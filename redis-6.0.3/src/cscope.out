cscope 15 $HOME/redis/redis-6.0.3/src -q 0000026829 0003339828
	@acl.c

30 
	~"£rvî.h
"

31 
	~"sha256.h
"

32 
	~<f˙é.h
>

33 
	~<˘y≥.h
>

39 
øx
 *
	gU£rs
;

41 
u£r
 *
	gDeÁu…U£r
;

46 
li°
 *
	gU£rsToLﬂd
;

53 
li°
 *
	gACLLog
;

56 
	sACLC©eg‹yIãm
 {

57 c⁄° *
	m«me
;

58 
uöt64_t
 
	mÊag
;

59 } 
	gACLComm™dC©eg‹õs
[] = {

60 {"key•a˚", 
CMD_CATEGORY_KEYSPACE
},

61 {"ªad", 
CMD_CATEGORY_READ
},

62 {"wrôe", 
CMD_CATEGORY_WRITE
},

63 {"£t", 
CMD_CATEGORY_SET
},

64 {"s‹ãd£t", 
CMD_CATEGORY_SORTEDSET
},

65 {"li°", 
CMD_CATEGORY_LIST
},

66 {"hash", 
CMD_CATEGORY_HASH
},

67 {"°rög", 
CMD_CATEGORY_STRING
},

68 {"bôm≠", 
CMD_CATEGORY_BITMAP
},

69 {"hy≥æoglog", 
CMD_CATEGORY_HYPERLOGLOG
},

70 {"geo", 
CMD_CATEGORY_GEO
},

71 {"°ªam", 
CMD_CATEGORY_STREAM
},

72 {"pubsub", 
CMD_CATEGORY_PUBSUB
},

73 {"admö", 
CMD_CATEGORY_ADMIN
},

74 {"Á°", 
CMD_CATEGORY_FAST
},

75 {"¶ow", 
CMD_CATEGORY_SLOW
},

76 {"blockög", 
CMD_CATEGORY_BLOCKING
},

77 {"d™gîous", 
CMD_CATEGORY_DANGEROUS
},

78 {"c⁄√˘i⁄", 
CMD_CATEGORY_CONNECTION
},

79 {"å™ß˘i⁄", 
CMD_CATEGORY_TRANSACTION
},

80 {"s¸ùtög", 
CMD_CATEGORY_SCRIPTING
},

81 {
NULL
,0}

84 
	sACLU£rFœg
 {

85 c⁄° *
	m«me
;

86 
uöt64_t
 
	mÊag
;

87 } 
	gACLU£rFœgs
[] = {

88 {"⁄", 
USER_FLAG_ENABLED
},

89 {"off", 
USER_FLAG_DISABLED
},

90 {"Ælkeys", 
USER_FLAG_ALLKEYS
},

91 {"Ælcomm™ds", 
USER_FLAG_ALLCOMMANDS
},

92 {"n›ass", 
USER_FLAG_NOPASS
},

93 {
NULL
,0}

96 
ACLRe£tSubcomm™dsF‹Comm™d
(
u£r
 *
u
, 
id
);

97 
ACLRe£tSubcomm™ds
(
u£r
 *
u
);

98 
ACLAddAŒowedSubcomm™d
(
u£r
 *
u
, 
id
, c⁄° *
sub
);

99 
ACLFªeLogE¡ry
(*
À
);

102 
	#HASH_PASSWORD_LEN
 
SHA256_BLOCK_SIZE
*2

	)

117 
	$time_ödïídít_°rcmp
(*
a
, *
b
) {

118 
buÁ
[
CONFIG_AUTHPASS_MAX_LEN
], 
bufb
[CONFIG_AUTHPASS_MAX_LEN];

123 
Æí
 = 
	`°æí
(
a
);

124 
bÀn
 = 
	`°æí
(
b
);

125 
j
;

126 
diff
 = 0;

131 i‡(
Æí
 > (
buÁ
Ë|| 
bÀn
 > (
bufb
))  1;

133 
	`mem£t
(
buÁ
,0,(bufa));

134 
	`mem£t
(
bufb
,0,(bufb));

137 
	`mem˝y
(
buÁ
,
a
,
Æí
);

138 
	`mem˝y
(
bufb
,
b
,
bÀn
);

142 
j
 = 0; j < (
buÁ
); j++) {

143 
diff
 |(
buÁ
[
j
] ^ 
bufb
[j]);

146 
diff
 |
Æí
 ^ 
bÀn
;

147  
diff
;

148 
	}
}

152 
sds
 
	$ACLHashPassw‹d
(*
˛óπext
, 
size_t
 
Àn
) {

153 
SHA256_CTX
 
˘x
;

154 
hash
[
SHA256_BLOCK_SIZE
];

155 
hex
[
HASH_PASSWORD_LEN
];

156 *
c£t
 = "0123456789abcdef";

158 
	`sha256_öô
(&
˘x
);

159 
	`sha256_upd©e
(&
˘x
,(*)
˛óπext
,
Àn
);

160 
	`sha256_föÆ
(&
˘x
,
hash
);

162 
j
 = 0; j < 
SHA256_BLOCK_SIZE
; j++) {

163 
hex
[
j
*2] = 
c£t
[((
hash
[j]&0xF0)>>4)];

164 
hex
[
j
*2+1] = 
c£t
[(
hash
[j]&0xF)];

166  
	`sd¢ewÀn
(
hex
,
HASH_PASSWORD_LEN
);

167 
	}
}

178 
	$ACLSåögHasS∑˚s
(c⁄° *
s
, 
size_t
 
Àn
) {

179 
size_t
 
i
 = 0; i < 
Àn
; i++) {

180 i‡(
	`is•a˚
(
s
[
i
]) || s[i] == 0)  1;

183 
	}
}

187 
uöt64_t
 
	$ACLGëComm™dC©eg‹yFœgByName
(c⁄° *
«me
) {

188 
j
 = 0; 
ACLComm™dC©eg‹õs
[j].
Êag
 != 0; j++) {

189 i‡(!
	`°rˇ£cmp
(
«me
,
ACLComm™dC©eg‹õs
[
j
].name)) {

190  
ACLComm™dC©eg‹õs
[
j
].
Êag
;

194 
	}
}

198 
	$ACLLi°M©chSds
(*
a
, *
b
) {

199  
	`sdscmp
(
a
,
b
) == 0;

200 
	}
}

203 
	$ACLLi°FªeSds
(*
ôem
) {

204 
	`sds‰ì
(
ôem
);

205 
	}
}

208 *
	$ACLLi°DupSds
(*
ôem
) {

209  
	`sdsdup
(
ôem
);

210 
	}
}

217 
u£r
 *
	$ACLCª©eU£r
(c⁄° *
«me
, 
size_t
 
«mñí
) {

218 i‡(
	`øxFöd
(
U£rs
,(*)
«me
,
«mñí
Ë!
øxNŸFound
Ë 
NULL
;

219 
u£r
 *
u
 = 
	`zmÆloc
((*u));

220 
u
->
«me
 = 
	`sd¢ewÀn
“ame,
«mñí
);

221 
u
->
Êags
 = 
USER_FLAG_DISABLED
;

222 
u
->
Ælowed_subcomm™ds
 = 
NULL
;

223 
u
->
∑ssw‹ds
 = 
	`li°Cª©e
();

224 
u
->
∑âîns
 = 
	`li°Cª©e
();

225 
	`li°SëM©chMëhod
(
u
->
∑ssw‹ds
,
ACLLi°M©chSds
);

226 
	`li°SëFªeMëhod
(
u
->
∑ssw‹ds
,
ACLLi°FªeSds
);

227 
	`li°SëDupMëhod
(
u
->
∑ssw‹ds
,
ACLLi°DupSds
);

228 
	`li°SëM©chMëhod
(
u
->
∑âîns
,
ACLLi°M©chSds
);

229 
	`li°SëFªeMëhod
(
u
->
∑âîns
,
ACLLi°FªeSds
);

230 
	`li°SëDupMëhod
(
u
->
∑âîns
,
ACLLi°DupSds
);

231 
	`mem£t
(
u
->
Ælowed_comm™ds
,0,(u->allowed_commands));

232 
	`øxIn£π
(
U£rs
,(*)
«me
,
«mñí
,
u
,
NULL
);

233  
u
;

234 
	}
}

240 
u£r
 *
	$ACLCª©eU∆ökedU£r
() {

241 
u£∫ame
[64];

242 
j
 = 0; ; j++) {

243 
	`¢¥ötf
(
u£∫ame
,(u£∫ame),"__Ákeu£r:%d__",
j
);

244 
u£r
 *
Ákeu£r
 = 
	`ACLCª©eU£r
(
u£∫ame
,
	`°æí
(username));

245 i‡(
Ákeu£r
 =
NULL
) ;

246 
ªtvÆ
 = 
	`øxRemove
(
U£rs
,(*Ë
u£∫ame
,

247 
	`°æí
(
u£∫ame
),
NULL
);

248 
	`£rvîAs£π
(
ªtvÆ
 != 0);

249  
Ákeu£r
;

251 
	}
}

255 
	$ACLFªeU£r
(
u£r
 *
u
) {

256 
	`sds‰ì
(
u
->
«me
);

257 
	`li°Rñó£
(
u
->
∑ssw‹ds
);

258 
	`li°Rñó£
(
u
->
∑âîns
);

259 
	`ACLRe£tSubcomm™ds
(
u
);

260 
	`z‰ì
(
u
);

261 
	}
}

266 
	$ACLFªeU£rAndKûlClõ¡s
(
u£r
 *
u
) {

267 
li°Iãr
 
li
;

268 
li°Node
 *
 
;

269 
	`li°Rewöd
(
£rvî
.
˛õ¡s
,&
li
);

270 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

271 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

272 i‡(
c
->
u£r
 =
u
) {

279 
c
->
u£r
 = 
DeÁu…U£r
;

280 
c
->
authítiˇãd
 = 0;

281 
	`‰ìClõ¡Async
(
c
);

284 
	`ACLFªeU£r
(
u
);

285 
	}
}

290 
	$ACLC›yU£r
(
u£r
 *
d°
, u£∏*
§c
) {

291 
	`li°Rñó£
(
d°
->
∑ssw‹ds
);

292 
	`li°Rñó£
(
d°
->
∑âîns
);

293 
d°
->
∑ssw‹ds
 = 
	`li°Dup
(
§c
->passwords);

294 
d°
->
∑âîns
 = 
	`li°Dup
(
§c
->patterns);

295 
	`mem˝y
(
d°
->
Ælowed_comm™ds
,
§c
->allowed_commands,

296 (
d°
->
Ælowed_comm™ds
));

297 
d°
->
Êags
 = 
§c
->flags;

298 
	`ACLRe£tSubcomm™ds
(
d°
);

300 i‡(
§c
->
Ælowed_subcomm™ds
) {

301 
j
 = 0; j < 
USER_COMMAND_BITS_COUNT
; j++) {

302 i‡(
§c
->
Ælowed_subcomm™ds
[
j
]) {

303 
i
 = 0; 
§c
->
Ælowed_subcomm™ds
[
j
][i]; i++)

305 
	`ACLAddAŒowedSubcomm™d
(
d°
, 
j
,

306 
§c
->
Ælowed_subcomm™ds
[
j
][
i
]);

311 
	}
}

315 
	$ACLFªeU£rsSë
(
øx
 *
u£rs
) {

316 
	`øxFªeWôhCÆlback
(
u£rs
,((*)(*))
ACLFªeU£rAndKûlClõ¡s
);

317 
	}
}

325 
	$ACLGëComm™dBôCo‹dö©es
(
uöt64_t
 
id
, uöt64_à*
w‹d
, uöt64_à*
bô
) {

326 i‡(
id
 >
USER_COMMAND_BITS_COUNT
Ë 
C_ERR
;

327 *
w‹d
 = 
id
 / (
uöt64_t
) / 8;

328 *
bô
 = 1ULL << (
id
 % ((
uöt64_t
) * 8));

329  
C_OK
;

330 
	}
}

339 
	$ACLGëU£rComm™dBô
(
u£r
 *
u
, 
id
) {

340 
uöt64_t
 
w‹d
, 
bô
;

341 i‡(
	`ACLGëComm™dBôCo‹dö©es
(
id
,&
w‹d
,&
bô
Ë=
C_ERR
)  0;

342  (
u
->
Ælowed_comm™ds
[
w‹d
] & 
bô
) != 0;

343 
	}
}

348 
	$ACLU£rC™ExecuãFutuªComm™ds
(
u£r
 *
u
) {

349  
	`ACLGëU£rComm™dBô
(
u
,
USER_COMMAND_BITS_COUNT
-1);

350 
	}
}

357 
	$ACLSëU£rComm™dBô
(
u£r
 *
u
, 
id
, 
vÆue
) {

358 
uöt64_t
 
w‹d
, 
bô
;

359 i‡(
vÆue
 =0Ë
u
->
Êags
 &~
USER_FLAG_ALLCOMMANDS
;

360 i‡(
	`ACLGëComm™dBôCo‹dö©es
(
id
,&
w‹d
,&
bô
Ë=
C_ERR
) ;

361 i‡(
vÆue
)

362 
u
->
Ælowed_comm™ds
[
w‹d
] |
bô
;

364 
u
->
Ælowed_comm™ds
[
w‹d
] &~
bô
;

365 
	}
}

373 
	$ACLSëU£rComm™dBôsF‹C©eg‹y
(
u£r
 *
u
, c⁄° *
ˇãg‹y
, 
vÆue
) {

374 
uöt64_t
 
cÊag
 = 
	`ACLGëComm™dC©eg‹yFœgByName
(
ˇãg‹y
);

375 i‡(!
cÊag
Ë 
C_ERR
;

376 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
‹ig_comm™ds
);

377 
di˘E¡ry
 *
de
;

378 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

379 
ªdisComm™d
 *
cmd
 = 
	`di˘GëVÆ
(
de
);

380 i‡(
cmd
->
Êags
 & 
CMD_MODULE
) ;

381 i‡(
cmd
->
Êags
 & 
cÊag
) {

382 
	`ACLSëU£rComm™dBô
(
u
,
cmd
->
id
,
vÆue
);

383 
	`ACLRe£tSubcomm™dsF‹Comm™d
(
u
,
cmd
->
id
);

386 
	`di˘Rñó£Iãøt‹
(
di
);

387  
C_OK
;

388 
	}
}

394 
	$ACLCou¡C©eg‹yBôsF‹U£r
(
u£r
 *
u
, *
⁄
, *
off
,

395 c⁄° *
ˇãg‹y
)

397 
uöt64_t
 
cÊag
 = 
	`ACLGëComm™dC©eg‹yFœgByName
(
ˇãg‹y
);

398 i‡(!
cÊag
Ë 
C_ERR
;

400 *
⁄
 = *
off
 = 0;

401 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
‹ig_comm™ds
);

402 
di˘E¡ry
 *
de
;

403 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

404 
ªdisComm™d
 *
cmd
 = 
	`di˘GëVÆ
(
de
);

405 i‡(
cmd
->
Êags
 & 
cÊag
) {

406 i‡(
	`ACLGëU£rComm™dBô
(
u
,
cmd
->
id
))

407 (*
⁄
)++;

409 (*
off
)++;

412 
	`di˘Rñó£Iãøt‹
(
di
);

413  
C_OK
;

414 
	}
}

423 
sds
 
	$ACLDes¸ibeU£rComm™dRuÀs
(
u£r
 *
u
) {

424 
sds
 
ruÀs
 = 
	`sd£m±y
();

425 
addôive
;

431 
u£r
 
fu
 = {0};

432 
u£r
 *
Ákeu£r
 = &
fu
;

442 i‡(
	`ACLU£rC™ExecuãFutuªComm™ds
(
u
)) {

443 
addôive
 = 0;

444 
ruÀs
 = 
	`sdsˇt
(rules,"+@all ");

445 
	`ACLSëU£r
(
Ákeu£r
,"+@all",-1);

447 
addôive
 = 1;

448 
ruÀs
 = 
	`sdsˇt
(rules,"-@all ");

449 
	`ACLSëU£r
(
Ákeu£r
,"-@all",-1);

456 
j
 = 0; 
ACLComm™dC©eg‹õs
[j].
Êag
 != 0; j++) {

457 
⁄
, 
off
;

458 
	`ACLCou¡C©eg‹yBôsF‹U£r
(
u
,&
⁄
,&
off
,
ACLComm™dC©eg‹õs
[
j
].
«me
);

459 i‡((
addôive
 && 
⁄
 > 
off
) || (!additive && off > on)) {

460 
sds
 
›
 = 
	`sd¢ewÀn
(
addôive
 ? "+@" : "-@", 2);

461 
›
 = 
	`sdsˇt
(›,
ACLComm™dC©eg‹õs
[
j
].
«me
);

462 
	`ACLSëU£r
(
Ákeu£r
,
›
,-1);

463 
ruÀs
 = 
	`sdsˇtsds
‘uÀs,
›
);

464 
ruÀs
 = 
	`sdsˇéí
(rules," ",1);

465 
	`sds‰ì
(
›
);

470 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
‹ig_comm™ds
);

471 
di˘E¡ry
 *
de
;

472 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

473 
ªdisComm™d
 *
cmd
 = 
	`di˘GëVÆ
(
de
);

474 
u£rbô
 = 
	`ACLGëU£rComm™dBô
(
u
,
cmd
->
id
);

475 
Ákebô
 = 
	`ACLGëU£rComm™dBô
(
Ákeu£r
,
cmd
->
id
);

476 i‡(
u£rbô
 !
Ákebô
) {

477 
ruÀs
 = 
	`sdsˇéí
‘uÀs, 
u£rbô
 ? "+" : "-", 1);

478 
ruÀs
 = 
	`sdsˇt
‘uÀs,
cmd
->
«me
);

479 
ruÀs
 = 
	`sdsˇéí
(rules," ",1);

480 
	`ACLSëU£rComm™dBô
(
Ákeu£r
,
cmd
->
id
,
u£rbô
);

484 i‡(
u£rbô
 =0 && 
u
->
Ælowed_subcomm™ds
 &&

485 
u
->
Ælowed_subcomm™ds
[
cmd
->
id
])

487 
j
 = 0; 
u
->
Ælowed_subcomm™ds
[
cmd
->
id
][j]; j++) {

488 
ruÀs
 = 
	`sdsˇéí
(rules,"+",1);

489 
ruÀs
 = 
	`sdsˇt
‘uÀs,
cmd
->
«me
);

490 
ruÀs
 = 
	`sdsˇéí
(rules,"|",1);

491 
ruÀs
 = 
	`sdsˇtsds
‘uÀs,
u
->
Ælowed_subcomm™ds
[
cmd
->
id
][
j
]);

492 
ruÀs
 = 
	`sdsˇéí
(rules," ",1);

496 
	`di˘Rñó£Iãøt‹
(
di
);

499 
	`sd§™ge
(
ruÀs
,0,-2);

505 i‡(
	`memcmp
(
Ákeu£r
->
Ælowed_comm™ds
,

506 
u
->
Ælowed_comm™ds
,

507 (
u
->
Ælowed_comm™ds
)) != 0)

509 
	`£rvîLog
(
LL_WARNING
,

511 
ruÀs
);

512 
	`£rvîP™ic
("No bitmap match in ACLDescribeUserCommandRules()");

514  
ruÀs
;

515 
	}
}

523 
sds
 
	$ACLDes¸ibeU£r
(
u£r
 *
u
) {

524 
sds
 
ªs
 = 
	`sd£m±y
();

527 
j
 = 0; 
ACLU£rFœgs
[j].
Êag
; j++) {

530 i‡(
ACLU£rFœgs
[
j
].
Êag
 =
USER_FLAG_ALLKEYS
 ||

531 
ACLU£rFœgs
[
j
].
Êag
 =
USER_FLAG_ALLCOMMANDS
) ;

532 i‡(
u
->
Êags
 & 
ACLU£rFœgs
[
j
].
Êag
) {

533 
ªs
 = 
	`sdsˇt
‘es,
ACLU£rFœgs
[
j
].
«me
);

534 
ªs
 = 
	`sdsˇéí
(res," ",1);

539 
li°Iãr
 
li
;

540 
li°Node
 *
 
;

541 
	`li°Rewöd
(
u
->
∑ssw‹ds
,&
li
);

542 (
 
 = 
	`li°Next
(&
li
))) {

543 
sds
 
thi•ass
 = 
	`li°NodeVÆue
(
 
);

544 
ªs
 = 
	`sdsˇéí
(res,"#",1);

545 
ªs
 = 
	`sdsˇtsds
‘es,
thi•ass
);

546 
ªs
 = 
	`sdsˇéí
(res," ",1);

550 i‡(
u
->
Êags
 & 
USER_FLAG_ALLKEYS
) {

551 
ªs
 = 
	`sdsˇéí
(res,"~* ",3);

553 
	`li°Rewöd
(
u
->
∑âîns
,&
li
);

554 (
 
 = 
	`li°Next
(&
li
))) {

555 
sds
 
thi•©
 = 
	`li°NodeVÆue
(
 
);

556 
ªs
 = 
	`sdsˇéí
(res,"~",1);

557 
ªs
 = 
	`sdsˇtsds
‘es,
thi•©
);

558 
ªs
 = 
	`sdsˇéí
(res," ",1);

563 
sds
 
ruÀs
 = 
	`ACLDes¸ibeU£rComm™dRuÀs
(
u
);

564 
ªs
 = 
	`sdsˇtsds
‘es,
ruÀs
);

565 
	`sds‰ì
(
ruÀs
);

566  
ªs
;

567 
	}
}

572 
ªdisComm™d
 *
	$ACLLookupComm™d
(c⁄° *
«me
) {

573 
ªdisComm™d
 *
cmd
;

574 
sds
 
sd¢ame
 = 
	`sd¢ew
(
«me
);

575 
cmd
 = 
	`di˘FëchVÆue
(
£rvî
.
‹ig_comm™ds
, 
sd¢ame
);

576 
	`sds‰ì
(
sd¢ame
);

577  
cmd
;

578 
	}
}

582 
	$ACLRe£tSubcomm™dsF‹Comm™d
(
u£r
 *
u
, 
id
) {

583 i‡(
u
->
Ælowed_subcomm™ds
 && u->Ælowed_subcomm™ds[
id
]) {

584 
i
 = 0; 
u
->
Ælowed_subcomm™ds
[
id
][i]; i++)

585 
	`sds‰ì
(
u
->
Ælowed_subcomm™ds
[
id
][
i
]);

586 
	`z‰ì
(
u
->
Ælowed_subcomm™ds
[
id
]);

587 
u
->
Ælowed_subcomm™ds
[
id
] = 
NULL
;

589 
	}
}

594 
	$ACLRe£tSubcomm™ds
(
u£r
 *
u
) {

595 i‡(
u
->
Ælowed_subcomm™ds
 =
NULL
) ;

596 
j
 = 0; j < 
USER_COMMAND_BITS_COUNT
; j++) {

597 i‡(
u
->
Ælowed_subcomm™ds
[
j
]) {

598 
i
 = 0; 
u
->
Ælowed_subcomm™ds
[
j
][i]; i++)

599 
	`sds‰ì
(
u
->
Ælowed_subcomm™ds
[
j
][
i
]);

600 
	`z‰ì
(
u
->
Ælowed_subcomm™ds
[
j
]);

603 
	`z‰ì
(
u
->
Ælowed_subcomm™ds
);

604 
u
->
Ælowed_subcomm™ds
 = 
NULL
;

605 
	}
}

610 
	$ACLAddAŒowedSubcomm™d
(
u£r
 *
u
, 
id
, c⁄° *
sub
) {

613 i‡(
u
->
Ælowed_subcomm™ds
 =
NULL
) {

614 
u
->
Ælowed_subcomm™ds
 = 
	`zˇŒoc
(
USER_COMMAND_BITS_COUNT
 *

615 (
sds
*));

622 
ôems
 = 0;

623 i‡(
u
->
Ælowed_subcomm™ds
[
id
]) {

624 
u
->
Ælowed_subcomm™ds
[
id
][
ôems
]) {

626 i‡(!
	`°rˇ£cmp
(
u
->
Ælowed_subcomm™ds
[
id
][
ôems
],
sub
)) ;

627 
ôems
++;

632 
ôems
 += 2;

633 
u
->
Ælowed_subcomm™ds
[
id
] = 
	`zªÆloc
(u->allowed_subcommands[id],

634 (
sds
)*
ôems
);

635 
u
->
Ælowed_subcomm™ds
[
id
][
ôems
-2] = 
	`sd¢ew
(
sub
);

636 
u
->
Ælowed_subcomm™ds
[
id
][
ôems
-1] = 
NULL
;

637 
	}
}

717 
	$ACLSëU£r
(
u£r
 *
u
, c⁄° *
›
, 
ssize_t
 
›Àn
) {

718 i‡(
›Àn
 =-1Ë›À¿
	`°æí
(
›
);

719 i‡(!
	`°rˇ£cmp
(
›
,"on")) {

720 
u
->
Êags
 |
USER_FLAG_ENABLED
;

721 
u
->
Êags
 &~
USER_FLAG_DISABLED
;

722 } i‡(!
	`°rˇ£cmp
(
›
,"off")) {

723 
u
->
Êags
 |
USER_FLAG_DISABLED
;

724 
u
->
Êags
 &~
USER_FLAG_ENABLED
;

725 } i‡(!
	`°rˇ£cmp
(
›
,"allkeys") ||

726 !
	`°rˇ£cmp
(
›
,"~*"))

728 
u
->
Êags
 |
USER_FLAG_ALLKEYS
;

729 
	`li°Em±y
(
u
->
∑âîns
);

730 } i‡(!
	`°rˇ£cmp
(
›
,"resetkeys")) {

731 
u
->
Êags
 &~
USER_FLAG_ALLKEYS
;

732 
	`li°Em±y
(
u
->
∑âîns
);

733 } i‡(!
	`°rˇ£cmp
(
›
,"allcommands") ||

734 !
	`°rˇ£cmp
(
›
,"+@all"))

736 
	`mem£t
(
u
->
Ælowed_comm™ds
,255,(u->allowed_commands));

737 
u
->
Êags
 |
USER_FLAG_ALLCOMMANDS
;

738 
	`ACLRe£tSubcomm™ds
(
u
);

739 } i‡(!
	`°rˇ£cmp
(
›
,"nocommands") ||

740 !
	`°rˇ£cmp
(
›
,"-@all"))

742 
	`mem£t
(
u
->
Ælowed_comm™ds
,0,(u->allowed_commands));

743 
u
->
Êags
 &~
USER_FLAG_ALLCOMMANDS
;

744 
	`ACLRe£tSubcomm™ds
(
u
);

745 } i‡(!
	`°rˇ£cmp
(
›
,"nopass")) {

746 
u
->
Êags
 |
USER_FLAG_NOPASS
;

747 
	`li°Em±y
(
u
->
∑ssw‹ds
);

748 } i‡(!
	`°rˇ£cmp
(
›
,"resetpass")) {

749 
u
->
Êags
 &~
USER_FLAG_NOPASS
;

750 
	`li°Em±y
(
u
->
∑ssw‹ds
);

751 } i‡(
›
[0] == '>' || op[0] == '#') {

752 
sds
 
√w∑ss
;

753 i‡(
›
[0] == '>') {

754 
√w∑ss
 = 
	`ACLHashPassw‹d
((*)
›
+1,
›Àn
-1);

756 i‡(
›Àn
 !
HASH_PASSWORD_LEN
 + 1) {

757 
î∫o
 = 
EBADMSG
;

758  
C_ERR
;

765 
i
 = 1; i < 
HASH_PASSWORD_LEN
 + 1; i++) {

766 
c
 = 
›
[
i
];

767 i‡((
c
 < 'a' || c > 'f') && (c < '0' || c > '9')) {

768 
î∫o
 = 
EBADMSG
;

769  
C_ERR
;

772 
√w∑ss
 = 
	`sd¢ewÀn
(
›
+1,
›Àn
-1);

775 
li°Node
 *
 
 = 
	`li°SórchKey
(
u
->
∑ssw‹ds
,
√w∑ss
);

777 i‡(
 
 =
NULL
)

778 
	`li°AddNodeTaû
(
u
->
∑ssw‹ds
,
√w∑ss
);

780 
	`sds‰ì
(
√w∑ss
);

781 
u
->
Êags
 &~
USER_FLAG_NOPASS
;

782 } i‡(
›
[0] == '<' || op[0] == '!') {

783 
sds
 
dñ∑ss
;

784 i‡(
›
[0] == '<') {

785 
dñ∑ss
 = 
	`ACLHashPassw‹d
((*)
›
+1,
›Àn
-1);

787 i‡(
›Àn
 !
HASH_PASSWORD_LEN
 + 1) {

788 
î∫o
 = 
EBADMSG
;

789  
C_ERR
;

791 
dñ∑ss
 = 
	`sd¢ewÀn
(
›
+1,
›Àn
-1);

793 
li°Node
 *
 
 = 
	`li°SórchKey
(
u
->
∑ssw‹ds
,
dñ∑ss
);

794 
	`sds‰ì
(
dñ∑ss
);

795 i‡(
 
) {

796 
	`li°DñNode
(
u
->
∑ssw‹ds
,
 
);

798 
î∫o
 = 
ENODEV
;

799  
C_ERR
;

801 } i‡(
›
[0] == '~') {

802 i‡(
u
->
Êags
 & 
USER_FLAG_ALLKEYS
) {

803 
î∫o
 = 
EEXIST
;

804  
C_ERR
;

806 i‡(
	`ACLSåögHasS∑˚s
(
›
+1,
›Àn
-1)) {

807 
î∫o
 = 
EINVAL
;

808  
C_ERR
;

810 
sds
 
√w∑t
 = 
	`sd¢ewÀn
(
›
+1,
›Àn
-1);

811 
li°Node
 *
 
 = 
	`li°SórchKey
(
u
->
∑âîns
,
√w∑t
);

813 i‡(
 
 =
NULL
)

814 
	`li°AddNodeTaû
(
u
->
∑âîns
,
√w∑t
);

816 
	`sds‰ì
(
√w∑t
);

817 
u
->
Êags
 &~
USER_FLAG_ALLKEYS
;

818 } i‡(
›
[0] == '+' && op[1] != '@') {

819 i‡(
	`°rchr
(
›
,'|'Ë=
NULL
) {

820 i‡(
	`ACLLookupComm™d
(
›
+1Ë=
NULL
) {

821 
î∫o
 = 
ENOENT
;

822  
C_ERR
;

824 
id
 = 
	`ACLGëComm™dID
(
›
+1);

825 
	`ACLSëU£rComm™dBô
(
u
,
id
,1);

826 
	`ACLRe£tSubcomm™dsF‹Comm™d
(
u
,
id
);

829 *
c›y
 = 
	`z°rdup
(
›
+1);

830 *
sub
 = 
	`°rchr
(
c›y
,'|');

831 
sub
[0] = '\0';

832 
sub
++;

836 i‡(
	`ACLLookupComm™d
(
c›y
Ë=
NULL
) {

837 
	`z‰ì
(
c›y
);

838 
î∫o
 = 
ENOENT
;

839  
C_ERR
;

841 
id
 = 
	`ACLGëComm™dID
(
c›y
);

845 i‡(
	`°æí
(
sub
) == 0) {

846 
	`z‰ì
(
c›y
);

847 
î∫o
 = 
EINVAL
;

848  
C_ERR
;

854 i‡(
	`ACLGëU£rComm™dBô
(
u
,
id
) == 1) {

855 
	`z‰ì
(
c›y
);

856 
î∫o
 = 
EBUSY
;

857  
C_ERR
;

861 
	`ACLAddAŒowedSubcomm™d
(
u
,
id
,
sub
);

865 
	`ACLSëU£rComm™dBô
(
u
,
id
,0);

866 
	`z‰ì
(
c›y
);

868 } i‡(
›
[0] == '-' && op[1] != '@') {

869 i‡(
	`ACLLookupComm™d
(
›
+1Ë=
NULL
) {

870 
î∫o
 = 
ENOENT
;

871  
C_ERR
;

873 
id
 = 
	`ACLGëComm™dID
(
›
+1);

874 
	`ACLSëU£rComm™dBô
(
u
,
id
,0);

875 
	`ACLRe£tSubcomm™dsF‹Comm™d
(
u
,
id
);

876 } i‡((
›
[0] == '+' || op[0] == '-') && op[1] == '@') {

877 
bôvÆ
 = 
›
[0] == '+' ? 1 : 0;

878 i‡(
	`ACLSëU£rComm™dBôsF‹C©eg‹y
(
u
,
›
+2,
bôvÆ
Ë=
C_ERR
) {

879 
î∫o
 = 
ENOENT
;

880  
C_ERR
;

882 } i‡(!
	`°rˇ£cmp
(
›
,"reset")) {

883 
	`£rvîAs£π
(
	`ACLSëU£r
(
u
,"ª£çass",-1Ë=
C_OK
);

884 
	`£rvîAs£π
(
	`ACLSëU£r
(
u
,"ª£tkeys",-1Ë=
C_OK
);

885 
	`£rvîAs£π
(
	`ACLSëU£r
(
u
,"off",-1Ë=
C_OK
);

886 
	`£rvîAs£π
(
	`ACLSëU£r
(
u
,"-@Æl",-1Ë=
C_OK
);

888 
î∫o
 = 
EINVAL
;

889  
C_ERR
;

891  
C_OK
;

892 
	}
}

896 *
	$ACLSëU£rSåögEº‹
() {

897 *
îrmsg
 = "Wrong format";

898 i‡(
î∫o
 =
ENOENT
)

899 
îrmsg
 = "Unknown command or categoryÇame in ACL";

900 i‡(
î∫o
 =
EINVAL
)

901 
îrmsg
 = "SyntaxÉrror";

902 i‡(
î∫o
 =
EBUSY
)

903 
îrmsg
 = "Addingá subcommand ofá commandálready fully "

906 i‡(
î∫o
 =
EEXIST
)

907 
îrmsg
 = "AddingáÖatternáfterÅhe *Öattern (orÅhe "

911 i‡(
î∫o
 =
ENODEV
)

912 
îrmsg
 = "TheÖassword youáreÅryingÅoÑemove fromÅhe user does "

914 i‡(
î∫o
 =
EBADMSG
)

915 
îrmsg
 = "TheÖassword hash must beÉxactly 64 charactersánd contain "

917  
îrmsg
;

918 
	}
}

922 
	$ACLInôDeÁu…U£r
() {

923 
DeÁu…U£r
 = 
	`ACLCª©eU£r
("default",7);

924 
	`ACLSëU£r
(
DeÁu…U£r
,"+@all",-1);

925 
	`ACLSëU£r
(
DeÁu…U£r
,"~*",-1);

926 
	`ACLSëU£r
(
DeÁu…U£r
,"on",-1);

927 
	`ACLSëU£r
(
DeÁu…U£r
,"nopass",-1);

928 
	}
}

931 
	$ACLInô
() {

932 
U£rs
 = 
	`øxNew
();

933 
U£rsToLﬂd
 = 
	`li°Cª©e
();

934 
ACLLog
 = 
	`li°Cª©e
();

935 
	`ACLInôDeÁu…U£r
();

936 
£rvî
.
ªquúïass
 = 
NULL
;

937 
	}
}

945 
	$ACLCheckU£rCªdítüls
(
robj
 *
u£∫ame
,Ñobj *
∑ssw‹d
) {

946 
u£r
 *
u
 = 
	`ACLGëU£rByName
(
u£∫ame
->
±r
,
	`sd¶í
(username->ptr));

947 i‡(
u
 =
NULL
) {

948 
î∫o
 = 
ENOENT
;

949  
C_ERR
;

953 i‡(
u
->
Êags
 & 
USER_FLAG_DISABLED
) {

954 
î∫o
 = 
EINVAL
;

955  
C_ERR
;

960 i‡(
u
->
Êags
 & 
USER_FLAG_NOPASS
Ë 
C_OK
;

963 
li°Iãr
 
li
;

964 
li°Node
 *
 
;

965 
	`li°Rewöd
(
u
->
∑ssw‹ds
,&
li
);

966 
sds
 
hashed
 = 
	`ACLHashPassw‹d
(
∑ssw‹d
->
±r
,
	`sd¶í
(password->ptr));

967 (
 
 = 
	`li°Next
(&
li
))) {

968 
sds
 
thi•ass
 = 
	`li°NodeVÆue
(
 
);

969 i‡(!
	`time_ödïídít_°rcmp
(
hashed
, 
thi•ass
)) {

970 
	`sds‰ì
(
hashed
);

971  
C_OK
;

974 
	`sds‰ì
(
hashed
);

977 
î∫o
 = 
EINVAL
;

978  
C_ERR
;

979 
	}
}

987 
	$ACLAuthítiˇãU£r
(
˛õ¡
 *
c
, 
robj
 *
u£∫ame
,Ñobj *
∑ssw‹d
) {

988 i‡(
	`ACLCheckU£rCªdítüls
(
u£∫ame
,
∑ssw‹d
Ë=
C_OK
) {

989 
c
->
authítiˇãd
 = 1;

990 
c
->
u£r
 = 
	`ACLGëU£rByName
(
u£∫ame
->
±r
,
	`sd¶í
(username->ptr));

991 
	`moduÀNŸifyU£rCh™ged
(
c
);

992  
C_OK
;

994 
	`addACLLogE¡ry
(
c
,
ACL_DENIED_AUTH
,0,
u£∫ame
->
±r
);

995  
C_ERR
;

997 
	}
}

1005 
	$ACLGëComm™dID
(c⁄° *
cmd«me
) {

1006 
øx
 *
m≠
 = 
NULL
;

1007 
√xtid
 = 0;

1009 
sds
 
lowî«me
 = 
	`sd¢ew
(
cmd«me
);

1010 
	`sd°ﬁowî
(
lowî«me
);

1011 i‡(
m≠
 =
NULL
Ëm≠ = 
	`øxNew
();

1012 *
id
 = 
	`øxFöd
(
m≠
,(*)
lowî«me
,
	`sd¶í
(lowername));

1013 i‡(
id
 !
øxNŸFound
) {

1014 
	`sds‰ì
(
lowî«me
);

1015  ()
id
;

1017 
	`øxIn£π
(
m≠
,(*)
lowî«me
,
	`°æí
(lowername),

1018 (*)
√xtid
,
NULL
);

1019 
	`sds‰ì
(
lowî«me
);

1020 
thisid
 = 
√xtid
;

1021 
√xtid
++;

1031 i‡(
√xtid
 =
USER_COMMAND_BITS_COUNT
-1)Çextid++;

1032  
thisid
;

1033 
	}
}

1036 
u£r
 *
	$ACLGëU£rByName
(c⁄° *
«me
, 
size_t
 
«mñí
) {

1037 *
myu£r
 = 
	`øxFöd
(
U£rs
,(*)
«me
,
«mñí
);

1038 i‡(
myu£r
 =
øxNŸFound
Ë 
NULL
;

1039  
myu£r
;

1040 
	}
}

1051 
	$ACLCheckComm™dPîm
(
˛õ¡
 *
c
, *
keyidx±r
) {

1052 
u£r
 *
u
 = 
c
->user;

1053 
uöt64_t
 
id
 = 
c
->
cmd
->id;

1056 i‡(
u
 =
NULL
Ë 
ACL_OK
;

1059 i‡(!(
u
->
Êags
 & 
USER_FLAG_ALLCOMMANDS
) &&

1060 
c
->
cmd
->
¥oc
 !
authComm™d
)

1064 i‡(
	`ACLGëU£rComm™dBô
(
u
,
id
) == 0) {

1066 i‡(
c
->
¨gc
 < 2 ||

1067 
u
->
Ælowed_subcomm™ds
 =
NULL
 ||

1068 
u
->
Ælowed_subcomm™ds
[
id
] =
NULL
)

1070  
ACL_DENIED_CMD
;

1073 
subid
 = 0;

1075 i‡(
u
->
Ælowed_subcomm™ds
[
id
][
subid
] =
NULL
)

1076  
ACL_DENIED_CMD
;

1077 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,

1078 
u
->
Ælowed_subcomm™ds
[
id
][
subid
]))

1080 
subid
++;

1087 i‡(!(
c
->
u£r
->
Êags
 & 
USER_FLAG_ALLKEYS
) &&

1088 (
c
->
cmd
->
gëkeys_¥oc
 || c->cmd->
fú°key
))

1090 
numkeys
;

1091 *
keyidx
 = 
	`gëKeysFromComm™d
(
c
->
cmd
,c->
¨gv
,c->
¨gc
,&
numkeys
);

1092 
j
 = 0; j < 
numkeys
; j++) {

1093 
li°Iãr
 
li
;

1094 
li°Node
 *
 
;

1095 
	`li°Rewöd
(
u
->
∑âîns
,&
li
);

1098 
m©ch
 = 0;

1099 (
 
 = 
	`li°Next
(&
li
))) {

1100 
sds
 
∑âîn
 = 
	`li°NodeVÆue
(
 
);

1101 
size_t
 
∂í
 = 
	`sd¶í
(
∑âîn
);

1102 
idx
 = 
keyidx
[
j
];

1103 i‡(
	`°rögm©chÀn
(
∑âîn
,
∂í
,
c
->
¨gv
[
idx
]->
±r
,

1104 
	`sd¶í
(
c
->
¨gv
[
idx
]->
±r
),0))

1106 
m©ch
 = 1;

1110 i‡(!
m©ch
) {

1111 i‡(
keyidx±r
Ë*keyidx±∏
keyidx
[
j
];

1112 
	`gëKeysFªeResu…
(
keyidx
);

1113  
ACL_DENIED_KEY
;

1116 
	`gëKeysFªeResu…
(
keyidx
);

1121  
ACL_OK
;

1122 
	}
}

1146 
	$ACLAµídU£rF‹Lﬂdög
(
sds
 *
¨gv
, 
¨gc
, *
¨gc_îr
) {

1147 i‡(
¨gc
 < 2 || 
	`°rˇ£cmp
(
¨gv
[0],"user")) {

1148 i‡(
¨gc_îr
) *argc_err = 0;

1149  
C_ERR
;

1154 
u£r
 *
Ákeu£r
 = 
	`ACLCª©eU∆ökedU£r
();

1156 
j
 = 2; j < 
¨gc
; j++) {

1157 i‡(
	`ACLSëU£r
(
Ákeu£r
,
¨gv
[
j
],
	`sd¶í
◊rgv[j])Ë=
C_ERR
) {

1158 i‡(
î∫o
 !
ENOENT
) {

1159 
	`ACLFªeU£r
(
Ákeu£r
);

1160 i‡(
¨gc_îr
Ë*¨gc_î∏
j
;

1161  
C_ERR
;

1167 
sds
 *
c›y
 = 
	`zmÆloc
((sds)*
¨gc
);

1168 
j
 = 1; j < 
¨gc
; j++Ë
c›y
[j-1] = 
	`sdsdup
(
¨gv
[j]);

1169 
c›y
[
¨gc
-1] = 
NULL
;

1170 
	`li°AddNodeTaû
(
U£rsToLﬂd
,
c›y
);

1171 
	`ACLFªeU£r
(
Ákeu£r
);

1172  
C_OK
;

1173 
	}
}

1178 
	$ACLLﬂdC⁄figuªdU£rs
() {

1179 
li°Iãr
 
li
;

1180 
li°Node
 *
 
;

1181 
	`li°Rewöd
(
U£rsToLﬂd
,&
li
);

1182 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

1183 
sds
 *
a˛ruÀs
 = 
	`li°NodeVÆue
(
 
);

1184 
sds
 
u£∫ame
 = 
a˛ruÀs
[0];

1186 i‡(
	`ACLSåögHasS∑˚s
(
a˛ruÀs
[0],
	`sd¶í
(aclrules[0]))) {

1187 
	`£rvîLog
(
LL_WARNING
,"SpacesÇotállowed in ACL usernames");

1188  
C_ERR
;

1191 
u£r
 *
u
 = 
	`ACLCª©eU£r
(
u£∫ame
,
	`sd¶í
(username));

1192 i‡(!
u
) {

1193 
u
 = 
	`ACLGëU£rByName
(
u£∫ame
,
	`sd¶í
(username));

1194 
	`£rvîAs£π
(
u
 !
NULL
);

1195 
	`ACLSëU£r
(
u
,"reset",-1);

1199 
j
 = 1; 
a˛ruÀs
[j]; j++) {

1200 i‡(
	`ACLSëU£r
(
u
,
a˛ruÀs
[
j
],
	`sd¶í
◊˛ruÀs[j])Ë!
C_OK
) {

1201 *
îrmsg
 = 
	`ACLSëU£rSåögEº‹
();

1202 
	`£rvîLog
(
LL_WARNING
,"ErrorÜoading ACLÑule '%s' for "

1204 
a˛ruÀs
[
j
],a˛ruÀs[0],
îrmsg
);

1205  
C_ERR
;

1211 i‡(
u
->
Êags
 & 
USER_FLAG_DISABLED
) {

1212 
	`£rvîLog
(
LL_NOTICE
, "The user '%s' is disabled (there isÇo "

1215 
a˛ruÀs
[0]);

1218  
C_OK
;

1219 
	}
}

1244 
sds
 
	$ACLLﬂdFromFûe
(c⁄° *
fûíame
) {

1245 
FILE
 *
Â
;

1246 
buf
[1024];

1249 i‡((
Â
 = 
	`f›í
(
fûíame
,"r")Ë=
NULL
) {

1250 
sds
 
îr‹s
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1252 
fûíame
, 
	`°ªº‹
(
î∫o
));

1253  
îr‹s
;

1257 
sds
 
a˛s
 = 
	`sd£m±y
();

1258 
	`fgës
(
buf
,(buf),
Â
Ë!
NULL
)

1259 
a˛s
 = 
	`sdsˇt
◊˛s,
buf
);

1260 
	`f˛o£
(
Â
);

1263 
tŸlöes
;

1264 
sds
 *
löes
, 
îr‹s
 = 
	`sd£m±y
();

1265 
löes
 = 
	`sds•lôÀn
(
a˛s
,
	`°æí
◊˛s),"\n",1,&
tŸlöes
);

1266 
	`sds‰ì
(
a˛s
);

1270 
u£r
 *
Ákeu£r
 = 
	`ACLCª©eU∆ökedU£r
();

1275 
øx
 *
ﬁd_u£rs
 = 
U£rs
;

1276 
u£r
 *
ﬁd_deÁu…_u£r
 = 
DeÁu…U£r
;

1277 
U£rs
 = 
	`øxNew
();

1278 
	`ACLInôDeÁu…U£r
();

1281 
i
 = 0; i < 
tŸlöes
; i++) {

1282 
sds
 *
¨gv
;

1283 
¨gc
;

1284 
löíum
 = 
i
+1;

1286 
löes
[
i
] = 
	`sd°rim
(lines[i]," \t\r\n");

1289 i‡(
löes
[
i
][0] == '\0') ;

1292 
¨gv
 = 
	`sds•lô¨gs
(
löes
[
i
],&
¨gc
);

1293 i‡(
¨gv
 =
NULL
) {

1294 
îr‹s
 = 
	`sdsˇçrötf
(errors,

1296 
£rvî
.
a˛_fûíame
, 
löíum
);

1301 i‡(
¨gc
 == 0) {

1302 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

1307 i‡(
	`°rcmp
(
¨gv
[0],"u£r"Ë|| 
¨gc
 < 2) {

1308 
îr‹s
 = 
	`sdsˇçrötf
(errors,

1310 "byÅhêu£∫ame. ", 
£rvî
.
a˛_fûíame
,

1311 
löíum
);

1312 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

1317 i‡(
	`ACLSåögHasS∑˚s
(
¨gv
[1],
	`sd¶í
(argv[1]))) {

1318 
îr‹s
 = 
	`sdsˇçrötf
(errors,

1320 
£rvî
.
a˛_fûíame
, 
löíum
, 
¨gv
[1]);

1326 
	`ACLSëU£r
(
Ákeu£r
,"reset",-1);

1327 
j
;

1328 
j
 = 2; j < 
¨gc
; j++) {

1329 i‡(
	`ACLSëU£r
(
Ákeu£r
,
¨gv
[
j
],
	`sd¶í
◊rgv[j])Ë!
C_OK
) {

1330 *
îrmsg
 = 
	`ACLSëU£rSåögEº‹
();

1331 
îr‹s
 = 
	`sdsˇçrötf
(errors,

1333 
£rvî
.
a˛_fûíame
, 
löíum
, 
îrmsg
);

1341 i‡(
	`sd¶í
(
îr‹s
) != 0) {

1342 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

1348 
u£r
 *
u
 = 
	`ACLCª©eU£r
(
¨gv
[1],
	`sd¶í
(argv[1]));

1349 i‡(!
u
) {

1350 
u
 = 
	`ACLGëU£rByName
(
¨gv
[1],
	`sd¶í
(argv[1]));

1351 
	`£rvîAs£π
(
u
 !
NULL
);

1352 
	`ACLSëU£r
(
u
,"reset",-1);

1357 
j
 = 2; j < 
¨gc
; j++)

1358 
	`£rvîAs£π
(
	`ACLSëU£r
(
u
,
¨gv
[
j
],
	`sd¶í
◊rgv[j])Ë=
C_OK
);

1360 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

1363 
	`ACLFªeU£r
(
Ákeu£r
);

1364 
	`sds‰ì•lôªs
(
löes
,
tŸlöes
);

1365 
DeÁu…U£r
 = 
ﬁd_deÁu…_u£r
;

1368 i‡(
	`sd¶í
(
îr‹s
) == 0) {

1372 
u£r
 *
√w
 = 
	`ACLGëU£rByName
("default",7);

1373 
	`£rvîAs£π
(
√w
 !
NULL
);

1374 
	`ACLC›yU£r
(
DeÁu…U£r
,
√w
);

1375 
	`ACLFªeU£r
(
√w
);

1376 
	`øxIn£π
(
U£rs
,(*)"deÁu…",7,
DeÁu…U£r
,
NULL
);

1377 
	`øxRemove
(
ﬁd_u£rs
,(*)"deÁu…",7,
NULL
);

1378 
	`ACLFªeU£rsSë
(
ﬁd_u£rs
);

1379 
	`sds‰ì
(
îr‹s
);

1380  
NULL
;

1382 
	`ACLFªeU£rsSë
(
U£rs
);

1383 
U£rs
 = 
ﬁd_u£rs
;

1384 
îr‹s
 = 
	`sdsˇt
(errors,"WARNING: ACLÉrrors detected,Ço changeÅoÅheÖreviouslyáctive ACLÑules wasÖerformed");

1385  
îr‹s
;

1387 
	}
}

1392 
	$ACLSaveToFûe
(c⁄° *
fûíame
) {

1393 
sds
 
a˛
 = 
	`sd£m±y
();

1394 
fd
 = -1;

1395 
sds
 
tmpfûíame
 = 
NULL
;

1396 
ªtvÆ
 = 
C_ERR
;

1400 
øxIãøt‹
 
ri
;

1401 
	`øxSèπ
(&
ri
,
U£rs
);

1402 
	`øxSìk
(&
ri
,"^",
NULL
,0);

1403 
	`øxNext
(&
ri
)) {

1404 
u£r
 *
u
 = 
ri
.
d©a
;

1406 
sds
 
u£r
 = 
	`sd¢ew
("user ");

1407 
u£r
 = 
	`sdsˇtsds
(u£r,
u
->
«me
);

1408 
u£r
 = 
	`sdsˇéí
(user," ",1);

1409 
sds
 
des¸
 = 
	`ACLDes¸ibeU£r
(
u
);

1410 
u£r
 = 
	`sdsˇtsds
(u£r,
des¸
);

1411 
	`sds‰ì
(
des¸
);

1412 
a˛
 = 
	`sdsˇtsds
◊˛,
u£r
);

1413 
a˛
 = 
	`sdsˇéí
(acl,"\n",1);

1414 
	`sds‰ì
(
u£r
);

1416 
	`øxSt›
(&
ri
);

1419 
tmpfûíame
 = 
	`sd¢ew
(
fûíame
);

1420 
tmpfûíame
 = 
	`sdsˇtfmt
(tmpfilename,".tmp-%i-%I",

1421 ()
	`gëpid
(),()
	`m°ime
());

1422 i‡((
fd
 = 
	`›í
(
tmpfûíame
,
O_WRONLY
|
O_CREAT
,0644)) == -1) {

1423 
	`£rvîLog
(
LL_WARNING
,"OpeningÅemp ACL file for ACL SAVE: %s",

1424 
	`°ªº‹
(
î∫o
));

1425 
˛ónup
;

1429 i‡(
	`wrôe
(
fd
,
a˛
,
	`sd¶í
◊˛)Ë!(
ssize_t
)sdslen(acl)) {

1430 
	`£rvîLog
(
LL_WARNING
,"Writing ACL file for ACL SAVE: %s",

1431 
	`°ªº‹
(
î∫o
));

1432 
˛ónup
;

1434 
	`˛o£
(
fd
); fd = -1;

1437 i‡(
	`ª«me
(
tmpfûíame
,
fûíame
) == -1) {

1438 
	`£rvîLog
(
LL_WARNING
,"Renaming ACL file for ACL SAVE: %s",

1439 
	`°ªº‹
(
î∫o
));

1440 
˛ónup
;

1442 
	`sds‰ì
(
tmpfûíame
);Åmpfûíamê
NULL
;

1443 
ªtvÆ
 = 
C_OK
;

1445 
˛ónup
:

1446 i‡(
fd
 !-1Ë
	`˛o£
(fd);

1447 i‡(
tmpfûíame
Ë
	`u∆ök
(tmpfilename);

1448 
	`sds‰ì
(
tmpfûíame
);

1449 
	`sds‰ì
(
a˛
);

1450  
ªtvÆ
;

1451 
	}
}

1458 
	$ACLLﬂdU£rsAtSèπup
() {

1459 i‡(
£rvî
.
a˛_fûíame
[0] !'\0' && 
	`li°Lígth
(
U£rsToLﬂd
) != 0) {

1460 
	`£rvîLog
(
LL_WARNING
,

1466 
	`exô
(1);

1469 i‡(
	`ACLLﬂdC⁄figuªdU£rs
(Ë=
C_ERR
) {

1470 
	`£rvîLog
(
LL_WARNING
,

1472 
	`exô
(1);

1475 i‡(
£rvî
.
a˛_fûíame
[0] != '\0') {

1476 
sds
 
îr‹s
 = 
	`ACLLﬂdFromFûe
(
£rvî
.
a˛_fûíame
);

1477 i‡(
îr‹s
) {

1478 
	`£rvîLog
(
LL_WARNING
,

1479 "Ab‹tög Redi†°¨tu∞beˇu£ o‡ACLÉº‹s: %s", 
îr‹s
);

1480 
	`sds‰ì
(
îr‹s
);

1481 
	`exô
(1);

1484 
	}
}

1490 
	#ACL_LOG_CTX_TOPLEVEL
 0

	)

1491 
	#ACL_LOG_CTX_LUA
 1

	)

1492 
	#ACL_LOG_CTX_MULTI
 2

	)

1493 
	#ACL_LOG_GROUPING_MAX_TIME_DELTA
 60000

	)

1496 
	sACLLogE¡ry
 {

1497 
uöt64_t
 
	mcou¡
;

1498 
	mªas⁄
;

1499 
	mc⁄ãxt
;

1500 
sds
 
	mobje˘
;

1501 
sds
 
	mu£∫ame
;

1502 
m°ime_t
 
	m˘ime
;

1503 
sds
 
	mcöfo
;

1504 } 
	tACLLogE¡ry
;

1509 
	$ACLLogM©chE¡ry
(
ACLLogE¡ry
 *
a
, ACLLogE¡ry *
b
) {

1510 i‡(
a
->
ªas⁄
 !
b
->reason)  0;

1511 i‡(
a
->
c⁄ãxt
 !
b
->context)  0;

1512 
m°ime_t
 
dñè
 = 
a
->
˘ime
 - 
b
->ctime;

1513 i‡(
dñè
 < 0) delta = -delta;

1514 i‡(
dñè
 > 
ACL_LOG_GROUPING_MAX_TIME_DELTA
)  0;

1515 i‡(
	`sdscmp
(
a
->
obje˘
,
b
->object) != 0)  0;

1516 i‡(
	`sdscmp
(
a
->
u£∫ame
,
b
->username) != 0)  0;

1518 
	}
}

1521 
	$ACLFªeLogE¡ry
(*
À±r
) {

1522 
ACLLogE¡ry
 *
À
 = 
À±r
;

1523 
	`sds‰ì
(
À
->
obje˘
);

1524 
	`sds‰ì
(
À
->
u£∫ame
);

1525 
	`sds‰ì
(
À
->
cöfo
);

1526 
	`z‰ì
(
À
);

1527 
	}
}

1541 
	$addACLLogE¡ry
(
˛õ¡
 *
c
, 
ªas⁄
, 
keypos
, 
sds
 
u£∫ame
) {

1543 
ACLLogE¡ry
 *
À
 = 
	`zmÆloc
((*le));

1544 
À
->
cou¡
 = 1;

1545 
À
->
ªas⁄
 =Ñeason;

1546 
À
->
u£∫ame
 = 
	`sdsdup
(
ªas⁄
 =
ACL_DENIED_AUTH
 ? u£∫amê: 
c
->
u£r
->
«me
);

1547 
À
->
˘ime
 = 
	`m°ime
();

1549 
ªas⁄
) {

1550 
ACL_DENIED_CMD
: 
À
->
obje˘
 = 
	`sd¢ew
(
c
->
cmd
->
«me
); ;

1551 
ACL_DENIED_KEY
: 
À
->
obje˘
 = 
	`sd¢ew
(
c
->
¨gv
[
keypos
]->
±r
); ;

1552 
ACL_DENIED_AUTH
: 
À
->
obje˘
 = 
	`sd¢ew
(
c
->
¨gv
[0]->
±r
); ;

1553 : 
À
->
obje˘
 = 
	`sd£m±y
();

1556 
˛õ¡
 *
ªÆ˛õ¡
 = 
c
;

1557 i‡(
ªÆ˛õ¡
->
Êags
 & 
CLIENT_LUA
ËªÆ˛õ¡ = 
£rvî
.
lua_ˇŒî
;

1559 
À
->
cöfo
 = 
	`ˇtClõ¡InfoSåög
(
	`sd£m±y
(),
ªÆ˛õ¡
);

1560 i‡(
c
->
Êags
 & 
CLIENT_MULTI
) {

1561 
À
->
c⁄ãxt
 = 
ACL_LOG_CTX_MULTI
;

1562 } i‡(
c
->
Êags
 & 
CLIENT_LUA
) {

1563 
À
->
c⁄ãxt
 = 
ACL_LOG_CTX_LUA
;

1565 
À
->
c⁄ãxt
 = 
ACL_LOG_CTX_TOPLEVEL
;

1570 
tosˇn
 = 10;

1571 
li°Iãr
 
li
;

1572 
li°Node
 *
 
;

1573 
	`li°Rewöd
(
ACLLog
,&
li
);

1574 
ACLLogE¡ry
 *
m©ch
 = 
NULL
;

1575 
tosˇn
-- && (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

1576 
ACLLogE¡ry
 *
cuºít
 = 
	`li°NodeVÆue
(
 
);

1577 i‡(
	`ACLLogM©chE¡ry
(
cuºít
,
À
)) {

1578 
m©ch
 = 
cuºít
;

1579 
	`li°DñNode
(
ACLLog
,
 
);

1580 
	`li°AddNodeHód
(
ACLLog
,
cuºít
);

1587 i‡(
m©ch
) {

1590 
	`sds‰ì
(
m©ch
->
cöfo
);

1591 
m©ch
->
cöfo
 = 
À
->cinfo;

1592 
m©ch
->
˘ime
 = 
À
->ctime;

1593 
m©ch
->
cou¡
++;

1596 
À
->
cöfo
 = 
NULL
;

1597 
	`ACLFªeLogE¡ry
(
À
);

1601 
	`li°AddNodeHód
(
ACLLog
, 
À
);

1602 
	`li°Lígth
(
ACLLog
Ë> 
£rvî
.
a˛log_max_Àn
) {

1603 
li°Node
 *
 
 = 
	`li°La°
(
ACLLog
);

1604 
ACLLogE¡ry
 *
À
 = 
	`li°NodeVÆue
(
 
);

1605 
	`ACLFªeLogE¡ry
(
À
);

1606 
	`li°DñNode
(
ACLLog
,
 
);

1609 
	}
}

1629 
	$a˛Comm™d
(
˛õ¡
 *
c
) {

1630 *
sub
 = 
c
->
¨gv
[1]->
±r
;

1631 i‡(!
	`°rˇ£cmp
(
sub
,"£tu£r"Ë&& 
c
->
¨gc
 >= 3) {

1632 
sds
 
u£∫ame
 = 
c
->
¨gv
[2]->
±r
;

1634 i‡(
	`ACLSåögHasS∑˚s
(
u£∫ame
,
	`sd¶í
(username))) {

1635 
	`addRïlyEº‹F‹m©
(
c
,

1644 
u£r
 *
ãmpu
 = 
	`ACLCª©eU∆ökedU£r
();

1645 
u£r
 *
u
 = 
	`ACLGëU£rByName
(
u£∫ame
,
	`sd¶í
(username));

1646 i‡(
u
Ë
	`ACLC›yU£r
(
ãmpu
, u);

1648 
j
 = 3; j < 
c
->
¨gc
; j++) {

1649 i‡(
	`ACLSëU£r
(
ãmpu
,
c
->
¨gv
[
j
]->
±r
,
	`sd¶í
(c->¨gv[j]->±r)Ë!
C_OK
) {

1650 *
îrmsg
 = 
	`ACLSëU£rSåögEº‹
();

1651 
	`addRïlyEº‹F‹m©
(
c
,

1653 (*)
c
->
¨gv
[
j
]->
±r
, 
îrmsg
);

1655 
	`ACLFªeU£r
(
ãmpu
);

1661 i‡(!
u
Ëu = 
	`ACLCª©eU£r
(
u£∫ame
,
	`sd¶í
(username));

1662 
	`£rvîAs£π
(
u
 !
NULL
);

1663 
	`ACLC›yU£r
(
u
, 
ãmpu
);

1664 
	`ACLFªeU£r
(
ãmpu
);

1665 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1666 } i‡(!
	`°rˇ£cmp
(
sub
,"dñu£r"Ë&& 
c
->
¨gc
 >= 3) {

1667 
dñëed
 = 0;

1668 
j
 = 2; j < 
c
->
¨gc
; j++) {

1669 
sds
 
u£∫ame
 = 
c
->
¨gv
[
j
]->
±r
;

1670 i‡(!
	`°rcmp
(
u£∫ame
,"default")) {

1671 
	`addRïlyEº‹
(
c
,"The 'default' user cannot beÑemoved");

1676 
j
 = 2; j < 
c
->
¨gc
; j++) {

1677 
sds
 
u£∫ame
 = 
c
->
¨gv
[
j
]->
±r
;

1678 
u£r
 *
u
;

1679 i‡(
	`øxRemove
(
U£rs
,(*)
u£∫ame
,

1680 
	`sd¶í
(
u£∫ame
),

1681 (**)&
u
))

1683 
	`ACLFªeU£rAndKûlClõ¡s
(
u
);

1684 
dñëed
++;

1687 
	`addRïlyL⁄gL⁄g
(
c
,
dñëed
);

1688 } i‡(!
	`°rˇ£cmp
(
sub
,"gëu£r"Ë&& 
c
->
¨gc
 == 3) {

1689 
u£r
 *
u
 = 
	`ACLGëU£rByName
(
c
->
¨gv
[2]->
±r
,
	`sd¶í
(c->argv[2]->ptr));

1690 i‡(
u
 =
NULL
) {

1691 
	`addRïlyNuŒ
(
c
);

1695 
	`addRïlyM≠Lí
(
c
,4);

1698 
	`addRïlyBulkCSåög
(
c
,"flags");

1699 *
deÊí
 = 
	`addRïlyDe„ºedLí
(
c
);

1700 
numÊags
 = 0;

1701 
j
 = 0; 
ACLU£rFœgs
[j].
Êag
; j++) {

1702 i‡(
u
->
Êags
 & 
ACLU£rFœgs
[
j
].
Êag
) {

1703 
	`addRïlyBulkCSåög
(
c
,
ACLU£rFœgs
[
j
].
«me
);

1704 
numÊags
++;

1707 
	`£tDe„ºedSëLí
(
c
,
deÊí
,
numÊags
);

1710 
	`addRïlyBulkCSåög
(
c
,"passwords");

1711 
	`addRïlyAºayLí
(
c
,
	`li°Lígth
(
u
->
∑ssw‹ds
));

1712 
li°Iãr
 
li
;

1713 
li°Node
 *
 
;

1714 
	`li°Rewöd
(
u
->
∑ssw‹ds
,&
li
);

1715 (
 
 = 
	`li°Next
(&
li
))) {

1716 
sds
 
thi•ass
 = 
	`li°NodeVÆue
(
 
);

1717 
	`addRïlyBulkCBuf„r
(
c
,
thi•ass
,
	`sd¶í
(thispass));

1721 
	`addRïlyBulkCSåög
(
c
,"commands");

1722 
sds
 
cmddes¸
 = 
	`ACLDes¸ibeU£rComm™dRuÀs
(
u
);

1723 
	`addRïlyBulkSds
(
c
,
cmddes¸
);

1726 
	`addRïlyBulkCSåög
(
c
,"keys");

1727 i‡(
u
->
Êags
 & 
USER_FLAG_ALLKEYS
) {

1728 
	`addRïlyAºayLí
(
c
,1);

1729 
	`addRïlyBulkCBuf„r
(
c
,"*",1);

1731 
	`addRïlyAºayLí
(
c
,
	`li°Lígth
(
u
->
∑âîns
));

1732 
li°Iãr
 
li
;

1733 
li°Node
 *
 
;

1734 
	`li°Rewöd
(
u
->
∑âîns
,&
li
);

1735 (
 
 = 
	`li°Next
(&
li
))) {

1736 
sds
 
thi•©
 = 
	`li°NodeVÆue
(
 
);

1737 
	`addRïlyBulkCBuf„r
(
c
,
thi•©
,
	`sd¶í
(thispat));

1740 } i‡((!
	`°rˇ£cmp
(
sub
,"list") || !strcasecmp(sub,"users")) &&

1741 
c
->
¨gc
 == 2)

1743 
ju°«mes
 = !
	`°rˇ£cmp
(
sub
,"users");

1744 
	`addRïlyAºayLí
(
c
,
	`øxSize
(
U£rs
));

1745 
øxIãøt‹
 
ri
;

1746 
	`øxSèπ
(&
ri
,
U£rs
);

1747 
	`øxSìk
(&
ri
,"^",
NULL
,0);

1748 
	`øxNext
(&
ri
)) {

1749 
u£r
 *
u
 = 
ri
.
d©a
;

1750 i‡(
ju°«mes
) {

1751 
	`addRïlyBulkCBuf„r
(
c
,
u
->
«me
,
	`sd¶í
(u->name));

1754 
sds
 
c⁄fig
 = 
	`sd¢ew
("user ");

1755 
c⁄fig
 = 
	`sdsˇtsds
(c⁄fig,
u
->
«me
);

1756 
c⁄fig
 = 
	`sdsˇéí
(config," ",1);

1757 
sds
 
des¸
 = 
	`ACLDes¸ibeU£r
(
u
);

1758 
c⁄fig
 = 
	`sdsˇtsds
(c⁄fig,
des¸
);

1759 
	`sds‰ì
(
des¸
);

1760 
	`addRïlyBulkSds
(
c
,
c⁄fig
);

1763 
	`øxSt›
(&
ri
);

1764 } i‡(!
	`°rˇ£cmp
(
sub
,"whﬂmi"Ë&& 
c
->
¨gc
 == 2) {

1765 i‡(
c
->
u£r
 !
NULL
) {

1766 
	`addRïlyBulkCBuf„r
(
c
,c->
u£r
->
«me
,
	`sd¶í
(c->user->name));

1768 
	`addRïlyNuŒ
(
c
);

1770 } i‡(
£rvî
.
a˛_fûíame
[0] == '\0' &&

1771 (!
	`°rˇ£cmp
(
sub
,"load") || !strcasecmp(sub,"save")))

1773 
	`addRïlyEº‹
(
c
,"This Redis instance isÇot configuredÅo useán ACL file. You may wantÅo specify users viaÅhe ACL SETUSER commandándÅhen issueá CONFIG REWRITE (assuming you haveá Redis configuration file set) in orderÅo store users inÅhe Redis configuration.");

1775 } i‡(!
	`°rˇ£cmp
(
sub
,"lﬂd"Ë&& 
c
->
¨gc
 == 2) {

1776 
sds
 
îr‹s
 = 
	`ACLLﬂdFromFûe
(
£rvî
.
a˛_fûíame
);

1777 i‡(
îr‹s
 =
NULL
) {

1778 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1780 
	`addRïlyEº‹
(
c
,
îr‹s
);

1781 
	`sds‰ì
(
îr‹s
);

1783 } i‡(!
	`°rˇ£cmp
(
sub
,"ßve"Ë&& 
c
->
¨gc
 == 2) {

1784 i‡(
	`ACLSaveToFûe
(
£rvî
.
a˛_fûíame
Ë=
C_OK
) {

1785 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1787 
	`addRïlyEº‹
(
c
,"There wasánÉrrorÅryingÅo saveÅhe ACLs. "

1791 } i‡(!
	`°rˇ£cmp
(
sub
,"ˇt"Ë&& 
c
->
¨gc
 == 2) {

1792 *
dl
 = 
	`addRïlyDe„ºedLí
(
c
);

1793 
j
;

1794 
j
 = 0; 
ACLComm™dC©eg‹õs
[j].
Êag
 != 0; j++)

1795 
	`addRïlyBulkCSåög
(
c
,
ACLComm™dC©eg‹õs
[
j
].
«me
);

1796 
	`£tDe„ºedAºayLí
(
c
,
dl
,
j
);

1797 } i‡(!
	`°rˇ£cmp
(
sub
,"ˇt"Ë&& 
c
->
¨gc
 == 3) {

1798 
uöt64_t
 
cÊag
 = 
	`ACLGëComm™dC©eg‹yFœgByName
(
c
->
¨gv
[2]->
±r
);

1799 i‡(
cÊag
 == 0) {

1800 
	`addRïlyEº‹F‹m©
(
c
, "Unknow¿ˇãg‹y '%s'", (*)c->
¨gv
[2]->
±r
);

1803 
¨øyÀn
 = 0;

1804 *
dl
 = 
	`addRïlyDe„ºedLí
(
c
);

1805 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
‹ig_comm™ds
);

1806 
di˘E¡ry
 *
de
;

1807 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1808 
ªdisComm™d
 *
cmd
 = 
	`di˘GëVÆ
(
de
);

1809 i‡(
cmd
->
Êags
 & 
CMD_MODULE
) ;

1810 i‡(
cmd
->
Êags
 & 
cÊag
) {

1811 
	`addRïlyBulkCSåög
(
c
,
cmd
->
«me
);

1812 
¨øyÀn
++;

1815 
	`di˘Rñó£Iãøt‹
(
di
);

1816 
	`£tDe„ºedAºayLí
(
c
,
dl
,
¨øyÀn
);

1817 } i‡(!
	`°rˇ£cmp
(
sub
,"gí∑ss"Ë&& (
c
->
¨gc
 == 2 || c->argc == 3)) {

1818 
	#GENPASS_MAX_BITS
 4096

	)

1819 
∑ss
[
GENPASS_MAX_BITS
/8*2];

1820 
bôs
 = 256;

1822 i‡(
c
->
¨gc
 =3 && 
	`gëL⁄gFromObje˘OrRïly
(c,c->
¨gv
[2],&
bôs
,
NULL
)

1823 !
C_OK
) ;

1825 i‡(
bôs
 <0 || bô†> 
GENPASS_MAX_BITS
) {

1826 
	`addRïlyEº‹F‹m©
(
c
,

1829 "u∞tÿ%d",
GENPASS_MAX_BITS
);

1833 
ch¨s
 = (
bôs
+3)/4;

1834 
	`gëR™domHexCh¨s
(
∑ss
,
ch¨s
);

1835 
	`addRïlyBulkCBuf„r
(
c
,
∑ss
,
ch¨s
);

1836 } i‡(!
	`°rˇ£cmp
(
sub
,"log"Ë&& (
c
->
¨gc
 == 2 || c->argc ==3)) {

1837 
cou¡
 = 10;

1842 i‡(
c
->
¨gc
 == 3) {

1843 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"reset")) {

1844 
	`li°SëFªeMëhod
(
ACLLog
,
ACLFªeLogE¡ry
);

1845 
	`li°Em±y
(
ACLLog
);

1846 
	`li°SëFªeMëhod
(
ACLLog
,
NULL
);

1847 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1849 } i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
cou¡
,
NULL
)

1850 !
C_OK
)

1854 i‡(
cou¡
 < 0) count = 0;

1858 i‡((
size_t
)
cou¡
 > 
	`li°Lígth
(
ACLLog
))

1859 
cou¡
 = 
	`li°Lígth
(
ACLLog
);

1861 
	`addRïlyAºayLí
(
c
,
cou¡
);

1862 
li°Iãr
 
li
;

1863 
li°Node
 *
 
;

1864 
	`li°Rewöd
(
ACLLog
,&
li
);

1865 
m°ime_t
 
now
 = 
	`m°ime
();

1866 
cou¡
-- && (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

1867 
ACLLogE¡ry
 *
À
 = 
	`li°NodeVÆue
(
 
);

1868 
	`addRïlyM≠Lí
(
c
,7);

1869 
	`addRïlyBulkCSåög
(
c
,"count");

1870 
	`addRïlyL⁄gL⁄g
(
c
,
À
->
cou¡
);

1872 
	`addRïlyBulkCSåög
(
c
,"reason");

1873 *
ªas⁄°r
;

1874 
À
->
ªas⁄
) {

1875 
ACL_DENIED_CMD
: 
ªas⁄°r
="command"; ;

1876 
ACL_DENIED_KEY
: 
ªas⁄°r
="key"; ;

1877 
ACL_DENIED_AUTH
: 
ªas⁄°r
="auth"; ;

1878 : 
ªas⁄°r
="unknown";

1880 
	`addRïlyBulkCSåög
(
c
,
ªas⁄°r
);

1882 
	`addRïlyBulkCSåög
(
c
,"context");

1883 *
˘x°r
;

1884 
À
->
c⁄ãxt
) {

1885 
ACL_LOG_CTX_TOPLEVEL
: 
˘x°r
="toplevel"; ;

1886 
ACL_LOG_CTX_MULTI
: 
˘x°r
="multi"; ;

1887 
ACL_LOG_CTX_LUA
: 
˘x°r
="lua"; ;

1888 : 
˘x°r
="unknown";

1890 
	`addRïlyBulkCSåög
(
c
,
˘x°r
);

1892 
	`addRïlyBulkCSåög
(
c
,"object");

1893 
	`addRïlyBulkCBuf„r
(
c
,
À
->
obje˘
,
	`sd¶í
(le->object));

1894 
	`addRïlyBulkCSåög
(
c
,"username");

1895 
	`addRïlyBulkCBuf„r
(
c
,
À
->
u£∫ame
,
	`sd¶í
(le->username));

1896 
	`addRïlyBulkCSåög
(
c
,"age-seconds");

1897 
age
 = ()(
now
 - 
À
->
˘ime
)/1000;

1898 
	`addRïlyDoubÀ
(
c
,
age
);

1899 
	`addRïlyBulkCSåög
(
c
,"client-info");

1900 
	`addRïlyBulkCBuf„r
(
c
,
À
->
cöfo
,
	`sd¶í
(le->cinfo));

1902 } i‡(!
	`°rˇ£cmp
(
sub
,"help")) {

1903 c⁄° *
hñp
[] = {

1916 
NULL


1918 
	`addRïlyHñp
(
c
,
hñp
);

1920 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

1922 
	}
}

1924 
	$addRïlyComm™dC©eg‹õs
(
˛õ¡
 *
c
, 
ªdisComm™d
 *
cmd
) {

1925 
Êagcou¡
 = 0;

1926 *
ÊagÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

1927 
j
 = 0; 
ACLComm™dC©eg‹õs
[j].
Êag
 != 0; j++) {

1928 i‡(
cmd
->
Êags
 & 
ACLComm™dC©eg‹õs
[
j
].
Êag
) {

1929 
	`addRïlySètusF‹m©
(
c
, "@%s", 
ACLComm™dC©eg‹õs
[
j
].
«me
);

1930 
Êagcou¡
++;

1933 
	`£tDe„ºedSëLí
(
c
, 
ÊagÀn
, 
Êagcou¡
);

1934 
	}
}

1941 
	$authComm™d
(
˛õ¡
 *
c
) {

1943 i‡(
c
->
¨gc
 > 3) {

1944 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

1950 
robj
 *
u£∫ame
, *
∑ssw‹d
;

1951 i‡(
c
->
¨gc
 == 2) {

1954 i‡(
DeÁu…U£r
->
Êags
 & 
USER_FLAG_NOPASS
) {

1955 
	`addRïlyEº‹
(
c
,"AUTH <password> called withoutányÖassword "

1961 
u£∫ame
 = 
	`¸óãSåögObje˘
("default",7);

1962 
∑ssw‹d
 = 
c
->
¨gv
[1];

1964 
u£∫ame
 = 
c
->
¨gv
[1];

1965 
∑ssw‹d
 = 
c
->
¨gv
[2];

1968 i‡(
	`ACLAuthítiˇãU£r
(
c
,
u£∫ame
,
∑ssw‹d
Ë=
C_OK
) {

1969 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1971 
	`addRïlyEº‹
(
c
,"-WRONGPASS invalid username-passwordÖair");

1976 i‡(
c
->
¨gc
 =2Ë
	`de¸RefCou¡
(
u£∫ame
);

1977 
	}
}

	@adlist.c

32 
	~<°dlib.h
>

33 
	~"adli°.h
"

34 
	~"zmÆloc.h
"

41 
li°
 *
	$li°Cª©e
()

43 
li°
 *list;

45 i‡((
li°
 = 
	`zmÆloc
((*li°))Ë=
NULL
)

46  
NULL
;

47 
li°
->
hód
 =Üi°->
èû
 = 
NULL
;

48 
li°
->
Àn
 = 0;

49 
li°
->
dup
 = 
NULL
;

50 
li°
->
‰ì
 = 
NULL
;

51 
li°
->
m©ch
 = 
NULL
;

52  
li°
;

53 
	}
}

56 
	$li°Em±y
(
li°
 *list)

58 
Àn
;

59 
li°Node
 *
cuºít
, *
√xt
;

61 
cuºít
 = 
li°
->
hód
;

62 
Àn
 = 
li°
->len;

63 
Àn
--) {

64 
√xt
 = 
cuºít
->next;

65 i‡(
li°
->
‰ì
Ëli°->
	`‰ì
(
cuºít
->
vÆue
);

66 
	`z‰ì
(
cuºít
);

67 
cuºít
 = 
√xt
;

69 
li°
->
hód
 =Üi°->
èû
 = 
NULL
;

70 
li°
->
Àn
 = 0;

71 
	}
}

76 
	$li°Rñó£
(
li°
 *list)

78 
	`li°Em±y
(
li°
);

79 
	`z‰ì
(
li°
);

80 
	}
}

88 
li°
 *
	$li°AddNodeHód
(
li°
 *li°, *
vÆue
)

90 
li°Node
 *
node
;

92 i‡((
node
 = 
	`zmÆloc
((*node))Ë=
NULL
)

93  
NULL
;

94 
node
->
vÆue
 = value;

95 i‡(
li°
->
Àn
 == 0) {

96 
li°
->
hód
 =Üi°->
èû
 = 
node
;

97 
node
->
¥ev
 =Çode->
√xt
 = 
NULL
;

99 
node
->
¥ev
 = 
NULL
;

100 
node
->
√xt
 = 
li°
->
hód
;

101 
li°
->
hód
->
¥ev
 = 
node
;

102 
li°
->
hód
 = 
node
;

104 
li°
->
Àn
++;

105  
li°
;

106 
	}
}

114 
li°
 *
	$li°AddNodeTaû
(
li°
 *li°, *
vÆue
)

116 
li°Node
 *
node
;

118 i‡((
node
 = 
	`zmÆloc
((*node))Ë=
NULL
)

119  
NULL
;

120 
node
->
vÆue
 = value;

121 i‡(
li°
->
Àn
 == 0) {

122 
li°
->
hód
 =Üi°->
èû
 = 
node
;

123 
node
->
¥ev
 =Çode->
√xt
 = 
NULL
;

125 
node
->
¥ev
 = 
li°
->
èû
;

126 
node
->
√xt
 = 
NULL
;

127 
li°
->
èû
->
√xt
 = 
node
;

128 
li°
->
èû
 = 
node
;

130 
li°
->
Àn
++;

131  
li°
;

132 
	}
}

134 
li°
 *
	$li°In£πNode
(
li°
 *li°, 
li°Node
 *
ﬁd_node
, *
vÆue
, 
a·î
) {

135 
li°Node
 *
node
;

137 i‡((
node
 = 
	`zmÆloc
((*node))Ë=
NULL
)

138  
NULL
;

139 
node
->
vÆue
 = value;

140 i‡(
a·î
) {

141 
node
->
¥ev
 = 
ﬁd_node
;

142 
node
->
√xt
 = 
ﬁd_node
->next;

143 i‡(
li°
->
èû
 =
ﬁd_node
) {

144 
li°
->
èû
 = 
node
;

147 
node
->
√xt
 = 
ﬁd_node
;

148 
node
->
¥ev
 = 
ﬁd_node
->prev;

149 i‡(
li°
->
hód
 =
ﬁd_node
) {

150 
li°
->
hód
 = 
node
;

153 i‡(
node
->
¥ev
 !
NULL
) {

154 
node
->
¥ev
->
√xt
 =Çode;

156 i‡(
node
->
√xt
 !
NULL
) {

157 
node
->
√xt
->
¥ev
 =Çode;

159 
li°
->
Àn
++;

160  
li°
;

161 
	}
}

167 
	$li°DñNode
(
li°
 *li°, 
li°Node
 *
node
)

169 i‡(
node
->
¥ev
)

170 
node
->
¥ev
->
√xt
 =Çode->next;

172 
li°
->
hód
 = 
node
->
√xt
;

173 i‡(
node
->
√xt
)

174 
node
->
√xt
->
¥ev
 =Çode->prev;

176 
li°
->
èû
 = 
node
->
¥ev
;

177 i‡(
li°
->
‰ì
Ëli°->
	`‰ì
(
node
->
vÆue
);

178 
	`z‰ì
(
node
);

179 
li°
->
Àn
--;

180 
	}
}

186 
li°Iãr
 *
	$li°GëIãøt‹
(
li°
 *li°, 
dúe˘i⁄
)

188 
li°Iãr
 *
ôî
;

190 i‡((
ôî
 = 
	`zmÆloc
((*ôî))Ë=
NULL
)  NULL;

191 i‡(
dúe˘i⁄
 =
AL_START_HEAD
)

192 
ôî
->
√xt
 = 
li°
->
hód
;

194 
ôî
->
√xt
 = 
li°
->
èû
;

195 
ôî
->
dúe˘i⁄
 = direction;

196  
ôî
;

197 
	}
}

200 
	$li°Rñó£Iãøt‹
(
li°Iãr
 *
ôî
) {

201 
	`z‰ì
(
ôî
);

202 
	}
}

205 
	$li°Rewöd
(
li°
 *li°, 
li°Iãr
 *
li
) {

206 
li
->
√xt
 = 
li°
->
hód
;

207 
li
->
dúe˘i⁄
 = 
AL_START_HEAD
;

208 
	}
}

210 
	$li°RewödTaû
(
li°
 *li°, 
li°Iãr
 *
li
) {

211 
li
->
√xt
 = 
li°
->
èû
;

212 
li
->
dúe˘i⁄
 = 
AL_START_TAIL
;

213 
	}
}

229 
li°Node
 *
	$li°Next
(
li°Iãr
 *
ôî
)

231 
li°Node
 *
cuºít
 = 
ôî
->
√xt
;

233 i‡(
cuºít
 !
NULL
) {

234 i‡(
ôî
->
dúe˘i⁄
 =
AL_START_HEAD
)

235 
ôî
->
√xt
 = 
cuºít
->next;

237 
ôî
->
√xt
 = 
cuºít
->
¥ev
;

239  
cuºít
;

240 
	}
}

250 
li°
 *
	$li°Dup
(
li°
 *
‹ig
)

252 
li°
 *
c›y
;

253 
li°Iãr
 
ôî
;

254 
li°Node
 *
node
;

256 i‡((
c›y
 = 
	`li°Cª©e
()Ë=
NULL
)

257  
NULL
;

258 
c›y
->
dup
 = 
‹ig
->dup;

259 
c›y
->
‰ì
 = 
‹ig
->free;

260 
c›y
->
m©ch
 = 
‹ig
->match;

261 
	`li°Rewöd
(
‹ig
, &
ôî
);

262 (
node
 = 
	`li°Next
(&
ôî
)Ë!
NULL
) {

263 *
vÆue
;

265 i‡(
c›y
->
dup
) {

266 
vÆue
 = 
c›y
->
	`dup
(
node
->value);

267 i‡(
vÆue
 =
NULL
) {

268 
	`li°Rñó£
(
c›y
);

269  
NULL
;

272 
vÆue
 = 
node
->value;

273 i‡(
	`li°AddNodeTaû
(
c›y
, 
vÆue
Ë=
NULL
) {

274 
	`li°Rñó£
(
c›y
);

275  
NULL
;

278  
c›y
;

279 
	}
}

290 
li°Node
 *
	$li°SórchKey
(
li°
 *li°, *
key
)

292 
li°Iãr
 
ôî
;

293 
li°Node
 *
node
;

295 
	`li°Rewöd
(
li°
, &
ôî
);

296 (
node
 = 
	`li°Next
(&
ôî
)Ë!
NULL
) {

297 i‡(
li°
->
m©ch
) {

298 i‡(
li°
->
	`m©ch
(
node
->
vÆue
, 
key
)) {

299  
node
;

302 i‡(
key
 =
node
->
vÆue
) {

303  
node
;

307  
NULL
;

308 
	}
}

315 
li°Node
 *
	$li°Index
(
li°
 *li°, 
ödex
) {

316 
li°Node
 *
n
;

318 i‡(
ödex
 < 0) {

319 
ödex
 = (-index)-1;

320 
n
 = 
li°
->
èû
;

321 
ödex
-- && 
n
Ë¿n->
¥ev
;

323 
n
 = 
li°
->
hód
;

324 
ödex
-- && 
n
Ë¿n->
√xt
;

326  
n
;

327 
	}
}

330 
	$li°RŸ©eTaûToHód
(
li°
 *list) {

331 i‡(
	`li°Lígth
(
li°
) <= 1) ;

334 
li°Node
 *
èû
 = 
li°
->tail;

335 
li°
->
èû
 =Åaû->
¥ev
;

336 
li°
->
èû
->
√xt
 = 
NULL
;

338 
li°
->
hód
->
¥ev
 = 
èû
;

339 
èû
->
¥ev
 = 
NULL
;

340 
èû
->
√xt
 = 
li°
->
hód
;

341 
li°
->
hód
 = 
èû
;

342 
	}
}

345 
	$li°RŸ©eHódToTaû
(
li°
 *list) {

346 i‡(
	`li°Lígth
(
li°
) <= 1) ;

348 
li°Node
 *
hód
 = 
li°
->head;

350 
li°
->
hód
 = hód->
√xt
;

351 
li°
->
hód
->
¥ev
 = 
NULL
;

353 
li°
->
èû
->
√xt
 = 
hód
;

354 
hód
->
√xt
 = 
NULL
;

355 
hód
->
¥ev
 = 
li°
->
èû
;

356 
li°
->
èû
 = 
hód
;

357 
	}
}

361 
	$li°Joö
(
li°
 *
l
,Üi° *
o
) {

362 i‡(
o
->
hód
)

363 
o
->
hód
->
¥ev
 = 
l
->
èû
;

365 i‡(
l
->
èû
)

366 
l
->
èû
->
√xt
 = 
o
->
hód
;

368 
l
->
hód
 = 
o
->head;

370 i‡(
o
->
èû
Ë
l
->tail = o->tail;

371 
l
->
Àn
 +
o
->len;

374 
o
->
hód
 = o->
èû
 = 
NULL
;

375 
o
->
Àn
 = 0;

376 
	}
}

	@adlist.h

31 #i‚de‡
__ADLIST_H__


32 
	#__ADLIST_H__


	)

36 
	sli°Node
 {

37 
li°Node
 *
	m¥ev
;

38 
li°Node
 *
	m√xt
;

39 *
	mvÆue
;

40 } 
	tli°Node
;

42 
	sli°Iãr
 {

43 
li°Node
 *
	m√xt
;

44 
	mdúe˘i⁄
;

45 } 
	tli°Iãr
;

47 
	sli°
 {

48 
li°Node
 *
	mhód
;

49 
li°Node
 *
	mèû
;

50 *(*
	mdup
)(*
	m±r
);

51 (*
	m‰ì
)(*
	m±r
);

52 (*
	mm©ch
)(*
	m±r
, *
	mkey
);

53 
	mÀn
;

54 } 
	tli°
;

57 
	#li°Lígth
(
l
Ë(÷)->
Àn
)

	)

58 
	#li°Fú°
(
l
Ë(÷)->
hód
)

	)

59 
	#li°La°
(
l
Ë(÷)->
èû
)

	)

60 
	#li°PªvNode
(
n
Ë(“)->
¥ev
)

	)

61 
	#li°NextNode
(
n
Ë(“)->
√xt
)

	)

62 
	#li°NodeVÆue
(
n
Ë(“)->
vÆue
)

	)

64 
	#li°SëDupMëhod
(
l
,
m
Ë(÷)->
dup
 = (m))

	)

65 
	#li°SëFªeMëhod
(
l
,
m
Ë(÷)->
‰ì
 = (m))

	)

66 
	#li°SëM©chMëhod
(
l
,
m
Ë(÷)->
m©ch
 = (m))

	)

68 
	#li°GëDupMëhod
(
l
Ë(÷)->
dup
)

	)

69 
	#li°GëFªeMëhod
(
l
Ë(÷)->
‰ì
)

	)

70 
	#li°GëM©chMëhod
(
l
Ë(÷)->
m©ch
)

	)

73 
li°
 *
li°Cª©e
();

74 
li°Rñó£
(
li°
 *list);

75 
li°Em±y
(
li°
 *list);

76 
li°
 *
li°AddNodeHód
÷i° *li°, *
vÆue
);

77 
li°
 *
li°AddNodeTaû
÷i° *li°, *
vÆue
);

78 
li°
 *
li°In£πNode
÷i° *li°, 
li°Node
 *
ﬁd_node
, *
vÆue
, 
a·î
);

79 
li°DñNode
(
li°
 *li°, 
li°Node
 *
node
);

80 
li°Iãr
 *
li°GëIãøt‹
(
li°
 *li°, 
dúe˘i⁄
);

81 
li°Node
 *
li°Next
(
li°Iãr
 *
ôî
);

82 
li°Rñó£Iãøt‹
(
li°Iãr
 *
ôî
);

83 
li°
 *
li°Dup
÷i° *
‹ig
);

84 
li°Node
 *
li°SórchKey
(
li°
 *li°, *
key
);

85 
li°Node
 *
li°Index
(
li°
 *li°, 
ödex
);

86 
li°Rewöd
(
li°
 *li°, 
li°Iãr
 *
li
);

87 
li°RewödTaû
(
li°
 *li°, 
li°Iãr
 *
li
);

88 
li°RŸ©eTaûToHód
(
li°
 *list);

89 
li°RŸ©eHódToTaû
(
li°
 *list);

90 
li°Joö
(
li°
 *
l
,Üi° *
o
);

93 
	#AL_START_HEAD
 0

	)

94 
	#AL_START_TAIL
 1

	)

	@ae.c

33 
	~<°dio.h
>

34 
	~<sys/time.h
>

35 
	~<sys/ty≥s.h
>

36 
	~<uni°d.h
>

37 
	~<°dlib.h
>

38 
	~<pﬁl.h
>

39 
	~<°rög.h
>

40 
	~<time.h
>

41 
	~<î∫o.h
>

43 
	~"´.h
"

44 
	~"zmÆloc.h
"

45 
	~"c⁄fig.h
"

49 #ifde‡
HAVE_EVPORT


50 
	~"´_evp‹t.c
"

52 #ifde‡
HAVE_EPOLL


53 
	~"´_ïﬁl.c
"

55 #ifde‡
HAVE_KQUEUE


56 
	~"´_kqueue.c
"

58 
	~"´_£À˘.c
"

63 
´EvítLo›
 *
	$´Cª©eEvítLo›
(
£tsize
) {

64 
´EvítLo›
 *
evítLo›
;

65 
i
;

67 i‡((
evítLo›
 = 
	`zmÆloc
((*evítLo›))Ë=
NULL
Ë
îr
;

68 
evítLo›
->
evíts
 = 
	`zmÆloc
((
´FûeEvít
)*
£tsize
);

69 
evítLo›
->
fúed
 = 
	`zmÆloc
((
´FúedEvít
)*
£tsize
);

70 i‡(
evítLo›
->
evíts
 =
NULL
 ||ÉvítLo›->
fúed
 =NULLË
îr
;

71 
evítLo›
->
£tsize
 = setsize;

72 
evítLo›
->
œ°Time
 = 
	`time
(
NULL
);

73 
evítLo›
->
timeEvítHód
 = 
NULL
;

74 
evítLo›
->
timeEvítNextId
 = 0;

75 
evítLo›
->
°›
 = 0;

76 
evítLo›
->
maxfd
 = -1;

77 
evítLo›
->
bef‹e¶ìp
 = 
NULL
;

78 
evítLo›
->
a·î¶ìp
 = 
NULL
;

79 
evítLo›
->
Êags
 = 0;

80 i‡(
	`´ApiCª©e
(
evítLo›
Ë=-1Ë
îr
;

83 
i
 = 0; i < 
£tsize
; i++)

84 
evítLo›
->
evíts
[
i
].
mask
 = 
AE_NONE
;

85  
evítLo›
;

87 
îr
:

88 i‡(
evítLo›
) {

89 
	`z‰ì
(
evítLo›
->
evíts
);

90 
	`z‰ì
(
evítLo›
->
fúed
);

91 
	`z‰ì
(
evítLo›
);

93  
NULL
;

94 
	}
}

97 
	$´GëSëSize
(
´EvítLo›
 *
evítLo›
) {

98  
evítLo›
->
£tsize
;

99 
	}
}

102 
	$´SëD⁄tWaô
(
´EvítLo›
 *
evítLo›
, 
noWaô
) {

103 i‡(
noWaô
)

104 
evítLo›
->
Êags
 |
AE_DONT_WAIT
;

106 
evítLo›
->
Êags
 &~
AE_DONT_WAIT
;

107 
	}
}

116 
	$´ResizeSëSize
(
´EvítLo›
 *
evítLo›
, 
£tsize
) {

117 
i
;

119 i‡(
£tsize
 =
evítLo›
->£tsizeË 
AE_OK
;

120 i‡(
evítLo›
->
maxfd
 >
£tsize
Ë 
AE_ERR
;

121 i‡(
	`´ApiResize
(
evítLo›
,
£tsize
Ë=-1Ë 
AE_ERR
;

123 
evítLo›
->
evíts
 = 
	`zªÆloc
”vítLo›->evíts,(
´FûeEvít
)*
£tsize
);

124 
evítLo›
->
fúed
 = 
	`zªÆloc
”vítLo›->fúed,(
´FúedEvít
)*
£tsize
);

125 
evítLo›
->
£tsize
 = setsize;

129 
i
 = 
evítLo›
->
maxfd
+1; i < 
£tsize
; i++)

130 
evítLo›
->
evíts
[
i
].
mask
 = 
AE_NONE
;

131  
AE_OK
;

132 
	}
}

134 
	$´DñëeEvítLo›
(
´EvítLo›
 *
evítLo›
) {

135 
	`´ApiFªe
(
evítLo›
);

136 
	`z‰ì
(
evítLo›
->
evíts
);

137 
	`z‰ì
(
evítLo›
->
fúed
);

140 
´TimeEvít
 *
√xt_ã
, *
ã
 = 
evítLo›
->
timeEvítHód
;

141 
ã
) {

142 
√xt_ã
 = 
ã
->
√xt
;

143 
	`z‰ì
(
ã
);

144 
ã
 = 
√xt_ã
;

146 
	`z‰ì
(
evítLo›
);

147 
	}
}

149 
	$´St›
(
´EvítLo›
 *
evítLo›
) {

150 
evítLo›
->
°›
 = 1;

151 
	}
}

153 
	$´Cª©eFûeEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
,

154 
´FûeProc
 *
¥oc
, *
˛õ¡D©a
)

156 i‡(
fd
 >
evítLo›
->
£tsize
) {

157 
î∫o
 = 
ERANGE
;

158  
AE_ERR
;

160 
´FûeEvít
 *
„
 = &
evítLo›
->
evíts
[
fd
];

162 i‡(
	`´ApiAddEvít
(
evítLo›
, 
fd
, 
mask
) == -1)

163  
AE_ERR
;

164 
„
->
mask
 |= mask;

165 i‡(
mask
 & 
AE_READABLE
Ë
„
->
rfûeProc
 = 
¥oc
;

166 i‡(
mask
 & 
AE_WRITABLE
Ë
„
->
wfûeProc
 = 
¥oc
;

167 
„
->
˛õ¡D©a
 = clientData;

168 i‡(
fd
 > 
evítLo›
->
maxfd
)

169 
evítLo›
->
maxfd
 = 
fd
;

170  
AE_OK
;

171 
	}
}

173 
	$´DñëeFûeEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
)

175 i‡(
fd
 >
evítLo›
->
£tsize
) ;

176 
´FûeEvít
 *
„
 = &
evítLo›
->
evíts
[
fd
];

177 i‡(
„
->
mask
 =
AE_NONE
) ;

181 i‡(
mask
 & 
AE_WRITABLE
Ëmask |
AE_BARRIER
;

183 
	`´ApiDñEvít
(
evítLo›
, 
fd
, 
mask
);

184 
„
->
mask
 = fe->mask & (~mask);

185 i‡(
fd
 =
evítLo›
->
maxfd
 && 
„
->
mask
 =
AE_NONE
) {

187 
j
;

189 
j
 = 
evítLo›
->
maxfd
-1; j >= 0; j--)

190 i‡(
evítLo›
->
evíts
[
j
].
mask
 !
AE_NONE
) ;

191 
evítLo›
->
maxfd
 = 
j
;

193 
	}
}

195 
	$´GëFûeEvíts
(
´EvítLo›
 *
evítLo›
, 
fd
) {

196 i‡(
fd
 >
evítLo›
->
£tsize
)  0;

197 
´FûeEvít
 *
„
 = &
evítLo›
->
evíts
[
fd
];

199  
„
->
mask
;

200 
	}
}

202 
	$´GëTime
(*
£c⁄ds
, *
mûli£c⁄ds
)

204 
timevÆ
 
tv
;

206 
	`gëtimeofday
(&
tv
, 
NULL
);

207 *
£c⁄ds
 = 
tv
.
tv_£c
;

208 *
mûli£c⁄ds
 = 
tv
.
tv_u£c
/1000;

209 
	}
}

211 
	$´AddMûli£c⁄dsToNow
(
mûli£c⁄ds
, *
£c
, *
ms
) {

212 
cur_£c
, 
cur_ms
, 
whí_£c
, 
whí_ms
;

214 
	`´GëTime
(&
cur_£c
, &
cur_ms
);

215 
whí_£c
 = 
cur_£c
 + 
mûli£c⁄ds
/1000;

216 
whí_ms
 = 
cur_ms
 + 
mûli£c⁄ds
%1000;

217 i‡(
whí_ms
 >= 1000) {

218 
whí_£c
 ++;

219 
whí_ms
 -= 1000;

221 *
£c
 = 
whí_£c
;

222 *
ms
 = 
whí_ms
;

223 
	}
}

225 
	$´Cª©eTimeEvít
(
´EvítLo›
 *
evítLo›
, 
mûli£c⁄ds
,

226 
´TimeProc
 *
¥oc
, *
˛õ¡D©a
,

227 
´EvítFöÆizîProc
 *
föÆizîProc
)

229 
id
 = 
evítLo›
->
timeEvítNextId
++;

230 
´TimeEvít
 *
ã
;

232 
ã
 = 
	`zmÆloc
((*te));

233 i‡(
ã
 =
NULL
Ë 
AE_ERR
;

234 
ã
->
id
 = id;

235 
	`´AddMûli£c⁄dsToNow
(
mûli£c⁄ds
,&
ã
->
whí_£c
,&ã->
whí_ms
);

236 
ã
->
timeProc
 = 
¥oc
;

237 
ã
->
föÆizîProc
 = finalizerProc;

238 
ã
->
˛õ¡D©a
 = clientData;

239 
ã
->
¥ev
 = 
NULL
;

240 
ã
->
√xt
 = 
evítLo›
->
timeEvítHód
;

241 
ã
->
ªfcou¡
 = 0;

242 i‡(
ã
->
√xt
)

243 
ã
->
√xt
->
¥ev
 =Åe;

244 
evítLo›
->
timeEvítHód
 = 
ã
;

245  
id
;

246 
	}
}

248 
	$´DñëeTimeEvít
(
´EvítLo›
 *
evítLo›
, 
id
)

250 
´TimeEvít
 *
ã
 = 
evítLo›
->
timeEvítHód
;

251 
ã
) {

252 i‡(
ã
->
id
 == id) {

253 
ã
->
id
 = 
AE_DELETED_EVENT_ID
;

254  
AE_OK
;

256 
ã
 =Åe->
√xt
;

258  
AE_ERR
;

259 
	}
}

272 
´TimeEvít
 *
	$´SórchNóª°Timî
(
´EvítLo›
 *
evítLo›
)

274 
´TimeEvít
 *
ã
 = 
evítLo›
->
timeEvítHód
;

275 
´TimeEvít
 *
√¨e°
 = 
NULL
;

277 
ã
) {

278 i‡(!
√¨e°
 || 
ã
->
whí_£c
 <Çearest->when_sec ||

279 (
ã
->
whí_£c
 =
√¨e°
->when_sec &&

280 
ã
->
whí_ms
 < 
√¨e°
->when_ms))

281 
√¨e°
 = 
ã
;

282 
ã
 =Åe->
√xt
;

284  
√¨e°
;

285 
	}
}

288 
	$¥o˚ssTimeEvíts
(
´EvítLo›
 *
evítLo›
) {

289 
¥o˚s£d
 = 0;

290 
´TimeEvít
 *
ã
;

291 
maxId
;

292 
time_t
 
now
 = 
	`time
(
NULL
);

302 i‡(
now
 < 
evítLo›
->
œ°Time
) {

303 
ã
 = 
evítLo›
->
timeEvítHód
;

304 
ã
) {

305 
ã
->
whí_£c
 = 0;

306 
ã
 =Åe->
√xt
;

309 
evítLo›
->
œ°Time
 = 
now
;

311 
ã
 = 
evítLo›
->
timeEvítHód
;

312 
maxId
 = 
evítLo›
->
timeEvítNextId
-1;

313 
ã
) {

314 
now_£c
, 
now_ms
;

315 
id
;

318 i‡(
ã
->
id
 =
AE_DELETED_EVENT_ID
) {

319 
´TimeEvít
 *
√xt
 = 
ã
->next;

323 i‡(
ã
->
ªfcou¡
) {

324 
ã
 = 
√xt
;

327 i‡(
ã
->
¥ev
)

328 
ã
->
¥ev
->
√xt
 =Åe->next;

330 
evítLo›
->
timeEvítHód
 = 
ã
->
√xt
;

331 i‡(
ã
->
√xt
)

332 
ã
->
√xt
->
¥ev
 =Åe->prev;

333 i‡(
ã
->
föÆizîProc
)

334 
ã
->
	`föÆizîProc
(
evítLo›
,Åe->
˛õ¡D©a
);

335 
	`z‰ì
(
ã
);

336 
ã
 = 
√xt
;

345 i‡(
ã
->
id
 > 
maxId
) {

346 
ã
 =Åe->
√xt
;

349 
	`´GëTime
(&
now_£c
, &
now_ms
);

350 i‡(
now_£c
 > 
ã
->
whí_£c
 ||

351 (
now_£c
 =
ã
->
whí_£c
 && 
now_ms
 >ã->
whí_ms
))

353 
ªtvÆ
;

355 
id
 = 
ã
->id;

356 
ã
->
ªfcou¡
++;

357 
ªtvÆ
 = 
ã
->
	`timeProc
(
evítLo›
, 
id
,Åe->
˛õ¡D©a
);

358 
ã
->
ªfcou¡
--;

359 
¥o˚s£d
++;

360 i‡(
ªtvÆ
 !
AE_NOMORE
) {

361 
	`´AddMûli£c⁄dsToNow
(
ªtvÆ
,&
ã
->
whí_£c
,&ã->
whí_ms
);

363 
ã
->
id
 = 
AE_DELETED_EVENT_ID
;

366 
ã
 =Åe->
√xt
;

368  
¥o˚s£d
;

369 
	}
}

386 
	$´Pro˚ssEvíts
(
´EvítLo›
 *
evítLo›
, 
Êags
)

388 
¥o˚s£d
 = 0, 
numevíts
;

391 i‡(!(
Êags
 & 
AE_TIME_EVENTS
Ë&& !(Êag†& 
AE_FILE_EVENTS
))  0;

397 i‡(
evítLo›
->
maxfd
 != -1 ||

398 ((
Êags
 & 
AE_TIME_EVENTS
Ë&& !(Êag†& 
AE_DONT_WAIT
))) {

399 
j
;

400 
´TimeEvít
 *
sh‹ã°
 = 
NULL
;

401 
timevÆ
 
tv
, *
tvp
;

403 i‡(
Êags
 & 
AE_TIME_EVENTS
 && !(Êag†& 
AE_DONT_WAIT
))

404 
sh‹ã°
 = 
	`´SórchNóª°Timî
(
evítLo›
);

405 i‡(
sh‹ã°
) {

406 
now_£c
, 
now_ms
;

408 
	`´GëTime
(&
now_£c
, &
now_ms
);

409 
tvp
 = &
tv
;

413 
ms
 =

414 (
sh‹ã°
->
whí_£c
 - 
now_£c
)*1000 +

415 
sh‹ã°
->
whí_ms
 - 
now_ms
;

417 i‡(
ms
 > 0) {

418 
tvp
->
tv_£c
 = 
ms
/1000;

419 
tvp
->
tv_u£c
 = (
ms
 % 1000)*1000;

421 
tvp
->
tv_£c
 = 0;

422 
tvp
->
tv_u£c
 = 0;

428 i‡(
Êags
 & 
AE_DONT_WAIT
) {

429 
tv
.
tv_£c
 =Åv.
tv_u£c
 = 0;

430 
tvp
 = &
tv
;

433 
tvp
 = 
NULL
;

437 i‡(
evítLo›
->
Êags
 & 
AE_DONT_WAIT
) {

438 
tv
.
tv_£c
 =Åv.
tv_u£c
 = 0;

439 
tvp
 = &
tv
;

442 i‡(
evítLo›
->
bef‹e¶ìp
 !
NULL
 && 
Êags
 & 
AE_CALL_BEFORE_SLEEP
)

443 
evítLo›
->
	`bef‹e¶ìp
(eventLoop);

447 
numevíts
 = 
	`´ApiPﬁl
(
evítLo›
, 
tvp
);

450 i‡(
evítLo›
->
a·î¶ìp
 !
NULL
 && 
Êags
 & 
AE_CALL_AFTER_SLEEP
)

451 
evítLo›
->
	`a·î¶ìp
(eventLoop);

453 
j
 = 0; j < 
numevíts
; j++) {

454 
´FûeEvít
 *
„
 = &
evítLo›
->
evíts
[evítLo›->
fúed
[
j
].
fd
];

455 
mask
 = 
evítLo›
->
fúed
[
j
].mask;

456 
fd
 = 
evítLo›
->
fúed
[
j
].fd;

457 
fúed
 = 0;

470 
övît
 = 
„
->
mask
 & 
AE_BARRIER
;

478 i‡(!
övît
 && 
„
->
mask
 & mask & 
AE_READABLE
) {

479 
„
->
	`rfûeProc
(
evítLo›
,
fd
,„->
˛õ¡D©a
,
mask
);

480 
fúed
++;

481 
„
 = &
evítLo›
->
evíts
[
fd
];

485 i‡(
„
->
mask
 & mask & 
AE_WRITABLE
) {

486 i‡(!
fúed
 || 
„
->
wfûeProc
 !„->
rfûeProc
) {

487 
„
->
	`wfûeProc
(
evítLo›
,
fd
,„->
˛õ¡D©a
,
mask
);

488 
fúed
++;

494 i‡(
övît
) {

495 
„
 = &
evítLo›
->
evíts
[
fd
];

496 i‡((
„
->
mask
 & mask & 
AE_READABLE
) &&

497 (!
fúed
 || 
„
->
wfûeProc
 !„->
rfûeProc
))

499 
„
->
	`rfûeProc
(
evítLo›
,
fd
,„->
˛õ¡D©a
,
mask
);

500 
fúed
++;

504 
¥o˚s£d
++;

508 i‡(
Êags
 & 
AE_TIME_EVENTS
)

509 
¥o˚s£d
 +
	`¥o˚ssTimeEvíts
(
evítLo›
);

511  
¥o˚s£d
;

512 
	}
}

516 
	$´Waô
(
fd
, 
mask
, 
mûli£c⁄ds
) {

517 
pﬁlfd
 
pfd
;

518 
ªtmask
 = 0, 
ªtvÆ
;

520 
	`mem£t
(&
pfd
, 0, (pfd));

521 
pfd
.
fd
 = fd;

522 i‡(
mask
 & 
AE_READABLE
Ë
pfd
.
evíts
 |
POLLIN
;

523 i‡(
mask
 & 
AE_WRITABLE
Ë
pfd
.
evíts
 |
POLLOUT
;

525 i‡((
ªtvÆ
 = 
	`pﬁl
(&
pfd
, 1, 
mûli£c⁄ds
))== 1) {

526 i‡(
pfd
.
ªvíts
 & 
POLLIN
Ë
ªtmask
 |
AE_READABLE
;

527 i‡(
pfd
.
ªvíts
 & 
POLLOUT
Ë
ªtmask
 |
AE_WRITABLE
;

528 i‡(
pfd
.
ªvíts
 & 
POLLERR
Ë
ªtmask
 |
AE_WRITABLE
;

529 i‡(
pfd
.
ªvíts
 & 
POLLHUP
Ë
ªtmask
 |
AE_WRITABLE
;

530  
ªtmask
;

532  
ªtvÆ
;

534 
	}
}

536 
	$´Maö
(
´EvítLo›
 *
evítLo›
) {

537 
evítLo›
->
°›
 = 0;

538 !
evítLo›
->
°›
) {

539 
	`´Pro˚ssEvíts
(
evítLo›
, 
AE_ALL_EVENTS
|

540 
AE_CALL_BEFORE_SLEEP
|

541 
AE_CALL_AFTER_SLEEP
);

543 
	}
}

545 *
	$´GëApiName
() {

546  
	`´ApiName
();

547 
	}
}

549 
	$´SëBef‹eSÀïProc
(
´EvítLo›
 *
evítLo›
, 
´Bef‹eSÀïProc
 *
bef‹e¶ìp
) {

550 
evítLo›
->
bef‹e¶ìp
 = beforesleep;

551 
	}
}

553 
	$´SëA·îSÀïProc
(
´EvítLo›
 *
evítLo›
, 
´Bef‹eSÀïProc
 *
a·î¶ìp
) {

554 
evítLo›
->
a·î¶ìp
 =áftersleep;

555 
	}
}

	@ae.h

33 #i‚de‡
__AE_H__


34 
	#__AE_H__


	)

36 
	~<time.h
>

38 
	#AE_OK
 0

	)

39 
	#AE_ERR
 -1

	)

41 
	#AE_NONE
 0

	)

42 
	#AE_READABLE
 1

	)

43 
	#AE_WRITABLE
 2

	)

44 
	#AE_BARRIER
 4

	)

50 
	#AE_FILE_EVENTS
 (1<<0)

	)

51 
	#AE_TIME_EVENTS
 (1<<1)

	)

52 
	#AE_ALL_EVENTS
 (
AE_FILE_EVENTS
|
AE_TIME_EVENTS
)

	)

53 
	#AE_DONT_WAIT
 (1<<2)

	)

54 
	#AE_CALL_BEFORE_SLEEP
 (1<<3)

	)

55 
	#AE_CALL_AFTER_SLEEP
 (1<<4)

	)

57 
	#AE_NOMORE
 -1

	)

58 
	#AE_DELETED_EVENT_ID
 -1

	)

61 
	#AE_NOTUSED
(
V
Ë((ËV)

	)

63 
	g´EvítLo›
;

66 
	t´FûeProc
(
	t´EvítLo›
 *
	tevítLo›
, 
	tfd
, *
	t˛õ¡D©a
, 
	tmask
);

67 
	t´TimeProc
(
	t´EvítLo›
 *
	tevítLo›
, 
	tid
, *
	t˛õ¡D©a
);

68 
	t´EvítFöÆizîProc
(
	t´EvítLo›
 *
	tevítLo›
, *
	t˛õ¡D©a
);

69 
	t´Bef‹eSÀïProc
(
	t´EvítLo›
 *
	tevítLo›
);

72 
	s´FûeEvít
 {

73 
	mmask
;

74 
´FûeProc
 *
	mrfûeProc
;

75 
´FûeProc
 *
	mwfûeProc
;

76 *
	m˛õ¡D©a
;

77 } 
	t´FûeEvít
;

80 
	s´TimeEvít
 {

81 
	mid
;

82 
	mwhí_£c
;

83 
	mwhí_ms
;

84 
´TimeProc
 *
	mtimeProc
;

85 
´EvítFöÆizîProc
 *
	mföÆizîProc
;

86 *
	m˛õ¡D©a
;

87 
´TimeEvít
 *
	m¥ev
;

88 
´TimeEvít
 *
	m√xt
;

89 
	mªfcou¡
;

91 } 
	t´TimeEvít
;

94 
	s´FúedEvít
 {

95 
	mfd
;

96 
	mmask
;

97 } 
	t´FúedEvít
;

100 
	s´EvítLo›
 {

101 
	mmaxfd
;

102 
	m£tsize
;

103 
	mtimeEvítNextId
;

104 
time_t
 
	mœ°Time
;

105 
´FûeEvít
 *
	mevíts
;

106 
´FúedEvít
 *
	mfúed
;

107 
´TimeEvít
 *
	mtimeEvítHód
;

108 
	m°›
;

109 *
	m≠id©a
;

110 
´Bef‹eSÀïProc
 *
	mbef‹e¶ìp
;

111 
´Bef‹eSÀïProc
 *
	ma·î¶ìp
;

112 
	mÊags
;

113 } 
	t´EvítLo›
;

116 
´EvítLo›
 *
´Cª©eEvítLo›
(
£tsize
);

117 
´DñëeEvítLo›
(
´EvítLo›
 *
evítLo›
);

118 
´St›
(
´EvítLo›
 *
evítLo›
);

119 
´Cª©eFûeEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
,

120 
´FûeProc
 *
¥oc
, *
˛õ¡D©a
);

121 
´DñëeFûeEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
);

122 
´GëFûeEvíts
(
´EvítLo›
 *
evítLo›
, 
fd
);

123 
´Cª©eTimeEvít
(
´EvítLo›
 *
evítLo›
, 
mûli£c⁄ds
,

124 
´TimeProc
 *
¥oc
, *
˛õ¡D©a
,

125 
´EvítFöÆizîProc
 *
föÆizîProc
);

126 
´DñëeTimeEvít
(
´EvítLo›
 *
evítLo›
, 
id
);

127 
´Pro˚ssEvíts
(
´EvítLo›
 *
evítLo›
, 
Êags
);

128 
´Waô
(
fd
, 
mask
, 
mûli£c⁄ds
);

129 
´Maö
(
´EvítLo›
 *
evítLo›
);

130 *
´GëApiName
();

131 
´SëBef‹eSÀïProc
(
´EvítLo›
 *
evítLo›
, 
´Bef‹eSÀïProc
 *
bef‹e¶ìp
);

132 
´SëA·îSÀïProc
(
´EvítLo›
 *
evítLo›
, 
´Bef‹eSÀïProc
 *
a·î¶ìp
);

133 
´GëSëSize
(
´EvítLo›
 *
evítLo›
);

134 
´ResizeSëSize
(
´EvítLo›
 *
evítLo›
, 
£tsize
);

135 
´SëD⁄tWaô
(
´EvítLo›
 *
evítLo›
, 
noWaô
);

	@ae_epoll.c

32 
	~<sys/ïﬁl.h
>

34 
	s´ApiSèã
 {

35 
	mïfd
;

36 
ïﬁl_evít
 *
	mevíts
;

37 } 
	t´ApiSèã
;

39 
	$´ApiCª©e
(
´EvítLo›
 *
evítLo›
) {

40 
´ApiSèã
 *
°©e
 = 
	`zmÆloc
((aeApiState));

42 i‡(!
°©e
)  -1;

43 
°©e
->
evíts
 = 
	`zmÆloc
((
ïﬁl_evít
)*
evítLo›
->
£tsize
);

44 i‡(!
°©e
->
evíts
) {

45 
	`z‰ì
(
°©e
);

48 
°©e
->
ïfd
 = 
	`ïﬁl_¸óã
(1024);

49 i‡(
°©e
->
ïfd
 == -1) {

50 
	`z‰ì
(
°©e
->
evíts
);

51 
	`z‰ì
(
°©e
);

54 
evítLo›
->
≠id©a
 = 
°©e
;

56 
	}
}

58 
	$´ApiResize
(
´EvítLo›
 *
evítLo›
, 
£tsize
) {

59 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

61 
°©e
->
evíts
 = 
	`zªÆloc
(°©e->evíts, (
ïﬁl_evít
)*
£tsize
);

63 
	}
}

65 
	$´ApiFªe
(
´EvítLo›
 *
evítLo›
) {

66 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

68 
	`˛o£
(
°©e
->
ïfd
);

69 
	`z‰ì
(
°©e
->
evíts
);

70 
	`z‰ì
(
°©e
);

71 
	}
}

73 
	$´ApiAddEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
) {

74 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

75 
ïﬁl_evít
 
ì
 = {0};

78 
›
 = 
evítLo›
->
evíts
[
fd
].
mask
 =
AE_NONE
 ?

79 
EPOLL_CTL_ADD
 : 
EPOLL_CTL_MOD
;

81 
ì
.
evíts
 = 0;

82 
mask
 |
evítLo›
->
evíts
[
fd
].mask;

83 i‡(
mask
 & 
AE_READABLE
Ë
ì
.
evíts
 |
EPOLLIN
;

84 i‡(
mask
 & 
AE_WRITABLE
Ë
ì
.
evíts
 |
EPOLLOUT
;

85 
ì
.
d©a
.
fd
 = fd;

86 i‡(
	`ïﬁl_˘l
(
°©e
->
ïfd
,
›
,
fd
,&
ì
) == -1)  -1;

88 
	}
}

90 
	$´ApiDñEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
dñmask
) {

91 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

92 
ïﬁl_evít
 
ì
 = {0};

93 
mask
 = 
evítLo›
->
evíts
[
fd
].mask & (~
dñmask
);

95 
ì
.
evíts
 = 0;

96 i‡(
mask
 & 
AE_READABLE
Ë
ì
.
evíts
 |
EPOLLIN
;

97 i‡(
mask
 & 
AE_WRITABLE
Ë
ì
.
evíts
 |
EPOLLOUT
;

98 
ì
.
d©a
.
fd
 = fd;

99 i‡(
mask
 !
AE_NONE
) {

100 
	`ïﬁl_˘l
(
°©e
->
ïfd
,
EPOLL_CTL_MOD
,
fd
,&
ì
);

104 
	`ïﬁl_˘l
(
°©e
->
ïfd
,
EPOLL_CTL_DEL
,
fd
,&
ì
);

106 
	}
}

108 
	$´ApiPﬁl
(
´EvítLo›
 *
evítLo›
, 
timevÆ
 *
tvp
) {

109 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

110 
ªtvÆ
, 
numevíts
 = 0;

112 
ªtvÆ
 = 
	`ïﬁl_waô
(
°©e
->
ïfd
,°©e->
evíts
,
evítLo›
->
£tsize
,

113 
tvp
 ? (tvp->
tv_£c
*1000 +Åvp->
tv_u£c
/1000) : -1);

114 i‡(
ªtvÆ
 > 0) {

115 
j
;

117 
numevíts
 = 
ªtvÆ
;

118 
j
 = 0; j < 
numevíts
; j++) {

119 
mask
 = 0;

120 
ïﬁl_evít
 *
e
 = 
°©e
->
evíts
+
j
;

122 i‡(
e
->
evíts
 & 
EPOLLIN
Ë
mask
 |
AE_READABLE
;

123 i‡(
e
->
evíts
 & 
EPOLLOUT
Ë
mask
 |
AE_WRITABLE
;

124 i‡(
e
->
evíts
 & 
EPOLLERR
Ë
mask
 |
AE_WRITABLE
|
AE_READABLE
;

125 i‡(
e
->
evíts
 & 
EPOLLHUP
Ë
mask
 |
AE_WRITABLE
|
AE_READABLE
;

126 
evítLo›
->
fúed
[
j
].
fd
 = 
e
->
d©a
.fd;

127 
evítLo›
->
fúed
[
j
].
mask
 = mask;

130  
numevíts
;

131 
	}
}

133 *
	$´ApiName
() {

135 
	}
}

	@ae_evport.c

31 
	~<as£π.h
>

32 
	~<î∫o.h
>

33 
	~<p‹t.h
>

34 
	~<pﬁl.h
>

36 
	~<sys/ty≥s.h
>

37 
	~<sys/time.h
>

39 
	~<°dio.h
>

41 
	gevp‹t_debug
 = 0;

66 
	#MAX_EVENT_BATCHSZ
 512

	)

68 
	s´ApiSèã
 {

69 
	mp‹tfd
;

70 
	m≈ídög
;

71 
	m≥ndög_fds
[
MAX_EVENT_BATCHSZ
];

72 
	m≥ndög_masks
[
MAX_EVENT_BATCHSZ
];

73 } 
	t´ApiSèã
;

75 
	$´ApiCª©e
(
´EvítLo›
 *
evítLo›
) {

76 
i
;

77 
´ApiSèã
 *
°©e
 = 
	`zmÆloc
((aeApiState));

78 i‡(!
°©e
)  -1;

80 
°©e
->
p‹tfd
 = 
	`p‹t_¸óã
();

81 i‡(
°©e
->
p‹tfd
 == -1) {

82 
	`z‰ì
(
°©e
);

86 
°©e
->
≈ídög
 = 0;

88 
i
 = 0; i < 
MAX_EVENT_BATCHSZ
; i++) {

89 
°©e
->
≥ndög_fds
[
i
] = -1;

90 
°©e
->
≥ndög_masks
[
i
] = 
AE_NONE
;

93 
evítLo›
->
≠id©a
 = 
°©e
;

95 
	}
}

97 
	$´ApiResize
(
´EvítLo›
 *
evítLo›
, 
£tsize
) {

100 
	}
}

102 
	$´ApiFªe
(
´EvítLo›
 *
evítLo›
) {

103 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

105 
	`˛o£
(
°©e
->
p‹tfd
);

106 
	`z‰ì
(
°©e
);

107 
	}
}

109 
	$´ApiLookupPídög
(
´ApiSèã
 *
°©e
, 
fd
) {

110 
i
;

112 
i
 = 0; i < 
°©e
->
≈ídög
; i++) {

113 i‡(
°©e
->
≥ndög_fds
[
i
] =
fd
)

114  (
i
);

118 
	}
}

123 
	$´ApiAssocüã
(c⁄° *
whîe
, 
p‹tfd
, 
fd
, 
mask
) {

124 
evíts
 = 0;

125 
rv
, 
îr
;

127 i‡(
mask
 & 
AE_READABLE
)

128 
evíts
 |
POLLIN
;

129 i‡(
mask
 & 
AE_WRITABLE
)

130 
evíts
 |
POLLOUT
;

132 i‡(
evp‹t_debug
)

133 
	`Ârötf
(
°dîr
, "%s:Ö‹t_assocüã(%d, 0x%xË", 
whîe
, 
fd
, 
evíts
);

135 
rv
 = 
	`p‹t_assocüã
(
p‹tfd
, 
PORT_SOURCE_FD
, 
fd
, 
evíts
,

136 (*)(
uöçå_t
)
mask
);

137 
îr
 = 
î∫o
;

139 i‡(
evp‹t_debug
)

140 
	`Ârötf
(
°dîr
, "%d (%s)\n", 
rv
,Ñv =0 ? "nÿîr‹" : 
	`°ªº‹
(
îr
));

142 i‡(
rv
 == -1) {

143 
	`Ârötf
(
°dîr
, "%s:Ö‹t_assocüã: %s\n", 
whîe
, 
	`°ªº‹
(
îr
));

145 i‡(
îr
 =
EAGAIN
)

146 
	`Ârötf
(
°dîr
, "aeApiAssociate:ÉventÖortÜimitÉxceeded.");

149  
rv
;

150 
	}
}

152 
	$´ApiAddEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
) {

153 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

154 
fuŒmask
, 
pfd
;

156 i‡(
evp‹t_debug
)

157 
	`Ârötf
(
°dîr
, "´ApiAddEvít: fd %d mask 0x%x\n", 
fd
, 
mask
);

164 
fuŒmask
 = 
mask
 | 
evítLo›
->
evíts
[
fd
].mask;

165 
pfd
 = 
	`´ApiLookupPídög
(
°©e
, 
fd
);

167 i‡(
pfd
 != -1) {

174 i‡(
evp‹t_debug
)

175 
	`Ârötf
(
°dîr
, "´ApiAddEvít:áddögÅÿ≥ndög fd %d\n", 
fd
);

176 
°©e
->
≥ndög_masks
[
pfd
] |
fuŒmask
;

180  (
	`´ApiAssocüã
("´ApiAddEvít", 
°©e
->
p‹tfd
, 
fd
, 
fuŒmask
));

181 
	}
}

183 
	$´ApiDñEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
) {

184 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

185 
fuŒmask
, 
pfd
;

187 i‡(
evp‹t_debug
)

188 
	`Ârötf
(
°dîr
, "dñ fd %d mask 0x%x\n", 
fd
, 
mask
);

190 
pfd
 = 
	`´ApiLookupPídög
(
°©e
, 
fd
);

192 i‡(
pfd
 != -1) {

193 i‡(
evp‹t_debug
)

194 
	`Ârötf
(
°dîr
, "dñëögÉvíà‰omÖídög fd %d\n", 
fd
);

201 
°©e
->
≥ndög_masks
[
pfd
] &~
mask
;

203 i‡(
°©e
->
≥ndög_masks
[
pfd
] =
AE_NONE
)

204 
°©e
->
≥ndög_fds
[
pfd
] = -1;

217 
fuŒmask
 = 
evítLo›
->
evíts
[
fd
].
mask
;

218 i‡(
fuŒmask
 =
AE_NONE
) {

223 i‡(
evp‹t_debug
)

224 
	`Ârötf
(
°dîr
, "´ApiDñEvít:Ö‹t_dissocüã(%d)\n", 
fd
);

226 i‡(
	`p‹t_dissocüã
(
°©e
->
p‹tfd
, 
PORT_SOURCE_FD
, 
fd
) != 0) {

227 
	`≥º‹
("aeApiDelEvent:Öort_dissociate");

228 
	`ab‹t
();

230 } i‡(
	`´ApiAssocüã
("´ApiDñEvít", 
°©e
->
p‹tfd
, 
fd
,

231 
fuŒmask
) != 0) {

239 
	`ab‹t
();

241 
	}
}

243 
	$´ApiPﬁl
(
´EvítLo›
 *
evítLo›
, 
timevÆ
 *
tvp
) {

244 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

245 
time•ec
 
timeout
, *
t•
;

246 
mask
, 
i
;

247 
uöt_t
 
√víts
;

248 
p‹t_evít_t
 
evít
[
MAX_EVENT_BATCHSZ
];

255 
i
 = 0; i < 
°©e
->
≈ídög
; i++) {

256 i‡(
°©e
->
≥ndög_fds
[
i
] == -1)

260 i‡(
	`´ApiAssocüã
("´ApiPﬁl", 
°©e
->
p‹tfd
,

261 
°©e
->
≥ndög_fds
[
i
], sèã->
≥ndög_masks
[i]) != 0) {

263 
	`ab‹t
();

266 
°©e
->
≥ndög_masks
[
i
] = 
AE_NONE
;

267 
°©e
->
≥ndög_fds
[
i
] = -1;

270 
°©e
->
≈ídög
 = 0;

272 i‡(
tvp
 !
NULL
) {

273 
timeout
.
tv_£c
 = 
tvp
->tv_sec;

274 
timeout
.
tv_n£c
 = 
tvp
->
tv_u£c
 * 1000;

275 
t•
 = &
timeout
;

277 
t•
 = 
NULL
;

284 
√víts
 = 1;

285 i‡(
	`p‹t_gën
(
°©e
->
p‹tfd
, 
evít
, 
MAX_EVENT_BATCHSZ
, &
√víts
,

286 
t•
Ë=-1 && (
î∫o
 !
ETIME
 || 
√víts
 == 0)) {

287 i‡(
î∫o
 =
ETIME
 ||Éºnÿ=
EINTR
)

291 
	`≥º‹
("aeApiPoll:Öort_get");

292 
	`ab‹t
();

295 
°©e
->
≈ídög
 = 
√víts
;

297 
i
 = 0; i < 
√víts
; i++) {

298 
mask
 = 0;

299 i‡(
evít
[
i
].
p‹ãv_evíts
 & 
POLLIN
)

300 
mask
 |
AE_READABLE
;

301 i‡(
evít
[
i
].
p‹ãv_evíts
 & 
POLLOUT
)

302 
mask
 |
AE_WRITABLE
;

304 
evítLo›
->
fúed
[
i
].
fd
 = 
evít
[i].
p‹ãv_obje˘
;

305 
evítLo›
->
fúed
[
i
].
mask
 = mask;

307 i‡(
evp‹t_debug
)

308 
	`Ârötf
(
°dîr
, "aeApiPoll: fd %d mask 0x%x\n",

309 ()
evít
[
i
].
p‹ãv_obje˘
, 
mask
);

311 
°©e
->
≥ndög_fds
[
i
] = 
evít
[i].
p‹ãv_obje˘
;

312 
°©e
->
≥ndög_masks
[
i
] = (
uöçå_t
)
evít
[i].
p‹ãv_u£r
;

315  
√víts
;

316 
	}
}

318 *
	$´ApiName
() {

320 
	}
}

	@ae_kqueue.c

32 
	~<sys/ty≥s.h
>

33 
	~<sys/evít.h
>

34 
	~<sys/time.h
>

36 
	s´ApiSèã
 {

37 
	mkqfd
;

38 
kevít
 *
	mevíts
;

39 } 
	t´ApiSèã
;

41 
	$´ApiCª©e
(
´EvítLo›
 *
evítLo›
) {

42 
´ApiSèã
 *
°©e
 = 
	`zmÆloc
((aeApiState));

44 i‡(!
°©e
)  -1;

45 
°©e
->
evíts
 = 
	`zmÆloc
((
kevít
)*
evítLo›
->
£tsize
);

46 i‡(!
°©e
->
evíts
) {

47 
	`z‰ì
(
°©e
);

50 
°©e
->
kqfd
 = 
	`kqueue
();

51 i‡(
°©e
->
kqfd
 == -1) {

52 
	`z‰ì
(
°©e
->
evíts
);

53 
	`z‰ì
(
°©e
);

56 
evítLo›
->
≠id©a
 = 
°©e
;

58 
	}
}

60 
	$´ApiResize
(
´EvítLo›
 *
evítLo›
, 
£tsize
) {

61 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

63 
°©e
->
evíts
 = 
	`zªÆloc
(°©e->evíts, (
kevít
)*
£tsize
);

65 
	}
}

67 
	$´ApiFªe
(
´EvítLo›
 *
evítLo›
) {

68 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

70 
	`˛o£
(
°©e
->
kqfd
);

71 
	`z‰ì
(
°©e
->
evíts
);

72 
	`z‰ì
(
°©e
);

73 
	}
}

75 
	$´ApiAddEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
) {

76 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

77 
kevít
 
ke
;

79 i‡(
mask
 & 
AE_READABLE
) {

80 
	`EV_SET
(&
ke
, 
fd
, 
EVFILT_READ
, 
EV_ADD
, 0, 0, 
NULL
);

81 i‡(
	`kevít
(
°©e
->
kqfd
, &
ke
, 1, 
NULL
, 0, NULL) == -1)  -1;

83 i‡(
mask
 & 
AE_WRITABLE
) {

84 
	`EV_SET
(&
ke
, 
fd
, 
EVFILT_WRITE
, 
EV_ADD
, 0, 0, 
NULL
);

85 i‡(
	`kevít
(
°©e
->
kqfd
, &
ke
, 1, 
NULL
, 0, NULL) == -1)  -1;

88 
	}
}

90 
	$´ApiDñEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
) {

91 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

92 
kevít
 
ke
;

94 i‡(
mask
 & 
AE_READABLE
) {

95 
	`EV_SET
(&
ke
, 
fd
, 
EVFILT_READ
, 
EV_DELETE
, 0, 0, 
NULL
);

96 
	`kevít
(
°©e
->
kqfd
, &
ke
, 1, 
NULL
, 0, NULL);

98 i‡(
mask
 & 
AE_WRITABLE
) {

99 
	`EV_SET
(&
ke
, 
fd
, 
EVFILT_WRITE
, 
EV_DELETE
, 0, 0, 
NULL
);

100 
	`kevít
(
°©e
->
kqfd
, &
ke
, 1, 
NULL
, 0, NULL);

102 
	}
}

104 
	$´ApiPﬁl
(
´EvítLo›
 *
evítLo›
, 
timevÆ
 *
tvp
) {

105 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

106 
ªtvÆ
, 
numevíts
 = 0;

108 i‡(
tvp
 !
NULL
) {

109 
time•ec
 
timeout
;

110 
timeout
.
tv_£c
 = 
tvp
->tv_sec;

111 
timeout
.
tv_n£c
 = 
tvp
->
tv_u£c
 * 1000;

112 
ªtvÆ
 = 
	`kevít
(
°©e
->
kqfd
, 
NULL
, 0, sèã->
evíts
, 
evítLo›
->
£tsize
,

113 &
timeout
);

115 
ªtvÆ
 = 
	`kevít
(
°©e
->
kqfd
, 
NULL
, 0, sèã->
evíts
, 
evítLo›
->
£tsize
,

116 
NULL
);

119 i‡(
ªtvÆ
 > 0) {

120 
j
;

122 
numevíts
 = 
ªtvÆ
;

123 
j
 = 0; j < 
numevíts
; j++) {

124 
mask
 = 0;

125 
kevít
 *
e
 = 
°©e
->
evíts
+
j
;

127 i‡(
e
->
fûãr
 =
EVFILT_READ
Ë
mask
 |
AE_READABLE
;

128 i‡(
e
->
fûãr
 =
EVFILT_WRITE
Ë
mask
 |
AE_WRITABLE
;

129 
evítLo›
->
fúed
[
j
].
fd
 = 
e
->
idít
;

130 
evítLo›
->
fúed
[
j
].
mask
 = mask;

133  
numevíts
;

134 
	}
}

136 *
	$´ApiName
() {

138 
	}
}

	@ae_select.c

32 
	~<sys/£À˘.h
>

33 
	~<°rög.h
>

35 
	s´ApiSèã
 {

36 
fd_£t
 
	mrfds
, 
	mwfds
;

39 
fd_£t
 
	m_rfds
, 
	m_wfds
;

40 } 
	t´ApiSèã
;

42 
	$´ApiCª©e
(
´EvítLo›
 *
evítLo›
) {

43 
´ApiSèã
 *
°©e
 = 
	`zmÆloc
((aeApiState));

45 i‡(!
°©e
)  -1;

46 
	`FD_ZERO
(&
°©e
->
rfds
);

47 
	`FD_ZERO
(&
°©e
->
wfds
);

48 
evítLo›
->
≠id©a
 = 
°©e
;

50 
	}
}

52 
	$´ApiResize
(
´EvítLo›
 *
evítLo›
, 
£tsize
) {

54 i‡(
£tsize
 >
FD_SETSIZE
)  -1;

56 
	}
}

58 
	$´ApiFªe
(
´EvítLo›
 *
evítLo›
) {

59 
	`z‰ì
(
evítLo›
->
≠id©a
);

60 
	}
}

62 
	$´ApiAddEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
) {

63 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

65 i‡(
mask
 & 
AE_READABLE
Ë
	`FD_SET
(
fd
,&
°©e
->
rfds
);

66 i‡(
mask
 & 
AE_WRITABLE
Ë
	`FD_SET
(
fd
,&
°©e
->
wfds
);

68 
	}
}

70 
	$´ApiDñEvít
(
´EvítLo›
 *
evítLo›
, 
fd
, 
mask
) {

71 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

73 i‡(
mask
 & 
AE_READABLE
Ë
	`FD_CLR
(
fd
,&
°©e
->
rfds
);

74 i‡(
mask
 & 
AE_WRITABLE
Ë
	`FD_CLR
(
fd
,&
°©e
->
wfds
);

75 
	}
}

77 
	$´ApiPﬁl
(
´EvítLo›
 *
evítLo›
, 
timevÆ
 *
tvp
) {

78 
´ApiSèã
 *
°©e
 = 
evítLo›
->
≠id©a
;

79 
ªtvÆ
, 
j
, 
numevíts
 = 0;

81 
	`mem˝y
(&
°©e
->
_rfds
,&°©e->
rfds
,(
fd_£t
));

82 
	`mem˝y
(&
°©e
->
_wfds
,&°©e->
wfds
,(
fd_£t
));

84 
ªtvÆ
 = 
	`£À˘
(
evítLo›
->
maxfd
+1,

85 &
°©e
->
_rfds
,&°©e->
_wfds
,
NULL
,
tvp
);

86 i‡(
ªtvÆ
 > 0) {

87 
j
 = 0; j <
evítLo›
->
maxfd
; j++) {

88 
mask
 = 0;

89 
´FûeEvít
 *
„
 = &
evítLo›
->
evíts
[
j
];

91 i‡(
„
->
mask
 =
AE_NONE
) ;

92 i‡(
„
->
mask
 & 
AE_READABLE
 && 
	`FD_ISSET
(
j
,&
°©e
->
_rfds
))

93 
mask
 |
AE_READABLE
;

94 i‡(
„
->
mask
 & 
AE_WRITABLE
 && 
	`FD_ISSET
(
j
,&
°©e
->
_wfds
))

95 
mask
 |
AE_WRITABLE
;

96 
evítLo›
->
fúed
[
numevíts
].
fd
 = 
j
;

97 
evítLo›
->
fúed
[
numevíts
].
mask
 = mask;

98 
numevíts
++;

101  
numevíts
;

102 
	}
}

104 *
	$´ApiName
() {

106 
	}
}

	@anet.c

31 
	~"fma¸os.h
"

33 
	~<sys/ty≥s.h
>

34 
	~<sys/sockë.h
>

35 
	~<sys/°©.h
>

36 
	~<sys/un.h
>

37 
	~<sys/time.h
>

38 
	~<√töë/ö.h
>

39 
	~<√töë/t˝.h
>

40 
	~<¨∑/öë.h
>

41 
	~<uni°d.h
>

42 
	~<f˙é.h
>

43 
	~<°rög.h
>

44 
	~<√tdb.h
>

45 
	~<î∫o.h
>

46 
	~<°d¨g.h
>

47 
	~<°dio.h
>

49 
	~"™ë.h
"

51 
	$™ëSëEº‹
(*
îr
, c⁄° *
fmt
, ...)

53 
va_li°
 
≠
;

55 i‡(!
îr
) ;

56 
	`va_°¨t
(
≠
, 
fmt
);

57 
	`v¢¥ötf
(
îr
, 
ANET_ERR_LEN
, 
fmt
, 
≠
);

58 
	`va_íd
(
≠
);

59 
	}
}

61 
	$™ëSëBlock
(*
îr
, 
fd
, 
n⁄_block
) {

62 
Êags
;

67 i‡((
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
)) == -1) {

68 
	`™ëSëEº‹
(
îr
, "f˙é(F_GETFL): %s", 
	`°ªº‹
(
î∫o
));

69  
ANET_ERR
;

72 i‡(
n⁄_block
)

73 
Êags
 |
O_NONBLOCK
;

75 
Êags
 &~
O_NONBLOCK
;

77 i‡(
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
) == -1) {

78 
	`™ëSëEº‹
(
îr
, "f˙é(F_SETFL,O_NONBLOCK): %s", 
	`°ªº‹
(
î∫o
));

79  
ANET_ERR
;

81  
ANET_OK
;

82 
	}
}

84 
	$™ëN⁄Block
(*
îr
, 
fd
) {

85  
	`™ëSëBlock
(
îr
,
fd
,1);

86 
	}
}

88 
	$™ëBlock
(*
îr
, 
fd
) {

89  
	`™ëSëBlock
(
îr
,
fd
,0);

90 
	}
}

95 
	$™ëKìpAlive
(*
îr
, 
fd
, 
öãrvÆ
)

97 
vÆ
 = 1;

99 i‡(
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_KEEPALIVE
, &
vÆ
, (val)) == -1)

101 
	`™ëSëEº‹
(
îr
, "£tsock›àSO_KEEPALIVE: %s", 
	`°ªº‹
(
î∫o
));

102  
ANET_ERR
;

105 #ifde‡
__löux__


111 
vÆ
 = 
öãrvÆ
;

112 i‡(
	`£tsock›t
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPIDLE
, &
vÆ
, (val)) < 0) {

113 
	`™ëSëEº‹
(
îr
, "£tsock›àTCP_KEEPIDLE: %s\n", 
	`°ªº‹
(
î∫o
));

114  
ANET_ERR
;

120 
vÆ
 = 
öãrvÆ
/3;

121 i‡(
vÆ
 == 0) val = 1;

122 i‡(
	`£tsock›t
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPINTVL
, &
vÆ
, (val)) < 0) {

123 
	`™ëSëEº‹
(
îr
, "£tsock›àTCP_KEEPINTVL: %s\n", 
	`°ªº‹
(
î∫o
));

124  
ANET_ERR
;

129 
vÆ
 = 3;

130 i‡(
	`£tsock›t
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPCNT
, &
vÆ
, (val)) < 0) {

131 
	`™ëSëEº‹
(
îr
, "£tsock›àTCP_KEEPCNT: %s\n", 
	`°ªº‹
(
î∫o
));

132  
ANET_ERR
;

135 ((Ë
öãrvÆ
);

138  
ANET_OK
;

139 
	}
}

141 
	$™ëSëT˝NoDñay
(*
îr
, 
fd
, 
vÆ
)

143 i‡(
	`£tsock›t
(
fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
, &
vÆ
, (val)) == -1)

145 
	`™ëSëEº‹
(
îr
, "£tsock›àTCP_NODELAY: %s", 
	`°ªº‹
(
î∫o
));

146  
ANET_ERR
;

148  
ANET_OK
;

149 
	}
}

151 
	$™ëE«bÀT˝NoDñay
(*
îr
, 
fd
)

153  
	`™ëSëT˝NoDñay
(
îr
, 
fd
, 1);

154 
	}
}

156 
	$™ëDißbÀT˝NoDñay
(*
îr
, 
fd
)

158  
	`™ëSëT˝NoDñay
(
îr
, 
fd
, 0);

159 
	}
}

162 
	$™ëSëSídBuf„r
(*
îr
, 
fd
, 
buffsize
)

164 i‡(
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_SNDBUF
, &
buffsize
, (buffsize)) == -1)

166 
	`™ëSëEº‹
(
îr
, "£tsock›àSO_SNDBUF: %s", 
	`°ªº‹
(
î∫o
));

167  
ANET_ERR
;

169  
ANET_OK
;

170 
	}
}

172 
	$™ëT˝KìpAlive
(*
îr
, 
fd
)

174 
yes
 = 1;

175 i‡(
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_KEEPALIVE
, &
yes
, (yes)) == -1) {

176 
	`™ëSëEº‹
(
îr
, "£tsock›àSO_KEEPALIVE: %s", 
	`°ªº‹
(
î∫o
));

177  
ANET_ERR
;

179  
ANET_OK
;

180 
	}
}

184 
	$™ëSídTimeout
(*
îr
, 
fd
, 
ms
) {

185 
timevÆ
 
tv
;

187 
tv
.
tv_£c
 = 
ms
/1000;

188 
tv
.
tv_u£c
 = (
ms
%1000)*1000;

189 i‡(
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_SNDTIMEO
, &
tv
, (tv)) == -1) {

190 
	`™ëSëEº‹
(
îr
, "£tsock›àSO_SNDTIMEO: %s", 
	`°ªº‹
(
î∫o
));

191  
ANET_ERR
;

193  
ANET_OK
;

194 
	}
}

198 
	$™ëRecvTimeout
(*
îr
, 
fd
, 
ms
) {

199 
timevÆ
 
tv
;

201 
tv
.
tv_£c
 = 
ms
/1000;

202 
tv
.
tv_u£c
 = (
ms
%1000)*1000;

203 i‡(
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_RCVTIMEO
, &
tv
, (tv)) == -1) {

204 
	`™ëSëEº‹
(
îr
, "£tsock›àSO_RCVTIMEO: %s", 
	`°ªº‹
(
î∫o
));

205  
ANET_ERR
;

207  
ANET_OK
;

208 
	}
}

217 
	$™ëGíîicResﬁve
(*
îr
, *
ho°
, *
ùbuf
, 
size_t
 
ùbuf_Àn
,

218 
Êags
)

220 
addröfo
 
höts
, *
öfo
;

221 
rv
;

223 
	`mem£t
(&
höts
,0,(hints));

224 i‡(
Êags
 & 
ANET_IP_ONLY
Ë
höts
.
ai_Êags
 = 
AI_NUMERICHOST
;

225 
höts
.
ai_Ámûy
 = 
AF_UNSPEC
;

226 
höts
.
ai_sockty≥
 = 
SOCK_STREAM
;

228 i‡((
rv
 = 
	`gëaddröfo
(
ho°
, 
NULL
, &
höts
, &
öfo
)) != 0) {

229 
	`™ëSëEº‹
(
îr
, "%s", 
	`gai_°ªº‹
(
rv
));

230  
ANET_ERR
;

232 i‡(
öfo
->
ai_Ámûy
 =
AF_INET
) {

233 
sockaddr_ö
 *
ß
 = (sockaddr_ö *)
öfo
->
ai_addr
;

234 
	`öë_¡›
(
AF_INET
, &(
ß
->
sö_addr
), 
ùbuf
, 
ùbuf_Àn
);

236 
sockaddr_ö6
 *
ß
 = (sockaddr_ö6 *)
öfo
->
ai_addr
;

237 
	`öë_¡›
(
AF_INET6
, &(
ß
->
sö6_addr
), 
ùbuf
, 
ùbuf_Àn
);

240 
	`‰ìaddröfo
(
öfo
);

241  
ANET_OK
;

242 
	}
}

244 
	$™ëResﬁve
(*
îr
, *
ho°
, *
ùbuf
, 
size_t
 
ùbuf_Àn
) {

245  
	`™ëGíîicResﬁve
(
îr
,
ho°
,
ùbuf
,
ùbuf_Àn
,
ANET_NONE
);

246 
	}
}

248 
	$™ëResﬁveIP
(*
îr
, *
ho°
, *
ùbuf
, 
size_t
 
ùbuf_Àn
) {

249  
	`™ëGíîicResﬁve
(
îr
,
ho°
,
ùbuf
,
ùbuf_Àn
,
ANET_IP_ONLY
);

250 
	}
}

252 
	$™ëSëReu£Addr
(*
îr
, 
fd
) {

253 
yes
 = 1;

256 i‡(
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
yes
, (yes)) == -1) {

257 
	`™ëSëEº‹
(
îr
, "£tsock›àSO_REUSEADDR: %s", 
	`°ªº‹
(
î∫o
));

258  
ANET_ERR
;

260  
ANET_OK
;

261 
	}
}

263 
	$™ëCª©eSockë
(*
îr
, 
domaö
) {

264 
s
;

265 i‡((
s
 = 
	`sockë
(
domaö
, 
SOCK_STREAM
, 0)) == -1) {

266 
	`™ëSëEº‹
(
îr
, "¸ótög sockë: %s", 
	`°ªº‹
(
î∫o
));

267  
ANET_ERR
;

272 i‡(
	`™ëSëReu£Addr
(
îr
,
s
Ë=
ANET_ERR
) {

273 
	`˛o£
(
s
);

274  
ANET_ERR
;

276  
s
;

277 
	}
}

279 
	#ANET_CONNECT_NONE
 0

	)

280 
	#ANET_CONNECT_NONBLOCK
 1

	)

281 
	#ANET_CONNECT_BE_BINDING
 2

	)

282 
	$™ëT˝GíîicC⁄√˘
(*
îr
, c⁄° *
addr
, 
p‹t
,

283 c⁄° *
sour˚_addr
, 
Êags
)

285 
s
 = 
ANET_ERR
, 
rv
;

286 
p‹t°r
[6];

287 
addröfo
 
höts
, *
£rvöfo
, *
b£rvöfo
, *
p
, *
b
;

289 
	`¢¥ötf
(
p‹t°r
,’‹t°r),"%d",
p‹t
);

290 
	`mem£t
(&
höts
,0,(hints));

291 
höts
.
ai_Ámûy
 = 
AF_UNSPEC
;

292 
höts
.
ai_sockty≥
 = 
SOCK_STREAM
;

294 i‡((
rv
 = 
	`gëaddröfo
(
addr
,
p‹t°r
,&
höts
,&
£rvöfo
)) != 0) {

295 
	`™ëSëEº‹
(
îr
, "%s", 
	`gai_°ªº‹
(
rv
));

296  
ANET_ERR
;

298 
p
 = 
£rvöfo
;Ö !
NULL
;Ö =Ö->
ai_√xt
) {

302 i‡((
s
 = 
	`sockë
(
p
->
ai_Ámûy
,p->
ai_sockty≥
,p->
ai_¥Ÿocﬁ
)) == -1)

304 i‡(
	`™ëSëReu£Addr
(
îr
,
s
Ë=
ANET_ERR
Ë
îr‹
;

305 i‡(
Êags
 & 
ANET_CONNECT_NONBLOCK
 && 
	`™ëN⁄Block
(
îr
,
s
Ë!
ANET_OK
)

306 
îr‹
;

307 i‡(
sour˚_addr
) {

308 
bound
 = 0;

310 i‡((
rv
 = 
	`gëaddröfo
(
sour˚_addr
, 
NULL
, &
höts
, &
b£rvöfo
)) != 0)

312 
	`™ëSëEº‹
(
îr
, "%s", 
	`gai_°ªº‹
(
rv
));

313 
îr‹
;

315 
b
 = 
b£rvöfo
; b !
NULL
; b = b->
ai_√xt
) {

316 i‡(
	`böd
(
s
,
b
->
ai_addr
,b->
ai_addæí
) != -1) {

317 
bound
 = 1;

321 
	`‰ìaddröfo
(
b£rvöfo
);

322 i‡(!
bound
) {

323 
	`™ëSëEº‹
(
îr
, "böd: %s", 
	`°ªº‹
(
î∫o
));

324 
îr‹
;

327 i‡(
	`c⁄√˘
(
s
,
p
->
ai_addr
,p->
ai_addæí
) == -1) {

330 i‡(
î∫o
 =
EINPROGRESS
 && 
Êags
 & 
ANET_CONNECT_NONBLOCK
)

331 
íd
;

332 
	`˛o£
(
s
);

333 
s
 = 
ANET_ERR
;

339 
íd
;

341 i‡(
p
 =
NULL
)

342 
	`™ëSëEº‹
(
îr
, "¸ótög sockë: %s", 
	`°ªº‹
(
î∫o
));

344 
îr‹
:

345 i‡(
s
 !
ANET_ERR
) {

346 
	`˛o£
(
s
);

347 
s
 = 
ANET_ERR
;

350 
íd
:

351 
	`‰ìaddröfo
(
£rvöfo
);

355 i‡(
s
 =
ANET_ERR
 && 
sour˚_addr
 && (
Êags
 & 
ANET_CONNECT_BE_BINDING
)) {

356  
	`™ëT˝GíîicC⁄√˘
(
îr
,
addr
,
p‹t
,
NULL
,
Êags
);

358  
s
;

360 
	}
}

362 
	$™ëT˝C⁄√˘
(*
îr
, c⁄° *
addr
, 
p‹t
)

364  
	`™ëT˝GíîicC⁄√˘
(
îr
,
addr
,
p‹t
,
NULL
,
ANET_CONNECT_NONE
);

365 
	}
}

367 
	$™ëT˝N⁄BlockC⁄√˘
(*
îr
, c⁄° *
addr
, 
p‹t
)

369  
	`™ëT˝GíîicC⁄√˘
(
îr
,
addr
,
p‹t
,
NULL
,
ANET_CONNECT_NONBLOCK
);

370 
	}
}

372 
	$™ëT˝N⁄BlockBödC⁄√˘
(*
îr
, c⁄° *
addr
, 
p‹t
,

373 c⁄° *
sour˚_addr
)

375  
	`™ëT˝GíîicC⁄√˘
(
îr
,
addr
,
p‹t
,
sour˚_addr
,

376 
ANET_CONNECT_NONBLOCK
);

377 
	}
}

379 
	$™ëT˝N⁄BlockBe°Eff‹tBödC⁄√˘
(*
îr
, c⁄° *
addr
, 
p‹t
,

380 c⁄° *
sour˚_addr
)

382  
	`™ëT˝GíîicC⁄√˘
(
îr
,
addr
,
p‹t
,
sour˚_addr
,

383 
ANET_CONNECT_NONBLOCK
|
ANET_CONNECT_BE_BINDING
);

384 
	}
}

386 
	$™ëUnixGíîicC⁄√˘
(*
îr
, c⁄° *
∑th
, 
Êags
)

388 
s
;

389 
sockaddr_un
 
ß
;

391 i‡((
s
 = 
	`™ëCª©eSockë
(
îr
,
AF_LOCAL
)Ë=
ANET_ERR
)

392  
ANET_ERR
;

394 
ß
.
sun_Ámûy
 = 
AF_LOCAL
;

395 
	`°∫˝y
(
ß
.
sun_∑th
,
∑th
,(sa.sun_path)-1);

396 i‡(
Êags
 & 
ANET_CONNECT_NONBLOCK
) {

397 i‡(
	`™ëN⁄Block
(
îr
,
s
Ë!
ANET_OK
) {

398 
	`˛o£
(
s
);

399  
ANET_ERR
;

402 i‡(
	`c⁄√˘
(
s
,(
sockaddr
*)&
ß
,(sa)) == -1) {

403 i‡(
î∫o
 =
EINPROGRESS
 &&

404 
Êags
 & 
ANET_CONNECT_NONBLOCK
)

405  
s
;

407 
	`™ëSëEº‹
(
îr
, "c⁄√˘: %s", 
	`°ªº‹
(
î∫o
));

408 
	`˛o£
(
s
);

409  
ANET_ERR
;

411  
s
;

412 
	}
}

414 
	$™ëUnixC⁄√˘
(*
îr
, c⁄° *
∑th
)

416  
	`™ëUnixGíîicC⁄√˘
(
îr
,
∑th
,
ANET_CONNECT_NONE
);

417 
	}
}

419 
	$™ëUnixN⁄BlockC⁄√˘
(*
îr
, c⁄° *
∑th
)

421  
	`™ëUnixGíîicC⁄√˘
(
îr
,
∑th
,
ANET_CONNECT_NONBLOCK
);

422 
	}
}

426 
	$™ëRód
(
fd
, *
buf
, 
cou¡
)

428 
ssize_t
 
ƒód
, 
tŸÀn
 = 0;

429 
tŸÀn
 !
cou¡
) {

430 
ƒód
 = 
	`ªad
(
fd
,
buf
,
cou¡
-
tŸÀn
);

431 i‡(
ƒód
 =0Ë 
tŸÀn
;

432 i‡(
ƒód
 == -1)  -1;

433 
tŸÀn
 +
ƒód
;

434 
buf
 +
ƒód
;

436  
tŸÀn
;

437 
	}
}

441 
	$™ëWrôe
(
fd
, *
buf
, 
cou¡
)

443 
ssize_t
 
nwrôãn
, 
tŸÀn
 = 0;

444 
tŸÀn
 !
cou¡
) {

445 
nwrôãn
 = 
	`wrôe
(
fd
,
buf
,
cou¡
-
tŸÀn
);

446 i‡(
nwrôãn
 =0Ë 
tŸÀn
;

447 i‡(
nwrôãn
 == -1)  -1;

448 
tŸÀn
 +
nwrôãn
;

449 
buf
 +
nwrôãn
;

451  
tŸÀn
;

452 
	}
}

454 
	$™ëLi°í
(*
îr
, 
s
, 
sockaddr
 *
ß
, 
sockÀn_t
 
Àn
, 
backlog
) {

455 i‡(
	`böd
(
s
,
ß
,
Àn
) == -1) {

456 
	`™ëSëEº‹
(
îr
, "böd: %s", 
	`°ªº‹
(
î∫o
));

457 
	`˛o£
(
s
);

458  
ANET_ERR
;

461 i‡(
	`li°í
(
s
, 
backlog
) == -1) {

462 
	`™ëSëEº‹
(
îr
, "li°í: %s", 
	`°ªº‹
(
î∫o
));

463 
	`˛o£
(
s
);

464  
ANET_ERR
;

466  
ANET_OK
;

467 
	}
}

469 
	$™ëV6O∆y
(*
îr
, 
s
) {

470 
yes
 = 1;

471 i‡(
	`£tsock›t
(
s
,
IPPROTO_IPV6
,
IPV6_V6ONLY
,&
yes
,(yes)) == -1) {

472 
	`™ëSëEº‹
(
îr
, "£tsock›t: %s", 
	`°ªº‹
(
î∫o
));

473 
	`˛o£
(
s
);

474  
ANET_ERR
;

476  
ANET_OK
;

477 
	}
}

479 
	$_™ëT˝Sîvî
(*
îr
, 
p‹t
, *
bödaddr
, 
af
, 
backlog
)

481 
s
 = -1, 
rv
;

482 
_p‹t
[6];

483 
addröfo
 
höts
, *
£rvöfo
, *
p
;

485 
	`¢¥ötf
(
_p‹t
,6,"%d",
p‹t
);

486 
	`mem£t
(&
höts
,0,(hints));

487 
höts
.
ai_Ámûy
 = 
af
;

488 
höts
.
ai_sockty≥
 = 
SOCK_STREAM
;

489 
höts
.
ai_Êags
 = 
AI_PASSIVE
;

491 i‡((
rv
 = 
	`gëaddröfo
(
bödaddr
,
_p‹t
,&
höts
,&
£rvöfo
)) != 0) {

492 
	`™ëSëEº‹
(
îr
, "%s", 
	`gai_°ªº‹
(
rv
));

493  
ANET_ERR
;

495 
p
 = 
£rvöfo
;Ö !
NULL
;Ö =Ö->
ai_√xt
) {

496 i‡((
s
 = 
	`sockë
(
p
->
ai_Ámûy
,p->
ai_sockty≥
,p->
ai_¥Ÿocﬁ
)) == -1)

499 i‡(
af
 =
AF_INET6
 && 
	`™ëV6O∆y
(
îr
,
s
Ë=
ANET_ERR
Ë
îr‹
;

500 i‡(
	`™ëSëReu£Addr
(
îr
,
s
Ë=
ANET_ERR
Ë
îr‹
;

501 i‡(
	`™ëLi°í
(
îr
,
s
,
p
->
ai_addr
,p->
ai_addæí
,
backlog
Ë=
ANET_ERR
) s = ANET_ERR;

502 
íd
;

504 i‡(
p
 =
NULL
) {

505 
	`™ëSëEº‹
(
îr
, "u«bÀÅÿböd sockë,Éºno: %d", 
î∫o
);

506 
îr‹
;

509 
îr‹
:

510 i‡(
s
 !-1Ë
	`˛o£
(s);

511 
s
 = 
ANET_ERR
;

512 
íd
:

513 
	`‰ìaddröfo
(
£rvöfo
);

514  
s
;

515 
	}
}

517 
	$™ëT˝Sîvî
(*
îr
, 
p‹t
, *
bödaddr
, 
backlog
)

519  
	`_™ëT˝Sîvî
(
îr
, 
p‹t
, 
bödaddr
, 
AF_INET
, 
backlog
);

520 
	}
}

522 
	$™ëT˝6Sîvî
(*
îr
, 
p‹t
, *
bödaddr
, 
backlog
)

524  
	`_™ëT˝Sîvî
(
îr
, 
p‹t
, 
bödaddr
, 
AF_INET6
, 
backlog
);

525 
	}
}

527 
	$™ëUnixSîvî
(*
îr
, *
∑th
, 
mode_t
 
≥rm
, 
backlog
)

529 
s
;

530 
sockaddr_un
 
ß
;

532 i‡((
s
 = 
	`™ëCª©eSockë
(
îr
,
AF_LOCAL
)Ë=
ANET_ERR
)

533  
ANET_ERR
;

535 
	`mem£t
(&
ß
,0,(sa));

536 
ß
.
sun_Ámûy
 = 
AF_LOCAL
;

537 
	`°∫˝y
(
ß
.
sun_∑th
,
∑th
,(sa.sun_path)-1);

538 i‡(
	`™ëLi°í
(
îr
,
s
,(
sockaddr
*)&
ß
,(ß),
backlog
Ë=
ANET_ERR
)

539  
ANET_ERR
;

540 i‡(
≥rm
)

541 
	`chmod
(
ß
.
sun_∑th
, 
≥rm
);

542  
s
;

543 
	}
}

545 
	$™ëGíîicAc˚±
(*
îr
, 
s
, 
sockaddr
 *
ß
, 
sockÀn_t
 *
Àn
) {

546 
fd
;

548 
fd
 = 
	`ac˚±
(
s
,
ß
,
Àn
);

549 i‡(
fd
 == -1) {

550 i‡(
î∫o
 =
EINTR
)

553 
	`™ëSëEº‹
(
îr
, "ac˚±: %s", 
	`°ªº‹
(
î∫o
));

554  
ANET_ERR
;

559  
fd
;

560 
	}
}

562 
	$™ëT˝Ac˚±
(*
îr
, 
s
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
) {

563 
fd
;

564 
sockaddr_°‹age
 
ß
;

565 
sockÀn_t
 
ßÀn
 = (
ß
);

566 i‡((
fd
 = 
	`™ëGíîicAc˚±
(
îr
,
s
,(
sockaddr
*)&
ß
,&
ßÀn
)) == -1)

567  
ANET_ERR
;

569 i‡(
ß
.
ss_Ámûy
 =
AF_INET
) {

570 
sockaddr_ö
 *
s
 = (sockaddr_ö *)&
ß
;

571 i‡(
ù
Ë
	`öë_¡›
(
AF_INET
,(*)&(
s
->
sö_addr
),ù,
ù_Àn
);

572 i‡(
p‹t
Ë*p‹à
	`¡ohs
(
s
->
sö_p‹t
);

574 
sockaddr_ö6
 *
s
 = (sockaddr_ö6 *)&
ß
;

575 i‡(
ù
Ë
	`öë_¡›
(
AF_INET6
,(*)&(
s
->
sö6_addr
),ù,
ù_Àn
);

576 i‡(
p‹t
Ë*p‹à
	`¡ohs
(
s
->
sö6_p‹t
);

578  
fd
;

579 
	}
}

581 
	$™ëUnixAc˚±
(*
îr
, 
s
) {

582 
fd
;

583 
sockaddr_un
 
ß
;

584 
sockÀn_t
 
ßÀn
 = (
ß
);

585 i‡((
fd
 = 
	`™ëGíîicAc˚±
(
îr
,
s
,(
sockaddr
*)&
ß
,&
ßÀn
)) == -1)

586  
ANET_ERR
;

588  
fd
;

589 
	}
}

591 
	$™ëPìrToSåög
(
fd
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
) {

592 
sockaddr_°‹age
 
ß
;

593 
sockÀn_t
 
ßÀn
 = (
ß
);

595 i‡(
	`gë≥î«me
(
fd
,(
sockaddr
*)&
ß
,&
ßÀn
Ë=-1Ë
îr‹
;

596 i‡(
ù_Àn
 =0Ë
îr‹
;

598 i‡(
ß
.
ss_Ámûy
 =
AF_INET
) {

599 
sockaddr_ö
 *
s
 = (sockaddr_ö *)&
ß
;

600 i‡(
ù
Ë
	`öë_¡›
(
AF_INET
,(*)&(
s
->
sö_addr
),ù,
ù_Àn
);

601 i‡(
p‹t
Ë*p‹à
	`¡ohs
(
s
->
sö_p‹t
);

602 } i‡(
ß
.
ss_Ámûy
 =
AF_INET6
) {

603 
sockaddr_ö6
 *
s
 = (sockaddr_ö6 *)&
ß
;

604 i‡(
ù
Ë
	`öë_¡›
(
AF_INET6
,(*)&(
s
->
sö6_addr
),ù,
ù_Àn
);

605 i‡(
p‹t
Ë*p‹à
	`¡ohs
(
s
->
sö6_p‹t
);

606 } i‡(
ß
.
ss_Ámûy
 =
AF_UNIX
) {

607 i‡(
ù
Ë
	`°∫˝y
(ù,"/unixsockë",
ù_Àn
);

608 i‡(
p‹t
) *port = 0;

610 
îr‹
;

614 
îr‹
:

615 i‡(
ù
) {

616 i‡(
ù_Àn
 >= 2) {

617 
ù
[0] = '?';

618 
ù
[1] = '\0';

619 } i‡(
ù_Àn
 == 1) {

620 
ù
[0] = '\0';

623 i‡(
p‹t
) *port = 0;

625 
	}
}

630 
	$™ëF‹m©Addr
(*
buf
, 
size_t
 
buf_Àn
, *
ù
, 
p‹t
) {

631  
	`¢¥ötf
(
buf
,
buf_Àn
, 
	`°rchr
(
ù
,':') ?

632 "[%s]:%d" : "%s:%d", 
ù
, 
p‹t
);

633 
	}
}

636 
	$™ëF‹m©Pìr
(
fd
, *
buf
, 
size_t
 
buf_Àn
) {

637 
ù
[
INET6_ADDRSTRLEN
];

638 
p‹t
;

640 
	`™ëPìrToSåög
(
fd
,
ù
,(ù),&
p‹t
);

641  
	`™ëF‹m©Addr
(
buf
, 
buf_Àn
, 
ù
, 
p‹t
);

642 
	}
}

644 
	$™ëSockName
(
fd
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
) {

645 
sockaddr_°‹age
 
ß
;

646 
sockÀn_t
 
ßÀn
 = (
ß
);

648 i‡(
	`gësock«me
(
fd
,(
sockaddr
*)&
ß
,&
ßÀn
) == -1) {

649 i‡(
p‹t
) *port = 0;

650 
ù
[0] = '?';

651 
ù
[1] = '\0';

654 i‡(
ß
.
ss_Ámûy
 =
AF_INET
) {

655 
sockaddr_ö
 *
s
 = (sockaddr_ö *)&
ß
;

656 i‡(
ù
Ë
	`öë_¡›
(
AF_INET
,(*)&(
s
->
sö_addr
),ù,
ù_Àn
);

657 i‡(
p‹t
Ë*p‹à
	`¡ohs
(
s
->
sö_p‹t
);

659 
sockaddr_ö6
 *
s
 = (sockaddr_ö6 *)&
ß
;

660 i‡(
ù
Ë
	`öë_¡›
(
AF_INET6
,(*)&(
s
->
sö6_addr
),ù,
ù_Àn
);

661 i‡(
p‹t
Ë*p‹à
	`¡ohs
(
s
->
sö6_p‹t
);

664 
	}
}

666 
	$™ëF‹m©Sock
(
fd
, *
fmt
, 
size_t
 
fmt_Àn
) {

667 
ù
[
INET6_ADDRSTRLEN
];

668 
p‹t
;

670 
	`™ëSockName
(
fd
,
ù
,(ù),&
p‹t
);

671  
	`™ëF‹m©Addr
(
fmt
, 
fmt_Àn
, 
ù
, 
p‹t
);

672 
	}
}

	@anet.h

31 #i‚de‡
ANET_H


32 
	#ANET_H


	)

34 
	~<sys/ty≥s.h
>

36 
	#ANET_OK
 0

	)

37 
	#ANET_ERR
 -1

	)

38 
	#ANET_ERR_LEN
 256

	)

41 
	#ANET_NONE
 0

	)

42 
	#ANET_IP_ONLY
 (1<<0)

	)

44 #i‡
deföed
(
__sun
Ë|| deföed(
_AIX
)

45 
	#AF_LOCAL
 
AF_UNIX


	)

48 #ifde‡
_AIX


49 #unde‡
ù_Àn


52 
™ëT˝C⁄√˘
(*
îr
, c⁄° *
addr
, 
p‹t
);

53 
™ëT˝N⁄BlockC⁄√˘
(*
îr
, c⁄° *
addr
, 
p‹t
);

54 
™ëT˝N⁄BlockBödC⁄√˘
(*
îr
, c⁄° *
addr
, 
p‹t
, c⁄° *
sour˚_addr
);

55 
™ëT˝N⁄BlockBe°Eff‹tBödC⁄√˘
(*
îr
, c⁄° *
addr
, 
p‹t
, c⁄° *
sour˚_addr
);

56 
™ëUnixC⁄√˘
(*
îr
, c⁄° *
∑th
);

57 
™ëUnixN⁄BlockC⁄√˘
(*
îr
, c⁄° *
∑th
);

58 
™ëRód
(
fd
, *
buf
, 
cou¡
);

59 
™ëResﬁve
(*
îr
, *
ho°
, *
ùbuf
, 
size_t
 
ùbuf_Àn
);

60 
™ëResﬁveIP
(*
îr
, *
ho°
, *
ùbuf
, 
size_t
 
ùbuf_Àn
);

61 
™ëT˝Sîvî
(*
îr
, 
p‹t
, *
bödaddr
, 
backlog
);

62 
™ëT˝6Sîvî
(*
îr
, 
p‹t
, *
bödaddr
, 
backlog
);

63 
™ëUnixSîvî
(*
îr
, *
∑th
, 
mode_t
 
≥rm
, 
backlog
);

64 
™ëT˝Ac˚±
(*
îr
, 
£rvîsock
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
);

65 
™ëUnixAc˚±
(*
îr
, 
£rvîsock
);

66 
™ëWrôe
(
fd
, *
buf
, 
cou¡
);

67 
™ëN⁄Block
(*
îr
, 
fd
);

68 
™ëBlock
(*
îr
, 
fd
);

69 
™ëE«bÀT˝NoDñay
(*
îr
, 
fd
);

70 
™ëDißbÀT˝NoDñay
(*
îr
, 
fd
);

71 
™ëT˝KìpAlive
(*
îr
, 
fd
);

72 
™ëSídTimeout
(*
îr
, 
fd
, 
ms
);

73 
™ëRecvTimeout
(*
îr
, 
fd
, 
ms
);

74 
™ëPìrToSåög
(
fd
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
);

75 
™ëKìpAlive
(*
îr
, 
fd
, 
öãrvÆ
);

76 
™ëSockName
(
fd
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
);

77 
™ëF‹m©Addr
(*
fmt
, 
size_t
 
fmt_Àn
, *
ù
, 
p‹t
);

78 
™ëF‹m©Pìr
(
fd
, *
fmt
, 
size_t
 
fmt_Àn
);

79 
™ëF‹m©Sock
(
fd
, *
fmt
, 
size_t
 
fmt_Àn
);

	@aof.c

30 
	~"£rvî.h
"

31 
	~"bio.h
"

32 
	~"rio.h
"

34 
	~<sig«l.h
>

35 
	~<f˙é.h
>

36 
	~<sys/°©.h
>

37 
	~<sys/ty≥s.h
>

38 
	~<sys/time.h
>

39 
	~<sys/ªsour˚.h
>

40 
	~<sys/waô.h
>

41 
	~<sys/∑øm.h
>

43 
aofUpd©eCuºítSize
();

44 
aofClo£Pùes
();

60 
	#AOF_RW_BUF_BLOCK_SIZE
 (1024*1024*10Ë

	)

62 
	sao‰wblock
 {

63 
	mu£d
, 
	m‰ì
;

64 
	mbuf
[
AOF_RW_BUF_BLOCK_SIZE
];

65 } 
	tao‰wblock
;

70 
	$aofRewrôeBuf„rRe£t
() {

71 i‡(
£rvî
.
aof_ªwrôe_buf_blocks
)

72 
	`li°Rñó£
(
£rvî
.
aof_ªwrôe_buf_blocks
);

74 
£rvî
.
aof_ªwrôe_buf_blocks
 = 
	`li°Cª©e
();

75 
	`li°SëFªeMëhod
(
£rvî
.
aof_ªwrôe_buf_blocks
,
z‰ì
);

76 
	}
}

79 
	$aofRewrôeBuf„rSize
() {

80 
li°Node
 *
 
;

81 
li°Iãr
 
li
;

82 
size
 = 0;

84 
	`li°Rewöd
(
£rvî
.
aof_ªwrôe_buf_blocks
,&
li
);

85 (
 
 = 
	`li°Next
(&
li
))) {

86 
ao‰wblock
 *
block
 = 
	`li°NodeVÆue
(
 
);

87 
size
 +
block
->
u£d
;

89  
size
;

90 
	}
}

95 
	$aofChûdWrôeDiffD©a
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

96 
li°Node
 *
 
;

97 
ao‰wblock
 *
block
;

98 
ssize_t
 
nwrôãn
;

99 
	`UNUSED
(
ñ
);

100 
	`UNUSED
(
fd
);

101 
	`UNUSED
(
¥ivd©a
);

102 
	`UNUSED
(
mask
);

105 
 
 = 
	`li°Fú°
(
£rvî
.
aof_ªwrôe_buf_blocks
);

106 
block
 = 
 
 ?Ün->
vÆue
 : 
NULL
;

107 i‡(
£rvî
.
aof_°›_£ndög_diff
 || !
block
) {

108 
	`´DñëeFûeEvít
(
£rvî
.
ñ
,£rvî.
aof_pùe_wrôe_d©a_to_chûd
,

109 
AE_WRITABLE
);

112 i‡(
block
->
u£d
 > 0) {

113 
nwrôãn
 = 
	`wrôe
(
£rvî
.
aof_pùe_wrôe_d©a_to_chûd
,

114 
block
->
buf
,block->
u£d
);

115 i‡(
nwrôãn
 <= 0) ;

116 
	`memmove
(
block
->
buf
,block->buf+
nwrôãn
,block->
u£d
-nwritten);

117 
block
->
u£d
 -
nwrôãn
;

118 
block
->
‰ì
 +
nwrôãn
;

120 i‡(
block
->
u£d
 =0Ë
	`li°DñNode
(
£rvî
.
aof_ªwrôe_buf_blocks
,
 
);

122 
	}
}

125 
	$aofRewrôeBuf„rAµíd
(*
s
, 
Àn
) {

126 
li°Node
 *
 
 = 
	`li°La°
(
£rvî
.
aof_ªwrôe_buf_blocks
);

127 
ao‰wblock
 *
block
 = 
 
 ?Ün->
vÆue
 : 
NULL
;

129 
Àn
) {

132 i‡(
block
) {

133 
thi¶í
 = (
block
->
‰ì
 < 
Àn
) ? block->free :Üen;

134 i‡(
thi¶í
) {

135 
	`mem˝y
(
block
->
buf
+block->
u£d
, 
s
, 
thi¶í
);

136 
block
->
u£d
 +
thi¶í
;

137 
block
->
‰ì
 -
thi¶í
;

138 
s
 +
thi¶í
;

139 
Àn
 -
thi¶í
;

143 i‡(
Àn
) {

144 
numblocks
;

146 
block
 = 
	`zmÆloc
((*block));

147 
block
->
‰ì
 = 
AOF_RW_BUF_BLOCK_SIZE
;

148 
block
->
u£d
 = 0;

149 
	`li°AddNodeTaû
(
£rvî
.
aof_ªwrôe_buf_blocks
,
block
);

153 
numblocks
 = 
	`li°Lígth
(
£rvî
.
aof_ªwrôe_buf_blocks
);

154 i‡(((
numblocks
+1) % 10) == 0) {

155 
Àvñ
 = ((
numblocks
+1Ë% 100Ë=0 ? 
LL_WARNING
 :

156 
LL_NOTICE
;

157 
	`£rvîLog
(
Àvñ
,"Background AOF buffer size: %lu MB",

158 
	`aofRewrôeBuf„rSize
()/(1024*1024));

165 i‡(
	`´GëFûeEvíts
(
£rvî
.
ñ
,£rvî.
aof_pùe_wrôe_d©a_to_chûd
) == 0) {

166 
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, sîvî.
aof_pùe_wrôe_d©a_to_chûd
,

167 
AE_WRITABLE
, 
aofChûdWrôeDiffD©a
, 
NULL
);

169 
	}
}

174 
ssize_t
 
	$aofRewrôeBuf„rWrôe
(
fd
) {

175 
li°Node
 *
 
;

176 
li°Iãr
 
li
;

177 
ssize_t
 
cou¡
 = 0;

179 
	`li°Rewöd
(
£rvî
.
aof_ªwrôe_buf_blocks
,&
li
);

180 (
 
 = 
	`li°Next
(&
li
))) {

181 
ao‰wblock
 *
block
 = 
	`li°NodeVÆue
(
 
);

182 
ssize_t
 
nwrôãn
;

184 i‡(
block
->
u£d
) {

185 
nwrôãn
 = 
	`wrôe
(
fd
,
block
->
buf
,block->
u£d
);

186 i‡(
nwrôãn
 !(
ssize_t
)
block
->
u£d
) {

187 i‡(
nwrôãn
 =0Ë
î∫o
 = 
EIO
;

190 
cou¡
 +
nwrôãn
;

193  
cou¡
;

194 
	}
}

202 
	$aofFsyncInProgªss
() {

203  
	`bioPídögJobsOfTy≥
(
BIO_AOF_FSYNC
) != 0;

204 
	}
}

208 
	$aof_background_fsync
(
fd
) {

209 
	`bioCª©eBackgroundJob
(
BIO_AOF_FSYNC
,(*)()
fd
,
NULL
,NULL);

210 
	}
}

213 
	$kûlAµídO∆yChûd
() {

214 
°©loc
;

216 i‡(
£rvî
.
aof_chûd_pid
 == -1) ;

218 
	`£rvîLog
(
LL_NOTICE
,"KillingÑunning AOFÑewrite child: %ld",

219 (Ë
£rvî
.
aof_chûd_pid
);

220 i‡(
	`kûl
(
£rvî
.
aof_chûd_pid
,
SIGUSR1
) != -1) {

221 
	`waô3
(&
°©loc
,0,
NULL
Ë!
£rvî
.
aof_chûd_pid
);

224 
	`aofRewrôeBuf„rRe£t
();

225 
	`aofRemoveTempFûe
(
£rvî
.
aof_chûd_pid
);

226 
£rvî
.
aof_chûd_pid
 = -1;

227 
£rvî
.
aof_ªwrôe_time_°¨t
 = -1;

229 
	`aofClo£Pùes
();

230 
	`˛o£ChûdInfoPùe
();

231 
	`upd©eDi˘ResizePﬁicy
();

232 
	}
}

236 
	$°›AµídO∆y
() {

237 
	`£rvîAs£π
(
£rvî
.
aof_°©e
 !
AOF_OFF
);

238 
	`ÊushAµídO∆yFûe
(1);

239 
	`ªdis_fsync
(
£rvî
.
aof_fd
);

240 
	`˛o£
(
£rvî
.
aof_fd
);

242 
£rvî
.
aof_fd
 = -1;

243 
£rvî
.
aof_£À˘ed_db
 = -1;

244 
£rvî
.
aof_°©e
 = 
AOF_OFF
;

245 
£rvî
.
aof_ªwrôe_scheduÀd
 = 0;

246 
	`kûlAµídO∆yChûd
();

247 
	}
}

251 
	$°¨tAµídO∆y
() {

252 
cwd
[
MAXPATHLEN
];

253 
√wfd
;

255 
√wfd
 = 
	`›í
(
£rvî
.
aof_fûíame
,
O_WRONLY
|
O_APPEND
|
O_CREAT
,0644);

256 
	`£rvîAs£π
(
£rvî
.
aof_°©e
 =
AOF_OFF
);

257 i‡(
√wfd
 == -1) {

258 *
cwdp
 = 
	`gëcwd
(
cwd
,
MAXPATHLEN
);

260 
	`£rvîLog
(
LL_WARNING
,

263 
£rvî
.
aof_fûíame
,

264 
cwdp
 ? cwdp : "unknown",

265 
	`°ªº‹
(
î∫o
));

266  
C_ERR
;

268 i‡(
	`hasA˘iveChûdPro˚ss
(Ë&& 
£rvî
.
aof_chûd_pid
 == -1) {

269 
£rvî
.
aof_ªwrôe_scheduÀd
 = 1;

270 
	`£rvîLog
(
LL_WARNING
,"AOF wasÉnabled butÅhere isálreadyánother background operation. An AOF background was scheduledÅo start whenÖossible.");

275 i‡(
£rvî
.
aof_chûd_pid
 != -1) {

276 
	`£rvîLog
(
LL_WARNING
,"AOF wasÉnabled butÅhere isálreadyán AOFÑewriting in background. Stopping background AOFánd startingáÑewriteÇow.");

277 
	`kûlAµídO∆yChûd
();

279 i‡(
	`ªwrôeAµídO∆yFûeBackground
(Ë=
C_ERR
) {

280 
	`˛o£
(
√wfd
);

281 
	`£rvîLog
(
LL_WARNING
,"RedisÇeedsÅoÉnableÅhe AOF but can'tÅriggerá background AOFÑewrite operation. CheckÅheáboveÜogs for more infoáboutÅheÉrror.");

282  
C_ERR
;

287 
£rvî
.
aof_°©e
 = 
AOF_WAIT_REWRITE
;

288 
£rvî
.
aof_œ°_fsync
 = sîvî.
unixtime
;

289 
£rvî
.
aof_fd
 = 
√wfd
;

290  
C_OK
;

291 
	}
}

300 
ssize_t
 
	$aofWrôe
(
fd
, c⁄° *
buf
, 
size_t
 
Àn
) {

301 
ssize_t
 
nwrôãn
 = 0, 
tŸwrôãn
 = 0;

303 
Àn
) {

304 
nwrôãn
 = 
	`wrôe
(
fd
, 
buf
, 
Àn
);

306 i‡(
nwrôãn
 < 0) {

307 i‡(
î∫o
 =
EINTR
) ;

308  
tŸwrôãn
 ?Åotwritten : -1;

311 
Àn
 -
nwrôãn
;

312 
buf
 +
nwrôãn
;

313 
tŸwrôãn
 +
nwrôãn
;

316  
tŸwrôãn
;

317 
	}
}

337 
	#AOF_WRITE_LOG_ERROR_RATE
 30

	)

338 
	$ÊushAµídO∆yFûe
(
f‹˚
) {

339 
ssize_t
 
nwrôãn
;

340 
sync_ö_¥ogªss
 = 0;

341 
m°ime_t
 
œãncy
;

343 i‡(
	`sd¶í
(
£rvî
.
aof_buf
) == 0) {

349 i‡(
£rvî
.
aof_fsync
 =
AOF_FSYNC_EVERYSEC
 &&

350 
£rvî
.
aof_fsync_off£t
 !£rvî.
aof_cuºít_size
 &&

351 
£rvî
.
unixtime
 > sîvî.
aof_œ°_fsync
 &&

352 !(
sync_ö_¥ogªss
 = 
	`aofFsyncInProgªss
())) {

353 
åy_fsync
;

359 i‡(
£rvî
.
aof_fsync
 =
AOF_FSYNC_EVERYSEC
)

360 
sync_ö_¥ogªss
 = 
	`aofFsyncInProgªss
();

362 i‡(
£rvî
.
aof_fsync
 =
AOF_FSYNC_EVERYSEC
 && !
f‹˚
) {

366 i‡(
sync_ö_¥ogªss
) {

367 i‡(
£rvî
.
aof_Êush_po°p⁄ed_°¨t
 == 0) {

370 
£rvî
.
aof_Êush_po°p⁄ed_°¨t
 = sîvî.
unixtime
;

372 } i‡(
£rvî
.
unixtime
 - sîvî.
aof_Êush_po°p⁄ed_°¨t
 < 2) {

379 
£rvî
.
aof_dñayed_fsync
++;

380 
	`£rvîLog
(
LL_NOTICE
,"Asynchronous AOF fsync isÅakingÅooÜong (disk is busy?). WritingÅhe AOF buffer without waiting for fsyncÅo complete,Åhis may slow down Redis.");

389 i‡(
£rvî
.
aof_Êush_¶ìp
 && 
	`sd¶í
(£rvî.
aof_buf
)) {

390 
	`u¶ìp
(
£rvî
.
aof_Êush_¶ìp
);

393 
	`œãncySèπM⁄ô‹
(
œãncy
);

394 
nwrôãn
 = 
	`aofWrôe
(
£rvî
.
aof_fd
,£rvî.
aof_buf
,
	`sd¶í
(server.aof_buf));

395 
	`œãncyEndM⁄ô‹
(
œãncy
);

401 i‡(
sync_ö_¥ogªss
) {

402 
	`œãncyAddSam∂eIfNìded
("aof-wrôe-≥ndög-fsync",
œãncy
);

403 } i‡(
	`hasA˘iveChûdPro˚ss
()) {

404 
	`œãncyAddSam∂eIfNìded
("aof-wrôe-a˘ive-chûd",
œãncy
);

406 
	`œãncyAddSam∂eIfNìded
("aof-wrôe-Æ⁄e",
œãncy
);

408 
	`œãncyAddSam∂eIfNìded
("aof-wrôe",
œãncy
);

411 
£rvî
.
aof_Êush_po°p⁄ed_°¨t
 = 0;

413 i‡(
nwrôãn
 !(
ssize_t
)
	`sd¶í
(
£rvî
.
aof_buf
)) {

414 
time_t
 
œ°_wrôe_îr‹_log
 = 0;

415 
ˇn_log
 = 0;

418 i‡((
£rvî
.
unixtime
 - 
œ°_wrôe_îr‹_log
Ë> 
AOF_WRITE_LOG_ERROR_RATE
) {

419 
ˇn_log
 = 1;

420 
œ°_wrôe_îr‹_log
 = 
£rvî
.
unixtime
;

424 i‡(
nwrôãn
 == -1) {

425 i‡(
ˇn_log
) {

426 
	`£rvîLog
(
LL_WARNING
,"Error writingÅoÅhe AOF file: %s",

427 
	`°ªº‹
(
î∫o
));

428 
£rvî
.
aof_œ°_wrôe_î∫o
 = 
î∫o
;

431 i‡(
ˇn_log
) {

432 
	`£rvîLog
(
LL_WARNING
,"Short write while writingÅo "

435 ()
nwrôãn
,

436 ()
	`sd¶í
(
£rvî
.
aof_buf
));

439 i‡(
	`·runˇã
(
£rvî
.
aof_fd
, sîvî.
aof_cuºít_size
) == -1) {

440 i‡(
ˇn_log
) {

441 
	`£rvîLog
(
LL_WARNING
, "CouldÇotÑemove short write "

444 "·runˇã: %s", 
	`°ªº‹
(
î∫o
));

449 
nwrôãn
 = -1;

451 
£rvî
.
aof_œ°_wrôe_î∫o
 = 
ENOSPC
;

455 i‡(
£rvî
.
aof_fsync
 =
AOF_FSYNC_ALWAYS
) {

460 
	`£rvîLog
(
LL_WARNING
,"Can'tÑecover from AOF writeÉrror whenÅhe AOF fsyncÖolicy is 'always'. Exiting...");

461 
	`exô
(1);

466 
£rvî
.
aof_œ°_wrôe_°©us
 = 
C_ERR
;

470 i‡(
nwrôãn
 > 0) {

471 
£rvî
.
aof_cuºít_size
 +
nwrôãn
;

472 
	`sd§™ge
(
£rvî
.
aof_buf
,
nwrôãn
,-1);

479 i‡(
£rvî
.
aof_œ°_wrôe_°©us
 =
C_ERR
) {

480 
	`£rvîLog
(
LL_WARNING
,

482 
£rvî
.
aof_œ°_wrôe_°©us
 = 
C_OK
;

485 
£rvî
.
aof_cuºít_size
 +
nwrôãn
;

489 i‡((
	`sd¶í
(
£rvî
.
aof_buf
)+
	`sdßvaû
(server.aof_buf)) < 4000) {

490 
	`sds˛ór
(
£rvî
.
aof_buf
);

492 
	`sds‰ì
(
£rvî
.
aof_buf
);

493 
£rvî
.
aof_buf
 = 
	`sd£m±y
();

496 
åy_fsync
:

499 i‡(
£rvî
.
aof_no_fsync_⁄_ªwrôe
 && 
	`hasA˘iveChûdPro˚ss
())

503 i‡(
£rvî
.
aof_fsync
 =
AOF_FSYNC_ALWAYS
) {

506 
	`œãncySèπM⁄ô‹
(
œãncy
);

507 
	`ªdis_fsync
(
£rvî
.
aof_fd
);

508 
	`œãncyEndM⁄ô‹
(
œãncy
);

509 
	`œãncyAddSam∂eIfNìded
("aof-fsync-Æways",
œãncy
);

510 
£rvî
.
aof_fsync_off£t
 = sîvî.
aof_cuºít_size
;

511 
£rvî
.
aof_œ°_fsync
 = sîvî.
unixtime
;

512 } i‡((
£rvî
.
aof_fsync
 =
AOF_FSYNC_EVERYSEC
 &&

513 
£rvî
.
unixtime
 > sîvî.
aof_œ°_fsync
)) {

514 i‡(!
sync_ö_¥ogªss
) {

515 
	`aof_background_fsync
(
£rvî
.
aof_fd
);

516 
£rvî
.
aof_fsync_off£t
 = sîvî.
aof_cuºít_size
;

518 
£rvî
.
aof_œ°_fsync
 = sîvî.
unixtime
;

520 
	}
}

522 
sds
 
	$ˇtAµídO∆yGíîicComm™d
(
sds
 
d°
, 
¨gc
, 
robj
 **
¨gv
) {

523 
buf
[32];

524 
Àn
, 
j
;

525 
robj
 *
o
;

527 
buf
[0] = '*';

528 
Àn
 = 1+
	`Œ2°rög
(
buf
+1,(buf)-1,
¨gc
);

529 
buf
[
Àn
++] = '\r';

530 
buf
[
Àn
++] = '\n';

531 
d°
 = 
	`sdsˇéí
(d°,
buf
,
Àn
);

533 
j
 = 0; j < 
¨gc
; j++) {

534 
o
 = 
	`gëDecodedObje˘
(
¨gv
[
j
]);

535 
buf
[0] = '$';

536 
Àn
 = 1+
	`Œ2°rög
(
buf
+1,(buf)-1,
	`sd¶í
(
o
->
±r
));

537 
buf
[
Àn
++] = '\r';

538 
buf
[
Àn
++] = '\n';

539 
d°
 = 
	`sdsˇéí
(d°,
buf
,
Àn
);

540 
d°
 = 
	`sdsˇéí
(d°,
o
->
±r
,
	`sd¶í
(o->ptr));

541 
d°
 = 
	`sdsˇéí
(dst,"\r\n",2);

542 
	`de¸RefCou¡
(
o
);

544  
d°
;

545 
	}
}

554 
sds
 
	$ˇtAµídO∆yExpúeAtComm™d
(
sds
 
buf
, 
ªdisComm™d
 *
cmd
, 
robj
 *
key
,Ñobj *
£c⁄ds
) {

555 
whí
;

556 
robj
 *
¨gv
[3];

559 
£c⁄ds
 = 
	`gëDecodedObje˘
(seconds);

560 
whí
 = 
	`°πﬁl
(
£c⁄ds
->
±r
,
NULL
,10);

562 i‡(
cmd
->
¥oc
 =
expúeComm™d
 || cmd->¥o¯=
£ãxComm™d
 ||

563 
cmd
->
¥oc
 =
expúótComm™d
)

565 
whí
 *= 1000;

568 i‡(
cmd
->
¥oc
 =
expúeComm™d
 || cmd->¥o¯=
≥xpúeComm™d
 ||

569 
cmd
->
¥oc
 =
£ãxComm™d
 || cmd->¥o¯=
p£ãxComm™d
)

571 
whí
 +
	`m°ime
();

573 
	`de¸RefCou¡
(
£c⁄ds
);

575 
¨gv
[0] = 
	`¸óãSåögObje˘
("PEXPIREAT",9);

576 
¨gv
[1] = 
key
;

577 
¨gv
[2] = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
whí
);

578 
buf
 = 
	`ˇtAµídO∆yGíîicComm™d
(buf, 3, 
¨gv
);

579 
	`de¸RefCou¡
(
¨gv
[0]);

580 
	`de¸RefCou¡
(
¨gv
[2]);

581  
buf
;

582 
	}
}

584 
	$„edAµídO∆yFûe
(
ªdisComm™d
 *
cmd
, 
di˘id
, 
robj
 **
¨gv
, 
¨gc
) {

585 
sds
 
buf
 = 
	`sd£m±y
();

586 
robj
 *
tm∑rgv
[3];

590 i‡(
di˘id
 !
£rvî
.
aof_£À˘ed_db
) {

591 
£ldb
[64];

593 
	`¢¥ötf
(
£ldb
,(£ldb),"%d",
di˘id
);

594 
buf
 = 
	`sdsˇçrötf
(buf,"*2\r\n$6\r\nSELECT\r\n$%lu\r\n%s\r\n",

595 ()
	`°æí
(
£ldb
),seldb);

596 
£rvî
.
aof_£À˘ed_db
 = 
di˘id
;

599 i‡(
cmd
->
¥oc
 =
expúeComm™d
 || cmd->¥o¯=
≥xpúeComm™d
 ||

600 
cmd
->
¥oc
 =
expúótComm™d
) {

602 
buf
 = 
	`ˇtAµídO∆yExpúeAtComm™d
(buf,
cmd
,
¨gv
[1],argv[2]);

603 } i‡(
cmd
->
¥oc
 =
£ãxComm™d
 || cmd->¥o¯=
p£ãxComm™d
) {

605 
tm∑rgv
[0] = 
	`¸óãSåögObje˘
("SET",3);

606 
tm∑rgv
[1] = 
¨gv
[1];

607 
tm∑rgv
[2] = 
¨gv
[3];

608 
buf
 = 
	`ˇtAµídO∆yGíîicComm™d
(buf,3,
tm∑rgv
);

609 
	`de¸RefCou¡
(
tm∑rgv
[0]);

610 
buf
 = 
	`ˇtAµídO∆yExpúeAtComm™d
(buf,
cmd
,
¨gv
[1],argv[2]);

611 } i‡(
cmd
->
¥oc
 =
£tComm™d
 && 
¨gc
 > 3) {

612 
i
;

613 
robj
 *
ex¨g
 = 
NULL
, *
px¨g
 = NULL;

615 
buf
 = 
	`ˇtAµídO∆yGíîicComm™d
(buf,3,
¨gv
);

616 
i
 = 3; i < 
¨gc
; i ++) {

617 i‡(!
	`°rˇ£cmp
(
¨gv
[
i
]->
±r
, "ex")Ë
ex¨g
 =árgv[i+1];

618 i‡(!
	`°rˇ£cmp
(
¨gv
[
i
]->
±r
, "px")Ë
px¨g
 =árgv[i+1];

620 
	`£rvîAs£π
(!(
ex¨g
 && 
px¨g
));

621 i‡(
ex¨g
)

622 
buf
 = 
	`ˇtAµídO∆yExpúeAtComm™d
(buf,
£rvî
.
expúeComm™d
,
¨gv
[1],

623 
ex¨g
);

624 i‡(
px¨g
)

625 
buf
 = 
	`ˇtAµídO∆yExpúeAtComm™d
(buf,
£rvî
.
≥xpúeComm™d
,
¨gv
[1],

626 
px¨g
);

631 
buf
 = 
	`ˇtAµídO∆yGíîicComm™d
(buf,
¨gc
,
¨gv
);

637 i‡(
£rvî
.
aof_°©e
 =
AOF_ON
)

638 
£rvî
.
aof_buf
 = 
	`sdsˇéí
(£rvî.aof_buf,
buf
,
	`sd¶í
(buf));

644 i‡(
£rvî
.
aof_chûd_pid
 != -1)

645 
	`aofRewrôeBuf„rAµíd
((*)
buf
,
	`sd¶í
(buf));

647 
	`sds‰ì
(
buf
);

648 
	}
}

656 
˛õ¡
 *
	$¸óãAOFClõ¡
() {

657 
˛õ¡
 *
c
 = 
	`zmÆloc
((*c));

659 
	`£À˘Db
(
c
,0);

660 
c
->
id
 = 
CLIENT_ID_AOF
;

661 
c
->
c⁄n
 = 
NULL
;

662 
c
->
«me
 = 
NULL
;

663 
c
->
quîybuf
 = 
	`sd£m±y
();

664 
c
->
quîybuf_≥ak
 = 0;

665 
c
->
¨gc
 = 0;

666 
c
->
¨gv
 = 
NULL
;

667 
c
->
buÂos
 = 0;

668 
c
->
Êags
 = 0;

669 
c
->
bty≥
 = 
BLOCKED_NONE
;

672 
c
->
ª∂°©e
 = 
SLAVE_STATE_WAIT_BGSAVE_START
;

673 
c
->
ª∂y
 = 
	`li°Cª©e
();

674 
c
->
ª∂y_byãs
 = 0;

675 
c
->
obuf_so·_limô_ªached_time
 = 0;

676 
c
->
w©ched_keys
 = 
	`li°Cª©e
();

677 
c
->
≥îid
 = 
NULL
;

678 
c
->
ª•
 = 2;

679 
c
->
u£r
 = 
NULL
;

680 
	`li°SëFªeMëhod
(
c
->
ª∂y
,
‰ìClõ¡RïlyVÆue
);

681 
	`li°SëDupMëhod
(
c
->
ª∂y
,
dupClõ¡RïlyVÆue
);

682 
	`öôClõ¡Mu…iSèã
(
c
);

683  
c
;

684 
	}
}

686 
	$‰ìFakeClõ¡Argv
(
˛õ¡
 *
c
) {

687 
j
;

689 
j
 = 0; j < 
c
->
¨gc
; j++)

690 
	`de¸RefCou¡
(
c
->
¨gv
[
j
]);

691 
	`z‰ì
(
c
->
¨gv
);

692 
	}
}

694 
	$‰ìFakeClõ¡
(
˛õ¡
 *
c
) {

695 
	`sds‰ì
(
c
->
quîybuf
);

696 
	`li°Rñó£
(
c
->
ª∂y
);

697 
	`li°Rñó£
(
c
->
w©ched_keys
);

698 
	`‰ìClõ¡Mu…iSèã
(
c
);

699 
	`z‰ì
(
c
);

700 
	}
}

705 
	$lﬂdAµídO∆yFûe
(*
fûíame
) {

706 
˛õ¡
 *
ÁkeClõ¡
;

707 
FILE
 *
Â
 = 
	`f›í
(
fûíame
,"r");

708 
ªdis_°©
 
sb
;

709 
ﬁd_aof_°©e
 = 
£rvî
.
aof_°©e
;

710 
lo›s
 = 0;

711 
off_t
 
vÆid_up_to
 = 0;

712 
off_t
 
vÆid_bef‹e_mu…i
 = 0;

714 i‡(
Â
 =
NULL
) {

715 
	`£rvîLog
(
LL_WARNING
,"F©ÆÉº‹: c™'à›íÅhê≠≥ndÜog fûêf‹Ñódög: %s",
	`°ªº‹
(
î∫o
));

716 
	`exô
(1);

723 i‡(
Â
 && 
	`ªdis_f°©
(
	`fûío
(Â),&
sb
Ë!-1 && sb.
°_size
 == 0) {

724 
£rvî
.
aof_cuºít_size
 = 0;

725 
£rvî
.
aof_fsync_off£t
 = sîvî.
aof_cuºít_size
;

726 
	`f˛o£
(
Â
);

727  
C_ERR
;

732 
£rvî
.
aof_°©e
 = 
AOF_OFF
;

734 
ÁkeClõ¡
 = 
	`¸óãAOFClõ¡
();

735 
	`°¨tLﬂdögFûe
(
Â
, 
fûíame
, 
RDBFLAGS_AOF_PREAMBLE
);

739 
sig
[5];

740 i‡(
	`‰ód
(
sig
,1,5,
Â
Ë!5 || 
	`memcmp
(sig,"REDIS",5) != 0) {

742 i‡(
	`f£ek
(
Â
,0,
SEEK_SET
Ë=-1Ë
ªadîr
;

745 
rio
 
rdb
;

747 
	`£rvîLog
(
LL_NOTICE
,"Reading RDBÖreamble from AOF file...");

748 i‡(
	`f£ek
(
Â
,0,
SEEK_SET
Ë=-1Ë
ªadîr
;

749 
	`rioInôWôhFûe
(&
rdb
,
Â
);

750 i‡(
	`rdbLﬂdRio
(&
rdb
,
RDBFLAGS_AOF_PREAMBLE
,
NULL
Ë!
C_OK
) {

751 
	`£rvîLog
(
LL_WARNING
,"ErrorÑeadingÅhe RDBÖreamble ofÅhe AOF file, AOFÜoadingáborted");

752 
ªadîr
;

754 
	`£rvîLog
(
LL_NOTICE
,"ReadingÅheÑemaining AOFÅail...");

760 
¨gc
, 
j
;

761 
Àn
;

762 
robj
 **
¨gv
;

763 
buf
[128];

764 
sds
 
¨gsds
;

765 
ªdisComm™d
 *
cmd
;

768 i‡(!(
lo›s
++ % 1000)) {

769 
	`lﬂdögProgªss
(
	`·ñlo
(
Â
));

770 
	`¥o˚ssEvítsWhûeBlocked
();

771 
	`¥o˚ssModuÀLﬂdögProgªssEvít
(1);

774 i‡(
	`fgës
(
buf
,(buf),
Â
Ë=
NULL
) {

775 i‡(
	`„of
(
Â
))

778 
ªadîr
;

780 i‡(
buf
[0] !'*'Ë
fmãº
;

781 i‡(
buf
[1] ='\0'Ë
ªadîr
;

782 
¨gc
 = 
	`©oi
(
buf
+1);

783 i‡(
¨gc
 < 1Ë
fmãº
;

787 
¨gv
 = 
	`zmÆloc
((
robj
*)*
¨gc
);

788 
ÁkeClõ¡
->
¨gc
 =árgc;

789 
ÁkeClõ¡
->
¨gv
 =árgv;

791 
j
 = 0; j < 
¨gc
; j++) {

793 *
ªadªs
 = 
	`fgës
(
buf
,(buf),
Â
);

794 i‡(
ªadªs
 =
NULL
 || 
buf
[0] != '$') {

795 
ÁkeClõ¡
->
¨gc
 = 
j
;

796 
	`‰ìFakeClõ¡Argv
(
ÁkeClõ¡
);

797 i‡(
ªadªs
 =
NULL
)

798 
ªadîr
;

800 
fmãº
;

802 
Àn
 = 
	`°πﬁ
(
buf
+1,
NULL
,10);

805 
¨gsds
 = 
	`sd¢ewÀn
(
SDS_NOINIT
,
Àn
);

806 i‡(
Àn
 && 
	`‰ód
(
¨gsds
,Àn,1,
Â
) == 0) {

807 
	`sds‰ì
(
¨gsds
);

808 
ÁkeClõ¡
->
¨gc
 = 
j
;

809 
	`‰ìFakeClõ¡Argv
(
ÁkeClõ¡
);

810 
ªadîr
;

812 
¨gv
[
j
] = 
	`¸óãObje˘
(
OBJ_STRING
,
¨gsds
);

815 i‡(
	`‰ód
(
buf
,2,1,
Â
) == 0) {

816 
ÁkeClõ¡
->
¨gc
 = 
j
+1;

817 
	`‰ìFakeClõ¡Argv
(
ÁkeClõ¡
);

818 
ªadîr
;

823 
cmd
 = 
	`lookupComm™d
(
¨gv
[0]->
±r
);

824 i‡(!
cmd
) {

825 
	`£rvîLog
(
LL_WARNING
,

827 (*)
¨gv
[0]->
±r
);

828 
	`exô
(1);

831 i‡(
cmd
 =
£rvî
.
mu…iComm™d
Ë
vÆid_bef‹e_mu…i
 = 
vÆid_up_to
;

834 
ÁkeClõ¡
->
cmd
 = fakeClõ¡->
œ°cmd
 = cmd;

835 i‡(
ÁkeClõ¡
->
Êags
 & 
CLIENT_MULTI
 &&

836 
ÁkeClõ¡
->
cmd
->
¥oc
 !
execComm™d
)

838 
	`queueMu…iComm™d
(
ÁkeClõ¡
);

840 
cmd
->
	`¥oc
(
ÁkeClõ¡
);

844 
	`£rvîAs£π
(
ÁkeClõ¡
->
buÂos
 == 0 &&

845 
	`li°Lígth
(
ÁkeClõ¡
->
ª∂y
) == 0);

848 
	`£rvîAs£π
((
ÁkeClõ¡
->
Êags
 & 
CLIENT_BLOCKED
) == 0);

852 
	`‰ìFakeClõ¡Argv
(
ÁkeClõ¡
);

853 
ÁkeClõ¡
->
cmd
 = 
NULL
;

854 i‡(
£rvî
.
aof_lﬂd_åunˇãd
Ë
vÆid_up_to
 = 
	`·ñlo
(
Â
);

855 i‡(
£rvî
.
key_lﬂd_dñay
)

856 
	`u¶ìp
(
£rvî
.
key_lﬂd_dñay
);

863 i‡(
ÁkeClõ¡
->
Êags
 & 
CLIENT_MULTI
) {

864 
	`£rvîLog
(
LL_WARNING
,

866 
vÆid_up_to
 = 
vÆid_bef‹e_mu…i
;

867 
uxeof
;

870 
lﬂded_ok
:

871 
	`f˛o£
(
Â
);

872 
	`‰ìFakeClõ¡
(
ÁkeClõ¡
);

873 
£rvî
.
aof_°©e
 = 
ﬁd_aof_°©e
;

874 
	`°›Lﬂdög
(1);

875 
	`aofUpd©eCuºítSize
();

876 
£rvî
.
aof_ªwrôe_ba£_size
 = sîvî.
aof_cuºít_size
;

877 
£rvî
.
aof_fsync_off£t
 = sîvî.
aof_cuºít_size
;

878  
C_OK
;

880 
ªadîr
:

881 i‡(!
	`„of
(
Â
)) {

882 i‡(
ÁkeClõ¡
Ë
	`‰ìFakeClõ¡
(fakeClient);

883 
	`f˛o£
(
Â
);

884 
	`£rvîLog
(
LL_WARNING
,"UƒecovîabÀÉº‹ÑódögÅhê≠≥nd o∆y fûe: %s", 
	`°ªº‹
(
î∫o
));

885 
	`exô
(1);

888 
uxeof
:

889 i‡(
£rvî
.
aof_lﬂd_åunˇãd
) {

890 
	`£rvîLog
(
LL_WARNING
,"!!! Warning: shortÑead whileÜoadingÅhe AOF file !!!");

891 
	`£rvîLog
(
LL_WARNING
,"!!! TruncatingÅhe AOFát offset %llu !!!",

892 (Ë
vÆid_up_to
);

893 i‡(
vÆid_up_to
 =-1 || 
	`åunˇã
(
fûíame
,valid_up_to) == -1) {

894 i‡(
vÆid_up_to
 == -1) {

895 
	`£rvîLog
(
LL_WARNING
,"Last valid command offset is invalid");

897 
	`£rvîLog
(
LL_WARNING
,"ErrorÅruncatingÅhe AOF file: %s",

898 
	`°ªº‹
(
î∫o
));

903 i‡(
£rvî
.
aof_fd
 !-1 && 
	`l£ek
(£rvî.aof_fd,0,
SEEK_END
) == -1) {

904 
	`£rvîLog
(
LL_WARNING
,"Can't seekÅheÉnd ofÅhe AOF file: %s",

905 
	`°ªº‹
(
î∫o
));

907 
	`£rvîLog
(
LL_WARNING
,

909 
lﬂded_ok
;

913 i‡(
ÁkeClõ¡
Ë
	`‰ìFakeClõ¡
(fakeClient);

914 
	`f˛o£
(
Â
);

915 
	`£rvîLog
(
LL_WARNING
,"UnexpectedÉnd of fileÑeadingÅheáppend only file. You can: 1) Makeá backup of your AOF file,Åhen use ./redis-check-aof --fix <filename>. 2) Alternatively you can setÅhe 'aof-load-truncated' configuration optionÅo yesándÑestartÅhe server.");

916 
	`exô
(1);

918 
fmãº
:

919 i‡(
ÁkeClõ¡
Ë
	`‰ìFakeClõ¡
(fakeClient);

920 
	`f˛o£
(
Â
);

921 
	`£rvîLog
(
LL_WARNING
,"Bad file formatÑeadingÅheáppend only file: makeá backup of your AOF file,Åhen use ./redis-check-aof --fix <filename>");

922 
	`exô
(1);

923 
	}
}

931 
	$rioWrôeBulkObje˘
(
rio
 *
r
, 
robj
 *
obj
) {

934 i‡(
obj
->
ícodög
 =
OBJ_ENCODING_INT
) {

935  
	`rioWrôeBulkL⁄gL⁄g
(
r
,()
obj
->
±r
);

936 } i‡(
	`sdsEncodedObje˘
(
obj
)) {

937  
	`rioWrôeBulkSåög
(
r
,
obj
->
±r
,
	`sd¶í
(obj->ptr));

939 
	`£rvîP™ic
("Unknown stringÉncoding");

941 
	}
}

945 
	$ªwrôeLi°Obje˘
(
rio
 *
r
, 
robj
 *
key
,Ñobj *
o
) {

946 
cou¡
 = 0, 
ôems
 = 
	`li°Ty≥Lígth
(
o
);

948 i‡(
o
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

949 
quickli°
 *
li°
 = 
o
->
±r
;

950 
quickli°Iãr
 *
li
 = 
	`quickli°GëIãøt‹
(
li°
, 
AL_START_HEAD
);

951 
quickli°E¡ry
 
íåy
;

953 
	`quickli°Next
(
li
,&
íåy
)) {

954 i‡(
cou¡
 == 0) {

955 
cmd_ôems
 = (
ôems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

956 
AOF_REWRITE_ITEMS_PER_CMD
 : 
ôems
;

957 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',2+
cmd_ôems
) == 0)  0;

958 i‡(
	`rioWrôeBulkSåög
(
r
,"RPUSH",5) == 0)  0;

959 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

962 i‡(
íåy
.
vÆue
) {

963 i‡(
	`rioWrôeBulkSåög
(
r
,(*)
íåy
.
vÆue
,íåy.
sz
) == 0)  0;

965 i‡(
	`rioWrôeBulkL⁄gL⁄g
(
r
,
íåy
.
l⁄gvÆ
) == 0)  0;

967 i‡(++
cou¡
 =
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

968 
ôems
--;

970 
	`quickli°Rñó£Iãøt‹
(
li
);

972 
	`£rvîP™ic
("UnknownÜistÉncoding");

975 
	}
}

979 
	$ªwrôeSëObje˘
(
rio
 *
r
, 
robj
 *
key
,Ñobj *
o
) {

980 
cou¡
 = 0, 
ôems
 = 
	`£tTy≥Size
(
o
);

982 i‡(
o
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

983 
ii
 = 0;

984 
öt64_t
 
ŒvÆ
;

986 
	`öt£tGë
(
o
->
±r
,
ii
++,&
ŒvÆ
)) {

987 i‡(
cou¡
 == 0) {

988 
cmd_ôems
 = (
ôems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

989 
AOF_REWRITE_ITEMS_PER_CMD
 : 
ôems
;

991 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',2+
cmd_ôems
) == 0)  0;

992 i‡(
	`rioWrôeBulkSåög
(
r
,"SADD",4) == 0)  0;

993 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

995 i‡(
	`rioWrôeBulkL⁄gL⁄g
(
r
,
ŒvÆ
) == 0)  0;

996 i‡(++
cou¡
 =
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

997 
ôems
--;

999 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

1000 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
o
->
±r
);

1001 
di˘E¡ry
 *
de
;

1003 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1004 
sds
 
ñe
 = 
	`di˘GëKey
(
de
);

1005 i‡(
cou¡
 == 0) {

1006 
cmd_ôems
 = (
ôems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

1007 
AOF_REWRITE_ITEMS_PER_CMD
 : 
ôems
;

1009 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',2+
cmd_ôems
) == 0)  0;

1010 i‡(
	`rioWrôeBulkSåög
(
r
,"SADD",4) == 0)  0;

1011 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

1013 i‡(
	`rioWrôeBulkSåög
(
r
,
ñe
,
	`sd¶í
(ele)) == 0)  0;

1014 i‡(++
cou¡
 =
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

1015 
ôems
--;

1017 
	`di˘Rñó£Iãøt‹
(
di
);

1019 
	`£rvîP™ic
("Unknown setÉncoding");

1022 
	}
}

1026 
	$ªwrôeS‹ãdSëObje˘
(
rio
 *
r
, 
robj
 *
key
,Ñobj *
o
) {

1027 
cou¡
 = 0, 
ôems
 = 
	`z£tLígth
(
o
);

1029 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1030 *
zl
 = 
o
->
±r
;

1031 *
ïå
, *
•å
;

1032 *
v°r
;

1033 
vÀn
;

1034 
vŒ
;

1035 
sc‹e
;

1037 
ïå
 = 
	`zùli°Index
(
zl
,0);

1038 
	`£rvîAs£π
(
ïå
 !
NULL
);

1039 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

1040 
	`£rvîAs£π
(
•å
 !
NULL
);

1042 
ïå
 !
NULL
) {

1043 
	`£rvîAs£π
(
	`zùli°Gë
(
ïå
,&
v°r
,&
vÀn
,&
vŒ
));

1044 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

1046 i‡(
cou¡
 == 0) {

1047 
cmd_ôems
 = (
ôems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

1048 
AOF_REWRITE_ITEMS_PER_CMD
 : 
ôems
;

1050 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',2+
cmd_ôems
*2) == 0)  0;

1051 i‡(
	`rioWrôeBulkSåög
(
r
,"ZADD",4) == 0)  0;

1052 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

1054 i‡(
	`rioWrôeBulkDoubÀ
(
r
,
sc‹e
) == 0)  0;

1055 i‡(
v°r
 !
NULL
) {

1056 i‡(
	`rioWrôeBulkSåög
(
r
,(*)
v°r
,
vÀn
) == 0)  0;

1058 i‡(
	`rioWrôeBulkL⁄gL⁄g
(
r
,
vŒ
) == 0)  0;

1060 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

1061 i‡(++
cou¡
 =
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

1062 
ôems
--;

1064 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1065 
z£t
 *
zs
 = 
o
->
±r
;

1066 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
zs
->
di˘
);

1067 
di˘E¡ry
 *
de
;

1069 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1070 
sds
 
ñe
 = 
	`di˘GëKey
(
de
);

1071 *
sc‹e
 = 
	`di˘GëVÆ
(
de
);

1073 i‡(
cou¡
 == 0) {

1074 
cmd_ôems
 = (
ôems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

1075 
AOF_REWRITE_ITEMS_PER_CMD
 : 
ôems
;

1077 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',2+
cmd_ôems
*2) == 0)  0;

1078 i‡(
	`rioWrôeBulkSåög
(
r
,"ZADD",4) == 0)  0;

1079 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

1081 i‡(
	`rioWrôeBulkDoubÀ
(
r
,*
sc‹e
) == 0)  0;

1082 i‡(
	`rioWrôeBulkSåög
(
r
,
ñe
,
	`sd¶í
(ele)) == 0)  0;

1083 i‡(++
cou¡
 =
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

1084 
ôems
--;

1086 
	`di˘Rñó£Iãøt‹
(
di
);

1088 
	`£rvîP™ic
("Unknown sorted zsetÉncoding");

1091 
	}
}

1099 
	$rioWrôeHashIãøt‹Curs‹
(
rio
 *
r
, 
hashTy≥Iãøt‹
 *
hi
, 
wh©
) {

1100 i‡(
hi
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1101 *
v°r
 = 
NULL
;

1102 
vÀn
 = 
UINT_MAX
;

1103 
vŒ
 = 
LLONG_MAX
;

1105 
	`hashTy≥CuºítFromZùli°
(
hi
, 
wh©
, &
v°r
, &
vÀn
, &
vŒ
);

1106 i‡(
v°r
)

1107  
	`rioWrôeBulkSåög
(
r
, (*)
v°r
, 
vÀn
);

1109  
	`rioWrôeBulkL⁄gL⁄g
(
r
, 
vŒ
);

1110 } i‡(
hi
->
ícodög
 =
OBJ_ENCODING_HT
) {

1111 
sds
 
vÆue
 = 
	`hashTy≥CuºítFromHashTabÀ
(
hi
, 
wh©
);

1112  
	`rioWrôeBulkSåög
(
r
, 
vÆue
, 
	`sd¶í
(value));

1115 
	`£rvîP™ic
("Unknown hashÉncoding");

1117 
	}
}

1121 
	$ªwrôeHashObje˘
(
rio
 *
r
, 
robj
 *
key
,Ñobj *
o
) {

1122 
hashTy≥Iãøt‹
 *
hi
;

1123 
cou¡
 = 0, 
ôems
 = 
	`hashTy≥Lígth
(
o
);

1125 
hi
 = 
	`hashTy≥InôIãøt‹
(
o
);

1126 
	`hashTy≥Next
(
hi
Ë!
C_ERR
) {

1127 i‡(
cou¡
 == 0) {

1128 
cmd_ôems
 = (
ôems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

1129 
AOF_REWRITE_ITEMS_PER_CMD
 : 
ôems
;

1131 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',2+
cmd_ôems
*2) == 0)  0;

1132 i‡(
	`rioWrôeBulkSåög
(
r
,"HMSET",5) == 0)  0;

1133 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

1136 i‡(
	`rioWrôeHashIãøt‹Curs‹
(
r
, 
hi
, 
OBJ_HASH_KEY
) == 0)  0;

1137 i‡(
	`rioWrôeHashIãøt‹Curs‹
(
r
, 
hi
, 
OBJ_HASH_VALUE
) == 0)  0;

1138 i‡(++
cou¡
 =
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

1139 
ôems
--;

1142 
	`hashTy≥Rñó£Iãøt‹
(
hi
);

1145 
	}
}

1149 
	$rioWrôeBulkSåómID
(
rio
 *
r
,
°ªamID
 *
id
) {

1150 
ªtvÆ
;

1152 
sds
 
ª∂yid
 = 
	`sdsˇtfmt
(
	`sd£m±y
(),"%U-%U",
id
->
ms
,id->
£q
);

1153 
ªtvÆ
 = 
	`rioWrôeBulkSåög
(
r
,
ª∂yid
,
	`sd¶í
(replyid));

1154 
	`sds‰ì
(
ª∂yid
);

1155  
ªtvÆ
;

1156 
	}
}

1162 
	$rioWrôeSåómPídögE¡ry
(
rio
 *
r
, 
robj
 *
key
, c⁄° *
grou≤ame
, 
size_t
 
grou≤ame_Àn
, 
°ªamC⁄sumî
 *
c⁄sumî
, *
øwid
, 
°ªamNACK
 *
«ck
) {

1165 
°ªamID
 
id
;

1166 
	`°ªamDecodeID
(
øwid
,&
id
);

1167 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',12) == 0)  0;

1168 i‡(
	`rioWrôeBulkSåög
(
r
,"XCLAIM",6) == 0)  0;

1169 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

1170 i‡(
	`rioWrôeBulkSåög
(
r
,
grou≤ame
,
grou≤ame_Àn
) == 0)  0;

1171 i‡(
	`rioWrôeBulkSåög
(
r
,
c⁄sumî
->
«me
,
	`sd¶í
(consumer->name)) == 0)  0;

1172 i‡(
	`rioWrôeBulkSåög
(
r
,"0",1) == 0)  0;

1173 i‡(
	`rioWrôeBulkSåómID
(
r
,&
id
) == 0)  0;

1174 i‡(
	`rioWrôeBulkSåög
(
r
,"TIME",4) == 0)  0;

1175 i‡(
	`rioWrôeBulkL⁄gL⁄g
(
r
,
«ck
->
dñivîy_time
) == 0)  0;

1176 i‡(
	`rioWrôeBulkSåög
(
r
,"RETRYCOUNT",10) == 0)  0;

1177 i‡(
	`rioWrôeBulkL⁄gL⁄g
(
r
,
«ck
->
dñivîy_cou¡
) == 0)  0;

1178 i‡(
	`rioWrôeBulkSåög
(
r
,"JUSTID",6) == 0)  0;

1179 i‡(
	`rioWrôeBulkSåög
(
r
,"FORCE",5) == 0)  0;

1181 
	}
}

1185 
	$ªwrôeSåómObje˘
(
rio
 *
r
, 
robj
 *
key
,Ñobj *
o
) {

1186 
°ªam
 *
s
 = 
o
->
±r
;

1187 
°ªamIãøt‹
 
si
;

1188 
	`°ªamIãøt‹Sèπ
(&
si
,
s
,
NULL
,NULL,0);

1189 
°ªamID
 
id
;

1190 
öt64_t
 
numfõlds
;

1192 i‡(
s
->
Àngth
) {

1194 
	`°ªamIãøt‹GëID
(&
si
,&
id
,&
numfõlds
)) {

1199 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',3+
numfõlds
*2) == 0)  0;

1200 i‡(
	`rioWrôeBulkSåög
(
r
,"XADD",4) == 0)  0;

1201 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

1202 i‡(
	`rioWrôeBulkSåómID
(
r
,&
id
) == 0)  0;

1203 
numfõlds
--) {

1204 *
fõld
, *
vÆue
;

1205 
öt64_t
 
fõld_Àn
, 
vÆue_Àn
;

1206 
	`°ªamIãøt‹GëFõld
(&
si
,&
fõld
,&
vÆue
,&
fõld_Àn
,&
vÆue_Àn
);

1207 i‡(
	`rioWrôeBulkSåög
(
r
,(*)
fõld
,
fõld_Àn
) == 0)  0;

1208 i‡(
	`rioWrôeBulkSåög
(
r
,(*)
vÆue
,
vÆue_Àn
) == 0)  0;

1215 
id
.
ms
 = 0; id.
£q
 = 1;

1216 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',7) == 0)  0;

1217 i‡(
	`rioWrôeBulkSåög
(
r
,"XADD",4) == 0)  0;

1218 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

1219 i‡(
	`rioWrôeBulkSåög
(
r
,"MAXLEN",6) == 0)  0;

1220 i‡(
	`rioWrôeBulkSåög
(
r
,"0",1) == 0)  0;

1221 i‡(
	`rioWrôeBulkSåómID
(
r
,&
id
) == 0)  0;

1222 i‡(
	`rioWrôeBulkSåög
(
r
,"x",1) == 0)  0;

1223 i‡(
	`rioWrôeBulkSåög
(
r
,"y",1) == 0)  0;

1228 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',3) == 0)  0;

1229 i‡(
	`rioWrôeBulkSåög
(
r
,"XSETID",6) == 0)  0;

1230 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

1231 i‡(
	`rioWrôeBulkSåómID
(
r
,&
s
->
œ°_id
) == 0)  0;

1235 i‡(
s
->
cgroups
) {

1236 
øxIãøt‹
 
ri
;

1237 
	`øxSèπ
(&
ri
,
s
->
cgroups
);

1238 
	`øxSìk
(&
ri
,"^",
NULL
,0);

1239 
	`øxNext
(&
ri
)) {

1240 
°ªamCG
 *
group
 = 
ri
.
d©a
;

1242 i‡(
	`rioWrôeBulkCou¡
(
r
,'*',5) == 0)  0;

1243 i‡(
	`rioWrôeBulkSåög
(
r
,"XGROUP",6) == 0)  0;

1244 i‡(
	`rioWrôeBulkSåög
(
r
,"CREATE",6) == 0)  0;

1245 i‡(
	`rioWrôeBulkObje˘
(
r
,
key
) == 0)  0;

1246 i‡(
	`rioWrôeBulkSåög
(
r
,(*)
ri
.
key
,ri.
key_Àn
) == 0)  0;

1247 i‡(
	`rioWrôeBulkSåómID
(
r
,&
group
->
œ°_id
) == 0)  0;

1252 
øxIãøt‹
 
ri_c⁄s
;

1253 
	`øxSèπ
(&
ri_c⁄s
,
group
->
c⁄sumîs
);

1254 
	`øxSìk
(&
ri_c⁄s
,"^",
NULL
,0);

1255 
	`øxNext
(&
ri_c⁄s
)) {

1256 
°ªamC⁄sumî
 *
c⁄sumî
 = 
ri_c⁄s
.
d©a
;

1259 
øxIãøt‹
 
ri_≥l
;

1260 
	`øxSèπ
(&
ri_≥l
,
c⁄sumî
->
≥l
);

1261 
	`øxSìk
(&
ri_≥l
,"^",
NULL
,0);

1262 
	`øxNext
(&
ri_≥l
)) {

1263 
°ªamNACK
 *
«ck
 = 
ri_≥l
.
d©a
;

1264 i‡(
	`rioWrôeSåómPídögE¡ry
(
r
,
key
,(*)
ri
.key,

1265 
ri
.
key_Àn
,
c⁄sumî
,

1266 
ri_≥l
.
key
,
«ck
) == 0)

1271 
	`øxSt›
(&
ri_≥l
);

1273 
	`øxSt›
(&
ri_c⁄s
);

1275 
	`øxSt›
(&
ri
);

1278 
	`°ªamIãøt‹St›
(&
si
);

1280 
	}
}

1285 
	$ªwrôeModuÀObje˘
(
rio
 *
r
, 
robj
 *
key
,Ñobj *
o
) {

1286 
RedisModuÀIO
 
io
;

1287 
moduÀVÆue
 *
mv
 = 
o
->
±r
;

1288 
moduÀTy≥
 *
mt
 = 
mv
->
ty≥
;

1289 
	`moduÀInôIOC⁄ãxt
(
io
,
mt
,
r
,
key
);

1290 
mt
->
	`aof_ªwrôe
(&
io
,
key
,
mv
->
vÆue
);

1291 i‡(
io
.
˘x
) {

1292 
	`moduÀFªeC⁄ãxt
(
io
.
˘x
);

1293 
	`z‰ì
(
io
.
˘x
);

1295  
io
.
îr‹
 ? 0 : 1;

1296 
	}
}

1301 
ssize_t
 
	$aofRódDiffFromP¨ít
() {

1302 
buf
[65536];

1303 
ssize_t
 
ƒód
, 
tŸÆ
 = 0;

1305 (
ƒód
 =

1306 
	`ªad
(
£rvî
.
aof_pùe_ªad_d©a_‰om_∑ª¡
,
buf
,(buf))) > 0) {

1307 
£rvî
.
aof_chûd_diff
 = 
	`sdsˇéí
(£rvî.aof_chûd_diff,
buf
,
ƒód
);

1308 
tŸÆ
 +
ƒód
;

1310  
tŸÆ
;

1311 
	}
}

1313 
	$ªwrôeAµídO∆yFûeRio
(
rio
 *
aof
) {

1314 
di˘Iãøt‹
 *
di
 = 
NULL
;

1315 
di˘E¡ry
 *
de
;

1316 
size_t
 
¥o˚s£d
 = 0;

1317 
j
;

1319 
j
 = 0; j < 
£rvî
.
dbnum
; j++) {

1320 
£À˘cmd
[] = "*2\r\n$6\r\nSELECT\r\n";

1321 
ªdisDb
 *
db
 = 
£rvî
.db+
j
;

1322 
di˘
 *
d
 = 
db
->dict;

1323 i‡(
	`di˘Size
(
d
) == 0) ;

1324 
di
 = 
	`di˘GëSa„Iãøt‹
(
d
);

1327 i‡(
	`rioWrôe
(
aof
,
£À˘cmd
,(£À˘cmd)-1Ë=0Ë
wîr
;

1328 i‡(
	`rioWrôeBulkL⁄gL⁄g
(
aof
,
j
Ë=0Ë
wîr
;

1331 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1332 
sds
 
key°r
;

1333 
robj
 
key
, *
o
;

1334 
expúëime
;

1336 
key°r
 = 
	`di˘GëKey
(
de
);

1337 
o
 = 
	`di˘GëVÆ
(
de
);

1338 
	`öôSèticSåögObje˘
(
key
,
key°r
);

1340 
expúëime
 = 
	`gëExpúe
(
db
,&
key
);

1343 i‡(
o
->
ty≥
 =
OBJ_STRING
) {

1345 
cmd
[]="*3\r\n$3\r\nSET\r\n";

1346 i‡(
	`rioWrôe
(
aof
,
cmd
,(cmd)-1Ë=0Ë
wîr
;

1348 i‡(
	`rioWrôeBulkObje˘
(
aof
,&
key
Ë=0Ë
wîr
;

1349 i‡(
	`rioWrôeBulkObje˘
(
aof
,
o
Ë=0Ë
wîr
;

1350 } i‡(
o
->
ty≥
 =
OBJ_LIST
) {

1351 i‡(
	`ªwrôeLi°Obje˘
(
aof
,&
key
,
o
Ë=0Ë
wîr
;

1352 } i‡(
o
->
ty≥
 =
OBJ_SET
) {

1353 i‡(
	`ªwrôeSëObje˘
(
aof
,&
key
,
o
Ë=0Ë
wîr
;

1354 } i‡(
o
->
ty≥
 =
OBJ_ZSET
) {

1355 i‡(
	`ªwrôeS‹ãdSëObje˘
(
aof
,&
key
,
o
Ë=0Ë
wîr
;

1356 } i‡(
o
->
ty≥
 =
OBJ_HASH
) {

1357 i‡(
	`ªwrôeHashObje˘
(
aof
,&
key
,
o
Ë=0Ë
wîr
;

1358 } i‡(
o
->
ty≥
 =
OBJ_STREAM
) {

1359 i‡(
	`ªwrôeSåómObje˘
(
aof
,&
key
,
o
Ë=0Ë
wîr
;

1360 } i‡(
o
->
ty≥
 =
OBJ_MODULE
) {

1361 i‡(
	`ªwrôeModuÀObje˘
(
aof
,&
key
,
o
Ë=0Ë
wîr
;

1363 
	`£rvîP™ic
("Unknown objectÅype");

1366 i‡(
expúëime
 != -1) {

1367 
cmd
[]="*3\r\n$9\r\nPEXPIREAT\r\n";

1368 i‡(
	`rioWrôe
(
aof
,
cmd
,(cmd)-1Ë=0Ë
wîr
;

1369 i‡(
	`rioWrôeBulkObje˘
(
aof
,&
key
Ë=0Ë
wîr
;

1370 i‡(
	`rioWrôeBulkL⁄gL⁄g
(
aof
,
expúëime
Ë=0Ë
wîr
;

1373 i‡(
aof
->
¥o˚s£d_byãs
 > 
¥o˚s£d
+
AOF_READ_DIFF_INTERVAL_BYTES
) {

1374 
¥o˚s£d
 = 
aof
->
¥o˚s£d_byãs
;

1375 
	`aofRódDiffFromP¨ít
();

1378 
	`di˘Rñó£Iãøt‹
(
di
);

1379 
di
 = 
NULL
;

1381  
C_OK
;

1383 
wîr
:

1384 i‡(
di
Ë
	`di˘Rñó£Iãøt‹
(di);

1385  
C_ERR
;

1386 
	}
}

1395 
	$ªwrôeAµídO∆yFûe
(*
fûíame
) {

1396 
rio
 
aof
;

1397 
FILE
 *
Â
;

1398 
tmpfûe
[256];

1399 
byã
;

1403 
	`¢¥ötf
(
tmpfûe
,256,"ãmp-ªwrôóof-%d.aof", (Ë
	`gëpid
());

1404 
Â
 = 
	`f›í
(
tmpfûe
,"w");

1405 i‡(!
Â
) {

1406 
	`£rvîLog
(
LL_WARNING
, "O≥nögÅhêãm∞fûêf‹ AOFÑewrôêöÑewrôeAµídO∆yFûe(): %s", 
	`°ªº‹
(
î∫o
));

1407  
C_ERR
;

1410 
£rvî
.
aof_chûd_diff
 = 
	`sd£m±y
();

1411 
	`rioInôWôhFûe
(&
aof
,
Â
);

1413 i‡(
£rvî
.
aof_ªwrôe_ö¸emíèl_fsync
)

1414 
	`rioSëAutoSync
(&
aof
,
REDIS_AUTOSYNC_BYTES
);

1416 
	`°¨tSavög
(
RDBFLAGS_AOF_PREAMBLE
);

1418 i‡(
£rvî
.
aof_u£_rdb_¥ómbÀ
) {

1419 
îr‹
;

1420 i‡(
	`rdbSaveRio
(&
aof
,&
îr‹
,
RDBFLAGS_AOF_PREAMBLE
,
NULL
Ë=
C_ERR
) {

1421 
î∫o
 = 
îr‹
;

1422 
wîr
;

1425 i‡(
	`ªwrôeAµídO∆yFûeRio
(&
aof
Ë=
C_ERR
Ë
wîr
;

1430 i‡(
	`fÊush
(
Â
Ë=
EOF
Ë
wîr
;

1431 i‡(
	`fsync
(
	`fûío
(
Â
)Ë=-1Ë
wîr
;

1439 
nod©a
 = 0;

1440 
m°ime_t
 
°¨t
 = 
	`m°ime
();

1441 
	`m°ime
()-
°¨t
 < 1000 && 
nod©a
 < 20) {

1442 i‡(
	`´Waô
(
£rvî
.
aof_pùe_ªad_d©a_‰om_∑ª¡
, 
AE_READABLE
, 1) <= 0)

1444 
nod©a
++;

1447 
nod©a
 = 0;

1449 
	`aofRódDiffFromP¨ít
();

1453 i‡(
	`wrôe
(
£rvî
.
aof_pùe_wrôe_ack_to_∑ª¡
,"!",1Ë!1Ë
wîr
;

1454 i‡(
	`™ëN⁄Block
(
NULL
,
£rvî
.
aof_pùe_ªad_ack_‰om_∑ª¡
Ë!
ANET_OK
)

1455 
wîr
;

1459 i‡(
	`syncRód
(
£rvî
.
aof_pùe_ªad_ack_‰om_∑ª¡
,&
byã
,1,5000) != 1 ||

1460 
byã
 !'!'Ë
wîr
;

1461 
	`£rvîLog
(
LL_NOTICE
,"ParentágreedÅo stop sending diffs. Finalizing AOF...");

1464 
	`aofRódDiffFromP¨ít
();

1467 
	`£rvîLog
(
LL_NOTICE
,

1469 (Ë
	`sd¶í
(
£rvî
.
aof_chûd_diff
) / (1024*1024));

1470 i‡(
	`rioWrôe
(&
aof
,
£rvî
.
aof_chûd_diff
,
	`sd¶í
(server.aof_child_diff)) == 0)

1471 
wîr
;

1474 i‡(
	`fÊush
(
Â
Ë=
EOF
Ë
wîr
;

1475 i‡(
	`fsync
(
	`fûío
(
Â
)Ë=-1Ë
wîr
;

1476 i‡(
	`f˛o£
(
Â
Ë=
EOF
Ë
wîr
;

1480 i‡(
	`ª«me
(
tmpfûe
,
fûíame
) == -1) {

1481 
	`£rvîLog
(
LL_WARNING
,"Eº‹ movögÅem∞≠≥nd o∆y fûê⁄ÅhêföÆ de°ö©i⁄: %s", 
	`°ªº‹
(
î∫o
));

1482 
	`u∆ök
(
tmpfûe
);

1483 
	`°›Savög
(0);

1484  
C_ERR
;

1486 
	`£rvîLog
(
LL_NOTICE
,"SYNCáppend only fileÑewriteÖerformed");

1487 
	`°›Savög
(1);

1488  
C_OK
;

1490 
wîr
:

1491 
	`£rvîLog
(
LL_WARNING
,"Wrôêîr‹ wrôögáµíd o∆y fûê⁄ disk: %s", 
	`°ªº‹
(
î∫o
));

1492 
	`f˛o£
(
Â
);

1493 
	`u∆ök
(
tmpfûe
);

1494 
	`°›Savög
(0);

1495  
C_ERR
;

1496 
	}
}

1505 
	$aofChûdPùeRódabÀ
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

1506 
byã
;

1507 
	`UNUSED
(
ñ
);

1508 
	`UNUSED
(
¥ivd©a
);

1509 
	`UNUSED
(
mask
);

1511 i‡(
	`ªad
(
fd
,&
byã
,1) == 1 && byte == '!') {

1512 
	`£rvîLog
(
LL_NOTICE
,"AOFÑewrite childásksÅo stop sending diffs.");

1513 
£rvî
.
aof_°›_£ndög_diff
 = 1;

1514 i‡(
	`wrôe
(
£rvî
.
aof_pùe_wrôe_ack_to_chûd
,"!",1) != 1) {

1519 
	`£rvîLog
(
LL_WARNING
,"Can't send ACKÅo AOF child: %s",

1520 
	`°ªº‹
(
î∫o
));

1525 
	`´DñëeFûeEvít
(
£rvî
.
ñ
,£rvî.
aof_pùe_ªad_ack_‰om_chûd
,
AE_READABLE
);

1526 
	}
}

1533 
	$aofCª©ePùes
() {

1534 
fds
[6] = {-1, -1, -1, -1, -1, -1};

1535 
j
;

1537 i‡(
	`pùe
(
fds
Ë=-1Ë
îr‹
;

1538 i‡(
	`pùe
(
fds
+2Ë=-1Ë
îr‹
;

1539 i‡(
	`pùe
(
fds
+4Ë=-1Ë
îr‹
;

1541 i‡(
	`™ëN⁄Block
(
NULL
,
fds
[0]Ë!
ANET_OK
Ë
îr‹
;

1542 i‡(
	`™ëN⁄Block
(
NULL
,
fds
[1]Ë!
ANET_OK
Ë
îr‹
;

1543 i‡(
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, 
fds
[2], 
AE_READABLE
, 
aofChûdPùeRódabÀ
, 
NULL
Ë=
AE_ERR
Ë
îr‹
;

1545 
£rvî
.
aof_pùe_wrôe_d©a_to_chûd
 = 
fds
[1];

1546 
£rvî
.
aof_pùe_ªad_d©a_‰om_∑ª¡
 = 
fds
[0];

1547 
£rvî
.
aof_pùe_wrôe_ack_to_∑ª¡
 = 
fds
[3];

1548 
£rvî
.
aof_pùe_ªad_ack_‰om_chûd
 = 
fds
[2];

1549 
£rvî
.
aof_pùe_wrôe_ack_to_chûd
 = 
fds
[5];

1550 
£rvî
.
aof_pùe_ªad_ack_‰om_∑ª¡
 = 
fds
[4];

1551 
£rvî
.
aof_°›_£ndög_diff
 = 0;

1552  
C_OK
;

1554 
îr‹
:

1555 
	`£rvîLog
(
LL_WARNING
,"Error opening /setting AOFÑewrite IPCÖipes: %s",

1556 
	`°ªº‹
(
î∫o
));

1557 
j
 = 0; j < 6; j++Ëif(
fds
[j] !-1Ë
	`˛o£
(fds[j]);

1558  
C_ERR
;

1559 
	}
}

1561 
	$aofClo£Pùes
() {

1562 
	`´DñëeFûeEvít
(
£rvî
.
ñ
,£rvî.
aof_pùe_ªad_ack_‰om_chûd
,
AE_READABLE
);

1563 
	`´DñëeFûeEvít
(
£rvî
.
ñ
,£rvî.
aof_pùe_wrôe_d©a_to_chûd
,
AE_WRITABLE
);

1564 
	`˛o£
(
£rvî
.
aof_pùe_wrôe_d©a_to_chûd
);

1565 
	`˛o£
(
£rvî
.
aof_pùe_ªad_d©a_‰om_∑ª¡
);

1566 
	`˛o£
(
£rvî
.
aof_pùe_wrôe_ack_to_∑ª¡
);

1567 
	`˛o£
(
£rvî
.
aof_pùe_ªad_ack_‰om_chûd
);

1568 
	`˛o£
(
£rvî
.
aof_pùe_wrôe_ack_to_chûd
);

1569 
	`˛o£
(
£rvî
.
aof_pùe_ªad_ack_‰om_∑ª¡
);

1570 
	}
}

1588 
	$ªwrôeAµídO∆yFûeBackground
() {

1589 
pid_t
 
chûdpid
;

1591 i‡(
	`hasA˘iveChûdPro˚ss
()Ë 
C_ERR
;

1592 i‡(
	`aofCª©ePùes
(Ë!
C_OK
Ë 
C_ERR
;

1593 
	`›íChûdInfoPùe
();

1594 i‡((
chûdpid
 = 
	`ªdisF‹k
()) == 0) {

1595 
tmpfûe
[256];

1598 
	`ªdisSëProcTôÀ
("redis-aof-rewrite");

1599 
	`ªdisSëCpuAfföôy
(
£rvî
.
aof_ªwrôe_˝uli°
);

1600 
	`¢¥ötf
(
tmpfûe
,256,"ãmp-ªwrôóof-bg-%d.aof", (Ë
	`gëpid
());

1601 i‡(
	`ªwrôeAµídO∆yFûe
(
tmpfûe
Ë=
C_OK
) {

1602 
	`£ndChûdCOWInfo
(
CHILD_INFO_TYPE_AOF
, "AOFÑewrite");

1603 
	`exôFromChûd
(0);

1605 
	`exôFromChûd
(1);

1609 i‡(
chûdpid
 == -1) {

1610 
	`˛o£ChûdInfoPùe
();

1611 
	`£rvîLog
(
LL_WARNING
,

1613 
	`°ªº‹
(
î∫o
));

1614 
	`aofClo£Pùes
();

1615  
C_ERR
;

1617 
	`£rvîLog
(
LL_NOTICE
,

1618 "Backgroundáµíd o∆y fûêªwrôög sèπed byÖid %d",
chûdpid
);

1619 
£rvî
.
aof_ªwrôe_scheduÀd
 = 0;

1620 
£rvî
.
aof_ªwrôe_time_°¨t
 = 
	`time
(
NULL
);

1621 
£rvî
.
aof_chûd_pid
 = 
chûdpid
;

1626 
£rvî
.
aof_£À˘ed_db
 = -1;

1627 
	`ª∂iˇti⁄S¸ùtCacheFlush
();

1628  
C_OK
;

1630  
C_OK
;

1631 
	}
}

1633 
	$bgªwrôóofComm™d
(
˛õ¡
 *
c
) {

1634 i‡(
£rvî
.
aof_chûd_pid
 != -1) {

1635 
	`addRïlyEº‹
(
c
,"Backgroundáppend only fileÑewritingálready inÖrogress");

1636 } i‡(
	`hasA˘iveChûdPro˚ss
()) {

1637 
£rvî
.
aof_ªwrôe_scheduÀd
 = 1;

1638 
	`addRïlySètus
(
c
,"Backgroundáppend only fileÑewriting scheduled");

1639 } i‡(
	`ªwrôeAµídO∆yFûeBackground
(Ë=
C_OK
) {

1640 
	`addRïlySètus
(
c
,"Backgroundáppend only fileÑewriting started");

1642 
	`addRïlyEº‹
(
c
,"Can'tÉxecuteán AOF backgroundÑewriting. "

1645 
	}
}

1647 
	$aofRemoveTempFûe
(
pid_t
 
chûdpid
) {

1648 
tmpfûe
[256];

1650 
	`¢¥ötf
(
tmpfûe
,256,"ãmp-ªwrôóof-bg-%d.aof", (Ë
chûdpid
);

1651 
	`u∆ök
(
tmpfûe
);

1653 
	`¢¥ötf
(
tmpfûe
,256,"ãmp-ªwrôóof-%d.aof", (Ë
chûdpid
);

1654 
	`u∆ök
(
tmpfûe
);

1655 
	}
}

1661 
	$aofUpd©eCuºítSize
() {

1662 
ªdis_°©
 
sb
;

1663 
m°ime_t
 
œãncy
;

1665 
	`œãncySèπM⁄ô‹
(
œãncy
);

1666 i‡(
	`ªdis_f°©
(
£rvî
.
aof_fd
,&
sb
) == -1) {

1667 
	`£rvîLog
(
LL_WARNING
,"UnableÅo obtainÅhe AOF fileÜength. stat: %s",

1668 
	`°ªº‹
(
î∫o
));

1670 
£rvî
.
aof_cuºít_size
 = 
sb
.
°_size
;

1672 
	`œãncyEndM⁄ô‹
(
œãncy
);

1673 
	`œãncyAddSam∂eIfNìded
("aof-f°©",
œãncy
);

1674 
	}
}

1678 
	$backgroundRewrôeD⁄eH™dÀr
(
exôcode
, 
bysig«l
) {

1679 i‡(!
bysig«l
 && 
exôcode
 == 0) {

1680 
√wfd
, 
ﬁdfd
;

1681 
tmpfûe
[256];

1682 
now
 = 
	`u°ime
();

1683 
m°ime_t
 
œãncy
;

1685 
	`£rvîLog
(
LL_NOTICE
,

1690 
	`œãncySèπM⁄ô‹
(
œãncy
);

1691 
	`¢¥ötf
(
tmpfûe
,256,"temp-rewriteaof-bg-%d.aof",

1692 ()
£rvî
.
aof_chûd_pid
);

1693 
√wfd
 = 
	`›í
(
tmpfûe
,
O_WRONLY
|
O_APPEND
);

1694 i‡(
√wfd
 == -1) {

1695 
	`£rvîLog
(
LL_WARNING
,

1696 "U«bÀÅÿ›íÅhêãmp‹¨y AOFÖrodu˚d byÅhêchûd: %s", 
	`°ªº‹
(
î∫o
));

1697 
˛ónup
;

1700 i‡(
	`aofRewrôeBuf„rWrôe
(
√wfd
) == -1) {

1701 
	`£rvîLog
(
LL_WARNING
,

1702 "Eº‹ÅryögÅÿÊushÅhê∑ª¡ dif‡tÿthêªwrôã¿AOF: %s", 
	`°ªº‹
(
î∫o
));

1703 
	`˛o£
(
√wfd
);

1704 
˛ónup
;

1706 
	`œãncyEndM⁄ô‹
(
œãncy
);

1707 
	`œãncyAddSam∂eIfNìded
("aof-ªwrôe-diff-wrôe",
œãncy
);

1709 
	`£rvîLog
(
LL_NOTICE
,

1710 "ResiduÆÖ¨íàdif‡suc˚ssfuŒy flushedÅÿthêªwrôã¿AOF (%.2‡MB)", (Ë
	`aofRewrôeBuf„rSize
() / (1024*1024));

1739 i‡(
£rvî
.
aof_fd
 == -1) {

1745 
ﬁdfd
 = 
	`›í
(
£rvî
.
aof_fûíame
,
O_RDONLY
|
O_NONBLOCK
);

1748 
ﬁdfd
 = -1;

1753 
	`œãncySèπM⁄ô‹
(
œãncy
);

1754 i‡(
	`ª«me
(
tmpfûe
,
£rvî
.
aof_fûíame
) == -1) {

1755 
	`£rvîLog
(
LL_WARNING
,

1757 
tmpfûe
,

1758 
£rvî
.
aof_fûíame
,

1759 
	`°ªº‹
(
î∫o
));

1760 
	`˛o£
(
√wfd
);

1761 i‡(
ﬁdfd
 !-1Ë
	`˛o£
(oldfd);

1762 
˛ónup
;

1764 
	`œãncyEndM⁄ô‹
(
œãncy
);

1765 
	`œãncyAddSam∂eIfNìded
("aof-ª«me",
œãncy
);

1767 i‡(
£rvî
.
aof_fd
 == -1) {

1770 
	`˛o£
(
√wfd
);

1773 
ﬁdfd
 = 
£rvî
.
aof_fd
;

1774 
£rvî
.
aof_fd
 = 
√wfd
;

1775 i‡(
£rvî
.
aof_fsync
 =
AOF_FSYNC_ALWAYS
)

1776 
	`ªdis_fsync
(
√wfd
);

1777 i‡(
£rvî
.
aof_fsync
 =
AOF_FSYNC_EVERYSEC
)

1778 
	`aof_background_fsync
(
√wfd
);

1779 
£rvî
.
aof_£À˘ed_db
 = -1;

1780 
	`aofUpd©eCuºítSize
();

1781 
£rvî
.
aof_ªwrôe_ba£_size
 = sîvî.
aof_cuºít_size
;

1782 
£rvî
.
aof_fsync_off£t
 = sîvî.
aof_cuºít_size
;

1786 
	`sds‰ì
(
£rvî
.
aof_buf
);

1787 
£rvî
.
aof_buf
 = 
	`sd£m±y
();

1790 
£rvî
.
aof_œ°bgªwrôe_°©us
 = 
C_OK
;

1792 
	`£rvîLog
(
LL_NOTICE
, "Background AOFÑewrite finished successfully");

1794 i‡(
£rvî
.
aof_°©e
 =
AOF_WAIT_REWRITE
)

1795 
£rvî
.
aof_°©e
 = 
AOF_ON
;

1798 i‡(
ﬁdfd
 !-1Ë
	`bioCª©eBackgroundJob
(
BIO_CLOSE_FILE
,(*)()ﬁdfd,
NULL
,NULL);

1800 
	`£rvîLog
(
LL_VERBOSE
,

1801 "Background AOFÑewrôêsig«»h™dÀ∏took %Œdus", 
	`u°ime
()-
now
);

1802 } i‡(!
bysig«l
 && 
exôcode
 != 0) {

1803 
£rvî
.
aof_œ°bgªwrôe_°©us
 = 
C_ERR
;

1805 
	`£rvîLog
(
LL_WARNING
,

1810 i‡(
bysig«l
 !
SIGUSR1
)

1811 
£rvî
.
aof_œ°bgªwrôe_°©us
 = 
C_ERR
;

1813 
	`£rvîLog
(
LL_WARNING
,

1814 "Background AOFÑewrôêãrmö©ed by sig«»%d", 
bysig«l
);

1817 
˛ónup
:

1818 
	`aofClo£Pùes
();

1819 
	`aofRewrôeBuf„rRe£t
();

1820 
	`aofRemoveTempFûe
(
£rvî
.
aof_chûd_pid
);

1821 
£rvî
.
aof_chûd_pid
 = -1;

1822 
£rvî
.
aof_ªwrôe_time_œ°
 = 
	`time
(
NULL
)-£rvî.
aof_ªwrôe_time_°¨t
;

1823 
£rvî
.
aof_ªwrôe_time_°¨t
 = -1;

1825 i‡(
£rvî
.
aof_°©e
 =
AOF_WAIT_REWRITE
)

1826 
£rvî
.
aof_ªwrôe_scheduÀd
 = 1;

1827 
	}
}

	@asciilogo.h

30 c⁄° *
	gascii_logo
 =

	@atomicvar.h

60 
	~<±hªad.h
>

62 #i‚de‡
__ATOMIC_VAR_H


63 
	#__ATOMIC_VAR_H


	)

71 #i‡!
deföed
(
__ATOMIC_VAR_FORCE_SYNC_MACROS
Ë&& deföed(
__ATOMIC_RELAXED
Ë&& !deföed(
__sun
Ë&& (!deföed(
__˛™g__
Ë|| !deföed(
__APPLE__
Ë|| 
__≠∂e_buûd_vîsi⁄__
 > 4210057)

74 
	#©omicIn¸
(
v¨
,
cou¡
Ë
	`__©omic_add_„tch
(&v¨,(cou¡),
__ATOMIC_RELAXED
)

	)

75 
	#©omicGëIn¸
(
v¨
,
ﬁdvÆue_v¨
,
cou¡
) do { \

76 
ﬁdvÆue_v¨
 = 
	`__©omic_„tch_add
(&
v¨
,(
cou¡
),
__ATOMIC_RELAXED
); \

77 } 0)

	)

78 
	#©omicDe¸
(
v¨
,
cou¡
Ë
	`__©omic_sub_„tch
(&v¨,(cou¡),
__ATOMIC_RELAXED
)

	)

79 
	#©omicGë
(
v¨
,
d°v¨
) do { \

80 
d°v¨
 = 
	`__©omic_lﬂd_n
(&
v¨
,
__ATOMIC_RELAXED
); \

81 } 0)

	)

82 
	#©omicSë
(
v¨
,
vÆue
Ë
	`__©omic_°‹e_n
(&v¨,vÆue,
__ATOMIC_RELAXED
)

	)

83 
	#REDIS_ATOMIC_API
 "©omic-buûtö"

	)

85 #ñi‡
deföed
(
HAVE_ATOMIC
)

88 
	#©omicIn¸
(
v¨
,
cou¡
Ë
	`__sync_add_™d_„tch
(&v¨,(cou¡))

	)

89 
	#©omicGëIn¸
(
v¨
,
ﬁdvÆue_v¨
,
cou¡
) do { \

90 
ﬁdvÆue_v¨
 = 
	`__sync_„tch_™d_add
(&
v¨
,(
cou¡
)); \

91 } 0)

	)

92 
	#©omicDe¸
(
v¨
,
cou¡
Ë
	`__sync_sub_™d_„tch
(&v¨,(cou¡))

	)

93 
	#©omicGë
(
v¨
,
d°v¨
) do { \

94 
d°v¨
 = 
	`__sync_sub_™d_„tch
(&
v¨
,0); \

95 } 0)

	)

96 
	#©omicSë
(
v¨
,
vÆue
) do { \

97 !
	`__sync_boﬁ_com∑ª_™d_sw≠
(&
v¨
,v¨,
vÆue
)); \

98 } 0)

	)

99 
	#REDIS_ATOMIC_API
 "sync-buûtö"

	)

104 
	#©omicIn¸
(
v¨
,
cou¡
) do { \

105 
	`±hªad_muãx_lock
(&
v¨
 ## 
_muãx
); \

106 
v¨
 +(
cou¡
); \

107 
	`±hªad_muãx_u∆ock
(&
v¨
 ## 
_muãx
); \

108 } 0)

	)

109 
	#©omicGëIn¸
(
v¨
,
ﬁdvÆue_v¨
,
cou¡
) do { \

110 
	`±hªad_muãx_lock
(&
v¨
 ## 
_muãx
); \

111 
ﬁdvÆue_v¨
 = 
v¨
; \

112 
v¨
 +(
cou¡
); \

113 
	`±hªad_muãx_u∆ock
(&
v¨
 ## 
_muãx
); \

114 } 0)

	)

115 
	#©omicDe¸
(
v¨
,
cou¡
) do { \

116 
	`±hªad_muãx_lock
(&
v¨
 ## 
_muãx
); \

117 
v¨
 -(
cou¡
); \

118 
	`±hªad_muãx_u∆ock
(&
v¨
 ## 
_muãx
); \

119 } 0)

	)

120 
	#©omicGë
(
v¨
,
d°v¨
) do { \

121 
	`±hªad_muãx_lock
(&
v¨
 ## 
_muãx
); \

122 
d°v¨
 = 
v¨
; \

123 
	`±hªad_muãx_u∆ock
(&
v¨
 ## 
_muãx
); \

124 } 0)

	)

125 
	#©omicSë
(
v¨
,
vÆue
) do { \

126 
	`±hªad_muãx_lock
(&
v¨
 ## 
_muãx
); \

127 
v¨
 = 
vÆue
; \

128 
	`±hªad_muãx_u∆ock
(&
v¨
 ## 
_muãx
); \

129 } 0)

	)

130 
	#REDIS_ATOMIC_API
 "±hªad-muãx"

	)

	@bio.c

61 
	~"£rvî.h
"

62 
	~"bio.h
"

64 
±hªad_t
 
	gbio_thªads
[
BIO_NUM_OPS
];

65 
±hªad_muãx_t
 
	gbio_muãx
[
BIO_NUM_OPS
];

66 
±hªad_c⁄d_t
 
	gbio_√wjob_c⁄d
[
BIO_NUM_OPS
];

67 
±hªad_c⁄d_t
 
	gbio_°ï_c⁄d
[
BIO_NUM_OPS
];

68 
li°
 *
	gbio_jobs
[
BIO_NUM_OPS
];

75 
	gbio_≥ndög
[
BIO_NUM_OPS
];

79 
	sbio_job
 {

80 
time_t
 
	mtime
;

83 *
	m¨g1
, *
	m¨g2
, *
	m¨g3
;

86 *
bioPro˚ssBackgroundJobs
(*
¨g
);

87 
œzy‰ìFªeObje˘FromBioThªad
(
robj
 *
o
);

88 
œzy‰ìFªeD©aba£FromBioThªad
(
di˘
 *
ht1
, di˘ *
ht2
);

89 
œzy‰ìFªeSlŸsM≠FromBioThªad
(
zskùli°
 *
¶
);

93 
	#REDIS_THREAD_STACK_SIZE
 (1024*1024*4)

	)

96 
	$bioInô
() {

97 
±hªad_©å_t
 
©å
;

98 
±hªad_t
 
thªad
;

99 
size_t
 
°acksize
;

100 
j
;

103 
j
 = 0; j < 
BIO_NUM_OPS
; j++) {

104 
	`±hªad_muãx_öô
(&
bio_muãx
[
j
],
NULL
);

105 
	`±hªad_c⁄d_öô
(&
bio_√wjob_c⁄d
[
j
],
NULL
);

106 
	`±hªad_c⁄d_öô
(&
bio_°ï_c⁄d
[
j
],
NULL
);

107 
bio_jobs
[
j
] = 
	`li°Cª©e
();

108 
bio_≥ndög
[
j
] = 0;

112 
	`±hªad_©å_öô
(&
©å
);

113 
	`±hªad_©å_gë°acksize
(&
©å
,&
°acksize
);

114 i‡(!
°acksize
) stacksize = 1;

115 
°acksize
 < 
REDIS_THREAD_STACK_SIZE
) stacksize *= 2;

116 
	`±hªad_©å_£t°acksize
(&
©å
, 
°acksize
);

121 
j
 = 0; j < 
BIO_NUM_OPS
; j++) {

122 *
¨g
 = (*)(Ë
j
;

123 i‡(
	`±hªad_¸óã
(&
thªad
,&
©å
,
bioPro˚ssBackgroundJobs
,
¨g
) != 0) {

124 
	`£rvîLog
(
LL_WARNING
,"Fatal: Can't initialize Background Jobs.");

125 
	`exô
(1);

127 
bio_thªads
[
j
] = 
thªad
;

129 
	}
}

131 
	$bioCª©eBackgroundJob
(
ty≥
, *
¨g1
, *
¨g2
, *
¨g3
) {

132 
bio_job
 *
job
 = 
	`zmÆloc
((*job));

134 
job
->
time
 = 
	`time
(
NULL
);

135 
job
->
¨g1
 =árg1;

136 
job
->
¨g2
 =árg2;

137 
job
->
¨g3
 =árg3;

138 
	`±hªad_muãx_lock
(&
bio_muãx
[
ty≥
]);

139 
	`li°AddNodeTaû
(
bio_jobs
[
ty≥
],
job
);

140 
bio_≥ndög
[
ty≥
]++;

141 
	`±hªad_c⁄d_sig«l
(&
bio_√wjob_c⁄d
[
ty≥
]);

142 
	`±hªad_muãx_u∆ock
(&
bio_muãx
[
ty≥
]);

143 
	}
}

145 *
	$bioPro˚ssBackgroundJobs
(*
¨g
) {

146 
bio_job
 *
job
;

147 
ty≥
 = (Ë
¨g
;

148 
sig£t_t
 
sig£t
;

151 i‡(
ty≥
 >
BIO_NUM_OPS
) {

152 
	`£rvîLog
(
LL_WARNING
,

153 "W¨nög: biÿthªad sèπed wôh wr⁄gÅy≥ %lu",
ty≥
);

154  
NULL
;

157 
ty≥
) {

158 
BIO_CLOSE_FILE
:

159 
	`ªdis_£t_thªad_tôÀ
("bio_close_file");

161 
BIO_AOF_FSYNC
:

162 
	`ªdis_£t_thªad_tôÀ
("bio_aof_fsync");

164 
BIO_LAZY_FREE
:

165 
	`ªdis_£t_thªad_tôÀ
("bio_lazy_free");

169 
	`ªdisSëCpuAfföôy
(
£rvî
.
bio_˝uli°
);

173 
	`±hªad_£tˇn˚l°©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
);

174 
	`±hªad_£tˇn˚…y≥
(
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
);

176 
	`±hªad_muãx_lock
(&
bio_muãx
[
ty≥
]);

179 
	`sigem±y£t
(&
sig£t
);

180 
	`sigadd£t
(&
sig£t
, 
SIGALRM
);

181 i‡(
	`±hªad_sigmask
(
SIG_BLOCK
, &
sig£t
, 
NULL
))

182 
	`£rvîLog
(
LL_WARNING
,

183 "W¨nög: c™'àmask SIGALRM i¿bio.¯thªad: %s", 
	`°ªº‹
(
î∫o
));

186 
li°Node
 *
 
;

189 i‡(
	`li°Lígth
(
bio_jobs
[
ty≥
]) == 0) {

190 
	`±hªad_c⁄d_waô
(&
bio_√wjob_c⁄d
[
ty≥
],&
bio_muãx
[type]);

194 
 
 = 
	`li°Fú°
(
bio_jobs
[
ty≥
]);

195 
job
 = 
 
->
vÆue
;

198 
	`±hªad_muãx_u∆ock
(&
bio_muãx
[
ty≥
]);

201 i‡(
ty≥
 =
BIO_CLOSE_FILE
) {

202 
	`˛o£
(()
job
->
¨g1
);

203 } i‡(
ty≥
 =
BIO_AOF_FSYNC
) {

204 
	`ªdis_fsync
(()
job
->
¨g1
);

205 } i‡(
ty≥
 =
BIO_LAZY_FREE
) {

210 i‡(
job
->
¨g1
)

211 
	`œzy‰ìFªeObje˘FromBioThªad
(
job
->
¨g1
);

212 i‡(
job
->
¨g2
 && job->
¨g3
)

213 
	`œzy‰ìFªeD©aba£FromBioThªad
(
job
->
¨g2
,job->
¨g3
);

214 i‡(
job
->
¨g3
)

215 
	`œzy‰ìFªeSlŸsM≠FromBioThªad
(
job
->
¨g3
);

217 
	`£rvîP™ic
("Wrong jobÅype in bioProcessBackgroundJobs().");

219 
	`z‰ì
(
job
);

223 
	`±hªad_muãx_lock
(&
bio_muãx
[
ty≥
]);

224 
	`li°DñNode
(
bio_jobs
[
ty≥
],
 
);

225 
bio_≥ndög
[
ty≥
]--;

228 
	`±hªad_c⁄d_brﬂdˇ°
(&
bio_°ï_c⁄d
[
ty≥
]);

230 
	}
}

233 
	$bioPídögJobsOfTy≥
(
ty≥
) {

234 
vÆ
;

235 
	`±hªad_muãx_lock
(&
bio_muãx
[
ty≥
]);

236 
vÆ
 = 
bio_≥ndög
[
ty≥
];

237 
	`±hªad_muãx_u∆ock
(&
bio_muãx
[
ty≥
]);

238  
vÆ
;

239 
	}
}

251 
	$bioWaôSãpOfTy≥
(
ty≥
) {

252 
vÆ
;

253 
	`±hªad_muãx_lock
(&
bio_muãx
[
ty≥
]);

254 
vÆ
 = 
bio_≥ndög
[
ty≥
];

255 i‡(
vÆ
 != 0) {

256 
	`±hªad_c⁄d_waô
(&
bio_°ï_c⁄d
[
ty≥
],&
bio_muãx
[type]);

257 
vÆ
 = 
bio_≥ndög
[
ty≥
];

259 
	`±hªad_muãx_u∆ock
(&
bio_muãx
[
ty≥
]);

260  
vÆ
;

261 
	}
}

267 
	$bioKûlThªads
() {

268 
îr
, 
j
;

270 
j
 = 0; j < 
BIO_NUM_OPS
; j++) {

271 i‡(
bio_thªads
[
j
] && 
	`±hªad_ˇn˚l
(bio_threads[j]) == 0) {

272 i‡((
îr
 = 
	`±hªad_joö
(
bio_thªads
[
j
],
NULL
)) != 0) {

273 
	`£rvîLog
(
LL_WARNING
,

275 
j
, 
	`°ªº‹
(
îr
));

277 
	`£rvîLog
(
LL_WARNING
,

278 "Biÿthªad f‹ jobÅy≥ #%dÅîmö©ed",
j
);

282 
	}
}

	@bio.h

30 #i‚de‡
__BIO_H


31 
	#__BIO_H


	)

34 
bioInô
();

35 
bioCª©eBackgroundJob
(
ty≥
, *
¨g1
, *
¨g2
, *
¨g3
);

36 
bioPídögJobsOfTy≥
(
ty≥
);

37 
bioWaôSãpOfTy≥
(
ty≥
);

38 
time_t
 
bioOldîJobOfTy≥
(
ty≥
);

39 
bioKûlThªads
();

42 
	#BIO_CLOSE_FILE
 0

	)

43 
	#BIO_AOF_FSYNC
 1

	)

44 
	#BIO_LAZY_FREE
 2

	)

45 
	#BIO_NUM_OPS
 3

	)

	@bitops.c

31 
	~"£rvî.h
"

40 
size_t
 
	$ªdisP›cou¡
(*
s
, 
cou¡
) {

41 
size_t
 
bôs
 = 0;

42 *
p
 = 
s
;

43 
uöt32_t
 *
p4
;

44 c⁄° 
bôsöbyã
[256] = {0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,3,4,4,5,4,5,5,6,4,5,5,6,5,6,6,7,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,3,4,4,5,4,5,5,6,4,5,5,6,5,6,6,7,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,3,4,4,5,4,5,5,6,4,5,5,6,5,6,6,7,3,4,4,5,4,5,5,6,4,5,5,6,5,6,6,7,4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8};

47 ()
p
 & 3 && 
cou¡
) {

48 
bôs
 +
bôsöbyã
[*
p
++];

49 
cou¡
--;

53 
p4
 = (
uöt32_t
*)
p
;

54 
cou¡
>=28) {

55 
uöt32_t
 
aux1
, 
aux2
, 
aux3
, 
aux4
, 
aux5
, 
aux6
, 
aux7
;

57 
aux1
 = *
p4
++;

58 
aux2
 = *
p4
++;

59 
aux3
 = *
p4
++;

60 
aux4
 = *
p4
++;

61 
aux5
 = *
p4
++;

62 
aux6
 = *
p4
++;

63 
aux7
 = *
p4
++;

64 
cou¡
 -= 28;

66 
aux1
 =áux1 - ((aux1 >> 1) & 0x55555555);

67 
aux1
 = (aux1 & 0x33333333) + ((aux1 >> 2) & 0x33333333);

68 
aux2
 =áux2 - ((aux2 >> 1) & 0x55555555);

69 
aux2
 = (aux2 & 0x33333333) + ((aux2 >> 2) & 0x33333333);

70 
aux3
 =áux3 - ((aux3 >> 1) & 0x55555555);

71 
aux3
 = (aux3 & 0x33333333) + ((aux3 >> 2) & 0x33333333);

72 
aux4
 =áux4 - ((aux4 >> 1) & 0x55555555);

73 
aux4
 = (aux4 & 0x33333333) + ((aux4 >> 2) & 0x33333333);

74 
aux5
 =áux5 - ((aux5 >> 1) & 0x55555555);

75 
aux5
 = (aux5 & 0x33333333) + ((aux5 >> 2) & 0x33333333);

76 
aux6
 =áux6 - ((aux6 >> 1) & 0x55555555);

77 
aux6
 = (aux6 & 0x33333333) + ((aux6 >> 2) & 0x33333333);

78 
aux7
 =áux7 - ((aux7 >> 1) & 0x55555555);

79 
aux7
 = (aux7 & 0x33333333) + ((aux7 >> 2) & 0x33333333);

80 
bôs
 +((((
aux1
 + (aux1 >> 4)) & 0x0F0F0F0F) +

81 ((
aux2
 + (aux2 >> 4)) & 0x0F0F0F0F) +

82 ((
aux3
 + (aux3 >> 4)) & 0x0F0F0F0F) +

83 ((
aux4
 + (aux4 >> 4)) & 0x0F0F0F0F) +

84 ((
aux5
 + (aux5 >> 4)) & 0x0F0F0F0F) +

85 ((
aux6
 + (aux6 >> 4)) & 0x0F0F0F0F) +

86 ((
aux7
 + (aux7 >> 4)) & 0x0F0F0F0F))* 0x01010101) >> 24;

89 
p
 = (*)
p4
;

90 
cou¡
--Ë
bôs
 +
bôsöbyã
[*
p
++];

91  
bôs
;

92 
	}
}

101 
	$ªdisBôpos
(*
s
, 
cou¡
, 
bô
) {

102 *
l
;

103 *
c
;

104 
skùvÆ
, 
w‹d
 = 0, 
⁄e
;

105 
pos
 = 0;

106 
j
;

107 
found
;

119 
skùvÆ
 = 
bô
 ? 0 : 
UCHAR_MAX
;

120 
c
 = (*Ë
s
;

121 
found
 = 0;

122 ()
c
 & ((*
l
)-1Ë&& 
cou¡
) {

123 i‡(*
c
 !
skùvÆ
) {

124 
found
 = 1;

127 
c
++;

128 
cou¡
--;

129 
pos
 += 8;

133 
l
 = (*Ë
c
;

134 i‡(!
found
) {

135 
skùvÆ
 = 
bô
 ? 0 : 
ULONG_MAX
;

136 
cou¡
 >(*
l
)) {

137 i‡(*
l
 !
skùvÆ
) ;

138 
l
++;

139 
cou¡
 -(*
l
);

140 
pos
 +(*
l
)*8;

151 
c
 = (*)
l
;

152 
j
 = 0; j < (*
l
); j++) {

153 
w‹d
 <<= 8;

154 i‡(
cou¡
) {

155 
w‹d
 |*
c
;

156 
c
++;

157 
cou¡
--;

166 i‡(
bô
 =1 && 
w‹d
 == 0)  -1;

172 
⁄e
 = 
ULONG_MAX
;

173 
⁄e
 >>= 1;

174 
⁄e
 = ~one;

176 
⁄e
) {

177 i‡(((
⁄e
 & 
w‹d
Ë!0Ë=
bô
Ë 
pos
;

178 
pos
++;

179 
⁄e
 >>= 1;

184 
	`£rvîP™ic
("End ofÑedisBitpos()Ñeached.");

186 
	}
}

209 
	$£tUnsig√dBôfõld
(*
p
, 
uöt64_t
 
off£t
, uöt64_à
bôs
, uöt64_à
vÆue
) {

210 
uöt64_t
 
byã
, 
bô
, 
byãvÆ
, 
bôvÆ
, 
j
;

212 
j
 = 0; j < 
bôs
; j++) {

213 
bôvÆ
 = (
vÆue
 & ((
uöt64_t
)1<<(
bôs
-1-
j
))) != 0;

214 
byã
 = 
off£t
 >> 3;

215 
bô
 = 7 - (
off£t
 & 0x7);

216 
byãvÆ
 = 
p
[
byã
];

217 
byãvÆ
 &~(1 << 
bô
);

218 
byãvÆ
 |
bôvÆ
 << 
bô
;

219 
p
[
byã
] = 
byãvÆ
 & 0xff;

220 
off£t
++;

222 
	}
}

224 
	$£tSig√dBôfõld
(*
p
, 
uöt64_t
 
off£t
, uöt64_à
bôs
, 
öt64_t
 
vÆue
) {

225 
uöt64_t
 
uv
 = 
vÆue
;

226 
	`£tUnsig√dBôfõld
(
p
,
off£t
,
bôs
,
uv
);

227 
	}
}

229 
uöt64_t
 
	$gëUnsig√dBôfõld
(*
p
, 
uöt64_t
 
off£t
, uöt64_à
bôs
) {

230 
uöt64_t
 
byã
, 
bô
, 
byãvÆ
, 
bôvÆ
, 
j
, 
vÆue
 = 0;

232 
j
 = 0; j < 
bôs
; j++) {

233 
byã
 = 
off£t
 >> 3;

234 
bô
 = 7 - (
off£t
 & 0x7);

235 
byãvÆ
 = 
p
[
byã
];

236 
bôvÆ
 = (
byãvÆ
 >> 
bô
) & 1;

237 
vÆue
 = (vÆue<<1Ë| 
bôvÆ
;

238 
off£t
++;

240  
vÆue
;

241 
	}
}

243 
öt64_t
 
	$gëSig√dBôfõld
(*
p
, 
uöt64_t
 
off£t
, uöt64_à
bôs
) {

244 
öt64_t
 
vÆue
;

245 uni⁄ {
uöt64_t
 
u
; 
öt64_t
 
i
;} 
c⁄v
;

254 
c⁄v
.
u
 = 
	`gëUnsig√dBôfõld
(
p
,
off£t
,
bôs
);

255 
vÆue
 = 
c⁄v
.
i
;

260 i‡(
vÆue
 & ((
uöt64_t
)1 << (
bôs
-1)))

261 
vÆue
 |((
uöt64_t
)-1Ë<< 
bôs
;

262  
vÆue
;

263 
	}
}

284 
	#BFOVERFLOW_WRAP
 0

	)

285 
	#BFOVERFLOW_SAT
 1

	)

286 
	#BFOVERFLOW_FAIL
 2

	)

288 
	$checkUnsig√dBôfõldOvîÊow
(
uöt64_t
 
vÆue
, 
öt64_t
 
ö¸
, uöt64_à
bôs
, 
owty≥
, uöt64_à*
limô
) {

289 
uöt64_t
 
max
 = (
bôs
 =64Ë? 
UINT64_MAX
 : (((uint64_t)1<<bits)-1);

290 
öt64_t
 
maxö¸
 = 
max
-
vÆue
;

291 
öt64_t
 
möö¸
 = -
vÆue
;

293 i‡(
vÆue
 > 
max
 || (
ö¸
 > 0 && in¸ > 
maxö¸
)) {

294 i‡(
limô
) {

295 i‡(
owty≥
 =
BFOVERFLOW_WRAP
) {

296 
h™dÀ_wøp
;

297 } i‡(
owty≥
 =
BFOVERFLOW_SAT
) {

298 *
limô
 = 
max
;

302 } i‡(
ö¸
 < 0 && in¸ < 
möö¸
) {

303 i‡(
limô
) {

304 i‡(
owty≥
 =
BFOVERFLOW_WRAP
) {

305 
h™dÀ_wøp
;

306 } i‡(
owty≥
 =
BFOVERFLOW_SAT
) {

307 *
limô
 = 0;

314 
h™dÀ_wøp
:

316 
uöt64_t
 
mask
 = ((uöt64_t)-1Ë<< 
bôs
;

317 
uöt64_t
 
ªs
 = 
vÆue
+
ö¸
;

319 
ªs
 &~
mask
;

320 *
limô
 = 
ªs
;

323 
	}
}

325 
	$checkSig√dBôfõldOvîÊow
(
öt64_t
 
vÆue
, i¡64_à
ö¸
, 
uöt64_t
 
bôs
, 
owty≥
, i¡64_à*
limô
) {

326 
öt64_t
 
max
 = (
bôs
 =64Ë? 
INT64_MAX
 : (((int64_t)1<<(bits-1))-1);

327 
öt64_t
 
mö
 = (-
max
)-1;

332 
öt64_t
 
maxö¸
 = 
max
-
vÆue
;

333 
öt64_t
 
möö¸
 = 
mö
-
vÆue
;

335 i‡(
vÆue
 > 
max
 || (
bôs
 !64 && 
ö¸
 > 
maxö¸
) || (value >= 0 && incr > 0 && incr > maxincr))

337 i‡(
limô
) {

338 i‡(
owty≥
 =
BFOVERFLOW_WRAP
) {

339 
h™dÀ_wøp
;

340 } i‡(
owty≥
 =
BFOVERFLOW_SAT
) {

341 *
limô
 = 
max
;

345 } i‡(
vÆue
 < 
mö
 || (
bôs
 !64 && 
ö¸
 < 
möö¸
) || (value < 0 && incr < 0 && incr < minincr)) {

346 i‡(
limô
) {

347 i‡(
owty≥
 =
BFOVERFLOW_WRAP
) {

348 
h™dÀ_wøp
;

349 } i‡(
owty≥
 =
BFOVERFLOW_SAT
) {

350 *
limô
 = 
mö
;

357 
h™dÀ_wøp
:

359 
uöt64_t
 
mask
 = ((uöt64_t)-1Ë<< 
bôs
;

360 
uöt64_t
 
msb
 = (uöt64_t)1 << (
bôs
-1);

361 
uöt64_t
 
a
 = 
vÆue
, 
b
 = 
ö¸
, 
c
;

362 
c
 = 
a
+
b
;

367 i‡(
c
 & 
msb
) {

368 
c
 |
mask
;

370 
c
 &~
mask
;

372 *
limô
 = 
c
;

375 
	}
}

379 
	$¥ötBôs
(*
p
, 
cou¡
) {

380 
j
, 
i
, 
byã
;

382 
j
 = 0; j < 
cou¡
; j++) {

383 
byã
 = 
p
[
j
];

384 
i
 = 0x80; i > 0; i /= 2)

385 
	`¥ötf
("%c", (
byã
 & 
i
) ? '1' : '0');

386 
	`¥ötf
("|");

388 
	`¥ötf
("\n");

389 
	}
}

395 
	#BITOP_AND
 0

	)

396 
	#BITOP_OR
 1

	)

397 
	#BITOP_XOR
 2

	)

398 
	#BITOP_NOT
 3

	)

400 
	#BITFIELDOP_GET
 0

	)

401 
	#BITFIELDOP_SET
 1

	)

402 
	#BITFIELDOP_INCRBY
 2

	)

411 
	$gëBôOff£tFromArgumít
(
˛õ¡
 *
c
, 
robj
 *
o
, 
size_t
 *
off£t
, 
hash
, 
bôs
) {

412 
loff£t
;

413 *
îr
 = "bit offset isÇotán integer or out ofÑange";

414 *
p
 = 
o
->
±r
;

415 
size_t
 
∂í
 = 
	`sd¶í
(
p
);

416 
u£hash
 = 0;

419 i‡(
p
[0] ='#' && 
hash
 && 
bôs
 > 0Ë
u£hash
 = 1;

421 i‡(
	`°rög2Œ
(
p
+
u£hash
,
∂í
-u£hash,&
loff£t
) == 0) {

422 
	`addRïlyEº‹
(
c
,
îr
);

423  
C_ERR
;

427 i‡(
u£hash
Ë
loff£t
 *
bôs
;

430 i‡((
loff£t
 < 0) || (()loffset >> 3) >= (512*1024*1024))

432 
	`addRïlyEº‹
(
c
,
îr
);

433  
C_ERR
;

436 *
off£t
 = (
size_t
)
loff£t
;

437  
C_OK
;

438 
	}
}

447 
	$gëBôfõldTy≥FromArgumít
(
˛õ¡
 *
c
, 
robj
 *
o
, *
sign
, *
bôs
) {

448 *
p
 = 
o
->
±r
;

449 *
îr
 = "Invalid bitfieldÅype. Use somethingÜike i16 u8. NoteÅhat u64 isÇot supported but i64 is.";

450 
Œbôs
;

452 i‡(
p
[0] == 'i') {

453 *
sign
 = 1;

454 } i‡(
p
[0] == 'u') {

455 *
sign
 = 0;

457 
	`addRïlyEº‹
(
c
,
îr
);

458  
C_ERR
;

461 i‡((
	`°rög2Œ
(
p
+1,
	`°æí
’+1),&
Œbôs
)) == 0 ||

462 
Œbôs
 < 1 ||

463 (*
sign
 =1 && 
Œbôs
 > 64) ||

464 (*
sign
 =0 && 
Œbôs
 > 63))

466 
	`addRïlyEº‹
(
c
,
îr
);

467  
C_ERR
;

469 *
bôs
 = 
Œbôs
;

470  
C_OK
;

471 
	}
}

478 
robj
 *
	$lookupSåögF‹BôComm™d
(
˛õ¡
 *
c
, 
size_t
 
maxbô
) {

479 
size_t
 
byã
 = 
maxbô
 >> 3;

480 
robj
 *
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

482 i‡(
o
 =
NULL
) {

483 
o
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ewÀn
(
NULL
, 
byã
+1));

484 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],
o
);

486 i‡(
	`checkTy≥
(
c
,
o
,
OBJ_STRING
)Ë 
NULL
;

487 
o
 = 
	`dbUnsh¨eSåögVÆue
(
c
->
db
,c->
¨gv
[1],o);

488 
o
->
±r
 = 
	`sdsgrowzîo
(o->±r,
byã
+1);

490  
o
;

491 
	}
}

506 *
	$gëObje˘RódO∆ySåög
(
robj
 *
o
, *
Àn
, *
Œbuf
) {

507 
	`£rvîAs£π
(
o
->
ty≥
 =
OBJ_STRING
);

508 *
p
 = 
NULL
;

512 i‡(
o
 && o->
ícodög
 =
OBJ_ENCODING_INT
) {

513 
p
 = (*Ë
Œbuf
;

514 i‡(
Àn
Ë*À¿
	`Œ2°rög
(
Œbuf
,
LONG_STR_SIZE
,()
o
->
±r
);

515 } i‡(
o
) {

516 
p
 = (*Ë
o
->
±r
;

517 i‡(
Àn
Ë*À¿
	`sd¶í
(
o
->
±r
);

519 i‡(
Àn
) *len = 0;

521  
p
;

522 
	}
}

525 
	$£tbôComm™d
(
˛õ¡
 *
c
) {

526 
robj
 *
o
;

527 *
îr
 = "bit isÇotán integer or out ofÑange";

528 
size_t
 
bôoff£t
;

529 
ssize_t
 
byã
, 
bô
;

530 
byãvÆ
, 
bôvÆ
;

531 
⁄
;

533 i‡(
	`gëBôOff£tFromArgumít
(
c
,c->
¨gv
[2],&
bôoff£t
,0,0Ë!
C_OK
)

536 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
⁄
,
îr
Ë!
C_OK
)

540 i‡(
⁄
 & ~1) {

541 
	`addRïlyEº‹
(
c
,
îr
);

545 i‡((
o
 = 
	`lookupSåögF‹BôComm™d
(
c
,
bôoff£t
)Ë=
NULL
) ;

548 
byã
 = 
bôoff£t
 >> 3;

549 
byãvÆ
 = ((
uöt8_t
*)
o
->
±r
)[
byã
];

550 
bô
 = 7 - (
bôoff£t
 & 0x7);

551 
bôvÆ
 = 
byãvÆ
 & (1 << 
bô
);

554 
byãvÆ
 &~(1 << 
bô
);

555 
byãvÆ
 |((
⁄
 & 0x1Ë<< 
bô
);

556 ((
uöt8_t
*)
o
->
±r
)[
byã
] = 
byãvÆ
;

557 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

558 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"£tbô",
c
->
¨gv
[1],c->
db
->
id
);

559 
£rvî
.
dúty
++;

560 
	`addRïly
(
c
, 
bôvÆ
 ? 
sh¨ed
.
c⁄e
 : sh¨ed.
czîo
);

561 
	}
}

564 
	$gëbôComm™d
(
˛õ¡
 *
c
) {

565 
robj
 *
o
;

566 
Œbuf
[32];

567 
size_t
 
bôoff£t
;

568 
size_t
 
byã
, 
bô
;

569 
size_t
 
bôvÆ
 = 0;

571 i‡(
	`gëBôOff£tFromArgumít
(
c
,c->
¨gv
[2],&
bôoff£t
,0,0Ë!
C_OK
)

574 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

575 
	`checkTy≥
(
c
,
o
,
OBJ_STRING
)) ;

577 
byã
 = 
bôoff£t
 >> 3;

578 
bô
 = 7 - (
bôoff£t
 & 0x7);

579 i‡(
	`sdsEncodedObje˘
(
o
)) {

580 i‡(
byã
 < 
	`sd¶í
(
o
->
±r
))

581 
bôvÆ
 = ((
uöt8_t
*)
o
->
±r
)[
byã
] & (1 << 
bô
);

583 i‡(
byã
 < (
size_t
)
	`Œ2°rög
(
Œbuf
,÷lbuf),()
o
->
±r
))

584 
bôvÆ
 = 
Œbuf
[
byã
] & (1 << 
bô
);

587 
	`addRïly
(
c
, 
bôvÆ
 ? 
sh¨ed
.
c⁄e
 : sh¨ed.
czîo
);

588 
	}
}

591 
	$bô›Comm™d
(
˛õ¡
 *
c
) {

592 *
›«me
 = 
c
->
¨gv
[1]->
±r
;

593 
robj
 *
o
, *
èrgëkey
 = 
c
->
¨gv
[2];

594 
›
, 
j
, 
numkeys
;

595 
robj
 **
obje˘s
;

596 **
§c
;

597 *
Àn
, 
maxÀn
 = 0;

599 
möÀn
 = 0;

600 *
ªs
 = 
NULL
;

603 i‡((
›«me
[0] ='a' || o≤ame[0] ='A'Ë&& !
	`°rˇ£cmp
(opname,"and"))

604 
›
 = 
BITOP_AND
;

605 if((
›«me
[0] ='o' || o≤ame[0] ='O'Ë&& !
	`°rˇ£cmp
(opname,"or"))

606 
›
 = 
BITOP_OR
;

607 if((
›«me
[0] ='x' || o≤ame[0] ='X'Ë&& !
	`°rˇ£cmp
(opname,"xor"))

608 
›
 = 
BITOP_XOR
;

609 if((
›«me
[0] ='n' || o≤ame[0] ='N'Ë&& !
	`°rˇ£cmp
(opname,"not"))

610 
›
 = 
BITOP_NOT
;

612 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

617 i‡(
›
 =
BITOP_NOT
 && 
c
->
¨gc
 != 4) {

618 
	`addRïlyEº‹
(
c
,"BITOP NOT must be called withá single source key.");

623 
numkeys
 = 
c
->
¨gc
 - 3;

624 
§c
 = 
	`zmÆloc
((*Ë* 
numkeys
);

625 
Àn
 = 
	`zmÆloc
((Ë* 
numkeys
);

626 
obje˘s
 = 
	`zmÆloc
((
robj
*Ë* 
numkeys
);

627 
j
 = 0; j < 
numkeys
; j++) {

628 
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
j
+3]);

630 i‡(
o
 =
NULL
) {

631 
obje˘s
[
j
] = 
NULL
;

632 
§c
[
j
] = 
NULL
;

633 
Àn
[
j
] = 0;

634 
möÀn
 = 0;

638 i‡(
	`checkTy≥
(
c
,
o
,
OBJ_STRING
)) {

639 
i
;

640 
i
 = 0; i < 
j
; i++) {

641 i‡(
obje˘s
[
i
])

642 
	`de¸RefCou¡
(
obje˘s
[
i
]);

644 
	`z‰ì
(
§c
);

645 
	`z‰ì
(
Àn
);

646 
	`z‰ì
(
obje˘s
);

649 
obje˘s
[
j
] = 
	`gëDecodedObje˘
(
o
);

650 
§c
[
j
] = 
obje˘s
[j]->
±r
;

651 
Àn
[
j
] = 
	`sd¶í
(
obje˘s
[j]->
±r
);

652 i‡(
Àn
[
j
] > 
maxÀn
) maxlen =Üen[j];

653 i‡(
j
 =0 || 
Àn
[j] < 
möÀn
) minlen =Üen[j];

657 i‡(
maxÀn
) {

658 
ªs
 = (*Ë
	`sd¢ewÀn
(
NULL
,
maxÀn
);

659 
ouçut
, 
byã
;

660 
i
;

667 
j
 = 0;

668 #i‚de‡
USE_ALIGNED_ACCESS


669 i‡(
möÀn
 >()*4 && 
numkeys
 <= 16) {

670 *
Õ
[16];

671 *
Ães
 = (*Ë
ªs
;

674 
	`mem˝y
(
Õ
,
§c
,(*)*
numkeys
);

675 
	`mem˝y
(
ªs
,
§c
[0],
möÀn
);

678 i‡(
›
 =
BITOP_AND
) {

679 
möÀn
 >= ()*4) {

680 
i
 = 1; i < 
numkeys
; i++) {

681 
Ães
[0] &
Õ
[
i
][0];

682 
Ães
[1] &
Õ
[
i
][1];

683 
Ães
[2] &
Õ
[
i
][2];

684 
Ães
[3] &
Õ
[
i
][3];

685 
Õ
[
i
]+=4;

687 
Ães
+=4;

688 
j
 += ()*4;

689 
möÀn
 -= ()*4;

691 } i‡(
›
 =
BITOP_OR
) {

692 
möÀn
 >= ()*4) {

693 
i
 = 1; i < 
numkeys
; i++) {

694 
Ães
[0] |
Õ
[
i
][0];

695 
Ães
[1] |
Õ
[
i
][1];

696 
Ães
[2] |
Õ
[
i
][2];

697 
Ães
[3] |
Õ
[
i
][3];

698 
Õ
[
i
]+=4;

700 
Ães
+=4;

701 
j
 += ()*4;

702 
möÀn
 -= ()*4;

704 } i‡(
›
 =
BITOP_XOR
) {

705 
möÀn
 >= ()*4) {

706 
i
 = 1; i < 
numkeys
; i++) {

707 
Ães
[0] ^
Õ
[
i
][0];

708 
Ães
[1] ^
Õ
[
i
][1];

709 
Ães
[2] ^
Õ
[
i
][2];

710 
Ães
[3] ^
Õ
[
i
][3];

711 
Õ
[
i
]+=4;

713 
Ães
+=4;

714 
j
 += ()*4;

715 
möÀn
 -= ()*4;

717 } i‡(
›
 =
BITOP_NOT
) {

718 
möÀn
 >= ()*4) {

719 
Ães
[0] = ~lres[0];

720 
Ães
[1] = ~lres[1];

721 
Ães
[2] = ~lres[2];

722 
Ães
[3] = ~lres[3];

723 
Ães
+=4;

724 
j
 += ()*4;

725 
möÀn
 -= ()*4;

732 ; 
j
 < 
maxÀn
; j++) {

733 
ouçut
 = (
Àn
[0] <
j
Ë? 0 : 
§c
[0][j];

734 i‡(
›
 =
BITOP_NOT
Ë
ouçut
 = ~output;

735 
i
 = 1; i < 
numkeys
; i++) {

736 
byã
 = (
Àn
[
i
] <
j
Ë? 0 : 
§c
[i][j];

737 
›
) {

738 
BITOP_AND
: 
ouçut
 &
byã
; ;

739 
BITOP_OR
: 
ouçut
 |
byã
; ;

740 
BITOP_XOR
: 
ouçut
 ^
byã
; ;

743 
ªs
[
j
] = 
ouçut
;

746 
j
 = 0; j < 
numkeys
; j++) {

747 i‡(
obje˘s
[
j
])

748 
	`de¸RefCou¡
(
obje˘s
[
j
]);

750 
	`z‰ì
(
§c
);

751 
	`z‰ì
(
Àn
);

752 
	`z‰ì
(
obje˘s
);

755 i‡(
maxÀn
) {

756 
o
 = 
	`¸óãObje˘
(
OBJ_STRING
,
ªs
);

757 
	`£tKey
(
c
,c->
db
,
èrgëkey
,
o
);

758 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"£t",
èrgëkey
,
c
->
db
->
id
);

759 
	`de¸RefCou¡
(
o
);

760 } i‡(
	`dbDñëe
(
c
->
db
,
èrgëkey
)) {

761 
	`sig«lModifõdKey
(
c
,c->
db
,
èrgëkey
);

762 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
èrgëkey
,
c
->
db
->
id
);

764 
£rvî
.
dúty
++;

765 
	`addRïlyL⁄gL⁄g
(
c
,
maxÀn
);

766 
	}
}

769 
	$bôcou¡Comm™d
(
˛õ¡
 *
c
) {

770 
robj
 *
o
;

771 
°¨t
, 
íd
, 
°æí
;

772 *
p
;

773 
Œbuf
[
LONG_STR_SIZE
];

776 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

777 
	`checkTy≥
(
c
,
o
,
OBJ_STRING
)) ;

778 
p
 = 
	`gëObje˘RódO∆ySåög
(
o
,&
°æí
,
Œbuf
);

781 i‡(
c
->
¨gc
 == 4) {

782 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
°¨t
,
NULL
Ë!
C_OK
)

784 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
íd
,
NULL
Ë!
C_OK
)

787 i‡(
°¨t
 < 0 && 
íd
 < 0 && start >Énd) {

788 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

791 i‡(
°¨t
 < 0Ë°¨à
°æí
+start;

792 i‡(
íd
 < 0Ëíd = 
°æí
+end;

793 i‡(
°¨t
 < 0) start = 0;

794 i‡(
íd
 < 0)Énd = 0;

795 i‡(
íd
 >
°æí
)Énd = strlen-1;

796 } i‡(
c
->
¨gc
 == 2) {

798 
°¨t
 = 0;

799 
íd
 = 
°æí
-1;

802 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

808 i‡(
°¨t
 > 
íd
) {

809 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

811 
byãs
 = 
íd
-
°¨t
+1;

813 
	`addRïlyL⁄gL⁄g
(
c
,
	`ªdisP›cou¡
(
p
+
°¨t
,
byãs
));

815 
	}
}

818 
	$bôposComm™d
(
˛õ¡
 *
c
) {

819 
robj
 *
o
;

820 
bô
, 
°¨t
, 
íd
, 
°æí
;

821 *
p
;

822 
Œbuf
[
LONG_STR_SIZE
];

823 
íd_giví
 = 0;

827 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
bô
,
NULL
Ë!
C_OK
)

829 i‡(
bô
 != 0 && bit != 1) {

830 
	`addRïlyEº‹
(
c
, "The bitárgument must be 1 or 0.");

837 i‡((
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[1])Ë=
NULL
) {

838 
	`addRïlyL⁄gL⁄g
(
c
, 
bô
 ? -1 : 0);

841 i‡(
	`checkTy≥
(
c
,
o
,
OBJ_STRING
)) ;

842 
p
 = 
	`gëObje˘RódO∆ySåög
(
o
,&
°æí
,
Œbuf
);

845 i‡(
c
->
¨gc
 == 4 || c->argc == 5) {

846 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
°¨t
,
NULL
Ë!
C_OK
)

848 i‡(
c
->
¨gc
 == 5) {

849 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[4],&
íd
,
NULL
Ë!
C_OK
)

851 
íd_giví
 = 1;

853 
íd
 = 
°æí
-1;

856 i‡(
°¨t
 < 0Ë°¨à
°æí
+start;

857 i‡(
íd
 < 0Ëíd = 
°æí
+end;

858 i‡(
°¨t
 < 0) start = 0;

859 i‡(
íd
 < 0)Énd = 0;

860 i‡(
íd
 >
°æí
)Énd = strlen-1;

861 } i‡(
c
->
¨gc
 == 3) {

863 
°¨t
 = 0;

864 
íd
 = 
°æí
-1;

867 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

873 i‡(
°¨t
 > 
íd
) {

874 
	`addRïlyL⁄gL⁄g
(
c
, -1);

876 
byãs
 = 
íd
-
°¨t
+1;

877 
pos
 = 
	`ªdisBôpos
(
p
+
°¨t
,
byãs
,
bô
);

886 i‡(
íd_giví
 && 
bô
 =0 && 
pos
 =
byãs
*8) {

887 
	`addRïlyL⁄gL⁄g
(
c
,-1);

890 i‡(
pos
 !-1Ëpo†+
°¨t
*8;

891 
	`addRïlyL⁄gL⁄g
(
c
,
pos
);

893 
	}
}

905 
	#BITFIELD_FLAG_NONE
 0

	)

906 
	#BITFIELD_FLAG_READONLY
 (1<<0)

	)

908 
	sbôfõldOp
 {

909 
uöt64_t
 
	moff£t
;

910 
öt64_t
 
	mi64
;

911 
	m›code
;

912 
	mowty≥
;

913 
	mbôs
;

914 
	msign
;

920 
	$bôfõldGíîic
(
˛õ¡
 *
c
, 
Êags
) {

921 
robj
 *
o
;

922 
size_t
 
bôoff£t
;

923 
j
, 
num›s
 = 0, 
ch™ges
 = 0;

924 
bôfõldOp
 *
›s
 = 
NULL
;

925 
owty≥
 = 
BFOVERFLOW_WRAP
;

926 
ªad⁄ly
 = 1;

927 
size_t
 
highe°_wrôe_off£t
 = 0;

929 
j
 = 2; j < 
c
->
¨gc
; j++) {

930 
ªm¨gs
 = 
c
->
¨gc
-
j
-1;

931 *
subcmd
 = 
c
->
¨gv
[
j
]->
±r
;

932 
›code
;

933 
i64
 = 0;

934 
sign
 = 0;

935 
bôs
 = 0;

937 i‡(!
	`°rˇ£cmp
(
subcmd
,"gë"Ë&& 
ªm¨gs
 >= 2)

938 
›code
 = 
BITFIELDOP_GET
;

939 i‡(!
	`°rˇ£cmp
(
subcmd
,"£t"Ë&& 
ªm¨gs
 >= 3)

940 
›code
 = 
BITFIELDOP_SET
;

941 i‡(!
	`°rˇ£cmp
(
subcmd
,"ö¸by"Ë&& 
ªm¨gs
 >= 3)

942 
›code
 = 
BITFIELDOP_INCRBY
;

943 i‡(!
	`°rˇ£cmp
(
subcmd
,"ovîÊow"Ë&& 
ªm¨gs
 >= 1) {

944 *
owty≥«me
 = 
c
->
¨gv
[
j
+1]->
±r
;

945 
j
++;

946 i‡(!
	`°rˇ£cmp
(
owty≥«me
,"wrap"))

947 
owty≥
 = 
BFOVERFLOW_WRAP
;

948 i‡(!
	`°rˇ£cmp
(
owty≥«me
,"sat"))

949 
owty≥
 = 
BFOVERFLOW_SAT
;

950 i‡(!
	`°rˇ£cmp
(
owty≥«me
,"fail"))

951 
owty≥
 = 
BFOVERFLOW_FAIL
;

953 
	`addRïlyEº‹
(
c
,"Invalid OVERFLOWÅype specified");

954 
	`z‰ì
(
›s
);

959 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

960 
	`z‰ì
(
›s
);

965 i‡(
	`gëBôfõldTy≥FromArgumít
(
c
,c->
¨gv
[
j
+1],&
sign
,&
bôs
Ë!
C_OK
) {

966 
	`z‰ì
(
›s
);

970 i‡(
	`gëBôOff£tFromArgumít
(
c
,c->
¨gv
[
j
+2],&
bôoff£t
,1,
bôs
Ë!
C_OK
){

971 
	`z‰ì
(
›s
);

975 i‡(
›code
 !
BITFIELDOP_GET
) {

976 
ªad⁄ly
 = 0;

977 i‡(
highe°_wrôe_off£t
 < 
bôoff£t
 + 
bôs
 - 1)

978 
highe°_wrôe_off£t
 = 
bôoff£t
 + 
bôs
 - 1;

980 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
+3],&
i64
,
NULL
Ë!
C_OK
){

981 
	`z‰ì
(
›s
);

987 
›s
 = 
	`zªÆloc
(›s,(*›s)*(
num›s
+1));

988 
›s
[
num›s
].
off£t
 = 
bôoff£t
;

989 
›s
[
num›s
].
i64
 = i64;

990 
›s
[
num›s
].
›code
 = opcode;

991 
›s
[
num›s
].
owty≥
 = owtype;

992 
›s
[
num›s
].
bôs
 = bits;

993 
›s
[
num›s
].
sign
 = sign;

994 
num›s
++;

996 
j
 +3 - (
›code
 =
BITFIELDOP_GET
);

999 i‡(
ªad⁄ly
) {

1002 
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[1]);

1003 i‡(
o
 !
NULL
 && 
	`checkTy≥
(
c
,o,
OBJ_STRING
)) {

1004 
	`z‰ì
(
›s
);

1008 i‡(
Êags
 & 
BITFIELD_FLAG_READONLY
) {

1009 
	`z‰ì
(
›s
);

1010 
	`addRïlyEº‹
(
c
, "BITFIELD_RO only supportsÅhe GET subcommand");

1016 i‡((
o
 = 
	`lookupSåögF‹BôComm™d
(
c
,

1017 
highe°_wrôe_off£t
)Ë=
NULL
) {

1018 
	`z‰ì
(
›s
);

1023 
	`addRïlyAºayLí
(
c
,
num›s
);

1026 
j
 = 0; j < 
num›s
; j++) {

1027 
bôfõldOp
 *
this›
 = 
›s
+
j
;

1030 i‡(
this›
->
›code
 =
BITFIELDOP_SET
 ||

1031 
this›
->
›code
 =
BITFIELDOP_INCRBY
)

1040 i‡(
this›
->
sign
) {

1041 
öt64_t
 
ﬁdvÆ
, 
√wvÆ
, 
wøµed
, 
ªtvÆ
;

1042 
ovîÊow
;

1044 
ﬁdvÆ
 = 
	`gëSig√dBôfõld
(
o
->
±r
,
this›
->
off£t
,

1045 
this›
->
bôs
);

1047 i‡(
this›
->
›code
 =
BITFIELDOP_INCRBY
) {

1048 
√wvÆ
 = 
ﬁdvÆ
 + 
this›
->
i64
;

1049 
ovîÊow
 = 
	`checkSig√dBôfõldOvîÊow
(
ﬁdvÆ
,

1050 
this›
->
i64
,this›->
bôs
,this›->
owty≥
,&
wøµed
);

1051 i‡(
ovîÊow
Ë
√wvÆ
 = 
wøµed
;

1052 
ªtvÆ
 = 
√wvÆ
;

1054 
√wvÆ
 = 
this›
->
i64
;

1055 
ovîÊow
 = 
	`checkSig√dBôfõldOvîÊow
(
√wvÆ
,

1056 0,
this›
->
bôs
,this›->
owty≥
,&
wøµed
);

1057 i‡(
ovîÊow
Ë
√wvÆ
 = 
wøµed
;

1058 
ªtvÆ
 = 
ﬁdvÆ
;

1063 i‡(!(
ovîÊow
 && 
this›
->
owty≥
 =
BFOVERFLOW_FAIL
)) {

1064 
	`addRïlyL⁄gL⁄g
(
c
,
ªtvÆ
);

1065 
	`£tSig√dBôfõld
(
o
->
±r
,
this›
->
off£t
,

1066 
this›
->
bôs
,
√wvÆ
);

1068 
	`addRïlyNuŒ
(
c
);

1071 
uöt64_t
 
ﬁdvÆ
, 
√wvÆ
, 
wøµed
, 
ªtvÆ
;

1072 
ovîÊow
;

1074 
ﬁdvÆ
 = 
	`gëUnsig√dBôfõld
(
o
->
±r
,
this›
->
off£t
,

1075 
this›
->
bôs
);

1077 i‡(
this›
->
›code
 =
BITFIELDOP_INCRBY
) {

1078 
√wvÆ
 = 
ﬁdvÆ
 + 
this›
->
i64
;

1079 
ovîÊow
 = 
	`checkUnsig√dBôfõldOvîÊow
(
ﬁdvÆ
,

1080 
this›
->
i64
,this›->
bôs
,this›->
owty≥
,&
wøµed
);

1081 i‡(
ovîÊow
Ë
√wvÆ
 = 
wøµed
;

1082 
ªtvÆ
 = 
√wvÆ
;

1084 
√wvÆ
 = 
this›
->
i64
;

1085 
ovîÊow
 = 
	`checkUnsig√dBôfõldOvîÊow
(
√wvÆ
,

1086 0,
this›
->
bôs
,this›->
owty≥
,&
wøµed
);

1087 i‡(
ovîÊow
Ë
√wvÆ
 = 
wøµed
;

1088 
ªtvÆ
 = 
ﬁdvÆ
;

1092 i‡(!(
ovîÊow
 && 
this›
->
owty≥
 =
BFOVERFLOW_FAIL
)) {

1093 
	`addRïlyL⁄gL⁄g
(
c
,
ªtvÆ
);

1094 
	`£tUnsig√dBôfõld
(
o
->
±r
,
this›
->
off£t
,

1095 
this›
->
bôs
,
√wvÆ
);

1097 
	`addRïlyNuŒ
(
c
);

1100 
ch™ges
++;

1103 
buf
[9];

1104 
°æí
 = 0;

1105 *
§c
 = 
NULL
;

1106 
Œbuf
[
LONG_STR_SIZE
];

1108 i‡(
o
 !
NULL
)

1109 
§c
 = 
	`gëObje˘RódO∆ySåög
(
o
,&
°æí
,
Œbuf
);

1115 
	`mem£t
(
buf
,0,9);

1116 
i
;

1117 
size_t
 
byã
 = 
this›
->
off£t
 >> 3;

1118 
i
 = 0; i < 9; i++) {

1119 i‡(
§c
 =
NULL
 || 
i
+
byã
 >(
size_t
)
°æí
) ;

1120 
buf
[
i
] = 
§c
[i+
byã
];

1125 i‡(
this›
->
sign
) {

1126 
öt64_t
 
vÆ
 = 
	`gëSig√dBôfõld
(
buf
,
this›
->
off£t
-(
byã
*8),

1127 
this›
->
bôs
);

1128 
	`addRïlyL⁄gL⁄g
(
c
,
vÆ
);

1130 
uöt64_t
 
vÆ
 = 
	`gëUnsig√dBôfõld
(
buf
,
this›
->
off£t
-(
byã
*8),

1131 
this›
->
bôs
);

1132 
	`addRïlyL⁄gL⁄g
(
c
,
vÆ
);

1137 i‡(
ch™ges
) {

1138 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

1139 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"£tbô",
c
->
¨gv
[1],c->
db
->
id
);

1140 
£rvî
.
dúty
 +
ch™ges
;

1142 
	`z‰ì
(
›s
);

1143 
	}
}

1145 
	$bôfõldComm™d
(
˛õ¡
 *
c
) {

1146 
	`bôfõldGíîic
(
c
, 
BITFIELD_FLAG_NONE
);

1147 
	}
}

1149 
	$bôfõldroComm™d
(
˛õ¡
 *
c
) {

1150 
	`bôfõldGíîic
(
c
, 
BITFIELD_FLAG_READONLY
);

1151 
	}
}

	@blocked.c

63 
	~"£rvî.h
"

65 
£rveClõ¡BlockedOnLi°
(
˛õ¡
 *
ª˚ivî
, 
robj
 *
key
,Ñobj *
d°key
, 
ªdisDb
 *
db
,Ñobj *
vÆue
, 
whîe
);

77 
	sbköfo
 {

78 
li°Node
 *
	mli°node
;

79 
°ªamID
 
	m°ªam_id
;

80 } 
	tbköfo
;

85 
	$blockClõ¡
(
˛õ¡
 *
c
, 
bty≥
) {

86 
c
->
Êags
 |
CLIENT_BLOCKED
;

87 
c
->
bty≥
 = btype;

88 
£rvî
.
blocked_˛õ¡s
++;

89 
£rvî
.
blocked_˛õ¡s_by_ty≥
[
bty≥
]++;

90 
	`addClõ¡ToTimeoutTabÀ
(
c
);

91 
	}
}

96 
	$¥o˚ssUnblockedClõ¡s
() {

97 
li°Node
 *
 
;

98 
˛õ¡
 *
c
;

100 
	`li°Lígth
(
£rvî
.
unblocked_˛õ¡s
)) {

101 
 
 = 
	`li°Fú°
(
£rvî
.
unblocked_˛õ¡s
);

102 
	`£rvîAs£π
(
 
 !
NULL
);

103 
c
 = 
 
->
vÆue
;

104 
	`li°DñNode
(
£rvî
.
unblocked_˛õ¡s
,
 
);

105 
c
->
Êags
 &~
CLIENT_UNBLOCKED
;

111 i‡(!(
c
->
Êags
 & 
CLIENT_BLOCKED
)) {

112 i‡(
c
->
quîybuf
 && 
	`sd¶í
(c->querybuf) > 0) {

113 
	`¥o˚ssI≈utBuf„r
(
c
);

117 
	}
}

135 
	$queueClõ¡F‹Rïro˚ssög
(
˛õ¡
 *
c
) {

138 i‡(!(
c
->
Êags
 & 
CLIENT_UNBLOCKED
)) {

139 
c
->
Êags
 |
CLIENT_UNBLOCKED
;

140 
	`li°AddNodeTaû
(
£rvî
.
unblocked_˛õ¡s
,
c
);

142 
	}
}

146 
	$unblockClõ¡
(
˛õ¡
 *
c
) {

147 i‡(
c
->
bty≥
 =
BLOCKED_LIST
 ||

148 
c
->
bty≥
 =
BLOCKED_ZSET
 ||

149 
c
->
bty≥
 =
BLOCKED_STREAM
) {

150 
	`unblockClõ¡WaôögD©a
(
c
);

151 } i‡(
c
->
bty≥
 =
BLOCKED_WAIT
) {

152 
	`unblockClõ¡WaôögRïliˇs
(
c
);

153 } i‡(
c
->
bty≥
 =
BLOCKED_MODULE
) {

154 i‡(
	`moduÀClõ¡IsBlockedOnKeys
(
c
)Ë
	`unblockClõ¡WaôögD©a
(c);

155 
	`unblockClõ¡FromModuÀ
(
c
);

157 
	`£rvîP™ic
("Unknown btype in unblockClient().");

161 
£rvî
.
blocked_˛õ¡s
--;

162 
£rvî
.
blocked_˛õ¡s_by_ty≥
[
c
->
bty≥
]--;

163 
c
->
Êags
 &~
CLIENT_BLOCKED
;

164 
c
->
bty≥
 = 
BLOCKED_NONE
;

165 
	`ªmoveClõ¡FromTimeoutTabÀ
(
c
);

166 
	`queueClõ¡F‹Rïro˚ssög
(
c
);

167 
	}
}

172 
	$ª∂yToBlockedClõ¡TimedOut
(
˛õ¡
 *
c
) {

173 i‡(
c
->
bty≥
 =
BLOCKED_LIST
 ||

174 
c
->
bty≥
 =
BLOCKED_ZSET
 ||

175 
c
->
bty≥
 =
BLOCKED_STREAM
) {

176 
	`addRïlyNuŒAºay
(
c
);

177 } i‡(
c
->
bty≥
 =
BLOCKED_WAIT
) {

178 
	`addRïlyL⁄gL⁄g
(
c
,
	`ª∂iˇti⁄Cou¡AcksByOff£t
(c->
bp›
.
ª∂off£t
));

179 } i‡(
c
->
bty≥
 =
BLOCKED_MODULE
) {

180 
	`moduÀBlockedClõ¡TimedOut
(
c
);

182 
	`£rvîP™ic
("Unknown btype inÑeplyToBlockedClientTimedOut().");

184 
	}
}

193 
	$disc⁄√˘AŒBlockedClõ¡s
() {

194 
li°Node
 *
 
;

195 
li°Iãr
 
li
;

197 
	`li°Rewöd
(
£rvî
.
˛õ¡s
,&
li
);

198 (
 
 = 
	`li°Next
(&
li
))) {

199 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

201 i‡(
c
->
Êags
 & 
CLIENT_BLOCKED
) {

202 
	`addRïlySds
(
c
,
	`sd¢ew
(

205 
	`unblockClõ¡
(
c
);

206 
c
->
Êags
 |
CLIENT_CLOSE_AFTER_REPLY
;

209 
	}
}

214 
	$£rveClõ¡sBlockedOnLi°Key
(
robj
 *
o
, 
ªadyLi°
 *
æ
) {

217 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
æ
->
db
->
blockög_keys
,æ->
key
);

218 i‡(
de
) {

219 
li°
 *
˛õ¡s
 = 
	`di˘GëVÆ
(
de
);

220 
num˛õ¡s
 = 
	`li°Lígth
(
˛õ¡s
);

222 
num˛õ¡s
--) {

223 
li°Node
 *
˛õ¡node
 = 
	`li°Fú°
(
˛õ¡s
);

224 
˛õ¡
 *
ª˚ivî
 = 
˛õ¡node
->
vÆue
;

226 i‡(
ª˚ivî
->
bty≥
 !
BLOCKED_LIST
) {

229 
	`li°RŸ©eHódToTaû
(
˛õ¡s
);

233 
robj
 *
d°key
 = 
ª˚ivî
->
bp›
.
èrgë
;

234 
whîe
 = (
ª˚ivî
->
œ°cmd
 &&

235 
ª˚ivî
->
œ°cmd
->
¥oc
 =
bÕ›Comm™d
) ?

236 
LIST_HEAD
 : 
LIST_TAIL
;

237 
robj
 *
vÆue
 = 
	`li°Ty≥P›
(
o
,
whîe
);

239 i‡(
vÆue
) {

243 i‡(
d°key
Ë
	`ö¸RefCou¡
(dstkey);

244 
	`unblockClõ¡
(
ª˚ivî
);

246 i‡(
	`£rveClõ¡BlockedOnLi°
(
ª˚ivî
,

247 
æ
->
key
,
d°key
,æ->
db
,
vÆue
,

248 
whîe
Ë=
C_ERR
)

252 
	`li°Ty≥Push
(
o
,
vÆue
,
whîe
);

255 i‡(
d°key
Ë
	`de¸RefCou¡
(dstkey);

256 
	`de¸RefCou¡
(
vÆue
);

263 i‡(
	`li°Ty≥Lígth
(
o
) == 0) {

264 
	`dbDñëe
(
æ
->
db
,æ->
key
);

265 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
æ
->
key
,æ->
db
->
id
);

269 
	}
}

274 
	$£rveClõ¡sBlockedOnS‹ãdSëKey
(
robj
 *
o
, 
ªadyLi°
 *
æ
) {

277 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
æ
->
db
->
blockög_keys
,æ->
key
);

278 i‡(
de
) {

279 
li°
 *
˛õ¡s
 = 
	`di˘GëVÆ
(
de
);

280 
num˛õ¡s
 = 
	`li°Lígth
(
˛õ¡s
);

281 
zˇrd
 = 
	`z£tLígth
(
o
);

283 
num˛õ¡s
-- && 
zˇrd
) {

284 
li°Node
 *
˛õ¡node
 = 
	`li°Fú°
(
˛õ¡s
);

285 
˛õ¡
 *
ª˚ivî
 = 
˛õ¡node
->
vÆue
;

287 i‡(
ª˚ivî
->
bty≥
 !
BLOCKED_ZSET
) {

290 
	`li°RŸ©eHódToTaû
(
˛õ¡s
);

294 
whîe
 = (
ª˚ivî
->
œ°cmd
 &&

295 
ª˚ivî
->
œ°cmd
->
¥oc
 =
bzp›möComm™d
)

296 ? 
ZSET_MIN
 : 
ZSET_MAX
;

297 
	`unblockClõ¡
(
ª˚ivî
);

298 
	`gíîicZp›Comm™d
(
ª˚ivî
,&
æ
->
key
,1,
whîe
,1,
NULL
);

299 
zˇrd
--;

302 
robj
 *
¨gv
[2];

303 
ªdisComm™d
 *
cmd
 = 
whîe
 =
ZSET_MIN
 ?

304 
£rvî
.
zp›möComm™d
 :

305 
£rvî
.
zp›maxComm™d
;

306 
¨gv
[0] = 
	`¸óãSåögObje˘
(
cmd
->
«me
,
	`°æí
(cmd->name));

307 
¨gv
[1] = 
æ
->
key
;

308 
	`ö¸RefCou¡
(
æ
->
key
);

309 
	`¥›ag©e
(
cmd
,
ª˚ivî
->
db
->
id
,

310 
¨gv
,2,
PROPAGATE_AOF
|
PROPAGATE_REPL
);

311 
	`de¸RefCou¡
(
¨gv
[0]);

312 
	`de¸RefCou¡
(
¨gv
[1]);

315 
	}
}

320 
	$£rveClõ¡sBlockedOnSåómKey
(
robj
 *
o
, 
ªadyLi°
 *
æ
) {

321 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
æ
->
db
->
blockög_keys
,æ->
key
);

322 
°ªam
 *
s
 = 
o
->
±r
;

327 i‡(
de
) {

328 
li°
 *
˛õ¡s
 = 
	`di˘GëVÆ
(
de
);

329 
li°Node
 *
 
;

330 
li°Iãr
 
li
;

331 
	`li°Rewöd
(
˛õ¡s
,&
li
);

333 (
 
 = 
	`li°Next
(&
li
))) {

334 
˛õ¡
 *
ª˚ivî
 = 
	`li°NodeVÆue
(
 
);

335 i‡(
ª˚ivî
->
bty≥
 !
BLOCKED_STREAM
) ;

336 
bköfo
 *
bki
 = 
	`di˘FëchVÆue
(
ª˚ivî
->
bp›
.
keys
,
æ
->
key
);

337 
°ªamID
 *
gt
 = &
bki
->
°ªam_id
;

348 
°ªamCG
 *
group
 = 
NULL
;

349 i‡(
ª˚ivî
->
bp›
.
xªad_group
) {

350 
group
 = 
	`°ªamLookupCG
(
s
,

351 
ª˚ivî
->
bp›
.
xªad_group
->
±r
);

354 i‡(!
group
) {

355 
	`addRïlyEº‹
(
ª˚ivî
,

358 
	`unblockClõ¡
(
ª˚ivî
);

361 *
gt
 = 
group
->
œ°_id
;

365 i‡(
	`°ªamCom∑ªID
(&
s
->
œ°_id
, 
gt
) > 0) {

366 
°ªamID
 
°¨t
 = *
gt
;

367 
	`°ªamIn¸ID
(&
°¨t
);

370 
°ªamC⁄sumî
 *
c⁄sumî
 = 
NULL
;

371 
nﬂck
 = 0;

373 i‡(
group
) {

374 
c⁄sumî
 =

375 
	`°ªamLookupC⁄sumî
(
group
,

376 
ª˚ivî
->
bp›
.
xªad_c⁄sumî
->
±r
,

377 
SLC_NONE
);

378 
nﬂck
 = 
ª˚ivî
->
bp›
.
xªad_group_nﬂck
;

385 i‡(
ª˚ivî
->
ª•
 == 2) {

386 
	`addRïlyAºayLí
(
ª˚ivî
,1);

387 
	`addRïlyAºayLí
(
ª˚ivî
,2);

389 
	`addRïlyM≠Lí
(
ª˚ivî
,1);

391 
	`addRïlyBulk
(
ª˚ivî
,
æ
->
key
);

393 
°ªamPr›Info
 
pi
 = {

394 
æ
->
key
,

395 
ª˚ivî
->
bp›
.
xªad_group


397 
	`°ªamRïlyWôhR™ge
(
ª˚ivî
,
s
,&
°¨t
,
NULL
,

398 
ª˚ivî
->
bp›
.
xªad_cou¡
,

399 0, 
group
, 
c⁄sumî
, 
nﬂck
, &
pi
);

405 
	`unblockClõ¡
(
ª˚ivî
);

409 
	}
}

417 
	$£rveClõ¡sBlockedOnKeyByModuÀ
(
ªadyLi°
 *
æ
) {

418 
di˘E¡ry
 *
de
;

422 
de
 = 
	`di˘Föd
(
æ
->
db
->
blockög_keys
,æ->
key
);

423 i‡(
de
) {

424 
li°
 *
˛õ¡s
 = 
	`di˘GëVÆ
(
de
);

425 
num˛õ¡s
 = 
	`li°Lígth
(
˛õ¡s
);

427 
num˛õ¡s
--) {

428 
li°Node
 *
˛õ¡node
 = 
	`li°Fú°
(
˛õ¡s
);

429 
˛õ¡
 *
ª˚ivî
 = 
˛õ¡node
->
vÆue
;

436 
	`li°RŸ©eHódToTaû
(
˛õ¡s
);

438 i‡(
ª˚ivî
->
bty≥
 !
BLOCKED_MODULE
) ;

446 i‡(!
	`moduÀTrySîveClõ¡BlockedOnKey
(
ª˚ivî
, 
æ
->
key
)) ;

448 
	`moduÀUnblockClõ¡
(
ª˚ivî
);

451 
	}
}

474 
	$h™dÀClõ¡sBlockedOnKeys
() {

475 
	`li°Lígth
(
£rvî
.
ªady_keys
) != 0) {

476 
li°
 *
l
;

482 
l
 = 
£rvî
.
ªady_keys
;

483 
£rvî
.
ªady_keys
 = 
	`li°Cª©e
();

485 
	`li°Lígth
(
l
) != 0) {

486 
li°Node
 *
 
 = 
	`li°Fú°
(
l
);

487 
ªadyLi°
 *
æ
 = 
 
->
vÆue
;

491 
	`di˘Dñëe
(
æ
->
db
->
ªady_keys
,æ->
key
);

500 
£rvî
.
fixed_time_expúe
++;

501 
	`upd©eCachedTime
(0);

504 
robj
 *
o
 = 
	`lookupKeyWrôe
(
æ
->
db
,æ->
key
);

506 i‡(
o
 !
NULL
) {

507 i‡(
o
->
ty≥
 =
OBJ_LIST
)

508 
	`£rveClõ¡sBlockedOnLi°Key
(
o
,
æ
);

509 i‡(
o
->
ty≥
 =
OBJ_ZSET
)

510 
	`£rveClõ¡sBlockedOnS‹ãdSëKey
(
o
,
æ
);

511 i‡(
o
->
ty≥
 =
OBJ_STREAM
)

512 
	`£rveClõ¡sBlockedOnSåómKey
(
o
,
æ
);

516 
	`£rveClõ¡sBlockedOnKeyByModuÀ
(
æ
);

518 
£rvî
.
fixed_time_expúe
--;

521 
	`de¸RefCou¡
(
æ
->
key
);

522 
	`z‰ì
(
æ
);

523 
	`li°DñNode
(
l
,
 
);

525 
	`li°Rñó£
(
l
);

527 
	}
}

556 
	$blockF‹Keys
(
˛õ¡
 *
c
, 
bty≥
, 
robj
 **
keys
, 
numkeys
, 
m°ime_t
 
timeout
,Ñobj *
èrgë
, 
°ªamID
 *
ids
) {

557 
di˘E¡ry
 *
de
;

558 
li°
 *
l
;

559 
j
;

561 
c
->
bp›
.
timeout
 =Åimeout;

562 
c
->
bp›
.
èrgë
 =Åarget;

564 i‡(
èrgë
 !
NULL
Ë
	`ö¸RefCou¡
(target);

566 
j
 = 0; j < 
numkeys
; j++) {

569 
bköfo
 *
bki
 = 
	`zmÆloc
((*bki));

570 i‡(
bty≥
 =
BLOCKED_STREAM
)

571 
bki
->
°ªam_id
 = 
ids
[
j
];

574 i‡(
	`di˘Add
(
c
->
bp›
.
keys
,keys[
j
],
bki
Ë!
DICT_OK
) {

575 
	`z‰ì
(
bki
);

578 
	`ö¸RefCou¡
(
keys
[
j
]);

581 
de
 = 
	`di˘Föd
(
c
->
db
->
blockög_keys
,
keys
[
j
]);

582 i‡(
de
 =
NULL
) {

583 
ªtvÆ
;

586 
l
 = 
	`li°Cª©e
();

587 
ªtvÆ
 = 
	`di˘Add
(
c
->
db
->
blockög_keys
,
keys
[
j
],
l
);

588 
	`ö¸RefCou¡
(
keys
[
j
]);

589 
	`£rvîAs£πWôhInfo
(
c
,
keys
[
j
],
ªtvÆ
 =
DICT_OK
);

591 
l
 = 
	`di˘GëVÆ
(
de
);

593 
	`li°AddNodeTaû
(
l
,
c
);

594 
bki
->
li°node
 = 
	`li°La°
(
l
);

596 
	`blockClõ¡
(
c
,
bty≥
);

597 
	}
}

601 
	$unblockClõ¡WaôögD©a
(
˛õ¡
 *
c
) {

602 
di˘E¡ry
 *
de
;

603 
di˘Iãøt‹
 *
di
;

604 
li°
 *
l
;

606 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`di˘Size
(c->
bp›
.
keys
) != 0);

607 
di
 = 
	`di˘GëIãøt‹
(
c
->
bp›
.
keys
);

609 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

610 
robj
 *
key
 = 
	`di˘GëKey
(
de
);

611 
bköfo
 *
bki
 = 
	`di˘GëVÆ
(
de
);

614 
l
 = 
	`di˘FëchVÆue
(
c
->
db
->
blockög_keys
,
key
);

615 
	`£rvîAs£πWôhInfo
(
c
,
key
,
l
 !
NULL
);

616 
	`li°DñNode
(
l
,
bki
->
li°node
);

618 i‡(
	`li°Lígth
(
l
) == 0)

619 
	`di˘Dñëe
(
c
->
db
->
blockög_keys
,
key
);

621 
	`di˘Rñó£Iãøt‹
(
di
);

624 
	`di˘Em±y
(
c
->
bp›
.
keys
,
NULL
);

625 i‡(
c
->
bp›
.
èrgë
) {

626 
	`de¸RefCou¡
(
c
->
bp›
.
èrgë
);

627 
c
->
bp›
.
èrgë
 = 
NULL
;

629 i‡(
c
->
bp›
.
xªad_group
) {

630 
	`de¸RefCou¡
(
c
->
bp›
.
xªad_group
);

631 
	`de¸RefCou¡
(
c
->
bp›
.
xªad_c⁄sumî
);

632 
c
->
bp›
.
xªad_group
 = 
NULL
;

633 
c
->
bp›
.
xªad_c⁄sumî
 = 
NULL
;

635 
	}
}

644 
	$sig«lKeyAsRódy
(
ªdisDb
 *
db
, 
robj
 *
key
) {

645 
ªadyLi°
 *
æ
;

648 i‡(
	`di˘Föd
(
db
->
blockög_keys
,
key
Ë=
NULL
) ;

651 i‡(
	`di˘Föd
(
db
->
ªady_keys
,
key
Ë!
NULL
) ;

654 
æ
 = 
	`zmÆloc
((*rl));

655 
æ
->
key
 = key;

656 
æ
->
db
 = db;

657 
	`ö¸RefCou¡
(
key
);

658 
	`li°AddNodeTaû
(
£rvî
.
ªady_keys
,
æ
);

663 
	`ö¸RefCou¡
(
key
);

664 
	`£rvîAs£π
(
	`di˘Add
(
db
->
ªady_keys
,
key
,
NULL
Ë=
DICT_OK
);

665 
	}
}

	@childinfo.c

30 
	~"£rvî.h
"

31 
	~<uni°d.h
>

36 
	$›íChûdInfoPùe
() {

37 i‡(
	`pùe
(
£rvî
.
chûd_öfo_pùe
) == -1) {

40 
	`˛o£ChûdInfoPùe
();

41 } i‡(
	`™ëN⁄Block
(
NULL
,
£rvî
.
chûd_öfo_pùe
[0]Ë!
ANET_OK
) {

42 
	`˛o£ChûdInfoPùe
();

44 
	`mem£t
(&
£rvî
.
chûd_öfo_d©a
,0,(server.child_info_data));

46 
	}
}

49 
	$˛o£ChûdInfoPùe
() {

50 i‡(
£rvî
.
chûd_öfo_pùe
[0] != -1 ||

51 
£rvî
.
chûd_öfo_pùe
[1] != -1)

53 
	`˛o£
(
£rvî
.
chûd_öfo_pùe
[0]);

54 
	`˛o£
(
£rvî
.
chûd_öfo_pùe
[1]);

55 
£rvî
.
chûd_öfo_pùe
[0] = -1;

56 
£rvî
.
chûd_öfo_pùe
[1] = -1;

58 
	}
}

62 
	$£ndChûdInfo
(
±y≥
) {

63 i‡(
£rvî
.
chûd_öfo_pùe
[1] == -1) ;

64 
£rvî
.
chûd_öfo_d©a
.
magic
 = 
CHILD_INFO_MAGIC
;

65 
£rvî
.
chûd_öfo_d©a
.
¥o˚ss_ty≥
 = 
±y≥
;

66 
ssize_t
 
wÀn
 = (
£rvî
.
chûd_öfo_d©a
);

67 i‡(
	`wrôe
(
£rvî
.
chûd_öfo_pùe
[1],&£rvî.
chûd_öfo_d©a
,
wÀn
) != wlen) {

70 
	}
}

73 
	$ª˚iveChûdInfo
() {

74 i‡(
£rvî
.
chûd_öfo_pùe
[0] == -1) ;

75 
ssize_t
 
wÀn
 = (
£rvî
.
chûd_öfo_d©a
);

76 i‡(
	`ªad
(
£rvî
.
chûd_öfo_pùe
[0],&£rvî.
chûd_öfo_d©a
,
wÀn
) == wlen &&

77 
£rvî
.
chûd_öfo_d©a
.
magic
 =
CHILD_INFO_MAGIC
)

79 i‡(
£rvî
.
chûd_öfo_d©a
.
¥o˚ss_ty≥
 =
CHILD_INFO_TYPE_RDB
) {

80 
£rvî
.
°©_rdb_cow_byãs
 = sîvî.
chûd_öfo_d©a
.
cow_size
;

81 } i‡(
£rvî
.
chûd_öfo_d©a
.
¥o˚ss_ty≥
 =
CHILD_INFO_TYPE_AOF
) {

82 
£rvî
.
°©_aof_cow_byãs
 = sîvî.
chûd_öfo_d©a
.
cow_size
;

83 } i‡(
£rvî
.
chûd_öfo_d©a
.
¥o˚ss_ty≥
 =
CHILD_INFO_TYPE_MODULE
) {

84 
£rvî
.
°©_moduÀ_cow_byãs
 = sîvî.
chûd_öfo_d©a
.
cow_size
;

87 
	}
}

	@cluster.c

31 
	~"£rvî.h
"

32 
	~"˛u°î.h
"

33 
	~"ídünc⁄v.h
"

35 
	~<sys/ty≥s.h
>

36 
	~<sys/sockë.h
>

37 
	~<¨∑/öë.h
>

38 
	~<f˙é.h
>

39 
	~<uni°d.h
>

40 
	~<sys/°©.h
>

41 
	~<sys/fûe.h
>

42 
	~<m©h.h
>

47 
˛u°îNode
 *
	gmy£lf
 = 
NULL
;

49 
˛u°îNode
 *
¸óãClu°îNode
(*
nodíame
, 
Êags
);

50 
˛u°îAddNode
(
˛u°îNode
 *
node
);

51 
˛u°îAc˚±H™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
);

52 
˛u°îRódH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
);

53 
˛u°îSídPög
(
˛u°îLök
 *
lök
, 
ty≥
);

54 
˛u°îSídFaû
(*
nodíame
);

55 
˛u°îSídFaûovîAuthIfNìded
(
˛u°îNode
 *
node
, 
˛u°îMsg
 *
ªque°
);

56 
˛u°îUpd©eSèã
();

57 
˛u°îNodeGëSlŸBô
(
˛u°îNode
 *
n
, 
¶Ÿ
);

58 
sds
 
˛u°îGíNodesDes¸ùti⁄
(
fûãr
);

59 
˛u°îNode
 *
˛u°îLookupNode
(c⁄° *
«me
);

60 
˛u°îNodeAddSœve
(
˛u°îNode
 *
ma°î
, clu°îNodê*
¶ave
);

61 
˛u°îAddSlŸ
(
˛u°îNode
 *
n
, 
¶Ÿ
);

62 
˛u°îDñSlŸ
(
¶Ÿ
);

63 
˛u°îDñNodeSlŸs
(
˛u°îNode
 *
node
);

64 
˛u°îNodeSëSlŸBô
(
˛u°îNode
 *
n
, 
¶Ÿ
);

65 
˛u°îSëMa°î
(
˛u°îNode
 *
n
);

66 
˛u°îH™dÀSœveFaûovî
();

67 
˛u°îH™dÀSœveMigøti⁄
(
max_¶aves
);

68 
bôm≠Te°Bô
(*
bôm≠
, 
pos
);

69 
˛u°îDoBef‹eSÀï
(
Êags
);

70 
˛u°îSídUpd©e
(
˛u°îLök
 *
lök
, 
˛u°îNode
 *
node
);

71 
ª£tM™uÆFaûovî
();

72 
˛u°îClo£AŒSlŸs
();

73 
˛u°îSëNodeAsMa°î
(
˛u°îNode
 *
n
);

74 
˛u°îDñNode
(
˛u°îNode
 *
dñnode
);

75 
sds
 
ª¥e£¡Clu°îNodeFœgs
(sd†
ci
, 
uöt16_t
 
Êags
);

76 
uöt64_t
 
˛u°îGëMaxEpoch
();

77 
˛u°îBumpC⁄figEpochWôhoutC⁄£nsus
();

78 
moduÀCÆlClu°îRe˚ivîs
(c⁄° *
£ndî_id
, 
uöt64_t
 
moduÀ_id
, 
uöt8_t
 
ty≥
, c⁄° *
∑ylﬂd
, 
uöt32_t
 
Àn
);

90 
	$˛u°îLﬂdC⁄fig
(*
fûíame
) {

91 
FILE
 *
Â
 = 
	`f›í
(
fûíame
,"r");

92 
°©
 
sb
;

93 *
löe
;

94 
maxlöe
, 
j
;

96 i‡(
Â
 =
NULL
) {

97 i‡(
î∫o
 =
ENOENT
) {

98  
C_ERR
;

100 
	`£rvîLog
(
LL_WARNING
,

102 
fûíame
, 
	`°ªº‹
(
î∫o
));

103 
	`exô
(1);

109 i‡(
	`f°©
(
	`fûío
(
Â
),&
sb
Ë!-1 && sb.
°_size
 == 0) {

110 
	`f˛o£
(
Â
);

111  
C_ERR
;

121 
maxlöe
 = 1024+
CLUSTER_SLOTS
*128;

122 
löe
 = 
	`zmÆloc
(
maxlöe
);

123 
	`fgës
(
löe
,
maxlöe
,
Â
Ë!
NULL
) {

124 
¨gc
;

125 
sds
 *
¨gv
;

126 
˛u°îNode
 *
n
, *
ma°î
;

127 *
p
, *
s
;

132 i‡(
löe
[0] == '\n' ||Üine[0] == '\0') ;

135 
¨gv
 = 
	`sds•lô¨gs
(
löe
,&
¨gc
);

136 i‡(
¨gv
 =
NULL
Ë
fmãº
;

140 i‡(
	`°rˇ£cmp
(
¨gv
[0],"vars") == 0) {

141 i‡(!(
¨gc
 % 2)Ë
fmãº
;

142 
j
 = 1; j < 
¨gc
; j += 2) {

143 i‡(
	`°rˇ£cmp
(
¨gv
[
j
],"currentEpoch") == 0) {

144 
£rvî
.
˛u°î
->
cuºítEpoch
 =

145 
	`°πouŒ
(
¨gv
[
j
+1],
NULL
,10);

146 } i‡(
	`°rˇ£cmp
(
¨gv
[
j
],"lastVoteEpoch") == 0) {

147 
£rvî
.
˛u°î
->
œ°VŸeEpoch
 =

148 
	`°πouŒ
(
¨gv
[
j
+1],
NULL
,10);

150 
	`£rvîLog
(
LL_WARNING
,

152 
¨gv
[
j
]);

155 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

160 i‡(
¨gc
 < 8) {

161 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

162 
fmãº
;

166 
n
 = 
	`˛u°îLookupNode
(
¨gv
[0]);

167 i‡(!
n
) {

168 
n
 = 
	`¸óãClu°îNode
(
¨gv
[0],0);

169 
	`˛u°îAddNode
(
n
);

172 i‡((
p
 = 
	`°ºchr
(
¨gv
[1],':')Ë=
NULL
) {

173 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

174 
fmãº
;

176 *
p
 = '\0';

177 
	`mem˝y
(
n
->
ù
,
¨gv
[1],
	`°æí
(argv[1])+1);

178 *
p‹t
 = 
p
+1;

179 *
bu•
 = 
	`°rchr
(
p‹t
,'@');

180 i‡(
bu•
) {

181 *
bu•
 = '\0';

182 
bu•
++;

184 
n
->
p‹t
 = 
	`©oi
(port);

188 
n
->
˝‹t
 = 
bu•
 ? 
	`©oi
(bu•Ë:Ç->
p‹t
 + 
CLUSTER_PORT_INCR
;

191 
p
 = 
s
 = 
¨gv
[2];

192 
p
) {

193 
p
 = 
	`°rchr
(
s
,',');

194 i‡(
p
) *p = '\0';

195 i‡(!
	`°rˇ£cmp
(
s
,"myself")) {

196 
	`£rvîAs£π
(
£rvî
.
˛u°î
->
my£lf
 =
NULL
);

197 
my£lf
 = 
£rvî
.
˛u°î
->my£l‡
n
;

198 
n
->
Êags
 |
CLUSTER_NODE_MYSELF
;

199 } i‡(!
	`°rˇ£cmp
(
s
,"master")) {

200 
n
->
Êags
 |
CLUSTER_NODE_MASTER
;

201 } i‡(!
	`°rˇ£cmp
(
s
,"slave")) {

202 
n
->
Êags
 |
CLUSTER_NODE_SLAVE
;

203 } i‡(!
	`°rˇ£cmp
(
s
,"fail?")) {

204 
n
->
Êags
 |
CLUSTER_NODE_PFAIL
;

205 } i‡(!
	`°rˇ£cmp
(
s
,"fail")) {

206 
n
->
Êags
 |
CLUSTER_NODE_FAIL
;

207 
n
->
Áû_time
 = 
	`m°ime
();

208 } i‡(!
	`°rˇ£cmp
(
s
,"handshake")) {

209 
n
->
Êags
 |
CLUSTER_NODE_HANDSHAKE
;

210 } i‡(!
	`°rˇ£cmp
(
s
,"noaddr")) {

211 
n
->
Êags
 |
CLUSTER_NODE_NOADDR
;

212 } i‡(!
	`°rˇ£cmp
(
s
,"nofailover")) {

213 
n
->
Êags
 |
CLUSTER_NODE_NOFAILOVER
;

214 } i‡(!
	`°rˇ£cmp
(
s
,"noflags")) {

217 
	`£rvîP™ic
("Unknown flag inÑedis cluster config file");

219 i‡(
p
Ë
s
 =Ö+1;

224 i‡(
¨gv
[3][0] != '-') {

225 
ma°î
 = 
	`˛u°îLookupNode
(
¨gv
[3]);

226 i‡(!
ma°î
) {

227 
ma°î
 = 
	`¸óãClu°îNode
(
¨gv
[3],0);

228 
	`˛u°îAddNode
(
ma°î
);

230 
n
->
¶aveof
 = 
ma°î
;

231 
	`˛u°îNodeAddSœve
(
ma°î
,
n
);

235 i‡(
	`©oi
(
¨gv
[4])Ë
n
->
pög_£¡
 = 
	`m°ime
();

236 i‡(
	`©oi
(
¨gv
[5])Ë
n
->
p⁄g_ª˚ived
 = 
	`m°ime
();

239 
n
->
c⁄figEpoch
 = 
	`°πouŒ
(
¨gv
[6],
NULL
,10);

242 
j
 = 8; j < 
¨gc
; j++) {

243 
°¨t
, 
°›
;

245 i‡(
¨gv
[
j
][0] == '[') {

247 
¶Ÿ
;

248 
dúe˘i⁄
;

249 
˛u°îNode
 *
˙
;

251 
p
 = 
	`°rchr
(
¨gv
[
j
],'-');

252 
	`£rvîAs£π
(
p
 !
NULL
);

253 *
p
 = '\0';

254 
dúe˘i⁄
 = 
p
[1];

255 
¶Ÿ
 = 
	`©oi
(
¨gv
[
j
]+1);

256 i‡(
¶Ÿ
 < 0 || slŸ >
CLUSTER_SLOTS
) {

257 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

258 
fmãº
;

260 
p
 += 3;

261 
˙
 = 
	`˛u°îLookupNode
(
p
);

262 i‡(!
˙
) {

263 
˙
 = 
	`¸óãClu°îNode
(
p
,0);

264 
	`˛u°îAddNode
(
˙
);

266 i‡(
dúe˘i⁄
 == '>') {

267 
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
¶Ÿ
] = 
˙
;

269 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
¶Ÿ
] = 
˙
;

272 } i‡((
p
 = 
	`°rchr
(
¨gv
[
j
],'-')Ë!
NULL
) {

273 *
p
 = '\0';

274 
°¨t
 = 
	`©oi
(
¨gv
[
j
]);

275 
°›
 = 
	`©oi
(
p
+1);

277 
°¨t
 = 
°›
 = 
	`©oi
(
¨gv
[
j
]);

279 i‡(
°¨t
 < 0 || sèπ >
CLUSTER_SLOTS
 ||

280 
°›
 < 0 || st› >
CLUSTER_SLOTS
)

282 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

283 
fmãº
;

285 
°¨t
 <
°›
Ë
	`˛u°îAddSlŸ
(
n
, start++);

288 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

291 i‡(
£rvî
.
˛u°î
->
my£lf
 =
NULL
Ë
fmãº
;

293 
	`z‰ì
(
löe
);

294 
	`f˛o£
(
Â
);

296 
	`£rvîLog
(
LL_NOTICE
,"Nodêc⁄figuøti⁄Üﬂded, I'm %.40s", 
my£lf
->
«me
);

301 i‡(
	`˛u°îGëMaxEpoch
(Ë> 
£rvî
.
˛u°î
->
cuºítEpoch
) {

302 
£rvî
.
˛u°î
->
cuºítEpoch
 = 
	`˛u°îGëMaxEpoch
();

304  
C_OK
;

306 
fmãº
:

307 
	`£rvîLog
(
LL_WARNING
,

309 
	`z‰ì
(
löe
);

310 i‡(
Â
Ë
	`f˛o£
(fp);

311 
	`exô
(1);

312 
	}
}

326 
	$˛u°îSaveC⁄fig
(
do_fsync
) {

327 
sds
 
ci
;

328 
size_t
 
c⁄ã¡_size
;

329 
°©
 
sb
;

330 
fd
;

332 
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 &~
CLUSTER_TODO_SAVE_CONFIG
;

336 
ci
 = 
	`˛u°îGíNodesDes¸ùti⁄
(
CLUSTER_NODE_HANDSHAKE
);

337 
ci
 = 
	`sdsˇçrötf
(ci,"vars currentEpoch %lluÜastVoteEpoch %llu\n",

338 (Ë
£rvî
.
˛u°î
->
cuºítEpoch
,

339 (Ë
£rvî
.
˛u°î
->
œ°VŸeEpoch
);

340 
c⁄ã¡_size
 = 
	`sd¶í
(
ci
);

342 i‡((
fd
 = 
	`›í
(
£rvî
.
˛u°î_c⁄figfûe
,
O_WRONLY
|
O_CREAT
,0644))

343 =-1Ë
îr
;

346 i‡(
	`f°©
(
fd
,&
sb
) != -1) {

347 i‡(
sb
.
°_size
 > (
off_t
)
c⁄ã¡_size
) {

348 
ci
 = 
	`sdsgrowzîo
(ci,
sb
.
°_size
);

349 
	`mem£t
(
ci
+
c⁄ã¡_size
,'\n',
sb
.
°_size
-content_size);

352 i‡(
	`wrôe
(
fd
,
ci
,
	`sd¶í
(ci)Ë!(
ssize_t
)sd¶í(ci)Ë
îr
;

353 i‡(
do_fsync
) {

354 
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 &~
CLUSTER_TODO_FSYNC_CONFIG
;

355 
	`fsync
(
fd
);

360 i‡(
c⁄ã¡_size
 !
	`sd¶í
(
ci
Ë&& 
	`·runˇã
(
fd
,content_size) == -1) {

363 
	`˛o£
(
fd
);

364 
	`sds‰ì
(
ci
);

367 
îr
:

368 i‡(
fd
 !-1Ë
	`˛o£
(fd);

369 
	`sds‰ì
(
ci
);

371 
	}
}

373 
	$˛u°îSaveC⁄figOrDõ
(
do_fsync
) {

374 i‡(
	`˛u°îSaveC⁄fig
(
do_fsync
) == -1) {

375 
	`£rvîLog
(
LL_WARNING
,"Fatal: can't update cluster config file.");

376 
	`exô
(1);

378 
	}
}

389 
	$˛u°îLockC⁄fig
(*
fûíame
) {

394 #i‡!
	`deföed
(
__sun
)

398 
fd
 = 
	`›í
(
fûíame
,
O_WRONLY
|
O_CREAT
,0644);

399 i‡(
fd
 == -1) {

400 
	`£rvîLog
(
LL_WARNING
,

402 
fûíame
, 
	`°ªº‹
(
î∫o
));

403  
C_ERR
;

406 i‡(
	`Êock
(
fd
,
LOCK_EX
|
LOCK_NB
) == -1) {

407 i‡(
î∫o
 =
EWOULDBLOCK
) {

408 
	`£rvîLog
(
LL_WARNING
,

412 "fûes.", 
fûíame
);

414 
	`£rvîLog
(
LL_WARNING
,

415 "ImpossibÀÅÿlock %s: %s", 
fûíame
, 
	`°ªº‹
(
î∫o
));

417 
	`˛o£
(
fd
);

418  
C_ERR
;

424  
C_OK
;

425 
	}
}

431 
	$˛u°îUpd©eMy£lfFœgs
() {

432 
ﬁdÊags
 = 
my£lf
->
Êags
;

433 
noÁûovî
 = 
£rvî
.
˛u°î_¶ave_no_Áûovî
 ?

434 
CLUSTER_NODE_NOFAILOVER
 : 0;

435 
my£lf
->
Êags
 &~
CLUSTER_NODE_NOFAILOVER
;

436 
my£lf
->
Êags
 |
noÁûovî
;

437 i‡(
my£lf
->
Êags
 !
ﬁdÊags
) {

438 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

439 
CLUSTER_TODO_UPDATE_STATE
);

441 
	}
}

443 
	$˛u°îInô
() {

444 
ßvec⁄f
 = 0;

446 
£rvî
.
˛u°î
 = 
	`zmÆloc
((
˛u°îSèã
));

447 
£rvî
.
˛u°î
->
my£lf
 = 
NULL
;

448 
£rvî
.
˛u°î
->
cuºítEpoch
 = 0;

449 
£rvî
.
˛u°î
->
°©e
 = 
CLUSTER_FAIL
;

450 
£rvî
.
˛u°î
->
size
 = 1;

451 
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 = 0;

452 
£rvî
.
˛u°î
->
nodes
 = 
	`di˘Cª©e
(&
˛u°îNodesDi˘Ty≥
,
NULL
);

453 
£rvî
.
˛u°î
->
nodes_bœck_li°
 =

454 
	`di˘Cª©e
(&
˛u°îNodesBœckLi°Di˘Ty≥
,
NULL
);

455 
£rvî
.
˛u°î
->
Áûovî_auth_time
 = 0;

456 
£rvî
.
˛u°î
->
Áûovî_auth_cou¡
 = 0;

457 
£rvî
.
˛u°î
->
Áûovî_auth_ønk
 = 0;

458 
£rvî
.
˛u°î
->
Áûovî_auth_ïoch
 = 0;

459 
£rvî
.
˛u°î
->
ˇ¡_Áûovî_ªas⁄
 = 
CLUSTER_CANT_FAILOVER_NONE
;

460 
£rvî
.
˛u°î
->
œ°VŸeEpoch
 = 0;

461 
i
 = 0; i < 
CLUSTERMSG_TYPE_COUNT
; i++) {

462 
£rvî
.
˛u°î
->
°©s_bus_mesßges_£¡
[
i
] = 0;

463 
£rvî
.
˛u°î
->
°©s_bus_mesßges_ª˚ived
[
i
] = 0;

465 
£rvî
.
˛u°î
->
°©s_pÁû_nodes
 = 0;

466 
	`mem£t
(
£rvî
.
˛u°î
->
¶Ÿs
,0, (server.cluster->slots));

467 
	`˛u°îClo£AŒSlŸs
();

471 i‡(
	`˛u°îLockC⁄fig
(
£rvî
.
˛u°î_c⁄figfûe
Ë=
C_ERR
)

472 
	`exô
(1);

475 i‡(
	`˛u°îLﬂdC⁄fig
(
£rvî
.
˛u°î_c⁄figfûe
Ë=
C_ERR
) {

478 
my£lf
 = 
£rvî
.
˛u°î
->myself =

479 
	`¸óãClu°îNode
(
NULL
,
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_MASTER
);

480 
	`£rvîLog
(
LL_NOTICE
,"No cluster configuration found, I'm %.40s",

481 
my£lf
->
«me
);

482 
	`˛u°îAddNode
(
my£lf
);

483 
ßvec⁄f
 = 1;

485 i‡(
ßvec⁄f
Ë
	`˛u°îSaveC⁄figOrDõ
(1);

488 
£rvî
.
cfd_cou¡
 = 0;

493 
p‹t
 = 
£rvî
.
és_˛u°î
 ? sîvî.
és_p‹t
 : server.port;

494 i‡(
p‹t
 > (65535-
CLUSTER_PORT_INCR
)) {

495 
	`£rvîLog
(
LL_WARNING
, "RedisÖortÇumberÅoo high. "

500 
	`exô
(1);

502 i‡(
	`li°íToP‹t
(
p‹t
+
CLUSTER_PORT_INCR
,

503 
£rvî
.
cfd
,&£rvî.
cfd_cou¡
Ë=
C_ERR
)

505 
	`exô
(1);

507 
j
;

509 
j
 = 0; j < 
£rvî
.
cfd_cou¡
; j++) {

510 i‡(
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, sîvî.
cfd
[
j
], 
AE_READABLE
,

511 
˛u°îAc˚±H™dÀr
, 
NULL
Ë=
AE_ERR
)

512 
	`£rvîP™ic
("UnrecoverableÉrror creating Redis Cluster "

518 
£rvî
.
˛u°î
->
¶Ÿs_to_keys
 = 
	`øxNew
();

519 
	`mem£t
(
£rvî
.
˛u°î
->
¶Ÿs_keys_cou¡
,0,

520 (
£rvî
.
˛u°î
->
¶Ÿs_keys_cou¡
));

524 
my£lf
->
p‹t
 =Öort;

525 
my£lf
->
˝‹t
 = 
p‹t
+
CLUSTER_PORT_INCR
;

526 i‡(
£rvî
.
˛u°î_™noun˚_p‹t
)

527 
my£lf
->
p‹t
 = 
£rvî
.
˛u°î_™noun˚_p‹t
;

528 i‡(
£rvî
.
˛u°î_™noun˚_bus_p‹t
)

529 
my£lf
->
˝‹t
 = 
£rvî
.
˛u°î_™noun˚_bus_p‹t
;

531 
£rvî
.
˛u°î
->
mf_íd
 = 0;

532 
	`ª£tM™uÆFaûovî
();

533 
	`˛u°îUpd©eMy£lfFœgs
();

534 
	}
}

545 
	$˛u°îRe£t
(
h¨d
) {

546 
di˘Iãøt‹
 *
di
;

547 
di˘E¡ry
 *
de
;

548 
j
;

551 i‡(
	`nodeIsSœve
(
my£lf
)) {

552 
	`˛u°îSëNodeAsMa°î
(
my£lf
);

553 
	`ª∂iˇti⁄Un£tMa°î
();

554 
	`em±yDb
(-1,
EMPTYDB_NO_FLAGS
,
NULL
);

558 
	`˛u°îClo£AŒSlŸs
();

559 
	`ª£tM™uÆFaûovî
();

562 
j
 = 0; j < 
CLUSTER_SLOTS
; j++Ë
	`˛u°îDñSlŸ
(j);

565 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

566 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

567 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

569 i‡(
node
 =
my£lf
) ;

570 
	`˛u°îDñNode
(
node
);

572 
	`di˘Rñó£Iãøt‹
(
di
);

575 i‡(
h¨d
) {

576 
sds
 
ﬁd«me
;

578 
£rvî
.
˛u°î
->
cuºítEpoch
 = 0;

579 
£rvî
.
˛u°î
->
œ°VŸeEpoch
 = 0;

580 
my£lf
->
c⁄figEpoch
 = 0;

581 
	`£rvîLog
(
LL_WARNING
, "configEpoch setÅo 0 via CLUSTER RESET HARD");

585 
ﬁd«me
 = 
	`sd¢ewÀn
(
my£lf
->
«me
, 
CLUSTER_NAMELEN
);

586 
	`di˘Dñëe
(
£rvî
.
˛u°î
->
nodes
,
ﬁd«me
);

587 
	`sds‰ì
(
ﬁd«me
);

588 
	`gëR™domHexCh¨s
(
my£lf
->
«me
, 
CLUSTER_NAMELEN
);

589 
	`˛u°îAddNode
(
my£lf
);

590 
	`£rvîLog
(
LL_NOTICE
,"Nodêh¨dÑe£t,Çow I'm %.40s", 
my£lf
->
«me
);

594 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

595 
CLUSTER_TODO_UPDATE_STATE
|

596 
CLUSTER_TODO_FSYNC_CONFIG
);

597 
	}
}

603 
˛u°îLök
 *
	$¸óãClu°îLök
(
˛u°îNode
 *
node
) {

604 
˛u°îLök
 *
lök
 = 
	`zmÆloc
((*link));

605 
lök
->
˘ime
 = 
	`m°ime
();

606 
lök
->
¢dbuf
 = 
	`sd£m±y
();

607 
lök
->
rcvbuf
 = 
	`sd£m±y
();

608 
lök
->
node
 =Çode;

609 
lök
->
c⁄n
 = 
NULL
;

610  
lök
;

611 
	}
}

616 
	$‰ìClu°îLök
(
˛u°îLök
 *
lök
) {

617 i‡(
lök
->
c⁄n
) {

618 
	`c⁄nClo£
(
lök
->
c⁄n
);

619 
lök
->
c⁄n
 = 
NULL
;

621 
	`sds‰ì
(
lök
->
¢dbuf
);

622 
	`sds‰ì
(
lök
->
rcvbuf
);

623 i‡(
lök
->
node
)

624 
lök
->
node
->lök = 
NULL
;

625 
	`z‰ì
(
lök
);

626 
	}
}

628 
	$˛u°îC⁄nAc˚±H™dÀr
(
c⁄√˘i⁄
 *
c⁄n
) {

629 
˛u°îLök
 *
lök
;

631 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë!
CONN_STATE_CONNECTED
) {

632 
	`£rvîLog
(
LL_VERBOSE
,

633 "Eº‹ác˚±ög clu°îÇodêc⁄√˘i⁄: %s", 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

634 
	`c⁄nClo£
(
c⁄n
);

643 
lök
 = 
	`¸óãClu°îLök
(
NULL
);

644 
lök
->
c⁄n
 = conn;

645 
	`c⁄nSëPriv©eD©a
(
c⁄n
, 
lök
);

648 
	`c⁄nSëRódH™dÀr
(
c⁄n
, 
˛u°îRódH™dÀr
);

649 
	}
}

651 
	#MAX_CLUSTER_ACCEPTS_PER_CALL
 1000

	)

652 
	$˛u°îAc˚±H™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

653 
˝‹t
, 
cfd
;

654 
max
 = 
MAX_CLUSTER_ACCEPTS_PER_CALL
;

655 
cù
[
NET_IP_STR_LEN
];

656 
	`UNUSED
(
ñ
);

657 
	`UNUSED
(
mask
);

658 
	`UNUSED
(
¥ivd©a
);

662 i‡(
£rvî
.
ma°îho°
 =
NULL
 && sîvî.
lﬂdög
) ;

664 
max
--) {

665 
cfd
 = 
	`™ëT˝Ac˚±
(
£rvî
.
√ãº
, 
fd
, 
cù
, (cù), &
˝‹t
);

666 i‡(
cfd
 =
ANET_ERR
) {

667 i‡(
î∫o
 !
EWOULDBLOCK
)

668 
	`£rvîLog
(
LL_VERBOSE
,

669 "Eº‹ác˚±ög clu°îÇode: %s", 
£rvî
.
√ãº
);

673 
c⁄√˘i⁄
 *
c⁄n
 = 
£rvî
.
és_˛u°î
 ? 
	`c⁄nCª©eAc˚±edTLS
(
cfd
,1Ë: 
	`c⁄nCª©eAc˚±edSockë
(cfd);

674 
	`c⁄nN⁄Block
(
c⁄n
);

675 
	`c⁄nE«bÀT˝NoDñay
(
c⁄n
);

678 
	`£rvîLog
(
LL_VERBOSE
,"Ac˚±ög clu°îÇodêc⁄√˘i⁄ from %s:%d", 
cù
, 
˝‹t
);

683 i‡(
	`c⁄nAc˚±
(
c⁄n
, 
˛u°îC⁄nAc˚±H™dÀr
Ë=
C_ERR
) {

684 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë=
CONN_STATE_ERROR
)

685 
	`£rvîLog
(
LL_VERBOSE
,

687 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

688 
	`c⁄nClo£
(
c⁄n
);

692 
	}
}

704 
	$keyHashSlŸ
(*
key
, 
keyÀn
) {

705 
s
, 
e
;

707 
s
 = 0; s < 
keyÀn
; s++)

708 i‡(
key
[
s
] == '{') ;

711 i‡(
s
 =
keyÀn
Ë 
	`¸c16
(
key
,keylen) & 0x3FFF;

714 
e
 = 
s
+1;É < 
keyÀn
;É++)

715 i‡(
key
[
e
] == '}') ;

718 i‡(
e
 =
keyÀn
 ||É =
s
+1Ë 
	`¸c16
(
key
,keylen) & 0x3FFF;

722  
	`¸c16
(
key
+
s
+1,
e
-s-1) & 0x3FFF;

723 
	}
}

736 
˛u°îNode
 *
	$¸óãClu°îNode
(*
nodíame
, 
Êags
) {

737 
˛u°îNode
 *
node
 = 
	`zmÆloc
((*node));

739 i‡(
nodíame
)

740 
	`mem˝y
(
node
->
«me
, 
nodíame
, 
CLUSTER_NAMELEN
);

742 
	`gëR™domHexCh¨s
(
node
->
«me
, 
CLUSTER_NAMELEN
);

743 
node
->
˘ime
 = 
	`m°ime
();

744 
node
->
c⁄figEpoch
 = 0;

745 
node
->
Êags
 = flags;

746 
	`mem£t
(
node
->
¶Ÿs
,0,(node->slots));

747 
node
->
num¶Ÿs
 = 0;

748 
node
->
num¶aves
 = 0;

749 
node
->
¶aves
 = 
NULL
;

750 
node
->
¶aveof
 = 
NULL
;

751 
node
->
pög_£¡
 =Çode->
p⁄g_ª˚ived
 = 0;

752 
node
->
d©a_ª˚ived
 = 0;

753 
node
->
Áû_time
 = 0;

754 
node
->
lök
 = 
NULL
;

755 
	`mem£t
(
node
->
ù
,0,(node->ip));

756 
node
->
p‹t
 = 0;

757 
node
->
˝‹t
 = 0;

758 
node
->
Áû_ªp‹ts
 = 
	`li°Cª©e
();

759 
node
->
vŸed_time
 = 0;

760 
node
->
‹ph™ed_time
 = 0;

761 
node
->
ª∂_off£t_time
 = 0;

762 
node
->
ª∂_off£t
 = 0;

763 
	`li°SëFªeMëhod
(
node
->
Áû_ªp‹ts
,
z‰ì
);

764  
node
;

765 
	}
}

777 
	$˛u°îNodeAddFaûuªRï‹t
(
˛u°îNode
 *
Áûög
, clu°îNodê*
£ndî
) {

778 
li°
 *
l
 = 
Áûög
->
Áû_ªp‹ts
;

779 
li°Node
 *
 
;

780 
li°Iãr
 
li
;

781 
˛u°îNodeFaûRï‹t
 *
‰
;

785 
	`li°Rewöd
(
l
,&
li
);

786 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

787 
‰
 = 
 
->
vÆue
;

788 i‡(
‰
->
node
 =
£ndî
) {

789 
‰
->
time
 = 
	`m°ime
();

795 
‰
 = 
	`zmÆloc
((*fr));

796 
‰
->
node
 = 
£ndî
;

797 
‰
->
time
 = 
	`m°ime
();

798 
	`li°AddNodeTaû
(
l
,
‰
);

800 
	}
}

807 
	$˛u°îNodeCÀ™upFaûuªRï‹ts
(
˛u°îNode
 *
node
) {

808 
li°
 *
l
 = 
node
->
Áû_ªp‹ts
;

809 
li°Node
 *
 
;

810 
li°Iãr
 
li
;

811 
˛u°îNodeFaûRï‹t
 *
‰
;

812 
m°ime_t
 
maxtime
 = 
£rvî
.
˛u°î_node_timeout
 *

813 
CLUSTER_FAIL_REPORT_VALIDITY_MULT
;

814 
m°ime_t
 
now
 = 
	`m°ime
();

816 
	`li°Rewöd
(
l
,&
li
);

817 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

818 
‰
 = 
 
->
vÆue
;

819 i‡(
now
 - 
‰
->
time
 > 
maxtime
Ë
	`li°DñNode
(
l
,
 
);

821 
	}
}

834 
	$˛u°îNodeDñFaûuªRï‹t
(
˛u°îNode
 *
node
, clu°îNodê*
£ndî
) {

835 
li°
 *
l
 = 
node
->
Áû_ªp‹ts
;

836 
li°Node
 *
 
;

837 
li°Iãr
 
li
;

838 
˛u°îNodeFaûRï‹t
 *
‰
;

841 
	`li°Rewöd
(
l
,&
li
);

842 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

843 
‰
 = 
 
->
vÆue
;

844 i‡(
‰
->
node
 =
£ndî
) ;

846 i‡(!
 
)  0;

849 
	`li°DñNode
(
l
,
 
);

850 
	`˛u°îNodeCÀ™upFaûuªRï‹ts
(
node
);

852 
	}
}

857 
	$˛u°îNodeFaûuªRï‹tsCou¡
(
˛u°îNode
 *
node
) {

858 
	`˛u°îNodeCÀ™upFaûuªRï‹ts
(
node
);

859  
	`li°Lígth
(
node
->
Áû_ªp‹ts
);

860 
	}
}

862 
	$˛u°îNodeRemoveSœve
(
˛u°îNode
 *
ma°î
, clu°îNodê*
¶ave
) {

863 
j
;

865 
j
 = 0; j < 
ma°î
->
num¶aves
; j++) {

866 i‡(
ma°î
->
¶aves
[
j
] =
¶ave
) {

867 i‡((
j
+1Ë< 
ma°î
->
num¶aves
) {

868 
ªmaöög_¶aves
 = (
ma°î
->
num¶aves
 - 
j
) - 1;

869 
	`memmove
(
ma°î
->
¶aves
+
j
,master->slaves+(j+1),

870 ((*
ma°î
->
¶aves
Ë* 
ªmaöög_¶aves
));

872 
ma°î
->
num¶aves
--;

873 i‡(
ma°î
->
num¶aves
 == 0)

874 
ma°î
->
Êags
 &~
CLUSTER_NODE_MIGRATE_TO
;

875  
C_OK
;

878  
C_ERR
;

879 
	}
}

881 
	$˛u°îNodeAddSœve
(
˛u°îNode
 *
ma°î
, clu°îNodê*
¶ave
) {

882 
j
;

885 
j
 = 0; j < 
ma°î
->
num¶aves
; j++)

886 i‡(
ma°î
->
¶aves
[
j
] =
¶ave
Ë 
C_ERR
;

887 
ma°î
->
¶aves
 = 
	`zªÆloc
(master->slaves,

888 (
˛u°îNode
*)*(
ma°î
->
num¶aves
+1));

889 
ma°î
->
¶aves
[ma°î->
num¶aves
] = 
¶ave
;

890 
ma°î
->
num¶aves
++;

891 
ma°î
->
Êags
 |
CLUSTER_NODE_MIGRATE_TO
;

892  
C_OK
;

893 
	}
}

895 
	$˛u°îCou¡N⁄FaûögSœves
(
˛u°îNode
 *
n
) {

896 
j
, 
ok¶aves
 = 0;

898 
j
 = 0; j < 
n
->
num¶aves
; j++)

899 i‡(!
	`nodeFaûed
(
n
->
¶aves
[
j
])Ë
ok¶aves
++;

900  
ok¶aves
;

901 
	}
}

904 
	$‰ìClu°îNode
(
˛u°îNode
 *
n
) {

905 
sds
 
nodíame
;

906 
j
;

910 
j
 = 0; j < 
n
->
num¶aves
; j++)

911 
n
->
¶aves
[
j
]->
¶aveof
 = 
NULL
;

914 i‡(
	`nodeIsSœve
(
n
Ë&&Ç->
¶aveof
Ë
	`˛u°îNodeRemoveSœve
(n->slaveof,n);

917 
nodíame
 = 
	`sd¢ewÀn
(
n
->
«me
, 
CLUSTER_NAMELEN
);

918 
	`£rvîAs£π
(
	`di˘Dñëe
(
£rvî
.
˛u°î
->
nodes
,
nodíame
Ë=
DICT_OK
);

919 
	`sds‰ì
(
nodíame
);

922 i‡(
n
->
lök
Ë
	`‰ìClu°îLök
(n->link);

923 
	`li°Rñó£
(
n
->
Áû_ªp‹ts
);

924 
	`z‰ì
(
n
->
¶aves
);

925 
	`z‰ì
(
n
);

926 
	}
}

929 
	$˛u°îAddNode
(
˛u°îNode
 *
node
) {

930 
ªtvÆ
;

932 
ªtvÆ
 = 
	`di˘Add
(
£rvî
.
˛u°î
->
nodes
,

933 
	`sd¢ewÀn
(
node
->
«me
,
CLUSTER_NAMELEN
),Çode);

934  (
ªtvÆ
 =
DICT_OK
Ë? 
C_OK
 : 
C_ERR
;

935 
	}
}

948 
	$˛u°îDñNode
(
˛u°îNode
 *
dñnode
) {

949 
j
;

950 
di˘Iãøt‹
 *
di
;

951 
di˘E¡ry
 *
de
;

954 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

955 i‡(
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
j
] =
dñnode
)

956 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
j
] = 
NULL
;

957 i‡(
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
j
] =
dñnode
)

958 
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
j
] = 
NULL
;

959 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
dñnode
)

960 
	`˛u°îDñSlŸ
(
j
);

964 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

965 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

966 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

968 i‡(
node
 =
dñnode
) ;

969 
	`˛u°îNodeDñFaûuªRï‹t
(
node
,
dñnode
);

971 
	`di˘Rñó£Iãøt‹
(
di
);

974 
	`‰ìClu°îNode
(
dñnode
);

975 
	}
}

978 
˛u°îNode
 *
	$˛u°îLookupNode
(c⁄° *
«me
) {

979 
sds
 
s
 = 
	`sd¢ewÀn
(
«me
, 
CLUSTER_NAMELEN
);

980 
di˘E¡ry
 *
de
;

982 
de
 = 
	`di˘Föd
(
£rvî
.
˛u°î
->
nodes
,
s
);

983 
	`sds‰ì
(
s
);

984 i‡(
de
 =
NULL
)  NULL;

985  
	`di˘GëVÆ
(
de
);

986 
	}
}

992 
	$˛u°îRíameNode
(
˛u°îNode
 *
node
, *
√w«me
) {

993 
ªtvÆ
;

994 
sds
 
s
 = 
	`sd¢ewÀn
(
node
->
«me
, 
CLUSTER_NAMELEN
);

996 
	`£rvîLog
(
LL_DEBUG
,"RenamingÇode %.40s into %.40s",

997 
node
->
«me
, 
√w«me
);

998 
ªtvÆ
 = 
	`di˘Dñëe
(
£rvî
.
˛u°î
->
nodes
, 
s
);

999 
	`sds‰ì
(
s
);

1000 
	`£rvîAs£π
(
ªtvÆ
 =
DICT_OK
);

1001 
	`mem˝y
(
node
->
«me
, 
√w«me
, 
CLUSTER_NAMELEN
);

1002 
	`˛u°îAddNode
(
node
);

1003 
	}
}

1011 
uöt64_t
 
	$˛u°îGëMaxEpoch
() {

1012 
uöt64_t
 
max
 = 0;

1013 
di˘Iãøt‹
 *
di
;

1014 
di˘E¡ry
 *
de
;

1016 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

1017 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1018 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

1019 i‡(
node
->
c⁄figEpoch
 > 
max
) max =Çode->configEpoch;

1021 
	`di˘Rñó£Iãøt‹
(
di
);

1022 i‡(
max
 < 
£rvî
.
˛u°î
->
cuºítEpoch
) max = server.cluster->currentEpoch;

1023  
max
;

1024 
	}
}

1055 
	$˛u°îBumpC⁄figEpochWôhoutC⁄£nsus
() {

1056 
uöt64_t
 
maxEpoch
 = 
	`˛u°îGëMaxEpoch
();

1058 i‡(
my£lf
->
c⁄figEpoch
 == 0 ||

1059 
my£lf
->
c⁄figEpoch
 !
maxEpoch
)

1061 
£rvî
.
˛u°î
->
cuºítEpoch
++;

1062 
my£lf
->
c⁄figEpoch
 = 
£rvî
.
˛u°î
->
cuºítEpoch
;

1063 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

1064 
CLUSTER_TODO_FSYNC_CONFIG
);

1065 
	`£rvîLog
(
LL_WARNING
,

1067 (Ë
my£lf
->
c⁄figEpoch
);

1068  
C_OK
;

1070  
C_ERR
;

1072 
	}
}

1120 
	$˛u°îH™dÀC⁄figEpochCﬁlisi⁄
(
˛u°îNode
 *
£ndî
) {

1122 i‡(
£ndî
->
c⁄figEpoch
 !
my£lf
->configEpoch ||

1123 !
	`nodeIsMa°î
(
£ndî
Ë|| !nodeIsMa°î(
my£lf
)) ;

1125 i‡(
	`memcmp
(
£ndî
->
«me
,
my£lf
->«me,
CLUSTER_NAMELEN
) <= 0) ;

1127 
£rvî
.
˛u°î
->
cuºítEpoch
++;

1128 
my£lf
->
c⁄figEpoch
 = 
£rvî
.
˛u°î
->
cuºítEpoch
;

1129 
	`˛u°îSaveC⁄figOrDõ
(1);

1130 
	`£rvîLog
(
LL_VERBOSE
,

1133 
£ndî
->
«me
,

1134 (Ë
my£lf
->
c⁄figEpoch
);

1135 
	}
}

1159 
	#CLUSTER_BLACKLIST_TTL
 60

	)

1168 
	$˛u°îBœckli°CÀ™up
() {

1169 
di˘Iãøt‹
 *
di
;

1170 
di˘E¡ry
 *
de
;

1172 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes_bœck_li°
);

1173 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1174 
öt64_t
 
expúe
 = 
	`di˘GëUnsig√dI¡egîVÆ
(
de
);

1176 i‡(
expúe
 < 
£rvî
.
unixtime
)

1177 
	`di˘Dñëe
(
£rvî
.
˛u°î
->
nodes_bœck_li°
,
	`di˘GëKey
(
de
));

1179 
	`di˘Rñó£Iãøt‹
(
di
);

1180 
	}
}

1183 
	$˛u°îBœckli°AddNode
(
˛u°îNode
 *
node
) {

1184 
di˘E¡ry
 *
de
;

1185 
sds
 
id
 = 
	`sd¢ewÀn
(
node
->
«me
,
CLUSTER_NAMELEN
);

1187 
	`˛u°îBœckli°CÀ™up
();

1188 i‡(
	`di˘Add
(
£rvî
.
˛u°î
->
nodes_bœck_li°
,
id
,
NULL
Ë=
DICT_OK
) {

1191 
id
 = 
	`sdsdup
(id);

1193 
de
 = 
	`di˘Föd
(
£rvî
.
˛u°î
->
nodes_bœck_li°
,
id
);

1194 
	`di˘SëUnsig√dI¡egîVÆ
(
de
,
	`time
(
NULL
)+
CLUSTER_BLACKLIST_TTL
);

1195 
	`sds‰ì
(
id
);

1196 
	}
}

1201 
	$˛u°îBœckli°Exi°s
(*
nodeid
) {

1202 
sds
 
id
 = 
	`sd¢ewÀn
(
nodeid
,
CLUSTER_NAMELEN
);

1203 
ªtvÆ
;

1205 
	`˛u°îBœckli°CÀ™up
();

1206 
ªtvÆ
 = 
	`di˘Föd
(
£rvî
.
˛u°î
->
nodes_bœck_li°
,
id
Ë!
NULL
;

1207 
	`sds‰ì
(
id
);

1208  
ªtvÆ
;

1209 
	}
}

1236 
	$m¨kNodeAsFaûögIfNìded
(
˛u°îNode
 *
node
) {

1237 
Áûuªs
;

1238 
√eded_qu‹um
 = (
£rvî
.
˛u°î
->
size
 / 2) + 1;

1240 i‡(!
	`nodeTimedOut
(
node
)) ;

1241 i‡(
	`nodeFaûed
(
node
)) ;

1243 
Áûuªs
 = 
	`˛u°îNodeFaûuªRï‹tsCou¡
(
node
);

1245 i‡(
	`nodeIsMa°î
(
my£lf
)Ë
Áûuªs
++;

1246 i‡(
Áûuªs
 < 
√eded_qu‹um
) ;

1248 
	`£rvîLog
(
LL_NOTICE
,

1249 "M¨kögÇodê%.40†a†Áûög (qu‹umÑóched).", 
node
->
«me
);

1252 
node
->
Êags
 &~
CLUSTER_NODE_PFAIL
;

1253 
node
->
Êags
 |
CLUSTER_NODE_FAIL
;

1254 
node
->
Áû_time
 = 
	`m°ime
();

1258 i‡(
	`nodeIsMa°î
(
my£lf
)Ë
	`˛u°îSídFaû
(
node
->
«me
);

1259 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

1260 
	}
}

1265 
	$˛órNodeFaûuªIfNìded
(
˛u°îNode
 *
node
) {

1266 
m°ime_t
 
now
 = 
	`m°ime
();

1268 
	`£rvîAs£π
(
	`nodeFaûed
(
node
));

1272 i‡(
	`nodeIsSœve
(
node
Ë||Çode->
num¶Ÿs
 == 0) {

1273 
	`£rvîLog
(
LL_NOTICE
,

1275 
node
->
«me
,

1276 
	`nodeIsSœve
(
node
) ? "replica" : "master without slots");

1277 
node
->
Êags
 &~
CLUSTER_NODE_FAIL
;

1278 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

1285 i‡(
	`nodeIsMa°î
(
node
Ë&&Çode->
num¶Ÿs
 > 0 &&

1286 (
now
 - 
node
->
Áû_time
) >

1287 (
£rvî
.
˛u°î_node_timeout
 * 
CLUSTER_FAIL_UNDO_TIME_MULT
))

1289 
	`£rvîLog
(
LL_NOTICE
,

1291 
node
->
«me
);

1292 
node
->
Êags
 &~
CLUSTER_NODE_FAIL
;

1293 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

1295 
	}
}

1300 
	$˛u°îH™dshakeInProgªss
(*
ù
, 
p‹t
, 
˝‹t
) {

1301 
di˘Iãøt‹
 *
di
;

1302 
di˘E¡ry
 *
de
;

1304 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

1305 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1306 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

1308 i‡(!
	`nodeInH™dshake
(
node
)) ;

1309 i‡(!
	`°rˇ£cmp
(
node
->
ù
,ip) &&

1310 
node
->
p‹t
 ==Öort &&

1311 
node
->
˝‹t
 == cport) ;

1313 
	`di˘Rñó£Iãøt‹
(
di
);

1314  
de
 !
NULL
;

1315 
	}
}

1324 
	$˛u°îSèπH™dshake
(*
ù
, 
p‹t
, 
˝‹t
) {

1325 
˛u°îNode
 *
n
;

1326 
n‹m_ù
[
NET_IP_STR_LEN
];

1327 
sockaddr_°‹age
 
ß
;

1330 i‡(
	`öë_±⁄
(
AF_INET
,
ù
,

1331 &(((
sockaddr_ö
 *)&
ß
)->
sö_addr
)))

1333 
ß
.
ss_Ámûy
 = 
AF_INET
;

1334 } i‡(
	`öë_±⁄
(
AF_INET6
,
ù
,

1335 &(((
sockaddr_ö6
 *)&
ß
)->
sö6_addr
)))

1337 
ß
.
ss_Ámûy
 = 
AF_INET6
;

1339 
î∫o
 = 
EINVAL
;

1344 i‡(
p‹t
 <0 ||Ö‹à> 65535 || 
˝‹t
 <= 0 || cport > 65535) {

1345 
î∫o
 = 
EINVAL
;

1351 
	`mem£t
(
n‹m_ù
,0,
NET_IP_STR_LEN
);

1352 i‡(
ß
.
ss_Ámûy
 =
AF_INET
)

1353 
	`öë_¡›
(
AF_INET
,

1354 (*)&(((
sockaddr_ö
 *)&
ß
)->
sö_addr
),

1355 
n‹m_ù
,
NET_IP_STR_LEN
);

1357 
	`öë_¡›
(
AF_INET6
,

1358 (*)&(((
sockaddr_ö6
 *)&
ß
)->
sö6_addr
),

1359 
n‹m_ù
,
NET_IP_STR_LEN
);

1361 i‡(
	`˛u°îH™dshakeInProgªss
(
n‹m_ù
,
p‹t
,
˝‹t
)) {

1362 
î∫o
 = 
EAGAIN
;

1369 
n
 = 
	`¸óãClu°îNode
(
NULL
,
CLUSTER_NODE_HANDSHAKE
|
CLUSTER_NODE_MEET
);

1370 
	`mem˝y
(
n
->
ù
,
n‹m_ù
,(n->ip));

1371 
n
->
p‹t
 =Öort;

1372 
n
->
˝‹t
 = cport;

1373 
	`˛u°îAddNode
(
n
);

1375 
	}
}

1381 
	$˛u°îPro˚ssGossùSe˘i⁄
(
˛u°îMsg
 *
hdr
, 
˛u°îLök
 *
lök
) {

1382 
uöt16_t
 
cou¡
 = 
	`¡ohs
(
hdr
->count);

1383 
˛u°îMsgD©aGossù
 *
g
 = (˛u°îMsgD©aGossù*Ë
hdr
->
d©a
.
pög
.
gossù
;

1384 
˛u°îNode
 *
£ndî
 = 
lök
->
node
 ?Üök->nodê: 
	`˛u°îLookupNode
(
hdr
->sender);

1386 
cou¡
--) {

1387 
uöt16_t
 
Êags
 = 
	`¡ohs
(
g
->flags);

1388 
˛u°îNode
 *
node
;

1389 
sds
 
ci
;

1391 i‡(
£rvî
.
vîbosôy
 =
LL_DEBUG
) {

1392 
ci
 = 
	`ª¥e£¡Clu°îNodeFœgs
(
	`sd£m±y
(), 
Êags
);

1393 
	`£rvîLog
(
LL_DEBUG
,"GOSSIP %.40s %s:%d@%d %s",

1394 
g
->
nodíame
,

1395 
g
->
ù
,

1396 
	`¡ohs
(
g
->
p‹t
),

1397 
	`¡ohs
(
g
->
˝‹t
),

1398 
ci
);

1399 
	`sds‰ì
(
ci
);

1403 
node
 = 
	`˛u°îLookupNode
(
g
->
nodíame
);

1404 i‡(
node
) {

1407 i‡(
£ndî
 && 
	`nodeIsMa°î
(£ndîË&& 
node
 !
my£lf
) {

1408 i‡(
Êags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_PFAIL
)) {

1409 i‡(
	`˛u°îNodeAddFaûuªRï‹t
(
node
,
£ndî
)) {

1410 
	`£rvîLog
(
LL_VERBOSE
,

1412 
£ndî
->
«me
, 
node
->name);

1414 
	`m¨kNodeAsFaûögIfNìded
(
node
);

1416 i‡(
	`˛u°îNodeDñFaûuªRï‹t
(
node
,
£ndî
)) {

1417 
	`£rvîLog
(
LL_VERBOSE
,

1419 
£ndî
->
«me
, 
node
->name);

1428 i‡(!(
Êags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_PFAIL
)) &&

1429 
node
->
pög_£¡
 == 0 &&

1430 
	`˛u°îNodeFaûuªRï‹tsCou¡
(
node
) == 0)

1432 
m°ime_t
 
p⁄gtime
 = 
	`¡ohl
(
g
->
p⁄g_ª˚ived
);

1433 
p⁄gtime
 *= 1000;

1439 i‡(
p⁄gtime
 <(
£rvî
.
m°ime
+500) &&

1440 
p⁄gtime
 > 
node
->
p⁄g_ª˚ived
)

1442 
node
->
p⁄g_ª˚ived
 = 
p⁄gtime
;

1451 i‡(
node
->
Êags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_PFAIL
) &&

1452 !(
Êags
 & 
CLUSTER_NODE_NOADDR
) &&

1453 !(
Êags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_PFAIL
)) &&

1454 (
	`°rˇ£cmp
(
node
->
ù
,
g
->ip) ||

1455 
node
->
p‹t
 !
	`¡ohs
(
g
->port) ||

1456 
node
->
˝‹t
 !
	`¡ohs
(
g
->cport)))

1458 i‡(
node
->
lök
Ë
	`‰ìClu°îLök
(node->link);

1459 
	`mem˝y
(
node
->
ù
,
g
->ù,
NET_IP_STR_LEN
);

1460 
node
->
p‹t
 = 
	`¡ohs
(
g
->port);

1461 
node
->
˝‹t
 = 
	`¡ohs
(
g
->cport);

1462 
node
->
Êags
 &~
CLUSTER_NODE_NOADDR
;

1471 i‡(
£ndî
 &&

1472 !(
Êags
 & 
CLUSTER_NODE_NOADDR
) &&

1473 !
	`˛u°îBœckli°Exi°s
(
g
->
nodíame
))

1475 
	`˛u°îSèπH™dshake
(
g
->
ù
,
	`¡ohs
(g->
p‹t
),¡ohs(g->
˝‹t
));

1480 
g
++;

1482 
	}
}

1487 
	$nodeIp2Såög
(*
buf
, 
˛u°îLök
 *
lök
, *
™noun˚d_ù
) {

1488 i‡(
™noun˚d_ù
[0] != '\0') {

1489 
	`mem˝y
(
buf
,
™noun˚d_ù
,
NET_IP_STR_LEN
);

1490 
buf
[
NET_IP_STR_LEN
-1] = '\0';

1492 
	`c⁄nPìrToSåög
(
lök
->
c⁄n
, 
buf
, 
NET_IP_STR_LEN
, 
NULL
);

1494 
	}
}

1508 
	$nodeUpd©eAddªssIfNìded
(
˛u°îNode
 *
node
, 
˛u°îLök
 *
lök
,

1509 
˛u°îMsg
 *
hdr
)

1511 
ù
[
NET_IP_STR_LEN
] = {0};

1512 
p‹t
 = 
	`¡ohs
(
hdr
->port);

1513 
˝‹t
 = 
	`¡ohs
(
hdr
->cport);

1521 i‡(
lök
 =
node
->link)  0;

1523 
	`nodeIp2Såög
(
ù
,
lök
,
hdr
->
myù
);

1524 i‡(
node
->
p‹t
 =p‹à&&Çode->
˝‹t
 == cport &&

1525 
	`°rcmp
(
ù
,
node
->ip) == 0)  0;

1528 
	`mem˝y
(
node
->
ù
,ip,(ip));

1529 
node
->
p‹t
 =Öort;

1530 
node
->
˝‹t
 = cport;

1531 i‡(
node
->
lök
Ë
	`‰ìClu°îLök
(node->link);

1532 
node
->
Êags
 &~
CLUSTER_NODE_NOADDR
;

1533 
	`£rvîLog
(
LL_WARNING
,"Address updated forÇode %.40s,Çow %s:%d",

1534 
node
->
«me
,Çode->
ù
,Çode->
p‹t
);

1538 i‡(
	`nodeIsSœve
(
my£lf
Ë&& my£lf->
¶aveof
 =
node
)

1539 
	`ª∂iˇti⁄SëMa°î
(
node
->
ù
,Çode->
p‹t
);

1541 
	}
}

1546 
	$˛u°îSëNodeAsMa°î
(
˛u°îNode
 *
n
) {

1547 i‡(
	`nodeIsMa°î
(
n
)) ;

1549 i‡(
n
->
¶aveof
) {

1550 
	`˛u°îNodeRemoveSœve
(
n
->
¶aveof
,n);

1551 i‡(
n
 !
my£lf
Ën->
Êags
 |
CLUSTER_NODE_MIGRATE_TO
;

1553 
n
->
Êags
 &~
CLUSTER_NODE_SLAVE
;

1554 
n
->
Êags
 |
CLUSTER_NODE_MASTER
;

1555 
n
->
¶aveof
 = 
NULL
;

1558 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

1559 
CLUSTER_TODO_UPDATE_STATE
);

1560 
	}
}

1573 
	$˛u°îUpd©eSlŸsC⁄figWôh
(
˛u°îNode
 *
£ndî
, 
uöt64_t
 
£ndîC⁄figEpoch
, *
¶Ÿs
) {

1574 
j
;

1575 
˛u°îNode
 *
curma°î
, *
√wma°î
 = 
NULL
;

1583 
uöt16_t
 
dúty_¶Ÿs
[
CLUSTER_SLOTS
];

1584 
dúty_¶Ÿs_cou¡
 = 0;

1589 
curma°î
 = 
	`nodeIsMa°î
(
my£lf
Ë? my£l‡: my£lf->
¶aveof
;

1591 i‡(
£ndî
 =
my£lf
) {

1592 
	`£rvîLog
(
LL_WARNING
,"Discarding UPDATE messageábout myself.");

1596 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

1597 i‡(
	`bôm≠Te°Bô
(
¶Ÿs
,
j
)) {

1599 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
£ndî
) ;

1605 i‡(
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
j
]) ;

1611 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
NULL
 ||

1612 
£rvî
.
˛u°î
->
¶Ÿs
[
j
]->
c⁄figEpoch
 < 
£ndîC⁄figEpoch
)

1616 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
my£lf
 &&

1617 
	`cou¡KeysInSlŸ
(
j
) &&

1618 
£ndî
 !
my£lf
)

1620 
dúty_¶Ÿs
[
dúty_¶Ÿs_cou¡
] = 
j
;

1621 
dúty_¶Ÿs_cou¡
++;

1624 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
curma°î
)

1625 
√wma°î
 = 
£ndî
;

1626 
	`˛u°îDñSlŸ
(
j
);

1627 
	`˛u°îAddSlŸ
(
£ndî
,
j
);

1628 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

1629 
CLUSTER_TODO_UPDATE_STATE
|

1630 
CLUSTER_TODO_FSYNC_CONFIG
);

1638 i‡(
£rvî
.
˛u°î_moduÀ_Êags
 & 
CLUSTER_MODULE_FLAG_NO_REDIRECTION
)

1648 i‡(
√wma°î
 && 
curma°î
->
num¶Ÿs
 == 0) {

1649 
	`£rvîLog
(
LL_WARNING
,

1651 "a†®ª∂iˇ o‡%.40s", 
£ndî
->
«me
);

1652 
	`˛u°îSëMa°î
(
£ndî
);

1653 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

1654 
CLUSTER_TODO_UPDATE_STATE
|

1655 
CLUSTER_TODO_FSYNC_CONFIG
);

1656 } i‡(
dúty_¶Ÿs_cou¡
) {

1664 
j
 = 0; j < 
dúty_¶Ÿs_cou¡
; j++)

1665 
	`dñKeysInSlŸ
(
dúty_¶Ÿs
[
j
]);

1667 
	}
}

1678 
	$˛u°îPro˚ssPackë
(
˛u°îLök
 *
lök
) {

1679 
˛u°îMsg
 *
hdr
 = (˛u°îMsg*Ë
lök
->
rcvbuf
;

1680 
uöt32_t
 
tŸÀn
 = 
	`¡ohl
(
hdr
->totlen);

1681 
uöt16_t
 
ty≥
 = 
	`¡ohs
(
hdr
->type);

1682 
m°ime_t
 
now
 = 
	`m°ime
();

1684 i‡(
ty≥
 < 
CLUSTERMSG_TYPE_COUNT
)

1685 
£rvî
.
˛u°î
->
°©s_bus_mesßges_ª˚ived
[
ty≥
]++;

1686 
	`£rvîLog
(
LL_DEBUG
,"--- ProcessingÖacket ofÅype %d, %lu bytes",

1687 
ty≥
, (Ë
tŸÀn
);

1690 i‡(
tŸÀn
 < 16)  1;

1691 i‡(
tŸÀn
 > 
	`sd¶í
(
lök
->
rcvbuf
))  1;

1693 i‡(
	`¡ohs
(
hdr
->
vî
Ë!
CLUSTER_PROTO_VER
) {

1698 
uöt16_t
 
Êags
 = 
	`¡ohs
(
hdr
->flags);

1699 
uöt64_t
 
£ndîCuºítEpoch
 = 0, 
£ndîC⁄figEpoch
 = 0;

1700 
˛u°îNode
 *
£ndî
;

1702 i‡(
ty≥
 =
CLUSTERMSG_TYPE_PING
 ||Åy≥ =
CLUSTERMSG_TYPE_PONG
 ||

1703 
ty≥
 =
CLUSTERMSG_TYPE_MEET
)

1705 
uöt16_t
 
cou¡
 = 
	`¡ohs
(
hdr
->count);

1706 
uöt32_t
 
ex∂í
;

1708 
ex∂í
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

1709 
ex∂í
 +((
˛u°îMsgD©aGossù
)*
cou¡
);

1710 i‡(
tŸÀn
 !
ex∂í
)  1;

1711 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_FAIL
) {

1712 
uöt32_t
 
ex∂í
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

1714 
ex∂í
 +(
˛u°îMsgD©aFaû
);

1715 i‡(
tŸÀn
 !
ex∂í
)  1;

1716 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_PUBLISH
) {

1717 
uöt32_t
 
ex∂í
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

1719 
ex∂í
 +(
˛u°îMsgD©aPublish
) -

1721 
	`¡ohl
(
hdr
->
d©a
.
publish
.
msg
.
ch™√l_Àn
) +

1722 
	`¡ohl
(
hdr
->
d©a
.
publish
.
msg
.
mesßge_Àn
);

1723 i‡(
tŸÀn
 !
ex∂í
)  1;

1724 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST
 ||

1725 
ty≥
 =
CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK
 ||

1726 
ty≥
 =
CLUSTERMSG_TYPE_MFSTART
)

1728 
uöt32_t
 
ex∂í
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

1730 i‡(
tŸÀn
 !
ex∂í
)  1;

1731 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_UPDATE
) {

1732 
uöt32_t
 
ex∂í
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

1734 
ex∂í
 +(
˛u°îMsgD©aUpd©e
);

1735 i‡(
tŸÀn
 !
ex∂í
)  1;

1736 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_MODULE
) {

1737 
uöt32_t
 
ex∂í
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

1739 
ex∂í
 +(
˛u°îMsgD©aPublish
) -

1740 3 + 
	`¡ohl
(
hdr
->
d©a
.
moduÀ
.
msg
.
Àn
);

1741 i‡(
tŸÀn
 !
ex∂í
)  1;

1747 
£ndî
 = 
	`˛u°îLookupNode
(
hdr
->sender);

1753 i‡(
£ndî
Ë£ndî->
d©a_ª˚ived
 = 
now
;

1755 i‡(
£ndî
 && !
	`nodeInH™dshake
(sender)) {

1757 
£ndîCuºítEpoch
 = 
	`¡ohu64
(
hdr
->
cuºítEpoch
);

1758 
£ndîC⁄figEpoch
 = 
	`¡ohu64
(
hdr
->
c⁄figEpoch
);

1759 i‡(
£ndîCuºítEpoch
 > 
£rvî
.
˛u°î
->
cuºítEpoch
)

1760 
£rvî
.
˛u°î
->
cuºítEpoch
 = 
£ndîCuºítEpoch
;

1762 i‡(
£ndîC⁄figEpoch
 > 
£ndî
->
c⁄figEpoch
) {

1763 
£ndî
->
c⁄figEpoch
 = 
£ndîC⁄figEpoch
;

1764 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

1765 
CLUSTER_TODO_FSYNC_CONFIG
);

1768 
£ndî
->
ª∂_off£t
 = 
	`¡ohu64
(
hdr
->
off£t
);

1769 
£ndî
->
ª∂_off£t_time
 = 
now
;

1772 i‡(
£rvî
.
˛u°î
->
mf_íd
 &&

1773 
	`nodeIsSœve
(
my£lf
) &&

1774 
my£lf
->
¶aveof
 =
£ndî
 &&

1775 
hdr
->
mÊags
[0] & 
CLUSTERMSG_FLAG0_PAUSED
 &&

1776 
£rvî
.
˛u°î
->
mf_ma°î_off£t
 == 0)

1778 
£rvî
.
˛u°î
->
mf_ma°î_off£t
 = 
£ndî
->
ª∂_off£t
;

1779 
	`£rvîLog
(
LL_WARNING
,

1782 
£rvî
.
˛u°î
->
mf_ma°î_off£t
);

1787 i‡(
ty≥
 =
CLUSTERMSG_TYPE_PING
 ||Åy≥ =
CLUSTERMSG_TYPE_MEET
) {

1788 
	`£rvîLog
(
LL_DEBUG
,"PögÖackëÑe˚ived: %p", (*)
lök
->
node
);

1801 i‡((
ty≥
 =
CLUSTERMSG_TYPE_MEET
 || 
my£lf
->
ù
[0] == '\0') &&

1802 
£rvî
.
˛u°î_™noun˚_ù
 =
NULL
)

1804 
ù
[
NET_IP_STR_LEN
];

1806 i‡(
	`c⁄nSockName
(
lök
->
c⁄n
,
ù
,(ù),
NULL
) != -1 &&

1807 
	`°rcmp
(
ù
,
my£lf
->ip))

1809 
	`mem˝y
(
my£lf
->
ù
,ù,
NET_IP_STR_LEN
);

1810 
	`£rvîLog
(
LL_WARNING
,"IPáddress forÅhisÇode updatedÅo %s",

1811 
my£lf
->
ù
);

1812 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
);

1820 i‡(!
£ndî
 && 
ty≥
 =
CLUSTERMSG_TYPE_MEET
) {

1821 
˛u°îNode
 *
node
;

1823 
node
 = 
	`¸óãClu°îNode
(
NULL
,
CLUSTER_NODE_HANDSHAKE
);

1824 
	`nodeIp2Såög
(
node
->
ù
,
lök
,
hdr
->
myù
);

1825 
node
->
p‹t
 = 
	`¡ohs
(
hdr
->port);

1826 
node
->
˝‹t
 = 
	`¡ohs
(
hdr
->cport);

1827 
	`˛u°îAddNode
(
node
);

1828 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
);

1834 i‡(!
£ndî
 && 
ty≥
 =
CLUSTERMSG_TYPE_MEET
)

1835 
	`˛u°îPro˚ssGossùSe˘i⁄
(
hdr
,
lök
);

1838 
	`˛u°îSídPög
(
lök
,
CLUSTERMSG_TYPE_PONG
);

1842 i‡(
ty≥
 =
CLUSTERMSG_TYPE_PING
 ||Åy≥ =
CLUSTERMSG_TYPE_PONG
 ||

1843 
ty≥
 =
CLUSTERMSG_TYPE_MEET
)

1845 
	`£rvîLog
(
LL_DEBUG
,"%sÖacketÑeceived: %p",

1846 
ty≥
 =
CLUSTERMSG_TYPE_PING
 ? "ping" : "pong",

1847 (*)
lök
->
node
);

1848 i‡(
lök
->
node
) {

1849 i‡(
	`nodeInH™dshake
(
lök
->
node
)) {

1852 i‡(
£ndî
) {

1853 
	`£rvîLog
(
LL_VERBOSE
,

1855 "upd©ögÅhêaddªs†i‡√eded.", 
£ndî
->
«me
);

1856 i‡(
	`nodeUpd©eAddªssIfNìded
(
£ndî
,
lök
,
hdr
))

1858 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

1859 
CLUSTER_TODO_UPDATE_STATE
);

1863 
	`˛u°îDñNode
(
lök
->
node
);

1869 
	`˛u°îRíameNode
(
lök
->
node
, 
hdr
->
£ndî
);

1870 
	`£rvîLog
(
LL_DEBUG
,"Handshake withÇode %.40s completed.",

1871 
lök
->
node
->
«me
);

1872 
lök
->
node
->
Êags
 &~
CLUSTER_NODE_HANDSHAKE
;

1873 
lök
->
node
->
Êags
 |Êags&(
CLUSTER_NODE_MASTER
|
CLUSTER_NODE_SLAVE
);

1874 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
);

1875 } i‡(
	`memcmp
(
lök
->
node
->
«me
,
hdr
->
£ndî
,

1876 
CLUSTER_NAMELEN
) != 0)

1881 
	`£rvîLog
(
LL_DEBUG
,"PONG contains mismatching sender ID. AboutÇode %.40sádded %d mságo, having flags %d",

1882 
lök
->
node
->
«me
,

1883 ()(
now
-(
lök
->
node
->
˘ime
)),

1884 
lök
->
node
->
Êags
);

1885 
lök
->
node
->
Êags
 |
CLUSTER_NODE_NOADDR
;

1886 
lök
->
node
->
ù
[0] = '\0';

1887 
lök
->
node
->
p‹t
 = 0;

1888 
lök
->
node
->
˝‹t
 = 0;

1889 
	`‰ìClu°îLök
(
lök
);

1890 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
);

1901 i‡(
£ndî
) {

1902 
noÁûovî
 = 
Êags
 & 
CLUSTER_NODE_NOFAILOVER
;

1903 
£ndî
->
Êags
 &~
CLUSTER_NODE_NOFAILOVER
;

1904 
£ndî
->
Êags
 |
noÁûovî
;

1908 i‡(
£ndî
 && 
ty≥
 =
CLUSTERMSG_TYPE_PING
 &&

1909 !
	`nodeInH™dshake
(
£ndî
) &&

1910 
	`nodeUpd©eAddªssIfNìded
(
£ndî
,
lök
,
hdr
))

1912 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

1913 
CLUSTER_TODO_UPDATE_STATE
);

1917 i‡(
lök
->
node
 && 
ty≥
 =
CLUSTERMSG_TYPE_PONG
) {

1918 
lök
->
node
->
p⁄g_ª˚ived
 = 
now
;

1919 
lök
->
node
->
pög_£¡
 = 0;

1927 i‡(
	`nodeTimedOut
(
lök
->
node
)) {

1928 
lök
->
node
->
Êags
 &~
CLUSTER_NODE_PFAIL
;

1929 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

1930 
CLUSTER_TODO_UPDATE_STATE
);

1931 } i‡(
	`nodeFaûed
(
lök
->
node
)) {

1932 
	`˛órNodeFaûuªIfNìded
(
lök
->
node
);

1937 i‡(
£ndî
) {

1938 i‡(!
	`memcmp
(
hdr
->
¶aveof
,
CLUSTER_NODE_NULL_NAME
,

1939 (
hdr
->
¶aveof
)))

1942 
	`˛u°îSëNodeAsMa°î
(
£ndî
);

1945 
˛u°îNode
 *
ma°î
 = 
	`˛u°îLookupNode
(
hdr
->
¶aveof
);

1947 i‡(
	`nodeIsMa°î
(
£ndî
)) {

1949 
	`˛u°îDñNodeSlŸs
(
£ndî
);

1950 
£ndî
->
Êags
 &~(
CLUSTER_NODE_MASTER
|

1951 
CLUSTER_NODE_MIGRATE_TO
);

1952 
£ndî
->
Êags
 |
CLUSTER_NODE_SLAVE
;

1955 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

1956 
CLUSTER_TODO_UPDATE_STATE
);

1960 i‡(
ma°î
 && 
£ndî
->
¶aveof
 != master) {

1961 i‡(
£ndî
->
¶aveof
)

1962 
	`˛u°îNodeRemoveSœve
(
£ndî
->
¶aveof
,sender);

1963 
	`˛u°îNodeAddSœve
(
ma°î
,
£ndî
);

1964 
£ndî
->
¶aveof
 = 
ma°î
;

1967 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
);

1981 
˛u°îNode
 *
£ndî_ma°î
 = 
NULL
;

1982 
dúty_¶Ÿs
 = 0;

1984 i‡(
£ndî
) {

1985 
£ndî_ma°î
 = 
	`nodeIsMa°î
(
£ndî
Ë? sídî : sídî->
¶aveof
;

1986 i‡(
£ndî_ma°î
) {

1987 
dúty_¶Ÿs
 = 
	`memcmp
(
£ndî_ma°î
->
¶Ÿs
,

1988 
hdr
->
my¶Ÿs
,(hdr->myslots)) != 0;

1995 i‡(
£ndî
 && 
	`nodeIsMa°î
(£ndîË&& 
dúty_¶Ÿs
)

1996 
	`˛u°îUpd©eSlŸsC⁄figWôh
(
£ndî
,
£ndîC⁄figEpoch
,
hdr
->
my¶Ÿs
);

2016 i‡(
£ndî
 && 
dúty_¶Ÿs
) {

2017 
j
;

2019 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

2020 i‡(
	`bôm≠Te°Bô
(
hdr
->
my¶Ÿs
,
j
)) {

2021 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
£ndî
 ||

2022 
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
NULL
) ;

2023 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
]->
c⁄figEpoch
 >

2024 
£ndîC⁄figEpoch
)

2026 
	`£rvîLog
(
LL_VERBOSE
,

2029 
£ndî
->
«me
, 
£rvî
.
˛u°î
->
¶Ÿs
[
j
]->name);

2030 
	`˛u°îSídUpd©e
(
£ndî
->
lök
,

2031 
£rvî
.
˛u°î
->
¶Ÿs
[
j
]);

2044 i‡(
£ndî
 &&

2045 
	`nodeIsMa°î
(
my£lf
Ë&&ÇodeIsMa°î(
£ndî
) &&

2046 
£ndîC⁄figEpoch
 =
my£lf
->
c⁄figEpoch
)

2048 
	`˛u°îH™dÀC⁄figEpochCﬁlisi⁄
(
£ndî
);

2052 i‡(
£ndî
Ë
	`˛u°îPro˚ssGossùSe˘i⁄
(
hdr
,
lök
);

2053 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_FAIL
) {

2054 
˛u°îNode
 *
Áûög
;

2056 i‡(
£ndî
) {

2057 
Áûög
 = 
	`˛u°îLookupNode
(
hdr
->
d©a
.
Áû
.
about
.
nodíame
);

2058 i‡(
Áûög
 &&

2059 !(
Áûög
->
Êags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_MYSELF
)))

2061 
	`£rvîLog
(
LL_NOTICE
,

2063 
hdr
->
£ndî
, hdr->
d©a
.
Áû
.
about
.
nodíame
);

2064 
Áûög
->
Êags
 |
CLUSTER_NODE_FAIL
;

2065 
Áûög
->
Áû_time
 = 
now
;

2066 
Áûög
->
Êags
 &~
CLUSTER_NODE_PFAIL
;

2067 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

2068 
CLUSTER_TODO_UPDATE_STATE
);

2071 
	`£rvîLog
(
LL_NOTICE
,

2073 
hdr
->
£ndî
, hdr->
d©a
.
Áû
.
about
.
nodíame
);

2075 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_PUBLISH
) {

2076 
robj
 *
ch™√l
, *
mesßge
;

2077 
uöt32_t
 
ch™√l_Àn
, 
mesßge_Àn
;

2081 i‡(
	`di˘Size
(
£rvî
.
pubsub_ch™√ls
) ||

2082 
	`li°Lígth
(
£rvî
.
pubsub_∑âîns
))

2084 
ch™√l_Àn
 = 
	`¡ohl
(
hdr
->
d©a
.
publish
.
msg
.channel_len);

2085 
mesßge_Àn
 = 
	`¡ohl
(
hdr
->
d©a
.
publish
.
msg
.message_len);

2086 
ch™√l
 = 
	`¸óãSåögObje˘
(

2087 (*)
hdr
->
d©a
.
publish
.
msg
.
bulk_d©a
,
ch™√l_Àn
);

2088 
mesßge
 = 
	`¸óãSåögObje˘
(

2089 (*)
hdr
->
d©a
.
publish
.
msg
.
bulk_d©a
+
ch™√l_Àn
,

2090 
mesßge_Àn
);

2091 
	`pubsubPublishMesßge
(
ch™√l
,
mesßge
);

2092 
	`de¸RefCou¡
(
ch™√l
);

2093 
	`de¸RefCou¡
(
mesßge
);

2095 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST
) {

2096 i‡(!
£ndî
)  1;

2097 
	`˛u°îSídFaûovîAuthIfNìded
(
£ndî
,
hdr
);

2098 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK
) {

2099 i‡(!
£ndî
)  1;

2103 i‡(
	`nodeIsMa°î
(
£ndî
Ë&& sídî->
num¶Ÿs
 > 0 &&

2104 
£ndîCuºítEpoch
 >
£rvî
.
˛u°î
->
Áûovî_auth_ïoch
)

2106 
£rvî
.
˛u°î
->
Áûovî_auth_cou¡
++;

2109 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_HANDLE_FAILOVER
);

2111 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_MFSTART
) {

2114 i‡(!
£ndî
 || sídî->
¶aveof
 !
my£lf
)  1;

2117 
	`ª£tM™uÆFaûovî
();

2118 
£rvî
.
˛u°î
->
mf_íd
 = 
now
 + 
CLUSTER_MF_TIMEOUT
;

2119 
£rvî
.
˛u°î
->
mf_¶ave
 = 
£ndî
;

2120 
	`∑u£Clõ¡s
(
now
+(
CLUSTER_MF_TIMEOUT
*
CLUSTER_MF_PAUSE_MULT
));

2121 
	`£rvîLog
(
LL_WARNING
,"Manual failoverÑequested byÑeplica %.40s.",

2122 
£ndî
->
«me
);

2123 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_UPDATE
) {

2124 
˛u°îNode
 *
n
;

2125 
uöt64_t
 
ªp‹ãdC⁄figEpoch
 =

2126 
	`¡ohu64
(
hdr
->
d©a
.
upd©e
.
nodecfg
.
c⁄figEpoch
);

2128 i‡(!
£ndî
)  1;

2129 
n
 = 
	`˛u°îLookupNode
(
hdr
->
d©a
.
upd©e
.
nodecfg
.
nodíame
);

2130 i‡(!
n
)  1;

2131 i‡(
n
->
c⁄figEpoch
 >
ªp‹ãdC⁄figEpoch
)  1;

2134 i‡(
	`nodeIsSœve
(
n
)Ë
	`˛u°îSëNodeAsMa°î
(n);

2137 
n
->
c⁄figEpoch
 = 
ªp‹ãdC⁄figEpoch
;

2138 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

2139 
CLUSTER_TODO_FSYNC_CONFIG
);

2143 
	`˛u°îUpd©eSlŸsC⁄figWôh
(
n
,
ªp‹ãdC⁄figEpoch
,

2144 
hdr
->
d©a
.
upd©e
.
nodecfg
.
¶Ÿs
);

2145 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_MODULE
) {

2146 i‡(!
£ndî
)  1;

2149 
uöt64_t
 
moduÀ_id
 = 
hdr
->
d©a
.
moduÀ
.
msg
.module_id;

2150 
uöt32_t
 
Àn
 = 
	`¡ohl
(
hdr
->
d©a
.
moduÀ
.
msg
.len);

2151 
uöt8_t
 
ty≥
 = 
hdr
->
d©a
.
moduÀ
.
msg
.type;

2152 *
∑ylﬂd
 = 
hdr
->
d©a
.
moduÀ
.
msg
.
bulk_d©a
;

2153 
	`moduÀCÆlClu°îRe˚ivîs
(
£ndî
->
«me
,
moduÀ_id
,
ty≥
,
∑ylﬂd
,
Àn
);

2155 
	`£rvîLog
(
LL_WARNING
,"Re˚ived unknow¿∑ckëÅy≥: %d", 
ty≥
);

2158 
	}
}

2166 
	$h™dÀLökIOEº‹
(
˛u°îLök
 *
lök
) {

2167 
	`‰ìClu°îLök
(
lök
);

2168 
	}
}

2173 
	$˛u°îWrôeH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
) {

2174 
˛u°îLök
 *
lök
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

2175 
ssize_t
 
nwrôãn
;

2177 
nwrôãn
 = 
	`c⁄nWrôe
(
c⁄n
, 
lök
->
¢dbuf
, 
	`sd¶í
(link->sndbuf));

2178 i‡(
nwrôãn
 <= 0) {

2179 
	`£rvîLog
(
LL_DEBUG
,"I/OÉrror writingÅoÇodeÜink: %s",

2180 (
nwrôãn
 =-1Ë? 
	`c⁄nGëLa°Eº‹
(
c⁄n
) : "short write");

2181 
	`h™dÀLökIOEº‹
(
lök
);

2184 
	`sd§™ge
(
lök
->
¢dbuf
,
nwrôãn
,-1);

2185 i‡(
	`sd¶í
(
lök
->
¢dbuf
) == 0)

2186 
	`c⁄nSëWrôeH™dÀr
(
lök
->
c⁄n
, 
NULL
);

2187 
	}
}

2192 
	$˛u°îLökC⁄√˘H™dÀr
(
c⁄√˘i⁄
 *
c⁄n
) {

2193 
˛u°îLök
 *
lök
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

2194 
˛u°îNode
 *
node
 = 
lök
->node;

2197 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë!
CONN_STATE_CONNECTED
) {

2198 
	`£rvîLog
(
LL_VERBOSE
, "Connection with Node %.40sát %s:%d failed: %s",

2199 
node
->
«me
,Çode->
ù
,Çode->
˝‹t
,

2200 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

2201 
	`‰ìClu°îLök
(
lök
);

2206 
	`c⁄nSëRódH™dÀr
(
c⁄n
, 
˛u°îRódH™dÀr
);

2214 
m°ime_t
 
ﬁd_pög_£¡
 = 
node
->
pög_£¡
;

2215 
	`˛u°îSídPög
(
lök
, 
node
->
Êags
 & 
CLUSTER_NODE_MEET
 ?

2216 
CLUSTERMSG_TYPE_MEET
 : 
CLUSTERMSG_TYPE_PING
);

2217 i‡(
ﬁd_pög_£¡
) {

2221 
node
->
pög_£¡
 = 
ﬁd_pög_£¡
;

2228 
node
->
Êags
 &~
CLUSTER_NODE_MEET
;

2230 
	`£rvîLog
(
LL_DEBUG
,"Connecting with Node %.40sát %s:%d",

2231 
node
->
«me
,Çode->
ù
,Çode->
˝‹t
);

2232 
	}
}

2237 
	$˛u°îRódH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
) {

2238 
˛u°îMsg
 
buf
[1];

2239 
ssize_t
 
ƒód
;

2240 
˛u°îMsg
 *
hdr
;

2241 
˛u°îLök
 *
lök
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

2242 
ªadÀn
, 
rcvbuÊí
;

2245 
rcvbuÊí
 = 
	`sd¶í
(
lök
->
rcvbuf
);

2246 i‡(
rcvbuÊí
 < 8) {

2249 
ªadÀn
 = 8 - 
rcvbuÊí
;

2252 
hdr
 = (
˛u°îMsg
*Ë
lök
->
rcvbuf
;

2253 i‡(
rcvbuÊí
 == 8) {

2256 i‡(
	`memcmp
(
hdr
->
sig
,"RCmb",4) != 0 ||

2257 
	`¡ohl
(
hdr
->
tŸÀn
Ë< 
CLUSTERMSG_MIN_LEN
)

2259 
	`£rvîLog
(
LL_WARNING
,

2262 
	`h™dÀLökIOEº‹
(
lök
);

2266 
ªadÀn
 = 
	`¡ohl
(
hdr
->
tŸÀn
Ë- 
rcvbuÊí
;

2267 i‡(
ªadÀn
 > (
buf
))Ñeadlen = (buf);

2270 
ƒód
 = 
	`c⁄nRód
(
c⁄n
,
buf
,
ªadÀn
);

2271 i‡(
ƒód
 =-1 && (
	`c⁄nGëSèã
(
c⁄n
Ë=
CONN_STATE_CONNECTED
)) ;

2273 i‡(
ƒód
 <= 0) {

2275 
	`£rvîLog
(
LL_DEBUG
,"I/OÉrrorÑeading fromÇodeÜink: %s",

2276 (
ƒód
 =0Ë? "c⁄√˘i⁄ clo£d" : 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

2277 
	`h™dÀLökIOEº‹
(
lök
);

2281 
lök
->
rcvbuf
 = 
	`sdsˇéí
÷ök->rcvbuf,
buf
,
ƒód
);

2282 
hdr
 = (
˛u°îMsg
*Ë
lök
->
rcvbuf
;

2283 
rcvbuÊí
 +
ƒód
;

2287 i‡(
rcvbuÊí
 >8 &&ÑcvbuÊí =
	`¡ohl
(
hdr
->
tŸÀn
)) {

2288 i‡(
	`˛u°îPro˚ssPackë
(
lök
)) {

2289 
	`sds‰ì
(
lök
->
rcvbuf
);

2290 
lök
->
rcvbuf
 = 
	`sd£m±y
();

2296 
	}
}

2303 
	$˛u°îSídMesßge
(
˛u°îLök
 *
lök
, *
msg
, 
size_t
 
msgÀn
) {

2304 i‡(
	`sd¶í
(
lök
->
¢dbuf
Ë=0 && 
msgÀn
 != 0)

2305 
	`c⁄nSëWrôeH™dÀrWôhB¨rõr
(
lök
->
c⁄n
, 
˛u°îWrôeH™dÀr
, 1);

2307 
lök
->
¢dbuf
 = 
	`sdsˇéí
÷ök->¢dbuf, 
msg
, 
msgÀn
);

2310 
˛u°îMsg
 *
hdr
 = (˛u°îMsg*Ë
msg
;

2311 
uöt16_t
 
ty≥
 = 
	`¡ohs
(
hdr
->type);

2312 i‡(
ty≥
 < 
CLUSTERMSG_TYPE_COUNT
)

2313 
£rvî
.
˛u°î
->
°©s_bus_mesßges_£¡
[
ty≥
]++;

2314 
	}
}

2322 
	$˛u°îBrﬂdˇ°Mesßge
(*
buf
, 
size_t
 
Àn
) {

2323 
di˘Iãøt‹
 *
di
;

2324 
di˘E¡ry
 *
de
;

2326 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

2327 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

2328 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

2330 i‡(!
node
->
lök
) ;

2331 i‡(
node
->
Êags
 & (
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_HANDSHAKE
))

2333 
	`˛u°îSídMesßge
(
node
->
lök
,
buf
,
Àn
);

2335 
	`di˘Rñó£Iãøt‹
(
di
);

2336 
	}
}

2340 
	$˛u°îBuûdMesßgeHdr
(
˛u°îMsg
 *
hdr
, 
ty≥
) {

2341 
tŸÀn
 = 0;

2342 
uöt64_t
 
off£t
;

2343 
˛u°îNode
 *
ma°î
;

2349 
ma°î
 = (
	`nodeIsSœve
(
my£lf
Ë&& my£lf->
¶aveof
) ?

2350 
my£lf
->
¶aveof
 : myself;

2352 
	`mem£t
(
hdr
,0,(*hdr));

2353 
hdr
->
vî
 = 
	`ht⁄s
(
CLUSTER_PROTO_VER
);

2354 
hdr
->
sig
[0] = 'R';

2355 
hdr
->
sig
[1] = 'C';

2356 
hdr
->
sig
[2] = 'm';

2357 
hdr
->
sig
[3] = 'b';

2358 
hdr
->
ty≥
 = 
	`ht⁄s
(type);

2359 
	`mem˝y
(
hdr
->
£ndî
,
my£lf
->
«me
,
CLUSTER_NAMELEN
);

2364 
	`mem£t
(
hdr
->
myù
,0,
NET_IP_STR_LEN
);

2365 i‡(
£rvî
.
˛u°î_™noun˚_ù
) {

2366 
	`°∫˝y
(
hdr
->
myù
,
£rvî
.
˛u°î_™noun˚_ù
,
NET_IP_STR_LEN
);

2367 
hdr
->
myù
[
NET_IP_STR_LEN
-1] = '\0';

2371 
p‹t
 = 
£rvî
.
és_˛u°î
 ? sîvî.
és_p‹t
 : server.port;

2372 
™noun˚d_p‹t
 = 
£rvî
.
˛u°î_™noun˚_p‹t
 ?

2373 
£rvî
.
˛u°î_™noun˚_p‹t
 : 
p‹t
;

2374 
™noun˚d_˝‹t
 = 
£rvî
.
˛u°î_™noun˚_bus_p‹t
 ?

2375 
£rvî
.
˛u°î_™noun˚_bus_p‹t
 :

2376 (
p‹t
 + 
CLUSTER_PORT_INCR
);

2378 
	`mem˝y
(
hdr
->
my¶Ÿs
,
ma°î
->
¶Ÿs
,(hdr->myslots));

2379 
	`mem£t
(
hdr
->
¶aveof
,0,
CLUSTER_NAMELEN
);

2380 i‡(
my£lf
->
¶aveof
 !
NULL
)

2381 
	`mem˝y
(
hdr
->
¶aveof
,
my£lf
->¶aveof->
«me
, 
CLUSTER_NAMELEN
);

2382 
hdr
->
p‹t
 = 
	`ht⁄s
(
™noun˚d_p‹t
);

2383 
hdr
->
˝‹t
 = 
	`ht⁄s
(
™noun˚d_˝‹t
);

2384 
hdr
->
Êags
 = 
	`ht⁄s
(
my£lf
->flags);

2385 
hdr
->
°©e
 = 
£rvî
.
˛u°î
->state;

2388 
hdr
->
cuºítEpoch
 = 
	`ht⁄u64
(
£rvî
.
˛u°î
->currentEpoch);

2389 
hdr
->
c⁄figEpoch
 = 
	`ht⁄u64
(
ma°î
->configEpoch);

2392 i‡(
	`nodeIsSœve
(
my£lf
))

2393 
off£t
 = 
	`ª∂iˇti⁄GëSœveOff£t
();

2395 
off£t
 = 
£rvî
.
ma°î_ª∂_off£t
;

2396 
hdr
->
off£t
 = 
	`ht⁄u64
(offset);

2399 i‡(
	`nodeIsMa°î
(
my£lf
Ë&& 
£rvî
.
˛u°î
->
mf_íd
)

2400 
hdr
->
mÊags
[0] |
CLUSTERMSG_FLAG0_PAUSED
;

2404 i‡(
ty≥
 =
CLUSTERMSG_TYPE_FAIL
) {

2405 
tŸÀn
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

2406 
tŸÀn
 +(
˛u°îMsgD©aFaû
);

2407 } i‡(
ty≥
 =
CLUSTERMSG_TYPE_UPDATE
) {

2408 
tŸÀn
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

2409 
tŸÀn
 +(
˛u°îMsgD©aUpd©e
);

2411 
hdr
->
tŸÀn
 = 
	`ht⁄l
(totlen);

2413 
	}
}

2418 
	$˛u°îNodeIsInGossùSe˘i⁄
(
˛u°îMsg
 *
hdr
, 
cou¡
, 
˛u°îNode
 *
n
) {

2419 
j
;

2420 
j
 = 0; j < 
cou¡
; j++) {

2421 i‡(
	`memcmp
(
hdr
->
d©a
.
pög
.
gossù
[
j
].
nodíame
,
n
->
«me
,

2422 
CLUSTER_NAMELEN
) == 0) ;

2424  
j
 !
cou¡
;

2425 
	}
}

2429 
	$˛u°îSëGossùE¡ry
(
˛u°îMsg
 *
hdr
, 
i
, 
˛u°îNode
 *
n
) {

2430 
˛u°îMsgD©aGossù
 *
gossù
;

2431 
gossù
 = &(
hdr
->
d©a
.
pög
.gossù[
i
]);

2432 
	`mem˝y
(
gossù
->
nodíame
,
n
->
«me
,
CLUSTER_NAMELEN
);

2433 
gossù
->
pög_£¡
 = 
	`ht⁄l
(
n
->ping_sent/1000);

2434 
gossù
->
p⁄g_ª˚ived
 = 
	`ht⁄l
(
n
->pong_received/1000);

2435 
	`mem˝y
(
gossù
->
ù
,
n
->ip,(n->ip));

2436 
gossù
->
p‹t
 = 
	`ht⁄s
(
n
->port);

2437 
gossù
->
˝‹t
 = 
	`ht⁄s
(
n
->cport);

2438 
gossù
->
Êags
 = 
	`ht⁄s
(
n
->flags);

2439 
gossù
->
nŸu£d1
 = 0;

2440 
	}
}

2444 
	$˛u°îSídPög
(
˛u°îLök
 *
lök
, 
ty≥
) {

2445 *
buf
;

2446 
˛u°îMsg
 *
hdr
;

2447 
gossùcou¡
 = 0;

2448 
w™ãd
;

2449 
tŸÀn
;

2454 
‰eshnodes
 = 
	`di˘Size
(
£rvî
.
˛u°î
->
nodes
)-2;

2482 
w™ãd
 = 
	`Êo‹
(
	`di˘Size
(
£rvî
.
˛u°î
->
nodes
)/10);

2483 i‡(
w™ãd
 < 3) wanted = 3;

2484 i‡(
w™ãd
 > 
‰eshnodes
) wanted = freshnodes;

2488 
pÁû_w™ãd
 = 
£rvî
.
˛u°î
->
°©s_pÁû_nodes
;

2493 
tŸÀn
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

2494 
tŸÀn
 +((
˛u°îMsgD©aGossù
)*(
w™ãd
+
pÁû_w™ãd
));

2497 i‡(
tŸÀn
 < ()(
˛u°îMsg
))Åotlen = (clusterMsg);

2498 
buf
 = 
	`zˇŒoc
(
tŸÀn
);

2499 
hdr
 = (
˛u°îMsg
*Ë
buf
;

2502 i‡(
lök
->
node
 && 
ty≥
 =
CLUSTERMSG_TYPE_PING
)

2503 
lök
->
node
->
pög_£¡
 = 
	`m°ime
();

2504 
	`˛u°îBuûdMesßgeHdr
(
hdr
,
ty≥
);

2507 
maxôî©i⁄s
 = 
w™ãd
*3;

2508 
‰eshnodes
 > 0 && 
gossùcou¡
 < 
w™ãd
 && 
maxôî©i⁄s
--) {

2509 
di˘E¡ry
 *
de
 = 
	`di˘GëR™domKey
(
£rvî
.
˛u°î
->
nodes
);

2510 
˛u°îNode
 *
this
 = 
	`di˘GëVÆ
(
de
);

2514 i‡(
this
 =
my£lf
) ;

2517 i‡(
this
->
Êags
 & 
CLUSTER_NODE_PFAIL
) ;

2524 i‡(
this
->
Êags
 & (
CLUSTER_NODE_HANDSHAKE
|
CLUSTER_NODE_NOADDR
) ||

2525 (
this
->
lök
 =
NULL
 &&Åhis->
num¶Ÿs
 == 0))

2527 
‰eshnodes
--;

2532 i‡(
	`˛u°îNodeIsInGossùSe˘i⁄
(
hdr
,
gossùcou¡
,
this
)) ;

2535 
	`˛u°îSëGossùE¡ry
(
hdr
,
gossùcou¡
,
this
);

2536 
‰eshnodes
--;

2537 
gossùcou¡
++;

2541 i‡(
pÁû_w™ãd
) {

2542 
di˘Iãøt‹
 *
di
;

2543 
di˘E¡ry
 *
de
;

2545 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

2546 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
 && 
pÁû_w™ãd
 > 0) {

2547 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

2548 i‡(
node
->
Êags
 & 
CLUSTER_NODE_HANDSHAKE
) ;

2549 i‡(
node
->
Êags
 & 
CLUSTER_NODE_NOADDR
) ;

2550 i‡(!(
node
->
Êags
 & 
CLUSTER_NODE_PFAIL
)) ;

2551 
	`˛u°îSëGossùE¡ry
(
hdr
,
gossùcou¡
,
node
);

2552 
‰eshnodes
--;

2553 
gossùcou¡
++;

2557 
pÁû_w™ãd
--;

2559 
	`di˘Rñó£Iãøt‹
(
di
);

2564 
tŸÀn
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

2565 
tŸÀn
 +((
˛u°îMsgD©aGossù
)*
gossùcou¡
);

2566 
hdr
->
cou¡
 = 
	`ht⁄s
(
gossùcou¡
);

2567 
hdr
->
tŸÀn
 = 
	`ht⁄l
(totlen);

2568 
	`˛u°îSídMesßge
(
lök
,
buf
,
tŸÀn
);

2569 
	`z‰ì
(
buf
);

2570 
	}
}

2586 
	#CLUSTER_BROADCAST_ALL
 0

	)

2587 
	#CLUSTER_BROADCAST_LOCAL_SLAVES
 1

	)

2588 
	$˛u°îBrﬂdˇ°P⁄g
(
èrgë
) {

2589 
di˘Iãøt‹
 *
di
;

2590 
di˘E¡ry
 *
de
;

2592 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

2593 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

2594 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

2596 i‡(!
node
->
lök
) ;

2597 i‡(
node
 =
my£lf
 || 
	`nodeInH™dshake
(node)) ;

2598 i‡(
èrgë
 =
CLUSTER_BROADCAST_LOCAL_SLAVES
) {

2599 
loˇl_¶ave
 =

2600 
	`nodeIsSœve
(
node
Ë&&Çode->
¶aveof
 &&

2601 (
node
->
¶aveof
 =
my£lf
 ||Çode->slaveof == myself->slaveof);

2602 i‡(!
loˇl_¶ave
) ;

2604 
	`˛u°îSídPög
(
node
->
lök
,
CLUSTERMSG_TYPE_PONG
);

2606 
	`di˘Rñó£Iãøt‹
(
di
);

2607 
	}
}

2612 
	$˛u°îSídPublish
(
˛u°îLök
 *
lök
, 
robj
 *
ch™√l
,Ñobj *
mesßge
) {

2613 *
∑ylﬂd
;

2614 
˛u°îMsg
 
buf
[1];

2615 
˛u°îMsg
 *
hdr
 = (˛u°îMsg*Ë
buf
;

2616 
uöt32_t
 
tŸÀn
;

2617 
uöt32_t
 
ch™√l_Àn
, 
mesßge_Àn
;

2619 
ch™√l
 = 
	`gëDecodedObje˘
(channel);

2620 
mesßge
 = 
	`gëDecodedObje˘
(message);

2621 
ch™√l_Àn
 = 
	`sd¶í
(
ch™√l
->
±r
);

2622 
mesßge_Àn
 = 
	`sd¶í
(
mesßge
->
±r
);

2624 
	`˛u°îBuûdMesßgeHdr
(
hdr
,
CLUSTERMSG_TYPE_PUBLISH
);

2625 
tŸÀn
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

2626 
tŸÀn
 +(
˛u°îMsgD©aPublish
Ë- 8 + 
ch™√l_Àn
 + 
mesßge_Àn
;

2628 
hdr
->
d©a
.
publish
.
msg
.
ch™√l_Àn
 = 
	`ht⁄l
(channel_len);

2629 
hdr
->
d©a
.
publish
.
msg
.
mesßge_Àn
 = 
	`ht⁄l
(message_len);

2630 
hdr
->
tŸÀn
 = 
	`ht⁄l
(totlen);

2633 i‡(
tŸÀn
 < (
buf
)) {

2634 
∑ylﬂd
 = (*)
buf
;

2636 
∑ylﬂd
 = 
	`zmÆloc
(
tŸÀn
);

2637 
	`mem˝y
(
∑ylﬂd
,
hdr
,(*hdr));

2638 
hdr
 = (
˛u°îMsg
*Ë
∑ylﬂd
;

2640 
	`mem˝y
(
hdr
->
d©a
.
publish
.
msg
.
bulk_d©a
,
ch™√l
->
±r
,
	`sd¶í
(channel->ptr));

2641 
	`mem˝y
(
hdr
->
d©a
.
publish
.
msg
.
bulk_d©a
+
	`sd¶í
(
ch™√l
->
±r
),

2642 
mesßge
->
±r
,
	`sd¶í
(message->ptr));

2644 i‡(
lök
)

2645 
	`˛u°îSídMesßge
(
lök
,
∑ylﬂd
,
tŸÀn
);

2647 
	`˛u°îBrﬂdˇ°Mesßge
(
∑ylﬂd
,
tŸÀn
);

2649 
	`de¸RefCou¡
(
ch™√l
);

2650 
	`de¸RefCou¡
(
mesßge
);

2651 i‡(
∑ylﬂd
 !(*)
buf
Ë
	`z‰ì
(payload);

2652 
	}
}

2659 
	$˛u°îSídFaû
(*
nodíame
) {

2660 
˛u°îMsg
 
buf
[1];

2661 
˛u°îMsg
 *
hdr
 = (˛u°îMsg*Ë
buf
;

2663 
	`˛u°îBuûdMesßgeHdr
(
hdr
,
CLUSTERMSG_TYPE_FAIL
);

2664 
	`mem˝y
(
hdr
->
d©a
.
Áû
.
about
.
nodíame
,nodíame,
CLUSTER_NAMELEN
);

2665 
	`˛u°îBrﬂdˇ°Mesßge
(
buf
,
	`¡ohl
(
hdr
->
tŸÀn
));

2666 
	}
}

2671 
	$˛u°îSídUpd©e
(
˛u°îLök
 *
lök
, 
˛u°îNode
 *
node
) {

2672 
˛u°îMsg
 
buf
[1];

2673 
˛u°îMsg
 *
hdr
 = (˛u°îMsg*Ë
buf
;

2675 i‡(
lök
 =
NULL
) ;

2676 
	`˛u°îBuûdMesßgeHdr
(
hdr
,
CLUSTERMSG_TYPE_UPDATE
);

2677 
	`mem˝y
(
hdr
->
d©a
.
upd©e
.
nodecfg
.
nodíame
,
node
->
«me
,
CLUSTER_NAMELEN
);

2678 
hdr
->
d©a
.
upd©e
.
nodecfg
.
c⁄figEpoch
 = 
	`ht⁄u64
(
node
->configEpoch);

2679 
	`mem˝y
(
hdr
->
d©a
.
upd©e
.
nodecfg
.
¶Ÿs
,
node
->slots,(node->slots));

2680 
	`˛u°îSídMesßge
(
lök
,(*)
buf
,
	`¡ohl
(
hdr
->
tŸÀn
));

2681 
	}
}

2686 
	$˛u°îSídModuÀ
(
˛u°îLök
 *
lök
, 
uöt64_t
 
moduÀ_id
, 
uöt8_t
 
ty≥
,

2687 *
∑ylﬂd
, 
uöt32_t
 
Àn
) {

2688 *
hópbuf
;

2689 
˛u°îMsg
 
buf
[1];

2690 
˛u°îMsg
 *
hdr
 = (˛u°îMsg*Ë
buf
;

2691 
uöt32_t
 
tŸÀn
;

2693 
	`˛u°îBuûdMesßgeHdr
(
hdr
,
CLUSTERMSG_TYPE_MODULE
);

2694 
tŸÀn
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

2695 
tŸÀn
 +(
˛u°îMsgModuÀ
Ë- 3 + 
Àn
;

2697 
hdr
->
d©a
.
moduÀ
.
msg
.
moduÀ_id
 = module_id;

2698 
hdr
->
d©a
.
moduÀ
.
msg
.
ty≥
 =Åype;

2699 
hdr
->
d©a
.
moduÀ
.
msg
.
Àn
 = 
	`ht⁄l
(len);

2700 
hdr
->
tŸÀn
 = 
	`ht⁄l
(totlen);

2703 i‡(
tŸÀn
 < (
buf
)) {

2704 
hópbuf
 = (*)
buf
;

2706 
hópbuf
 = 
	`zmÆloc
(
tŸÀn
);

2707 
	`mem˝y
(
hópbuf
,
hdr
,(*hdr));

2708 
hdr
 = (
˛u°îMsg
*Ë
hópbuf
;

2710 
	`mem˝y
(
hdr
->
d©a
.
moduÀ
.
msg
.
bulk_d©a
,
∑ylﬂd
,
Àn
);

2712 i‡(
lök
)

2713 
	`˛u°îSídMesßge
(
lök
,
hópbuf
,
tŸÀn
);

2715 
	`˛u°îBrﬂdˇ°Mesßge
(
hópbuf
,
tŸÀn
);

2717 i‡(
hópbuf
 !(*)
buf
Ë
	`z‰ì
(heapbuf);

2718 
	}
}

2726 
	$˛u°îSídModuÀMesßgeToT¨gë
(c⁄° *
èrgë
, 
uöt64_t
 
moduÀ_id
, 
uöt8_t
 
ty≥
, *
∑ylﬂd
, 
uöt32_t
 
Àn
) {

2727 
˛u°îNode
 *
node
 = 
NULL
;

2729 i‡(
èrgë
 !
NULL
) {

2730 
node
 = 
	`˛u°îLookupNode
(
èrgë
);

2731 i‡(
node
 =
NULL
 ||Çode->
lök
 =NULLË 
C_ERR
;

2734 
	`˛u°îSídModuÀ
(
èrgë
 ? 
node
->
lök
 : 
NULL
,

2735 
moduÀ_id
, 
ty≥
, 
∑ylﬂd
, 
Àn
);

2736  
C_OK
;

2737 
	}
}

2746 
	$˛u°îPr›ag©ePublish
(
robj
 *
ch™√l
,Ñobj *
mesßge
) {

2747 
	`˛u°îSídPublish
(
NULL
, 
ch™√l
, 
mesßge
);

2748 
	}
}

2760 
	$˛u°îReque°FaûovîAuth
() {

2761 
˛u°îMsg
 
buf
[1];

2762 
˛u°îMsg
 *
hdr
 = (˛u°îMsg*Ë
buf
;

2763 
uöt32_t
 
tŸÀn
;

2765 
	`˛u°îBuûdMesßgeHdr
(
hdr
,
CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST
);

2769 i‡(
£rvî
.
˛u°î
->
mf_íd
Ë
hdr
->
mÊags
[0] |
CLUSTERMSG_FLAG0_FORCEACK
;

2770 
tŸÀn
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

2771 
hdr
->
tŸÀn
 = 
	`ht⁄l
(totlen);

2772 
	`˛u°îBrﬂdˇ°Mesßge
(
buf
,
tŸÀn
);

2773 
	}
}

2776 
	$˛u°îSídFaûovîAuth
(
˛u°îNode
 *
node
) {

2777 
˛u°îMsg
 
buf
[1];

2778 
˛u°îMsg
 *
hdr
 = (˛u°îMsg*Ë
buf
;

2779 
uöt32_t
 
tŸÀn
;

2781 i‡(!
node
->
lök
) ;

2782 
	`˛u°îBuûdMesßgeHdr
(
hdr
,
CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK
);

2783 
tŸÀn
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

2784 
hdr
->
tŸÀn
 = 
	`ht⁄l
(totlen);

2785 
	`˛u°îSídMesßge
(
node
->
lök
,(*)
buf
,
tŸÀn
);

2786 
	}
}

2789 
	$˛u°îSídMFSèπ
(
˛u°îNode
 *
node
) {

2790 
˛u°îMsg
 
buf
[1];

2791 
˛u°îMsg
 *
hdr
 = (˛u°îMsg*Ë
buf
;

2792 
uöt32_t
 
tŸÀn
;

2794 i‡(!
node
->
lök
) ;

2795 
	`˛u°îBuûdMesßgeHdr
(
hdr
,
CLUSTERMSG_TYPE_MFSTART
);

2796 
tŸÀn
 = (
˛u°îMsg
)-(
˛u°îMsgD©a
);

2797 
hdr
->
tŸÀn
 = 
	`ht⁄l
(totlen);

2798 
	`˛u°îSídMesßge
(
node
->
lök
,(*)
buf
,
tŸÀn
);

2799 
	}
}

2802 
	$˛u°îSídFaûovîAuthIfNìded
(
˛u°îNode
 *
node
, 
˛u°îMsg
 *
ªque°
) {

2803 
˛u°îNode
 *
ma°î
 = 
node
->
¶aveof
;

2804 
uöt64_t
 
ªque°CuºítEpoch
 = 
	`¡ohu64
(
ªque°
->
cuºítEpoch
);

2805 
uöt64_t
 
ªque°C⁄figEpoch
 = 
	`¡ohu64
(
ªque°
->
c⁄figEpoch
);

2806 *
˛aimed_¶Ÿs
 = 
ªque°
->
my¶Ÿs
;

2807 
f‹˚_ack
 = 
ªque°
->
mÊags
[0] & 
CLUSTERMSG_FLAG0_FORCEACK
;

2808 
j
;

2814 i‡(
	`nodeIsSœve
(
my£lf
Ë|| my£lf->
num¶Ÿs
 == 0) ;

2820 i‡(
ªque°CuºítEpoch
 < 
£rvî
.
˛u°î
->
cuºítEpoch
) {

2821 
	`£rvîLog
(
LL_WARNING
,

2823 
node
->
«me
,

2824 (Ë
ªque°CuºítEpoch
,

2825 (Ë
£rvî
.
˛u°î
->
cuºítEpoch
);

2830 i‡(
£rvî
.
˛u°î
->
œ°VŸeEpoch
 =£rvî.˛u°î->
cuºítEpoch
) {

2831 
	`£rvîLog
(
LL_WARNING
,

2833 
node
->
«me
,

2834 (Ë
£rvî
.
˛u°î
->
cuºítEpoch
);

2841 i‡(
	`nodeIsMa°î
(
node
Ë|| 
ma°î
 =
NULL
 ||

2842 (!
	`nodeFaûed
(
ma°î
Ë&& !
f‹˚_ack
))

2844 i‡(
	`nodeIsMa°î
(
node
)) {

2845 
	`£rvîLog
(
LL_WARNING
,

2847 
node
->
«me
);

2848 } i‡(
ma°î
 =
NULL
) {

2849 
	`£rvîLog
(
LL_WARNING
,

2851 
node
->
«me
);

2852 } i‡(!
	`nodeFaûed
(
ma°î
)) {

2853 
	`£rvîLog
(
LL_WARNING
,

2855 
node
->
«me
);

2863 i‡(
	`m°ime
(Ë- 
node
->
¶aveof
->
vŸed_time
 < 
£rvî
.
˛u°î_node_timeout
 * 2)

2865 
	`£rvîLog
(
LL_WARNING
,

2868 
node
->
«me
,

2869 (Ë((
£rvî
.
˛u°î_node_timeout
*2)-

2870 (
	`m°ime
(Ë- 
node
->
¶aveof
->
vŸed_time
)));

2877 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

2878 i‡(
	`bôm≠Te°Bô
(
˛aimed_¶Ÿs
, 
j
) == 0) ;

2879 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
NULL
 ||

2880 
£rvî
.
˛u°î
->
¶Ÿs
[
j
]->
c⁄figEpoch
 <
ªque°C⁄figEpoch
)

2887 
	`£rvîLog
(
LL_WARNING
,

2890 
node
->
«me
, 
j
,

2891 (Ë
£rvî
.
˛u°î
->
¶Ÿs
[
j
]->
c⁄figEpoch
,

2892 (Ë
ªque°C⁄figEpoch
);

2897 
£rvî
.
˛u°î
->
œ°VŸeEpoch
 = sîvî.˛u°î->
cuºítEpoch
;

2898 
node
->
¶aveof
->
vŸed_time
 = 
	`m°ime
();

2899 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|
CLUSTER_TODO_FSYNC_CONFIG
);

2900 
	`˛u°îSídFaûovîAuth
(
node
);

2901 
	`£rvîLog
(
LL_WARNING
, "Failoveráuth grantedÅo %.40s forÉpoch %llu",

2902 
node
->
«me
, (Ë
£rvî
.
˛u°î
->
cuºítEpoch
);

2903 
	}
}

2917 
	$˛u°îGëSœveR™k
() {

2918 
myoff£t
;

2919 
j
, 
ønk
 = 0;

2920 
˛u°îNode
 *
ma°î
;

2922 
	`£rvîAs£π
(
	`nodeIsSœve
(
my£lf
));

2923 
ma°î
 = 
my£lf
->
¶aveof
;

2924 i‡(
ma°î
 =
NULL
)  0;

2926 
myoff£t
 = 
	`ª∂iˇti⁄GëSœveOff£t
();

2927 
j
 = 0; j < 
ma°î
->
num¶aves
; j++)

2928 i‡(
ma°î
->
¶aves
[
j
] !
my£lf
 &&

2929 !
	`nodeC™tFaûovî
(
ma°î
->
¶aves
[
j
]) &&

2930 
ma°î
->
¶aves
[
j
]->
ª∂_off£t
 > 
myoff£t
Ë
ønk
++;

2931  
ønk
;

2932 
	}
}

2956 
	$˛u°îLogC™tFaûovî
(
ªas⁄
) {

2957 *
msg
;

2958 
time_t
 
œ°log_time
 = 0;

2959 
m°ime_t
 
nﬁog_Áû_time
 = 
£rvî
.
˛u°î_node_timeout
 + 5000;

2962 i‡(
ªas⁄
 =
£rvî
.
˛u°î
->
ˇ¡_Áûovî_ªas⁄
 &&

2963 
	`time
(
NULL
)-
œ°log_time
 < 
CLUSTER_CANT_FAILOVER_RELOG_PERIOD
)

2966 
£rvî
.
˛u°î
->
ˇ¡_Áûovî_ªas⁄
 = 
ªas⁄
;

2971 i‡(
my£lf
->
¶aveof
 &&

2972 
	`nodeFaûed
(
my£lf
->
¶aveof
) &&

2973 (
	`m°ime
(Ë- 
my£lf
->
¶aveof
->
Áû_time
Ë< 
nﬁog_Áû_time
) ;

2975 
ªas⁄
) {

2976 
CLUSTER_CANT_FAILOVER_DATA_AGE
:

2977 
msg
 = "Disconnected from master forÜongerÅhanállowed. "

2981 
CLUSTER_CANT_FAILOVER_WAITING_DELAY
:

2982 
msg
 = "WaitingÅhe delay before I can startáÇew failover.";

2984 
CLUSTER_CANT_FAILOVER_EXPIRED
:

2985 
msg
 = "FailoveráttemptÉxpired.";

2987 
CLUSTER_CANT_FAILOVER_WAITING_VOTES
:

2988 
msg
 = "Waiting for votes, but majority stillÇotÑeached.";

2991 
msg
 = "UnknownÑeason code.";

2994 
œ°log_time
 = 
	`time
(
NULL
);

2995 
	`£rvîLog
(
LL_WARNING
,"Cuºíéy u«bÀÅÿÁûovî: %s", 
msg
);

2996 
	}
}

3004 
	$˛u°îFaûovîRïœ˚YourMa°î
() {

3005 
j
;

3006 
˛u°îNode
 *
ﬁdma°î
 = 
my£lf
->
¶aveof
;

3008 i‡(
	`nodeIsMa°î
(
my£lf
Ë|| 
ﬁdma°î
 =
NULL
) ;

3011 
	`˛u°îSëNodeAsMa°î
(
my£lf
);

3012 
	`ª∂iˇti⁄Un£tMa°î
();

3015 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3016 i‡(
	`˛u°îNodeGëSlŸBô
(
ﬁdma°î
,
j
)) {

3017 
	`˛u°îDñSlŸ
(
j
);

3018 
	`˛u°îAddSlŸ
(
my£lf
,
j
);

3023 
	`˛u°îUpd©eSèã
();

3024 
	`˛u°îSaveC⁄figOrDõ
(1);

3028 
	`˛u°îBrﬂdˇ°P⁄g
(
CLUSTER_BROADCAST_ALL
);

3031 
	`ª£tM™uÆFaûovî
();

3032 
	}
}

3042 
	$˛u°îH™dÀSœveFaûovî
() {

3043 
m°ime_t
 
d©a_age
;

3044 
m°ime_t
 
auth_age
 = 
	`m°ime
(Ë- 
£rvî
.
˛u°î
->
Áûovî_auth_time
;

3045 
√eded_qu‹um
 = (
£rvî
.
˛u°î
->
size
 / 2) + 1;

3046 
m™uÆ_Áûovî
 = 
£rvî
.
˛u°î
->
mf_íd
 != 0 &&

3047 
£rvî
.
˛u°î
->
mf_ˇn_°¨t
;

3048 
m°ime_t
 
auth_timeout
, 
auth_ªåy_time
;

3050 
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 &~
CLUSTER_TODO_HANDLE_FAILOVER
;

3059 
auth_timeout
 = 
£rvî
.
˛u°î_node_timeout
*2;

3060 i‡(
auth_timeout
 < 2000)áuth_timeout = 2000;

3061 
auth_ªåy_time
 = 
auth_timeout
*2;

3070 i‡(
	`nodeIsMa°î
(
my£lf
) ||

3071 
my£lf
->
¶aveof
 =
NULL
 ||

3072 (!
	`nodeFaûed
(
my£lf
->
¶aveof
Ë&& !
m™uÆ_Áûovî
) ||

3073 (
£rvî
.
˛u°î_¶ave_no_Áûovî
 && !
m™uÆ_Áûovî
) ||

3074 
my£lf
->
¶aveof
->
num¶Ÿs
 == 0)

3078 
£rvî
.
˛u°î
->
ˇ¡_Áûovî_ªas⁄
 = 
CLUSTER_CANT_FAILOVER_NONE
;

3084 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTED
) {

3085 
d©a_age
 = (
m°ime_t
)(
£rvî
.
unixtime
 - sîvî.
ma°î
->
œ°öãø˘i⁄
)

3088 
d©a_age
 = (
m°ime_t
)(
£rvî
.
unixtime
 - sîvî.
ª∂_down_sö˚
) * 1000;

3094 i‡(
d©a_age
 > 
£rvî
.
˛u°î_node_timeout
)

3095 
d©a_age
 -
£rvî
.
˛u°î_node_timeout
;

3101 i‡(
£rvî
.
˛u°î_¶ave_vÆidôy_Á˘‹
 &&

3102 
d©a_age
 >

3103 (((
m°ime_t
)
£rvî
.
ª∂_pög_¶ave_≥riod
 * 1000) +

3104 (
£rvî
.
˛u°î_node_timeout
 * sîvî.
˛u°î_¶ave_vÆidôy_Á˘‹
)))

3106 i‡(!
m™uÆ_Áûovî
) {

3107 
	`˛u°îLogC™tFaûovî
(
CLUSTER_CANT_FAILOVER_DATA_AGE
);

3114 i‡(
auth_age
 > 
auth_ªåy_time
) {

3115 
£rvî
.
˛u°î
->
Áûovî_auth_time
 = 
	`m°ime
() +

3117 
	`øndom
() % 500;

3118 
£rvî
.
˛u°î
->
Áûovî_auth_cou¡
 = 0;

3119 
£rvî
.
˛u°î
->
Áûovî_auth_£¡
 = 0;

3120 
£rvî
.
˛u°î
->
Áûovî_auth_ønk
 = 
	`˛u°îGëSœveR™k
();

3124 
£rvî
.
˛u°î
->
Áûovî_auth_time
 +=

3125 
£rvî
.
˛u°î
->
Áûovî_auth_ønk
 * 1000;

3127 i‡(
£rvî
.
˛u°î
->
mf_íd
) {

3128 
£rvî
.
˛u°î
->
Áûovî_auth_time
 = 
	`m°ime
();

3129 
£rvî
.
˛u°î
->
Áûovî_auth_ønk
 = 0;

3130 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_HANDLE_FAILOVER
);

3132 
	`£rvîLog
(
LL_WARNING
,

3135 
£rvî
.
˛u°î
->
Áûovî_auth_time
 - 
	`m°ime
(),

3136 
£rvî
.
˛u°î
->
Áûovî_auth_ønk
,

3137 
	`ª∂iˇti⁄GëSœveOff£t
());

3141 
	`˛u°îBrﬂdˇ°P⁄g
(
CLUSTER_BROADCAST_LOCAL_SLAVES
);

3150 i‡(
£rvî
.
˛u°î
->
Áûovî_auth_£¡
 == 0 &&

3151 
£rvî
.
˛u°î
->
mf_íd
 == 0)

3153 
√wønk
 = 
	`˛u°îGëSœveR™k
();

3154 i‡(
√wønk
 > 
£rvî
.
˛u°î
->
Áûovî_auth_ønk
) {

3155 
added_dñay
 =

3156 (
√wønk
 - 
£rvî
.
˛u°î
->
Áûovî_auth_ønk
) * 1000;

3157 
£rvî
.
˛u°î
->
Áûovî_auth_time
 +
added_dñay
;

3158 
£rvî
.
˛u°î
->
Áûovî_auth_ønk
 = 
√wønk
;

3159 
	`£rvîLog
(
LL_WARNING
,

3161 
√wønk
, 
added_dñay
);

3166 i‡(
	`m°ime
(Ë< 
£rvî
.
˛u°î
->
Áûovî_auth_time
) {

3167 
	`˛u°îLogC™tFaûovî
(
CLUSTER_CANT_FAILOVER_WAITING_DELAY
);

3172 i‡(
auth_age
 > 
auth_timeout
) {

3173 
	`˛u°îLogC™tFaûovî
(
CLUSTER_CANT_FAILOVER_EXPIRED
);

3178 i‡(
£rvî
.
˛u°î
->
Áûovî_auth_£¡
 == 0) {

3179 
£rvî
.
˛u°î
->
cuºítEpoch
++;

3180 
£rvî
.
˛u°î
->
Áûovî_auth_ïoch
 = sîvî.˛u°î->
cuºítEpoch
;

3181 
	`£rvîLog
(
LL_WARNING
,"Startingá failoverÉlection forÉpoch %llu.",

3182 (Ë
£rvî
.
˛u°î
->
cuºítEpoch
);

3183 
	`˛u°îReque°FaûovîAuth
();

3184 
£rvî
.
˛u°î
->
Áûovî_auth_£¡
 = 1;

3185 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|

3186 
CLUSTER_TODO_UPDATE_STATE
|

3187 
CLUSTER_TODO_FSYNC_CONFIG
);

3192 i‡(
£rvî
.
˛u°î
->
Áûovî_auth_cou¡
 >
√eded_qu‹um
) {

3195 
	`£rvîLog
(
LL_WARNING
,

3199 i‡(
my£lf
->
c⁄figEpoch
 < 
£rvî
.
˛u°î
->
Áûovî_auth_ïoch
) {

3200 
my£lf
->
c⁄figEpoch
 = 
£rvî
.
˛u°î
->
Áûovî_auth_ïoch
;

3201 
	`£rvîLog
(
LL_WARNING
,

3203 (Ë
my£lf
->
c⁄figEpoch
);

3207 
	`˛u°îFaûovîRïœ˚YourMa°î
();

3209 
	`˛u°îLogC™tFaûovî
(
CLUSTER_CANT_FAILOVER_WAITING_VOTES
);

3211 
	}
}

3240 
	$˛u°îH™dÀSœveMigøti⁄
(
max_¶aves
) {

3241 
j
, 
ok¶aves
 = 0;

3242 
˛u°îNode
 *
myma°î
 = 
my£lf
->
¶aveof
, *
èrgë
 = 
NULL
, *
ˇndid©e
 = NULL;

3243 
di˘Iãøt‹
 *
di
;

3244 
di˘E¡ry
 *
de
;

3247 i‡(
£rvî
.
˛u°î
->
°©e
 !
CLUSTER_OK
) ;

3251 i‡(
myma°î
 =
NULL
) ;

3252 
j
 = 0; j < 
myma°î
->
num¶aves
; j++)

3253 i‡(!
	`nodeFaûed
(
myma°î
->
¶aves
[
j
]) &&

3254 !
	`nodeTimedOut
(
myma°î
->
¶aves
[
j
])Ë
ok¶aves
++;

3255 i‡(
ok¶aves
 <
£rvî
.
˛u°î_migøti⁄_b¨rõr
) ;

3267 
ˇndid©e
 = 
my£lf
;

3268 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

3269 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3270 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

3271 
ok¶aves
 = 0, 
is_‹ph™ed
 = 1;

3277 i‡(
	`nodeIsSœve
(
node
Ë|| 
	`nodeFaûed
“ode)Ë
is_‹ph™ed
 = 0;

3278 i‡(!(
node
->
Êags
 & 
CLUSTER_NODE_MIGRATE_TO
)Ë
is_‹ph™ed
 = 0;

3281 i‡(
	`nodeIsMa°î
(
node
)Ë
ok¶aves
 = 
	`˛u°îCou¡N⁄FaûögSœves
(node);

3282 i‡(
ok¶aves
 > 0Ë
is_‹ph™ed
 = 0;

3284 i‡(
is_‹ph™ed
) {

3285 i‡(!
èrgë
 && 
node
->
num¶Ÿs
 > 0)Åarget =Çode;

3289 i‡(!
node
->
‹ph™ed_time
Ënode->‹ph™ed_timê
	`m°ime
();

3291 
node
->
‹ph™ed_time
 = 0;

3297 i‡(
ok¶aves
 =
max_¶aves
) {

3298 
j
 = 0; j < 
node
->
num¶aves
; j++) {

3299 i‡(
	`memcmp
(
node
->
¶aves
[
j
]->
«me
,

3300 
ˇndid©e
->
«me
,

3301 
CLUSTER_NAMELEN
) < 0)

3303 
ˇndid©e
 = 
node
->
¶aves
[
j
];

3308 
	`di˘Rñó£Iãøt‹
(
di
);

3315 i‡(
èrgë
 && 
ˇndid©e
 =
my£lf
 &&

3316 (
	`m°ime
()-
èrgë
->
‹ph™ed_time
Ë> 
CLUSTER_SLAVE_MIGRATION_DELAY
 &&

3317 !(
£rvî
.
˛u°î_moduÀ_Êags
 & 
CLUSTER_MODULE_FLAG_NO_FAILOVER
))

3319 
	`£rvîLog
(
LL_WARNING
,"MigratingÅo orphaned master %.40s",

3320 
èrgë
->
«me
);

3321 
	`˛u°îSëMa°î
(
èrgë
);

3323 
	}
}

3359 
	$ª£tM™uÆFaûovî
() {

3360 i‡(
£rvî
.
˛u°î
->
mf_íd
 && 
	`˛õ¡sAªPau£d
()) {

3361 
£rvî
.
˛õ¡s_∑u£_íd_time
 = 0;

3362 
	`˛õ¡sAªPau£d
();

3364 
£rvî
.
˛u°î
->
mf_íd
 = 0;

3365 
£rvî
.
˛u°î
->
mf_ˇn_°¨t
 = 0;

3366 
£rvî
.
˛u°î
->
mf_¶ave
 = 
NULL
;

3367 
£rvî
.
˛u°î
->
mf_ma°î_off£t
 = 0;

3368 
	}
}

3371 
	$m™uÆFaûovîCheckTimeout
() {

3372 i‡(
£rvî
.
˛u°î
->
mf_íd
 && sîvî.˛u°î->mf_íd < 
	`m°ime
()) {

3373 
	`£rvîLog
(
LL_WARNING
,"Manual failoverÅimed out.");

3374 
	`ª£tM™uÆFaûovî
();

3376 
	}
}

3380 
	$˛u°îH™dÀM™uÆFaûovî
() {

3382 i‡(
£rvî
.
˛u°î
->
mf_íd
 == 0) ;

3386 i‡(
£rvî
.
˛u°î
->
mf_ˇn_°¨t
) ;

3388 i‡(
£rvî
.
˛u°î
->
mf_ma°î_off£t
 == 0) ;

3390 i‡(
£rvî
.
˛u°î
->
mf_ma°î_off£t
 =
	`ª∂iˇti⁄GëSœveOff£t
()) {

3393 
£rvî
.
˛u°î
->
mf_ˇn_°¨t
 = 1;

3394 
	`£rvîLog
(
LL_WARNING
,

3398 
	}
}

3405 
	$˛u°îCr⁄
() {

3406 
di˘Iãøt‹
 *
di
;

3407 
di˘E¡ry
 *
de
;

3408 
upd©e_°©e
 = 0;

3409 
‹ph™ed_ma°îs
;

3410 
max_¶aves
;

3411 
this_¶aves
;

3412 
m°ime_t
 
mö_p⁄g
 = 0, 
now
 = 
	`m°ime
();

3413 
˛u°îNode
 *
mö_p⁄g_node
 = 
NULL
;

3414 
ôî©i⁄
 = 0;

3415 
m°ime_t
 
h™dshake_timeout
;

3417 
ôî©i⁄
++;

3423 *
¥ev_ù
 = 
NULL
;

3424 *
cuº_ù
 = 
£rvî
.
˛u°î_™noun˚_ù
;

3425 
ch™ged
 = 0;

3427 i‡(
¥ev_ù
 =
NULL
 && 
cuº_ù
 !NULLË
ch™ged
 = 1;

3428 i‡(
¥ev_ù
 !
NULL
 && 
cuº_ù
 =NULLË
ch™ged
 = 1;

3429 i‡(
¥ev_ù
 && 
cuº_ù
 && 
	`°rcmp
’ªv_ù,cuº_ù)Ë
ch™ged
 = 1;

3431 i‡(
ch™ged
) {

3432 i‡(
¥ev_ù
Ë
	`z‰ì
(prev_ip);

3433 
¥ev_ù
 = 
cuº_ù
;

3435 i‡(
cuº_ù
) {

3439 
¥ev_ù
 = 
	`z°rdup
(prev_ip);

3440 
	`°∫˝y
(
my£lf
->
ù
,
£rvî
.
˛u°î_™noun˚_ù
,
NET_IP_STR_LEN
);

3441 
my£lf
->
ù
[
NET_IP_STR_LEN
-1] = '\0';

3443 
my£lf
->
ù
[0] = '\0';

3452 
h™dshake_timeout
 = 
£rvî
.
˛u°î_node_timeout
;

3453 i‡(
h™dshake_timeout
 < 1000) handshake_timeout = 1000;

3456 
	`˛u°îUpd©eMy£lfFœgs
();

3461 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

3462 
£rvî
.
˛u°î
->
°©s_pÁû_nodes
 = 0;

3463 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3464 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

3468 i‡(
node
->
Êags
 & (
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_NOADDR
)) ;

3470 i‡(
node
->
Êags
 & 
CLUSTER_NODE_PFAIL
)

3471 
£rvî
.
˛u°î
->
°©s_pÁû_nodes
++;

3475 i‡(
	`nodeInH™dshake
(
node
Ë&& 
now
 -Çode->
˘ime
 > 
h™dshake_timeout
) {

3476 
	`˛u°îDñNode
(
node
);

3480 i‡(
node
->
lök
 =
NULL
) {

3481 
˛u°îLök
 *
lök
 = 
	`¸óãClu°îLök
(
node
);

3482 
lök
->
c⁄n
 = 
£rvî
.
és_˛u°î
 ? 
	`c⁄nCª©eTLS
(Ë: 
	`c⁄nCª©eSockë
();

3483 
	`c⁄nSëPriv©eD©a
(
lök
->
c⁄n
,Üink);

3484 i‡(
	`c⁄nC⁄√˘
(
lök
->
c⁄n
, 
node
->
ù
,Çode->
˝‹t
, 
NET_FIRST_BIND_ADDR
,

3485 
˛u°îLökC⁄√˘H™dÀr
) == -1) {

3491 i‡(
node
->
pög_£¡
 =0Ënode->pög_£¡ = 
	`m°ime
();

3492 
	`£rvîLog
(
LL_DEBUG
, "UnableÅo connectÅo "

3493 "Clu°î Nodê[%s]:%d -> %s", 
node
->
ù
,

3494 
node
->
˝‹t
, 
£rvî
.
√ãº
);

3496 
	`‰ìClu°îLök
(
lök
);

3499 
node
->
lök
 =Üink;

3502 
	`di˘Rñó£Iãøt‹
(
di
);

3506 i‡(!(
ôî©i⁄
 % 10)) {

3507 
j
;

3511 
j
 = 0; j < 5; j++) {

3512 
de
 = 
	`di˘GëR™domKey
(
£rvî
.
˛u°î
->
nodes
);

3513 
˛u°îNode
 *
this
 = 
	`di˘GëVÆ
(
de
);

3516 i‡(
this
->
lök
 =
NULL
 ||Åhis->
pög_£¡
 != 0) ;

3517 i‡(
this
->
Êags
 & (
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_HANDSHAKE
))

3519 i‡(
mö_p⁄g_node
 =
NULL
 || 
mö_p⁄g
 > 
this
->
p⁄g_ª˚ived
) {

3520 
mö_p⁄g_node
 = 
this
;

3521 
mö_p⁄g
 = 
this
->
p⁄g_ª˚ived
;

3524 i‡(
mö_p⁄g_node
) {

3525 
	`£rvîLog
(
LL_DEBUG
,"PögögÇodê%.40s", 
mö_p⁄g_node
->
«me
);

3526 
	`˛u°îSídPög
(
mö_p⁄g_node
->
lök
, 
CLUSTERMSG_TYPE_PING
);

3536 
‹ph™ed_ma°îs
 = 0;

3537 
max_¶aves
 = 0;

3538 
this_¶aves
 = 0;

3539 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

3540 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3541 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

3542 
now
 = 
	`m°ime
();

3544 i‡(
node
->
Êags
 &

3545 (
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_NOADDR
|
CLUSTER_NODE_HANDSHAKE
))

3550 i‡(
	`nodeIsSœve
(
my£lf
Ë&& 
	`nodeIsMa°î
(
node
Ë&& !
	`nodeFaûed
(node)) {

3551 
ok¶aves
 = 
	`˛u°îCou¡N⁄FaûögSœves
(
node
);

3556 i‡(
ok¶aves
 =0 && 
node
->
num¶Ÿs
 > 0 &&

3557 
node
->
Êags
 & 
CLUSTER_NODE_MIGRATE_TO
)

3559 
‹ph™ed_ma°îs
++;

3561 i‡(
ok¶aves
 > 
max_¶aves
) max_slaves = okslaves;

3562 i‡(
	`nodeIsSœve
(
my£lf
Ë&& my£lf->
¶aveof
 =
node
)

3563 
this_¶aves
 = 
ok¶aves
;

3569 
m°ime_t
 
pög_dñay
 = 
now
 - 
node
->
pög_£¡
;

3570 
m°ime_t
 
d©a_dñay
 = 
now
 - 
node
->
d©a_ª˚ived
;

3571 i‡(
node
->
lök
 &&

3572 
now
 - 
node
->
lök
->
˘ime
 >

3573 
£rvî
.
˛u°î_node_timeout
 &&

3574 
node
->
pög_£¡
 &&

3575 
node
->
p⁄g_ª˚ived
 <Çode->
pög_£¡
 &&

3577 
pög_dñay
 > 
£rvî
.
˛u°î_node_timeout
/2 &&

3579 
d©a_dñay
 > 
£rvî
.
˛u°î_node_timeout
/2)

3582 
	`‰ìClu°îLök
(
node
->
lök
);

3589 i‡(
node
->
lök
 &&

3590 
node
->
pög_£¡
 == 0 &&

3591 (
now
 - 
node
->
p⁄g_ª˚ived
Ë> 
£rvî
.
˛u°î_node_timeout
/2)

3593 
	`˛u°îSídPög
(
node
->
lök
, 
CLUSTERMSG_TYPE_PING
);

3599 i‡(
£rvî
.
˛u°î
->
mf_íd
 &&

3600 
	`nodeIsMa°î
(
my£lf
) &&

3601 
£rvî
.
˛u°î
->
mf_¶ave
 =
node
 &&

3602 
node
->
lök
)

3604 
	`˛u°îSídPög
(
node
->
lök
, 
CLUSTERMSG_TYPE_PING
);

3609 i‡(
node
->
pög_£¡
 == 0) ;

3619 
m°ime_t
 
node_dñay
 = (
pög_dñay
 < 
d©a_dñay
) ?Öing_delay :

3620 
d©a_dñay
;

3622 i‡(
node_dñay
 > 
£rvî
.
˛u°î_node_timeout
) {

3625 i‡(!(
node
->
Êags
 & (
CLUSTER_NODE_PFAIL
|
CLUSTER_NODE_FAIL
))) {

3626 
	`£rvîLog
(
LL_DEBUG
,"*** NODE %.40sÖossibly failing",

3627 
node
->
«me
);

3628 
node
->
Êags
 |
CLUSTER_NODE_PFAIL
;

3629 
upd©e_°©e
 = 1;

3633 
	`di˘Rñó£Iãøt‹
(
di
);

3638 i‡(
	`nodeIsSœve
(
my£lf
) &&

3639 
£rvî
.
ma°îho°
 =
NULL
 &&

3640 
my£lf
->
¶aveof
 &&

3641 
	`nodeHasAddr
(
my£lf
->
¶aveof
))

3643 
	`ª∂iˇti⁄SëMa°î
(
my£lf
->
¶aveof
->
ù
, my£lf->¶aveof->
p‹t
);

3647 
	`m™uÆFaûovîCheckTimeout
();

3649 i‡(
	`nodeIsSœve
(
my£lf
)) {

3650 
	`˛u°îH™dÀM™uÆFaûovî
();

3651 i‡(!(
£rvî
.
˛u°î_moduÀ_Êags
 & 
CLUSTER_MODULE_FLAG_NO_FAILOVER
))

3652 
	`˛u°îH™dÀSœveFaûovî
();

3658 i‡(
‹ph™ed_ma°îs
 && 
max_¶aves
 >2 && 
this_¶aves
 == max_slaves)

3659 
	`˛u°îH™dÀSœveMigøti⁄
(
max_¶aves
);

3662 i‡(
upd©e_°©e
 || 
£rvî
.
˛u°î
->
°©e
 =
CLUSTER_FAIL
)

3663 
	`˛u°îUpd©eSèã
();

3664 
	}
}

3671 
	$˛u°îBef‹eSÀï
() {

3674 i‡(
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 & 
CLUSTER_TODO_HANDLE_FAILOVER
)

3675 
	`˛u°îH™dÀSœveFaûovî
();

3678 i‡(
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 & 
CLUSTER_TODO_UPDATE_STATE
)

3679 
	`˛u°îUpd©eSèã
();

3682 i‡(
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 & 
CLUSTER_TODO_SAVE_CONFIG
) {

3683 
fsync
 = 
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 &

3684 
CLUSTER_TODO_FSYNC_CONFIG
;

3685 
	`˛u°îSaveC⁄figOrDõ
(
fsync
);

3690 
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 = 0;

3691 
	}
}

3693 
	$˛u°îDoBef‹eSÀï
(
Êags
) {

3694 
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 |
Êags
;

3695 
	}
}

3703 
	$bôm≠Te°Bô
(*
bôm≠
, 
pos
) {

3704 
off_t
 
byã
 = 
pos
/8;

3705 
bô
 = 
pos
&7;

3706  (
bôm≠
[
byã
] & (1<<
bô
)) != 0;

3707 
	}
}

3710 
	$bôm≠SëBô
(*
bôm≠
, 
pos
) {

3711 
off_t
 
byã
 = 
pos
/8;

3712 
bô
 = 
pos
&7;

3713 
bôm≠
[
byã
] |1<<
bô
;

3714 
	}
}

3717 
	$bôm≠CÀ¨Bô
(*
bôm≠
, 
pos
) {

3718 
off_t
 
byã
 = 
pos
/8;

3719 
bô
 = 
pos
&7;

3720 
bôm≠
[
byã
] &~(1<<
bô
);

3721 
	}
}

3726 
	$˛u°îMa°îsHaveSœves
() {

3727 
di˘Iãøt‹
 *
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

3728 
di˘E¡ry
 *
de
;

3729 
¶aves
 = 0;

3730 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3731 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

3733 i‡(
	`nodeIsSœve
(
node
)) ;

3734 
¶aves
 +
node
->
num¶aves
;

3736 
	`di˘Rñó£Iãøt‹
(
di
);

3737  
¶aves
 != 0;

3738 
	}
}

3741 
	$˛u°îNodeSëSlŸBô
(
˛u°îNode
 *
n
, 
¶Ÿ
) {

3742 
ﬁd
 = 
	`bôm≠Te°Bô
(
n
->
¶Ÿs
,
¶Ÿ
);

3743 
	`bôm≠SëBô
(
n
->
¶Ÿs
,
¶Ÿ
);

3744 i‡(!
ﬁd
) {

3745 
n
->
num¶Ÿs
++;

3759 i‡(
n
->
num¶Ÿs
 =1 && 
	`˛u°îMa°îsHaveSœves
())

3760 
n
->
Êags
 |
CLUSTER_NODE_MIGRATE_TO
;

3762  
ﬁd
;

3763 
	}
}

3766 
	$˛u°îNodeCÀ¨SlŸBô
(
˛u°îNode
 *
n
, 
¶Ÿ
) {

3767 
ﬁd
 = 
	`bôm≠Te°Bô
(
n
->
¶Ÿs
,
¶Ÿ
);

3768 
	`bôm≠CÀ¨Bô
(
n
->
¶Ÿs
,
¶Ÿ
);

3769 i‡(
ﬁd
Ë
n
->
num¶Ÿs
--;

3770  
ﬁd
;

3771 
	}
}

3774 
	$˛u°îNodeGëSlŸBô
(
˛u°îNode
 *
n
, 
¶Ÿ
) {

3775  
	`bôm≠Te°Bô
(
n
->
¶Ÿs
,
¶Ÿ
);

3776 
	}
}

3782 
	$˛u°îAddSlŸ
(
˛u°îNode
 *
n
, 
¶Ÿ
) {

3783 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
]Ë 
C_ERR
;

3784 
	`˛u°îNodeSëSlŸBô
(
n
,
¶Ÿ
);

3785 
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
] = 
n
;

3786  
C_OK
;

3787 
	}
}

3792 
	$˛u°îDñSlŸ
(
¶Ÿ
) {

3793 
˛u°îNode
 *
n
 = 
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
];

3795 i‡(!
n
Ë 
C_ERR
;

3796 
	`£rvîAs£π
(
	`˛u°îNodeCÀ¨SlŸBô
(
n
,
¶Ÿ
) == 1);

3797 
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
] = 
NULL
;

3798  
C_OK
;

3799 
	}
}

3803 
	$˛u°îDñNodeSlŸs
(
˛u°îNode
 *
node
) {

3804 
dñëed
 = 0, 
j
;

3806 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3807 i‡(
	`˛u°îNodeGëSlŸBô
(
node
,
j
)) {

3808 
	`˛u°îDñSlŸ
(
j
);

3809 
dñëed
++;

3812  
dñëed
;

3813 
	}
}

3817 
	$˛u°îClo£AŒSlŸs
() {

3818 
	`mem£t
(
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
,0,

3819 (
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
));

3820 
	`mem£t
(
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
,0,

3821 (
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
));

3822 
	}
}

3832 
	#CLUSTER_MAX_REJOIN_DELAY
 5000

	)

3833 
	#CLUSTER_MIN_REJOIN_DELAY
 500

	)

3834 
	#CLUSTER_WRITABLE_DELAY
 2000

	)

3836 
	$˛u°îUpd©eSèã
() {

3837 
j
, 
√w_°©e
;

3838 
ªachabÀ_ma°îs
 = 0;

3839 
m°ime_t
 
am⁄g_mö‹ôy_time
;

3840 
m°ime_t
 
fú°_ˇŒ_time
 = 0;

3842 
£rvî
.
˛u°î
->
todo_bef‹e_¶ìp
 &~
CLUSTER_TODO_UPDATE_STATE
;

3850 i‡(
fú°_ˇŒ_time
 =0Ëfú°_ˇŒ_timê
	`m°ime
();

3851 i‡(
	`nodeIsMa°î
(
my£lf
) &&

3852 
£rvî
.
˛u°î
->
°©e
 =
CLUSTER_FAIL
 &&

3853 
	`m°ime
(Ë- 
fú°_ˇŒ_time
 < 
CLUSTER_WRITABLE_DELAY
) ;

3857 
√w_°©e
 = 
CLUSTER_OK
;

3860 i‡(
£rvî
.
˛u°î_ªquúe_fuŒ_covîage
) {

3861 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3862 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
NULL
 ||

3863 
£rvî
.
˛u°î
->
¶Ÿs
[
j
]->
Êags
 & (
CLUSTER_NODE_FAIL
))

3865 
√w_°©e
 = 
CLUSTER_FAIL
;

3877 
di˘Iãøt‹
 *
di
;

3878 
di˘E¡ry
 *
de
;

3880 
£rvî
.
˛u°î
->
size
 = 0;

3881 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

3882 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3883 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

3885 i‡(
	`nodeIsMa°î
(
node
Ë&&Çode->
num¶Ÿs
) {

3886 
£rvî
.
˛u°î
->
size
++;

3887 i‡((
node
->
Êags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_PFAIL
)) == 0)

3888 
ªachabÀ_ma°îs
++;

3891 
	`di˘Rñó£Iãøt‹
(
di
);

3897 
√eded_qu‹um
 = (
£rvî
.
˛u°î
->
size
 / 2) + 1;

3899 i‡(
ªachabÀ_ma°îs
 < 
√eded_qu‹um
) {

3900 
√w_°©e
 = 
CLUSTER_FAIL
;

3901 
am⁄g_mö‹ôy_time
 = 
	`m°ime
();

3906 i‡(
√w_°©e
 !
£rvî
.
˛u°î
->
°©e
) {

3907 
m°ime_t
 
ªjoö_dñay
 = 
£rvî
.
˛u°î_node_timeout
;

3913 i‡(
ªjoö_dñay
 > 
CLUSTER_MAX_REJOIN_DELAY
)

3914 
ªjoö_dñay
 = 
CLUSTER_MAX_REJOIN_DELAY
;

3915 i‡(
ªjoö_dñay
 < 
CLUSTER_MIN_REJOIN_DELAY
)

3916 
ªjoö_dñay
 = 
CLUSTER_MIN_REJOIN_DELAY
;

3918 i‡(
√w_°©e
 =
CLUSTER_OK
 &&

3919 
	`nodeIsMa°î
(
my£lf
) &&

3920 
	`m°ime
(Ë- 
am⁄g_mö‹ôy_time
 < 
ªjoö_dñay
)

3926 
	`£rvîLog
(
LL_WARNING
,"Cluster state changed: %s",

3927 
√w_°©e
 =
CLUSTER_OK
 ? "ok" : "fail");

3928 
£rvî
.
˛u°î
->
°©e
 = 
√w_°©e
;

3930 
	}
}

3954 
	$vîifyClu°îC⁄figWôhD©a
() {

3955 
j
;

3956 
upd©e_c⁄fig
 = 0;

3960 i‡(
£rvî
.
˛u°î_moduÀ_Êags
 & 
CLUSTER_MODULE_FLAG_NO_REDIRECTION
)

3961  
C_OK
;

3965 i‡(
	`nodeIsSœve
(
my£lf
)Ë 
C_OK
;

3968 
j
 = 1; j < 
£rvî
.
dbnum
; j++) {

3969 i‡(
	`di˘Size
(
£rvî
.
db
[
j
].
di˘
)Ë 
C_ERR
;

3974 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3975 i‡(!
	`cou¡KeysInSlŸ
(
j
)) ;

3979 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
my£lf
 ||

3980 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
j
] !
NULL
) ;

3986 
upd©e_c⁄fig
++;

3988 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
j
] =
NULL
) {

3989 
	`£rvîLog
(
LL_WARNING
, "I have keys for unassigned slot %d. "

3990 "TakögÑe•⁄sibûôy f‹ it.",
j
);

3991 
	`˛u°îAddSlŸ
(
my£lf
,
j
);

3993 
	`£rvîLog
(
LL_WARNING
, "I have keys for slot %d, butÅhe slot is "

3995 "Sëtög iàtÿimp‹tög sèã.",
j
);

3996 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
j
] = sîvî.˛u°î->
¶Ÿs
[j];

3999 i‡(
upd©e_c⁄fig
Ë
	`˛u°îSaveC⁄figOrDõ
(1);

4000  
C_OK
;

4001 
	}
}

4009 
	$˛u°îSëMa°î
(
˛u°îNode
 *
n
) {

4010 
	`£rvîAs£π
(
n
 !
my£lf
);

4011 
	`£rvîAs£π
(
my£lf
->
num¶Ÿs
 == 0);

4013 i‡(
	`nodeIsMa°î
(
my£lf
)) {

4014 
my£lf
->
Êags
 &~(
CLUSTER_NODE_MASTER
|
CLUSTER_NODE_MIGRATE_TO
);

4015 
my£lf
->
Êags
 |
CLUSTER_NODE_SLAVE
;

4016 
	`˛u°îClo£AŒSlŸs
();

4018 i‡(
my£lf
->
¶aveof
)

4019 
	`˛u°îNodeRemoveSœve
(
my£lf
->
¶aveof
,myself);

4021 
my£lf
->
¶aveof
 = 
n
;

4022 
	`˛u°îNodeAddSœve
(
n
,
my£lf
);

4023 
	`ª∂iˇti⁄SëMa°î
(
n
->
ù
,Ç->
p‹t
);

4024 
	`ª£tM™uÆFaûovî
();

4025 
	}
}

4031 
	sªdisNodeFœgs
 {

4032 
uöt16_t
 
	mÊag
;

4033 *
	m«me
;

4036 
ªdisNodeFœgs
 
	gªdisNodeFœgsTabÀ
[] = {

4037 {
CLUSTER_NODE_MYSELF
, "myself,"},

4038 {
CLUSTER_NODE_MASTER
, "master,"},

4039 {
CLUSTER_NODE_SLAVE
, "slave,"},

4040 {
CLUSTER_NODE_PFAIL
, "fail?,"},

4041 {
CLUSTER_NODE_FAIL
, "fail,"},

4042 {
CLUSTER_NODE_HANDSHAKE
, "handshake,"},

4043 {
CLUSTER_NODE_NOADDR
, "noaddr,"},

4044 {
CLUSTER_NODE_NOFAILOVER
, "nofailover,"}

4049 
sds
 
	$ª¥e£¡Clu°îNodeFœgs
(
sds
 
ci
, 
uöt16_t
 
Êags
) {

4050 
size_t
 
‹ig_Àn
 = 
	`sd¶í
(
ci
);

4051 
i
, 
size
 = (
ªdisNodeFœgsTabÀ
)/(
ªdisNodeFœgs
);

4052 
i
 = 0; i < 
size
; i++) {

4053 
ªdisNodeFœgs
 *
nodeÊag
 = 
ªdisNodeFœgsTabÀ
 + 
i
;

4054 i‡(
Êags
 & 
nodeÊag
->
Êag
Ë
ci
 = 
	`sdsˇt
(ci,ÇodeÊag->
«me
);

4057 i‡(
	`sd¶í
(
ci
Ë=
‹ig_Àn
Ëcò
	`sdsˇt
(ci,"noflags,");

4058 
	`sdsIn¸Lí
(
ci
,-1);

4059  
ci
;

4060 
	}
}

4066 
sds
 
	$˛u°îGíNodeDes¸ùti⁄
(
˛u°îNode
 *
node
) {

4067 
j
, 
°¨t
;

4068 
sds
 
ci
;

4071 
ci
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%.40s %s:%d@%d ",

4072 
node
->
«me
,

4073 
node
->
ù
,

4074 
node
->
p‹t
,

4075 
node
->
˝‹t
);

4078 
ci
 = 
	`ª¥e£¡Clu°îNodeFœgs
(ci, 
node
->
Êags
);

4081 i‡(
node
->
¶aveof
)

4082 
ci
 = 
	`sdsˇçrötf
(ci," %.40†",
node
->
¶aveof
->
«me
);

4084 
ci
 = 
	`sdsˇéí
(ci," - ",3);

4087 
ci
 = 
	`sdsˇçrötf
(ci,"%lld %lld %llu %s",

4088 (Ë
node
->
pög_£¡
,

4089 (Ë
node
->
p⁄g_ª˚ived
,

4090 (Ë
node
->
c⁄figEpoch
,

4091 (
node
->
lök
 ||Çode->
Êags
 & 
CLUSTER_NODE_MYSELF
) ?

4095 
°¨t
 = -1;

4096 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

4097 
bô
;

4099 i‡((
bô
 = 
	`˛u°îNodeGëSlŸBô
(
node
,
j
)) != 0) {

4100 i‡(
°¨t
 =-1Ë°¨à
j
;

4102 i‡(
°¨t
 !-1 && (!
bô
 || 
j
 =
CLUSTER_SLOTS
-1)) {

4103 i‡(
bô
 && 
j
 =
CLUSTER_SLOTS
-1) j++;

4105 i‡(
°¨t
 =
j
-1) {

4106 
ci
 = 
	`sdsˇçrötf
(ci," %d",
°¨t
);

4108 
ci
 = 
	`sdsˇçrötf
(ci," %d-%d",
°¨t
,
j
-1);

4110 
°¨t
 = -1;

4117 i‡(
node
->
Êags
 & 
CLUSTER_NODE_MYSELF
) {

4118 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

4119 i‡(
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
j
]) {

4120 
ci
 = 
	`sdsˇçrötf
(ci," [%d->-%.40s]",
j
,

4121 
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
j
]->
«me
);

4122 } i‡(
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
j
]) {

4123 
ci
 = 
	`sdsˇçrötf
(ci," [%d-<-%.40s]",
j
,

4124 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
j
]->
«me
);

4128  
ci
;

4129 
	}
}

4143 
sds
 
	$˛u°îGíNodesDes¸ùti⁄
(
fûãr
) {

4144 
sds
 
ci
 = 
	`sd£m±y
(), 
ni
;

4145 
di˘Iãøt‹
 *
di
;

4146 
di˘E¡ry
 *
de
;

4148 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

4149 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

4150 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

4152 i‡(
node
->
Êags
 & 
fûãr
) ;

4153 
ni
 = 
	`˛u°îGíNodeDes¸ùti⁄
(
node
);

4154 
ci
 = 
	`sdsˇtsds
(ci,
ni
);

4155 
	`sds‰ì
(
ni
);

4156 
ci
 = 
	`sdsˇéí
(ci,"\n",1);

4158 
	`di˘Rñó£Iãøt‹
(
di
);

4159  
ci
;

4160 
	}
}

4166 c⁄° *
	$˛u°îGëMesßgeTy≥Såög
(
ty≥
) {

4167 
ty≥
) {

4168 
CLUSTERMSG_TYPE_PING
:  "ping";

4169 
CLUSTERMSG_TYPE_PONG
:  "pong";

4170 
CLUSTERMSG_TYPE_MEET
:  "meet";

4171 
CLUSTERMSG_TYPE_FAIL
:  "fail";

4172 
CLUSTERMSG_TYPE_PUBLISH
:  "publish";

4173 
CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST
:  "auth-req";

4174 
CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK
:  "auth-ack";

4175 
CLUSTERMSG_TYPE_UPDATE
:  "update";

4176 
CLUSTERMSG_TYPE_MFSTART
:  "mfstart";

4177 
CLUSTERMSG_TYPE_MODULE
:  "module";

4180 
	}
}

4182 
	$gëSlŸOrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
) {

4183 
¶Ÿ
;

4185 i‡(
	`gëL⁄gL⁄gFromObje˘
(
o
,&
¶Ÿ
Ë!
C_OK
 ||

4186 
¶Ÿ
 < 0 || slŸ >
CLUSTER_SLOTS
)

4188 
	`addRïlyEº‹
(
c
,"Invalid or out ofÑange slot");

4191  (Ë
¶Ÿ
;

4192 
	}
}

4194 
	$˛u°îRïlyMu…iBulkSlŸs
(
˛õ¡
 *
c
) {

4206 
num_ma°îs
 = 0;

4207 *
¶Ÿ_ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

4209 
di˘E¡ry
 *
de
;

4210 
di˘Iãøt‹
 *
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
˛u°î
->
nodes
);

4211 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

4212 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

4213 
j
 = 0, 
°¨t
 = -1;

4214 
i
, 
√°ed_ñemíts
 = 0;

4218 i‡(!
	`nodeIsMa°î
(
node
Ë||Çode->
num¶Ÿs
 == 0) ;

4220 
i
 = 0; i < 
node
->
num¶aves
; i++) {

4221 i‡(
	`nodeFaûed
(
node
->
¶aves
[
i
])) ;

4222 
√°ed_ñemíts
++;

4225 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

4226 
bô
, 
i
;

4228 i‡((
bô
 = 
	`˛u°îNodeGëSlŸBô
(
node
,
j
)) != 0) {

4229 i‡(
°¨t
 =-1Ë°¨à
j
;

4231 i‡(
°¨t
 !-1 && (!
bô
 || 
j
 =
CLUSTER_SLOTS
-1)) {

4232 
	`addRïlyAºayLí
(
c
, 
√°ed_ñemíts
 + 3);

4234 i‡(
bô
 && 
j
 =
CLUSTER_SLOTS
-1) j++;

4238 i‡(
°¨t
 =
j
-1) {

4239 
	`addRïlyL⁄gL⁄g
(
c
, 
°¨t
);

4240 
	`addRïlyL⁄gL⁄g
(
c
, 
°¨t
);

4242 
	`addRïlyL⁄gL⁄g
(
c
, 
°¨t
);

4243 
	`addRïlyL⁄gL⁄g
(
c
, 
j
-1);

4245 
°¨t
 = -1;

4248 
	`addRïlyAºayLí
(
c
, 3);

4249 
	`addRïlyBulkCSåög
(
c
, 
node
->
ù
);

4250 
	`addRïlyL⁄gL⁄g
(
c
, 
node
->
p‹t
);

4251 
	`addRïlyBulkCBuf„r
(
c
, 
node
->
«me
, 
CLUSTER_NAMELEN
);

4254 
i
 = 0; i < 
node
->
num¶aves
; i++) {

4257 i‡(
	`nodeFaûed
(
node
->
¶aves
[
i
])) ;

4258 
	`addRïlyAºayLí
(
c
, 3);

4259 
	`addRïlyBulkCSåög
(
c
, 
node
->
¶aves
[
i
]->
ù
);

4260 
	`addRïlyL⁄gL⁄g
(
c
, 
node
->
¶aves
[
i
]->
p‹t
);

4261 
	`addRïlyBulkCBuf„r
(
c
, 
node
->
¶aves
[
i
]->
«me
, 
CLUSTER_NAMELEN
);

4263 
num_ma°îs
++;

4267 
	`di˘Rñó£Iãøt‹
(
di
);

4268 
	`£tDe„ºedAºayLí
(
c
, 
¶Ÿ_ª∂yÀn
, 
num_ma°îs
);

4269 
	}
}

4271 
	$˛u°îComm™d
(
˛õ¡
 *
c
) {

4272 i‡(
£rvî
.
˛u°î_íabÀd
 == 0) {

4273 
	`addRïlyEº‹
(
c
,"This instance has cluster support disabled");

4277 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"help")) {

4278 c⁄° *
hñp
[] = {

4302 
NULL


4304 
	`addRïlyHñp
(
c
, 
hñp
);

4305 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"mìt"Ë&& (c->
¨gc
 == 4 || c->argc == 5)) {

4307 
p‹t
, 
˝‹t
;

4309 i‡(
	`gëL⁄gL⁄gFromObje˘
(
c
->
¨gv
[3], &
p‹t
Ë!
C_OK
) {

4310 
	`addRïlyEº‹F‹m©
(
c
,"Invalid TCP baseÖort specified: %s",

4311 (*)
c
->
¨gv
[3]->
±r
);

4315 i‡(
c
->
¨gc
 == 5) {

4316 i‡(
	`gëL⁄gL⁄gFromObje˘
(
c
->
¨gv
[4], &
˝‹t
Ë!
C_OK
) {

4317 
	`addRïlyEº‹F‹m©
(
c
,"Invalid TCP busÖort specified: %s",

4318 (*)
c
->
¨gv
[4]->
±r
);

4322 
˝‹t
 = 
p‹t
 + 
CLUSTER_PORT_INCR
;

4325 i‡(
	`˛u°îSèπH™dshake
(
c
->
¨gv
[2]->
±r
,
p‹t
,
˝‹t
) == 0 &&

4326 
î∫o
 =
EINVAL
)

4328 
	`addRïlyEº‹F‹m©
(
c
,"InvalidÇodeáddress specified: %s:%s",

4329 (*)
c
->
¨gv
[2]->
±r
, (*)c->argv[3]->ptr);

4331 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4333 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"nodes"Ë&& c->
¨gc
 == 2) {

4335 
sds
 
nodes
 = 
	`˛u°îGíNodesDes¸ùti⁄
(0);

4336 
	`addRïlyVîb©im
(
c
,
nodes
,
	`sd¶í
(nodes),"txt");

4337 
	`sds‰ì
(
nodes
);

4338 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"myid"Ë&& c->
¨gc
 == 2) {

4340 
	`addRïlyBulkCBuf„r
(
c
,
my£lf
->
«me
, 
CLUSTER_NAMELEN
);

4341 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"¶Ÿs"Ë&& c->
¨gc
 == 2) {

4343 
	`˛u°îRïlyMu…iBulkSlŸs
(
c
);

4344 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"Êush¶Ÿs"Ë&& c->
¨gc
 == 2) {

4346 i‡(
	`di˘Size
(
£rvî
.
db
[0].
di˘
) != 0) {

4347 
	`addRïlyEº‹
(
c
,"DB must beÉmptyÅoÖerform CLUSTER FLUSHSLOTS.");

4350 
	`˛u°îDñNodeSlŸs
(
my£lf
);

4351 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

4352 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4353 } i‡((!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"addslots") ||

4354 !
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"dñ¶Ÿs")Ë&& c->
¨gc
 >= 3)

4358 
j
, 
¶Ÿ
;

4359 *
¶Ÿs
 = 
	`zmÆloc
(
CLUSTER_SLOTS
);

4360 
dñ
 = !
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"delslots");

4362 
	`mem£t
(
¶Ÿs
,0,
CLUSTER_SLOTS
);

4365 
j
 = 2; j < 
c
->
¨gc
; j++) {

4366 i‡((
¶Ÿ
 = 
	`gëSlŸOrRïly
(
c
,c->
¨gv
[
j
])) == -1) {

4367 
	`z‰ì
(
¶Ÿs
);

4370 i‡(
dñ
 && 
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
] =
NULL
) {

4371 
	`addRïlyEº‹F‹m©
(
c
,"SlŸ %d i†Æªady u«ssig√d", 
¶Ÿ
);

4372 
	`z‰ì
(
¶Ÿs
);

4374 } i‡(!
dñ
 && 
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
]) {

4375 
	`addRïlyEº‹F‹m©
(
c
,"SlŸ %d i†Æªady busy", 
¶Ÿ
);

4376 
	`z‰ì
(
¶Ÿs
);

4379 i‡(
¶Ÿs
[
¶Ÿ
]++ == 1) {

4380 
	`addRïlyEº‹F‹m©
(
c
,"Slot %d specified multipleÅimes",

4381 ()
¶Ÿ
);

4382 
	`z‰ì
(
¶Ÿs
);

4386 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

4387 i‡(
¶Ÿs
[
j
]) {

4388 
ªtvÆ
;

4392 i‡(
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
j
])

4393 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
j
] = 
NULL
;

4395 
ªtvÆ
 = 
dñ
 ? 
	`˛u°îDñSlŸ
(
j
) :

4396 
	`˛u°îAddSlŸ
(
my£lf
,
j
);

4397 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
ªtvÆ
 =
C_OK
);

4400 
	`z‰ì
(
¶Ÿs
);

4401 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

4402 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4403 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"£t¶Ÿ"Ë&& c->
¨gc
 >= 4) {

4408 
¶Ÿ
;

4409 
˛u°îNode
 *
n
;

4411 i‡(
	`nodeIsSœve
(
my£lf
)) {

4412 
	`addRïlyEº‹
(
c
,"Please use SETSLOT only with masters.");

4416 i‡((
¶Ÿ
 = 
	`gëSlŸOrRïly
(
c
,c->
¨gv
[2])) == -1) ;

4418 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[3]->
±r
,"migøtög"Ë&& c->
¨gc
 == 5) {

4419 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
] !
my£lf
) {

4420 
	`addRïlyEº‹F‹m©
(
c
,"I'mÇŸÅhêow√∏o‡hash slŸ %u",
¶Ÿ
);

4423 i‡((
n
 = 
	`˛u°îLookupNode
(
c
->
¨gv
[4]->
±r
)Ë=
NULL
) {

4424 
	`addRïlyEº‹F‹m©
(
c
,"I don't knowáboutÇode %s",

4425 (*)
c
->
¨gv
[4]->
±r
);

4428 
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
¶Ÿ
] = 
n
;

4429 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[3]->
±r
,"imp‹tög"Ë&& c->
¨gc
 == 5) {

4430 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
] =
my£lf
) {

4431 
	`addRïlyEº‹F‹m©
(
c
,

4432 "I'máÃódyÅhêow√∏o‡hash slŸ %u",
¶Ÿ
);

4435 i‡((
n
 = 
	`˛u°îLookupNode
(
c
->
¨gv
[4]->
±r
)Ë=
NULL
) {

4436 
	`addRïlyEº‹F‹m©
(
c
,"I don't knowáboutÇode %s",

4437 (*)
c
->
¨gv
[4]->
±r
);

4440 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
¶Ÿ
] = 
n
;

4441 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[3]->
±r
,"°abÀ"Ë&& c->
¨gc
 == 4) {

4443 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
¶Ÿ
] = 
NULL
;

4444 
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
¶Ÿ
] = 
NULL
;

4445 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[3]->
±r
,"node"Ë&& c->
¨gc
 == 5) {

4447 
˛u°îNode
 *
n
 = 
	`˛u°îLookupNode
(
c
->
¨gv
[4]->
±r
);

4449 i‡(!
n
) {

4450 
	`addRïlyEº‹F‹m©
(
c
,"UnknownÇode %s",

4451 (*)
c
->
¨gv
[4]->
±r
);

4456 i‡(
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
] =
my£lf
 && 
n
 != myself) {

4457 i‡(
	`cou¡KeysInSlŸ
(
¶Ÿ
) != 0) {

4458 
	`addRïlyEº‹F‹m©
(
c
,

4460 "whûêI stû»hﬁd key†f‹Åhi†hash slŸ.", 
¶Ÿ
);

4467 i‡(
	`cou¡KeysInSlŸ
(
¶Ÿ
) == 0 &&

4468 
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
¶Ÿ
])

4469 
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
¶Ÿ
] = 
NULL
;

4473 i‡(
n
 =
my£lf
 &&

4474 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
¶Ÿ
])

4485 i‡(
	`˛u°îBumpC⁄figEpochWôhoutC⁄£nsus
(Ë=
C_OK
) {

4486 
	`£rvîLog
(
LL_WARNING
,

4487 "c⁄figEpoch upd©edá·î imp‹tög slŸ %d", 
¶Ÿ
);

4489 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
¶Ÿ
] = 
NULL
;

4491 
	`˛u°îDñSlŸ
(
¶Ÿ
);

4492 
	`˛u°îAddSlŸ
(
n
,
¶Ÿ
);

4494 
	`addRïlyEº‹
(
c
,

4498 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_SAVE_CONFIG
|
CLUSTER_TODO_UPDATE_STATE
);

4499 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4500 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"bum≥poch"Ë&& c->
¨gc
 == 2) {

4502 
ªtvÆ
 = 
	`˛u°îBumpC⁄figEpochWôhoutC⁄£nsus
();

4503 
sds
 
ª∂y
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"+%s %llu\r\n",

4504 (
ªtvÆ
 =
C_OK
) ? "BUMPED" : "STILL",

4505 (Ë
my£lf
->
c⁄figEpoch
);

4506 
	`addRïlySds
(
c
,
ª∂y
);

4507 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"öfo"Ë&& c->
¨gc
 == 2) {

4509 *
°©e°r
[] = {"ok","fail","needhelp"};

4510 
¶Ÿs_assig√d
 = 0, 
¶Ÿs_ok
 = 0, 
¶Ÿs_pÁû
 = 0, 
¶Ÿs_Áû
 = 0;

4511 
uöt64_t
 
myïoch
;

4512 
j
;

4514 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

4515 
˛u°îNode
 *
n
 = 
£rvî
.
˛u°î
->
¶Ÿs
[
j
];

4517 i‡(
n
 =
NULL
) ;

4518 
¶Ÿs_assig√d
++;

4519 i‡(
	`nodeFaûed
(
n
)) {

4520 
¶Ÿs_Áû
++;

4521 } i‡(
	`nodeTimedOut
(
n
)) {

4522 
¶Ÿs_pÁû
++;

4524 
¶Ÿs_ok
++;

4528 
myïoch
 = (
	`nodeIsSœve
(
my£lf
Ë&& my£lf->
¶aveof
) ?

4529 
my£lf
->
¶aveof
->
c⁄figEpoch
 : myself->configEpoch;

4531 
sds
 
öfo
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

4541 , 
°©e°r
[
£rvî
.
˛u°î
->
°©e
],

4542 
¶Ÿs_assig√d
,

4543 
¶Ÿs_ok
,

4544 
¶Ÿs_pÁû
,

4545 
¶Ÿs_Áû
,

4546 
	`di˘Size
(
£rvî
.
˛u°î
->
nodes
),

4547 
£rvî
.
˛u°î
->
size
,

4548 (Ë
£rvî
.
˛u°î
->
cuºítEpoch
,

4549 (Ë
myïoch


4553 
tŸ_msg_£¡
 = 0;

4554 
tŸ_msg_ª˚ived
 = 0;

4556 
i
 = 0; i < 
CLUSTERMSG_TYPE_COUNT
; i++) {

4557 i‡(
£rvî
.
˛u°î
->
°©s_bus_mesßges_£¡
[
i
] == 0) ;

4558 
tŸ_msg_£¡
 +
£rvî
.
˛u°î
->
°©s_bus_mesßges_£¡
[
i
];

4559 
öfo
 = 
	`sdsˇçrötf
(info,

4561 
	`˛u°îGëMesßgeTy≥Såög
(
i
),

4562 
£rvî
.
˛u°î
->
°©s_bus_mesßges_£¡
[
i
]);

4564 
öfo
 = 
	`sdsˇçrötf
(info,

4565 "˛u°î_°©s_mesßges_£¡:%Œd\r\n", 
tŸ_msg_£¡
);

4567 
i
 = 0; i < 
CLUSTERMSG_TYPE_COUNT
; i++) {

4568 i‡(
£rvî
.
˛u°î
->
°©s_bus_mesßges_ª˚ived
[
i
] == 0) ;

4569 
tŸ_msg_ª˚ived
 +
£rvî
.
˛u°î
->
°©s_bus_mesßges_ª˚ived
[
i
];

4570 
öfo
 = 
	`sdsˇçrötf
(info,

4572 
	`˛u°îGëMesßgeTy≥Såög
(
i
),

4573 
£rvî
.
˛u°î
->
°©s_bus_mesßges_ª˚ived
[
i
]);

4575 
öfo
 = 
	`sdsˇçrötf
(info,

4576 "˛u°î_°©s_mesßges_ª˚ived:%Œd\r\n", 
tŸ_msg_ª˚ived
);

4579 
	`addRïlyVîb©im
(
c
,
öfo
,
	`sd¶í
(info),"txt");

4580 
	`sds‰ì
(
öfo
);

4581 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ßvec⁄fig"Ë&& c->
¨gc
 == 2) {

4582 
ªtvÆ
 = 
	`˛u°îSaveC⁄fig
(1);

4584 i‡(
ªtvÆ
 == 0)

4585 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4587 
	`addRïlyEº‹F‹m©
(
c
,"error savingÅhe clusterÇode config: %s",

4588 
	`°ªº‹
(
î∫o
));

4589 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"key¶Ÿ"Ë&& c->
¨gc
 == 3) {

4591 
sds
 
key
 = 
c
->
¨gv
[2]->
±r
;

4593 
	`addRïlyL⁄gL⁄g
(
c
,
	`keyHashSlŸ
(
key
,
	`sd¶í
(key)));

4594 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"cou¡keysö¶Ÿ"Ë&& c->
¨gc
 == 3) {

4596 
¶Ÿ
;

4598 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
¶Ÿ
,
NULL
Ë!
C_OK
)

4600 i‡(
¶Ÿ
 < 0 || slŸ >
CLUSTER_SLOTS
) {

4601 
	`addRïlyEº‹
(
c
,"Invalid slot");

4604 
	`addRïlyL⁄gL⁄g
(
c
,
	`cou¡KeysInSlŸ
(
¶Ÿ
));

4605 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"gëkeysö¶Ÿ"Ë&& c->
¨gc
 == 4) {

4607 
maxkeys
, 
¶Ÿ
;

4608 
numkeys
, 
j
;

4609 
robj
 **
keys
;

4611 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
¶Ÿ
,
NULL
Ë!
C_OK
)

4613 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
maxkeys
,
NULL
)

4614 !
C_OK
)

4616 i‡(
¶Ÿ
 < 0 || slŸ >
CLUSTER_SLOTS
 || 
maxkeys
 < 0) {

4617 
	`addRïlyEº‹
(
c
,"Invalid slot orÇumber of keys");

4623 
keys_ö_¶Ÿ
 = 
	`cou¡KeysInSlŸ
(
¶Ÿ
);

4624 i‡(
maxkeys
 > 
keys_ö_¶Ÿ
) maxkeys = keys_in_slot;

4626 
keys
 = 
	`zmÆloc
((
robj
*)*
maxkeys
);

4627 
numkeys
 = 
	`gëKeysInSlŸ
(
¶Ÿ
, 
keys
, 
maxkeys
);

4628 
	`addRïlyAºayLí
(
c
,
numkeys
);

4629 
j
 = 0; j < 
numkeys
; j++) {

4630 
	`addRïlyBulk
(
c
,
keys
[
j
]);

4631 
	`de¸RefCou¡
(
keys
[
j
]);

4633 
	`z‰ì
(
keys
);

4634 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"f‹gë"Ë&& c->
¨gc
 == 3) {

4636 
˛u°îNode
 *
n
 = 
	`˛u°îLookupNode
(
c
->
¨gv
[2]->
±r
);

4638 i‡(!
n
) {

4639 
	`addRïlyEº‹F‹m©
(
c
,"Unknow¿nodê%s", (*)c->
¨gv
[2]->
±r
);

4641 } i‡(
n
 =
my£lf
) {

4642 
	`addRïlyEº‹
(
c
,"IÅried hard but I can't forget myself...");

4644 } i‡(
	`nodeIsSœve
(
my£lf
Ë&& my£lf->
¶aveof
 =
n
) {

4645 
	`addRïlyEº‹
(
c
,"Can't forget my master!");

4648 
	`˛u°îBœckli°AddNode
(
n
);

4649 
	`˛u°îDñNode
(
n
);

4650 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_UPDATE_STATE
|

4651 
CLUSTER_TODO_SAVE_CONFIG
);

4652 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4653 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ª∂iˇã"Ë&& c->
¨gc
 == 3) {

4655 
˛u°îNode
 *
n
 = 
	`˛u°îLookupNode
(
c
->
¨gv
[2]->
±r
);

4658 i‡(!
n
) {

4659 
	`addRïlyEº‹F‹m©
(
c
,"Unknow¿nodê%s", (*)c->
¨gv
[2]->
±r
);

4664 i‡(
n
 =
my£lf
) {

4665 
	`addRïlyEº‹
(
c
,"Can'tÑeplicate myself");

4670 i‡(
	`nodeIsSœve
(
n
)) {

4671 
	`addRïlyEº‹
(
c
,"I can onlyÑeplicateá master,ÇotáÑeplica.");

4678 i‡(
	`nodeIsMa°î
(
my£lf
) &&

4679 (
my£lf
->
num¶Ÿs
 !0 || 
	`di˘Size
(
£rvî
.
db
[0].
di˘
) != 0)) {

4680 
	`addRïlyEº‹
(
c
,

4687 
	`˛u°îSëMa°î
(
n
);

4688 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

4689 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4690 } i‡((!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"slaves") ||

4691 !
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ª∂iˇs")Ë&& c->
¨gc
 == 3) {

4693 
˛u°îNode
 *
n
 = 
	`˛u°îLookupNode
(
c
->
¨gv
[2]->
±r
);

4694 
j
;

4697 i‡(!
n
) {

4698 
	`addRïlyEº‹F‹m©
(
c
,"Unknow¿nodê%s", (*)c->
¨gv
[2]->
±r
);

4702 i‡(
	`nodeIsSœve
(
n
)) {

4703 
	`addRïlyEº‹
(
c
,"The specifiedÇode isÇotá master");

4707 
	`addRïlyAºayLí
(
c
,
n
->
num¶aves
);

4708 
j
 = 0; j < 
n
->
num¶aves
; j++) {

4709 
sds
 
ni
 = 
	`˛u°îGíNodeDes¸ùti⁄
(
n
->
¶aves
[
j
]);

4710 
	`addRïlyBulkCSåög
(
c
,
ni
);

4711 
	`sds‰ì
(
ni
);

4713 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"count-failure-reports") &&

4714 
c
->
¨gc
 == 3)

4717 
˛u°îNode
 *
n
 = 
	`˛u°îLookupNode
(
c
->
¨gv
[2]->
±r
);

4719 i‡(!
n
) {

4720 
	`addRïlyEº‹F‹m©
(
c
,"Unknow¿nodê%s", (*)c->
¨gv
[2]->
±r
);

4723 
	`addRïlyL⁄gL⁄g
(
c
,
	`˛u°îNodeFaûuªRï‹tsCou¡
(
n
));

4725 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"failover") &&

4726 (
c
->
¨gc
 == 2 || c->argc == 3))

4729 
f‹˚
 = 0, 
èkeovî
 = 0;

4731 i‡(
c
->
¨gc
 == 3) {

4732 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"force")) {

4733 
f‹˚
 = 1;

4734 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"takeover")) {

4735 
èkeovî
 = 1;

4736 
f‹˚
 = 1;

4738 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

4744 i‡(
	`nodeIsMa°î
(
my£lf
)) {

4745 
	`addRïlyEº‹
(
c
,"You should send CLUSTER FAILOVERÅoáÑeplica");

4747 } i‡(
my£lf
->
¶aveof
 =
NULL
) {

4748 
	`addRïlyEº‹
(
c
,"I'máÑeplica but my master is unknownÅo me");

4750 } i‡(!
f‹˚
 &&

4751 (
	`nodeFaûed
(
my£lf
->
¶aveof
) ||

4752 
my£lf
->
¶aveof
->
lök
 =
NULL
))

4754 
	`addRïlyEº‹
(
c
,"Master is down or failed, "

4758 
	`ª£tM™uÆFaûovî
();

4759 
£rvî
.
˛u°î
->
mf_íd
 = 
	`m°ime
(Ë+ 
CLUSTER_MF_TIMEOUT
;

4761 i‡(
èkeovî
) {

4766 
	`£rvîLog
(
LL_WARNING
,"Taking overÅhe master (userÑequest).");

4767 
	`˛u°îBumpC⁄figEpochWôhoutC⁄£nsus
();

4768 
	`˛u°îFaûovîRïœ˚YourMa°î
();

4769 } i‡(
f‹˚
) {

4773 
	`£rvîLog
(
LL_WARNING
,"Forced failover userÑequestáccepted.");

4774 
£rvî
.
˛u°î
->
mf_ˇn_°¨t
 = 1;

4776 
	`£rvîLog
(
LL_WARNING
,"Manual failover userÑequestáccepted.");

4777 
	`˛u°îSídMFSèπ
(
my£lf
->
¶aveof
);

4779 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4780 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"£t-c⁄fig-ïoch"Ë&& c->
¨gc
 == 3)

4789 
ïoch
;

4791 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
ïoch
,
NULL
Ë!
C_OK
)

4794 i‡(
ïoch
 < 0) {

4795 
	`addRïlyEº‹F‹m©
(
c
,"InvÆid c⁄figÉpoch s≥cifõd: %Œd",
ïoch
);

4796 } i‡(
	`di˘Size
(
£rvî
.
˛u°î
->
nodes
) > 1) {

4797 
	`addRïlyEº‹
(
c
,"The user canássigná configÉpoch only whenÅhe "

4799 } i‡(
my£lf
->
c⁄figEpoch
 != 0) {

4800 
	`addRïlyEº‹
(
c
,"Node configÉpoch isálreadyÇon-zero");

4802 
my£lf
->
c⁄figEpoch
 = 
ïoch
;

4803 
	`£rvîLog
(
LL_WARNING
,

4805 (Ë
my£lf
->
c⁄figEpoch
);

4807 i‡(
£rvî
.
˛u°î
->
cuºítEpoch
 < (
uöt64_t
)
ïoch
)

4808 
£rvî
.
˛u°î
->
cuºítEpoch
 = 
ïoch
;

4812 
	`˛u°îDoBef‹eSÀï
(
CLUSTER_TODO_UPDATE_STATE
|

4813 
CLUSTER_TODO_SAVE_CONFIG
);

4814 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4816 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"reset") &&

4817 (
c
->
¨gc
 == 2 || c->argc == 3))

4820 
h¨d
 = 0;

4823 i‡(
c
->
¨gc
 == 3) {

4824 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"hard")) {

4825 
h¨d
 = 1;

4826 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"soft")) {

4827 
h¨d
 = 0;

4829 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

4836 i‡(
	`nodeIsMa°î
(
my£lf
Ë&& 
	`di˘Size
(
c
->
db
->
di˘
) != 0) {

4837 
	`addRïlyEº‹
(
c
,"CLUSTER RESET can't be called with "

4841 
	`˛u°îRe£t
(
h¨d
);

4842 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4844 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

4847 
	}
}

4855 
	$¸óãDumpPaylﬂd
(
rio
 *
∑ylﬂd
, 
robj
 *
o
,Ñobj *
key
) {

4856 
buf
[2];

4857 
uöt64_t
 
¸c
;

4861 
	`rioInôWôhBuf„r
(
∑ylﬂd
,
	`sd£m±y
());

4862 
	`£rvîAs£π
(
	`rdbSaveObje˘Ty≥
(
∑ylﬂd
,
o
));

4863 
	`£rvîAs£π
(
	`rdbSaveObje˘
(
∑ylﬂd
,
o
,
key
));

4873 
buf
[0] = 
RDB_VERSION
 & 0xff;

4874 
buf
[1] = (
RDB_VERSION
 >> 8) & 0xff;

4875 
∑ylﬂd
->
io
.
buf„r
.
±r
 = 
	`sdsˇéí
’aylﬂd->io.buf„r.±r,
buf
,2);

4878 
¸c
 = 
	`¸c64
(0,(*)
∑ylﬂd
->
io
.
buf„r
.
±r
,

4879 
	`sd¶í
(
∑ylﬂd
->
io
.
buf„r
.
±r
));

4880 
	`memªv64ifbe
(&
¸c
);

4881 
∑ylﬂd
->
io
.
buf„r
.
±r
 = 
	`sdsˇéí
’aylﬂd->io.buf„r.±r,&
¸c
,8);

4882 
	}
}

4888 
	$vîifyDumpPaylﬂd
(*
p
, 
size_t
 
Àn
) {

4889 *
foŸî
;

4890 
uöt16_t
 
rdbvî
;

4891 
uöt64_t
 
¸c
;

4894 i‡(
Àn
 < 10Ë 
C_ERR
;

4895 
foŸî
 = 
p
+(
Àn
-10);

4898 
rdbvî
 = (
foŸî
[1] << 8) | footer[0];

4899 i‡(
rdbvî
 > 
RDB_VERSION
Ë 
C_ERR
;

4902 
¸c
 = 
	`¸c64
(0,
p
,
Àn
-8);

4903 
	`memªv64ifbe
(&
¸c
);

4904  (
	`memcmp
(&
¸c
,
foŸî
+2,8Ë=0Ë? 
C_OK
 : 
C_ERR
;

4905 
	}
}

4910 
	$dumpComm™d
(
˛õ¡
 *
c
) {

4911 
robj
 *
o
;

4912 
rio
 
∑ylﬂd
;

4915 i‡((
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[1])Ë=
NULL
) {

4916 
	`addRïlyNuŒ
(
c
);

4921 
	`¸óãDumpPaylﬂd
(&
∑ylﬂd
,
o
,
c
->
¨gv
[1]);

4924 
	`addRïlyBulkSds
(
c
,
∑ylﬂd
.
io
.
buf„r
.
±r
);

4926 
	}
}

4929 
	$ª°‹eComm™d
(
˛õ¡
 *
c
) {

4930 
âl
, 
lfu_‰eq
 = -1, 
Ãu_idÀ
 = -1, 
Ãu_˛ock
 = -1;

4931 
rio
 
∑ylﬂd
;

4932 
j
, 
ty≥
, 
ª∂a˚
 = 0, 
ab°é
 = 0;

4933 
robj
 *
obj
;

4936 
j
 = 4; j < 
c
->
¨gc
; j++) {

4937 
addôi⁄Æ
 = 
c
->
¨gc
-
j
-1;

4938 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"replace")) {

4939 
ª∂a˚
 = 1;

4940 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"absttl")) {

4941 
ab°é
 = 1;

4942 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"idÀtime"Ë&& 
addôi⁄Æ
 >= 1 &&

4943 
lfu_‰eq
 == -1)

4945 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
+1],&
Ãu_idÀ
,
NULL
)

4946 !
C_OK
) ;

4947 i‡(
Ãu_idÀ
 < 0) {

4948 
	`addRïlyEº‹
(
c
,"Invalid IDLETIME value, must be >= 0");

4951 
Ãu_˛ock
 = 
	`LRU_CLOCK
();

4952 
j
++;

4953 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"‰eq"Ë&& 
addôi⁄Æ
 >= 1 &&

4954 
Ãu_idÀ
 == -1)

4956 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
+1],&
lfu_‰eq
,
NULL
)

4957 !
C_OK
) ;

4958 i‡(
lfu_‰eq
 < 0 ||Üfu_freq > 255) {

4959 
	`addRïlyEº‹
(
c
,"Invalid FREQ value, must be >= 0ánd <= 255");

4962 
j
++;

4964 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

4970 i‡(!
ª∂a˚
 && 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]Ë!
NULL
) {

4971 
	`addRïly
(
c
,
sh¨ed
.
busykeyîr
);

4976 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
âl
,
NULL
Ë!
C_OK
) {

4978 } i‡(
âl
 < 0) {

4979 
	`addRïlyEº‹
(
c
,"Invalid TTL value, must be >= 0");

4984 i‡(
	`vîifyDumpPaylﬂd
(
c
->
¨gv
[3]->
±r
,
	`sd¶í
(c->¨gv[3]->±r)Ë=
C_ERR
)

4986 
	`addRïlyEº‹
(
c
,"DUMPÖayload version or checksumáre wrong");

4990 
	`rioInôWôhBuf„r
(&
∑ylﬂd
,
c
->
¨gv
[3]->
±r
);

4991 i‡(((
ty≥
 = 
	`rdbLﬂdObje˘Ty≥
(&
∑ylﬂd
)) == -1) ||

4992 ((
obj
 = 
	`rdbLﬂdObje˘
(
ty≥
,&
∑ylﬂd
,
c
->
¨gv
[1]->
±r
)Ë=
NULL
))

4994 
	`addRïlyEº‹
(
c
,"Bad data format");

4999 i‡(
ª∂a˚
Ë
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

5002 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],
obj
);

5003 i‡(
âl
) {

5004 i‡(!
ab°é
Ë
âl
+=
	`m°ime
();

5005 
	`£tExpúe
(
c
,c->
db
,c->
¨gv
[1],
âl
);

5007 
	`obje˘SëLRUOrLFU
(
obj
,
lfu_‰eq
,
Ãu_idÀ
,
Ãu_˛ock
,1000);

5008 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

5009 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"ª°‹e",
c
->
¨gv
[1],c->
db
->
id
);

5010 
	`addRïly
(
c
,
sh¨ed
.
ok
);

5011 
£rvî
.
dúty
++;

5012 
	}
}

5020 
	#MIGRATE_SOCKET_CACHE_ITEMS
 64

	)

5021 
	#MIGRATE_SOCKET_CACHE_TTL
 10

	)

5023 
	smigøãCachedSockë
 {

5024 
c⁄√˘i⁄
 *
	mc⁄n
;

5025 
	mœ°_dbid
;

5026 
time_t
 
	mœ°_u£_time
;

5027 } 
	tmigøãCachedSockë
;

5040 
migøãCachedSockë
* 
	$migøãGëSockë
(
˛õ¡
 *
c
, 
robj
 *
ho°
,Ñobj *
p‹t
, 
timeout
) {

5041 
c⁄√˘i⁄
 *
c⁄n
;

5042 
sds
 
«me
 = 
	`sd£m±y
();

5043 
migøãCachedSockë
 *
cs
;

5046 
«me
 = 
	`sdsˇéí
“ame,
ho°
->
±r
,
	`sd¶í
(host->ptr));

5047 
«me
 = 
	`sdsˇéí
(name,":",1);

5048 
«me
 = 
	`sdsˇéí
“ame,
p‹t
->
±r
,
	`sd¶í
(port->ptr));

5049 
cs
 = 
	`di˘FëchVÆue
(
£rvî
.
migøã_ˇched_sockës
,
«me
);

5050 i‡(
cs
) {

5051 
	`sds‰ì
(
«me
);

5052 
cs
->
œ°_u£_time
 = 
£rvî
.
unixtime
;

5053  
cs
;

5057 i‡(
	`di˘Size
(
£rvî
.
migøã_ˇched_sockës
Ë=
MIGRATE_SOCKET_CACHE_ITEMS
) {

5059 
di˘E¡ry
 *
de
 = 
	`di˘GëR™domKey
(
£rvî
.
migøã_ˇched_sockës
);

5060 
cs
 = 
	`di˘GëVÆ
(
de
);

5061 
	`c⁄nClo£
(
cs
->
c⁄n
);

5062 
	`z‰ì
(
cs
);

5063 
	`di˘Dñëe
(
£rvî
.
migøã_ˇched_sockës
,
	`di˘GëKey
(
de
));

5067 
c⁄n
 = 
£rvî
.
és_˛u°î
 ? 
	`c⁄nCª©eTLS
(Ë: 
	`c⁄nCª©eSockë
();

5068 i‡(
	`c⁄nBlockögC⁄√˘
(
c⁄n
, 
c
->
¨gv
[1]->
±r
, 
	`©oi
(c->¨gv[2]->±r), 
timeout
)

5069 !
C_OK
) {

5070 
	`addRïlySds
(
c
,

5071 
	`sd¢ew
("-IOERRÉrror orÅimeout connectingÅoÅhe client\r\n"));

5072 
	`c⁄nClo£
(
c⁄n
);

5073 
	`sds‰ì
(
«me
);

5074  
NULL
;

5076 
	`c⁄nE«bÀT˝NoDñay
(
c⁄n
);

5079 
cs
 = 
	`zmÆloc
((*cs));

5080 
cs
->
c⁄n
 = conn;

5082 
cs
->
œ°_dbid
 = -1;

5083 
cs
->
œ°_u£_time
 = 
£rvî
.
unixtime
;

5084 
	`di˘Add
(
£rvî
.
migøã_ˇched_sockës
,
«me
,
cs
);

5085  
cs
;

5086 
	}
}

5089 
	$migøãClo£Sockë
(
robj
 *
ho°
,Ñobj *
p‹t
) {

5090 
sds
 
«me
 = 
	`sd£m±y
();

5091 
migøãCachedSockë
 *
cs
;

5093 
«me
 = 
	`sdsˇéí
“ame,
ho°
->
±r
,
	`sd¶í
(host->ptr));

5094 
«me
 = 
	`sdsˇéí
(name,":",1);

5095 
«me
 = 
	`sdsˇéí
“ame,
p‹t
->
±r
,
	`sd¶í
(port->ptr));

5096 
cs
 = 
	`di˘FëchVÆue
(
£rvî
.
migøã_ˇched_sockës
,
«me
);

5097 i‡(!
cs
) {

5098 
	`sds‰ì
(
«me
);

5102 
	`c⁄nClo£
(
cs
->
c⁄n
);

5103 
	`z‰ì
(
cs
);

5104 
	`di˘Dñëe
(
£rvî
.
migøã_ˇched_sockës
,
«me
);

5105 
	`sds‰ì
(
«me
);

5106 
	}
}

5108 
	$migøãClo£TimedoutSockës
() {

5109 
di˘Iãøt‹
 *
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
migøã_ˇched_sockës
);

5110 
di˘E¡ry
 *
de
;

5112 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

5113 
migøãCachedSockë
 *
cs
 = 
	`di˘GëVÆ
(
de
);

5115 i‡((
£rvî
.
unixtime
 - 
cs
->
œ°_u£_time
Ë> 
MIGRATE_SOCKET_CACHE_TTL
) {

5116 
	`c⁄nClo£
(
cs
->
c⁄n
);

5117 
	`z‰ì
(
cs
);

5118 
	`di˘Dñëe
(
£rvî
.
migøã_ˇched_sockës
,
	`di˘GëKey
(
de
));

5121 
	`di˘Rñó£Iãøt‹
(
di
);

5122 
	}
}

5131 
	$migøãComm™d
(
˛õ¡
 *
c
) {

5132 
migøãCachedSockë
 *
cs
;

5133 
c›y
 = 0, 
ª∂a˚
 = 0, 
j
;

5134 *
u£∫ame
 = 
NULL
;

5135 *
∑ssw‹d
 = 
NULL
;

5136 
timeout
;

5137 
dbid
;

5138 
robj
 **
ov
 = 
NULL
;

5139 
robj
 **
kv
 = 
NULL
;

5140 
robj
 **
√w¨gv
 = 
NULL
;

5141 
rio
 
cmd
, 
∑ylﬂd
;

5142 
may_ªåy
 = 1;

5143 
wrôe_îr‹
 = 0;

5144 
¨gv_ªwrôãn
 = 0;

5147 
fú°_key
 = 3;

5148 
num_keys
 = 1;

5151 
j
 = 6; j < 
c
->
¨gc
; j++) {

5152 
m‹órgs
 = (
c
->
¨gc
-1Ë- 
j
;

5153 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"copy")) {

5154 
c›y
 = 1;

5155 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"replace")) {

5156 
ª∂a˚
 = 1;

5157 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"auth")) {

5158 i‡(!
m‹órgs
) {

5159 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

5162 
j
++;

5163 
∑ssw‹d
 = 
c
->
¨gv
[
j
]->
±r
;

5164 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"auth2")) {

5165 i‡(
m‹órgs
 < 2) {

5166 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

5169 
u£∫ame
 = 
c
->
¨gv
[++
j
]->
±r
;

5170 
∑ssw‹d
 = 
c
->
¨gv
[++
j
]->
±r
;

5171 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"keys")) {

5172 i‡(
	`sd¶í
(
c
->
¨gv
[3]->
±r
) != 0) {

5173 
	`addRïlyEº‹
(
c
,

5178 
fú°_key
 = 
j
+1;

5179 
num_keys
 = 
c
->
¨gc
 - 
j
 - 1;

5182 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

5188 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[5],&
timeout
,
NULL
Ë!
C_OK
 ||

5189 
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[4],&
dbid
,
NULL
Ë!
C_OK
)

5193 i‡(
timeout
 <= 0)Åimeout = 1000;

5200 
ov
 = 
	`zªÆloc
(ov,(
robj
*)*
num_keys
);

5201 
kv
 = 
	`zªÆloc
(kv,(
robj
*)*
num_keys
);

5202 
oi
 = 0;

5204 
j
 = 0; j < 
num_keys
; j++) {

5205 i‡((
ov
[
oi
] = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
fú°_key
+
j
])Ë!
NULL
) {

5206 
kv
[
oi
] = 
c
->
¨gv
[
fú°_key
+
j
];

5207 
oi
++;

5210 
num_keys
 = 
oi
;

5211 i‡(
num_keys
 == 0) {

5212 
	`z‰ì
(
ov
); z‰ì(
kv
);

5213 
	`addRïlySds
(
c
,
	`sd¢ew
("+NOKEY\r\n"));

5217 
åy_agaö
:

5218 
wrôe_îr‹
 = 0;

5221 
cs
 = 
	`migøãGëSockë
(
c
,c->
¨gv
[1],c->¨gv[2],
timeout
);

5222 i‡(
cs
 =
NULL
) {

5223 
	`z‰ì
(
ov
); z‰ì(
kv
);

5227 
	`rioInôWôhBuf„r
(&
cmd
,
	`sd£m±y
());

5230 i‡(
∑ssw‹d
) {

5231 
¨ôy
 = 
u£∫ame
 ? 3 : 2;

5232 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkCou¡
(&
cmd
,'*',
¨ôy
));

5233 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkSåög
(&
cmd
,"AUTH",4));

5234 i‡(
u£∫ame
) {

5235 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkSåög
(&
cmd
,
u£∫ame
,

5236 
	`sd¶í
(
u£∫ame
)));

5238 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkSåög
(&
cmd
,
∑ssw‹d
,

5239 
	`sd¶í
(
∑ssw‹d
)));

5243 
£À˘
 = 
cs
->
œ°_dbid
 !
dbid
;

5244 i‡(
£À˘
) {

5245 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkCou¡
(&
cmd
,'*',2));

5246 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkSåög
(&
cmd
,"SELECT",6));

5247 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkL⁄gL⁄g
(&
cmd
,
dbid
));

5250 
n⁄_expúed
 = 0;

5256 
j
 = 0; j < 
num_keys
; j++) {

5257 
âl
 = 0;

5258 
expúót
 = 
	`gëExpúe
(
c
->
db
,
kv
[
j
]);

5260 i‡(
expúót
 != -1) {

5261 
âl
 = 
expúót
-
	`m°ime
();

5262 i‡(
âl
 < 0) {

5265 i‡(
âl
 < 1)Åtl = 1;

5271 
kv
[
n⁄_expúed
++] = kv[
j
];

5273 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,

5274 
	`rioWrôeBulkCou¡
(&
cmd
,'*',
ª∂a˚
 ? 5 : 4));

5276 i‡(
£rvî
.
˛u°î_íabÀd
)

5277 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,

5278 
	`rioWrôeBulkSåög
(&
cmd
,"RESTORE-ASKING",14));

5280 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkSåög
(&
cmd
,"RESTORE",7));

5281 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`sdsEncodedObje˘
(
kv
[
j
]));

5282 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkSåög
(&
cmd
,
kv
[
j
]->
±r
,

5283 
	`sd¶í
(
kv
[
j
]->
±r
)));

5284 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkL⁄gL⁄g
(&
cmd
,
âl
));

5288 
	`¸óãDumpPaylﬂd
(&
∑ylﬂd
,
ov
[
j
],
kv
[j]);

5289 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,

5290 
	`rioWrôeBulkSåög
(&
cmd
,
∑ylﬂd
.
io
.
buf„r
.
±r
,

5291 
	`sd¶í
(
∑ylﬂd
.
io
.
buf„r
.
±r
)));

5292 
	`sds‰ì
(
∑ylﬂd
.
io
.
buf„r
.
±r
);

5296 i‡(
ª∂a˚
)

5297 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
	`rioWrôeBulkSåög
(&
cmd
,"REPLACE",7));

5301 
num_keys
 = 
n⁄_expúed
;

5304 
î∫o
 = 0;

5306 
sds
 
buf
 = 
cmd
.
io
.
buf„r
.
±r
;

5307 
size_t
 
pos
 = 0, 
towrôe
;

5308 
nwrôãn
 = 0;

5310 (
towrôe
 = 
	`sd¶í
(
buf
)-
pos
) > 0) {

5311 
towrôe
 = (towrite > (64*1024) ? (64*1024) :Åowrite);

5312 
nwrôãn
 = 
	`c⁄nSyncWrôe
(
cs
->
c⁄n
,
buf
+
pos
,
towrôe
,
timeout
);

5313 i‡(
nwrôãn
 !(sig√d)
towrôe
) {

5314 
wrôe_îr‹
 = 1;

5315 
sockë_îr
;

5317 
pos
 +
nwrôãn
;

5321 
buf0
[1024];

5322 
buf1
[1024];

5323 
buf2
[1024];

5326 i‡(
∑ssw‹d
 && 
	`c⁄nSyncRódLöe
(
cs
->
c⁄n
, 
buf0
, (buf0), 
timeout
) <= 0)

5327 
sockë_îr
;

5330 i‡(
£À˘
 && 
	`c⁄nSyncRódLöe
(
cs
->
c⁄n
, 
buf1
, (buf1), 
timeout
) <= 0)

5331 
sockë_îr
;

5334 
îr‹_‰om_èrgë
 = 0;

5335 
sockë_îr‹
 = 0;

5336 
dñ_idx
 = 1;

5342 i‡(!
c›y
Ë
√w¨gv
 = 
	`zmÆloc
((
robj
*)*(
num_keys
+1));

5344 
j
 = 0; j < 
num_keys
; j++) {

5345 i‡(
	`c⁄nSyncRódLöe
(
cs
->
c⁄n
, 
buf2
, (buf2), 
timeout
) <= 0) {

5346 
sockë_îr‹
 = 1;

5349 i‡((
∑ssw‹d
 && 
buf0
[0] == '-') ||

5350 (
£À˘
 && 
buf1
[0] == '-') ||

5351 
buf2
[0] == '-')

5354 i‡(!
îr‹_‰om_èrgë
) {

5355 
cs
->
œ°_dbid
 = -1;

5356 *
îrbuf
;

5357 i‡(
∑ssw‹d
 && 
buf0
[0] ='-'Ë
îrbuf
 = buf0;

5358 i‡(
£À˘
 && 
buf1
[0] ='-'Ë
îrbuf
 = buf1;

5359 
îrbuf
 = 
buf2
;

5361 
îr‹_‰om_èrgë
 = 1;

5362 
	`addRïlyEº‹F‹m©
(
c
,"Target instanceÑeplied withÉrror: %s",

5363 
îrbuf
+1);

5366 i‡(!
c›y
) {

5368 
	`dbDñëe
(
c
->
db
,
kv
[
j
]);

5369 
	`sig«lModifõdKey
(
c
,c->
db
,
kv
[
j
]);

5370 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
kv
[
j
],
c
->
db
->
id
);

5371 
£rvî
.
dúty
++;

5374 
√w¨gv
[
dñ_idx
++] = 
kv
[
j
];

5375 
	`ö¸RefCou¡
(
kv
[
j
]);

5383 i‡(!
îr‹_‰om_èrgë
 && 
sockë_îr‹
 && 
j
 =0 && 
may_ªåy
 &&

5384 
î∫o
 !
ETIMEDOUT
)

5386 
sockë_îr
;

5392 i‡(
sockë_îr‹
Ë
	`migøãClo£Sockë
(
c
->
¨gv
[1],c->argv[2]);

5394 i‡(!
c›y
) {

5398 i‡(
dñ_idx
 > 1) {

5399 
√w¨gv
[0] = 
	`¸óãSåögObje˘
("DEL",3);

5401 
	`ª∂a˚Clõ¡Comm™dVe˘‹
(
c
,
dñ_idx
,
√w¨gv
);

5402 
¨gv_ªwrôãn
 = 1;

5405 
	`z‰ì
(
√w¨gv
);

5407 
√w¨gv
 = 
NULL
;

5413 i‡(!
îr‹_‰om_èrgë
 && 
sockë_îr‹
) {

5414 
may_ªåy
 = 0;

5415 
sockë_îr
;

5418 i‡(!
îr‹_‰om_èrgë
) {

5425 
cs
->
œ°_dbid
 = 
dbid
;

5426 
	`addRïly
(
c
,
sh¨ed
.
ok
);

5432 
	`sds‰ì
(
cmd
.
io
.
buf„r
.
±r
);

5433 
	`z‰ì
(
ov
); z‰ì(
kv
); z‰ì(
√w¨gv
);

5439 
sockë_îr
:

5442 
	`sds‰ì
(
cmd
.
io
.
buf„r
.
±r
);

5448 i‡(!
¨gv_ªwrôãn
Ë
	`migøãClo£Sockë
(
c
->
¨gv
[1],c->argv[2]);

5449 
	`z‰ì
(
√w¨gv
);

5450 
√w¨gv
 = 
NULL
;

5454 i‡(
î∫o
 !
ETIMEDOUT
 && 
may_ªåy
) {

5455 
may_ªåy
 = 0;

5456 
åy_agaö
;

5460 
	`z‰ì
(
ov
); z‰ì(
kv
);

5461 
	`addRïlySds
(
c
,

5462 
	`sdsˇçrötf
(
	`sd£m±y
(),

5464 
wrôe_îr‹
 ? "writing" : "reading"));

5466 
	}
}

5476 
	$askögComm™d
(
˛õ¡
 *
c
) {

5477 i‡(
£rvî
.
˛u°î_íabÀd
 == 0) {

5478 
	`addRïlyEº‹
(
c
,"This instance has cluster support disabled");

5481 
c
->
Êags
 |
CLIENT_ASKING
;

5482 
	`addRïly
(
c
,
sh¨ed
.
ok
);

5483 
	}
}

5488 
	$ªad⁄lyComm™d
(
˛õ¡
 *
c
) {

5489 i‡(
£rvî
.
˛u°î_íabÀd
 == 0) {

5490 
	`addRïlyEº‹
(
c
,"This instance has cluster support disabled");

5493 
c
->
Êags
 |
CLIENT_READONLY
;

5494 
	`addRïly
(
c
,
sh¨ed
.
ok
);

5495 
	}
}

5498 
	$ªadwrôeComm™d
(
˛õ¡
 *
c
) {

5499 
c
->
Êags
 &~
CLIENT_READONLY
;

5500 
	`addRïly
(
c
,
sh¨ed
.
ok
);

5501 
	}
}

5535 
˛u°îNode
 *
	$gëNodeByQuîy
(
˛õ¡
 *
c
, 
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
hash¶Ÿ
, *
îr‹_code
) {

5536 
˛u°îNode
 *
n
 = 
NULL
;

5537 
robj
 *
fú°key
 = 
NULL
;

5538 
mu…ùÀ_keys
 = 0;

5539 
mu…iSèã
 *
ms
, 
_ms
;

5540 
mu…iCmd
 
mc
;

5541 
i
, 
¶Ÿ
 = 0, 
migøtög_¶Ÿ
 = 0, 
imp‹tög_¶Ÿ
 = 0, 
missög_keys
 = 0;

5544 i‡(
£rvî
.
˛u°î_moduÀ_Êags
 & 
CLUSTER_MODULE_FLAG_NO_REDIRECTION
)

5545  
my£lf
;

5548 i‡(
îr‹_code
Ë*îr‹_codê
CLUSTER_REDIR_NONE
;

5556 i‡(
cmd
->
¥oc
 =
execComm™d
) {

5559 i‡(!(
c
->
Êags
 & 
CLIENT_MULTI
)Ë 
my£lf
;

5560 
ms
 = &
c
->
m°©e
;

5565 
ms
 = &
_ms
;

5566 
_ms
.
comm™ds
 = &
mc
;

5567 
_ms
.
cou¡
 = 1;

5568 
mc
.
¨gv
 =árgv;

5569 
mc
.
¨gc
 =árgc;

5570 
mc
.
cmd
 = cmd;

5575 
i
 = 0; i < 
ms
->
cou¡
; i++) {

5576 
ªdisComm™d
 *
mcmd
;

5577 
robj
 **
m¨gv
;

5578 
m¨gc
, *
keyödex
, 
numkeys
, 
j
;

5580 
mcmd
 = 
ms
->
comm™ds
[
i
].
cmd
;

5581 
m¨gc
 = 
ms
->
comm™ds
[
i
].
¨gc
;

5582 
m¨gv
 = 
ms
->
comm™ds
[
i
].
¨gv
;

5584 
keyödex
 = 
	`gëKeysFromComm™d
(
mcmd
,
m¨gv
,
m¨gc
,&
numkeys
);

5585 
j
 = 0; j < 
numkeys
; j++) {

5586 
robj
 *
thiskey
 = 
m¨gv
[
keyödex
[
j
]];

5587 
this¶Ÿ
 = 
	`keyHashSlŸ
((*)
thiskey
->
±r
,

5588 
	`sd¶í
(
thiskey
->
±r
));

5590 i‡(
fú°key
 =
NULL
) {

5593 
fú°key
 = 
thiskey
;

5594 
¶Ÿ
 = 
this¶Ÿ
;

5595 
n
 = 
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
];

5601 i‡(
n
 =
NULL
) {

5602 
	`gëKeysFªeResu…
(
keyödex
);

5603 i‡(
îr‹_code
)

5604 *
îr‹_code
 = 
CLUSTER_REDIR_DOWN_UNBOUND
;

5605  
NULL
;

5613 i‡(
n
 =
my£lf
 &&

5614 
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
¶Ÿ
] !
NULL
)

5616 
migøtög_¶Ÿ
 = 1;

5617 } i‡(
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
¶Ÿ
] !
NULL
) {

5618 
imp‹tög_¶Ÿ
 = 1;

5623 i‡(!
	`equÆSåögObje˘s
(
fú°key
,
thiskey
)) {

5624 i‡(
¶Ÿ
 !
this¶Ÿ
) {

5626 
	`gëKeysFªeResu…
(
keyödex
);

5627 i‡(
îr‹_code
)

5628 *
îr‹_code
 = 
CLUSTER_REDIR_CROSS_SLOT
;

5629  
NULL
;

5633 
mu…ùÀ_keys
 = 1;

5639 i‡((
migøtög_¶Ÿ
 || 
imp‹tög_¶Ÿ
) &&

5640 
	`lookupKeyRód
(&
£rvî
.
db
[0],
thiskey
Ë=
NULL
)

5642 
missög_keys
++;

5645 
	`gëKeysFªeResu…
(
keyödex
);

5650 i‡(
n
 =
NULL
Ë 
my£lf
;

5654 i‡(
£rvî
.
˛u°î
->
°©e
 !
CLUSTER_OK
) {

5655 i‡(!
£rvî
.
˛u°î_Ælow_ªads_whí_down
) {

5658 i‡(
îr‹_code
Ë*îr‹_codê
CLUSTER_REDIR_DOWN_STATE
;

5659  
NULL
;

5660 } i‡(!(
cmd
->
Êags
 & 
CMD_READONLY
Ë&& !(cmd->
¥oc
 =
evÆComm™d
)

5661 && !(
cmd
->
¥oc
 =
evÆShaComm™d
))

5666 i‡(
îr‹_code
Ë*îr‹_codê
CLUSTER_REDIR_DOWN_RO_STATE
;

5667  
NULL
;

5676 i‡(
hash¶Ÿ
Ë*hash¶Ÿ = 
¶Ÿ
;

5681 i‡((
migøtög_¶Ÿ
 || 
imp‹tög_¶Ÿ
Ë&& 
cmd
->
¥oc
 =
migøãComm™d
)

5682  
my£lf
;

5686 i‡(
migøtög_¶Ÿ
 && 
missög_keys
) {

5687 i‡(
îr‹_code
Ë*îr‹_codê
CLUSTER_REDIR_ASK
;

5688  
£rvî
.
˛u°î
->
migøtög_¶Ÿs_to
[
¶Ÿ
];

5695 i‡(
imp‹tög_¶Ÿ
 &&

5696 (
c
->
Êags
 & 
CLIENT_ASKING
 || 
cmd
->Êag†& 
CMD_ASKING
))

5698 i‡(
mu…ùÀ_keys
 && 
missög_keys
) {

5699 i‡(
îr‹_code
Ë*îr‹_codê
CLUSTER_REDIR_UNSTABLE
;

5700  
NULL
;

5702  
my£lf
;

5709 i‡(
c
->
Êags
 & 
CLIENT_READONLY
 &&

5710 (
cmd
->
Êags
 & 
CMD_READONLY
 || cmd->
¥oc
 =
evÆComm™d
 ||

5711 
cmd
->
¥oc
 =
evÆShaComm™d
) &&

5712 
	`nodeIsSœve
(
my£lf
) &&

5713 
my£lf
->
¶aveof
 =
n
)

5715  
my£lf
;

5720 i‡(
n
 !
my£lf
 && 
îr‹_code
Ë*îr‹_codê
CLUSTER_REDIR_MOVED
;

5721  
n
;

5722 
	}
}

5731 
	$˛u°îRedúe˘Clõ¡
(
˛õ¡
 *
c
, 
˛u°îNode
 *
n
, 
hash¶Ÿ
, 
îr‹_code
) {

5732 i‡(
îr‹_code
 =
CLUSTER_REDIR_CROSS_SLOT
) {

5733 
	`addRïlySds
(
c
,
	`sd¢ew
("-CROSSSLOT Keys inÑequest don't hashÅoÅhe same slot\r\n"));

5734 } i‡(
îr‹_code
 =
CLUSTER_REDIR_UNSTABLE
) {

5738 
	`addRïlySds
(
c
,
	`sd¢ew
("-TRYAGAIN Multiple keysÑequest duringÑehashing of slot\r\n"));

5739 } i‡(
îr‹_code
 =
CLUSTER_REDIR_DOWN_STATE
) {

5740 
	`addRïlySds
(
c
,
	`sd¢ew
("-CLUSTERDOWN The cluster is down\r\n"));

5741 } i‡(
îr‹_code
 =
CLUSTER_REDIR_DOWN_RO_STATE
) {

5742 
	`addRïlySds
(
c
,
	`sd¢ew
("-CLUSTERDOWN The cluster is downánd onlyácceptsÑead commands\r\n"));

5743 } i‡(
îr‹_code
 =
CLUSTER_REDIR_DOWN_UNBOUND
) {

5744 
	`addRïlySds
(
c
,
	`sd¢ew
("-CLUSTERDOWN Hash slotÇot served\r\n"));

5745 } i‡(
îr‹_code
 =
CLUSTER_REDIR_MOVED
 ||

5746 
îr‹_code
 =
CLUSTER_REDIR_ASK
)

5748 
	`addRïlySds
(
c
,
	`sdsˇçrötf
(
	`sd£m±y
(),

5750 (
îr‹_code
 =
CLUSTER_REDIR_ASK
) ? "ASK" : "MOVED",

5751 
hash¶Ÿ
,
n
->
ù
,n->
p‹t
));

5753 
	`£rvîP™ic
("getNodeByQuery() unknownÉrror.");

5755 
	}
}

5768 
	$˛u°îRedúe˘BlockedClõ¡IfNìded
(
˛õ¡
 *
c
) {

5769 i‡(
c
->
Êags
 & 
CLIENT_BLOCKED
 &&

5770 (
c
->
bty≥
 =
BLOCKED_LIST
 ||

5771 
c
->
bty≥
 =
BLOCKED_ZSET
 ||

5772 
c
->
bty≥
 =
BLOCKED_STREAM
))

5774 
di˘E¡ry
 *
de
;

5775 
di˘Iãøt‹
 *
di
;

5781 i‡(
£rvî
.
˛u°î
->
°©e
 =
CLUSTER_FAIL
) {

5782 
	`˛u°îRedúe˘Clõ¡
(
c
,
NULL
,0,
CLUSTER_REDIR_DOWN_STATE
);

5787 
di
 = 
	`di˘GëIãøt‹
(
c
->
bp›
.
keys
);

5788 i‡((
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

5789 
robj
 *
key
 = 
	`di˘GëKey
(
de
);

5790 
¶Ÿ
 = 
	`keyHashSlŸ
((*)
key
->
±r
, 
	`sd¶í
(key->ptr));

5791 
˛u°îNode
 *
node
 = 
£rvî
.
˛u°î
->
¶Ÿs
[
¶Ÿ
];

5796 i‡(
node
 !
my£lf
 &&

5797 
£rvî
.
˛u°î
->
imp‹tög_¶Ÿs_‰om
[
¶Ÿ
] =
NULL
)

5799 i‡(
node
 =
NULL
) {

5800 
	`˛u°îRedúe˘Clõ¡
(
c
,
NULL
,0,

5801 
CLUSTER_REDIR_DOWN_UNBOUND
);

5803 
	`˛u°îRedúe˘Clõ¡
(
c
,
node
,
¶Ÿ
,

5804 
CLUSTER_REDIR_MOVED
);

5806 
	`di˘Rñó£Iãøt‹
(
di
);

5810 
	`di˘Rñó£Iãøt‹
(
di
);

5813 
	}
}

	@cluster.h

1 #i‚de‡
__CLUSTER_H


2 
	#__CLUSTER_H


	)

8 
	#CLUSTER_SLOTS
 16384

	)

9 
	#CLUSTER_OK
 0

	)

10 
	#CLUSTER_FAIL
 1

	)

11 
	#CLUSTER_NAMELEN
 40

	)

12 
	#CLUSTER_PORT_INCR
 10000

	)

16 
	#CLUSTER_FAIL_REPORT_VALIDITY_MULT
 2

	)

17 
	#CLUSTER_FAIL_UNDO_TIME_MULT
 2

	)

18 
	#CLUSTER_FAIL_UNDO_TIME_ADD
 10

	)

19 
	#CLUSTER_FAILOVER_DELAY
 5

	)

20 
	#CLUSTER_MF_TIMEOUT
 5000

	)

21 
	#CLUSTER_MF_PAUSE_MULT
 2

	)

22 
	#CLUSTER_SLAVE_MIGRATION_DELAY
 5000

	)

25 
	#CLUSTER_REDIR_NONE
 0

	)

26 
	#CLUSTER_REDIR_CROSS_SLOT
 1

	)

27 
	#CLUSTER_REDIR_UNSTABLE
 2

	)

28 
	#CLUSTER_REDIR_ASK
 3

	)

29 
	#CLUSTER_REDIR_MOVED
 4

	)

30 
	#CLUSTER_REDIR_DOWN_STATE
 5

	)

31 
	#CLUSTER_REDIR_DOWN_UNBOUND
 6

	)

32 
	#CLUSTER_REDIR_DOWN_RO_STATE
 7

	)

34 
	g˛u°îNode
;

37 
	s˛u°îLök
 {

38 
m°ime_t
 
	m˘ime
;

39 
c⁄√˘i⁄
 *
	mc⁄n
;

40 
sds
 
	m¢dbuf
;

41 
sds
 
	mrcvbuf
;

42 
˛u°îNode
 *
	mnode
;

43 } 
	t˛u°îLök
;

46 
	#CLUSTER_NODE_MASTER
 1

	)

47 
	#CLUSTER_NODE_SLAVE
 2

	)

48 
	#CLUSTER_NODE_PFAIL
 4

	)

49 
	#CLUSTER_NODE_FAIL
 8

	)

50 
	#CLUSTER_NODE_MYSELF
 16

	)

51 
	#CLUSTER_NODE_HANDSHAKE
 32

	)

52 
	#CLUSTER_NODE_NOADDR
 64

	)

53 
	#CLUSTER_NODE_MEET
 128

	)

54 
	#CLUSTER_NODE_MIGRATE_TO
 256

	)

55 
	#CLUSTER_NODE_NOFAILOVER
 512

	)

56 
	#CLUSTER_NODE_NULL_NAME
 "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"

	)

58 
	#nodeIsMa°î
(
n
Ë(“)->
Êags
 & 
CLUSTER_NODE_MASTER
)

	)

59 
	#nodeIsSœve
(
n
Ë(“)->
Êags
 & 
CLUSTER_NODE_SLAVE
)

	)

60 
	#nodeInH™dshake
(
n
Ë(“)->
Êags
 & 
CLUSTER_NODE_HANDSHAKE
)

	)

61 
	#nodeHasAddr
(
n
Ë(!(“)->
Êags
 & 
CLUSTER_NODE_NOADDR
))

	)

62 
	#nodeWôhoutAddr
(
n
Ë(“)->
Êags
 & 
CLUSTER_NODE_NOADDR
)

	)

63 
	#nodeTimedOut
(
n
Ë(“)->
Êags
 & 
CLUSTER_NODE_PFAIL
)

	)

64 
	#nodeFaûed
(
n
Ë(“)->
Êags
 & 
CLUSTER_NODE_FAIL
)

	)

65 
	#nodeC™tFaûovî
(
n
Ë(“)->
Êags
 & 
CLUSTER_NODE_NOFAILOVER
)

	)

68 
	#CLUSTER_CANT_FAILOVER_NONE
 0

	)

69 
	#CLUSTER_CANT_FAILOVER_DATA_AGE
 1

	)

70 
	#CLUSTER_CANT_FAILOVER_WAITING_DELAY
 2

	)

71 
	#CLUSTER_CANT_FAILOVER_EXPIRED
 3

	)

72 
	#CLUSTER_CANT_FAILOVER_WAITING_VOTES
 4

	)

73 
	#CLUSTER_CANT_FAILOVER_RELOG_PERIOD
 (60*5Ë

	)

76 
	#CLUSTER_TODO_HANDLE_FAILOVER
 (1<<0)

	)

77 
	#CLUSTER_TODO_UPDATE_STATE
 (1<<1)

	)

78 
	#CLUSTER_TODO_SAVE_CONFIG
 (1<<2)

	)

79 
	#CLUSTER_TODO_FSYNC_CONFIG
 (1<<3)

	)

87 
	#CLUSTERMSG_TYPE_PING
 0

	)

88 
	#CLUSTERMSG_TYPE_PONG
 1

	)

89 
	#CLUSTERMSG_TYPE_MEET
 2

	)

90 
	#CLUSTERMSG_TYPE_FAIL
 3

	)

91 
	#CLUSTERMSG_TYPE_PUBLISH
 4

	)

92 
	#CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST
 5

	)

93 
	#CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK
 6

	)

94 
	#CLUSTERMSG_TYPE_UPDATE
 7

	)

95 
	#CLUSTERMSG_TYPE_MFSTART
 8

	)

96 
	#CLUSTERMSG_TYPE_MODULE
 9

	)

97 
	#CLUSTERMSG_TYPE_COUNT
 10

	)

102 
	#CLUSTER_MODULE_FLAG_NONE
 0

	)

103 
	#CLUSTER_MODULE_FLAG_NO_FAILOVER
 (1<<1)

	)

104 
	#CLUSTER_MODULE_FLAG_NO_REDIRECTION
 (1<<2)

	)

107 
	s˛u°îNodeFaûRï‹t
 {

108 
˛u°îNode
 *
	mnode
;

109 
m°ime_t
 
	mtime
;

110 } 
	t˛u°îNodeFaûRï‹t
;

112 
	s˛u°îNode
 {

113 
m°ime_t
 
	m˘ime
;

114 
	m«me
[
CLUSTER_NAMELEN
];

115 
	mÊags
;

116 
uöt64_t
 
	mc⁄figEpoch
;

117 
	m¶Ÿs
[
CLUSTER_SLOTS
/8];

118 
	mnum¶Ÿs
;

119 
	mnum¶aves
;

120 
˛u°îNode
 **
	m¶aves
;

121 
˛u°îNode
 *
	m¶aveof
;

125 
m°ime_t
 
	mpög_£¡
;

126 
m°ime_t
 
	mp⁄g_ª˚ived
;

127 
m°ime_t
 
	md©a_ª˚ived
;

128 
m°ime_t
 
	mÁû_time
;

129 
m°ime_t
 
	mvŸed_time
;

130 
m°ime_t
 
	mª∂_off£t_time
;

131 
m°ime_t
 
	m‹ph™ed_time
;

132 
	mª∂_off£t
;

133 
	mù
[
NET_IP_STR_LEN
];

134 
	mp‹t
;

135 
	m˝‹t
;

136 
˛u°îLök
 *
	mlök
;

137 
li°
 *
	mÁû_ªp‹ts
;

138 } 
	t˛u°îNode
;

140 
	s˛u°îSèã
 {

141 
˛u°îNode
 *
	mmy£lf
;

142 
uöt64_t
 
	mcuºítEpoch
;

143 
	m°©e
;

144 
	msize
;

145 
di˘
 *
	mnodes
;

146 
di˘
 *
	mnodes_bœck_li°
;

147 
˛u°îNode
 *
	mmigøtög_¶Ÿs_to
[
CLUSTER_SLOTS
];

148 
˛u°îNode
 *
	mimp‹tög_¶Ÿs_‰om
[
CLUSTER_SLOTS
];

149 
˛u°îNode
 *
	m¶Ÿs
[
CLUSTER_SLOTS
];

150 
uöt64_t
 
	m¶Ÿs_keys_cou¡
[
CLUSTER_SLOTS
];

151 
øx
 *
	m¶Ÿs_to_keys
;

153 
m°ime_t
 
	mÁûovî_auth_time
;

154 
	mÁûovî_auth_cou¡
;

155 
	mÁûovî_auth_£¡
;

156 
	mÁûovî_auth_ønk
;

157 
uöt64_t
 
	mÁûovî_auth_ïoch
;

158 
	mˇ¡_Áûovî_ªas⁄
;

161 
m°ime_t
 
	mmf_íd
;

164 
˛u°îNode
 *
	mmf_¶ave
;

166 
	mmf_ma°î_off£t
;

168 
	mmf_ˇn_°¨t
;

171 
uöt64_t
 
	mœ°VŸeEpoch
;

172 
	mtodo_bef‹e_¶ìp
;

174 
	m°©s_bus_mesßges_£¡
[
CLUSTERMSG_TYPE_COUNT
];

175 
	m°©s_bus_mesßges_ª˚ived
[
CLUSTERMSG_TYPE_COUNT
];

176 
	m°©s_pÁû_nodes
;

178 } 
	t˛u°îSèã
;

186 
	mnodíame
[
CLUSTER_NAMELEN
];

187 
uöt32_t
 
	mpög_£¡
;

188 
uöt32_t
 
	mp⁄g_ª˚ived
;

189 
	mù
[
NET_IP_STR_LEN
];

190 
uöt16_t
 
	mp‹t
;

191 
uöt16_t
 
	m˝‹t
;

192 
uöt16_t
 
	mÊags
;

193 
uöt32_t
 
	mnŸu£d1
;

194 } 
	t˛u°îMsgD©aGossù
;

197 
	mnodíame
[
CLUSTER_NAMELEN
];

198 } 
	t˛u°îMsgD©aFaû
;

201 
uöt32_t
 
	mch™√l_Àn
;

202 
uöt32_t
 
	mmesßge_Àn
;

203 
	mbulk_d©a
[8];

204 } 
	t˛u°îMsgD©aPublish
;

207 
uöt64_t
 
	mc⁄figEpoch
;

208 
	mnodíame
[
CLUSTER_NAMELEN
];

209 
	m¶Ÿs
[
CLUSTER_SLOTS
/8];

210 } 
	t˛u°îMsgD©aUpd©e
;

213 
uöt64_t
 
	mmoduÀ_id
;

214 
uöt32_t
 
	mÀn
;

215 
uöt8_t
 
	mty≥
;

216 
	mbulk_d©a
[3];

217 } 
	t˛u°îMsgModuÀ
;

219 
	u˛u°îMsgD©a
 {

223 
˛u°îMsgD©aGossù
 
	mgossù
[1];

224 } 
	mpög
;

228 
˛u°îMsgD©aFaû
 
	mabout
;

229 } 
	mÁû
;

233 
˛u°îMsgD©aPublish
 
	mmsg
;

234 } 
	mpublish
;

238 
˛u°îMsgD©aUpd©e
 
	mnodecfg
;

239 } 
	mupd©e
;

243 
˛u°îMsgModuÀ
 
	mmsg
;

244 } 
	mmoduÀ
;

247 
	#CLUSTER_PROTO_VER
 1

	)

250 
	msig
[4];

251 
uöt32_t
 
	mtŸÀn
;

252 
uöt16_t
 
	mvî
;

253 
uöt16_t
 
	mp‹t
;

254 
uöt16_t
 
	mty≥
;

255 
uöt16_t
 
	mcou¡
;

256 
uöt64_t
 
	mcuºítEpoch
;

257 
uöt64_t
 
	mc⁄figEpoch
;

260 
uöt64_t
 
	moff£t
;

262 
	m£ndî
[
CLUSTER_NAMELEN
];

263 
	mmy¶Ÿs
[
CLUSTER_SLOTS
/8];

264 
	m¶aveof
[
CLUSTER_NAMELEN
];

265 
	mmyù
[
NET_IP_STR_LEN
];

266 
	mnŸu£d1
[34];

267 
uöt16_t
 
	m˝‹t
;

268 
uöt16_t
 
	mÊags
;

269 
	m°©e
;

270 
	mmÊags
[3];

271 
˛u°îMsgD©a
 
	md©a
;

272 } 
	t˛u°îMsg
;

274 
	#CLUSTERMSG_MIN_LEN
 ((
˛u°îMsg
)-(
˛u°îMsgD©a
))

	)

278 
	#CLUSTERMSG_FLAG0_PAUSED
 (1<<0Ë

	)

279 
	#CLUSTERMSG_FLAG0_FORCEACK
 (1<<1Ë

	)

283 
˛u°îNode
 *
gëNodeByQuîy
(
˛õ¡
 *
c
, 
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
hash¶Ÿ
, *
ask
);

284 
˛u°îRedúe˘BlockedClõ¡IfNìded
(
˛õ¡
 *
c
);

285 
˛u°îRedúe˘Clõ¡
(
˛õ¡
 *
c
, 
˛u°îNode
 *
n
, 
hash¶Ÿ
, 
îr‹_code
);

	@config.c

31 
	~"£rvî.h
"

32 
	~"˛u°î.h
"

34 
	~<f˙é.h
>

35 
	~<sys/°©.h
>

41 
	sc⁄figEnum
 {

42 c⁄° *
	m«me
;

43 c⁄° 
	mvÆ
;

44 } 
	tc⁄figEnum
;

46 
c⁄figEnum
 
	gmaxmem‹y_pﬁicy_íum
[] = {

47 {"vﬁ©ûe-Ãu", 
MAXMEMORY_VOLATILE_LRU
},

48 {"vﬁ©ûe-lfu", 
MAXMEMORY_VOLATILE_LFU
},

49 {"vﬁ©ûe-øndom",
MAXMEMORY_VOLATILE_RANDOM
},

50 {"vﬁ©ûe-âl",
MAXMEMORY_VOLATILE_TTL
},

51 {"Ælkeys-Ãu",
MAXMEMORY_ALLKEYS_LRU
},

52 {"Ælkeys-lfu",
MAXMEMORY_ALLKEYS_LFU
},

53 {"Ælkeys-øndom",
MAXMEMORY_ALLKEYS_RANDOM
},

54 {"n€vi˘i⁄",
MAXMEMORY_NO_EVICTION
},

55 {
NULL
, 0}

58 
c⁄figEnum
 
	gsy¶og_Ácûôy_íum
[] = {

59 {"u£r", 
LOG_USER
},

60 {"loˇl0", 
LOG_LOCAL0
},

61 {"loˇl1", 
LOG_LOCAL1
},

62 {"loˇl2", 
LOG_LOCAL2
},

63 {"loˇl3", 
LOG_LOCAL3
},

64 {"loˇl4", 
LOG_LOCAL4
},

65 {"loˇl5", 
LOG_LOCAL5
},

66 {"loˇl6", 
LOG_LOCAL6
},

67 {"loˇl7", 
LOG_LOCAL7
},

68 {
NULL
, 0}

71 
c⁄figEnum
 
	glogÀvñ_íum
[] = {

72 {"debug", 
LL_DEBUG
},

73 {"vîbo£", 
LL_VERBOSE
},

74 {"nŸi˚", 
LL_NOTICE
},

75 {"w¨nög", 
LL_WARNING
},

76 {
NULL
,0}

79 
c⁄figEnum
 
	gsu≥rvi£d_mode_íum
[] = {

80 {"up°¨t", 
SUPERVISED_UPSTART
},

81 {"sy°emd", 
SUPERVISED_SYSTEMD
},

82 {"auto", 
SUPERVISED_AUTODETECT
},

83 {"no", 
SUPERVISED_NONE
},

84 {
NULL
, 0}

87 
c⁄figEnum
 
	gaof_fsync_íum
[] = {

88 {"evîy£c", 
AOF_FSYNC_EVERYSEC
},

89 {"Æways", 
AOF_FSYNC_ALWAYS
},

90 {"no", 
AOF_FSYNC_NO
},

91 {
NULL
, 0}

94 
c⁄figEnum
 
	gª∂_diskÀss_lﬂd_íum
[] = {

95 {"dißbÀd", 
REPL_DISKLESS_LOAD_DISABLED
},

96 {"⁄-em±y-db", 
REPL_DISKLESS_LOAD_WHEN_DB_EMPTY
},

97 {"sw≠db", 
REPL_DISKLESS_LOAD_SWAPDB
},

98 {
NULL
, 0}

102 
˛õ¡Buf„rLimôsC⁄fig
 
	g˛õ¡Buf„rLimôsDeÁu…s
[
CLIENT_TYPE_OBUF_COUNT
] = {

122 
	sboﬁC⁄figD©a
 {

123 *
	mc⁄fig
;

124 c⁄° 
	mdeÁu…_vÆue
;

125 (*
	mis_vÆid_‚
)(
	mvÆ
, **
	mîr
);

126 (*
	mupd©e_‚
)(
	mvÆ
, 
	m¥ev
, **
	mîr
);

127 } 
	tboﬁC⁄figD©a
;

129 
	s°rögC⁄figD©a
 {

130 **
	mc⁄fig
;

131 c⁄° *
	mdeÁu…_vÆue
;

132 (*
	mis_vÆid_‚
)(* 
	mvÆ
, **
	mîr
);

133 (*
	mupd©e_‚
)(* 
	mvÆ
, * 
	m¥ev
, **
	mîr
);

134 
	mc⁄vît_em±y_to_nuŒ
;

136 } 
	t°rögC⁄figD©a
;

138 
	síumC⁄figD©a
 {

139 *
	mc⁄fig
;

140 
c⁄figEnum
 *
	míum_vÆue
;

141 c⁄° 
	mdeÁu…_vÆue
;

142 (*
	mis_vÆid_‚
)(
	mvÆ
, **
	mîr
);

143 (*
	mupd©e_‚
)(
	mvÆ
, 
	m¥ev
, **
	mîr
);

144 } 
	tíumC⁄figD©a
;

146 
	enumîicTy≥
 {

147 
	mNUMERIC_TYPE_INT
,

148 
	mNUMERIC_TYPE_UINT
,

149 
	mNUMERIC_TYPE_LONG
,

150 
	mNUMERIC_TYPE_ULONG
,

151 
	mNUMERIC_TYPE_LONG_LONG
,

152 
	mNUMERIC_TYPE_ULONG_LONG
,

153 
	mNUMERIC_TYPE_SIZE_T
,

154 
	mNUMERIC_TYPE_SSIZE_T
,

155 
	mNUMERIC_TYPE_OFF_T
,

156 
	mNUMERIC_TYPE_TIME_T
,

157 } 
	tnumîicTy≥
;

159 
	snumîicC⁄figD©a
 {

161 *
	mi
;

162 *
	mui
;

163 *
	ml
;

164 *
	mul
;

165 *
	mŒ
;

166 *
	muŒ
;

167 
size_t
 *
	m°
;

168 
ssize_t
 *
	ms°
;

169 
off_t
 *
	mŸ
;

170 
time_t
 *
	mâ
;

171 } 
	mc⁄fig
;

172 
	mis_mem‹y
;

173 
numîicTy≥
 
	mnumîic_ty≥
;

174 
	mlowî_bound
;

175 
	muµî_bound
;

176 c⁄° 
	mdeÁu…_vÆue
;

177 (*
	mis_vÆid_‚
)(
	mvÆ
, **
	mîr
);

178 (*
	mupd©e_‚
)(
	mvÆ
, 
	m¥ev
, **
	mîr
);

179 } 
	tnumîicC⁄figD©a
;

181 
	uty≥D©a
 {

182 
boﬁC⁄figD©a
 
	mye¢o
;

183 
°rögC⁄figD©a
 
	m°rög
;

184 
íumC⁄figD©a
 
	míumd
;

185 
numîicC⁄figD©a
 
	mnumîic
;

186 } 
	tty≥D©a
;

188 
	sty≥I¡îÁ˚
 {

190 (*
	möô
)(
ty≥D©a
 
	md©a
);

192 (*
	mlﬂd
)(
ty≥D©a
 
	md©a
, 
sds
 *
	m¨gc
, 
	m¨gv
, **
	mîr
);

195 (*
	m£t
)(
ty≥D©a
 
	md©a
, 
sds
 
	mvÆue
, 
	mupd©e
, **
	mîr
);

197 (*
	mgë
)(
˛õ¡
 *
	mc
, 
ty≥D©a
 
	md©a
);

199 (*
	mªwrôe
)(
ty≥D©a
 
	md©a
, c⁄° *
	m«me
, 
ªwrôeC⁄figSèã
 *
	m°©e
);

200 } 
	tty≥I¡îÁ˚
;

202 
	s°™d¨dC⁄fig
 {

203 c⁄° *
	m«me
;

204 c⁄° *
	mÆüs
;

205 c⁄° 
	mmodifübÀ
;

206 
ty≥I¡îÁ˚
 
	möãrÁ˚
;

207 
ty≥D©a
 
	md©a
;

208 } 
	t°™d¨dC⁄fig
;

210 
°™d¨dC⁄fig
 
	gc⁄figs
[];

217 
	$c⁄figEnumGëVÆue
(
c⁄figEnum
 *
˚
, *
«me
) {

218 
˚
->
«me
 !
NULL
) {

219 i‡(!
	`°rˇ£cmp
(
˚
->
«me
,«me)Ë ce->
vÆ
;

220 
˚
++;

222  
INT_MIN
;

223 
	}
}

226 c⁄° *
	$c⁄figEnumGëName
(
c⁄figEnum
 *
˚
, 
vÆ
) {

227 
˚
->
«me
 !
NULL
) {

228 i‡(
˚
->
vÆ
 =vÆË ce->
«me
;

229 
˚
++;

231  
NULL
;

232 
	}
}

236 c⁄° *
	$c⁄figEnumGëNameOrUnknown
(
c⁄figEnum
 *
˚
, 
vÆ
) {

237 c⁄° *
«me
 = 
	`c⁄figEnumGëName
(
˚
,
vÆ
);

238  
«me
 ?Çame : "unknown";

239 
	}
}

242 c⁄° *
	$evi˘PﬁicyToSåög
() {

243  
	`c⁄figEnumGëNameOrUnknown
(
maxmem‹y_pﬁicy_íum
,
£rvî
.
maxmem‹y_pﬁicy
);

244 
	}
}

250 
	$ye¢Ÿoi
(*
s
) {

251 i‡(!
	`°rˇ£cmp
(
s
,"yes"))  1;

252 i‡(!
	`°rˇ£cmp
(
s
,"no"))  0;

254 
	}
}

256 
	$≠≥ndSîvîSaveP¨ams
(
time_t
 
£c⁄ds
, 
ch™ges
) {

257 
£rvî
.
ßvï¨ams
 = 
	`zªÆloc
(£rvî.ßvï¨ams,(
ßvï¨am
)*(£rvî.
ßvï¨am¶í
+1));

258 
£rvî
.
ßvï¨ams
[£rvî.
ßvï¨am¶í
].
£c⁄ds
 = seconds;

259 
£rvî
.
ßvï¨ams
[£rvî.
ßvï¨am¶í
].
ch™ges
 = changes;

260 
£rvî
.
ßvï¨am¶í
++;

261 
	}
}

263 
	$ª£tSîvîSaveP¨ams
() {

264 
	`z‰ì
(
£rvî
.
ßvï¨ams
);

265 
£rvî
.
ßvï¨ams
 = 
NULL
;

266 
£rvî
.
ßvï¨am¶í
 = 0;

267 
	}
}

269 
	$queueLﬂdModuÀ
(
sds
 
∑th
, sd†*
¨gv
, 
¨gc
) {

270 
i
;

271 
moduÀLﬂdQueueE¡ry
 *
lﬂdmod
;

273 
lﬂdmod
 = 
	`zmÆloc
((
moduÀLﬂdQueueE¡ry
));

274 
lﬂdmod
->
¨gv
 = 
	`zmÆloc
((
robj
*)*
¨gc
);

275 
lﬂdmod
->
∑th
 = 
	`sd¢ew
(path);

276 
lﬂdmod
->
¨gc
 =árgc;

277 
i
 = 0; i < 
¨gc
; i++) {

278 
lﬂdmod
->
¨gv
[
i
] = 
	`¸óãRawSåögObje˘
◊rgv[i],
	`sd¶í
(argv[i]));

280 
	`li°AddNodeTaû
(
£rvî
.
lﬂdmoduÀ_queue
,
lﬂdmod
);

281 
	}
}

283 
	$öôC⁄figVÆues
() {

284 
°™d¨dC⁄fig
 *
c⁄fig
 = 
c⁄figs
; c⁄fig->
«me
 !
NULL
; config++) {

285 
c⁄fig
->
öãrÁ˚
.
	`öô
(c⁄fig->
d©a
);

287 
	}
}

289 
	$lﬂdSîvîC⁄figFromSåög
(*
c⁄fig
) {

290 *
îr
 = 
NULL
;

291 
löíum
 = 0, 
tŸlöes
, 
i
;

292 
¶aveof_löíum
 = 0;

293 
sds
 *
löes
;

295 
löes
 = 
	`sds•lôÀn
(
c⁄fig
,
	`°æí
(c⁄fig),"\n",1,&
tŸlöes
);

297 
i
 = 0; i < 
tŸlöes
; i++) {

298 
sds
 *
¨gv
;

299 
¨gc
;

301 
löíum
 = 
i
+1;

302 
löes
[
i
] = 
	`sd°rim
(lines[i]," \t\r\n");

305 i‡(
löes
[
i
][0] == '#' ||Üines[i][0] == '\0') ;

308 
¨gv
 = 
	`sds•lô¨gs
(
löes
[
i
],&
¨gc
);

309 i‡(
¨gv
 =
NULL
) {

310 
îr
 = "Unbalanced quotes in configurationÜine";

311 
lﬂdîr
;

315 i‡(
¨gc
 == 0) {

316 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

319 
	`sd°ﬁowî
(
¨gv
[0]);

322 
m©ch
 = 0;

323 
°™d¨dC⁄fig
 *
c⁄fig
 = 
c⁄figs
; c⁄fig->
«me
 !
NULL
; config++) {

324 i‡((!
	`°rˇ£cmp
(
¨gv
[0],
c⁄fig
->
«me
) ||

325 (
c⁄fig
->
Æüs
 && !
	`°rˇ£cmp
(
¨gv
[0],config->alias))))

327 i‡(
¨gc
 != 2) {

328 
îr
 = "wrongÇumber ofárguments";

329 
lﬂdîr
;

331 i‡(!
c⁄fig
->
öãrÁ˚
.
	`£t
(c⁄fig->
d©a
, 
¨gv
[1], 0, &
îr
)) {

332 
lﬂdîr
;

335 
m©ch
 = 1;

340 i‡(
m©ch
) {

341 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

346 i‡(!
	`°rˇ£cmp
(
¨gv
[0],"böd"Ë&& 
¨gc
 >= 2) {

347 
j
, 
addªs£s
 = 
¨gc
-1;

349 i‡(
addªs£s
 > 
CONFIG_BINDADDR_MAX
) {

350 
îr
 = "Toÿm™y bödáddªs£†•ecifõd"; 
lﬂdîr
;

353 
j
 = 0; j < 
£rvî
.
bödaddr_cou¡
; j++) {

354 
	`z‰ì
(
£rvî
.
bödaddr
[
j
]);

356 
j
 = 0; j < 
addªs£s
; j++)

357 
£rvî
.
bödaddr
[
j
] = 
	`z°rdup
(
¨gv
[j+1]);

358 
£rvî
.
bödaddr_cou¡
 = 
addªs£s
;

359 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"unixsockë≥rm"Ë&& 
¨gc
 == 2) {

360 
î∫o
 = 0;

361 
£rvî
.
unixsockë≥rm
 = (
mode_t
)
	`°πﬁ
(
¨gv
[1], 
NULL
, 8);

362 i‡(
î∫o
 || 
£rvî
.
unixsockë≥rm
 > 0777) {

363 
îr
 = "InvÆid sockë fûê≥rmissi⁄s"; 
lﬂdîr
;

365 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"save")) {

366 i‡(
¨gc
 == 3) {

367 
£c⁄ds
 = 
	`©oi
(
¨gv
[1]);

368 
ch™ges
 = 
	`©oi
(
¨gv
[2]);

369 i‡(
£c⁄ds
 < 1 || 
ch™ges
 < 0) {

370 
îr
 = "InvÆid savê∑ømëîs"; 
lﬂdîr
;

372 
	`≠≥ndSîvîSaveP¨ams
(
£c⁄ds
,
ch™ges
);

373 } i‡(
¨gc
 =2 && !
	`°rˇ£cmp
(
¨gv
[1],"")) {

374 
	`ª£tSîvîSaveP¨ams
();

376 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"dú"Ë&& 
¨gc
 == 2) {

377 i‡(
	`chdú
(
¨gv
[1]) == -1) {

378 
	`£rvîLog
(
LL_WARNING
,"Can't chdirÅo '%s': %s",

379 
¨gv
[1], 
	`°ªº‹
(
î∫o
));

380 
	`exô
(1);

382 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"logfûe"Ë&& 
¨gc
 == 2) {

383 
FILE
 *
logÂ
;

385 
	`z‰ì
(
£rvî
.
logfûe
);

386 
£rvî
.
logfûe
 = 
	`z°rdup
(
¨gv
[1]);

387 i‡(
£rvî
.
logfûe
[0] != '\0') {

390 
logÂ
 = 
	`f›í
(
£rvî
.
logfûe
,"a");

391 i‡(
logÂ
 =
NULL
) {

392 
îr
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

393 "C™'à›íÅhêlog fûe: %s", 
	`°ªº‹
(
î∫o
));

394 
lﬂdîr
;

396 
	`f˛o£
(
logÂ
);

398 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"ö˛ude"Ë&& 
¨gc
 == 2) {

399 
	`lﬂdSîvîC⁄fig
(
¨gv
[1],
NULL
);

400 } i‡((!
	`°rˇ£cmp
(
¨gv
[0],"˛õ¡-quîy-buf„r-limô")Ë&& 
¨gc
 == 2) {

401 
£rvî
.
˛õ¡_max_quîybuf_Àn
 = 
	`memtﬁl
(
¨gv
[1],
NULL
);

402 } i‡((!
	`°rˇ£cmp
(
¨gv
[0],"slaveof") ||

403 !
	`°rˇ£cmp
(
¨gv
[0],"ª∂iˇof")Ë&& 
¨gc
 == 3) {

404 
¶aveof_löíum
 = 
löíum
;

405 
£rvî
.
ma°îho°
 = 
	`sd¢ew
(
¨gv
[1]);

406 
£rvî
.
ma°îp‹t
 = 
	`©oi
(
¨gv
[2]);

407 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_CONNECT
;

408 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"ªquúïass"Ë&& 
¨gc
 == 2) {

409 i‡(
	`°æí
(
¨gv
[1]Ë> 
CONFIG_AUTHPASS_MAX_LEN
) {

410 
îr
 = "Password isÜongerÅhan CONFIG_AUTHPASS_MAX_LEN";

411 
lﬂdîr
;

417 
	`ACLSëU£r
(
DeÁu…U£r
,"resetpass",-1);

418 
sds
 
a˛›
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),">%s",
¨gv
[1]);

419 
	`ACLSëU£r
(
DeÁu…U£r
,
a˛›
,
	`sd¶í
(aclop));

420 
	`sds‰ì
(
a˛›
);

421 
	`sds‰ì
(
£rvî
.
ªquúïass
);

422 
£rvî
.
ªquúïass
 = 
	`sd¢ew
(
¨gv
[1]);

423 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"li°-max-zùli°-íåõs"Ë&& 
¨gc
 == 2){

425 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"li°-max-zùli°-vÆue"Ë&& 
¨gc
 == 2) {

427 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"ª«me-comm™d"Ë&& 
¨gc
 == 3) {

428 
ªdisComm™d
 *
cmd
 = 
	`lookupComm™d
(
¨gv
[1]);

429 
ªtvÆ
;

431 i‡(!
cmd
) {

432 
îr
 = "No such command inÑename-command";

433 
lﬂdîr
;

438 
ªtvÆ
 = 
	`di˘Dñëe
(
£rvî
.
comm™ds
, 
¨gv
[1]);

439 
	`£rvîAs£π
(
ªtvÆ
 =
DICT_OK
);

442 i‡(
	`sd¶í
(
¨gv
[2]) != 0) {

443 
sds
 
c›y
 = 
	`sdsdup
(
¨gv
[2]);

445 
ªtvÆ
 = 
	`di˘Add
(
£rvî
.
comm™ds
, 
c›y
, 
cmd
);

446 i‡(
ªtvÆ
 !
DICT_OK
) {

447 
	`sds‰ì
(
c›y
);

448 
îr
 = "T¨gë comm™dÇamêÆªadyÉxi°s"; 
lﬂdîr
;

451 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"˛u°î-c⁄fig-fûe"Ë&& 
¨gc
 == 2) {

452 
	`z‰ì
(
£rvî
.
˛u°î_c⁄figfûe
);

453 
£rvî
.
˛u°î_c⁄figfûe
 = 
	`z°rdup
(
¨gv
[1]);

454 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"client-output-buffer-limit") &&

455 
¨gc
 == 5)

457 
˛ass
 = 
	`gëClõ¡Ty≥ByName
(
¨gv
[1]);

458 
h¨d
, 
so·
;

459 
so·_£c⁄ds
;

461 i‡(
˛ass
 =-1 || cœs†=
CLIENT_TYPE_MASTER
) {

462 
îr
 = "Unrecognized clientÜimit class:Åhe user specified "

464 
lﬂdîr
;

466 
h¨d
 = 
	`memtﬁl
(
¨gv
[2],
NULL
);

467 
so·
 = 
	`memtﬁl
(
¨gv
[3],
NULL
);

468 
so·_£c⁄ds
 = 
	`©oi
(
¨gv
[4]);

469 i‡(
so·_£c⁄ds
 < 0) {

470 
îr
 = "NegativeÇumber of seconds in softÜimit is invalid";

471 
lﬂdîr
;

473 
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
h¨d_limô_byãs
 = 
h¨d
;

474 
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
so·_limô_byãs
 = 
so·
;

475 
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
so·_limô_£c⁄ds
 = 
so·_£c⁄ds
;

476 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"nŸify-key•a˚-evíts"Ë&& 
¨gc
 == 2) {

477 
Êags
 = 
	`key•a˚EvítsSåögToFœgs
(
¨gv
[1]);

479 i‡(
Êags
 == -1) {

480 
îr
 = "InvalidÉvent class character. Use 'g$lshzxeA'.";

481 
lﬂdîr
;

483 
£rvî
.
nŸify_key•a˚_evíts
 = 
Êags
;

484 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"u£r"Ë&& 
¨gc
 >= 2) {

485 
¨gc_îr
;

486 i‡(
	`ACLAµídU£rF‹Lﬂdög
(
¨gv
,
¨gc
,&
¨gc_îr
Ë=
C_ERR
) {

487 
buf
[1024];

488 *
îrmsg
 = 
	`ACLSëU£rSåögEº‹
();

489 
	`¢¥ötf
(
buf
,(buf),"Error in user declaration '%s': %s",

490 
¨gv
[
¨gc_îr
],
îrmsg
);

491 
îr
 = 
buf
;

492 
lﬂdîr
;

494 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"lﬂdmoduÀ"Ë&& 
¨gc
 >= 2) {

495 
	`queueLﬂdModuÀ
(
¨gv
[1],&¨gv[2],
¨gc
-2);

496 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"sentinel")) {

499 i‡(
¨gc
 != 1) {

500 i‡(!
£rvî
.
£¡öñ_mode
) {

501 
îr
 = "sentinel directive whileÇot in sentinel mode";

502 
lﬂdîr
;

504 
îr
 = 
	`£¡öñH™dÀC⁄figuøti⁄
(
¨gv
+1,
¨gc
-1);

505 i‡(
îr
Ë
lﬂdîr
;

508 
îr
 = "Bad dúe˘ivê‹ wr⁄gÇumbî o‡¨gumíts"; 
lﬂdîr
;

510 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

514 i‡(
£rvî
.
˛u°î_íabÀd
 && sîvî.
ma°îho°
) {

515 
löíum
 = 
¶aveof_löíum
;

516 
i
 = 
löíum
-1;

517 
îr
 = "replicaof directiveÇotállowed in cluster mode";

518 
lﬂdîr
;

521 
	`sds‰ì•lôªs
(
löes
,
tŸlöes
);

524 
lﬂdîr
:

525 
	`Ârötf
(
°dîr
, "\n*** FATAL CONFIG FILE ERROR (Redis %s) ***\n",

526 
REDIS_VERSION
);

527 
	`Ârötf
(
°dîr
, "RódögÅhêc⁄figuøti⁄ fûe,áàlöê%d\n", 
löíum
);

528 
	`Ârötf
(
°dîr
, ">>> '%s'\n", 
löes
[
i
]);

529 
	`Ârötf
(
°dîr
, "%s\n", 
îr
);

530 
	`exô
(1);

531 
	}
}

540 
	$lﬂdSîvîC⁄fig
(*
fûíame
, *
›ti⁄s
) {

541 
sds
 
c⁄fig
 = 
	`sd£m±y
();

542 
buf
[
CONFIG_MAX_LINE
+1];

545 i‡(
fûíame
) {

546 
FILE
 *
Â
;

548 i‡(
fûíame
[0] == '-' && filename[1] == '\0') {

549 
Â
 = 
°dö
;

551 i‡((
Â
 = 
	`f›í
(
fûíame
,"r")Ë=
NULL
) {

552 
	`£rvîLog
(
LL_WARNING
,

553 "F©ÆÉº‹, c™'à›í c⁄fig fûê'%s'", 
fûíame
);

554 
	`exô
(1);

557 
	`fgës
(
buf
,
CONFIG_MAX_LINE
+1,
Â
Ë!
NULL
)

558 
c⁄fig
 = 
	`sdsˇt
(c⁄fig,
buf
);

559 i‡(
Â
 !
°dö
Ë
	`f˛o£
(fp);

562 i‡(
›ti⁄s
) {

563 
c⁄fig
 = 
	`sdsˇt
(config,"\n");

564 
c⁄fig
 = 
	`sdsˇt
(c⁄fig,
›ti⁄s
);

566 
	`lﬂdSîvîC⁄figFromSåög
(
c⁄fig
);

567 
	`sds‰ì
(
c⁄fig
);

568 
	}
}

574 
	#c⁄fig_£t_boﬁ_fõld
(
_«me
,
_v¨
) \

575 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,
_«me
)) { \

576 
yn
 = 
	`ye¢Ÿoi
(
o
->
±r
); \

577 i‡(
yn
 =-1Ë
badfmt
; \

578 
_v¨
 = 
yn
;

	)

580 
	#c⁄fig_£t_numîiˇl_fõld
(
_«me
,
_v¨
,
mö
,
max
) \

581 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,
_«me
)) { \

582 i‡(
	`gëL⁄gL⁄gFromObje˘
(
o
,&
Œ
Ë=
C_ERR
Ë
badfmt
; \

583 i‡(
mö
 !
LLONG_MIN
 && 
Œ
 < möË
badfmt
; \

584 i‡(
max
 !
LLONG_MAX
 && 
Œ
 > maxË
badfmt
; \

585 
_v¨
 = 
Œ
;

	)

587 
	#c⁄fig_£t_mem‹y_fõld
(
_«me
,
_v¨
) \

588 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,
_«me
)) { \

589 
Œ
 = 
	`memtﬁl
(
o
->
±r
,&
îr
); \

590 i‡(
îr
 || 
Œ
 < 0Ë
badfmt
; \

591 
_v¨
 = 
Œ
;

	)

593 
	#c⁄fig_£t_•ecül_fõld
(
_«me
) \

594 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,
_«me
)Ë{

	)

596 
	#c⁄fig_£t_•ecül_fõld_wôh_Æüs
(
_«me1
,
_«me2
) \

597 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,
_«me1
) || \

598 !
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,
_«me2
)Ë{

	)

600 
	#c⁄fig_£t_ñ£
 } 

	)

602 
	$c⁄figSëComm™d
(
˛õ¡
 *
c
) {

603 
robj
 *
o
;

604 
Œ
;

605 
îr
;

606 *
îr°r
 = 
NULL
;

607 
	`£rvîAs£πWôhInfo
(
c
,c->
¨gv
[2],
	`sdsEncodedObje˘
(c->argv[2]));

608 
	`£rvîAs£πWôhInfo
(
c
,c->
¨gv
[3],
	`sdsEncodedObje˘
(c->argv[3]));

609 
o
 = 
c
->
¨gv
[3];

612 
°™d¨dC⁄fig
 *
c⁄fig
 = 
c⁄figs
; c⁄fig->
«me
 !
NULL
; config++) {

613 if(
c⁄fig
->
modifübÀ
 && (!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,c⁄fig->
«me
) ||

614 (
c⁄fig
->
Æüs
 && !
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,config->alias))))

616 i‡(!
c⁄fig
->
öãrÁ˚
.
	`£t
(c⁄fig->
d©a
,
o
->
±r
,1,&
îr°r
)) {

617 
badfmt
;

619 
	`addRïly
(
c
,
sh¨ed
.
ok
);

627 
	`c⁄fig_£t_•ecül_fõld
("requirepass") {

628 i‡(
	`sd¶í
(
o
->
±r
Ë> 
CONFIG_AUTHPASS_MAX_LEN
Ë
badfmt
;

633 
	`ACLSëU£r
(
DeÁu…U£r
,"resetpass",-1);

634 
sds
 
a˛›
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),">%s",(*)
o
->
±r
);

635 
	`ACLSëU£r
(
DeÁu…U£r
,
a˛›
,
	`sd¶í
(aclop));

636 
	`sds‰ì
(
a˛›
);

637 
	`sds‰ì
(
£rvî
.
ªquúïass
);

638 
£rvî
.
ªquúïass
 = 
	`sd¢ew
(
o
->
±r
);

639 } 
	`c⁄fig_£t_•ecül_fõld
("save") {

640 
vÀn
, 
j
;

641 
sds
 *
v
 = 
	`sds•lôÀn
(
o
->
±r
,
	`sd¶í
(o->±r)," ",1,&
vÀn
);

646 i‡(
vÀn
 & 1) {

647 
	`sds‰ì•lôªs
(
v
,
vÀn
);

648 
badfmt
;

650 
j
 = 0; j < 
vÀn
; j++) {

651 *
ïå
;

652 
vÆ
;

654 
vÆ
 = 
	`°πﬁl
(
v
[
j
], &
ïå
, 10);

655 i‡(
ïå
[0] != '\0' ||

656 ((
j
 & 1Ë=0 && 
vÆ
 < 1) ||

657 ((
j
 & 1Ë=1 && 
vÆ
 < 0)) {

658 
	`sds‰ì•lôªs
(
v
,
vÀn
);

659 
badfmt
;

663 
	`ª£tSîvîSaveP¨ams
();

664 
j
 = 0; j < 
vÀn
; j += 2) {

665 
time_t
 
£c⁄ds
;

666 
ch™ges
;

668 
£c⁄ds
 = 
	`°πﬁl
(
v
[
j
],
NULL
,10);

669 
ch™ges
 = 
	`°πﬁl
(
v
[
j
+1],
NULL
,10);

670 
	`≠≥ndSîvîSaveP¨ams
(
£c⁄ds
, 
ch™ges
);

672 
	`sds‰ì•lôªs
(
v
,
vÀn
);

673 } 
	`c⁄fig_£t_•ecül_fõld
("dir") {

674 i‡(
	`chdú
((*)
o
->
±r
) == -1) {

675 
	`addRïlyEº‹F‹m©
(
c
,"Ch™gög dúe˘‹y: %s", 
	`°ªº‹
(
î∫o
));

678 } 
	`c⁄fig_£t_•ecül_fõld
("client-output-buffer-limit") {

679 
vÀn
, 
j
;

680 
sds
 *
v
 = 
	`sds•lôÀn
(
o
->
±r
,
	`sd¶í
(o->±r)," ",1,&
vÀn
);

683 i‡(
vÀn
 % 4) {

684 
	`sds‰ì•lôªs
(
v
,
vÀn
);

685 
badfmt
;

691 
j
 = 0; j < 
vÀn
; j++) {

692 
vÆ
;

694 i‡((
j
 % 4) == 0) {

695 
˛ass
 = 
	`gëClõ¡Ty≥ByName
(
v
[
j
]);

696 i‡(
˛ass
 =-1 || cœs†=
CLIENT_TYPE_MASTER
) {

697 
	`sds‰ì•lôªs
(
v
,
vÀn
);

698 
badfmt
;

701 
vÆ
 = 
	`memtﬁl
(
v
[
j
], &
îr
);

702 i‡(
îr
 || 
vÆ
 < 0) {

703 
	`sds‰ì•lôªs
(
v
,
vÀn
);

704 
badfmt
;

709 
j
 = 0; j < 
vÀn
; j += 4) {

710 
˛ass
;

711 
h¨d
, 
so·
;

712 
so·_£c⁄ds
;

714 
˛ass
 = 
	`gëClõ¡Ty≥ByName
(
v
[
j
]);

715 
h¨d
 = 
	`memtﬁl
(
v
[
j
+1],
NULL
);

716 
so·
 = 
	`memtﬁl
(
v
[
j
+2],
NULL
);

717 
so·_£c⁄ds
 = 
	`°πﬁl
(
v
[
j
+3],
NULL
,10);

719 
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
h¨d_limô_byãs
 = 
h¨d
;

720 
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
so·_limô_byãs
 = 
so·
;

721 
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
so·_limô_£c⁄ds
 = 
so·_£c⁄ds
;

723 
	`sds‰ì•lôªs
(
v
,
vÀn
);

724 } 
	`c⁄fig_£t_•ecül_fõld
("notify-keyspace-events") {

725 
Êags
 = 
	`key•a˚EvítsSåögToFœgs
(
o
->
±r
);

727 i‡(
Êags
 =-1Ë
badfmt
;

728 
£rvî
.
nŸify_key•a˚_evíts
 = 
Êags
;

731 } 
	`c⁄fig_£t_numîiˇl_fõld
(

732 "w©chdog-≥riod",
Œ
,0,
INT_MAX
) {

733 i‡(
Œ
)

734 
	`íabÀW©chdog
(
Œ
);

736 
	`dißbÀW©chdog
();

739 } 
	`c⁄fig_£t_mem‹y_fõld
(

740 "˛õ¡-quîy-buf„r-limô",
£rvî
.
˛õ¡_max_quîybuf_Àn
) {

742 } 
c⁄fig_£t_ñ£
 {

743 
	`addRïlyEº‹F‹m©
(
c
,"Unsupported CONFIGÖarameter: %s",

744 (*)
c
->
¨gv
[2]->
±r
);

749 
	`addRïly
(
c
,
sh¨ed
.
ok
);

752 
badfmt
:

753 i‡(
îr°r
) {

754 
	`addRïlyEº‹F‹m©
(
c
,"Invalidárgument '%s' for CONFIG SET '%s' - %s",

755 (*)
o
->
±r
,

756 (*)
c
->
¨gv
[2]->
±r
,

757 
îr°r
);

759 
	`addRïlyEº‹F‹m©
(
c
,"Invalidárgument '%s' for CONFIG SET '%s'",

760 (*)
o
->
±r
,

761 (*)
c
->
¨gv
[2]->
±r
);

769 
	#c⁄fig_gë_°rög_fõld
(
_«me
,
_v¨
) do { \

770 i‡(
	`°rögm©ch
(
∑âîn
,
_«me
,1)) { \

771 
	`addRïlyBulkCSåög
(
c
,
_«me
); \

772 
	`addRïlyBulkCSåög
(
c
,
_v¨
 ? _var : ""); \

773 
m©ches
++; \

775 } 0);

	)

777 
	#c⁄fig_gë_boﬁ_fõld
(
_«me
,
_v¨
) do { \

778 i‡(
	`°rögm©ch
(
∑âîn
,
_«me
,1)) { \

779 
	`addRïlyBulkCSåög
(
c
,
_«me
); \

780 
	`addRïlyBulkCSåög
(
c
,
_v¨
 ? "yes" : "no"); \

781 
m©ches
++; \

783 } 0);

	)

785 
	#c⁄fig_gë_numîiˇl_fõld
(
_«me
,
_v¨
) do { \

786 i‡(
	`°rögm©ch
(
∑âîn
,
_«me
,1)) { \

787 
	`Œ2°rög
(
buf
,(buf),
_v¨
); \

788 
	`addRïlyBulkCSåög
(
c
,
_«me
); \

789 
	`addRïlyBulkCSåög
(
c
,
buf
); \

790 
m©ches
++; \

792 } 0);

	)

795 
	`c⁄figGëComm™d
(
˛õ¡
 *
c
) {

796 
robj
 *
o
 = 
c
->
¨gv
[2];

797 *
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

798 *
∑âîn
 = 
o
->
±r
;

799 
buf
[128];

800 
m©ches
 = 0;

801 
	`£rvîAs£πWôhInfo
(
c
,
o
,
	`sdsEncodedObje˘
(o));

804 
°™d¨dC⁄fig
 *
c⁄fig
 = 
c⁄figs
; c⁄fig->
«me
 !
NULL
; config++) {

805 i‡(
	`°rögm©ch
(
∑âîn
,
c⁄fig
->
«me
,1)) {

806 
	`addRïlyBulkCSåög
(
c
,
c⁄fig
->
«me
);

807 
c⁄fig
->
öãrÁ˚
.
	`gë
(
c
,c⁄fig->
d©a
);

808 
m©ches
++;

810 i‡(
c⁄fig
->
Æüs
 && 
	`°rögm©ch
(
∑âîn
,config->alias,1)) {

811 
	`addRïlyBulkCSåög
(
c
,
c⁄fig
->
Æüs
);

812 
c⁄fig
->
öãrÁ˚
.
	`gë
(
c
,c⁄fig->
d©a
);

813 
m©ches
++;

818 
	`c⁄fig_gë_°rög_fõld
("logfûe",
£rvî
.
logfûe
);

821 
	`c⁄fig_gë_numîiˇl_fõld
("˛õ¡-quîy-buf„r-limô",
£rvî
.
˛õ¡_max_quîybuf_Àn
);

822 
	`c⁄fig_gë_numîiˇl_fõld
("w©chdog-≥riod",
£rvî
.
w©chdog_≥riod
);

826 i‡(
	`°rögm©ch
(
∑âîn
,"dir",1)) {

827 
buf
[1024];

829 i‡(
	`gëcwd
(
buf
,(buf)Ë=
NULL
)

830 
buf
[0] = '\0';

832 
	`addRïlyBulkCSåög
(
c
,"dir");

833 
	`addRïlyBulkCSåög
(
c
,
buf
);

834 
m©ches
++;

836 i‡(
	`°rögm©ch
(
∑âîn
,"save",1)) {

837 
sds
 
buf
 = 
	`sd£m±y
();

838 
j
;

840 
j
 = 0; j < 
£rvî
.
ßvï¨am¶í
; j++) {

841 
buf
 = 
	`sdsˇçrötf
(buf,"%jd %d",

842 (
ötmax_t
)
£rvî
.
ßvï¨ams
[
j
].
£c⁄ds
,

843 
£rvî
.
ßvï¨ams
[
j
].
ch™ges
);

844 i‡(
j
 !
£rvî
.
ßvï¨am¶í
-1)

845 
buf
 = 
	`sdsˇéí
(buf," ",1);

847 
	`addRïlyBulkCSåög
(
c
,"save");

848 
	`addRïlyBulkCSåög
(
c
,
buf
);

849 
	`sds‰ì
(
buf
);

850 
m©ches
++;

852 i‡(
	`°rögm©ch
(
∑âîn
,"client-output-buffer-limit",1)) {

853 
sds
 
buf
 = 
	`sd£m±y
();

854 
j
;

856 
j
 = 0; j < 
CLIENT_TYPE_OBUF_COUNT
; j++) {

857 
buf
 = 
	`sdsˇçrötf
(buf,"%s %llu %llu %ld",

858 
	`gëClõ¡Ty≥Name
(
j
),

859 
£rvî
.
˛õ¡_obuf_limôs
[
j
].
h¨d_limô_byãs
,

860 
£rvî
.
˛õ¡_obuf_limôs
[
j
].
so·_limô_byãs
,

861 (Ë
£rvî
.
˛õ¡_obuf_limôs
[
j
].
so·_limô_£c⁄ds
);

862 i‡(
j
 !
CLIENT_TYPE_OBUF_COUNT
-1)

863 
buf
 = 
	`sdsˇéí
(buf," ",1);

865 
	`addRïlyBulkCSåög
(
c
,"client-output-buffer-limit");

866 
	`addRïlyBulkCSåög
(
c
,
buf
);

867 
	`sds‰ì
(
buf
);

868 
m©ches
++;

870 i‡(
	`°rögm©ch
(
∑âîn
,"unixsocketperm",1)) {

871 
buf
[32];

872 
	`¢¥ötf
(
buf
,(buf),"%o",
£rvî
.
unixsockë≥rm
);

873 
	`addRïlyBulkCSåög
(
c
,"unixsocketperm");

874 
	`addRïlyBulkCSåög
(
c
,
buf
);

875 
m©ches
++;

877 i‡(
	`°rögm©ch
(
∑âîn
,"slaveof",1) ||

878 
	`°rögm©ch
(
∑âîn
,"replicaof",1))

880 *
›äame
 = 
	`°rögm©ch
(
∑âîn
,"slaveof",1) ?

882 
buf
[256];

884 
	`addRïlyBulkCSåög
(
c
,
›äame
);

885 i‡(
£rvî
.
ma°îho°
)

886 
	`¢¥ötf
(
buf
,(buf),"%s %d",

887 
£rvî
.
ma°îho°
, sîvî.
ma°îp‹t
);

889 
buf
[0] = '\0';

890 
	`addRïlyBulkCSåög
(
c
,
buf
);

891 
m©ches
++;

893 i‡(
	`°rögm©ch
(
∑âîn
,"notify-keyspace-events",1)) {

894 
sds
 
Êags
 = 
	`key•a˚EvítsFœgsToSåög
(
£rvî
.
nŸify_key•a˚_evíts
);

896 
	`addRïlyBulkCSåög
(
c
,"notify-keyspace-events");

897 
	`addRïlyBulkSds
(
c
,
Êags
);

898 
m©ches
++;

900 i‡(
	`°rögm©ch
(
∑âîn
,"bind",1)) {

901 
sds
 
aux
 = 
	`sdsjoö
(
£rvî
.
bödaddr
,£rvî.
bödaddr_cou¡
," ");

903 
	`addRïlyBulkCSåög
(
c
,"bind");

904 
	`addRïlyBulkCSåög
(
c
,
aux
);

905 
	`sds‰ì
(
aux
);

906 
m©ches
++;

908 i‡(
	`°rögm©ch
(
∑âîn
,"requirepass",1)) {

909 
	`addRïlyBulkCSåög
(
c
,"requirepass");

910 
sds
 
∑ssw‹d
 = 
£rvî
.
ªquúïass
;

911 i‡(
∑ssw‹d
) {

912 
	`addRïlyBulkCBuf„r
(
c
,
∑ssw‹d
,
	`sd¶í
(password));

914 
	`addRïlyBulkCSåög
(
c
,"");

916 
m©ches
++;

919 
	`£tDe„ºedM≠Lí
(
c
,
ª∂yÀn
,
m©ches
);

926 
	#REDIS_CONFIG_REWRITE_SIGNATURE
 "# Gíî©ed by CONFIG REWRITE"

	)

931 
uöt64_t
 
	`di˘SdsCa£Hash
(c⁄° *
key
);

932 
	`di˘SdsKeyCa£Com∑ª
(*
¥ivd©a
, c⁄° *
key1
, c⁄° *
key2
);

933 
	`di˘SdsDe°ru˘‹
(*
¥ivd©a
, *
vÆ
);

934 
	`di˘Li°De°ru˘‹
(*
¥ivd©a
, *
vÆ
);

938 
	`ªwrôeC⁄figSítöñO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
);

940 
di˘Ty≥
 
›ti⁄ToLöeDi˘Ty≥
 = {

941 
di˘SdsCa£Hash
,

942 
NULL
,

943 
NULL
,

944 
di˘SdsKeyCa£Com∑ª
,

945 
di˘SdsDe°ru˘‹
,

946 
di˘Li°De°ru˘‹


949 
di˘Ty≥
 
›ti⁄SëDi˘Ty≥
 = {

950 
di˘SdsCa£Hash
,

951 
NULL
,

952 
NULL
,

953 
di˘SdsKeyCa£Com∑ª
,

954 
di˘SdsDe°ru˘‹
,

955 
NULL


959 
	sªwrôeC⁄figSèã
 {

960 
di˘
 *
›ti⁄_to_löe
;

961 
di˘
 *
ªwrôãn
;

962 
numlöes
;

963 
sds
 *
löes
;

964 
has_èû
;

969 
	`ªwrôeC⁄figAµídLöe
(
ªwrôeC⁄figSèã
 *
°©e
, 
sds
 
löe
) {

970 
°©e
->
löes
 = 
	`zªÆloc
(°©e->löes, (*Ë* (°©e->
numlöes
+1));

971 
°©e
->
löes
[°©e->
numlöes
++] = 
löe
;

975 
	`ªwrôeC⁄figAddLöeNumbîToO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
, 
sds
 
›ti⁄
, 
löíum
) {

976 
li°
 *
l
 = 
	`di˘FëchVÆue
(
°©e
->
›ti⁄_to_löe
,
›ti⁄
);

978 i‡(
l
 =
NULL
) {

979 
l
 = 
	`li°Cª©e
();

980 
	`di˘Add
(
°©e
->
›ti⁄_to_löe
,
	`sdsdup
(
›ti⁄
),
l
);

982 
	`li°AddNodeTaû
(
l
,(*)()
löíum
);

989 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
ªwrôeC⁄figSèã
 *
°©e
, c⁄° *
›ti⁄
) {

990 
sds
 
›t
 = 
	`sd¢ew
(
›ti⁄
);

992 i‡(
	`di˘Add
(
°©e
->
ªwrôãn
,
›t
,
NULL
Ë!
DICT_OK
Ë
	`sds‰ì
(opt);

1000 
ªwrôeC⁄figSèã
 *
	`ªwrôeC⁄figRódOldFûe
(*
∑th
) {

1001 
FILE
 *
Â
 = 
	`f›í
(
∑th
,"r");

1002 i‡(
Â
 =
NULL
 && 
î∫o
 !
ENOENT
)  NULL;

1004 
buf
[
CONFIG_MAX_LINE
+1];

1005 
löíum
 = -1;

1006 
ªwrôeC⁄figSèã
 *
°©e
 = 
	`zmÆloc
((*state));

1007 
°©e
->
›ti⁄_to_löe
 = 
	`di˘Cª©e
(&
›ti⁄ToLöeDi˘Ty≥
,
NULL
);

1008 
°©e
->
ªwrôãn
 = 
	`di˘Cª©e
(&
›ti⁄SëDi˘Ty≥
,
NULL
);

1009 
°©e
->
numlöes
 = 0;

1010 
°©e
->
löes
 = 
NULL
;

1011 
°©e
->
has_èû
 = 0;

1012 i‡(
Â
 =
NULL
Ë 
°©e
;

1015 
	`fgës
(
buf
,
CONFIG_MAX_LINE
+1,
Â
Ë!
NULL
) {

1016 
¨gc
;

1017 
sds
 *
¨gv
;

1018 
sds
 
löe
 = 
	`sd°rim
(
	`sd¢ew
(
buf
),"\r\n\t ");

1020 
löíum
++;

1023 i‡(
löe
[0] == '#' ||Üine[0] == '\0') {

1024 i‡(!
°©e
->
has_èû
 && !
	`°rcmp
(
löe
,
REDIS_CONFIG_REWRITE_SIGNATURE
))

1025 
°©e
->
has_èû
 = 1;

1026 
	`ªwrôeC⁄figAµídLöe
(
°©e
,
löe
);

1031 
¨gv
 = 
	`sds•lô¨gs
(
löe
,&
¨gc
);

1032 i‡(
¨gv
 =
NULL
) {

1036 
sds
 
aux
 = 
	`sd¢ew
("# ??? ");

1037 
aux
 = 
	`sdsˇtsds
◊ux,
löe
);

1038 
	`sds‰ì
(
löe
);

1039 
	`ªwrôeC⁄figAµídLöe
(
°©e
,
aux
);

1043 
	`sd°ﬁowî
(
¨gv
[0]);

1047 
	`ªwrôeC⁄figAµídLöe
(
°©e
,
löe
);

1052 *
p
 = 
	`°r°r
(
¨gv
[0],"slave");

1053 i‡(
p
) {

1054 
sds
 
Æt
 = 
	`sd£m±y
();

1055 
Æt
 = 
	`sdsˇéí
◊…,
¨gv
[0],
p
-argv[0]);;

1056 
Æt
 = 
	`sdsˇéí
(alt,"replica",7);

1057 
Æt
 = 
	`sdsˇéí
◊…,
p
+5,
	`°æí
(p+5));

1058 
	`sds‰ì
(
¨gv
[0]);

1059 
¨gv
[0] = 
Æt
;

1061 
	`ªwrôeC⁄figAddLöeNumbîToO±i⁄
(
°©e
,
¨gv
[0],
löíum
);

1062 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

1064 
	`f˛o£
(
Â
);

1065  
°©e
;

1084 
	`ªwrôeC⁄figRewrôeLöe
(
ªwrôeC⁄figSèã
 *
°©e
, c⁄° *
›ti⁄
, 
sds
 
löe
, 
f‹˚
) {

1085 
sds
 
o
 = 
	`sd¢ew
(
›ti⁄
);

1086 
li°
 *
l
 = 
	`di˘FëchVÆue
(
°©e
->
›ti⁄_to_löe
,
o
);

1088 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
°©e
,
›ti⁄
);

1090 i‡(!
l
 && !
f‹˚
) {

1092 
	`sds‰ì
(
löe
);

1093 
	`sds‰ì
(
o
);

1097 i‡(
l
) {

1098 
li°Node
 *
 
 = 
	`li°Fú°
(
l
);

1099 
löíum
 = (Ë
 
->
vÆue
;

1103 
	`li°DñNode
(
l
,
 
);

1104 i‡(
	`li°Lígth
(
l
Ë=0Ë
	`di˘Dñëe
(
°©e
->
›ti⁄_to_löe
,
o
);

1105 
	`sds‰ì
(
°©e
->
löes
[
löíum
]);

1106 
°©e
->
löes
[
löíum
] = 
löe
;

1109 i‡(!
°©e
->
has_èû
) {

1110 
	`ªwrôeC⁄figAµídLöe
(
°©e
,

1111 
	`sd¢ew
(
REDIS_CONFIG_REWRITE_SIGNATURE
));

1112 
°©e
->
has_èû
 = 1;

1114 
	`ªwrôeC⁄figAµídLöe
(
°©e
,
löe
);

1116 
	`sds‰ì
(
o
);

1121 
	`ªwrôeC⁄figF‹m©Mem‹y
(*
buf
, 
size_t
 
Àn
, 
byãs
) {

1122 
gb
 = 1024*1024*1024;

1123 
mb
 = 1024*1024;

1124 
kb
 = 1024;

1126 i‡(
byãs
 && (byã†% 
gb
) == 0) {

1127  
	`¢¥ötf
(
buf
,
Àn
,"%Œdgb",
byãs
/
gb
);

1128 } i‡(
byãs
 && (byã†% 
mb
) == 0) {

1129  
	`¢¥ötf
(
buf
,
Àn
,"%Œdmb",
byãs
/
mb
);

1130 } i‡(
byãs
 && (byã†% 
kb
) == 0) {

1131  
	`¢¥ötf
(
buf
,
Àn
,"%Œdkb",
byãs
/
kb
);

1133  
	`¢¥ötf
(
buf
,
Àn
,"%Œd",
byãs
);

1138 
	`ªwrôeC⁄figByãsO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
, c⁄° *
›ti⁄
, 
vÆue
, 
defvÆue
) {

1139 
buf
[64];

1140 
f‹˚
 = 
vÆue
 !
defvÆue
;

1141 
sds
 
löe
;

1143 
	`ªwrôeC⁄figF‹m©Mem‹y
(
buf
,(buf),
vÆue
);

1144 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%†%s",
›ti⁄
,
buf
);

1145 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1149 
	`ªwrôeC⁄figYesNoO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
, c⁄° *
›ti⁄
, 
vÆue
, 
defvÆue
) {

1150 
f‹˚
 = 
vÆue
 !
defvÆue
;

1151 
sds
 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%†%s",
›ti⁄
,

1152 
vÆue
 ? "yes" : "no");

1154 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1158 
	`ªwrôeC⁄figSåögO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
, c⁄° *
›ti⁄
, *
vÆue
, c⁄° *
defvÆue
) {

1159 
f‹˚
 = 1;

1160 
sds
 
löe
;

1164 i‡(
vÆue
 =
NULL
) {

1165 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
°©e
,
›ti⁄
);

1170 i‡(
defvÆue
 && 
	`°rcmp
(
vÆue
,defvÆueË=0Ë
f‹˚
 = 0;

1172 
löe
 = 
	`sd¢ew
(
›ti⁄
);

1173 
löe
 = 
	`sdsˇéí
(line, " ", 1);

1174 
löe
 = 
	`sdsˇåïr
÷öe, 
vÆue
, 
	`°æí
(value));

1176 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1180 
	`ªwrôeC⁄figNumîiˇlO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
, c⁄° *
›ti⁄
, 
vÆue
, 
defvÆue
) {

1181 
f‹˚
 = 
vÆue
 !
defvÆue
;

1182 
sds
 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%†%Œd",
›ti⁄
,
vÆue
);

1184 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1188 
	`ªwrôeC⁄figO˘ÆO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
, *
›ti⁄
, 
vÆue
, 
defvÆue
) {

1189 
f‹˚
 = 
vÆue
 !
defvÆue
;

1190 
sds
 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%†%o",
›ti⁄
,
vÆue
);

1192 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1198 
	`ªwrôeC⁄figEnumO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
, c⁄° *
›ti⁄
, 
vÆue
, 
c⁄figEnum
 *
˚
, 
defvÆ
) {

1199 
sds
 
löe
;

1200 c⁄° *
«me
 = 
	`c⁄figEnumGëNameOrUnknown
(
˚
,
vÆue
);

1201 
f‹˚
 = 
vÆue
 !
defvÆ
;

1203 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%†%s",
›ti⁄
,
«me
);

1204 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1208 
	`ªwrôeC⁄figSaveO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
) {

1209 
j
;

1210 
sds
 
löe
;

1215 
j
 = 0; j < 
£rvî
.
ßvï¨am¶í
; j++) {

1216 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"save %ld %d",

1217 (Ë
£rvî
.
ßvï¨ams
[
j
].
£c⁄ds
, sîvî.ßvï¨ams[j].
ch™ges
);

1218 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"ßve",
löe
,1);

1221 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
°©e
,"save");

1225 
	`ªwrôeC⁄figU£rO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
) {

1229 i‡(
£rvî
.
a˛_fûíame
[0] != '\0') {

1230 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
°©e
,"user");

1237 
øxIãøt‹
 
ri
;

1238 
	`øxSèπ
(&
ri
,
U£rs
);

1239 
	`øxSìk
(&
ri
,"^",
NULL
,0);

1240 
	`øxNext
(&
ri
)) {

1241 
u£r
 *
u
 = 
ri
.
d©a
;

1242 
sds
 
löe
 = 
	`sd¢ew
("user ");

1243 
löe
 = 
	`sdsˇtsds
÷öe,
u
->
«me
);

1244 
löe
 = 
	`sdsˇéí
(line," ",1);

1245 
sds
 
des¸
 = 
	`ACLDes¸ibeU£r
(
u
);

1246 
löe
 = 
	`sdsˇtsds
÷öe,
des¸
);

1247 
	`sds‰ì
(
des¸
);

1248 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"u£r",
löe
,1);

1250 
	`øxSt›
(&
ri
);

1253 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
°©e
,"user");

1257 
	`ªwrôeC⁄figDúO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
) {

1258 
cwd
[1024];

1260 i‡(
	`gëcwd
(
cwd
,(cwd)Ë=
NULL
) {

1261 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
°©e
,"dir");

1264 
	`ªwrôeC⁄figSåögO±i⁄
(
°©e
,"dú",
cwd
,
NULL
);

1268 
	`ªwrôeC⁄figSœveofO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
, *
›ti⁄
) {

1269 
sds
 
löe
;

1274 i‡(
£rvî
.
˛u°î_íabÀd
 || sîvî.
ma°îho°
 =
NULL
) {

1275 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
°©e
,
›ti⁄
);

1278 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%†%†%d", 
›ti⁄
,

1279 
£rvî
.
ma°îho°
, sîvî.
ma°îp‹t
);

1280 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,1);

1284 
	`ªwrôeC⁄figNŸifykey•a˚evítsO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
) {

1285 
f‹˚
 = 
£rvî
.
nŸify_key•a˚_evíts
 != 0;

1286 *
›ti⁄
 = "notify-keyspace-events";

1287 
sds
 
löe
, 
Êags
;

1289 
Êags
 = 
	`key•a˚EvítsFœgsToSåög
(
£rvî
.
nŸify_key•a˚_evíts
);

1290 
löe
 = 
	`sd¢ew
(
›ti⁄
);

1291 
löe
 = 
	`sdsˇéí
(line, " ", 1);

1292 
löe
 = 
	`sdsˇåïr
÷öe, 
Êags
, 
	`sd¶í
(flags));

1293 
	`sds‰ì
(
Êags
);

1294 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1298 
	`ªwrôeC⁄figClõ¡ouçutbuf„æimôO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
) {

1299 
j
;

1300 *
›ti⁄
 = "client-output-buffer-limit";

1302 
j
 = 0; j < 
CLIENT_TYPE_OBUF_COUNT
; j++) {

1303 
f‹˚
 = (
£rvî
.
˛õ¡_obuf_limôs
[
j
].
h¨d_limô_byãs
 !=

1304 
˛õ¡Buf„rLimôsDeÁu…s
[
j
].
h¨d_limô_byãs
) ||

1305 (
£rvî
.
˛õ¡_obuf_limôs
[
j
].
so·_limô_byãs
 !=

1306 
˛õ¡Buf„rLimôsDeÁu…s
[
j
].
so·_limô_byãs
) ||

1307 (
£rvî
.
˛õ¡_obuf_limôs
[
j
].
so·_limô_£c⁄ds
 !=

1308 
˛õ¡Buf„rLimôsDeÁu…s
[
j
].
so·_limô_£c⁄ds
);

1309 
sds
 
löe
;

1310 
h¨d
[64], 
so·
[64];

1312 
	`ªwrôeC⁄figF‹m©Mem‹y
(
h¨d
,(hard),

1313 
£rvî
.
˛õ¡_obuf_limôs
[
j
].
h¨d_limô_byãs
);

1314 
	`ªwrôeC⁄figF‹m©Mem‹y
(
so·
,(soft),

1315 
£rvî
.
˛õ¡_obuf_limôs
[
j
].
so·_limô_byãs
);

1317 *
ty≥«me
 = 
	`gëClõ¡Ty≥Name
(
j
);

1318 i‡(!
	`°rcmp
(
ty≥«me
,"slave"))Åypename = "replica";

1319 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%s %s %s %s %ld",

1320 
›ti⁄
, 
ty≥«me
, 
h¨d
, 
so·
,

1321 (Ë
£rvî
.
˛õ¡_obuf_limôs
[
j
].
so·_limô_£c⁄ds
);

1322 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1327 
	`ªwrôeC⁄figBödO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
) {

1328 
f‹˚
 = 1;

1329 
sds
 
löe
, 
addªs£s
;

1330 *
›ti⁄
 = "bind";

1333 i‡(
£rvî
.
bödaddr_cou¡
 == 0) {

1334 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
°©e
,
›ti⁄
);

1339 
addªs£s
 = 
	`sdsjoö
(
£rvî
.
bödaddr
,£rvî.
bödaddr_cou¡
," ");

1340 
löe
 = 
	`sd¢ew
(
›ti⁄
);

1341 
löe
 = 
	`sdsˇéí
(line, " ", 1);

1342 
löe
 = 
	`sdsˇtsds
÷öe, 
addªs£s
);

1343 
	`sds‰ì
(
addªs£s
);

1345 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1349 
	`ªwrôeC⁄figRequúïassO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
, *
›ti⁄
) {

1350 
f‹˚
 = 1;

1351 
sds
 
löe
;

1352 
sds
 
∑ssw‹d
 = 
£rvî
.
ªquúïass
;

1356 i‡(
∑ssw‹d
 =
NULL
) {

1357 
	`ªwrôeC⁄figM¨kAsPro˚s£d
(
°©e
,
›ti⁄
);

1361 
löe
 = 
	`sd¢ew
(
›ti⁄
);

1362 
löe
 = 
	`sdsˇéí
(line, " ", 1);

1363 
löe
 = 
	`sdsˇtsds
÷öe, 
∑ssw‹d
);

1365 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,
›ti⁄
,
löe
,
f‹˚
);

1370 
sds
 
	`ªwrôeC⁄figGëC⁄ã¡FromSèã
(
ªwrôeC⁄figSèã
 *
°©e
) {

1371 
sds
 
c⁄ã¡
 = 
	`sd£m±y
();

1372 
j
, 
was_em±y
 = 0;

1374 
j
 = 0; j < 
°©e
->
numlöes
; j++) {

1376 i‡(
	`sd¶í
(
°©e
->
löes
[
j
]) == 0) {

1377 i‡(
was_em±y
) ;

1378 
was_em±y
 = 1;

1380 
was_em±y
 = 0;

1382 
c⁄ã¡
 = 
	`sdsˇtsds
(c⁄ã¡,
°©e
->
löes
[
j
]);

1383 
c⁄ã¡
 = 
	`sdsˇéí
(content,"\n",1);

1385  
c⁄ã¡
;

1389 
	`ªwrôeC⁄figRñó£Sèã
(
ªwrôeC⁄figSèã
 *
°©e
) {

1390 
	`sds‰ì•lôªs
(
°©e
->
löes
,°©e->
numlöes
);

1391 
	`di˘Rñó£
(
°©e
->
›ti⁄_to_löe
);

1392 
	`di˘Rñó£
(
°©e
->
ªwrôãn
);

1393 
	`z‰ì
(
°©e
);

1404 
	`ªwrôeC⁄figRemoveOΩh™ed
(
ªwrôeC⁄figSèã
 *
°©e
) {

1405 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
°©e
->
›ti⁄_to_löe
);

1406 
di˘E¡ry
 *
de
;

1408 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1409 
li°
 *
l
 = 
	`di˘GëVÆ
(
de
);

1410 
sds
 
›ti⁄
 = 
	`di˘GëKey
(
de
);

1414 i‡(
	`di˘Föd
(
°©e
->
ªwrôãn
,
›ti⁄
Ë=
NULL
) {

1415 
	`£rvîLog
(
LL_DEBUG
,"NŸÑewrôã¿›ti⁄: %s", 
›ti⁄
);

1419 
	`li°Lígth
(
l
)) {

1420 
li°Node
 *
 
 = 
	`li°Fú°
(
l
);

1421 
löíum
 = (Ë
 
->
vÆue
;

1423 
	`sds‰ì
(
°©e
->
löes
[
löíum
]);

1424 
°©e
->
löes
[
löíum
] = 
	`sd£m±y
();

1425 
	`li°DñNode
(
l
,
 
);

1428 
	`di˘Rñó£Iãøt‹
(
di
);

1443 
	`ªwrôeC⁄figOvîwrôeFûe
(*
c⁄figfûe
, 
sds
 
c⁄ã¡
) {

1444 
ªtvÆ
 = 0;

1445 
fd
 = 
	`›í
(
c⁄figfûe
,
O_RDWR
|
O_CREAT
,0644);

1446 
c⁄ã¡_size
 = 
	`sd¶í
(
c⁄ã¡
), 
∑ddög
 = 0;

1447 
°©
 
sb
;

1448 
sds
 
c⁄ã¡_∑dded
;

1452 i‡(
fd
 == -1)  -1;

1453 i‡(
	`f°©
(
fd
,&
sb
) == -1) {

1454 
	`˛o£
(
fd
);

1459 
c⁄ã¡_∑dded
 = 
	`sdsdup
(
c⁄ã¡
);

1460 i‡(
c⁄ã¡_size
 < 
sb
.
°_size
) {

1463 
∑ddög
 = 
sb
.
°_size
 - 
c⁄ã¡_size
;

1464 
c⁄ã¡_∑dded
 = 
	`sdsgrowzîo
(c⁄ã¡_∑dded,
sb
.
°_size
);

1465 
c⁄ã¡_∑dded
[
c⁄ã¡_size
] = '\n';

1466 
	`mem£t
(
c⁄ã¡_∑dded
+
c⁄ã¡_size
+1,'#',
∑ddög
-1);

1470 i‡(
	`wrôe
(
fd
,
c⁄ã¡_∑dded
,
	`°æí
(content_padded)) == -1) {

1471 
ªtvÆ
 = -1;

1472 
˛ónup
;

1476 i‡(
∑ddög
) {

1477 i‡(
	`·runˇã
(
fd
,
c⁄ã¡_size
) == -1) {

1482 
˛ónup
:

1483 
	`sds‰ì
(
c⁄ã¡_∑dded
);

1484 
	`˛o£
(
fd
);

1485  
ªtvÆ
;

1496 
	`ªwrôeC⁄fig
(*
∑th
) {

1497 
ªwrôeC⁄figSèã
 *
°©e
;

1498 
sds
 
√wc⁄ã¡
;

1499 
ªtvÆ
;

1502 i‡((
°©e
 = 
	`ªwrôeC⁄figRódOldFûe
(
∑th
)Ë=
NULL
)  -1;

1508 
°™d¨dC⁄fig
 *
c⁄fig
 = 
c⁄figs
; c⁄fig->
«me
 !
NULL
; config++) {

1509 
c⁄fig
->
öãrÁ˚
.
	`ªwrôe
(c⁄fig->
d©a
, c⁄fig->
«me
, 
°©e
);

1512 
	`ªwrôeC⁄figBödO±i⁄
(
°©e
);

1513 
	`ªwrôeC⁄figO˘ÆO±i⁄
(
°©e
,"unixsockë≥rm",
£rvî
.
unixsockë≥rm
,
CONFIG_DEFAULT_UNIX_SOCKET_PERM
);

1514 
	`ªwrôeC⁄figSåögO±i⁄
(
°©e
,"logfûe",
£rvî
.
logfûe
,
CONFIG_DEFAULT_LOGFILE
);

1515 
	`ªwrôeC⁄figSaveO±i⁄
(
°©e
);

1516 
	`ªwrôeC⁄figU£rO±i⁄
(
°©e
);

1517 
	`ªwrôeC⁄figDúO±i⁄
(
°©e
);

1518 
	`ªwrôeC⁄figSœveofO±i⁄
(
°©e
,"replicaof");

1519 
	`ªwrôeC⁄figRequúïassO±i⁄
(
°©e
,"requirepass");

1520 
	`ªwrôeC⁄figByãsO±i⁄
(
°©e
,"˛õ¡-quîy-buf„r-limô",
£rvî
.
˛õ¡_max_quîybuf_Àn
,
PROTO_MAX_QUERYBUF_LEN
);

1521 
	`ªwrôeC⁄figSåögO±i⁄
(
°©e
,"˛u°î-c⁄fig-fûe",
£rvî
.
˛u°î_c⁄figfûe
,
CONFIG_DEFAULT_CLUSTER_CONFIG_FILE
);

1522 
	`ªwrôeC⁄figNŸifykey•a˚evítsO±i⁄
(
°©e
);

1523 
	`ªwrôeC⁄figClõ¡ouçutbuf„æimôO±i⁄
(
°©e
);

1526 i‡(
£rvî
.
£¡öñ_mode
Ë
	`ªwrôeC⁄figSítöñO±i⁄
(
°©e
);

1531 
	`ªwrôeC⁄figRemoveOΩh™ed
(
°©e
);

1535 
√wc⁄ã¡
 = 
	`ªwrôeC⁄figGëC⁄ã¡FromSèã
(
°©e
);

1536 
ªtvÆ
 = 
	`ªwrôeC⁄figOvîwrôeFûe
(
£rvî
.
c⁄figfûe
,
√wc⁄ã¡
);

1538 
	`sds‰ì
(
√wc⁄ã¡
);

1539 
	`ªwrôeC⁄figRñó£Sèã
(
°©e
);

1540  
ªtvÆ
;

1546 
	#LOADBUF_SIZE
 256

	)

1547 
lﬂdbuf
[
LOADBUF_SIZE
];

1549 
	#MODIFIABLE_CONFIG
 1

	)

1550 
	#IMMUTABLE_CONFIG
 0

	)

1552 
	#embedComm⁄C⁄fig
(
c⁄fig_«me
, 
c⁄fig_Æüs
, 
is_modifübÀ
) \

1553 .
«me
 = (
c⁄fig_«me
), \

1554 .
Æüs
 = (
c⁄fig_Æüs
), \

1555 .
modifübÀ
 = (
is_modifübÀ
),

	)

1557 
	#embedC⁄figI¡îÁ˚
(
öô‚
, 
£t‚
, 
gë‚
, 
ªwrôe‚
Ë.
öãrÁ˚
 = { \

1558 .
öô
 = (
öô‚
), \

1559 .
£t
 = (
£t‚
), \

1560 .
gë
 = (
gë‚
), \

1561 .
ªwrôe
 = (
ªwrôe‚
) \

1562 },

	)

1577 
	`boﬁC⁄figInô
(
ty≥D©a
 
d©a
) {

1578 *
d©a
.
ye¢o
.
c⁄fig
 = d©a.ye¢o.
deÁu…_vÆue
;

1581 
	`boﬁC⁄figSë
(
ty≥D©a
 
d©a
, 
sds
 
vÆue
, 
upd©e
, **
îr
) {

1582 
yn
 = 
	`ye¢Ÿoi
(
vÆue
);

1583 i‡(
yn
 == -1) {

1584 *
îr
 = "argument must be 'yes' or 'no'";

1587 i‡(
d©a
.
ye¢o
.
is_vÆid_‚
 && !d©a.ye¢o.
	`is_vÆid_‚
(
yn
, 
îr
))

1589 
¥ev
 = *(
d©a
.
ye¢o
.
c⁄fig
);

1590 *(
d©a
.
ye¢o
.
c⁄fig
Ë
yn
;

1591 i‡(
upd©e
 && 
d©a
.
ye¢o
.
upd©e_‚
 && !d©a.ye¢o.
	`upd©e_‚
(
yn
, 
¥ev
, 
îr
)) {

1592 *(
d©a
.
ye¢o
.
c⁄fig
Ë
¥ev
;

1598 
	`boﬁC⁄figGë
(
˛õ¡
 *
c
, 
ty≥D©a
 
d©a
) {

1599 
	`addRïlyBulkCSåög
(
c
, *
d©a
.
ye¢o
.
c⁄fig
 ? "yes" : "no");

1602 
	`boﬁC⁄figRewrôe
(
ty≥D©a
 
d©a
, c⁄° *
«me
, 
ªwrôeC⁄figSèã
 *
°©e
) {

1603 
	`ªwrôeC⁄figYesNoO±i⁄
(
°©e
, 
«me
,*(
d©a
.
ye¢o
.
c⁄fig
), d©a.ye¢o.
deÁu…_vÆue
);

1606 
	#¸óãBoﬁC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
c⁄fig_addr
, , 
is_vÆid
, 
upd©e
) { \

1607 
	`embedComm⁄C⁄fig
(
«me
, 
Æüs
, 
modifübÀ
) \

1608 
	`embedC⁄figI¡îÁ˚
(
boﬁC⁄figInô
, 
boﬁC⁄figSë
, 
boﬁC⁄figGë
, 
boﬁC⁄figRewrôe
) \

1609 .
d©a
.
ye¢o
 = { \

1610 .
c⁄fig
 = &(
c⁄fig_addr
), \

1611 .
deÁu…_vÆue
 = (), \

1612 .
is_vÆid_‚
 = (
is_vÆid
), \

1613 .
upd©e_‚
 = (
upd©e
), \

1615 }

	)

1618 
	`°rögC⁄figInô
(
ty≥D©a
 
d©a
) {

1619 i‡(
d©a
.
°rög
.
c⁄vît_em±y_to_nuŒ
) {

1620 *
d©a
.
°rög
.
c⁄fig
 = d©a.°rög.
deÁu…_vÆue
 ? 
	`z°rdup
(d©a.°rög.deÁu…_vÆueË: 
NULL
;

1622 *
d©a
.
°rög
.
c⁄fig
 = 
	`z°rdup
(d©a.°rög.
deÁu…_vÆue
);

1626 
	`°rögC⁄figSë
(
ty≥D©a
 
d©a
, 
sds
 
vÆue
, 
upd©e
, **
îr
) {

1627 i‡(
d©a
.
°rög
.
is_vÆid_‚
 && !d©a.°rög.
	`is_vÆid_‚
(
vÆue
, 
îr
))

1629 *
¥ev
 = *
d©a
.
°rög
.
c⁄fig
;

1630 i‡(
d©a
.
°rög
.
c⁄vît_em±y_to_nuŒ
) {

1631 *
d©a
.
°rög
.
c⁄fig
 = 
vÆue
[0] ? 
	`z°rdup
(vÆueË: 
NULL
;

1633 *
d©a
.
°rög
.
c⁄fig
 = 
	`z°rdup
(
vÆue
);

1635 i‡(
upd©e
 && 
d©a
.
°rög
.
upd©e_‚
 && !d©a.°rög.
	`upd©e_‚
(*d©a.°rög.
c⁄fig
, 
¥ev
, 
îr
)) {

1636 
	`z‰ì
(*
d©a
.
°rög
.
c⁄fig
);

1637 *
d©a
.
°rög
.
c⁄fig
 = 
¥ev
;

1640 
	`z‰ì
(
¥ev
);

1644 
	`°rögC⁄figGë
(
˛õ¡
 *
c
, 
ty≥D©a
 
d©a
) {

1645 
	`addRïlyBulkCSåög
(
c
, *
d©a
.
°rög
.
c⁄fig
 ? *data.string.config : "");

1648 
	`°rögC⁄figRewrôe
(
ty≥D©a
 
d©a
, c⁄° *
«me
, 
ªwrôeC⁄figSèã
 *
°©e
) {

1649 
	`ªwrôeC⁄figSåögO±i⁄
(
°©e
, 
«me
,*(
d©a
.
°rög
.
c⁄fig
), d©a.°rög.
deÁu…_vÆue
);

1652 
	#ALLOW_EMPTY_STRING
 0

	)

1653 
	#EMPTY_STRING_IS_NULL
 1

	)

1655 
	#¸óãSåögC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
em±y_to_nuŒ
, 
c⁄fig_addr
, , 
is_vÆid
, 
upd©e
) { \

1656 
	`embedComm⁄C⁄fig
(
«me
, 
Æüs
, 
modifübÀ
) \

1657 
	`embedC⁄figI¡îÁ˚
(
°rögC⁄figInô
, 
°rögC⁄figSë
, 
°rögC⁄figGë
, 
°rögC⁄figRewrôe
) \

1658 .
d©a
.
°rög
 = { \

1659 .
c⁄fig
 = &(
c⁄fig_addr
), \

1660 .
deÁu…_vÆue
 = (), \

1661 .
is_vÆid_‚
 = (
is_vÆid
), \

1662 .
upd©e_‚
 = (
upd©e
), \

1663 .
c⁄vît_em±y_to_nuŒ
 = (
em±y_to_nuŒ
), \

1665 }

	)

1668 
	`íumC⁄figInô
(
ty≥D©a
 
d©a
) {

1669 *
d©a
.
íumd
.
c⁄fig
 = d©a.íumd.
deÁu…_vÆue
;

1672 
	`íumC⁄figSë
(
ty≥D©a
 
d©a
, 
sds
 
vÆue
, 
upd©e
, **
îr
) {

1673 
íumvÆ
 = 
	`c⁄figEnumGëVÆue
(
d©a
.
íumd
.
íum_vÆue
, 
vÆue
);

1674 i‡(
íumvÆ
 =
INT_MIN
) {

1675 
sds
 
íumîr
 = 
	`sd¢ew
("argument must be one ofÅhe following: ");

1676 
c⁄figEnum
 *
íumNode
 = 
d©a
.
íumd
.
íum_vÆue
;

1677 
íumNode
->
«me
 !
NULL
) {

1678 
íumîr
 = 
	`sdsˇéí
”numîr, 
íumNode
->
«me
,

1679 
	`°æí
(
íumNode
->
«me
));

1680 
íumîr
 = 
	`sdsˇéí
(enumerr, ", ", 2);

1681 
íumNode
++;

1683 
	`sd§™ge
(
íumîr
,0,-3);

1685 
	`°∫˝y
(
lﬂdbuf
, 
íumîr
, 
LOADBUF_SIZE
);

1686 
lﬂdbuf
[
LOADBUF_SIZE
 - 1] = '\0';

1688 
	`sds‰ì
(
íumîr
);

1689 *
îr
 = 
lﬂdbuf
;

1692 i‡(
d©a
.
íumd
.
is_vÆid_‚
 && !d©a.íumd.
	`is_vÆid_‚
(
íumvÆ
, 
îr
))

1694 
¥ev
 = *(
d©a
.
íumd
.
c⁄fig
);

1695 *(
d©a
.
íumd
.
c⁄fig
Ë
íumvÆ
;

1696 i‡(
upd©e
 && 
d©a
.
íumd
.
upd©e_‚
 && !d©a.íumd.
	`upd©e_‚
(
íumvÆ
, 
¥ev
, 
îr
)) {

1697 *(
d©a
.
íumd
.
c⁄fig
Ë
¥ev
;

1703 
	`íumC⁄figGë
(
˛õ¡
 *
c
, 
ty≥D©a
 
d©a
) {

1704 
	`addRïlyBulkCSåög
(
c
, 
	`c⁄figEnumGëNameOrUnknown
(
d©a
.
íumd
.
íum_vÆue
,*d©a.íumd.
c⁄fig
));

1707 
	`íumC⁄figRewrôe
(
ty≥D©a
 
d©a
, c⁄° *
«me
, 
ªwrôeC⁄figSèã
 *
°©e
) {

1708 
	`ªwrôeC⁄figEnumO±i⁄
(
°©e
, 
«me
,*(
d©a
.
íumd
.
c⁄fig
), d©a.íumd.
íum_vÆue
, d©a.íumd.
deÁu…_vÆue
);

1711 
	#¸óãEnumC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, , 
c⁄fig_addr
, , 
is_vÆid
, 
upd©e
) { \

1712 
	`embedComm⁄C⁄fig
(
«me
, 
Æüs
, 
modifübÀ
) \

1713 
	`embedC⁄figI¡îÁ˚
(
íumC⁄figInô
, 
íumC⁄figSë
, 
íumC⁄figGë
, 
íumC⁄figRewrôe
) \

1714 .
d©a
.
íumd
 = { \

1715 .
c⁄fig
 = &(
c⁄fig_addr
), \

1716 .
deÁu…_vÆue
 = (), \

1717 .
is_vÆid_‚
 = (
is_vÆid
), \

1718 .
upd©e_‚
 = (
upd©e
), \

1719 .
íum_vÆue
 = (), \

1721 }

	)

1725 
	#SET_NUMERIC_TYPE
(
vÆ
) \

1726 i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_INT
) { \

1727 *(
d©a
.
numîic
.
c⁄fig
.
i
Ë(Ë
vÆ
; \

1728 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_UINT
) { \

1729 *(
d©a
.
numîic
.
c⁄fig
.
ui
Ë(Ë
vÆ
; \

1730 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_LONG
) { \

1731 *(
d©a
.
numîic
.
c⁄fig
.
l
Ë(Ë
vÆ
; \

1732 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_ULONG
) { \

1733 *(
d©a
.
numîic
.
c⁄fig
.
ul
Ë(Ë
vÆ
; \

1734 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_LONG_LONG
) { \

1735 *(
d©a
.
numîic
.
c⁄fig
.
Œ
Ë(Ë
vÆ
; \

1736 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_ULONG_LONG
) { \

1737 *(
d©a
.
numîic
.
c⁄fig
.
uŒ
Ë(Ë
vÆ
; \

1738 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_SIZE_T
) { \

1739 *(
d©a
.
numîic
.
c⁄fig
.
°
Ë(
size_t
Ë
vÆ
; \

1740 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_SSIZE_T
) { \

1741 *(
d©a
.
numîic
.
c⁄fig
.
s°
Ë(
ssize_t
Ë
vÆ
; \

1742 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_OFF_T
) { \

1743 *(
d©a
.
numîic
.
c⁄fig
.
Ÿ
Ë(
off_t
Ë
vÆ
; \

1744 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_TIME_T
) { \

1745 *(
d©a
.
numîic
.
c⁄fig
.
â
Ë(
time_t
Ë
vÆ
; \

1746 }

	)

1750 
	#GET_NUMERIC_TYPE
(
vÆ
) \

1751 i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_INT
) { \

1752 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
i
); \

1753 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_UINT
) { \

1754 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
ui
); \

1755 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_LONG
) { \

1756 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
l
); \

1757 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_ULONG
) { \

1758 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
ul
); \

1759 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_LONG_LONG
) { \

1760 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
Œ
); \

1761 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_ULONG_LONG
) { \

1762 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
uŒ
); \

1763 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_SIZE_T
) { \

1764 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
°
); \

1765 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_SSIZE_T
) { \

1766 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
s°
); \

1767 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_OFF_T
) { \

1768 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
Ÿ
); \

1769 } i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_TIME_T
) { \

1770 
vÆ
 = *(
d©a
.
numîic
.
c⁄fig
.
â
); \

1771 }

	)

1774 
	`numîicC⁄figInô
(
ty≥D©a
 
d©a
) {

1775 
	`SET_NUMERIC_TYPE
(
d©a
.
numîic
.
deÁu…_vÆue
)

1778 
	`numîicBound¨yCheck
(
ty≥D©a
 
d©a
, 
Œ
, **
îr
) {

1779 i‡(
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_ULONG_LONG
 ||

1780 
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_UINT
 ||

1781 
d©a
.
numîic
.
numîic_ty≥
 =
NUMERIC_TYPE_SIZE_T
) {

1783 
uŒ
 = 
Œ
;

1784 
uµî_bound
 = 
d©a
.
numîic
.upper_bound;

1785 
lowî_bound
 = 
d©a
.
numîic
.lower_bound;

1786 i‡(
uŒ
 > 
uµî_bound
 || uŒ < 
lowî_bound
) {

1787 
	`¢¥ötf
(
lﬂdbuf
, 
LOADBUF_SIZE
,

1789 
lowî_bound
,

1790 
uµî_bound
);

1791 *
îr
 = 
lﬂdbuf
;

1796 i‡(
Œ
 > 
d©a
.
numîic
.
uµî_bound
 ||Ü»< d©a.numîic.
lowî_bound
) {

1797 
	`¢¥ötf
(
lﬂdbuf
, 
LOADBUF_SIZE
,

1799 
d©a
.
numîic
.
lowî_bound
,

1800 
d©a
.
numîic
.
uµî_bound
);

1801 *
îr
 = 
lﬂdbuf
;

1808 
	`numîicC⁄figSë
(
ty≥D©a
 
d©a
, 
sds
 
vÆue
, 
upd©e
, **
îr
) {

1809 
Œ
, 
¥ev
 = 0;

1810 i‡(
d©a
.
numîic
.
is_mem‹y
) {

1811 
memîr
;

1812 
Œ
 = 
	`memtﬁl
(
vÆue
, &
memîr
);

1813 i‡(
memîr
 || 
Œ
 < 0) {

1814 *
îr
 = "argument must beá memory value";

1818 i‡(!
	`°rög2Œ
(
vÆue
, 
	`sd¶í
(vÆue),&
Œ
)) {

1819 *
îr
 = "argument couldn't beÖarsed intoán integer" ;

1824 i‡(!
	`numîicBound¨yCheck
(
d©a
, 
Œ
, 
îr
))

1827 i‡(
d©a
.
numîic
.
is_vÆid_‚
 && !d©a.numîic.
	`is_vÆid_‚
(
Œ
, 
îr
))

1830 
	`GET_NUMERIC_TYPE
(
¥ev
)

1831 
	`SET_NUMERIC_TYPE
(
Œ
)

1833 i‡(
upd©e
 && 
d©a
.
numîic
.
upd©e_‚
 && !d©a.numîic.
	`upd©e_‚
(
Œ
, 
¥ev
, 
îr
)) {

1834 
	`SET_NUMERIC_TYPE
(
¥ev
)

1840 
	`numîicC⁄figGë
(
˛õ¡
 *
c
, 
ty≥D©a
 
d©a
) {

1841 
buf
[128];

1842 
vÆue
 = 0;

1844 
	`GET_NUMERIC_TYPE
(
vÆue
)

1846 
	`Œ2°rög
(
buf
, (buf), 
vÆue
);

1847 
	`addRïlyBulkCSåög
(
c
, 
buf
);

1850 
	`numîicC⁄figRewrôe
(
ty≥D©a
 
d©a
, c⁄° *
«me
, 
ªwrôeC⁄figSèã
 *
°©e
) {

1851 
vÆue
 = 0;

1853 
	`GET_NUMERIC_TYPE
(
vÆue
)

1855 i‡(
d©a
.
numîic
.
is_mem‹y
) {

1856 
	`ªwrôeC⁄figByãsO±i⁄
(
°©e
, 
«me
, 
vÆue
, 
d©a
.
numîic
.
deÁu…_vÆue
);

1858 
	`ªwrôeC⁄figNumîiˇlO±i⁄
(
°©e
, 
«me
, 
vÆue
, 
d©a
.
numîic
.
deÁu…_vÆue
);

1862 
	#INTEGER_CONFIG
 0

	)

1863 
	#MEMORY_CONFIG
 1

	)

1865 
	#embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) { \

1866 
	`embedComm⁄C⁄fig
(
«me
, 
Æüs
, 
modifübÀ
) \

1867 
	`embedC⁄figI¡îÁ˚
(
numîicC⁄figInô
, 
numîicC⁄figSë
, 
numîicC⁄figGë
, 
numîicC⁄figRewrôe
) \

1868 .
d©a
.
numîic
 = { \

1869 .
lowî_bound
 = (
lowî
), \

1870 .
uµî_bound
 = (
uµî
), \

1871 .
deÁu…_vÆue
 = (), \

1872 .
is_vÆid_‚
 = (
is_vÆid
), \

1873 .
upd©e_‚
 = (
upd©e
), \

1874 .
is_mem‹y
 = (
mem‹y
),

	)

1876 
	#¸óãI¡C⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1877 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1878 .
numîic_ty≥
 = 
NUMERIC_TYPE_INT
, \

1879 .
c⁄fig
.
i
 = &(
c⁄fig_addr
) \

1881 }

	)

1883 
	#¸óãUI¡C⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1884 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1885 .
numîic_ty≥
 = 
NUMERIC_TYPE_UINT
, \

1886 .
c⁄fig
.
ui
 = &(
c⁄fig_addr
) \

1887 
	}
} \

1888 }

	)

1890 
	#¸óãL⁄gC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1891 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1892 .
numîic_ty≥
 = 
NUMERIC_TYPE_LONG
, \

1893 .
c⁄fig
.
l
 = &(
c⁄fig_addr
) \

1895 }

	)

1897 
	#¸óãUL⁄gC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1898 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1899 .
numîic_ty≥
 = 
NUMERIC_TYPE_ULONG
, \

1900 .
c⁄fig
.
ul
 = &(
c⁄fig_addr
) \

1902 }

	)

1904 
	#¸óãL⁄gL⁄gC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1905 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1906 .
numîic_ty≥
 = 
NUMERIC_TYPE_LONG_LONG
, \

1907 .
c⁄fig
.
Œ
 = &(
c⁄fig_addr
) \

1909 }

	)

1911 
	#¸óãUL⁄gL⁄gC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1912 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1913 .
numîic_ty≥
 = 
NUMERIC_TYPE_ULONG_LONG
, \

1914 .
c⁄fig
.
uŒ
 = &(
c⁄fig_addr
) \

1916 }

	)

1918 
	#¸óãSizeTC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1919 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1920 .
numîic_ty≥
 = 
NUMERIC_TYPE_SIZE_T
, \

1921 .
c⁄fig
.
°
 = &(
c⁄fig_addr
) \

1923 }

	)

1925 
	#¸óãSSizeTC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1926 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1927 .
numîic_ty≥
 = 
NUMERIC_TYPE_SSIZE_T
, \

1928 .
c⁄fig
.
s°
 = &(
c⁄fig_addr
) \

1930 }

	)

1932 
	#¸óãTimeTC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1933 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1934 .
numîic_ty≥
 = 
NUMERIC_TYPE_TIME_T
, \

1935 .
c⁄fig
.
â
 = &(
c⁄fig_addr
) \

1937 }

	)

1939 
	#¸óãOffTC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1940 
	`embedComm⁄NumîiˇlC⁄fig
(
«me
, 
Æüs
, 
modifübÀ
, 
lowî
, 
uµî
, 
c⁄fig_addr
, , 
mem‹y
, 
is_vÆid
, 
upd©e
) \

1941 .
numîic_ty≥
 = 
NUMERIC_TYPE_OFF_T
, \

1942 .
c⁄fig
.
Ÿ
 = &(
c⁄fig_addr
) \

1944 }

	)

1946 
	$isVÆidA˘iveDe‰ag
(
vÆ
, **
îr
) {

1947 #i‚de‡
HAVE_DEFRAG


1948 i‡(
vÆ
) {

1949 *
îr
 = "Active defragmentation cannot beÉnabled: it "

1956 
	`UNUSED
(
vÆ
);

1957 
	`UNUSED
(
îr
);

1960 
	}
}

1962 
	$isVÆidDBfûíame
(*
vÆ
, **
îr
) {

1963 i‡(!
	`∑thIsBa£Name
(
vÆ
)) {

1964 *
îr
 = "dbfilename can't beáÖath, justá filename";

1968 
	}
}

1970 
	$isVÆidAOFfûíame
(*
vÆ
, **
îr
) {

1971 i‡(!
	`∑thIsBa£Name
(
vÆ
)) {

1972 *
îr
 = "appendfilename can't beáÖath, justá filename";

1976 
	}
}

1978 
	$upd©eHZ
(
vÆ
, 
¥ev
, **
îr
) {

1979 
	`UNUSED
(
¥ev
);

1980 
	`UNUSED
(
îr
);

1983 
£rvî
.
c⁄fig_hz
 = 
vÆ
;

1984 i‡(
£rvî
.
c⁄fig_hz
 < 
CONFIG_MIN_HZ
) server.config_hz = CONFIG_MIN_HZ;

1985 i‡(
£rvî
.
c⁄fig_hz
 > 
CONFIG_MAX_HZ
) server.config_hz = CONFIG_MAX_HZ;

1986 
£rvî
.
hz
 = sîvî.
c⁄fig_hz
;

1988 
	}
}

1990 
	$upd©eJemÆlocBgThªad
(
vÆ
, 
¥ev
, **
îr
) {

1991 
	`UNUSED
(
¥ev
);

1992 
	`UNUSED
(
îr
);

1993 
	`£t_jemÆloc_bg_thªad
(
vÆ
);

1995 
	}
}

1997 
	$upd©eRïlBacklogSize
(
vÆ
, 
¥ev
, **
îr
) {

2000 
	`UNUSED
(
îr
);

2001 
£rvî
.
ª∂_backlog_size
 = 
¥ev
;

2002 
	`ªsizeRïliˇti⁄Backlog
(
vÆ
);

2004 
	}
}

2006 
	$upd©eMaxmem‹y
(
vÆ
, 
¥ev
, **
îr
) {

2007 
	`UNUSED
(
¥ev
);

2008 
	`UNUSED
(
îr
);

2009 i‡(
vÆ
) {

2010 
size_t
 
u£d
 = 
	`zmÆloc_u£d_mem‹y
()-
	`‰ìMem‹yGëNŸCou¡edMem‹y
();

2011 i‡(()
vÆ
 < 
u£d
) {

2012 
	`£rvîLog
(
LL_WARNING
,"WARNING:Åhê√w maxmem‹y vÆuê£àvü CONFIG SET (%ŒuËi†smÆÀ∏th™Åhêcuºíàmem‹y ußgê(%zu). Thi†wû»ªsu… i¿keyÉvi˘i⁄ánd/‹ÅhêöabûôyÅÿac˚±Çew wrôêcomm™d†dïídög o¿thêmaxmem‹y-pﬁicy.", 
£rvî
.
maxmem‹y
, 
u£d
);

2014 
	`‰ìMem‹yIfNìdedAndSa„
();

2017 
	}
}

2019 
	$upd©eGoodSœves
(
vÆ
, 
¥ev
, **
îr
) {

2020 
	`UNUSED
(
vÆ
);

2021 
	`UNUSED
(
¥ev
);

2022 
	`UNUSED
(
îr
);

2023 
	`ª‰eshGoodSœvesCou¡
();

2025 
	}
}

2027 
	$upd©eAµíd⁄ly
(
vÆ
, 
¥ev
, **
îr
) {

2028 
	`UNUSED
(
¥ev
);

2029 i‡(
vÆ
 =0 && 
£rvî
.
aof_°©e
 !
AOF_OFF
) {

2030 
	`°›AµídO∆y
();

2031 } i‡(
vÆ
 && 
£rvî
.
aof_°©e
 =
AOF_OFF
) {

2032 i‡(
	`°¨tAµídO∆y
(Ë=
C_ERR
) {

2033 *
îr
 = "UnableÅoÅurn on AOF. Check serverÜogs.";

2038 
	}
}

2040 
	$upd©eMax˛õ¡s
(
vÆ
, 
¥ev
, **
îr
) {

2042 i‡(
vÆ
 > 
¥ev
) {

2043 
	`adju°O≥nFûesLimô
();

2044 i‡(
£rvî
.
max˛õ¡s
 !
vÆ
) {

2045 
msg
[128];

2046 
	`•rötf
(
msg
, "Thê›î©ög sy°em i†nŸábÀÅÿh™dÀÅhê•ecifõdÇumbî o‡˛õ¡s,Åry wôh %d", 
£rvî
.
max˛õ¡s
);

2047 *
îr
 = 
msg
;

2048 i‡(
£rvî
.
max˛õ¡s
 > 
¥ev
) {

2049 
£rvî
.
max˛õ¡s
 = 
¥ev
;

2050 
	`adju°O≥nFûesLimô
();

2054 i‡((Ë
	`´GëSëSize
(
£rvî
.
ñ
) <

2055 
£rvî
.
max˛õ¡s
 + 
CONFIG_FDSET_INCR
)

2057 i‡(
	`´ResizeSëSize
(
£rvî
.
ñ
,

2058 
£rvî
.
max˛õ¡s
 + 
CONFIG_FDSET_INCR
Ë=
AE_ERR
)

2060 *
îr
 = "TheÉventÜoop API used by Redis isÇotábleÅo handleÅhe specifiedÇumber of clients";

2066 
	}
}

2068 #ifde‡
USE_OPENSSL


2069 
	$upd©eTlsCfg
(*
vÆ
, *
¥ev
, **
îr
) {

2070 
	`UNUSED
(
vÆ
);

2071 
	`UNUSED
(
¥ev
);

2072 
	`UNUSED
(
îr
);

2073 i‡(
	`ésC⁄figuª
(&
£rvî
.
és_˘x_c⁄fig
Ë=
C_ERR
) {

2074 *
îr
 = "UnableÅo configureÅls-cert-file. Check serverÜogs.";

2078 
	}
}

2079 
	$upd©eTlsCfgBoﬁ
(
vÆ
, 
¥ev
, **
îr
) {

2080 
	`UNUSED
(
vÆ
);

2081 
	`UNUSED
(
¥ev
);

2082  
	`upd©eTlsCfg
(
NULL
, NULL, 
îr
);

2083 
	}
}

2086 
°™d¨dC⁄fig
 
	gc⁄figs
[] = {

2088 
¸óãBoﬁC⁄fig
("rdbchecksum", 
NULL
, 
IMMUTABLE_CONFIG
, 
£rvî
.
rdb_checksum
, 1, NULL, NULL),

2089 
¸óãBoﬁC⁄fig
("d´m⁄ize", 
NULL
, 
IMMUTABLE_CONFIG
, 
£rvî
.
d´m⁄ize
, 0, NULL, NULL),

2090 
¸óãBoﬁC⁄fig
("io-thªads-do-ªads", 
NULL
, 
IMMUTABLE_CONFIG
, 
£rvî
.
io_thªads_do_ªads
, 0,NULL, NULL),

2091 
¸óãBoﬁC⁄fig
("lua-ª∂iˇã-comm™ds", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
lua_Æways_ª∂iˇã_comm™ds
, 1, NULL, NULL),

2092 
¸óãBoﬁC⁄fig
("Æways-show-logo", 
NULL
, 
IMMUTABLE_CONFIG
, 
£rvî
.
Æways_show_logo
, 0, NULL, NULL),

2093 
¸óãBoﬁC⁄fig
("¥Ÿe˘ed-mode", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
¥Ÿe˘ed_mode
, 1, NULL, NULL),

2094 
¸óãBoﬁC⁄fig
("rdbcom¥essi⁄", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
rdb_com¥essi⁄
, 1, NULL, NULL),

2095 
¸óãBoﬁC⁄fig
("rdb-dñ-sync-fûes", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
rdb_dñ_sync_fûes
, 0, NULL, NULL),

2096 
¸óãBoﬁC⁄fig
("a˘ivîehashög", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
a˘ivîehashög
, 1, NULL, NULL),

2097 
¸óãBoﬁC⁄fig
("°›-wrôes-⁄-bgßve-îr‹", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
°›_wrôes_⁄_bgßve_îr
, 1, NULL, NULL),

2098 
¸óãBoﬁC⁄fig
("dy«mic-hz", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
dy«mic_hz
, 1, NULL, NULL),

2099 
¸óãBoﬁC⁄fig
("œzy‰ì-œzy-evi˘i⁄", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
œzy‰ì_œzy_evi˘i⁄
, 0, NULL, NULL),

2100 
¸óãBoﬁC⁄fig
("œzy‰ì-œzy-expúe", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
œzy‰ì_œzy_expúe
, 0, NULL, NULL),

2101 
¸óãBoﬁC⁄fig
("œzy‰ì-œzy-£rvî-dñ", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
œzy‰ì_œzy_£rvî_dñ
, 0, NULL, NULL),

2102 
¸óãBoﬁC⁄fig
("œzy‰ì-œzy-u£r-dñ", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
œzy‰ì_œzy_u£r_dñ
 , 0, NULL, NULL),

2103 
¸óãBoﬁC⁄fig
("ª∂-dißbÀ-t˝-nodñay", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
ª∂_dißbÀ_t˝_nodñay
, 0, NULL, NULL),

2104 
¸óãBoﬁC⁄fig
("ª∂-diskÀss-sync", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
ª∂_diskÀss_sync
, 0, NULL, NULL),

2105 
¸óãBoﬁC⁄fig
("g›hî-íabÀd", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
g›hî_íabÀd
, 0, NULL, NULL),

2106 
¸óãBoﬁC⁄fig
("aof-ªwrôe-ö¸emíèl-fsync", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
aof_ªwrôe_ö¸emíèl_fsync
, 1, NULL, NULL),

2107 
¸óãBoﬁC⁄fig
("no-≠≥ndfsync-⁄-ªwrôe", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
aof_no_fsync_⁄_ªwrôe
, 0, NULL, NULL),

2108 
¸óãBoﬁC⁄fig
("˛u°î-ªquúe-fuŒ-covîage", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
˛u°î_ªquúe_fuŒ_covîage
, 1, NULL, NULL),

2109 
¸óãBoﬁC⁄fig
("rdb-ßve-ö¸emíèl-fsync", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
rdb_ßve_ö¸emíèl_fsync
, 1, NULL, NULL),

2110 
¸óãBoﬁC⁄fig
("aof-lﬂd-åunˇãd", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
aof_lﬂd_åunˇãd
, 1, NULL, NULL),

2111 
¸óãBoﬁC⁄fig
("aof-u£-rdb-¥ómbÀ", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
aof_u£_rdb_¥ómbÀ
, 1, NULL, NULL),

2112 
¸óãBoﬁC⁄fig
("˛u°î-ª∂iˇ-no-Áûovî", "˛u°î-¶ave-no-Áûovî", 
MODIFIABLE_CONFIG
, 
£rvî
.
˛u°î_¶ave_no_Áûovî
, 0, 
NULL
, NULL),

2113 
¸óãBoﬁC⁄fig
("ª∂iˇ-œzy-Êush", "¶ave-œzy-Êush", 
MODIFIABLE_CONFIG
, 
£rvî
.
ª∂_¶ave_œzy_Êush
, 0, 
NULL
, NULL),

2114 
¸óãBoﬁC⁄fig
("ª∂iˇ-£rve-°Æe-d©a", "¶ave-£rve-°Æe-d©a", 
MODIFIABLE_CONFIG
, 
£rvî
.
ª∂_£rve_°Æe_d©a
, 1, 
NULL
, NULL),

2115 
¸óãBoﬁC⁄fig
("ª∂iˇ-ªad-⁄ly", "¶ave-ªad-⁄ly", 
MODIFIABLE_CONFIG
, 
£rvî
.
ª∂_¶ave_ro
, 1, 
NULL
, NULL),

2116 
¸óãBoﬁC⁄fig
("ª∂iˇ-ign‹e-maxmem‹y", "¶ave-ign‹e-maxmem‹y", 
MODIFIABLE_CONFIG
, 
£rvî
.
ª∂_¶ave_ign‹e_maxmem‹y
, 1, 
NULL
, NULL),

2117 
¸óãBoﬁC⁄fig
("jemÆloc-bg-thªad", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
jemÆloc_bg_thªad
, 1, NULL, 
upd©eJemÆlocBgThªad
),

2118 
¸óãBoﬁC⁄fig
("a˘ivede‰ag", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
a˘ive_de‰ag_íabÀd
, 0, 
isVÆidA˘iveDe‰ag
, NULL),

2119 
¸óãBoﬁC⁄fig
("sy¶og-íabÀd", 
NULL
, 
IMMUTABLE_CONFIG
, 
£rvî
.
sy¶og_íabÀd
, 0, NULL, NULL),

2120 
¸óãBoﬁC⁄fig
("˛u°î-íabÀd", 
NULL
, 
IMMUTABLE_CONFIG
, 
£rvî
.
˛u°î_íabÀd
, 0, NULL, NULL),

2121 
¸óãBoﬁC⁄fig
("≠≥nd⁄ly", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
aof_íabÀd
, 0, NULL, 
upd©eAµíd⁄ly
),

2122 
¸óãBoﬁC⁄fig
("˛u°î-Ælow-ªads-whí-down", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
˛u°î_Ælow_ªads_whí_down
, 0, NULL, NULL),

2126 
¸óãSåögC⁄fig
("a˛fûe", 
NULL
, 
IMMUTABLE_CONFIG
, 
ALLOW_EMPTY_STRING
, 
£rvî
.
a˛_fûíame
, "", NULL, NULL),

2127 
¸óãSåögC⁄fig
("unixsockë", 
NULL
, 
IMMUTABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
unixsockë
, NULL, NULL, NULL),

2128 
¸óãSåögC⁄fig
("pidfûe", 
NULL
, 
IMMUTABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
pidfûe
, NULL, NULL, NULL),

2129 
¸óãSåögC⁄fig
("ª∂iˇ-™noun˚-ù", "¶ave-™noun˚-ù", 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
¶ave_™noun˚_ù
, 
NULL
, NULL, NULL),

2130 
¸óãSåögC⁄fig
("ma°îu£r", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
ma°îu£r
, NULL, NULL, NULL),

2131 
¸óãSåögC⁄fig
("ma°îauth", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
ma°îauth
, NULL, NULL, NULL),

2132 
¸óãSåögC⁄fig
("˛u°î-™noun˚-ù", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
˛u°î_™noun˚_ù
, NULL, NULL, NULL),

2133 
¸óãSåögC⁄fig
("sy¶og-idít", 
NULL
, 
IMMUTABLE_CONFIG
, 
ALLOW_EMPTY_STRING
, 
£rvî
.
sy¶og_idít
, "redis", NULL, NULL),

2134 
¸óãSåögC⁄fig
("dbfûíame", 
NULL
, 
MODIFIABLE_CONFIG
, 
ALLOW_EMPTY_STRING
, 
£rvî
.
rdb_fûíame
, "dump.rdb", 
isVÆidDBfûíame
, NULL),

2135 
¸óãSåögC⁄fig
("≠≥ndfûíame", 
NULL
, 
IMMUTABLE_CONFIG
, 
ALLOW_EMPTY_STRING
, 
£rvî
.
aof_fûíame
, "≠≥nd⁄ly.aof", 
isVÆidAOFfûíame
, NULL),

2136 
¸óãSåögC⁄fig
("£rvî_˝uli°", 
NULL
, 
IMMUTABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
£rvî_˝uli°
, NULL, NULL, NULL),

2137 
¸óãSåögC⁄fig
("bio_˝uli°", 
NULL
, 
IMMUTABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
bio_˝uli°
, NULL, NULL, NULL),

2138 
¸óãSåögC⁄fig
("aof_ªwrôe_˝uli°", 
NULL
, 
IMMUTABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
aof_ªwrôe_˝uli°
, NULL, NULL, NULL),

2139 
¸óãSåögC⁄fig
("bgßve_˝uli°", 
NULL
, 
IMMUTABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
bgßve_˝uli°
, NULL, NULL, NULL),

2142 
¸óãEnumC⁄fig
("su≥rvi£d", 
NULL
, 
IMMUTABLE_CONFIG
, 
su≥rvi£d_mode_íum
, 
£rvî
.
su≥rvi£d_mode
, 
SUPERVISED_NONE
, NULL, NULL),

2143 
¸óãEnumC⁄fig
("sy¶og-Ácûôy", 
NULL
, 
IMMUTABLE_CONFIG
, 
sy¶og_Ácûôy_íum
, 
£rvî
.
sy¶og_Ácûôy
, 
LOG_LOCAL0
, NULL, NULL),

2144 
¸óãEnumC⁄fig
("ª∂-diskÀss-lﬂd", 
NULL
, 
MODIFIABLE_CONFIG
, 
ª∂_diskÀss_lﬂd_íum
, 
£rvî
.
ª∂_diskÀss_lﬂd
, 
REPL_DISKLESS_LOAD_DISABLED
, NULL, NULL),

2145 
¸óãEnumC⁄fig
("logÀvñ", 
NULL
, 
MODIFIABLE_CONFIG
, 
logÀvñ_íum
, 
£rvî
.
vîbosôy
, 
LL_NOTICE
, NULL, NULL),

2146 
¸óãEnumC⁄fig
("maxmem‹y-pﬁicy", 
NULL
, 
MODIFIABLE_CONFIG
, 
maxmem‹y_pﬁicy_íum
, 
£rvî
.
maxmem‹y_pﬁicy
, 
MAXMEMORY_NO_EVICTION
, NULL, NULL),

2147 
¸óãEnumC⁄fig
("≠≥ndfsync", 
NULL
, 
MODIFIABLE_CONFIG
, 
aof_fsync_íum
, 
£rvî
.
aof_fsync
, 
AOF_FSYNC_EVERYSEC
, NULL, NULL),

2150 
¸óãI¡C⁄fig
("d©aba£s", 
NULL
, 
IMMUTABLE_CONFIG
, 1, 
INT_MAX
, 
£rvî
.
dbnum
, 16, 
INTEGER_CONFIG
, NULL, NULL),

2151 
¸óãI¡C⁄fig
("p‹t", 
NULL
, 
IMMUTABLE_CONFIG
, 0, 65535, 
£rvî
.
p‹t
, 6379, 
INTEGER_CONFIG
, NULL, NULL),

2152 
¸óãI¡C⁄fig
("io-thªads", 
NULL
, 
IMMUTABLE_CONFIG
, 1, 128, 
£rvî
.
io_thªads_num
, 1, 
INTEGER_CONFIG
, NULL, NULL),

2153 
¸óãI¡C⁄fig
("auto-aof-ªwrôe-≥r˚¡age", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
aof_ªwrôe_≥rc
, 100, 
INTEGER_CONFIG
, NULL, NULL),

2154 
¸óãI¡C⁄fig
("˛u°î-ª∂iˇ-vÆidôy-Á˘‹", "˛u°î-¶ave-vÆidôy-Á˘‹", 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
˛u°î_¶ave_vÆidôy_Á˘‹
, 10, 
INTEGER_CONFIG
, 
NULL
, NULL),

2155 
¸óãI¡C⁄fig
("li°-max-zùli°-size", 
NULL
, 
MODIFIABLE_CONFIG
, 
INT_MIN
, 
INT_MAX
, 
£rvî
.
li°_max_zùli°_size
, -2, 
INTEGER_CONFIG
, NULL, NULL),

2156 
¸óãI¡C⁄fig
("t˝-kì∑live", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
t˝kì∑live
, 300, 
INTEGER_CONFIG
, NULL, NULL),

2157 
¸óãI¡C⁄fig
("˛u°î-migøti⁄-b¨rõr", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
˛u°î_migøti⁄_b¨rõr
, 1, 
INTEGER_CONFIG
, NULL, NULL),

2158 
¸óãI¡C⁄fig
("a˘ive-de‰ag-cy˛e-mö", 
NULL
, 
MODIFIABLE_CONFIG
, 1, 99, 
£rvî
.
a˘ive_de‰ag_cy˛e_mö
, 1, 
INTEGER_CONFIG
, NULL, NULL),

2159 
¸óãI¡C⁄fig
("a˘ive-de‰ag-cy˛e-max", 
NULL
, 
MODIFIABLE_CONFIG
, 1, 99, 
£rvî
.
a˘ive_de‰ag_cy˛e_max
, 25, 
INTEGER_CONFIG
, NULL, NULL),

2160 
¸óãI¡C⁄fig
("a˘ive-de‰ag-thªshﬁd-lowî", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 1000, 
£rvî
.
a˘ive_de‰ag_thªshﬁd_lowî
, 10, 
INTEGER_CONFIG
, NULL, NULL),

2161 
¸óãI¡C⁄fig
("a˘ive-de‰ag-thªshﬁd-uµî", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 1000, 
£rvî
.
a˘ive_de‰ag_thªshﬁd_uµî
, 100, 
INTEGER_CONFIG
, NULL, NULL),

2162 
¸óãI¡C⁄fig
("lfu-log-Á˘‹", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
lfu_log_Á˘‹
, 10, 
INTEGER_CONFIG
, NULL, NULL),

2163 
¸óãI¡C⁄fig
("lfu-deˇy-time", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
lfu_deˇy_time
, 1, 
INTEGER_CONFIG
, NULL, NULL),

2164 
¸óãI¡C⁄fig
("ª∂iˇ-¥i‹ôy", "¶ave-¥i‹ôy", 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
¶ave_¥i‹ôy
, 100, 
INTEGER_CONFIG
, 
NULL
, NULL),

2165 
¸óãI¡C⁄fig
("ª∂-diskÀss-sync-dñay", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
ª∂_diskÀss_sync_dñay
, 5, 
INTEGER_CONFIG
, NULL, NULL),

2166 
¸óãI¡C⁄fig
("maxmem‹y-ßm∂es", 
NULL
, 
MODIFIABLE_CONFIG
, 1, 
INT_MAX
, 
£rvî
.
maxmem‹y_ßm∂es
, 5, 
INTEGER_CONFIG
, NULL, NULL),

2167 
¸óãI¡C⁄fig
("timeout", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
maxidÀtime
, 0, 
INTEGER_CONFIG
, NULL, NULL),

2168 
¸óãI¡C⁄fig
("ª∂iˇ-™noun˚-p‹t", "¶ave-™noun˚-p‹t", 
MODIFIABLE_CONFIG
, 0, 65535, 
£rvî
.
¶ave_™noun˚_p‹t
, 0, 
INTEGER_CONFIG
, 
NULL
, NULL),

2169 
¸óãI¡C⁄fig
("t˝-backlog", 
NULL
, 
IMMUTABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
t˝_backlog
, 511, 
INTEGER_CONFIG
, NULL, NULL),

2170 
¸óãI¡C⁄fig
("˛u°î-™noun˚-bus-p‹t", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 65535, 
£rvî
.
˛u°î_™noun˚_bus_p‹t
, 0, 
INTEGER_CONFIG
, NULL, NULL),

2171 
¸óãI¡C⁄fig
("˛u°î-™noun˚-p‹t", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 65535, 
£rvî
.
˛u°î_™noun˚_p‹t
, 0, 
INTEGER_CONFIG
, NULL, NULL),

2172 
¸óãI¡C⁄fig
("ª∂-timeout", 
NULL
, 
MODIFIABLE_CONFIG
, 1, 
INT_MAX
, 
£rvî
.
ª∂_timeout
, 60, 
INTEGER_CONFIG
, NULL, NULL),

2173 
¸óãI¡C⁄fig
("ª∂-pög-ª∂iˇ-≥riod", "ª∂-pög-¶ave-≥riod", 
MODIFIABLE_CONFIG
, 1, 
INT_MAX
, 
£rvî
.
ª∂_pög_¶ave_≥riod
, 10, 
INTEGER_CONFIG
, 
NULL
, NULL),

2174 
¸óãI¡C⁄fig
("li°-com¥ess-dïth", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
li°_com¥ess_dïth
, 0, 
INTEGER_CONFIG
, NULL, NULL),

2175 
¸óãI¡C⁄fig
("rdb-key-ßve-dñay", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
rdb_key_ßve_dñay
, 0, 
INTEGER_CONFIG
, NULL, NULL),

2176 
¸óãI¡C⁄fig
("key-lﬂd-dñay", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
key_lﬂd_dñay
, 0, 
INTEGER_CONFIG
, NULL, NULL),

2177 
¸óãI¡C⁄fig
("a˘ive-expúe-eff‹t", 
NULL
, 
MODIFIABLE_CONFIG
, 1, 10, 
£rvî
.
a˘ive_expúe_eff‹t
, 1, 
INTEGER_CONFIG
, NULL, NULL),

2178 
¸óãI¡C⁄fig
("hz", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
c⁄fig_hz
, 
CONFIG_DEFAULT_HZ
, 
INTEGER_CONFIG
, NULL, 
upd©eHZ
),

2179 
¸óãI¡C⁄fig
("mö-ª∂iˇs-to-wrôe", "mö-¶aves-to-wrôe", 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
ª∂_mö_¶aves_to_wrôe
, 0, 
INTEGER_CONFIG
, 
NULL
, 
upd©eGoodSœves
),

2180 
¸óãI¡C⁄fig
("mö-ª∂iˇs-max-œg", "mö-¶aves-max-œg", 
MODIFIABLE_CONFIG
, 0, 
INT_MAX
, 
£rvî
.
ª∂_mö_¶aves_max_œg
, 10, 
INTEGER_CONFIG
, 
NULL
, 
upd©eGoodSœves
),

2183 
¸óãUI¡C⁄fig
("max˛õ¡s", 
NULL
, 
MODIFIABLE_CONFIG
, 1, 
UINT_MAX
, 
£rvî
.
max˛õ¡s
, 10000, 
INTEGER_CONFIG
, NULL, 
upd©eMax˛õ¡s
),

2186 
¸óãUL⁄gC⁄fig
("a˘ive-de‰ag-max-sˇn-fõlds", 
NULL
, 
MODIFIABLE_CONFIG
, 1, 
LONG_MAX
, 
£rvî
.
a˘ive_de‰ag_max_sˇn_fõlds
, 1000, 
INTEGER_CONFIG
, NULL, NULL),

2187 
¸óãUL⁄gC⁄fig
("¶owlog-max-Àn", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
¶owlog_max_Àn
, 128, 
INTEGER_CONFIG
, NULL, NULL),

2188 
¸óãUL⁄gC⁄fig
("a˛log-max-Àn", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
a˛log_max_Àn
, 128, 
INTEGER_CONFIG
, NULL, NULL),

2191 
¸óãL⁄gL⁄gC⁄fig
("lua-time-limô", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
lua_time_limô
, 5000, 
INTEGER_CONFIG
, NULL, NULL),

2192 
¸óãL⁄gL⁄gC⁄fig
("˛u°î-node-timeout", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LLONG_MAX
, 
£rvî
.
˛u°î_node_timeout
, 15000, 
INTEGER_CONFIG
, NULL, NULL),

2193 
¸óãL⁄gL⁄gC⁄fig
("¶owlog-log-¶owî-th™", 
NULL
, 
MODIFIABLE_CONFIG
, -1, 
LLONG_MAX
, 
£rvî
.
¶owlog_log_¶owî_th™
, 10000, 
INTEGER_CONFIG
, NULL, NULL),

2194 
¸óãL⁄gL⁄gC⁄fig
("œãncy-m⁄ô‹-thªshﬁd", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LLONG_MAX
, 
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
, 0, 
INTEGER_CONFIG
, NULL, NULL),

2195 
¸óãL⁄gL⁄gC⁄fig
("¥Ÿo-max-bulk-Àn", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LLONG_MAX
, 
£rvî
.
¥Ÿo_max_bulk_Àn
, 512Œ*1024*1024, 
MEMORY_CONFIG
, NULL, NULL),

2196 
¸óãL⁄gL⁄gC⁄fig
("°ªam-node-max-íåõs", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LLONG_MAX
, 
£rvî
.
°ªam_node_max_íåõs
, 100, 
INTEGER_CONFIG
, NULL, NULL),

2197 
¸óãL⁄gL⁄gC⁄fig
("ª∂-backlog-size", 
NULL
, 
MODIFIABLE_CONFIG
, 1, 
LLONG_MAX
, 
£rvî
.
ª∂_backlog_size
, 1024*1024, 
MEMORY_CONFIG
, NULL, 
upd©eRïlBacklogSize
),

2200 
¸óãUL⁄gL⁄gC⁄fig
("maxmem‹y", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
ULLONG_MAX
, 
£rvî
.
maxmem‹y
, 0, 
MEMORY_CONFIG
, NULL, 
upd©eMaxmem‹y
),

2203 
¸óãSizeTC⁄fig
("hash-max-zùli°-íåõs", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
hash_max_zùli°_íåõs
, 512, 
INTEGER_CONFIG
, NULL, NULL),

2204 
¸óãSizeTC⁄fig
("£t-max-öt£t-íåõs", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
£t_max_öt£t_íåõs
, 512, 
INTEGER_CONFIG
, NULL, NULL),

2205 
¸óãSizeTC⁄fig
("z£t-max-zùli°-íåõs", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
z£t_max_zùli°_íåõs
, 128, 
INTEGER_CONFIG
, NULL, NULL),

2206 
¸óãSizeTC⁄fig
("a˘ive-de‰ag-ign‹e-byãs", 
NULL
, 
MODIFIABLE_CONFIG
, 1, 
LLONG_MAX
, 
£rvî
.
a˘ive_de‰ag_ign‹e_byãs
, 100<<20, 
MEMORY_CONFIG
, NULL, NULL),

2207 
¸óãSizeTC⁄fig
("hash-max-zùli°-vÆue", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
hash_max_zùli°_vÆue
, 64, 
MEMORY_CONFIG
, NULL, NULL),

2208 
¸óãSizeTC⁄fig
("°ªam-node-max-byãs", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
°ªam_node_max_byãs
, 4096, 
MEMORY_CONFIG
, NULL, NULL),

2209 
¸óãSizeTC⁄fig
("z£t-max-zùli°-vÆue", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
z£t_max_zùli°_vÆue
, 64, 
MEMORY_CONFIG
, NULL, NULL),

2210 
¸óãSizeTC⁄fig
("hŒ-•¨£-max-byãs", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
hŒ_•¨£_max_byãs
, 3000, 
MEMORY_CONFIG
, NULL, NULL),

2211 
¸óãSizeTC⁄fig
("åackög-èbÀ-max-keys", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
åackög_èbÀ_max_keys
, 1000000, 
INTEGER_CONFIG
, NULL, NULL),

2214 
¸óãTimeTC⁄fig
("ª∂-backlog-âl", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LONG_MAX
, 
£rvî
.
ª∂_backlog_time_limô
, 60*60, 
INTEGER_CONFIG
, NULL, NULL),

2215 
¸óãOffTC⁄fig
("auto-aof-ªwrôe-mö-size", 
NULL
, 
MODIFIABLE_CONFIG
, 0, 
LLONG_MAX
, 
£rvî
.
aof_ªwrôe_mö_size
, 64*1024*1024, 
MEMORY_CONFIG
, NULL, NULL),

2217 #ifde‡
USE_OPENSSL


2218 
¸óãI¡C⁄fig
("és-p‹t", 
NULL
, 
IMMUTABLE_CONFIG
, 0, 65535, 
£rvî
.
és_p‹t
, 0, 
INTEGER_CONFIG
, NULL, NULL),

2219 
¸óãBoﬁC⁄fig
("és-˛u°î", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
és_˛u°î
, 0, NULL, NULL),

2220 
¸óãBoﬁC⁄fig
("és-ª∂iˇti⁄", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
és_ª∂iˇti⁄
, 0, NULL, NULL),

2221 
¸óãBoﬁC⁄fig
("és-auth-˛õ¡s", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
és_auth_˛õ¡s
, 1, NULL, NULL),

2222 
¸óãBoﬁC⁄fig
("és-¥e„r-£rvî-cùhîs", 
NULL
, 
MODIFIABLE_CONFIG
, 
£rvî
.
és_˘x_c⁄fig
.
¥e„r_£rvî_cùhîs
, 0, NULL, 
upd©eTlsCfgBoﬁ
),

2223 
¸óãSåögC⁄fig
("és-˚π-fûe", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
és_˘x_c⁄fig
.
˚π_fûe
, NULL, NULL, 
upd©eTlsCfg
),

2224 
¸óãSåögC⁄fig
("és-key-fûe", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
és_˘x_c⁄fig
.
key_fûe
, NULL, NULL, 
upd©eTlsCfg
),

2225 
¸óãSåögC⁄fig
("és-dh-∑øms-fûe", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
és_˘x_c⁄fig
.
dh_∑øms_fûe
, NULL, NULL, 
upd©eTlsCfg
),

2226 
¸óãSåögC⁄fig
("és-ˇ-˚π-fûe", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
és_˘x_c⁄fig
.
ˇ_˚π_fûe
, NULL, NULL, 
upd©eTlsCfg
),

2227 
¸óãSåögC⁄fig
("és-ˇ-˚π-dú", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
és_˘x_c⁄fig
.
ˇ_˚π_dú
, NULL, NULL, 
upd©eTlsCfg
),

2228 
¸óãSåögC⁄fig
("és-¥Ÿocﬁs", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
és_˘x_c⁄fig
.
¥Ÿocﬁs
, NULL, NULL, 
upd©eTlsCfg
),

2229 
¸óãSåögC⁄fig
("és-cùhîs", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
és_˘x_c⁄fig
.
cùhîs
, NULL, NULL, 
upd©eTlsCfg
),

2230 
¸óãSåögC⁄fig
("és-cùhîsuôes", 
NULL
, 
MODIFIABLE_CONFIG
, 
EMPTY_STRING_IS_NULL
, 
£rvî
.
és_˘x_c⁄fig
.
cùhîsuôes
, NULL, NULL, 
upd©eTlsCfg
),

2234 {
NULL
}

2241 
	$c⁄figComm™d
(
˛õ¡
 *
c
) {

2243 i‡(
£rvî
.
lﬂdög
 && 
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"get")) {

2244 
	`addRïlyEº‹
(
c
,"Only CONFIG GET isállowed duringÜoading");

2248 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"help")) {

2249 c⁄° *
hñp
[] = {

2254 
NULL


2256 
	`addRïlyHñp
(
c
, 
hñp
);

2257 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"£t"Ë&& c->
¨gc
 == 4) {

2258 
	`c⁄figSëComm™d
(
c
);

2259 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"gë"Ë&& c->
¨gc
 == 3) {

2260 
	`c⁄figGëComm™d
(
c
);

2261 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ª£t°©"Ë&& c->
¨gc
 == 2) {

2262 
	`ª£tSîvîSèts
();

2263 
	`ª£tComm™dTabÀSèts
();

2264 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2265 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ªwrôe"Ë&& c->
¨gc
 == 2) {

2266 i‡(
£rvî
.
c⁄figfûe
 =
NULL
) {

2267 
	`addRïlyEº‹
(
c
,"The server isÑunning withoutá config file");

2270 i‡(
	`ªwrôeC⁄fig
(
£rvî
.
c⁄figfûe
) == -1) {

2271 
	`£rvîLog
(
LL_WARNING
,"CONFIG REWRITE faûed: %s", 
	`°ªº‹
(
î∫o
));

2272 
	`addRïlyEº‹F‹m©
(
c
,"Rewrôög c⁄fig fûe: %s", 
	`°ªº‹
(
î∫o
));

2274 
	`£rvîLog
(
LL_WARNING
,"CONFIG REWRITEÉxecuted with success.");

2275 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2278 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

2281 
	}
}

	@config.h

30 #i‚de‡
__CONFIG_H


31 
	#__CONFIG_H


	)

33 #ifde‡
__APPLE__


34 
	~<AvaûabûôyMa¸os.h
>

37 #ifde‡
__löux__


38 
	~<löux/vîsi⁄.h
>

39 
	~<„©uªs.h
>

43 #i‡
deföed
(
__APPLE__
Ë&& !deföed(
MAC_OS_X_VERSION_10_6
)

44 
	#ªdis_f°©
 
f°©64


	)

45 
	#ªdis_°©
 
°©64


	)

47 
	#ªdis_f°©
 
f°©


	)

48 
	#ªdis_°©
 
°©


	)

52 #ifde‡
__löux__


53 
	#HAVE_PROC_STAT
 1

	)

54 
	#HAVE_PROC_MAPS
 1

	)

55 
	#HAVE_PROC_SMAPS
 1

	)

56 
	#HAVE_PROC_SOMAXCONN
 1

	)

60 #i‡
deföed
(
__APPLE__
)

61 
	#HAVE_TASKINFO
 1

	)

65 #i‡
deföed
(
__APPLE__
Ë|| (deföed(
__löux__
Ë&& deföed(
__GLIBC__
)) || \

66 
deföed
(
__FªeBSD__
Ë|| (deföed(
__O≥nBSD__
Ë&& deföed(
USE_BACKTRACE
))\

67 || 
	$deföed
(
__Døg⁄Fly__
)

68 
	#HAVE_BACKTRACE
 1

	)

72 #ifde‡
__löux__


73 
	#HAVE_MSG_NOSIGNAL
 1

	)

77 #ifde‡
__löux__


78 
	#HAVE_EPOLL
 1

	)

81 #i‡(
	`deföed
(
__APPLE__
Ë&& deföed(
MAC_OS_X_VERSION_10_6
)Ë|| deföed(
__FªeBSD__
Ë|| deföed(
__O≥nBSD__
Ë|| deföed (
__NëBSD__
)

82 
	#HAVE_KQUEUE
 1

	)

85 #ifde‡
__sun


86 
	~<sys/„©uª_ã°s.h
>

87 #ifde‡
_DTRACE_VERSION


88 
	#HAVE_EVPORT
 1

	)

93 #ifde‡
__löux__


94 
	#ªdis_fsync
 
fd©async


	)

96 
	#ªdis_fsync
 
fsync


	)

101 #ifde‡
__löux__


102 #i‡
	`deföed
(
__GLIBC__
Ë&& deföed(
__GLIBC_PREREQ
)

103 #i‡(
LINUX_VERSION_CODE
 >0x020611 && 
	`__GLIBC_PREREQ
(2, 6))

104 
	#HAVE_SYNC_FILE_RANGE
 1

	)

107 #i‡(
LINUX_VERSION_CODE
 >= 0x020611)

108 
	#HAVE_SYNC_FILE_RANGE
 1

	)

113 #ifde‡
HAVE_SYNC_FILE_RANGE


114 
	#rdb_fsync_ønge
(
fd
,
off
,
size
Ë
	`sync_fûe_ønge
(fd,off,size,
SYNC_FILE_RANGE_WAIT_BEFORE
|
SYNC_FILE_RANGE_WRITE
)

	)

116 
	#rdb_fsync_ønge
(
fd
,
off
,
size
Ë
	`fsync
(fd)

	)

122 #i‡(
deföed
 
__NëBSD__
 || deföed 
__FªeBSD__
 || deföed 
__O≥nBSD__
)

123 
	#USE_SETPROCTITLE


	)

126 #i‡((
deföed
 
__löux
 && 
	`deföed
(
__GLIBC__
)Ë|| deföed 
__APPLE__
)

127 
	#USE_SETPROCTITLE


	)

128 
	#INIT_SETPROCTITLE_REPLACEMENT


	)

129 
	`•t_öô
(
¨gc
, *
¨gv
[]);

130 
	`£çro˘ôÀ
(c⁄° *
fmt
, ...);

134 
	~<sys/ty≥s.h
>

136 #i‚de‡
BYTE_ORDER


137 #i‡(
BSD
 >= 199103)

138 
	~<machöe/ídün.h
>

140 #i‡
	`deföed
(
löux
Ë|| deföed(
__löux__
)

141 
	~<ídün.h
>

143 
	#LITTLE_ENDIAN
 1234

	)

144 
	#BIG_ENDIAN
 4321

	)

145 
	#PDP_ENDIAN
 3412

	)

147 #i‡
	`deföed
(
__i386__
Ë|| deföed(
__x86_64__
Ë|| deföed(
__amd64__
) || \

148 
	`deföed
(
vax
Ë|| deföed(
ns32000
Ë|| deföed(
sun386
) || \

149 
	`deföed
(
MIPSEL
Ë|| deföed(
_MIPSEL
Ë|| deföed(
BIT_ZERO_ON_RIGHT
) || \

150 
	`deföed
(
__Æpha__
Ë|| 
	$deföed
(
__Æpha
)

151 
	#BYTE_ORDER
 
LITTLE_ENDIAN


	)

154 #i‡
	`deföed
(
£l
Ë|| deföed(
pyr
Ë|| deföed(
mc68000
Ë|| deföed(
•¨c
) || \

155 
	`deföed
(
is68k
Ë|| deföed(
èh€
Ë|| deföed(
ibm032
Ë|| deföed(
ibm370
) || \

156 
	`deföed
(
MIPSEB
Ë|| deföed(
_MIPSEB
Ë|| deföed(
_IBMR2
Ë|| deföed(
DGUX
) ||\

157 
	`deföed
(
≠ﬁlo
Ë|| deföed(
__c⁄vex__
Ë|| deföed(
_CRAY
) || \

158 
	`deföed
(
__hµa
Ë|| deföed(
__hp9000
) || \

159 
	`deföed
(
__hp9000s300
Ë|| deföed(
__hp9000s700
) || \

160 
	`deföed
 (
BIT_ZERO_ON_LEFT
Ë|| deföed(
m68k
Ë|| 
	$deföed
(
__•¨c
)

161 
	#BYTE_ORDER
 
BIG_ENDIAN


	)

171 #i‚de‡
BYTE_ORDER


172 #ifde‡
__BYTE_ORDER


173 #i‡
	`deföed
(
__LITTLE_ENDIAN
Ë&& deföed(
__BIG_ENDIAN
)

174 #i‚de‡
LITTLE_ENDIAN


175 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

177 #i‚de‡
BIG_ENDIAN


178 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

180 #i‡(
__BYTE_ORDER
 =
__LITTLE_ENDIAN
)

181 
	#BYTE_ORDER
 
LITTLE_ENDIAN


	)

183 
	#BYTE_ORDER
 
BIG_ENDIAN


	)

189 #i‡!
	`deföed
(
BYTE_ORDER
) || \

190 (
BYTE_ORDER
 !
BIG_ENDIAN
 && BYTE_ORDER !
LITTLE_ENDIAN
)

199 #i‡(
__i386
 || 
__amd64
 || 
__powîpc__
Ë&& 
__GNUC__


200 
	#GNUC_VERSION
 (
__GNUC__
 * 10000 + 
__GNUC_MINOR__
 * 100 + 
__GNUC_PATCHLEVEL__
)

	)

201 #i‡
	`deföed
(
__˛™g__
)

202 
	#HAVE_ATOMIC


	)

204 #i‡(
	`deföed
(
__GLIBC__
Ë&& deföed(
__GLIBC_PREREQ
))

205 #i‡(
GNUC_VERSION
 >40100 && 
	`__GLIBC_PREREQ
(2, 6))

206 
	#HAVE_ATOMIC


	)

213 #i‡
	`deföed
(
__¨m
Ë&& !deföed(
__¨m__
)

214 
	#__¨m__


	)

216 #i‡
	`deföed
 (
__Ørch64__
Ë&& !deföed(
__¨m64__
)

217 
	#__¨m64__


	)

221 #i‡
	`deföed
(
__•¨c
Ë&& !deföed(
__•¨c__
)

222 
	#__•¨c__


	)

225 #i‡
	`deföed
(
__•¨c__
Ë|| deföed(
__¨m__
)

226 
	#USE_ALIGNED_ACCESS


	)

230 #ifde‡
__löux__


231 
	#ªdis_£t_thªad_tôÀ
(
«me
Ë
	`±hªad_£äame_≈
(
	`±hªad_£lf
(),Çame)

	)

233 #i‡(
deföed
 
__FªeBSD__
 || deföed 
__O≥nBSD__
)

234 
	~<±hªad_≈.h
>

235 
	#ªdis_£t_thªad_tôÀ
(
«me
Ë
	`±hªad_£t_«me_≈
(
	`±hªad_£lf
(),Çame)

	)

236 #ñi‡
deföed
 
__NëBSD__


237 
	~<±hªad.h
>

238 
	#ªdis_£t_thªad_tôÀ
(
«me
Ë
	`±hªad_£äame_≈
(
	`±hªad_£lf
(),Çame, 
NULL
)

	)

240 #i‡(
deföed
 
__APPLE__
 && 
	`deföed
(
MAC_OS_X_VERSION_10_7
))

241 
	`±hªad_£äame_≈
(c⁄° *
«me
);

242 
	~<±hªad.h
>

243 
	#ªdis_£t_thªad_tôÀ
(
«me
Ë
	`±hªad_£äame_≈
“ame)

	)

245 
	#ªdis_£t_thªad_tôÀ
(
«me
)

	)

251 #i‡(
deföed
 
__löux
 || deföed 
__NëBSD__
 || deföed 
__FªeBSD__
)

252 
	#USE_SETCPUAFFINITY


	)

253 
	`£t˝uafföôy
(c⁄° *
˝uli°
);

	@connection.c

30 
	~"£rvî.h
"

31 
	~"c⁄nhñ≥rs.h
"

52 
C⁄√˘i⁄Ty≥
 
	gCT_Sockë
;

77 
c⁄√˘i⁄
 *
	$c⁄nCª©eSockë
() {

78 
c⁄√˘i⁄
 *
c⁄n
 = 
	`zˇŒoc
((connection));

79 
c⁄n
->
ty≥
 = &
CT_Sockë
;

80 
c⁄n
->
fd
 = -1;

82  
c⁄n
;

83 
	}
}

91 
c⁄√˘i⁄
 *
	$c⁄nCª©eAc˚±edSockë
(
fd
) {

92 
c⁄√˘i⁄
 *
c⁄n
 = 
	`c⁄nCª©eSockë
();

93 
c⁄n
->
fd
 = fd;

94 
c⁄n
->
°©e
 = 
CONN_STATE_ACCEPTING
;

95  
c⁄n
;

96 
	}
}

98 
	$c⁄nSockëC⁄√˘
(
c⁄√˘i⁄
 *
c⁄n
, c⁄° *
addr
, 
p‹t
, c⁄° *
§c_addr
,

99 
C⁄√˘i⁄CÆlbackFunc
 
c⁄√˘_h™dÀr
) {

100 
fd
 = 
	`™ëT˝N⁄BlockBe°Eff‹tBödC⁄√˘
(
NULL
,
addr
,
p‹t
,
§c_addr
);

101 i‡(
fd
 == -1) {

102 
c⁄n
->
°©e
 = 
CONN_STATE_ERROR
;

103 
c⁄n
->
œ°_î∫o
 = 
î∫o
;

104  
C_ERR
;

107 
c⁄n
->
fd
 = fd;

108 
c⁄n
->
°©e
 = 
CONN_STATE_CONNECTING
;

110 
c⁄n
->
c⁄n_h™dÀr
 = 
c⁄√˘_h™dÀr
;

111 
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, 
c⁄n
->
fd
, 
AE_WRITABLE
,

112 
c⁄n
->
ty≥
->
´_h™dÀr
, conn);

114  
C_OK
;

115 
	}
}

118 
	$c⁄nHasWrôeH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
) {

119  
c⁄n
->
wrôe_h™dÀr
 !
NULL
;

120 
	}
}

123 
	$c⁄nHasRódH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
) {

124  
c⁄n
->
ªad_h™dÀr
 !
NULL
;

125 
	}
}

128 
	$c⁄nSëPriv©eD©a
(
c⁄√˘i⁄
 *
c⁄n
, *
d©a
) {

129 
c⁄n
->
¥iv©e_d©a
 = 
d©a
;

130 
	}
}

133 *
	$c⁄nGëPriv©eD©a
(
c⁄√˘i⁄
 *
c⁄n
) {

134  
c⁄n
->
¥iv©e_d©a
;

135 
	}
}

144 
	$c⁄nSockëClo£
(
c⁄√˘i⁄
 *
c⁄n
) {

145 i‡(
c⁄n
->
fd
 != -1) {

146 
	`´DñëeFûeEvít
(
£rvî
.
ñ
,
c⁄n
->
fd
,
AE_READABLE
);

147 
	`´DñëeFûeEvít
(
£rvî
.
ñ
,
c⁄n
->
fd
,
AE_WRITABLE
);

148 
	`˛o£
(
c⁄n
->
fd
);

149 
c⁄n
->
fd
 = -1;

155 i‡(
	`c⁄nHasRefs
(
c⁄n
)) {

156 
c⁄n
->
Êags
 |
CONN_FLAG_CLOSE_SCHEDULED
;

160 
	`z‰ì
(
c⁄n
);

161 
	}
}

163 
	$c⁄nSockëWrôe
(
c⁄√˘i⁄
 *
c⁄n
, c⁄° *
d©a
, 
size_t
 
d©a_Àn
) {

164 
ªt
 = 
	`wrôe
(
c⁄n
->
fd
, 
d©a
, 
d©a_Àn
);

165 i‡(
ªt
 < 0 && 
î∫o
 !
EAGAIN
) {

166 
c⁄n
->
œ°_î∫o
 = 
î∫o
;

167 
c⁄n
->
°©e
 = 
CONN_STATE_ERROR
;

170  
ªt
;

171 
	}
}

173 
	$c⁄nSockëRód
(
c⁄√˘i⁄
 *
c⁄n
, *
buf
, 
size_t
 
buf_Àn
) {

174 
ªt
 = 
	`ªad
(
c⁄n
->
fd
, 
buf
, 
buf_Àn
);

175 i‡(!
ªt
) {

176 
c⁄n
->
°©e
 = 
CONN_STATE_CLOSED
;

177 } i‡(
ªt
 < 0 && 
î∫o
 !
EAGAIN
) {

178 
c⁄n
->
œ°_î∫o
 = 
î∫o
;

179 
c⁄n
->
°©e
 = 
CONN_STATE_ERROR
;

182  
ªt
;

183 
	}
}

185 
	$c⁄nSockëAc˚±
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
ac˚±_h™dÀr
) {

186 
ªt
 = 
C_OK
;

188 i‡(
c⁄n
->
°©e
 !
CONN_STATE_ACCEPTING
Ë 
C_ERR
;

189 
c⁄n
->
°©e
 = 
CONN_STATE_CONNECTED
;

191 
	`c⁄nIn¸Refs
(
c⁄n
);

192 i‡(!
	`ˇŒH™dÀr
(
c⁄n
, 
ac˚±_h™dÀr
)Ë
ªt
 = 
C_ERR
;

193 
	`c⁄nDe¸Refs
(
c⁄n
);

195  
ªt
;

196 
	}
}

206 
	$c⁄nSockëSëWrôeH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
func
, 
b¨rõr
) {

207 i‡(
func
 =
c⁄n
->
wrôe_h™dÀr
Ë 
C_OK
;

209 
c⁄n
->
wrôe_h™dÀr
 = 
func
;

210 i‡(
b¨rõr
)

211 
c⁄n
->
Êags
 |
CONN_FLAG_WRITE_BARRIER
;

213 
c⁄n
->
Êags
 &~
CONN_FLAG_WRITE_BARRIER
;

214 i‡(!
c⁄n
->
wrôe_h™dÀr
)

215 
	`´DñëeFûeEvít
(
£rvî
.
ñ
,
c⁄n
->
fd
,
AE_WRITABLE
);

217 i‡(
	`´Cª©eFûeEvít
(
£rvî
.
ñ
,
c⁄n
->
fd
,
AE_WRITABLE
,

218 
c⁄n
->
ty≥
->
´_h™dÀr
,c⁄nË=
AE_ERR
Ë 
C_ERR
;

219  
C_OK
;

220 
	}
}

225 
	$c⁄nSockëSëRódH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
func
) {

226 i‡(
func
 =
c⁄n
->
ªad_h™dÀr
Ë 
C_OK
;

228 
c⁄n
->
ªad_h™dÀr
 = 
func
;

229 i‡(!
c⁄n
->
ªad_h™dÀr
)

230 
	`´DñëeFûeEvít
(
£rvî
.
ñ
,
c⁄n
->
fd
,
AE_READABLE
);

232 i‡(
	`´Cª©eFûeEvít
(
£rvî
.
ñ
,
c⁄n
->
fd
,

233 
AE_READABLE
,
c⁄n
->
ty≥
->
´_h™dÀr
,c⁄nË=
AE_ERR
Ë 
C_ERR
;

234  
C_OK
;

235 
	}
}

237 c⁄° *
	$c⁄nSockëGëLa°Eº‹
(
c⁄√˘i⁄
 *
c⁄n
) {

238  
	`°ªº‹
(
c⁄n
->
œ°_î∫o
);

239 
	}
}

241 
	$c⁄nSockëEvítH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
˛õ¡D©a
, 
mask
)

243 
	`UNUSED
(
ñ
);

244 
	`UNUSED
(
fd
);

245 
c⁄√˘i⁄
 *
c⁄n
 = 
˛õ¡D©a
;

247 i‡(
c⁄n
->
°©e
 =
CONN_STATE_CONNECTING
 &&

248 (
mask
 & 
AE_WRITABLE
Ë&& 
c⁄n
->
c⁄n_h™dÀr
) {

250 i‡(
	`c⁄nGëSockëEº‹
(
c⁄n
)) {

251 
c⁄n
->
œ°_î∫o
 = 
î∫o
;

252 
c⁄n
->
°©e
 = 
CONN_STATE_ERROR
;

254 
c⁄n
->
°©e
 = 
CONN_STATE_CONNECTED
;

257 i‡(!
c⁄n
->
wrôe_h™dÀr
Ë
	`´DñëeFûeEvít
(
£rvî
.
ñ
,c⁄n->
fd
,
AE_WRITABLE
);

259 i‡(!
	`ˇŒH™dÀr
(
c⁄n
, c⁄n->
c⁄n_h™dÀr
)) ;

260 
c⁄n
->
c⁄n_h™dÀr
 = 
NULL
;

274 
övît
 = 
c⁄n
->
Êags
 & 
CONN_FLAG_WRITE_BARRIER
;

276 
ˇŒ_wrôe
 = (
mask
 & 
AE_WRITABLE
Ë&& 
c⁄n
->
wrôe_h™dÀr
;

277 
ˇŒ_ªad
 = (
mask
 & 
AE_READABLE
Ë&& 
c⁄n
->
ªad_h™dÀr
;

280 i‡(!
övît
 && 
ˇŒ_ªad
) {

281 i‡(!
	`ˇŒH™dÀr
(
c⁄n
, c⁄n->
ªad_h™dÀr
)) ;

284 i‡(
ˇŒ_wrôe
) {

285 i‡(!
	`ˇŒH™dÀr
(
c⁄n
, c⁄n->
wrôe_h™dÀr
)) ;

289 i‡(
övît
 && 
ˇŒ_ªad
) {

290 i‡(!
	`ˇŒH™dÀr
(
c⁄n
, c⁄n->
ªad_h™dÀr
)) ;

292 
	}
}

294 
	$c⁄nSockëBlockögC⁄√˘
(
c⁄√˘i⁄
 *
c⁄n
, c⁄° *
addr
, 
p‹t
, 
timeout
) {

295 
fd
 = 
	`™ëT˝N⁄BlockC⁄√˘
(
NULL
,
addr
,
p‹t
);

296 i‡(
fd
 == -1) {

297 
c⁄n
->
°©e
 = 
CONN_STATE_ERROR
;

298 
c⁄n
->
œ°_î∫o
 = 
î∫o
;

299  
C_ERR
;

302 i‡((
	`´Waô
(
fd
, 
AE_WRITABLE
, 
timeout
) & AE_WRITABLE) == 0) {

303 
c⁄n
->
°©e
 = 
CONN_STATE_ERROR
;

304 
c⁄n
->
œ°_î∫o
 = 
ETIMEDOUT
;

307 
c⁄n
->
fd
 = fd;

308 
c⁄n
->
°©e
 = 
CONN_STATE_CONNECTED
;

309  
C_OK
;

310 
	}
}

316 
ssize_t
 
	$c⁄nSockëSyncWrôe
(
c⁄√˘i⁄
 *
c⁄n
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

317  
	`syncWrôe
(
c⁄n
->
fd
, 
±r
, 
size
, 
timeout
);

318 
	}
}

320 
ssize_t
 
	$c⁄nSockëSyncRód
(
c⁄√˘i⁄
 *
c⁄n
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

321  
	`syncRód
(
c⁄n
->
fd
, 
±r
, 
size
, 
timeout
);

322 
	}
}

324 
ssize_t
 
	$c⁄nSockëSyncRódLöe
(
c⁄√˘i⁄
 *
c⁄n
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

325  
	`syncRódLöe
(
c⁄n
->
fd
, 
±r
, 
size
, 
timeout
);

326 
	}
}

329 
C⁄√˘i⁄Ty≥
 
	gCT_Sockë
 = {

330 .
´_h™dÀr
 = 
c⁄nSockëEvítH™dÀr
,

331 .
	g˛o£
 = 
c⁄nSockëClo£
,

332 .
	gwrôe
 = 
c⁄nSockëWrôe
,

333 .
	gªad
 = 
c⁄nSockëRód
,

334 .
	gac˚±
 = 
c⁄nSockëAc˚±
,

335 .
	gc⁄√˘
 = 
c⁄nSockëC⁄√˘
,

336 .
	g£t_wrôe_h™dÀr
 = 
c⁄nSockëSëWrôeH™dÀr
,

337 .
	g£t_ªad_h™dÀr
 = 
c⁄nSockëSëRódH™dÀr
,

338 .
	ggë_œ°_îr‹
 = 
c⁄nSockëGëLa°Eº‹
,

339 .
	gblockög_c⁄√˘
 = 
c⁄nSockëBlockögC⁄√˘
,

340 .
	gsync_wrôe
 = 
c⁄nSockëSyncWrôe
,

341 .
	gsync_ªad
 = 
c⁄nSockëSyncRód
,

342 .
	gsync_ªadlöe
 = 
c⁄nSockëSyncRódLöe


346 
	$c⁄nGëSockëEº‹
(
c⁄√˘i⁄
 *
c⁄n
) {

347 
sockîr
 = 0;

348 
sockÀn_t
 
îæí
 = (
sockîr
);

350 i‡(
	`gësock›t
(
c⁄n
->
fd
, 
SOL_SOCKET
, 
SO_ERROR
, &
sockîr
, &
îæí
) == -1)

351 
sockîr
 = 
î∫o
;

352  
sockîr
;

353 
	}
}

355 
	$c⁄nPìrToSåög
(
c⁄√˘i⁄
 *
c⁄n
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
) {

356  
	`™ëPìrToSåög
(
c⁄n
 ? c⁄n->
fd
 : -1, 
ù
, 
ù_Àn
, 
p‹t
);

357 
	}
}

359 
	$c⁄nF‹m©Pìr
(
c⁄√˘i⁄
 *
c⁄n
, *
buf
, 
size_t
 
buf_Àn
) {

360  
	`™ëF‹m©Pìr
(
c⁄n
 ? c⁄n->
fd
 : -1, 
buf
, 
buf_Àn
);

361 
	}
}

363 
	$c⁄nSockName
(
c⁄√˘i⁄
 *
c⁄n
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
) {

364  
	`™ëSockName
(
c⁄n
->
fd
, 
ù
, 
ù_Àn
, 
p‹t
);

365 
	}
}

367 
	$c⁄nBlock
(
c⁄√˘i⁄
 *
c⁄n
) {

368 i‡(
c⁄n
->
fd
 =-1Ë 
C_ERR
;

369  
	`™ëBlock
(
NULL
, 
c⁄n
->
fd
);

370 
	}
}

372 
	$c⁄nN⁄Block
(
c⁄√˘i⁄
 *
c⁄n
) {

373 i‡(
c⁄n
->
fd
 =-1Ë 
C_ERR
;

374  
	`™ëN⁄Block
(
NULL
, 
c⁄n
->
fd
);

375 
	}
}

377 
	$c⁄nE«bÀT˝NoDñay
(
c⁄√˘i⁄
 *
c⁄n
) {

378 i‡(
c⁄n
->
fd
 =-1Ë 
C_ERR
;

379  
	`™ëE«bÀT˝NoDñay
(
NULL
, 
c⁄n
->
fd
);

380 
	}
}

382 
	$c⁄nDißbÀT˝NoDñay
(
c⁄√˘i⁄
 *
c⁄n
) {

383 i‡(
c⁄n
->
fd
 =-1Ë 
C_ERR
;

384  
	`™ëDißbÀT˝NoDñay
(
NULL
, 
c⁄n
->
fd
);

385 
	}
}

387 
	$c⁄nKìpAlive
(
c⁄√˘i⁄
 *
c⁄n
, 
öãrvÆ
) {

388 i‡(
c⁄n
->
fd
 =-1Ë 
C_ERR
;

389  
	`™ëKìpAlive
(
NULL
, 
c⁄n
->
fd
, 
öãrvÆ
);

390 
	}
}

392 
	$c⁄nSídTimeout
(
c⁄√˘i⁄
 *
c⁄n
, 
ms
) {

393  
	`™ëSídTimeout
(
NULL
, 
c⁄n
->
fd
, 
ms
);

394 
	}
}

396 
	$c⁄nRecvTimeout
(
c⁄√˘i⁄
 *
c⁄n
, 
ms
) {

397  
	`™ëRecvTimeout
(
NULL
, 
c⁄n
->
fd
, 
ms
);

398 
	}
}

400 
	$c⁄nGëSèã
(
c⁄√˘i⁄
 *
c⁄n
) {

401  
c⁄n
->
°©e
;

402 
	}
}

409 c⁄° *
	$c⁄nGëInfo
(
c⁄√˘i⁄
 *
c⁄n
, *
buf
, 
size_t
 
buf_Àn
) {

410 
	`¢¥ötf
(
buf
, 
buf_Àn
-1, "fd=%i", 
c⁄n
->
fd
);

411  
buf
;

412 
	}
}

	@connection.h

31 #i‚de‡
__REDIS_CONNECTION_H


32 
	#__REDIS_CONNECTION_H


	)

34 
	#CONN_INFO_LEN
 32

	)

36 
	g´EvítLo›
;

37 
c⁄√˘i⁄
 
	tc⁄√˘i⁄
;

40 
	mCONN_STATE_NONE
 = 0,

41 
	mCONN_STATE_CONNECTING
,

42 
	mCONN_STATE_ACCEPTING
,

43 
	mCONN_STATE_CONNECTED
,

44 
	mCONN_STATE_CLOSED
,

45 
	mCONN_STATE_ERROR


46 } 
	tC⁄√˘i⁄Sèã
;

48 
	#CONN_FLAG_CLOSE_SCHEDULED
 (1<<0Ë

	)

49 
	#CONN_FLAG_WRITE_BARRIER
 (1<<1Ë

	)

51 (*
	tC⁄√˘i⁄CÆlbackFunc
)(
	tc⁄√˘i⁄
 *
	tc⁄n
);

53 
	sC⁄√˘i⁄Ty≥
 {

54 (*
´_h™dÀr
)(
´EvítLo›
 *
ñ
, 
fd
, *
˛õ¡D©a
, 
mask
);

55 (*
c⁄√˘
)(
c⁄√˘i⁄
 *
c⁄n
, c⁄° *
addr
, 
p‹t
, c⁄° *
sour˚_addr
, 
C⁄√˘i⁄CÆlbackFunc
 
c⁄√˘_h™dÀr
);

56 (*
wrôe
)(
c⁄√˘i⁄
 *
c⁄n
, c⁄° *
d©a
, 
size_t
 
d©a_Àn
);

57 (*
ªad
)(
c⁄√˘i⁄
 *
c⁄n
, *
buf
, 
size_t
 
buf_Àn
);

58 (*
˛o£
)(
c⁄√˘i⁄
 *
c⁄n
);

59 (*
ac˚±
)(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
ac˚±_h™dÀr
);

60 (*
£t_wrôe_h™dÀr
)(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
h™dÀr
, 
b¨rõr
);

61 (*
£t_ªad_h™dÀr
)(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
h™dÀr
);

62 c⁄° *(*
gë_œ°_îr‹
)(
c⁄√˘i⁄
 *
c⁄n
);

63 (*
blockög_c⁄√˘
)(
c⁄√˘i⁄
 *
c⁄n
, c⁄° *
addr
, 
p‹t
, 
timeout
);

64 
	`ssize_t
 (*
sync_wrôe
)(
c⁄√˘i⁄
 *
c⁄n
, *
±r
, 
ssize_t
 
size
, 
timeout
);

65 
	`ssize_t
 (*
sync_ªad
)(
c⁄√˘i⁄
 *
c⁄n
, *
±r
, 
ssize_t
 
size
, 
timeout
);

66 
	`ssize_t
 (*
sync_ªadlöe
)(
c⁄√˘i⁄
 *
c⁄n
, *
±r
, 
ssize_t
 
size
, 
timeout
);

67 } 
	tC⁄√˘i⁄Ty≥
;

69 
	sc⁄√˘i⁄
 {

70 
C⁄√˘i⁄Ty≥
 *
ty≥
;

71 
C⁄√˘i⁄Sèã
 
°©e
;

72 
Êags
;

73 
ªfs
;

74 
œ°_î∫o
;

75 *
¥iv©e_d©a
;

76 
C⁄√˘i⁄CÆlbackFunc
 
c⁄n_h™dÀr
;

77 
C⁄√˘i⁄CÆlbackFunc
 
wrôe_h™dÀr
;

78 
C⁄√˘i⁄CÆlbackFunc
 
ªad_h™dÀr
;

79 
fd
;

100 
ölöe
 
	$c⁄nAc˚±
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
ac˚±_h™dÀr
) {

101  
c⁄n
->
ty≥
->
	`ac˚±
(c⁄n, 
ac˚±_h™dÀr
);

102 
	}
}

113 
ölöe
 
	$c⁄nC⁄√˘
(
c⁄√˘i⁄
 *
c⁄n
, c⁄° *
addr
, 
p‹t
, c⁄° *
§c_addr
,

114 
C⁄√˘i⁄CÆlbackFunc
 
c⁄√˘_h™dÀr
) {

115  
c⁄n
->
ty≥
->
	`c⁄√˘
(c⁄n, 
addr
, 
p‹t
, 
§c_addr
, 
c⁄√˘_h™dÀr
);

116 
	}
}

124 
ölöe
 
	$c⁄nBlockögC⁄√˘
(
c⁄√˘i⁄
 *
c⁄n
, c⁄° *
addr
, 
p‹t
, 
timeout
) {

125  
c⁄n
->
ty≥
->
	`blockög_c⁄√˘
(c⁄n, 
addr
, 
p‹t
, 
timeout
);

126 
	}
}

135 
ölöe
 
	$c⁄nWrôe
(
c⁄√˘i⁄
 *
c⁄n
, c⁄° *
d©a
, 
size_t
 
d©a_Àn
) {

136  
c⁄n
->
ty≥
->
	`wrôe
(c⁄n, 
d©a
, 
d©a_Àn
);

137 
	}
}

147 
ölöe
 
	$c⁄nRód
(
c⁄√˘i⁄
 *
c⁄n
, *
buf
, 
size_t
 
buf_Àn
) {

148  
c⁄n
->
ty≥
->
	`ªad
(c⁄n, 
buf
, 
buf_Àn
);

149 
	}
}

154 
ölöe
 
	$c⁄nSëWrôeH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
func
) {

155  
c⁄n
->
ty≥
->
	`£t_wrôe_h™dÀr
(c⁄n, 
func
, 0);

156 
	}
}

161 
ölöe
 
	$c⁄nSëRódH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
func
) {

162  
c⁄n
->
ty≥
->
	`£t_ªad_h™dÀr
(c⁄n, 
func
);

163 
	}
}

170 
ölöe
 
	$c⁄nSëWrôeH™dÀrWôhB¨rõr
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
func
, 
b¨rõr
) {

171  
c⁄n
->
ty≥
->
	`£t_wrôe_h™dÀr
(c⁄n, 
func
, 
b¨rõr
);

172 
	}
}

174 
ölöe
 
	$c⁄nClo£
(
c⁄√˘i⁄
 *
c⁄n
) {

175 
c⁄n
->
ty≥
->
	`˛o£
(conn);

176 
	}
}

181 
ölöe
 c⁄° *
	$c⁄nGëLa°Eº‹
(
c⁄√˘i⁄
 *
c⁄n
) {

182  
c⁄n
->
ty≥
->
	`gë_œ°_îr‹
(conn);

183 
	}
}

185 
ölöe
 
ssize_t
 
	$c⁄nSyncWrôe
(
c⁄√˘i⁄
 *
c⁄n
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

186  
c⁄n
->
ty≥
->
	`sync_wrôe
(c⁄n, 
±r
, 
size
, 
timeout
);

187 
	}
}

189 
ölöe
 
ssize_t
 
	$c⁄nSyncRód
(
c⁄√˘i⁄
 *
c⁄n
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

190  
c⁄n
->
ty≥
->
	`sync_ªad
(c⁄n, 
±r
, 
size
, 
timeout
);

191 
	}
}

193 
ölöe
 
ssize_t
 
	$c⁄nSyncRódLöe
(
c⁄√˘i⁄
 *
c⁄n
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

194  
c⁄n
->
ty≥
->
	`sync_ªadlöe
(c⁄n, 
±r
, 
size
, 
timeout
);

195 
	}
}

197 
c⁄√˘i⁄
 *
c⁄nCª©eSockë
();

198 
c⁄√˘i⁄
 *
c⁄nCª©eAc˚±edSockë
(
fd
);

200 
c⁄√˘i⁄
 *
c⁄nCª©eTLS
();

201 
c⁄√˘i⁄
 *
c⁄nCª©eAc˚±edTLS
(
fd
, 
ªquúe_auth
);

203 
c⁄nSëPriv©eD©a
(
c⁄√˘i⁄
 *
c⁄n
, *
d©a
);

204 *
c⁄nGëPriv©eD©a
(
c⁄√˘i⁄
 *
c⁄n
);

205 
c⁄nGëSèã
(
c⁄√˘i⁄
 *
c⁄n
);

206 
c⁄nHasWrôeH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
);

207 
c⁄nHasRódH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
);

208 
c⁄nGëSockëEº‹
(
c⁄√˘i⁄
 *
c⁄n
);

211 
c⁄nBlock
(
c⁄√˘i⁄
 *
c⁄n
);

212 
c⁄nN⁄Block
(
c⁄√˘i⁄
 *
c⁄n
);

213 
c⁄nE«bÀT˝NoDñay
(
c⁄√˘i⁄
 *
c⁄n
);

214 
c⁄nDißbÀT˝NoDñay
(
c⁄√˘i⁄
 *
c⁄n
);

215 
c⁄nKìpAlive
(
c⁄√˘i⁄
 *
c⁄n
, 
öãrvÆ
);

216 
c⁄nSídTimeout
(
c⁄√˘i⁄
 *
c⁄n
, 
ms
);

217 
c⁄nRecvTimeout
(
c⁄√˘i⁄
 *
c⁄n
, 
ms
);

218 
c⁄nPìrToSåög
(
c⁄√˘i⁄
 *
c⁄n
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
);

219 
c⁄nF‹m©Pìr
(
c⁄√˘i⁄
 *
c⁄n
, *
buf
, 
size_t
 
buf_Àn
);

220 
c⁄nSockName
(
c⁄√˘i⁄
 *
c⁄n
, *
ù
, 
size_t
 
ù_Àn
, *
p‹t
);

221 c⁄° *
c⁄nGëInfo
(
c⁄√˘i⁄
 *
c⁄n
, *
buf
, 
size_t
 
buf_Àn
);

224 
ésHasPídögD©a
();

225 
ésPro˚ssPídögD©a
();

	@connhelpers.h

31 #i‚de‡
__REDIS_CONNHELPERS_H


32 
	#__REDIS_CONNHELPERS_H


	)

34 
	~"c⁄√˘i⁄.h
"

52 
ölöe
 
	$c⁄nIn¸Refs
(
c⁄√˘i⁄
 *
c⁄n
) {

53 
c⁄n
->
ªfs
++;

54 
	}
}

64 
ölöe
 
	$c⁄nDe¸Refs
(
c⁄√˘i⁄
 *
c⁄n
) {

65 
c⁄n
->
ªfs
--;

66 
	}
}

68 
ölöe
 
	$c⁄nHasRefs
(
c⁄√˘i⁄
 *
c⁄n
) {

69  
c⁄n
->
ªfs
;

70 
	}
}

77 
ölöe
 
	$ˇŒH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
h™dÀr
) {

78 
	`c⁄nIn¸Refs
(
c⁄n
);

79 i‡(
h™dÀr
Ë
	`h™dÀr
(
c⁄n
);

80 
	`c⁄nDe¸Refs
(
c⁄n
);

81 i‡(
c⁄n
->
Êags
 & 
CONN_FLAG_CLOSE_SCHEDULED
) {

82 i‡(!
	`c⁄nHasRefs
(
c⁄n
)Ë
	`c⁄nClo£
(conn);

86 
	}
}

	@crc16.c

1 
	~"£rvî.h
"

47 c⁄° 
uöt16_t
 
	g¸c16èb
[256]= {

82 
uöt16_t
 
	$¸c16
(c⁄° *
buf
, 
Àn
) {

83 
cou¡î
;

84 
uöt16_t
 
¸c
 = 0;

85 
cou¡î
 = 0; cou¡î < 
Àn
; counter++)

86 
¸c
 = (¸c<<8Ë^ 
¸c16èb
[((¸c>>8Ë^ *
buf
++)&0x00FF];

87  
¸c
;

88 
	}
}

	@crc16_slottable.h

1 #i‚de‡
_CRC16_TABLE_H__


2 
	#_CRC16_TABLE_H__


	)

11 c⁄° *
	g¸c16_¶Ÿ_èbÀ
[] = {

	@crc64.c

29 
	~"¸c64.h
"

30 
	~"¸c•ìd.h
"

31 
uöt64_t
 
	g¸c64_èbÀ
[8][256] = {{0}};

33 
	#POLY
 
	`UINT64_C
(0xad93d23594c935a9)

	)

69 
ölöe
 
uöt_Á°64_t
 
	$¸c_ªÊe˘
(
uöt_Á°64_t
 
d©a
, 
size_t
 
d©a_Àn
) {

70 
uöt_Á°64_t
 
ªt
 = 
d©a
 & 0x01;

72 
size_t
 
i
 = 1; i < 
d©a_Àn
; i++) {

73 
d©a
 >>= 1;

74 
ªt
 = (ªà<< 1Ë| (
d©a
 & 0x01);

77  
ªt
;

78 
	}
}

88 
uöt64_t
 
	$_¸c64
(
uöt_Á°64_t
 
¸c
, c⁄° *
ö_d©a
, c⁄° 
uöt64_t
 
Àn
) {

89 c⁄° 
uöt8_t
 *
d©a
 = 
ö_d©a
;

90 
bô
;

92 
uöt64_t
 
off£t
 = 0; off£à< 
Àn
; offset++) {

93 
uöt8_t
 
c
 = 
d©a
[
off£t
];

94 
uöt_Á°8_t
 
i
 = 0x01; i & 0xff; i <<= 1) {

95 
bô
 = 
¸c
 & 0x8000000000000000;

96 i‡(
c
 & 
i
) {

97 
bô
 = !bit;

100 
¸c
 <<= 1;

101 i‡(
bô
) {

102 
¸c
 ^
POLY
;

106 
¸c
 &= 0xffffffffffffffff;

109 
¸c
 = crc & 0xffffffffffffffff;

110  
	`¸c_ªÊe˘
(
¸c
, 64) ^ 0x0000000000000000;

111 
	}
}

116 
	$¸c64_öô
() {

117 
	`¸c•ìd64«tive_öô
(
_¸c64
, 
¸c64_èbÀ
);

118 
	}
}

121 
uöt64_t
 
	$¸c64
(
uöt64_t
 
¸c
, c⁄° *
s
, uöt64_à
l
) {

122  
	`¸c•ìd64«tive
(
¸c64_èbÀ
, 
¸c
, (*Ë
s
, 
l
);

123 
	}
}

126 #ifde‡
REDIS_TEST


127 
	~<°dio.h
>

129 
	#UNUSED
(
x
Ë()(x)

	)

130 
	$¸c64Te°
(
¨gc
, *
¨gv
[]) {

131 
	`UNUSED
(
¨gc
);

132 
	`UNUSED
(
¨gv
);

133 
	`¸c64_öô
();

134 
	`¥ötf
("[ˇlcuœ]:É9c6d914c4b8d9ˇ =%016" 
PRIx64
 "\n",

135 (
uöt64_t
)
	`_¸c64
(0, "123456789", 9));

136 
	`¥ötf
("[64•ìd]:É9c6d914c4b8d9ˇ =%016" 
PRIx64
 "\n",

137 (
uöt64_t
)
	`¸c64
(0, "123456789", 9));

138 
li
[] = "Lorem ipsum dolor sitámet, consecteturádipiscingÉlit, sed "

146 
	`¥ötf
("[ˇlcuœ]: c7794709e69683b3 =%016" 
PRIx64
 "\n",

147 (
uöt64_t
)
	`_¸c64
(0, 
li
, (li)));

148 
	`¥ötf
("[64•ìd]: c7794709e69683b3 =%016" 
PRIx64
 "\n",

149 (
uöt64_t
)
	`¸c64
(0, 
li
, (li)));

151 
	}
}

155 #ifde‡
REDIS_TEST_MAIN


156 
	$maö
(
¨gc
, *
¨gv
[]) {

157  
	`¸c64Te°
(
¨gc
, 
¨gv
);

158 
	}
}

	@crc64.h

1 #i‚de‡
CRC64_H


2 
	#CRC64_H


	)

4 
	~<°döt.h
>

6 
¸c64_öô
();

7 
uöt64_t
 
¸c64
(uöt64_à
¸c
, c⁄° *
s
, uöt64_à
l
);

9 #ifde‡
REDIS_TEST


10 
¸c64Te°
(
¨gc
, *
¨gv
[]);

	@crcspeed.c

30 
	~"¸c•ìd.h
"

33 
	$¸c•ìd64lôée_öô
(
¸c‚64
 
¸c‚
, 
uöt64_t
 
èbÀ
[8][256]) {

34 
uöt64_t
 
¸c
;

37 
n
 = 0;Ç < 256;Ç++) {

38 
èbÀ
[0][
n
] = 
	`¸c‚
(0, &n, 1);

42 
n
 = 0;Ç < 256;Ç++) {

43 
¸c
 = 
èbÀ
[0][
n
];

44 
k
 = 1; k < 8; k++) {

45 
¸c
 = 
èbÀ
[0][crc & 0xff] ^ (crc >> 8);

46 
èbÀ
[
k
][
n
] = 
¸c
;

49 
	}
}

51 
	$¸c•ìd16lôée_öô
(
¸c‚16
 
¸c‚
, 
uöt16_t
 
èbÀ
[8][256]) {

52 
uöt16_t
 
¸c
;

55 
n
 = 0;Ç < 256;Ç++) {

56 
èbÀ
[0][
n
] = 
	`¸c‚
(0, &n, 1);

60 
n
 = 0;Ç < 256;Ç++) {

61 
¸c
 = 
èbÀ
[0][
n
];

62 
k
 = 1; k < 8; k++) {

63 
¸c
 = 
èbÀ
[0][(crc >> 8) & 0xff] ^ (crc << 8);

64 
èbÀ
[
k
][
n
] = 
¸c
;

67 
	}
}

70 
ölöe
 
uöt64_t
 
	$ªv8
(
uöt64_t
 
a
) {

71 #i‡
	`deföed
(
__GNUC__
Ë|| deföed(
__˛™g__
)

72  
	`__buûtö_bsw≠64
(
a
);

74 
uöt64_t
 
m
;

76 
m
 = 
	`UINT64_C
(0xff00ff00ff00ff);

77 
a
 = (◊ >> 8Ë& 
m
) | (a & m) << 8;

78 
m
 = 
	`UINT64_C
(0xffff0000ffff);

79 
a
 = (◊ >> 16Ë& 
m
) | (a & m) << 16;

80  
a
 >> 32 |á << 32;

82 
	}
}

86 
	$¸c•ìd64big_öô
(
¸c‚64
 
‚
, 
uöt64_t
 
big_èbÀ
[8][256]) {

88 
	`¸c•ìd64lôée_öô
(
‚
, 
big_èbÀ
);

89 
k
 = 0; k < 8; k++) {

90 
n
 = 0;Ç < 256;Ç++) {

91 
big_èbÀ
[
k
][
n
] = 
	`ªv8
(big_table[k][n]);

94 
	}
}

96 
	$¸c•ìd16big_öô
(
¸c‚16
 
‚
, 
uöt16_t
 
big_èbÀ
[8][256]) {

98 
	`¸c•ìd16lôée_öô
(
‚
, 
big_èbÀ
);

99 
k
 = 0; k < 8; k++) {

100 
n
 = 0;Ç < 256;Ç++) {

101 
big_èbÀ
[
k
][
n
] = 
	`ªv8
(big_table[k][n]);

104 
	}
}

111 
uöt64_t
 
	$¸c•ìd64lôée
(
uöt64_t
 
lôée_èbÀ
[8][256], uöt64_à
¸c
,

112 *
buf
, 
size_t
 
Àn
) {

113 *
√xt
 = 
buf
;

116 
Àn
 && ((
uöçå_t
)
√xt
 & 7) != 0) {

117 
¸c
 = 
lôée_èbÀ
[0][(¸¯^ *
√xt
++) & 0xff] ^ (crc >> 8);

118 
Àn
--;

122 
Àn
 >= 8) {

123 
¸c
 ^*(
uöt64_t
 *)
√xt
;

124 
¸c
 = 
lôée_èbÀ
[7][crc & 0xff] ^

125 
lôée_èbÀ
[6][(
¸c
 >> 8) & 0xff] ^

126 
lôée_èbÀ
[5][(
¸c
 >> 16) & 0xff] ^

127 
lôée_èbÀ
[4][(
¸c
 >> 24) & 0xff] ^

128 
lôée_èbÀ
[3][(
¸c
 >> 32) & 0xff] ^

129 
lôée_èbÀ
[2][(
¸c
 >> 40) & 0xff] ^

130 
lôée_èbÀ
[1][(
¸c
 >> 48) & 0xff] ^

131 
lôée_èbÀ
[0][
¸c
 >> 56];

132 
√xt
 += 8;

133 
Àn
 -= 8;

137 
Àn
) {

138 
¸c
 = 
lôée_èbÀ
[0][(¸¯^ *
√xt
++) & 0xff] ^ (crc >> 8);

139 
Àn
--;

142  
¸c
;

143 
	}
}

145 
uöt16_t
 
	$¸c•ìd16lôée
(
uöt16_t
 
lôée_èbÀ
[8][256], uöt16_à
¸c
,

146 *
buf
, 
size_t
 
Àn
) {

147 *
√xt
 = 
buf
;

150 
Àn
 && ((
uöçå_t
)
√xt
 & 7) != 0) {

151 
¸c
 = 
lôée_èbÀ
[0][((¸¯>> 8Ë^ *
√xt
++) & 0xff] ^ (crc << 8);

152 
Àn
--;

156 
Àn
 >= 8) {

157 
uöt64_t
 
n
 = *(uöt64_à*)
√xt
;

158 
¸c
 = 
lôée_èbÀ
[7][(
n
 & 0xff) ^ ((crc >> 8) & 0xff)] ^

159 
lôée_èbÀ
[6][((
n
 >> 8Ë& 0xffË^ (
¸c
 & 0xff)] ^

160 
lôée_èbÀ
[5][(
n
 >> 16) & 0xff] ^

161 
lôée_èbÀ
[4][(
n
 >> 24) & 0xff] ^

162 
lôée_èbÀ
[3][(
n
 >> 32) & 0xff] ^

163 
lôée_èbÀ
[2][(
n
 >> 40) & 0xff] ^

164 
lôée_èbÀ
[1][(
n
 >> 48) & 0xff] ^

165 
lôée_èbÀ
[0][
n
 >> 56];

166 
√xt
 += 8;

167 
Àn
 -= 8;

171 
Àn
) {

172 
¸c
 = 
lôée_èbÀ
[0][((¸¯>> 8Ë^ *
√xt
++) & 0xff] ^ (crc << 8);

173 
Àn
--;

176  
¸c
;

177 
	}
}

182 
uöt64_t
 
	$¸c•ìd64big
(
uöt64_t
 
big_èbÀ
[8][256], uöt64_à
¸c
, *
buf
,

183 
size_t
 
Àn
) {

184 *
√xt
 = 
buf
;

186 
¸c
 = 
	`ªv8
(crc);

187 
Àn
 && ((
uöçå_t
)
√xt
 & 7) != 0) {

188 
¸c
 = 
big_èbÀ
[0][(¸¯>> 56Ë^ *
√xt
++] ^ (crc << 8);

189 
Àn
--;

192 
Àn
 >= 8) {

193 
¸c
 ^*(
uöt64_t
 *)
√xt
;

194 
¸c
 = 
big_èbÀ
[0][crc & 0xff] ^

195 
big_èbÀ
[1][(
¸c
 >> 8) & 0xff] ^

196 
big_èbÀ
[2][(
¸c
 >> 16) & 0xff] ^

197 
big_èbÀ
[3][(
¸c
 >> 24) & 0xff] ^

198 
big_èbÀ
[4][(
¸c
 >> 32) & 0xff] ^

199 
big_èbÀ
[5][(
¸c
 >> 40) & 0xff] ^

200 
big_èbÀ
[6][(
¸c
 >> 48) & 0xff] ^

201 
big_èbÀ
[7][
¸c
 >> 56];

202 
√xt
 += 8;

203 
Àn
 -= 8;

206 
Àn
) {

207 
¸c
 = 
big_èbÀ
[0][(¸¯>> 56Ë^ *
√xt
++] ^ (crc << 8);

208 
Àn
--;

211  
	`ªv8
(
¸c
);

212 
	}
}

215 
uöt16_t
 
	$¸c•ìd16big
(
uöt16_t
 
big_èbÀ
[8][256], uöt16_à
¸c_ö
, *
buf
,

216 
size_t
 
Àn
) {

217 *
√xt
 = 
buf
;

218 
uöt64_t
 
¸c
 = 
¸c_ö
;

220 
¸c
 = 
	`ªv8
(crc);

221 
Àn
 && ((
uöçå_t
)
√xt
 & 7) != 0) {

222 
¸c
 = 
big_èbÀ
[0][((¸¯>> (56 - 8)Ë^ *
√xt
++) & 0xff] ^ (crc >> 8);

223 
Àn
--;

226 
Àn
 >= 8) {

227 
uöt64_t
 
n
 = *(uöt64_à*)
√xt
;

228 
¸c
 = 
big_èbÀ
[0][(
n
 & 0xff) ^ ((crc >> (56 - 8)) & 0xff)] ^

229 
big_èbÀ
[1][((
n
 >> 8Ë& 0xffË^ (
¸c
 & 0xff)] ^

230 
big_èbÀ
[2][(
n
 >> 16) & 0xff] ^

231 
big_èbÀ
[3][(
n
 >> 24) & 0xff] ^

232 
big_èbÀ
[4][(
n
 >> 32) & 0xff] ^

233 
big_èbÀ
[5][(
n
 >> 40) & 0xff] ^

234 
big_èbÀ
[6][(
n
 >> 48) & 0xff] ^

235 
big_èbÀ
[7][
n
 >> 56];

236 
√xt
 += 8;

237 
Àn
 -= 8;

240 
Àn
) {

241 
¸c
 = 
big_èbÀ
[0][((¸¯>> (56 - 8)Ë^ *
√xt
++) & 0xff] ^ (crc >> 8);

242 
Àn
--;

245  
	`ªv8
(
¸c
);

246 
	}
}

252 
uöt64_t
 
	$¸c•ìd64«tive
(
uöt64_t
 
èbÀ
[8][256], uöt64_à
¸c
, *
buf
,

253 
size_t
 
Àn
) {

254 
uöt64_t
 
n
 = 1;

256  *(*)&
n
 ? 
	`¸c•ìd64lôée
(
èbÀ
, 
¸c
, 
buf
, 
Àn
)

257 : 
	`¸c•ìd64big
(
èbÀ
, 
¸c
, 
buf
, 
Àn
);

258 
	}
}

260 
uöt16_t
 
	$¸c•ìd16«tive
(
uöt16_t
 
èbÀ
[8][256], uöt16_à
¸c
, *
buf
,

261 
size_t
 
Àn
) {

262 
uöt64_t
 
n
 = 1;

264  *(*)&
n
 ? 
	`¸c•ìd16lôée
(
èbÀ
, 
¸c
, 
buf
, 
Àn
)

265 : 
	`¸c•ìd16big
(
èbÀ
, 
¸c
, 
buf
, 
Àn
);

266 
	}
}

269 
	$¸c•ìd64«tive_öô
(
¸c‚64
 
‚
, 
uöt64_t
 
èbÀ
[8][256]) {

270 
uöt64_t
 
n
 = 1;

272 *(*)&
n
 ? 
	`¸c•ìd64lôée_öô
(
‚
, 
èbÀ
)

273 : 
	`¸c•ìd64big_öô
(
‚
, 
èbÀ
);

274 
	}
}

276 
	$¸c•ìd16«tive_öô
(
¸c‚16
 
‚
, 
uöt16_t
 
èbÀ
[8][256]) {

277 
uöt64_t
 
n
 = 1;

279 *(*)&
n
 ? 
	`¸c•ìd16lôée_öô
(
‚
, 
èbÀ
)

280 : 
	`¸c•ìd16big_öô
(
‚
, 
èbÀ
);

281 
	}
}

	@crcspeed.h

28 #i‚de‡
CRCSPEED_H


29 
	#CRCSPEED_H


	)

31 
	~<öây≥s.h
>

32 
	~<°dio.h
>

34 
	$uöt64_t
 (*
	t¸c‚64
)(
	tuöt64_t
, const *, const uint64_t);

35 
	$uöt16_t
 (*
	t¸c‚16
)(
	tuöt16_t
, c⁄° *, c⁄° 
	tuöt64_t
);

38 
	`¸c•ìd64lôée_öô
(
¸c‚64
 
‚
, 
uöt64_t
 
èbÀ
[8][256]);

39 
	`¸c•ìd64big_öô
(
¸c‚64
 
‚
, 
uöt64_t
 
èbÀ
[8][256]);

40 
	`¸c•ìd64«tive_öô
(
¸c‚64
 
‚
, 
uöt64_t
 
èbÀ
[8][256]);

42 
uöt64_t
 
	`¸c•ìd64lôée
(uöt64_à
èbÀ
[8][256], uöt64_à
¸c
, *
buf
,

43 
size_t
 
Àn
);

44 
uöt64_t
 
	`¸c•ìd64big
(uöt64_à
èbÀ
[8][256], uöt64_à
¸c
, *
buf
,

45 
size_t
 
Àn
);

46 
uöt64_t
 
	`¸c•ìd64«tive
(uöt64_à
èbÀ
[8][256], uöt64_à
¸c
, *
buf
,

47 
size_t
 
Àn
);

50 
	`¸c•ìd16lôée_öô
(
¸c‚16
 
‚
, 
uöt16_t
 
èbÀ
[8][256]);

51 
	`¸c•ìd16big_öô
(
¸c‚16
 
‚
, 
uöt16_t
 
èbÀ
[8][256]);

52 
	`¸c•ìd16«tive_öô
(
¸c‚16
 
‚
, 
uöt16_t
 
èbÀ
[8][256]);

54 
uöt16_t
 
	`¸c•ìd16lôée
(uöt16_à
èbÀ
[8][256], uöt16_à
¸c
, *
buf
,

55 
size_t
 
Àn
);

56 
uöt16_t
 
	`¸c•ìd16big
(uöt16_à
èbÀ
[8][256], uöt16_à
¸c
, *
buf
,

57 
size_t
 
Àn
);

58 
uöt16_t
 
	`¸c•ìd16«tive
(uöt16_à
èbÀ
[8][256], uöt16_à
¸c
, *
buf
,

59 
size_t
 
Àn
);

	@db.c

30 
	~"£rvî.h
"

31 
	~"˛u°î.h
"

32 
	~"©omicv¨.h
"

34 
	~<sig«l.h
>

35 
	~<˘y≥.h
>

41 
keyIsExpúed
(
ªdisDb
 *
db
, 
robj
 *
key
);

46 
	$upd©eLFU
(
robj
 *
vÆ
) {

47 
cou¡î
 = 
	`LFUDe¸AndRëu∫
(
vÆ
);

48 
cou¡î
 = 
	`LFULogIn¸
(counter);

49 
vÆ
->
Ãu
 = (
	`LFUGëTimeInMöuãs
()<<8Ë| 
cou¡î
;

50 
	}
}

55 
robj
 *
	$lookupKey
(
ªdisDb
 *
db
, 
robj
 *
key
, 
Êags
) {

56 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
db
->
di˘
,
key
->
±r
);

57 i‡(
de
) {

58 
robj
 *
vÆ
 = 
	`di˘GëVÆ
(
de
);

63 i‡(!
	`hasA˘iveChûdPro˚ss
(Ë&& !(
Êags
 & 
LOOKUP_NOTOUCH
)){

64 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
) {

65 
	`upd©eLFU
(
vÆ
);

67 
vÆ
->
Ãu
 = 
	`LRU_CLOCK
();

70  
vÆ
;

72  
NULL
;

74 
	}
}

98 
robj
 *
	$lookupKeyRódWôhFœgs
(
ªdisDb
 *
db
, 
robj
 *
key
, 
Êags
) {

99 
robj
 *
vÆ
;

101 i‡(
	`expúeIfNìded
(
db
,
key
) == 1) {

105 i‡(
£rvî
.
ma°îho°
 =
NULL
) {

106 
£rvî
.
°©_key•a˚_mis£s
++;

107 
	`nŸifyKey•a˚Evít
(
NOTIFY_KEY_MISS
, "keymiss", 
key
, 
db
->
id
);

108  
NULL
;

123 i‡(
£rvî
.
cuºít_˛õ¡
 &&

124 
£rvî
.
cuºít_˛õ¡
 !£rvî.
ma°î
 &&

125 
£rvî
.
cuºít_˛õ¡
->
cmd
 &&

126 
£rvî
.
cuºít_˛õ¡
->
cmd
->
Êags
 & 
CMD_READONLY
)

128 
£rvî
.
°©_key•a˚_mis£s
++;

129 
	`nŸifyKey•a˚Evít
(
NOTIFY_KEY_MISS
, "keymiss", 
key
, 
db
->
id
);

130  
NULL
;

133 
vÆ
 = 
	`lookupKey
(
db
,
key
,
Êags
);

134 i‡(
vÆ
 =
NULL
) {

135 
£rvî
.
°©_key•a˚_mis£s
++;

136 
	`nŸifyKey•a˚Evít
(
NOTIFY_KEY_MISS
, "keymiss", 
key
, 
db
->
id
);

139 
£rvî
.
°©_key•a˚_hôs
++;

140  
vÆ
;

141 
	}
}

145 
robj
 *
	$lookupKeyRód
(
ªdisDb
 *
db
, 
robj
 *
key
) {

146  
	`lookupKeyRódWôhFœgs
(
db
,
key
,
LOOKUP_NONE
);

147 
	}
}

154 
robj
 *
	$lookupKeyWrôeWôhFœgs
(
ªdisDb
 *
db
, 
robj
 *
key
, 
Êags
) {

155 
	`expúeIfNìded
(
db
,
key
);

156  
	`lookupKey
(
db
,
key
,
Êags
);

157 
	}
}

159 
robj
 *
	$lookupKeyWrôe
(
ªdisDb
 *
db
, 
robj
 *
key
) {

160  
	`lookupKeyWrôeWôhFœgs
(
db
, 
key
, 
LOOKUP_NONE
);

161 
	}
}

163 
robj
 *
	$lookupKeyRódOrRïly
(
˛õ¡
 *
c
, 
robj
 *
key
,Ñobj *
ª∂y
) {

164 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
, 
key
);

165 i‡(!
o
Ë
	`addRïly
(
c
,
ª∂y
);

166  
o
;

167 
	}
}

169 
robj
 *
	$lookupKeyWrôeOrRïly
(
˛õ¡
 *
c
, 
robj
 *
key
,Ñobj *
ª∂y
) {

170 
robj
 *
o
 = 
	`lookupKeyWrôe
(
c
->
db
, 
key
);

171 i‡(!
o
Ë
	`addRïly
(
c
,
ª∂y
);

172  
o
;

173 
	}
}

179 
	$dbAdd
(
ªdisDb
 *
db
, 
robj
 *
key
,Ñobj *
vÆ
) {

180 
sds
 
c›y
 = 
	`sdsdup
(
key
->
±r
);

181 
ªtvÆ
 = 
	`di˘Add
(
db
->
di˘
, 
c›y
, 
vÆ
);

183 
	`£rvîAs£πWôhInfo
(
NULL
,
key
,
ªtvÆ
 =
DICT_OK
);

184 i‡(
vÆ
->
ty≥
 =
OBJ_LIST
 ||

185 
vÆ
->
ty≥
 =
OBJ_ZSET
 ||

186 
vÆ
->
ty≥
 =
OBJ_STREAM
)

187 
	`sig«lKeyAsRódy
(
db
, 
key
);

188 i‡(
£rvî
.
˛u°î_íabÀd
Ë
	`¶ŸToKeyAdd
(
key
->
±r
);

189 
	}
}

202 
	$dbAddRDBLﬂd
(
ªdisDb
 *
db
, 
sds
 
key
, 
robj
 *
vÆ
) {

203 
ªtvÆ
 = 
	`di˘Add
(
db
->
di˘
, 
key
, 
vÆ
);

204 i‡(
ªtvÆ
 !
DICT_OK
)  0;

205 i‡(
£rvî
.
˛u°î_íabÀd
Ë
	`¶ŸToKeyAdd
(
key
);

207 
	}
}

214 
	$dbOvîwrôe
(
ªdisDb
 *
db
, 
robj
 *
key
,Ñobj *
vÆ
) {

215 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
db
->
di˘
,
key
->
±r
);

217 
	`£rvîAs£πWôhInfo
(
NULL
,
key
,
de
 != NULL);

218 
di˘E¡ry
 
auxíåy
 = *
de
;

219 
robj
 *
ﬁd
 = 
	`di˘GëVÆ
(
de
);

220 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
) {

221 
vÆ
->
Ãu
 = 
ﬁd
->lru;

223 
	`di˘SëVÆ
(
db
->
di˘
, 
de
, 
vÆ
);

225 i‡(
£rvî
.
œzy‰ì_œzy_£rvî_dñ
) {

226 
	`‰ìObjAsync
(
ﬁd
);

227 
	`di˘SëVÆ
(
db
->
di˘
, &
auxíåy
, 
NULL
);

230 
	`di˘FªeVÆ
(
db
->
di˘
, &
auxíåy
);

231 
	}
}

244 
	$gíîicSëKey
(
˛õ¡
 *
c
, 
ªdisDb
 *
db
, 
robj
 *
key
,Ñobj *
vÆ
, 
kì±é
, 
sig«l
) {

245 i‡(
	`lookupKeyWrôe
(
db
,
key
Ë=
NULL
) {

246 
	`dbAdd
(
db
,
key
,
vÆ
);

248 
	`dbOvîwrôe
(
db
,
key
,
vÆ
);

250 
	`ö¸RefCou¡
(
vÆ
);

251 i‡(!
kì±é
Ë
	`ªmoveExpúe
(
db
,
key
);

252 i‡(
sig«l
Ë
	`sig«lModifõdKey
(
c
,
db
,
key
);

253 
	}
}

256 
	$£tKey
(
˛õ¡
 *
c
, 
ªdisDb
 *
db
, 
robj
 *
key
,Ñobj *
vÆ
) {

257 
	`gíîicSëKey
(
c
,
db
,
key
,
vÆ
,0,1);

258 
	}
}

262 
	$dbExi°s
(
ªdisDb
 *
db
, 
robj
 *
key
) {

263  
	`di˘Föd
(
db
->
di˘
,
key
->
±r
Ë!
NULL
;

264 
	}
}

270 
robj
 *
	$dbR™domKey
(
ªdisDb
 *
db
) {

271 
di˘E¡ry
 *
de
;

272 
maxåõs
 = 100;

273 
Ælvﬁ©ûe
 = 
	`di˘Size
(
db
->
di˘
Ë=di˘Size(db->
expúes
);

276 
sds
 
key
;

277 
robj
 *
keyobj
;

279 
de
 = 
	`di˘GëFaúR™domKey
(
db
->
di˘
);

280 i‡(
de
 =
NULL
)  NULL;

282 
key
 = 
	`di˘GëKey
(
de
);

283 
keyobj
 = 
	`¸óãSåögObje˘
(
key
,
	`sd¶í
(key));

284 i‡(
	`di˘Föd
(
db
->
expúes
,
key
)) {

285 i‡(
Ælvﬁ©ûe
 && 
£rvî
.
ma°îho°
 && --
maxåõs
 == 0) {

294  
keyobj
;

296 i‡(
	`expúeIfNìded
(
db
,
keyobj
)) {

297 
	`de¸RefCou¡
(
keyobj
);

301  
keyobj
;

303 
	}
}

306 
	$dbSyncDñëe
(
ªdisDb
 *
db
, 
robj
 *
key
) {

309 i‡(
	`di˘Size
(
db
->
expúes
Ë> 0Ë
	`di˘Dñëe
(db->expúes,
key
->
±r
);

310 i‡(
	`di˘Dñëe
(
db
->
di˘
,
key
->
±r
Ë=
DICT_OK
) {

311 i‡(
£rvî
.
˛u°î_íabÀd
Ë
	`¶ŸToKeyDñ
(
key
->
±r
);

316 
	}
}

320 
	$dbDñëe
(
ªdisDb
 *
db
, 
robj
 *
key
) {

321  
£rvî
.
œzy‰ì_œzy_£rvî_dñ
 ? 
	`dbAsyncDñëe
(
db
,
key
) :

322 
	`dbSyncDñëe
(
db
,
key
);

323 
	}
}

352 
robj
 *
	$dbUnsh¨eSåögVÆue
(
ªdisDb
 *
db
, 
robj
 *
key
,Ñobj *
o
) {

353 
	`£rvîAs£π
(
o
->
ty≥
 =
OBJ_STRING
);

354 i‡(
o
->
ªfcou¡
 !1 || o->
ícodög
 !
OBJ_ENCODING_RAW
) {

355 
robj
 *
decoded
 = 
	`gëDecodedObje˘
(
o
);

356 
o
 = 
	`¸óãRawSåögObje˘
(
decoded
->
±r
, 
	`sd¶í
(decoded->ptr));

357 
	`de¸RefCou¡
(
decoded
);

358 
	`dbOvîwrôe
(
db
,
key
,
o
);

360  
o
;

361 
	}
}

380 
em±yDbGíîic
(
ªdisDb
 *
db¨øy
, 
dbnum
, 
Êags
, (
ˇŒback
)(*)) {

381 
async
 = (
Êags
 & 
EMPTYDB_ASYNC
);

382 
backup
 = (
Êags
 & 
EMPTYDB_BACKUP
);

383 
RedisModuÀFlushInfoV1
 
fi
 = {
REDISMODULE_FLUSHINFO_VERSION
,!
async
,
dbnum
};

384 
ªmoved
 = 0;

386 i‡(
dbnum
 < -1 || dbnum >
£rvî
.dbnum) {

387 
î∫o
 = 
EINVAL
;

392 i‡(!
backup
) {

394 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_FLUSHDB
,

395 
REDISMODULE_SUBEVENT_FLUSHDB_START
,

396 &
fi
);

401 
	`sig«lFlushedDb
(
dbnum
);

404 
°¨tdb
, 
íddb
;

405 i‡(
dbnum
 == -1) {

406 
°¨tdb
 = 0;

407 
íddb
 = 
£rvî
.
dbnum
-1;

409 
°¨tdb
 = 
íddb
 = 
dbnum
;

412 
j
 = 
°¨tdb
; j <
íddb
; j++) {

413 
ªmoved
 +
	`di˘Size
(
db¨øy
[
j
].
di˘
);

414 i‡(
async
) {

415 
	`em±yDbAsync
(&
db¨øy
[
j
]);

417 
	`di˘Em±y
(
db¨øy
[
j
].
di˘
,
ˇŒback
);

418 
	`di˘Em±y
(
db¨øy
[
j
].
expúes
,
ˇŒback
);

423 i‡(!
backup
) {

424 i‡(
£rvî
.
˛u°î_íabÀd
) {

425 i‡(
async
) {

426 
	`¶ŸToKeyFlushAsync
();

428 
	`¶ŸToKeyFlush
();

431 i‡(
dbnum
 =-1Ë
	`ÊushSœveKeysWôhExpúeLi°
();

435 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_FLUSHDB
,

436 
REDISMODULE_SUBEVENT_FLUSHDB_END
,

437 &
fi
);

440  
ªmoved
;

441 
	}
}

443 
em±yDb
(
dbnum
, 
Êags
, (
ˇŒback
)(*)) {

444  
	`em±yDbGíîic
(
£rvî
.
db
, 
dbnum
, 
Êags
, 
ˇŒback
);

445 
	}
}

447 
	$£À˘Db
(
˛õ¡
 *
c
, 
id
) {

448 i‡(
id
 < 0 || id >
£rvî
.
dbnum
)

449  
C_ERR
;

450 
c
->
db
 = &
£rvî
.db[
id
];

451  
C_OK
;

452 
	}
}

454 
	$dbTŸÆSîvîKeyCou¡
() {

455 
tŸÆ
 = 0;

456 
j
;

457 
j
 = 0; j < 
£rvî
.
dbnum
; j++) {

458 
tŸÆ
 +
	`di˘Size
(
£rvî
.
db
[
j
].
di˘
);

460  
tŸÆ
;

461 
	}
}

474 
	$sig«lModifõdKey
(
˛õ¡
 *
c
, 
ªdisDb
 *
db
, 
robj
 *
key
) {

475 
	`touchW©chedKey
(
db
,
key
);

476 
	`åackögInvÆid©eKey
(
c
,
key
);

477 
	}
}

479 
	$sig«lFlushedDb
(
dbid
) {

480 
	`touchW©chedKeysOnFlush
(
dbid
);

481 
	`åackögInvÆid©eKeysOnFlush
(
dbid
);

482 
	}
}

496 
	$gëFlushComm™dFœgs
(
˛õ¡
 *
c
, *
Êags
) {

498 i‡(
c
->
¨gc
 > 1) {

499 i‡(
c
->
¨gc
 > 2 || 
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"async")) {

500 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

501  
C_ERR
;

503 *
Êags
 = 
EMPTYDB_ASYNC
;

505 *
Êags
 = 
EMPTYDB_NO_FLAGS
;

507  
C_OK
;

508 
	}
}

511 
	$ÊushAŒD©aAndRe£tRDB
(
Êags
) {

512 
£rvî
.
dúty
 +
	`em±yDb
(-1,
Êags
,
NULL
);

513 i‡(
£rvî
.
rdb_chûd_pid
 !-1Ë
	`kûlRDBChûd
();

514 i‡(
£rvî
.
ßvï¨am¶í
 > 0) {

517 
ßved_dúty
 = 
£rvî
.
dúty
;

518 
rdbSaveInfo
 
rsi
, *
rsùå
;

519 
rsùå
 = 
	`rdbP›uœãSaveInfo
(&
rsi
);

520 
	`rdbSave
(
£rvî
.
rdb_fûíame
,
rsùå
);

521 
£rvî
.
dúty
 = 
ßved_dúty
;

523 
£rvî
.
dúty
++;

524 #i‡
	`deföed
(
USE_JEMALLOC
)

528 i‡(!(
Êags
 & 
EMPTYDB_ASYNC
))

529 
	`jemÆloc_purge
();

531 
	}
}

536 
	$ÊushdbComm™d
(
˛õ¡
 *
c
) {

537 
Êags
;

539 i‡(
	`gëFlushComm™dFœgs
(
c
,&
Êags
Ë=
C_ERR
) ;

540 
£rvî
.
dúty
 +
	`em±yDb
(
c
->
db
->
id
,
Êags
,
NULL
);

541 
	`addRïly
(
c
,
sh¨ed
.
ok
);

542 #i‡
	`deföed
(
USE_JEMALLOC
)

546 i‡(!(
Êags
 & 
EMPTYDB_ASYNC
))

547 
	`jemÆloc_purge
();

549 
	}
}

554 
	$ÊushÆlComm™d
(
˛õ¡
 *
c
) {

555 
Êags
;

556 i‡(
	`gëFlushComm™dFœgs
(
c
,&
Êags
Ë=
C_ERR
) ;

557 
	`ÊushAŒD©aAndRe£tRDB
(
Êags
);

558 
	`addRïly
(
c
,
sh¨ed
.
ok
);

559 
	}
}

562 
	$dñGíîicComm™d
(
˛õ¡
 *
c
, 
œzy
) {

563 
numdñ
 = 0, 
j
;

565 
j
 = 1; j < 
c
->
¨gc
; j++) {

566 
	`expúeIfNìded
(
c
->
db
,c->
¨gv
[
j
]);

567 
dñëed
 = 
œzy
 ? 
	`dbAsyncDñëe
(
c
->
db
,c->
¨gv
[
j
]) :

568 
	`dbSyncDñëe
(
c
->
db
,c->
¨gv
[
j
]);

569 i‡(
dñëed
) {

570 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[
j
]);

571 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,

572 "dñ",
c
->
¨gv
[
j
],c->
db
->
id
);

573 
£rvî
.
dúty
++;

574 
numdñ
++;

577 
	`addRïlyL⁄gL⁄g
(
c
,
numdñ
);

578 
	}
}

580 
	$dñComm™d
(
˛õ¡
 *
c
) {

581 
	`dñGíîicComm™d
(
c
,
£rvî
.
œzy‰ì_œzy_u£r_dñ
);

582 
	}
}

584 
	$u∆ökComm™d
(
˛õ¡
 *
c
) {

585 
	`dñGíîicComm™d
(
c
,1);

586 
	}
}

590 
	$exi°sComm™d
(
˛õ¡
 *
c
) {

591 
cou¡
 = 0;

592 
j
;

594 
j
 = 1; j < 
c
->
¨gc
; j++) {

595 i‡(
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
j
])Ë
cou¡
++;

597 
	`addRïlyL⁄gL⁄g
(
c
,
cou¡
);

598 
	}
}

600 
	$£À˘Comm™d
(
˛õ¡
 *
c
) {

601 
id
;

603 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[1], &
id
,

604 "övÆid DB index"Ë!
C_OK
)

607 i‡(
£rvî
.
˛u°î_íabÀd
 && 
id
 != 0) {

608 
	`addRïlyEº‹
(
c
,"SELECT isÇotállowed in cluster mode");

611 i‡(
	`£À˘Db
(
c
,
id
Ë=
C_ERR
) {

612 
	`addRïlyEº‹
(
c
,"DB index is out ofÑange");

614 
	`addRïly
(
c
,
sh¨ed
.
ok
);

616 
	}
}

618 
	$øndomkeyComm™d
(
˛õ¡
 *
c
) {

619 
robj
 *
key
;

621 i‡((
key
 = 
	`dbR™domKey
(
c
->
db
)Ë=
NULL
) {

622 
	`addRïlyNuŒ
(
c
);

626 
	`addRïlyBulk
(
c
,
key
);

627 
	`de¸RefCou¡
(
key
);

628 
	}
}

630 
	$keysComm™d
(
˛õ¡
 *
c
) {

631 
di˘Iãøt‹
 *
di
;

632 
di˘E¡ry
 *
de
;

633 
sds
 
∑âîn
 = 
c
->
¨gv
[1]->
±r
;

634 
∂í
 = 
	`sd¶í
(
∑âîn
), 
Ælkeys
;

635 
numkeys
 = 0;

636 *
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

638 
di
 = 
	`di˘GëSa„Iãøt‹
(
c
->
db
->
di˘
);

639 
Ælkeys
 = (
∑âîn
[0] ='*' && 
∂í
 == 1);

640 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

641 
sds
 
key
 = 
	`di˘GëKey
(
de
);

642 
robj
 *
keyobj
;

644 i‡(
Ælkeys
 || 
	`°rögm©chÀn
(
∑âîn
,
∂í
,
key
,
	`sd¶í
(key),0)) {

645 
keyobj
 = 
	`¸óãSåögObje˘
(
key
,
	`sd¶í
(key));

646 i‡(!
	`keyIsExpúed
(
c
->
db
,
keyobj
)) {

647 
	`addRïlyBulk
(
c
,
keyobj
);

648 
numkeys
++;

650 
	`de¸RefCou¡
(
keyobj
);

653 
	`di˘Rñó£Iãøt‹
(
di
);

654 
	`£tDe„ºedAºayLí
(
c
,
ª∂yÀn
,
numkeys
);

655 
	}
}

659 
	$sˇnCÆlback
(*
¥ivd©a
, c⁄° 
di˘E¡ry
 *
de
) {

660 **
pd
 = (**Ë
¥ivd©a
;

661 
li°
 *
keys
 = 
pd
[0];

662 
robj
 *
o
 = 
pd
[1];

663 
robj
 *
key
, *
vÆ
 = 
NULL
;

665 i‡(
o
 =
NULL
) {

666 
sds
 
sdskey
 = 
	`di˘GëKey
(
de
);

667 
key
 = 
	`¸óãSåögObje˘
(
sdskey
, 
	`sd¶í
(sdskey));

668 } i‡(
o
->
ty≥
 =
OBJ_SET
) {

669 
sds
 
keysds
 = 
	`di˘GëKey
(
de
);

670 
key
 = 
	`¸óãSåögObje˘
(
keysds
,
	`sd¶í
(keysds));

671 } i‡(
o
->
ty≥
 =
OBJ_HASH
) {

672 
sds
 
sdskey
 = 
	`di˘GëKey
(
de
);

673 
sds
 
sdsvÆ
 = 
	`di˘GëVÆ
(
de
);

674 
key
 = 
	`¸óãSåögObje˘
(
sdskey
,
	`sd¶í
(sdskey));

675 
vÆ
 = 
	`¸óãSåögObje˘
(
sdsvÆ
,
	`sd¶í
(sdsval));

676 } i‡(
o
->
ty≥
 =
OBJ_ZSET
) {

677 
sds
 
sdskey
 = 
	`di˘GëKey
(
de
);

678 
key
 = 
	`¸óãSåögObje˘
(
sdskey
,
	`sd¶í
(sdskey));

679 
vÆ
 = 
	`¸óãSåögObje˘FromL⁄gDoubÀ
(*(*)
	`di˘GëVÆ
(
de
),0);

681 
	`£rvîP™ic
("TypeÇot handled in SCAN callback.");

684 
	`li°AddNodeTaû
(
keys
, 
key
);

685 i‡(
vÆ
Ë
	`li°AddNodeTaû
(
keys
, val);

686 
	}
}

692 
	$∑r£SˇnCurs‹OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
curs‹
) {

693 *
ïå
;

697 
î∫o
 = 0;

698 *
curs‹
 = 
	`°πoul
(
o
->
±r
, &
ïå
, 10);

699 i‡(
	`is•a˚
(((*)
o
->
±r
)[0]Ë|| 
ïå
[0] !'\0' || 
î∫o
 =
ERANGE
)

701 
	`addRïlyEº‹
(
c
, "invalid cursor");

702  
C_ERR
;

704  
C_OK
;

705 
	}
}

718 
	$sˇnGíîicComm™d
(
˛õ¡
 *
c
, 
robj
 *
o
, 
curs‹
) {

719 
i
, 
j
;

720 
li°
 *
keys
 = 
	`li°Cª©e
();

721 
li°Node
 *
node
, *
√xäode
;

722 
cou¡
 = 10;

723 
sds
 
∑t
 = 
NULL
;

724 
sds
 
ty≥«me
 = 
NULL
;

725 
∑éí
 = 0, 
u£_∑âîn
 = 0;

726 
di˘
 *
ht
;

730 
	`£rvîAs£π
(
o
 =
NULL
 || o->
ty≥
 =
OBJ_SET
 || o->ty≥ =
OBJ_HASH
 ||

731 
o
->
ty≥
 =
OBJ_ZSET
);

734 
i
 = (
o
 =
NULL
) ? 2 : 3;

737 
i
 < 
c
->
¨gc
) {

738 
j
 = 
c
->
¨gc
 - 
i
;

739 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
]->
±r
, "cou¡"Ë&& 
j
 >= 2) {

740 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[
i
+1], &
cou¡
, 
NULL
)

741 !
C_OK
)

743 
˛ónup
;

746 i‡(
cou¡
 < 1) {

747 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

748 
˛ónup
;

751 
i
 += 2;

752 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
]->
±r
, "m©ch"Ë&& 
j
 >= 2) {

753 
∑t
 = 
c
->
¨gv
[
i
+1]->
±r
;

754 
∑éí
 = 
	`sd¶í
(
∑t
);

758 
u£_∑âîn
 = !(
∑t
[0] ='*' && 
∑éí
 == 1);

760 
i
 += 2;

761 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
]->
±r
, "ty≥"Ë&& 
o
 =
NULL
 && 
j
 >= 2) {

763 
ty≥«me
 = 
c
->
¨gv
[
i
+1]->
±r
;

764 
i
+= 2;

766 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

767 
˛ónup
;

780 
ht
 = 
NULL
;

781 i‡(
o
 =
NULL
) {

782 
ht
 = 
c
->
db
->
di˘
;

783 } i‡(
o
->
ty≥
 =
OBJ_SET
 && o->
ícodög
 =
OBJ_ENCODING_HT
) {

784 
ht
 = 
o
->
±r
;

785 } i‡(
o
->
ty≥
 =
OBJ_HASH
 && o->
ícodög
 =
OBJ_ENCODING_HT
) {

786 
ht
 = 
o
->
±r
;

787 
cou¡
 *= 2;

788 } i‡(
o
->
ty≥
 =
OBJ_ZSET
 && o->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

789 
z£t
 *
zs
 = 
o
->
±r
;

790 
ht
 = 
zs
->
di˘
;

791 
cou¡
 *= 2;

794 i‡(
ht
) {

795 *
¥ivd©a
[2];

800 
maxôî©i⁄s
 = 
cou¡
*10;

805 
¥ivd©a
[0] = 
keys
;

806 
¥ivd©a
[1] = 
o
;

808 
curs‹
 = 
	`di˘Sˇn
(
ht
, curs‹, 
sˇnCÆlback
, 
NULL
, 
¥ivd©a
);

809 } 
curs‹
 &&

810 
maxôî©i⁄s
-- &&

811 
	`li°Lígth
(
keys
Ë< ()
cou¡
);

812 } i‡(
o
->
ty≥
 =
OBJ_SET
) {

813 
pos
 = 0;

814 
öt64_t
 
Œ
;

816 
	`öt£tGë
(
o
->
±r
,
pos
++,&
Œ
))

817 
	`li°AddNodeTaû
(
keys
,
	`¸óãSåögObje˘FromL⁄gL⁄g
(
Œ
));

818 
curs‹
 = 0;

819 } i‡(
o
->
ty≥
 =
OBJ_HASH
 || o->ty≥ =
OBJ_ZSET
) {

820 *
p
 = 
	`zùli°Index
(
o
->
±r
,0);

821 *
v°r
;

822 
vÀn
;

823 
vŒ
;

825 
p
) {

826 
	`zùli°Gë
(
p
,&
v°r
,&
vÀn
,&
vŒ
);

827 
	`li°AddNodeTaû
(
keys
,

828 (
v°r
 !
NULL
Ë? 
	`¸óãSåögObje˘
((*)v°r,
vÀn
) :

829 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
vŒ
));

830 
p
 = 
	`zùli°Next
(
o
->
±r
,p);

832 
curs‹
 = 0;

834 
	`£rvîP™ic
("Not handledÉncoding in SCAN.");

838 
node
 = 
	`li°Fú°
(
keys
);

839 
node
) {

840 
robj
 *
kobj
 = 
	`li°NodeVÆue
(
node
);

841 
√xäode
 = 
	`li°NextNode
(
node
);

842 
fûãr
 = 0;

845 i‡(!
fûãr
 && 
u£_∑âîn
) {

846 i‡(
	`sdsEncodedObje˘
(
kobj
)) {

847 i‡(!
	`°rögm©chÀn
(
∑t
, 
∑éí
, 
kobj
->
±r
, 
	`sd¶í
(kobj->ptr), 0))

848 
fûãr
 = 1;

850 
buf
[
LONG_STR_SIZE
];

851 
Àn
;

853 
	`£rvîAs£π
(
kobj
->
ícodög
 =
OBJ_ENCODING_INT
);

854 
Àn
 = 
	`Œ2°rög
(
buf
,(buf),()
kobj
->
±r
);

855 i‡(!
	`°rögm©chÀn
(
∑t
, 
∑éí
, 
buf
, 
Àn
, 0)Ë
fûãr
 = 1;

860 i‡(!
fûãr
 && 
o
 =
NULL
 && 
ty≥«me
){

861 
robj
* 
ty≥check
 = 
	`lookupKeyRódWôhFœgs
(
c
->
db
, 
kobj
, 
LOOKUP_NOTOUCH
);

862 * 
ty≥
 = 
	`gëObje˘Ty≥Name
(
ty≥check
);

863 i‡(
	`°rˇ£cmp
((*Ë
ty≥«me
, 
ty≥
)Ë
fûãr
 = 1;

867 i‡(!
fûãr
 && 
o
 =
NULL
 && 
	`expúeIfNìded
(
c
->
db
, 
kobj
)) filter = 1;

870 i‡(
fûãr
) {

871 
	`de¸RefCou¡
(
kobj
);

872 
	`li°DñNode
(
keys
, 
node
);

878 i‡(
o
 && (o->
ty≥
 =
OBJ_ZSET
 || o->ty≥ =
OBJ_HASH
)) {

879 
node
 = 
√xäode
;

880 
√xäode
 = 
	`li°NextNode
(
node
);

881 i‡(
fûãr
) {

882 
kobj
 = 
	`li°NodeVÆue
(
node
);

883 
	`de¸RefCou¡
(
kobj
);

884 
	`li°DñNode
(
keys
, 
node
);

887 
node
 = 
√xäode
;

891 
	`addRïlyAºayLí
(
c
, 2);

892 
	`addRïlyBulkL⁄gL⁄g
(
c
,
curs‹
);

894 
	`addRïlyAºayLí
(
c
, 
	`li°Lígth
(
keys
));

895 (
node
 = 
	`li°Fú°
(
keys
)Ë!
NULL
) {

896 
robj
 *
kobj
 = 
	`li°NodeVÆue
(
node
);

897 
	`addRïlyBulk
(
c
, 
kobj
);

898 
	`de¸RefCou¡
(
kobj
);

899 
	`li°DñNode
(
keys
, 
node
);

902 
˛ónup
:

903 
	`li°SëFªeMëhod
(
keys
,
de¸RefCou¡Void
);

904 
	`li°Rñó£
(
keys
);

905 
	}
}

908 
	$sˇnComm™d
(
˛õ¡
 *
c
) {

909 
curs‹
;

910 i‡(
	`∑r£SˇnCurs‹OrRïly
(
c
,c->
¨gv
[1],&
curs‹
Ë=
C_ERR
) ;

911 
	`sˇnGíîicComm™d
(
c
,
NULL
,
curs‹
);

912 
	}
}

914 
	$dbsizeComm™d
(
˛õ¡
 *
c
) {

915 
	`addRïlyL⁄gL⁄g
(
c
,
	`di˘Size
(c->
db
->
di˘
));

916 
	}
}

918 
	$œ°ßveComm™d
(
˛õ¡
 *
c
) {

919 
	`addRïlyL⁄gL⁄g
(
c
,
£rvî
.
œ°ßve
);

920 
	}
}

922 * 
	$gëObje˘Ty≥Name
(
robj
 *
o
) {

923 * 
ty≥
;

924 i‡(
o
 =
NULL
) {

925 
ty≥
 = "none";

927 
o
->
ty≥
) {

928 
OBJ_STRING
: 
ty≥
 = "string"; ;

929 
OBJ_LIST
: 
ty≥
 = "list"; ;

930 
OBJ_SET
: 
ty≥
 = "set"; ;

931 
OBJ_ZSET
: 
ty≥
 = "zset"; ;

932 
OBJ_HASH
: 
ty≥
 = "hash"; ;

933 
OBJ_STREAM
: 
ty≥
 = "stream"; ;

934 
OBJ_MODULE
: {

935 
moduÀVÆue
 *
mv
 = 
o
->
±r
;

936 
ty≥
 = 
mv
->ty≥->
«me
;

938 : 
ty≥
 = "unknown"; ;

941  
ty≥
;

942 
	}
}

944 
	$ty≥Comm™d
(
˛õ¡
 *
c
) {

945 
robj
 *
o
;

946 
o
 = 
	`lookupKeyRódWôhFœgs
(
c
->
db
,c->
¨gv
[1],
LOOKUP_NOTOUCH
);

947 
	`addRïlySètus
(
c
, 
	`gëObje˘Ty≥Name
(
o
));

948 
	}
}

950 
	$shutdownComm™d
(
˛õ¡
 *
c
) {

951 
Êags
 = 0;

953 i‡(
c
->
¨gc
 > 2) {

954 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

956 } i‡(
c
->
¨gc
 == 2) {

957 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"nosave")) {

958 
Êags
 |
SHUTDOWN_NOSAVE
;

959 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"save")) {

960 
Êags
 |
SHUTDOWN_SAVE
;

962 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

972 i‡(
£rvî
.
lﬂdög
 || sîvî.
£¡öñ_mode
)

973 
Êags
 = (Êag†& ~
SHUTDOWN_SAVE
Ë| 
SHUTDOWN_NOSAVE
;

974 i‡(
	`¥ï¨eF‹Shutdown
(
Êags
Ë=
C_OK
Ë
	`exô
(0);

975 
	`addRïlyEº‹
(
c
,"ErrorsÅryingÅo SHUTDOWN. CheckÜogs.");

976 
	}
}

978 
	$ª«meGíîicComm™d
(
˛õ¡
 *
c
, 
nx
) {

979 
robj
 *
o
;

980 
expúe
;

981 
ßmekey
 = 0;

985 i‡(
	`sdscmp
(
c
->
¨gv
[1]->
±r
,c->¨gv[2]->±rË=0Ë
ßmekey
 = 1;

987 i‡((
o
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nokeyîr
)Ë=
NULL
)

990 i‡(
ßmekey
) {

991 
	`addRïly
(
c
,
nx
 ? 
sh¨ed
.
czîo
 : sh¨ed.
ok
);

995 
	`ö¸RefCou¡
(
o
);

996 
expúe
 = 
	`gëExpúe
(
c
->
db
,c->
¨gv
[1]);

997 i‡(
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[2]Ë!
NULL
) {

998 i‡(
nx
) {

999 
	`de¸RefCou¡
(
o
);

1000 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

1005 
	`dbDñëe
(
c
->
db
,c->
¨gv
[2]);

1007 
	`dbAdd
(
c
->
db
,c->
¨gv
[2],
o
);

1008 i‡(
expúe
 !-1Ë
	`£tExpúe
(
c
,c->
db
,c->
¨gv
[2],expire);

1009 
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

1010 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

1011 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[2]);

1012 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"rename_from",

1013 
c
->
¨gv
[1],c->
db
->
id
);

1014 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"rename_to",

1015 
c
->
¨gv
[2],c->
db
->
id
);

1016 
£rvî
.
dúty
++;

1017 
	`addRïly
(
c
,
nx
 ? 
sh¨ed
.
c⁄e
 : sh¨ed.
ok
);

1018 
	}
}

1020 
	$ª«meComm™d
(
˛õ¡
 *
c
) {

1021 
	`ª«meGíîicComm™d
(
c
,0);

1022 
	}
}

1024 
	$ª«míxComm™d
(
˛õ¡
 *
c
) {

1025 
	`ª«meGíîicComm™d
(
c
,1);

1026 
	}
}

1028 
	$moveComm™d
(
˛õ¡
 *
c
) {

1029 
robj
 *
o
;

1030 
ªdisDb
 *
§c
, *
d°
;

1031 
§cid
;

1032 
dbid
, 
expúe
;

1034 i‡(
£rvî
.
˛u°î_íabÀd
) {

1035 
	`addRïlyEº‹
(
c
,"MOVE isÇotállowed in cluster mode");

1040 
§c
 = 
c
->
db
;

1041 
§cid
 = 
c
->
db
->
id
;

1043 i‡(
	`gëL⁄gL⁄gFromObje˘
(
c
->
¨gv
[2],&
dbid
Ë=
C_ERR
 ||

1044 
dbid
 < 
INT_MIN
 || dbid > 
INT_MAX
 ||

1045 
	`£À˘Db
(
c
,
dbid
Ë=
C_ERR
)

1047 
	`addRïly
(
c
,
sh¨ed
.
outo‰™gìº
);

1050 
d°
 = 
c
->
db
;

1051 
	`£À˘Db
(
c
,
§cid
);

1055 i‡(
§c
 =
d°
) {

1056 
	`addRïly
(
c
,
sh¨ed
.
ßmeobje˘îr
);

1061 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

1062 i‡(!
o
) {

1063 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

1066 
expúe
 = 
	`gëExpúe
(
c
->
db
,c->
¨gv
[1]);

1069 i‡(
	`lookupKeyWrôe
(
d°
,
c
->
¨gv
[1]Ë!
NULL
) {

1070 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

1073 
	`dbAdd
(
d°
,
c
->
¨gv
[1],
o
);

1074 i‡(
expúe
 !-1Ë
	`£tExpúe
(
c
,
d°
,c->
¨gv
[1],expire);

1075 
	`ö¸RefCou¡
(
o
);

1078 
	`dbDñëe
(
§c
,
c
->
¨gv
[1]);

1079 
	`sig«lModifõdKey
(
c
,
§c
,c->
¨gv
[1]);

1080 
	`sig«lModifõdKey
(
c
,
d°
,c->
¨gv
[1]);

1081 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,

1082 "move_‰om",
c
->
¨gv
[1],
§c
->
id
);

1083 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,

1084 "move_to",
c
->
¨gv
[1],
d°
->
id
);

1086 
£rvî
.
dúty
++;

1087 
	`addRïly
(
c
,
sh¨ed
.
c⁄e
);

1088 
	}
}

1094 
	$sˇnD©aba£F‹RódyLi°s
(
ªdisDb
 *
db
) {

1095 
di˘E¡ry
 *
de
;

1096 
di˘Iãøt‹
 *
di
 = 
	`di˘GëSa„Iãøt‹
(
db
->
blockög_keys
);

1097 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1098 
robj
 *
key
 = 
	`di˘GëKey
(
de
);

1099 
robj
 *
vÆue
 = 
	`lookupKey
(
db
,
key
,
LOOKUP_NOTOUCH
);

1100 i‡(
vÆue
 && (vÆue->
ty≥
 =
OBJ_LIST
 ||

1101 
vÆue
->
ty≥
 =
OBJ_STREAM
 ||

1102 
vÆue
->
ty≥
 =
OBJ_ZSET
))

1103 
	`sig«lKeyAsRódy
(
db
, 
key
);

1105 
	`di˘Rñó£Iãøt‹
(
di
);

1106 
	}
}

1116 
	$dbSw≠D©aba£s
(
id1
, 
id2
) {

1117 i‡(
id1
 < 0 || id1 >
£rvî
.
dbnum
 ||

1118 
id2
 < 0 || id2 >
£rvî
.
dbnum
Ë 
C_ERR
;

1119 i‡(
id1
 =
id2
Ë 
C_OK
;

1120 
ªdisDb
 
aux
 = 
£rvî
.
db
[
id1
];

1121 
ªdisDb
 *
db1
 = &
£rvî
.
db
[
id1
], *
db2
 = &£rvî.db[
id2
];

1126 
db1
->
di˘
 = 
db2
->dict;

1127 
db1
->
expúes
 = 
db2
->expires;

1128 
db1
->
avg_âl
 = 
db2
->avg_ttl;

1129 
db1
->
expúes_curs‹
 = 
db2
->expires_cursor;

1131 
db2
->
di˘
 = 
aux
.dict;

1132 
db2
->
expúes
 = 
aux
.expires;

1133 
db2
->
avg_âl
 = 
aux
.avg_ttl;

1134 
db2
->
expúes_curs‹
 = 
aux
.expires_cursor;

1145 
	`sˇnD©aba£F‹RódyLi°s
(
db1
);

1146 
	`sˇnD©aba£F‹RódyLi°s
(
db2
);

1147  
C_OK
;

1148 
	}
}

1151 
	$sw≠dbComm™d
(
˛õ¡
 *
c
) {

1152 
id1
, 
id2
;

1155 i‡(
£rvî
.
˛u°î_íabÀd
) {

1156 
	`addRïlyEº‹
(
c
,"SWAPDB isÇotállowed in cluster mode");

1161 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[1], &
id1
,

1162 "övÆid fú° DB index"Ë!
C_OK
)

1165 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
id2
,

1166 "övÆid sec⁄d DB index"Ë!
C_OK
)

1170 i‡(
	`dbSw≠D©aba£s
(
id1
,
id2
Ë=
C_ERR
) {

1171 
	`addRïlyEº‹
(
c
,"DB index is out ofÑange");

1174 
£rvî
.
dúty
++;

1175 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1177 
	}
}

1183 
	$ªmoveExpúe
(
ªdisDb
 *
db
, 
robj
 *
key
) {

1186 
	`£rvîAs£πWôhInfo
(
NULL
,
key
,
	`di˘Föd
(
db
->
di˘
,key->
±r
) != NULL);

1187  
	`di˘Dñëe
(
db
->
expúes
,
key
->
±r
Ë=
DICT_OK
;

1188 
	}
}

1194 
	$£tExpúe
(
˛õ¡
 *
c
, 
ªdisDb
 *
db
, 
robj
 *
key
, 
whí
) {

1195 
di˘E¡ry
 *
kde
, *
de
;

1198 
kde
 = 
	`di˘Föd
(
db
->
di˘
,
key
->
±r
);

1199 
	`£rvîAs£πWôhInfo
(
NULL
,
key
,
kde
 != NULL);

1200 
de
 = 
	`di˘AddOrFöd
(
db
->
expúes
,
	`di˘GëKey
(
kde
));

1201 
	`di˘SëSig√dI¡egîVÆ
(
de
,
whí
);

1203 
wrôabÀ_¶ave
 = 
£rvî
.
ma°îho°
 && sîvî.
ª∂_¶ave_ro
 == 0;

1204 i‡(
c
 && 
wrôabÀ_¶ave
 && !(c->
Êags
 & 
CLIENT_MASTER
))

1205 
	`ªmembîSœveKeyWôhExpúe
(
db
,
key
);

1206 
	}
}

1210 
	$gëExpúe
(
ªdisDb
 *
db
, 
robj
 *
key
) {

1211 
di˘E¡ry
 *
de
;

1214 i‡(
	`di˘Size
(
db
->
expúes
) == 0 ||

1215 (
de
 = 
	`di˘Föd
(
db
->
expúes
,
key
->
±r
)Ë=
NULL
)  -1;

1219 
	`£rvîAs£πWôhInfo
(
NULL
,
key
,
	`di˘Föd
(
db
->
di˘
,key->
±r
) != NULL);

1220  
	`di˘GëSig√dI¡egîVÆ
(
de
);

1221 
	}
}

1231 
	$¥›ag©eExpúe
(
ªdisDb
 *
db
, 
robj
 *
key
, 
œzy
) {

1232 
robj
 *
¨gv
[2];

1234 
¨gv
[0] = 
œzy
 ? 
sh¨ed
.
u∆ök
 : sh¨ed.
dñ
;

1235 
¨gv
[1] = 
key
;

1236 
	`ö¸RefCou¡
(
¨gv
[0]);

1237 
	`ö¸RefCou¡
(
¨gv
[1]);

1239 i‡(
£rvî
.
aof_°©e
 !
AOF_OFF
)

1240 
	`„edAµídO∆yFûe
(
£rvî
.
dñComm™d
,
db
->
id
,
¨gv
,2);

1241 
	`ª∂iˇti⁄FìdSœves
(
£rvî
.
¶aves
,
db
->
id
,
¨gv
,2);

1243 
	`de¸RefCou¡
(
¨gv
[0]);

1244 
	`de¸RefCou¡
(
¨gv
[1]);

1245 
	}
}

1248 
	$keyIsExpúed
(
ªdisDb
 *
db
, 
robj
 *
key
) {

1249 
m°ime_t
 
whí
 = 
	`gëExpúe
(
db
,
key
);

1250 
m°ime_t
 
now
;

1252 i‡(
whí
 < 0)  0;

1255 i‡(
£rvî
.
lﬂdög
)  0;

1262 i‡(
£rvî
.
lua_ˇŒî
) {

1263 
now
 = 
£rvî
.
lua_time_°¨t
;

1272 i‡(
£rvî
.
fixed_time_expúe
 > 0) {

1273 
now
 = 
£rvî
.
m°ime
;

1277 
now
 = 
	`m°ime
();

1282  
now
 > 
whí
;

1283 
	}
}

1304 
	$expúeIfNìded
(
ªdisDb
 *
db
, 
robj
 *
key
) {

1305 i‡(!
	`keyIsExpúed
(
db
,
key
))  0;

1315 i‡(
£rvî
.
ma°îho°
 !
NULL
)  1;

1318 
£rvî
.
°©_expúedkeys
++;

1319 
	`¥›ag©eExpúe
(
db
,
key
,
£rvî
.
œzy‰ì_œzy_expúe
);

1320 
	`nŸifyKey•a˚Evít
(
NOTIFY_EXPIRED
,

1321 "expúed",
key
,
db
->
id
);

1322 
ªtvÆ
 = 
£rvî
.
œzy‰ì_œzy_expúe
 ? 
	`dbAsyncDñëe
(
db
,
key
) :

1323 
	`dbSyncDñëe
(
db
,
key
);

1324 i‡(
ªtvÆ
Ë
	`sig«lModifõdKey
(
NULL
,
db
,
key
);

1325  
ªtvÆ
;

1326 
	}
}

1331 
	#MAX_KEYS_BUFFER
 256

	)

1332 
	ggëKeysTempBuf„r
[
MAX_KEYS_BUFFER
];

1336 *
	$gëKeysUsögComm™dTabÀ
(
ªdisComm™d
 *
cmd
,
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

1337 
j
, 
i
 = 0, 
œ°
, *
keys
;

1338 
	`UNUSED
(
¨gv
);

1340 i‡(
cmd
->
fú°key
 == 0) {

1341 *
numkeys
 = 0;

1342  
NULL
;

1345 
œ°
 = 
cmd
->
œ°key
;

1346 i‡(
œ°
 < 0Ëœ° = 
¨gc
+last;

1348 
cou¡
 = ((
œ°
 - 
cmd
->
fú°key
)+1);

1349 
keys
 = 
gëKeysTempBuf„r
;

1350 i‡(
cou¡
 > 
MAX_KEYS_BUFFER
)

1351 
keys
 = 
	`zmÆloc
(()*
cou¡
);

1353 
j
 = 
cmd
->
fú°key
; j <
œ°
; j +cmd->
key°ï
) {

1354 i‡(
j
 >
¨gc
) {

1361 i‡(
cmd
->
Êags
 & 
CMD_MODULE
 || cmd->
¨ôy
 < 0) {

1362 
	`gëKeysFªeResu…
(
keys
);

1363 *
numkeys
 = 0;

1364  
NULL
;

1366 
	`£rvîP™ic
("Redis built-in command declared keysÖositionsÇot matchingÅheárityÑequirements.");

1369 
keys
[
i
++] = 
j
;

1371 *
numkeys
 = 
i
;

1372  
keys
;

1373 
	}
}

1386 *
	$gëKeysFromComm™d
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

1387 i‡(
cmd
->
Êags
 & 
CMD_MODULE_GETKEYS
) {

1388  
	`moduÀGëComm™dKeysVüAPI
(
cmd
,
¨gv
,
¨gc
,
numkeys
);

1389 } i‡(!(
cmd
->
Êags
 & 
CMD_MODULE
Ë&& cmd->
gëkeys_¥oc
) {

1390  
cmd
->
	`gëkeys_¥oc
(cmd,
¨gv
,
¨gc
,
numkeys
);

1392  
	`gëKeysUsögComm™dTabÀ
(
cmd
,
¨gv
,
¨gc
,
numkeys
);

1394 
	}
}

1397 
	$gëKeysFªeResu…
(*
ªsu…
) {

1398 i‡(
ªsu…
 !
gëKeysTempBuf„r
)

1399 
	`z‰ì
(
ªsu…
);

1400 
	}
}

1405 *
	$zuni⁄I¡îGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

1406 
i
, 
num
, *
keys
;

1407 
	`UNUSED
(
cmd
);

1409 
num
 = 
	`©oi
(
¨gv
[2]->
±r
);

1412 i‡(
num
 < 1 ||Çum > (
¨gc
-3)) {

1413 *
numkeys
 = 0;

1414  
NULL
;

1420 
keys
 = 
gëKeysTempBuf„r
;

1421 i‡(
num
+1>
MAX_KEYS_BUFFER
)

1422 
keys
 = 
	`zmÆloc
(()*(
num
+1));

1425 
i
 = 0; i < 
num
; i++Ë
keys
[i] = 3+i;

1428 
keys
[
num
] = 1;

1429 *
numkeys
 = 
num
+1;

1430  
keys
;

1431 
	}
}

1436 *
	$evÆGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

1437 
i
, 
num
, *
keys
;

1438 
	`UNUSED
(
cmd
);

1440 
num
 = 
	`©oi
(
¨gv
[2]->
±r
);

1443 i‡(
num
 <0 ||Çum > (
¨gc
-3)) {

1444 *
numkeys
 = 0;

1445  
NULL
;

1448 
keys
 = 
gëKeysTempBuf„r
;

1449 i‡(
num
>
MAX_KEYS_BUFFER
)

1450 
keys
 = 
	`zmÆloc
(()*
num
);

1452 *
numkeys
 = 
num
;

1455 
i
 = 0; i < 
num
; i++Ë
keys
[i] = 3+i;

1457  
keys
;

1458 
	}
}

1467 *
	$s‹tGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

1468 
i
, 
j
, 
num
, *
keys
, 
found_°‹e
 = 0;

1469 
	`UNUSED
(
cmd
);

1471 
num
 = 0;

1472 
keys
 = 
gëKeysTempBuf„r
;

1474 
keys
[
num
++] = 1;

1481 *
«me
;

1482 
skù
;

1483 } 
skùli°
[] = {

1487 {
NULL
, 0}

1490 
i
 = 2; i < 
¨gc
; i++) {

1491 
j
 = 0; 
skùli°
[j].
«me
 !
NULL
; j++) {

1492 i‡(!
	`°rˇ£cmp
(
¨gv
[
i
]->
±r
,
skùli°
[
j
].
«me
)) {

1493 
i
 +
skùli°
[
j
].
skù
;

1495 } i‡(!
	`°rˇ£cmp
(
¨gv
[
i
]->
±r
,"°‹e"Ë&& i+1 < 
¨gc
) {

1499 
found_°‹e
 = 1;

1500 
keys
[
num
] = 
i
+1;

1505 *
numkeys
 = 
num
 + 
found_°‹e
;

1506  
keys
;

1507 
	}
}

1509 *
	$migøãGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

1510 
i
, 
num
, 
fú°
, *
keys
;

1511 
	`UNUSED
(
cmd
);

1514 
fú°
 = 3;

1515 
num
 = 1;

1518 i‡(
¨gc
 > 6) {

1519 
i
 = 6; i < 
¨gc
; i++) {

1520 i‡(!
	`°rˇ£cmp
(
¨gv
[
i
]->
±r
,"keys") &&

1521 
	`sd¶í
(
¨gv
[3]->
±r
) == 0)

1523 
fú°
 = 
i
+1;

1524 
num
 = 
¨gc
-
fú°
;

1530 
keys
 = 
gëKeysTempBuf„r
;

1531 i‡(
num
>
MAX_KEYS_BUFFER
)

1532 
keys
 = 
	`zmÆloc
(()*
num
);

1534 
i
 = 0; i < 
num
; i++Ë
keys
[i] = 
fú°
+i;

1535 *
numkeys
 = 
num
;

1536  
keys
;

1537 
	}
}

1543 *
	$ge‹adiusGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

1544 
i
, 
num
, *
keys
;

1545 
	`UNUSED
(
cmd
);

1548 
°‹ed_key
 = -1;

1549 
i
 = 5; i < 
¨gc
; i++) {

1550 *
¨g
 = 
¨gv
[
i
]->
±r
;

1555 i‡((!
	`°rˇ£cmp
(
¨g
, "°‹e"Ë|| !°rˇ£cmp◊rg, "°‹edi°")Ë&& ((
i
+1Ë< 
¨gc
)) {

1556 
°‹ed_key
 = 
i
+1;

1557 
i
++;

1560 
num
 = 1 + (
°‹ed_key
 == -1 ? 0 : 1);

1566 
keys
 = 
gëKeysTempBuf„r
;

1567 i‡(
num
>
MAX_KEYS_BUFFER
)

1568 
keys
 = 
	`zmÆloc
((Ë* 
num
);

1571 
keys
[0] = 1;

1572 if(
num
 > 1) {

1573 
keys
[1] = 
°‹ed_key
;

1575 *
numkeys
 = 
num
;

1576  
keys
;

1577 
	}
}

1580 *
	$lcsGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
)

1582 
i
;

1583 *
keys
 = 
gëKeysTempBuf„r
;

1584 
	`UNUSED
(
cmd
);

1588 
i
 = 1; i < 
¨gc
; i++) {

1589 *
¨g
 = 
¨gv
[
i
]->
±r
;

1590 
m‹órgs
 = (
¨gc
-1Ë- 
i
;

1592 i‡(!
	`°rˇ£cmp
(
¨g
, "strings")) {

1594 } i‡(!
	`°rˇ£cmp
(
¨g
, "keys"Ë&& 
m‹órgs
 >= 2) {

1595 
keys
[0] = 
i
+1;

1596 
keys
[1] = 
i
+2;

1597 *
numkeys
 = 2;

1598  
keys
;

1601 *
numkeys
 = 0;

1602  
keys
;

1603 
	}
}

1607 *
	$mem‹yGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

1608 *
keys
;

1609 
	`UNUSED
(
cmd
);

1611 i‡(
¨gc
 >3 && !
	`°rˇ£cmp
(
¨gv
[1]->
±r
,"usage")) {

1612 
keys
 = 
gëKeysTempBuf„r
;

1613 
keys
[0] = 2;

1614 *
numkeys
 = 1;

1615  
keys
;

1617 *
numkeys
 = 0;

1618  
NULL
;

1619 
	}
}

1623 *
	$xªadGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

1624 
i
, 
num
 = 0, *
keys
;

1625 
	`UNUSED
(
cmd
);

1631 
°ªams_pos
 = -1;

1632 
i
 = 1; i < 
¨gc
; i++) {

1633 *
¨g
 = 
¨gv
[
i
]->
±r
;

1634 i‡(!
	`°rˇ£cmp
(
¨g
, "block")) {

1635 
i
++;

1636 } i‡(!
	`°rˇ£cmp
(
¨g
, "count")) {

1637 
i
++;

1638 } i‡(!
	`°rˇ£cmp
(
¨g
, "group")) {

1639 
i
 += 2;

1640 } i‡(!
	`°rˇ£cmp
(
¨g
, "noack")) {

1642 } i‡(!
	`°rˇ£cmp
(
¨g
, "streams")) {

1643 
°ªams_pos
 = 
i
;

1649 i‡(
°ªams_pos
 !-1Ë
num
 = 
¨gc
 - streams_pos - 1;

1652 i‡(
°ªams_pos
 =-1 || 
num
 == 0 ||Çum % 2 != 0) {

1653 *
numkeys
 = 0;

1654  
NULL
;

1656 
num
 /= 2;

1659 
keys
 = 
gëKeysTempBuf„r
;

1660 i‡(
num
>
MAX_KEYS_BUFFER
)

1661 
keys
 = 
	`zmÆloc
((Ë* 
num
);

1663 
i
 = 
°ªams_pos
+1; i < 
¨gc
-
num
; i++Ë
keys
[i-streams_pos-1] = i;

1664 *
numkeys
 = 
num
;

1665  
keys
;

1666 
	}
}

1672 
	$¶ŸToKeyUpd©eKey
(
sds
 
key
, 
add
) {

1673 
size_t
 
keyÀn
 = 
	`sd¶í
(
key
);

1674 
hash¶Ÿ
 = 
	`keyHashSlŸ
(
key
,
keyÀn
);

1675 
buf
[64];

1676 *
ödexed
 = 
buf
;

1678 
£rvî
.
˛u°î
->
¶Ÿs_keys_cou¡
[
hash¶Ÿ
] +
add
 ? 1 : -1;

1679 i‡(
keyÀn
+2 > 64Ë
ödexed
 = 
	`zmÆloc
(keylen+2);

1680 
ödexed
[0] = (
hash¶Ÿ
 >> 8) & 0xff;

1681 
ödexed
[1] = 
hash¶Ÿ
 & 0xff;

1682 
	`mem˝y
(
ödexed
+2,
key
,
keyÀn
);

1683 i‡(
add
) {

1684 
	`øxIn£π
(
£rvî
.
˛u°î
->
¶Ÿs_to_keys
,
ödexed
,
keyÀn
+2,
NULL
,NULL);

1686 
	`øxRemove
(
£rvî
.
˛u°î
->
¶Ÿs_to_keys
,
ödexed
,
keyÀn
+2,
NULL
);

1688 i‡(
ödexed
 !
buf
Ë
	`z‰ì
(indexed);

1689 
	}
}

1691 
	$¶ŸToKeyAdd
(
sds
 
key
) {

1692 
	`¶ŸToKeyUpd©eKey
(
key
,1);

1693 
	}
}

1695 
	$¶ŸToKeyDñ
(
sds
 
key
) {

1696 
	`¶ŸToKeyUpd©eKey
(
key
,0);

1697 
	}
}

1699 
	$¶ŸToKeyFlush
() {

1700 
	`øxFªe
(
£rvî
.
˛u°î
->
¶Ÿs_to_keys
);

1701 
£rvî
.
˛u°î
->
¶Ÿs_to_keys
 = 
	`øxNew
();

1702 
	`mem£t
(
£rvî
.
˛u°î
->
¶Ÿs_keys_cou¡
,0,

1703 (
£rvî
.
˛u°î
->
¶Ÿs_keys_cou¡
));

1704 
	}
}

1709 
	$gëKeysInSlŸ
(
hash¶Ÿ
, 
robj
 **
keys
, 
cou¡
) {

1710 
øxIãøt‹
 
ôî
;

1711 
j
 = 0;

1712 
ödexed
[2];

1714 
ödexed
[0] = (
hash¶Ÿ
 >> 8) & 0xff;

1715 
ödexed
[1] = 
hash¶Ÿ
 & 0xff;

1716 
	`øxSèπ
(&
ôî
,
£rvî
.
˛u°î
->
¶Ÿs_to_keys
);

1717 
	`øxSìk
(&
ôî
,">=",
ödexed
,2);

1718 
cou¡
-- && 
	`øxNext
(&
ôî
)) {

1719 i‡(
ôî
.
key
[0] !
ödexed
[0] || iter.key[1] != indexed[1]) ;

1720 
keys
[
j
++] = 
	`¸óãSåögObje˘
((*)
ôî
.
key
+2,ôî.
key_Àn
-2);

1722 
	`øxSt›
(&
ôî
);

1723  
j
;

1724 
	}
}

1728 
	$dñKeysInSlŸ
(
hash¶Ÿ
) {

1729 
øxIãøt‹
 
ôî
;

1730 
j
 = 0;

1731 
ödexed
[2];

1733 
ödexed
[0] = (
hash¶Ÿ
 >> 8) & 0xff;

1734 
ödexed
[1] = 
hash¶Ÿ
 & 0xff;

1735 
	`øxSèπ
(&
ôî
,
£rvî
.
˛u°î
->
¶Ÿs_to_keys
);

1736 
£rvî
.
˛u°î
->
¶Ÿs_keys_cou¡
[
hash¶Ÿ
]) {

1737 
	`øxSìk
(&
ôî
,">=",
ödexed
,2);

1738 
	`øxNext
(&
ôî
);

1740 
robj
 *
key
 = 
	`¸óãSåögObje˘
((*)
ôî
.key+2,ôî.
key_Àn
-2);

1741 
	`dbDñëe
(&
£rvî
.
db
[0],
key
);

1742 
	`de¸RefCou¡
(
key
);

1743 
j
++;

1745 
	`øxSt›
(&
ôî
);

1746  
j
;

1747 
	}
}

1749 
	$cou¡KeysInSlŸ
(
hash¶Ÿ
) {

1750  
£rvî
.
˛u°î
->
¶Ÿs_keys_cou¡
[
hash¶Ÿ
];

1751 
	}
}

	@debug.c

30 
	~"£rvî.h
"

31 
	~"sha1.h
"

32 
	~"¸c64.h
"

34 
	~<¨∑/öë.h
>

35 
	~<sig«l.h
>

36 
	~<dlf˙.h
>

38 #ifde‡
HAVE_BACKTRACE


39 
	~<execöfo.h
>

40 #i‚de‡
__O≥nBSD__


41 
	~<uc⁄ãxt.h
>

43 
uc⁄ãxt_t
 
	tsigc⁄ãxt_t
;

45 
	~<f˙é.h
>

46 
	~"bio.h
"

47 
	~<uni°d.h
>

50 #ifde‡
__CYGWIN__


51 #i‚de‡
SA_ONSTACK


52 
	#SA_ONSTACK
 0x08000000

	)

64 
	$x‹Dige°
(*
dige°
, *
±r
, 
size_t
 
Àn
) {

65 
SHA1_CTX
 
˘x
;

66 
hash
[20], *
s
 = 
±r
;

67 
j
;

69 
	`SHA1Inô
(&
˘x
);

70 
	`SHA1Upd©e
(&
˘x
,
s
,
Àn
);

71 
	`SHA1FöÆ
(
hash
,&
˘x
);

73 
j
 = 0; j < 20; j++)

74 
dige°
[
j
] ^
hash
[j];

75 
	}
}

77 
	$x‹SåögObje˘Dige°
(*
dige°
, 
robj
 *
o
) {

78 
o
 = 
	`gëDecodedObje˘
(o);

79 
	`x‹Dige°
(
dige°
,
o
->
±r
,
	`sd¶í
(o->ptr));

80 
	`de¸RefCou¡
(
o
);

81 
	}
}

97 
	$mixDige°
(*
dige°
, *
±r
, 
size_t
 
Àn
) {

98 
SHA1_CTX
 
˘x
;

99 *
s
 = 
±r
;

101 
	`x‹Dige°
(
dige°
,
s
,
Àn
);

102 
	`SHA1Inô
(&
˘x
);

103 
	`SHA1Upd©e
(&
˘x
,
dige°
,20);

104 
	`SHA1FöÆ
(
dige°
,&
˘x
);

105 
	}
}

107 
	$mixSåögObje˘Dige°
(*
dige°
, 
robj
 *
o
) {

108 
o
 = 
	`gëDecodedObje˘
(o);

109 
	`mixDige°
(
dige°
,
o
->
±r
,
	`sd¶í
(o->ptr));

110 
	`de¸RefCou¡
(
o
);

111 
	}
}

121 
	$x‹Obje˘Dige°
(
ªdisDb
 *
db
, 
robj
 *
keyobj
, *
dige°
,Ñobj *
o
) {

122 
uöt32_t
 
aux
 = 
	`ht⁄l
(
o
->
ty≥
);

123 
	`mixDige°
(
dige°
,&
aux
,(aux));

124 
expúëime
 = 
	`gëExpúe
(
db
,
keyobj
);

125 
buf
[128];

128 i‡(
o
->
ty≥
 =
OBJ_STRING
) {

129 
	`mixSåögObje˘Dige°
(
dige°
,
o
);

130 } i‡(
o
->
ty≥
 =
OBJ_LIST
) {

131 
li°Ty≥Iãøt‹
 *
li
 = 
	`li°Ty≥InôIãøt‹
(
o
,0,
LIST_TAIL
);

132 
li°Ty≥E¡ry
 
íåy
;

133 
	`li°Ty≥Next
(
li
,&
íåy
)) {

134 
robj
 *
ñeobj
 = 
	`li°Ty≥Gë
(&
íåy
);

135 
	`mixSåögObje˘Dige°
(
dige°
,
ñeobj
);

136 
	`de¸RefCou¡
(
ñeobj
);

138 
	`li°Ty≥Rñó£Iãøt‹
(
li
);

139 } i‡(
o
->
ty≥
 =
OBJ_SET
) {

140 
£tTy≥Iãøt‹
 *
si
 = 
	`£tTy≥InôIãøt‹
(
o
);

141 
sds
 
sd£À
;

142 (
sd£À
 = 
	`£tTy≥NextObje˘
(
si
)Ë!
NULL
) {

143 
	`x‹Dige°
(
dige°
,
sd£À
,
	`sd¶í
(sdsele));

144 
	`sds‰ì
(
sd£À
);

146 
	`£tTy≥Rñó£Iãøt‹
(
si
);

147 } i‡(
o
->
ty≥
 =
OBJ_ZSET
) {

148 
ñedige°
[20];

150 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

151 *
zl
 = 
o
->
±r
;

152 *
ïå
, *
•å
;

153 *
v°r
;

154 
vÀn
;

155 
vŒ
;

156 
sc‹e
;

158 
ïå
 = 
	`zùli°Index
(
zl
,0);

159 
	`£rvîAs£π
(
ïå
 !
NULL
);

160 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

161 
	`£rvîAs£π
(
•å
 !
NULL
);

163 
ïå
 !
NULL
) {

164 
	`£rvîAs£π
(
	`zùli°Gë
(
ïå
,&
v°r
,&
vÀn
,&
vŒ
));

165 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

167 
	`mem£t
(
ñedige°
,0,20);

168 i‡(
v°r
 !
NULL
) {

169 
	`mixDige°
(
ñedige°
,
v°r
,
vÀn
);

171 
	`Œ2°rög
(
buf
,(buf),
vŒ
);

172 
	`mixDige°
(
ñedige°
,
buf
,
	`°æí
(buf));

175 
	`¢¥ötf
(
buf
,(buf),"%.17g",
sc‹e
);

176 
	`mixDige°
(
ñedige°
,
buf
,
	`°æí
(buf));

177 
	`x‹Dige°
(
dige°
,
ñedige°
,20);

178 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

180 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

181 
z£t
 *
zs
 = 
o
->
±r
;

182 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
zs
->
di˘
);

183 
di˘E¡ry
 *
de
;

185 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

186 
sds
 
sd£À
 = 
	`di˘GëKey
(
de
);

187 *
sc‹e
 = 
	`di˘GëVÆ
(
de
);

189 
	`¢¥ötf
(
buf
,(buf),"%.17g",*
sc‹e
);

190 
	`mem£t
(
ñedige°
,0,20);

191 
	`mixDige°
(
ñedige°
,
sd£À
,
	`sd¶í
(sdsele));

192 
	`mixDige°
(
ñedige°
,
buf
,
	`°æí
(buf));

193 
	`x‹Dige°
(
dige°
,
ñedige°
,20);

195 
	`di˘Rñó£Iãøt‹
(
di
);

197 
	`£rvîP™ic
("Unknown sorted setÉncoding");

199 } i‡(
o
->
ty≥
 =
OBJ_HASH
) {

200 
hashTy≥Iãøt‹
 *
hi
 = 
	`hashTy≥InôIãøt‹
(
o
);

201 
	`hashTy≥Next
(
hi
Ë!
C_ERR
) {

202 
ñedige°
[20];

203 
sds
 
sd£À
;

205 
	`mem£t
(
ñedige°
,0,20);

206 
sd£À
 = 
	`hashTy≥CuºítObje˘NewSds
(
hi
,
OBJ_HASH_KEY
);

207 
	`mixDige°
(
ñedige°
,
sd£À
,
	`sd¶í
(sdsele));

208 
	`sds‰ì
(
sd£À
);

209 
sd£À
 = 
	`hashTy≥CuºítObje˘NewSds
(
hi
,
OBJ_HASH_VALUE
);

210 
	`mixDige°
(
ñedige°
,
sd£À
,
	`sd¶í
(sdsele));

211 
	`sds‰ì
(
sd£À
);

212 
	`x‹Dige°
(
dige°
,
ñedige°
,20);

214 
	`hashTy≥Rñó£Iãøt‹
(
hi
);

215 } i‡(
o
->
ty≥
 =
OBJ_STREAM
) {

216 
°ªamIãøt‹
 
si
;

217 
	`°ªamIãøt‹Sèπ
(&
si
,
o
->
±r
,
NULL
,NULL,0);

218 
°ªamID
 
id
;

219 
öt64_t
 
numfõlds
;

221 
	`°ªamIãøt‹GëID
(&
si
,&
id
,&
numfõlds
)) {

222 
sds
 
ôemid
 = 
	`sdsˇtfmt
(
	`sd£m±y
(),"%U.%U",
id
.
ms
,id.
£q
);

223 
	`mixDige°
(
dige°
,
ôemid
,
	`sd¶í
(itemid));

224 
	`sds‰ì
(
ôemid
);

226 
numfõlds
--) {

227 *
fõld
, *
vÆue
;

228 
öt64_t
 
fõld_Àn
, 
vÆue_Àn
;

229 
	`°ªamIãøt‹GëFõld
(&
si
,&
fõld
,&
vÆue
,

230 &
fõld_Àn
,&
vÆue_Àn
);

231 
	`mixDige°
(
dige°
,
fõld
,
fõld_Àn
);

232 
	`mixDige°
(
dige°
,
vÆue
,
vÆue_Àn
);

235 
	`°ªamIãøt‹St›
(&
si
);

236 } i‡(
o
->
ty≥
 =
OBJ_MODULE
) {

237 
RedisModuÀDige°
 
md
;

238 
moduÀVÆue
 *
mv
 = 
o
->
±r
;

239 
moduÀTy≥
 *
mt
 = 
mv
->
ty≥
;

240 
	`moduÀInôDige°C⁄ãxt
(
md
);

241 i‡(
mt
->
dige°
) {

242 
mt
->
	`dige°
(&
md
,
mv
->
vÆue
);

243 
	`x‹Dige°
(
dige°
,
md
.
x
,(md.x));

246 
	`£rvîP™ic
("Unknown objectÅype");

249 i‡(
expúëime
 !-1Ë
	`x‹Dige°
(
dige°
,"!!expire!!",10);

250 
	}
}

258 
	$compuãD©a£tDige°
(*
föÆ
) {

259 
dige°
[20];

260 
di˘Iãøt‹
 *
di
 = 
NULL
;

261 
di˘E¡ry
 *
de
;

262 
j
;

263 
uöt32_t
 
aux
;

265 
	`mem£t
(
föÆ
,0,20);

267 
j
 = 0; j < 
£rvî
.
dbnum
; j++) {

268 
ªdisDb
 *
db
 = 
£rvî
.db+
j
;

270 i‡(
	`di˘Size
(
db
->
di˘
) == 0) ;

271 
di
 = 
	`di˘GëSa„Iãøt‹
(
db
->
di˘
);

275 
aux
 = 
	`ht⁄l
(
j
);

276 
	`mixDige°
(
föÆ
,&
aux
,(aux));

279 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

280 
sds
 
key
;

281 
robj
 *
keyobj
, *
o
;

283 
	`mem£t
(
dige°
,0,20);

284 
key
 = 
	`di˘GëKey
(
de
);

285 
keyobj
 = 
	`¸óãSåögObje˘
(
key
,
	`sd¶í
(key));

287 
	`mixDige°
(
dige°
,
key
,
	`sd¶í
(key));

289 
o
 = 
	`di˘GëVÆ
(
de
);

290 
	`x‹Obje˘Dige°
(
db
,
keyobj
,
dige°
,
o
);

293 
	`x‹Dige°
(
föÆ
,
dige°
,20);

294 
	`de¸RefCou¡
(
keyobj
);

296 
	`di˘Rñó£Iãøt‹
(
di
);

298 
	}
}

300 #ifde‡
USE_JEMALLOC


301 
	$mÆl˘l_öt
(
˛õ¡
 *
c
, 
robj
 **
¨gv
, 
¨gc
) {

302 
ªt
;

304 
öt64_t
 
ﬁd
 = 0, 
vÆ
;

305 i‡(
¨gc
 > 1) {

306 
Œ
;

307 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
, 
¨gv
[1], &
Œ
, 
NULL
Ë!
C_OK
)

309 
vÆ
 = 
Œ
;

311 
size_t
 
sz
 = (
ﬁd
);

312 
sz
 > 0) {

313 i‡((
ªt
=
	`je_mÆl˘l
(
¨gv
[0]->
±r
, &
ﬁd
, &
sz
, 
¨gc
 > 1? &
vÆ
: 
NULL
,árgc > 1?sz: 0))) {

314 i‡(
ªt
==
EINVAL
) {

316 
sz
 /= 2;

317 #i‡
BYTE_ORDER
 =
BIG_ENDIAN


318 
vÆ
 <<8*
sz
;

322 
	`addRïlyEº‹F‹m©
(
c
,"%s", 
	`°ªº‹
(
ªt
));

325 #i‡
BYTE_ORDER
 =
BIG_ENDIAN


326 
ﬁd
 >>64 - 8*
sz
;

328 
	`addRïlyL⁄gL⁄g
(
c
, 
ﬁd
);

332 
	`addRïlyEº‹F‹m©
(
c
,"%s", 
	`°ªº‹
(
EINVAL
));

333 
	}
}

335 
	$mÆl˘l_°rög
(
˛õ¡
 *
c
, 
robj
 **
¨gv
, 
¨gc
) {

336 
ªt
;

337 *
ﬁd
;

338 
size_t
 
sz
 = (
ﬁd
);

340 i‡((
ªt
=
	`je_mÆl˘l
(
¨gv
[0]->
±r
, &
ﬁd
, &
sz
, 
NULL
, 0))) {

341 
	`addRïlyEº‹F‹m©
(
c
,"%s", 
	`°ªº‹
(
ªt
));

344 
	`addRïlyBulkCSåög
(
c
, 
ﬁd
);

345 if(
¨gc
 > 1)

346 
	`je_mÆl˘l
(
¨gv
[0]->
±r
, 
NULL
, 0, &argv[1]->ptr, (*));

347 
	}
}

350 
	$debugComm™d
(
˛õ¡
 *
c
) {

351 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"help")) {

352 c⁄° *
hñp
[] = {

379 #ifde‡
USE_JEMALLOC


383 
NULL


385 
	`addRïlyHñp
(
c
, 
hñp
);

386 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"segfault")) {

388 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"panic")) {

389 
	`£rvîP™ic
("DEBUG PANIC cÆÀdáàUnixÅimê%ld", 
	`time
(
NULL
));

390 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"restart") ||

391 !
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"crash-and-recover"))

393 
dñay
 = 0;

394 i‡(
c
->
¨gc
 >= 3) {

395 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
dñay
, 
NULL
)

396 !
C_OK
) ;

397 i‡(
dñay
 < 0) delay = 0;

399 
Êags
 = !
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"restart") ?

400 (
RESTART_SERVER_GRACEFULLY
|
RESTART_SERVER_CONFIG_REWRITE
) :

401 
RESTART_SERVER_NONE
;

402 
	`ª°¨tSîvî
(
Êags
,
dñay
);

403 
	`addRïlyEº‹
(
c
,"failedÅoÑestartÅhe server. Check serverÜogs.");

404 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"oom")) {

405 *
±r
 = 
	`zmÆloc
(
ULONG_MAX
);

406 
	`z‰ì
(
±r
);

407 
	`addRïly
(
c
,
sh¨ed
.
ok
);

408 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"assert")) {

409 
	`£rvîAs£πWôhInfo
(
c
,c->
¨gv
[0],1 == 2);

410 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"log"Ë&& c->
¨gc
 == 3) {

411 
	`£rvîLog
(
LL_WARNING
, "DEBUG LOG: %s", (*)
c
->
¨gv
[2]->
±r
);

412 
	`addRïly
(
c
,
sh¨ed
.
ok
);

413 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"reload")) {

414 
Êush
 = 1, 
ßve
 = 1;

415 
Êags
 = 
RDBFLAGS_NONE
;

419 
j
 = 2; j < 
c
->
¨gc
; j++) {

420 *
›t
 = 
c
->
¨gv
[
j
]->
±r
;

421 i‡(!
	`°rˇ£cmp
(
›t
,"MERGE")) {

422 
Êags
 |
RDBFLAGS_ALLOW_DUP
;

423 } i‡(!
	`°rˇ£cmp
(
›t
,"NOFLUSH")) {

424 
Êush
 = 0;

425 } i‡(!
	`°rˇ£cmp
(
›t
,"NOSAVE")) {

426 
ßve
 = 0;

428 
	`addRïlyEº‹
(
c
,"DEBUG RELOAD only supportsÅhe "

436 i‡(
ßve
) {

437 
rdbSaveInfo
 
rsi
, *
rsùå
;

438 
rsùå
 = 
	`rdbP›uœãSaveInfo
(&
rsi
);

439 i‡(
	`rdbSave
(
£rvî
.
rdb_fûíame
,
rsùå
Ë!
C_OK
) {

440 
	`addRïly
(
c
,
sh¨ed
.
îr
);

448 i‡(
Êush
Ë
	`em±yDb
(-1,
EMPTYDB_NO_FLAGS
,
NULL
);

450 
	`¥Ÿe˘Clõ¡
(
c
);

451 
ªt
 = 
	`rdbLﬂd
(
£rvî
.
rdb_fûíame
,
NULL
,
Êags
);

452 
	`u≈rŸe˘Clõ¡
(
c
);

453 i‡(
ªt
 !
C_OK
) {

454 
	`addRïlyEº‹
(
c
,"ErrorÅryingÅoÜoadÅhe RDB dump");

457 
	`£rvîLog
(
LL_WARNING
,"DBÑeloaded by DEBUG RELOAD");

458 
	`addRïly
(
c
,
sh¨ed
.
ok
);

459 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"loadaof")) {

460 i‡(
£rvî
.
aof_°©e
 !
AOF_OFF
Ë
	`ÊushAµídO∆yFûe
(1);

461 
	`em±yDb
(-1,
EMPTYDB_NO_FLAGS
,
NULL
);

462 
	`¥Ÿe˘Clõ¡
(
c
);

463 
ªt
 = 
	`lﬂdAµídO∆yFûe
(
£rvî
.
aof_fûíame
);

464 
	`u≈rŸe˘Clõ¡
(
c
);

465 i‡(
ªt
 !
C_OK
) {

466 
	`addRïly
(
c
,
sh¨ed
.
îr
);

469 
£rvî
.
dúty
 = 0;

470 
	`£rvîLog
(
LL_WARNING
,"Append Only FileÜoaded by DEBUG LOADAOF");

471 
	`addRïly
(
c
,
sh¨ed
.
ok
);

472 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"obje˘"Ë&& c->
¨gc
 == 3) {

473 
di˘E¡ry
 *
de
;

474 
robj
 *
vÆ
;

475 *
°ªnc
;

477 i‡((
de
 = 
	`di˘Föd
(
c
->
db
->
di˘
,c->
¨gv
[2]->
±r
)Ë=
NULL
) {

478 
	`addRïly
(
c
,
sh¨ed
.
nokeyîr
);

481 
vÆ
 = 
	`di˘GëVÆ
(
de
);

482 
°ªnc
 = 
	`°rEncodög
(
vÆ
->
ícodög
);

484 
exåa
[138] = {0};

485 i‡(
vÆ
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

486 *
√xåa
 = 
exåa
;

487 
ªmaöög
 = (
exåa
);

488 
quickli°
 *
ql
 = 
vÆ
->
±r
;

490 
u£d
 = 
	`¢¥ötf
(
√xåa
, 
ªmaöög
, " ql_nodes:%lu", 
ql
->
Àn
);

491 
√xåa
 +
u£d
;

492 
ªmaöög
 -
u£d
;

494 
avg
 = ()
ql
->
cou¡
/ql->
Àn
;

495 
u£d
 = 
	`¢¥ötf
(
√xåa
, 
ªmaöög
, " ql_avg_node:%.2f", 
avg
);

496 
√xåa
 +
u£d
;

497 
ªmaöög
 -
u£d
;

499 
u£d
 = 
	`¢¥ötf
(
√xåa
, 
ªmaöög
, " ql_zùli°_max:%d", 
ql
->
fûl
);

500 
√xåa
 +
u£d
;

501 
ªmaöög
 -
u£d
;

503 
com¥es£d
 = 
ql
->
com¥ess
 != 0;

504 
u£d
 = 
	`¢¥ötf
(
√xåa
, 
ªmaöög
, " ql_com¥es£d:%d", 
com¥es£d
);

505 
√xåa
 +
u£d
;

506 
ªmaöög
 -
u£d
;

508 
sz
 = 0;

509 
quickli°Node
 *
node
 = 
ql
->
hód
;Çode;Çodênode->
√xt
) {

510 
sz
 +
node
->sz;

512 
u£d
 = 
	`¢¥ötf
(
√xåa
, 
ªmaöög
, " ql_uncom¥es£d_size:%lu", 
sz
);

513 
√xåa
 +
u£d
;

514 
ªmaöög
 -
u£d
;

517 
	`addRïlySètusF‹m©
(
c
,

521 (*)
vÆ
, vÆ->
ªfcou¡
,

522 
°ªnc
, 
	`rdbSavedObje˘Lí
(
vÆ
, 
c
->
¨gv
[2]),

523 
vÆ
->
Ãu
, 
	`e°im©eObje˘IdÀTime
(vÆ)/1000, 
exåa
);

524 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"sd¶í"Ë&& c->
¨gc
 == 3) {

525 
di˘E¡ry
 *
de
;

526 
robj
 *
vÆ
;

527 
sds
 
key
;

529 i‡((
de
 = 
	`di˘Föd
(
c
->
db
->
di˘
,c->
¨gv
[2]->
±r
)Ë=
NULL
) {

530 
	`addRïly
(
c
,
sh¨ed
.
nokeyîr
);

533 
vÆ
 = 
	`di˘GëVÆ
(
de
);

534 
key
 = 
	`di˘GëKey
(
de
);

536 i‡(
vÆ
->
ty≥
 !
OBJ_STRING
 || !
	`sdsEncodedObje˘
(val)) {

537 
	`addRïlyEº‹
(
c
,"Notán sdsÉncoded string.");

539 
	`addRïlySètusF‹m©
(
c
,

542 (Ë
	`sd¶í
(
key
),

543 (Ë
	`sdßvaû
(
key
),

544 (Ë
	`sdsZmÆlocSize
(
key
),

545 (Ë
	`sd¶í
(
vÆ
->
±r
),

546 (Ë
	`sdßvaû
(
vÆ
->
±r
),

547 (Ë
	`gëSåögObje˘SdsU£dMem‹y
(
vÆ
));

549 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"zùli°"Ë&& c->
¨gc
 == 3) {

550 
robj
 *
o
;

552 i‡((
o
 = 
	`obje˘Comm™dLookupOrRïly
(
c
,c->
¨gv
[2],
sh¨ed
.
nokeyîr
))

553 =
NULL
) ;

555 i‡(
o
->
ícodög
 !
OBJ_ENCODING_ZIPLIST
) {

556 
	`addRïlyEº‹
(
c
,"Notán sdsÉncoded string.");

558 
	`zùli°Rïr
(
o
->
±r
);

559 
	`addRïlySètus
(
c
,"Ziplist structureÖrinted on stdout");

561 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"populate") &&

562 
c
->
¨gc
 >= 3 && c->argc <= 5) {

563 
keys
, 
j
;

564 
robj
 *
key
, *
vÆ
;

565 
buf
[128];

567 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
keys
, 
NULL
Ë!
C_OK
)

569 
	`di˘Ex∑nd
(
c
->
db
->
di˘
,
keys
);

570 
j
 = 0; j < 
keys
; j++) {

571 
vÆsize
 = 0;

572 
	`¢¥ötf
(
buf
,(buf),"%s:%lu",

573 (
c
->
¨gc
 =3Ë? "key" : (*)c->
¨gv
[3]->
±r
, 
j
);

574 
key
 = 
	`¸óãSåögObje˘
(
buf
,
	`°æí
(buf));

575 i‡(
c
->
¨gc
 == 5)

576 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[4], &
vÆsize
, 
NULL
Ë!
C_OK
)

578 i‡(
	`lookupKeyWrôe
(
c
->
db
,
key
Ë!
NULL
) {

579 
	`de¸RefCou¡
(
key
);

582 
	`¢¥ötf
(
buf
,(buf),"vÆue:%lu",
j
);

583 i‡(
vÆsize
==0)

584 
vÆ
 = 
	`¸óãSåögObje˘
(
buf
,
	`°æí
(buf));

586 
buÊí
 = 
	`°æí
(
buf
);

587 
vÆ
 = 
	`¸óãSåögObje˘
(
NULL
,
vÆsize
);

588 
	`mem˝y
(
vÆ
->
±r
, 
buf
, 
vÆsize
<=
buÊí
? valsize: buflen);

590 
	`dbAdd
(
c
->
db
,
key
,
vÆ
);

591 
	`sig«lModifõdKey
(
c
,c->
db
,
key
);

592 
	`de¸RefCou¡
(
key
);

594 
	`addRïly
(
c
,
sh¨ed
.
ok
);

595 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"dige°"Ë&& c->
¨gc
 == 2) {

597 
dige°
[20];

598 
sds
 
d
 = 
	`sd£m±y
();

600 
	`compuãD©a£tDige°
(
dige°
);

601 
i
 = 0; i < 20; i++Ë
d
 = 
	`sdsˇçrötf
(d, "%02x",
dige°
[i]);

602 
	`addRïlySètus
(
c
,
d
);

603 
	`sds‰ì
(
d
);

604 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"dige°-vÆue"Ë&& c->
¨gc
 >= 2) {

606 
	`addRïlyAºayLí
(
c
,c->
¨gc
-2);

607 
j
 = 2; j < 
c
->
¨gc
; j++) {

608 
dige°
[20];

609 
	`mem£t
(
dige°
,0,20);

610 
robj
 *
o
 = 
	`lookupKeyRódWôhFœgs
(
c
->
db
,c->
¨gv
[
j
],
LOOKUP_NOTOUCH
);

611 i‡(
o
Ë
	`x‹Obje˘Dige°
(
c
->
db
,c->
¨gv
[
j
],
dige°
,o);

613 
sds
 
d
 = 
	`sd£m±y
();

614 
i
 = 0; i < 20; i++Ë
d
 = 
	`sdsˇçrötf
(d, "%02x",
dige°
[i]);

615 
	`addRïlySètus
(
c
,
d
);

616 
	`sds‰ì
(
d
);

618 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"¥Ÿocﬁ"Ë&& c->
¨gc
 == 3) {

621 *
«me
 = 
c
->
¨gv
[2]->
±r
;

622 i‡(!
	`°rˇ£cmp
(
«me
,"string")) {

623 
	`addRïlyBulkCSåög
(
c
,"Hello World");

624 } i‡(!
	`°rˇ£cmp
(
«me
,"integer")) {

625 
	`addRïlyL⁄gL⁄g
(
c
,12345);

626 } i‡(!
	`°rˇ£cmp
(
«me
,"double")) {

627 
	`addRïlyDoubÀ
(
c
,3.14159265359);

628 } i‡(!
	`°rˇ£cmp
(
«me
,"bignum")) {

629 
	`addRïlyPrŸo
(
c
,"(1234567999999999999999999999999999999\r\n",40);

630 } i‡(!
	`°rˇ£cmp
(
«me
,"null")) {

631 
	`addRïlyNuŒ
(
c
);

632 } i‡(!
	`°rˇ£cmp
(
«me
,"array")) {

633 
	`addRïlyAºayLí
(
c
,3);

634 
j
 = 0; j < 3; j++Ë
	`addRïlyL⁄gL⁄g
(
c
,j);

635 } i‡(!
	`°rˇ£cmp
(
«me
,"set")) {

636 
	`addRïlySëLí
(
c
,3);

637 
j
 = 0; j < 3; j++Ë
	`addRïlyL⁄gL⁄g
(
c
,j);

638 } i‡(!
	`°rˇ£cmp
(
«me
,"map")) {

639 
	`addRïlyM≠Lí
(
c
,3);

640 
j
 = 0; j < 3; j++) {

641 
	`addRïlyL⁄gL⁄g
(
c
,
j
);

642 
	`addRïlyBoﬁ
(
c
, 
j
 == 1);

644 } i‡(!
	`°rˇ£cmp
(
«me
,"attrib")) {

645 
	`addRïlyAâribuãLí
(
c
,1);

646 
	`addRïlyBulkCSåög
(
c
,"key-popularity");

647 
	`addRïlyAºayLí
(
c
,2);

648 
	`addRïlyBulkCSåög
(
c
,"key:123");

649 
	`addRïlyL⁄gL⁄g
(
c
,90);

652 
	`addRïlyBulkCSåög
(
c
,"SomeÑealÑeply followingÅheáttribute");

653 } i‡(!
	`°rˇ£cmp
(
«me
,"push")) {

654 
	`addRïlyPushLí
(
c
,2);

655 
	`addRïlyBulkCSåög
(
c
,"server-cpu-usage");

656 
	`addRïlyL⁄gL⁄g
(
c
,42);

660 
	`addRïlyBulkCSåög
(
c
,"SomeÑealÑeply followingÅheÖushÑeply");

661 } i‡(!
	`°rˇ£cmp
(
«me
,"true")) {

662 
	`addRïlyBoﬁ
(
c
,1);

663 } i‡(!
	`°rˇ£cmp
(
«me
,"false")) {

664 
	`addRïlyBoﬁ
(
c
,0);

665 } i‡(!
	`°rˇ£cmp
(
«me
,"verbatim")) {

666 
	`addRïlyVîb©im
(
c
,"This isá verbatim\nstring",25,"txt");

668 
	`addRïlyEº‹
(
c
,"WrongÖrotocolÅypeÇame. Please use one ofÅhe following: string|integer|double|bignum|null|array|set|map|attrib|push|verbatim|true|false");

670 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"¶ìp"Ë&& c->
¨gc
 == 3) {

671 
dtime
 = 
	`°πod
(
c
->
¨gv
[2]->
±r
,
NULL
);

672 
utime
 = 
dtime
*1000000;

673 
time•ec
 
tv
;

675 
tv
.
tv_£c
 = 
utime
 / 1000000;

676 
tv
.
tv_n£c
 = (
utime
 % 1000000) * 1000;

677 
	`«no¶ìp
(&
tv
, 
NULL
);

678 
	`addRïly
(
c
,
sh¨ed
.
ok
);

679 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"set-active-expire") &&

680 
c
->
¨gc
 == 3)

682 
£rvî
.
a˘ive_expúe_íabÀd
 = 
	`©oi
(
c
->
¨gv
[2]->
±r
);

683 
	`addRïly
(
c
,
sh¨ed
.
ok
);

684 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"aof-flush-sleep") &&

685 
c
->
¨gc
 == 3)

687 
£rvî
.
aof_Êush_¶ìp
 = 
	`©oi
(
c
->
¨gv
[2]->
±r
);

688 
	`addRïly
(
c
,
sh¨ed
.
ok
);

689 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"lua-always-replicate-commands") &&

690 
c
->
¨gc
 == 3)

692 
£rvî
.
lua_Æways_ª∂iˇã_comm™ds
 = 
	`©oi
(
c
->
¨gv
[2]->
±r
);

693 
	`addRïly
(
c
,
sh¨ed
.
ok
);

694 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"îr‹"Ë&& c->
¨gc
 == 3) {

695 
sds
 
îr°r
 = 
	`sd¢ewÀn
("-",1);

697 
îr°r
 = 
	`sdsˇtsds
”º°r,
c
->
¨gv
[2]->
±r
);

698 
îr°r
 = 
	`sdsm≠ch¨s
(errstr,"\n\r"," ",2);

699 
îr°r
 = 
	`sdsˇéí
(errstr,"\r\n",2);

700 
	`addRïlySds
(
c
,
îr°r
);

701 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"°ru˘size"Ë&& c->
¨gc
 == 2) {

702 
sds
 
sizes
 = 
	`sd£m±y
();

703 
sizes
 = 
	`sdsˇçrötf
(sizes,"bits:%d ",((*) == 8)?64:32);

704 
sizes
 = 
	`sdsˇçrötf
(sizes,"robj:%d ",()(
robj
));

705 
sizes
 = 
	`sdsˇçrötf
(sizes,"di˘íåy:%d ",()(
di˘E¡ry
));

706 
sizes
 = 
	`sdsˇçrötf
(sizes,"sdshdr5:%d ",()(
sdshdr5
));

707 
sizes
 = 
	`sdsˇçrötf
(sizes,"sdshdr8:%d ",()(
sdshdr8
));

708 
sizes
 = 
	`sdsˇçrötf
(sizes,"sdshdr16:%d ",()(
sdshdr16
));

709 
sizes
 = 
	`sdsˇçrötf
(sizes,"sdshdr32:%d ",()(
sdshdr32
));

710 
sizes
 = 
	`sdsˇçrötf
(sizes,"sdshdr64:%d ",()(
sdshdr64
));

711 
	`addRïlyBulkSds
(
c
,
sizes
);

712 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ht°©s"Ë&& c->
¨gc
 == 3) {

713 
dbid
;

714 
sds
 
°©s
 = 
	`sd£m±y
();

715 
buf
[4096];

717 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
dbid
, 
NULL
Ë!
C_OK
) {

718 
	`sds‰ì
(
°©s
);

721 i‡(
dbid
 < 0 || dbid >
£rvî
.
dbnum
) {

722 
	`sds‰ì
(
°©s
);

723 
	`addRïlyEº‹
(
c
,"Out ofÑange database");

727 
°©s
 = 
	`sdsˇçrötf
(stats,"[Dictionary HT]\n");

728 
	`di˘GëSèts
(
buf
,(buf),
£rvî
.
db
[
dbid
].
di˘
);

729 
°©s
 = 
	`sdsˇt
(°©s,
buf
);

731 
°©s
 = 
	`sdsˇçrötf
(stats,"[Expires HT]\n");

732 
	`di˘GëSèts
(
buf
,(buf),
£rvî
.
db
[
dbid
].
expúes
);

733 
°©s
 = 
	`sdsˇt
(°©s,
buf
);

735 
	`addRïlyVîb©im
(
c
,
°©s
,
	`sd¶í
(stats),"txt");

736 
	`sds‰ì
(
°©s
);

737 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ht°©s-key"Ë&& c->
¨gc
 == 3) {

738 
robj
 *
o
;

739 
di˘
 *
ht
 = 
NULL
;

741 i‡((
o
 = 
	`obje˘Comm™dLookupOrRïly
(
c
,c->
¨gv
[2],
sh¨ed
.
nokeyîr
))

742 =
NULL
) ;

745 
o
->
ícodög
) {

746 
OBJ_ENCODING_SKIPLIST
:

748 
z£t
 *
zs
 = 
o
->
±r
;

749 
ht
 = 
zs
->
di˘
;

752 
OBJ_ENCODING_HT
:

753 
ht
 = 
o
->
±r
;

757 i‡(
ht
 =
NULL
) {

758 
	`addRïlyEº‹
(
c
,"The value storedátÅhe specified key isÇot "

761 
buf
[4096];

762 
	`di˘GëSèts
(
buf
,(buf),
ht
);

763 
	`addRïlyVîb©im
(
c
,
buf
,
	`°æí
(buf),"txt");

765 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ch™ge-ª∂-id"Ë&& c->
¨gc
 == 2) {

766 
	`£rvîLog
(
LL_WARNING
,"ChangingÑeplication IDsáfterÑeceiving DEBUG change-repl-id");

767 
	`ch™geRïliˇti⁄Id
();

768 
	`˛órRïliˇti⁄Id2
();

769 
	`addRïly
(
c
,
sh¨ed
.
ok
);

770 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"°rögm©ch-ã°"Ë&& c->
¨gc
 == 2)

772 
	`°rögm©chÀn_fuzz_ã°
();

773 
	`addRïlySètus
(
c
,"Apparently Redis didÇot crash:ÅestÖassed");

774 #ifde‡
USE_JEMALLOC


775 } if(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"mÆl˘l"Ë&& c->
¨gc
 >= 3) {

776 
	`mÆl˘l_öt
(
c
, c->
¨gv
+2, c->
¨gc
-2);

778 } if(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"mÆl˘l-°r"Ë&& c->
¨gc
 >= 3) {

779 
	`mÆl˘l_°rög
(
c
, c->
¨gv
+2, c->
¨gc
-2);

783 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

786 
	}
}

790 
	$_£rvîAs£π
(c⁄° *
e°r
, c⁄° *
fûe
, 
löe
) {

791 
	`bugRï‹tSèπ
();

792 
	`£rvîLog
(
LL_WARNING
,"=== ASSERTION FAILED ===");

793 
	`£rvîLog
(
LL_WARNING
,"==> %s:%d '%s' i†nŸÅrue",
fûe
,
löe
,
e°r
);

794 #ifde‡
HAVE_BACKTRACE


795 
£rvî
.
as£π_Áûed
 = 
e°r
;

796 
£rvî
.
as£π_fûe
 = 
fûe
;

797 
£rvî
.
as£π_löe
 = 
löe
;

798 
	`£rvîLog
(
LL_WARNING
,"(forcing SIGSEGVÅoÖrintÅhe bugÑeport.)");

801 
	}
}

803 
	$_£rvîAs£πPrötClõ¡Info
(c⁄° 
˛õ¡
 *
c
) {

804 
j
;

805 
c⁄nöfo
[
CONN_INFO_LEN
];

807 
	`bugRï‹tSèπ
();

808 
	`£rvîLog
(
LL_WARNING
,"=== ASSERTION FAILED CLIENT CONTEXT ===");

809 
	`£rvîLog
(
LL_WARNING
,"˛õ¡->Êag†%Œu", (Ë
c
->
Êags
);

810 
	`£rvîLog
(
LL_WARNING
,"˛õ¡->c⁄¿%s", 
	`c⁄nGëInfo
(
c
->
c⁄n
, 
c⁄nöfo
, (conninfo)));

811 
	`£rvîLog
(
LL_WARNING
,"˛õ¡->¨g¯%d", 
c
->
¨gc
);

812 
j
=0; j < 
c
->
¨gc
; j++) {

813 
buf
[128];

814 *
¨g
;

816 i‡(
c
->
¨gv
[
j
]->
ty≥
 =
OBJ_STRING
 && 
	`sdsEncodedObje˘
(c->argv[j])) {

817 
¨g
 = (*Ë
c
->
¨gv
[
j
]->
±r
;

819 
	`¢¥ötf
(
buf
,(buf),"ObjectÅype: %u,Éncoding: %u",

820 
c
->
¨gv
[
j
]->
ty≥
, c->¨gv[j]->
ícodög
);

821 
¨g
 = 
buf
;

823 
	`£rvîLog
(
LL_WARNING
,"client->argv[%d] = \"%s\" (refcount: %d)",

824 
j
, 
¨g
, 
c
->
¨gv
[j]->
ªfcou¡
);

826 
	}
}

828 
	$£rvîLogObje˘DebugInfo
(c⁄° 
robj
 *
o
) {

829 
	`£rvîLog
(
LL_WARNING
,"Obje˘Åy≥: %d", 
o
->
ty≥
);

830 
	`£rvîLog
(
LL_WARNING
,"Obje˘Éncodög: %d", 
o
->
ícodög
);

831 
	`£rvîLog
(
LL_WARNING
,"Obje˘Ñefcou¡: %d", 
o
->
ªfcou¡
);

832 i‡(
o
->
ty≥
 =
OBJ_STRING
 && 
	`sdsEncodedObje˘
(o)) {

833 
	`£rvîLog
(
LL_WARNING
,"Obje˘Ñaw såögÜí: %zu", 
	`sd¶í
(
o
->
±r
));

834 i‡(
	`sd¶í
(
o
->
±r
) < 4096) {

835 
sds
 
ª¥
 = 
	`sdsˇåïr
(
	`sd£m±y
(),
o
->
±r
,
	`sd¶í
(o->ptr));

836 
	`£rvîLog
(
LL_WARNING
,"Obje˘Ñaw såög c⁄ã¡: %s", 
ª¥
);

837 
	`sds‰ì
(
ª¥
);

839 } i‡(
o
->
ty≥
 =
OBJ_LIST
) {

840 
	`£rvîLog
(
LL_WARNING
,"Li°Üígth: %d", (Ë
	`li°Ty≥Lígth
(
o
));

841 } i‡(
o
->
ty≥
 =
OBJ_SET
) {

842 
	`£rvîLog
(
LL_WARNING
,"Së size: %d", (Ë
	`£tTy≥Size
(
o
));

843 } i‡(
o
->
ty≥
 =
OBJ_HASH
) {

844 
	`£rvîLog
(
LL_WARNING
,"Hash size: %d", (Ë
	`hashTy≥Lígth
(
o
));

845 } i‡(
o
->
ty≥
 =
OBJ_ZSET
) {

846 
	`£rvîLog
(
LL_WARNING
,"S‹ãd së size: %d", (Ë
	`z£tLígth
(
o
));

847 i‡(
o
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
)

848 
	`£rvîLog
(
LL_WARNING
,"Skùli°Üevñ: %d", (Ë((c⁄° 
z£t
*)
o
->
±r
)->
z¶
->
Àvñ
);

849 } i‡(
o
->
ty≥
 =
OBJ_STREAM
) {

850 
	`£rvîLog
(
LL_WARNING
,"Såóm size: %d", (Ë
	`°ªamLígth
(
o
));

852 
	}
}

854 
	$_£rvîAs£πPrötObje˘
(c⁄° 
robj
 *
o
) {

855 
	`bugRï‹tSèπ
();

856 
	`£rvîLog
(
LL_WARNING
,"=== ASSERTION FAILED OBJECT CONTEXT ===");

857 
	`£rvîLogObje˘DebugInfo
(
o
);

858 
	}
}

860 
	$_£rvîAs£πWôhInfo
(c⁄° 
˛õ¡
 *
c
, c⁄° 
robj
 *
o
, c⁄° *
e°r
, c⁄° *
fûe
, 
löe
) {

861 i‡(
c
Ë
	`_£rvîAs£πPrötClõ¡Info
(c);

862 i‡(
o
Ë
	`_£rvîAs£πPrötObje˘
(o);

863 
	`_£rvîAs£π
(
e°r
,
fûe
,
löe
);

864 
	}
}

866 
	$_£rvîP™ic
(c⁄° *
fûe
, 
löe
, c⁄° *
msg
, ...) {

867 
va_li°
 
≠
;

868 
	`va_°¨t
(
≠
,
msg
);

869 
fmtmsg
[256];

870 
	`v¢¥ötf
(
fmtmsg
,(fmtmsg),
msg
,
≠
);

871 
	`va_íd
(
≠
);

873 
	`bugRï‹tSèπ
();

874 
	`£rvîLog
(
LL_WARNING
,"------------------------------------------------");

875 
	`£rvîLog
(
LL_WARNING
,"!!! Software Failure. PressÜeft mouse buttonÅo continue");

876 
	`£rvîLog
(
LL_WARNING
,"Guru Medô©i⁄: %†#%s:%d",
fmtmsg
,
fûe
,
löe
);

877 #ifde‡
HAVE_BACKTRACE


878 
	`£rvîLog
(
LL_WARNING
,"(forcing SIGSEGV in orderÅoÖrintÅhe stackÅrace)");

880 
	`£rvîLog
(
LL_WARNING
,"------------------------------------------------");

882 
	}
}

884 
	$bugRï‹tSèπ
() {

885 i‡(
£rvî
.
bug_ªp‹t_°¨t
 == 0) {

886 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
,

888 
£rvî
.
bug_ªp‹t_°¨t
 = 1;

890 
	}
}

892 #ifde‡
HAVE_BACKTRACE


893 *
	$gëMc⁄ãxtEù
(
uc⁄ãxt_t
 *
uc
) {

894 #i‡
	`deföed
(
__APPLE__
Ë&& !deföed(
MAC_OS_X_VERSION_10_6
)

896 #i‡
	`deföed
(
__x86_64__
)

897  (*Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rù
;

898 #ñi‡
	`deföed
(
__i386__
)

899  (*Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__eù
;

901  (*Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__§r0
;

903 #ñi‡
	`deföed
(
__APPLE__
Ë&& deföed(
MAC_OS_X_VERSION_10_6
)

905 #i‡
	`deföed
(
_STRUCT_X86_THREAD_STATE64
Ë&& !deföed(
__i386__
)

906  (*Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rù
;

908  (*Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__eù
;

910 #ñi‡
	`deföed
(
__löux__
)

912 #i‡
	`deföed
(
__i386__
Ë|| deföed(
__ILP32__
)

913  (*Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[14];

914 #ñi‡
	`deföed
(
__X86_64__
Ë|| deföed(
__x86_64__
)

915  (*Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[16];

916 #ñi‡
	`deföed
(
__ü64__
)

917  (*Ë
uc
->
uc_mc⁄ãxt
.
sc_ù
;

918 #ñi‡
	`deföed
(
__¨m__
)

919  (*Ë
uc
->
uc_mc⁄ãxt
.
¨m_pc
;

920 #ñi‡
	`deföed
(
__Ørch64__
)

921  (*Ë
uc
->
uc_mc⁄ãxt
.
pc
;

923 #ñi‡
	`deföed
(
__FªeBSD__
)

925 #i‡
	`deföed
(
__i386__
)

926  (*Ë
uc
->
uc_mc⁄ãxt
.
mc_eù
;

927 #ñi‡
	`deföed
(
__x86_64__
)

928  (*Ë
uc
->
uc_mc⁄ãxt
.
mc_rù
;

930 #ñi‡
	`deföed
(
__O≥nBSD__
)

932 #i‡
	`deföed
(
__i386__
)

933  (*Ë
uc
->
sc_eù
;

934 #ñi‡
	`deföed
(
__x86_64__
)

935  (*Ë
uc
->
sc_rù
;

937 #ñi‡
	`deföed
(
__Døg⁄Fly__
)

938  (*Ë
uc
->
uc_mc⁄ãxt
.
mc_rù
;

940  
NULL
;

942 
	}
}

944 
	$logSèckC⁄ã¡
(**
•
) {

945 
i
;

946 
i
 = 15; i >= 0; i--) {

947 
addr
 = (Ë
•
+
i
;

948 
vÆ
 = (Ë
•
[
i
];

951 
	`£rvîLog
(
LL_WARNING
, "(%08lxË-> %08lx", 
addr
, 
vÆ
);

953 
	`£rvîLog
(
LL_WARNING
, "(%016lxË-> %016lx", 
addr
, 
vÆ
);

955 
	}
}

957 
	$logRegi°îs
(
uc⁄ãxt_t
 *
uc
) {

958 
	`£rvîLog
(
LL_WARNING
|
LL_RAW
, "\n------ REGISTERS ------\n");

961 #i‡
	`deföed
(
__APPLE__
Ë&& deföed(
MAC_OS_X_VERSION_10_6
)

963 #i‡
	`deföed
(
_STRUCT_X86_THREAD_STATE64
Ë&& !deföed(
__i386__
)

964 
	`£rvîLog
(
LL_WARNING
,

971 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__øx
,

972 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rbx
,

973 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rcx
,

974 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rdx
,

975 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rdi
,

976 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rsi
,

977 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rbp
,

978 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__r•
,

979 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__r8
,

980 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__r9
,

981 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__r10
,

982 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__r11
,

983 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__r12
,

984 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__r13
,

985 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__r14
,

986 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__r15
,

987 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rù
,

988 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__rÊags
,

989 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__cs
,

990 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__fs
,

991 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__gs


993 
	`logSèckC⁄ã¡
((**)
uc
->
uc_mc⁄ãxt
->
__ss
.
__r•
);

996 
	`£rvîLog
(
LL_WARNING
,

1002 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__óx
,

1003 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__ebx
,

1004 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__ecx
,

1005 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__edx
,

1006 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__edi
,

1007 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__esi
,

1008 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__ebp
,

1009 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__e•
,

1010 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.__ss,

1011 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__eÊags
,

1012 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__eù
,

1013 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__cs
,

1014 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__ds
,

1015 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__es
,

1016 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__fs
,

1017 (Ë
uc
->
uc_mc⁄ãxt
->
__ss
.
__gs


1019 
	`logSèckC⁄ã¡
((**)
uc
->
uc_mc⁄ãxt
->
__ss
.
__e•
);

1022 #ñi‡
	`deföed
(
__löux__
)

1024 #i‡
	`deföed
(
__i386__
Ë|| deföed(
__ILP32__
)

1025 
	`£rvîLog
(
LL_WARNING
,

1031 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[11],

1032 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[8],

1033 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[10],

1034 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[9],

1035 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[4],

1036 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[5],

1037 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[6],

1038 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[7],

1039 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[18],

1040 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[17],

1041 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[14],

1042 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[15],

1043 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[3],

1044 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[2],

1045 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[1],

1046 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[0]

1048 
	`logSèckC⁄ã¡
((**)
uc
->
uc_mc⁄ãxt
.
gªgs
[7]);

1049 #ñi‡
	`deföed
(
__X86_64__
Ë|| deföed(
__x86_64__
)

1051 
	`£rvîLog
(
LL_WARNING
,

1058 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[13],

1059 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[11],

1060 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[14],

1061 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[12],

1062 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[8],

1063 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[9],

1064 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[10],

1065 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[15],

1066 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[0],

1067 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[1],

1068 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[2],

1069 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[3],

1070 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[4],

1071 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[5],

1072 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[6],

1073 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[7],

1074 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[16],

1075 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[17],

1076 (Ë
uc
->
uc_mc⁄ãxt
.
gªgs
[18]

1078 
	`logSèckC⁄ã¡
((**)
uc
->
uc_mc⁄ãxt
.
gªgs
[15]);

1079 #ñi‡
	`deföed
(
__Ørch64__
)

1080 
	`£rvîLog
(
LL_WARNING
,

1087 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[18],

1088 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[19],

1089 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[20],

1090 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[21],

1091 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[22],

1092 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[23],

1093 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[24],

1094 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[25],

1095 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[26],

1096 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[27],

1097 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[28],

1098 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[29],

1099 (Ë
uc
->
uc_mc⁄ãxt
.
ªgs
[30],

1100 (Ë
uc
->
uc_mc⁄ãxt
.
pc
,

1101 (Ë
uc
->
uc_mc⁄ãxt
.
•
,

1102 (Ë
uc
->
uc_mc⁄ãxt
.
p°©e
,

1103 (Ë
uc
->
uc_mc⁄ãxt
.
Áu…_addªss


1105 
	`logSèckC⁄ã¡
((**)
uc
->
uc_mc⁄ãxt
.
•
);

1106 #ñi‡
	`deföed
(
__¨m__
)

1107 
	`£rvîLog
(
LL_WARNING
,

1114 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r10
,

1115 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r9
,

1116 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r8
,

1117 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r7
,

1118 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r6
,

1119 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r5
,

1120 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r4
,

1121 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r3
,

1122 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r2
,

1123 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r1
,

1124 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_r0
,

1125 (Ë
uc
->
uc_mc⁄ãxt
.
îr‹_code
,

1126 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_Â
,

1127 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_ù
,

1128 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_pc
,

1129 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_•
,

1130 (Ë
uc
->
uc_mc⁄ãxt
.
¨m_˝§
,

1131 (Ë
uc
->
uc_mc⁄ãxt
.
Áu…_addªss


1133 
	`logSèckC⁄ã¡
((**)
uc
->
uc_mc⁄ãxt
.
¨m_•
);

1135 #ñi‡
	`deföed
(
__FªeBSD__
)

1136 #i‡
	`deföed
(
__x86_64__
)

1137 
	`£rvîLog
(
LL_WARNING
,

1144 (Ë
uc
->
uc_mc⁄ãxt
.
mc_øx
,

1145 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rbx
,

1146 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rcx
,

1147 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rdx
,

1148 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rdi
,

1149 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rsi
,

1150 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rbp
,

1151 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r•
,

1152 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r8
,

1153 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r9
,

1154 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r10
,

1155 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r11
,

1156 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r12
,

1157 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r13
,

1158 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r14
,

1159 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r15
,

1160 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rù
,

1161 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rÊags
,

1162 (Ë
uc
->
uc_mc⁄ãxt
.
mc_cs


1164 
	`logSèckC⁄ã¡
((**)
uc
->
uc_mc⁄ãxt
.
mc_r•
);

1165 #ñi‡
	`deföed
(
__i386__
)

1166 
	`£rvîLog
(
LL_WARNING
,

1172 (Ë
uc
->
uc_mc⁄ãxt
.
mc_óx
,

1173 (Ë
uc
->
uc_mc⁄ãxt
.
mc_ebx
,

1174 (Ë
uc
->
uc_mc⁄ãxt
.
mc_ebx
,

1175 (Ë
uc
->
uc_mc⁄ãxt
.
mc_edx
,

1176 (Ë
uc
->
uc_mc⁄ãxt
.
mc_edi
,

1177 (Ë
uc
->
uc_mc⁄ãxt
.
mc_esi
,

1178 (Ë
uc
->
uc_mc⁄ãxt
.
mc_ebp
,

1179 (Ë
uc
->
uc_mc⁄ãxt
.
mc_e•
,

1180 (Ë
uc
->
uc_mc⁄ãxt
.
mc_ss
,

1181 (Ë
uc
->
uc_mc⁄ãxt
.
mc_eÊags
,

1182 (Ë
uc
->
uc_mc⁄ãxt
.
mc_eù
,

1183 (Ë
uc
->
uc_mc⁄ãxt
.
mc_cs
,

1184 (Ë
uc
->
uc_mc⁄ãxt
.
mc_es
,

1185 (Ë
uc
->
uc_mc⁄ãxt
.
mc_fs
,

1186 (Ë
uc
->
uc_mc⁄ãxt
.
mc_gs


1188 
	`logSèckC⁄ã¡
((**)
uc
->
uc_mc⁄ãxt
.
mc_e•
);

1190 #ñi‡
	`deföed
(
__O≥nBSD__
)

1191 #i‡
	`deföed
(
__x86_64__
)

1192 
	`£rvîLog
(
LL_WARNING
,

1199 (Ë
uc
->
sc_øx
,

1200 (Ë
uc
->
sc_rbx
,

1201 (Ë
uc
->
sc_rcx
,

1202 (Ë
uc
->
sc_rdx
,

1203 (Ë
uc
->
sc_rdi
,

1204 (Ë
uc
->
sc_rsi
,

1205 (Ë
uc
->
sc_rbp
,

1206 (Ë
uc
->
sc_r•
,

1207 (Ë
uc
->
sc_r8
,

1208 (Ë
uc
->
sc_r9
,

1209 (Ë
uc
->
sc_r10
,

1210 (Ë
uc
->
sc_r11
,

1211 (Ë
uc
->
sc_r12
,

1212 (Ë
uc
->
sc_r13
,

1213 (Ë
uc
->
sc_r14
,

1214 (Ë
uc
->
sc_r15
,

1215 (Ë
uc
->
sc_rù
,

1216 (Ë
uc
->
sc_rÊags
,

1217 (Ë
uc
->
sc_cs


1219 
	`logSèckC⁄ã¡
((**)
uc
->
sc_r•
);

1220 #ñi‡
	`deföed
(
__i386__
)

1221 
	`£rvîLog
(
LL_WARNING
,

1227 (Ë
uc
->
sc_óx
,

1228 (Ë
uc
->
sc_ebx
,

1229 (Ë
uc
->
sc_ebx
,

1230 (Ë
uc
->
sc_edx
,

1231 (Ë
uc
->
sc_edi
,

1232 (Ë
uc
->
sc_esi
,

1233 (Ë
uc
->
sc_ebp
,

1234 (Ë
uc
->
sc_e•
,

1235 (Ë
uc
->
sc_ss
,

1236 (Ë
uc
->
sc_eÊags
,

1237 (Ë
uc
->
sc_eù
,

1238 (Ë
uc
->
sc_cs
,

1239 (Ë
uc
->
sc_es
,

1240 (Ë
uc
->
sc_fs
,

1241 (Ë
uc
->
sc_gs


1243 
	`logSèckC⁄ã¡
((**)
uc
->
sc_e•
);

1245 #ñi‡
	`deföed
(
__Døg⁄Fly__
)

1246 
	`£rvîLog
(
LL_WARNING
,

1253 (Ë
uc
->
uc_mc⁄ãxt
.
mc_øx
,

1254 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rbx
,

1255 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rcx
,

1256 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rdx
,

1257 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rdi
,

1258 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rsi
,

1259 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rbp
,

1260 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r•
,

1261 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r8
,

1262 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r9
,

1263 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r10
,

1264 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r11
,

1265 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r12
,

1266 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r13
,

1267 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r14
,

1268 (Ë
uc
->
uc_mc⁄ãxt
.
mc_r15
,

1269 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rù
,

1270 (Ë
uc
->
uc_mc⁄ãxt
.
mc_rÊags
,

1271 (Ë
uc
->
uc_mc⁄ãxt
.
mc_cs


1273 
	`logSèckC⁄ã¡
((**)
uc
->
uc_mc⁄ãxt
.
mc_r•
);

1275 
	`£rvîLog
(
LL_WARNING
,

1278 
	}
}

1286 
	$›íDúe˘LogFûedes
() {

1287 
log_to_°dout
 = 
£rvî
.
logfûe
[0] == '\0';

1288 
fd
 = 
log_to_°dout
 ?

1289 
STDOUT_FILENO
 :

1290 
	`›í
(
£rvî
.
logfûe
, 
O_APPEND
|
O_CREAT
|
O_WRONLY
, 0644);

1291  
fd
;

1292 
	}
}

1295 
	$˛o£Dúe˘LogFûedes
(
fd
) {

1296 
log_to_°dout
 = 
£rvî
.
logfûe
[0] == '\0';

1297 i‡(!
log_to_°dout
Ë
	`˛o£
(
fd
);

1298 
	}
}

1302 
	$logSèckTø˚
(
uc⁄ãxt_t
 *
uc
) {

1303 *
åa˚
[101];

1304 
åa˚_size
 = 0, 
fd
 = 
	`›íDúe˘LogFûedes
();

1306 i‡(
fd
 == -1) ;

1309 
åa˚_size
 = 
	`backåa˚
(
åa˚
+1, 100);

1311 i‡(
	`gëMc⁄ãxtEù
(
uc
Ë!
NULL
) {

1312 *
msg1
 = "EIP:\n";

1313 *
msg2
 = "\nBacktrace:\n";

1314 i‡(
	`wrôe
(
fd
,
msg1
,
	`°æí
(msg1)) == -1) { };

1315 
åa˚
[0] = 
	`gëMc⁄ãxtEù
(
uc
);

1316 
	`backåa˚_symbﬁs_fd
(
åa˚
, 1, 
fd
);

1317 i‡(
	`wrôe
(
fd
,
msg2
,
	`°æí
(msg2)) == -1) { };

1321 
	`backåa˚_symbﬁs_fd
(
åa˚
+1, 
åa˚_size
, 
fd
);

1324 
	`˛o£Dúe˘LogFûedes
(
fd
);

1325 
	}
}

1330 
	$logCuºítClõ¡
() {

1331 i‡(
£rvî
.
cuºít_˛õ¡
 =
NULL
) ;

1333 
˛õ¡
 *
cc
 = 
£rvî
.
cuºít_˛õ¡
;

1334 
sds
 
˛õ¡
;

1335 
j
;

1337 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ CURRENT CLIENT INFO ------\n");

1338 
˛õ¡
 = 
	`ˇtClõ¡InfoSåög
(
	`sd£m±y
(),
cc
);

1339 
	`£rvîLog
(
LL_WARNING
|
LL_RAW
,"%s\n", 
˛õ¡
);

1340 
	`sds‰ì
(
˛õ¡
);

1341 
j
 = 0; j < 
cc
->
¨gc
; j++) {

1342 
robj
 *
decoded
;

1344 
decoded
 = 
	`gëDecodedObje˘
(
cc
->
¨gv
[
j
]);

1345 
	`£rvîLog
(
LL_WARNING
|
LL_RAW
,"¨gv[%d]: '%s'\n", 
j
,

1346 (*)
decoded
->
±r
);

1347 
	`de¸RefCou¡
(
decoded
);

1351 i‡(
cc
->
¨gc
 >= 1) {

1352 
robj
 *
vÆ
, *
key
;

1353 
di˘E¡ry
 *
de
;

1355 
key
 = 
	`gëDecodedObje˘
(
cc
->
¨gv
[1]);

1356 
de
 = 
	`di˘Föd
(
cc
->
db
->
di˘
, 
key
->
±r
);

1357 i‡(
de
) {

1358 
vÆ
 = 
	`di˘GëVÆ
(
de
);

1359 
	`£rvîLog
(
LL_WARNING
,"key '%s' found i¿DB c⁄èöögÅhêfﬁlowög obje˘:", (*)
key
->
±r
);

1360 
	`£rvîLogObje˘DebugInfo
(
vÆ
);

1362 
	`de¸RefCou¡
(
key
);

1364 
	}
}

1366 #i‡
deföed
(
HAVE_PROC_MAPS
)

1368 
	#MEMTEST_MAX_REGIONS
 128

	)

1371 
	$memã°_ã°_löux_™⁄ymous_m≠s
() {

1372 
FILE
 *
Â
;

1373 
löe
[1024];

1374 
logbuf
[1024];

1375 
size_t
 
°¨t_addr
, 
íd_addr
, 
size
;

1376 
size_t
 
°¨t_ve˘
[
MEMTEST_MAX_REGIONS
];

1377 
size_t
 
size_ve˘
[
MEMTEST_MAX_REGIONS
];

1378 
ªgi⁄s
 = 0, 
j
;

1380 
fd
 = 
	`›íDúe˘LogFûedes
();

1381 i‡(!
fd
)  0;

1383 
Â
 = 
	`f›í
("/proc/self/maps","r");

1384 i‡(!
Â
)  0;

1385 
	`fgës
(
löe
,÷öe),
Â
Ë!
NULL
) {

1386 *
°¨t
, *
íd
, *
p
 = 
löe
;

1388 
°¨t
 = 
p
;

1389 
p
 = 
	`°rchr
(p,'-');

1390 i‡(!
p
) ;

1391 *
p
++ = '\0';

1392 
íd
 = 
p
;

1393 
p
 = 
	`°rchr
(p,' ');

1394 i‡(!
p
) ;

1395 *
p
++ = '\0';

1396 i‡(
	`°r°r
(
p
,"stack") ||

1397 
	`°r°r
(
p
,"vdso") ||

1398 
	`°r°r
(
p
,"vsyscall")) ;

1399 i‡(!
	`°r°r
(
p
,"00:00")) ;

1400 i‡(!
	`°r°r
(
p
,"rw")) ;

1402 
°¨t_addr
 = 
	`°πoul
(
°¨t
,
NULL
,16);

1403 
íd_addr
 = 
	`°πoul
(
íd
,
NULL
,16);

1404 
size
 = 
íd_addr
-
°¨t_addr
;

1406 
°¨t_ve˘
[
ªgi⁄s
] = 
°¨t_addr
;

1407 
size_ve˘
[
ªgi⁄s
] = 
size
;

1408 
	`¢¥ötf
(
logbuf
,(logbuf),

1410 (Ë
°¨t_ve˘
[
ªgi⁄s
],

1411 (Ë
size_ve˘
[
ªgi⁄s
]);

1412 i‡(
	`wrôe
(
fd
,
logbuf
,
	`°æí
(logbuf)) == -1) { }

1413 
ªgi⁄s
++;

1416 
îr‹s
 = 0;

1417 
j
 = 0; j < 
ªgi⁄s
; j++) {

1418 i‡(
	`wrôe
(
fd
,".",1) == -1) { }

1419 
îr‹s
 +
	`memã°_¥e£rvög_ã°
((*)
°¨t_ve˘
[
j
],
size_ve˘
[j],1);

1420 i‡(
	`wrôe
(
fd
, 
îr‹s
 ? "E" : "O",1) == -1) { }

1422 i‡(
	`wrôe
(
fd
,"\n",1) == -1) { }

1427 
	`f˛o£
(
Â
);

1428 
	`˛o£Dúe˘LogFûedes
(
fd
);

1429  
îr‹s
;

1430 
	}
}

1436 
	$dumpX86CÆls
(*
addr
, 
size_t
 
Àn
) {

1437 
size_t
 
j
;

1438 *
p
 = 
addr
;

1439 
Dl_öfo
 
öfo
;

1442 
ht
[256] = {0};

1444 i‡(
Àn
 < 5) ;

1445 
j
 = 0; j < 
Àn
-4; j++) {

1446 i‡(
p
[
j
] != 0xE8) ;

1447 
èrgë
 = ()
addr
+
j
+5;

1448 
èrgë
 +*((
öt32_t
*)(
p
+
j
+1));

1449 i‡(
	`dœddr
((*)
èrgë
, &
öfo
Ë!0 && info.
dli_¢ame
 !
NULL
) {

1450 i‡(
ht
[
èrgë
&0xff] !=Åarget) {

1451 
	`¥ötf
("Fun˘i⁄áà0x%lx i†%s\n",
èrgë
,
öfo
.
dli_¢ame
);

1452 
ht
[
èrgë
&0xff] =Åarget;

1454 
j
 += 4;

1457 
	}
}

1459 
	$sig£gvH™dÀr
(
sig
, 
sigöfo_t
 *
öfo
, *
£¸ë
) {

1460 
uc⁄ãxt_t
 *
uc
 = (uc⁄ãxt_t*Ë
£¸ë
;

1461 *
eù
 = 
	`gëMc⁄ãxtEù
(
uc
);

1462 
sds
 
öfo°rög
, 
˛õ¡s
;

1463 
siga˘i⁄
 
a˘
;

1464 
	`UNUSED
(
öfo
);

1466 
	`bugRï‹tSèπ
();

1467 
	`£rvîLog
(
LL_WARNING
,

1468 "Redi†%†¸ashed by sig«l: %d", 
REDIS_VERSION
, 
sig
);

1469 i‡(
eù
 !
NULL
) {

1470 
	`£rvîLog
(
LL_WARNING
,

1471 "CøshedÑu¬ögÅhêö°ru˘i⁄át: %p", 
eù
);

1473 i‡(
sig
 =
SIGSEGV
 || sig =
SIGBUS
) {

1474 
	`£rvîLog
(
LL_WARNING
,

1475 "Ac˚ssögáddªss: %p", (*)
öfo
->
si_addr
);

1477 
	`£rvîLog
(
LL_WARNING
,

1478 "Faûedás£πi⁄: %†(%s:%d)", 
£rvî
.
as£π_Áûed
,

1479 
£rvî
.
as£π_fûe
, sîvî.
as£π_löe
);

1482 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ STACK TRACE ------\n");

1483 
	`logSèckTø˚
(
uc
);

1486 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ INFO OUTPUT ------\n");

1487 
öfo°rög
 = 
	`gíRedisInfoSåög
("all");

1488 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
, 
öfo°rög
);

1489 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ CLIENT LIST OUTPUT ------\n");

1490 
˛õ¡s
 = 
	`gëAŒClõ¡sInfoSåög
(-1);

1491 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
, 
˛õ¡s
);

1492 
	`sds‰ì
(
öfo°rög
);

1493 
	`sds‰ì
(
˛õ¡s
);

1496 
	`logCuºítClõ¡
();

1499 
	`logRegi°îs
(
uc
);

1502 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ MODULES INFO OUTPUT ------\n");

1503 
öfo°rög
 = 
	`moduÀsCﬁÀ˘Info
(
	`sd£m±y
(), 
NULL
, 1, 0);

1504 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
, 
öfo°rög
);

1505 
	`sds‰ì
(
öfo°rög
);

1507 #i‡
	`deföed
(
HAVE_PROC_MAPS
)

1509 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ FAST MEMORY TEST ------\n");

1510 
	`bioKûlThªads
();

1511 i‡(
	`memã°_ã°_löux_™⁄ymous_m≠s
()) {

1512 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
,

1515 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
,

1520 i‡(
eù
 !
NULL
) {

1521 
Dl_öfo
 
öfo
;

1522 i‡(
	`dœddr
(
eù
, &
öfo
) != 0) {

1523 
	`£rvîLog
(
LL_WARNING
|
LL_RAW
,

1530 
öfo
.
dli_¢ame
, info.
dli_ßddr
, info.
dli_‚ame
, info.
dli_fba£
,

1531 
öfo
.
dli_ßddr
);

1532 
size_t
 
Àn
 = ()
eù
 - ()
öfo
.
dli_ßddr
;

1533 
sz
 = 
	`sysc⁄f
(
_SC_PAGESIZE
);

1534 i‡(
Àn
 < 1<<13) {

1538 
√xt
 = (()
eù
 + 
sz
) & ~(sz-1);

1539 
íd
 = ()
eù
 + 128;

1540 i‡(
íd
 > 
√xt
)Énd =Çext;

1541 
Àn
 = 
íd
 - ()
öfo
.
dli_ßddr
;

1542 
	`£rvîLogHexDump
(
LL_WARNING
, "dump of function",

1543 
öfo
.
dli_ßddr
 ,
Àn
);

1544 
	`dumpX86CÆls
(
öfo
.
dli_ßddr
,
Àn
);

1549 
	`£rvîLogRaw
(
LL_WARNING
|
LL_RAW
,

1557 i‡(
£rvî
.
d´m⁄ize
 && sîvî.
su≥rvi£d
 =0Ë
	`u∆ök
(£rvî.
pidfûe
);

1561 
	`sigem±y£t
 (&
a˘
.
ß_mask
);

1562 
a˘
.
ß_Êags
 = 
SA_NODEFER
 | 
SA_ONSTACK
 | 
SA_RESETHAND
;

1563 
a˘
.
ß_h™dÀr
 = 
SIG_DFL
;

1564 
	`siga˘i⁄
 (
sig
, &
a˘
, 
NULL
);

1565 
	`kûl
(
	`gëpid
(),
sig
);

1566 
	}
}

1571 
	$£rvîLogHexDump
(
Àvñ
, *
des¸
, *
vÆue
, 
size_t
 
Àn
) {

1572 
buf
[65], *
b
;

1573 *
v
 = 
vÆue
;

1574 
ch¨£t
[] = "0123456789abcdef";

1576 
	`£rvîLog
(
Àvñ
,"%†(hexdum∞o‡%zu byãs):", 
des¸
, 
Àn
);

1577 
b
 = 
buf
;

1578 
Àn
) {

1579 
b
[0] = 
ch¨£t
[(*
v
)>>4];

1580 
b
[1] = 
ch¨£t
[(*
v
)&0xf];

1581 
b
[2] = '\0';

1582 
b
 += 2;

1583 
Àn
--;

1584 
v
++;

1585 i‡(
b
-
buf
 =64 || 
Àn
 == 0) {

1586 
	`£rvîLogRaw
(
Àvñ
|
LL_RAW
,
buf
);

1587 
b
 = 
buf
;

1590 
	`£rvîLogRaw
(
Àvñ
|
LL_RAW
,"\n");

1591 
	}
}

1594 
	~<sys/time.h
>

1596 
	$w©chdogSig«lH™dÀr
(
sig
, 
sigöfo_t
 *
öfo
, *
£¸ë
) {

1597 #ifde‡
HAVE_BACKTRACE


1598 
uc⁄ãxt_t
 *
uc
 = (uc⁄ãxt_t*Ë
£¸ë
;

1600 ()
£¸ë
;

1602 
	`UNUSED
(
öfo
);

1603 
	`UNUSED
(
sig
);

1605 
	`£rvîLogFromH™dÀr
(
LL_WARNING
,"\n--- WATCHDOG TIMER EXPIRED ---");

1606 #ifde‡
HAVE_BACKTRACE


1607 
	`logSèckTø˚
(
uc
);

1609 
	`£rvîLogFromH™dÀr
(
LL_WARNING
,"Sorry:Ço support for backtrace().");

1611 
	`£rvîLogFromH™dÀr
(
LL_WARNING
,"--------\n");

1612 
	}
}

1617 
	$w©chdogScheduÀSig«l
(
≥riod
) {

1618 
ôimîvÆ
 
ô
;

1621 
ô
.
ô_vÆue
.
tv_£c
 = 
≥riod
/1000;

1622 
ô
.
ô_vÆue
.
tv_u£c
 = (
≥riod
%1000)*1000;

1624 
ô
.
ô_öãrvÆ
.
tv_£c
 = 0;

1625 
ô
.
ô_öãrvÆ
.
tv_u£c
 = 0;

1626 
	`£tôimî
(
ITIMER_REAL
, &
ô
, 
NULL
);

1627 
	}
}

1630 
	$íabÀW©chdog
(
≥riod
) {

1631 
mö_≥riod
;

1633 i‡(
£rvî
.
w©chdog_≥riod
 == 0) {

1634 
siga˘i⁄
 
a˘
;

1638 
	`sigem±y£t
(&
a˘
.
ß_mask
);

1639 
a˘
.
ß_Êags
 = 
SA_SIGINFO
;

1640 
a˘
.
ß_siga˘i⁄
 = 
w©chdogSig«lH™dÀr
;

1641 
	`siga˘i⁄
(
SIGALRM
, &
a˘
, 
NULL
);

1646 
mö_≥riod
 = (1000/
£rvî
.
hz
)*2;

1647 i‡(
≥riod
 < 
mö_≥riod
)Öeriod = min_period;

1648 
	`w©chdogScheduÀSig«l
(
≥riod
);

1649 
£rvî
.
w©chdog_≥riod
 = 
≥riod
;

1650 
	}
}

1653 
	$dißbÀW©chdog
() {

1654 
siga˘i⁄
 
a˘
;

1655 i‡(
£rvî
.
w©chdog_≥riod
 == 0) ;

1656 
	`w©chdogScheduÀSig«l
(0);

1660 
	`sigem±y£t
(&
a˘
.
ß_mask
);

1661 
a˘
.
ß_Êags
 = 0;

1662 
a˘
.
ß_h™dÀr
 = 
SIG_IGN
;

1663 
	`siga˘i⁄
(
SIGALRM
, &
a˘
, 
NULL
);

1664 
£rvî
.
w©chdog_≥riod
 = 0;

1665 
	}
}

	@debugmacro.h

33 
	~<°dio.h
>

34 
	#D
(...) \

36 
FILE
 *
Â
 = 
	`f›í
("/tmp/log.txt","a"); \

37 
	`Ârötf
(
Â
,"%s:%s:%d:\t", 
__FILE__
, 
__func__
, 
__LINE__
); \

38 
	`Ârötf
(
Â
,
__VA_ARGS__
); \

39 
	`Ârötf
(
Â
,"\n"); \

40 
	`f˛o£
(
Â
); \

41 } 0);

	)

	@defrag.c

37 
	~"£rvî.h
"

38 
	~<time.h
>

39 
	~<as£π.h
>

40 
	~<°ddef.h
>

42 #ifde‡
HAVE_DEFRAG


46 
je_gë_de‰ag_höt
(* 
±r
, *
bö_utû
, *
run_utû
);

49 
de‰agDi˘BuckëCÆlback
(*
¥ivd©a
, 
di˘E¡ry
 **
buckëªf
);

50 
di˘E¡ry
* 
ª∂a˚S©ñôeDi˘KeyPåAndOrDe‰agDi˘E¡ry
(
di˘
 *
d
, 
sds
 
ﬁdkey
, sd†
√wkey
, 
uöt64_t
 
hash
, *
de‰agged
);

57 * 
	$a˘iveDe‰agAŒoc
(*
±r
) {

58 
bö_utû
, 
run_utû
;

59 
size_t
 
size
;

60 *
√w±r
;

61 if(!
	`je_gë_de‰ag_höt
(
±r
, &
bö_utû
, &
run_utû
)) {

62 
£rvî
.
°©_a˘ive_de‰ag_mis£s
++;

63  
NULL
;

68 i‡(
run_utû
 > 
bö_utû
 ||Ñun_util == 1<<16) {

69 
£rvî
.
°©_a˘ive_de‰ag_mis£s
++;

70  
NULL
;

75 
size
 = 
	`zmÆloc_size
(
±r
);

76 
√w±r
 = 
	`zmÆloc_no_tˇche
(
size
);

77 
	`mem˝y
(
√w±r
, 
±r
, 
size
);

78 
	`z‰ì_no_tˇche
(
±r
);

79  
√w±r
;

80 
	}
}

87 
sds
 
	$a˘iveDe‰agSds
(
sds
 
sd•å
) {

88 * 
±r
 = 
	`sdsAŒocPå
(
sd•å
);

89 * 
√w±r
 = 
	`a˘iveDe‰agAŒoc
(
±r
);

90 i‡(
√w±r
) {

91 
size_t
 
off£t
 = 
sd•å
 - (*)
±r
;

92 
sd•å
 = (*)
√w±r
 + 
off£t
;

93  
sd•å
;

95  
NULL
;

96 
	}
}

103 
robj
 *
	$a˘iveDe‰agSåögOb
(
robj
* 
ob
, *
de‰agged
) {

104 
robj
 *
ªt
 = 
NULL
;

105 i‡(
ob
->
ªfcou¡
!=1)

106  
NULL
;

109 i‡(
ob
->
ty≥
!=
OBJ_STRING
 || ob->
ícodög
!=
OBJ_ENCODING_EMBSTR
) {

110 i‡((
ªt
 = 
	`a˘iveDe‰agAŒoc
(
ob
))) {

111 
ob
 = 
ªt
;

112 (*
de‰agged
)++;

117 i‡(
ob
->
ty≥
 =
OBJ_STRING
) {

118 if(
ob
->
ícodög
==
OBJ_ENCODING_RAW
) {

119 
sds
 
√wsds
 = 
	`a˘iveDe‰agSds
((sds)
ob
->
±r
);

120 i‡(
√wsds
) {

121 
ob
->
±r
 = 
√wsds
;

122 (*
de‰agged
)++;

124 } i‡(
ob
->
ícodög
==
OBJ_ENCODING_EMBSTR
) {

127 
ofs
 = (
öçå_t
)
ob
->
±r
 - (intptr_t)ob;

128 i‡((
ªt
 = 
	`a˘iveDe‰agAŒoc
(
ob
))) {

129 
ªt
->
±r
 = (*)((
öçå_t
Ïë + 
ofs
);

130 (*
de‰agged
)++;

132 } i‡(
ob
->
ícodög
!=
OBJ_ENCODING_INT
) {

133 
	`£rvîP™ic
("Unknown stringÉncoding");

136  
ªt
;

137 
	}
}

141 
	$di˘IãrDe‰agE¡ry
(
di˘Iãøt‹
 *
ôî
) {

145 
de‰agged
 = 0;

146 
di˘ht
 *
ht
;

149 i‡(
ôî
->
√xtE¡ry
) {

150 
di˘E¡ry
 *
√wde
 = 
	`a˘iveDe‰agAŒoc
(
ôî
->
√xtE¡ry
);

151 i‡(
√wde
) {

152 
de‰agged
++;

153 
ôî
->
√xtE¡ry
 = 
√wde
;

154 
ôî
->
íåy
->
√xt
 = 
√wde
;

158 
ht
 = &
ôî
->
d
->ht[ôî->
èbÀ
];

159 i‡(
ht
->
èbÀ
[
ôî
->
ödex
] =ôî->
íåy
) {

160 
di˘E¡ry
 *
√wde
 = 
	`a˘iveDe‰agAŒoc
(
ôî
->
íåy
);

161 i‡(
√wde
) {

162 
ôî
->
íåy
 = 
√wde
;

163 
ht
->
èbÀ
[
ôî
->
ödex
] = 
√wde
;

164 
de‰agged
++;

167  
de‰agged
;

168 
	}
}

173 
	$di˘De‰agTabÀs
(
di˘
* 
d
) {

174 
di˘E¡ry
 **
√wèbÀ
;

175 
de‰agged
 = 0;

177 
√wèbÀ
 = 
	`a˘iveDe‰agAŒoc
(
d
->
ht
[0].
èbÀ
);

178 i‡(
√wèbÀ
)

179 
de‰agged
++, 
d
->
ht
[0].
èbÀ
 = 
√wèbÀ
;

181 i‡(
d
->
ht
[1].
èbÀ
) {

182 
√wèbÀ
 = 
	`a˘iveDe‰agAŒoc
(
d
->
ht
[1].
èbÀ
);

183 i‡(
√wèbÀ
)

184 
de‰agged
++, 
d
->
ht
[1].
èbÀ
 = 
√wèbÀ
;

186  
de‰agged
;

187 
	}
}

190 
	$z¶Upd©eNode
(
zskùli°
 *
z¶
, 
zskùli°Node
 *
ﬁdnode
, zskùli°Nodê*
√wnode
, zskùli°Nodê**
upd©e
) {

191 
i
;

192 
i
 = 0; i < 
z¶
->
Àvñ
; i++) {

193 i‡(
upd©e
[
i
]->
Àvñ
[i].
f‹w¨d
 =
ﬁdnode
)

194 
upd©e
[
i
]->
Àvñ
[i].
f‹w¨d
 = 
√wnode
;

196 
	`£rvîAs£π
(
z¶
->
hódî
!=
ﬁdnode
);

197 i‡(
√wnode
->
Àvñ
[0].
f‹w¨d
) {

198 
	`£rvîAs£π
(
√wnode
->
Àvñ
[0].
f‹w¨d
->
backw¨d
==
ﬁdnode
);

199 
√wnode
->
Àvñ
[0].
f‹w¨d
->
backw¨d
 =Çewnode;

201 
	`£rvîAs£π
(
z¶
->
èû
==
ﬁdnode
);

202 
z¶
->
èû
 = 
√wnode
;

204 
	}
}

213 *
	$z¶De‰ag
(
zskùli°
 *
z¶
, 
sc‹e
, 
sds
 
ﬁdñe
, sd†
√wñe
) {

214 
zskùli°Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
, *
√wx
;

215 
i
;

216 
sds
 
ñe
 = 
√wñe
?Çewñe: 
ﬁdñe
;

220 
x
 = 
z¶
->
hódî
;

221 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

222 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

223 
x
->
Àvñ
[
i
].
f‹w¨d
->
ñe
 !
ﬁdñe
 &&

226 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 < score ||

227 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 == score &&

228 
	`sdscmp
(
x
->
Àvñ
[
i
].
f‹w¨d
->
ñe
,ele) < 0)))

229 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

230 
upd©e
[
i
] = 
x
;

234 
x
 = x->
Àvñ
[0].
f‹w¨d
;

235 
	`£rvîAs£π
(
x
 && 
sc‹e
 =x->sc‹ê&& x->
ñe
==
ﬁdñe
);

236 i‡(
√wñe
)

237 
x
->
ñe
 = 
√wñe
;

240 
√wx
 = 
	`a˘iveDe‰agAŒoc
(
x
);

241 i‡(
√wx
) {

242 
	`z¶Upd©eNode
(
z¶
, 
x
, 
√wx
, 
upd©e
);

243  &
√wx
->
sc‹e
;

245  
NULL
;

246 
	}
}

250 
	$a˘iveDe‰agZ£tE¡ry
(
z£t
 *
zs
, 
di˘E¡ry
 *
de
) {

251 
sds
 
√wsds
;

252 * 
√wsc‹e
;

253 
de‰agged
 = 0;

254 
sds
 
sd£À
 = 
	`di˘GëKey
(
de
);

255 i‡((
√wsds
 = 
	`a˘iveDe‰agSds
(
sd£À
)))

256 
de‰agged
++, 
de
->
key
 = 
√wsds
;

257 
√wsc‹e
 = 
	`z¶De‰ag
(
zs
->
z¶
, *(*)
	`di˘GëVÆ
(
de
), 
sd£À
, 
√wsds
);

258 i‡(
√wsc‹e
) {

259 
	`di˘SëVÆ
(
zs
->
di˘
, 
de
, 
√wsc‹e
);

260 
de‰agged
++;

262  
de‰agged
;

263 
	}
}

265 
	#DEFRAG_SDS_DICT_NO_VAL
 0

	)

266 
	#DEFRAG_SDS_DICT_VAL_IS_SDS
 1

	)

267 
	#DEFRAG_SDS_DICT_VAL_IS_STROB
 2

	)

268 
	#DEFRAG_SDS_DICT_VAL_VOID_PTR
 3

	)

271 
	$a˘iveDe‰agSdsDi˘
(
di˘
* 
d
, 
vÆ_ty≥
) {

272 
di˘Iãøt‹
 *
di
;

273 
di˘E¡ry
 *
de
;

274 
de‰agged
 = 0;

275 
di
 = 
	`di˘GëIãøt‹
(
d
);

276 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

277 
sds
 
sd£À
 = 
	`di˘GëKey
(
de
), 
√wsds
;

278 i‡((
√wsds
 = 
	`a˘iveDe‰agSds
(
sd£À
)))

279 
de
->
key
 = 
√wsds
, 
de‰agged
++;

281 i‡(
vÆ_ty≥
 =
DEFRAG_SDS_DICT_VAL_IS_SDS
) {

282 
sd£À
 = 
	`di˘GëVÆ
(
de
);

283 i‡((
√wsds
 = 
	`a˘iveDe‰agSds
(
sd£À
)))

284 
de
->
v
.
vÆ
 = 
√wsds
, 
de‰agged
++;

285 } i‡(
vÆ_ty≥
 =
DEFRAG_SDS_DICT_VAL_IS_STROB
) {

286 
robj
 *
√wñe
, *
ñe
 = 
	`di˘GëVÆ
(
de
);

287 i‡((
√wñe
 = 
	`a˘iveDe‰agSåögOb
(
ñe
, &
de‰agged
)))

288 
de
->
v
.
vÆ
 = 
√wñe
;

289 } i‡(
vÆ_ty≥
 =
DEFRAG_SDS_DICT_VAL_VOID_PTR
) {

290 *
√w±r
, *
±r
 = 
	`di˘GëVÆ
(
de
);

291 i‡((
√w±r
 = 
	`a˘iveDe‰agAŒoc
(
±r
)))

292 
de
->
v
.
vÆ
 = 
√w±r
, 
de‰agged
++;

294 
de‰agged
 +
	`di˘IãrDe‰agE¡ry
(
di
);

296 
	`di˘Rñó£Iãøt‹
(
di
);

297  
de‰agged
;

298 
	}
}

301 
	$a˘iveDe‰agLi°
(
li°
 *
l
, 
vÆ_ty≥
) {

302 
de‰agged
 = 0;

303 
li°Node
 *
 
, *
√w 
;

304 
 
 = 
l
->
hód
;Ün;Ü¿ ->
√xt
) {

305 i‡((
√w 
 = 
	`a˘iveDe‰agAŒoc
(
 
))) {

306 i‡(
√w 
->
¥ev
)

307 
√w 
->
¥ev
->
√xt
 =Çewln;

309 
l
->
hód
 = 
√w 
;

310 i‡(
√w 
->
√xt
)

311 
√w 
->
√xt
->
¥ev
 =Çewln;

313 
l
->
èû
 = 
√w 
;

314 
 
 = 
√w 
;

315 
de‰agged
++;

317 i‡(
vÆ_ty≥
 =
DEFRAG_SDS_DICT_VAL_IS_SDS
) {

318 
sds
 
√wsds
, 
sd£À
 = 
 
->
vÆue
;

319 i‡((
√wsds
 = 
	`a˘iveDe‰agSds
(
sd£À
)))

320 
 
->
vÆue
 = 
√wsds
, 
de‰agged
++;

321 } i‡(
vÆ_ty≥
 =
DEFRAG_SDS_DICT_VAL_IS_STROB
) {

322 
robj
 *
√wñe
, *
ñe
 = 
 
->
vÆue
;

323 i‡((
√wñe
 = 
	`a˘iveDe‰agSåögOb
(
ñe
, &
de‰agged
)))

324 
 
->
vÆue
 = 
√wñe
;

325 } i‡(
vÆ_ty≥
 =
DEFRAG_SDS_DICT_VAL_VOID_PTR
) {

326 *
√w±r
, *
±r
 = 
 
->
vÆue
;

327 i‡((
√w±r
 = 
	`a˘iveDe‰agAŒoc
(
±r
)))

328 
 
->
vÆue
 = 
√w±r
, 
de‰agged
++;

331  
de‰agged
;

332 
	}
}

335 
	$a˘iveDe‰agSdsLi°AndDi˘
(
li°
 *
l
, 
di˘
 *
d
, 
di˘_vÆ_ty≥
) {

336 
de‰agged
 = 0;

337 
sds
 
√wsds
, 
sd£À
;

338 
li°Node
 *
 
, *
√w 
;

339 
di˘Iãøt‹
 *
di
;

340 
di˘E¡ry
 *
de
;

342 
 
 = 
l
->
hód
;Ün;Ü¿ ->
√xt
) {

343 i‡((
√w 
 = 
	`a˘iveDe‰agAŒoc
(
 
))) {

344 i‡(
√w 
->
¥ev
)

345 
√w 
->
¥ev
->
√xt
 =Çewln;

347 
l
->
hód
 = 
√w 
;

348 i‡(
√w 
->
√xt
)

349 
√w 
->
√xt
->
¥ev
 =Çewln;

351 
l
->
èû
 = 
√w 
;

352 
 
 = 
√w 
;

353 
de‰agged
++;

355 
sd£À
 = 
 
->
vÆue
;

356 i‡((
√wsds
 = 
	`a˘iveDe‰agSds
(
sd£À
))) {

358 
uöt64_t
 
hash
 = 
	`di˘GëHash
(
d
, 
sd£À
);

359 
	`ª∂a˚S©ñôeDi˘KeyPåAndOrDe‰agDi˘E¡ry
(
d
, 
sd£À
, 
√wsds
, 
hash
, &
de‰agged
);

360 
 
->
vÆue
 = 
√wsds
;

361 
de‰agged
++;

366 
di
 = 
	`di˘GëIãøt‹
(
d
);

367 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

368 i‡(
di˘_vÆ_ty≥
 =
DEFRAG_SDS_DICT_VAL_IS_SDS
) {

369 
sds
 
√wsds
, 
sd£À
 = 
	`di˘GëVÆ
(
de
);

370 i‡((
√wsds
 = 
	`a˘iveDe‰agSds
(
sd£À
)))

371 
de
->
v
.
vÆ
 = 
√wsds
, 
de‰agged
++;

372 } i‡(
di˘_vÆ_ty≥
 =
DEFRAG_SDS_DICT_VAL_IS_STROB
) {

373 
robj
 *
√wñe
, *
ñe
 = 
	`di˘GëVÆ
(
de
);

374 i‡((
√wñe
 = 
	`a˘iveDe‰agSåögOb
(
ñe
, &
de‰agged
)))

375 
de
->
v
.
vÆ
 = 
√wñe
, 
de‰agged
++;

376 } i‡(
di˘_vÆ_ty≥
 =
DEFRAG_SDS_DICT_VAL_VOID_PTR
) {

377 *
√w±r
, *
±r
 = 
	`di˘GëVÆ
(
de
);

378 i‡((
√w±r
 = 
	`a˘iveDe‰agAŒoc
(
±r
)))

379 
 
->
vÆue
 = 
√w±r
, 
de‰agged
++;

381 
de‰agged
 +
	`di˘IãrDe‰agE¡ry
(
di
);

383 
	`di˘Rñó£Iãøt‹
(
di
);

385  
de‰agged
;

386 
	}
}

395 
di˘E¡ry
* 
	$ª∂a˚S©ñôeDi˘KeyPåAndOrDe‰agDi˘E¡ry
(
di˘
 *
d
, 
sds
 
ﬁdkey
, sd†
√wkey
, 
uöt64_t
 
hash
, *
de‰agged
) {

396 
di˘E¡ry
 **
dîef
 = 
	`di˘FödE¡ryRefByPåAndHash
(
d
, 
ﬁdkey
, 
hash
);

397 i‡(
dîef
) {

398 
di˘E¡ry
 *
de
 = *
dîef
;

399 
di˘E¡ry
 *
√wde
 = 
	`a˘iveDe‰agAŒoc
(
de
);

400 i‡(
√wde
) {

401 
de
 = *
dîef
 = 
√wde
;

402 (*
de‰agged
)++;

404 i‡(
√wkey
)

405 
de
->
key
 = 
√wkey
;

406  
de
;

408  
NULL
;

409 
	}
}

411 
	$a˘iveDe‰agQuickLi°Node
(
quickli°
 *
ql
, 
quickli°Node
 **
node_ªf
) {

412 
quickli°Node
 *
√wnode
, *
node
 = *
node_ªf
;

413 
de‰agged
 = 0;

414 *
√wzl
;

415 i‡((
√wnode
 = 
	`a˘iveDe‰agAŒoc
(
node
))) {

416 i‡(
√wnode
->
¥ev
)

417 
√wnode
->
¥ev
->
√xt
 =Çewnode;

419 
ql
->
hód
 = 
√wnode
;

420 i‡(
√wnode
->
√xt
)

421 
√wnode
->
√xt
->
¥ev
 =Çewnode;

423 
ql
->
èû
 = 
√wnode
;

424 *
node_ªf
 = 
node
 = 
√wnode
;

425 
de‰agged
++;

427 i‡((
√wzl
 = 
	`a˘iveDe‰agAŒoc
(
node
->
zl
)))

428 
de‰agged
++, 
node
->
zl
 = 
√wzl
;

429  
de‰agged
;

430 
	}
}

432 
	$a˘iveDe‰agQuickLi°Nodes
(
quickli°
 *
ql
) {

433 
quickli°Node
 *
node
 = 
ql
->
hód
;

434 
de‰agged
 = 0;

435 
node
) {

436 
de‰agged
 +
	`a˘iveDe‰agQuickLi°Node
(
ql
, &
node
);

437 
node
 =Çode->
√xt
;

439  
de‰agged
;

440 
	}
}

445 
	$de‰agL©î
(
ªdisDb
 *
db
, 
di˘E¡ry
 *
kde
) {

446 
sds
 
key
 = 
	`sdsdup
(
	`di˘GëKey
(
kde
));

447 
	`li°AddNodeTaû
(
db
->
de‰ag_œãr
, 
key
);

448 
	}
}

451 
	$sˇnL©îLi°
(
robj
 *
ob
, *
curs‹
, 
ídtime
, *
de‰agged
) {

452 
quickli°
 *
ql
 = 
ob
->
±r
;

453 
quickli°Node
 *
node
;

454 
ôî©i⁄s
 = 0;

455 
bookm¨k_Áûed
 = 0;

456 i‡(
ob
->
ty≥
 !
OBJ_LIST
 || ob->
ícodög
 !
OBJ_ENCODING_QUICKLIST
)

459 i‡(*
curs‹
 == 0) {

461 
node
 = 
ql
->
hód
;

463 
node
 = 
	`quickli°Bookm¨kFöd
(
ql
, "_AD");

464 i‡(!
node
) {

466 *
curs‹
 = 0;

469 
node
 =Çode->
√xt
;

472 (*
curs‹
)++;

473 
node
) {

474 (*
de‰agged
Ë+
	`a˘iveDe‰agQuickLi°Node
(
ql
, &
node
);

475 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
++;

476 i‡(++
ôî©i⁄s
 > 128 && !
bookm¨k_Áûed
) {

477 i‡(
	`u°ime
(Ë> 
ídtime
) {

478 i‡(!
	`quickli°Bookm¨kCª©e
(&
ql
, "_AD", 
node
)) {

479 
bookm¨k_Áûed
 = 1;

481 
ob
->
±r
 = 
ql
;

485 
ôî©i⁄s
 = 0;

487 
node
 =Çode->
√xt
;

489 
	`quickli°Bookm¨kDñëe
(
ql
, "_AD");

490 *
curs‹
 = 0;

491  
bookm¨k_Áûed
? 1: 0;

492 
	}
}

495 
z£t
 *
	mzs
;

496 
	mde‰agged
;

497 } 
	tsˇnL©îZ£tD©a
;

499 
	$sˇnL©îZ£tCÆlback
(*
¥ivd©a
, c⁄° 
di˘E¡ry
 *
_de
) {

500 
di˘E¡ry
 *
de
 = (di˘E¡ry*)
_de
;

501 
sˇnL©îZ£tD©a
 *
d©a
 = 
¥ivd©a
;

502 
d©a
->
de‰agged
 +
	`a˘iveDe‰agZ£tE¡ry
(d©a->
zs
, 
de
);

503 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
++;

504 
	}
}

506 
	$sˇnL©îZ£t
(
robj
 *
ob
, *
curs‹
) {

507 i‡(
ob
->
ty≥
 !
OBJ_ZSET
 || ob->
ícodög
 !
OBJ_ENCODING_SKIPLIST
)

509 
z£t
 *
zs
 = (z£t*)
ob
->
±r
;

510 
di˘
 *
d
 = 
zs
->dict;

511 
sˇnL©îZ£tD©a
 
d©a
 = {
zs
, 0};

512 *
curs‹
 = 
	`di˘Sˇn
(
d
, *curs‹, 
sˇnL©îZ£tCÆlback
, 
de‰agDi˘BuckëCÆlback
, &
d©a
);

513  
d©a
.
de‰agged
;

514 
	}
}

516 
	$sˇnL©îSëCÆlback
(*
¥ivd©a
, c⁄° 
di˘E¡ry
 *
_de
) {

517 
di˘E¡ry
 *
de
 = (di˘E¡ry*)
_de
;

518 *
de‰agged
 = 
¥ivd©a
;

519 
sds
 
sd£À
 = 
	`di˘GëKey
(
de
), 
√wsds
;

520 i‡((
√wsds
 = 
	`a˘iveDe‰agSds
(
sd£À
)))

521 (*
de‰agged
)++, 
de
->
key
 = 
√wsds
;

522 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
++;

523 
	}
}

525 
	$sˇnL©îSë
(
robj
 *
ob
, *
curs‹
) {

526 
de‰agged
 = 0;

527 i‡(
ob
->
ty≥
 !
OBJ_SET
 || ob->
ícodög
 !
OBJ_ENCODING_HT
)

529 
di˘
 *
d
 = 
ob
->
±r
;

530 *
curs‹
 = 
	`di˘Sˇn
(
d
, *curs‹, 
sˇnL©îSëCÆlback
, 
de‰agDi˘BuckëCÆlback
, &
de‰agged
);

531  
de‰agged
;

532 
	}
}

534 
	$sˇnL©îHashCÆlback
(*
¥ivd©a
, c⁄° 
di˘E¡ry
 *
_de
) {

535 
di˘E¡ry
 *
de
 = (di˘E¡ry*)
_de
;

536 *
de‰agged
 = 
¥ivd©a
;

537 
sds
 
sd£À
 = 
	`di˘GëKey
(
de
), 
√wsds
;

538 i‡((
√wsds
 = 
	`a˘iveDe‰agSds
(
sd£À
)))

539 (*
de‰agged
)++, 
de
->
key
 = 
√wsds
;

540 
sd£À
 = 
	`di˘GëVÆ
(
de
);

541 i‡((
√wsds
 = 
	`a˘iveDe‰agSds
(
sd£À
)))

542 (*
de‰agged
)++, 
de
->
v
.
vÆ
 = 
√wsds
;

543 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
++;

544 
	}
}

546 
	$sˇnL©îHash
(
robj
 *
ob
, *
curs‹
) {

547 
de‰agged
 = 0;

548 i‡(
ob
->
ty≥
 !
OBJ_HASH
 || ob->
ícodög
 !
OBJ_ENCODING_HT
)

550 
di˘
 *
d
 = 
ob
->
±r
;

551 *
curs‹
 = 
	`di˘Sˇn
(
d
, *curs‹, 
sˇnL©îHashCÆlback
, 
de‰agDi˘BuckëCÆlback
, &
de‰agged
);

552  
de‰agged
;

553 
	}
}

555 
	$de‰agQuickli°
(
ªdisDb
 *
db
, 
di˘E¡ry
 *
kde
) {

556 
robj
 *
ob
 = 
	`di˘GëVÆ
(
kde
);

557 
de‰agged
 = 0;

558 
quickli°
 *
ql
 = 
ob
->
±r
, *
√wql
;

559 
	`£rvîAs£π
(
ob
->
ty≥
 =
OBJ_LIST
 && ob->
ícodög
 =
OBJ_ENCODING_QUICKLIST
);

560 i‡((
√wql
 = 
	`a˘iveDe‰agAŒoc
(
ql
)))

561 
de‰agged
++, 
ob
->
±r
 = 
ql
 = 
√wql
;

562 i‡(
ql
->
Àn
 > 
£rvî
.
a˘ive_de‰ag_max_sˇn_fõlds
)

563 
	`de‰agL©î
(
db
, 
kde
);

565 
de‰agged
 +
	`a˘iveDe‰agQuickLi°Nodes
(
ql
);

566  
de‰agged
;

567 
	}
}

569 
	$de‰agZ£tSkùli°
(
ªdisDb
 *
db
, 
di˘E¡ry
 *
kde
) {

570 
robj
 *
ob
 = 
	`di˘GëVÆ
(
kde
);

571 
de‰agged
 = 0;

572 
z£t
 *
zs
 = (z£t*)
ob
->
±r
;

573 
z£t
 *
√wzs
;

574 
zskùli°
 *
√wz¶
;

575 
di˘
 *
√wdi˘
;

576 
di˘E¡ry
 *
de
;

577 
zskùli°Node
 *
√whódî
;

578 
	`£rvîAs£π
(
ob
->
ty≥
 =
OBJ_ZSET
 && ob->
ícodög
 =
OBJ_ENCODING_SKIPLIST
);

579 i‡((
√wzs
 = 
	`a˘iveDe‰agAŒoc
(
zs
)))

580 
de‰agged
++, 
ob
->
±r
 = 
zs
 = 
√wzs
;

581 i‡((
√wz¶
 = 
	`a˘iveDe‰agAŒoc
(
zs
->
z¶
)))

582 
de‰agged
++, 
zs
->
z¶
 = 
√wz¶
;

583 i‡((
√whódî
 = 
	`a˘iveDe‰agAŒoc
(
zs
->
z¶
->
hódî
)))

584 
de‰agged
++, 
zs
->
z¶
->
hódî
 = 
√whódî
;

585 i‡(
	`di˘Size
(
zs
->
di˘
Ë> 
£rvî
.
a˘ive_de‰ag_max_sˇn_fõlds
)

586 
	`de‰agL©î
(
db
, 
kde
);

588 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
zs
->
di˘
);

589 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

590 
de‰agged
 +
	`a˘iveDe‰agZ£tE¡ry
(
zs
, 
de
);

592 
	`di˘Rñó£Iãøt‹
(
di
);

595 i‡((
√wdi˘
 = 
	`a˘iveDe‰agAŒoc
(
zs
->
di˘
)))

596 
de‰agged
++, 
zs
->
di˘
 = 
√wdi˘
;

598 
de‰agged
 +
	`di˘De‰agTabÀs
(
zs
->
di˘
);

599  
de‰agged
;

600 
	}
}

602 
	$de‰agHash
(
ªdisDb
 *
db
, 
di˘E¡ry
 *
kde
) {

603 
de‰agged
 = 0;

604 
robj
 *
ob
 = 
	`di˘GëVÆ
(
kde
);

605 
di˘
 *
d
, *
√wd
;

606 
	`£rvîAs£π
(
ob
->
ty≥
 =
OBJ_HASH
 && ob->
ícodög
 =
OBJ_ENCODING_HT
);

607 
d
 = 
ob
->
±r
;

608 i‡(
	`di˘Size
(
d
Ë> 
£rvî
.
a˘ive_de‰ag_max_sˇn_fõlds
)

609 
	`de‰agL©î
(
db
, 
kde
);

611 
de‰agged
 +
	`a˘iveDe‰agSdsDi˘
(
d
, 
DEFRAG_SDS_DICT_VAL_IS_SDS
);

613 i‡((
√wd
 = 
	`a˘iveDe‰agAŒoc
(
ob
->
±r
)))

614 
de‰agged
++, 
ob
->
±r
 = 
√wd
;

616 
de‰agged
 +
	`di˘De‰agTabÀs
(
ob
->
±r
);

617  
de‰agged
;

618 
	}
}

620 
	$de‰agSë
(
ªdisDb
 *
db
, 
di˘E¡ry
 *
kde
) {

621 
de‰agged
 = 0;

622 
robj
 *
ob
 = 
	`di˘GëVÆ
(
kde
);

623 
di˘
 *
d
, *
√wd
;

624 
	`£rvîAs£π
(
ob
->
ty≥
 =
OBJ_SET
 && ob->
ícodög
 =
OBJ_ENCODING_HT
);

625 
d
 = 
ob
->
±r
;

626 i‡(
	`di˘Size
(
d
Ë> 
£rvî
.
a˘ive_de‰ag_max_sˇn_fõlds
)

627 
	`de‰agL©î
(
db
, 
kde
);

629 
de‰agged
 +
	`a˘iveDe‰agSdsDi˘
(
d
, 
DEFRAG_SDS_DICT_NO_VAL
);

631 i‡((
√wd
 = 
	`a˘iveDe‰agAŒoc
(
ob
->
±r
)))

632 
de‰agged
++, 
ob
->
±r
 = 
√wd
;

634 
de‰agged
 +
	`di˘De‰agTabÀs
(
ob
->
±r
);

635  
de‰agged
;

636 
	}
}

640 
	$de‰agRaxNode
(
øxNode
 **
nodîef
) {

641 
øxNode
 *
√wnode
 = 
	`a˘iveDe‰agAŒoc
(*
nodîef
);

642 i‡(
√wnode
) {

643 *
nodîef
 = 
√wnode
;

647 
	}
}

650 
	$sˇnL©îSå´mLi°∑cks
(
robj
 *
ob
, *
curs‹
, 
ídtime
, *
de‰agged
) {

651 
œ°
[(
°ªamID
)];

652 
øxIãøt‹
 
ri
;

653 
ôî©i⁄s
 = 0;

654 i‡(
ob
->
ty≥
 !
OBJ_STREAM
 || ob->
ícodög
 !
OBJ_ENCODING_STREAM
) {

655 *
curs‹
 = 0;

659 
°ªam
 *
s
 = 
ob
->
±r
;

660 
	`øxSèπ
(&
ri
,
s
->
øx
);

661 i‡(*
curs‹
 == 0) {

663 
	`de‰agRaxNode
(&
s
->
øx
->
hód
);

666 
ri
.
node_cb
 = 
de‰agRaxNode
;

667 
	`øxSìk
(&
ri
,"^",
NULL
,0);

670 i‡(!
	`øxSìk
(&
ri
,">", 
œ°
, (last))) {

671 *
curs‹
 = 0;

676 
ri
.
node_cb
 = 
de‰agRaxNode
;

679 (*
curs‹
)++;

680 
	`øxNext
(&
ri
)) {

681 *
√wd©a
 = 
	`a˘iveDe‰agAŒoc
(
ri
.
d©a
);

682 i‡(
√wd©a
)

683 
	`øxSëD©a
(
ri
.
node
,Ñi.
d©a
=
√wd©a
), (*
de‰agged
)++;

684 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
++;

685 i‡(++
ôî©i⁄s
 > 128) {

686 i‡(
	`u°ime
(Ë> 
ídtime
) {

687 
	`£rvîAs£π
(
ri
.
key_Àn
==(
œ°
));

688 
	`mem˝y
(
œ°
,
ri
.
key
,ri.
key_Àn
);

689 
	`øxSt›
(&
ri
);

692 
ôî©i⁄s
 = 0;

695 
	`øxSt›
(&
ri
);

696 *
curs‹
 = 0;

698 
	}
}

701 *(
	tøxDe‰agFun˘i⁄
)(
	tøxIãøt‹
 *
	tri
, *
	t¥ivd©a
, *
	tde‰agged
);

708 
	$de‰agRadixTªe
(
øx
 **
øxªf
, 
de‰ag_d©a
, 
øxDe‰agFun˘i⁄
 *
ñemít_cb
, *
ñemít_cb_d©a
) {

709 
de‰agged
 = 0;

710 
øxIãøt‹
 
ri
;

711 
øx
*Ñax;

712 i‡((
øx
 = 
	`a˘iveDe‰agAŒoc
(*
øxªf
)))

713 
de‰agged
++, *
øxªf
 = 
øx
;

714 
øx
 = *
øxªf
;

715 
	`øxSèπ
(&
ri
,
øx
);

716 
ri
.
node_cb
 = 
de‰agRaxNode
;

717 
	`de‰agRaxNode
(&
øx
->
hód
);

718 
	`øxSìk
(&
ri
,"^",
NULL
,0);

719 
	`øxNext
(&
ri
)) {

720 *
√wd©a
 = 
NULL
;

721 i‡(
ñemít_cb
)

722 
√wd©a
 = 
	`ñemít_cb
(&
ri
, 
ñemít_cb_d©a
, &
de‰agged
);

723 i‡(
de‰ag_d©a
 && !
√wd©a
)

724 
√wd©a
 = 
	`a˘iveDe‰agAŒoc
(
ri
.
d©a
);

725 i‡(
√wd©a
)

726 
	`øxSëD©a
(
ri
.
node
,Ñi.
d©a
=
√wd©a
), 
de‰agged
++;

728 
	`øxSt›
(&
ri
);

729  
de‰agged
;

730 
	}
}

733 
°ªamCG
 *
	mcg
;

734 
°ªamC⁄sumî
 *
	mc
;

735 } 
	tPídögE¡ryC⁄ãxt
;

737 * 
	$de‰agSåómC⁄sumîPídögE¡ry
(
øxIãøt‹
 *
ri
, *
¥ivd©a
, *
de‰agged
) {

738 
	`UNUSED
(
de‰agged
);

739 
PídögE¡ryC⁄ãxt
 *
˘x
 = 
¥ivd©a
;

740 
°ªamNACK
 *
«ck
 = 
ri
->
d©a
, *
√w«ck
;

741 
«ck
->
c⁄sumî
 = 
˘x
->
c
;

742 
√w«ck
 = 
	`a˘iveDe‰agAŒoc
(
«ck
);

743 i‡(
√w«ck
) {

745 *
¥ev
;

746 
	`øxIn£π
(
˘x
->
cg
->
≥l
, 
ri
->
key
,Ñi->
key_Àn
, 
√w«ck
, &
¥ev
);

747 
	`£rvîAs£π
(
¥ev
==
«ck
);

750  
√w«ck
;

751 
	}
}

753 * 
	$de‰agSåómC⁄sumî
(
øxIãøt‹
 *
ri
, *
¥ivd©a
, *
de‰agged
) {

754 
°ªamC⁄sumî
 *
c
 = 
ri
->
d©a
;

755 
°ªamCG
 *
cg
 = 
¥ivd©a
;

756 *
√wc
 = 
	`a˘iveDe‰agAŒoc
(
c
);

757 i‡(
√wc
) {

759 
c
 = 
√wc
;

761 
sds
 
√wsds
 = 
	`a˘iveDe‰agSds
(
c
->
«me
);

762 i‡(
√wsds
)

763 (*
de‰agged
)++, 
c
->
«me
 = 
√wsds
;

764 i‡(
c
->
≥l
) {

765 
PídögE¡ryC⁄ãxt
 
≥l_˘x
 = {
cg
, 
c
};

766 *
de‰agged
 +
	`de‰agRadixTªe
(&
c
->
≥l
, 0, 
de‰agSåómC⁄sumîPídögE¡ry
, &
≥l_˘x
);

768  
√wc
;

769 
	}
}

771 * 
	$de‰agSåómC⁄sumîGroup
(
øxIãøt‹
 *
ri
, *
¥ivd©a
, *
de‰agged
) {

772 
°ªamCG
 *
cg
 = 
ri
->
d©a
;

773 
	`UNUSED
(
¥ivd©a
);

774 i‡(
cg
->
c⁄sumîs
)

775 *
de‰agged
 +
	`de‰agRadixTªe
(&
cg
->
c⁄sumîs
, 0, 
de‰agSåómC⁄sumî
, cg);

776 i‡(
cg
->
≥l
)

777 *
de‰agged
 +
	`de‰agRadixTªe
(&
cg
->
≥l
, 0, 
NULL
, NULL);

778  
NULL
;

779 
	}
}

781 
	$de‰agSåóm
(
ªdisDb
 *
db
, 
di˘E¡ry
 *
kde
) {

782 
de‰agged
 = 0;

783 
robj
 *
ob
 = 
	`di˘GëVÆ
(
kde
);

784 
	`£rvîAs£π
(
ob
->
ty≥
 =
OBJ_STREAM
 && ob->
ícodög
 =
OBJ_ENCODING_STREAM
);

785 
°ªam
 *
s
 = 
ob
->
±r
, *
√ws
;

788 i‡((
√ws
 = 
	`a˘iveDe‰agAŒoc
(
s
)))

789 
de‰agged
++, 
ob
->
±r
 = 
s
 = 
√ws
;

791 i‡(
	`øxSize
(
s
->
øx
Ë> 
£rvî
.
a˘ive_de‰ag_max_sˇn_fõlds
) {

792 
øx
 *
√wøx
 = 
	`a˘iveDe‰agAŒoc
(
s
->rax);

793 i‡(
√wøx
)

794 
de‰agged
++, 
s
->
øx
 = 
√wøx
;

795 
	`de‰agL©î
(
db
, 
kde
);

797 
de‰agged
 +
	`de‰agRadixTªe
(&
s
->
øx
, 1, 
NULL
, NULL);

799 i‡(
s
->
cgroups
)

800 
de‰agged
 +
	`de‰agRadixTªe
(&
s
->
cgroups
, 1, 
de‰agSåómC⁄sumîGroup
, 
NULL
);

801  
de‰agged
;

802 
	}
}

807 
	$de‰agKey
(
ªdisDb
 *
db
, 
di˘E¡ry
 *
de
) {

808 
sds
 
keysds
 = 
	`di˘GëKey
(
de
);

809 
robj
 *
√wob
, *
ob
;

810 *
√wzl
;

811 
de‰agged
 = 0;

812 
sds
 
√wsds
;

815 
√wsds
 = 
	`a˘iveDe‰agSds
(
keysds
);

816 i‡(
√wsds
)

817 
de‰agged
++, 
de
->
key
 = 
√wsds
;

818 i‡(
	`di˘Size
(
db
->
expúes
)) {

822 
uöt64_t
 
hash
 = 
	`di˘GëHash
(
db
->
di˘
, 
de
->
key
);

823 
	`ª∂a˚S©ñôeDi˘KeyPåAndOrDe‰agDi˘E¡ry
(
db
->
expúes
, 
keysds
, 
√wsds
, 
hash
, &
de‰agged
);

827 
ob
 = 
	`di˘GëVÆ
(
de
);

828 i‡((
√wob
 = 
	`a˘iveDe‰agSåögOb
(
ob
, &
de‰agged
))) {

829 
de
->
v
.
vÆ
 = 
√wob
;

830 
ob
 = 
√wob
;

833 i‡(
ob
->
ty≥
 =
OBJ_STRING
) {

835 } i‡(
ob
->
ty≥
 =
OBJ_LIST
) {

836 i‡(
ob
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

837 
de‰agged
 +
	`de‰agQuickli°
(
db
, 
de
);

838 } i‡(
ob
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

839 i‡((
√wzl
 = 
	`a˘iveDe‰agAŒoc
(
ob
->
±r
)))

840 
de‰agged
++, 
ob
->
±r
 = 
√wzl
;

842 
	`£rvîP™ic
("UnknownÜistÉncoding");

844 } i‡(
ob
->
ty≥
 =
OBJ_SET
) {

845 i‡(
ob
->
ícodög
 =
OBJ_ENCODING_HT
) {

846 
de‰agged
 +
	`de‰agSë
(
db
, 
de
);

847 } i‡(
ob
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

848 
öt£t
 *
√wis
, *
is
 = 
ob
->
±r
;

849 i‡((
√wis
 = 
	`a˘iveDe‰agAŒoc
(
is
)))

850 
de‰agged
++, 
ob
->
±r
 = 
√wis
;

852 
	`£rvîP™ic
("Unknown setÉncoding");

854 } i‡(
ob
->
ty≥
 =
OBJ_ZSET
) {

855 i‡(
ob
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

856 i‡((
√wzl
 = 
	`a˘iveDe‰agAŒoc
(
ob
->
±r
)))

857 
de‰agged
++, 
ob
->
±r
 = 
√wzl
;

858 } i‡(
ob
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

859 
de‰agged
 +
	`de‰agZ£tSkùli°
(
db
, 
de
);

861 
	`£rvîP™ic
("Unknown sorted setÉncoding");

863 } i‡(
ob
->
ty≥
 =
OBJ_HASH
) {

864 i‡(
ob
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

865 i‡((
√wzl
 = 
	`a˘iveDe‰agAŒoc
(
ob
->
±r
)))

866 
de‰agged
++, 
ob
->
±r
 = 
√wzl
;

867 } i‡(
ob
->
ícodög
 =
OBJ_ENCODING_HT
) {

868 
de‰agged
 +
	`de‰agHash
(
db
, 
de
);

870 
	`£rvîP™ic
("Unknown hashÉncoding");

872 } i‡(
ob
->
ty≥
 =
OBJ_STREAM
) {

873 
de‰agged
 +
	`de‰agSåóm
(
db
, 
de
);

874 } i‡(
ob
->
ty≥
 =
OBJ_MODULE
) {

878 
	`£rvîP™ic
("Unknown objectÅype");

880  
de‰agged
;

881 
	}
}

884 
	$de‰agSˇnCÆlback
(*
¥ivd©a
, c⁄° 
di˘E¡ry
 *
de
) {

885 
de‰agged
 = 
	`de‰agKey
((
ªdisDb
*)
¥ivd©a
, (
di˘E¡ry
*)
de
);

886 
£rvî
.
°©_a˘ive_de‰ag_hôs
 +
de‰agged
;

887 if(
de‰agged
)

888 
£rvî
.
°©_a˘ive_de‰ag_key_hôs
++;

890 
£rvî
.
°©_a˘ive_de‰ag_key_mis£s
++;

891 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
++;

892 
	}
}

896 
	$de‰agDi˘BuckëCÆlback
(*
¥ivd©a
, 
di˘E¡ry
 **
buckëªf
) {

897 
	`UNUSED
(
¥ivd©a
);

898 *
buckëªf
) {

899 
di˘E¡ry
 *
de
 = *
buckëªf
, *
√wde
;

900 i‡((
√wde
 = 
	`a˘iveDe‰agAŒoc
(
de
))) {

901 *
buckëªf
 = 
√wde
;

903 
buckëªf
 = &(*buckëªf)->
√xt
;

905 
	}
}

913 
	$gëAŒoˇt‹Føgmíèti⁄
(
size_t
 *
out_‰ag_byãs
) {

914 
size_t
 
ªsidít
, 
a˘ive
, 
Æloˇãd
;

915 
	`zmÆloc_gë_Æloˇt‹_öfo
(&
Æloˇãd
, &
a˘ive
, &
ªsidít
);

916 
‰ag_p˘
 = (()
a˘ive
 / 
Æloˇãd
)*100 - 100;

917 
size_t
 
‰ag_byãs
 = 
a˘ive
 - 
Æloˇãd
;

918 
rss_p˘
 = (()
ªsidít
 / 
Æloˇãd
)*100 - 100;

919 
size_t
 
rss_byãs
 = 
ªsidít
 - 
Æloˇãd
;

920 if(
out_‰ag_byãs
)

921 *
out_‰ag_byãs
 = 
‰ag_byãs
;

922 
	`£rvîLog
(
LL_DEBUG
,

924 
Æloˇãd
, 
a˘ive
, 
ªsidít
, 
‰ag_p˘
, 
rss_p˘
, 
‰ag_byãs
, 
rss_byãs
);

925  
‰ag_p˘
;

926 
	}
}

930 
	$de‰agOthîGlobÆs
() {

931 
de‰agged
 = 0;

936 
de‰agged
 +
	`a˘iveDe‰agSdsDi˘
(
£rvî
.
lua_s¸ùts
, 
DEFRAG_SDS_DICT_VAL_IS_STROB
);

937 
de‰agged
 +
	`a˘iveDe‰agSdsLi°AndDi˘
(
£rvî
.
ª∂_s¸ùtˇche_fifo
, sîvî.
ª∂_s¸ùtˇche_di˘
, 
DEFRAG_SDS_DICT_NO_VAL
);

938  
de‰agged
;

939 
	}
}

943 
	$de‰agL©îIãm
(
di˘E¡ry
 *
de
, *
curs‹
, 
ídtime
) {

944 i‡(
de
) {

945 
robj
 *
ob
 = 
	`di˘GëVÆ
(
de
);

946 i‡(
ob
->
ty≥
 =
OBJ_LIST
) {

947  
	`sˇnL©îLi°
(
ob
, 
curs‹
, 
ídtime
, &
£rvî
.
°©_a˘ive_de‰ag_hôs
);

948 } i‡(
ob
->
ty≥
 =
OBJ_SET
) {

949 
£rvî
.
°©_a˘ive_de‰ag_hôs
 +
	`sˇnL©îSë
(
ob
, 
curs‹
);

950 } i‡(
ob
->
ty≥
 =
OBJ_ZSET
) {

951 
£rvî
.
°©_a˘ive_de‰ag_hôs
 +
	`sˇnL©îZ£t
(
ob
, 
curs‹
);

952 } i‡(
ob
->
ty≥
 =
OBJ_HASH
) {

953 
£rvî
.
°©_a˘ive_de‰ag_hôs
 +
	`sˇnL©îHash
(
ob
, 
curs‹
);

954 } i‡(
ob
->
ty≥
 =
OBJ_STREAM
) {

955  
	`sˇnL©îSå´mLi°∑cks
(
ob
, 
curs‹
, 
ídtime
, &
£rvî
.
°©_a˘ive_de‰ag_hôs
);

957 *
curs‹
 = 0;

960 *
curs‹
 = 0;

963 
	}
}

966 
sds
 
	gde‰ag_œãr_cuºít_key
 = 
NULL
;

967 
	gde‰ag_œãr_curs‹
 = 0;

970 
	$de‰agL©îSãp
(
ªdisDb
 *
db
, 
ídtime
) {

971 
ôî©i⁄s
 = 0;

972 
¥ev_de‰agged
 = 
£rvî
.
°©_a˘ive_de‰ag_hôs
;

973 
¥ev_sˇ¬ed
 = 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
;

974 
key_de‰agged
;

978 i‡(!
de‰ag_œãr_curs‹
) {

979 
li°Node
 *
hód
 = 
	`li°Fú°
(
db
->
de‰ag_œãr
);

982 i‡(
de‰ag_œãr_cuºít_key
) {

983 
	`£rvîAs£π
(
de‰ag_œãr_cuºít_key
 =
hód
->
vÆue
);

984 
	`li°DñNode
(
db
->
de‰ag_œãr
, 
hód
);

985 
de‰ag_œãr_curs‹
 = 0;

986 
de‰ag_œãr_cuºít_key
 = 
NULL
;

990 
hód
 = 
	`li°Fú°
(
db
->
de‰ag_œãr
);

991 i‡(!
hód
)

995 
de‰ag_œãr_cuºít_key
 = 
hód
->
vÆue
;

996 
de‰ag_œãr_curs‹
 = 0;

1000 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
db
->
di˘
, 
de‰ag_œãr_cuºít_key
);

1001 
key_de‰agged
 = 
£rvî
.
°©_a˘ive_de‰ag_hôs
;

1003 
quô
 = 0;

1004 i‡(
	`de‰agL©îIãm
(
de
, &
de‰ag_œãr_curs‹
, 
ídtime
))

1005 
quô
 = 1;

1010 i‡(
quô
 || (++
ôî©i⁄s
 > 16 ||

1011 
£rvî
.
°©_a˘ive_de‰ag_hôs
 - 
¥ev_de‰agged
 > 512 ||

1012 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
 - 
¥ev_sˇ¬ed
 > 64)) {

1013 i‡(
quô
 || 
	`u°ime
(Ë> 
ídtime
) {

1014 if(
key_de‰agged
 !
£rvî
.
°©_a˘ive_de‰ag_hôs
)

1015 
£rvî
.
°©_a˘ive_de‰ag_key_hôs
++;

1017 
£rvî
.
°©_a˘ive_de‰ag_key_mis£s
++;

1020 
ôî©i⁄s
 = 0;

1021 
¥ev_de‰agged
 = 
£rvî
.
°©_a˘ive_de‰ag_hôs
;

1022 
¥ev_sˇ¬ed
 = 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
;

1024 } 
de‰ag_œãr_curs‹
);

1025 if(
key_de‰agged
 !
£rvî
.
°©_a˘ive_de‰ag_hôs
)

1026 
£rvî
.
°©_a˘ive_de‰ag_key_hôs
++;

1028 
£rvî
.
°©_a˘ive_de‰ag_key_mis£s
++;

1030 
	}
}

1032 
	#INTERPOLATE
(
x
, 
x1
, 
x2
, 
y1
, 
y2
Ë–(y1Ë+ ((x)-(x1)Ë* ((y2)-(y1)Ë/ ((x2)-(x1)Ë)

	)

1033 
	#LIMIT
(
y
, 
mö
, 
max
Ë((y)<(mö)? mö: ((y)>(max)? max: (y)))

	)

1036 
	$compuãDe‰agCy˛es
() {

1037 
size_t
 
‰ag_byãs
;

1038 
‰ag_p˘
 = 
	`gëAŒoˇt‹Føgmíèti⁄
(&
‰ag_byãs
);

1040 i‡(!
£rvî
.
a˘ive_de‰ag_ru¬ög
) {

1041 if(
‰ag_p˘
 < 
£rvî
.
a˘ive_de‰ag_thªshﬁd_lowî
 || 
‰ag_byãs
 < sîvî.
a˘ive_de‰ag_ign‹e_byãs
)

1046 
˝u_p˘
 = 
	`INTERPOLATE
(
‰ag_p˘
,

1047 
£rvî
.
a˘ive_de‰ag_thªshﬁd_lowî
,

1048 
£rvî
.
a˘ive_de‰ag_thªshﬁd_uµî
,

1049 
£rvî
.
a˘ive_de‰ag_cy˛e_mö
,

1050 
£rvî
.
a˘ive_de‰ag_cy˛e_max
);

1051 
˝u_p˘
 = 
	`LIMIT
(cpu_pct,

1052 
£rvî
.
a˘ive_de‰ag_cy˛e_mö
,

1053 
£rvî
.
a˘ive_de‰ag_cy˛e_max
);

1056 i‡(!
£rvî
.
a˘ive_de‰ag_ru¬ög
 ||

1057 
˝u_p˘
 > 
£rvî
.
a˘ive_de‰ag_ru¬ög
)

1059 
£rvî
.
a˘ive_de‰ag_ru¬ög
 = 
˝u_p˘
;

1060 
	`£rvîLog
(
LL_VERBOSE
,

1062 
‰ag_p˘
, 
‰ag_byãs
, 
˝u_p˘
);

1064 
	}
}

1069 
	$a˘iveDe‰agCy˛e
() {

1070 
cuºít_db
 = -1;

1071 
curs‹
 = 0;

1072 
ªdisDb
 *
db
 = 
NULL
;

1073 
°¨t_sˇn
, 
°¨t_°©
;

1074 
ôî©i⁄s
 = 0;

1075 
¥ev_de‰agged
 = 
£rvî
.
°©_a˘ive_de‰ag_hôs
;

1076 
¥ev_sˇ¬ed
 = 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
;

1077 
°¨t
, 
timñimô
, 
ídtime
;

1078 
m°ime_t
 
œãncy
;

1079 
quô
 = 0;

1081 i‡(!
£rvî
.
a˘ive_de‰ag_íabÀd
) {

1082 i‡(
£rvî
.
a˘ive_de‰ag_ru¬ög
) {

1084 
£rvî
.
a˘ive_de‰ag_ru¬ög
 = 0;

1085 i‡(
db
)

1086 
	`li°Em±y
(
db
->
de‰ag_œãr
);

1087 
de‰ag_œãr_cuºít_key
 = 
NULL
;

1088 
de‰ag_œãr_curs‹
 = 0;

1089 
cuºít_db
 = -1;

1090 
curs‹
 = 0;

1091 
db
 = 
NULL
;

1096 i‡(
	`hasA˘iveChûdPro˚ss
())

1101 
	`run_wôh_≥riod
(1000) {

1102 
	`compuãDe‰agCy˛es
();

1104 i‡(!
£rvî
.
a˘ive_de‰ag_ru¬ög
)

1108 
°¨t
 = 
	`u°ime
();

1109 
timñimô
 = 1000000*
£rvî
.
a˘ive_de‰ag_ru¬ög
/£rvî.
hz
/100;

1110 i‡(
timñimô
 <= 0)Åimelimit = 1;

1111 
ídtime
 = 
°¨t
 + 
timñimô
;

1112 
	`œãncySèπM⁄ô‹
(
œãncy
);

1116 i‡(!
curs‹
) {

1118 i‡(
db
 && 
	`de‰agL©îSãp
(db, 
ídtime
)) {

1119 
quô
 = 1;

1124 i‡(++
cuºít_db
 >
£rvî
.
dbnum
) {

1126 
	`de‰agOthîGlobÆs
();

1128 
now
 = 
	`u°ime
();

1129 
size_t
 
‰ag_byãs
;

1130 
‰ag_p˘
 = 
	`gëAŒoˇt‹Føgmíèti⁄
(&
‰ag_byãs
);

1131 
	`£rvîLog
(
LL_VERBOSE
,

1133 ()((
now
 - 
°¨t_sˇn
)/1000), ()(
£rvî
.
°©_a˘ive_de‰ag_hôs
 - 
°¨t_°©
), 
‰ag_p˘
, 
‰ag_byãs
);

1135 
°¨t_sˇn
 = 
now
;

1136 
cuºít_db
 = -1;

1137 
curs‹
 = 0;

1138 
db
 = 
NULL
;

1139 
£rvî
.
a˘ive_de‰ag_ru¬ög
 = 0;

1141 
	`compuãDe‰agCy˛es
();

1142 i‡(
£rvî
.
a˘ive_de‰ag_ru¬ög
 !0 && 
	`u°ime
(Ë< 
ídtime
)

1146 i‡(
cuºít_db
==0) {

1148 
°¨t_sˇn
 = 
	`u°ime
();

1149 
°¨t_°©
 = 
£rvî
.
°©_a˘ive_de‰ag_hôs
;

1152 
db
 = &
£rvî
.db[
cuºít_db
];

1153 
curs‹
 = 0;

1158 i‡(
	`de‰agL©îSãp
(
db
, 
ídtime
)) {

1159 
quô
 = 1;

1163 
curs‹
 = 
	`di˘Sˇn
(
db
->
di˘
, curs‹, 
de‰agSˇnCÆlback
, 
de‰agDi˘BuckëCÆlback
, db);

1170 i‡(!
curs‹
 || (++
ôî©i⁄s
 > 16 ||

1171 
£rvî
.
°©_a˘ive_de‰ag_hôs
 - 
¥ev_de‰agged
 > 512 ||

1172 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
 - 
¥ev_sˇ¬ed
 > 64)) {

1173 i‡(!
curs‹
 || 
	`u°ime
(Ë> 
ídtime
) {

1174 
quô
 = 1;

1177 
ôî©i⁄s
 = 0;

1178 
¥ev_de‰agged
 = 
£rvî
.
°©_a˘ive_de‰ag_hôs
;

1179 
¥ev_sˇ¬ed
 = 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
;

1181 } 
curs‹
 && !
quô
);

1182 } !
quô
);

1184 
	`œãncyEndM⁄ô‹
(
œãncy
);

1185 
	`œãncyAddSam∂eIfNìded
("a˘ive-de‰ag-cy˛e",
œãncy
);

1186 
	}
}

1190 
	$a˘iveDe‰agCy˛e
() {

1192 
	}
}

	@dict.c

36 
	~"fma¸os.h
"

38 
	~<°dio.h
>

39 
	~<°dlib.h
>

40 
	~<°döt.h
>

41 
	~<°rög.h
>

42 
	~<°d¨g.h
>

43 
	~<limôs.h
>

44 
	~<sys/time.h
>

46 
	~"di˘.h
"

47 
	~"zmÆloc.h
"

48 #i‚de‡
DICT_BENCHMARK_MAIN


49 
	~"ªdißs£π.h
"

51 
	~<as£π.h
>

62 
	gdi˘_ˇn_ªsize
 = 1;

63 
	gdi˘_f‹˚_ªsize_øtio
 = 5;

67 
_di˘Ex∑ndIfNìded
(
di˘
 *
ht
);

68 
_di˘NextPowî
(
size
);

69 
_di˘KeyIndex
(
di˘
 *
ht
, c⁄° *
key
, 
uöt64_t
 
hash
, 
di˘E¡ry
 **
exi°ög
);

70 
_di˘Inô
(
di˘
 *
ht
, 
di˘Ty≥
 *
ty≥
, *
¥ivD©aPå
);

74 
uöt8_t
 
	gdi˘_hash_fun˘i⁄_£ed
[16];

76 
	$di˘SëHashFun˘i⁄Sìd
(
uöt8_t
 *
£ed
) {

77 
	`mem˝y
(
di˘_hash_fun˘i⁄_£ed
,
£ed
,(dict_hash_function_seed));

78 
	}
}

80 
uöt8_t
 *
	$di˘GëHashFun˘i⁄Sìd
() {

81  
di˘_hash_fun˘i⁄_£ed
;

82 
	}
}

87 
uöt64_t
 
sùhash
(c⁄° 
uöt8_t
 *
ö
, c⁄° 
size_t
 
öÀn
, c⁄° uöt8_à*
k
);

88 
uöt64_t
 
sùhash_noˇ£
(c⁄° 
uöt8_t
 *
ö
, c⁄° 
size_t
 
öÀn
, c⁄° uöt8_à*
k
);

90 
uöt64_t
 
	$di˘GíHashFun˘i⁄
(c⁄° *
key
, 
Àn
) {

91  
	`sùhash
(
key
,
Àn
,
di˘_hash_fun˘i⁄_£ed
);

92 
	}
}

94 
uöt64_t
 
	$di˘GíCa£HashFun˘i⁄
(c⁄° *
buf
, 
Àn
) {

95  
	`sùhash_noˇ£
(
buf
,
Àn
,
di˘_hash_fun˘i⁄_£ed
);

96 
	}
}

102 
	$_di˘Re£t
(
di˘ht
 *
ht
)

104 
ht
->
èbÀ
 = 
NULL
;

105 
ht
->
size
 = 0;

106 
ht
->
sizemask
 = 0;

107 
ht
->
u£d
 = 0;

108 
	}
}

111 
di˘
 *
	$di˘Cª©e
(
di˘Ty≥
 *
ty≥
,

112 *
¥ivD©aPå
)

114 
di˘
 *
d
 = 
	`zmÆloc
((*d));

116 
	`_di˘Inô
(
d
,
ty≥
,
¥ivD©aPå
);

117  
d
;

118 
	}
}

121 
	$_di˘Inô
(
di˘
 *
d
, 
di˘Ty≥
 *
ty≥
,

122 *
¥ivD©aPå
)

124 
	`_di˘Re£t
(&
d
->
ht
[0]);

125 
	`_di˘Re£t
(&
d
->
ht
[1]);

126 
d
->
ty≥
 =Åype;

127 
d
->
¥ivd©a
 = 
¥ivD©aPå
;

128 
d
->
ªhashidx
 = -1;

129 
d
->
ôî©‹s
 = 0;

130  
DICT_OK
;

131 
	}
}

135 
	$di˘Resize
(
di˘
 *
d
)

137 
möimÆ
;

139 i‡(!
di˘_ˇn_ªsize
 || 
	`di˘IsRehashög
(
d
)Ë 
DICT_ERR
;

140 
möimÆ
 = 
d
->
ht
[0].
u£d
;

141 i‡(
möimÆ
 < 
DICT_HT_INITIAL_SIZE
)

142 
möimÆ
 = 
DICT_HT_INITIAL_SIZE
;

143  
	`di˘Ex∑nd
(
d
, 
möimÆ
);

144 
	}
}

147 
	$di˘Ex∑nd
(
di˘
 *
d
, 
size
)

151 i‡(
	`di˘IsRehashög
(
d
Ë|| d->
ht
[0].
u£d
 > 
size
)

152  
DICT_ERR
;

154 
di˘ht
 
n
;

155 
ªÆsize
 = 
	`_di˘NextPowî
(
size
);

158 i‡(
ªÆsize
 =
d
->
ht
[0].
size
Ë 
DICT_ERR
;

161 
n
.
size
 = 
ªÆsize
;

162 
n
.
sizemask
 = 
ªÆsize
-1;

163 
n
.
èbÀ
 = 
	`zˇŒoc
(
ªÆsize
*(
di˘E¡ry
*));

164 
n
.
u£d
 = 0;

168 i‡(
d
->
ht
[0].
èbÀ
 =
NULL
) {

169 
d
->
ht
[0] = 
n
;

170  
DICT_OK
;

174 
d
->
ht
[1] = 
n
;

175 
d
->
ªhashidx
 = 0;

176  
DICT_OK
;

177 
	}
}

188 
	$di˘Rehash
(
di˘
 *
d
, 
n
) {

189 
em±y_visôs
 = 
n
*10;

190 i‡(!
	`di˘IsRehashög
(
d
))  0;

192 
n
-- && 
d
->
ht
[0].
u£d
 != 0) {

193 
di˘E¡ry
 *
de
, *
√xtde
;

197 
	`as£π
(
d
->
ht
[0].
size
 > ()d->
ªhashidx
);

198 
d
->
ht
[0].
èbÀ
[d->
ªhashidx
] =
NULL
) {

199 
d
->
ªhashidx
++;

200 i‡(--
em±y_visôs
 == 0)  1;

202 
de
 = 
d
->
ht
[0].
èbÀ
[d->
ªhashidx
];

204 
de
) {

205 
uöt64_t
 
h
;

207 
√xtde
 = 
de
->
√xt
;

209 
h
 = 
	`di˘HashKey
(
d
, 
de
->
key
Ë& d->
ht
[1].
sizemask
;

210 
de
->
√xt
 = 
d
->
ht
[1].
èbÀ
[
h
];

211 
d
->
ht
[1].
èbÀ
[
h
] = 
de
;

212 
d
->
ht
[0].
u£d
--;

213 
d
->
ht
[1].
u£d
++;

214 
de
 = 
√xtde
;

216 
d
->
ht
[0].
èbÀ
[d->
ªhashidx
] = 
NULL
;

217 
d
->
ªhashidx
++;

221 i‡(
d
->
ht
[0].
u£d
 == 0) {

222 
	`z‰ì
(
d
->
ht
[0].
èbÀ
);

223 
d
->
ht
[0] = d->ht[1];

224 
	`_di˘Re£t
(&
d
->
ht
[1]);

225 
d
->
ªhashidx
 = -1;

231 
	}
}

233 
	$timeInMûli£c⁄ds
() {

234 
timevÆ
 
tv
;

236 
	`gëtimeofday
(&
tv
,
NULL
);

237  ((()
tv
.
tv_£c
)*1000)+—v.
tv_u£c
/1000);

238 
	}
}

241 
	$di˘RehashMûli£c⁄ds
(
di˘
 *
d
, 
ms
) {

242 
°¨t
 = 
	`timeInMûli£c⁄ds
();

243 
ªhashes
 = 0;

245 
	`di˘Rehash
(
d
,100)) {

246 
ªhashes
 += 100;

247 i‡(
	`timeInMûli£c⁄ds
()-
°¨t
 > 
ms
) ;

249  
ªhashes
;

250 
	}
}

260 
	$_di˘RehashSãp
(
di˘
 *
d
) {

261 i‡(
d
->
ôî©‹s
 =0Ë
	`di˘Rehash
(d,1);

262 
	}
}

265 
	$di˘Add
(
di˘
 *
d
, *
key
, *
vÆ
)

267 
di˘E¡ry
 *
íåy
 = 
	`di˘AddRaw
(
d
,
key
,
NULL
);

269 i‡(!
íåy
Ë 
DICT_ERR
;

270 
	`di˘SëVÆ
(
d
, 
íåy
, 
vÆ
);

271  
DICT_OK
;

272 
	}
}

292 
di˘E¡ry
 *
	$di˘AddRaw
(
di˘
 *
d
, *
key
, 
di˘E¡ry
 **
exi°ög
)

294 
ödex
;

295 
di˘E¡ry
 *
íåy
;

296 
di˘ht
 *
ht
;

298 i‡(
	`di˘IsRehashög
(
d
)Ë
	`_di˘RehashSãp
(d);

302 i‡((
ödex
 = 
	`_di˘KeyIndex
(
d
, 
key
, 
	`di˘HashKey
(d,key), 
exi°ög
)) == -1)

303  
NULL
;

309 
ht
 = 
	`di˘IsRehashög
(
d
) ? &d->ht[1] : &d->ht[0];

310 
íåy
 = 
	`zmÆloc
((*entry));

311 
íåy
->
√xt
 = 
ht
->
èbÀ
[
ödex
];

312 
ht
->
èbÀ
[
ödex
] = 
íåy
;

313 
ht
->
u£d
++;

316 
	`di˘SëKey
(
d
, 
íåy
, 
key
);

317  
íåy
;

318 
	}
}

325 
	$di˘Rïœ˚
(
di˘
 *
d
, *
key
, *
vÆ
)

327 
di˘E¡ry
 *
íåy
, *
exi°ög
, 
auxíåy
;

331 
íåy
 = 
	`di˘AddRaw
(
d
,
key
,&
exi°ög
);

332 i‡(
íåy
) {

333 
	`di˘SëVÆ
(
d
, 
íåy
, 
vÆ
);

342 
auxíåy
 = *
exi°ög
;

343 
	`di˘SëVÆ
(
d
, 
exi°ög
, 
vÆ
);

344 
	`di˘FªeVÆ
(
d
, &
auxíåy
);

346 
	}
}

355 
di˘E¡ry
 *
	$di˘AddOrFöd
(
di˘
 *
d
, *
key
) {

356 
di˘E¡ry
 *
íåy
, *
exi°ög
;

357 
íåy
 = 
	`di˘AddRaw
(
d
,
key
,&
exi°ög
);

358  
íåy
 ?É¡ry : 
exi°ög
;

359 
	}
}

364 
di˘E¡ry
 *
	$di˘GíîicDñëe
(
di˘
 *
d
, c⁄° *
key
, 
no‰ì
) {

365 
uöt64_t
 
h
, 
idx
;

366 
di˘E¡ry
 *
he
, *
¥evHe
;

367 
èbÀ
;

369 i‡(
d
->
ht
[0].
u£d
 =0 && d->ht[1].u£d =0Ë 
NULL
;

371 i‡(
	`di˘IsRehashög
(
d
)Ë
	`_di˘RehashSãp
(d);

372 
h
 = 
	`di˘HashKey
(
d
, 
key
);

374 
èbÀ
 = 0;Åable <= 1;Åable++) {

375 
idx
 = 
h
 & 
d
->
ht
[
èbÀ
].
sizemask
;

376 
he
 = 
d
->
ht
[
èbÀ
].èbÀ[
idx
];

377 
¥evHe
 = 
NULL
;

378 
he
) {

379 i‡(
key
==
he
->key || 
	`di˘Com∑ªKeys
(
d
, key, he->key)) {

381 i‡(
¥evHe
)

382 
¥evHe
->
√xt
 = 
he
->next;

384 
d
->
ht
[
èbÀ
].èbÀ[
idx
] = 
he
->
√xt
;

385 i‡(!
no‰ì
) {

386 
	`di˘FªeKey
(
d
, 
he
);

387 
	`di˘FªeVÆ
(
d
, 
he
);

388 
	`z‰ì
(
he
);

390 
d
->
ht
[
èbÀ
].
u£d
--;

391  
he
;

393 
¥evHe
 = 
he
;

394 
he
 = he->
√xt
;

396 i‡(!
	`di˘IsRehashög
(
d
)) ;

398  
NULL
;

399 
	}
}

403 
	$di˘Dñëe
(
di˘
 *
ht
, c⁄° *
key
) {

404  
	`di˘GíîicDñëe
(
ht
,
key
,0Ë? 
DICT_OK
 : 
DICT_ERR
;

405 
	}
}

428 
di˘E¡ry
 *
	$di˘U∆ök
(
di˘
 *
ht
, c⁄° *
key
) {

429  
	`di˘GíîicDñëe
(
ht
,
key
,1);

430 
	}
}

434 
	$di˘FªeU∆ökedE¡ry
(
di˘
 *
d
, 
di˘E¡ry
 *
he
) {

435 i‡(
he
 =
NULL
) ;

436 
	`di˘FªeKey
(
d
, 
he
);

437 
	`di˘FªeVÆ
(
d
, 
he
);

438 
	`z‰ì
(
he
);

439 
	}
}

442 
_di˘CÀ¨
(
di˘
 *
d
, 
di˘ht
 *
ht
, (
ˇŒback
)(*)) {

443 
i
;

446 
i
 = 0; i < 
ht
->
size
 && ht->
u£d
 > 0; i++) {

447 
di˘E¡ry
 *
he
, *
√xtHe
;

449 i‡(
ˇŒback
 && (
i
 & 65535Ë=0Ë
	`ˇŒback
(
d
->
¥ivd©a
);

451 i‡((
he
 = 
ht
->
èbÀ
[
i
]Ë=
NULL
) ;

452 
he
) {

453 
√xtHe
 = 
he
->
√xt
;

454 
	`di˘FªeKey
(
d
, 
he
);

455 
	`di˘FªeVÆ
(
d
, 
he
);

456 
	`z‰ì
(
he
);

457 
ht
->
u£d
--;

458 
he
 = 
√xtHe
;

462 
	`z‰ì
(
ht
->
èbÀ
);

464 
	`_di˘Re£t
(
ht
);

465  
DICT_OK
;

466 
	}
}

469 
	$di˘Rñó£
(
di˘
 *
d
)

471 
	`_di˘CÀ¨
(
d
,&d->
ht
[0],
NULL
);

472 
	`_di˘CÀ¨
(
d
,&d->
ht
[1],
NULL
);

473 
	`z‰ì
(
d
);

474 
	}
}

476 
di˘E¡ry
 *
	$di˘Föd
(
di˘
 *
d
, c⁄° *
key
)

478 
di˘E¡ry
 *
he
;

479 
uöt64_t
 
h
, 
idx
, 
èbÀ
;

481 i‡(
d
->
ht
[0].
u£d
 + d->ht[1].u£d =0Ë 
NULL
;

482 i‡(
	`di˘IsRehashög
(
d
)Ë
	`_di˘RehashSãp
(d);

483 
h
 = 
	`di˘HashKey
(
d
, 
key
);

484 
èbÀ
 = 0;Åable <= 1;Åable++) {

485 
idx
 = 
h
 & 
d
->
ht
[
èbÀ
].
sizemask
;

486 
he
 = 
d
->
ht
[
èbÀ
].èbÀ[
idx
];

487 
he
) {

488 i‡(
key
==
he
->key || 
	`di˘Com∑ªKeys
(
d
, key, he->key))

489  
he
;

490 
he
 = he->
√xt
;

492 i‡(!
	`di˘IsRehashög
(
d
)Ë 
NULL
;

494  
NULL
;

495 
	}
}

497 *
	$di˘FëchVÆue
(
di˘
 *
d
, c⁄° *
key
) {

498 
di˘E¡ry
 *
he
;

500 
he
 = 
	`di˘Föd
(
d
,
key
);

501  
he
 ? 
	`di˘GëVÆ
(heË: 
NULL
;

502 
	}
}

510 
	$di˘Fögî¥öt
(
di˘
 *
d
) {

511 
öãgîs
[6], 
hash
 = 0;

512 
j
;

514 
öãgîs
[0] = (Ë
d
->
ht
[0].
èbÀ
;

515 
öãgîs
[1] = 
d
->
ht
[0].
size
;

516 
öãgîs
[2] = 
d
->
ht
[0].
u£d
;

517 
öãgîs
[3] = (Ë
d
->
ht
[1].
èbÀ
;

518 
öãgîs
[4] = 
d
->
ht
[1].
size
;

519 
öãgîs
[5] = 
d
->
ht
[1].
u£d
;

528 
j
 = 0; j < 6; j++) {

529 
hash
 +
öãgîs
[
j
];

531 
hash
 = (~hash) + (hash << 21);

532 
hash
 = hash ^ (hash >> 24);

533 
hash
 = (hash + (hash << 3)) + (hash << 8);

534 
hash
 = hash ^ (hash >> 14);

535 
hash
 = (hash + (hash << 2)) + (hash << 4);

536 
hash
 = hash ^ (hash >> 28);

537 
hash
 = hash + (hash << 31);

539  
hash
;

540 
	}
}

542 
di˘Iãøt‹
 *
	$di˘GëIãøt‹
(
di˘
 *
d
)

544 
di˘Iãøt‹
 *
ôî
 = 
	`zmÆloc
((*iter));

546 
ôî
->
d
 = d;

547 
ôî
->
èbÀ
 = 0;

548 
ôî
->
ödex
 = -1;

549 
ôî
->
ß„
 = 0;

550 
ôî
->
íåy
 = 
NULL
;

551 
ôî
->
√xtE¡ry
 = 
NULL
;

552  
ôî
;

553 
	}
}

555 
di˘Iãøt‹
 *
	$di˘GëSa„Iãøt‹
(
di˘
 *
d
) {

556 
di˘Iãøt‹
 *
i
 = 
	`di˘GëIãøt‹
(
d
);

558 
i
->
ß„
 = 1;

559  
i
;

560 
	}
}

562 
di˘E¡ry
 *
	$di˘Next
(
di˘Iãøt‹
 *
ôî
)

565 i‡(
ôî
->
íåy
 =
NULL
) {

566 
di˘ht
 *
ht
 = &
ôî
->
d
->ht[ôî->
èbÀ
];

567 i‡(
ôî
->
ödex
 =-1 && iãr->
èbÀ
 == 0) {

568 i‡(
ôî
->
ß„
)

569 
ôî
->
d
->
ôî©‹s
++;

571 
ôî
->
fögî¥öt
 = 
	`di˘Fögî¥öt
(ôî->
d
);

573 
ôî
->
ödex
++;

574 i‡(
ôî
->
ödex
 >(Ë
ht
->
size
) {

575 i‡(
	`di˘IsRehashög
(
ôî
->
d
Ë&& iãr->
èbÀ
 == 0) {

576 
ôî
->
èbÀ
++;

577 
ôî
->
ödex
 = 0;

578 
ht
 = &
ôî
->
d
->ht[1];

583 
ôî
->
íåy
 = 
ht
->
èbÀ
[ôî->
ödex
];

585 
ôî
->
íåy
 = iãr->
√xtE¡ry
;

587 i‡(
ôî
->
íåy
) {

590 
ôî
->
√xtE¡ry
 = iãr->
íåy
->
√xt
;

591  
ôî
->
íåy
;

594  
NULL
;

595 
	}
}

597 
	$di˘Rñó£Iãøt‹
(
di˘Iãøt‹
 *
ôî
)

599 i‡(!(
ôî
->
ödex
 =-1 && iãr->
èbÀ
 == 0)) {

600 i‡(
ôî
->
ß„
)

601 
ôî
->
d
->
ôî©‹s
--;

603 
	`as£π
(
ôî
->
fögî¥öt
 =
	`di˘Fögî¥öt
(ôî->
d
));

605 
	`z‰ì
(
ôî
);

606 
	}
}

610 
di˘E¡ry
 *
	$di˘GëR™domKey
(
di˘
 *
d
)

612 
di˘E¡ry
 *
he
, *
‹ighe
;

613 
h
;

614 
li°Àn
, 
li°ñe
;

616 i‡(
	`di˘Size
(
d
Ë=0Ë 
NULL
;

617 i‡(
	`di˘IsRehashög
(
d
)Ë
	`_di˘RehashSãp
(d);

618 i‡(
	`di˘IsRehashög
(
d
)) {

622 
h
 = 
d
->
ªhashidx
 + (
	`øndom
(Ë% (d->
ht
[0].
size
 +

623 
d
->
ht
[1].
size
 -

624 
d
->
ªhashidx
));

625 
he
 = (
h
 >
d
->
ht
[0].
size
Ë? d->ht[1].
èbÀ
[h - d->ht[0].size] :

626 
d
->
ht
[0].
èbÀ
[
h
];

627 } 
he
 =
NULL
);

630 
h
 = 
	`øndom
(Ë& 
d
->
ht
[0].
sizemask
;

631 
he
 = 
d
->
ht
[0].
èbÀ
[
h
];

632 } 
he
 =
NULL
);

639 
li°Àn
 = 0;

640 
‹ighe
 = 
he
;

641 
he
) {

642 
he
 = he->
√xt
;

643 
li°Àn
++;

645 
li°ñe
 = 
	`øndom
(Ë% 
li°Àn
;

646 
he
 = 
‹ighe
;

647 
li°ñe
--Ë
he
 = he->
√xt
;

648  
he
;

649 
	}
}

673 
	$di˘GëSomeKeys
(
di˘
 *
d
, 
di˘E¡ry
 **
des
, 
cou¡
) {

674 
j
;

675 
èbÀs
;

676 
°‹ed
 = 0, 
maxsizemask
;

677 
max°ïs
;

679 i‡(
	`di˘Size
(
d
Ë< 
cou¡
) count = dictSize(d);

680 
max°ïs
 = 
cou¡
*10;

683 
j
 = 0; j < 
cou¡
; j++) {

684 i‡(
	`di˘IsRehashög
(
d
))

685 
	`_di˘RehashSãp
(
d
);

690 
èbÀs
 = 
	`di˘IsRehashög
(
d
) ? 2 : 1;

691 
maxsizemask
 = 
d
->
ht
[0].
sizemask
;

692 i‡(
èbÀs
 > 1 && 
maxsizemask
 < 
d
->
ht
[1].
sizemask
)

693 
maxsizemask
 = 
d
->
ht
[1].
sizemask
;

696 
i
 = 
	`øndom
(Ë& 
maxsizemask
;

697 
em±yÀn
 = 0;

698 
°‹ed
 < 
cou¡
 && 
max°ïs
--) {

699 
j
 = 0; j < 
èbÀs
; j++) {

703 i‡(
èbÀs
 =2 && 
j
 =0 && 
i
 < (Ë
d
->
ªhashidx
) {

708 i‡(
i
 >
d
->
ht
[1].
size
)

709 
i
 = 
d
->
ªhashidx
;

713 i‡(
i
 >
d
->
ht
[
j
].
size
) ;

714 
di˘E¡ry
 *
he
 = 
d
->
ht
[
j
].
èbÀ
[
i
];

718 i‡(
he
 =
NULL
) {

719 
em±yÀn
++;

720 i‡(
em±yÀn
 >5 &&Ém±yÀ¿> 
cou¡
) {

721 
i
 = 
	`øndom
(Ë& 
maxsizemask
;

722 
em±yÀn
 = 0;

725 
em±yÀn
 = 0;

726 
he
) {

729 *
des
 = 
he
;

730 
des
++;

731 
he
 = he->
√xt
;

732 
°‹ed
++;

733 i‡(
°‹ed
 =
cou¡
)  stored;

737 
i
 = (i+1Ë& 
maxsizemask
;

739  
°‹ed
;

740 
	}
}

753 
	#GETFAIR_NUM_ENTRIES
 15

	)

754 
di˘E¡ry
 *
	$di˘GëFaúR™domKey
(
di˘
 *
d
) {

755 
di˘E¡ry
 *
íåõs
[
GETFAIR_NUM_ENTRIES
];

756 
cou¡
 = 
	`di˘GëSomeKeys
(
d
,
íåõs
,
GETFAIR_NUM_ENTRIES
);

761 i‡(
cou¡
 =0Ë 
	`di˘GëR™domKey
(
d
);

762 
idx
 = 
	`ønd
(Ë% 
cou¡
;

763  
íåõs
[
idx
];

764 
	}
}

768 
	$ªv
(
v
) {

769 
s
 = 
CHAR_BIT
 * (
v
);

770 
mask
 = ~0UL;

771 (
s
 >>= 1) > 0) {

772 
mask
 ^(mask << 
s
);

773 
v
 = ((v >> 
s
Ë& 
mask
) | ((v << s) & ~mask);

775  
v
;

776 
	}
}

862 
	$di˘Sˇn
(
di˘
 *
d
,

863 
v
,

864 
di˘SˇnFun˘i⁄
 *
‚
,

865 
di˘SˇnBuckëFun˘i⁄
* 
buckë‚
,

866 *
¥ivd©a
)

868 
di˘ht
 *
t0
, *
t1
;

869 c⁄° 
di˘E¡ry
 *
de
, *
√xt
;

870 
m0
, 
m1
;

872 i‡(
	`di˘Size
(
d
) == 0)  0;

876 
d
->
ôî©‹s
++;

878 i‡(!
	`di˘IsRehashög
(
d
)) {

879 
t0
 = &(
d
->
ht
[0]);

880 
m0
 = 
t0
->
sizemask
;

883 i‡(
buckë‚
Ë
	`buckë‚
(
¥ivd©a
, &
t0
->
èbÀ
[
v
 & 
m0
]);

884 
de
 = 
t0
->
èbÀ
[
v
 & 
m0
];

885 
de
) {

886 
√xt
 = 
de
->next;

887 
	`‚
(
¥ivd©a
, 
de
);

888 
de
 = 
√xt
;

893 
v
 |~
m0
;

896 
v
 = 
	`ªv
(v);

897 
v
++;

898 
v
 = 
	`ªv
(v);

901 
t0
 = &
d
->
ht
[0];

902 
t1
 = &
d
->
ht
[1];

905 i‡(
t0
->
size
 > 
t1
->size) {

906 
t0
 = &
d
->
ht
[1];

907 
t1
 = &
d
->
ht
[0];

910 
m0
 = 
t0
->
sizemask
;

911 
m1
 = 
t1
->
sizemask
;

914 i‡(
buckë‚
Ë
	`buckë‚
(
¥ivd©a
, &
t0
->
èbÀ
[
v
 & 
m0
]);

915 
de
 = 
t0
->
èbÀ
[
v
 & 
m0
];

916 
de
) {

917 
√xt
 = 
de
->next;

918 
	`‚
(
¥ivd©a
, 
de
);

919 
de
 = 
√xt
;

926 i‡(
buckë‚
Ë
	`buckë‚
(
¥ivd©a
, &
t1
->
èbÀ
[
v
 & 
m1
]);

927 
de
 = 
t1
->
èbÀ
[
v
 & 
m1
];

928 
de
) {

929 
√xt
 = 
de
->next;

930 
	`‚
(
¥ivd©a
, 
de
);

931 
de
 = 
√xt
;

935 
v
 |~
m1
;

936 
v
 = 
	`ªv
(v);

937 
v
++;

938 
v
 = 
	`ªv
(v);

941 } 
v
 & (
m0
 ^ 
m1
));

945 
d
->
ôî©‹s
--;

947  
v
;

948 
	}
}

953 
	$_di˘Ex∑ndIfNìded
(
di˘
 *
d
)

956 i‡(
	`di˘IsRehashög
(
d
)Ë 
DICT_OK
;

959 i‡(
d
->
ht
[0].
size
 =0Ë 
	`di˘Ex∑nd
(d, 
DICT_HT_INITIAL_SIZE
);

965 i‡(
d
->
ht
[0].
u£d
 >d->ht[0].
size
 &&

966 (
di˘_ˇn_ªsize
 ||

967 
d
->
ht
[0].
u£d
/d->ht[0].
size
 > 
di˘_f‹˚_ªsize_øtio
))

969  
	`di˘Ex∑nd
(
d
, d->
ht
[0].
u£d
*2);

971  
DICT_OK
;

972 
	}
}

975 
	$_di˘NextPowî
(
size
)

977 
i
 = 
DICT_HT_INITIAL_SIZE
;

979 i‡(
size
 >
LONG_MAX
)  LONG_MAX + 1LU;

981 i‡(
i
 >
size
)

982  
i
;

983 
i
 *= 2;

985 
	}
}

994 
	$_di˘KeyIndex
(
di˘
 *
d
, c⁄° *
key
, 
uöt64_t
 
hash
, 
di˘E¡ry
 **
exi°ög
)

996 
idx
, 
èbÀ
;

997 
di˘E¡ry
 *
he
;

998 i‡(
exi°ög
Ë*exi°ög = 
NULL
;

1001 i‡(
	`_di˘Ex∑ndIfNìded
(
d
Ë=
DICT_ERR
)

1003 
èbÀ
 = 0;Åable <= 1;Åable++) {

1004 
idx
 = 
hash
 & 
d
->
ht
[
èbÀ
].
sizemask
;

1006 
he
 = 
d
->
ht
[
èbÀ
].èbÀ[
idx
];

1007 
he
) {

1008 i‡(
key
==
he
->key || 
	`di˘Com∑ªKeys
(
d
, key, he->key)) {

1009 i‡(
exi°ög
Ë*exi°ög = 
he
;

1012 
he
 = he->
√xt
;

1014 i‡(!
	`di˘IsRehashög
(
d
)) ;

1016  
idx
;

1017 
	}
}

1019 
di˘Em±y
(
di˘
 *
d
, (
ˇŒback
)(*)) {

1020 
	`_di˘CÀ¨
(
d
,&d->
ht
[0],
ˇŒback
);

1021 
	`_di˘CÀ¨
(
d
,&d->
ht
[1],
ˇŒback
);

1022 
d
->
ªhashidx
 = -1;

1023 
d
->
ôî©‹s
 = 0;

1024 
	}
}

1026 
	$di˘E«bÀResize
() {

1027 
di˘_ˇn_ªsize
 = 1;

1028 
	}
}

1030 
	$di˘DißbÀResize
() {

1031 
di˘_ˇn_ªsize
 = 0;

1032 
	}
}

1034 
uöt64_t
 
	$di˘GëHash
(
di˘
 *
d
, c⁄° *
key
) {

1035  
	`di˘HashKey
(
d
, 
key
);

1036 
	}
}

1043 
di˘E¡ry
 **
	$di˘FödE¡ryRefByPåAndHash
(
di˘
 *
d
, c⁄° *
ﬁd±r
, 
uöt64_t
 
hash
) {

1044 
di˘E¡ry
 *
he
, **
hîef
;

1045 
idx
, 
èbÀ
;

1047 i‡(
d
->
ht
[0].
u£d
 + d->ht[1].u£d =0Ë 
NULL
;

1048 
èbÀ
 = 0;Åable <= 1;Åable++) {

1049 
idx
 = 
hash
 & 
d
->
ht
[
èbÀ
].
sizemask
;

1050 
hîef
 = &
d
->
ht
[
èbÀ
].èbÀ[
idx
];

1051 
he
 = *
hîef
;

1052 
he
) {

1053 i‡(
ﬁd±r
==
he
->
key
)

1054  
hîef
;

1055 
hîef
 = &
he
->
√xt
;

1056 
he
 = *
hîef
;

1058 i‡(!
	`di˘IsRehashög
(
d
)Ë 
NULL
;

1060  
NULL
;

1061 
	}
}

1065 
	#DICT_STATS_VECTLEN
 50

	)

1066 
size_t
 
	$_di˘GëSètsHt
(*
buf
, 
size_t
 
bufsize
, 
di˘ht
 *
ht
, 
èbÀid
) {

1067 
i
, 
¶Ÿs
 = 0, 
chaöÀn
, 
maxchaöÀn
 = 0;

1068 
tŸchaöÀn
 = 0;

1069 
˛ve˘‹
[
DICT_STATS_VECTLEN
];

1070 
size_t
 
l
 = 0;

1072 i‡(
ht
->
u£d
 == 0) {

1073  
	`¢¥ötf
(
buf
,
bufsize
,

1078 
i
 = 0; i < 
DICT_STATS_VECTLEN
; i++Ë
˛ve˘‹
[i] = 0;

1079 
i
 = 0; i < 
ht
->
size
; i++) {

1080 
di˘E¡ry
 *
he
;

1082 i‡(
ht
->
èbÀ
[
i
] =
NULL
) {

1083 
˛ve˘‹
[0]++;

1086 
¶Ÿs
++;

1088 
chaöÀn
 = 0;

1089 
he
 = 
ht
->
èbÀ
[
i
];

1090 
he
) {

1091 
chaöÀn
++;

1092 
he
 = he->
√xt
;

1094 
˛ve˘‹
[(
chaöÀn
 < 
DICT_STATS_VECTLEN
) ? chainlen : (DICT_STATS_VECTLEN-1)]++;

1095 i‡(
chaöÀn
 > 
maxchaöÀn
) maxchainlen = chainlen;

1096 
tŸchaöÀn
 +
chaöÀn
;

1100 
l
 +
	`¢¥ötf
(
buf
+l,
bufsize
-l,

1109 
èbÀid
, (tableid == 0) ? "main hashÅable" : "rehashingÅarget",

1110 
ht
->
size
, ht->
u£d
, 
¶Ÿs
, 
maxchaöÀn
,

1111 ()
tŸchaöÀn
/
¶Ÿs
, ()
ht
->
u£d
/slots);

1113 
i
 = 0; i < 
DICT_STATS_VECTLEN
-1; i++) {

1114 i‡(
˛ve˘‹
[
i
] == 0) ;

1115 i‡(
l
 >
bufsize
) ;

1116 
l
 +
	`¢¥ötf
(
buf
+l,
bufsize
-l,

1118 (
i
 =
DICT_STATS_VECTLEN
-1)?">= ":"",

1119 
i
, 
˛ve˘‹
[i], (()˛ve˘‹[i]/
ht
->
size
)*100);

1123 i‡(
bufsize
Ë
buf
[bufsize-1] = '\0';

1124  
	`°æí
(
buf
);

1125 
	}
}

1127 
	$di˘GëSèts
(*
buf
, 
size_t
 
bufsize
, 
di˘
 *
d
) {

1128 
size_t
 
l
;

1129 *
‹ig_buf
 = 
buf
;

1130 
size_t
 
‹ig_bufsize
 = 
bufsize
;

1132 
l
 = 
	`_di˘GëSètsHt
(
buf
,
bufsize
,&
d
->
ht
[0],0);

1133 
buf
 +
l
;

1134 
bufsize
 -
l
;

1135 i‡(
	`di˘IsRehashög
(
d
Ë&& 
bufsize
 > 0) {

1136 
	`_di˘GëSètsHt
(
buf
,
bufsize
,&
d
->
ht
[1],1);

1139 i‡(
‹ig_bufsize
Ë
‹ig_buf
[orig_bufsize-1] = '\0';

1140 
	}
}

1144 #ifde‡
DICT_BENCHMARK_MAIN


1146 
	~"sds.h
"

1148 
uöt64_t
 
	$hashCÆlback
(c⁄° *
key
) {

1149  
	`di˘GíHashFun˘i⁄
((*)
key
, 
	`sd¶í
((*)key));

1150 
	}
}

1152 
	$com∑ªCÆlback
(*
¥ivd©a
, c⁄° *
key1
, c⁄° *
key2
) {

1153 
l1
,
l2
;

1154 
	`DICT_NOTUSED
(
¥ivd©a
);

1156 
l1
 = 
	`sd¶í
((
sds
)
key1
);

1157 
l2
 = 
	`sd¶í
((
sds
)
key2
);

1158 i‡(
l1
 !
l2
)  0;

1159  
	`memcmp
(
key1
, 
key2
, 
l1
) == 0;

1160 
	}
}

1162 
	$‰ìCÆlback
(*
¥ivd©a
, *
vÆ
) {

1163 
	`DICT_NOTUSED
(
¥ivd©a
);

1165 
	`sds‰ì
(
vÆ
);

1166 
	}
}

1168 
di˘Ty≥
 
	gBíchm¨kDi˘Ty≥
 = {

1169 
hashCÆlback
,

1170 
NULL
,

1171 
NULL
,

1172 
com∑ªCÆlback
,

1173 
‰ìCÆlback
,

1174 
NULL


1177 
	#°¨t_bíchm¨k
(Ë
°¨t
 = 
	`timeInMûli£c⁄ds
()

	)

1178 
	#íd_bíchm¨k
(
msg
) do { \

1179 
ñ≠£d
 = 
	`timeInMûli£c⁄ds
()-
°¨t
; \

1180 
	`¥ötf
(
msg
 ": %ld iãm†ö %Œd ms\n", 
cou¡
, 
ñ≠£d
); \

1181 } 0);

	)

1184 
	$maö
(
¨gc
, **
¨gv
) {

1185 
j
;

1186 
°¨t
, 
ñ≠£d
;

1187 
di˘
 *di˘ = 
	`di˘Cª©e
(&
Bíchm¨kDi˘Ty≥
,
NULL
);

1188 
cou¡
 = 0;

1190 i‡(
¨gc
 == 2) {

1191 
cou¡
 = 
	`°πﬁ
(
¨gv
[1],
NULL
,10);

1193 
cou¡
 = 5000000;

1196 
	`°¨t_bíchm¨k
();

1197 
j
 = 0; j < 
cou¡
; j++) {

1198 
ªtvÆ
 = 
	`di˘Add
(
di˘
,
	`sds‰oml⁄gl⁄g
(
j
),(*)j);

1199 
	`as£π
(
ªtvÆ
 =
DICT_OK
);

1201 
	`íd_bíchm¨k
("Inserting");

1202 
	`as£π
(()
	`di˘Size
(
di˘
Ë=
cou¡
);

1205 
	`di˘IsRehashög
(
di˘
)) {

1206 
	`di˘RehashMûli£c⁄ds
(
di˘
,100);

1209 
	`°¨t_bíchm¨k
();

1210 
j
 = 0; j < 
cou¡
; j++) {

1211 
sds
 
key
 = 
	`sds‰oml⁄gl⁄g
(
j
);

1212 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
di˘
,
key
);

1213 
	`as£π
(
de
 !
NULL
);

1214 
	`sds‰ì
(
key
);

1216 
	`íd_bíchm¨k
("Linearáccess ofÉxistingÉlements");

1218 
	`°¨t_bíchm¨k
();

1219 
j
 = 0; j < 
cou¡
; j++) {

1220 
sds
 
key
 = 
	`sds‰oml⁄gl⁄g
(
j
);

1221 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
di˘
,
key
);

1222 
	`as£π
(
de
 !
NULL
);

1223 
	`sds‰ì
(
key
);

1225 
	`íd_bíchm¨k
("Linearáccess ofÉxistingÉlements (2ndÑound)");

1227 
	`°¨t_bíchm¨k
();

1228 
j
 = 0; j < 
cou¡
; j++) {

1229 
sds
 
key
 = 
	`sds‰oml⁄gl⁄g
(
	`ønd
(Ë% 
cou¡
);

1230 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
di˘
,
key
);

1231 
	`as£π
(
de
 !
NULL
);

1232 
	`sds‰ì
(
key
);

1234 
	`íd_bíchm¨k
("Randomáccess ofÉxistingÉlements");

1236 
	`°¨t_bíchm¨k
();

1237 
j
 = 0; j < 
cou¡
; j++) {

1238 
sds
 
key
 = 
	`sds‰oml⁄gl⁄g
(
	`ønd
(Ë% 
cou¡
);

1239 
key
[0] = 'X';

1240 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
di˘
,
key
);

1241 
	`as£π
(
de
 =
NULL
);

1242 
	`sds‰ì
(
key
);

1244 
	`íd_bíchm¨k
("Accessing missing");

1246 
	`°¨t_bíchm¨k
();

1247 
j
 = 0; j < 
cou¡
; j++) {

1248 
sds
 
key
 = 
	`sds‰oml⁄gl⁄g
(
j
);

1249 
ªtvÆ
 = 
	`di˘Dñëe
(
di˘
,
key
);

1250 
	`as£π
(
ªtvÆ
 =
DICT_OK
);

1251 
key
[0] += 17;

1252 
ªtvÆ
 = 
	`di˘Add
(
di˘
,
key
,(*)
j
);

1253 
	`as£π
(
ªtvÆ
 =
DICT_OK
);

1255 
	`íd_bíchm¨k
("Removingándádding");

1256 
	}
}

	@dict.h

36 
	~<°döt.h
>

38 #i‚de‡
__DICT_H


39 
	#__DICT_H


	)

41 
	#DICT_OK
 0

	)

42 
	#DICT_ERR
 1

	)

45 
	#DICT_NOTUSED
(
V
Ë((ËV)

	)

47 
	sdi˘E¡ry
 {

48 *
	mkey
;

50 *
	mvÆ
;

51 
uöt64_t
 
	mu64
;

52 
öt64_t
 
	ms64
;

53 
	md
;

54 } 
	mv
;

55 
di˘E¡ry
 *
	m√xt
;

56 } 
	tdi˘E¡ry
;

58 
	sdi˘Ty≥
 {

59 
uöt64_t
 (*
hashFun˘i⁄
)(c⁄° *
	mkey
);

60 *(*
	mkeyDup
)(*
	m¥ivd©a
, c⁄° *
	mkey
);

61 *(*
	mvÆDup
)(*
	m¥ivd©a
, c⁄° *
	mobj
);

62 (*
	mkeyCom∑ª
)(*
	m¥ivd©a
, c⁄° *
	mkey1
, c⁄° *
	mkey2
);

63 (*
	mkeyDe°ru˘‹
)(*
	m¥ivd©a
, *
	mkey
);

64 (*
	mvÆDe°ru˘‹
)(*
	m¥ivd©a
, *
	mobj
);

65 } 
	tdi˘Ty≥
;

69 
	sdi˘ht
 {

70 
di˘E¡ry
 **
	mèbÀ
;

71 
	msize
;

72 
	msizemask
;

73 
	mu£d
;

74 } 
	tdi˘ht
;

76 
	sdi˘
 {

77 
di˘Ty≥
 *
	mty≥
;

78 *
	m¥ivd©a
;

79 
di˘ht
 
	mht
[2];

80 
	mªhashidx
;

81 
	môî©‹s
;

82 } 
	tdi˘
;

88 
	sdi˘Iãøt‹
 {

89 
di˘
 *
	md
;

90 
	mödex
;

91 
	mèbÀ
, 
	mß„
;

92 
di˘E¡ry
 *
	míåy
, *
	m√xtE¡ry
;

94 
	mfögî¥öt
;

95 } 
	tdi˘Iãøt‹
;

97 (
	tdi˘SˇnFun˘i⁄
)(*
	t¥ivd©a
, c⁄° 
	tdi˘E¡ry
 *
	tde
);

98 (
	tdi˘SˇnBuckëFun˘i⁄
)(*
	t¥ivd©a
, 
	tdi˘E¡ry
 **
	tbuckëªf
);

101 
	#DICT_HT_INITIAL_SIZE
 4

	)

104 
	#di˘FªeVÆ
(
d
, 
íåy
) \

105 i‡((
d
)->
ty≥
->
vÆDe°ru˘‹
) \

106 (
d
)->
ty≥
->
	`vÆDe°ru˘‹
((d)->
¥ivd©a
, (
íåy
)->
v
.
vÆ
)

	)

108 
	#di˘SëVÆ
(
d
, 
íåy
, 
_vÆ_
) do { \

109 i‡((
d
)->
ty≥
->
vÆDup
) \

110 (
íåy
)->
v
.
vÆ
 = (
d
)->
ty≥
->
	`vÆDup
((d)->
¥ivd©a
, 
_vÆ_
); \

112 (
íåy
)->
v
.
vÆ
 = (
_vÆ_
); \

113 
	}
} 0)

	)

115 
	#di˘SëSig√dI¡egîVÆ
(
íåy
, 
_vÆ_
) \

116 dÿ{ (
íåy
)->
v
.
s64
 = 
_vÆ_
; } 0)

	)

118 
	#di˘SëUnsig√dI¡egîVÆ
(
íåy
, 
_vÆ_
) \

119 dÿ{ (
íåy
)->
v
.
u64
 = 
_vÆ_
; } 0)

	)

121 
	#di˘SëDoubÀVÆ
(
íåy
, 
_vÆ_
) \

122 dÿ{ (
íåy
)->
v
.
d
 = 
_vÆ_
; } 0)

	)

124 
	#di˘FªeKey
(
d
, 
íåy
) \

125 i‡((
d
)->
ty≥
->
keyDe°ru˘‹
) \

126 (
d
)->
ty≥
->
	`keyDe°ru˘‹
((d)->
¥ivd©a
, (
íåy
)->
key
)

	)

128 
	#di˘SëKey
(
d
, 
íåy
, 
_key_
) do { \

129 i‡((
d
)->
ty≥
->
keyDup
) \

130 (
íåy
)->
key
 = (
d
)->
ty≥
->
	`keyDup
((d)->
¥ivd©a
, 
_key_
); \

132 (
íåy
)->
key
 = (
_key_
); \

133 } 0)

	)

135 
	#di˘Com∑ªKeys
(
d
, 
key1
, 
key2
) \

136 (((
d
)->
ty≥
->
keyCom∑ª
) ? \

137 (
d
)->
ty≥
->
	`keyCom∑ª
((d)->
¥ivd©a
, 
key1
, 
key2
) : \

138 (
key1
Ë=(
key2
))

	)

140 
	#di˘HashKey
(
d
, 
key
Ë(d)->
ty≥
->
	`hashFun˘i⁄
(key)

	)

141 
	#di˘GëKey
(
he
Ë((he)->
key
)

	)

142 
	#di˘GëVÆ
(
he
Ë((he)->
v
.
vÆ
)

	)

143 
	#di˘GëSig√dI¡egîVÆ
(
he
Ë((he)->
v
.
s64
)

	)

144 
	#di˘GëUnsig√dI¡egîVÆ
(
he
Ë((he)->
v
.
u64
)

	)

145 
	#di˘GëDoubÀVÆ
(
he
Ë((he)->
v
.
d
)

	)

146 
	#di˘SlŸs
(
d
Ë((d)->
ht
[0].
size
+(d)->ht[1].size)

	)

147 
	#di˘Size
(
d
Ë((d)->
ht
[0].
u£d
+(d)->ht[1].u£d)

	)

148 
	#di˘IsRehashög
(
d
Ë((d)->
ªhashidx
 !-1)

	)

151 
di˘
 *
di˘Cª©e
(
di˘Ty≥
 *
ty≥
, *
¥ivD©aPå
);

152 
di˘Ex∑nd
(
di˘
 *
d
, 
size
);

153 
di˘Add
(
di˘
 *
d
, *
key
, *
vÆ
);

154 
di˘E¡ry
 *
di˘AddRaw
(
di˘
 *
d
, *
key
, di˘E¡ry **
exi°ög
);

155 
di˘E¡ry
 *
di˘AddOrFöd
(
di˘
 *
d
, *
key
);

156 
di˘Rïœ˚
(
di˘
 *
d
, *
key
, *
vÆ
);

157 
di˘Dñëe
(
di˘
 *
d
, c⁄° *
key
);

158 
di˘E¡ry
 *
di˘U∆ök
(
di˘
 *
ht
, c⁄° *
key
);

159 
di˘FªeU∆ökedE¡ry
(
di˘
 *
d
, 
di˘E¡ry
 *
he
);

160 
di˘Rñó£
(
di˘
 *
d
);

161 
di˘E¡ry
 * 
di˘Föd
(
di˘
 *
d
, c⁄° *
key
);

162 *
di˘FëchVÆue
(
di˘
 *
d
, c⁄° *
key
);

163 
di˘Resize
(
di˘
 *
d
);

164 
di˘Iãøt‹
 *
di˘GëIãøt‹
(
di˘
 *
d
);

165 
di˘Iãøt‹
 *
di˘GëSa„Iãøt‹
(
di˘
 *
d
);

166 
di˘E¡ry
 *
di˘Next
(
di˘Iãøt‹
 *
ôî
);

167 
di˘Rñó£Iãøt‹
(
di˘Iãøt‹
 *
ôî
);

168 
di˘E¡ry
 *
di˘GëR™domKey
(
di˘
 *
d
);

169 
di˘E¡ry
 *
di˘GëFaúR™domKey
(
di˘
 *
d
);

170 
di˘GëSomeKeys
(
di˘
 *
d
, 
di˘E¡ry
 **
des
, 
cou¡
);

171 
di˘GëSèts
(*
buf
, 
size_t
 
bufsize
, 
di˘
 *
d
);

172 
uöt64_t
 
di˘GíHashFun˘i⁄
(c⁄° *
key
, 
Àn
);

173 
uöt64_t
 
di˘GíCa£HashFun˘i⁄
(c⁄° *
buf
, 
Àn
);

174 
di˘Em±y
(
di˘
 *
d
, (
ˇŒback
)(*));

175 
	`di˘E«bÀResize
();

176 
	`di˘DißbÀResize
();

177 
	`di˘Rehash
(
di˘
 *
d
, 
n
);

178 
	`di˘RehashMûli£c⁄ds
(
di˘
 *
d
, 
ms
);

179 
	`di˘SëHashFun˘i⁄Sìd
(
uöt8_t
 *
£ed
);

180 
uöt8_t
 *
	`di˘GëHashFun˘i⁄Sìd
();

181 
	`di˘Sˇn
(
di˘
 *
d
, 
v
, 
di˘SˇnFun˘i⁄
 *
‚
, 
di˘SˇnBuckëFun˘i⁄
 *
buckë‚
, *
¥ivd©a
);

182 
uöt64_t
 
	`di˘GëHash
(
di˘
 *
d
, c⁄° *
key
);

183 
di˘E¡ry
 **
	`di˘FödE¡ryRefByPåAndHash
(
di˘
 *
d
, c⁄° *
ﬁd±r
, 
uöt64_t
 
hash
);

186 
di˘Ty≥
 
di˘Ty≥HópSåögC›yKey
;

187 
di˘Ty≥
 
di˘Ty≥HópSåögs
;

188 
di˘Ty≥
 
di˘Ty≥HópSåögC›yKeyVÆue
;

	@endianconv.c

45 
	~<°döt.h
>

49 
	$memªv16
(*
p
) {

50 *
x
 = 
p
, 
t
;

52 
t
 = 
x
[0];

53 
x
[0] = x[1];

54 
x
[1] = 
t
;

55 
	}
}

59 
	$memªv32
(*
p
) {

60 *
x
 = 
p
, 
t
;

62 
t
 = 
x
[0];

63 
x
[0] = x[3];

64 
x
[3] = 
t
;

65 
t
 = 
x
[1];

66 
x
[1] = x[2];

67 
x
[2] = 
t
;

68 
	}
}

72 
	$memªv64
(*
p
) {

73 *
x
 = 
p
, 
t
;

75 
t
 = 
x
[0];

76 
x
[0] = x[7];

77 
x
[7] = 
t
;

78 
t
 = 
x
[1];

79 
x
[1] = x[6];

80 
x
[6] = 
t
;

81 
t
 = 
x
[2];

82 
x
[2] = x[5];

83 
x
[5] = 
t
;

84 
t
 = 
x
[3];

85 
x
[3] = x[4];

86 
x
[4] = 
t
;

87 
	}
}

89 
uöt16_t
 
	$öåev16
(
uöt16_t
 
v
) {

90 
	`memªv16
(&
v
);

91  
v
;

92 
	}
}

94 
uöt32_t
 
	$öåev32
(
uöt32_t
 
v
) {

95 
	`memªv32
(&
v
);

96  
v
;

97 
	}
}

99 
uöt64_t
 
	$öåev64
(
uöt64_t
 
v
) {

100 
	`memªv64
(&
v
);

101  
v
;

102 
	}
}

104 #ifde‡
REDIS_TEST


105 
	~<°dio.h
>

107 
	#UNUSED
(
x
Ë()(x)

	)

108 
	$ídünc⁄vTe°
(
¨gc
, *
¨gv
[]) {

109 
buf
[32];

111 
	`UNUSED
(
¨gc
);

112 
	`UNUSED
(
¨gv
);

114 
	`•rötf
(
buf
,"ciaoroma");

115 
	`memªv16
(
buf
);

116 
	`¥ötf
("%s\n", 
buf
);

118 
	`•rötf
(
buf
,"ciaoroma");

119 
	`memªv32
(
buf
);

120 
	`¥ötf
("%s\n", 
buf
);

122 
	`•rötf
(
buf
,"ciaoroma");

123 
	`memªv64
(
buf
);

124 
	`¥ötf
("%s\n", 
buf
);

127 
	}
}

	@endianconv.h

33 #i‚de‡
__ENDIANCONV_H


34 
	#__ENDIANCONV_H


	)

36 
	~"c⁄fig.h
"

37 
	~<°döt.h
>

39 
memªv16
(*
p
);

40 
memªv32
(*
p
);

41 
memªv64
(*
p
);

42 
uöt16_t
 
öåev16
(uöt16_à
v
);

43 
uöt32_t
 
öåev32
(uöt32_à
v
);

44 
uöt64_t
 
öåev64
(uöt64_à
v
);

48 #i‡(
BYTE_ORDER
 =
LITTLE_ENDIAN
)

49 
	#memªv16ifbe
(
p
Ë(()(0))

	)

50 
	#memªv32ifbe
(
p
Ë(()(0))

	)

51 
	#memªv64ifbe
(
p
Ë(()(0))

	)

52 
	#öåev16ifbe
(
v
Ë(v)

	)

53 
	#öåev32ifbe
(
v
Ë(v)

	)

54 
	#öåev64ifbe
(
v
Ë(v)

	)

56 
	#memªv16ifbe
(
p
Ë
	`memªv16
’)

	)

57 
	#memªv32ifbe
(
p
Ë
	`memªv32
’)

	)

58 
	#memªv64ifbe
(
p
Ë
	`memªv64
’)

	)

59 
	#öåev16ifbe
(
v
Ë
	`öåev16
(v)

	)

60 
	#öåev32ifbe
(
v
Ë
	`öåev32
(v)

	)

61 
	#öåev64ifbe
(
v
Ë
	`öåev64
(v)

	)

66 #i‡(
BYTE_ORDER
 =
BIG_ENDIAN
)

67 
	#ht⁄u64
(
v
Ë(v)

	)

68 
	#¡ohu64
(
v
Ë(v)

	)

70 
	#ht⁄u64
(
v
Ë
	`öåev64
(v)

	)

71 
	#¡ohu64
(
v
Ë
	`öåev64
(v)

	)

74 #ifde‡
REDIS_TEST


75 
ídünc⁄vTe°
(
¨gc
, *
¨gv
[]);

	@evict.c

33 
	~"£rvî.h
"

34 
	~"bio.h
"

35 
	~"©omicv¨.h
"

52 
	#EVPOOL_SIZE
 16

	)

53 
	#EVPOOL_CACHED_SDS_SIZE
 255

	)

54 
	sevi˘i⁄PoﬁE¡ry
 {

55 
	midÀ
;

56 
sds
 
	mkey
;

57 
sds
 
	mˇched
;

58 
	mdbid
;

61 
evi˘i⁄PoﬁE¡ry
 *
	gEvi˘i⁄PoﬁLRU
;

70 
	$gëLRUClock
() {

71  (
	`m°ime
()/
LRU_CLOCK_RESOLUTION
Ë& 
LRU_CLOCK_MAX
;

72 
	}
}

78 
	$LRU_CLOCK
() {

79 
Ãu˛ock
;

80 i‡(1000/
£rvî
.
hz
 <
LRU_CLOCK_RESOLUTION
) {

81 
Ãu˛ock
 = 
£rvî
.lruclock;

83 
Ãu˛ock
 = 
	`gëLRUClock
();

85  
Ãu˛ock
;

86 
	}
}

90 
	$e°im©eObje˘IdÀTime
(
robj
 *
o
) {

91 
Ãu˛ock
 = 
	`LRU_CLOCK
();

92 i‡(
Ãu˛ock
 >
o
->
Ãu
) {

93  (
Ãu˛ock
 - 
o
->
Ãu
Ë* 
LRU_CLOCK_RESOLUTION
;

95  (
Ãu˛ock
 + (
LRU_CLOCK_MAX
 - 
o
->
Ãu
)) *

96 
LRU_CLOCK_RESOLUTION
;

98 
	}
}

139 
	$evi˘i⁄PoﬁAŒoc
() {

140 
evi˘i⁄PoﬁE¡ry
 *
ï
;

141 
j
;

143 
ï
 = 
	`zmÆloc
((*ï)*
EVPOOL_SIZE
);

144 
j
 = 0; j < 
EVPOOL_SIZE
; j++) {

145 
ï
[
j
].
idÀ
 = 0;

146 
ï
[
j
].
key
 = 
NULL
;

147 
ï
[
j
].
ˇched
 = 
	`sd¢ewÀn
(
NULL
,
EVPOOL_CACHED_SDS_SIZE
);

148 
ï
[
j
].
dbid
 = 0;

150 
Evi˘i⁄PoﬁLRU
 = 
ï
;

151 
	}
}

162 
	$evi˘i⁄PoﬁP›uœã
(
dbid
, 
di˘
 *
ßm∂edi˘
, di˘ *
keydi˘
, 
evi˘i⁄PoﬁE¡ry
 *
poﬁ
) {

163 
j
, 
k
, 
cou¡
;

164 
di˘E¡ry
 *
ßm∂es
[
£rvî
.
maxmem‹y_ßm∂es
];

166 
cou¡
 = 
	`di˘GëSomeKeys
(
ßm∂edi˘
,
ßm∂es
,
£rvî
.
maxmem‹y_ßm∂es
);

167 
j
 = 0; j < 
cou¡
; j++) {

168 
idÀ
;

169 
sds
 
key
;

170 
robj
 *
o
;

171 
di˘E¡ry
 *
de
;

173 
de
 = 
ßm∂es
[
j
];

174 
key
 = 
	`di˘GëKey
(
de
);

179 i‡(
£rvî
.
maxmem‹y_pﬁicy
 !
MAXMEMORY_VOLATILE_TTL
) {

180 i‡(
ßm∂edi˘
 !
keydi˘
Ë
de
 = 
	`di˘Föd
(keydi˘, 
key
);

181 
o
 = 
	`di˘GëVÆ
(
de
);

187 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LRU
) {

188 
idÀ
 = 
	`e°im©eObje˘IdÀTime
(
o
);

189 } i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
) {

197 
idÀ
 = 255-
	`LFUDe¸AndRëu∫
(
o
);

198 } i‡(
£rvî
.
maxmem‹y_pﬁicy
 =
MAXMEMORY_VOLATILE_TTL
) {

200 
idÀ
 = 
ULLONG_MAX
 - ()
	`di˘GëVÆ
(
de
);

202 
	`£rvîP™ic
("UnknownÉvictionÖolicy inÉvictionPoolPopulate()");

208 
k
 = 0;

209 
k
 < 
EVPOOL_SIZE
 &&

210 
poﬁ
[
k
].
key
 &&

211 
poﬁ
[
k
].
idÀ
 < idle) k++;

212 i‡(
k
 =0 && 
poﬁ
[
EVPOOL_SIZE
-1].
key
 !
NULL
) {

216 } i‡(
k
 < 
EVPOOL_SIZE
 && 
poﬁ
[k].
key
 =
NULL
) {

221 i‡(
poﬁ
[
EVPOOL_SIZE
-1].
key
 =
NULL
) {

226 
sds
 
ˇched
 = 
poﬁ
[
EVPOOL_SIZE
-1].cached;

227 
	`memmove
(
poﬁ
+
k
+1,pool+k,

228 (
poﬁ
[0])*(
EVPOOL_SIZE
-
k
-1));

229 
poﬁ
[
k
].
ˇched
 = cached;

232 
k
--;

235 
sds
 
ˇched
 = 
poﬁ
[0].cached;

236 i‡(
poﬁ
[0].
key
 !poﬁ[0].
ˇched
Ë
	`sds‰ì
(pool[0].key);

237 
	`memmove
(
poﬁ
,poﬁ+1,’oﬁ[0])*
k
);

238 
poﬁ
[
k
].
ˇched
 = cached;

246 
kÀn
 = 
	`sd¶í
(
key
);

247 i‡(
kÀn
 > 
EVPOOL_CACHED_SDS_SIZE
) {

248 
poﬁ
[
k
].
key
 = 
	`sdsdup
(key);

250 
	`mem˝y
(
poﬁ
[
k
].
ˇched
,
key
,
kÀn
+1);

251 
	`sds£éí
(
poﬁ
[
k
].
ˇched
,
kÀn
);

252 
poﬁ
[
k
].
key
 =Öoﬁ[k].
ˇched
;

254 
poﬁ
[
k
].
idÀ
 = idle;

255 
poﬁ
[
k
].
dbid
 = dbid;

257 
	}
}

299 
	$LFUGëTimeInMöuãs
() {

300  (
£rvî
.
unixtime
/60) & 65535;

301 
	}
}

307 
	$LFUTimeEœp£d
(
ldt
) {

308 
now
 = 
	`LFUGëTimeInMöuãs
();

309 i‡(
now
 >
ldt
) Çow-ldt;

310  65535-
ldt
+
now
;

311 
	}
}

315 
uöt8_t
 
	$LFULogIn¸
(
uöt8_t
 
cou¡î
) {

316 i‡(
cou¡î
 == 255)  255;

317 
r
 = ()
	`ønd
()/
RAND_MAX
;

318 
ba£vÆ
 = 
cou¡î
 - 
LFU_INIT_VAL
;

319 i‡(
ba£vÆ
 < 0) baseval = 0;

320 
p
 = 1.0/(
ba£vÆ
*
£rvî
.
lfu_log_Á˘‹
+1);

321 i‡(
r
 < 
p
Ë
cou¡î
++;

322  
cou¡î
;

323 
	}
}

335 
	$LFUDe¸AndRëu∫
(
robj
 *
o
) {

336 
ldt
 = 
o
->
Ãu
 >> 8;

337 
cou¡î
 = 
o
->
Ãu
 & 255;

338 
num_≥riods
 = 
£rvî
.
lfu_deˇy_time
 ? 
	`LFUTimeEœp£d
(
ldt
) / server.lfu_decay_time : 0;

339 i‡(
num_≥riods
)

340 
cou¡î
 = (
num_≥riods
 > counter) ? 0 : counter -Çum_periods;

341  
cou¡î
;

342 
	}
}

352 
size_t
 
	$‰ìMem‹yGëNŸCou¡edMem‹y
() {

353 
size_t
 
ovîhód
 = 0;

354 
¶aves
 = 
	`li°Lígth
(
£rvî
.slaves);

356 i‡(
¶aves
) {

357 
li°Iãr
 
li
;

358 
li°Node
 *
 
;

360 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

361 (
 
 = 
	`li°Next
(&
li
))) {

362 
˛õ¡
 *
¶ave
 = 
	`li°NodeVÆue
(
 
);

363 
ovîhód
 +
	`gëClõ¡OuçutBuf„rMem‹yUßge
(
¶ave
);

366 i‡(
£rvî
.
aof_°©e
 !
AOF_OFF
) {

367 
ovîhód
 +
	`sdßŒoc
(
£rvî
.
aof_buf
)+
	`aofRewrôeBuf„rSize
();

369  
ovîhód
;

370 
	}
}

396 
	$gëMaxmem‹ySèã
(
size_t
 *
tŸÆ
, size_à*
logiˇl
, size_à*
to‰ì
, *
Àvñ
) {

397 
size_t
 
mem_ªp‹ãd
, 
mem_u£d
, 
mem_to‰ì
;

401 
mem_ªp‹ãd
 = 
	`zmÆloc_u£d_mem‹y
();

402 i‡(
tŸÆ
Ë*tŸÆ = 
mem_ªp‹ãd
;

405 
ªtu∫_ok_aßp
 = !
£rvî
.
maxmem‹y
 || 
mem_ªp‹ãd
 <= server.maxmemory;

406 i‡(
ªtu∫_ok_aßp
 && !
Àvñ
Ë 
C_OK
;

410 
mem_u£d
 = 
mem_ªp‹ãd
;

411 
size_t
 
ovîhód
 = 
	`‰ìMem‹yGëNŸCou¡edMem‹y
();

412 
mem_u£d
 = (mem_u£d > 
ovîhód
) ? mem_used-overhead : 0;

415 i‡(
Àvñ
) {

416 i‡(!
£rvî
.
maxmem‹y
) {

417 *
Àvñ
 = 0;

419 *
Àvñ
 = ()
mem_u£d
 / ()
£rvî
.
maxmem‹y
;

423 i‡(
ªtu∫_ok_aßp
Ë 
C_OK
;

426 i‡(
mem_u£d
 <
£rvî
.
maxmem‹y
Ë 
C_OK
;

429 
mem_to‰ì
 = 
mem_u£d
 - 
£rvî
.
maxmem‹y
;

431 i‡(
logiˇl
Ë*logiˇ»
mem_u£d
;

432 i‡(
to‰ì
Ë*to‰ì = 
mem_to‰ì
;

434  
C_ERR
;

435 
	}
}

446 
	$‰ìMem‹yIfNìded
() {

447 
keys_‰ìd
 = 0;

450 i‡(
£rvî
.
ma°îho°
 && sîvî.
ª∂_¶ave_ign‹e_maxmem‹y
Ë 
C_OK
;

452 
size_t
 
mem_ªp‹ãd
, 
mem_to‰ì
, 
mem_‰ìd
;

453 
m°ime_t
 
œãncy
, 
evi˘i⁄_œãncy
, 
œzy‰ì_œãncy
;

454 
dñè
;

455 
¶aves
 = 
	`li°Lígth
(
£rvî
.slaves);

456 
ªsu…
 = 
C_ERR
;

461 i‡(
	`˛õ¡sAªPau£d
()Ë 
C_OK
;

462 i‡(
	`gëMaxmem‹ySèã
(&
mem_ªp‹ãd
,
NULL
,&
mem_to‰ì
,NULLË=
C_OK
)

463  
C_OK
;

465 
mem_‰ìd
 = 0;

467 
	`œãncySèπM⁄ô‹
(
œãncy
);

468 i‡(
£rvî
.
maxmem‹y_pﬁicy
 =
MAXMEMORY_NO_EVICTION
)

469 
ˇ¡_‰ì
;

471 
mem_‰ìd
 < 
mem_to‰ì
) {

472 
j
, 
k
, 
i
;

473 
√xt_db
 = 0;

474 
sds
 
be°key
 = 
NULL
;

475 
be°dbid
;

476 
ªdisDb
 *
db
;

477 
di˘
 *dict;

478 
di˘E¡ry
 *
de
;

480 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & (
MAXMEMORY_FLAG_LRU
|
MAXMEMORY_FLAG_LFU
) ||

481 
£rvî
.
maxmem‹y_pﬁicy
 =
MAXMEMORY_VOLATILE_TTL
)

483 
evi˘i⁄PoﬁE¡ry
 *
poﬁ
 = 
Evi˘i⁄PoﬁLRU
;

485 
be°key
 =
NULL
) {

486 
tŸÆ_keys
 = 0, 
keys
;

491 
i
 = 0; i < 
£rvî
.
dbnum
; i++) {

492 
db
 = 
£rvî
.db+
i
;

493 
di˘
 = (
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_ALLKEYS
) ?

494 
db
->
di˘
 : db->
expúes
;

495 i‡((
keys
 = 
	`di˘Size
(
di˘
)) != 0) {

496 
	`evi˘i⁄PoﬁP›uœã
(
i
, 
di˘
, 
db
->di˘, 
poﬁ
);

497 
tŸÆ_keys
 +
keys
;

500 i‡(!
tŸÆ_keys
) ;

503 
k
 = 
EVPOOL_SIZE
-1; k >= 0; k--) {

504 i‡(
poﬁ
[
k
].
key
 =
NULL
) ;

505 
be°dbid
 = 
poﬁ
[
k
].
dbid
;

507 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_ALLKEYS
) {

508 
de
 = 
	`di˘Föd
(
£rvî
.
db
[
poﬁ
[
k
].
dbid
].
di˘
,

509 
poﬁ
[
k
].
key
);

511 
de
 = 
	`di˘Föd
(
£rvî
.
db
[
poﬁ
[
k
].
dbid
].
expúes
,

512 
poﬁ
[
k
].
key
);

516 i‡(
poﬁ
[
k
].
key
 !poﬁ[k].
ˇched
)

517 
	`sds‰ì
(
poﬁ
[
k
].
key
);

518 
poﬁ
[
k
].
key
 = 
NULL
;

519 
poﬁ
[
k
].
idÀ
 = 0;

523 i‡(
de
) {

524 
be°key
 = 
	`di˘GëKey
(
de
);

534 i‡(
£rvî
.
maxmem‹y_pﬁicy
 =
MAXMEMORY_ALLKEYS_RANDOM
 ||

535 
£rvî
.
maxmem‹y_pﬁicy
 =
MAXMEMORY_VOLATILE_RANDOM
)

540 
i
 = 0; i < 
£rvî
.
dbnum
; i++) {

541 
j
 = (++
√xt_db
Ë% 
£rvî
.
dbnum
;

542 
db
 = 
£rvî
.db+
j
;

543 
di˘
 = (
£rvî
.
maxmem‹y_pﬁicy
 =
MAXMEMORY_ALLKEYS_RANDOM
) ?

544 
db
->
di˘
 : db->
expúes
;

545 i‡(
	`di˘Size
(
di˘
) != 0) {

546 
de
 = 
	`di˘GëR™domKey
(
di˘
);

547 
be°key
 = 
	`di˘GëKey
(
de
);

548 
be°dbid
 = 
j
;

555 i‡(
be°key
) {

556 
db
 = 
£rvî
.db+
be°dbid
;

557 
robj
 *
keyobj
 = 
	`¸óãSåögObje˘
(
be°key
,
	`sd¶í
(bestkey));

558 
	`¥›ag©eExpúe
(
db
,
keyobj
,
£rvî
.
œzy‰ì_œzy_evi˘i⁄
);

567 
dñè
 = (Ë
	`zmÆloc_u£d_mem‹y
();

568 
	`œãncySèπM⁄ô‹
(
evi˘i⁄_œãncy
);

569 i‡(
£rvî
.
œzy‰ì_œzy_evi˘i⁄
)

570 
	`dbAsyncDñëe
(
db
,
keyobj
);

572 
	`dbSyncDñëe
(
db
,
keyobj
);

573 
	`sig«lModifõdKey
(
NULL
,
db
,
keyobj
);

574 
	`œãncyEndM⁄ô‹
(
evi˘i⁄_œãncy
);

575 
	`œãncyAddSam∂eIfNìded
("evi˘i⁄-dñ",
evi˘i⁄_œãncy
);

576 
dñè
 -(Ë
	`zmÆloc_u£d_mem‹y
();

577 
mem_‰ìd
 +
dñè
;

578 
£rvî
.
°©_evi˘edkeys
++;

579 
	`nŸifyKey•a˚Evít
(
NOTIFY_EVICTED
, "evicted",

580 
keyobj
, 
db
->
id
);

581 
	`de¸RefCou¡
(
keyobj
);

582 
keys_‰ìd
++;

588 i‡(
¶aves
Ë
	`ÊushSœvesOuçutBuf„rs
();

597 i‡(
£rvî
.
œzy‰ì_œzy_evi˘i⁄
 && !(
keys_‰ìd
 % 16)) {

598 i‡(
	`gëMaxmem‹ySèã
(
NULL
,NULL,NULL,NULLË=
C_OK
) {

600 
mem_‰ìd
 = 
mem_to‰ì
;

604 
ˇ¡_‰ì
;

607 
ªsu…
 = 
C_OK
;

609 
ˇ¡_‰ì
:

613 i‡(
ªsu…
 !
C_OK
) {

614 
	`œãncySèπM⁄ô‹
(
œzy‰ì_œãncy
);

615 
	`bioPídögJobsOfTy≥
(
BIO_LAZY_FREE
)) {

616 i‡(
	`gëMaxmem‹ySèã
(
NULL
,NULL,NULL,NULLË=
C_OK
) {

617 
ªsu…
 = 
C_OK
;

620 
	`u¶ìp
(1000);

622 
	`œãncyEndM⁄ô‹
(
œzy‰ì_œãncy
);

623 
	`œãncyAddSam∂eIfNìded
("evi˘i⁄-œzy‰ì",
œzy‰ì_œãncy
);

625 
	`œãncyEndM⁄ô‹
(
œãncy
);

626 
	`œãncyAddSam∂eIfNìded
("evi˘i⁄-cy˛e",
œãncy
);

627  
ªsu…
;

628 
	}
}

637 
	$‰ìMem‹yIfNìdedAndSa„
() {

638 i‡(
£rvî
.
lua_timedout
 || sîvî.
lﬂdög
Ë 
C_OK
;

639  
	`‰ìMem‹yIfNìded
();

640 
	}
}

	@expire.c

33 
	~"£rvî.h
"

54 
	$a˘iveExpúeCy˛eTryExpúe
(
ªdisDb
 *
db
, 
di˘E¡ry
 *
de
, 
now
) {

55 
t
 = 
	`di˘GëSig√dI¡egîVÆ
(
de
);

56 i‡(
now
 > 
t
) {

57 
sds
 
key
 = 
	`di˘GëKey
(
de
);

58 
robj
 *
keyobj
 = 
	`¸óãSåögObje˘
(
key
,
	`sd¶í
(key));

60 
	`¥›ag©eExpúe
(
db
,
keyobj
,
£rvî
.
œzy‰ì_œzy_expúe
);

61 i‡(
£rvî
.
œzy‰ì_œzy_expúe
)

62 
	`dbAsyncDñëe
(
db
,
keyobj
);

64 
	`dbSyncDñëe
(
db
,
keyobj
);

65 
	`nŸifyKey•a˚Evít
(
NOTIFY_EXPIRED
,

66 "expúed",
keyobj
,
db
->
id
);

67 
	`åackögInvÆid©eKey
(
NULL
,
keyobj
);

68 
	`de¸RefCou¡
(
keyobj
);

69 
£rvî
.
°©_expúedkeys
++;

74 
	}
}

117 
	#ACTIVE_EXPIRE_CYCLE_KEYS_PER_LOOP
 20

	)

118 
	#ACTIVE_EXPIRE_CYCLE_FAST_DURATION
 1000

	)

119 
	#ACTIVE_EXPIRE_CYCLE_SLOW_TIME_PERC
 25

	)

120 
	#ACTIVE_EXPIRE_CYCLE_ACCEPTABLE_STALE
 10

	)

123 
	$a˘iveExpúeCy˛e
(
ty≥
) {

128 
eff‹t
 = 
£rvî
.
a˘ive_expúe_eff‹t
-1,

129 
c⁄fig_keys_≥r_lo›
 = 
ACTIVE_EXPIRE_CYCLE_KEYS_PER_LOOP
 +

130 
ACTIVE_EXPIRE_CYCLE_KEYS_PER_LOOP
/4*
eff‹t
,

131 
c⁄fig_cy˛e_Á°_duøti⁄
 = 
ACTIVE_EXPIRE_CYCLE_FAST_DURATION
 +

132 
ACTIVE_EXPIRE_CYCLE_FAST_DURATION
/4*
eff‹t
,

133 
c⁄fig_cy˛e_¶ow_time_≥rc
 = 
ACTIVE_EXPIRE_CYCLE_SLOW_TIME_PERC
 +

134 2*
eff‹t
,

135 
c⁄fig_cy˛e_ac˚±abÀ_°Æe
 = 
ACTIVE_EXPIRE_CYCLE_ACCEPTABLE_STALE
-

136 
eff‹t
;

140 
cuºít_db
 = 0;

141 
timñimô_exô
 = 0;

142 
œ°_Á°_cy˛e
 = 0;

144 
j
, 
ôî©i⁄
 = 0;

145 
dbs_≥r_ˇŒ
 = 
CRON_DBS_PER_CALL
;

146 
°¨t
 = 
	`u°ime
(), 
timñimô
, 
ñ≠£d
;

151 i‡(
	`˛õ¡sAªPau£d
()) ;

153 i‡(
ty≥
 =
ACTIVE_EXPIRE_CYCLE_FAST
) {

158 i‡(!
timñimô_exô
 &&

159 
£rvî
.
°©_expúed_°Æe_≥rc
 < 
c⁄fig_cy˛e_ac˚±abÀ_°Æe
)

162 i‡(
°¨t
 < 
œ°_Á°_cy˛e
 + ()
c⁄fig_cy˛e_Á°_duøti⁄
*2)

165 
œ°_Á°_cy˛e
 = 
°¨t
;

175 i‡(
dbs_≥r_ˇŒ
 > 
£rvî
.
dbnum
 || 
timñimô_exô
)

176 
dbs_≥r_ˇŒ
 = 
£rvî
.
dbnum
;

182 
timñimô
 = 
c⁄fig_cy˛e_¶ow_time_≥rc
*1000000/
£rvî
.
hz
/100;

183 
timñimô_exô
 = 0;

184 i‡(
timñimô
 <= 0)Åimelimit = 1;

186 i‡(
ty≥
 =
ACTIVE_EXPIRE_CYCLE_FAST
)

187 
timñimô
 = 
c⁄fig_cy˛e_Á°_duøti⁄
;

192 
tŸÆ_ßm∂ed
 = 0;

193 
tŸÆ_expúed
 = 0;

195 
j
 = 0; j < 
dbs_≥r_ˇŒ
 && 
timñimô_exô
 == 0; j++) {

197 
expúed
, 
ßm∂ed
;

199 
ªdisDb
 *
db
 = 
£rvî
.db+(
cuºít_db
 % sîvî.
dbnum
);

204 
cuºít_db
++;

211 
num
, 
¶Ÿs
;

212 
now
, 
âl_sum
;

213 
âl_ßm∂es
;

214 
ôî©i⁄
++;

217 i‡((
num
 = 
	`di˘Size
(
db
->
expúes
)) == 0) {

218 
db
->
avg_âl
 = 0;

221 
¶Ÿs
 = 
	`di˘SlŸs
(
db
->
expúes
);

222 
now
 = 
	`m°ime
();

227 i‡(
num
 && 
¶Ÿs
 > 
DICT_HT_INITIAL_SIZE
 &&

228 (
num
*100/
¶Ÿs
 < 1)) ;

232 
expúed
 = 0;

233 
ßm∂ed
 = 0;

234 
âl_sum
 = 0;

235 
âl_ßm∂es
 = 0;

237 i‡(
num
 > 
c⁄fig_keys_≥r_lo›
)

238 
num
 = 
c⁄fig_keys_≥r_lo›
;

250 
max_buckës
 = 
num
*20;

251 
checked_buckës
 = 0;

253 
ßm∂ed
 < 
num
 && 
checked_buckës
 < 
max_buckës
) {

254 
èbÀ
 = 0;Åable < 2;Åable++) {

255 i‡(
èbÀ
 =1 && !
	`di˘IsRehashög
(
db
->
expúes
)) ;

257 
idx
 = 
db
->
expúes_curs‹
;

258 
idx
 &
db
->
expúes
->
ht
[
èbÀ
].
sizemask
;

259 
di˘E¡ry
 *
de
 = 
db
->
expúes
->
ht
[
èbÀ
].èbÀ[
idx
];

260 
âl
;

263 
checked_buckës
++;

264 
de
) {

267 
di˘E¡ry
 *
e
 = 
de
;

268 
de
 = de->
√xt
;

270 
âl
 = 
	`di˘GëSig√dI¡egîVÆ
(
e
)-
now
;

271 i‡(
	`a˘iveExpúeCy˛eTryExpúe
(
db
,
e
,
now
)Ë
expúed
++;

272 i‡(
âl
 > 0) {

275 
âl_sum
 +
âl
;

276 
âl_ßm∂es
++;

278 
ßm∂ed
++;

281 
db
->
expúes_curs‹
++;

283 
tŸÆ_expúed
 +
expúed
;

284 
tŸÆ_ßm∂ed
 +
ßm∂ed
;

287 i‡(
âl_ßm∂es
) {

288 
avg_âl
 = 
âl_sum
/
âl_ßm∂es
;

293 i‡(
db
->
avg_âl
 == 0) db->avg_ttl =ávg_ttl;

294 
db
->
avg_âl
 = (db->avg_ttl/50)*49 + (avg_ttl/50);

300 i‡((
ôî©i⁄
 & 0xf) == 0) {

301 
ñ≠£d
 = 
	`u°ime
()-
°¨t
;

302 i‡(
ñ≠£d
 > 
timñimô
) {

303 
timñimô_exô
 = 1;

304 
£rvî
.
°©_expúed_time_ˇp_ªached_cou¡
++;

311 } 
ßm∂ed
 == 0 ||

312 (
expúed
*100/
ßm∂ed
Ë> 
c⁄fig_cy˛e_ac˚±abÀ_°Æe
);

315 
ñ≠£d
 = 
	`u°ime
()-
°¨t
;

316 
£rvî
.
°©_expúe_cy˛e_time_u£d
 +
ñ≠£d
;

317 
	`œãncyAddSam∂eIfNìded
("expúe-cy˛e",
ñ≠£d
/1000);

321 
cuºít_≥rc
;

322 i‡(
tŸÆ_ßm∂ed
) {

323 
cuºít_≥rc
 = ()
tŸÆ_expúed
/
tŸÆ_ßm∂ed
;

325 
cuºít_≥rc
 = 0;

326 
£rvî
.
°©_expúed_°Æe_≥rc
 = (
cuºít_≥rc
*0.05)+

327 (
£rvî
.
°©_expúed_°Æe_≥rc
*0.95);

328 
	}
}

365 
di˘
 *
	g¶aveKeysWôhExpúe
 = 
NULL
;

369 
	$expúeSœveKeys
() {

370 i‡(
¶aveKeysWôhExpúe
 =
NULL
 ||

371 
	`di˘Size
(
¶aveKeysWôhExpúe
) == 0) ;

373 
cy˛es
 = 0, 
n€xpúe
 = 0;

374 
m°ime_t
 
°¨t
 = 
	`m°ime
();

376 
di˘E¡ry
 *
de
 = 
	`di˘GëR™domKey
(
¶aveKeysWôhExpúe
);

377 
sds
 
key«me
 = 
	`di˘GëKey
(
de
);

378 
uöt64_t
 
dbids
 = 
	`di˘GëUnsig√dI¡egîVÆ
(
de
);

379 
uöt64_t
 
√w_dbids
 = 0;

383 
dbid
 = 0;

384 
dbids
 && 
dbid
 < 
£rvî
.
dbnum
) {

385 i‡((
dbids
 & 1) != 0) {

386 
ªdisDb
 *
db
 = 
£rvî
.db+
dbid
;

387 
di˘E¡ry
 *
expúe
 = 
	`di˘Föd
(
db
->
expúes
,
key«me
);

388 
expúed
 = 0;

390 i‡(
expúe
 &&

391 
	`a˘iveExpúeCy˛eTryExpúe
(
£rvî
.
db
+
dbid
,
expúe
,
°¨t
))

393 
expúed
 = 1;

400 i‡(
expúe
 && !
expúed
) {

401 
n€xpúe
++;

402 
√w_dbids
 |(
uöt64_t
)1 << 
dbid
;

405 
dbid
++;

406 
dbids
 >>= 1;

412 i‡(
√w_dbids
)

413 
	`di˘SëUnsig√dI¡egîVÆ
(
de
,
√w_dbids
);

415 
	`di˘Dñëe
(
¶aveKeysWôhExpúe
,
key«me
);

419 
cy˛es
++;

420 i‡(
n€xpúe
 > 3) ;

421 i‡((
cy˛es
 % 64Ë=0 && 
	`m°ime
()-
°¨t
 > 1) ;

422 i‡(
	`di˘Size
(
¶aveKeysWôhExpúe
) == 0) ;

424 
	}
}

428 
	$ªmembîSœveKeyWôhExpúe
(
ªdisDb
 *
db
, 
robj
 *
key
) {

429 i‡(
¶aveKeysWôhExpúe
 =
NULL
) {

430 
di˘Ty≥
 
dt
 = {

431 
di˘SdsHash
,

432 
NULL
,

433 
NULL
,

434 
di˘SdsKeyCom∑ª
,

435 
di˘SdsDe°ru˘‹
,

436 
NULL


438 
¶aveKeysWôhExpúe
 = 
	`di˘Cª©e
(&
dt
,
NULL
);

440 i‡(
db
->
id
 > 63) ;

442 
di˘E¡ry
 *
de
 = 
	`di˘AddOrFöd
(
¶aveKeysWôhExpúe
,
key
->
±r
);

447 i‡(
de
->
key
 =key->
±r
) {

448 
de
->
key
 = 
	`sdsdup
(key->
±r
);

449 
	`di˘SëUnsig√dI¡egîVÆ
(
de
,0);

452 
uöt64_t
 
dbids
 = 
	`di˘GëUnsig√dI¡egîVÆ
(
de
);

453 
dbids
 |(
uöt64_t
)1 << 
db
->
id
;

454 
	`di˘SëUnsig√dI¡egîVÆ
(
de
,
dbids
);

455 
	}
}

458 
size_t
 
	$gëSœveKeyWôhExpúeCou¡
() {

459 i‡(
¶aveKeysWôhExpúe
 =
NULL
)  0;

460  
	`di˘Size
(
¶aveKeysWôhExpúe
);

461 
	}
}

471 
	$ÊushSœveKeysWôhExpúeLi°
() {

472 i‡(
¶aveKeysWôhExpúe
) {

473 
	`di˘Rñó£
(
¶aveKeysWôhExpúe
);

474 
¶aveKeysWôhExpúe
 = 
NULL
;

476 
	}
}

489 
	$expúeGíîicComm™d
(
˛õ¡
 *
c
, 
ba£time
, 
unô
) {

490 
robj
 *
key
 = 
c
->
¨gv
[1], *
∑øm
 = c->argv[2];

491 
whí
;

493 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
, 
∑øm
, &
whí
, 
NULL
Ë!
C_OK
)

496 i‡(
unô
 =
UNIT_SECONDS
Ë
whí
 *= 1000;

497 
whí
 +
ba£time
;

500 i‡(
	`lookupKeyWrôe
(
c
->
db
,
key
Ë=
NULL
) {

501 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

511 i‡(
whí
 <
	`m°ime
(Ë&& !
£rvî
.
lﬂdög
 && !£rvî.
ma°îho°
) {

512 
robj
 *
aux
;

514 
dñëed
 = 
£rvî
.
œzy‰ì_œzy_expúe
 ? 
	`dbAsyncDñëe
(
c
->
db
,
key
) :

515 
	`dbSyncDñëe
(
c
->
db
,
key
);

516 
	`£rvîAs£πWôhInfo
(
c
,
key
,
dñëed
);

517 
£rvî
.
dúty
++;

520 
aux
 = 
£rvî
.
œzy‰ì_œzy_expúe
 ? 
sh¨ed
.
u∆ök
 : sh¨ed.
dñ
;

521 
	`ªwrôeClõ¡Comm™dVe˘‹
(
c
,2,
aux
,
key
);

522 
	`sig«lModifõdKey
(
c
,c->
db
,
key
);

523 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
key
,
c
->
db
->
id
);

524 
	`addRïly
(
c
, 
sh¨ed
.
c⁄e
);

527 
	`£tExpúe
(
c
,c->
db
,
key
,
whí
);

528 
	`addRïly
(
c
,
sh¨ed
.
c⁄e
);

529 
	`sig«lModifõdKey
(
c
,c->
db
,
key
);

530 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"expúe",
key
,
c
->
db
->
id
);

531 
£rvî
.
dúty
++;

534 
	}
}

537 
	$expúeComm™d
(
˛õ¡
 *
c
) {

538 
	`expúeGíîicComm™d
(
c
,
	`m°ime
(),
UNIT_SECONDS
);

539 
	}
}

542 
	$expúótComm™d
(
˛õ¡
 *
c
) {

543 
	`expúeGíîicComm™d
(
c
,0,
UNIT_SECONDS
);

544 
	}
}

547 
	$≥xpúeComm™d
(
˛õ¡
 *
c
) {

548 
	`expúeGíîicComm™d
(
c
,
	`m°ime
(),
UNIT_MILLISECONDS
);

549 
	}
}

552 
	$≥xpúótComm™d
(
˛õ¡
 *
c
) {

553 
	`expúeGíîicComm™d
(
c
,0,
UNIT_MILLISECONDS
);

554 
	}
}

557 
	$âlGíîicComm™d
(
˛õ¡
 *
c
, 
ouçut_ms
) {

558 
expúe
, 
âl
 = -1;

561 i‡(
	`lookupKeyRódWôhFœgs
(
c
->
db
,c->
¨gv
[1],
LOOKUP_NOTOUCH
Ë=
NULL
) {

562 
	`addRïlyL⁄gL⁄g
(
c
,-2);

567 
expúe
 = 
	`gëExpúe
(
c
->
db
,c->
¨gv
[1]);

568 i‡(
expúe
 != -1) {

569 
âl
 = 
expúe
-
	`m°ime
();

570 i‡(
âl
 < 0)Åtl = 0;

572 i‡(
âl
 == -1) {

573 
	`addRïlyL⁄gL⁄g
(
c
,-1);

575 
	`addRïlyL⁄gL⁄g
(
c
,
ouçut_ms
 ? 
âl
 : ((ttl+500)/1000));

577 
	}
}

580 
	$âlComm™d
(
˛õ¡
 *
c
) {

581 
	`âlGíîicComm™d
(
c
, 0);

582 
	}
}

585 
	$±éComm™d
(
˛õ¡
 *
c
) {

586 
	`âlGíîicComm™d
(
c
, 1);

587 
	}
}

590 
	$≥rsi°Comm™d
(
˛õ¡
 *
c
) {

591 i‡(
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1])) {

592 i‡(
	`ªmoveExpúe
(
c
->
db
,c->
¨gv
[1])) {

593 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"≥rsi°",
c
->
¨gv
[1],c->
db
->
id
);

594 
	`addRïly
(
c
,
sh¨ed
.
c⁄e
);

595 
£rvî
.
dúty
++;

597 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

600 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

602 
	}
}

605 
	$touchComm™d
(
˛õ¡
 *
c
) {

606 
touched
 = 0;

607 
j
 = 1; j < 
c
->
¨gc
; j++)

608 i‡(
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
j
]Ë!
NULL
Ë
touched
++;

609 
	`addRïlyL⁄gL⁄g
(
c
,
touched
);

610 
	}
}

	@fmacros.h

30 #i‚de‡
_REDIS_FMACRO_H


31 
	#_REDIS_FMACRO_H


	)

33 
	#_BSD_SOURCE


	)

35 #i‡
deföed
(
__löux__
)

36 
	#_GNU_SOURCE


	)

37 
	#_DEFAULT_SOURCE


	)

40 #i‡
deföed
(
_AIX
)

41 
	#_ALL_SOURCE


	)

44 #i‡
deföed
(
__löux__
Ë|| deföed(
__O≥nBSD__
)

45 
	#_XOPEN_SOURCE
 700

	)

50 #ñi‡!
deföed
(
__NëBSD__
)

51 
	#_XOPEN_SOURCE


	)

54 #i‡
deföed
(
__sun
)

55 
	#_POSIX_C_SOURCE
 199506L

	)

58 
	#_LARGEFILE_SOURCE


	)

59 
	#_FILE_OFFSET_BITS
 64

	)

	@geo.c

31 
	~"geo.h
"

32 
	~"geohash_hñ≥r.h
"

33 
	~"debugma¸o.h
"

37 *
zzlFú°InR™ge
(*
zl
, 
zønge•ec
 *
ønge
);

38 
z¶VÆueLãMax
(
vÆue
, 
zønge•ec
 *
•ec
);

53 
geoAºay
 *
	$geoAºayCª©e
() {

54 
geoAºay
 *
ga
 = 
	`zmÆloc
((*ga));

56 
ga
->
¨øy
 = 
NULL
;

57 
ga
->
buckës
 = 0;

58 
ga
->
u£d
 = 0;

59  
ga
;

60 
	}
}

64 
geoPoöt
 *
	$geoAºayAµíd
(
geoAºay
 *
ga
) {

65 i‡(
ga
->
u£d
 =ga->
buckës
) {

66 
ga
->
buckës
 = (ga->buckets == 0) ? 8 : ga->buckets*2;

67 
ga
->
¨øy
 = 
	`zªÆloc
(ga->¨øy,(
geoPoöt
)*ga->
buckës
);

69 
geoPoöt
 *
gp
 = 
ga
->
¨øy
+ga->
u£d
;

70 
ga
->
u£d
++;

71  
gp
;

72 
	}
}

75 
	$geoAºayFªe
(
geoAºay
 *
ga
) {

76 
size_t
 
i
;

77 
i
 = 0; i < 
ga
->
u£d
; i++Ë
	`sds‰ì
(ga->
¨øy
[i].
membî
);

78 
	`z‰ì
(
ga
->
¨øy
);

79 
	`z‰ì
(
ga
);

80 
	}
}

85 
	$decodeGeohash
(
bôs
, *
xy
) {

86 
GeoHashBôs
 
hash
 = { .
bôs
 = (
uöt64_t
)bôs, .
°ï
 = 
GEO_STEP_MAX
 };

87  
	`geohashDecodeToL⁄gL©WGS84
(
hash
, 
xy
);

88 
	}
}

93 
	$exåa˘L⁄gL©OrRïly
(
˛õ¡
 *
c
, 
robj
 **
¨gv
, *
xy
) {

94 
i
;

95 
i
 = 0; i < 2; i++) {

96 i‡(
	`gëDoubÀFromObje˘OrRïly
(
c
, 
¨gv
[
i
], 
xy
 + i, 
NULL
) !=

97 
C_OK
) {

98  
C_ERR
;

101 i‡(
xy
[0] < 
GEO_LONG_MIN
 || xy[0] > 
GEO_LONG_MAX
 ||

102 
xy
[1] < 
GEO_LAT_MIN
 || xy[1] > 
GEO_LAT_MAX
) {

103 
	`addRïlySds
(
c
, 
	`sdsˇçrötf
(
	`sd£m±y
(),

104 "-ERR invÆidÜ⁄gôude,œtôudê∑ú %f,%f\r\n",
xy
[0],xy[1]));

105  
C_ERR
;

107  
C_OK
;

108 
	}
}

113 
	$l⁄gL©FromMembî
(
robj
 *
zobj
,Ñobj *
membî
, *
xy
) {

114 
sc‹e
 = 0;

116 i‡(
	`z£tSc‹e
(
zobj
, 
membî
->
±r
, &
sc‹e
Ë=
C_ERR
)  C_ERR;

117 i‡(!
	`decodeGeohash
(
sc‹e
, 
xy
)Ë 
C_ERR
;

118  
C_OK
;

119 
	}
}

127 
	$exåa˘UnôOrRïly
(
˛õ¡
 *
c
, 
robj
 *
unô
) {

128 *
u
 = 
unô
->
±r
;

130 i‡(!
	`°rcmp
(
u
, "m")) {

132 } i‡(!
	`°rcmp
(
u
, "km")) {

134 } i‡(!
	`°rcmp
(
u
, "ft")) {

136 } i‡(!
	`°rcmp
(
u
, "mi")) {

139 
	`addRïlyEº‹
(
c
,

143 
	}
}

152 
	$exåa˘Di°™˚OrRïly
(
˛õ¡
 *
c
, 
robj
 **
¨gv
,

153 *
c⁄vîsi⁄
) {

154 
di°™˚
;

155 i‡(
	`gëDoubÀFromObje˘OrRïly
(
c
, 
¨gv
[0], &
di°™˚
,

156 "√edÇumîi¯ødius"Ë!
C_OK
) {

160 i‡(
di°™˚
 < 0) {

161 
	`addRïlyEº‹
(
c
,"radius cannot beÇegative");

165 
to_mëîs
 = 
	`exåa˘UnôOrRïly
(
c
,
¨gv
[1]);

166 i‡(
to_mëîs
 < 0) {

170 i‡(
c⁄vîsi⁄
Ë*c⁄vîsi⁄ = 
to_mëîs
;

171  
di°™˚
 * 
to_mëîs
;

172 
	}
}

179 
	$addRïlyDoubÀDi°™˚
(
˛õ¡
 *
c
, 
d
) {

180 
dbuf
[128];

181 
dÀn
 = 
	`¢¥ötf
(
dbuf
, (dbuf), "%.4f", 
d
);

182 
	`addRïlyBulkCBuf„r
(
c
, 
dbuf
, 
dÀn
);

183 
	}
}

191 
	$geoAµídIfWôhöRadius
(
geoAºay
 *
ga
, 
l⁄
, 
œt
, 
ødius
, 
sc‹e
, 
sds
 
membî
) {

192 
di°™˚
, 
xy
[2];

194 i‡(!
	`decodeGeohash
(
sc‹e
,
xy
)Ë 
C_ERR
;

197 i‡(!
	`geohashGëDi°™˚IfInRadiusWGS84
(
l⁄
,
œt
, 
xy
[0], xy[1],

198 
ødius
, &
di°™˚
))

200  
C_ERR
;

204 
geoPoöt
 *
gp
 = 
	`geoAºayAµíd
(
ga
);

205 
gp
->
l⁄gôude
 = 
xy
[0];

206 
gp
->
œtôude
 = 
xy
[1];

207 
gp
->
di°
 = 
di°™˚
;

208 
gp
->
membî
 = member;

209 
gp
->
sc‹e
 = score;

210  
C_OK
;

211 
	}
}

225 
	$geoGëPoötsInR™ge
(
robj
 *
zobj
, 
mö
, 
max
, 
l⁄
, 
œt
, 
ødius
, 
geoAºay
 *
ga
) {

228 
zønge•ec
 
ønge
 = { .
mö
 = mö, .
max
 = max, .
möex
 = 0, .
maxex
 = 1 };

229 
size_t
 
‹igöcou¡
 = 
ga
->
u£d
;

230 
sds
 
membî
;

232 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

233 *
zl
 = 
zobj
->
±r
;

234 *
ïå
, *
•å
;

235 *
v°r
 = 
NULL
;

236 
vÀn
 = 0;

237 
vl⁄g
 = 0;

238 
sc‹e
 = 0;

240 i‡((
ïå
 = 
	`zzlFú°InR™ge
(
zl
, &
ønge
)Ë=
NULL
) {

245 
•å
 = 
	`zùli°Next
(
zl
, 
ïå
);

246 
ïå
) {

247 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

250 i‡(!
	`z¶VÆueLãMax
(
sc‹e
, &
ønge
))

254 
	`zùli°Gë
(
ïå
, &
v°r
, &
vÀn
, &
vl⁄g
);

255 
membî
 = (
v°r
 =
NULL
Ë? 
	`sds‰oml⁄gl⁄g
(
vl⁄g
) :

256 
	`sd¢ewÀn
(
v°r
,
vÀn
);

257 i‡(
	`geoAµídIfWôhöRadius
(
ga
,
l⁄
,
œt
,
ødius
,
sc‹e
,
membî
)

258 =
C_ERR
Ë
	`sds‰ì
(
membî
);

259 
	`zzlNext
(
zl
, &
ïå
, &
•å
);

261 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

262 
z£t
 *
zs
 = 
zobj
->
±r
;

263 
zskùli°
 *
z¶
 = 
zs
->zsl;

264 
zskùli°Node
 *
 
;

266 i‡((
 
 = 
	`z¶Fú°InR™ge
(
z¶
, &
ønge
)Ë=
NULL
) {

271 
 
) {

272 
sds
 
ñe
 = 
 
->ele;

274 i‡(!
	`z¶VÆueLãMax
(
 
->
sc‹e
, &
ønge
))

277 
ñe
 = 
	`sdsdup
(ele);

278 i‡(
	`geoAµídIfWôhöRadius
(
ga
,
l⁄
,
œt
,
ødius
,
 
->
sc‹e
,
ñe
)

279 =
C_ERR
Ë
	`sds‰ì
(
ñe
);

280 
 
 =Ün->
Àvñ
[0].
f‹w¨d
;

283  
ga
->
u£d
 - 
‹igöcou¡
;

284 
	}
}

289 
	$sc‹esOfGeoHashBox
(
GeoHashBôs
 
hash
, 
GeoHashFix52Bôs
 *
mö
, GeoHashFix52Bô†*
max
) {

310 *
mö
 = 
	`geohashAlign52Bôs
(
hash
);

311 
hash
.
bôs
++;

312 *
max
 = 
	`geohashAlign52Bôs
(
hash
);

313 
	}
}

318 
	$membîsOfGeoHashBox
(
robj
 *
zobj
, 
GeoHashBôs
 
hash
, 
geoAºay
 *
ga
, 
l⁄
, 
œt
, 
ødius
) {

319 
GeoHashFix52Bôs
 
mö
, 
max
;

321 
	`sc‹esOfGeoHashBox
(
hash
,&
mö
,&
max
);

322  
	`geoGëPoötsInR™ge
(
zobj
, 
mö
, 
max
, 
l⁄
, 
œt
, 
ødius
, 
ga
);

323 
	}
}

326 
	$membîsOfAŒNeighb‹s
(
robj
 *
zobj
, 
GeoHashRadius
 
n
, 
l⁄
, 
œt
, 
ødius
, 
geoAºay
 *
ga
) {

327 
GeoHashBôs
 
√ighb‹s
[9];

328 
i
, 
cou¡
 = 0, 
œ°_¥o˚s£d
 = 0;

329 
debugmsg
 = 0;

331 
√ighb‹s
[0] = 
n
.
hash
;

332 
√ighb‹s
[1] = 
n
.√ighb‹s.
n‹th
;

333 
√ighb‹s
[2] = 
n
.√ighb‹s.
south
;

334 
√ighb‹s
[3] = 
n
.√ighb‹s.
ó°
;

335 
√ighb‹s
[4] = 
n
.√ighb‹s.
we°
;

336 
√ighb‹s
[5] = 
n
.√ighb‹s.
n‹th_ó°
;

337 
√ighb‹s
[6] = 
n
.√ighb‹s.
n‹th_we°
;

338 
√ighb‹s
[7] = 
n
.√ighb‹s.
south_ó°
;

339 
√ighb‹s
[8] = 
n
.√ighb‹s.
south_we°
;

343 
i
 = 0; i < (
√ighb‹s
) / (*neighbors); i++) {

344 i‡(
	`HASHISZERO
(
√ighb‹s
[
i
])) {

345 i‡(
debugmsg
Ë
	`D
("√ighb‹s[%d] i†zîo",
i
);

350 i‡(
debugmsg
) {

351 
GeoHashR™ge
 
l⁄g_ønge
, 
œt_ønge
;

352 
	`geohashGëCo‹dR™ge
(&
l⁄g_ønge
,&
œt_ønge
);

353 
GeoHashAªa
 
my¨ó
 = {{0}};

354 
	`geohashDecode
(
l⁄g_ønge
, 
œt_ønge
, 
√ighb‹s
[
i
], &
my¨ó
);

357 
	`D
("√ighb‹s[%d]:\n",
i
);

358 
	`D
("¨ó.l⁄gôude.mö: %f\n", 
my¨ó
.
l⁄gôude
.
mö
);

359 
	`D
("¨ó.l⁄gôude.max: %f\n", 
my¨ó
.
l⁄gôude
.
max
);

360 
	`D
("¨ó.œtôude.mö: %f\n", 
my¨ó
.
œtôude
.
mö
);

361 
	`D
("¨ó.œtôude.max: %f\n", 
my¨ó
.
œtôude
.
max
);

362 
	`D
("\n");

369 i‡(
œ°_¥o˚s£d
 &&

370 
√ighb‹s
[
i
].
bôs
 =√ighb‹s[
œ°_¥o˚s£d
].bits &&

371 
√ighb‹s
[
i
].
°ï
 =√ighb‹s[
œ°_¥o˚s£d
].step)

373 i‡(
debugmsg
)

374 
	`D
("SkùpögÖro˚ssög o‡%d, samêa†¥evious\n",
i
);

377 
cou¡
 +
	`membîsOfGeoHashBox
(
zobj
, 
√ighb‹s
[
i
], 
ga
, 
l⁄
, 
œt
, 
ødius
);

378 
œ°_¥o˚s£d
 = 
i
;

380  
cou¡
;

381 
	}
}

384 
	$s‹t_gp_asc
(c⁄° *
a
, c⁄° *
b
) {

385 c⁄° 
geoPoöt
 *
g∑
 = 
a
, *
gpb
 = 
b
;

388 i‡(
g∑
->
di°
 > 
gpb
->dist)

390 i‡(
g∑
->
di°
 =
gpb
->dist)

394 
	}
}

396 
	$s‹t_gp_desc
(c⁄° *
a
, c⁄° *
b
) {

397  -
	`s‹t_gp_asc
(
a
, 
b
);

398 
	}
}

405 
	$geﬂddComm™d
(
˛õ¡
 *
c
) {

407 i‡((
c
->
¨gc
 - 2) % 3 != 0) {

409 
	`addRïlyEº‹
(
c
, "syntaxÉrror. Try GEOADD key [x1] [y1] [name1] "

414 
ñemíts
 = (
c
->
¨gc
 - 2) / 3;

415 
¨gc
 = 2+
ñemíts
*2;

416 
robj
 **
¨gv
 = 
	`zˇŒoc
(
¨gc
*(robj*));

417 
¨gv
[0] = 
	`¸óãRawSåögObje˘
("zadd",4);

418 
¨gv
[1] = 
c
->argv[1];

419 
	`ö¸RefCou¡
(
¨gv
[1]);

424 
i
;

425 
i
 = 0; i < 
ñemíts
; i++) {

426 
xy
[2];

428 i‡(
	`exåa˘L⁄gL©OrRïly
(
c
, (c->
¨gv
+2)+(
i
*3),
xy
Ë=
C_ERR
) {

429 
i
 = 0; i < 
¨gc
; i++)

430 i‡(
¨gv
[
i
]Ë
	`de¸RefCou¡
(argv[i]);

431 
	`z‰ì
(
¨gv
);

436 
GeoHashBôs
 
hash
;

437 
	`geohashEncodeWGS84
(
xy
[0], xy[1], 
GEO_STEP_MAX
, &
hash
);

438 
GeoHashFix52Bôs
 
bôs
 = 
	`geohashAlign52Bôs
(
hash
);

439 
robj
 *
sc‹e
 = 
	`¸óãObje˘
(
OBJ_STRING
, 
	`sds‰oml⁄gl⁄g
(
bôs
));

440 
robj
 *
vÆ
 = 
c
->
¨gv
[2 + 
i
 * 3 + 2];

441 
¨gv
[2+
i
*2] = 
sc‹e
;

442 
¨gv
[3+
i
*2] = 
vÆ
;

443 
	`ö¸RefCou¡
(
vÆ
);

447 
	`ª∂a˚Clõ¡Comm™dVe˘‹
(
c
,
¨gc
,
¨gv
);

448 
	`zaddComm™d
(
c
);

449 
	}
}

451 
	#SORT_NONE
 0

	)

452 
	#SORT_ASC
 1

	)

453 
	#SORT_DESC
 2

	)

455 
	#RADIUS_COORDS
 (1<<0Ë

	)

456 
	#RADIUS_MEMBER
 (1<<1Ë

	)

457 
	#RADIUS_NOSTORE
 (1<<2Ë

	)

462 
	$ge‹adiusGíîic
(
˛õ¡
 *
c
, 
Êags
) {

463 
robj
 *
key
 = 
c
->
¨gv
[1];

464 
robj
 *
°‹ekey
 = 
NULL
;

465 
°‹edi°
 = 0;

468 
robj
 *
zobj
 = 
NULL
;

469 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
, 
key
, 
sh¨ed
.
em±y¨øy
)Ë=
NULL
 ||

470 
	`checkTy≥
(
c
, 
zobj
, 
OBJ_ZSET
)) {

475 
ba£_¨gs
;

476 
xy
[2] = { 0 };

477 i‡(
Êags
 & 
RADIUS_COORDS
) {

478 
ba£_¨gs
 = 6;

479 i‡(
	`exåa˘L⁄gL©OrRïly
(
c
, c->
¨gv
 + 2, 
xy
Ë=
C_ERR
)

481 } i‡(
Êags
 & 
RADIUS_MEMBER
) {

482 
ba£_¨gs
 = 5;

483 
robj
 *
membî
 = 
c
->
¨gv
[2];

484 i‡(
	`l⁄gL©FromMembî
(
zobj
, 
membî
, 
xy
Ë=
C_ERR
) {

485 
	`addRïlyEº‹
(
c
, "couldÇot decodeÑequested zset member");

489 
	`addRïlyEº‹
(
c
, "Unknown georadius searchÅype");

494 
ødius_mëîs
 = 0, 
c⁄vîsi⁄
 = 1;

495 i‡((
ødius_mëîs
 = 
	`exåa˘Di°™˚OrRïly
(
c
, c->
¨gv
 + 
ba£_¨gs
 - 2,

496 &
c⁄vîsi⁄
)) < 0) {

501 
wôhdi°
 = 0, 
wôhhash
 = 0, 
wôhco‹ds
 = 0;

502 
s‹t
 = 
SORT_NONE
;

503 
cou¡
 = 0;

504 i‡(
c
->
¨gc
 > 
ba£_¨gs
) {

505 
ªmaöög
 = 
c
->
¨gc
 - 
ba£_¨gs
;

506 
i
 = 0; i < 
ªmaöög
; i++) {

507 *
¨g
 = 
c
->
¨gv
[
ba£_¨gs
 + 
i
]->
±r
;

508 i‡(!
	`°rˇ£cmp
(
¨g
, "withdist")) {

509 
wôhdi°
 = 1;

510 } i‡(!
	`°rˇ£cmp
(
¨g
, "withhash")) {

511 
wôhhash
 = 1;

512 } i‡(!
	`°rˇ£cmp
(
¨g
, "withcoord")) {

513 
wôhco‹ds
 = 1;

514 } i‡(!
	`°rˇ£cmp
(
¨g
, "asc")) {

515 
s‹t
 = 
SORT_ASC
;

516 } i‡(!
	`°rˇ£cmp
(
¨g
, "desc")) {

517 
s‹t
 = 
SORT_DESC
;

518 } i‡(!
	`°rˇ£cmp
(
¨g
, "cou¡"Ë&& (
i
+1Ë< 
ªmaöög
) {

519 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[
ba£_¨gs
+
i
+1],

520 &
cou¡
, 
NULL
Ë!
C_OK
) ;

521 i‡(
cou¡
 <= 0) {

522 
	`addRïlyEº‹
(
c
,"COUNT must be > 0");

525 
i
++;

526 } i‡(!
	`°rˇ£cmp
(
¨g
, "store") &&

527 (
i
+1Ë< 
ªmaöög
 &&

528 !(
Êags
 & 
RADIUS_NOSTORE
))

530 
°‹ekey
 = 
c
->
¨gv
[
ba£_¨gs
+
i
+1];

531 
°‹edi°
 = 0;

532 
i
++;

533 } i‡(!
	`°rˇ£cmp
(
¨g
, "storedist") &&

534 (
i
+1Ë< 
ªmaöög
 &&

535 !(
Êags
 & 
RADIUS_NOSTORE
))

537 
°‹ekey
 = 
c
->
¨gv
[
ba£_¨gs
+
i
+1];

538 
°‹edi°
 = 1;

539 
i
++;

541 
	`addRïly
(
c
, 
sh¨ed
.
sy¡axîr
);

548 i‡(
°‹ekey
 && (
wôhdi°
 || 
wôhhash
 || 
wôhco‹ds
)) {

549 
	`addRïlyEº‹
(
c
,

557 i‡(
cou¡
 !0 && 
s‹t
 =
SORT_NONE
Ës‹à
SORT_ASC
;

560 
GeoHashRadius
 
ge‹adius
 =

561 
	`geohashGëAªasByRadiusWGS84
(
xy
[0], xy[1], 
ødius_mëîs
);

564 
geoAºay
 *
ga
 = 
	`geoAºayCª©e
();

565 
	`membîsOfAŒNeighb‹s
(
zobj
, 
ge‹adius
, 
xy
[0], xy[1], 
ødius_mëîs
, 
ga
);

568 i‡(
ga
->
u£d
 =0 && 
°‹ekey
 =
NULL
) {

569 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

570 
	`geoAºayFªe
(
ga
);

574 
ªsu…_Àngth
 = 
ga
->
u£d
;

575 
ªtu∫ed_ôems
 = (
cou¡
 =0 || 
ªsu…_Àngth
 < count) ?

576 
ªsu…_Àngth
 : 
cou¡
;

577 
›ti⁄_Àngth
 = 0;

580 i‡(
s‹t
 =
SORT_ASC
) {

581 
	`qs‹t
(
ga
->
¨øy
, 
ªsu…_Àngth
, (
geoPoöt
), 
s‹t_gp_asc
);

582 } i‡(
s‹t
 =
SORT_DESC
) {

583 
	`qs‹t
(
ga
->
¨øy
, 
ªsu…_Àngth
, (
geoPoöt
), 
s‹t_gp_desc
);

586 i‡(
°‹ekey
 =
NULL
) {

591 i‡(
wôhdi°
)

592 
›ti⁄_Àngth
++;

594 i‡(
wôhco‹ds
)

595 
›ti⁄_Àngth
++;

597 i‡(
wôhhash
)

598 
›ti⁄_Àngth
++;

604 
	`addRïlyAºayLí
(
c
, 
ªtu∫ed_ôems
);

607 
i
;

608 
i
 = 0; i < 
ªtu∫ed_ôems
; i++) {

609 
geoPoöt
 *
gp
 = 
ga
->
¨øy
+
i
;

610 
gp
->
di°
 /
c⁄vîsi⁄
;

615 i‡(
›ti⁄_Àngth
)

616 
	`addRïlyAºayLí
(
c
, 
›ti⁄_Àngth
 + 1);

618 
	`addRïlyBulkSds
(
c
,
gp
->
membî
);

619 
gp
->
membî
 = 
NULL
;

621 i‡(
wôhdi°
)

622 
	`addRïlyDoubÀDi°™˚
(
c
, 
gp
->
di°
);

624 i‡(
wôhhash
)

625 
	`addRïlyL⁄gL⁄g
(
c
, 
gp
->
sc‹e
);

627 i‡(
wôhco‹ds
) {

628 
	`addRïlyAºayLí
(
c
, 2);

629 
	`addRïlyHum™L⁄gDoubÀ
(
c
, 
gp
->
l⁄gôude
);

630 
	`addRïlyHum™L⁄gDoubÀ
(
c
, 
gp
->
œtôude
);

635 
robj
 *
zobj
;

636 
z£t
 *
zs
;

637 
i
;

638 
size_t
 
maxññí
 = 0;

640 i‡(
ªtu∫ed_ôems
) {

641 
zobj
 = 
	`¸óãZ£tObje˘
();

642 
zs
 = 
zobj
->
±r
;

645 
i
 = 0; i < 
ªtu∫ed_ôems
; i++) {

646 
zskùli°Node
 *
znode
;

647 
geoPoöt
 *
gp
 = 
ga
->
¨øy
+
i
;

648 
gp
->
di°
 /
c⁄vîsi⁄
;

649 
sc‹e
 = 
°‹edi°
 ? 
gp
->
di°
 : gp->score;

650 
size_t
 
ññí
 = 
	`sd¶í
(
gp
->
membî
);

652 i‡(
maxññí
 < 
ññí
) maxelelen =Élelen;

653 
znode
 = 
	`z¶In£π
(
zs
->
z¶
,
sc‹e
,
gp
->
membî
);

654 
	`£rvîAs£π
(
	`di˘Add
(
zs
->
di˘
,
gp
->
membî
,&
znode
->
sc‹e
Ë=
DICT_OK
);

655 
gp
->
membî
 = 
NULL
;

658 i‡(
ªtu∫ed_ôems
) {

659 
	`z£tC⁄vîtToZùli°IfNìded
(
zobj
,
maxññí
);

660 
	`£tKey
(
c
,c->
db
,
°‹ekey
,
zobj
);

661 
	`de¸RefCou¡
(
zobj
);

662 
	`nŸifyKey•a˚Evít
(
NOTIFY_ZSET
,"ge‹adius°‹e",
°‹ekey
,

663 
c
->
db
->
id
);

664 
£rvî
.
dúty
 +
ªtu∫ed_ôems
;

665 } i‡(
	`dbDñëe
(
c
->
db
,
°‹ekey
)) {

666 
	`sig«lModifõdKey
(
c
,c->
db
,
°‹ekey
);

667 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
°‹ekey
,
c
->
db
->
id
);

668 
£rvî
.
dúty
++;

670 
	`addRïlyL⁄gL⁄g
(
c
, 
ªtu∫ed_ôems
);

672 
	`geoAºayFªe
(
ga
);

673 
	}
}

676 
	$ge‹adiusComm™d
(
˛õ¡
 *
c
) {

677 
	`ge‹adiusGíîic
(
c
, 
RADIUS_COORDS
);

678 
	}
}

681 
	$ge‹adiusbymembîComm™d
(
˛õ¡
 *
c
) {

682 
	`ge‹adiusGíîic
(
c
, 
RADIUS_MEMBER
);

683 
	}
}

686 
	$ge‹adiu§oComm™d
(
˛õ¡
 *
c
) {

687 
	`ge‹adiusGíîic
(
c
, 
RADIUS_COORDS
|
RADIUS_NOSTORE
);

688 
	}
}

691 
	$ge‹adiusbymembîroComm™d
(
˛õ¡
 *
c
) {

692 
	`ge‹adiusGíîic
(
c
, 
RADIUS_MEMBER
|
RADIUS_NOSTORE
);

693 
	}
}

699 
	$geohashComm™d
(
˛õ¡
 *
c
) {

700 *
geﬂÕhabë
= "0123456789bcdefghjkmnpqrstuvwxyz";

701 
j
;

704 
robj
 *
zobj
 = 
	`lookupKeyRód
(
c
->
db
, c->
¨gv
[1]);

705 i‡(
zobj
 && 
	`checkTy≥
(
c
, zobj, 
OBJ_ZSET
)) ;

709 
	`addRïlyAºayLí
(
c
,c->
¨gc
-2);

710 
j
 = 2; j < 
c
->
¨gc
; j++) {

711 
sc‹e
;

712 i‡(!
zobj
 || 
	`z£tSc‹e
(zobj, 
c
->
¨gv
[
j
]->
±r
, &
sc‹e
Ë=
C_ERR
) {

713 
	`addRïlyNuŒ
(
c
);

722 
xy
[2];

723 i‡(!
	`decodeGeohash
(
sc‹e
,
xy
)) {

724 
	`addRïlyNuŒ
(
c
);

729 
GeoHashR™ge
 
r
[2];

730 
GeoHashBôs
 
hash
;

731 
r
[0].
mö
 = -180;

732 
r
[0].
max
 = 180;

733 
r
[1].
mö
 = -90;

734 
r
[1].
max
 = 90;

735 
	`geohashEncode
(&
r
[0],&r[1],
xy
[0],xy[1],26,&
hash
);

737 
buf
[12];

738 
i
;

739 
i
 = 0; i < 11; i++) {

740 
idx
;

741 i‡(
i
 == 10) {

745 
idx
 = 0;

747 
idx
 = (
hash
.
bôs
 >> (52-((
i
+1)*5))) & 0x1f;

749 
buf
[
i
] = 
geﬂÕhabë
[
idx
];

751 
buf
[11] = '\0';

752 
	`addRïlyBulkCBuf„r
(
c
,
buf
,11);

755 
	}
}

761 
	$ge›osComm™d
(
˛õ¡
 *
c
) {

762 
j
;

765 
robj
 *
zobj
 = 
	`lookupKeyRód
(
c
->
db
, c->
¨gv
[1]);

766 i‡(
zobj
 && 
	`checkTy≥
(
c
, zobj, 
OBJ_ZSET
)) ;

770 
	`addRïlyAºayLí
(
c
,c->
¨gc
-2);

771 
j
 = 2; j < 
c
->
¨gc
; j++) {

772 
sc‹e
;

773 i‡(!
zobj
 || 
	`z£tSc‹e
(zobj, 
c
->
¨gv
[
j
]->
±r
, &
sc‹e
Ë=
C_ERR
) {

774 
	`addRïlyNuŒAºay
(
c
);

777 
xy
[2];

778 i‡(!
	`decodeGeohash
(
sc‹e
,
xy
)) {

779 
	`addRïlyNuŒAºay
(
c
);

782 
	`addRïlyAºayLí
(
c
,2);

783 
	`addRïlyHum™L⁄gDoubÀ
(
c
,
xy
[0]);

784 
	`addRïlyHum™L⁄gDoubÀ
(
c
,
xy
[1]);

787 
	}
}

794 
	$geodi°Comm™d
(
˛õ¡
 *
c
) {

795 
to_mëî
 = 1;

798 i‡(
c
->
¨gc
 == 5) {

799 
to_mëî
 = 
	`exåa˘UnôOrRïly
(
c
,c->
¨gv
[4]);

800 i‡(
to_mëî
 < 0) ;

801 } i‡(
c
->
¨gc
 > 5) {

802 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

807 
robj
 *
zobj
 = 
NULL
;

808 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
, c->
¨gv
[1], 
sh¨ed
.
nuŒ
[c->
ª•
]))

809 =
NULL
 || 
	`checkTy≥
(
c
, 
zobj
, 
OBJ_ZSET
)) ;

812 
sc‹e1
, 
sc‹e2
, 
xyxy
[4];

813 i‡(
	`z£tSc‹e
(
zobj
, 
c
->
¨gv
[2]->
±r
, &
sc‹e1
Ë=
C_ERR
 ||

814 
	`z£tSc‹e
(
zobj
, 
c
->
¨gv
[3]->
±r
, &
sc‹e2
Ë=
C_ERR
)

816 
	`addRïlyNuŒ
(
c
);

821 i‡(!
	`decodeGeohash
(
sc‹e1
,
xyxy
Ë|| !decodeGeohash(
sc‹e2
,xyxy+2))

822 
	`addRïlyNuŒ
(
c
);

824 
	`addRïlyDoubÀDi°™˚
(
c
,

825 
	`geohashGëDi°™˚
(
xyxy
[0],xyxy[1],xyxy[2],xyxy[3]Ë/ 
to_mëî
);

826 
	}
}

	@geo.h

1 #i‚de‡
__GEO_H__


2 
	#__GEO_H__


	)

4 
	~"£rvî.h
"

8 
	sgeoPoöt
 {

9 
	ml⁄gôude
;

10 
	mœtôude
;

11 
	mdi°
;

12 
	msc‹e
;

13 *
	mmembî
;

14 } 
	tgeoPoöt
;

16 
	sgeoAºay
 {

17 
geoPoöt
 *
	m¨øy
;

18 
size_t
 
	mbuckës
;

19 
size_t
 
	mu£d
;

20 } 
	tgeoAºay
;

	@geohash.c

31 
	~"geohash.h
"

52 
ölöe
 
uöt64_t
 
	$öãæóve64
(
uöt32_t
 
xlo
, uöt32_à
ylo
) {

53 c⁄° 
uöt64_t
 
B
[] = {0x5555555555555555ULL, 0x3333333333333333ULL,

56 c⁄° 
S
[] = {1, 2, 4, 8, 16};

58 
uöt64_t
 
x
 = 
xlo
;

59 
uöt64_t
 
y
 = 
ylo
;

61 
x
 = (x | (x << 
S
[4])Ë& 
B
[4];

62 
y
 = (y | (y << 
S
[4])Ë& 
B
[4];

64 
x
 = (x | (x << 
S
[3])Ë& 
B
[3];

65 
y
 = (y | (y << 
S
[3])Ë& 
B
[3];

67 
x
 = (x | (x << 
S
[2])Ë& 
B
[2];

68 
y
 = (y | (y << 
S
[2])Ë& 
B
[2];

70 
x
 = (x | (x << 
S
[1])Ë& 
B
[1];

71 
y
 = (y | (y << 
S
[1])Ë& 
B
[1];

73 
x
 = (x | (x << 
S
[0])Ë& 
B
[0];

74 
y
 = (y | (y << 
S
[0])Ë& 
B
[0];

76  
x
 | (
y
 << 1);

77 
	}
}

82 
ölöe
 
uöt64_t
 
	$deöãæóve64
(
uöt64_t
 
öãæóved
) {

83 c⁄° 
uöt64_t
 
B
[] = {0x5555555555555555ULL, 0x3333333333333333ULL,

86 c⁄° 
S
[] = {0, 1, 2, 4, 8, 16};

88 
uöt64_t
 
x
 = 
öãæóved
;

89 
uöt64_t
 
y
 = 
öãæóved
 >> 1;

91 
x
 = (x | (x >> 
S
[0])Ë& 
B
[0];

92 
y
 = (y | (y >> 
S
[0])Ë& 
B
[0];

94 
x
 = (x | (x >> 
S
[1])Ë& 
B
[1];

95 
y
 = (y | (y >> 
S
[1])Ë& 
B
[1];

97 
x
 = (x | (x >> 
S
[2])Ë& 
B
[2];

98 
y
 = (y | (y >> 
S
[2])Ë& 
B
[2];

100 
x
 = (x | (x >> 
S
[3])Ë& 
B
[3];

101 
y
 = (y | (y >> 
S
[3])Ë& 
B
[3];

103 
x
 = (x | (x >> 
S
[4])Ë& 
B
[4];

104 
y
 = (y | (y >> 
S
[4])Ë& 
B
[4];

106 
x
 = (x | (x >> 
S
[5])Ë& 
B
[5];

107 
y
 = (y | (y >> 
S
[5])Ë& 
B
[5];

109  
x
 | (
y
 << 32);

110 
	}
}

112 
	$geohashGëCo‹dR™ge
(
GeoHashR™ge
 *
l⁄g_ønge
, GeoHashR™gê*
œt_ønge
) {

115 
l⁄g_ønge
->
max
 = 
GEO_LONG_MAX
;

116 
l⁄g_ønge
->
mö
 = 
GEO_LONG_MIN
;

117 
œt_ønge
->
max
 = 
GEO_LAT_MAX
;

118 
œt_ønge
->
mö
 = 
GEO_LAT_MIN
;

119 
	}
}

121 
	$geohashEncode
(c⁄° 
GeoHashR™ge
 *
l⁄g_ønge
, c⁄° GeoHashR™gê*
œt_ønge
,

122 
l⁄gôude
, 
œtôude
, 
uöt8_t
 
°ï
,

123 
GeoHashBôs
 *
hash
) {

125 i‡(
hash
 =
NULL
 || 
°ï
 > 32 || step == 0 ||

126 
	`RANGEPISZERO
(
œt_ønge
Ë|| RANGEPISZERO(
l⁄g_ønge
))  0;

130 i‡(
l⁄gôude
 > 
GEO_LONG_MAX
 ||Ü⁄gôudê< 
GEO_LONG_MIN
 ||

131 
œtôude
 > 
GEO_LAT_MAX
 ||Ü©ôudê< 
GEO_LAT_MIN
)  0;

133 
hash
->
bôs
 = 0;

134 
hash
->
°ï
 = step;

136 i‡(
œtôude
 < 
œt_ønge
->
mö
 ||Ü©ôudê>Ü©_ønge->
max
 ||

137 
l⁄gôude
 < 
l⁄g_ønge
->
mö
 ||Ü⁄gôudê>Ü⁄g_ønge->
max
) {

141 
œt_off£t
 =

142 (
œtôude
 - 
œt_ønge
->
mö
Ë/ (œt_ønge->
max
 -Üat_range->min);

143 
l⁄g_off£t
 =

144 (
l⁄gôude
 - 
l⁄g_ønge
->
mö
Ë/ (l⁄g_ønge->
max
 -Üong_range->min);

147 
œt_off£t
 *(1ULL << 
°ï
);

148 
l⁄g_off£t
 *(1ULL << 
°ï
);

149 
hash
->
bôs
 = 
	`öãæóve64
(
œt_off£t
, 
l⁄g_off£t
);

151 
	}
}

153 
	$geohashEncodeTy≥
(
l⁄gôude
, 
œtôude
, 
uöt8_t
 
°ï
, 
GeoHashBôs
 *
hash
) {

154 
GeoHashR™ge
 
r
[2] = {{0}};

155 
	`geohashGëCo‹dR™ge
(&
r
[0], &r[1]);

156  
	`geohashEncode
(&
r
[0], &r[1], 
l⁄gôude
, 
œtôude
, 
°ï
, 
hash
);

157 
	}
}

159 
	$geohashEncodeWGS84
(
l⁄gôude
, 
œtôude
, 
uöt8_t
 
°ï
,

160 
GeoHashBôs
 *
hash
) {

161  
	`geohashEncodeTy≥
(
l⁄gôude
, 
œtôude
, 
°ï
, 
hash
);

162 
	}
}

164 
	$geohashDecode
(c⁄° 
GeoHashR™ge
 
l⁄g_ønge
, c⁄° GeoHashR™gê
œt_ønge
,

165 c⁄° 
GeoHashBôs
 
hash
, 
GeoHashAªa
 *
¨ó
) {

166 i‡(
	`HASHISZERO
(
hash
Ë|| 
NULL
 =
¨ó
 || 
	`RANGEISZERO
(
œt_ønge
) ||

167 
	`RANGEISZERO
(
l⁄g_ønge
)) {

171 
¨ó
->
hash
 = hash;

172 
uöt8_t
 
°ï
 = 
hash
.step;

173 
uöt64_t
 
hash_£p
 = 
	`deöãæóve64
(
hash
.
bôs
);

175 
œt_sˇÀ
 = 
œt_ønge
.
max
 -Ü©_ønge.
mö
;

176 
l⁄g_sˇÀ
 = 
l⁄g_ønge
.
max
 -Ü⁄g_ønge.
mö
;

178 
uöt32_t
 
û©o
 = 
hash_£p
;

179 
uöt32_t
 
û⁄o
 = 
hash_£p
 >> 32;

184 
¨ó
->
œtôude
.
mö
 =

185 
œt_ønge
.
mö
 + (
û©o
 * 1.0 / (1uŒ << 
°ï
)Ë* 
œt_sˇÀ
;

186 
¨ó
->
œtôude
.
max
 =

187 
œt_ønge
.
mö
 + ((
û©o
 + 1Ë* 1.0 / (1uŒ << 
°ï
)Ë* 
œt_sˇÀ
;

188 
¨ó
->
l⁄gôude
.
mö
 =

189 
l⁄g_ønge
.
mö
 + (
û⁄o
 * 1.0 / (1uŒ << 
°ï
)Ë* 
l⁄g_sˇÀ
;

190 
¨ó
->
l⁄gôude
.
max
 =

191 
l⁄g_ønge
.
mö
 + ((
û⁄o
 + 1Ë* 1.0 / (1uŒ << 
°ï
)Ë* 
l⁄g_sˇÀ
;

194 
	}
}

196 
	$geohashDecodeTy≥
(c⁄° 
GeoHashBôs
 
hash
, 
GeoHashAªa
 *
¨ó
) {

197 
GeoHashR™ge
 
r
[2] = {{0}};

198 
	`geohashGëCo‹dR™ge
(&
r
[0], &r[1]);

199  
	`geohashDecode
(
r
[0],Ñ[1], 
hash
, 
¨ó
);

200 
	}
}

202 
	$geohashDecodeWGS84
(c⁄° 
GeoHashBôs
 
hash
, 
GeoHashAªa
 *
¨ó
) {

203  
	`geohashDecodeTy≥
(
hash
, 
¨ó
);

204 
	}
}

206 
	$geohashDecodeAªaToL⁄gL©
(c⁄° 
GeoHashAªa
 *
¨ó
, *
xy
) {

207 i‡(!
xy
)  0;

208 
xy
[0] = (
¨ó
->
l⁄gôude
.
mö
 +áªa->l⁄gôude.
max
) / 2;

209 i‡(
xy
[0] > 
GEO_LONG_MAX
) xy[0] = GEO_LONG_MAX;

210 i‡(
xy
[0] < 
GEO_LONG_MIN
) xy[0] = GEO_LONG_MIN;

211 
xy
[1] = (
¨ó
->
œtôude
.
mö
 +áªa->œtôude.
max
) / 2;

212 i‡(
xy
[1] > 
GEO_LAT_MAX
) xy[1] = GEO_LAT_MAX;

213 i‡(
xy
[1] < 
GEO_LAT_MIN
) xy[1] = GEO_LAT_MIN;

215 
	}
}

217 
	$geohashDecodeToL⁄gL©Ty≥
(c⁄° 
GeoHashBôs
 
hash
, *
xy
) {

218 
GeoHashAªa
 
¨ó
 = {{0}};

219 i‡(!
xy
 || !
	`geohashDecodeTy≥
(
hash
, &
¨ó
))

221  
	`geohashDecodeAªaToL⁄gL©
(&
¨ó
, 
xy
);

222 
	}
}

224 
	$geohashDecodeToL⁄gL©WGS84
(c⁄° 
GeoHashBôs
 
hash
, *
xy
) {

225  
	`geohashDecodeToL⁄gL©Ty≥
(
hash
, 
xy
);

226 
	}
}

228 
	$geohash_move_x
(
GeoHashBôs
 *
hash
, 
öt8_t
 
d
) {

229 i‡(
d
 == 0)

232 
uöt64_t
 
x
 = 
hash
->
bôs
 & 0xaaaaaaaaaaaaaaaaULL;

233 
uöt64_t
 
y
 = 
hash
->
bôs
 & 0x5555555555555555ULL;

235 
uöt64_t
 
zz
 = 0x5555555555555555ULL >> (64 - 
hash
->
°ï
 * 2);

237 i‡(
d
 > 0) {

238 
x
 = x + (
zz
 + 1);

240 
x
 = x | 
zz
;

241 
x
 = x - (
zz
 + 1);

244 
x
 &(0xØØØØØØØØULL >> (64 - 
hash
->
°ï
 * 2));

245 
hash
->
bôs
 = (
x
 | 
y
);

246 
	}
}

248 
	$geohash_move_y
(
GeoHashBôs
 *
hash
, 
öt8_t
 
d
) {

249 i‡(
d
 == 0)

252 
uöt64_t
 
x
 = 
hash
->
bôs
 & 0xaaaaaaaaaaaaaaaaULL;

253 
uöt64_t
 
y
 = 
hash
->
bôs
 & 0x5555555555555555ULL;

255 
uöt64_t
 
zz
 = 0xØØØØØØØØULL >> (64 - 
hash
->
°ï
 * 2);

256 i‡(
d
 > 0) {

257 
y
 = y + (
zz
 + 1);

259 
y
 = y | 
zz
;

260 
y
 = y - (
zz
 + 1);

262 
y
 &(0x5555555555555555ULL >> (64 - 
hash
->
°ï
 * 2));

263 
hash
->
bôs
 = (
x
 | 
y
);

264 
	}
}

266 
	$geohashNeighb‹s
(c⁄° 
GeoHashBôs
 *
hash
, 
GeoHashNeighb‹s
 *
√ighb‹s
) {

267 
√ighb‹s
->
ó°
 = *
hash
;

268 
√ighb‹s
->
we°
 = *
hash
;

269 
√ighb‹s
->
n‹th
 = *
hash
;

270 
√ighb‹s
->
south
 = *
hash
;

271 
√ighb‹s
->
south_ó°
 = *
hash
;

272 
√ighb‹s
->
south_we°
 = *
hash
;

273 
√ighb‹s
->
n‹th_ó°
 = *
hash
;

274 
√ighb‹s
->
n‹th_we°
 = *
hash
;

276 
	`geohash_move_x
(&
√ighb‹s
->
ó°
, 1);

277 
	`geohash_move_y
(&
√ighb‹s
->
ó°
, 0);

279 
	`geohash_move_x
(&
√ighb‹s
->
we°
, -1);

280 
	`geohash_move_y
(&
√ighb‹s
->
we°
, 0);

282 
	`geohash_move_x
(&
√ighb‹s
->
south
, 0);

283 
	`geohash_move_y
(&
√ighb‹s
->
south
, -1);

285 
	`geohash_move_x
(&
√ighb‹s
->
n‹th
, 0);

286 
	`geohash_move_y
(&
√ighb‹s
->
n‹th
, 1);

288 
	`geohash_move_x
(&
√ighb‹s
->
n‹th_we°
, -1);

289 
	`geohash_move_y
(&
√ighb‹s
->
n‹th_we°
, 1);

291 
	`geohash_move_x
(&
√ighb‹s
->
n‹th_ó°
, 1);

292 
	`geohash_move_y
(&
√ighb‹s
->
n‹th_ó°
, 1);

294 
	`geohash_move_x
(&
√ighb‹s
->
south_ó°
, 1);

295 
	`geohash_move_y
(&
√ighb‹s
->
south_ó°
, -1);

297 
	`geohash_move_x
(&
√ighb‹s
->
south_we°
, -1);

298 
	`geohash_move_y
(&
√ighb‹s
->
south_we°
, -1);

299 
	}
}

	@geohash.h

32 #i‚de‡
GEOHASH_H_


33 
	#GEOHASH_H_


	)

35 
	~<°ddef.h
>

36 
	~<°döt.h
>

37 
	~<°döt.h
>

39 #i‡
deföed
(
__˝lu•lus
)

43 
	#HASHISZERO
(
r
Ë(!‘).
bôs
 && !‘).
°ï
)

	)

44 
	#RANGEISZERO
(
r
Ë(!‘).
max
 && !‘).
mö
)

	)

45 
	#RANGEPISZERO
(
r
Ë‘ =
NULL
 || 
	`RANGEISZERO
(*r))

	)

47 
	#GEO_STEP_MAX
 26

	)

50 
	#GEO_LAT_MIN
 -85.05112878

	)

51 
	#GEO_LAT_MAX
 85.05112878

	)

52 
	#GEO_LONG_MIN
 -180

	)

53 
	#GEO_LONG_MAX
 180

	)

56 
GEOHASH_NORTH
 = 0,

57 
GEOHASH_EAST
,

58 
GEOHASH_WEST
,

59 
GEOHASH_SOUTH
,

60 
GEOHASH_SOUTH_WEST
,

61 
GEOHASH_SOUTH_EAST
,

62 
GEOHASH_NORT_WEST
,

63 
GEOHASH_NORT_EAST


64 } 
	tGeoDúe˘i⁄
;

67 
uöt64_t
 
bôs
;

68 
uöt8_t
 
°ï
;

69 } 
	tGeoHashBôs
;

72 
mö
;

73 
max
;

74 } 
	tGeoHashR™ge
;

77 
GeoHashBôs
 
hash
;

78 
GeoHashR™ge
 
l⁄gôude
;

79 
GeoHashR™ge
 
œtôude
;

80 } 
	tGeoHashAªa
;

83 
GeoHashBôs
 
n‹th
;

84 
GeoHashBôs
 
ó°
;

85 
GeoHashBôs
 
we°
;

86 
GeoHashBôs
 
south
;

87 
GeoHashBôs
 
n‹th_ó°
;

88 
GeoHashBôs
 
south_ó°
;

89 
GeoHashBôs
 
n‹th_we°
;

90 
GeoHashBôs
 
south_we°
;

91 } 
	tGeoHashNeighb‹s
;

97 
geohashGëCo‹dR™ge
(
GeoHashR™ge
 *
l⁄g_ønge
, GeoHashR™gê*
œt_ønge
);

98 
geohashEncode
(c⁄° 
GeoHashR™ge
 *
l⁄g_ønge
, c⁄° GeoHashR™gê*
œt_ønge
,

99 
l⁄gôude
, 
œtôude
, 
uöt8_t
 
°ï
,

100 
GeoHashBôs
 *
hash
);

101 
geohashEncodeTy≥
(
l⁄gôude
, 
œtôude
,

102 
uöt8_t
 
°ï
, 
GeoHashBôs
 *
hash
);

103 
geohashEncodeWGS84
(
l⁄gôude
, 
œtôude
, 
uöt8_t
 
°ï
,

104 
GeoHashBôs
 *
hash
);

105 
geohashDecode
(c⁄° 
GeoHashR™ge
 
l⁄g_ønge
, c⁄° GeoHashR™gê
œt_ønge
,

106 c⁄° 
GeoHashBôs
 
hash
, 
GeoHashAªa
 *
¨ó
);

107 
geohashDecodeTy≥
(c⁄° 
GeoHashBôs
 
hash
, 
GeoHashAªa
 *
¨ó
);

108 
geohashDecodeWGS84
(c⁄° 
GeoHashBôs
 
hash
, 
GeoHashAªa
 *
¨ó
);

109 
geohashDecodeAªaToL⁄gL©
(c⁄° 
GeoHashAªa
 *
¨ó
, *
xy
);

110 
geohashDecodeToL⁄gL©Ty≥
(c⁄° 
GeoHashBôs
 
hash
, *
xy
);

111 
geohashDecodeToL⁄gL©WGS84
(c⁄° 
GeoHashBôs
 
hash
, *
xy
);

112 
geohashDecodeToL⁄gL©Mîˇt‹
(c⁄° 
GeoHashBôs
 
hash
, *
xy
);

113 
geohashNeighb‹s
(c⁄° 
GeoHashBôs
 *
hash
, 
GeoHashNeighb‹s
 *
√ighb‹s
);

115 #i‡
deföed
(
__˝lu•lus
)

	@geohash_helper.c

37 
	~"fma¸os.h
"

38 
	~"geohash_hñ≥r.h
"

39 
	~"debugma¸o.h
"

40 
	~<m©h.h
>

42 
	#D_R
 (
M_PI
 / 180.0)

	)

43 
	#R_MAJOR
 6378137.0

	)

44 
	#R_MINOR
 6356752.3142

	)

45 
	#RATIO
 (
R_MINOR
 / 
R_MAJOR
)

	)

46 
	#ECCENT
 (
	`sqπ
(1.0 - (
RATIO
 *RATIO)))

	)

47 
	#COM
 (0.5 * 
ECCENT
)

	)

50 c⁄° 
	gDEG_TO_RAD
 = 0.017453292519943295769236907684886;

52 c⁄° 
	gEARTH_RADIUS_IN_METERS
 = 6372797.560856;

54 c⁄° 
	gMERCATOR_MAX
 = 20037726.37;

55 c⁄° 
	gMERCATOR_MIN
 = -20037726.37;

57 
ölöe
 
	$deg_ød
(
™g
Ë{ áng * 
D_R
; 
	}
}

58 
ölöe
 
	$ød_deg
(
™g
Ë{ áng / 
D_R
; 
	}
}

62 
uöt8_t
 
	$geohashE°im©eSãpsByRadius
(
ønge_mëîs
, 
œt
) {

63 i‡(
ønge_mëîs
 == 0)  26;

64 
°ï
 = 1;

65 
ønge_mëîs
 < 
MERCATOR_MAX
) {

66 
ønge_mëîs
 *= 2;

67 
°ï
++;

69 
°ï
 -= 2;

74 i‡(
œt
 > 66 ||Üat < -66) {

75 
°ï
--;

76 i‡(
œt
 > 80 ||Ü© < -80Ë
°ï
--;

80 i‡(
°ï
 < 1) step = 1;

81 i‡(
°ï
 > 26) step = 26;

82  
°ï
;

83 
	}
}

103 
	$geohashBoundögBox
(
l⁄gôude
, 
œtôude
, 
ødius_mëîs
,

104 *
bounds
) {

105 i‡(!
bounds
)  0;

107 
bounds
[0] = 
l⁄gôude
 - 
	`ød_deg
(
ødius_mëîs
/
EARTH_RADIUS_IN_METERS
/
	`cos
(
	`deg_ød
(
œtôude
)));

108 
bounds
[2] = 
l⁄gôude
 + 
	`ød_deg
(
ødius_mëîs
/
EARTH_RADIUS_IN_METERS
/
	`cos
(
	`deg_ød
(
œtôude
)));

109 
bounds
[1] = 
œtôude
 - 
	`ød_deg
(
ødius_mëîs
/
EARTH_RADIUS_IN_METERS
);

110 
bounds
[3] = 
œtôude
 + 
	`ød_deg
(
ødius_mëîs
/
EARTH_RADIUS_IN_METERS
);

112 
	}
}

116 
GeoHashRadius
 
	$geohashGëAªasByRadius
(
l⁄gôude
, 
œtôude
, 
ødius_mëîs
) {

117 
GeoHashR™ge
 
l⁄g_ønge
, 
œt_ønge
;

118 
GeoHashRadius
 
ødius
;

119 
GeoHashBôs
 
hash
;

120 
GeoHashNeighb‹s
 
√ighb‹s
;

121 
GeoHashAªa
 
¨ó
;

122 
mö_l⁄
, 
max_l⁄
, 
mö_œt
, 
max_œt
;

123 
bounds
[4];

124 
°ïs
;

126 
	`geohashBoundögBox
(
l⁄gôude
, 
œtôude
, 
ødius_mëîs
, 
bounds
);

127 
mö_l⁄
 = 
bounds
[0];

128 
mö_œt
 = 
bounds
[1];

129 
max_l⁄
 = 
bounds
[2];

130 
max_œt
 = 
bounds
[3];

132 
°ïs
 = 
	`geohashE°im©eSãpsByRadius
(
ødius_mëîs
,
œtôude
);

134 
	`geohashGëCo‹dR™ge
(&
l⁄g_ønge
,&
œt_ønge
);

135 
	`geohashEncode
(&
l⁄g_ønge
,&
œt_ønge
,
l⁄gôude
,
œtôude
,
°ïs
,&
hash
);

136 
	`geohashNeighb‹s
(&
hash
,&
√ighb‹s
);

137 
	`geohashDecode
(
l⁄g_ønge
,
œt_ønge
,
hash
,&
¨ó
);

144 
de¸ó£_°ï
 = 0;

146 
GeoHashAªa
 
n‹th
, 
south
, 
ó°
, 
we°
;

148 
	`geohashDecode
(
l⁄g_ønge
, 
œt_ønge
, 
√ighb‹s
.
n‹th
, &north);

149 
	`geohashDecode
(
l⁄g_ønge
, 
œt_ønge
, 
√ighb‹s
.
south
, &south);

150 
	`geohashDecode
(
l⁄g_ønge
, 
œt_ønge
, 
√ighb‹s
.
ó°
, &east);

151 
	`geohashDecode
(
l⁄g_ønge
, 
œt_ønge
, 
√ighb‹s
.
we°
, &west);

153 i‡(
	`geohashGëDi°™˚
(
l⁄gôude
,
œtôude
,l⁄gôude,
n‹th
.œtôude.
max
)

154 < 
ødius_mëîs
Ë
de¸ó£_°ï
 = 1;

155 i‡(
	`geohashGëDi°™˚
(
l⁄gôude
,
œtôude
,l⁄gôude,
south
.œtôude.
mö
)

156 < 
ødius_mëîs
Ë
de¸ó£_°ï
 = 1;

157 i‡(
	`geohashGëDi°™˚
(
l⁄gôude
,
œtôude
,
ó°
.l⁄gôude.
max
,latitude)

158 < 
ødius_mëîs
Ë
de¸ó£_°ï
 = 1;

159 i‡(
	`geohashGëDi°™˚
(
l⁄gôude
,
œtôude
,
we°
.l⁄gôude.
mö
,latitude)

160 < 
ødius_mëîs
Ë
de¸ó£_°ï
 = 1;

163 i‡(
°ïs
 > 1 && 
de¸ó£_°ï
) {

164 
°ïs
--;

165 
	`geohashEncode
(&
l⁄g_ønge
,&
œt_ønge
,
l⁄gôude
,
œtôude
,
°ïs
,&
hash
);

166 
	`geohashNeighb‹s
(&
hash
,&
√ighb‹s
);

167 
	`geohashDecode
(
l⁄g_ønge
,
œt_ønge
,
hash
,&
¨ó
);

171 i‡(
°ïs
 >= 2) {

172 i‡(
¨ó
.
œtôude
.
mö
 < 
mö_œt
) {

173 
	`GZERO
(
√ighb‹s
.
south
);

174 
	`GZERO
(
√ighb‹s
.
south_we°
);

175 
	`GZERO
(
√ighb‹s
.
south_ó°
);

177 i‡(
¨ó
.
œtôude
.
max
 > 
max_œt
) {

178 
	`GZERO
(
√ighb‹s
.
n‹th
);

179 
	`GZERO
(
√ighb‹s
.
n‹th_ó°
);

180 
	`GZERO
(
√ighb‹s
.
n‹th_we°
);

182 i‡(
¨ó
.
l⁄gôude
.
mö
 < 
mö_l⁄
) {

183 
	`GZERO
(
√ighb‹s
.
we°
);

184 
	`GZERO
(
√ighb‹s
.
south_we°
);

185 
	`GZERO
(
√ighb‹s
.
n‹th_we°
);

187 i‡(
¨ó
.
l⁄gôude
.
max
 > 
max_l⁄
) {

188 
	`GZERO
(
√ighb‹s
.
ó°
);

189 
	`GZERO
(
√ighb‹s
.
south_ó°
);

190 
	`GZERO
(
√ighb‹s
.
n‹th_ó°
);

193 
ødius
.
hash
 = hash;

194 
ødius
.
√ighb‹s
 =Çeighbors;

195 
ødius
.
¨ó
 =área;

196  
ødius
;

197 
	}
}

199 
GeoHashRadius
 
	$geohashGëAªasByRadiusWGS84
(
l⁄gôude
, 
œtôude
,

200 
ødius_mëîs
) {

201  
	`geohashGëAªasByRadius
(
l⁄gôude
, 
œtôude
, 
ødius_mëîs
);

202 
	}
}

204 
GeoHashFix52Bôs
 
	$geohashAlign52Bôs
(c⁄° 
GeoHashBôs
 
hash
) {

205 
uöt64_t
 
bôs
 = 
hash
.bits;

206 
bôs
 <<(52 - 
hash
.
°ï
 * 2);

207  
bôs
;

208 
	}
}

211 
	$geohashGëDi°™˚
(
l⁄1d
, 
œt1d
, 
l⁄2d
, 
œt2d
) {

212 
œt1r
, 
l⁄1r
, 
œt2r
, 
l⁄2r
, 
u
, 
v
;

213 
œt1r
 = 
	`deg_ød
(
œt1d
);

214 
l⁄1r
 = 
	`deg_ød
(
l⁄1d
);

215 
œt2r
 = 
	`deg_ød
(
œt2d
);

216 
l⁄2r
 = 
	`deg_ød
(
l⁄2d
);

217 
u
 = 
	`sö
((
œt2r
 - 
œt1r
) / 2);

218 
v
 = 
	`sö
((
l⁄2r
 - 
l⁄1r
) / 2);

219  2.0 * 
EARTH_RADIUS_IN_METERS
 *

220 
	`asö
(
	`sqπ
(
u
 * u + 
	`cos
(
œt1r
Ë* cos(
œt2r
Ë* 
v
 * v));

221 
	}
}

223 
	$geohashGëDi°™˚IfInRadius
(
x1
, 
y1
,

224 
x2
, 
y2
, 
ødius
,

225 *
di°™˚
) {

226 *
di°™˚
 = 
	`geohashGëDi°™˚
(
x1
, 
y1
, 
x2
, 
y2
);

227 i‡(*
di°™˚
 > 
ødius
)  0;

229 
	}
}

231 
	$geohashGëDi°™˚IfInRadiusWGS84
(
x1
, 
y1
, 
x2
,

232 
y2
, 
ødius
,

233 *
di°™˚
) {

234  
	`geohashGëDi°™˚IfInRadius
(
x1
, 
y1
, 
x2
, 
y2
, 
ødius
, 
di°™˚
);

235 
	}
}

	@geohash_helper.h

32 #i‚de‡
GEOHASH_HELPER_HPP_


33 
	#GEOHASH_HELPER_HPP_


	)

35 
	~"geohash.h
"

37 
	#GZERO
(
s
Ës.
bôs
 = s.
°ï
 = 0;

	)

38 
	#GISZERO
(
s
Ë(!s.
bôs
 && !s.
°ï
)

	)

39 
	#GISNOTZERO
(
s
Ë(s.
bôs
 || s.
°ï
)

	)

41 
uöt64_t
 
	tGeoHashFix52Bôs
;

42 
uöt64_t
 
	tGeoHashV¨Bôs
;

45 
GeoHashBôs
 
	mhash
;

46 
GeoHashAªa
 
	m¨ó
;

47 
GeoHashNeighb‹s
 
	m√ighb‹s
;

48 } 
	tGeoHashRadius
;

50 
GeoHashBôsCom∑øt‹
(c⁄° 
GeoHashBôs
 *
a
, c⁄° GeoHashBô†*
b
);

51 
uöt8_t
 
geohashE°im©eSãpsByRadius
(
ønge_mëîs
, 
œt
);

52 
geohashBoundögBox
(
l⁄gôude
, 
œtôude
, 
ødius_mëîs
,

53 *
bounds
);

54 
GeoHashRadius
 
geohashGëAªasByRadius
(
l⁄gôude
,

55 
œtôude
, 
ødius_mëîs
);

56 
GeoHashRadius
 
geohashGëAªasByRadiusWGS84
(
l⁄gôude
, 
œtôude
,

57 
ødius_mëîs
);

58 
GeoHashRadius
 
geohashGëAªasByRadiusMîˇt‹
(
l⁄gôude
, 
œtôude
,

59 
ødius_mëîs
);

60 
GeoHashFix52Bôs
 
geohashAlign52Bôs
(c⁄° 
GeoHashBôs
 
hash
);

61 
geohashGëDi°™˚
(
l⁄1d
, 
œt1d
,

62 
l⁄2d
, 
œt2d
);

63 
geohashGëDi°™˚IfInRadius
(
x1
, 
y1
,

64 
x2
, 
y2
, 
ødius
,

65 *
di°™˚
);

66 
geohashGëDi°™˚IfInRadiusWGS84
(
x1
, 
y1
, 
x2
,

67 
y2
, 
ødius
,

68 *
di°™˚
);

	@gopher.c

30 
	~"£rvî.h
"

35 
	$addRïlyG›hîIãm
(
˛õ¡
 *
c
, c⁄° *
ty≥
, c⁄° *
des¸
,

36 c⁄° *
£À˘‹
, c⁄° *
ho°«me
, 
p‹t
)

38 
sds
 
ôem
 = 
	`sdsˇtfmt
(
	`sd£m±y
(),"%s%s\t%s\t%s\t%i\r\n",

39 
ty≥
, 
des¸
,

40 
£À˘‹
 ? selector : "(NULL)",

41 
ho°«me
 ? hostname : "(NULL)",

42 
p‹t
);

43 
	`addRïlyPrŸo
(
c
,
ôem
,
	`sd¶í
(item));

44 
	`sds‰ì
(
ôem
);

45 
	}
}

51 
	$¥o˚ssG›hîReque°
(
˛õ¡
 *
c
) {

52 
robj
 *
key«me
 = 
c
->
¨gc
 =0 ? 
	`¸óãSåögObje˘
("/",1Ë: c->
¨gv
[0];

53 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
,
key«me
);

56 i‡(
o
 =
NULL
 || o->
ty≥
 !
OBJ_STRING
) {

57 *
îr°r
;

58 i‡(
o
 =
NULL
)

59 
îr°r
 = "Error:Ço contentátÅhe specified key";

61 
îr°r
 = "Error: selected keyÅype is invalid "

63 
	`addRïlyG›hîIãm
(
c
,"i",
îr°r
,
NULL
,NULL,0);

64 
	`addRïlyG›hîIãm
(
c
,"i","Redi†G›hî sîvî",
NULL
,NULL,0);

66 
	`addRïly
(
c
,
o
);

73 i‡(
c
->
¨gc
 =0Ë
	`de¸RefCou¡
(
key«me
);

97 
	}
}

	@help.h

3 #i‚de‡
__REDIS_HELP_H


4 
	#__REDIS_HELP_H


	)

6 *
	gcomm™dGroups
[] = {

24 
	scomm™dHñp
 {

25 *
	m«me
;

26 *
	m∑øms
;

27 *
	msumm¨y
;

28 
	mgroup
;

29 *
	msö˚
;

30 } 
	gcomm™dHñp
[] = {

	@hyperloglog.c

32 
	~"£rvî.h
"

34 
	~<°döt.h
>

35 
	~<m©h.h
>

182 
	shŒhdr
 {

183 
	mmagic
[4];

184 
uöt8_t
 
	mícodög
;

185 
uöt8_t
 
	mnŸu£d
[3];

186 
uöt8_t
 
	mˇrd
[8];

187 
uöt8_t
 
	mªgi°îs
[];

191 
	#HLL_INVALIDATE_CACHE
(
hdr
Ë(hdr)->
ˇrd
[7] |(1<<7)

	)

192 
	#HLL_VALID_CACHE
(
hdr
Ë(((hdr)->
ˇrd
[7] & (1<<7)Ë=0)

	)

194 
	#HLL_P
 14

	)

195 
	#HLL_Q
 (64-
HLL_P
Ë

	)

197 
	#HLL_REGISTERS
 (1<<
HLL_P
Ë

	)

198 
	#HLL_P_MASK
 (
HLL_REGISTERS
-1Ë

	)

199 
	#HLL_BITS
 6

	)

200 
	#HLL_REGISTER_MAX
 ((1<<
HLL_BITS
)-1)

	)

201 
	#HLL_HDR_SIZE
 (
hŒhdr
)

	)

202 
	#HLL_DENSE_SIZE
 (
HLL_HDR_SIZE
+((
HLL_REGISTERS
*
HLL_BITS
+7)/8))

	)

203 
	#HLL_DENSE
 0

	)

204 
	#HLL_SPARSE
 1

	)

205 
	#HLL_RAW
 255

	)

206 
	#HLL_MAX_ENCODING
 1

	)

208 *
	gövÆid_hŒ_îr
 = "-INVALIDOBJ Corrupted HLL object detected\r\n";

339 
	#HLL_DENSE_GET_REGISTER
(
èrgë
,
p
,
ªgnum
) do { \

340 
uöt8_t
 *
_p
 = (uöt8_t*Ë
p
; \

341 
_byã
 = 
ªgnum
*
HLL_BITS
/8; \

342 
_fb
 = 
ªgnum
*
HLL_BITS
&7; \

343 
_fb8
 = 8 - 
_fb
; \

344 
b0
 = 
_p
[
_byã
]; \

345 
b1
 = 
_p
[
_byã
+1]; \

346 
èrgë
 = ((
b0
 >> 
_fb
Ë| (
b1
 << 
_fb8
)Ë& 
HLL_REGISTER_MAX
; \

347 } 0)

	)

351 
	#HLL_DENSE_SET_REGISTER
(
p
,
ªgnum
,
vÆ
) do { \

352 
uöt8_t
 *
_p
 = (uöt8_t*Ë
p
; \

353 
_byã
 = 
ªgnum
*
HLL_BITS
/8; \

354 
_fb
 = 
ªgnum
*
HLL_BITS
&7; \

355 
_fb8
 = 8 - 
_fb
; \

356 
_v
 = 
vÆ
; \

357 
_p
[
_byã
] &~(
HLL_REGISTER_MAX
 << 
_fb
); \

358 
_p
[
_byã
] |
_v
 << 
_fb
; \

359 
_p
[
_byã
+1] &~(
HLL_REGISTER_MAX
 >> 
_fb8
); \

360 
_p
[
_byã
+1] |
_v
 >> 
_fb8
; \

361 } 0)

	)

365 
	#HLL_SPARSE_XZERO_BIT
 0x40

	)

366 
	#HLL_SPARSE_VAL_BIT
 0x80

	)

367 
	#HLL_SPARSE_IS_ZERO
(
p
Ë(((*’)Ë& 0xc0Ë=0Ë

	)

368 
	#HLL_SPARSE_IS_XZERO
(
p
Ë(((*’)Ë& 0xc0Ë=
HLL_SPARSE_XZERO_BIT
)

	)

369 
	#HLL_SPARSE_IS_VAL
(
p
Ë((*’)Ë& 
HLL_SPARSE_VAL_BIT
)

	)

370 
	#HLL_SPARSE_ZERO_LEN
(
p
Ë(((*’)Ë& 0x3f)+1)

	)

371 
	#HLL_SPARSE_XZERO_LEN
(
p
Ë(((((*’)Ë& 0x3fË<< 8Ë| (*(’)+1)))+1)

	)

372 
	#HLL_SPARSE_VAL_VALUE
(
p
Ë((((*’)Ë>> 2Ë& 0x1f)+1)

	)

373 
	#HLL_SPARSE_VAL_LEN
(
p
Ë(((*’)Ë& 0x3)+1)

	)

374 
	#HLL_SPARSE_VAL_MAX_VALUE
 32

	)

375 
	#HLL_SPARSE_VAL_MAX_LEN
 4

	)

376 
	#HLL_SPARSE_ZERO_MAX_LEN
 64

	)

377 
	#HLL_SPARSE_XZERO_MAX_LEN
 16384

	)

378 
	#HLL_SPARSE_VAL_SET
(
p
,
vÆ
,
Àn
) do { \

379 *(
p
Ë(((
vÆ
)-1)<<2|((
Àn
)-1))|
HLL_SPARSE_VAL_BIT
; \

380 } 0)

	)

381 
	#HLL_SPARSE_ZERO_SET
(
p
,
Àn
) do { \

382 *(
p
Ë(
Àn
)-1; \

383 } 0)

	)

384 
	#HLL_SPARSE_XZERO_SET
(
p
,
Àn
) do { \

385 
_l
 = (
Àn
)-1; \

386 *(
p
Ë(
_l
>>8Ë| 
HLL_SPARSE_XZERO_BIT
; \

387 *((
p
)+1Ë(
_l
&0xff); \

388 } 0)

	)

389 
	#HLL_ALPHA_INF
 0.721347520444481703680

	)

396 
uöt64_t
 
	$MurmurHash64A
 (c⁄° * 
key
, 
Àn
, 
£ed
) {

397 c⁄° 
uöt64_t
 
m
 = 0xc6a4a7935bd1e995;

398 c⁄° 
r
 = 47;

399 
uöt64_t
 
h
 = 
£ed
 ^ (
Àn
 * 
m
);

400 c⁄° 
uöt8_t
 *
d©a
 = (c⁄° uöt8_à*)
key
;

401 c⁄° 
uöt8_t
 *
íd
 = 
d©a
 + (
Àn
-(len&7));

403 
d©a
 !
íd
) {

404 
uöt64_t
 
k
;

406 #i‡(
BYTE_ORDER
 =
LITTLE_ENDIAN
)

407 #ifde‡
USE_ALIGNED_ACCESS


408 
	`mem˝y
(&
k
,
d©a
,(
uöt64_t
));

410 
k
 = *((
uöt64_t
*)
d©a
);

413 
k
 = (
uöt64_t
Ë
d©a
[0];

414 
k
 |(
uöt64_t
Ë
d©a
[1] << 8;

415 
k
 |(
uöt64_t
Ë
d©a
[2] << 16;

416 
k
 |(
uöt64_t
Ë
d©a
[3] << 24;

417 
k
 |(
uöt64_t
Ë
d©a
[4] << 32;

418 
k
 |(
uöt64_t
Ë
d©a
[5] << 40;

419 
k
 |(
uöt64_t
Ë
d©a
[6] << 48;

420 
k
 |(
uöt64_t
Ë
d©a
[7] << 56;

423 
k
 *
m
;

424 
k
 ^k >> 
r
;

425 
k
 *
m
;

426 
h
 ^
k
;

427 
h
 *
m
;

428 
d©a
 += 8;

431 
Àn
 & 7) {

432 7: 
h
 ^(
uöt64_t
)
d©a
[6] << 48;

433 6: 
h
 ^(
uöt64_t
)
d©a
[5] << 40;

434 5: 
h
 ^(
uöt64_t
)
d©a
[4] << 32;

435 4: 
h
 ^(
uöt64_t
)
d©a
[3] << 24;

436 3: 
h
 ^(
uöt64_t
)
d©a
[2] << 16;

437 2: 
h
 ^(
uöt64_t
)
d©a
[1] << 8;

438 1: 
h
 ^(
uöt64_t
)
d©a
[0];

439 
h
 *
m
;

442 
h
 ^h >> 
r
;

443 
h
 *
m
;

444 
h
 ^h >> 
r
;

445  
h
;

446 
	}
}

451 
	$hŒP©Lí
(*
ñe
, 
size_t
 
ñesize
, *
ªgp
) {

452 
uöt64_t
 
hash
, 
bô
, 
ödex
;

453 
cou¡
;

466 
hash
 = 
	`MurmurHash64A
(
ñe
,
ñesize
,0xadc83b19ULL);

467 
ödex
 = 
hash
 & 
HLL_P_MASK
;

468 
hash
 >>
HLL_P
;

469 
hash
 |((
uöt64_t
)1<<
HLL_Q
);

471 
bô
 = 1;

472 
cou¡
 = 1;

473 (
hash
 & 
bô
) == 0) {

474 
cou¡
++;

475 
bô
 <<= 1;

477 *
ªgp
 = (Ë
ödex
;

478  
cou¡
;

479 
	}
}

493 
	$hŒDí£Së
(
uöt8_t
 *
ªgi°îs
, 
ödex
, uöt8_à
cou¡
) {

494 
uöt8_t
 
ﬁdcou¡
;

496 
	`HLL_DENSE_GET_REGISTER
(
ﬁdcou¡
,
ªgi°îs
,
ödex
);

497 i‡(
cou¡
 > 
ﬁdcou¡
) {

498 
	`HLL_DENSE_SET_REGISTER
(
ªgi°îs
,
ödex
,
cou¡
);

503 
	}
}

511 
	$hŒDí£Add
(
uöt8_t
 *
ªgi°îs
, *
ñe
, 
size_t
 
ñesize
) {

512 
ödex
;

513 
uöt8_t
 
cou¡
 = 
	`hŒP©Lí
(
ñe
,
ñesize
,&
ödex
);

515  
	`hŒDí£Së
(
ªgi°îs
,
ödex
,
cou¡
);

516 
	}
}

519 
	$hŒDí£RegHi°o
(
uöt8_t
 *
ªgi°îs
, * 
ªghi°o
) {

520 
j
;

525 i‡(
HLL_REGISTERS
 =16384 && 
HLL_BITS
 == 6) {

526 
uöt8_t
 *
r
 = 
ªgi°îs
;

527 
r0
, 
r1
, 
r2
, 
r3
, 
r4
, 
r5
, 
r6
, 
r7
, 
r8
, 
r9
,

528 
r10
, 
r11
, 
r12
, 
r13
, 
r14
, 
r15
;

529 
j
 = 0; j < 1024; j++) {

531 
r0
 = 
r
[0] & 63;

532 
r1
 = (
r
[0] >> 6 |Ñ[1] << 2) & 63;

533 
r2
 = (
r
[1] >> 4 |Ñ[2] << 4) & 63;

534 
r3
 = (
r
[2] >> 2) & 63;

535 
r4
 = 
r
[3] & 63;

536 
r5
 = (
r
[3] >> 6 |Ñ[4] << 2) & 63;

537 
r6
 = (
r
[4] >> 4 |Ñ[5] << 4) & 63;

538 
r7
 = (
r
[5] >> 2) & 63;

539 
r8
 = 
r
[6] & 63;

540 
r9
 = (
r
[6] >> 6 |Ñ[7] << 2) & 63;

541 
r10
 = (
r
[7] >> 4 |Ñ[8] << 4) & 63;

542 
r11
 = (
r
[8] >> 2) & 63;

543 
r12
 = 
r
[9] & 63;

544 
r13
 = (
r
[9] >> 6 |Ñ[10] << 2) & 63;

545 
r14
 = (
r
[10] >> 4 |Ñ[11] << 4) & 63;

546 
r15
 = (
r
[11] >> 2) & 63;

548 
ªghi°o
[
r0
]++;

549 
ªghi°o
[
r1
]++;

550 
ªghi°o
[
r2
]++;

551 
ªghi°o
[
r3
]++;

552 
ªghi°o
[
r4
]++;

553 
ªghi°o
[
r5
]++;

554 
ªghi°o
[
r6
]++;

555 
ªghi°o
[
r7
]++;

556 
ªghi°o
[
r8
]++;

557 
ªghi°o
[
r9
]++;

558 
ªghi°o
[
r10
]++;

559 
ªghi°o
[
r11
]++;

560 
ªghi°o
[
r12
]++;

561 
ªghi°o
[
r13
]++;

562 
ªghi°o
[
r14
]++;

563 
ªghi°o
[
r15
]++;

565 
r
 += 12;

568 
j
 = 0; j < 
HLL_REGISTERS
; j++) {

569 
ªg
;

570 
	`HLL_DENSE_GET_REGISTER
(
ªg
,
ªgi°îs
,
j
);

571 
ªghi°o
[
ªg
]++;

574 
	}
}

584 
	$hŒS∑r£ToDí£
(
robj
 *
o
) {

585 
sds
 
•¨£
 = 
o
->
±r
, 
dí£
;

586 
hŒhdr
 *
hdr
, *
ﬁdhdr
 = (hŒhdr*)
•¨£
;

587 
idx
 = 0, 
ru∆í
, 
ªgvÆ
;

588 
uöt8_t
 *
p
 = (uöt8_t*)
•¨£
, *
íd
 =Ö+
	`sd¶í
(sparse);

591 
hdr
 = (
hŒhdr
*Ë
•¨£
;

592 i‡(
hdr
->
ícodög
 =
HLL_DENSE
Ë 
C_OK
;

597 
dí£
 = 
	`sd¢ewÀn
(
NULL
,
HLL_DENSE_SIZE
);

598 
hdr
 = (
hŒhdr
*Ë
dí£
;

599 *
hdr
 = *
ﬁdhdr
;

600 
hdr
->
ícodög
 = 
HLL_DENSE
;

604 
p
 +
HLL_HDR_SIZE
;

605 
p
 < 
íd
) {

606 i‡(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

607 
ru∆í
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

608 
idx
 +
ru∆í
;

609 
p
++;

610 } i‡(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

611 
ru∆í
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

612 
idx
 +
ru∆í
;

613 
p
 += 2;

615 
ru∆í
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

616 
ªgvÆ
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

617 i‡((
ru∆í
 + 
idx
Ë> 
HLL_REGISTERS
) ;

618 
ru∆í
--) {

619 
	`HLL_DENSE_SET_REGISTER
(
hdr
->
ªgi°îs
,
idx
,
ªgvÆ
);

620 
idx
++;

622 
p
++;

628 i‡(
idx
 !
HLL_REGISTERS
) {

629 
	`sds‰ì
(
dí£
);

630  
C_ERR
;

634 
	`sds‰ì
(
o
->
±r
);

635 
o
->
±r
 = 
dí£
;

636  
C_OK
;

637 
	}
}

654 
	$hŒS∑r£Së
(
robj
 *
o
, 
ödex
, 
uöt8_t
 
cou¡
) {

655 
hŒhdr
 *
hdr
;

656 
uöt8_t
 
ﬁdcou¡
, *
•¨£
, *
íd
, *
p
, *
¥ev
, *
√xt
;

657 
fú°
, 
•™
;

658 
is_zîo
 = 0, 
is_xzîo
 = 0, 
is_vÆ
 = 0, 
ru∆í
 = 0;

662 i‡(
cou¡
 > 
HLL_SPARSE_VAL_MAX_VALUE
Ë
¥omŸe
;

669 
o
->
±r
 = 
	`sdsMakeRoomF‹
(o->ptr,3);

673 
•¨£
 = 
p
 = ((
uöt8_t
*)
o
->
±r
Ë+ 
HLL_HDR_SIZE
;

674 
íd
 = 
p
 + 
	`sd¶í
(
o
->
±r
Ë- 
HLL_HDR_SIZE
;

676 
fú°
 = 0;

677 
¥ev
 = 
NULL
;

678 
√xt
 = 
NULL
;

679 
•™
 = 0;

680 
p
 < 
íd
) {

681 
›Àn
;

688 
›Àn
 = 1;

689 i‡(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

690 
•™
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

691 } i‡(
	`HLL_SPARSE_IS_VAL
(
p
)) {

692 
•™
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

694 
•™
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

695 
›Àn
 = 2;

698 i‡(
ödex
 <
fú°
+
•™
-1) ;

699 
¥ev
 = 
p
;

700 
p
 +
›Àn
;

701 
fú°
 +
•™
;

703 i‡(
•™
 =0 || 
p
 >
íd
)  -1;

705 
√xt
 = 
	`HLL_SPARSE_IS_XZERO
(
p
) ?Ö+2 :Ö+1;

706 i‡(
√xt
 >
íd
Ë√xà
NULL
;

711 i‡(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

712 
is_zîo
 = 1;

713 
ru∆í
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

714 } i‡(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

715 
is_xzîo
 = 1;

716 
ru∆í
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

718 
is_vÆ
 = 1;

719 
ru∆í
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

743 i‡(
is_vÆ
) {

744 
ﬁdcou¡
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

746 i‡(
ﬁdcou¡
 >
cou¡
)  0;

749 i‡(
ru∆í
 == 1) {

750 
	`HLL_SPARSE_VAL_SET
(
p
,
cou¡
,1);

751 
upd©ed
;

757 i‡(
is_zîo
 && 
ru∆í
 == 1) {

758 
	`HLL_SPARSE_VAL_SET
(
p
,
cou¡
,1);

759 
upd©ed
;

777 
uöt8_t
 
£q
[5], *
n
 = seq;

778 
œ°
 = 
fú°
+
•™
-1;

779 
Àn
;

781 i‡(
is_zîo
 || 
is_xzîo
) {

783 i‡(
ödex
 !
fú°
) {

784 
Àn
 = 
ödex
-
fú°
;

785 i‡(
Àn
 > 
HLL_SPARSE_ZERO_MAX_LEN
) {

786 
	`HLL_SPARSE_XZERO_SET
(
n
,
Àn
);

787 
n
 += 2;

789 
	`HLL_SPARSE_ZERO_SET
(
n
,
Àn
);

790 
n
++;

793 
	`HLL_SPARSE_VAL_SET
(
n
,
cou¡
,1);

794 
n
++;

795 i‡(
ödex
 !
œ°
) {

796 
Àn
 = 
œ°
-
ödex
;

797 i‡(
Àn
 > 
HLL_SPARSE_ZERO_MAX_LEN
) {

798 
	`HLL_SPARSE_XZERO_SET
(
n
,
Àn
);

799 
n
 += 2;

801 
	`HLL_SPARSE_ZERO_SET
(
n
,
Àn
);

802 
n
++;

807 
curvÆ
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

809 i‡(
ödex
 !
fú°
) {

810 
Àn
 = 
ödex
-
fú°
;

811 
	`HLL_SPARSE_VAL_SET
(
n
,
curvÆ
,
Àn
);

812 
n
++;

814 
	`HLL_SPARSE_VAL_SET
(
n
,
cou¡
,1);

815 
n
++;

816 i‡(
ödex
 !
œ°
) {

817 
Àn
 = 
œ°
-
ödex
;

818 
	`HLL_SPARSE_VAL_SET
(
n
,
curvÆ
,
Àn
);

819 
n
++;

827 
£qÀn
 = 
n
-
£q
;

828 
ﬁdÀn
 = 
is_xzîo
 ? 2 : 1;

829 
dñèÀn
 = 
£qÀn
-
ﬁdÀn
;

831 i‡(
dñèÀn
 > 0 &&

832 
	`sd¶í
(
o
->
±r
)+
dñèÀn
 > 
£rvî
.
hŒ_•¨£_max_byãs
Ë
¥omŸe
;

833 i‡(
dñèÀn
 && 
√xt
Ë
	`memmove
“ext+dñèÀn,√xt,
íd
-next);

834 
	`sdsIn¸Lí
(
o
->
±r
,
dñèÀn
);

835 
	`mem˝y
(
p
,
£q
,
£qÀn
);

836 
íd
 +
dñèÀn
;

838 
upd©ed
:

844 
p
 = 
¥ev
 ?Öªv : 
•¨£
;

845 
sˇ∆í
 = 5;

846 
p
 < 
íd
 && 
sˇ∆í
--) {

847 i‡(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

848 
p
 += 2;

850 } i‡(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

851 
p
++;

856 i‡(
p
+1 < 
íd
 && 
	`HLL_SPARSE_IS_VAL
(p+1)) {

857 
v1
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

858 
v2
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
+1);

859 i‡(
v1
 =
v2
) {

860 
Àn
 = 
	`HLL_SPARSE_VAL_LEN
(
p
)+HLL_SPARSE_VAL_LEN(p+1);

861 i‡(
Àn
 <
HLL_SPARSE_VAL_MAX_LEN
) {

862 
	`HLL_SPARSE_VAL_SET
(
p
+1,
v1
,
Àn
);

863 
	`memmove
(
p
,p+1,
íd
-p);

864 
	`sdsIn¸Lí
(
o
->
±r
,-1);

865 
íd
--;

873 
p
++;

877 
hdr
 = 
o
->
±r
;

878 
	`HLL_INVALIDATE_CACHE
(
hdr
);

881 
¥omŸe
:

882 i‡(
	`hŒS∑r£ToDí£
(
o
Ë=
C_ERR
)  -1;

883 
hdr
 = 
o
->
±r
;

892 
dí£_ªtvÆ
 = 
	`hŒDí£Së
(
hdr
->
ªgi°îs
,
ödex
,
cou¡
);

893 
	`£rvîAs£π
(
dí£_ªtvÆ
 == 1);

894  
dí£_ªtvÆ
;

895 
	}
}

903 
	$hŒS∑r£Add
(
robj
 *
o
, *
ñe
, 
size_t
 
ñesize
) {

904 
ödex
;

905 
uöt8_t
 
cou¡
 = 
	`hŒP©Lí
(
ñe
,
ñesize
,&
ödex
);

907  
	`hŒS∑r£Së
(
o
,
ödex
,
cou¡
);

908 
	}
}

911 
	$hŒS∑r£RegHi°o
(
uöt8_t
 *
•¨£
, 
•¨£Àn
, *
övÆid
, * 
ªghi°o
) {

912 
idx
 = 0, 
ru∆í
, 
ªgvÆ
;

913 
uöt8_t
 *
íd
 = 
•¨£
+
•¨£Àn
, *
p
 = sparse;

915 
p
 < 
íd
) {

916 i‡(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

917 
ru∆í
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

918 
idx
 +
ru∆í
;

919 
ªghi°o
[0] +
ru∆í
;

920 
p
++;

921 } i‡(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

922 
ru∆í
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

923 
idx
 +
ru∆í
;

924 
ªghi°o
[0] +
ru∆í
;

925 
p
 += 2;

927 
ru∆í
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

928 
ªgvÆ
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

929 
idx
 +
ru∆í
;

930 
ªghi°o
[
ªgvÆ
] +
ru∆í
;

931 
p
++;

934 i‡(
idx
 !
HLL_REGISTERS
 && 
övÆid
) *invalid = 1;

935 
	}
}

945 
	$hŒRawRegHi°o
(
uöt8_t
 *
ªgi°îs
, * 
ªghi°o
) {

946 
uöt64_t
 *
w‹d
 = (uöt64_t*Ë
ªgi°îs
;

947 
uöt8_t
 *
byãs
;

948 
j
;

950 
j
 = 0; j < 
HLL_REGISTERS
/8; j++) {

951 i‡(*
w‹d
 == 0) {

952 
ªghi°o
[0] += 8;

954 
byãs
 = (
uöt8_t
*Ë
w‹d
;

955 
ªghi°o
[
byãs
[0]]++;

956 
ªghi°o
[
byãs
[1]]++;

957 
ªghi°o
[
byãs
[2]]++;

958 
ªghi°o
[
byãs
[3]]++;

959 
ªghi°o
[
byãs
[4]]++;

960 
ªghi°o
[
byãs
[5]]++;

961 
ªghi°o
[
byãs
[6]]++;

962 
ªghi°o
[
byãs
[7]]++;

964 
w‹d
++;

966 
	}
}

971 
	$hŒSigma
(
x
) {

972 i‡(
x
 =1.Ë 
INFINITY
;

973 
zPrime
;

974 
y
 = 1;

975 
z
 = 
x
;

977 
x
 *= x;

978 
zPrime
 = 
z
;

979 
z
 +
x
 * 
y
;

980 
y
 += y;

981 } 
zPrime
 !
z
);

982  
z
;

983 
	}
}

988 
	$hŒTau
(
x
) {

989 i‡(
x
 == 0. || x == 1.)  0.;

990 
zPrime
;

991 
y
 = 1.0;

992 
z
 = 1 - 
x
;

994 
x
 = 
	`sqπ
(x);

995 
zPrime
 = 
z
;

996 
y
 *= 0.5;

997 
z
 -
	`pow
(1 - 
x
, 2)*
y
;

998 } 
zPrime
 !
z
);

999  
z
 / 3;

1000 
	}
}

1013 
uöt64_t
 
	$hŒCou¡
(
hŒhdr
 *
hdr
, *
övÆid
) {

1014 
m
 = 
HLL_REGISTERS
;

1015 
E
;

1016 
j
;

1022 
ªghi°o
[64] = {0};

1025 i‡(
hdr
->
ícodög
 =
HLL_DENSE
) {

1026 
	`hŒDí£RegHi°o
(
hdr
->
ªgi°îs
,
ªghi°o
);

1027 } i‡(
hdr
->
ícodög
 =
HLL_SPARSE
) {

1028 
	`hŒS∑r£RegHi°o
(
hdr
->
ªgi°îs
,

1029 
	`sd¶í
((
sds
)
hdr
)-
HLL_HDR_SIZE
,
övÆid
,
ªghi°o
);

1030 } i‡(
hdr
->
ícodög
 =
HLL_RAW
) {

1031 
	`hŒRawRegHi°o
(
hdr
->
ªgi°îs
,
ªghi°o
);

1033 
	`£rvîP™ic
("Unknown HyperLogLogÉncoding in hllCount()");

1039 
z
 = 
m
 * 
	`hŒTau
((m-
ªghi°o
[
HLL_Q
+1])/()m);

1040 
j
 = 
HLL_Q
; j >= 1; --j) {

1041 
z
 +
ªghi°o
[
j
];

1042 
z
 *= 0.5;

1044 
z
 +
m
 * 
	`hŒSigma
(
ªghi°o
[0]/()m);

1045 
E
 = 
	`Œroundl
(
HLL_ALPHA_INF
*
m
*m/
z
);

1047  (
uöt64_t
Ë
E
;

1048 
	}
}

1051 
	$hŒAdd
(
robj
 *
o
, *
ñe
, 
size_t
 
ñesize
) {

1052 
hŒhdr
 *
hdr
 = 
o
->
±r
;

1053 
hdr
->
ícodög
) {

1054 
HLL_DENSE
:  
	`hŒDí£Add
(
hdr
->
ªgi°îs
,
ñe
,
ñesize
);

1055 
HLL_SPARSE
:  
	`hŒS∑r£Add
(
o
,
ñe
,
ñesize
);

1058 
	}
}

1068 
	$hŒMîge
(
uöt8_t
 *
max
, 
robj
 *
hŒ
) {

1069 
hŒhdr
 *
hdr
 = 
hŒ
->
±r
;

1070 
i
;

1072 i‡(
hdr
->
ícodög
 =
HLL_DENSE
) {

1073 
uöt8_t
 
vÆ
;

1075 
i
 = 0; i < 
HLL_REGISTERS
; i++) {

1076 
	`HLL_DENSE_GET_REGISTER
(
vÆ
,
hdr
->
ªgi°îs
,
i
);

1077 i‡(
vÆ
 > 
max
[
i
]) max[i] = val;

1080 
uöt8_t
 *
p
 = 
hŒ
->
±r
, *
íd
 =Ö + 
	`sd¶í
(hll->ptr);

1081 
ru∆í
, 
ªgvÆ
;

1083 
p
 +
HLL_HDR_SIZE
;

1084 
i
 = 0;

1085 
p
 < 
íd
) {

1086 i‡(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

1087 
ru∆í
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

1088 
i
 +
ru∆í
;

1089 
p
++;

1090 } i‡(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

1091 
ru∆í
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

1092 
i
 +
ru∆í
;

1093 
p
 += 2;

1095 
ru∆í
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

1096 
ªgvÆ
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

1097 i‡((
ru∆í
 + 
i
Ë> 
HLL_REGISTERS
) ;

1098 
ru∆í
--) {

1099 i‡(
ªgvÆ
 > 
max
[
i
]) max[i] =Ñegval;

1100 
i
++;

1102 
p
++;

1105 i‡(
i
 !
HLL_REGISTERS
Ë 
C_ERR
;

1107  
C_OK
;

1108 
	}
}

1114 
robj
 *
	$¸óãHLLObje˘
() {

1115 
robj
 *
o
;

1116 
hŒhdr
 *
hdr
;

1117 
sds
 
s
;

1118 
uöt8_t
 *
p
;

1119 
•¨£Àn
 = 
HLL_HDR_SIZE
 +

1120 (((
HLL_REGISTERS
+(
HLL_SPARSE_XZERO_MAX_LEN
-1)) /

1121 
HLL_SPARSE_XZERO_MAX_LEN
)*2);

1122 
aux
;

1126 
aux
 = 
HLL_REGISTERS
;

1127 
s
 = 
	`sd¢ewÀn
(
NULL
,
•¨£Àn
);

1128 
p
 = (
uöt8_t
*)
s
 + 
HLL_HDR_SIZE
;

1129 
aux
) {

1130 
xzîo
 = 
HLL_SPARSE_XZERO_MAX_LEN
;

1131 i‡(
xzîo
 > 
aux
) xzero =áux;

1132 
	`HLL_SPARSE_XZERO_SET
(
p
,
xzîo
);

1133 
p
 += 2;

1134 
aux
 -
xzîo
;

1136 
	`£rvîAs£π
((
p
-(
uöt8_t
*)
s
Ë=
•¨£Àn
);

1139 
o
 = 
	`¸óãObje˘
(
OBJ_STRING
,
s
);

1140 
hdr
 = 
o
->
±r
;

1141 
	`mem˝y
(
hdr
->
magic
,"HYLL",4);

1142 
hdr
->
ícodög
 = 
HLL_SPARSE
;

1143  
o
;

1144 
	}
}

1149 
	$isHLLObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
) {

1150 
hŒhdr
 *
hdr
;

1153 i‡(
	`checkTy≥
(
c
,
o
,
OBJ_STRING
))

1154  
C_ERR
;

1156 i‡(!
	`sdsEncodedObje˘
(
o
)Ë
övÆid
;

1157 i‡(
	`°rögObje˘Lí
(
o
Ë< (*
hdr
)Ë
övÆid
;

1158 
hdr
 = 
o
->
±r
;

1161 i‡(
hdr
->
magic
[0] != 'H' || hdr->magic[1] != 'Y' ||

1162 
hdr
->
magic
[2] !'L' || hdr->magic[3] !'L'Ë
övÆid
;

1164 i‡(
hdr
->
ícodög
 > 
HLL_MAX_ENCODING
Ë
övÆid
;

1167 i‡(
hdr
->
ícodög
 =
HLL_DENSE
 &&

1168 
	`°rögObje˘Lí
(
o
Ë!
HLL_DENSE_SIZE
Ë
övÆid
;

1171  
C_OK
;

1173 
övÆid
:

1174 
	`addRïlySds
(
c
,

1175 
	`sd¢ew
("-WRONGTYPE Key isÇotá valid "

1177  
C_ERR
;

1178 
	}
}

1181 
	$pÁddComm™d
(
˛õ¡
 *
c
) {

1182 
robj
 *
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

1183 
hŒhdr
 *
hdr
;

1184 
upd©ed
 = 0, 
j
;

1186 i‡(
o
 =
NULL
) {

1190 
o
 = 
	`¸óãHLLObje˘
();

1191 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],
o
);

1192 
upd©ed
++;

1194 i‡(
	`isHLLObje˘OrRïly
(
c
,
o
Ë!
C_OK
) ;

1195 
o
 = 
	`dbUnsh¨eSåögVÆue
(
c
->
db
,c->
¨gv
[1],o);

1198 
j
 = 2; j < 
c
->
¨gc
; j++) {

1199 
ªtvÆ
 = 
	`hŒAdd
(
o
, (*)
c
->
¨gv
[
j
]->
±r
,

1200 
	`sd¶í
(
c
->
¨gv
[
j
]->
±r
));

1201 
ªtvÆ
) {

1203 
upd©ed
++;

1206 
	`addRïlySds
(
c
,
	`sd¢ew
(
övÆid_hŒ_îr
));

1210 
hdr
 = 
o
->
±r
;

1211 i‡(
upd©ed
) {

1212 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

1213 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"pÁdd",
c
->
¨gv
[1],c->
db
->
id
);

1214 
£rvî
.
dúty
++;

1215 
	`HLL_INVALIDATE_CACHE
(
hdr
);

1217 
	`addRïly
(
c
, 
upd©ed
 ? 
sh¨ed
.
c⁄e
 : sh¨ed.
czîo
);

1218 
	}
}

1221 
	$pfcou¡Comm™d
(
˛õ¡
 *
c
) {

1222 
robj
 *
o
;

1223 
hŒhdr
 *
hdr
;

1224 
uöt64_t
 
ˇrd
;

1230 i‡(
c
->
¨gc
 > 2) {

1231 
uöt8_t
 
max
[
HLL_HDR_SIZE
+
HLL_REGISTERS
], *
ªgi°îs
;

1232 
j
;

1235 
	`mem£t
(
max
,0,(max));

1236 
hdr
 = (
hŒhdr
*Ë
max
;

1237 
hdr
->
ícodög
 = 
HLL_RAW
;

1238 
ªgi°îs
 = 
max
 + 
HLL_HDR_SIZE
;

1239 
j
 = 1; j < 
c
->
¨gc
; j++) {

1241 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
j
]);

1242 i‡(
o
 =
NULL
) ;

1243 i‡(
	`isHLLObje˘OrRïly
(
c
,
o
Ë!
C_OK
) ;

1247 i‡(
	`hŒMîge
(
ªgi°îs
,
o
Ë=
C_ERR
) {

1248 
	`addRïlySds
(
c
,
	`sd¢ew
(
övÆid_hŒ_îr
));

1254 
	`addRïlyL⁄gL⁄g
(
c
,
	`hŒCou¡
(
hdr
,
NULL
));

1262 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

1263 i‡(
o
 =
NULL
) {

1266 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

1268 i‡(
	`isHLLObje˘OrRïly
(
c
,
o
Ë!
C_OK
) ;

1269 
o
 = 
	`dbUnsh¨eSåögVÆue
(
c
->
db
,c->
¨gv
[1],o);

1272 
hdr
 = 
o
->
±r
;

1273 i‡(
	`HLL_VALID_CACHE
(
hdr
)) {

1275 
ˇrd
 = (
uöt64_t
)
hdr
->card[0];

1276 
ˇrd
 |(
uöt64_t
)
hdr
->card[1] << 8;

1277 
ˇrd
 |(
uöt64_t
)
hdr
->card[2] << 16;

1278 
ˇrd
 |(
uöt64_t
)
hdr
->card[3] << 24;

1279 
ˇrd
 |(
uöt64_t
)
hdr
->card[4] << 32;

1280 
ˇrd
 |(
uöt64_t
)
hdr
->card[5] << 40;

1281 
ˇrd
 |(
uöt64_t
)
hdr
->card[6] << 48;

1282 
ˇrd
 |(
uöt64_t
)
hdr
->card[7] << 56;

1284 
övÆid
 = 0;

1286 
ˇrd
 = 
	`hŒCou¡
(
hdr
,&
övÆid
);

1287 i‡(
övÆid
) {

1288 
	`addRïlySds
(
c
,
	`sd¢ew
(
övÆid_hŒ_îr
));

1291 
hdr
->
ˇrd
[0] = card & 0xff;

1292 
hdr
->
ˇrd
[1] = (card >> 8) & 0xff;

1293 
hdr
->
ˇrd
[2] = (card >> 16) & 0xff;

1294 
hdr
->
ˇrd
[3] = (card >> 24) & 0xff;

1295 
hdr
->
ˇrd
[4] = (card >> 32) & 0xff;

1296 
hdr
->
ˇrd
[5] = (card >> 40) & 0xff;

1297 
hdr
->
ˇrd
[6] = (card >> 48) & 0xff;

1298 
hdr
->
ˇrd
[7] = (card >> 56) & 0xff;

1303 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

1304 
£rvî
.
dúty
++;

1306 
	`addRïlyL⁄gL⁄g
(
c
,
ˇrd
);

1308 
	}
}

1311 
	$pfmîgeComm™d
(
˛õ¡
 *
c
) {

1312 
uöt8_t
 
max
[
HLL_REGISTERS
];

1313 
hŒhdr
 *
hdr
;

1314 
j
;

1315 
u£_dí£
 = 0;

1320 
	`mem£t
(
max
,0,(max));

1321 
j
 = 1; j < 
c
->
¨gc
; j++) {

1323 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
j
]);

1324 i‡(
o
 =
NULL
) ;

1325 i‡(
	`isHLLObje˘OrRïly
(
c
,
o
Ë!
C_OK
) ;

1329 
hdr
 = 
o
->
±r
;

1330 i‡(
hdr
->
ícodög
 =
HLL_DENSE
Ë
u£_dí£
 = 1;

1334 i‡(
	`hŒMîge
(
max
,
o
Ë=
C_ERR
) {

1335 
	`addRïlySds
(
c
,
	`sd¢ew
(
övÆid_hŒ_îr
));

1341 
robj
 *
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

1342 i‡(
o
 =
NULL
) {

1346 
o
 = 
	`¸óãHLLObje˘
();

1347 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],
o
);

1352 
o
 = 
	`dbUnsh¨eSåögVÆue
(
c
->
db
,c->
¨gv
[1],o);

1357 i‡(
u£_dí£
 && 
	`hŒS∑r£ToDí£
(
o
Ë=
C_ERR
) {

1358 
	`addRïlySds
(
c
,
	`sd¢ew
(
övÆid_hŒ_îr
));

1364 
j
 = 0; j < 
HLL_REGISTERS
; j++) {

1365 i‡(
max
[
j
] == 0) ;

1366 
hdr
 = 
o
->
±r
;

1367 
hdr
->
ícodög
) {

1368 
HLL_DENSE
: 
	`hŒDí£Së
(
hdr
->
ªgi°îs
,
j
,
max
[j]); ;

1369 
HLL_SPARSE
: 
	`hŒS∑r£Së
(
o
,
j
,
max
[j]); ;

1372 
hdr
 = 
o
->
±r
;

1374 
	`HLL_INVALIDATE_CACHE
(
hdr
);

1376 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

1379 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"pÁdd",
c
->
¨gv
[1],c->
db
->
id
);

1380 
£rvî
.
dúty
++;

1381 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1382 
	}
}

1389 
	#HLL_TEST_CYCLES
 1000

	)

1390 
	$pf£l·e°Comm™d
(
˛õ¡
 *
c
) {

1391 
j
, 
i
;

1392 
sds
 
bôcou¡îs
 = 
	`sd¢ewÀn
(
NULL
,
HLL_DENSE_SIZE
);

1393 
hŒhdr
 *
hdr
 = (hŒhdr*Ë
bôcou¡îs
, *
hdr2
;

1394 
robj
 *
o
 = 
NULL
;

1395 
uöt8_t
 
byãcou¡îs
[
HLL_REGISTERS
];

1401 
j
 = 0; j < 
HLL_TEST_CYCLES
; j++) {

1404 
i
 = 0; i < 
HLL_REGISTERS
; i++) {

1405 
r
 = 
	`ønd
(Ë& 
HLL_REGISTER_MAX
;

1407 
byãcou¡îs
[
i
] = 
r
;

1408 
	`HLL_DENSE_SET_REGISTER
(
hdr
->
ªgi°îs
,
i
,
r
);

1411 
i
 = 0; i < 
HLL_REGISTERS
; i++) {

1412 
vÆ
;

1414 
	`HLL_DENSE_GET_REGISTER
(
vÆ
,
hdr
->
ªgi°îs
,
i
);

1415 i‡(
vÆ
 !
byãcou¡îs
[
i
]) {

1416 
	`addRïlyEº‹F‹m©
(
c
,

1418 
i
, (Ë
byãcou¡îs
[i], (Ë
vÆ
);

1419 
˛ónup
;

1434 
	`mem£t
(
hdr
->
ªgi°îs
,0,
HLL_DENSE_SIZE
-
HLL_HDR_SIZE
);

1435 
o
 = 
	`¸óãHLLObje˘
();

1436 
ªÀº
 = 1.04/
	`sqπ
(
HLL_REGISTERS
);

1437 
öt64_t
 
checkpoöt
 = 1;

1438 
uöt64_t
 
£ed
 = (uöt64_t)
	`ønd
() | (uint64_t)rand() << 32;

1439 
uöt64_t
 
ñe
;

1440 
j
 = 1; j <= 10000000; j++) {

1441 
ñe
 = 
j
 ^ 
£ed
;

1442 
	`hŒDí£Add
(
hdr
->
ªgi°îs
,(*)&
ñe
,(ele));

1443 
	`hŒAdd
(
o
,(*)&
ñe
,(ele));

1447 i‡(
j
 =
checkpoöt
 && j < 
£rvî
.
hŒ_•¨£_max_byãs
/2) {

1448 
hdr2
 = 
o
->
±r
;

1449 i‡(
hdr2
->
ícodög
 !
HLL_SPARSE
) {

1450 
	`addRïlyEº‹
(
c
, "TESTFAILED sparseÉncodingÇot used");

1451 
˛ónup
;

1456 i‡(
j
 =
checkpoöt
 && 
	`hŒCou¡
(
hdr
,
NULL
Ë!hŒCou¡(
o
->
±r
,NULL)) {

1457 
	`addRïlyEº‹
(
c
, "TESTFAILED dense/sparse disagree");

1458 
˛ónup
;

1462 i‡(
j
 =
checkpoöt
) {

1463 
öt64_t
 
ab£º
 = 
checkpoöt
 - (öt64_t)
	`hŒCou¡
(
hdr
,
NULL
);

1464 
uöt64_t
 
maxîr
 = 
	`˚û
(
ªÀº
*6*
checkpoöt
);

1470 i‡(
j
 =10Ë
maxîr
 = 1;

1472 i‡(
ab£º
 < 0)ábserr = -abserr;

1473 i‡(
ab£º
 > (
öt64_t
)
maxîr
) {

1474 
	`addRïlyEº‹F‹m©
(
c
,

1476 (Ë
checkpoöt
,

1477 (Ë
ab£º
);

1478 
˛ónup
;

1480 
checkpoöt
 *= 10;

1485 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1487 
˛ónup
:

1488 
	`sds‰ì
(
bôcou¡îs
);

1489 i‡(
o
Ë
	`de¸RefCou¡
(o);

1490 
	}
}

1494 
	$pfdebugComm™d
(
˛õ¡
 *
c
) {

1495 *
cmd
 = 
c
->
¨gv
[1]->
±r
;

1496 
hŒhdr
 *
hdr
;

1497 
robj
 *
o
;

1498 
j
;

1500 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[2]);

1501 i‡(
o
 =
NULL
) {

1502 
	`addRïlyEº‹
(
c
,"The specified key doesÇotÉxist");

1505 i‡(
	`isHLLObje˘OrRïly
(
c
,
o
Ë!
C_OK
) ;

1506 
o
 = 
	`dbUnsh¨eSåögVÆue
(
c
->
db
,c->
¨gv
[2],o);

1507 
hdr
 = 
o
->
±r
;

1510 i‡(!
	`°rˇ£cmp
(
cmd
,"getreg")) {

1511 i‡(
c
->
¨gc
 !3Ë
¨ôyîr
;

1513 i‡(
hdr
->
ícodög
 =
HLL_SPARSE
) {

1514 i‡(
	`hŒS∑r£ToDí£
(
o
Ë=
C_ERR
) {

1515 
	`addRïlySds
(
c
,
	`sd¢ew
(
övÆid_hŒ_îr
));

1518 
£rvî
.
dúty
++;

1521 
hdr
 = 
o
->
±r
;

1522 
	`addRïlyAºayLí
(
c
,
HLL_REGISTERS
);

1523 
j
 = 0; j < 
HLL_REGISTERS
; j++) {

1524 
uöt8_t
 
vÆ
;

1526 
	`HLL_DENSE_GET_REGISTER
(
vÆ
,
hdr
->
ªgi°îs
,
j
);

1527 
	`addRïlyL⁄gL⁄g
(
c
,
vÆ
);

1531 i‡(!
	`°rˇ£cmp
(
cmd
,"decode")) {

1532 i‡(
c
->
¨gc
 !3Ë
¨ôyîr
;

1534 
uöt8_t
 *
p
 = 
o
->
±r
, *
íd
 =Ö+
	`sd¶í
(o->ptr);

1535 
sds
 
decoded
 = 
	`sd£m±y
();

1537 i‡(
hdr
->
ícodög
 !
HLL_SPARSE
) {

1538 
	`sds‰ì
(
decoded
);

1539 
	`addRïlyEº‹
(
c
,"HLLÉncoding isÇot sparse");

1543 
p
 +
HLL_HDR_SIZE
;

1544 
p
 < 
íd
) {

1545 
ru∆í
, 
ªgvÆ
;

1547 i‡(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

1548 
ru∆í
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

1549 
p
++;

1550 
decoded
 = 
	`sdsˇçrötf
(decoded,"z:%d ",
ru∆í
);

1551 } i‡(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

1552 
ru∆í
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

1553 
p
 += 2;

1554 
decoded
 = 
	`sdsˇçrötf
(decoded,"Z:%d ",
ru∆í
);

1556 
ru∆í
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

1557 
ªgvÆ
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

1558 
p
++;

1559 
decoded
 = 
	`sdsˇçrötf
(decoded,"v:%d,%d ",
ªgvÆ
,
ru∆í
);

1562 
decoded
 = 
	`sd°rim
(decoded," ");

1563 
	`addRïlyBulkCBuf„r
(
c
,
decoded
,
	`sd¶í
(decoded));

1564 
	`sds‰ì
(
decoded
);

1567 i‡(!
	`°rˇ£cmp
(
cmd
,"encoding")) {

1568 *
ícodög°r
[2] = {"dense","sparse"};

1569 i‡(
c
->
¨gc
 !3Ë
¨ôyîr
;

1571 
	`addRïlySètus
(
c
,
ícodög°r
[
hdr
->
ícodög
]);

1574 i‡(!
	`°rˇ£cmp
(
cmd
,"todense")) {

1575 
c⁄v
 = 0;

1576 i‡(
c
->
¨gc
 !3Ë
¨ôyîr
;

1578 i‡(
hdr
->
ícodög
 =
HLL_SPARSE
) {

1579 i‡(
	`hŒS∑r£ToDí£
(
o
Ë=
C_ERR
) {

1580 
	`addRïlySds
(
c
,
	`sd¢ew
(
övÆid_hŒ_îr
));

1583 
c⁄v
 = 1;

1584 
£rvî
.
dúty
++;

1586 
	`addRïly
(
c
,
c⁄v
 ? 
sh¨ed
.
c⁄e
 : sh¨ed.
czîo
);

1588 
	`addRïlyEº‹F‹m©
(
c
,"Unknow¿PFDEBUG subcomm™d '%s'", 
cmd
);

1592 
¨ôyîr
:

1593 
	`addRïlyEº‹F‹m©
(
c
,

1594 "Wr⁄gÇumbî o‡¨gumít†f‹Åhê'%s' subcomm™d",
cmd
);

1595 
	}
}

	@intset.c

31 
	~<°dio.h
>

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~"öt£t.h
"

35 
	~"zmÆloc.h
"

36 
	~"ídünc⁄v.h
"

40 
	#INTSET_ENC_INT16
 ((
öt16_t
))

	)

41 
	#INTSET_ENC_INT32
 ((
öt32_t
))

	)

42 
	#INTSET_ENC_INT64
 ((
öt64_t
))

	)

45 
uöt8_t
 
	$_öt£tVÆueEncodög
(
öt64_t
 
v
) {

46 i‡(
v
 < 
INT32_MIN
 || v > 
INT32_MAX
)

47  
INTSET_ENC_INT64
;

48 i‡(
v
 < 
INT16_MIN
 || v > 
INT16_MAX
)

49  
INTSET_ENC_INT32
;

51  
INTSET_ENC_INT16
;

52 
	}
}

55 
öt64_t
 
	$_öt£tGëEncoded
(
öt£t
 *
is
, 
pos
, 
uöt8_t
 
íc
) {

56 
öt64_t
 
v64
;

57 
öt32_t
 
v32
;

58 
öt16_t
 
v16
;

60 i‡(
íc
 =
INTSET_ENC_INT64
) {

61 
	`mem˝y
(&
v64
,((
öt64_t
*)
is
->
c⁄ã¡s
)+
pos
,(v64));

62 
	`memªv64ifbe
(&
v64
);

63  
v64
;

64 } i‡(
íc
 =
INTSET_ENC_INT32
) {

65 
	`mem˝y
(&
v32
,((
öt32_t
*)
is
->
c⁄ã¡s
)+
pos
,(v32));

66 
	`memªv32ifbe
(&
v32
);

67  
v32
;

69 
	`mem˝y
(&
v16
,((
öt16_t
*)
is
->
c⁄ã¡s
)+
pos
,(v16));

70 
	`memªv16ifbe
(&
v16
);

71  
v16
;

73 
	}
}

76 
öt64_t
 
	$_öt£tGë
(
öt£t
 *
is
, 
pos
) {

77  
	`_öt£tGëEncoded
(
is
,
pos
,
	`öåev32ifbe
(is->
ícodög
));

78 
	}
}

81 
	$_öt£tSë
(
öt£t
 *
is
, 
pos
, 
öt64_t
 
vÆue
) {

82 
uöt32_t
 
ícodög
 = 
	`öåev32ifbe
(
is
->encoding);

84 i‡(
ícodög
 =
INTSET_ENC_INT64
) {

85 ((
öt64_t
*)
is
->
c⁄ã¡s
)[
pos
] = 
vÆue
;

86 
	`memªv64ifbe
(((
öt64_t
*)
is
->
c⁄ã¡s
)+
pos
);

87 } i‡(
ícodög
 =
INTSET_ENC_INT32
) {

88 ((
öt32_t
*)
is
->
c⁄ã¡s
)[
pos
] = 
vÆue
;

89 
	`memªv32ifbe
(((
öt32_t
*)
is
->
c⁄ã¡s
)+
pos
);

91 ((
öt16_t
*)
is
->
c⁄ã¡s
)[
pos
] = 
vÆue
;

92 
	`memªv16ifbe
(((
öt16_t
*)
is
->
c⁄ã¡s
)+
pos
);

94 
	}
}

97 
öt£t
 *
	$öt£tNew
() {

98 
öt£t
 *
is
 = 
	`zmÆloc
((intset));

99 
is
->
ícodög
 = 
	`öåev32ifbe
(
INTSET_ENC_INT16
);

100 
is
->
Àngth
 = 0;

101  
is
;

102 
	}
}

105 
öt£t
 *
	$öt£tResize
(
öt£t
 *
is
, 
uöt32_t
 
Àn
) {

106 
uöt32_t
 
size
 = 
Àn
*
	`öåev32ifbe
(
is
->
ícodög
);

107 
is
 = 
	`zªÆloc
(is,(
öt£t
)+
size
);

108  
is
;

109 
	}
}

115 
uöt8_t
 
	$öt£tSórch
(
öt£t
 *
is
, 
öt64_t
 
vÆue
, 
uöt32_t
 *
pos
) {

116 
mö
 = 0, 
max
 = 
	`öåev32ifbe
(
is
->
Àngth
)-1, 
mid
 = -1;

117 
öt64_t
 
cur
 = -1;

120 i‡(
	`öåev32ifbe
(
is
->
Àngth
) == 0) {

121 i‡(
pos
) *pos = 0;

126 i‡(
vÆue
 > 
	`_öt£tGë
(
is
,
max
)) {

127 i‡(
pos
Ë*po†
	`öåev32ifbe
(
is
->
Àngth
);

129 } i‡(
vÆue
 < 
	`_öt£tGë
(
is
,0)) {

130 i‡(
pos
) *pos = 0;

135 
max
 >
mö
) {

136 
mid
 = (()
mö
 + ()
max
) >> 1;

137 
cur
 = 
	`_öt£tGë
(
is
,
mid
);

138 i‡(
vÆue
 > 
cur
) {

139 
mö
 = 
mid
+1;

140 } i‡(
vÆue
 < 
cur
) {

141 
max
 = 
mid
-1;

147 i‡(
vÆue
 =
cur
) {

148 i‡(
pos
Ë*po†
mid
;

151 i‡(
pos
Ë*po†
mö
;

154 
	}
}

157 
öt£t
 *
	$öt£tUpgødeAndAdd
(
öt£t
 *
is
, 
öt64_t
 
vÆue
) {

158 
uöt8_t
 
cuªnc
 = 
	`öåev32ifbe
(
is
->
ícodög
);

159 
uöt8_t
 
√wíc
 = 
	`_öt£tVÆueEncodög
(
vÆue
);

160 
Àngth
 = 
	`öåev32ifbe
(
is
->length);

161 
¥ïíd
 = 
vÆue
 < 0 ? 1 : 0;

164 
is
->
ícodög
 = 
	`öåev32ifbe
(
√wíc
);

165 
is
 = 
	`öt£tResize
(is,
	`öåev32ifbe
(is->
Àngth
)+1);

170 
Àngth
--)

171 
	`_öt£tSë
(
is
,
Àngth
+
¥ïíd
,
	`_öt£tGëEncoded
(is,Àngth,
cuªnc
));

174 i‡(
¥ïíd
)

175 
	`_öt£tSë
(
is
,0,
vÆue
);

177 
	`_öt£tSë
(
is
,
	`öåev32ifbe
(is->
Àngth
),
vÆue
);

178 
is
->
Àngth
 = 
	`öåev32ifbe
(intrev32ifbe(is->length)+1);

179  
is
;

180 
	}
}

182 
	$öt£tMoveTaû
(
öt£t
 *
is
, 
uöt32_t
 
‰om
, uöt32_à
to
) {

183 *
§c
, *
d°
;

184 
uöt32_t
 
byãs
 = 
	`öåev32ifbe
(
is
->
Àngth
)-
‰om
;

185 
uöt32_t
 
ícodög
 = 
	`öåev32ifbe
(
is
->encoding);

187 i‡(
ícodög
 =
INTSET_ENC_INT64
) {

188 
§c
 = (
öt64_t
*)
is
->
c⁄ã¡s
+
‰om
;

189 
d°
 = (
öt64_t
*)
is
->
c⁄ã¡s
+
to
;

190 
byãs
 *(
öt64_t
);

191 } i‡(
ícodög
 =
INTSET_ENC_INT32
) {

192 
§c
 = (
öt32_t
*)
is
->
c⁄ã¡s
+
‰om
;

193 
d°
 = (
öt32_t
*)
is
->
c⁄ã¡s
+
to
;

194 
byãs
 *(
öt32_t
);

196 
§c
 = (
öt16_t
*)
is
->
c⁄ã¡s
+
‰om
;

197 
d°
 = (
öt16_t
*)
is
->
c⁄ã¡s
+
to
;

198 
byãs
 *(
öt16_t
);

200 
	`memmove
(
d°
,
§c
,
byãs
);

201 
	}
}

204 
öt£t
 *
	$öt£tAdd
(
öt£t
 *
is
, 
öt64_t
 
vÆue
, 
uöt8_t
 *
suc˚ss
) {

205 
uöt8_t
 
vÆíc
 = 
	`_öt£tVÆueEncodög
(
vÆue
);

206 
uöt32_t
 
pos
;

207 i‡(
suc˚ss
) *success = 1;

212 i‡(
vÆíc
 > 
	`öåev32ifbe
(
is
->
ícodög
)) {

214  
	`öt£tUpgødeAndAdd
(
is
,
vÆue
);

219 i‡(
	`öt£tSórch
(
is
,
vÆue
,&
pos
)) {

220 i‡(
suc˚ss
) *success = 0;

221  
is
;

224 
is
 = 
	`öt£tResize
(is,
	`öåev32ifbe
(is->
Àngth
)+1);

225 i‡(
pos
 < 
	`öåev32ifbe
(
is
->
Àngth
)Ë
	`öt£tMoveTaû
(is,pos,pos+1);

228 
	`_öt£tSë
(
is
,
pos
,
vÆue
);

229 
is
->
Àngth
 = 
	`öåev32ifbe
(intrev32ifbe(is->length)+1);

230  
is
;

231 
	}
}

234 
öt£t
 *
	$öt£tRemove
(
öt£t
 *
is
, 
öt64_t
 
vÆue
, *
suc˚ss
) {

235 
uöt8_t
 
vÆíc
 = 
	`_öt£tVÆueEncodög
(
vÆue
);

236 
uöt32_t
 
pos
;

237 i‡(
suc˚ss
) *success = 0;

239 i‡(
vÆíc
 <
	`öåev32ifbe
(
is
->
ícodög
Ë&& 
	`öt£tSórch
(is,
vÆue
,&
pos
)) {

240 
uöt32_t
 
Àn
 = 
	`öåev32ifbe
(
is
->
Àngth
);

243 i‡(
suc˚ss
) *success = 1;

246 i‡(
pos
 < (
Àn
-1)Ë
	`öt£tMoveTaû
(
is
,pos+1,pos);

247 
is
 = 
	`öt£tResize
(is,
Àn
-1);

248 
is
->
Àngth
 = 
	`öåev32ifbe
(
Àn
-1);

250  
is
;

251 
	}
}

254 
uöt8_t
 
	$öt£tFöd
(
öt£t
 *
is
, 
öt64_t
 
vÆue
) {

255 
uöt8_t
 
vÆíc
 = 
	`_öt£tVÆueEncodög
(
vÆue
);

256  
vÆíc
 <
	`öåev32ifbe
(
is
->
ícodög
Ë&& 
	`öt£tSórch
(is,
vÆue
,
NULL
);

257 
	}
}

260 
öt64_t
 
	$öt£tR™dom
(
öt£t
 *
is
) {

261  
	`_öt£tGë
(
is
,
	`ønd
()%
	`öåev32ifbe
(is->
Àngth
));

262 
	}
}

266 
uöt8_t
 
	$öt£tGë
(
öt£t
 *
is
, 
uöt32_t
 
pos
, 
öt64_t
 *
vÆue
) {

267 i‡(
pos
 < 
	`öåev32ifbe
(
is
->
Àngth
)) {

268 *
vÆue
 = 
	`_öt£tGë
(
is
,
pos
);

272 
	}
}

275 
uöt32_t
 
	$öt£tLí
(c⁄° 
öt£t
 *
is
) {

276  
	`öåev32ifbe
(
is
->
Àngth
);

277 
	}
}

280 
size_t
 
	$öt£tBlobLí
(
öt£t
 *
is
) {

281  (
öt£t
)+
	`öåev32ifbe
(
is
->
Àngth
)*öåev32ifbe(is->
ícodög
);

282 
	}
}

284 #ifde‡
REDIS_TEST


285 
	~<sys/time.h
>

286 
	~<time.h
>

289 
	$öt£tRïr
(
öt£t
 *
is
) {

290 
uöt32_t
 
i
 = 0; i < 
	`öåev32ifbe
(
is
->
Àngth
); i++) {

291 
	`¥ötf
("%Œd\n", (
uöt64_t
)
	`_öt£tGë
(
is
,
i
));

293 
	`¥ötf
("\n");

294 
	}
}

296 
	$îr‹
(*
îr
) {

297 
	`¥ötf
("%s\n", 
îr
);

298 
	`exô
(1);

299 
	}
}

302 
	$ok
() {

303 
	`¥ötf
("OK\n");

304 
	}
}

306 
	$u£c
() {

307 
timevÆ
 
tv
;

308 
	`gëtimeofday
(&
tv
,
NULL
);

309  ((()
tv
.
tv_£c
)*1000000)+tv.
tv_u£c
;

310 
	}
}

312 
	#as£π
(
_e
Ë((_e)?()0:(
	`_as£π
(#_e,
__FILE__
,
__LINE__
),
	`exô
(1)))

	)

313 
	$_as£π
(*
e°r
, *
fûe
, 
löe
) {

314 
	`¥ötf
("\n\n=== ASSERTION FAILED ===\n");

315 
	`¥ötf
("==> %s:%d '%s' i†nŸÅrue\n",
fûe
,
löe
,
e°r
);

316 
	}
}

318 
öt£t
 *
	$¸óãSë
(
bôs
, 
size
) {

319 
uöt64_t
 
mask
 = (1<<
bôs
)-1;

320 
uöt64_t
 
vÆue
;

321 
öt£t
 *
is
 = 
	`öt£tNew
();

323 
i
 = 0; i < 
size
; i++) {

324 i‡(
bôs
 > 32) {

325 
vÆue
 = (
	`ønd
()*ønd()Ë& 
mask
;

327 
vÆue
 = 
	`ønd
(Ë& 
mask
;

329 
is
 = 
	`öt£tAdd
(is,
vÆue
,
NULL
);

331  
is
;

332 
	}
}

334 
	$checkC⁄si°ícy
(
öt£t
 *
is
) {

335 
uöt32_t
 
i
 = 0; i < (
	`öåev32ifbe
(
is
->
Àngth
)-1); i++) {

336 
uöt32_t
 
ícodög
 = 
	`öåev32ifbe
(
is
->encoding);

338 i‡(
ícodög
 =
INTSET_ENC_INT16
) {

339 
öt16_t
 *
i16
 = (öt16_t*)
is
->
c⁄ã¡s
;

340 
	`as£π
(
i16
[
i
] < i16[i+1]);

341 } i‡(
ícodög
 =
INTSET_ENC_INT32
) {

342 
öt32_t
 *
i32
 = (öt32_t*)
is
->
c⁄ã¡s
;

343 
	`as£π
(
i32
[
i
] < i32[i+1]);

345 
öt64_t
 *
i64
 = (öt64_t*)
is
->
c⁄ã¡s
;

346 
	`as£π
(
i64
[
i
] < i64[i+1]);

349 
	}
}

351 
	#UNUSED
(
x
Ë()(x)

	)

352 
	$öt£tTe°
(
¨gc
, **
¨gv
) {

353 
uöt8_t
 
suc˚ss
;

354 
i
;

355 
öt£t
 *
is
;

356 
	`§™d
(
	`time
(
NULL
));

358 
	`UNUSED
(
¨gc
);

359 
	`UNUSED
(
¨gv
);

361 
	`¥ötf
("ValueÉncodings: "); {

362 
	`as£π
(
	`_öt£tVÆueEncodög
(-32768Ë=
INTSET_ENC_INT16
);

363 
	`as£π
(
	`_öt£tVÆueEncodög
(+32767Ë=
INTSET_ENC_INT16
);

364 
	`as£π
(
	`_öt£tVÆueEncodög
(-32769Ë=
INTSET_ENC_INT32
);

365 
	`as£π
(
	`_öt£tVÆueEncodög
(+32768Ë=
INTSET_ENC_INT32
);

366 
	`as£π
(
	`_öt£tVÆueEncodög
(-2147483648Ë=
INTSET_ENC_INT32
);

367 
	`as£π
(
	`_öt£tVÆueEncodög
(+2147483647Ë=
INTSET_ENC_INT32
);

368 
	`as£π
(
	`_öt£tVÆueEncodög
(-2147483649Ë=
INTSET_ENC_INT64
);

369 
	`as£π
(
	`_öt£tVÆueEncodög
(+2147483648Ë=
INTSET_ENC_INT64
);

370 
	`as£π
(
	`_öt£tVÆueEncodög
(-9223372036854775808ull) ==

371 
INTSET_ENC_INT64
);

372 
	`as£π
(
	`_öt£tVÆueEncodög
(+9223372036854775807ull) ==

373 
INTSET_ENC_INT64
);

374 
	`ok
();

377 
	`¥ötf
("Basicádding: "); {

378 
is
 = 
	`öt£tNew
();

379 
is
 = 
	`öt£tAdd
(is,5,&
suc˚ss
); 
	`as£π
(success);

380 
is
 = 
	`öt£tAdd
(is,6,&
suc˚ss
); 
	`as£π
(success);

381 
is
 = 
	`öt£tAdd
(is,4,&
suc˚ss
); 
	`as£π
(success);

382 
is
 = 
	`öt£tAdd
(is,4,&
suc˚ss
); 
	`as£π
(!success);

383 
	`ok
();

386 
	`¥ötf
("LargeÇumber ofÑandomádds: "); {

387 
uöt32_t
 
ö£πs
 = 0;

388 
is
 = 
	`öt£tNew
();

389 
i
 = 0; i < 1024; i++) {

390 
is
 = 
	`öt£tAdd
(is,
	`ønd
()%0x800,&
suc˚ss
);

391 i‡(
suc˚ss
Ë
ö£πs
++;

393 
	`as£π
(
	`öåev32ifbe
(
is
->
Àngth
Ë=
ö£πs
);

394 
	`checkC⁄si°ícy
(
is
);

395 
	`ok
();

398 
	`¥ötf
("Upgrade from int16Åo int32: "); {

399 
is
 = 
	`öt£tNew
();

400 
is
 = 
	`öt£tAdd
(is,32,
NULL
);

401 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT16
);

402 
is
 = 
	`öt£tAdd
(is,65535,
NULL
);

403 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT32
);

404 
	`as£π
(
	`öt£tFöd
(
is
,32));

405 
	`as£π
(
	`öt£tFöd
(
is
,65535));

406 
	`checkC⁄si°ícy
(
is
);

408 
is
 = 
	`öt£tNew
();

409 
is
 = 
	`öt£tAdd
(is,32,
NULL
);

410 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT16
);

411 
is
 = 
	`öt£tAdd
(is,-65535,
NULL
);

412 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT32
);

413 
	`as£π
(
	`öt£tFöd
(
is
,32));

414 
	`as£π
(
	`öt£tFöd
(
is
,-65535));

415 
	`checkC⁄si°ícy
(
is
);

416 
	`ok
();

419 
	`¥ötf
("Upgrade from int16Åo int64: "); {

420 
is
 = 
	`öt£tNew
();

421 
is
 = 
	`öt£tAdd
(is,32,
NULL
);

422 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT16
);

423 
is
 = 
	`öt£tAdd
(is,4294967295,
NULL
);

424 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT64
);

425 
	`as£π
(
	`öt£tFöd
(
is
,32));

426 
	`as£π
(
	`öt£tFöd
(
is
,4294967295));

427 
	`checkC⁄si°ícy
(
is
);

429 
is
 = 
	`öt£tNew
();

430 
is
 = 
	`öt£tAdd
(is,32,
NULL
);

431 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT16
);

432 
is
 = 
	`öt£tAdd
(is,-4294967295,
NULL
);

433 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT64
);

434 
	`as£π
(
	`öt£tFöd
(
is
,32));

435 
	`as£π
(
	`öt£tFöd
(
is
,-4294967295));

436 
	`checkC⁄si°ícy
(
is
);

437 
	`ok
();

440 
	`¥ötf
("Upgrade from int32Åo int64: "); {

441 
is
 = 
	`öt£tNew
();

442 
is
 = 
	`öt£tAdd
(is,65535,
NULL
);

443 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT32
);

444 
is
 = 
	`öt£tAdd
(is,4294967295,
NULL
);

445 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT64
);

446 
	`as£π
(
	`öt£tFöd
(
is
,65535));

447 
	`as£π
(
	`öt£tFöd
(
is
,4294967295));

448 
	`checkC⁄si°ícy
(
is
);

450 
is
 = 
	`öt£tNew
();

451 
is
 = 
	`öt£tAdd
(is,65535,
NULL
);

452 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT32
);

453 
is
 = 
	`öt£tAdd
(is,-4294967295,
NULL
);

454 
	`as£π
(
	`öåev32ifbe
(
is
->
ícodög
Ë=
INTSET_ENC_INT64
);

455 
	`as£π
(
	`öt£tFöd
(
is
,65535));

456 
	`as£π
(
	`öt£tFöd
(
is
,-4294967295));

457 
	`checkC⁄si°ícy
(
is
);

458 
	`ok
();

461 
	`¥ötf
("StressÜookups: "); {

462 
num
 = 100000, 
size
 = 10000;

463 
i
, 
bôs
 = 20;

464 
°¨t
;

465 
is
 = 
	`¸óãSë
(
bôs
,
size
);

466 
	`checkC⁄si°ícy
(
is
);

468 
°¨t
 = 
	`u£c
();

469 
i
 = 0; i < 
num
; i++Ë
	`öt£tSórch
(
is
,
	`ønd
(Ë% ((1<<
bôs
)-1),
NULL
);

470 
	`¥ötf
("%ldÜookups, %ldÉlement set, %lldusec\n",

471 
num
,
size
,
	`u£c
()-
°¨t
);

474 
	`¥ötf
("Stressádd+delete: "); {

475 
i
, 
v1
, 
v2
;

476 
is
 = 
	`öt£tNew
();

477 
i
 = 0; i < 0xffff; i++) {

478 
v1
 = 
	`ønd
() % 0xfff;

479 
is
 = 
	`öt£tAdd
(is,
v1
,
NULL
);

480 
	`as£π
(
	`öt£tFöd
(
is
,
v1
));

482 
v2
 = 
	`ønd
() % 0xfff;

483 
is
 = 
	`öt£tRemove
(is,
v2
,
NULL
);

484 
	`as£π
(!
	`öt£tFöd
(
is
,
v2
));

486 
	`checkC⁄si°ícy
(
is
);

487 
	`ok
();

491 
	}
}

	@intset.h

31 #i‚de‡
__INTSET_H


32 
	#__INTSET_H


	)

33 
	~<°döt.h
>

35 
	söt£t
 {

36 
uöt32_t
 
	mícodög
;

37 
uöt32_t
 
	mÀngth
;

38 
öt8_t
 
	mc⁄ã¡s
[];

39 } 
	töt£t
;

41 
öt£t
 *
öt£tNew
();

42 
öt£t
 *
öt£tAdd
(öt£à*
is
, 
öt64_t
 
vÆue
, 
uöt8_t
 *
suc˚ss
);

43 
öt£t
 *
öt£tRemove
(öt£à*
is
, 
öt64_t
 
vÆue
, *
suc˚ss
);

44 
uöt8_t
 
öt£tFöd
(
öt£t
 *
is
, 
öt64_t
 
vÆue
);

45 
öt64_t
 
öt£tR™dom
(
öt£t
 *
is
);

46 
uöt8_t
 
öt£tGë
(
öt£t
 *
is
, 
uöt32_t
 
pos
, 
öt64_t
 *
vÆue
);

47 
uöt32_t
 
öt£tLí
(c⁄° 
öt£t
 *
is
);

48 
size_t
 
öt£tBlobLí
(
öt£t
 *
is
);

50 #ifde‡
REDIS_TEST


51 
öt£tTe°
(
¨gc
, *
¨gv
[]);

	@latency.c

36 
	~"£rvî.h
"

39 
	$di˘SåögKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
, c⁄° *
key2
) {

40 
	`UNUSED
(
¥ivd©a
);

41  
	`°rcmp
(
key1
,
key2
) == 0;

42 
	}
}

44 
uöt64_t
 
	$di˘SåögHash
(c⁄° *
key
) {

45  
	`di˘GíHashFun˘i⁄
(
key
, 
	`°æí
(key));

46 
	}
}

48 
di˘V™ûœFªe
(*
¥ivd©a
, *
vÆ
);

50 
di˘Ty≥
 
	gœãncyTimeSîõsDi˘Ty≥
 = {

51 
di˘SåögHash
,

52 
NULL
,

53 
NULL
,

54 
di˘SåögKeyCom∑ª
,

55 
di˘V™ûœFªe
,

56 
di˘V™ûœFªe


61 #ifde‡
__löux__


64 
	$THPIsE«bÀd
() {

65 
buf
[1024];

67 
FILE
 *
Â
 = 
	`f›í
("/sys/kernel/mm/transparent_hugepage/enabled","r");

68 i‡(!
Â
)  0;

69 i‡(
	`fgës
(
buf
,(buf),
Â
Ë=
NULL
) {

70 
	`f˛o£
(
Â
);

73 
	`f˛o£
(
Â
);

74  (
	`°r°r
(
buf
,"[√vî]"Ë=
NULL
) ? 1 : 0;

75 
	}
}

81 
	$THPGëAn⁄HugePagesSize
() {

82  
	`zmÆloc_gë_sm≠_byãs_by_fõld
("AnonHugePages:",-1);

83 
	}
}

90 
	$œãncyM⁄ô‹Inô
() {

91 
£rvî
.
œãncy_evíts
 = 
	`di˘Cª©e
(&
œãncyTimeSîõsDi˘Ty≥
,
NULL
);

92 
	}
}

98 
	$œãncyAddSam∂e
(c⁄° *
evít
, 
m°ime_t
 
œãncy
) {

99 
œãncyTimeSîõs
 *
ts
 = 
	`di˘FëchVÆue
(
£rvî
.
œãncy_evíts
,
evít
);

100 
time_t
 
now
 = 
	`time
(
NULL
);

101 
¥ev
;

104 i‡(
ts
 =
NULL
) {

105 
ts
 = 
	`zmÆloc
((*ts));

106 
ts
->
idx
 = 0;

107 
ts
->
max
 = 0;

108 
	`mem£t
(
ts
->
ßm∂es
,0,(ts->samples));

109 
	`di˘Add
(
£rvî
.
œãncy_evíts
,
	`z°rdup
(
evít
),
ts
);

112 i‡(
œãncy
 > 
ts
->
max
)Ås->max =Üatency;

116 
¥ev
 = (
ts
->
idx
 + 
LATENCY_TS_LEN
 - 1) % LATENCY_TS_LEN;

117 i‡(
ts
->
ßm∂es
[
¥ev
].
time
 =
now
) {

118 i‡(
œãncy
 > 
ts
->
ßm∂es
[
¥ev
].latency)

119 
ts
->
ßm∂es
[
¥ev
].
œãncy
 =Üatency;

123 
ts
->
ßm∂es
[ts->
idx
].
time
 = 
	`time
(
NULL
);

124 
ts
->
ßm∂es
[ts->
idx
].
œãncy
 =Üatency;

126 
ts
->
idx
++;

127 i‡(
ts
->
idx
 =
LATENCY_TS_LEN
)Ås->idx = 0;

128 
	}
}

135 
	$œãncyRe£tEvít
(*
evít_to_ª£t
) {

136 
di˘Iãøt‹
 *
di
;

137 
di˘E¡ry
 *
de
;

138 
ª£ts
 = 0;

140 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
œãncy_evíts
);

141 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

142 *
evít
 = 
	`di˘GëKey
(
de
);

144 i‡(
evít_to_ª£t
 =
NULL
 || 
	`°rˇ£cmp
(
evít
,event_to_reset) == 0) {

145 
	`di˘Dñëe
(
£rvî
.
œãncy_evíts
, 
evít
);

146 
ª£ts
++;

149 
	`di˘Rñó£Iãøt‹
(
di
);

150  
ª£ts
;

151 
	}
}

160 
	$™ÆyzeL©ícyF‹Evít
(*
evít
, 
œãncySèts
 *
ls
) {

161 
œãncyTimeSîõs
 *
ts
 = 
	`di˘FëchVÆue
(
£rvî
.
œãncy_evíts
,
evít
);

162 
j
;

163 
uöt64_t
 
sum
;

165 
ls
->
Æl_time_high
 = 
ts
 ?Ås->
max
 : 0;

166 
ls
->
avg
 = 0;

167 
ls
->
mö
 = 0;

168 
ls
->
max
 = 0;

169 
ls
->
mad
 = 0;

170 
ls
->
ßm∂es
 = 0;

171 
ls
->
≥riod
 = 0;

172 i‡(!
ts
) ;

175 
sum
 = 0;

176 
j
 = 0; j < 
LATENCY_TS_LEN
; j++) {

177 i‡(
ts
->
ßm∂es
[
j
].
time
 == 0) ;

178 
ls
->
ßm∂es
++;

179 i‡(
ls
->
ßm∂es
 == 1) {

180 
ls
->
mö
 =Üs->
max
 = 
ts
->
ßm∂es
[
j
].
œãncy
;

182 i‡(
ls
->
mö
 > 
ts
->
ßm∂es
[
j
].
œãncy
)

183 
ls
->
mö
 = 
ts
->
ßm∂es
[
j
].
œãncy
;

184 i‡(
ls
->
max
 < 
ts
->
ßm∂es
[
j
].
œãncy
)

185 
ls
->
max
 = 
ts
->
ßm∂es
[
j
].
œãncy
;

187 
sum
 +
ts
->
ßm∂es
[
j
].
œãncy
;

190 i‡(
ls
->
≥riod
 =0 || 
ts
->
ßm∂es
[
j
].
time
 <Üs->period)

191 
ls
->
≥riod
 = 
ts
->
ßm∂es
[
j
].
time
;

197 i‡(
ls
->
ßm∂es
) {

198 
ls
->
avg
 = 
sum
 /Üs->
ßm∂es
;

199 
ls
->
≥riod
 = 
	`time
(
NULL
) -Üs->period;

200 i‡(
ls
->
≥riod
 == 0)Üs->period = 1;

204 
sum
 = 0;

205 
j
 = 0; j < 
LATENCY_TS_LEN
; j++) {

206 
öt64_t
 
dñè
;

208 i‡(
ts
->
ßm∂es
[
j
].
time
 == 0) ;

209 
dñè
 = (
öt64_t
)
ls
->
avg
 - 
ts
->
ßm∂es
[
j
].
œãncy
;

210 i‡(
dñè
 < 0) delta = -delta;

211 
sum
 +
dñè
;

213 i‡(
ls
->
ßm∂es
Ëls->
mad
 = 
sum
 /Üs->samples;

214 
	}
}

217 
sds
 
	$¸óãL©ícyRï‹t
() {

218 
sds
 
ªp‹t
 = 
	`sd£m±y
();

219 
advi£_bëãr_vm
 = 0;

220 
advi£_¶owlog_íabÀd
 = 0;

221 
advi£_¶owlog_tunög
 = 0;

222 
advi£_¶owlog_ö•e˘
 = 0;

223 
advi£_disk_c⁄ã¡i⁄
 = 0;

224 
advi£_scheduÀr
 = 0;

225 
advi£_d©a_wrôeback
 = 0;

226 
advi£_no_≠≥ndfsync
 = 0;

227 
advi£_loˇl_disk
 = 0;

228 
advi£_ssd
 = 0;

229 
advi£_wrôe_lﬂd_öfo
 = 0;

230 
advi£_hz
 = 0;

231 
advi£_œrge_obje˘s
 = 0;

232 
advi£_mass_evi˘i⁄
 = 0;

233 
advi£_ªœx_fsync_pﬁicy
 = 0;

234 
advi£_dißbÀ_thp
 = 0;

235 
advi˚s
 = 0;

239 i‡(
	`di˘Size
(
£rvî
.
œãncy_evíts
) == 0 &&

240 
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
 == 0)

242 
ªp‹t
 = 
	`sdsˇt
(report,"I'm sorry, Dave, I can't doÅhat. Latency monitoring is disabled inÅhis Redis instance. You may use \"CONFIG SETÜatency-monitor-threshold <milliseconds>.\" in orderÅoÉnable it. If we weren't iná deep space mission I'd suggestÅoÅakeáÜookát http://redis.io/topics/latency-monitor.\n");

243  
ªp‹t
;

248 
di˘Iãøt‹
 *
di
;

249 
di˘E¡ry
 *
de
;

250 
evíäum
 = 0;

252 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
œãncy_evíts
);

253 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

254 *
evít
 = 
	`di˘GëKey
(
de
);

255 
œãncyTimeSîõs
 *
ts
 = 
	`di˘GëVÆ
(
de
);

256 
œãncySèts
 
ls
;

258 i‡(
ts
 =
NULL
) ;

259 
evíäum
++;

260 i‡(
evíäum
 == 1) {

261 
ªp‹t
 = 
	`sdsˇt
(report,"Dave, I have observedÜatency spikes inÅhis Redis instance. You don't mindÅalkingábout it, do you Dave?\n\n");

263 
	`™ÆyzeL©ícyF‹Evít
(
evít
,&
ls
);

265 
ªp‹t
 = 
	`sdsˇçrötf
(report,

267 
evíäum
, 
evít
,

268 
ls
.
ßm∂es
,

269 (Ë
ls
.
avg
,

270 (Ë
ls
.
mad
,

271 (Ë
ls
.
≥riod
/ls.
ßm∂es
,

272 (Ë
ts
->
max
);

275 i‡(!
	`°rˇ£cmp
(
evít
,"fork")) {

276 *
f‹k_quÆôy
;

277 i‡(
£rvî
.
°©_f‹k_øã
 < 10) {

278 
f‹k_quÆôy
 = "terrible";

279 
advi£_bëãr_vm
 = 1;

280 
advi˚s
++;

281 } i‡(
£rvî
.
°©_f‹k_øã
 < 25) {

282 
f‹k_quÆôy
 = "poor";

283 
advi£_bëãr_vm
 = 1;

284 
advi˚s
++;

285 } i‡(
£rvî
.
°©_f‹k_øã
 < 100) {

286 
f‹k_quÆôy
 = "good";

288 
f‹k_quÆôy
 = "excellent";

290 
ªp‹t
 = 
	`sdsˇçrötf
(report,

291 " F‹kÑ©êi†%.2‡GB/£¯(%s).", 
£rvî
.
°©_f‹k_øã
,

292 
f‹k_quÆôy
);

296 i‡(!
	`°rˇ£cmp
(
evít
,"command")) {

297 i‡(
£rvî
.
¶owlog_log_¶owî_th™
 < 0) {

298 
advi£_¶owlog_íabÀd
 = 1;

299 
advi˚s
++;

300 } i‡(
£rvî
.
¶owlog_log_¶owî_th™
/1000 >

301 
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
)

303 
advi£_¶owlog_tunög
 = 1;

304 
advi˚s
++;

306 
advi£_¶owlog_ö•e˘
 = 1;

307 
advi£_œrge_obje˘s
 = 1;

308 
advi˚s
 += 2;

312 i‡(!
	`°rˇ£cmp
(
evít
,"fast-command")) {

313 
advi£_scheduÀr
 = 1;

314 
advi˚s
++;

318 i‡(!
	`°rˇ£cmp
(
evít
,"aof-write-pending-fsync")) {

319 
advi£_loˇl_disk
 = 1;

320 
advi£_disk_c⁄ã¡i⁄
 = 1;

321 
advi£_ssd
 = 1;

322 
advi£_d©a_wrôeback
 = 1;

323 
advi˚s
 += 4;

326 i‡(!
	`°rˇ£cmp
(
evít
,"aof-write-active-child")) {

327 
advi£_no_≠≥ndfsync
 = 1;

328 
advi£_d©a_wrôeback
 = 1;

329 
advi£_ssd
 = 1;

330 
advi˚s
 += 3;

333 i‡(!
	`°rˇ£cmp
(
evít
,"aof-write-alone")) {

334 
advi£_loˇl_disk
 = 1;

335 
advi£_d©a_wrôeback
 = 1;

336 
advi£_ssd
 = 1;

337 
advi˚s
 += 3;

340 i‡(!
	`°rˇ£cmp
(
evít
,"aof-fsync-always")) {

341 
advi£_ªœx_fsync_pﬁicy
 = 1;

342 
advi˚s
++;

345 i‡(!
	`°rˇ£cmp
(
evít
,"aof-fstat") ||

346 !
	`°rˇ£cmp
(
evít
,"rdb-unlik-temp-file")) {

347 
advi£_disk_c⁄ã¡i⁄
 = 1;

348 
advi£_loˇl_disk
 = 1;

349 
advi˚s
 += 2;

352 i‡(!
	`°rˇ£cmp
(
evít
,"aof-rewrite-diff-write") ||

353 !
	`°rˇ£cmp
(
evít
,"aof-rename")) {

354 
advi£_wrôe_lﬂd_öfo
 = 1;

355 
advi£_d©a_wrôeback
 = 1;

356 
advi£_ssd
 = 1;

357 
advi£_loˇl_disk
 = 1;

358 
advi˚s
 += 4;

362 i‡(!
	`°rˇ£cmp
(
evít
,"expire-cycle")) {

363 
advi£_hz
 = 1;

364 
advi£_œrge_obje˘s
 = 1;

365 
advi˚s
 += 2;

369 i‡(!
	`°rˇ£cmp
(
evít
,"eviction-del")) {

370 
advi£_œrge_obje˘s
 = 1;

371 
advi˚s
++;

374 i‡(!
	`°rˇ£cmp
(
evít
,"eviction-cycle")) {

375 
advi£_mass_evi˘i⁄
 = 1;

376 
advi˚s
++;

379 
ªp‹t
 = 
	`sdsˇéí
(report,"\n",1);

381 
	`di˘Rñó£Iãøt‹
(
di
);

384 i‡(
	`THPGëAn⁄HugePagesSize
() > 0) {

385 
advi£_dißbÀ_thp
 = 1;

386 
advi˚s
++;

389 i‡(
evíäum
 =0 && 
advi˚s
 == 0) {

390 
ªp‹t
 = 
	`sdsˇt
(report,"Dave,ÇoÜatency spike was observed duringÅheÜifetime ofÅhis Redis instance,Çot inÅhe slightest bit. I honestlyÅhink you oughtÅo sit down calmly,Åakeá stressÖill,ándÅhinkÅhings over.\n");

391 } i‡(
evíäum
 > 0 && 
advi˚s
 == 0) {

392 
ªp‹t
 = 
	`sdsˇt
(report,"\nWhileÅhereáreÜatencyÉventsÜogged, I'mÇotábleÅo suggestányÉasy fix. Please useÅhe Redis communityÅo get some help,ÖrovidingÅhisÑeport in your helpÑequest.\n");

397 
ªp‹t
 = 
	`sdsˇt
(report,"\nI haveá fewádvices for you:\n\n");

398 i‡(
advi£_bëãr_vm
) {

399 
ªp‹t
 = 
	`sdsˇt
(report,"- If youáre usingá virtual machine, consider upgrading it withá faster one usingán hypervisiorÅhatÖrovidesÜessÜatency during fork() calls. Xen is knownÅo haveÖoor fork()Öerformance. Even inÅhe context ofÅhe same VMÖrovider, certain kinds of instances canÉxecute fork fasterÅhan others.\n");

403 i‡(
advi£_¶owlog_íabÀd
) {

404 
ªp‹t
 = 
	`sdsˇçrötf
‘ï‹t,"- Thîê¨êœãncy issue†wôhÖŸítüŒy slow comm™d†youáª usög. TryÅÿíabÀÅhêSlow Log Redi†„©uª usögÅhêcomm™d 'CONFIG SET slowlog-log-¶owî-th™ %Œu'. I‡thêSlowÜog i†dißbÀd Redi†i†nŸábÀÅÿlog slow comm™d†executi⁄ f‹ you.\n", ()
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
*1000);

407 i‡(
advi£_¶owlog_tunög
) {

408 
ªp‹t
 = 
	`sdsˇçrötf
‘ï‹t,"- You∏cuºíàSlow Log c⁄figuøti⁄ o∆yÜog†evít†th©áª slowîÅh™ you∏c⁄figuªdÜ©ícy m⁄ô‹Åhªshﬁd. PÀa£ u£ 'CONFIG SET slowlog-log-¶owî-th™ %Œu'.\n", ()
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
*1000);

411 i‡(
advi£_¶owlog_ö•e˘
) {

412 
ªp‹t
 = 
	`sdsˇt
(report,"- Check your Slow LogÅo understand whatáreÅhe commands youáreÑunning whicháreÅoo slowÅoÉxecute. Please check http://redis.io/commands/slowlog for more information.\n");

416 i‡(
advi£_scheduÀr
) {

417 
ªp‹t
 = 
	`sdsˇt
(report,"- The system is slowÅoÉxecute Redis codeÖathsÇot containing system calls. This usually meansÅhe system doesÇotÖrovide Redis CPUÅimeÅoÑun forÜongÖeriods. You shouldÅryÅo:\n"

426 i‡(
advi£_loˇl_disk
) {

427 
ªp‹t
 = 
	`sdsˇt
(report,"- It is stronglyádvisedÅo useÜocal disks forÖersistence,Éspecially if youáre using AOF. Remote disksÖrovided byÖlatform-as-a-serviceÖrovidersáre knownÅo be slow.\n");

430 i‡(
advi£_ssd
) {

431 
ªp‹t
 = 
	`sdsˇt
(report,"- SSD disksáreábleÅoÑeduce fsyncÜatency,ándÅotalÅimeÇeeded for snapshottingánd AOFÜogÑewriting (resulting in smaller memory usageánd smaller final AOFÑewrite buffer flushes). WithÉxtremely high writeÜoad SSD disks can beá good option. However Redis shouldÖerformÑeasonably with highÜoad usingÇormal disks. UseÅhisádviceásáÜastÑesort.\n");

434 i‡(
advi£_d©a_wrôeback
) {

435 
ªp‹t
 = 
	`sdsˇt
(report,"- MountingÉxt3/4 filesystems with data=writeback canÖrovideáÖerformance boost comparedÅo data=ordered, howeverÅhis mode of operationÖrovidesÜess guarantees,ánd sometimes it can happenÅhatáfterá hard crashÅhe AOF file will haveán half-written commandátÅheÉndánd willÑequireÅo beÑepaired before RedisÑestarts.\n");

438 i‡(
advi£_disk_c⁄ã¡i⁄
) {

439 
ªp‹t
 = 
	`sdsˇt
(report,"- TryÅoÜowerÅhe disk contention. This is often caused by other disk intensiveÖrocessesÑunning inÅhe same computer (including other Redis instances).\n");

442 i‡(
advi£_no_≠≥ndfsync
) {

443 
ªp‹t
 = 
	`sdsˇt
(report,"- Assuming fromÅheÖoint of view of data safetyÅhis is viable in yourÉnvironment, you couldÅryÅoÉnableÅhe 'no-appendfsync-on-rewrite' option, soÅhat fsync willÇot beÖerformed whileÅhere isá childÑewritingÅhe AOF file orÖroducingán RDB file (the moment whereÅhere is high disk contention).\n");

446 i‡(
advi£_ªœx_fsync_pﬁicy
 && 
£rvî
.
aof_fsync
 =
AOF_FSYNC_ALWAYS
) {

447 
ªp‹t
 = 
	`sdsˇt
(report,"- Your fsyncÖolicy is setÅo 'always'. It is very hardÅo get goodÖerformances with suchá setup, ifÖossibleÅryÅoÑelaxÅhe fsyncÖolicyÅo 'onesec'.\n");

450 i‡(
advi£_wrôe_lﬂd_öfo
) {

451 
ªp‹t
 = 
	`sdsˇt
(report,"- Latency duringÅhe AOFátomicÑename operation or whenÅhe final difference is flushedÅoÅhe AOF fileátÅheÉnd ofÅheÑewrite, sometimes is caused by very high writeÜoad, causingÅhe AOF bufferÅo get veryÜarge. IfÖossibleÅryÅo sendÜess commandsÅoáccomplishÅhe same work, or use Lua scriptsÅo group multiple operations intoá single EVALSHA call.\n");

454 i‡(
advi£_hz
 && 
£rvî
.
hz
 < 100) {

455 
ªp‹t
 = 
	`sdsˇt
(report,"- In orderÅo makeÅhe Redis keysÉxpiringÖrocess more incremental,ÅryÅo setÅhe 'hz' configurationÖarameterÅo 100 using 'CONFIG SET hz 100'.\n");

458 i‡(
advi£_œrge_obje˘s
) {

459 
ªp‹t
 = 
	`sdsˇt
(report,"- Deleting,Éxpiring orÉvicting (because of maxmemoryÖolicy)Üarge objects isá blocking operation. If you have veryÜarge objectsÅhatáre often deleted,Éxpired, orÉvicted,ÅryÅo fragmentÅhose objects into multiple smaller objects.\n");

462 i‡(
advi£_mass_evi˘i⁄
) {

463 
ªp‹t
 = 
	`sdsˇt
(report,"- Sudden changesÅoÅhe 'maxmemory' setting via 'CONFIG SET', orállocation ofÜarge objects via sets or sorted sets intersections, STORE option of SORT, Redis ClusterÜarge keys migrations (RESTORE command), may create sudden memoryÖressure forcingÅhe serverÅo blockÅryingÅoÉvict keys. \n");

466 i‡(
advi£_dißbÀ_thp
) {

467 
ªp‹t
 = 
	`sdsˇt
(report,"- I detectedáÇon zeroámount ofánonymous hugeÖages used by yourÖrocess. This creates very seriousÜatencyÉvents in different conditions,Éspecially when Redis isÖersisting on disk. To disable THP support useÅhe command 'echoÇever > /sys/kernel/mm/transparent_hugepage/enabled', make sureÅoálsoádd it into /etc/rc.local soÅhatÅhe command will beÉxecutedágaináfteráÑeboot. NoteÅhatÉven if you haveálready disabled THP, you stillÇeedÅoÑestartÅhe RedisÖrocessÅo getÑid ofÅhe hugeÖagesálready created.\n");

471  
ªp‹t
;

472 
	}
}

478 
	$œãncyComm™dRïlyWôhSam∂es
(
˛õ¡
 *
c
, 
œãncyTimeSîõs
 *
ts
) {

479 *
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

480 
ßm∂es
 = 0, 
j
;

482 
j
 = 0; j < 
LATENCY_TS_LEN
; j++) {

483 
i
 = (
ts
->
idx
 + 
j
Ë% 
LATENCY_TS_LEN
;

485 i‡(
ts
->
ßm∂es
[
i
].
time
 == 0) ;

486 
	`addRïlyAºayLí
(
c
,2);

487 
	`addRïlyL⁄gL⁄g
(
c
,
ts
->
ßm∂es
[
i
].
time
);

488 
	`addRïlyL⁄gL⁄g
(
c
,
ts
->
ßm∂es
[
i
].
œãncy
);

489 
ßm∂es
++;

491 
	`£tDe„ºedAºayLí
(
c
,
ª∂yÀn
,
ßm∂es
);

492 
	}
}

496 
	$œãncyComm™dRïlyWôhL©e°Evíts
(
˛õ¡
 *
c
) {

497 
di˘Iãøt‹
 *
di
;

498 
di˘E¡ry
 *
de
;

500 
	`addRïlyAºayLí
(
c
,
	`di˘Size
(
£rvî
.
œãncy_evíts
));

501 
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
œãncy_evíts
);

502 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

503 *
evít
 = 
	`di˘GëKey
(
de
);

504 
œãncyTimeSîõs
 *
ts
 = 
	`di˘GëVÆ
(
de
);

505 
œ°
 = (
ts
->
idx
 + 
LATENCY_TS_LEN
 - 1) % LATENCY_TS_LEN;

507 
	`addRïlyAºayLí
(
c
,4);

508 
	`addRïlyBulkCSåög
(
c
,
evít
);

509 
	`addRïlyL⁄gL⁄g
(
c
,
ts
->
ßm∂es
[
œ°
].
time
);

510 
	`addRïlyL⁄gL⁄g
(
c
,
ts
->
ßm∂es
[
œ°
].
œãncy
);

511 
	`addRïlyL⁄gL⁄g
(
c
,
ts
->
max
);

513 
	`di˘Rñó£Iãøt‹
(
di
);

514 
	}
}

516 
	#LATENCY_GRAPH_COLS
 80

	)

517 
sds
 
	$œãncyComm™dGíS∑rkñöe
(*
evít
, 
œãncyTimeSîõs
 *
ts
) {

518 
j
;

519 
£quí˚
 *
£q
 = 
	`¸óãS∑rklöeSequí˚
();

520 
sds
 
gøph
 = 
	`sd£m±y
();

521 
uöt32_t
 
mö
 = 0, 
max
 = 0;

523 
j
 = 0; j < 
LATENCY_TS_LEN
; j++) {

524 
i
 = (
ts
->
idx
 + 
j
Ë% 
LATENCY_TS_LEN
;

525 
ñ≠£d
;

526 
buf
[64];

528 i‡(
ts
->
ßm∂es
[
i
].
time
 == 0) ;

530 i‡(
£q
->
Àngth
 == 0) {

531 
mö
 = 
max
 = 
ts
->
ßm∂es
[
i
].
œãncy
;

533 i‡(
ts
->
ßm∂es
[
i
].
œãncy
 > 
max
) max =Ås->samples[i].latency;

534 i‡(
ts
->
ßm∂es
[
i
].
œãncy
 < 
mö
) min =Ås->samples[i].latency;

538 
ñ≠£d
 = 
	`time
(
NULL
Ë- 
ts
->
ßm∂es
[
i
].
time
;

539 i‡(
ñ≠£d
 < 60)

540 
	`¢¥ötf
(
buf
,(buf),"%ds",
ñ≠£d
);

541 i‡(
ñ≠£d
 < 3600)

542 
	`¢¥ötf
(
buf
,(buf),"%dm",
ñ≠£d
/60);

543 i‡(
ñ≠£d
 < 3600*24)

544 
	`¢¥ötf
(
buf
,(buf),"%dh",
ñ≠£d
/3600);

546 
	`¢¥ötf
(
buf
,(buf),"%dd",
ñ≠£d
/(3600*24));

547 
	`•¨klöeSequí˚AddSam∂e
(
£q
,
ts
->
ßm∂es
[
i
].
œãncy
,
buf
);

550 
gøph
 = 
	`sdsˇçrötf
(graph,

551 "%†- high %lu ms,Üow %lu m†◊ŒÅimêhigh %lu ms)\n", 
evít
,

552 (Ë
max
, (Ë
mö
, (Ë
ts
->max);

553 
j
 = 0; j < 
LATENCY_GRAPH_COLS
; j++)

554 
gøph
 = 
	`sdsˇéí
(graph,"-",1);

555 
gøph
 = 
	`sdsˇéí
(graph,"\n",1);

556 
gøph
 = 
	`•¨klöeRídî
(gøph,
£q
,
LATENCY_GRAPH_COLS
,4,
SPARKLINE_FILL
);

557 
	`‰ìS∑rklöeSequí˚
(
£q
);

558  
gøph
;

559 
	}
}

569 
	$œãncyComm™d
(
˛õ¡
 *
c
) {

570 c⁄° *
hñp
[] = {

578 
NULL


580 
œãncyTimeSîõs
 *
ts
;

582 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"hi°‹y"Ë&& c->
¨gc
 == 3) {

584 
ts
 = 
	`di˘FëchVÆue
(
£rvî
.
œãncy_evíts
,
c
->
¨gv
[2]->
±r
);

585 i‡(
ts
 =
NULL
) {

586 
	`addRïlyAºayLí
(
c
,0);

588 
	`œãncyComm™dRïlyWôhSam∂es
(
c
,
ts
);

590 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"gøph"Ë&& c->
¨gc
 == 3) {

592 
sds
 
gøph
;

593 
di˘E¡ry
 *
de
;

594 *
evít
;

596 
de
 = 
	`di˘Föd
(
£rvî
.
œãncy_evíts
,
c
->
¨gv
[2]->
±r
);

597 i‡(
de
 =
NULL
Ë
nod©´º
;

598 
ts
 = 
	`di˘GëVÆ
(
de
);

599 
evít
 = 
	`di˘GëKey
(
de
);

601 
gøph
 = 
	`œãncyComm™dGíS∑rkñöe
(
evít
,
ts
);

602 
	`addRïlyVîb©im
(
c
,
gøph
,
	`sd¶í
(graph),"txt");

603 
	`sds‰ì
(
gøph
);

604 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"œã°"Ë&& c->
¨gc
 == 2) {

606 
	`œãncyComm™dRïlyWôhL©e°Evíts
(
c
);

607 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"do˘‹"Ë&& c->
¨gc
 == 2) {

609 
sds
 
ªp‹t
 = 
	`¸óãL©ícyRï‹t
();

611 
	`addRïlyVîb©im
(
c
,
ªp‹t
,
	`sd¶í
(report),"txt");

612 
	`sds‰ì
(
ªp‹t
);

613 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ª£t"Ë&& c->
¨gc
 >= 2) {

615 i‡(
c
->
¨gc
 == 2) {

616 
	`addRïlyL⁄gL⁄g
(
c
,
	`œãncyRe£tEvít
(
NULL
));

618 
j
, 
ª£ts
 = 0;

620 
j
 = 2; j < 
c
->
¨gc
; j++)

621 
ª£ts
 +
	`œãncyRe£tEvít
(
c
->
¨gv
[
j
]->
±r
);

622 
	`addRïlyL⁄gL⁄g
(
c
,
ª£ts
);

624 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"hñp"Ë&& c->
¨gc
 >= 2) {

625 
	`addRïlyHñp
(
c
, 
hñp
);

627 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

631 
nod©´º
:

634 
	`addRïlyEº‹F‹m©
(
c
,

635 "Nÿßm∂e†avaûabÀ f‹Évíà'%s'", (*Ë
c
->
¨gv
[2]->
±r
);

636 
	}
}

	@latency.h

34 #i‚de‡
__LATENCY_H


35 
	#__LATENCY_H


	)

37 
	#LATENCY_TS_LEN
 160

	)

41 
	sœãncySam∂e
 {

42 
öt32_t
 
	mtime
;

43 
uöt32_t
 
	mœãncy
;

47 
	sœãncyTimeSîõs
 {

48 
	midx
;

49 
uöt32_t
 
	mmax
;

50 
œãncySam∂e
 
	mßm∂es
[
LATENCY_TS_LEN
];

54 
	sœãncySèts
 {

55 
uöt32_t
 
	mÆl_time_high
;

56 
uöt32_t
 
	mavg
;

57 
uöt32_t
 
	mmö
;

58 
uöt32_t
 
	mmax
;

59 
uöt32_t
 
	mmad
;

60 
uöt32_t
 
	mßm∂es
;

61 
time_t
 
	m≥riod
;

64 
œãncyM⁄ô‹Inô
();

65 
œãncyAddSam∂e
(c⁄° *
evít
, 
m°ime_t
 
œãncy
);

66 
THPIsE«bÀd
();

71 
	#œãncySèπM⁄ô‹
(
v¨
Ëi‡(
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
) { \

72 
v¨
 = 
	`m°ime
(); \

74 
v¨
 = 0; \

75 }

	)

79 
	#œãncyEndM⁄ô‹
(
v¨
Ëi‡(
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
) { \

80 
v¨
 = 
	`m°ime
() - var; \

81 }

	)

84 
	#œãncyAddSam∂eIfNìded
(
evít
,
v¨
) \

85 i‡(
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
 && \

86 (
v¨
Ë>
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
) \

87 
	`œãncyAddSam∂e
((
evít
),(
v¨
));

	)

90 
	#œãncyRemoveNe°edEvít
(
evít_v¨
,
√°ed_v¨
) \

91 
evít_v¨
 +
√°ed_v¨
;

	)

	@lazyfree.c

1 
	~"£rvî.h
"

2 
	~"bio.h
"

3 
	~"©omicv¨.h
"

4 
	~"˛u°î.h
"

6 
size_t
 
	gœzy‰ì_obje˘s
 = 0;

7 
±hªad_muãx_t
 
	gœzy‰ì_obje˘s_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

10 
size_t
 
	$œzy‰ìGëPídögObje˘sCou¡
() {

11 
size_t
 
aux
;

12 
	`©omicGë
(
œzy‰ì_obje˘s
,
aux
);

13  
aux
;

14 
	}
}

31 
size_t
 
	$œzy‰ìGëFªeEff‹t
(
robj
 *
obj
) {

32 i‡(
obj
->
ty≥
 =
OBJ_LIST
) {

33 
quickli°
 *
ql
 = 
obj
->
±r
;

34  
ql
->
Àn
;

35 } i‡(
obj
->
ty≥
 =
OBJ_SET
 && obj->
ícodög
 =
OBJ_ENCODING_HT
) {

36 
di˘
 *
ht
 = 
obj
->
±r
;

37  
	`di˘Size
(
ht
);

38 } i‡(
obj
->
ty≥
 =
OBJ_ZSET
 && obj->
ícodög
 =
OBJ_ENCODING_SKIPLIST
){

39 
z£t
 *
zs
 = 
obj
->
±r
;

40  
zs
->
z¶
->
Àngth
;

41 } i‡(
obj
->
ty≥
 =
OBJ_HASH
 && obj->
ícodög
 =
OBJ_ENCODING_HT
) {

42 
di˘
 *
ht
 = 
obj
->
±r
;

43  
	`di˘Size
(
ht
);

47 
	}
}

53 
	#LAZYFREE_THRESHOLD
 64

	)

54 
	$dbAsyncDñëe
(
ªdisDb
 *
db
, 
robj
 *
key
) {

57 i‡(
	`di˘Size
(
db
->
expúes
Ë> 0Ë
	`di˘Dñëe
(db->expúes,
key
->
±r
);

62 
di˘E¡ry
 *
de
 = 
	`di˘U∆ök
(
db
->
di˘
,
key
->
±r
);

63 i‡(
de
) {

64 
robj
 *
vÆ
 = 
	`di˘GëVÆ
(
de
);

65 
size_t
 
‰ì_eff‹t
 = 
	`œzy‰ìGëFªeEff‹t
(
vÆ
);

75 i‡(
‰ì_eff‹t
 > 
LAZYFREE_THRESHOLD
 && 
vÆ
->
ªfcou¡
 == 1) {

76 
	`©omicIn¸
(
œzy‰ì_obje˘s
,1);

77 
	`bioCª©eBackgroundJob
(
BIO_LAZY_FREE
,
vÆ
,
NULL
,NULL);

78 
	`di˘SëVÆ
(
db
->
di˘
,
de
,
NULL
);

84 i‡(
de
) {

85 
	`di˘FªeU∆ökedE¡ry
(
db
->
di˘
,
de
);

86 i‡(
£rvî
.
˛u°î_íabÀd
Ë
	`¶ŸToKeyDñ
(
key
->
±r
);

91 
	}
}

94 
	$‰ìObjAsync
(
robj
 *
o
) {

95 
size_t
 
‰ì_eff‹t
 = 
	`œzy‰ìGëFªeEff‹t
(
o
);

96 i‡(
‰ì_eff‹t
 > 
LAZYFREE_THRESHOLD
 && 
o
->
ªfcou¡
 == 1) {

97 
	`©omicIn¸
(
œzy‰ì_obje˘s
,1);

98 
	`bioCª©eBackgroundJob
(
BIO_LAZY_FREE
,
o
,
NULL
,NULL);

100 
	`de¸RefCou¡
(
o
);

102 
	}
}

107 
	$em±yDbAsync
(
ªdisDb
 *
db
) {

108 
di˘
 *
ﬁdht1
 = 
db
->di˘, *
ﬁdht2
 = db->
expúes
;

109 
db
->
di˘
 = 
	`di˘Cª©e
(&
dbDi˘Ty≥
,
NULL
);

110 
db
->
expúes
 = 
	`di˘Cª©e
(&
key±rDi˘Ty≥
,
NULL
);

111 
	`©omicIn¸
(
œzy‰ì_obje˘s
,
	`di˘Size
(
ﬁdht1
));

112 
	`bioCª©eBackgroundJob
(
BIO_LAZY_FREE
,
NULL
,
ﬁdht1
,
ﬁdht2
);

113 
	}
}

117 
	$¶ŸToKeyFlushAsync
() {

118 
øx
 *
ﬁd
 = 
£rvî
.
˛u°î
->
¶Ÿs_to_keys
;

120 
£rvî
.
˛u°î
->
¶Ÿs_to_keys
 = 
	`øxNew
();

121 
	`mem£t
(
£rvî
.
˛u°î
->
¶Ÿs_keys_cou¡
,0,

122 (
£rvî
.
˛u°î
->
¶Ÿs_keys_cou¡
));

123 
	`©omicIn¸
(
œzy‰ì_obje˘s
,
ﬁd
->
numñe
);

124 
	`bioCª©eBackgroundJob
(
BIO_LAZY_FREE
,
NULL
,NULL,
ﬁd
);

125 
	}
}

129 
	$œzy‰ìFªeObje˘FromBioThªad
(
robj
 *
o
) {

130 
	`de¸RefCou¡
(
o
);

131 
	`©omicDe¸
(
œzy‰ì_obje˘s
,1);

132 
	}
}

139 
	$œzy‰ìFªeD©aba£FromBioThªad
(
di˘
 *
ht1
, di˘ *
ht2
) {

140 
size_t
 
numkeys
 = 
	`di˘Size
(
ht1
);

141 
	`di˘Rñó£
(
ht1
);

142 
	`di˘Rñó£
(
ht2
);

143 
	`©omicDe¸
(
œzy‰ì_obje˘s
,
numkeys
);

144 
	}
}

148 
	$œzy‰ìFªeSlŸsM≠FromBioThªad
(
øx
 *
π
) {

149 
size_t
 
Àn
 = 
π
->
numñe
;

150 
	`øxFªe
(
π
);

151 
	`©omicDe¸
(
œzy‰ì_obje˘s
,
Àn
);

152 
	}
}

	@listpack.c

35 
	~<°döt.h
>

36 
	~<limôs.h
>

37 
	~<sys/ty≥s.h
>

38 
	~<°dlib.h
>

39 
	~<°rög.h
>

40 
	~<°dio.h
>

42 
	~"li°∑ck.h
"

43 
	~"li°∑ck_mÆloc.h
"

45 
	#LP_HDR_SIZE
 6

	)

46 
	#LP_HDR_NUMELE_UNKNOWN
 
UINT16_MAX


	)

47 
	#LP_MAX_INT_ENCODING_LEN
 9

	)

48 
	#LP_MAX_BACKLEN_SIZE
 5

	)

49 
	#LP_MAX_ENTRY_BACKLEN
 34359738367ULL

	)

50 
	#LP_ENCODING_INT
 0

	)

51 
	#LP_ENCODING_STRING
 1

	)

53 
	#LP_ENCODING_7BIT_UINT
 0

	)

54 
	#LP_ENCODING_7BIT_UINT_MASK
 0x80

	)

55 
	#LP_ENCODING_IS_7BIT_UINT
(
byã
Ë(((byã)&
LP_ENCODING_7BIT_UINT_MASK
)==
LP_ENCODING_7BIT_UINT
)

	)

57 
	#LP_ENCODING_6BIT_STR
 0x80

	)

58 
	#LP_ENCODING_6BIT_STR_MASK
 0xC0

	)

59 
	#LP_ENCODING_IS_6BIT_STR
(
byã
Ë(((byã)&
LP_ENCODING_6BIT_STR_MASK
)==
LP_ENCODING_6BIT_STR
)

	)

61 
	#LP_ENCODING_13BIT_INT
 0xC0

	)

62 
	#LP_ENCODING_13BIT_INT_MASK
 0xE0

	)

63 
	#LP_ENCODING_IS_13BIT_INT
(
byã
Ë(((byã)&
LP_ENCODING_13BIT_INT_MASK
)==
LP_ENCODING_13BIT_INT
)

	)

65 
	#LP_ENCODING_12BIT_STR
 0xE0

	)

66 
	#LP_ENCODING_12BIT_STR_MASK
 0xF0

	)

67 
	#LP_ENCODING_IS_12BIT_STR
(
byã
Ë(((byã)&
LP_ENCODING_12BIT_STR_MASK
)==
LP_ENCODING_12BIT_STR
)

	)

69 
	#LP_ENCODING_16BIT_INT
 0xF1

	)

70 
	#LP_ENCODING_16BIT_INT_MASK
 0xFF

	)

71 
	#LP_ENCODING_IS_16BIT_INT
(
byã
Ë(((byã)&
LP_ENCODING_16BIT_INT_MASK
)==
LP_ENCODING_16BIT_INT
)

	)

73 
	#LP_ENCODING_24BIT_INT
 0xF2

	)

74 
	#LP_ENCODING_24BIT_INT_MASK
 0xFF

	)

75 
	#LP_ENCODING_IS_24BIT_INT
(
byã
Ë(((byã)&
LP_ENCODING_24BIT_INT_MASK
)==
LP_ENCODING_24BIT_INT
)

	)

77 
	#LP_ENCODING_32BIT_INT
 0xF3

	)

78 
	#LP_ENCODING_32BIT_INT_MASK
 0xFF

	)

79 
	#LP_ENCODING_IS_32BIT_INT
(
byã
Ë(((byã)&
LP_ENCODING_32BIT_INT_MASK
)==
LP_ENCODING_32BIT_INT
)

	)

81 
	#LP_ENCODING_64BIT_INT
 0xF4

	)

82 
	#LP_ENCODING_64BIT_INT_MASK
 0xFF

	)

83 
	#LP_ENCODING_IS_64BIT_INT
(
byã
Ë(((byã)&
LP_ENCODING_64BIT_INT_MASK
)==
LP_ENCODING_64BIT_INT
)

	)

85 
	#LP_ENCODING_32BIT_STR
 0xF0

	)

86 
	#LP_ENCODING_32BIT_STR_MASK
 0xFF

	)

87 
	#LP_ENCODING_IS_32BIT_STR
(
byã
Ë(((byã)&
LP_ENCODING_32BIT_STR_MASK
)==
LP_ENCODING_32BIT_STR
)

	)

89 
	#LP_EOF
 0xFF

	)

91 
	#LP_ENCODING_6BIT_STR_LEN
(
p
Ë(’)[0] & 0x3F)

	)

92 
	#LP_ENCODING_12BIT_STR_LEN
(
p
Ë(((’)[0] & 0xFË<< 8Ë| (p)[1])

	)

93 
	#LP_ENCODING_32BIT_STR_LEN
(
p
Ë(((
uöt32_t
)(p)[1]<<0) | \

94 ((
uöt32_t
)(
p
)[2]<<8) | \

95 ((
uöt32_t
)(
p
)[3]<<16) | \

96 ((
uöt32_t
)(
p
)[4]<<24))

	)

98 
	#ÕGëTŸÆByãs
(
p
Ë(((
uöt32_t
)(p)[0]<<0) | \

99 ((
uöt32_t
)(
p
)[1]<<8) | \

100 ((
uöt32_t
)(
p
)[2]<<16) | \

101 ((
uöt32_t
)(
p
)[3]<<24))

	)

103 
	#ÕGëNumEÀmíts
(
p
Ë(((
uöt32_t
)(p)[4]<<0) | \

104 ((
uöt32_t
)(
p
)[5]<<8))

	)

105 
	#ÕSëTŸÆByãs
(
p
,
v
) do { \

106 (
p
)[0] = (
v
)&0xff; \

107 (
p
)[1] = ((
v
)>>8)&0xff; \

108 (
p
)[2] = ((
v
)>>16)&0xff; \

109 (
p
)[3] = ((
v
)>>24)&0xff; \

110 } 0)

	)

112 
	#ÕSëNumEÀmíts
(
p
,
v
) do { \

113 (
p
)[4] = (
v
)&0xff; \

114 (
p
)[5] = ((
v
)>>8)&0xff; \

115 } 0)

	)

141 
	$ÕSåögToI¡64
(c⁄° *
s
, 
¶í
, 
öt64_t
 *
vÆue
) {

142 c⁄° *
p
 = 
s
;

143 
∂í
 = 0;

144 
√g©ive
 = 0;

145 
uöt64_t
 
v
;

147 i‡(
∂í
 =
¶í
)

151 i‡(
¶í
 =1 && 
p
[0] == '0') {

152 i‡(
vÆue
 !
NULL
) *value = 0;

156 i‡(
p
[0] == '-') {

157 
√g©ive
 = 1;

158 
p
++; 
∂í
++;

161 i‡(
∂í
 =
¶í
)

166 i‡(
p
[0] >= '1' &&Ö[0] <= '9') {

167 
v
 = 
p
[0]-'0';

168 
p
++; 
∂í
++;

169 } i‡(
p
[0] ='0' && 
¶í
 == 1) {

170 *
vÆue
 = 0;

176 
∂í
 < 
¶í
 && 
p
[0] >= '0' &&Ö[0] <= '9') {

177 i‡(
v
 > (
UINT64_MAX
 / 10))

179 
v
 *= 10;

181 i‡(
v
 > (
UINT64_MAX
 - (
p
[0]-'0')))

183 
v
 +
p
[0]-'0';

185 
p
++; 
∂í
++;

189 i‡(
∂í
 < 
¶í
)

192 i‡(
√g©ive
) {

193 i‡(
v
 > ((
uöt64_t
)(-(
INT64_MIN
+1))+1))

195 i‡(
vÆue
 !
NULL
Ë*vÆuê-
v
;

197 i‡(
v
 > 
INT64_MAX
)

199 i‡(
vÆue
 !
NULL
Ë*vÆuê
v
;

202 
	}
}

206 *
	$ÕNew
() {

207 *
Õ
 = 
	`Õ_mÆloc
(
LP_HDR_SIZE
+1);

208 i‡(
Õ
 =
NULL
)  NULL;

209 
	`ÕSëTŸÆByãs
(
Õ
,
LP_HDR_SIZE
+1);

210 
	`ÕSëNumEÀmíts
(
Õ
,0);

211 
Õ
[
LP_HDR_SIZE
] = 
LP_EOF
;

212  
Õ
;

213 
	}
}

216 
	$ÕFªe
(*
Õ
) {

217 
	`Õ_‰ì
(
Õ
);

218 
	}
}

231 
	$ÕEncodeGëTy≥
(*
ñe
, 
uöt32_t
 
size
, *
öãnc
, 
uöt64_t
 *
í˛í
) {

232 
öt64_t
 
v
;

233 i‡(
	`ÕSåögToI¡64
((c⁄° *)
ñe
, 
size
, &
v
)) {

234 i‡(
v
 >= 0 && v <= 127) {

236 
öãnc
[0] = 
v
;

237 *
í˛í
 = 1;

238 } i‡(
v
 >= -4096 && v <= 4095) {

240 i‡(
v
 < 0Ëv = ((
öt64_t
)1<<13)+v;

241 
öãnc
[0] = (
v
>>8)|
LP_ENCODING_13BIT_INT
;

242 
öãnc
[1] = 
v
&0xff;

243 *
í˛í
 = 2;

244 } i‡(
v
 >= -32768 && v <= 32767) {

246 i‡(
v
 < 0Ëv = ((
öt64_t
)1<<16)+v;

247 
öãnc
[0] = 
LP_ENCODING_16BIT_INT
;

248 
öãnc
[1] = 
v
&0xff;

249 
öãnc
[2] = 
v
>>8;

250 *
í˛í
 = 3;

251 } i‡(
v
 >= -8388608 && v <= 8388607) {

253 i‡(
v
 < 0Ëv = ((
öt64_t
)1<<24)+v;

254 
öãnc
[0] = 
LP_ENCODING_24BIT_INT
;

255 
öãnc
[1] = 
v
&0xff;

256 
öãnc
[2] = (
v
>>8)&0xff;

257 
öãnc
[3] = 
v
>>16;

258 *
í˛í
 = 4;

259 } i‡(
v
 >= -2147483648 && v <= 2147483647) {

261 i‡(
v
 < 0Ëv = ((
öt64_t
)1<<32)+v;

262 
öãnc
[0] = 
LP_ENCODING_32BIT_INT
;

263 
öãnc
[1] = 
v
&0xff;

264 
öãnc
[2] = (
v
>>8)&0xff;

265 
öãnc
[3] = (
v
>>16)&0xff;

266 
öãnc
[4] = 
v
>>24;

267 *
í˛í
 = 5;

270 
uöt64_t
 
uv
 = 
v
;

271 
öãnc
[0] = 
LP_ENCODING_64BIT_INT
;

272 
öãnc
[1] = 
uv
&0xff;

273 
öãnc
[2] = (
uv
>>8)&0xff;

274 
öãnc
[3] = (
uv
>>16)&0xff;

275 
öãnc
[4] = (
uv
>>24)&0xff;

276 
öãnc
[5] = (
uv
>>32)&0xff;

277 
öãnc
[6] = (
uv
>>40)&0xff;

278 
öãnc
[7] = (
uv
>>48)&0xff;

279 
öãnc
[8] = 
uv
>>56;

280 *
í˛í
 = 9;

282  
LP_ENCODING_INT
;

284 i‡(
size
 < 64Ë*
í˛í
 = 1+size;

285 i‡(
size
 < 4096Ë*
í˛í
 = 2+size;

286 *
í˛í
 = 5+
size
;

287  
LP_ENCODING_STRING
;

289 
	}
}

296 
	$ÕEncodeBackÀn
(*
buf
, 
uöt64_t
 
l
) {

297 i‡(
l
 <= 127) {

298 i‡(
buf
Ëbuf[0] = 
l
;

300 } i‡(
l
 < 16383) {

301 i‡(
buf
) {

302 
buf
[0] = 
l
>>7;

303 
buf
[1] = (
l
&127)|128;

306 } i‡(
l
 < 2097151) {

307 i‡(
buf
) {

308 
buf
[0] = 
l
>>14;

309 
buf
[1] = ((
l
>>7)&127)|128;

310 
buf
[2] = (
l
&127)|128;

313 } i‡(
l
 < 268435455) {

314 i‡(
buf
) {

315 
buf
[0] = 
l
>>21;

316 
buf
[1] = ((
l
>>14)&127)|128;

317 
buf
[2] = ((
l
>>7)&127)|128;

318 
buf
[3] = (
l
&127)|128;

322 i‡(
buf
) {

323 
buf
[0] = 
l
>>28;

324 
buf
[1] = ((
l
>>21)&127)|128;

325 
buf
[2] = ((
l
>>14)&127)|128;

326 
buf
[3] = ((
l
>>7)&127)|128;

327 
buf
[4] = (
l
&127)|128;

331 
	}
}

335 
uöt64_t
 
	$ÕDecodeBackÀn
(*
p
) {

336 
uöt64_t
 
vÆ
 = 0;

337 
uöt64_t
 
shi·
 = 0;

339 
vÆ
 |(
uöt64_t
)(
p
[0] & 127Ë<< 
shi·
;

340 i‡(!(
p
[0] & 128)) ;

341 
shi·
 += 7;

342 
p
--;

343 i‡(
shi·
 > 28Ë 
UINT64_MAX
;

345  
vÆ
;

346 
	}
}

352 
	$ÕEncodeSåög
(*
buf
, *
s
, 
uöt32_t
 
Àn
) {

353 i‡(
Àn
 < 64) {

354 
buf
[0] = 
Àn
 | 
LP_ENCODING_6BIT_STR
;

355 
	`mem˝y
(
buf
+1,
s
,
Àn
);

356 } i‡(
Àn
 < 4096) {

357 
buf
[0] = (
Àn
 >> 8Ë| 
LP_ENCODING_12BIT_STR
;

358 
buf
[1] = 
Àn
 & 0xff;

359 
	`mem˝y
(
buf
+2,
s
,
Àn
);

361 
buf
[0] = 
LP_ENCODING_32BIT_STR
;

362 
buf
[1] = 
Àn
 & 0xff;

363 
buf
[2] = (
Àn
 >> 8) & 0xff;

364 
buf
[3] = (
Àn
 >> 16) & 0xff;

365 
buf
[4] = (
Àn
 >> 24) & 0xff;

366 
	`mem˝y
(
buf
+5,
s
,
Àn
);

368 
	}
}

372 
uöt32_t
 
	$ÕCuºítEncodedSize
(*
p
) {

373 i‡(
	`LP_ENCODING_IS_7BIT_UINT
(
p
[0]))  1;

374 i‡(
	`LP_ENCODING_IS_6BIT_STR
(
p
[0])Ë 1+
	`LP_ENCODING_6BIT_STR_LEN
(p);

375 i‡(
	`LP_ENCODING_IS_13BIT_INT
(
p
[0]))  2;

376 i‡(
	`LP_ENCODING_IS_16BIT_INT
(
p
[0]))  3;

377 i‡(
	`LP_ENCODING_IS_24BIT_INT
(
p
[0]))  4;

378 i‡(
	`LP_ENCODING_IS_32BIT_INT
(
p
[0]))  5;

379 i‡(
	`LP_ENCODING_IS_64BIT_INT
(
p
[0]))  9;

380 i‡(
	`LP_ENCODING_IS_12BIT_STR
(
p
[0])Ë 2+
	`LP_ENCODING_12BIT_STR_LEN
(p);

381 i‡(
	`LP_ENCODING_IS_32BIT_STR
(
p
[0])Ë 5+
	`LP_ENCODING_32BIT_STR_LEN
(p);

382 i‡(
p
[0] =
LP_EOF
)  1;

384 
	}
}

390 *
	$ÕSkù
(*
p
) {

391 
íåyÀn
 = 
	`ÕCuºítEncodedSize
(
p
);

392 
íåyÀn
 +
	`ÕEncodeBackÀn
(
NULL
,entrylen);

393 
p
 +
íåyÀn
;

394  
p
;

395 
	}
}

400 *
	$ÕNext
(*
Õ
, *
p
) {

401 ((Ë
Õ
);

402 
p
 = 
	`ÕSkù
(p);

403 i‡(
p
[0] =
LP_EOF
Ë 
NULL
;

404  
p
;

405 
	}
}

410 *
	$ÕPªv
(*
Õ
, *
p
) {

411 i‡(
p
-
Õ
 =
LP_HDR_SIZE
Ë 
NULL
;

412 
p
--;

413 
uöt64_t
 
¥evÀn
 = 
	`ÕDecodeBackÀn
(
p
);

414 
¥evÀn
 +
	`ÕEncodeBackÀn
(
NULL
,prevlen);

415  
p
-
¥evÀn
+1;

416 
	}
}

420 *
	$ÕFú°
(*
Õ
) {

421 
Õ
 +
LP_HDR_SIZE
;

422 i‡(
Õ
[0] =
LP_EOF
Ë 
NULL
;

423  
Õ
;

424 
	}
}

428 *
	$ÕLa°
(*
Õ
) {

429 *
p
 = 
Õ
+
	`ÕGëTŸÆByãs
(lp)-1;

430  
	`ÕPªv
(
Õ
,
p
);

431 
	}
}

438 
uöt32_t
 
	$ÕLígth
(*
Õ
) {

439 
uöt32_t
 
numñe
 = 
	`ÕGëNumEÀmíts
(
Õ
);

440 i‡(
numñe
 !
LP_HDR_NUMELE_UNKNOWN
) Çumele;

444 
uöt32_t
 
cou¡
 = 0;

445 *
p
 = 
	`ÕFú°
(
Õ
);

446 
p
) {

447 
cou¡
++;

448 
p
 = 
	`ÕNext
(
Õ
,p);

453 i‡(
cou¡
 < 
LP_HDR_NUMELE_UNKNOWN
Ë
	`ÕSëNumEÀmíts
(
Õ
,count);

454  
cou¡
;

455 
	}
}

491 *
	$ÕGë
(*
p
, 
öt64_t
 *
cou¡
, *
ötbuf
) {

492 
öt64_t
 
vÆ
;

493 
uöt64_t
 
uvÆ
, 
√g°¨t
, 
√gmax
;

495 i‡(
	`LP_ENCODING_IS_7BIT_UINT
(
p
[0])) {

496 
√g°¨t
 = 
UINT64_MAX
;

497 
√gmax
 = 0;

498 
uvÆ
 = 
p
[0] & 0x7f;

499 } i‡(
	`LP_ENCODING_IS_6BIT_STR
(
p
[0])) {

500 *
cou¡
 = 
	`LP_ENCODING_6BIT_STR_LEN
(
p
);

501  
p
+1;

502 } i‡(
	`LP_ENCODING_IS_13BIT_INT
(
p
[0])) {

503 
uvÆ
 = ((
p
[0]&0x1f)<<8) |Ö[1];

504 
√g°¨t
 = (
uöt64_t
)1<<12;

505 
√gmax
 = 8191;

506 } i‡(
	`LP_ENCODING_IS_16BIT_INT
(
p
[0])) {

507 
uvÆ
 = (
uöt64_t
)
p
[1] |

508 (
uöt64_t
)
p
[2]<<8;

509 
√g°¨t
 = (
uöt64_t
)1<<15;

510 
√gmax
 = 
UINT16_MAX
;

511 } i‡(
	`LP_ENCODING_IS_24BIT_INT
(
p
[0])) {

512 
uvÆ
 = (
uöt64_t
)
p
[1] |

513 (
uöt64_t
)
p
[2]<<8 |

514 (
uöt64_t
)
p
[3]<<16;

515 
√g°¨t
 = (
uöt64_t
)1<<23;

516 
√gmax
 = 
UINT32_MAX
>>8;

517 } i‡(
	`LP_ENCODING_IS_32BIT_INT
(
p
[0])) {

518 
uvÆ
 = (
uöt64_t
)
p
[1] |

519 (
uöt64_t
)
p
[2]<<8 |

520 (
uöt64_t
)
p
[3]<<16 |

521 (
uöt64_t
)
p
[4]<<24;

522 
√g°¨t
 = (
uöt64_t
)1<<31;

523 
√gmax
 = 
UINT32_MAX
;

524 } i‡(
	`LP_ENCODING_IS_64BIT_INT
(
p
[0])) {

525 
uvÆ
 = (
uöt64_t
)
p
[1] |

526 (
uöt64_t
)
p
[2]<<8 |

527 (
uöt64_t
)
p
[3]<<16 |

528 (
uöt64_t
)
p
[4]<<24 |

529 (
uöt64_t
)
p
[5]<<32 |

530 (
uöt64_t
)
p
[6]<<40 |

531 (
uöt64_t
)
p
[7]<<48 |

532 (
uöt64_t
)
p
[8]<<56;

533 
√g°¨t
 = (
uöt64_t
)1<<63;

534 
√gmax
 = 
UINT64_MAX
;

535 } i‡(
	`LP_ENCODING_IS_12BIT_STR
(
p
[0])) {

536 *
cou¡
 = 
	`LP_ENCODING_12BIT_STR_LEN
(
p
);

537  
p
+2;

538 } i‡(
	`LP_ENCODING_IS_32BIT_STR
(
p
[0])) {

539 *
cou¡
 = 
	`LP_ENCODING_32BIT_STR_LEN
(
p
);

540  
p
+5;

542 
uvÆ
 = 12345678900000000ULL + 
p
[0];

543 
√g°¨t
 = 
UINT64_MAX
;

544 
√gmax
 = 0;

550 i‡(
uvÆ
 >
√g°¨t
) {

553 
uvÆ
 = 
√gmax
-uval;

554 
vÆ
 = 
uvÆ
;

555 
vÆ
 = -val-1;

557 
vÆ
 = 
uvÆ
;

562 i‡(
ötbuf
) {

563 *
cou¡
 = 
	`¢¥ötf
((*)
ötbuf
,
LP_INTBUF_SIZE
,"%Œd",()
vÆ
);

564  
ötbuf
;

566 *
cou¡
 = 
vÆ
;

567  
NULL
;

569 
	}
}

595 *
	$ÕIn£π
(*
Õ
, *
ñe
, 
uöt32_t
 
size
, *
p
, 
whîe
, **
√wp
) {

596 
öãnc
[
LP_MAX_INT_ENCODING_LEN
];

597 
backÀn
[
LP_MAX_BACKLEN_SIZE
];

599 
uöt64_t
 
í˛í
;

604 i‡(
ñe
 =
NULL
Ë
whîe
 = 
LP_REPLACE
;

610 i‡(
whîe
 =
LP_AFTER
) {

611 
p
 = 
	`ÕSkù
(p);

612 
whîe
 = 
LP_BEFORE
;

617 
poff
 = 
p
-
Õ
;

627 
í˘y≥
;

628 i‡(
ñe
) {

629 
í˘y≥
 = 
	`ÕEncodeGëTy≥
(
ñe
,
size
,
öãnc
,&
í˛í
);

631 
í˘y≥
 = -1;

632 
í˛í
 = 0;

638 
backÀn_size
 = 
ñe
 ? 
	`ÕEncodeBackÀn
(
backÀn
,
í˛í
) : 0;

639 
uöt64_t
 
ﬁd_li°∑ck_byãs
 = 
	`ÕGëTŸÆByãs
(
Õ
);

640 
uöt32_t
 
ª∂a˚d_Àn
 = 0;

641 i‡(
whîe
 =
LP_REPLACE
) {

642 
ª∂a˚d_Àn
 = 
	`ÕCuºítEncodedSize
(
p
);

643 
ª∂a˚d_Àn
 +
	`ÕEncodeBackÀn
(
NULL
,replaced_len);

646 
uöt64_t
 
√w_li°∑ck_byãs
 = 
ﬁd_li°∑ck_byãs
 + 
í˛í
 + 
backÀn_size


647 - 
ª∂a˚d_Àn
;

648 i‡(
√w_li°∑ck_byãs
 > 
UINT32_MAX
Ë 
NULL
;

656 *
d°
 = 
Õ
 + 
poff
;

659 i‡(
√w_li°∑ck_byãs
 > 
ﬁd_li°∑ck_byãs
) {

660 i‡((
Õ
 = 
	`Õ_ªÆloc
÷p,
√w_li°∑ck_byãs
)Ë=
NULL
)  NULL;

661 
d°
 = 
Õ
 + 
poff
;

666 i‡(
whîe
 =
LP_BEFORE
) {

667 
	`memmove
(
d°
+
í˛í
+
backÀn_size
,d°,
ﬁd_li°∑ck_byãs
-
poff
);

669 
Àndiff
 = (
í˛í
+
backÀn_size
)-
ª∂a˚d_Àn
;

670 
	`memmove
(
d°
+
ª∂a˚d_Àn
+
Àndiff
,

671 
d°
+
ª∂a˚d_Àn
,

672 
ﬁd_li°∑ck_byãs
-
poff
-
ª∂a˚d_Àn
);

676 i‡(
√w_li°∑ck_byãs
 < 
ﬁd_li°∑ck_byãs
) {

677 i‡((
Õ
 = 
	`Õ_ªÆloc
÷p,
√w_li°∑ck_byãs
)Ë=
NULL
)  NULL;

678 
d°
 = 
Õ
 + 
poff
;

682 i‡(
√wp
) {

683 *
√wp
 = 
d°
;

686 i‡(!
ñe
 && 
d°
[0] =
LP_EOF
Ë*
√wp
 = 
NULL
;

688 i‡(
ñe
) {

689 i‡(
í˘y≥
 =
LP_ENCODING_INT
) {

690 
	`mem˝y
(
d°
,
öãnc
,
í˛í
);

692 
	`ÕEncodeSåög
(
d°
,
ñe
,
size
);

694 
d°
 +
í˛í
;

695 
	`mem˝y
(
d°
,
backÀn
,
backÀn_size
);

696 
d°
 +
backÀn_size
;

700 i‡(
whîe
 !
LP_REPLACE
 || 
ñe
 =
NULL
) {

701 
uöt32_t
 
num_ñemíts
 = 
	`ÕGëNumEÀmíts
(
Õ
);

702 i‡(
num_ñemíts
 !
LP_HDR_NUMELE_UNKNOWN
) {

703 i‡(
ñe
)

704 
	`ÕSëNumEÀmíts
(
Õ
,
num_ñemíts
+1);

706 
	`ÕSëNumEÀmíts
(
Õ
,
num_ñemíts
-1);

709 
	`ÕSëTŸÆByãs
(
Õ
,
√w_li°∑ck_byãs
);

718 *
ﬁdÕ
 = 
Õ
;

719 
Õ
 = 
	`Õ_mÆloc
(
√w_li°∑ck_byãs
);

720 
	`mem˝y
(
Õ
,
ﬁdÕ
,
√w_li°∑ck_byãs
);

721 i‡(
√wp
) {

722 
off£t
 = (*
√wp
)-
ﬁdÕ
;

723 *
√wp
 = 
Õ
 + 
off£t
;

726 
	`mem£t
(
ﬁdÕ
,'A',
√w_li°∑ck_byãs
);

727 
	`Õ_‰ì
(
ﬁdÕ
);

730  
Õ
;

731 
	}
}

736 *
	$ÕAµíd
(*
Õ
, *
ñe
, 
uöt32_t
 
size
) {

737 
uöt64_t
 
li°∑ck_byãs
 = 
	`ÕGëTŸÆByãs
(
Õ
);

738 *
eoÂå
 = 
Õ
 + 
li°∑ck_byãs
 - 1;

739  
	`ÕIn£π
(
Õ
,
ñe
,
size
,
eoÂå
,
LP_BEFORE
,
NULL
);

740 
	}
}

746 *
	$ÕDñëe
(*
Õ
, *
p
, **
√wp
) {

747  
	`ÕIn£π
(
Õ
,
NULL
,0,
p
,
LP_REPLACE
,
√wp
);

748 
	}
}

751 
uöt32_t
 
	$ÕByãs
(*
Õ
) {

752  
	`ÕGëTŸÆByãs
(
Õ
);

753 
	}
}

760 *
	$ÕSìk
(*
Õ
, 
ödex
) {

761 
f‹w¨d
 = 1;

767 
uöt32_t
 
numñe
 = 
	`ÕGëNumEÀmíts
(
Õ
);

768 i‡(
numñe
 !
LP_HDR_NUMELE_UNKNOWN
) {

769 i‡(
ödex
 < 0Ëödex = ()
numñe
+index;

770 i‡(
ödex
 < 0Ë 
NULL
;

771 i‡(
ödex
 >
numñe
Ë 
NULL
;

774 i‡(
ödex
 > 
numñe
/2) {

775 
f‹w¨d
 = 0;

778 
ödex
 -
numñe
;

783 i‡(
ödex
 < 0Ë
f‹w¨d
 = 0;

787 i‡(
f‹w¨d
) {

788 *
ñe
 = 
	`ÕFú°
(
Õ
);

789 
ödex
 > 0 && 
ñe
) {

790 
ñe
 = 
	`ÕNext
(
Õ
,ele);

791 
ödex
--;

793  
ñe
;

795 *
ñe
 = 
	`ÕLa°
(
Õ
);

796 
ödex
 < -1 && 
ñe
) {

797 
ñe
 = 
	`ÕPªv
(
Õ
,ele);

798 
ödex
++;

800  
ñe
;

802 
	}
}

	@listpack.h

35 #i‚de‡
__LISTPACK_H


36 
	#__LISTPACK_H


	)

38 
	~<°döt.h
>

40 
	#LP_INTBUF_SIZE
 21

	)

43 
	#LP_BEFORE
 0

	)

44 
	#LP_AFTER
 1

	)

45 
	#LP_REPLACE
 2

	)

47 *
ÕNew
();

48 
ÕFªe
(*
Õ
);

49 *
ÕIn£π
(*
Õ
, *
ñe
, 
uöt32_t
 
size
, *
p
, 
whîe
, **
√wp
);

50 *
ÕAµíd
(*
Õ
, *
ñe
, 
uöt32_t
 
size
);

51 *
ÕDñëe
(*
Õ
, *
p
, **
√wp
);

52 
uöt32_t
 
ÕLígth
(*
Õ
);

53 *
ÕGë
(*
p
, 
öt64_t
 *
cou¡
, *
ötbuf
);

54 *
ÕFú°
(*
Õ
);

55 *
ÕLa°
(*
Õ
);

56 *
ÕNext
(*
Õ
, *
p
);

57 *
ÕPªv
(*
Õ
, *
p
);

58 
uöt32_t
 
ÕByãs
(*
Õ
);

59 *
ÕSìk
(*
Õ
, 
ödex
);

	@listpack_malloc.h

39 #i‚de‡
LISTPACK_ALLOC_H


40 
	#LISTPACK_ALLOC_H


	)

41 
	~"zmÆloc.h
"

42 
	#Õ_mÆloc
 
zmÆloc


	)

43 
	#Õ_ªÆloc
 
zªÆloc


	)

44 
	#Õ_‰ì
 
z‰ì


	)

	@localtime.c

30 
	~<time.h
>

52 
	$is_À≠_yór
(
time_t
 
yór
) {

53 i‡(
yór
 % 4)  0;

54 i‡(
yór
 % 100)  1;

55 i‡(
yór
 % 400)  0;

57 
	}
}

59 
	$nﬁocks_loˇ…ime
(
tm
 *
tmp
, 
time_t
 
t
,Åime_à
tz
, 
d°
) {

60 c⁄° 
time_t
 
£cs_mö
 = 60;

61 c⁄° 
time_t
 
£cs_hour
 = 3600;

62 c⁄° 
time_t
 
£cs_day
 = 3600*24;

64 
t
 -
tz
;

65 
t
 +3600*
d°
;

66 
time_t
 
days
 = 
t
 / 
£cs_day
;

67 
time_t
 
£c⁄ds
 = 
t
 % 
£cs_day
;

69 
tmp
->
tm_isd°
 = 
d°
;

70 
tmp
->
tm_hour
 = 
£c⁄ds
 / 
£cs_hour
;

71 
tmp
->
tm_mö
 = (
£c⁄ds
 % 
£cs_hour
Ë/ 
£cs_mö
;

72 
tmp
->
tm_£c
 = (
£c⁄ds
 % 
£cs_hour
Ë% 
£cs_mö
;

77 
tmp
->
tm_wday
 = (
days
+4)%7;

80 
tmp
->
tm_yór
 = 1970;

83 
time_t
 
days_this_yór
 = 365 + 
	`is_À≠_yór
(
tmp
->
tm_yór
);

84 i‡(
days_this_yór
 > 
days
) ;

85 
days
 -
days_this_yór
;

86 
tmp
->
tm_yór
++;

88 
tmp
->
tm_yday
 = 
days
;

93 
mdays
[12] = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};

94 
mdays
[1] +
	`is_À≠_yór
(
tmp
->
tm_yór
);

96 
tmp
->
tm_m⁄
 = 0;

97 
days
 >
mdays
[
tmp
->
tm_m⁄
]) {

98 
days
 -
mdays
[
tmp
->
tm_m⁄
];

99 
tmp
->
tm_m⁄
++;

102 
tmp
->
tm_mday
 = 
days
+1;

103 
tmp
->
tm_yór
 -= 1900;

104 
	}
}

106 #ifde‡
LOCALTIME_TEST_MAIN


107 
	~<°dio.h
>

109 
	$maö
() {

111 
	`tz£t
();

112 
time_t
 
t
 = 
	`time
(
NULL
);

113 
tm
 *
aux
 = 
	`loˇ…ime
(&
t
);

114 
daylight_a˘ive
 = 
aux
->
tm_isd°
;

116 
tm
Åm;

117 
buf
[1024];

119 
	`nﬁocks_loˇ…ime
(&
tm
,
t
,
timez⁄e
,
daylight_a˘ive
);

120 
	`°r·ime
(
buf
,(buf),"%d %b %H:%M:%S",&
tm
);

121 
	`¥ötf
("[timez⁄e: %d, dl: %d] %s\n", ()
timez⁄e
, ()
daylight_a˘ive
, 
buf
);

122 
	}
}

	@lolwut.c

36 
	~"£rvî.h
"

37 
	~"lﬁwut.h
"

38 
	~<m©h.h
>

40 
lﬁwut5Comm™d
(
˛õ¡
 *
c
);

41 
lﬁwut6Comm™d
(
˛õ¡
 *
c
);

45 
	$lﬁwutUn°abÀComm™d
(
˛õ¡
 *
c
) {

46 
sds
 
ªndîed
 = 
	`sd¢ew
("Redis ver. ");

47 
ªndîed
 = 
	`sdsˇt
‘ídîed,
REDIS_VERSION
);

48 
ªndîed
 = 
	`sdsˇéí
(rendered,"\n",1);

49 
	`addRïlyVîb©im
(
c
,
ªndîed
,
	`sd¶í
(rendered),"txt");

50 
	`sds‰ì
(
ªndîed
);

51 
	}
}

54 
	$lﬁwutComm™d
(
˛õ¡
 *
c
) {

55 *
v
 = 
REDIS_VERSION
;

56 
vî°r
[64];

58 i‡(
c
->
¨gc
 >3 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"version")) {

59 
vî
;

60 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
vî
,
NULL
Ë!
C_OK
) ;

61 
	`¢¥ötf
(
vî°r
,(vî°r),"%u.0.0",()
vî
);

62 
v
 = 
vî°r
;

67 
c
->
¨gv
 += 2;

68 
c
->
¨gc
 -= 2;

71 i‡((
v
[0] == '5' && v[1] == '.' && v[2] != '9') ||

72 (
v
[0] == '4' && v[1] == '.' && v[2] == '9'))

73 
	`lﬁwut5Comm™d
(
c
);

74 i‡((
v
[0] == '6' && v[1] == '.' && v[2] != '9') ||

75 (
v
[0] == '5' && v[1] == '.' && v[2] == '9'))

76 
	`lﬁwut6Comm™d
(
c
);

78 
	`lﬁwutUn°abÀComm™d
(
c
);

81 i‡(
v
 =
vî°r
) {

82 
c
->
¨gv
 -= 2;

83 
c
->
¨gc
 += 2;

85 
	}
}

93 
lwC™vas
 *
	$lwCª©eC™vas
(
width
, 
height
, 
bgcﬁ‹
) {

94 
lwC™vas
 *
ˇnvas
 = 
	`zmÆloc
((*canvas));

95 
ˇnvas
->
width
 = width;

96 
ˇnvas
->
height
 = height;

97 
ˇnvas
->
pixñs
 = 
	`zmÆloc
(
width
*
height
);

98 
	`mem£t
(
ˇnvas
->
pixñs
,
bgcﬁ‹
,
width
*
height
);

99  
ˇnvas
;

100 
	}
}

103 
	$lwFªeC™vas
(
lwC™vas
 *
ˇnvas
) {

104 
	`z‰ì
(
ˇnvas
->
pixñs
);

105 
	`z‰ì
(
ˇnvas
);

106 
	}
}

112 
	$lwDøwPixñ
(
lwC™vas
 *
ˇnvas
, 
x
, 
y
, 
cﬁ‹
) {

113 i‡(
x
 < 0 || x >
ˇnvas
->
width
 ||

114 
y
 < 0 || y >
ˇnvas
->
height
) ;

115 
ˇnvas
->
pixñs
[
x
+
y
*ˇnvas->
width
] = 
cﬁ‹
;

116 
	}
}

119 
	$lwGëPixñ
(
lwC™vas
 *
ˇnvas
, 
x
, 
y
) {

120 i‡(
x
 < 0 || x >
ˇnvas
->
width
 ||

121 
y
 < 0 || y >
ˇnvas
->
height
)  0;

122  
ˇnvas
->
pixñs
[
x
+
y
*ˇnvas->
width
];

123 
	}
}

126 
	$lwDøwLöe
(
lwC™vas
 *
ˇnvas
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹
) {

127 
dx
 = 
	`abs
(
x2
-
x1
);

128 
dy
 = 
	`abs
(
y2
-
y1
);

129 
sx
 = (
x1
 < 
x2
) ? 1 : -1;

130 
sy
 = (
y1
 < 
y2
) ? 1 : -1;

131 
îr
 = 
dx
-
dy
, 
e2
;

134 
	`lwDøwPixñ
(
ˇnvas
,
x1
,
y1
,
cﬁ‹
);

135 i‡(
x1
 =
x2
 && 
y1
 =
y2
) ;

136 
e2
 = 
îr
*2;

137 i‡(
e2
 > -
dy
) {

138 
îr
 -
dy
;

139 
x1
 +
sx
;

141 i‡(
e2
 < 
dx
) {

142 
îr
 +
dx
;

143 
y1
 +
sy
;

146 
	}
}

167 
	$lwDøwSqu¨e
(
lwC™vas
 *
ˇnvas
, 
x
, 
y
, 
size
, 
™gÀ
, 
cﬁ‹
) {

168 
px
[4], 
py
[4];

174 
size
 /= 1.4142135623;

175 
size
 = 
	`round
(size);

178 
k
 = 
M_PI
/4 + 
™gÀ
;

179 
j
 = 0; j < 4; j++) {

180 
px
[
j
] = 
	`round
(
	`sö
(
k
Ë* 
size
 + 
x
);

181 
py
[
j
] = 
	`round
(
	`cos
(
k
Ë* 
size
 + 
y
);

182 
k
 +
M_PI
/2;

186 
j
 = 0; j < 4; j++)

187 
	`lwDøwLöe
(
ˇnvas
,
px
[
j
],
py
[j],px[(j+1)%4],py[(j+1)%4],
cﬁ‹
);

188 
	}
}

	@lolwut.h

38 #i‚de‡
__LOLWUT_H


39 
	#__LOLWUT_H


	)

41 
	slwC™vas
 {

42 
	mwidth
;

43 
	mheight
;

44 *
	mpixñs
;

45 } 
	tlwC™vas
;

48 
lwC™vas
 *
lwCª©eC™vas
(
width
, 
height
, 
bgcﬁ‹
);

49 
lwFªeC™vas
(
lwC™vas
 *
ˇnvas
);

50 
lwDøwPixñ
(
lwC™vas
 *
ˇnvas
, 
x
, 
y
, 
cﬁ‹
);

51 
lwGëPixñ
(
lwC™vas
 *
ˇnvas
, 
x
, 
y
);

52 
lwDøwLöe
(
lwC™vas
 *
ˇnvas
, 
x1
, 
y1
, 
x2
, 
y2
, 
cﬁ‹
);

53 
lwDøwSqu¨e
(
lwC™vas
 *
ˇnvas
, 
x
, 
y
, 
size
, 
™gÀ
, 
cﬁ‹
);

	@lolwut5.c

36 
	~"£rvî.h
"

37 
	~"lﬁwut.h
"

38 
	~<m©h.h
>

53 
	~<°dio.h
>

54 
	$lwTøn¶©ePixñsGroup
(
byã
, *
ouçut
) {

55 
code
 = 0x2800 + 
byã
;

59 
ouçut
[0] = 0xE0 | (
code
 >> 12);

60 
ouçut
[1] = 0x80 | ((
code
 >> 6) & 0x3F);

61 
ouçut
[2] = 0x80 | (
code
 & 0x3F);

62 
	}
}

71 
lwC™vas
 *
	$lwDøwSchŸãr
(
c⁄sﬁe_cﬁs
, 
squ¨es_≥r_row
, 
squ¨es_≥r_cﬁ
) {

73 
ˇnvas_width
 = 
c⁄sﬁe_cﬁs
*2;

74 
∑ddög
 = 
ˇnvas_width
 > 4 ? 2 : 0;

75 
squ¨e_side
 = ()(
ˇnvas_width
-
∑ddög
*2Ë/ 
squ¨es_≥r_row
;

76 
ˇnvas_height
 = 
squ¨e_side
 * 
squ¨es_≥r_cﬁ
 + 
∑ddög
*2;

77 
lwC™vas
 *
ˇnvas
 = 
	`lwCª©eC™vas
(
ˇnvas_width
, 
ˇnvas_height
, 0);

79 
y
 = 0; y < 
squ¨es_≥r_cﬁ
; y++) {

80 
x
 = 0; x < 
squ¨es_≥r_row
; x++) {

81 
sx
 = 
x
 * 
squ¨e_side
 + squ¨e_side/2 + 
∑ddög
;

82 
sy
 = 
y
 * 
squ¨e_side
 + squ¨e_side/2 + 
∑ddög
;

85 
™gÀ
 = 0;

86 i‡(
y
 > 1) {

87 
r1
 = ()
	`ønd
(Ë/ 
RAND_MAX
 / 
squ¨es_≥r_cﬁ
 * 
y
;

88 
r2
 = ()
	`ønd
(Ë/ 
RAND_MAX
 / 
squ¨es_≥r_cﬁ
 * 
y
;

89 
r3
 = ()
	`ønd
(Ë/ 
RAND_MAX
 / 
squ¨es_≥r_cﬁ
 * 
y
;

90 i‡(
	`ønd
(Ë% 2Ë
r1
 = -r1;

91 i‡(
	`ønd
(Ë% 2Ë
r2
 = -r2;

92 i‡(
	`ønd
(Ë% 2Ë
r3
 = -r3;

93 
™gÀ
 = 
r1
;

94 
sx
 +
r2
*
squ¨e_side
/3;

95 
sy
 +
r3
*
squ¨e_side
/3;

97 
	`lwDøwSqu¨e
(
ˇnvas
,
sx
,
sy
,
squ¨e_side
,
™gÀ
,1);

101  
ˇnvas
;

102 
	}
}

109 
sds
 
	$ªndîC™vas
(
lwC™vas
 *
ˇnvas
) {

110 
sds
 
ãxt
 = 
	`sd£m±y
();

111 
y
 = 0; y < 
ˇnvas
->
height
; y += 4) {

112 
x
 = 0; x < 
ˇnvas
->
width
; x += 2) {

115 
byã
 = 0;

116 i‡(
	`lwGëPixñ
(
ˇnvas
,
x
,
y
)Ë
byã
 |= (1<<0);

117 i‡(
	`lwGëPixñ
(
ˇnvas
,
x
,
y
+1)Ë
byã
 |= (1<<1);

118 i‡(
	`lwGëPixñ
(
ˇnvas
,
x
,
y
+2)Ë
byã
 |= (1<<2);

119 i‡(
	`lwGëPixñ
(
ˇnvas
,
x
+1,
y
)Ë
byã
 |= (1<<3);

120 i‡(
	`lwGëPixñ
(
ˇnvas
,
x
+1,
y
+1)Ë
byã
 |= (1<<4);

121 i‡(
	`lwGëPixñ
(
ˇnvas
,
x
+1,
y
+2)Ë
byã
 |= (1<<5);

122 i‡(
	`lwGëPixñ
(
ˇnvas
,
x
,
y
+3)Ë
byã
 |= (1<<6);

123 i‡(
	`lwGëPixñ
(
ˇnvas
,
x
+1,
y
+3)Ë
byã
 |= (1<<7);

124 
unicode
[3];

125 
	`lwTøn¶©ePixñsGroup
(
byã
,
unicode
);

126 
ãxt
 = 
	`sdsˇéí
—ext,
unicode
,3);

128 i‡(
y
 !
ˇnvas
->
height
-1Ë
ãxt
 = 
	`sdsˇéí
(text,"\n",1);

130  
ãxt
;

131 
	}
}

140 
	$lﬁwut5Comm™d
(
˛õ¡
 *
c
) {

141 
cﬁs
 = 66;

142 
squ¨es_≥r_row
 = 8;

143 
squ¨es_≥r_cﬁ
 = 12;

146 i‡(
c
->
¨gc
 > 1 &&

147 
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[1],&
cﬁs
,
NULL
Ë!
C_OK
)

150 i‡(
c
->
¨gc
 > 2 &&

151 
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
squ¨es_≥r_row
,
NULL
Ë!
C_OK
)

154 i‡(
c
->
¨gc
 > 3 &&

155 
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
squ¨es_≥r_cﬁ
,
NULL
Ë!
C_OK
)

160 i‡(
cﬁs
 < 1) cols = 1;

161 i‡(
cﬁs
 > 1000) cols = 1000;

162 i‡(
squ¨es_≥r_row
 < 1) squares_per_row = 1;

163 i‡(
squ¨es_≥r_row
 > 200) squares_per_row = 200;

164 i‡(
squ¨es_≥r_cﬁ
 < 1) squares_per_col = 1;

165 i‡(
squ¨es_≥r_cﬁ
 > 200) squares_per_col = 200;

168 
lwC™vas
 *
ˇnvas
 = 
	`lwDøwSchŸãr
(
cﬁs
,
squ¨es_≥r_row
,
squ¨es_≥r_cﬁ
);

169 
sds
 
ªndîed
 = 
	`ªndîC™vas
(
ˇnvas
);

170 
ªndîed
 = 
	`sdsˇt
(rendered,

172 
ªndîed
 = 
	`sdsˇt
‘ídîed,
REDIS_VERSION
);

173 
ªndîed
 = 
	`sdsˇéí
(rendered,"\n",1);

174 
	`addRïlyVîb©im
(
c
,
ªndîed
,
	`sd¶í
(rendered),"txt");

175 
	`sds‰ì
(
ªndîed
);

176 
	`lwFªeC™vas
(
ˇnvas
);

177 
	}
}

	@lolwut6.c

42 
	~"£rvî.h
"

43 
	~"lﬁwut.h
"

47 
sds
 
	$ªndîC™vas
(
lwC™vas
 *
ˇnvas
) {

48 
sds
 
ãxt
 = 
	`sd£m±y
();

49 
y
 = 0; y < 
ˇnvas
->
height
; y++) {

50 
x
 = 0; x < 
ˇnvas
->
width
; x++) {

51 
cﬁ‹
 = 
	`lwGëPixñ
(
ˇnvas
,
x
,
y
);

52 *
˚
;

57 
cﬁ‹
) {

58 0: 
˚
 = "0;30;40m"; ;

59 1: 
˚
 = "0;90;100m"; ;

60 2: 
˚
 = "0;37;47m"; ;

61 3: 
˚
 = "0;97;107m"; ;

62 : 
˚
 = "0;30;40m"; ;

64 
ãxt
 = 
	`sdsˇçrötf
—ext,"\033[%†\033[0m",
˚
);

66 i‡(
y
 !
ˇnvas
->
height
-1Ë
ãxt
 = 
	`sdsˇéí
(text,"\n",1);

68  
ãxt
;

69 
	}
}

74 
	sskys¸≠î
 {

75 
	mxoff
;

76 
	mwidth
;

77 
	mheight
;

78 
	mwödows
;

79 
	mcﬁ‹
;

82 
	$gíî©eSkys¸≠î
(
lwC™vas
 *
ˇnvas
, 
skys¸≠î
 *
si
) {

83 
°¨ty
 = 
ˇnvas
->
height
-1;

84 
ídy
 = 
°¨ty
 - 
si
->
height
 + 1;

85 
y
 = 
°¨ty
; y >
ídy
; y--) {

86 
x
 = 
si
->
xoff
; x < si->xoff+si->
width
; x++) {

88 i‡(
y
 =
ídy
 && (
x
 <
si
->
xoff
+1 || x >si->xoff+si->
width
-2))

90 
cﬁ‹
 = 
si
->color;

94 i‡(
si
->
wödows
 &&

95 
x
 > 
si
->
xoff
+1 &&

96 
x
 < 
si
->
xoff
+si->
width
-2 &&

97 
y
 > 
ídy
+1 &&

98 
y
 < 
°¨ty
-1)

102 
ªlx
 = 
x
 - (
si
->
xoff
+1);

103 
ªly
 = 
y
 - (
ídy
+1);

108 i‡(
ªlx
/2 % 2 && 
ªly
 % 2) {

110 
cﬁ‹
 = 1 + 
	`ønd
() % 2;

111 } 
cﬁ‹
 =
si
->color);

114 i‡(
ªlx
 % 2Ë
cﬁ‹
 = 
	`lwGëPixñ
(
ˇnvas
,
x
-1,
y
);

117 
	`lwDøwPixñ
(
ˇnvas
,
x
,
y
,
cﬁ‹
);

120 
	}
}

123 
	$gíî©eSkylöe
(
lwC™vas
 *
ˇnvas
) {

124 
skys¸≠î
 
si
;

129 
cﬁ‹
 = 2; color >= 1; color--) {

130 
si
.
cﬁ‹
 = color;

131 
off£t
 = -10; off£à< 
ˇnvas
->
width
;) {

132 
off£t
 +
	`ønd
() % 8;

133 
si
.
xoff
 = 
off£t
;

134 
si
.
width
 = 10 + 
	`ønd
()%9;

135 i‡(
cﬁ‹
 == 2)

136 
si
.
height
 = 
ˇnvas
->height/2 + 
	`ønd
()%canvas->height/2;

138 
si
.
height
 = 
ˇnvas
->height/2 + 
	`ønd
()%canvas->height/3;

139 
si
.
wödows
 = 0;

140 
	`gíî©eSkys¸≠î
(
ˇnvas
, &
si
);

141 i‡(
cﬁ‹
 == 2)

142 
off£t
 +
si
.
width
/2;

144 
off£t
 +
si
.
width
+1;

149 
si
.
cﬁ‹
 = 0;

150 
off£t
 = -10; off£à< 
ˇnvas
->
width
;) {

151 
off£t
 +
	`ønd
() % 8;

152 
si
.
xoff
 = 
off£t
;

153 
si
.
width
 = 5 + 
	`ønd
()%14;

154 i‡(
si
.
width
 % 4) si.width += (si.width % 3);

155 
si
.
height
 = 
ˇnvas
->height/3 + 
	`ønd
()%canvas->height/2;

156 
si
.
wödows
 = 1;

157 
	`gíî©eSkys¸≠î
(
ˇnvas
, &
si
);

158 
off£t
 +
si
.
width
+5;

160 
	}
}

169 
	$lﬁwut6Comm™d
(
˛õ¡
 *
c
) {

170 
cﬁs
 = 80;

171 
rows
 = 20;

174 i‡(
c
->
¨gc
 > 1 &&

175 
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[1],&
cﬁs
,
NULL
Ë!
C_OK
)

178 i‡(
c
->
¨gc
 > 2 &&

179 
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
rows
,
NULL
Ë!
C_OK
)

184 i‡(
cﬁs
 < 1) cols = 1;

185 i‡(
cﬁs
 > 1000) cols = 1000;

186 i‡(
rows
 < 1)Ñows = 1;

187 i‡(
rows
 > 1000)Ñows = 1000;

190 
lwC™vas
 *
ˇnvas
 = 
	`lwCª©eC™vas
(
cﬁs
,
rows
,3);

191 
	`gíî©eSkylöe
(
ˇnvas
);

192 
sds
 
ªndîed
 = 
	`ªndîC™vas
(
ˇnvas
);

193 
ªndîed
 = 
	`sdsˇt
(rendered,

196 
ªndîed
 = 
	`sdsˇt
‘ídîed,
REDIS_VERSION
);

197 
ªndîed
 = 
	`sdsˇéí
(rendered,"\n",1);

198 
	`addRïlyVîb©im
(
c
,
ªndîed
,
	`sd¶í
(rendered),"txt");

199 
	`sds‰ì
(
ªndîed
);

200 
	`lwFªeC™vas
(
ˇnvas
);

201 
	}
}

	@lzf.h

37 #i‚de‡
LZF_H


38 
	#LZF_H


	)

49 
	#LZF_VERSION
 0x0105

	)

77 
lzf_com¥ess
 (c⁄° *c⁄° 
ö_d©a
, 
ö_Àn
,

78 *
out_d©a
, 
out_Àn
);

96 
lzf_decom¥ess
 (c⁄° *c⁄° 
ö_d©a
, 
ö_Àn
,

97 *
out_d©a
, 
out_Àn
);

	@lzfP.h

37 #i‚de‡
LZFP_h


38 
	#LZFP_h


	)

40 
	#STANDALONE
 1

	)

42 #i‚de‡
STANDALONE


43 
	~"lzf.h
"

54 #i‚de‡
HLOG


55 
	#HLOG
 16

	)

63 #i‚de‡
VERY_FAST


64 
	#VERY_FAST
 1

	)

74 #i‚de‡
ULTRA_FAST


75 
	#ULTRA_FAST
 0

	)

81 #i‚de‡
STRICT_ALIGN


82 #i‡!(
deföed
(
__i386
Ë|| deföed (
__amd64
))

83 
	#STRICT_ALIGN
 1

	)

85 
	#STRICT_ALIGN
 0

	)

94 #i‚de‡
INIT_HTAB


95 
	#INIT_HTAB
 0

	)

103 #i‚de‡
AVOID_ERRNO


104 
	#AVOID_ERRNO
 0

	)

112 #i‚de‡
LZF_STATE_ARG


113 
	#LZF_STATE_ARG
 0

	)

124 #i‚de‡
CHECK_INPUT


125 
	#CHECK_INPUT
 1

	)

138 #ifde‡
__˝lu•lus


139 
	~<c°rög
>

140 
	~<˛imôs
>

141 
usög
 
«me•a˚
 
	g°d
;

143 
	~<°rög.h
>

144 
	~<limôs.h
>

147 #i‚de‡
LZF_USE_OFFSETS


148 #i‡
deföed
 (
WIN32
)

149 
	#LZF_USE_OFFSETS
 
	`deföed
(
_M_X64
)

	)

151 #i‡
__˝lu•lus
 > 199711L

152 
	~<c°döt
>

154 
	~<°döt.h
>

156 
	#LZF_USE_OFFSETS
 (
UINTPTR_MAX
 > 0xffffffffU)

	)

160 
	tu8
;

162 #i‡
LZF_USE_OFFSETS


163 
	#LZF_HSLOT_BIAS
 ((c⁄° 
u8
 *)
ö_d©a
)

	)

164 
	tLZF_HSLOT
;

166 
	#LZF_HSLOT_BIAS
 0

	)

167 c⁄° 
	tu8
 *
	tLZF_HSLOT
;

170 
LZF_HSLOT
 
	tLZF_STATE
[1 << (
HLOG
)];

172 #i‡!
STRICT_ALIGN


174 #i‡
USHRT_MAX
 == 65535

175 
	tu16
;

176 #ñi‡
UINT_MAX
 == 65535

177 
	tu16
;

179 #unde‡
STRICT_ALIGN


180 
	#STRICT_ALIGN
 1

	)

184 #i‡
ULTRA_FAST


185 #unde‡
VERY_FAST


	@lzf_c.c

37 
	~"lzfP.h
"

39 
	#HSIZE
 (1 << (
HLOG
))

	)

47 #i‚de‡
FRST


48 
	#FRST
(
p
Ë((’[0]Ë<< 8Ë|Ö[1])

	)

49 
	#NEXT
(
v
,
p
Ë(((vË<< 8Ë|Ö[2])

	)

50 #i‡
ULTRA_FAST


51 
	#IDX
(
h
Ë((–h >> (3*8 - 
HLOG
)Ë- h ) & (
HSIZE
 - 1))

	)

52 #ñi‡
VERY_FAST


53 
	#IDX
(
h
Ë((–h >> (3*8 - 
HLOG
)Ë- h*5Ë& (
HSIZE
 - 1))

	)

55 
	#IDX
(
h
Ë((((h ^ (h << 5)Ë>> (3*8 - 
HLOG
)Ë- h*5Ë& (
HSIZE
 - 1))

	)

69 
	#FRST
(
p
Ë’[0] << 5Ë^Ö[1]

	)

70 
	#NEXT
(
v
,
p
Ë((vË<< 5Ë^Ö[2]

	)

71 
	#IDX
(
h
Ë((hË& (
HSIZE
 - 1))

	)

74 
	#MAX_LIT
 (1 << 5)

	)

75 
	#MAX_OFF
 (1 << 13)

	)

76 
	#MAX_REF
 ((1 << 8Ë+ (1 << 3))

	)

78 #i‡
__GNUC__
 >= 3

79 
	#ex≥˘
(
ex¥
,
vÆue
Ë
	`__buûtö_ex≥˘
 (”x¥),(vÆue))

	)

80 
	#ölöe
 
ölöe


	)

82 
	#ex≥˘
(
ex¥
,
vÆue
Ë”x¥)

	)

83 
	#ölöe
 

	)

86 
	#ex≥˘_Ál£
(
ex¥
Ë
	`ex≥˘
 (”x¥Ë!0, 0)

	)

87 
	#ex≥˘_åue
(
ex¥
Ë
	`ex≥˘
 (”x¥Ë!0, 1)

	)

99 
lzf_com¥ess
 (c⁄° *c⁄° 
ö_d©a
, 
ö_Àn
,

100 *
out_d©a
, 
out_Àn


101 #i‡
LZF_STATE_ARG


102 , 
LZF_STATE
 
hèb


106 #i‡!
LZF_STATE_ARG


107 
LZF_STATE
 
	ghèb
;

109 c⁄° 
u8
 *
	gù
 = (c⁄° u8 *)
ö_d©a
;

110 
u8
 *
	g›
 = (u8 *)
out_d©a
;

111 c⁄° 
u8
 *
	gö_íd
 = 
ù
 + 
ö_Àn
;

112 
u8
 *
	gout_íd
 = 
›
 + 
out_Àn
;

113 c⁄° 
u8
 *
	gªf
;

122 #i‡
deföed
 (
WIN32
Ë&& deföed (
_M_X64
)

123 
_öt64
 
	goff
;

125 
	goff
;

127 
	ghvÆ
;

128 
	glô
;

130 i‡(!
	gö_Àn
 || !
	gout_Àn
)

133 #i‡
INIT_HTAB


134 
mem£t
 (
hèb
, 0,  (htab));

137 
	glô
 = 0; 
	g›
++;

139 
	ghvÆ
 = 
FRST
 (
ù
);

140 
	gù
 < 
	gö_íd
 - 2)

142 
LZF_HSLOT
 *
	gh¶Ÿ
;

144 
	ghvÆ
 = 
NEXT
 (
hvÆ
, 
ù
);

145 
	gh¶Ÿ
 = 
hèb
 + 
IDX
 (
hvÆ
);

146 
	gªf
 = *
h¶Ÿ
 + 
LZF_HSLOT_BIAS
; *
	gh¶Ÿ
 = 
ù
 - LZF_HSLOT_BIAS;

149 #i‡
INIT_HTAB


150 && 
	gªf
 < 
	gù


152 && (
	goff
 = 
ù
 - 
ªf
 - 1Ë< 
MAX_OFF


153 && 
ªf
 > (
u8
 *)
ö_d©a


154 && 
ªf
[2] =
ù
[2]

155 #i‡
STRICT_ALIGN


156 && ((
ªf
[1] << 8Ë|Ñef[0]Ë=((
ù
[1] << 8) | ip[0])

158 && *(
u16
 *)
ªf
 =*(u16 *)
ù


163 
Àn
 = 2;

164 
	gmaxÀn
 = 
ö_íd
 - 
ù
 - 
Àn
;

165 
	gmaxÀn
 = 
maxÀn
 > 
MAX_REF
 ? MAX_REF : maxlen;

167 i‡(
ex≥˘_Ál£
 (
›
 + 3 + 1 >
out_íd
))

168 i‡(
›
 - !
lô
 + 3 + 1 >
out_íd
)

171 
	g›
 [- 
lô
 - 1] =Üit - 1;

172 
	g›
 -!
lô
;

176 i‡(
ex≥˘_åue
 (
maxÀn
 > 16))

178 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

179 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

180 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

181 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

183 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

184 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

185 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

186 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

188 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

189 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

190 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

191 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

193 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

194 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

195 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

196 
	gÀn
++; i‡(
	gªf
 [
Àn
] !
ù
 [len]) ;

200 
	gÀn
++;

201 
	gÀn
 < 
	gmaxÀn
 && 
	gªf
[
Àn
] =
ù
[len]);

206 
	gÀn
 -= 2;

207 
	gù
++;

209 i‡(
	gÀn
 < 7)

211 *
	g›
++ = (
off
 >> 8Ë+ (
Àn
 << 5);

215 *
	g›
++ = (
off
 >> 8) + ( 7 << 5);

216 *
	g›
++ = 
Àn
 - 7;

219 *
	g›
++ = 
off
;

221 
	glô
 = 0; 
	g›
++;

223 
	gù
 +
Àn
 + 1;

225 i‡(
ex≥˘_Ál£
 (
ù
 >
ö_íd
 - 2))

228 #i‡
ULTRA_FAST
 || 
VERY_FAST


229 --
	gù
;

230 #i‡
VERY_FAST
 && !
ULTRA_FAST


231 --
	gù
;

233 
	ghvÆ
 = 
FRST
 (
ù
);

235 
	ghvÆ
 = 
NEXT
 (
hvÆ
, 
ù
);

236 
	ghèb
[
IDX
 (
hvÆ
)] = 
ù
 - 
LZF_HSLOT_BIAS
;

237 
	gù
++;

239 #i‡
VERY_FAST
 && !
ULTRA_FAST


240 
	ghvÆ
 = 
NEXT
 (
hvÆ
, 
ù
);

241 
	ghèb
[
IDX
 (
hvÆ
)] = 
ù
 - 
LZF_HSLOT_BIAS
;

242 
	gù
++;

245 
	gù
 -
Àn
 + 1;

249 
	ghvÆ
 = 
NEXT
 (
hvÆ
, 
ù
);

250 
	ghèb
[
IDX
 (
hvÆ
)] = 
ù
 - 
LZF_HSLOT_BIAS
;

251 
	gù
++;

253 
	gÀn
--);

259 i‡(
ex≥˘_Ál£
 (
›
 >
out_íd
))

262 
	glô
++; *
	g›
++ = *
ù
++;

264 i‡(
ex≥˘_Ál£
 (
lô
 =
MAX_LIT
))

266 
›
 [- 
lô
 - 1] =Üit - 1;

267 
	glô
 = 0; 
	g›
++;

272 i‡(
	g›
 + 3 > 
	gout_íd
)

275 
	gù
 < 
	gö_íd
)

277 
	glô
++; *
	g›
++ = *
ù
++;

279 i‡(
ex≥˘_Ál£
 (
lô
 =
MAX_LIT
))

281 
›
 [- 
lô
 - 1] =Üit - 1;

282 
	glô
 = 0; 
	g›
++;

286 
	g›
 [- 
lô
 - 1] =Üit - 1;

287 
	g›
 -!
lô
;

289  
	g›
 - (
	gu8
 *)
	gout_d©a
;

	@lzf_d.c

37 
	~"lzfP.h
"

39 #i‡
AVOID_ERRNO


40 
	#SET_ERRNO
(
n
)

	)

42 
	~<î∫o.h
>

43 
	#SET_ERRNO
(
n
Ë
î∫o
 = (n)

	)

46 #i‡
USE_REP_MOVSB


47 #i‡(
__i386
 || 
__amd64
Ë&& 
__GNUC__
 >= 3

48 
	#lzf_movsb
(
d°
, 
§c
, 
Àn
) \

49 
	`asm
 ("rep movsb" \

50 : "=D" (
d°
), "=S" (
§c
), "=c" (
Àn
) \

51 : "0" (
d°
), "1" (
§c
), "2" (
Àn
));

	)

55 #i‡
deföed
(
__GNUC__
) && __GNUC__ >= 5

56 #¥agm®
GCC
 
dügno°ic
 
push


57 #¥agm®
GCC
 
dügno°ic
 
ign‹ed
 "-Wimplicit-fallthrough"

60 
	$lzf_decom¥ess
 (c⁄° *c⁄° 
ö_d©a
, 
ö_Àn
,

61 *
out_d©a
, 
out_Àn
)

63 
u8
 c⁄° *
ù
 = (c⁄° u8 *)
ö_d©a
;

64 
u8
 *
›
 = (u8 *)
out_d©a
;

65 
u8
 c⁄° *c⁄° 
ö_íd
 = 
ù
 + 
ö_Àn
;

66 
u8
 *c⁄° 
out_íd
 = 
›
 + 
out_Àn
;

70 
˘æ
 = *
ù
++;

72 i‡(
˘æ
 < (1 << 5))

74 
˘æ
++;

76 i‡(
›
 + 
˘æ
 > 
out_íd
)

78 
	`SET_ERRNO
 (
E2BIG
);

82 #i‡
CHECK_INPUT


83 i‡(
ù
 + 
˘æ
 > 
ö_íd
)

85 
	`SET_ERRNO
 (
EINVAL
);

90 #ifde‡
lzf_movsb


91 
	`lzf_movsb
 (
›
, 
ù
, 
˘æ
);

93 
˘æ
)

95 32: *
›
++ = *
ù
++; 31: *op++ = *ip++; 30: *op++ = *ip++; 29: *op++ = *ip++;

96 28: *
›
++ = *
ù
++; 27: *op++ = *ip++; 26: *op++ = *ip++; 25: *op++ = *ip++;

97 24: *
›
++ = *
ù
++; 23: *op++ = *ip++; 22: *op++ = *ip++; 21: *op++ = *ip++;

98 20: *
›
++ = *
ù
++; 19: *op++ = *ip++; 18: *op++ = *ip++; 17: *op++ = *ip++;

99 16: *
›
++ = *
ù
++; 15: *op++ = *ip++; 14: *op++ = *ip++; 13: *op++ = *ip++;

100 12: *
›
++ = *
ù
++; 11: *op++ = *ip++; 10: *op++ = *ip++; 9: *op++ = *ip++;

101 8: *
›
++ = *
ù
++; 7: *op++ = *ip++; 6: *op++ = *ip++; 5: *op++ = *ip++;

102 4: *
›
++ = *
ù
++; 3: *op++ = *ip++; 2: *op++ = *ip++; 1: *op++ = *ip++;

108 
Àn
 = 
˘æ
 >> 5;

110 
u8
 *
ªf
 = 
›
 - ((
˘æ
 & 0x1f) << 8) - 1;

112 #i‡
CHECK_INPUT


113 i‡(
ù
 >
ö_íd
)

115 
	`SET_ERRNO
 (
EINVAL
);

119 i‡(
Àn
 == 7)

121 
Àn
 +*
ù
++;

122 #i‡
CHECK_INPUT


123 i‡(
ù
 >
ö_íd
)

125 
	`SET_ERRNO
 (
EINVAL
);

131 
ªf
 -*
ù
++;

133 i‡(
›
 + 
Àn
 + 2 > 
out_íd
)

135 
	`SET_ERRNO
 (
E2BIG
);

139 i‡(
ªf
 < (
u8
 *)
out_d©a
)

141 
	`SET_ERRNO
 (
EINVAL
);

145 #ifde‡
lzf_movsb


146 
Àn
 += 2;

147 
	`lzf_movsb
 (
›
, 
ªf
, 
Àn
);

149 
Àn
)

152 
Àn
 += 2;

154 i‡(
›
 >
ªf
 + 
Àn
)

157 
	`mem˝y
 (
›
, 
ªf
, 
Àn
);

158 
›
 +
Àn
;

164 *
›
++ = *
ªf
++;

165 --
Àn
);

170 9: *
›
++ = *
ªf
++;

171 8: *
›
++ = *
ªf
++;

172 7: *
›
++ = *
ªf
++;

173 6: *
›
++ = *
ªf
++;

174 5: *
›
++ = *
ªf
++;

175 4: *
›
++ = *
ªf
++;

176 3: *
›
++ = *
ªf
++;

177 2: *
›
++ = *
ªf
++;

178 1: *
›
++ = *
ªf
++;

179 0: *
›
++ = *
ªf
++;

180 *
›
++ = *
ªf
++;

185 
ù
 < 
ö_íd
);

187  
›
 - (
u8
 *)
out_d©a
;

188 
	}
}

189 #i‡
deföed
(
__GNUC__
) && __GNUC__ >= 5

190 #¥agm®
GCC
 
dügno°ic
 
p›


	@memtest.c

29 
	~<°döt.h
>

30 
	~<°dlib.h
>

31 
	~<°dio.h
>

32 
	~<°rög.h
>

33 
	~<as£π.h
>

34 
	~<limôs.h
>

35 
	~<î∫o.h
>

36 
	~<ãrmios.h
>

37 
	~<sys/io˘l.h
>

38 #i‡
deföed
(
__sun
)

39 
	~<°r›ts.h
>

41 
	~"c⁄fig.h
"

43 #i‡(
ULONG_MAX
 == 4294967295UL)

44 
	#MEMTEST_32BIT


	)

45 #ñi‡(
ULONG_MAX
 == 18446744073709551615ULL)

46 
	#MEMTEST_64BIT


	)

51 #ifde‡
MEMTEST_32BIT


52 
	#ULONG_ONEZERO
 0xØØØØUL

	)

53 
	#ULONG_ZEROONE
 0x55555555UL

	)

55 
	#ULONG_ONEZERO
 0xØØØØØØØØUL

	)

56 
	#ULONG_ZEROONE
 0x5555555555555555UL

	)

59 
wösize
 
	gws
;

60 
size_t
 
	g¥ogªss_¥öãd
;

61 
size_t
 
	g¥ogªss_fuŒ
;

63 
	$memã°_¥ogªss_°¨t
(*
tôÀ
, 
∑ss
) {

64 
j
;

66 
	`¥ötf
("\x1b[H\x1b[2J");

68 
j
 = 0; j < 
ws
.
ws_cﬁ
*(ws.
ws_row
-2); j++Ë
	`¥ötf
(".");

69 
	`¥ötf
("Please keepÅheÅestÑunning several minutesÖer GB of memory.\n");

70 
	`¥ötf
("Also check http://www.memtest86.com/ánd http://pyropus.ca/software/memtester/");

71 
	`¥ötf
("\x1b[H\x1b[2K");

72 
	`¥ötf
("%†[%d]\n", 
tôÀ
, 
∑ss
);

73 
¥ogªss_¥öãd
 = 0;

74 
¥ogªss_fuŒ
 = 
ws
.
ws_cﬁ
*(ws.
ws_row
-3);

75 
	`fÊush
(
°dout
);

76 
	}
}

78 
	$memã°_¥ogªss_íd
() {

79 
	`¥ötf
("\x1b[H\x1b[2J");

80 
	}
}

82 
	$memã°_¥ogªss_°ï
(
size_t
 
cuº
, size_à
size
, 
c
) {

83 
size_t
 
ch¨s
 = (()
cuº
*
¥ogªss_fuŒ
)/
size
, 
j
;

85 
j
 = 0; j < 
ch¨s
-
¥ogªss_¥öãd
; j++Ë
	`¥ötf
("%c",
c
);

86 
¥ogªss_¥öãd
 = 
ch¨s
;

87 
	`fÊush
(
°dout
);

88 
	}
}

93 
	$memã°_addªssög
(*
l
, 
size_t
 
byãs
, 
öãø˘ive
) {

94 
w‹ds
 = 
byãs
/();

95 
j
, *
p
;

98 
p
 = 
l
;

99 
j
 = 0; j < 
w‹ds
; j++) {

100 *
p
 = ()p;

101 
p
++;

102 i‡((
j
 & 0xffffË=0 && 
öãø˘ive
)

103 
	`memã°_¥ogªss_°ï
(
j
,
w‹ds
*2,'A');

106 
p
 = 
l
;

107 
j
 = 0; j < 
w‹ds
; j++) {

108 i‡(*
p
 != ()p) {

109 i‡(
öãø˘ive
) {

110 
	`¥ötf
("\n*** MEMORY ADDRESSING ERROR: %p contains %lu\n",

111 (*Ë
p
, *p);

112 
	`exô
(1);

116 
p
++;

117 i‡((
j
 & 0xffffË=0 && 
öãø˘ive
)

118 
	`memã°_¥ogªss_°ï
(
j
+
w‹ds
,words*2,'A');

121 
	}
}

131 
	#x‹shi·64°¨_√xt
() do { \

132 
r£ed
 ^=Ñseed >> 12; \

133 
r£ed
 ^=Ñseed << 25; \

134 
r£ed
 ^=Ñseed >> 27; \

135 
rout
 = 
r£ed
 * 
	`UINT64_C
(2685821657736338717); \

136 } 0)

	)

138 
	$memã°_fûl_øndom
(*
l
, 
size_t
 
byãs
, 
öãø˘ive
) {

139 
°ï
 = 4096/();

140 
w‹ds
 = 
byãs
/()/2;

141 
iw‹ds
 = 
w‹ds
/
°ï
;

142 
off
, 
w
, *
l1
, *
l2
;

143 
uöt64_t
 
r£ed
 = 
	`UINT64_C
(0xd13133de9afdb566);

144 
uöt64_t
 
rout
 = 0;

146 
	`as£π
((
byãs
 & 4095) == 0);

147 
off
 = 0; of‡< 
°ï
; off++) {

148 
l1
 = 
l
+
off
;

149 
l2
 = 
l1
+
w‹ds
;

150 
w
 = 0; w < 
iw‹ds
; w++) {

151 
	`x‹shi·64°¨_√xt
();

152 *
l1
 = *
l2
 = (Ë
rout
;

153 
l1
 +
°ï
;

154 
l2
 +
°ï
;

155 i‡((
w
 & 0xffffË=0 && 
öãø˘ive
)

156 
	`memã°_¥ogªss_°ï
(
w
+
iw‹ds
*
off
,
w‹ds
,'R');

159 
	}
}

163 
	$memã°_fûl_vÆue
(*
l
, 
size_t
 
byãs
, 
v1
,

164 
v2
, 
sym
, 
öãø˘ive
)

166 
°ï
 = 4096/();

167 
w‹ds
 = 
byãs
/()/2;

168 
iw‹ds
 = 
w‹ds
/
°ï
;

169 
off
, 
w
, *
l1
, *
l2
, 
v
;

171 
	`as£π
((
byãs
 & 4095) == 0);

172 
off
 = 0; of‡< 
°ï
; off++) {

173 
l1
 = 
l
+
off
;

174 
l2
 = 
l1
+
w‹ds
;

175 
v
 = (
off
 & 1Ë? 
v2
 : 
v1
;

176 
w
 = 0; w < 
iw‹ds
; w++) {

177 #ifde‡
MEMTEST_32BIT


178 *
l1
 = *
l2
 = ((Ë
v
) |

179 (((Ë
v
) << 16);

181 *
l1
 = *
l2
 = ((Ë
v
) |

182 (((Ë
v
) << 16) |

183 (((Ë
v
) << 32) |

184 (((Ë
v
) << 48);

186 
l1
 +
°ï
;

187 
l2
 +
°ï
;

188 i‡((
w
 & 0xffffË=0 && 
öãø˘ive
)

189 
	`memã°_¥ogªss_°ï
(
w
+
iw‹ds
*
off
,
w‹ds
,
sym
);

192 
	}
}

194 
	$memã°_com∑ª
(*
l
, 
size_t
 
byãs
, 
öãø˘ive
) {

195 
w‹ds
 = 
byãs
/()/2;

196 
w
, *
l1
, *
l2
;

198 
	`as£π
((
byãs
 & 4095) == 0);

199 
l1
 = 
l
;

200 
l2
 = 
l1
+
w‹ds
;

201 
w
 = 0; w < 
w‹ds
; w++) {

202 i‡(*
l1
 !*
l2
) {

203 i‡(
öãø˘ive
) {

204 
	`¥ötf
("\n*** MEMORY ERROR DETECTED: %p != %p (%lu vs %lu)\n",

205 (*)
l1
, (*)
l2
, *l1, *l2);

206 
	`exô
(1);

210 
l1
 ++;

211 
l2
 ++;

212 i‡((
w
 & 0xffffË=0 && 
öãø˘ive
)

213 
	`memã°_¥ogªss_°ï
(
w
,
w‹ds
,'=');

216 
	}
}

218 
	$memã°_com∑ª_times
(*
m
, 
size_t
 
byãs
, 
∑ss
, 
times
,

219 
öãø˘ive
)

221 
j
;

222 
îr‹s
 = 0;

224 
j
 = 0; j < 
times
; j++) {

225 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_°¨t
("Com∑ª",
∑ss
);

226 
îr‹s
 +
	`memã°_com∑ª
(
m
,
byãs
,
öãø˘ive
);

227 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_íd
();

229  
îr‹s
;

230 
	}
}

237 
	$memã°_ã°
(*
m
, 
size_t
 
byãs
, 
∑s£s
, 
öãø˘ive
) {

238 
∑ss
 = 0;

239 
îr‹s
 = 0;

241 
∑ss
 !
∑s£s
) {

242 
∑ss
++;

244 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_°¨t
("AddªssögÅe°",
∑ss
);

245 
îr‹s
 +
	`memã°_addªssög
(
m
,
byãs
,
öãø˘ive
);

246 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_íd
();

248 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_°¨t
("R™dom fûl",
∑ss
);

249 
	`memã°_fûl_øndom
(
m
,
byãs
,
öãø˘ive
);

250 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_íd
();

251 
îr‹s
 +
	`memã°_com∑ª_times
(
m
,
byãs
,
∑ss
,4,
öãø˘ive
);

253 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_°¨t
("Sﬁid fûl",
∑ss
);

254 
	`memã°_fûl_vÆue
(
m
,
byãs
,0,()-1,'S',
öãø˘ive
);

255 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_íd
();

256 
îr‹s
 +
	`memã°_com∑ª_times
(
m
,
byãs
,
∑ss
,4,
öãø˘ive
);

258 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_°¨t
("Checkîbﬂrd fûl",
∑ss
);

259 
	`memã°_fûl_vÆue
(
m
,
byãs
,
ULONG_ONEZERO
,
ULONG_ZEROONE
,'C',
öãø˘ive
);

260 i‡(
öãø˘ive
Ë
	`memã°_¥ogªss_íd
();

261 
îr‹s
 +
	`memã°_com∑ª_times
(
m
,
byãs
,
∑ss
,4,
öãø˘ive
);

263  
îr‹s
;

264 
	}
}

275 
	#MEMTEST_BACKUP_WORDS
 (1024*(1024/()))

	)

279 
	#MEMTEST_DECACHE_SIZE
 (1024*8)

	)

280 
	$memã°_¥e£rvög_ã°
(*
m
, 
size_t
 
byãs
, 
∑s£s
) {

281 
backup
[
MEMTEST_BACKUP_WORDS
];

282 *
p
 = 
m
;

283 *
íd
 = (*Ë(((*)
m
)+(
byãs
-
MEMTEST_DECACHE_SIZE
));

284 
size_t
 
À·
 = 
byãs
;

285 
îr‹s
 = 0;

287 i‡(
byãs
 & 4095)  0;

288 i‡(
byãs
 < 4096*2)  0;

290 
À·
) {

294 i‡(
À·
 == 4096) {

295 
À·
 += 4096;

296 
p
 -= 4096/();

299 
∑ss
 = 0;

300 
size_t
 
Àn
 = (
À·
 > (
backup
)) ? (backup) :Üeft;

303 i‡(
Àn
/4096 % 2)Üen -= 4096;

305 
	`mem˝y
(
backup
,
p
,
Àn
);

306 
∑ss
 !
∑s£s
) {

307 
∑ss
++;

308 
îr‹s
 +
	`memã°_addªssög
(
p
,
Àn
,0);

309 
	`memã°_fûl_øndom
(
p
,
Àn
,0);

310 i‡(
byãs
 >
MEMTEST_DECACHE_SIZE
) {

311 
	`memã°_com∑ª_times
(
m
,
MEMTEST_DECACHE_SIZE
,
∑ss
,1,0);

312 
	`memã°_com∑ª_times
(
íd
,
MEMTEST_DECACHE_SIZE
,
∑ss
,1,0);

314 
îr‹s
 +
	`memã°_com∑ª_times
(
p
,
Àn
,
∑ss
,4,0);

315 
	`memã°_fûl_vÆue
(
p
,
Àn
,0,()-1,'S',0);

316 i‡(
byãs
 >
MEMTEST_DECACHE_SIZE
) {

317 
	`memã°_com∑ª_times
(
m
,
MEMTEST_DECACHE_SIZE
,
∑ss
,1,0);

318 
	`memã°_com∑ª_times
(
íd
,
MEMTEST_DECACHE_SIZE
,
∑ss
,1,0);

320 
îr‹s
 +
	`memã°_com∑ª_times
(
p
,
Àn
,
∑ss
,4,0);

321 
	`memã°_fûl_vÆue
(
p
,
Àn
,
ULONG_ONEZERO
,
ULONG_ZEROONE
,'C',0);

322 i‡(
byãs
 >
MEMTEST_DECACHE_SIZE
) {

323 
	`memã°_com∑ª_times
(
m
,
MEMTEST_DECACHE_SIZE
,
∑ss
,1,0);

324 
	`memã°_com∑ª_times
(
íd
,
MEMTEST_DECACHE_SIZE
,
∑ss
,1,0);

326 
îr‹s
 +
	`memã°_com∑ª_times
(
p
,
Àn
,
∑ss
,4,0);

328 
	`mem˝y
(
p
,
backup
,
Àn
);

329 
À·
 -
Àn
;

330 
p
 +
Àn
/();

332  
îr‹s
;

333 
	}
}

336 
	$memã°_Æloc_™d_ã°
(
size_t
 
megabyãs
, 
∑s£s
) {

337 
size_t
 
byãs
 = 
megabyãs
*1024*1024;

338 *
m
 = 
	`mÆloc
(
byãs
);

340 i‡(
m
 =
NULL
) {

341 
	`Ârötf
(
°dîr
,"UnableÅoállocate %zu megabytes: %s",

342 
megabyãs
, 
	`°ªº‹
(
î∫o
));

343 
	`exô
(1);

345 
	`memã°_ã°
(
m
,
byãs
,
∑s£s
,1);

346 
	`‰ì
(
m
);

347 
	}
}

349 
	$memã°
(
size_t
 
megabyãs
, 
∑s£s
) {

350 i‡(
	`io˘l
(1, 
TIOCGWINSZ
, &
ws
) == -1) {

351 
ws
.
ws_cﬁ
 = 80;

352 
ws
.
ws_row
 = 20;

354 
	`memã°_Æloc_™d_ã°
(
megabyãs
,
∑s£s
);

355 
	`¥ötf
("\nYour memoryÖassedÅhisÅest.\n");

356 
	`¥ötf
("Please if youáre still in doubt useÅhe followingÅwoÅools:\n");

357 
	`¥ötf
("1) memtest86: http://www.memtest86.com/\n");

358 
	`¥ötf
("2) memtester: http://pyropus.ca/software/memtester/\n");

359 
	`exô
(0);

360 
	}
}

	@module.c

30 
	~"£rvî.h
"

31 
	~"˛u°î.h
"

32 
	~"rdb.h
"

33 
	~<dlf˙.h
>

34 
	~<sys/°©.h
>

35 
	~<sys/waô.h
>

43 
	sRedisModuÀInfoCtx
 {

44 
RedisModuÀ
 *
	mmoduÀ
;

45 c⁄° *
	mªque°ed_£˘i⁄
;

46 
sds
 
	möfo
;

47 
	m£˘i⁄s
;

48 
	mö_£˘i⁄
;

49 
	mö_di˘_fõld
;

50 } 
	tRedisModuÀInfoCtx
;

52 (*
	tRedisModuÀInfoFunc
)(
	tRedisModuÀInfoCtx
 *
	t˘x
, 
	tf‹_¸ash_ªp‹t
);

55 
	sRedisModuÀ
 {

56 *
h™dÀ
;

57 *
«me
;

58 
vî
;

59 
≠ivî
;

60 
li°
 *
ty≥s
;

61 
li°
 *
u£dby
;

62 
li°
 *
usög
;

63 
li°
 *
fûãrs
;

64 
ö_ˇŒ
;

65 
ö_hook
;

66 
›ti⁄s
;

67 
blocked_˛õ¡s
;

68 
RedisModuÀInfoFunc
 
öfo_cb
;

70 
RedisModuÀ
 
	tRedisModuÀ
;

76 
	sRedisModuÀSh¨edAPI
 {

77 *
func
;

78 
RedisModuÀ
 *
moduÀ
;

80 
RedisModuÀSh¨edAPI
 
	tRedisModuÀSh¨edAPI
;

82 
di˘
 *
moduÀs
;

86 
	sAutoMemE¡ry
 {

87 *
±r
;

88 
ty≥
;

92 
	#REDISMODULE_AM_KEY
 0

	)

93 
	#REDISMODULE_AM_STRING
 1

	)

94 
	#REDISMODULE_AM_REPLY
 2

	)

95 
	#REDISMODULE_AM_FREED
 3

	)

96 
	#REDISMODULE_AM_DICT
 4

	)

97 
	#REDISMODULE_AM_INFO
 5

	)

112 
	#REDISMODULE_POOL_ALLOC_MIN_SIZE
 (1024*8)

	)

113 
	#REDISMODULE_POOL_ALLOC_ALIGN
 ((*))

	)

115 
	sRedisModuÀPoﬁAŒocBlock
 {

116 
uöt32_t
 
size
;

117 
uöt32_t
 
u£d
;

118 
RedisModuÀPoﬁAŒocBlock
 *
√xt
;

119 
mem‹y
[];

120 } 
	tRedisModuÀPoﬁAŒocBlock
;

130 
RedisModuÀBlockedClõ¡
;

132 
	sRedisModuÀCtx
 {

133 *
gë≠ifun˝å
;

134 
RedisModuÀ
 *
moduÀ
;

135 
˛õ¡
 *client;

136 
RedisModuÀBlockedClõ¡
 *
blocked_˛õ¡
;

138 
AutoMemE¡ry
 *
amqueue
;

139 
amqueue_Àn
;

140 
amqueue_u£d
;

141 
Êags
;

142 **
po°p⁄ed_¨øys
;

143 
po°p⁄ed_¨øys_cou¡
;

144 *
blocked_¥ivd©a
;

145 
RedisModuÀSåög
 *
blocked_ªady_key
;

150 *
keys_pos
;

151 
keys_cou¡
;

153 
RedisModuÀPoﬁAŒocBlock
 *
∑_hód
;

154 
ªdisOpAºay
 
ßved_›¨øy
;

159 
RedisModuÀCtx
 
	tRedisModuÀCtx
;

161 
	#REDISMODULE_CTX_INIT
 {(*)()&
RM_GëApi
, 
NULL
, NULL, NULL, NULL, 0, 0, 0, NULL, 0, NULL, NULL, NULL, 0, NULL, {0}
	}

	)
}

162 
	#REDISMODULE_CTX_MULTI_EMITTED
 (1<<0)

	)

163 
	#REDISMODULE_CTX_AUTO_MEMORY
 (1<<1)

	)

164 
	#REDISMODULE_CTX_KEYS_POS_REQUEST
 (1<<2)

	)

165 
	#REDISMODULE_CTX_BLOCKED_REPLY
 (1<<3)

	)

166 
	#REDISMODULE_CTX_BLOCKED_TIMEOUT
 (1<<4)

	)

167 
	#REDISMODULE_CTX_THREAD_SAFE
 (1<<5)

	)

168 
	#REDISMODULE_CTX_BLOCKED_DISCONNECTED
 (1<<6)

	)

169 
	#REDISMODULE_CTX_MODULE_COMMAND_CALL
 (1<<7)

	)

172 
	sRedisModuÀKey
 {

173 
RedisModuÀCtx
 *
	m˘x
;

174 
ªdisDb
 *
	mdb
;

175 
robj
 *
	mkey
;

176 
robj
 *
	mvÆue
;

177 *
	môî
;

178 
	mmode
;

181 
uöt32_t
 
	mzty≥
;

182 
zønge•ec
 
	mzrs
;

183 
zÀxønge•ec
 
	mzÃs
;

184 
uöt32_t
 
	mz°¨t
;

185 
uöt32_t
 
	mzíd
;

186 *
	mzcuºít
;

187 
	mzî
;

190 
RedisModuÀKey
 
	tRedisModuÀKey
;

193 
	#REDISMODULE_ZSET_RANGE_NONE
 0

	)

194 
	#REDISMODULE_ZSET_RANGE_LEX
 1

	)

195 
	#REDISMODULE_ZSET_RANGE_SCORE
 2

	)

196 
	#REDISMODULE_ZSET_RANGE_POS
 3

	)

200 
	gRedisModuÀBlockedClõ¡
;

201 (*
	tRedisModuÀCmdFunc
Ë(
	tRedisModuÀCtx
 *
	t˘x
, **
	t¨gv
, 
	t¨gc
);

202 (*
	tRedisModuÀDisc⁄√˘Func
Ë(
	tRedisModuÀCtx
 *
	t˘x
, 
	tRedisModuÀBlockedClõ¡
 *
	tbc
);

205 
	sRedisModuÀComm™dProxy
 {

206 
RedisModuÀ
 *
moduÀ
;

207 
RedisModuÀCmdFunc
 
func
;

208 
ªdisComm™d
 *
ªdiscmd
;

210 
RedisModuÀComm™dProxy
 
	tRedisModuÀComm™dProxy
;

212 
	#REDISMODULE_REPLYFLAG_NONE
 0

	)

213 
	#REDISMODULE_REPLYFLAG_TOPARSE
 (1<<0Ë

	)

214 
	#REDISMODULE_REPLYFLAG_NESTED
 (1<<1Ë

	)

220 
	sRedisModuÀCÆlRïly
 {

221 
RedisModuÀCtx
 *
˘x
;

222 
ty≥
;

223 
Êags
;

224 
size_t
 
Àn
;

225 *
¥Ÿo
;

226 
size_t
 
¥Ÿﬁí
;

228 c⁄° *
°r
;

232 
Œ
;

233 
RedisModuÀCÆlRïly
 *
¨øy
;

234 } 
vÆ
;

235 } 
	tRedisModuÀCÆlRïly
;

239 
	sRedisModuÀBlockedClõ¡
 {

240 
˛õ¡
 *client;

242 
RedisModuÀ
 *
moduÀ
;

243 
RedisModuÀCmdFunc
 
ª∂y_ˇŒback
;

244 
RedisModuÀCmdFunc
 
timeout_ˇŒback
;

245 
RedisModuÀDisc⁄√˘Func
 
disc⁄√˘_ˇŒback
;

246 (*
‰ì_¥ivd©a
)(
RedisModuÀCtx
*,*);

247 *
¥ivd©a
;

250 
˛õ¡
 *
ª∂y_˛õ¡
;

252 
dbid
;

253 
blocked_⁄_keys
;

254 
unblocked
;

255 } 
	tRedisModuÀBlockedClõ¡
;

257 
±hªad_muãx_t
 
moduÀUnblockedClõ¡sMuãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

258 
li°
 *
moduÀUnblockedClõ¡s
;

262 
±hªad_muãx_t
 
moduÀGIL
 = 
PTHREAD_MUTEX_INITIALIZER
;

266 (*
	tRedisModuÀNŸifiˇti⁄Func
Ë(
	tRedisModuÀCtx
 *
	t˘x
, 
	tty≥
, c⁄° *
	tevít
, 
	tRedisModuÀSåög
 *
	tkey
);

270 
	sRedisModuÀKey•a˚Subs¸ibî
 {

272 
RedisModuÀ
 *
moduÀ
;

274 
RedisModuÀNŸifiˇti⁄Func
 
nŸify_ˇŒback
;

276 
evít_mask
;

279 
a˘ive
;

280 } 
	tRedisModuÀKey•a˚Subs¸ibî
;

283 
li°
 *
moduÀKey•a˚Subs¸ibîs
;

289 
˛õ¡
 *
moduÀFªeC⁄ãxtReu£dClõ¡
;

292 
	sRedisModuÀDi˘
 {

293 
øx
 *rax;

294 } 
	tRedisModuÀDi˘
;

296 
	sRedisModuÀDi˘Iãr
 {

297 
RedisModuÀDi˘
 *
di˘
;

298 
øxIãøt‹
 
ri
;

299 } 
	tRedisModuÀDi˘Iãr
;

301 
	sRedisModuÀComm™dFûãrCtx
 {

302 
RedisModuÀSåög
 **
¨gv
;

303 
¨gc
;

304 } 
	tRedisModuÀComm™dFûãrCtx
;

306 (*
	tRedisModuÀComm™dFûãrFunc
Ë(
	tRedisModuÀComm™dFûãrCtx
 *
	tfûãr
);

308 
	sRedisModuÀComm™dFûãr
 {

310 
RedisModuÀ
 *
moduÀ
;

312 
RedisModuÀComm™dFûãrFunc
 
ˇŒback
;

314 
Êags
;

315 } 
	tRedisModuÀComm™dFûãr
;

318 
li°
 *
moduÀComm™dFûãrs
;

320 (*
	tRedisModuÀF‹kD⁄eH™dÀr
Ë(
	texôcode
, 
	tbysig«l
, *
	tu£r_d©a
);

322 
	sRedisModuÀF‹kInfo
 {

323 
RedisModuÀF‹kD⁄eH™dÀr
 
d⁄e_h™dÀr
;

324 * 
d⁄e_h™dÀr_u£r_d©a
;

325 } 
moduÀF‹kInfo
 = {0
	}
};

327 
	sRedisModuÀSîvîInfoD©a
 {

328 
øx
 *
	møx
;

329 } 
	tRedisModuÀSîvîInfoD©a
;

332 
	#REDISMODULE_ARGV_REPLICATE
 (1<<0)

	)

333 
	#REDISMODULE_ARGV_NO_AOF
 (1<<1)

	)

334 
	#REDISMODULE_ARGV_NO_REPLICAS
 (1<<2)

	)

340 
	#SHOULD_SIGNAL_MODIFIED_KEYS
(
˘x
) \

341 
˘x
->
moduÀ
? !(˘x->moduÀ->
›ti⁄s
 & 
REDISMODULE_OPTION_NO_IMPLICIT_SIGNAL_MODIFIED
Ë: 1

	)

348 
	sRedisModuÀEvítLi°íî
 {

349 
RedisModuÀ
 *
	mmoduÀ
;

350 
RedisModuÀEvít
 
	mevít
;

351 
RedisModuÀEvítCÆlback
 
	mˇŒback
;

352 } 
	tRedisModuÀEvítLi°íî
;

354 
li°
 *
	gRedisModuÀ_EvítLi°íîs
;

355 
	gModuÀsInHooks
 = 0;

363 (*
	tRedisModuÀU£rCh™gedFunc
Ë(
	tuöt64_t
 
	t˛õ¡_id
, *
	t¥ivd©a
);

368 
	sRedisModuÀU£r
 {

369 
u£r
 *user;

370 } 
	tRedisModuÀU£r
;

377 
	`RM_FªeCÆlRïly
(
RedisModuÀCÆlRïly
 *
ª∂y
);

378 
	`RM_Clo£Key
(
RedisModuÀKey
 *
key
);

379 
	`autoMem‹yCﬁÀ˘
(
RedisModuÀCtx
 *
˘x
);

380 
robj
 **
	`moduÀCª©eArgvFromU£rF‹m©
(c⁄° *
cmd«me
, c⁄° *
fmt
, *
¨g˝
, *
Êags
, 
va_li°
 
≠
);

381 
	`moduÀRïliˇãMu…iIfNìded
(
RedisModuÀCtx
 *
˘x
);

382 
	`RM_Z£tR™geSt›
(
RedisModuÀKey
 *
kp
);

383 
	`z£tKeyRe£t
(
RedisModuÀKey
 *
key
);

384 
	`RM_FªeDi˘
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀDi˘
 *
d
);

385 
	`RM_FªeSîvîInfo
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSîvîInfoD©a
 *
d©a
);

395 *
	$RM_AŒoc
(
size_t
 
byãs
) {

396  
	`zmÆloc
(
byãs
);

397 
	}
}

403 *
	$RM_CÆloc
(
size_t
 
nmemb
, size_à
size
) {

404  
	`zˇŒoc
(
nmemb
*
size
);

405 
	}
}

408 * 
	$RM_RóŒoc
(*
±r
, 
size_t
 
byãs
) {

409  
	`zªÆloc
(
±r
,
byãs
);

410 
	}
}

415 
	$RM_Fªe
(*
±r
) {

416 
	`z‰ì
(
±r
);

417 
	}
}

420 *
	$RM_Sådup
(c⁄° *
°r
) {

421  
	`z°rdup
(
°r
);

422 
	}
}

429 
	$poﬁAŒocRñó£
(
RedisModuÀCtx
 *
˘x
) {

430 
RedisModuÀPoﬁAŒocBlock
 *
hód
 = 
˘x
->
∑_hód
, *
√xt
;

432 
hód
 !
NULL
) {

433 
√xt
 = 
hód
->next;

434 
	`z‰ì
(
hód
);

435 
hód
 = 
√xt
;

437 
˘x
->
∑_hód
 = 
NULL
;

438 
	}
}

452 *
	$RM_PoﬁAŒoc
(
RedisModuÀCtx
 *
˘x
, 
size_t
 
byãs
) {

453 i‡(
byãs
 =0Ë 
NULL
;

454 
RedisModuÀPoﬁAŒocBlock
 *
b
 = 
˘x
->
∑_hód
;

455 
size_t
 
À·
 = 
b
 ? b->
size
 - b->
u£d
 : 0;

458 i‡(
À·
 >
byãs
) {

459 
size_t
 
Æignmít
 = 
REDISMODULE_POOL_ALLOC_ALIGN
;

460 
byãs
 < 
Æignmít
 &&álignment/2 >= bytes)álignment /= 2;

461 i‡(
b
->
u£d
 % 
Æignmít
)

462 
b
->
u£d
 +
Æignmít
 - (b->used %álignment);

463 
À·
 = (
b
->
u£d
 > b->
size
) ? 0 : b->size - b->used;

467 i‡(
À·
 < 
byãs
) {

468 
size_t
 
blocksize
 = 
REDISMODULE_POOL_ALLOC_MIN_SIZE
;

469 i‡(
blocksize
 < 
byãs
) blocksize = bytes;

470 
b
 = 
	`zmÆloc
((*bË+ 
blocksize
);

471 
b
->
size
 = 
blocksize
;

472 
b
->
u£d
 = 0;

473 
b
->
√xt
 = 
˘x
->
∑_hód
;

474 
˘x
->
∑_hód
 = 
b
;

477 *
ªtvÆ
 = 
b
->
mem‹y
 + b->
u£d
;

478 
b
->
u£d
 +
byãs
;

479  
ªtvÆ
;

480 
	}
}

498 
	$moduÀCª©eEm±yKey
(
RedisModuÀKey
 *
key
, 
ty≥
) {

499 
robj
 *
obj
;

502 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
Ë|| key->
vÆue
)

503  
REDISMODULE_ERR
;

505 
ty≥
) {

506 
REDISMODULE_KEYTYPE_LIST
:

507 
obj
 = 
	`¸óãQuickli°Obje˘
();

508 
	`quickli°SëO±i⁄s
(
obj
->
±r
, 
£rvî
.
li°_max_zùli°_size
,

509 
£rvî
.
li°_com¥ess_dïth
);

511 
REDISMODULE_KEYTYPE_ZSET
:

512 
obj
 = 
	`¸óãZ£tZùli°Obje˘
();

514 
REDISMODULE_KEYTYPE_HASH
:

515 
obj
 = 
	`¸óãHashObje˘
();

517 :  
REDISMODULE_ERR
;

519 
	`dbAdd
(
key
->
db
,key->key,
obj
);

520 
key
->
vÆue
 = 
obj
;

521  
REDISMODULE_OK
;

522 
	}
}

534 
	$moduÀDñKeyIfEm±y
(
RedisModuÀKey
 *
key
) {

535 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
Ë|| key->
vÆue
 =
NULL
)  0;

536 
i£m±y
;

537 
robj
 *
o
 = 
key
->
vÆue
;

539 
o
->
ty≥
) {

540 
OBJ_LIST
: 
i£m±y
 = 
	`li°Ty≥Lígth
(
o
) == 0; ;

541 
OBJ_SET
: 
i£m±y
 = 
	`£tTy≥Size
(
o
) == 0; ;

542 
OBJ_ZSET
: 
i£m±y
 = 
	`z£tLígth
(
o
) == 0; ;

543 
OBJ_HASH
: 
i£m±y
 = 
	`hashTy≥Lígth
(
o
) == 0; ;

544 
OBJ_STREAM
: 
i£m±y
 = 
	`°ªamLígth
(
o
) == 0; ;

545 : 
i£m±y
 = 0;

548 i‡(
i£m±y
) {

549 
	`dbDñëe
(
key
->
db
,key->key);

550 
key
->
vÆue
 = 
NULL
;

555 
	}
}

573 
	$RM_GëApi
(c⁄° *
fun˙ame
, **
èrgëPåPå
) {

574 
di˘E¡ry
 *
he
 = 
	`di˘Föd
(
£rvî
.
moduÀ≠i
, 
fun˙ame
);

575 i‡(!
he
Ë 
REDISMODULE_ERR
;

576 *
èrgëPåPå
 = 
	`di˘GëVÆ
(
he
);

577  
REDISMODULE_OK
;

578 
	}
}

582 
	$moduÀH™dÀPr›ag©i⁄A·îComm™dCÆlback
(
RedisModuÀCtx
 *
˘x
) {

583 
˛õ¡
 *
c
 = 
˘x
->client;

587 i‡(!(
˘x
->
Êags
 & 
REDISMODULE_CTX_MULTI_EMITTED
)) ;

589 i‡(
c
->
Êags
 & 
CLIENT_LUA
) ;

593 
	`ÆsoPr›ag©e
(
£rvî
.
execComm™d
,
c
->
db
->
id
,&
sh¨ed
.
exec
,1,

594 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

600 i‡(!(
˘x
->
Êags
 & 
REDISMODULE_CTX_MODULE_COMMAND_CALL
) &&

601 
£rvî
.
Æso_¥›ag©e
.
num›s
)

603 
j
 = 0; j < 
£rvî
.
Æso_¥›ag©e
.
num›s
; j++) {

604 
ªdisOp
 *
r›
 = &
£rvî
.
Æso_¥›ag©e
.
›s
[
j
];

605 
èrgë
 = 
r›
->target;

606 i‡(
èrgë
)

607 
	`¥›ag©e
(
r›
->
cmd
,r›->
dbid
,r›->
¨gv
,r›->
¨gc
,
èrgë
);

609 
	`ªdisOpAºayFªe
(&
£rvî
.
Æso_¥›ag©e
);

611 
£rvî
.
Æso_¥›ag©e
 = 
˘x
->
ßved_›¨øy
;

613 
	}
}

616 
	$moduÀFªeC⁄ãxt
(
RedisModuÀCtx
 *
˘x
) {

617 
	`moduÀH™dÀPr›ag©i⁄A·îComm™dCÆlback
(
˘x
);

618 
	`autoMem‹yCﬁÀ˘
(
˘x
);

619 
	`poﬁAŒocRñó£
(
˘x
);

620 i‡(
˘x
->
po°p⁄ed_¨øys
) {

621 
	`z‰ì
(
˘x
->
po°p⁄ed_¨øys
);

622 
˘x
->
po°p⁄ed_¨øys_cou¡
 = 0;

623 
	`£rvîLog
(
LL_WARNING
,

628 
˘x
->
moduÀ
->
«me
);

630 i‡(
˘x
->
Êags
 & 
REDISMODULE_CTX_THREAD_SAFE
Ë
	`‰ìClõ¡
(˘x->
˛õ¡
);

631 
	}
}

635 
	$RedisModuÀComm™dDi•©chî
(
˛õ¡
 *
c
) {

636 
RedisModuÀComm™dProxy
 *
˝
 = (*)()
c
->
cmd
->
gëkeys_¥oc
;

637 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

639 
˘x
.
Êags
 |
REDISMODULE_CTX_MODULE_COMMAND_CALL
;

640 
˘x
.
moduÀ
 = 
˝
->module;

641 
˘x
.
˛õ¡
 = 
c
;

642 
˝
->
	`func
(&
˘x
,(**)
c
->
¨gv
,c->
¨gc
);

643 
	`moduÀFªeC⁄ãxt
(&
˘x
);

654 
i
 = 0; i < 
c
->
¨gc
; i++) {

657 i‡(
c
->
¨gv
[
i
]->
ªfcou¡
 > 1)

658 
	`åimSåögObje˘IfNìded
(
c
->
¨gv
[
i
]);

660 
	}
}

671 *
	$moduÀGëComm™dKeysVüAPI
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
) {

672 
RedisModuÀComm™dProxy
 *
˝
 = (*)()
cmd
->
gëkeys_¥oc
;

673 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

675 
˘x
.
moduÀ
 = 
˝
->module;

676 
˘x
.
˛õ¡
 = 
NULL
;

677 
˘x
.
Êags
 |
REDISMODULE_CTX_KEYS_POS_REQUEST
;

678 
˝
->
	`func
(&
˘x
,(**)
¨gv
,
¨gc
);

679 *
ªs
 = 
˘x
.
keys_pos
;

680 i‡(
numkeys
Ë*numkey†
˘x
.
keys_cou¡
;

681 
	`moduÀFªeC⁄ãxt
(&
˘x
);

682  
ªs
;

683 
	}
}

688 
	$RM_IsKeysPosôi⁄Reque°
(
RedisModuÀCtx
 *
˘x
) {

689  (
˘x
->
Êags
 & 
REDISMODULE_CTX_KEYS_POS_REQUEST
) != 0;

690 
	}
}

706 
	$RM_KeyAtPos
(
RedisModuÀCtx
 *
˘x
, 
pos
) {

707 i‡(!(
˘x
->
Êags
 & 
REDISMODULE_CTX_KEYS_POS_REQUEST
)) ;

708 i‡(
pos
 <= 0) ;

709 
˘x
->
keys_pos
 = 
	`zªÆloc
(˘x->keys_pos,()*(˘x->
keys_cou¡
+1));

710 
˘x
->
keys_pos
[˘x->
keys_cou¡
++] = 
pos
;

711 
	}
}

717 
öt64_t
 
	$comm™dFœgsFromSåög
(*
s
) {

718 
cou¡
, 
j
;

719 
öt64_t
 
Êags
 = 0;

720 
sds
 *
tokís
 = 
	`sds•lôÀn
(
s
,
	`°æí
(s)," ",1,&
cou¡
);

721 
j
 = 0; j < 
cou¡
; j++) {

722 *
t
 = 
tokís
[
j
];

723 i‡(!
	`°rˇ£cmp
(
t
,"wrôe")Ë
Êags
 |
CMD_WRITE
;

724 i‡(!
	`°rˇ£cmp
(
t
,"ªad⁄ly")Ë
Êags
 |
CMD_READONLY
;

725 i‡(!
	`°rˇ£cmp
(
t
,"admö")Ë
Êags
 |
CMD_ADMIN
;

726 i‡(!
	`°rˇ£cmp
(
t
,"díy-oom")Ë
Êags
 |
CMD_DENYOOM
;

727 i‡(!
	`°rˇ£cmp
(
t
,"díy-s¸ùt")Ë
Êags
 |
CMD_NOSCRIPT
;

728 i‡(!
	`°rˇ£cmp
(
t
,"Ælow-lﬂdög")Ë
Êags
 |
CMD_LOADING
;

729 i‡(!
	`°rˇ£cmp
(
t
,"pubsub")Ë
Êags
 |
CMD_PUBSUB
;

730 i‡(!
	`°rˇ£cmp
(
t
,"øndom")Ë
Êags
 |
CMD_RANDOM
;

731 i‡(!
	`°rˇ£cmp
(
t
,"Ælow-°Æe")Ë
Êags
 |
CMD_STALE
;

732 i‡(!
	`°rˇ£cmp
(
t
,"no-m⁄ô‹")Ë
Êags
 |
CMD_SKIP_MONITOR
;

733 i‡(!
	`°rˇ£cmp
(
t
,"no-¶owlog")Ë
Êags
 |
CMD_SKIP_SLOWLOG
;

734 i‡(!
	`°rˇ£cmp
(
t
,"Á°")Ë
Êags
 |
CMD_FAST
;

735 i‡(!
	`°rˇ£cmp
(
t
,"no-auth")Ë
Êags
 |
CMD_NO_AUTH
;

736 i‡(!
	`°rˇ£cmp
(
t
,"gëkeys-≠i")Ë
Êags
 |
CMD_MODULE_GETKEYS
;

737 i‡(!
	`°rˇ£cmp
(
t
,"no-˛u°î")Ë
Êags
 |
CMD_MODULE_NO_CLUSTER
;

740 
	`sds‰ì•lôªs
(
tokís
,
cou¡
);

741 i‡(
j
 !
cou¡
)  -1;

742  
Êags
;

743 
	}
}

803 
	$RM_Cª©eComm™d
(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
RedisModuÀCmdFunc
 
cmdfunc
, c⁄° *
°rÊags
, 
fú°key
, 
œ°key
, 
key°ï
) {

804 
öt64_t
 
Êags
 = 
°rÊags
 ? 
	`comm™dFœgsFromSåög
((*)strflags) : 0;

805 i‡(
Êags
 =-1Ë 
REDISMODULE_ERR
;

806 i‡((
Êags
 & 
CMD_MODULE_NO_CLUSTER
Ë&& 
£rvî
.
˛u°î_íabÀd
)

807  
REDISMODULE_ERR
;

809 
ªdisComm™d
 *
ªdiscmd
;

810 
RedisModuÀComm™dProxy
 *
˝
;

811 
sds
 
cmd«me
 = 
	`sd¢ew
(
«me
);

814 i‡(
	`lookupComm™d
(
cmd«me
Ë!
NULL
) {

815 
	`sds‰ì
(
cmd«me
);

816  
REDISMODULE_ERR
;

826 
˝
 = 
	`zmÆloc
((*cp));

827 
˝
->
moduÀ
 = 
˘x
->module;

828 
˝
->
func
 = 
cmdfunc
;

829 
˝
->
ªdiscmd
 = 
	`zmÆloc
((*rediscmd));

830 
˝
->
ªdiscmd
->
«me
 = 
cmd«me
;

831 
˝
->
ªdiscmd
->
¥oc
 = 
RedisModuÀComm™dDi•©chî
;

832 
˝
->
ªdiscmd
->
¨ôy
 = -1;

833 
˝
->
ªdiscmd
->
Êags
 = fœg†| 
CMD_MODULE
;

834 
˝
->
ªdiscmd
->
gëkeys_¥oc
 = (
ªdisGëKeysProc
*)()cp;

835 
˝
->
ªdiscmd
->
fú°key
 = firstkey;

836 
˝
->
ªdiscmd
->
œ°key
 =Üastkey;

837 
˝
->
ªdiscmd
->
key°ï
 = keystep;

838 
˝
->
ªdiscmd
->
mi¸o£c⁄ds
 = 0;

839 
˝
->
ªdiscmd
->
ˇŒs
 = 0;

840 
	`di˘Add
(
£rvî
.
comm™ds
,
	`sdsdup
(
cmd«me
),
˝
->
ªdiscmd
);

841 
	`di˘Add
(
£rvî
.
‹ig_comm™ds
,
	`sdsdup
(
cmd«me
),
˝
->
ªdiscmd
);

842 
˝
->
ªdiscmd
->
id
 = 
	`ACLGëComm™dID
(
cmd«me
);

843  
REDISMODULE_OK
;

844 
	}
}

850 
	$RM_SëModuÀAâribs
(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
vî
, 
≠ivî
) {

851 
RedisModuÀ
 *
moduÀ
;

853 i‡(
˘x
->
moduÀ
 !
NULL
) ;

854 
moduÀ
 = 
	`zmÆloc
((*module));

855 
moduÀ
->
«me
 = 
	`sd¢ew
((*)name);

856 
moduÀ
->
vî
 = ver;

857 
moduÀ
->
≠ivî
 =ápiver;

858 
moduÀ
->
ty≥s
 = 
	`li°Cª©e
();

859 
moduÀ
->
u£dby
 = 
	`li°Cª©e
();

860 
moduÀ
->
usög
 = 
	`li°Cª©e
();

861 
moduÀ
->
fûãrs
 = 
	`li°Cª©e
();

862 
moduÀ
->
ö_ˇŒ
 = 0;

863 
moduÀ
->
ö_hook
 = 0;

864 
moduÀ
->
›ti⁄s
 = 0;

865 
moduÀ
->
öfo_cb
 = 0;

866 
˘x
->
moduÀ
 = module;

867 
	}
}

871 
	$RM_IsModuÀNameBusy
(c⁄° *
«me
) {

872 
sds
 
moduÀ«me
 = 
	`sd¢ew
(
«me
);

873 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
moduÀs
,
moduÀ«me
);

874 
	`sds‰ì
(
moduÀ«me
);

875  
de
 !
NULL
;

876 
	}
}

879 
	$RM_Mûli£c⁄ds
() {

880  
	`m°ime
();

881 
	}
}

892 
	$RM_SëModuÀO±i⁄s
(
RedisModuÀCtx
 *
˘x
, 
›ti⁄s
) {

893 
˘x
->
moduÀ
->
›ti⁄s
 = options;

894 
	}
}

898 
	$RM_Sig«lModifõdKey
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
key«me
) {

899 
	`sig«lModifõdKey
(
˘x
->
˛õ¡
,˘x->˛õ¡->
db
,
key«me
);

900  
REDISMODULE_OK
;

901 
	}
}

911 
	$RM_AutoMem‹y
(
RedisModuÀCtx
 *
˘x
) {

912 
˘x
->
Êags
 |
REDISMODULE_CTX_AUTO_MEMORY
;

913 
	}
}

916 
	$autoMem‹yAdd
(
RedisModuÀCtx
 *
˘x
, 
ty≥
, *
±r
) {

917 i‡(!(
˘x
->
Êags
 & 
REDISMODULE_CTX_AUTO_MEMORY
)) ;

918 i‡(
˘x
->
amqueue_u£d
 =˘x->
amqueue_Àn
) {

919 
˘x
->
amqueue_Àn
 *= 2;

920 i‡(
˘x
->
amqueue_Àn
 < 16) ctx->amqueue_len = 16;

921 
˘x
->
amqueue
 = 
	`zªÆloc
(˘x->amqueue,(
AutoMemE¡ry
)*˘x->
amqueue_Àn
);

923 
˘x
->
amqueue
[˘x->
amqueue_u£d
].
ty≥
 =Åype;

924 
˘x
->
amqueue
[˘x->
amqueue_u£d
].
±r
 =Ötr;

925 
˘x
->
amqueue_u£d
++;

926 
	}
}

933 
	$autoMem‹yFªed
(
RedisModuÀCtx
 *
˘x
, 
ty≥
, *
±r
) {

934 i‡(!(
˘x
->
Êags
 & 
REDISMODULE_CTX_AUTO_MEMORY
))  0;

936 
cou¡
 = (
˘x
->
amqueue_u£d
+1)/2;

937 
j
 = 0; j < 
cou¡
; j++) {

938 
side
 = 0; side < 2; side++) {

941 
i
 = (
side
 =0Ë? (
˘x
->
amqueue_u£d
 - 1 - 
j
) : j;

942 i‡(
˘x
->
amqueue
[
i
].
ty≥
 ==Åype &&

943 
˘x
->
amqueue
[
i
].
±r
 ==Ötr)

945 
˘x
->
amqueue
[
i
].
ty≥
 = 
REDISMODULE_AM_FREED
;

949 i‡(
i
 !
˘x
->
amqueue_u£d
-1) {

950 
˘x
->
amqueue
[
i
] = ctx->amqueue[˘x->
amqueue_u£d
-1];

955 
˘x
->
amqueue_u£d
--;

961 
	}
}

964 
	$autoMem‹yCﬁÀ˘
(
RedisModuÀCtx
 *
˘x
) {

965 i‡(!(
˘x
->
Êags
 & 
REDISMODULE_CTX_AUTO_MEMORY
)) ;

969 
˘x
->
Êags
 &~
REDISMODULE_CTX_AUTO_MEMORY
;

970 
j
;

971 
j
 = 0; j < 
˘x
->
amqueue_u£d
; j++) {

972 *
±r
 = 
˘x
->
amqueue
[
j
].ptr;

973 
˘x
->
amqueue
[
j
].
ty≥
) {

974 
REDISMODULE_AM_STRING
: 
	`de¸RefCou¡
(
±r
); ;

975 
REDISMODULE_AM_REPLY
: 
	`RM_FªeCÆlRïly
(
±r
); ;

976 
REDISMODULE_AM_KEY
: 
	`RM_Clo£Key
(
±r
); ;

977 
REDISMODULE_AM_DICT
: 
	`RM_FªeDi˘
(
NULL
,
±r
); ;

978 
REDISMODULE_AM_INFO
: 
	`RM_FªeSîvîInfo
(
NULL
,
±r
); ;

981 
˘x
->
Êags
 |
REDISMODULE_CTX_AUTO_MEMORY
;

982 
	`z‰ì
(
˘x
->
amqueue
);

983 
˘x
->
amqueue
 = 
NULL
;

984 
˘x
->
amqueue_Àn
 = 0;

985 
˘x
->
amqueue_u£d
 = 0;

986 
	}
}

1002 
RedisModuÀSåög
 *
	$RM_Cª©eSåög
(
RedisModuÀCtx
 *
˘x
, c⁄° *
±r
, 
size_t
 
Àn
) {

1003 
RedisModuÀSåög
 *
o
 = 
	`¸óãSåögObje˘
(
±r
,
Àn
);

1004 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yAdd
(˘x,
REDISMODULE_AM_STRING
,
o
);

1005  
o
;

1006 
	}
}

1016 
RedisModuÀSåög
 *
	$RM_Cª©eSåögPrötf
(
RedisModuÀCtx
 *
˘x
, c⁄° *
fmt
, ...) {

1017 
sds
 
s
 = 
	`sd£m±y
();

1019 
va_li°
 
≠
;

1020 
	`va_°¨t
(
≠
, 
fmt
);

1021 
s
 = 
	`sdsˇtv¥ötf
(s, 
fmt
, 
≠
);

1022 
	`va_íd
(
≠
);

1024 
RedisModuÀSåög
 *
o
 = 
	`¸óãObje˘
(
OBJ_STRING
, 
s
);

1025 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yAdd
(˘x,
REDISMODULE_AM_STRING
,
o
);

1027  
o
;

1028 
	}
}

1039 
RedisModuÀSåög
 *
	$RM_Cª©eSåögFromL⁄gL⁄g
(
RedisModuÀCtx
 *
˘x
, 
Œ
) {

1040 
buf
[
LONG_STR_SIZE
];

1041 
size_t
 
Àn
 = 
	`Œ2°rög
(
buf
,(buf),
Œ
);

1042  
	`RM_Cª©eSåög
(
˘x
,
buf
,
Àn
);

1043 
	}
}

1050 
RedisModuÀSåög
 *
	$RM_Cª©eSåögFromDoubÀ
(
RedisModuÀCtx
 *
˘x
, 
d
) {

1051 
buf
[128];

1052 
size_t
 
Àn
 = 
	`d2°rög
(
buf
,(buf),
d
);

1053  
	`RM_Cª©eSåög
(
˘x
,
buf
,
Àn
);

1054 
	}
}

1064 
RedisModuÀSåög
 *
	$RM_Cª©eSåögFromL⁄gDoubÀ
(
RedisModuÀCtx
 *
˘x
, 
ld
, 
hum™‰õndly
) {

1065 
buf
[
MAX_LONG_DOUBLE_CHARS
];

1066 
size_t
 
Àn
 = 
	`ld2°rög
(
buf
,(buf),
ld
,

1067 (
hum™‰õndly
 ? 
LD_STR_HUMAN
 : 
LD_STR_AUTO
));

1068  
	`RM_Cª©eSåög
(
˘x
,
buf
,
Àn
);

1069 
	}
}

1079 
RedisModuÀSåög
 *
	$RM_Cª©eSåögFromSåög
(
RedisModuÀCtx
 *
˘x
, c⁄° 
RedisModuÀSåög
 *
°r
) {

1080 
RedisModuÀSåög
 *
o
 = 
	`dupSåögObje˘
(
°r
);

1081 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yAdd
(˘x,
REDISMODULE_AM_STRING
,
o
);

1082  
o
;

1083 
	}
}

1097 
	$RM_FªeSåög
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
°r
) {

1098 
	`de¸RefCou¡
(
°r
);

1099 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yFªed
(˘x,
REDISMODULE_AM_STRING
,
°r
);

1100 
	}
}

1126 
	$RM_RëaöSåög
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
°r
) {

1127 i‡(
˘x
 =
NULL
 || !
	`autoMem‹yFªed
(˘x,
REDISMODULE_AM_STRING
,
°r
)) {

1137 
	`ö¸RefCou¡
(
°r
);

1139 
	}
}

1144 c⁄° *
	$RM_SåögPåLí
(c⁄° 
RedisModuÀSåög
 *
°r
, 
size_t
 *
Àn
) {

1145 i‡(
°r
 =
NULL
) {

1146 c⁄° *
îrmsg
 = "(NULL stringÑeplyÑeferenced in module)";

1147 i‡(
Àn
Ë*À¿
	`°æí
(
îrmsg
);

1148  
îrmsg
;

1150 i‡(
Àn
Ë*À¿
	`sd¶í
(
°r
->
±r
);

1151  
°r
->
±r
;

1152 
	}
}

1162 
	$RM_SåögToL⁄gL⁄g
(c⁄° 
RedisModuÀSåög
 *
°r
, *
Œ
) {

1163  
	`°rög2Œ
(
°r
->
±r
,
	`sd¶í
(°r->±r),
Œ
Ë? 
REDISMODULE_OK
 :

1164 
REDISMODULE_ERR
;

1165 
	}
}

1170 
	$RM_SåögToDoubÀ
(c⁄° 
RedisModuÀSåög
 *
°r
, *
d
) {

1171 
ªtvÆ
 = 
	`gëDoubÀFromObje˘
(
°r
,
d
);

1172  (
ªtvÆ
 =
C_OK
Ë? 
REDISMODULE_OK
 : 
REDISMODULE_ERR
;

1173 
	}
}

1178 
	$RM_SåögToL⁄gDoubÀ
(c⁄° 
RedisModuÀSåög
 *
°r
, *
ld
) {

1179 
ªtvÆ
 = 
	`°rög2ld
(
°r
->
±r
,
	`sd¶í
(°r->±r),
ld
);

1180  
ªtvÆ
 ? 
REDISMODULE_OK
 : 
REDISMODULE_ERR
;

1181 
	}
}

1186 
	$RM_SåögCom∑ª
(
RedisModuÀSåög
 *
a
, RedisModuÀSåög *
b
) {

1187  
	`com∑ªSåögObje˘s
(
a
,
b
);

1188 
	}
}

1192 
RedisModuÀSåög
 *
	$moduÀAs£πUnsh¨edSåög
(
RedisModuÀSåög
 *
°r
) {

1193 i‡(
°r
->
ªfcou¡
 != 1) {

1194 
	`£rvîLog
(
LL_WARNING
,

1198  
NULL
;

1200 i‡(
°r
->
ícodög
 =
OBJ_ENCODING_EMBSTR
) {

1203 
°r
->
±r
 = 
	`sd¢ewÀn
(°r->±r,
	`sd¶í
(str->ptr));

1204 
°r
->
ícodög
 = 
OBJ_ENCODING_RAW
;

1205 } i‡(
°r
->
ícodög
 =
OBJ_ENCODING_INT
) {

1207 
°r
->
±r
 = 
	`sds‰oml⁄gl⁄g
(()str->ptr);

1208 
°r
->
ícodög
 = 
OBJ_ENCODING_RAW
;

1210  
°r
;

1211 
	}
}

1216 
	$RM_SåögAµídBuf„r
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
°r
, c⁄° *
buf
, 
size_t
 
Àn
) {

1217 
	`UNUSED
(
˘x
);

1218 
°r
 = 
	`moduÀAs£πUnsh¨edSåög
(str);

1219 i‡(
°r
 =
NULL
Ë 
REDISMODULE_ERR
;

1220 
°r
->
±r
 = 
	`sdsˇéí
(°r->±r,
buf
,
Àn
);

1221  
REDISMODULE_OK
;

1222 
	}
}

1241 
	$RM_Wr⁄gArôy
(
RedisModuÀCtx
 *
˘x
) {

1242 
	`addRïlyEº‹F‹m©
(
˘x
->
˛õ¡
,

1244 (*)
˘x
->
˛õ¡
->
¨gv
[0]->
±r
);

1245  
REDISMODULE_OK
;

1246 
	}
}

1262 
˛õ¡
 *
	$moduÀGëRïlyClõ¡
(
RedisModuÀCtx
 *
˘x
) {

1263 i‡(
˘x
->
Êags
 & 
REDISMODULE_CTX_THREAD_SAFE
) {

1264 i‡(
˘x
->
blocked_˛õ¡
)

1265  
˘x
->
blocked_˛õ¡
->
ª∂y_˛õ¡
;

1267  
NULL
;

1273  
˘x
->
˛õ¡
;

1275 
	}
}

1279 
	$RM_RïlyWôhL⁄gL⁄g
(
RedisModuÀCtx
 *
˘x
, 
Œ
) {

1280 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1281 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1282 
	`addRïlyL⁄gL⁄g
(
c
,
Œ
);

1283  
REDISMODULE_OK
;

1284 
	}
}

1289 
	$ª∂yWôhSètus
(
RedisModuÀCtx
 *
˘x
, c⁄° *
msg
, *
¥efix
) {

1290 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1291 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1292 
	`addRïlyPrŸo
(
c
,
¥efix
,
	`°æí
(prefix));

1293 
	`addRïlyPrŸo
(
c
,
msg
,
	`°æí
(msg));

1294 
	`addRïlyPrŸo
(
c
,"\r\n",2);

1295  
REDISMODULE_OK
;

1296 
	}
}

1312 
	$RM_RïlyWôhEº‹
(
RedisModuÀCtx
 *
˘x
, c⁄° *
îr
) {

1313  
	`ª∂yWôhSètus
(
˘x
,
îr
,"-");

1314 
	}
}

1321 
	$RM_RïlyWôhSim∂eSåög
(
RedisModuÀCtx
 *
˘x
, c⁄° *
msg
) {

1322  
	`ª∂yWôhSètus
(
˘x
,
msg
,"+");

1323 
	}
}

1336 
	$RM_RïlyWôhAºay
(
RedisModuÀCtx
 *
˘x
, 
Àn
) {

1337 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1338 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1339 i‡(
Àn
 =
REDISMODULE_POSTPONED_ARRAY_LEN
) {

1340 
˘x
->
po°p⁄ed_¨øys
 = 
	`zªÆloc
(ctx->postponed_arrays,(*)*

1341 (
˘x
->
po°p⁄ed_¨øys_cou¡
+1));

1342 
˘x
->
po°p⁄ed_¨øys
[˘x->
po°p⁄ed_¨øys_cou¡
] =

1343 
	`addRïlyDe„ºedLí
(
c
);

1344 
˘x
->
po°p⁄ed_¨øys_cou¡
++;

1346 
	`addRïlyAºayLí
(
c
,
Àn
);

1348  
REDISMODULE_OK
;

1349 
	}
}

1355 
	$RM_RïlyWôhNuŒAºay
(
RedisModuÀCtx
 *
˘x
) {

1356 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1357 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1358 
	`addRïlyNuŒAºay
(
c
);

1359  
REDISMODULE_OK
;

1360 
	}
}

1365 
	$RM_RïlyWôhEm±yAºay
(
RedisModuÀCtx
 *
˘x
) {

1366 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1367 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1368 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

1369  
REDISMODULE_OK
;

1370 
	}
}

1398 
	$RM_RïlySëAºayLígth
(
RedisModuÀCtx
 *
˘x
, 
Àn
) {

1399 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1400 i‡(
c
 =
NULL
) ;

1401 i‡(
˘x
->
po°p⁄ed_¨øys_cou¡
 == 0) {

1402 
	`£rvîLog
(
LL_WARNING
,

1406 "ˇŒ.", 
˘x
->
moduÀ
->
«me
);

1409 
˘x
->
po°p⁄ed_¨øys_cou¡
--;

1410 
	`£tDe„ºedAºayLí
(
c
,

1411 
˘x
->
po°p⁄ed_¨øys
[˘x->
po°p⁄ed_¨øys_cou¡
],

1412 
Àn
);

1413 i‡(
˘x
->
po°p⁄ed_¨øys_cou¡
 == 0) {

1414 
	`z‰ì
(
˘x
->
po°p⁄ed_¨øys
);

1415 
˘x
->
po°p⁄ed_¨øys
 = 
NULL
;

1417 
	}
}

1422 
	$RM_RïlyWôhSåögBuf„r
(
RedisModuÀCtx
 *
˘x
, c⁄° *
buf
, 
size_t
 
Àn
) {

1423 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1424 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1425 
	`addRïlyBulkCBuf„r
(
c
,(*)
buf
,
Àn
);

1426  
REDISMODULE_OK
;

1427 
	}
}

1433 
	$RM_RïlyWôhCSåög
(
RedisModuÀCtx
 *
˘x
, c⁄° *
buf
) {

1434 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1435 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1436 
	`addRïlyBulkCSåög
(
c
,(*)
buf
);

1437  
REDISMODULE_OK
;

1438 
	}
}

1443 
	$RM_RïlyWôhSåög
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
°r
) {

1444 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1445 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1446 
	`addRïlyBulk
(
c
,
°r
);

1447  
REDISMODULE_OK
;

1448 
	}
}

1453 
	$RM_RïlyWôhEm±ySåög
(
RedisModuÀCtx
 *
˘x
) {

1454 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1455 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1456 
	`addRïly
(
c
,
sh¨ed
.
em±ybulk
);

1457  
REDISMODULE_OK
;

1458 
	}
}

1464 
	$RM_RïlyWôhVîb©imSåög
(
RedisModuÀCtx
 *
˘x
, c⁄° *
buf
, 
size_t
 
Àn
) {

1465 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1466 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1467 
	`addRïlyVîb©im
(
c
, 
buf
, 
Àn
, "txt");

1468  
REDISMODULE_OK
;

1469 
	}
}

1474 
	$RM_RïlyWôhNuŒ
(
RedisModuÀCtx
 *
˘x
) {

1475 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1476 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1477 
	`addRïlyNuŒ
(
c
);

1478  
REDISMODULE_OK
;

1479 
	}
}

1487 
	$RM_RïlyWôhCÆlRïly
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀCÆlRïly
 *
ª∂y
) {

1488 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1489 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1490 
sds
 
¥Ÿo
 = 
	`sd¢ewÀn
(
ª∂y
->¥Ÿo,Ñïly->
¥Ÿﬁí
);

1491 
	`addRïlySds
(
c
,
¥Ÿo
);

1492  
REDISMODULE_OK
;

1493 
	}
}

1501 
	$RM_RïlyWôhDoubÀ
(
RedisModuÀCtx
 *
˘x
, 
d
) {

1502 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1503 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1504 
	`addRïlyDoubÀ
(
c
,
d
);

1505  
REDISMODULE_OK
;

1506 
	}
}

1516 
	$RM_RïlyWôhL⁄gDoubÀ
(
RedisModuÀCtx
 *
˘x
, 
ld
) {

1517 
˛õ¡
 *
c
 = 
	`moduÀGëRïlyClõ¡
(
˘x
);

1518 i‡(
c
 =
NULL
Ë 
REDISMODULE_OK
;

1519 
	`addRïlyHum™L⁄gDoubÀ
(
c
, 
ld
);

1520  
REDISMODULE_OK
;

1521 
	}
}

1530 
	$moduÀRïliˇãMu…iIfNìded
(
RedisModuÀCtx
 *
˘x
) {

1533 i‡(
˘x
->
˛õ¡
->
Êags
 & (
CLIENT_MULTI
|
CLIENT_LUA
)) ;

1535 i‡(
˘x
->
Êags
 & 
REDISMODULE_CTX_MULTI_EMITTED
) ;

1539 i‡(
˘x
->
Êags
 & 
REDISMODULE_CTX_THREAD_SAFE
) ;

1543 i‡(!(
˘x
->
Êags
 & 
REDISMODULE_CTX_MODULE_COMMAND_CALL
)) {

1544 
˘x
->
ßved_›¨øy
 = 
£rvî
.
Æso_¥›ag©e
;

1545 
	`ªdisOpAºayInô
(&
£rvî
.
Æso_¥›ag©e
);

1547 
	`execComm™dPr›ag©eMu…i
(
˘x
->
˛õ¡
);

1548 
˘x
->
Êags
 |
REDISMODULE_CTX_MULTI_EMITTED
;

1549 
	}
}

1588 
	$RM_Rïliˇã
(
RedisModuÀCtx
 *
˘x
, c⁄° *
cmd«me
, c⁄° *
fmt
, ...) {

1589 
ªdisComm™d
 *
cmd
;

1590 
robj
 **
¨gv
 = 
NULL
;

1591 
¨gc
 = 0, 
Êags
 = 0, 
j
;

1592 
va_li°
 
≠
;

1594 
cmd
 = 
	`lookupComm™dByCSåög
((*)
cmd«me
);

1595 i‡(!
cmd
Ë 
REDISMODULE_ERR
;

1598 
	`va_°¨t
(
≠
, 
fmt
);

1599 
¨gv
 = 
	`moduÀCª©eArgvFromU£rF‹m©
(
cmd«me
,
fmt
,&
¨gc
,&
Êags
,
≠
);

1600 
	`va_íd
(
≠
);

1601 i‡(
¨gv
 =
NULL
Ë 
REDISMODULE_ERR
;

1606 
èrgë
 = 0;

1607 i‡(!(
Êags
 & 
REDISMODULE_ARGV_NO_AOF
)Ë
èrgë
 |
PROPAGATE_AOF
;

1608 i‡(!(
Êags
 & 
REDISMODULE_ARGV_NO_REPLICAS
)Ë
èrgë
 |
PROPAGATE_REPL
;

1614 i‡(
˘x
->
Êags
 & 
REDISMODULE_CTX_THREAD_SAFE
) {

1615 
	`¥›ag©e
(
cmd
,
˘x
->
˛õ¡
->
db
->
id
,
¨gv
,
¨gc
,
èrgë
);

1617 
	`moduÀRïliˇãMu…iIfNìded
(
˘x
);

1618 
	`ÆsoPr›ag©e
(
cmd
,
˘x
->
˛õ¡
->
db
->
id
,
¨gv
,
¨gc
,
èrgë
);

1622 
j
 = 0; j < 
¨gc
; j++Ë
	`de¸RefCou¡
(
¨gv
[j]);

1623 
	`z‰ì
(
¨gv
);

1624 
£rvî
.
dúty
++;

1625  
REDISMODULE_OK
;

1626 
	}
}

1639 
	$RM_RïliˇãVîb©im
(
RedisModuÀCtx
 *
˘x
) {

1640 
	`ÆsoPr›ag©e
(
˘x
->
˛õ¡
->
cmd
,˘x->˛õ¡->
db
->
id
,

1641 
˘x
->
˛õ¡
->
¨gv
,˘x->˛õ¡->
¨gc
,

1642 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

1643 
£rvî
.
dúty
++;

1644  
REDISMODULE_OK
;

1645 
	}
}

1670 
	$RM_GëClõ¡Id
(
RedisModuÀCtx
 *
˘x
) {

1671 i‡(
˘x
->
˛õ¡
 =
NULL
)  0;

1672  
˘x
->
˛õ¡
->
id
;

1673 
	}
}

1681 
	$moduÀP›uœãClõ¡InfoSåu˘uª
(*
ci
, 
˛õ¡
 *˛õ¡, 
°ru˘vî
) {

1682 i‡(
°ru˘vî
 !1Ë 
REDISMODULE_ERR
;

1684 
RedisModuÀClõ¡InfoV1
 *
ci1
 = 
ci
;

1685 
	`mem£t
(
ci1
,0,(*ci1));

1686 
ci1
->
vîsi⁄
 = 
°ru˘vî
;

1687 i‡(
˛õ¡
->
Êags
 & 
CLIENT_MULTI
)

1688 
ci1
->
Êags
 |
REDISMODULE_CLIENTINFO_FLAG_MULTI
;

1689 i‡(
˛õ¡
->
Êags
 & 
CLIENT_PUBSUB
)

1690 
ci1
->
Êags
 |
REDISMODULE_CLIENTINFO_FLAG_PUBSUB
;

1691 i‡(
˛õ¡
->
Êags
 & 
CLIENT_UNIX_SOCKET
)

1692 
ci1
->
Êags
 |
REDISMODULE_CLIENTINFO_FLAG_UNIXSOCKET
;

1693 i‡(
˛õ¡
->
Êags
 & 
CLIENT_TRACKING
)

1694 
ci1
->
Êags
 |
REDISMODULE_CLIENTINFO_FLAG_TRACKING
;

1695 i‡(
˛õ¡
->
Êags
 & 
CLIENT_BLOCKED
)

1696 
ci1
->
Êags
 |
REDISMODULE_CLIENTINFO_FLAG_BLOCKED
;

1698 
p‹t
;

1699 
	`c⁄nPìrToSåög
(
˛õ¡
->
c⁄n
,
ci1
->
addr
,(ci1->addr),&
p‹t
);

1700 
ci1
->
p‹t
 =Öort;

1701 
ci1
->
db
 = 
˛õ¡
->db->
id
;

1702 
ci1
->
id
 = 
˛õ¡
->id;

1703  
REDISMODULE_OK
;

1704 
	}
}

1711 
	$moduÀP›uœãRïliˇti⁄InfoSåu˘uª
(*
ri
, 
°ru˘vî
) {

1712 i‡(
°ru˘vî
 !1Ë 
REDISMODULE_ERR
;

1714 
RedisModuÀRïliˇti⁄InfoV1
 *
ri1
 = 
ri
;

1715 
	`mem£t
(
ri1
,0,(*ri1));

1716 
ri1
->
vîsi⁄
 = 
°ru˘vî
;

1717 
ri1
->
ma°î
 = 
£rvî
.
ma°îho°
==
NULL
;

1718 
ri1
->
ma°îho°
 = 
£rvî
.masterhost? server.masterhost: "";

1719 
ri1
->
ma°îp‹t
 = 
£rvî
.masterport;

1720 
ri1
->
ª∂id1
 = 
£rvî
.
ª∂id
;

1721 
ri1
->
ª∂id2
 = 
£rvî
.replid2;

1722 
ri1
->
ª∂1_off£t
 = 
£rvî
.
ma°î_ª∂_off£t
;

1723 
ri1
->
ª∂2_off£t
 = 
£rvî
.
£c⁄d_ª∂id_off£t
;

1724  
REDISMODULE_OK
;

1725 
	}
}

1769 
	$RM_GëClõ¡InfoById
(*
ci
, 
uöt64_t
 
id
) {

1770 
˛õ¡
 *˛õ¡ = 
	`lookupClõ¡ByID
(
id
);

1771 i‡(
˛õ¡
 =
NULL
Ë 
REDISMODULE_ERR
;

1772 i‡(
ci
 =
NULL
Ë 
REDISMODULE_OK
;

1775 
uöt64_t
 
°ru˘vî
 = ((uöt64_t*)
ci
)[0];

1776  
	`moduÀP›uœãClõ¡InfoSåu˘uª
(
ci
,
˛õ¡
,
°ru˘vî
);

1777 
	}
}

1780 
	$RM_PublishMesßge
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
ch™√l
, RedisModuÀSåög *
mesßge
) {

1781 
	`UNUSED
(
˘x
);

1782 
ª˚ivîs
 = 
	`pubsubPublishMesßge
(
ch™√l
, 
mesßge
);

1783 i‡(
£rvî
.
˛u°î_íabÀd
)

1784 
	`˛u°îPr›ag©ePublish
(
ch™√l
, 
mesßge
);

1785  
ª˚ivîs
;

1786 
	}
}

1789 
	$RM_GëSñe˘edDb
(
RedisModuÀCtx
 *
˘x
) {

1790  
˘x
->
˛õ¡
->
db
->
id
;

1791 
	}
}

1852 
	$RM_GëC⁄ãxtFœgs
(
RedisModuÀCtx
 *
˘x
) {

1854 
Êags
 = 0;

1856 i‡(
˘x
) {

1857 i‡(
˘x
->
˛õ¡
) {

1858 i‡(
˘x
->
˛õ¡
->
Êags
 & 
CLIENT_LUA
)

1859 
Êags
 |
REDISMODULE_CTX_FLAGS_LUA
;

1860 i‡(
˘x
->
˛õ¡
->
Êags
 & 
CLIENT_MULTI
)

1861 
Êags
 |
REDISMODULE_CTX_FLAGS_MULTI
;

1863 i‡(
˘x
->
˛õ¡
->
Êags
 & 
CLIENT_MASTER
)

1864 
Êags
 |
REDISMODULE_CTX_FLAGS_REPLICATED
;

1868 
˛õ¡
 *
c
 = 
˘x
->
blocked_˛õ¡
 ? ctx->blocked_client->client : ctx->client;

1869 i‡(
c
 && (c->
Êags
 & (
CLIENT_DIRTY_CAS
|
CLIENT_DIRTY_EXEC
))) {

1870 
Êags
 |
REDISMODULE_CTX_FLAGS_MULTI_DIRTY
;

1874 i‡(
£rvî
.
˛u°î_íabÀd
)

1875 
Êags
 |
REDISMODULE_CTX_FLAGS_CLUSTER
;

1877 i‡(
£rvî
.
lﬂdög
)

1878 
Êags
 |
REDISMODULE_CTX_FLAGS_LOADING
;

1881 i‡(
£rvî
.
maxmem‹y
 > 0) {

1882 
Êags
 |
REDISMODULE_CTX_FLAGS_MAXMEMORY
;

1884 i‡(
£rvî
.
maxmem‹y_pﬁicy
 !
MAXMEMORY_NO_EVICTION
)

1885 
Êags
 |
REDISMODULE_CTX_FLAGS_EVICT
;

1889 i‡(
£rvî
.
aof_°©e
 !
AOF_OFF
)

1890 
Êags
 |
REDISMODULE_CTX_FLAGS_AOF
;

1891 i‡(
£rvî
.
ßvï¨am¶í
 > 0)

1892 
Êags
 |
REDISMODULE_CTX_FLAGS_RDB
;

1895 i‡(
£rvî
.
ma°îho°
 =
NULL
) {

1896 
Êags
 |
REDISMODULE_CTX_FLAGS_MASTER
;

1898 
Êags
 |
REDISMODULE_CTX_FLAGS_SLAVE
;

1899 i‡(
£rvî
.
ª∂_¶ave_ro
)

1900 
Êags
 |
REDISMODULE_CTX_FLAGS_READONLY
;

1903 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECT
 ||

1904 
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTING
)

1906 
Êags
 |
REDISMODULE_CTX_FLAGS_REPLICA_IS_CONNECTING
;

1907 } i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_TRANSFER
) {

1908 
Êags
 |
REDISMODULE_CTX_FLAGS_REPLICA_IS_TRANSFERRING
;

1909 } i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTED
) {

1910 
Êags
 |
REDISMODULE_CTX_FLAGS_REPLICA_IS_ONLINE
;

1913 i‡(
£rvî
.
ª∂_°©e
 !
REPL_STATE_CONNECTED
)

1914 
Êags
 |
REDISMODULE_CTX_FLAGS_REPLICA_IS_STALE
;

1918 
Àvñ
;

1919 
ªtvÆ
 = 
	`gëMaxmem‹ySèã
(
NULL
,NULL,NULL,&
Àvñ
);

1920 i‡(
ªtvÆ
 =
C_ERR
Ë
Êags
 |
REDISMODULE_CTX_FLAGS_OOM
;

1921 i‡(
Àvñ
 > 0.75Ë
Êags
 |
REDISMODULE_CTX_FLAGS_OOM_WARNING
;

1924 i‡(
	`hasA˘iveChûdPro˚ss
()Ë
Êags
 |
REDISMODULE_CTX_FLAGS_ACTIVE_CHILD
;

1926  
Êags
;

1927 
	}
}

1949 
	$RM_AvoidRïliˇTøffic
() {

1950  
	`˛õ¡sAªPau£d
();

1951 
	}
}

1963 
	$RM_Sñe˘Db
(
RedisModuÀCtx
 *
˘x
, 
√wid
) {

1964 
ªtvÆ
 = 
	`£À˘Db
(
˘x
->
˛õ¡
,
√wid
);

1965  (
ªtvÆ
 =
C_OK
Ë? 
REDISMODULE_OK
 : 
REDISMODULE_ERR
;

1966 
	}
}

1969 
	$moduÀInôKey
(
RedisModuÀKey
 *
kp
, 
RedisModuÀCtx
 *
˘x
, 
robj
 *
key«me
,Ñobj *
vÆue
, 
mode
){

1970 
kp
->
˘x
 = ctx;

1971 
kp
->
db
 = 
˘x
->
˛õ¡
->db;

1972 
kp
->
key
 = 
key«me
;

1973 
	`ö¸RefCou¡
(
key«me
);

1974 
kp
->
vÆue
 = value;

1975 
kp
->
ôî
 = 
NULL
;

1976 
kp
->
mode
 = mode;

1977 
	`z£tKeyRe£t
(
kp
);

1978 
	}
}

1994 *
	$RM_O≥nKey
(
RedisModuÀCtx
 *
˘x
, 
robj
 *
key«me
, 
mode
) {

1995 
RedisModuÀKey
 *
kp
;

1996 
robj
 *
vÆue
;

1997 
Êags
 = 
mode
 & 
REDISMODULE_OPEN_KEY_NOTOUCH
? 
LOOKUP_NOTOUCH
: 0;

1999 i‡(
mode
 & 
REDISMODULE_WRITE
) {

2000 
vÆue
 = 
	`lookupKeyWrôeWôhFœgs
(
˘x
->
˛õ¡
->
db
,
key«me
, 
Êags
);

2002 
vÆue
 = 
	`lookupKeyRódWôhFœgs
(
˘x
->
˛õ¡
->
db
,
key«me
, 
Êags
);

2003 i‡(
vÆue
 =
NULL
) {

2004  
NULL
;

2009 
kp
 = 
	`zmÆloc
((*kp));

2010 
	`moduÀInôKey
(
kp
, 
˘x
, 
key«me
, 
vÆue
, 
mode
);

2011 
	`autoMem‹yAdd
(
˘x
,
REDISMODULE_AM_KEY
,
kp
);

2012  (*)
kp
;

2013 
	}
}

2016 
	$moduÀClo£Key
(
RedisModuÀKey
 *
key
) {

2017 
sig«l
 = 
	`SHOULD_SIGNAL_MODIFIED_KEYS
(
key
->
˘x
);

2018 i‡((
key
->
mode
 & 
REDISMODULE_WRITE
Ë&& 
sig«l
)

2019 
	`sig«lModifõdKey
(
key
->
˘x
->
˛õ¡
,key->
db
,key->key);

2021 
	`RM_Z£tR™geSt›
(
key
);

2022 
	`de¸RefCou¡
(
key
->key);

2023 
	}
}

2026 
	$RM_Clo£Key
(
RedisModuÀKey
 *
key
) {

2027 i‡(
key
 =
NULL
) ;

2028 
	`moduÀClo£Key
(
key
);

2029 
	`autoMem‹yFªed
(
key
->
˘x
,
REDISMODULE_AM_KEY
,key);

2030 
	`z‰ì
(
key
);

2031 
	}
}

2035 
	$RM_KeyTy≥
(
RedisModuÀKey
 *
key
) {

2036 i‡(
key
 =
NULL
 || key->
vÆue
 =NULLË 
REDISMODULE_KEYTYPE_EMPTY
;

2039 
key
->
vÆue
->
ty≥
) {

2040 
OBJ_STRING
:  
REDISMODULE_KEYTYPE_STRING
;

2041 
OBJ_LIST
:  
REDISMODULE_KEYTYPE_LIST
;

2042 
OBJ_SET
:  
REDISMODULE_KEYTYPE_SET
;

2043 
OBJ_ZSET
:  
REDISMODULE_KEYTYPE_ZSET
;

2044 
OBJ_HASH
:  
REDISMODULE_KEYTYPE_HASH
;

2045 
OBJ_MODULE
:  
REDISMODULE_KEYTYPE_MODULE
;

2046 
OBJ_STREAM
:  
REDISMODULE_KEYTYPE_STREAM
;

2049 
	}
}

2056 
size_t
 
	$RM_VÆueLígth
(
RedisModuÀKey
 *
key
) {

2057 i‡(
key
 =
NULL
 || key->
vÆue
 == NULL)  0;

2058 
key
->
vÆue
->
ty≥
) {

2059 
OBJ_STRING
:  
	`°rögObje˘Lí
(
key
->
vÆue
);

2060 
OBJ_LIST
:  
	`li°Ty≥Lígth
(
key
->
vÆue
);

2061 
OBJ_SET
:  
	`£tTy≥Size
(
key
->
vÆue
);

2062 
OBJ_ZSET
:  
	`z£tLígth
(
key
->
vÆue
);

2063 
OBJ_HASH
:  
	`hashTy≥Lígth
(
key
->
vÆue
);

2064 
OBJ_STREAM
:  
	`°ªamLígth
(
key
->
vÆue
);

2067 
	}
}

2073 
	$RM_DñëeKey
(
RedisModuÀKey
 *
key
) {

2074 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
)Ë 
REDISMODULE_ERR
;

2075 i‡(
key
->
vÆue
) {

2076 
	`dbDñëe
(
key
->
db
,key->key);

2077 
key
->
vÆue
 = 
NULL
;

2079  
REDISMODULE_OK
;

2080 
	}
}

2087 
	$RM_U∆ökKey
(
RedisModuÀKey
 *
key
) {

2088 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
)Ë 
REDISMODULE_ERR
;

2089 i‡(
key
->
vÆue
) {

2090 
	`dbAsyncDñëe
(
key
->
db
,key->key);

2091 
key
->
vÆue
 = 
NULL
;

2093  
REDISMODULE_OK
;

2094 
	}
}

2099 
m°ime_t
 
	$RM_GëExpúe
(
RedisModuÀKey
 *
key
) {

2100 
m°ime_t
 
expúe
 = 
	`gëExpúe
(
key
->
db
,key->key);

2101 i‡(
expúe
 =-1 || 
key
->
vÆue
 =
NULL
)  -1;

2102 
expúe
 -
	`m°ime
();

2103  
expúe
 >= 0 ?Éxpire : 0;

2104 
	}
}

2115 
	$RM_SëExpúe
(
RedisModuÀKey
 *
key
, 
m°ime_t
 
expúe
) {

2116 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
Ë|| key->
vÆue
 =
NULL
)

2117  
REDISMODULE_ERR
;

2118 i‡(
expúe
 !
REDISMODULE_NO_EXPIRE
) {

2119 
expúe
 +
	`m°ime
();

2120 
	`£tExpúe
(
key
->
˘x
->
˛õ¡
,key->
db
,key->key,
expúe
);

2122 
	`ªmoveExpúe
(
key
->
db
,key->key);

2124  
REDISMODULE_OK
;

2125 
	}
}

2131 
	$RM_Re£tD©a£t
(
ª°¨t_aof
, 
async
) {

2132 i‡(
ª°¨t_aof
 && 
£rvî
.
aof_°©e
 !
AOF_OFF
Ë
	`°›AµídO∆y
();

2133 
	`ÊushAŒD©aAndRe£tRDB
(
async
? 
EMPTYDB_ASYNC
: 
EMPTYDB_NO_FLAGS
);

2134 i‡(
£rvî
.
aof_íabÀd
 && 
ª°¨t_aof
Ë
	`ª°¨tAOFA·îSYNC
();

2135 
	}
}

2138 
	$RM_DbSize
(
RedisModuÀCtx
 *
˘x
) {

2139  
	`di˘Size
(
˘x
->
˛õ¡
->
db
->
di˘
);

2140 
	}
}

2143 
RedisModuÀSåög
 *
	$RM_R™domKey
(
RedisModuÀCtx
 *
˘x
) {

2144 
robj
 *
key
 = 
	`dbR™domKey
(
˘x
->
˛õ¡
->
db
);

2145 
	`autoMem‹yAdd
(
˘x
,
REDISMODULE_AM_STRING
,
key
);

2146  
key
;

2147 
	}
}

2157 
	$RM_SåögSë
(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
°r
) {

2158 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
Ë|| key->
ôî
Ë 
REDISMODULE_ERR
;

2159 
	`RM_DñëeKey
(
key
);

2160 
	`gíîicSëKey
(
key
->
˘x
->
˛õ¡
,key->
db
,key->key,
°r
,0,0);

2161 
key
->
vÆue
 = 
°r
;

2162  
REDISMODULE_OK
;

2163 
	}
}

2194 *
	$RM_SåögDMA
(
RedisModuÀKey
 *
key
, 
size_t
 *
Àn
, 
mode
) {

2199 *
em±y°rög
 = "<dma-empty-string>";

2200 i‡(
key
->
vÆue
 =
NULL
) {

2201 *
Àn
 = 0;

2202  
em±y°rög
;

2205 i‡(
key
->
vÆue
->
ty≥
 !
OBJ_STRING
Ë 
NULL
;

2209 i‡((
mode
 & 
REDISMODULE_WRITE
Ë|| 
key
->
vÆue
->
ícodög
 !
OBJ_ENCODING_RAW
)

2210 
key
->
vÆue
 = 
	`dbUnsh¨eSåögVÆue
(key->
db
, key->key, key->value);

2212 *
Àn
 = 
	`sd¶í
(
key
->
vÆue
->
±r
);

2213  
key
->
vÆue
->
±r
;

2214 
	}
}

2228 
	$RM_SåögTrunˇã
(
RedisModuÀKey
 *
key
, 
size_t
 
√wÀn
) {

2229 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
)Ë 
REDISMODULE_ERR
;

2230 i‡(
key
->
vÆue
 && key->vÆue->
ty≥
 !
OBJ_STRING
Ë 
REDISMODULE_ERR
;

2231 i‡(
√wÀn
 > 512*1024*1024Ë 
REDISMODULE_ERR
;

2235 i‡(
key
->
vÆue
 =
NULL
 && 
√wÀn
 =0Ë 
REDISMODULE_OK
;

2237 i‡(
key
->
vÆue
 =
NULL
) {

2239 
robj
 *
o
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ewÀn
(
NULL
, 
√wÀn
));

2240 
	`gíîicSëKey
(
key
->
˘x
->
˛õ¡
,key->
db
,key->key,
o
,0,0);

2241 
key
->
vÆue
 = 
o
;

2242 
	`de¸RefCou¡
(
o
);

2245 
key
->
vÆue
 = 
	`dbUnsh¨eSåögVÆue
(key->
db
, key->key, key->value);

2246 
size_t
 
cuæí
 = 
	`sd¶í
(
key
->
vÆue
->
±r
);

2247 i‡(
√wÀn
 > 
cuæí
) {

2248 
key
->
vÆue
->
±r
 = 
	`sdsgrowzîo
(key->vÆue->±r,
√wÀn
);

2249 } i‡(
√wÀn
 < 
cuæí
) {

2250 
	`sd§™ge
(
key
->
vÆue
->
±r
,0,
√wÀn
-1);

2252 i‡(
	`sd¶í
(
key
->
vÆue
->
±r
Ë< 
	`sdßvaû
(key->value->ptr))

2253 
key
->
vÆue
->
±r
 = 
	`sdsRemoveFªeS∑˚
(key->value->ptr);

2256  
REDISMODULE_OK
;

2257 
	}
}

2267 
	$RM_Li°Push
(
RedisModuÀKey
 *
key
, 
whîe
, 
RedisModuÀSåög
 *
ñe
) {

2268 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
)Ë 
REDISMODULE_ERR
;

2269 i‡(
key
->
vÆue
 && key->vÆue->
ty≥
 !
OBJ_LIST
Ë 
REDISMODULE_ERR
;

2270 i‡(
key
->
vÆue
 =
NULL
Ë
	`moduÀCª©eEm±yKey
(key,
REDISMODULE_KEYTYPE_LIST
);

2271 
	`li°Ty≥Push
(
key
->
vÆue
, 
ñe
,

2272 (
whîe
 =
REDISMODULE_LIST_HEAD
Ë? 
QUICKLIST_HEAD
 : 
QUICKLIST_TAIL
);

2273  
REDISMODULE_OK
;

2274 
	}
}

2283 
RedisModuÀSåög
 *
	$RM_Li°P›
(
RedisModuÀKey
 *
key
, 
whîe
) {

2284 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
) ||

2285 
key
->
vÆue
 =
NULL
 ||

2286 
key
->
vÆue
->
ty≥
 !
OBJ_LIST
Ë 
NULL
;

2287 
robj
 *
ñe
 = 
	`li°Ty≥P›
(
key
->
vÆue
,

2288 (
whîe
 =
REDISMODULE_LIST_HEAD
Ë? 
QUICKLIST_HEAD
 : 
QUICKLIST_TAIL
);

2289 
robj
 *
decoded
 = 
	`gëDecodedObje˘
(
ñe
);

2290 
	`de¸RefCou¡
(
ñe
);

2291 
	`moduÀDñKeyIfEm±y
(
key
);

2292 
	`autoMem‹yAdd
(
key
->
˘x
,
REDISMODULE_AM_STRING
,
decoded
);

2293  
decoded
;

2294 
	}
}

2302 
	$RM_Z£tAddFœgsToC‹eFœgs
(
Êags
) {

2303 
ªtÊags
 = 0;

2304 i‡(
Êags
 & 
REDISMODULE_ZADD_XX
Ë
ªtÊags
 |
ZADD_XX
;

2305 i‡(
Êags
 & 
REDISMODULE_ZADD_NX
Ë
ªtÊags
 |
ZADD_NX
;

2306  
ªtÊags
;

2307 
	}
}

2310 
	$RM_Z£tAddFœgsFromC‹eFœgs
(
Êags
) {

2311 
ªtÊags
 = 0;

2312 i‡(
Êags
 & 
ZADD_ADDED
Ë
ªtÊags
 |
REDISMODULE_ZADD_ADDED
;

2313 i‡(
Êags
 & 
ZADD_UPDATED
Ë
ªtÊags
 |
REDISMODULE_ZADD_UPDATED
;

2314 i‡(
Êags
 & 
ZADD_NOP
Ë
ªtÊags
 |
REDISMODULE_ZADD_NOP
;

2315  
ªtÊags
;

2316 
	}
}

2346 
	$RM_Z£tAdd
(
RedisModuÀKey
 *
key
, 
sc‹e
, 
RedisModuÀSåög
 *
ñe
, *
Êag•å
) {

2347 
Êags
 = 0;

2348 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
)Ë 
REDISMODULE_ERR
;

2349 i‡(
key
->
vÆue
 && key->vÆue->
ty≥
 !
OBJ_ZSET
Ë 
REDISMODULE_ERR
;

2350 i‡(
key
->
vÆue
 =
NULL
Ë
	`moduÀCª©eEm±yKey
(key,
REDISMODULE_KEYTYPE_ZSET
);

2351 i‡(
Êag•å
Ë
Êags
 = 
	`RM_Z£tAddFœgsToC‹eFœgs
(*flagsptr);

2352 i‡(
	`z£tAdd
(
key
->
vÆue
,
sc‹e
,
ñe
->
±r
,&
Êags
,
NULL
) == 0) {

2353 i‡(
Êag•å
) *flagsptr = 0;

2354  
REDISMODULE_ERR
;

2356 i‡(
Êag•å
Ë*Êag•å = 
	`RM_Z£tAddFœgsFromC‹eFœgs
(
Êags
);

2357  
REDISMODULE_OK
;

2358 
	}
}

2373 
	$RM_Z£tIn¸by
(
RedisModuÀKey
 *
key
, 
sc‹e
, 
RedisModuÀSåög
 *
ñe
, *
Êag•å
, *
√wsc‹e
) {

2374 
Êags
 = 0;

2375 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
)Ë 
REDISMODULE_ERR
;

2376 i‡(
key
->
vÆue
 && key->vÆue->
ty≥
 !
OBJ_ZSET
Ë 
REDISMODULE_ERR
;

2377 i‡(
key
->
vÆue
 =
NULL
Ë
	`moduÀCª©eEm±yKey
(key,
REDISMODULE_KEYTYPE_ZSET
);

2378 i‡(
Êag•å
Ë
Êags
 = 
	`RM_Z£tAddFœgsToC‹eFœgs
(*flagsptr);

2379 
Êags
 |
ZADD_INCR
;

2380 i‡(
	`z£tAdd
(
key
->
vÆue
,
sc‹e
,
ñe
->
±r
,&
Êags
,
√wsc‹e
) == 0) {

2381 i‡(
Êag•å
) *flagsptr = 0;

2382  
REDISMODULE_ERR
;

2385 i‡(
Êag•å
 && (*Êag•å & 
ZADD_NAN
)) {

2386 *
Êag•å
 = 0;

2387  
REDISMODULE_ERR
;

2389 i‡(
Êag•å
Ë*Êag•å = 
	`RM_Z£tAddFœgsFromC‹eFœgs
(
Êags
);

2390  
REDISMODULE_OK
;

2391 
	}
}

2411 
	$RM_Z£tRem
(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
ñe
, *
dñëed
) {

2412 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
)Ë 
REDISMODULE_ERR
;

2413 i‡(
key
->
vÆue
 && key->vÆue->
ty≥
 !
OBJ_ZSET
Ë 
REDISMODULE_ERR
;

2414 i‡(
key
->
vÆue
 !
NULL
 && 
	`z£tDñ
(key->vÆue,
ñe
->
±r
)) {

2415 i‡(
dñëed
) *deleted = 1;

2417 i‡(
dñëed
) *deleted = 0;

2419  
REDISMODULE_OK
;

2420 
	}
}

2430 
	$RM_Z£tSc‹e
(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
ñe
, *
sc‹e
) {

2431 i‡(
key
->
vÆue
 =
NULL
Ë 
REDISMODULE_ERR
;

2432 i‡(
key
->
vÆue
->
ty≥
 !
OBJ_ZSET
Ë 
REDISMODULE_ERR
;

2433 i‡(
	`z£tSc‹e
(
key
->
vÆue
,
ñe
->
±r
,
sc‹e
Ë=
C_ERR
Ë 
REDISMODULE_ERR
;

2434  
REDISMODULE_OK
;

2435 
	}
}

2441 
	$z£tKeyRe£t
(
RedisModuÀKey
 *
key
) {

2442 
key
->
zty≥
 = 
REDISMODULE_ZSET_RANGE_NONE
;

2443 
key
->
zcuºít
 = 
NULL
;

2444 
key
->
zî
 = 1;

2445 
	}
}

2448 
	$RM_Z£tR™geSt›
(
RedisModuÀKey
 *
key
) {

2450 i‡(
key
->
zty≥
 =
REDISMODULE_ZSET_RANGE_LEX
)

2451 
	`z¶FªeLexR™ge
(&
key
->
zÃs
);

2455 
	`z£tKeyRe£t
(
key
);

2456 
	}
}

2459 
	$RM_Z£tR™geEndRóched
(
RedisModuÀKey
 *
key
) {

2460  
key
->
zî
;

2461 
	}
}

2469 
	$z£tInôSc‹eR™ge
(
RedisModuÀKey
 *
key
, 
mö
, 
max
, 
möex
, 
maxex
, 
fú°
) {

2470 i‡(!
key
->
vÆue
 || key->vÆue->
ty≥
 !
OBJ_ZSET
Ë 
REDISMODULE_ERR
;

2472 
	`RM_Z£tR™geSt›
(
key
);

2473 
key
->
zty≥
 = 
REDISMODULE_ZSET_RANGE_SCORE
;

2474 
key
->
zî
 = 0;

2478 
zønge•ec
 *
zrs
 = &
key
->zrs;

2479 
zrs
->
mö
 = min;

2480 
zrs
->
max
 = max;

2481 
zrs
->
möex
 = minex;

2482 
zrs
->
maxex
 = maxex;

2484 i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2485 
key
->
zcuºít
 = 
fú°
 ? 
	`zzlFú°InR™ge
(key->
vÆue
->
±r
,
zrs
) :

2486 
	`zzlLa°InR™ge
(
key
->
vÆue
->
±r
,
zrs
);

2487 } i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2488 
z£t
 *
zs
 = 
key
->
vÆue
->
±r
;

2489 
zskùli°
 *
z¶
 = 
zs
->zsl;

2490 
key
->
zcuºít
 = 
fú°
 ? 
	`z¶Fú°InR™ge
(
z¶
,
zrs
) :

2491 
	`z¶La°InR™ge
(
z¶
,
zrs
);

2493 
	`£rvîP™ic
("Unsupported zsetÉncoding");

2495 i‡(
key
->
zcuºít
 =
NULL
Ëkey->
zî
 = 1;

2496  
REDISMODULE_OK
;

2497 
	}
}

2514 
	$RM_Z£tFú°InSc‹eR™ge
(
RedisModuÀKey
 *
key
, 
mö
, 
max
, 
möex
, 
maxex
) {

2515  
	`z£tInôSc‹eR™ge
(
key
,
mö
,
max
,
möex
,
maxex
,1);

2516 
	}
}

2520 
	$RM_Z£tLa°InSc‹eR™ge
(
RedisModuÀKey
 *
key
, 
mö
, 
max
, 
möex
, 
maxex
) {

2521  
	`z£tInôSc‹eR™ge
(
key
,
mö
,
max
,
möex
,
maxex
,0);

2522 
	}
}

2533 
	$z£tInôLexR™ge
(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
mö
, RedisModuÀSåög *
max
, 
fú°
) {

2534 i‡(!
key
->
vÆue
 || key->vÆue->
ty≥
 !
OBJ_ZSET
Ë 
REDISMODULE_ERR
;

2536 
	`RM_Z£tR™geSt›
(
key
);

2537 
key
->
zî
 = 0;

2541 
zÀxønge•ec
 *
zÃs
 = &
key
->zlrs;

2542 i‡(
	`z¶P¨£LexR™ge
(
mö
, 
max
, 
zÃs
Ë=
C_ERR
Ë 
REDISMODULE_ERR
;

2546 
key
->
zty≥
 = 
REDISMODULE_ZSET_RANGE_LEX
;

2548 i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2549 
key
->
zcuºít
 = 
fú°
 ? 
	`zzlFú°InLexR™ge
(key->
vÆue
->
±r
,
zÃs
) :

2550 
	`zzlLa°InLexR™ge
(
key
->
vÆue
->
±r
,
zÃs
);

2551 } i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2552 
z£t
 *
zs
 = 
key
->
vÆue
->
±r
;

2553 
zskùli°
 *
z¶
 = 
zs
->zsl;

2554 
key
->
zcuºít
 = 
fú°
 ? 
	`z¶Fú°InLexR™ge
(
z¶
,
zÃs
) :

2555 
	`z¶La°InLexR™ge
(
z¶
,
zÃs
);

2557 
	`£rvîP™ic
("Unsupported zsetÉncoding");

2559 i‡(
key
->
zcuºít
 =
NULL
Ëkey->
zî
 = 1;

2561  
REDISMODULE_OK
;

2562 
	}
}

2576 
	$RM_Z£tFú°InLexR™ge
(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
mö
, RedisModuÀSåög *
max
) {

2577  
	`z£tInôLexR™ge
(
key
,
mö
,
max
,1);

2578 
	}
}

2582 
	$RM_Z£tLa°InLexR™ge
(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
mö
, RedisModuÀSåög *
max
) {

2583  
	`z£tInôLexR™ge
(
key
,
mö
,
max
,0);

2584 
	}
}

2589 
RedisModuÀSåög
 *
	$RM_Z£tR™geCuºítEÀmít
(
RedisModuÀKey
 *
key
, *
sc‹e
) {

2590 
RedisModuÀSåög
 *
°r
;

2592 i‡(
key
->
zcuºít
 =
NULL
)  NULL;

2593 i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2594 *
ïå
, *
•å
;

2595 
ïå
 = 
key
->
zcuºít
;

2596 
sds
 
ñe
 = 
	`zùli°GëObje˘
(
ïå
);

2597 i‡(
sc‹e
) {

2598 
•å
 = 
	`zùli°Next
(
key
->
vÆue
->
±r
,
ïå
);

2599 *
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

2601 
°r
 = 
	`¸óãObje˘
(
OBJ_STRING
,
ñe
);

2602 } i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2603 
zskùli°Node
 *
 
 = 
key
->
zcuºít
;

2604 i‡(
sc‹e
Ë*sc‹ê
 
->score;

2605 
°r
 = 
	`¸óãSåögObje˘
(
 
->
ñe
,
	`sd¶í
(ln->ele));

2607 
	`£rvîP™ic
("Unsupported zsetÉncoding");

2609 
	`autoMem‹yAdd
(
key
->
˘x
,
REDISMODULE_AM_STRING
,
°r
);

2610  
°r
;

2611 
	}
}

2616 
	$RM_Z£tR™geNext
(
RedisModuÀKey
 *
key
) {

2617 i‡(!
key
->
zty≥
 || !key->
zcuºít
)  0;

2619 i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2620 *
zl
 = 
key
->
vÆue
->
±r
;

2621 *
ïå
 = 
key
->
zcuºít
;

2622 *
√xt
;

2623 
√xt
 = 
	`zùli°Next
(
zl
,
ïå
);

2624 i‡(
√xt
Ë√xà
	`zùli°Next
(
zl
,next);

2625 i‡(
√xt
 =
NULL
) {

2626 
key
->
zî
 = 1;

2630 i‡(
key
->
zty≥
 =
REDISMODULE_ZSET_RANGE_SCORE
) {

2633 *
ßved_√xt
 = 
√xt
;

2634 
√xt
 = 
	`zùli°Next
(
zl
,next);

2635 
sc‹e
 = 
	`zzlGëSc‹e
(
√xt
);

2636 i‡(!
	`z¶VÆueLãMax
(
sc‹e
,&
key
->
zrs
)) {

2637 
key
->
zî
 = 1;

2640 
√xt
 = 
ßved_√xt
;

2641 } i‡(
key
->
zty≥
 =
REDISMODULE_ZSET_RANGE_LEX
) {

2642 i‡(!
	`zzlLexVÆueLãMax
(
√xt
,&
key
->
zÃs
)) {

2643 
key
->
zî
 = 1;

2647 
key
->
zcuºít
 = 
√xt
;

2650 } i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2651 
zskùli°Node
 *
 
 = 
key
->
zcuºít
, *
√xt
 =Ün->
Àvñ
[0].
f‹w¨d
;

2652 i‡(
√xt
 =
NULL
) {

2653 
key
->
zî
 = 1;

2657 i‡(
key
->
zty≥
 =
REDISMODULE_ZSET_RANGE_SCORE
 &&

2658 !
	`z¶VÆueLãMax
(
√xt
->
sc‹e
,&
key
->
zrs
))

2660 
key
->
zî
 = 1;

2662 } i‡(
key
->
zty≥
 =
REDISMODULE_ZSET_RANGE_LEX
) {

2663 i‡(!
	`z¶LexVÆueLãMax
(
√xt
->
ñe
,&
key
->
zÃs
)) {

2664 
key
->
zî
 = 1;

2668 
key
->
zcuºít
 = 
√xt
;

2672 
	`£rvîP™ic
("Unsupported zsetÉncoding");

2674 
	}
}

2679 
	$RM_Z£tR™gePªv
(
RedisModuÀKey
 *
key
) {

2680 i‡(!
key
->
zty≥
 || !key->
zcuºít
)  0;

2682 i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2683 *
zl
 = 
key
->
vÆue
->
±r
;

2684 *
ïå
 = 
key
->
zcuºít
;

2685 *
¥ev
;

2686 
¥ev
 = 
	`zùli°Pªv
(
zl
,
ïå
);

2687 i‡(
¥ev
Ë¥ev = 
	`zùli°Pªv
(
zl
,prev);

2688 i‡(
¥ev
 =
NULL
) {

2689 
key
->
zî
 = 1;

2693 i‡(
key
->
zty≥
 =
REDISMODULE_ZSET_RANGE_SCORE
) {

2696 *
ßved_¥ev
 = 
¥ev
;

2697 
¥ev
 = 
	`zùli°Next
(
zl
,prev);

2698 
sc‹e
 = 
	`zzlGëSc‹e
(
¥ev
);

2699 i‡(!
	`z¶VÆueGãMö
(
sc‹e
,&
key
->
zrs
)) {

2700 
key
->
zî
 = 1;

2703 
¥ev
 = 
ßved_¥ev
;

2704 } i‡(
key
->
zty≥
 =
REDISMODULE_ZSET_RANGE_LEX
) {

2705 i‡(!
	`zzlLexVÆueGãMö
(
¥ev
,&
key
->
zÃs
)) {

2706 
key
->
zî
 = 1;

2710 
key
->
zcuºít
 = 
¥ev
;

2713 } i‡(
key
->
vÆue
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2714 
zskùli°Node
 *
 
 = 
key
->
zcuºít
, *
¥ev
 =Ün->
backw¨d
;

2715 i‡(
¥ev
 =
NULL
) {

2716 
key
->
zî
 = 1;

2720 i‡(
key
->
zty≥
 =
REDISMODULE_ZSET_RANGE_SCORE
 &&

2721 !
	`z¶VÆueGãMö
(
¥ev
->
sc‹e
,&
key
->
zrs
))

2723 
key
->
zî
 = 1;

2725 } i‡(
key
->
zty≥
 =
REDISMODULE_ZSET_RANGE_LEX
) {

2726 i‡(!
	`z¶LexVÆueGãMö
(
¥ev
->
ñe
,&
key
->
zÃs
)) {

2727 
key
->
zî
 = 1;

2731 
key
->
zcuºít
 = 
¥ev
;

2735 
	`£rvîP™ic
("Unsupported zsetÉncoding");

2737 
	}
}

2795 
	$RM_HashSë
(
RedisModuÀKey
 *
key
, 
Êags
, ...) {

2796 
va_li°
 
≠
;

2797 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
))  0;

2798 i‡(
key
->
vÆue
 && key->vÆue->
ty≥
 !
OBJ_HASH
)  0;

2799 i‡(
key
->
vÆue
 =
NULL
Ë
	`moduÀCª©eEm±yKey
(key,
REDISMODULE_KEYTYPE_HASH
);

2801 
upd©ed
 = 0;

2802 
	`va_°¨t
(
≠
, 
Êags
);

2804 
RedisModuÀSåög
 *
fõld
, *
vÆue
;

2806 i‡(
Êags
 & 
REDISMODULE_HASH_CFIELDS
) {

2807 *
cfõld
 = 
	`va_¨g
(
≠
,*);

2808 i‡(
cfõld
 =
NULL
) ;

2809 
fõld
 = 
	`¸óãRawSåögObje˘
(
cfõld
,
	`°æí
(cfield));

2811 
fõld
 = 
	`va_¨g
(
≠
,
RedisModuÀSåög
*);

2812 i‡(
fõld
 =
NULL
) ;

2814 
vÆue
 = 
	`va_¨g
(
≠
,
RedisModuÀSåög
*);

2817 i‡(
Êags
 & (
REDISMODULE_HASH_XX
|
REDISMODULE_HASH_NX
)) {

2818 
exi°s
 = 
	`hashTy≥Exi°s
(
key
->
vÆue
, 
fõld
->
±r
);

2819 i‡(((
Êags
 & 
REDISMODULE_HASH_XX
Ë&& !
exi°s
) ||

2820 ((
Êags
 & 
REDISMODULE_HASH_NX
Ë&& 
exi°s
))

2822 i‡(
Êags
 & 
REDISMODULE_HASH_CFIELDS
Ë
	`de¸RefCou¡
(
fõld
);

2828 i‡(
vÆue
 =
REDISMODULE_HASH_DELETE
) {

2829 
upd©ed
 +
	`hashTy≥Dñëe
(
key
->
vÆue
, 
fõld
->
±r
);

2830 i‡(
Êags
 & 
REDISMODULE_HASH_CFIELDS
Ë
	`de¸RefCou¡
(
fõld
);

2834 
low_Êags
 = 
HASH_SET_COPY
;

2838 i‡(
Êags
 & 
REDISMODULE_HASH_CFIELDS
)

2839 
low_Êags
 |
HASH_SET_TAKE_FIELD
;

2841 
robj
 *
¨gv
[2] = {
fõld
,
vÆue
};

2842 
	`hashTy≥TryC⁄vîsi⁄
(
key
->
vÆue
,
¨gv
,0,1);

2843 
upd©ed
 +
	`hashTy≥Së
(
key
->
vÆue
, 
fõld
->
±r
, vÆue->±r, 
low_Êags
);

2847 i‡(
Êags
 & 
REDISMODULE_HASH_CFIELDS
) {

2848 
fõld
->
±r
 = 
NULL
;

2849 
	`de¸RefCou¡
(
fõld
);

2852 
	`va_íd
(
≠
);

2853 
	`moduÀDñKeyIfEm±y
(
key
);

2854  
upd©ed
;

2855 
	}
}

2898 
	$RM_HashGë
(
RedisModuÀKey
 *
key
, 
Êags
, ...) {

2899 
va_li°
 
≠
;

2900 i‡(
key
->
vÆue
 && key->vÆue->
ty≥
 !
OBJ_HASH
Ë 
REDISMODULE_ERR
;

2902 
	`va_°¨t
(
≠
, 
Êags
);

2904 
RedisModuÀSåög
 *
fõld
, **
vÆuïå
;

2905 *
exi°•å
;

2907 i‡(
Êags
 & 
REDISMODULE_HASH_CFIELDS
) {

2908 *
cfõld
 = 
	`va_¨g
(
≠
,*);

2909 i‡(
cfõld
 =
NULL
) ;

2910 
fõld
 = 
	`¸óãRawSåögObje˘
(
cfõld
,
	`°æí
(cfield));

2912 
fõld
 = 
	`va_¨g
(
≠
,
RedisModuÀSåög
*);

2913 i‡(
fõld
 =
NULL
) ;

2917 i‡(
Êags
 & 
REDISMODULE_HASH_EXISTS
) {

2918 
exi°•å
 = 
	`va_¨g
(
≠
,*);

2919 i‡(
key
->
vÆue
)

2920 *
exi°•å
 = 
	`hashTy≥Exi°s
(
key
->
vÆue
,
fõld
->
±r
);

2922 *
exi°•å
 = 0;

2924 
vÆuïå
 = 
	`va_¨g
(
≠
,
RedisModuÀSåög
**);

2925 i‡(
key
->
vÆue
) {

2926 *
vÆuïå
 = 
	`hashTy≥GëVÆueObje˘
(
key
->
vÆue
,
fõld
->
±r
);

2927 i‡(*
vÆuïå
) {

2928 
robj
 *
decoded
 = 
	`gëDecodedObje˘
(*
vÆuïå
);

2929 
	`de¸RefCou¡
(*
vÆuïå
);

2930 *
vÆuïå
 = 
decoded
;

2932 i‡(*
vÆuïå
)

2933 
	`autoMem‹yAdd
(
key
->
˘x
,
REDISMODULE_AM_STRING
,*
vÆuïå
);

2935 *
vÆuïå
 = 
NULL
;

2940 i‡(
Êags
 & 
REDISMODULE_HASH_CFIELDS
Ë
	`de¸RefCou¡
(
fõld
);

2942 
	`va_íd
(
≠
);

2943  
REDISMODULE_OK
;

2944 
	}
}

2954 
RedisModuÀCÆlRïly
 *
	$moduÀCª©eCÆlRïlyFromPrŸo
(
RedisModuÀCtx
 *
˘x
, 
sds
 
¥Ÿo
) {

2955 
RedisModuÀCÆlRïly
 *
ª∂y
 = 
	`zmÆloc
((*reply));

2956 
ª∂y
->
˘x
 = ctx;

2957 
ª∂y
->
¥Ÿo
 =Öroto;

2958 
ª∂y
->
¥Ÿﬁí
 = 
	`sd¶í
(
¥Ÿo
);

2959 
ª∂y
->
Êags
 = 
REDISMODULE_REPLYFLAG_TOPARSE
;

2960 
¥Ÿo
[0]) {

2962 '+': 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_STRING
; ;

2963 '-': 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_ERROR
; ;

2964 ':': 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_INTEGER
; ;

2965 '*': 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_ARRAY
; ;

2966 : 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_UNKNOWN
; ;

2968 i‡((
¥Ÿo
[0] == '*' ||Öroto[0] == '$') &&Öroto[1] == '-')

2969 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_NULL
;

2970  
ª∂y
;

2971 
	}
}

2973 
moduÀP¨£CÆlRïly_I¡
(
RedisModuÀCÆlRïly
 *
ª∂y
);

2974 
moduÀP¨£CÆlRïly_BulkSåög
(
RedisModuÀCÆlRïly
 *
ª∂y
);

2975 
moduÀP¨£CÆlRïly_Sim∂eSåög
(
RedisModuÀCÆlRïly
 *
ª∂y
);

2976 
moduÀP¨£CÆlRïly_Aºay
(
RedisModuÀCÆlRïly
 *
ª∂y
);

2981 
	$moduÀP¨£CÆlRïly
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

2982 i‡(!(
ª∂y
->
Êags
 & 
REDISMODULE_REPLYFLAG_TOPARSE
)) ;

2983 
ª∂y
->
Êags
 &~
REDISMODULE_REPLYFLAG_TOPARSE
;

2985 
ª∂y
->
¥Ÿo
[0]) {

2986 ':': 
	`moduÀP¨£CÆlRïly_I¡
(
ª∂y
); ;

2987 '$': 
	`moduÀP¨£CÆlRïly_BulkSåög
(
ª∂y
); ;

2989 '+': 
	`moduÀP¨£CÆlRïly_Sim∂eSåög
(
ª∂y
); ;

2990 '*': 
	`moduÀP¨£CÆlRïly_Aºay
(
ª∂y
); ;

2992 
	}
}

2994 
	$moduÀP¨£CÆlRïly_I¡
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

2995 *
¥Ÿo
 = 
ª∂y
->proto;

2996 *
p
 = 
	`°rchr
(
¥Ÿo
+1,'\r');

2998 
	`°rög2Œ
(
¥Ÿo
+1,
p
-¥Ÿo-1,&
ª∂y
->
vÆ
.
Œ
);

2999 
ª∂y
->
¥Ÿﬁí
 = 
p
-
¥Ÿo
+2;

3000 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_INTEGER
;

3001 
	}
}

3003 
	$moduÀP¨£CÆlRïly_BulkSåög
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

3004 *
¥Ÿo
 = 
ª∂y
->proto;

3005 *
p
 = 
	`°rchr
(
¥Ÿo
+1,'\r');

3006 
bulkÀn
;

3008 
	`°rög2Œ
(
¥Ÿo
+1,
p
-¥Ÿo-1,&
bulkÀn
);

3009 i‡(
bulkÀn
 == -1) {

3010 
ª∂y
->
¥Ÿﬁí
 = 
p
-
¥Ÿo
+2;

3011 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_NULL
;

3013 
ª∂y
->
vÆ
.
°r
 = 
p
+2;

3014 
ª∂y
->
Àn
 = 
bulkÀn
;

3015 
ª∂y
->
¥Ÿﬁí
 = 
p
-
¥Ÿo
+2+
bulkÀn
+2;

3016 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_STRING
;

3018 
	}
}

3020 
	$moduÀP¨£CÆlRïly_Sim∂eSåög
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

3021 *
¥Ÿo
 = 
ª∂y
->proto;

3022 *
p
 = 
	`°rchr
(
¥Ÿo
+1,'\r');

3024 
ª∂y
->
vÆ
.
°r
 = 
¥Ÿo
+1;

3025 
ª∂y
->
Àn
 = 
p
-
¥Ÿo
-1;

3026 
ª∂y
->
¥Ÿﬁí
 = 
p
-
¥Ÿo
+2;

3027 
ª∂y
->
ty≥
 = 
¥Ÿo
[0] ='+' ? 
REDISMODULE_REPLY_STRING
 :

3028 
REDISMODULE_REPLY_ERROR
;

3029 
	}
}

3031 
	$moduÀP¨£CÆlRïly_Aºay
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

3032 *
¥Ÿo
 = 
ª∂y
->proto;

3033 *
p
 = 
	`°rchr
(
¥Ÿo
+1,'\r');

3034 
¨øyÀn
, 
j
;

3036 
	`°rög2Œ
(
¥Ÿo
+1,
p
-¥Ÿo-1,&
¨øyÀn
);

3037 
p
 += 2;

3039 i‡(
¨øyÀn
 == -1) {

3040 
ª∂y
->
¥Ÿﬁí
 = 
p
-
¥Ÿo
;

3041 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_NULL
;

3045 
ª∂y
->
vÆ
.
¨øy
 = 
	`zmÆloc
((
RedisModuÀCÆlRïly
)*
¨øyÀn
);

3046 
ª∂y
->
Àn
 = 
¨øyÀn
;

3047 
j
 = 0; j < 
¨øyÀn
; j++) {

3048 
RedisModuÀCÆlRïly
 *
ñe
 = 
ª∂y
->
vÆ
.
¨øy
+
j
;

3049 
ñe
->
Êags
 = 
REDISMODULE_REPLYFLAG_NESTED
 |

3050 
REDISMODULE_REPLYFLAG_TOPARSE
;

3051 
ñe
->
¥Ÿo
 = 
p
;

3052 
ñe
->
˘x
 = 
ª∂y
->ctx;

3053 
	`moduÀP¨£CÆlRïly
(
ñe
);

3054 
p
 +
ñe
->
¥Ÿﬁí
;

3056 
ª∂y
->
¥Ÿﬁí
 = 
p
-
¥Ÿo
;

3057 
ª∂y
->
ty≥
 = 
REDISMODULE_REPLY_ARRAY
;

3058 
	}
}

3062 
	$RM_FªeCÆlRïly_Rec
(
RedisModuÀCÆlRïly
 *
ª∂y
, 
‰ì√°ed
){

3066 i‡(!
‰ì√°ed
 && 
ª∂y
->
Êags
 & 
REDISMODULE_REPLYFLAG_NESTED
) ;

3068 i‡(!(
ª∂y
->
Êags
 & 
REDISMODULE_REPLYFLAG_TOPARSE
)) {

3069 i‡(
ª∂y
->
ty≥
 =
REDISMODULE_REPLY_ARRAY
) {

3070 
size_t
 
j
;

3071 
j
 = 0; j < 
ª∂y
->
Àn
; j++)

3072 
	`RM_FªeCÆlRïly_Rec
(
ª∂y
->
vÆ
.
¨øy
+
j
,1);

3073 
	`z‰ì
(
ª∂y
->
vÆ
.
¨øy
);

3081 i‡(!(
ª∂y
->
Êags
 & 
REDISMODULE_REPLYFLAG_NESTED
)) {

3082 i‡(
ª∂y
->
¥Ÿo
Ë
	`sds‰ì
(reply->proto);

3083 
	`z‰ì
(
ª∂y
);

3085 
	}
}

3090 
	$RM_FªeCÆlRïly
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

3092 
RedisModuÀCtx
 *
˘x
 = 
ª∂y
->ctx;

3093 
	`RM_FªeCÆlRïly_Rec
(
ª∂y
,0);

3094 
	`autoMem‹yFªed
(
˘x
,
REDISMODULE_AM_REPLY
,
ª∂y
);

3095 
	}
}

3098 
	$RM_CÆlRïlyTy≥
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

3099 i‡(!
ª∂y
Ë 
REDISMODULE_REPLY_UNKNOWN
;

3100  
ª∂y
->
ty≥
;

3101 
	}
}

3104 
size_t
 
	$RM_CÆlRïlyLígth
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

3105 
	`moduÀP¨£CÆlRïly
(
ª∂y
);

3106 
ª∂y
->
ty≥
) {

3107 
REDISMODULE_REPLY_STRING
:

3108 
REDISMODULE_REPLY_ERROR
:

3109 
REDISMODULE_REPLY_ARRAY
:

3110  
ª∂y
->
Àn
;

3114 
	}
}

3118 
RedisModuÀCÆlRïly
 *
	$RM_CÆlRïlyAºayEÀmít
(
RedisModuÀCÆlRïly
 *
ª∂y
, 
size_t
 
idx
) {

3119 
	`moduÀP¨£CÆlRïly
(
ª∂y
);

3120 i‡(
ª∂y
->
ty≥
 !
REDISMODULE_REPLY_ARRAY
Ë 
NULL
;

3121 i‡(
idx
 >
ª∂y
->
Àn
Ë 
NULL
;

3122  
ª∂y
->
vÆ
.
¨øy
+
idx
;

3123 
	}
}

3126 
	$RM_CÆlRïlyI¡egî
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

3127 
	`moduÀP¨£CÆlRïly
(
ª∂y
);

3128 i‡(
ª∂y
->
ty≥
 !
REDISMODULE_REPLY_INTEGER
Ë 
LLONG_MIN
;

3129  
ª∂y
->
vÆ
.
Œ
;

3130 
	}
}

3133 c⁄° *
	$RM_CÆlRïlySåögPå
(
RedisModuÀCÆlRïly
 *
ª∂y
, 
size_t
 *
Àn
) {

3134 
	`moduÀP¨£CÆlRïly
(
ª∂y
);

3135 i‡(
ª∂y
->
ty≥
 !
REDISMODULE_REPLY_STRING
 &&

3136 
ª∂y
->
ty≥
 !
REDISMODULE_REPLY_ERROR
Ë 
NULL
;

3137 i‡(
Àn
Ë*À¿
ª∂y
->len;

3138  
ª∂y
->
vÆ
.
°r
;

3139 
	}
}

3143 
RedisModuÀSåög
 *
	$RM_Cª©eSåögFromCÆlRïly
(
RedisModuÀCÆlRïly
 *
ª∂y
) {

3144 
	`moduÀP¨£CÆlRïly
(
ª∂y
);

3145 
ª∂y
->
ty≥
) {

3146 
REDISMODULE_REPLY_STRING
:

3147 
REDISMODULE_REPLY_ERROR
:

3148  
	`RM_Cª©eSåög
(
ª∂y
->
˘x
,ª∂y->
vÆ
.
°r
,ª∂y->
Àn
);

3149 
REDISMODULE_REPLY_INTEGER
: {

3150 
buf
[64];

3151 
Àn
 = 
	`Œ2°rög
(
buf
,(buf),
ª∂y
->
vÆ
.
Œ
);

3152  
	`RM_Cª©eSåög
(
ª∂y
->
˘x
,
buf
,
Àn
);

3154 :  
NULL
;

3156 
	}
}

3171 
robj
 **
	$moduÀCª©eArgvFromU£rF‹m©
(c⁄° *
cmd«me
, c⁄° *
fmt
, *
¨g˝
, *
Êags
, 
va_li°
 
≠
) {

3172 
¨gc
 = 0, 
¨gv_size
, 
j
;

3173 
robj
 **
¨gv
 = 
NULL
;

3177 
¨gv_size
 = 
	`°æí
(
fmt
)+1;

3178 
¨gv
 = 
	`zªÆloc
◊rgv,(
robj
*)*
¨gv_size
);

3181 
¨gv
[0] = 
	`¸óãSåögObje˘
(
cmd«me
,
	`°æí
(cmdname));

3182 
¨gc
++;

3185 c⁄° *
p
 = 
fmt
;

3186 *
p
) {

3187 i‡(*
p
 == 'c') {

3188 *
c°r
 = 
	`va_¨g
(
≠
,*);

3189 
¨gv
[
¨gc
++] = 
	`¸óãSåögObje˘
(
c°r
,
	`°æí
(cstr));

3190 } i‡(*
p
 == 's') {

3191 
robj
 *
obj
 = 
	`va_¨g
(
≠
,*);

3192 
¨gv
[
¨gc
++] = 
obj
;

3193 
	`ö¸RefCou¡
(
obj
);

3194 } i‡(*
p
 == 'b') {

3195 *
buf
 = 
	`va_¨g
(
≠
,*);

3196 
size_t
 
Àn
 = 
	`va_¨g
(
≠
,size_t);

3197 
¨gv
[
¨gc
++] = 
	`¸óãSåögObje˘
(
buf
,
Àn
);

3198 } i‡(*
p
 == 'l') {

3199 
Œ
 = 
	`va_¨g
(
≠
,);

3200 
¨gv
[
¨gc
++] = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sds‰oml⁄gl⁄g
(
Œ
));

3201 } i‡(*
p
 == 'v') {

3203 
robj
 **
v
 = 
	`va_¨g
(
≠
, *);

3204 
size_t
 
vÀn
 = 
	`va_¨g
(
≠
, size_t);

3209 
¨gv_size
 +
vÀn
-1;

3210 
¨gv
 = 
	`zªÆloc
◊rgv,(
robj
*)*
¨gv_size
);

3212 
size_t
 
i
 = 0;

3213 
i
 = 0; i < 
vÀn
; i++) {

3214 
	`ö¸RefCou¡
(
v
[
i
]);

3215 
¨gv
[
¨gc
++] = 
v
[
i
];

3217 } i‡(*
p
 == '!') {

3218 i‡(
Êags
Ë(*ÊagsË|
REDISMODULE_ARGV_REPLICATE
;

3219 } i‡(*
p
 == 'A') {

3220 i‡(
Êags
Ë(*ÊagsË|
REDISMODULE_ARGV_NO_AOF
;

3221 } i‡(*
p
 == 'R') {

3222 i‡(
Êags
Ë(*ÊagsË|
REDISMODULE_ARGV_NO_REPLICAS
;

3224 
fmãº
;

3226 
p
++;

3228 *
¨g˝
 = 
¨gc
;

3229  
¨gv
;

3231 
fmãº
:

3232 
j
 = 0; j < 
¨gc
; j++)

3233 
	`de¸RefCou¡
(
¨gv
[
j
]);

3234 
	`z‰ì
(
¨gv
);

3235  
NULL
;

3236 
	}
}

3252 
RedisModuÀCÆlRïly
 *
	$RM_CÆl
(
RedisModuÀCtx
 *
˘x
, c⁄° *
cmd«me
, c⁄° *
fmt
, ...) {

3253 
ªdisComm™d
 *
cmd
;

3254 
˛õ¡
 *
c
 = 
NULL
;

3255 
robj
 **
¨gv
 = 
NULL
;

3256 
¨gc
 = 0, 
Êags
 = 0;

3257 
va_li°
 
≠
;

3258 
RedisModuÀCÆlRïly
 *
ª∂y
 = 
NULL
;

3259 
ª∂iˇã
 = 0;

3262 
	`va_°¨t
(
≠
, 
fmt
);

3263 
c
 = 
	`¸óãClõ¡
(
NULL
);

3264 
c
->
u£r
 = 
NULL
;

3265 
¨gv
 = 
	`moduÀCª©eArgvFromU£rF‹m©
(
cmd«me
,
fmt
,&
¨gc
,&
Êags
,
≠
);

3266 
ª∂iˇã
 = 
Êags
 & 
REDISMODULE_ARGV_REPLICATE
;

3267 
	`va_íd
(
≠
);

3270 
c
->
Êags
 |
CLIENT_MODULE
;

3271 
c
->
db
 = 
˘x
->
˛õ¡
->db;

3272 
c
->
¨gv
 =árgv;

3273 
c
->
¨gc
 =árgc;

3274 i‡(
˘x
->
moduÀ
Ë˘x->moduÀ->
ö_ˇŒ
++;

3278 i‡(
¨gv
 =
NULL
) {

3279 
î∫o
 = 
EBADF
;

3280 
˛ónup
;

3284 
	`moduÀCÆlComm™dFûãrs
(
c
);

3289 
cmd
 = 
	`lookupComm™d
(
c
->
¨gv
[0]->
±r
);

3290 i‡(!
cmd
) {

3291 
î∫o
 = 
ENOENT
;

3292 
˛ónup
;

3294 
c
->
cmd
 = c->
œ°cmd
 = cmd;

3297 i‡((
cmd
->
¨ôy
 > 0 && cmd->¨ôy !
¨gc
) || (argc < -cmd->arity)) {

3298 
î∫o
 = 
EINVAL
;

3299 
˛ónup
;

3305 i‡(
£rvî
.
˛u°î_íabÀd
 && !(
˘x
->
˛õ¡
->
Êags
 & 
CLIENT_MASTER
)) {

3306 
îr‹_code
;

3308 
c
->
Êags
 &~(
CLIENT_READONLY
|
CLIENT_ASKING
);

3309 
c
->
Êags
 |
˘x
->
˛õ¡
->Êag†& (
CLIENT_READONLY
|
CLIENT_ASKING
);

3310 i‡(
	`gëNodeByQuîy
(
c
,c->
cmd
,c->
¨gv
,c->
¨gc
,
NULL
,&
îr‹_code
) !=

3311 
£rvî
.
˛u°î
->
my£lf
)

3313 i‡(
îr‹_code
 =
CLUSTER_REDIR_DOWN_RO_STATE
) {

3314 
î∫o
 = 
EROFS
;

3315 } i‡(
îr‹_code
 =
CLUSTER_REDIR_DOWN_STATE
) {

3316 
î∫o
 = 
ENETDOWN
;

3318 
î∫o
 = 
EPERM
;

3320 
˛ónup
;

3327 i‡(
ª∂iˇã
Ë
	`moduÀRïliˇãMu…iIfNìded
(
˘x
);

3330 
ˇŒ_Êags
 = 
CMD_CALL_SLOWLOG
 | 
CMD_CALL_STATS
 | 
CMD_CALL_NOWRAP
;

3331 i‡(
ª∂iˇã
) {

3332 i‡(!(
Êags
 & 
REDISMODULE_ARGV_NO_AOF
))

3333 
ˇŒ_Êags
 |
CMD_CALL_PROPAGATE_AOF
;

3334 i‡(!(
Êags
 & 
REDISMODULE_ARGV_NO_REPLICAS
))

3335 
ˇŒ_Êags
 |
CMD_CALL_PROPAGATE_REPL
;

3337 
	`ˇŒ
(
c
,
ˇŒ_Êags
);

3340 
sds
 
¥Ÿo
 = 
	`sd¢ewÀn
(
c
->
buf
,c->
buÂos
);

3341 
c
->
buÂos
 = 0;

3342 
	`li°Lígth
(
c
->
ª∂y
)) {

3343 
˛õ¡RïlyBlock
 *
o
 = 
	`li°NodeVÆue
(
	`li°Fú°
(
c
->
ª∂y
));

3345 
¥Ÿo
 = 
	`sdsˇéí
’rŸo,
o
->
buf
,o->
u£d
);

3346 
	`li°DñNode
(
c
->
ª∂y
,
	`li°Fú°
(c->reply));

3348 
ª∂y
 = 
	`moduÀCª©eCÆlRïlyFromPrŸo
(
˘x
,
¥Ÿo
);

3349 
	`autoMem‹yAdd
(
˘x
,
REDISMODULE_AM_REPLY
,
ª∂y
);

3351 
˛ónup
:

3352 i‡(
˘x
->
moduÀ
Ë˘x->moduÀ->
ö_ˇŒ
--;

3353 
	`‰ìClõ¡
(
c
);

3354  
ª∂y
;

3355 
	}
}

3359 c⁄° *
	$RM_CÆlRïlyPrŸo
(
RedisModuÀCÆlRïly
 *
ª∂y
, 
size_t
 *
Àn
) {

3360 i‡(
ª∂y
->
¥Ÿo
Ë*
Àn
 = 
	`sd¶í
(reply->proto);

3361  
ª∂y
->
¥Ÿo
;

3362 
	}
}

3397 c⁄° *
	gModuÀTy≥NameCh¨Së
 =

3402 
uöt64_t
 
	$moduÀTy≥EncodeId
(c⁄° *
«me
, 
ícvî
) {

3405 c⁄° *
c£t
 = 
ModuÀTy≥NameCh¨Së
;

3406 i‡(
	`°æí
(
«me
) != 9)  0;

3407 i‡(
ícvî
 < 0 ||Éncver > 1023)  0;

3409 
uöt64_t
 
id
 = 0;

3410 
j
 = 0; j < 9; j++) {

3411 *
p
 = 
	`°rchr
(
c£t
,
«me
[
j
]);

3412 i‡(!
p
)  0;

3413 
pos
 = 
p
-
c£t
;

3414 
id
 = (id << 6Ë| 
pos
;

3416 
id
 = (id << 10Ë| 
ícvî
;

3417  
id
;

3418 
	}
}

3423 
moduÀTy≥
 *
	$moduÀTy≥LookupModuÀByName
(c⁄° *
«me
) {

3424 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
moduÀs
);

3425 
di˘E¡ry
 *
de
;

3427 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3428 
RedisModuÀ
 *
moduÀ
 = 
	`di˘GëVÆ
(
de
);

3429 
li°Iãr
 
li
;

3430 
li°Node
 *
 
;

3432 
	`li°Rewöd
(
moduÀ
->
ty≥s
,&
li
);

3433 (
 
 = 
	`li°Next
(&
li
))) {

3434 
moduÀTy≥
 *
mt
 = 
 
->
vÆue
;

3435 i‡(
	`memcmp
(
«me
,
mt
->name,(mt->name)) == 0) {

3436 
	`di˘Rñó£Iãøt‹
(
di
);

3437  
mt
;

3441 
	`di˘Rñó£Iãøt‹
(
di
);

3442  
NULL
;

3443 
	}
}

3448 
	#MODULE_LOOKUP_CACHE_SIZE
 3

	)

3450 
moduÀTy≥
 *
	$moduÀTy≥LookupModuÀByID
(
uöt64_t
 
id
) {

3452 
uöt64_t
 
id
;

3453 
moduÀTy≥
 *
mt
;

3454 } 
ˇche
[
MODULE_LOOKUP_CACHE_SIZE
];

3457 
j
;

3458 
j
 = 0; j < 
MODULE_LOOKUP_CACHE_SIZE
 && 
ˇche
[j].
mt
 !
NULL
; j++)

3459 i‡(
ˇche
[
j
].
id
 =idË cache[j].
mt
;

3462 
moduÀTy≥
 *
mt
 = 
NULL
;

3463 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
moduÀs
);

3464 
di˘E¡ry
 *
de
;

3466 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
 && 
mt
 == NULL) {

3467 
RedisModuÀ
 *
moduÀ
 = 
	`di˘GëVÆ
(
de
);

3468 
li°Iãr
 
li
;

3469 
li°Node
 *
 
;

3471 
	`li°Rewöd
(
moduÀ
->
ty≥s
,&
li
);

3472 (
 
 = 
	`li°Next
(&
li
))) {

3473 
moduÀTy≥
 *
this_mt
 = 
 
->
vÆue
;

3476 i‡(
this_mt
->
id
 >> 10 == id >> 10) {

3477 
mt
 = 
this_mt
;

3482 
	`di˘Rñó£Iãøt‹
(
di
);

3485 i‡(
mt
 && 
j
 < 
MODULE_LOOKUP_CACHE_SIZE
) {

3486 
ˇche
[
j
].
id
 = id;

3487 
ˇche
[
j
].
mt
 = mt;

3489  
mt
;

3490 
	}
}

3496 
	$moduÀTy≥NameByID
(*
«me
, 
uöt64_t
 
moduÀid
) {

3497 c⁄° *
c£t
 = 
ModuÀTy≥NameCh¨Së
;

3499 
«me
[9] = '\0';

3500 *
p
 = 
«me
+8;

3501 
moduÀid
 >>= 10;

3502 
j
 = 0; j < 9; j++) {

3503 *
p
-- = 
c£t
[
moduÀid
 & 63];

3504 
moduÀid
 >>= 6;

3506 
	}
}

3578 
moduÀTy≥
 *
	$RM_Cª©eD©aTy≥
(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
ícvî
, *
ty≥mëhods_±r
) {

3579 
uöt64_t
 
id
 = 
	`moduÀTy≥EncodeId
(
«me
,
ícvî
);

3580 i‡(
id
 =0Ë 
NULL
;

3581 i‡(
	`moduÀTy≥LookupModuÀByName
(
«me
Ë!
NULL
)  NULL;

3583 
ty≥mëhods_vîsi⁄
 = ((*)
ty≥mëhods_±r
)[0];

3584 i‡(
ty≥mëhods_vîsi⁄
 =0Ë 
NULL
;

3586 
	sty≥mëhods
 {

3587 
uöt64_t
 
vîsi⁄
;

3588 
moduÀTy≥LﬂdFunc
 
rdb_lﬂd
;

3589 
moduÀTy≥SaveFunc
 
rdb_ßve
;

3590 
moduÀTy≥RewrôeFunc
 
aof_ªwrôe
;

3591 
moduÀTy≥MemUßgeFunc
 
mem_ußge
;

3592 
moduÀTy≥Dige°Func
 
dige°
;

3593 
moduÀTy≥FªeFunc
 
‰ì
;

3595 
moduÀTy≥AuxLﬂdFunc
 
aux_lﬂd
;

3596 
moduÀTy≥AuxSaveFunc
 
aux_ßve
;

3597 
aux_ßve_åiggîs
;

3598 } 
v2
;

3599 } *
tms
 = (
ty≥mëhods
*Ë
ty≥mëhods_±r
;

3601 
moduÀTy≥
 *
mt
 = 
	`zˇŒoc
((*mt));

3602 
mt
->
id
 = id;

3603 
mt
->
moduÀ
 = 
˘x
->module;

3604 
mt
->
rdb_lﬂd
 = 
tms
->rdb_load;

3605 
mt
->
rdb_ßve
 = 
tms
->rdb_save;

3606 
mt
->
aof_ªwrôe
 = 
tms
->aof_rewrite;

3607 
mt
->
mem_ußge
 = 
tms
->mem_usage;

3608 
mt
->
dige°
 = 
tms
->digest;

3609 
mt
->
‰ì
 = 
tms
->free;

3610 i‡(
tms
->
vîsi⁄
 >= 2) {

3611 
mt
->
aux_lﬂd
 = 
tms
->
v2
.aux_load;

3612 
mt
->
aux_ßve
 = 
tms
->
v2
.aux_save;

3613 
mt
->
aux_ßve_åiggîs
 = 
tms
->
v2
.aux_save_triggers;

3615 
	`mem˝y
(
mt
->
«me
,name,(mt->name));

3616 
	`li°AddNodeTaû
(
˘x
->
moduÀ
->
ty≥s
,
mt
);

3617  
mt
;

3618 
	}
}

3624 
	$RM_ModuÀTy≥SëVÆue
(
RedisModuÀKey
 *
key
, 
moduÀTy≥
 *
mt
, *
vÆue
) {

3625 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
Ë|| key->
ôî
Ë 
REDISMODULE_ERR
;

3626 
	`RM_DñëeKey
(
key
);

3627 
robj
 *
o
 = 
	`¸óãModuÀObje˘
(
mt
,
vÆue
);

3628 
	`gíîicSëKey
(
key
->
˘x
->
˛õ¡
,key->
db
,key->key,
o
,0,0);

3629 
	`de¸RefCou¡
(
o
);

3630 
key
->
vÆue
 = 
o
;

3631  
REDISMODULE_OK
;

3632 
	}
}

3639 
moduÀTy≥
 *
	$RM_ModuÀTy≥GëTy≥
(
RedisModuÀKey
 *
key
) {

3640 i‡(
key
 =
NULL
 ||

3641 
key
->
vÆue
 =
NULL
 ||

3642 
	`RM_KeyTy≥
(
key
Ë!
REDISMODULE_KEYTYPE_MODULE
Ë 
NULL
;

3643 
moduÀVÆue
 *
mv
 = 
key
->
vÆue
->
±r
;

3644  
mv
->
ty≥
;

3645 
	}
}

3653 *
	$RM_ModuÀTy≥GëVÆue
(
RedisModuÀKey
 *
key
) {

3654 i‡(
key
 =
NULL
 ||

3655 
key
->
vÆue
 =
NULL
 ||

3656 
	`RM_KeyTy≥
(
key
Ë!
REDISMODULE_KEYTYPE_MODULE
Ë 
NULL
;

3657 
moduÀVÆue
 *
mv
 = 
key
->
vÆue
->
±r
;

3658  
mv
->
vÆue
;

3659 
	}
}

3668 
	$moduÀRDBLﬂdEº‹
(
RedisModuÀIO
 *
io
) {

3669 i‡(
io
->
ty≥
->
moduÀ
->
›ti⁄s
 & 
REDISMODULE_OPTIONS_HANDLE_IO_ERRORS
) {

3670 
io
->
îr‹
 = 1;

3673 
	`£rvîP™ic
(

3678 
io
->
ty≥
->
moduÀ
->
«me
,

3679 
io
->
ty≥
->
«me
,

3680 ()
io
->
byãs
,

3681 
io
->
key
? (*)io->key->
±r
: "(null)");

3682 
	}
}

3687 
	$moduÀAŒD©©y≥sH™dÀEº‹s
() {

3688 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
moduÀs
);

3689 
di˘E¡ry
 *
de
;

3691 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3692 
RedisModuÀ
 *
moduÀ
 = 
	`di˘GëVÆ
(
de
);

3693 i‡(
	`li°Lígth
(
moduÀ
->
ty≥s
) &&

3694 !(
moduÀ
->
›ti⁄s
 & 
REDISMODULE_OPTIONS_HANDLE_IO_ERRORS
))

3696 
	`di˘Rñó£Iãøt‹
(
di
);

3700 
	`di˘Rñó£Iãøt‹
(
di
);

3702 
	}
}

3707 
	$RM_IsIOEº‹
(
RedisModuÀIO
 *
io
) {

3708  
io
->
îr‹
;

3709 
	}
}

3714 
	$RM_SaveUnsig√d
(
RedisModuÀIO
 *
io
, 
uöt64_t
 
vÆue
) {

3715 i‡(
io
->
îr‹
) ;

3717 
ªtvÆ
 = 
	`rdbSaveLí
(
io
->
rio
, 
RDB_MODULE_OPCODE_UINT
);

3718 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3719 
io
->
byãs
 +
ªtvÆ
;

3721 
ªtvÆ
 = 
	`rdbSaveLí
(
io
->
rio
, 
vÆue
);

3722 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3723 
io
->
byãs
 +
ªtvÆ
;

3726 
ßvìº
:

3727 
io
->
îr‹
 = 1;

3728 
	}
}

3733 
uöt64_t
 
	$RM_LﬂdUnsig√d
(
RedisModuÀIO
 *
io
) {

3734 i‡(
io
->
îr‹
)  0;

3735 i‡(
io
->
vî
 == 2) {

3736 
uöt64_t
 
›code
 = 
	`rdbLﬂdLí
(
io
->
rio
,
NULL
);

3737 i‡(
›code
 !
RDB_MODULE_OPCODE_UINT
Ë
lﬂdîr
;

3739 
uöt64_t
 
vÆue
;

3740 
ªtvÆ
 = 
	`rdbLﬂdLíByRef
(
io
->
rio
, 
NULL
, &
vÆue
);

3741 i‡(
ªtvÆ
 =-1Ë
lﬂdîr
;

3742  
vÆue
;

3744 
lﬂdîr
:

3745 
	`moduÀRDBLﬂdEº‹
(
io
);

3747 
	}
}

3750 
	$RM_SaveSig√d
(
RedisModuÀIO
 *
io
, 
öt64_t
 
vÆue
) {

3751 uni⁄ {
uöt64_t
 
u
; 
öt64_t
 
i
;} 
c⁄v
;

3752 
c⁄v
.
i
 = 
vÆue
;

3753 
	`RM_SaveUnsig√d
(
io
,
c⁄v
.
u
);

3754 
	}
}

3757 
öt64_t
 
	$RM_LﬂdSig√d
(
RedisModuÀIO
 *
io
) {

3758 uni⁄ {
uöt64_t
 
u
; 
öt64_t
 
i
;} 
c⁄v
;

3759 
c⁄v
.
u
 = 
	`RM_LﬂdUnsig√d
(
io
);

3760  
c⁄v
.
i
;

3761 
	}
}

3769 
	$RM_SaveSåög
(
RedisModuÀIO
 *
io
, 
RedisModuÀSåög
 *
s
) {

3770 i‡(
io
->
îr‹
) ;

3772 
ssize_t
 
ªtvÆ
 = 
	`rdbSaveLí
(
io
->
rio
, 
RDB_MODULE_OPCODE_STRING
);

3773 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3774 
io
->
byãs
 +
ªtvÆ
;

3776 
ªtvÆ
 = 
	`rdbSaveSåögObje˘
(
io
->
rio
, 
s
);

3777 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3778 
io
->
byãs
 +
ªtvÆ
;

3781 
ßvìº
:

3782 
io
->
îr‹
 = 1;

3783 
	}
}

3787 
	$RM_SaveSåögBuf„r
(
RedisModuÀIO
 *
io
, c⁄° *
°r
, 
size_t
 
Àn
) {

3788 i‡(
io
->
îr‹
) ;

3790 
ssize_t
 
ªtvÆ
 = 
	`rdbSaveLí
(
io
->
rio
, 
RDB_MODULE_OPCODE_STRING
);

3791 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3792 
io
->
byãs
 +
ªtvÆ
;

3794 
ªtvÆ
 = 
	`rdbSaveRawSåög
(
io
->
rio
, (*)
°r
,
Àn
);

3795 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3796 
io
->
byãs
 +
ªtvÆ
;

3799 
ßvìº
:

3800 
io
->
îr‹
 = 1;

3801 
	}
}

3804 *
	$moduÀLﬂdSåög
(
RedisModuÀIO
 *
io
, 
∂aö
, 
size_t
 *
À≈å
) {

3805 i‡(
io
->
îr‹
Ë 
NULL
;

3806 i‡(
io
->
vî
 == 2) {

3807 
uöt64_t
 
›code
 = 
	`rdbLﬂdLí
(
io
->
rio
,
NULL
);

3808 i‡(
›code
 !
RDB_MODULE_OPCODE_STRING
Ë
lﬂdîr
;

3810 *
s
 = 
	`rdbGíîicLﬂdSåögObje˘
(
io
->
rio
,

3811 
∂aö
 ? 
RDB_LOAD_PLAIN
 : 
RDB_LOAD_NONE
, 
À≈å
);

3812 i‡(
s
 =
NULL
Ë
lﬂdîr
;

3813  
s
;

3815 
lﬂdîr
:

3816 
	`moduÀRDBLﬂdEº‹
(
io
);

3817  
NULL
;

3818 
	}
}

3829 
RedisModuÀSåög
 *
	$RM_LﬂdSåög
(
RedisModuÀIO
 *
io
) {

3830  
	`moduÀLﬂdSåög
(
io
,0,
NULL
);

3831 
	}
}

3840 *
	$RM_LﬂdSåögBuf„r
(
RedisModuÀIO
 *
io
, 
size_t
 *
À≈å
) {

3841  
	`moduÀLﬂdSåög
(
io
,1,
À≈å
);

3842 
	}
}

3847 
	$RM_SaveDoubÀ
(
RedisModuÀIO
 *
io
, 
vÆue
) {

3848 i‡(
io
->
îr‹
) ;

3850 
ªtvÆ
 = 
	`rdbSaveLí
(
io
->
rio
, 
RDB_MODULE_OPCODE_DOUBLE
);

3851 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3852 
io
->
byãs
 +
ªtvÆ
;

3854 
ªtvÆ
 = 
	`rdbSaveBö¨yDoubÀVÆue
(
io
->
rio
, 
vÆue
);

3855 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3856 
io
->
byãs
 +
ªtvÆ
;

3859 
ßvìº
:

3860 
io
->
îr‹
 = 1;

3861 
	}
}

3865 
	$RM_LﬂdDoubÀ
(
RedisModuÀIO
 *
io
) {

3866 i‡(
io
->
îr‹
)  0;

3867 i‡(
io
->
vî
 == 2) {

3868 
uöt64_t
 
›code
 = 
	`rdbLﬂdLí
(
io
->
rio
,
NULL
);

3869 i‡(
›code
 !
RDB_MODULE_OPCODE_DOUBLE
Ë
lﬂdîr
;

3871 
vÆue
;

3872 
ªtvÆ
 = 
	`rdbLﬂdBö¨yDoubÀVÆue
(
io
->
rio
, &
vÆue
);

3873 i‡(
ªtvÆ
 =-1Ë
lﬂdîr
;

3874  
vÆue
;

3876 
lﬂdîr
:

3877 
	`moduÀRDBLﬂdEº‹
(
io
);

3879 
	}
}

3884 
	$RM_SaveFlﬂt
(
RedisModuÀIO
 *
io
, 
vÆue
) {

3885 i‡(
io
->
îr‹
) ;

3887 
ªtvÆ
 = 
	`rdbSaveLí
(
io
->
rio
, 
RDB_MODULE_OPCODE_FLOAT
);

3888 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3889 
io
->
byãs
 +
ªtvÆ
;

3891 
ªtvÆ
 = 
	`rdbSaveBö¨yFlﬂtVÆue
(
io
->
rio
, 
vÆue
);

3892 i‡(
ªtvÆ
 =-1Ë
ßvìº
;

3893 
io
->
byãs
 +
ªtvÆ
;

3896 
ßvìº
:

3897 
io
->
îr‹
 = 1;

3898 
	}
}

3902 
	$RM_LﬂdFlﬂt
(
RedisModuÀIO
 *
io
) {

3903 i‡(
io
->
îr‹
)  0;

3904 i‡(
io
->
vî
 == 2) {

3905 
uöt64_t
 
›code
 = 
	`rdbLﬂdLí
(
io
->
rio
,
NULL
);

3906 i‡(
›code
 !
RDB_MODULE_OPCODE_FLOAT
Ë
lﬂdîr
;

3908 
vÆue
;

3909 
ªtvÆ
 = 
	`rdbLﬂdBö¨yFlﬂtVÆue
(
io
->
rio
, &
vÆue
);

3910 i‡(
ªtvÆ
 =-1Ë
lﬂdîr
;

3911  
vÆue
;

3913 
lﬂdîr
:

3914 
	`moduÀRDBLﬂdEº‹
(
io
);

3916 
	}
}

3921 
	$RM_SaveL⁄gDoubÀ
(
RedisModuÀIO
 *
io
, 
vÆue
) {

3922 i‡(
io
->
îr‹
) ;

3923 
buf
[
MAX_LONG_DOUBLE_CHARS
];

3926 
size_t
 
Àn
 = 
	`ld2°rög
(
buf
,(buf),
vÆue
,
LD_STR_HEX
);

3927 
	`RM_SaveSåögBuf„r
(
io
,
buf
,
Àn
);

3928 
	}
}

3932 
	$RM_LﬂdL⁄gDoubÀ
(
RedisModuÀIO
 *
io
) {

3933 i‡(
io
->
îr‹
)  0;

3934 
vÆue
;

3935 
size_t
 
Àn
;

3936 * 
°r
 = 
	`RM_LﬂdSåögBuf„r
(
io
,&
Àn
);

3937 i‡(!
°r
)  0;

3938 
	`°rög2ld
(
°r
,
Àn
,&
vÆue
);

3939 
	`RM_Fªe
(
°r
);

3940  
vÆue
;

3941 
	}
}

3945 
ssize_t
 
	$rdbSaveModuÀsAux
(
rio
 *
rdb
, 
whí
) {

3946 
size_t
 
tŸÆ_wrôãn
 = 0;

3947 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
moduÀs
);

3948 
di˘E¡ry
 *
de
;

3950 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3951 
RedisModuÀ
 *
moduÀ
 = 
	`di˘GëVÆ
(
de
);

3952 
li°Iãr
 
li
;

3953 
li°Node
 *
 
;

3955 
	`li°Rewöd
(
moduÀ
->
ty≥s
,&
li
);

3956 (
 
 = 
	`li°Next
(&
li
))) {

3957 
moduÀTy≥
 *
mt
 = 
 
->
vÆue
;

3958 i‡(!
mt
->
aux_ßve
 || !(mt->
aux_ßve_åiggîs
 & 
whí
))

3960 
ssize_t
 
ªt
 = 
	`rdbSaveSögÀModuÀAux
(
rdb
, 
whí
, 
mt
);

3961 i‡(
ªt
==-1) {

3962 
	`di˘Rñó£Iãøt‹
(
di
);

3965 
tŸÆ_wrôãn
 +
ªt
;

3969 
	`di˘Rñó£Iãøt‹
(
di
);

3970  
tŸÆ_wrôãn
;

3971 
	}
}

4015 
	$RM_Dige°AddSåögBuf„r
(
RedisModuÀDige°
 *
md
, *
ñe
, 
size_t
 
Àn
) {

4016 
	`mixDige°
(
md
->
o
,
ñe
,
Àn
);

4017 
	}
}

4021 
	$RM_Dige°AddL⁄gL⁄g
(
RedisModuÀDige°
 *
md
, 
Œ
) {

4022 
buf
[
LONG_STR_SIZE
];

4023 
size_t
 
Àn
 = 
	`Œ2°rög
(
buf
,(buf),
Œ
);

4024 
	`mixDige°
(
md
->
o
,
buf
,
Àn
);

4025 
	}
}

4028 
	$RM_Dige°EndSequí˚
(
RedisModuÀDige°
 *
md
) {

4029 
	`x‹Dige°
(
md
->
x
,md->
o
,(md->o));

4030 
	`mem£t
(
md
->
o
,0,(md->o));

4031 
	}
}

4048 *
	$RM_LﬂdD©aTy≥FromSåög
(c⁄° 
RedisModuÀSåög
 *
°r
, c⁄° 
moduÀTy≥
 *
mt
) {

4049 
rio
 
∑ylﬂd
;

4050 
RedisModuÀIO
 
io
;

4051 *
ªt
;

4053 
	`rioInôWôhBuf„r
(&
∑ylﬂd
, 
°r
->
±r
);

4054 
	`moduÀInôIOC⁄ãxt
(
io
,(
moduÀTy≥
 *)
mt
,&
∑ylﬂd
,
NULL
);

4059 
io
.
vî
 = 2;

4060 
ªt
 = 
mt
->
	`rdb_lﬂd
(&
io
,0);

4061 i‡(
io
.
˘x
) {

4062 
	`moduÀFªeC⁄ãxt
(
io
.
˘x
);

4063 
	`z‰ì
(
io
.
˘x
);

4065  
ªt
;

4066 
	}
}

4076 
RedisModuÀSåög
 *
	$RM_SaveD©aTy≥ToSåög
(
RedisModuÀCtx
 *
˘x
, *
d©a
, c⁄° 
moduÀTy≥
 *
mt
) {

4077 
rio
 
∑ylﬂd
;

4078 
RedisModuÀIO
 
io
;

4080 
	`rioInôWôhBuf„r
(&
∑ylﬂd
,
	`sd£m±y
());

4081 
	`moduÀInôIOC⁄ãxt
(
io
,(
moduÀTy≥
 *)
mt
,&
∑ylﬂd
,
NULL
);

4082 
mt
->
	`rdb_ßve
(&
io
,
d©a
);

4083 i‡(
io
.
˘x
) {

4084 
	`moduÀFªeC⁄ãxt
(
io
.
˘x
);

4085 
	`z‰ì
(
io
.
˘x
);

4087 i‡(
io
.
îr‹
) {

4088  
NULL
;

4090 
robj
 *
°r
 = 
	`¸óãObje˘
(
OBJ_STRING
,
∑ylﬂd
.
io
.
buf„r
.
±r
);

4091 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yAdd
(˘x,
REDISMODULE_AM_STRING
,
°r
);

4092  
°r
;

4094 
	}
}

4105 
	$RM_EmôAOF
(
RedisModuÀIO
 *
io
, c⁄° *
cmd«me
, c⁄° *
fmt
, ...) {

4106 i‡(
io
->
îr‹
) ;

4107 
ªdisComm™d
 *
cmd
;

4108 
robj
 **
¨gv
 = 
NULL
;

4109 
¨gc
 = 0, 
Êags
 = 0, 
j
;

4110 
va_li°
 
≠
;

4112 
cmd
 = 
	`lookupComm™dByCSåög
((*)
cmd«me
);

4113 i‡(!
cmd
) {

4114 
	`£rvîLog
(
LL_WARNING
,

4117 
io
->
ty≥
->
«me
, 
cmd«me
);

4118 
io
->
îr‹
 = 1;

4119 
î∫o
 = 
EINVAL
;

4124 
	`va_°¨t
(
≠
, 
fmt
);

4125 
¨gv
 = 
	`moduÀCª©eArgvFromU£rF‹m©
(
cmd«me
,
fmt
,&
¨gc
,&
Êags
,
≠
);

4126 
	`va_íd
(
≠
);

4127 i‡(
¨gv
 =
NULL
) {

4128 
	`£rvîLog
(
LL_WARNING
,

4131 
io
->
ty≥
->
«me
, 
fmt
);

4132 
io
->
îr‹
 = 1;

4133 
î∫o
 = 
EINVAL
;

4138 i‡(!
io
->
îr‹
 && 
	`rioWrôeBulkCou¡
(io->
rio
,'*',
¨gc
) == 0)

4139 
io
->
îr‹
 = 1;

4142 
j
 = 0; j < 
¨gc
; j++) {

4143 i‡(!
io
->
îr‹
 && 
	`rioWrôeBulkObje˘
(io->
rio
,
¨gv
[
j
]) == 0)

4144 
io
->
îr‹
 = 1;

4145 
	`de¸RefCou¡
(
¨gv
[
j
]);

4147 
	`z‰ì
(
¨gv
);

4149 
	}
}

4155 
RedisModuÀCtx
 *
	$RM_GëC⁄ãxtFromIO
(
RedisModuÀIO
 *
io
) {

4156 i‡(
io
->
˘x
)  io->ctx;

4157 
RedisModuÀCtx
 
˘xãm∂©e
 = 
REDISMODULE_CTX_INIT
;

4158 
io
->
˘x
 = 
	`zmÆloc
((
RedisModuÀCtx
));

4159 *(
io
->
˘x
Ë
˘xãm∂©e
;

4160 
io
->
˘x
->
moduÀ
 = io->
ty≥
->module;

4161 
io
->
˘x
->
˛õ¡
 = 
NULL
;

4162  
io
->
˘x
;

4163 
	}
}

4169 c⁄° 
RedisModuÀSåög
 *
	$RM_GëKeyNameFromIO
(
RedisModuÀIO
 *
io
) {

4170  
io
->
key
;

4171 
	}
}

4174 c⁄° 
RedisModuÀSåög
 *
	$RM_GëKeyNameFromModuÀKey
(
RedisModuÀKey
 *
key
) {

4175  
key
 ? key->key : 
NULL
;

4176 
	}
}

4188 
	$RM_LogRaw
(
RedisModuÀ
 *
moduÀ
, c⁄° *
Àvñ°r
, c⁄° *
fmt
, 
va_li°
 
≠
) {

4189 
msg
[
LOG_MAX_LEN
];

4190 
size_t
 
«me_Àn
;

4191 
Àvñ
;

4193 i‡(!
	`°rˇ£cmp
(
Àvñ°r
,"debug")Ë
Àvñ
 = 
LL_DEBUG
;

4194 i‡(!
	`°rˇ£cmp
(
Àvñ°r
,"vîbo£")Ë
Àvñ
 = 
LL_VERBOSE
;

4195 i‡(!
	`°rˇ£cmp
(
Àvñ°r
,"nŸi˚")Ë
Àvñ
 = 
LL_NOTICE
;

4196 i‡(!
	`°rˇ£cmp
(
Àvñ°r
,"w¨nög")Ë
Àvñ
 = 
LL_WARNING
;

4197 
Àvñ
 = 
LL_VERBOSE
;

4199 i‡(
Àvñ
 < 
£rvî
.
vîbosôy
) ;

4201 
«me_Àn
 = 
	`¢¥ötf
(
msg
, (msg),"<%s> ", 
moduÀ
? moduÀ->
«me
: "module");

4202 
	`v¢¥ötf
(
msg
 + 
«me_Àn
, (msgË-Çame_Àn, 
fmt
, 
≠
);

4203 
	`£rvîLogRaw
(
Àvñ
,
msg
);

4204 
	}
}

4224 
	$RM_Log
(
RedisModuÀCtx
 *
˘x
, c⁄° *
Àvñ°r
, c⁄° *
fmt
, ...) {

4225 
va_li°
 
≠
;

4226 
	`va_°¨t
(
≠
, 
fmt
);

4227 
	`RM_LogRaw
(
˘x
? ctx->
moduÀ
: 
NULL
,
Àvñ°r
,
fmt
,
≠
);

4228 
	`va_íd
(
≠
);

4229 
	}
}

4236 
	$RM_LogIOEº‹
(
RedisModuÀIO
 *
io
, c⁄° *
Àvñ°r
, c⁄° *
fmt
, ...) {

4237 
va_li°
 
≠
;

4238 
	`va_°¨t
(
≠
, 
fmt
);

4239 
	`RM_LogRaw
(
io
->
ty≥
->
moduÀ
,
Àvñ°r
,
fmt
,
≠
);

4240 
	`va_íd
(
≠
);

4241 
	}
}

4248 
	$RM__As£π
(c⁄° *
e°r
, c⁄° *
fûe
, 
löe
) {

4249 
	`_£rvîAs£π
(
e°r
, 
fûe
, 
löe
);

4250 
	}
}

4255 
	$RM_L©ícyAddSam∂e
(c⁄° *
evít
, 
m°ime_t
 
œãncy
) {

4256 i‡(
œãncy
 >
£rvî
.
œãncy_m⁄ô‹_thªshﬁd
)

4257 
	`œãncyAddSam∂e
(
evít
, 
œãncy
);

4258 
	}
}

4268 
	$moduÀBlockedClõ¡PùeRódabÀ
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

4269 
	`UNUSED
(
ñ
);

4270 
	`UNUSED
(
fd
);

4271 
	`UNUSED
(
mask
);

4272 
	`UNUSED
(
¥ivd©a
);

4273 
	}
}

4287 
	$unblockClõ¡FromModuÀ
(
˛õ¡
 *
c
) {

4288 
RedisModuÀBlockedClõ¡
 *
bc
 = 
c
->
bp›
.
moduÀ_blocked_h™dÀ
;

4294 i‡(
bc
->
disc⁄√˘_ˇŒback
) {

4295 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

4296 
˘x
.
blocked_¥ivd©a
 = 
bc
->
¥ivd©a
;

4297 
˘x
.
moduÀ
 = 
bc
->module;

4298 
˘x
.
˛õ¡
 = 
bc
->client;

4299 
bc
->
	`disc⁄√˘_ˇŒback
(&
˘x
,bc);

4300 
	`moduÀFªeC⁄ãxt
(&
˘x
);

4318 i‡(
bc
->
blocked_⁄_keys
 && !bc->
unblocked
)

4319 
	`moduÀUnblockClõ¡
(
c
);

4321 
bc
->
˛õ¡
 = 
NULL
;

4326 
	`ª£tClõ¡
(
c
);

4327 
	}
}

4348 
RedisModuÀBlockedClõ¡
 *
	$moduÀBlockClõ¡
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀCmdFunc
 
ª∂y_ˇŒback
, RedisModuÀCmdFun¯
timeout_ˇŒback
, (*
‰ì_¥ivd©a
)(RedisModuÀCtx*,*), 
timeout_ms
, 
RedisModuÀSåög
 **
keys
, 
numkeys
, *
¥ivd©a
) {

4349 
˛õ¡
 *
c
 = 
˘x
->client;

4350 
i¶ua
 = 
c
->
Êags
 & 
CLIENT_LUA
;

4351 
ismu…i
 = 
c
->
Êags
 & 
CLIENT_MULTI
;

4353 
c
->
bp›
.
moduÀ_blocked_h™dÀ
 = 
	`zmÆloc
((
RedisModuÀBlockedClõ¡
));

4354 
RedisModuÀBlockedClõ¡
 *
bc
 = 
c
->
bp›
.
moduÀ_blocked_h™dÀ
;

4355 
˘x
->
moduÀ
->
blocked_˛õ¡s
++;

4361 
m°ime_t
 
timeout
 = 
timeout_ms
 ? (
	`m°ime
()+timeout_ms) : 0;

4362 
bc
->
˛õ¡
 = (
i¶ua
 || 
ismu…i
Ë? 
NULL
 : 
c
;

4363 
bc
->
moduÀ
 = 
˘x
->module;

4364 
bc
->
ª∂y_ˇŒback
 =Ñeply_callback;

4365 
bc
->
timeout_ˇŒback
 =Åimeout_callback;

4366 
bc
->
disc⁄√˘_ˇŒback
 = 
NULL
;

4367 
bc
->
‰ì_¥ivd©a
 = free_privdata;

4368 
bc
->
¥ivd©a
 =Örivdata;

4369 
bc
->
ª∂y_˛õ¡
 = 
	`¸óãClõ¡
(
NULL
);

4370 
bc
->
ª∂y_˛õ¡
->
Êags
 |
CLIENT_MODULE
;

4371 
bc
->
dbid
 = 
c
->
db
->
id
;

4372 
bc
->
blocked_⁄_keys
 = 
keys
 !
NULL
;

4373 
bc
->
unblocked
 = 0;

4374 
c
->
bp›
.
timeout
 =Åimeout;

4376 i‡(
i¶ua
 || 
ismu…i
) {

4377 
c
->
bp›
.
moduÀ_blocked_h™dÀ
 = 
NULL
;

4378 
	`addRïlyEº‹
(
c
, 
i¶ua
 ?

4382 i‡(
keys
) {

4383 
	`blockF‹Keys
(
c
,
BLOCKED_MODULE
,
keys
,
numkeys
,
timeout
,
NULL
,NULL);

4385 
	`blockClõ¡
(
c
,
BLOCKED_MODULE
);

4388  
bc
;

4389 
	}
}

4398 
	$moduÀTrySîveClõ¡BlockedOnKey
(
˛õ¡
 *
c
, 
robj
 *
key
) {

4399 
£rved
 = 0;

4400 
RedisModuÀBlockedClõ¡
 *
bc
 = 
c
->
bp›
.
moduÀ_blocked_h™dÀ
;

4405 i‡(
bc
->
unblocked
)  0;

4407 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

4408 
˘x
.
Êags
 |
REDISMODULE_CTX_BLOCKED_REPLY
;

4409 
˘x
.
blocked_ªady_key
 = 
key
;

4410 
˘x
.
blocked_¥ivd©a
 = 
bc
->
¥ivd©a
;

4411 
˘x
.
moduÀ
 = 
bc
->module;

4412 
˘x
.
˛õ¡
 = 
bc
->client;

4413 
˘x
.
blocked_˛õ¡
 = 
bc
;

4414 i‡(
bc
->
	`ª∂y_ˇŒback
(&
˘x
,(**)
c
->
¨gv
,c->
¨gc
Ë=
REDISMODULE_OK
)

4415 
£rved
 = 1;

4416 
	`moduÀFªeC⁄ãxt
(&
˘x
);

4417  
£rved
;

4418 
	}
}

4440 
RedisModuÀBlockedClõ¡
 *
	$RM_BlockClõ¡
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀCmdFunc
 
ª∂y_ˇŒback
, RedisModuÀCmdFun¯
timeout_ˇŒback
, (*
‰ì_¥ivd©a
)(RedisModuÀCtx*,*), 
timeout_ms
) {

4441  
	`moduÀBlockClõ¡
(
˘x
,
ª∂y_ˇŒback
,
timeout_ˇŒback
,
‰ì_¥ivd©a
,
timeout_ms
, 
NULL
,0,NULL);

4442 
	}
}

4502 
RedisModuÀBlockedClõ¡
 *
	$RM_BlockClõ¡OnKeys
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀCmdFunc
 
ª∂y_ˇŒback
, RedisModuÀCmdFun¯
timeout_ˇŒback
, (*
‰ì_¥ivd©a
)(RedisModuÀCtx*,*), 
timeout_ms
, 
RedisModuÀSåög
 **
keys
, 
numkeys
, *
¥ivd©a
) {

4503  
	`moduÀBlockClõ¡
(
˘x
,
ª∂y_ˇŒback
,
timeout_ˇŒback
,
‰ì_¥ivd©a
,
timeout_ms
, 
keys
,
numkeys
,
¥ivd©a
);

4504 
	}
}

4510 
	$RM_Sig«lKeyAsRódy
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
key
) {

4511 
	`sig«lKeyAsRódy
(
˘x
->
˛õ¡
->
db
, 
key
);

4512 
	}
}

4515 
	$moduÀUnblockClõ¡ByH™dÀ
(
RedisModuÀBlockedClõ¡
 *
bc
, *
¥ivd©a
) {

4516 
	`±hªad_muãx_lock
(&
moduÀUnblockedClõ¡sMuãx
);

4517 i‡(!
bc
->
blocked_⁄_keys
Ëbc->
¥ivd©a
 =Örivdata;

4518 
bc
->
unblocked
 = 1;

4519 
	`li°AddNodeTaû
(
moduÀUnblockedClõ¡s
,
bc
);

4520 i‡(
	`wrôe
(
£rvî
.
moduÀ_blocked_pùe
[1],"A",1) != 1) {

4523 
	`±hªad_muãx_u∆ock
(&
moduÀUnblockedClõ¡sMuãx
);

4524  
REDISMODULE_OK
;

4525 
	}
}

4529 
	$moduÀUnblockClõ¡
(
˛õ¡
 *
c
) {

4530 
RedisModuÀBlockedClõ¡
 *
bc
 = 
c
->
bp›
.
moduÀ_blocked_h™dÀ
;

4531 
	`moduÀUnblockClõ¡ByH™dÀ
(
bc
,
NULL
);

4532 
	}
}

4536 
	$moduÀClõ¡IsBlockedOnKeys
(
˛õ¡
 *
c
) {

4537 
RedisModuÀBlockedClõ¡
 *
bc
 = 
c
->
bp›
.
moduÀ_blocked_h™dÀ
;

4538  
bc
->
blocked_⁄_keys
;

4539 
	}
}

4561 
	$RM_UnblockClõ¡
(
RedisModuÀBlockedClõ¡
 *
bc
, *
¥ivd©a
) {

4562 i‡(
bc
->
blocked_⁄_keys
) {

4565 i‡(
bc
->
timeout_ˇŒback
 =
NULL
Ë 
REDISMODULE_ERR
;

4566 i‡(
bc
->
unblocked
Ë 
REDISMODULE_OK
;

4567 i‡(
bc
->
˛õ¡
Ë
	`moduÀBlockedClõ¡TimedOut
(bc->client);

4569 
	`moduÀUnblockClõ¡ByH™dÀ
(
bc
,
¥ivd©a
);

4570  
REDISMODULE_OK
;

4571 
	}
}

4575 
	$RM_Ab‹tBlock
(
RedisModuÀBlockedClõ¡
 *
bc
) {

4576 
bc
->
ª∂y_ˇŒback
 = 
NULL
;

4577 
bc
->
disc⁄√˘_ˇŒback
 = 
NULL
;

4578  
	`RM_UnblockClõ¡
(
bc
,
NULL
);

4579 
	}
}

4597 
	$RM_SëDisc⁄√˘CÆlback
(
RedisModuÀBlockedClõ¡
 *
bc
, 
RedisModuÀDisc⁄√˘Func
 
ˇŒback
) {

4598 
bc
->
disc⁄√˘_ˇŒback
 = 
ˇŒback
;

4599 
	}
}

4609 
	$moduÀH™dÀBlockedClõ¡s
() {

4610 
li°Node
 *
 
;

4611 
RedisModuÀBlockedClõ¡
 *
bc
;

4613 
	`±hªad_muãx_lock
(&
moduÀUnblockedClõ¡sMuãx
);

4616 
buf
[1];

4617 
	`ªad
(
£rvî
.
moduÀ_blocked_pùe
[0],
buf
,1) == 1);

4618 
	`li°Lígth
(
moduÀUnblockedClõ¡s
)) {

4619 
 
 = 
	`li°Fú°
(
moduÀUnblockedClõ¡s
);

4620 
bc
 = 
 
->
vÆue
;

4621 
˛õ¡
 *
c
 = 
bc
->client;

4622 
	`li°DñNode
(
moduÀUnblockedClõ¡s
,
 
);

4623 
	`±hªad_muãx_u∆ock
(&
moduÀUnblockedClõ¡sMuãx
);

4633 i‡(
c
 && !
bc
->
blocked_⁄_keys
 && bc->
ª∂y_ˇŒback
) {

4634 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

4635 
˘x
.
Êags
 |
REDISMODULE_CTX_BLOCKED_REPLY
;

4636 
˘x
.
blocked_¥ivd©a
 = 
bc
->
¥ivd©a
;

4637 
˘x
.
blocked_ªady_key
 = 
NULL
;

4638 
˘x
.
moduÀ
 = 
bc
->module;

4639 
˘x
.
˛õ¡
 = 
bc
->client;

4640 
˘x
.
blocked_˛õ¡
 = 
bc
;

4641 
bc
->
	`ª∂y_ˇŒback
(&
˘x
,(**)
c
->
¨gv
,c->
¨gc
);

4642 
	`moduÀFªeC⁄ãxt
(&
˘x
);

4646 i‡(
bc
->
¥ivd©a
 && bc->
‰ì_¥ivd©a
) {

4647 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

4648 i‡(
c
 =
NULL
)

4649 
˘x
.
Êags
 |
REDISMODULE_CTX_BLOCKED_DISCONNECTED
;

4650 
˘x
.
blocked_¥ivd©a
 = 
bc
->
¥ivd©a
;

4651 
˘x
.
moduÀ
 = 
bc
->module;

4652 
˘x
.
˛õ¡
 = 
bc
->client;

4653 
bc
->
	`‰ì_¥ivd©a
(&
˘x
,bc->
¥ivd©a
);

4654 
	`moduÀFªeC⁄ãxt
(&
˘x
);

4661 i‡(
c
Ë
	`AddRïlyFromClõ¡
(c, 
bc
->
ª∂y_˛õ¡
);

4662 
	`‰ìClõ¡
(
bc
->
ª∂y_˛õ¡
);

4664 i‡(
c
 !
NULL
) {

4668 
bc
->
disc⁄√˘_ˇŒback
 = 
NULL
;

4669 
	`unblockClõ¡
(
c
);

4673 i‡(
	`˛õ¡HasPídögRïlõs
(
c
) &&

4674 !(
c
->
Êags
 & 
CLIENT_PENDING_WRITE
))

4676 
c
->
Êags
 |
CLIENT_PENDING_WRITE
;

4677 
	`li°AddNodeHód
(
£rvî
.
˛õ¡s_≥ndög_wrôe
,
c
);

4684 
bc
->
moduÀ
->
blocked_˛õ¡s
--;

4685 
	`z‰ì
(
bc
);

4688 
	`±hªad_muãx_lock
(&
moduÀUnblockedClõ¡sMuãx
);

4690 
	`±hªad_muãx_u∆ock
(&
moduÀUnblockedClõ¡sMuãx
);

4691 
	}
}

4697 
	$moduÀBlockedClõ¡TimedOut
(
˛õ¡
 *
c
) {

4698 
RedisModuÀBlockedClõ¡
 *
bc
 = 
c
->
bp›
.
moduÀ_blocked_h™dÀ
;

4699 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

4700 
˘x
.
Êags
 |
REDISMODULE_CTX_BLOCKED_TIMEOUT
;

4701 
˘x
.
moduÀ
 = 
bc
->module;

4702 
˘x
.
˛õ¡
 = 
bc
->client;

4703 
˘x
.
blocked_˛õ¡
 = 
bc
;

4704 
bc
->
	`timeout_ˇŒback
(&
˘x
,(**)
c
->
¨gv
,c->
¨gc
);

4705 
	`moduÀFªeC⁄ãxt
(&
˘x
);

4709 
bc
->
disc⁄√˘_ˇŒback
 = 
NULL
;

4710 
	}
}

4714 
	$RM_IsBlockedRïlyReque°
(
RedisModuÀCtx
 *
˘x
) {

4715  (
˘x
->
Êags
 & 
REDISMODULE_CTX_BLOCKED_REPLY
) != 0;

4716 
	}
}

4720 
	$RM_IsBlockedTimeoutReque°
(
RedisModuÀCtx
 *
˘x
) {

4721  (
˘x
->
Êags
 & 
REDISMODULE_CTX_BLOCKED_TIMEOUT
) != 0;

4722 
	}
}

4725 *
	$RM_GëBlockedClõ¡Priv©eD©a
(
RedisModuÀCtx
 *
˘x
) {

4726  
˘x
->
blocked_¥ivd©a
;

4727 
	}
}

4731 
RedisModuÀSåög
 *
	$RM_GëBlockedClõ¡RódyKey
(
RedisModuÀCtx
 *
˘x
) {

4732  
˘x
->
blocked_ªady_key
;

4733 
	}
}

4739 
RedisModuÀBlockedClõ¡
 *
	$RM_GëBlockedClõ¡H™dÀ
(
RedisModuÀCtx
 *
˘x
) {

4740  
˘x
->
blocked_˛õ¡
;

4741 
	}
}

4746 
	$RM_BlockedClõ¡Disc⁄√˘ed
(
RedisModuÀCtx
 *
˘x
) {

4747  (
˘x
->
Êags
 & 
REDISMODULE_CTX_BLOCKED_DISCONNECTED
) != 0;

4748 
	}
}

4773 
RedisModuÀCtx
 *
	$RM_GëThªadSa„C⁄ãxt
(
RedisModuÀBlockedClõ¡
 *
bc
) {

4774 
RedisModuÀCtx
 *
˘x
 = 
	`zmÆloc
((*ctx));

4775 
RedisModuÀCtx
 
em±y
 = 
REDISMODULE_CTX_INIT
;

4776 
	`mem˝y
(
˘x
,&
em±y
,(empty));

4777 i‡(
bc
) {

4778 
˘x
->
blocked_˛õ¡
 = 
bc
;

4779 
˘x
->
moduÀ
 = 
bc
->module;

4781 
˘x
->
Êags
 |
REDISMODULE_CTX_THREAD_SAFE
;

4786 
˘x
->
˛õ¡
 = 
	`¸óãClõ¡
(
NULL
);

4787 i‡(
bc
) {

4788 
	`£À˘Db
(
˘x
->
˛õ¡
,
bc
->
dbid
);

4789 i‡(
bc
->
˛õ¡
Ë
˘x
->˛õ¡->
id
 = bc->client->id;

4791  
˘x
;

4792 
	}
}

4795 
	$RM_FªeThªadSa„C⁄ãxt
(
RedisModuÀCtx
 *
˘x
) {

4796 
	`moduÀFªeC⁄ãxt
(
˘x
);

4797 
	`z‰ì
(
˘x
);

4798 
	}
}

4803 
	$RM_ThªadSa„C⁄ãxtLock
(
RedisModuÀCtx
 *
˘x
) {

4804 
	`UNUSED
(
˘x
);

4805 
	`moduÀAcquúeGIL
();

4806 
	}
}

4809 
	$RM_ThªadSa„C⁄ãxtU∆ock
(
RedisModuÀCtx
 *
˘x
) {

4810 
	`UNUSED
(
˘x
);

4811 
	`moduÀRñó£GIL
();

4812 
	}
}

4814 
	$moduÀAcquúeGIL
() {

4815 
	`±hªad_muãx_lock
(&
moduÀGIL
);

4816 
	}
}

4818 
	$moduÀRñó£GIL
() {

4819 
	`±hªad_muãx_u∆ock
(&
moduÀGIL
);

4820 
	}
}

4877 
	$RM_Subs¸ibeToKey•a˚Evíts
(
RedisModuÀCtx
 *
˘x
, 
ty≥s
, 
RedisModuÀNŸifiˇti⁄Func
 
ˇŒback
) {

4878 
RedisModuÀKey•a˚Subs¸ibî
 *
sub
 = 
	`zmÆloc
((*sub));

4879 
sub
->
moduÀ
 = 
˘x
->module;

4880 
sub
->
evít_mask
 = 
ty≥s
;

4881 
sub
->
nŸify_ˇŒback
 = 
ˇŒback
;

4882 
sub
->
a˘ive
 = 0;

4884 
	`li°AddNodeTaû
(
moduÀKey•a˚Subs¸ibîs
, 
sub
);

4885  
REDISMODULE_OK
;

4886 
	}
}

4890 
	$RM_GëNŸifyKey•a˚Evíts
() {

4891  
£rvî
.
nŸify_key•a˚_evíts
;

4892 
	}
}

4895 
	$RM_NŸifyKey•a˚Evít
(
RedisModuÀCtx
 *
˘x
, 
ty≥
, c⁄° *
evít
, 
RedisModuÀSåög
 *
key
) {

4896 i‡(!
˘x
 || !˘x->
˛õ¡
)

4897  
REDISMODULE_ERR
;

4898 
	`nŸifyKey•a˚Evít
(
ty≥
, (*)
evít
, 
key
, 
˘x
->
˛õ¡
->
db
->
id
);

4899  
REDISMODULE_OK
;

4900 
	}
}

4905 
	$moduÀNŸifyKey•a˚Evít
(
ty≥
, c⁄° *
evít
, 
robj
 *
key
, 
dbid
) {

4907 i‡(
	`li°Lígth
(
moduÀKey•a˚Subs¸ibîs
) == 0) ;

4909 
li°Iãr
 
li
;

4910 
li°Node
 *
 
;

4911 
	`li°Rewöd
(
moduÀKey•a˚Subs¸ibîs
,&
li
);

4914 
ty≥
 &~(
NOTIFY_KEYEVENT
 | 
NOTIFY_KEYSPACE
);

4916 (
 
 = 
	`li°Next
(&
li
))) {

4917 
RedisModuÀKey•a˚Subs¸ibî
 *
sub
 = 
 
->
vÆue
;

4920 i‡((
sub
->
evít_mask
 & 
ty≥
Ë&& sub->
a˘ive
 == 0) {

4921 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

4922 
˘x
.
moduÀ
 = 
sub
->module;

4923 
˘x
.
˛õ¡
 = 
moduÀFªeC⁄ãxtReu£dClõ¡
;

4924 
	`£À˘Db
(
˘x
.
˛õ¡
, 
dbid
);

4929 
sub
->
a˘ive
 = 1;

4930 
sub
->
	`nŸify_ˇŒback
(&
˘x
, 
ty≥
, 
evít
, 
key
);

4931 
sub
->
a˘ive
 = 0;

4932 
	`moduÀFªeC⁄ãxt
(&
˘x
);

4935 
	}
}

4938 
	$moduÀUnsubs¸ibeNŸifiˇti⁄s
(
RedisModuÀ
 *
moduÀ
) {

4939 
li°Iãr
 
li
;

4940 
li°Node
 *
 
;

4941 
	`li°Rewöd
(
moduÀKey•a˚Subs¸ibîs
,&
li
);

4942 (
 
 = 
	`li°Next
(&
li
))) {

4943 
RedisModuÀKey•a˚Subs¸ibî
 *
sub
 = 
 
->
vÆue
;

4944 i‡(
sub
->
moduÀ
 == module) {

4945 
	`li°DñNode
(
moduÀKey•a˚Subs¸ibîs
, 
 
);

4946 
	`z‰ì
(
sub
);

4949 
	}
}

4956 (*
	tRedisModuÀClu°îMesßgeRe˚ivî
)(
	tRedisModuÀCtx
 *
	t˘x
, c⁄° *
	t£ndî_id
, 
	tuöt8_t
 
	tty≥
, c⁄° *
	t∑ylﬂd
, 
	tuöt32_t
 
	tÀn
);

4961 
	smoduÀClu°îRe˚ivî
 {

4962 
uöt64_t
 
moduÀ_id
;

4963 
RedisModuÀClu°îMesßgeRe˚ivî
 
ˇŒback
;

4964 
RedisModuÀ
 *
moduÀ
;

4965 
moduÀClu°îRe˚ivî
 *
√xt
;

4966 } 
	tmoduÀClu°îRe˚ivî
;

4968 
	smoduÀClu°îNodeInfo
 {

4969 
Êags
;

4970 
ù
[
NET_IP_STR_LEN
];

4971 
p‹t
;

4972 
ma°î_id
[40];

4973 } 
	tmdouÀClu°îNodeInfo
;

4977 
moduÀClu°îRe˚ivî
 *
˛u°îRe˚ivîs
[
UINT8_MAX
];

4980 
	$moduÀCÆlClu°îRe˚ivîs
(c⁄° *
£ndî_id
, 
uöt64_t
 
moduÀ_id
, 
uöt8_t
 
ty≥
, c⁄° *
∑ylﬂd
, 
uöt32_t
 
Àn
) {

4981 
moduÀClu°îRe˚ivî
 *
r
 = 
˛u°îRe˚ivîs
[
ty≥
];

4982 
r
) {

4983 i‡(
r
->
moduÀ_id
 == module_id) {

4984 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

4985 
˘x
.
moduÀ
 = 
r
->module;

4986 
˘x
.
˛õ¡
 = 
moduÀFªeC⁄ãxtReu£dClõ¡
;

4987 
	`£À˘Db
(
˘x
.
˛õ¡
, 0);

4988 
r
->
	`ˇŒback
(&
˘x
,
£ndî_id
,
ty≥
,
∑ylﬂd
,
Àn
);

4989 
	`moduÀFªeC⁄ãxt
(&
˘x
);

4992 
r
 =Ñ->
√xt
;

4994 
	}
}

5001 
	$RM_Regi°îClu°îMesßgeRe˚ivî
(
RedisModuÀCtx
 *
˘x
, 
uöt8_t
 
ty≥
, 
RedisModuÀClu°îMesßgeRe˚ivî
 
ˇŒback
) {

5002 i‡(!
£rvî
.
˛u°î_íabÀd
) ;

5004 
uöt64_t
 
moduÀ_id
 = 
	`moduÀTy≥EncodeId
(
˘x
->
moduÀ
->
«me
,0);

5005 
moduÀClu°îRe˚ivî
 *
r
 = 
˛u°îRe˚ivîs
[
ty≥
], *
¥ev
 = 
NULL
;

5006 
r
) {

5007 i‡(
r
->
moduÀ_id
 == module_id) {

5009 i‡(
ˇŒback
) {

5010 
r
->
ˇŒback
 = callback;

5015 i‡(
¥ev
)

5016 
¥ev
->
√xt
 = 
r
->next;

5018 
˛u°îRe˚ivîs
[
ty≥
]->
√xt
 = 
r
->next;

5019 
	`z‰ì
(
r
);

5023 
¥ev
 = 
r
;

5024 
r
 =Ñ->
√xt
;

5028 i‡(
ˇŒback
) {

5029 
r
 = 
	`zmÆloc
((*r));

5030 
r
->
moduÀ_id
 = module_id;

5031 
r
->
moduÀ
 = 
˘x
->module;

5032 
r
->
ˇŒback
 = callback;

5033 
r
->
√xt
 = 
˛u°îRe˚ivîs
[
ty≥
];

5034 
˛u°îRe˚ivîs
[
ty≥
] = 
r
;

5036 
	}
}

5045 
	$RM_SídClu°îMesßge
(
RedisModuÀCtx
 *
˘x
, *
èrgë_id
, 
uöt8_t
 
ty≥
, *
msg
, 
uöt32_t
 
Àn
) {

5046 i‡(!
£rvî
.
˛u°î_íabÀd
Ë 
REDISMODULE_ERR
;

5047 
uöt64_t
 
moduÀ_id
 = 
	`moduÀTy≥EncodeId
(
˘x
->
moduÀ
->
«me
,0);

5048 i‡(
	`˛u°îSídModuÀMesßgeToT¨gë
(
èrgë_id
,
moduÀ_id
,
ty≥
,
msg
,
Àn
Ë=
C_OK
)

5049  
REDISMODULE_OK
;

5051  
REDISMODULE_ERR
;

5052 
	}
}

5076 **
	$RM_GëClu°îNodesLi°
(
RedisModuÀCtx
 *
˘x
, 
size_t
 *
numnodes
) {

5077 
	`UNUSED
(
˘x
);

5079 i‡(!
£rvî
.
˛u°î_íabÀd
Ë 
NULL
;

5080 
size_t
 
cou¡
 = 
	`di˘Size
(
£rvî
.
˛u°î
->
nodes
);

5081 **
ids
 = 
	`zmÆloc
((
cou¡
+1)*
REDISMODULE_NODE_ID_LEN
);

5082 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
˛u°î
->
nodes
);

5083 
di˘E¡ry
 *
de
;

5084 
j
 = 0;

5085 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

5086 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
de
);

5087 i‡(
node
->
Êags
 & (
CLUSTER_NODE_NOADDR
|
CLUSTER_NODE_HANDSHAKE
)) ;

5088 
ids
[
j
] = 
	`zmÆloc
(
REDISMODULE_NODE_ID_LEN
);

5089 
	`mem˝y
(
ids
[
j
],
node
->
«me
,
REDISMODULE_NODE_ID_LEN
);

5090 
j
++;

5092 *
numnodes
 = 
j
;

5093 
ids
[
j
] = 
NULL
;

5095 
	`di˘Rñó£Iãøt‹
(
di
);

5096  
ids
;

5097 
	}
}

5100 
	$RM_FªeClu°îNodesLi°
(**
ids
) {

5101 i‡(
ids
 =
NULL
) ;

5102 
j
 = 0; 
ids
[j]; j++Ë
	`z‰ì
(ids[j]);

5103 
	`z‰ì
(
ids
);

5104 
	}
}

5108 c⁄° *
	$RM_GëMyClu°îID
() {

5109 i‡(!
£rvî
.
˛u°î_íabÀd
Ë 
NULL
;

5110  
£rvî
.
˛u°î
->
my£lf
->
«me
;

5111 
	}
}

5117 
size_t
 
	$RM_GëClu°îSize
() {

5118 i‡(!
£rvî
.
˛u°î_íabÀd
)  0;

5119  
	`di˘Size
(
£rvî
.
˛u°î
->
nodes
);

5120 
	}
}

5142 
˛u°îNode
 *
˛u°îLookupNode
(c⁄° *
«me
);

5144 
	$RM_GëClu°îNodeInfo
(
RedisModuÀCtx
 *
˘x
, c⁄° *
id
, *
ù
, *
ma°î_id
, *
p‹t
, *
Êags
) {

5145 
	`UNUSED
(
˘x
);

5147 
˛u°îNode
 *
node
 = 
	`˛u°îLookupNode
(
id
);

5148 i‡(
node
 =
NULL
 ||

5149 
node
->
Êags
 & (
CLUSTER_NODE_NOADDR
|
CLUSTER_NODE_HANDSHAKE
))

5151  
REDISMODULE_ERR
;

5154 i‡(
ù
Ë
	`°∫˝y
(ù,
node
->ù,
NET_IP_STR_LEN
);

5156 i‡(
ma°î_id
) {

5160 i‡(
node
->
Êags
 & 
CLUSTER_NODE_MASTER
 &&Çode->
¶aveof
)

5161 
	`mem˝y
(
ma°î_id
,
node
->
¶aveof
->
«me
,
REDISMODULE_NODE_ID_LEN
);

5163 
	`mem£t
(
ma°î_id
,0,
REDISMODULE_NODE_ID_LEN
);

5165 i‡(
p‹t
Ë*p‹à
node
->port;

5169 i‡(
Êags
) {

5170 *
Êags
 = 0;

5171 i‡(
node
->
Êags
 & 
CLUSTER_NODE_MYSELF
Ë*Êag†|
REDISMODULE_NODE_MYSELF
;

5172 i‡(
node
->
Êags
 & 
CLUSTER_NODE_MASTER
Ë*Êag†|
REDISMODULE_NODE_MASTER
;

5173 i‡(
node
->
Êags
 & 
CLUSTER_NODE_SLAVE
Ë*Êag†|
REDISMODULE_NODE_SLAVE
;

5174 i‡(
node
->
Êags
 & 
CLUSTER_NODE_PFAIL
Ë*Êag†|
REDISMODULE_NODE_PFAIL
;

5175 i‡(
node
->
Êags
 & 
CLUSTER_NODE_FAIL
Ë*Êag†|
REDISMODULE_NODE_FAIL
;

5176 i‡(
node
->
Êags
 & 
CLUSTER_NODE_NOFAILOVER
Ë*Êag†|
REDISMODULE_NODE_NOFAILOVER
;

5178  
REDISMODULE_OK
;

5179 
	}
}

5199 
	$RM_SëClu°îFœgs
(
RedisModuÀCtx
 *
˘x
, 
uöt64_t
 
Êags
) {

5200 
	`UNUSED
(
˘x
);

5201 i‡(
Êags
 & 
REDISMODULE_CLUSTER_FLAG_NO_FAILOVER
)

5202 
£rvî
.
˛u°î_moduÀ_Êags
 |
CLUSTER_MODULE_FLAG_NO_FAILOVER
;

5203 i‡(
Êags
 & 
REDISMODULE_CLUSTER_FLAG_NO_REDIRECTION
)

5204 
£rvî
.
˛u°î_moduÀ_Êags
 |
CLUSTER_MODULE_FLAG_NO_REDIRECTION
;

5205 
	}
}

5226 
øx
 *
	gTimîs
;

5227 
	g´Timî
 = -1;

5229 (*
	tRedisModuÀTimîProc
)(
	tRedisModuÀCtx
 *
	t˘x
, *
	td©a
);

5232 
	sRedisModuÀTimî
 {

5233 
RedisModuÀ
 *
moduÀ
;

5234 
RedisModuÀTimîProc
 
ˇŒback
;

5235 *
d©a
;

5236 
dbid
;

5237 } 
	tRedisModuÀTimî
;

5241 
	$moduÀTimîH™dÀr
(
´EvítLo›
 *
evítLo›
, 
id
, *
˛õ¡D©a
) {

5242 
	`UNUSED
(
evítLo›
);

5243 
	`UNUSED
(
id
);

5244 
	`UNUSED
(
˛õ¡D©a
);

5247 
øxIãøt‹
 
ri
;

5248 
	`øxSèπ
(&
ri
,
Timîs
);

5249 
uöt64_t
 
now
 = 
	`u°ime
();

5250 
√xt_≥riod
 = 0;

5252 
	`øxSìk
(&
ri
,"^",
NULL
,0);

5253 i‡(!
	`øxNext
(&
ri
)) ;

5254 
uöt64_t
 
expúëime
;

5255 
	`mem˝y
(&
expúëime
,
ri
.
key
,(expiretime));

5256 
expúëime
 = 
	`¡ohu64
(expiretime);

5257 i‡(
now
 >
expúëime
) {

5258 
RedisModuÀTimî
 *
timî
 = 
ri
.
d©a
;

5259 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

5261 
˘x
.
moduÀ
 = 
timî
->module;

5262 
˘x
.
˛õ¡
 = 
moduÀFªeC⁄ãxtReu£dClõ¡
;

5263 
	`£À˘Db
(
˘x
.
˛õ¡
, 
timî
->
dbid
);

5264 
timî
->
	`ˇŒback
(&
˘x
,timî->
d©a
);

5265 
	`moduÀFªeC⁄ãxt
(&
˘x
);

5266 
	`øxRemove
(
Timîs
,(*)
ri
.
key
,ri.
key_Àn
,
NULL
);

5267 
	`z‰ì
(
timî
);

5269 
√xt_≥riod
 = (
expúëime
-
now
)/1000;

5273 
	`øxSt›
(&
ri
);

5276 i‡(
√xt_≥riod
 <= 0)Çext_period = 1;

5277  (
	`øxSize
(
Timîs
Ë> 0Ë? 
√xt_≥riod
 : 
AE_NOMORE
;

5278 
	}
}

5283 
RedisModuÀTimîID
 
	$RM_Cª©eTimî
(
RedisModuÀCtx
 *
˘x
, 
m°ime_t
 
≥riod
, 
RedisModuÀTimîProc
 
ˇŒback
, *
d©a
) {

5284 
RedisModuÀTimî
 *
timî
 = 
	`zmÆloc
((*timer));

5285 
timî
->
moduÀ
 = 
˘x
->module;

5286 
timî
->
ˇŒback
 = callback;

5287 
timî
->
d©a
 = data;

5288 
timî
->
dbid
 = 
˘x
->
˛õ¡
 ? ctx->˛õ¡->
db
->
id
 : 0;

5289 
uöt64_t
 
expúëime
 = 
	`u°ime
()+
≥riod
*1000;

5290 
uöt64_t
 
key
;

5293 
key
 = 
	`ht⁄u64
(
expúëime
);

5294 i‡(
	`øxFöd
(
Timîs
, (*)&
key
,(key)Ë=
øxNŸFound
) {

5295 
	`øxIn£π
(
Timîs
,(*)&
key
,(key),
timî
,
NULL
);

5298 
expúëime
++;

5305 i‡(
´Timî
 != -1) {

5306 
øxIãøt‹
 
ri
;

5307 
	`øxSèπ
(&
ri
,
Timîs
);

5308 
	`øxSìk
(&
ri
,"^",
NULL
,0);

5309 
	`øxNext
(&
ri
);

5310 i‡(
	`memcmp
(
ri
.
key
,&key,(key)) == 0) {

5313 
	`´DñëeTimeEvít
(
£rvî
.
ñ
,
´Timî
);

5314 
´Timî
 = -1;

5316 
	`øxSt›
(&
ri
);

5321 i‡(
´Timî
 == -1)

5322 
´Timî
 = 
	`´Cª©eTimeEvít
(
£rvî
.
ñ
,
≥riod
,
moduÀTimîH™dÀr
,
NULL
,NULL);

5324  
key
;

5325 
	}
}

5331 
	$RM_St›Timî
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀTimîID
 
id
, **
d©a
) {

5332 
RedisModuÀTimî
 *
timî
 = 
	`øxFöd
(
Timîs
,(*)&
id
,(id));

5333 i‡(
timî
 =
øxNŸFound
 ||Åimî->
moduÀ
 !
˘x
->module)

5334  
REDISMODULE_ERR
;

5335 i‡(
d©a
Ë*d©®
timî
->data;

5336 
	`øxRemove
(
Timîs
,(*)&
id
,(id),
NULL
);

5337 
	`z‰ì
(
timî
);

5338  
REDISMODULE_OK
;

5339 
	}
}

5347 
	$RM_GëTimîInfo
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀTimîID
 
id
, 
uöt64_t
 *
ªmaöög
, **
d©a
) {

5348 
RedisModuÀTimî
 *
timî
 = 
	`øxFöd
(
Timîs
,(*)&
id
,(id));

5349 i‡(
timî
 =
øxNŸFound
 ||Åimî->
moduÀ
 !
˘x
->module)

5350  
REDISMODULE_ERR
;

5351 i‡(
ªmaöög
) {

5352 
öt64_t
 
ªm
 = 
	`¡ohu64
(
id
)-
	`u°ime
();

5353 i‡(
ªm
 < 0)Ñem = 0;

5354 *
ªmaöög
 = 
ªm
/1000;

5356 i‡(
d©a
Ë*d©®
timî
->data;

5357  
REDISMODULE_OK
;

5358 
	}
}

5372 
	$moduÀNŸifyU£rCh™ged
(
˛õ¡
 *
c
) {

5373 i‡(
c
->
auth_ˇŒback
) {

5374 
c
->
	`auth_ˇŒback
(c->
id
, c->
auth_ˇŒback_¥ivd©a
);

5379 
c
->
auth_ˇŒback
 = 
NULL
;

5380 
c
->
auth_ˇŒback_¥ivd©a
 = 
NULL
;

5381 
c
->
auth_moduÀ
 = 
NULL
;

5383 
	}
}

5385 
	$ªvokeClõ¡Authítiˇti⁄
(
˛õ¡
 *
c
) {

5391 
	`moduÀNŸifyU£rCh™ged
(
c
);

5393 
c
->
u£r
 = 
DeÁu…U£r
;

5394 
c
->
authítiˇãd
 = 0;

5395 
	`‰ìClõ¡Async
(
c
);

5396 
	}
}

5401 
	$moduÀFªeAuthítiˇãdClõ¡s
(
RedisModuÀ
 *
moduÀ
) {

5402 
li°Iãr
 
li
;

5403 
li°Node
 *
 
;

5404 
	`li°Rewöd
(
£rvî
.
˛õ¡s
,&
li
);

5405 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5406 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

5407 i‡(!
c
->
auth_moduÀ
) ;

5409 
RedisModuÀ
 *
auth_moduÀ
 = (RedisModuÀ *Ë
c
->auth_module;

5410 i‡(
auth_moduÀ
 =
moduÀ
) {

5411 
	`ªvokeClõ¡Authítiˇti⁄
(
c
);

5414 
	}
}

5436 
RedisModuÀU£r
 *
	$RM_Cª©eModuÀU£r
(c⁄° *
«me
) {

5437 
RedisModuÀU£r
 *
√w_u£r
 = 
	`zmÆloc
((RedisModuleUser));

5438 
√w_u£r
->
u£r
 = 
	`ACLCª©eU∆ökedU£r
();

5441 
	`sds‰ì
(
√w_u£r
->
u£r
->
«me
);

5442 
√w_u£r
->
u£r
->
«me
 = 
	`sd¢ew
(name);

5443  
√w_u£r
;

5444 
	}
}

5448 
	$RM_FªeModuÀU£r
(
RedisModuÀU£r
 *
u£r
) {

5449 
	`ACLFªeU£rAndKûlClõ¡s
(
u£r
->user);

5450 
	`z‰ì
(
u£r
);

5451  
REDISMODULE_OK
;

5452 
	}
}

5461 
	$RM_SëModuÀU£rACL
(
RedisModuÀU£r
 *
u£r
, c⁄° * 
a˛
) {

5462  
	`ACLSëU£r
(
u£r
->u£r, 
a˛
, -1);

5463 
	}
}

5485 
	$authítiˇãClõ¡WôhU£r
(
RedisModuÀCtx
 *
˘x
, 
u£r
 *u£r, 
RedisModuÀU£rCh™gedFunc
 
ˇŒback
, *
¥ivd©a
, 
uöt64_t
 *
˛õ¡_id
) {

5486 i‡(
u£r
->
Êags
 & 
USER_FLAG_DISABLED
) {

5487  
REDISMODULE_ERR
;

5490 
	`moduÀNŸifyU£rCh™ged
(
˘x
->
˛õ¡
);

5492 
˘x
->
˛õ¡
->
u£r
 = user;

5493 
˘x
->
˛õ¡
->
authítiˇãd
 = 1;

5495 i‡(
ˇŒback
) {

5496 
˘x
->
˛õ¡
->
auth_ˇŒback
 = 
ˇŒback
;

5497 
˘x
->
˛õ¡
->
auth_ˇŒback_¥ivd©a
 = 
¥ivd©a
;

5498 
˘x
->
˛õ¡
->
auth_moduÀ
 = ctx->
moduÀ
;

5501 i‡(
˛õ¡_id
) {

5502 *
˛õ¡_id
 = 
˘x
->
˛õ¡
->
id
;

5505  
REDISMODULE_OK
;

5506 
	}
}

5514 
	$RM_AuthítiˇãClõ¡WôhU£r
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀU£r
 *
moduÀ_u£r
, 
RedisModuÀU£rCh™gedFunc
 
ˇŒback
, *
¥ivd©a
, 
uöt64_t
 *
˛õ¡_id
) {

5515  
	`authítiˇãClõ¡WôhU£r
(
˘x
, 
moduÀ_u£r
->
u£r
, 
ˇŒback
, 
¥ivd©a
, 
˛õ¡_id
);

5516 
	}
}

5523 
	$RM_AuthítiˇãClõ¡WôhACLU£r
(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
size_t
 
Àn
, 
RedisModuÀU£rCh™gedFunc
 
ˇŒback
, *
¥ivd©a
, 
uöt64_t
 *
˛õ¡_id
) {

5524 
u£r
 *
a˛_u£r
 = 
	`ACLGëU£rByName
(
«me
, 
Àn
);

5526 i‡(!
a˛_u£r
) {

5527  
REDISMODULE_ERR
;

5529  
	`authítiˇãClõ¡WôhU£r
(
˘x
, 
a˛_u£r
, 
ˇŒback
, 
¥ivd©a
, 
˛õ¡_id
);

5530 
	}
}

5544 
	$RM_DóuthítiˇãAndClo£Clõ¡
(
RedisModuÀCtx
 *
˘x
, 
uöt64_t
 
˛õ¡_id
) {

5545 
	`UNUSED
(
˘x
);

5546 
˛õ¡
 *
c
 = 
	`lookupClõ¡ByID
(
˛õ¡_id
);

5547 i‡(
c
 =
NULL
Ë 
REDISMODULE_ERR
;

5550 
	`ªvokeClõ¡Authítiˇti⁄
(
c
);

5551  
REDISMODULE_OK
;

5552 
	}
}

5575 
RedisModuÀDi˘
 *
	$RM_Cª©eDi˘
(
RedisModuÀCtx
 *
˘x
) {

5576 
RedisModuÀDi˘
 *
d
 = 
	`zmÆloc
((*d));

5577 
d
->
øx
 = 
	`øxNew
();

5578 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yAdd
(˘x,
REDISMODULE_AM_DICT
,
d
);

5579  
d
;

5580 
	}
}

5585 
	$RM_FªeDi˘
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀDi˘
 *
d
) {

5586 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yFªed
(˘x,
REDISMODULE_AM_DICT
,
d
);

5587 
	`øxFªe
(
d
->
øx
);

5588 
	`z‰ì
(
d
);

5589 
	}
}

5592 
uöt64_t
 
	$RM_Di˘Size
(
RedisModuÀDi˘
 *
d
) {

5593  
	`øxSize
(
d
->
øx
);

5594 
	}
}

5600 
	$RM_Di˘SëC
(
RedisModuÀDi˘
 *
d
, *
key
, 
size_t
 
keyÀn
, *
±r
) {

5601 
ªtvÆ
 = 
	`øxTryIn£π
(
d
->
øx
,
key
,
keyÀn
,
±r
,
NULL
);

5602  (
ªtvÆ
 =1Ë? 
REDISMODULE_OK
 : 
REDISMODULE_ERR
;

5603 
	}
}

5607 
	$RM_Di˘Rïœ˚C
(
RedisModuÀDi˘
 *
d
, *
key
, 
size_t
 
keyÀn
, *
±r
) {

5608 
ªtvÆ
 = 
	`øxIn£π
(
d
->
øx
,
key
,
keyÀn
,
±r
,
NULL
);

5609  (
ªtvÆ
 =1Ë? 
REDISMODULE_OK
 : 
REDISMODULE_ERR
;

5610 
	}
}

5613 
	$RM_Di˘Së
(
RedisModuÀDi˘
 *
d
, 
RedisModuÀSåög
 *
key
, *
±r
) {

5614  
	`RM_Di˘SëC
(
d
,
key
->
±r
,
	`sd¶í
(key->ptr),ptr);

5615 
	}
}

5618 
	$RM_Di˘Rïœ˚
(
RedisModuÀDi˘
 *
d
, 
RedisModuÀSåög
 *
key
, *
±r
) {

5619  
	`RM_Di˘Rïœ˚C
(
d
,
key
->
±r
,
	`sd¶í
(key->ptr),ptr);

5620 
	}
}

5627 *
	$RM_Di˘GëC
(
RedisModuÀDi˘
 *
d
, *
key
, 
size_t
 
keyÀn
, *
nokey
) {

5628 *
ªs
 = 
	`øxFöd
(
d
->
øx
,
key
,
keyÀn
);

5629 i‡(
nokey
Ë*nokey = (
ªs
 =
øxNŸFound
);

5630  (
ªs
 =
øxNŸFound
Ë? 
NULL
 :Ñes;

5631 
	}
}

5634 *
	$RM_Di˘Gë
(
RedisModuÀDi˘
 *
d
, 
RedisModuÀSåög
 *
key
, *
nokey
) {

5635  
	`RM_Di˘GëC
(
d
,
key
->
±r
,
	`sd¶í
(key->±r),
nokey
);

5636 
	}
}

5645 
	$RM_Di˘DñC
(
RedisModuÀDi˘
 *
d
, *
key
, 
size_t
 
keyÀn
, *
ﬁdvÆ
) {

5646 
ªtvÆ
 = 
	`øxRemove
(
d
->
øx
,
key
,
keyÀn
,
ﬁdvÆ
);

5647  
ªtvÆ
 ? 
REDISMODULE_OK
 : 
REDISMODULE_ERR
;

5648 
	}
}

5651 
	$RM_Di˘Dñ
(
RedisModuÀDi˘
 *
d
, 
RedisModuÀSåög
 *
key
, *
ﬁdvÆ
) {

5652  
	`RM_Di˘DñC
(
d
,
key
->
±r
,
	`sd¶í
(key->±r),
ﬁdvÆ
);

5653 
	}
}

5675 
RedisModuÀDi˘Iãr
 *
	$RM_Di˘Iãøt‹SèπC
(
RedisModuÀDi˘
 *
d
, c⁄° *
›
, *
key
, 
size_t
 
keyÀn
) {

5676 
RedisModuÀDi˘Iãr
 *
di
 = 
	`zmÆloc
((*di));

5677 
di
->
di˘
 = 
d
;

5678 
	`øxSèπ
(&
di
->
ri
,
d
->
øx
);

5679 
	`øxSìk
(&
di
->
ri
,
›
,
key
,
keyÀn
);

5680  
di
;

5681 
	}
}

5685 
RedisModuÀDi˘Iãr
 *
	$RM_Di˘Iãøt‹Sèπ
(
RedisModuÀDi˘
 *
d
, c⁄° *
›
, 
RedisModuÀSåög
 *
key
) {

5686  
	`RM_Di˘Iãøt‹SèπC
(
d
,
›
,
key
->
±r
,
	`sd¶í
(key->ptr));

5687 
	}
}

5691 
	$RM_Di˘Iãøt‹St›
(
RedisModuÀDi˘Iãr
 *
di
) {

5692 
	`øxSt›
(&
di
->
ri
);

5693 
	`z‰ì
(
di
);

5694 
	}
}

5703 
	$RM_Di˘Iãøt‹Re£ekC
(
RedisModuÀDi˘Iãr
 *
di
, c⁄° *
›
, *
key
, 
size_t
 
keyÀn
) {

5704  
	`øxSìk
(&
di
->
ri
,
›
,
key
,
keyÀn
);

5705 
	}
}

5709 
	$RM_Di˘Iãøt‹Re£ek
(
RedisModuÀDi˘Iãr
 *
di
, c⁄° *
›
, 
RedisModuÀSåög
 *
key
) {

5710  
	`RM_Di˘Iãøt‹Re£ekC
(
di
,
›
,
key
->
±r
,
	`sd¶í
(key->ptr));

5711 
	}
}

5738 *
	$RM_Di˘NextC
(
RedisModuÀDi˘Iãr
 *
di
, 
size_t
 *
keyÀn
, **
d©≠å
) {

5739 i‡(!
	`øxNext
(&
di
->
ri
)Ë 
NULL
;

5740 i‡(
keyÀn
Ë*keyÀ¿
di
->
ri
.
key_Àn
;

5741 i‡(
d©≠å
Ë*d©≠å = 
di
->
ri
.
d©a
;

5742  
di
->
ri
.
key
;

5743 
	}
}

5748 *
	$RM_Di˘PªvC
(
RedisModuÀDi˘Iãr
 *
di
, 
size_t
 *
keyÀn
, **
d©≠å
) {

5749 i‡(!
	`øxPªv
(&
di
->
ri
)Ë 
NULL
;

5750 i‡(
keyÀn
Ë*keyÀ¿
di
->
ri
.
key_Àn
;

5751 i‡(
d©≠å
Ë*d©≠å = 
di
->
ri
.
d©a
;

5752  
di
->
ri
.
key
;

5753 
	}
}

5762 
RedisModuÀSåög
 *
	$RM_Di˘Next
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀDi˘Iãr
 *
di
, **
d©≠å
) {

5763 
size_t
 
keyÀn
;

5764 *
key
 = 
	`RM_Di˘NextC
(
di
,&
keyÀn
,
d©≠å
);

5765 i‡(
key
 =
NULL
)  NULL;

5766  
	`RM_Cª©eSåög
(
˘x
,
key
,
keyÀn
);

5767 
	}
}

5772 
RedisModuÀSåög
 *
	$RM_Di˘Pªv
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀDi˘Iãr
 *
di
, **
d©≠å
) {

5773 
size_t
 
keyÀn
;

5774 *
key
 = 
	`RM_Di˘PªvC
(
di
,&
keyÀn
,
d©≠å
);

5775 i‡(
key
 =
NULL
)  NULL;

5776  
	`RM_Cª©eSåög
(
˘x
,
key
,
keyÀn
);

5777 
	}
}

5791 
	$RM_Di˘Com∑ªC
(
RedisModuÀDi˘Iãr
 *
di
, c⁄° *
›
, *
key
, 
size_t
 
keyÀn
) {

5792 i‡(
	`øxEOF
(&
di
->
ri
)Ë 
REDISMODULE_ERR
;

5793 
ªs
 = 
	`øxCom∑ª
(&
di
->
ri
,
›
,
key
,
keyÀn
);

5794  
ªs
 ? 
REDISMODULE_OK
 : 
REDISMODULE_ERR
;

5795 
	}
}

5799 
	$RM_Di˘Com∑ª
(
RedisModuÀDi˘Iãr
 *
di
, c⁄° *
›
, 
RedisModuÀSåög
 *
key
) {

5800 i‡(
	`øxEOF
(&
di
->
ri
)Ë 
REDISMODULE_ERR
;

5801 
ªs
 = 
	`øxCom∑ª
(&
di
->
ri
,
›
,
key
->
±r
,
	`sd¶í
(key->ptr));

5802  
ªs
 ? 
REDISMODULE_OK
 : 
REDISMODULE_ERR
;

5803 
	}
}

5812 
RM_InfoEndDi˘Fõld
(
RedisModuÀInfoCtx
 *
˘x
);

5818 
	$RM_InfoAddSe˘i⁄
(
RedisModuÀInfoCtx
 *
˘x
, *
«me
) {

5819 
sds
 
fuŒ_«me
 = 
	`sdsdup
(
˘x
->
moduÀ
->
«me
);

5820 i‡(
«me
 !
NULL
 && 
	`°æí
(name) > 0)

5821 
fuŒ_«me
 = 
	`sdsˇtfmt
(fuŒ_«me, "_%s", 
«me
);

5824 i‡(
˘x
->
ö_di˘_fõld
)

5825 
	`RM_InfoEndDi˘Fõld
(
˘x
);

5831 i‡(
˘x
->
ªque°ed_£˘i⁄
) {

5832 i‡(
	`°rˇ£cmp
(
˘x
->
ªque°ed_£˘i⁄
, 
fuŒ_«me
) &&

5833 
	`°rˇ£cmp
(
˘x
->
ªque°ed_£˘i⁄
, ctx->
moduÀ
->
«me
)) {

5834 
	`sds‰ì
(
fuŒ_«me
);

5835 
˘x
->
ö_£˘i⁄
 = 0;

5836  
REDISMODULE_ERR
;

5839 i‡(
˘x
->
£˘i⁄s
++Ë˘x->
öfo
 = 
	`sdsˇt
(ctx->info,"\r\n");

5840 
˘x
->
öfo
 = 
	`sdsˇtfmt
(˘x->öfo, "# %S\r\n", 
fuŒ_«me
);

5841 
˘x
->
ö_£˘i⁄
 = 1;

5842 
	`sds‰ì
(
fuŒ_«me
);

5843  
REDISMODULE_OK
;

5844 
	}
}

5849 
	$RM_InfoBegöDi˘Fõld
(
RedisModuÀInfoCtx
 *
˘x
, *
«me
) {

5850 i‡(!
˘x
->
ö_£˘i⁄
)

5851  
REDISMODULE_ERR
;

5853 i‡(
˘x
->
ö_di˘_fõld
)

5854 
	`RM_InfoEndDi˘Fõld
(
˘x
);

5855 
˘x
->
öfo
 = 
	`sdsˇtfmt
(ctx->info,

5857 
˘x
->
moduÀ
->
«me
,

5858 
«me
);

5859 
˘x
->
ö_di˘_fõld
 = 1;

5860  
REDISMODULE_OK
;

5861 
	}
}

5864 
	$RM_InfoEndDi˘Fõld
(
RedisModuÀInfoCtx
 *
˘x
) {

5865 i‡(!
˘x
->
ö_di˘_fõld
)

5866  
REDISMODULE_ERR
;

5868 i‡(
˘x
->
öfo
[
	`sd¶í
(ctx->info)-1]==',')

5869 
	`sdsIn¸Lí
(
˘x
->
öfo
, -1);

5870 
˘x
->
öfo
 = 
	`sdsˇt
(ctx->info, "\r\n");

5871 
˘x
->
ö_di˘_fõld
 = 0;

5872  
REDISMODULE_OK
;

5873 
	}
}

5878 
	$RM_InfoAddFõldSåög
(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, 
RedisModuÀSåög
 *
vÆue
) {

5879 i‡(!
˘x
->
ö_£˘i⁄
)

5880  
REDISMODULE_ERR
;

5881 i‡(
˘x
->
ö_di˘_fõld
) {

5882 
˘x
->
öfo
 = 
	`sdsˇtfmt
(ctx->info,

5884 
fõld
,

5885 (
sds
)
vÆue
->
±r
);

5886  
REDISMODULE_OK
;

5888 
˘x
->
öfo
 = 
	`sdsˇtfmt
(ctx->info,

5890 
˘x
->
moduÀ
->
«me
,

5891 
fõld
,

5892 (
sds
)
vÆue
->
±r
);

5893  
REDISMODULE_OK
;

5894 
	}
}

5896 
	$RM_InfoAddFõldCSåög
(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, *
vÆue
) {

5897 i‡(!
˘x
->
ö_£˘i⁄
)

5898  
REDISMODULE_ERR
;

5899 i‡(
˘x
->
ö_di˘_fõld
) {

5900 
˘x
->
öfo
 = 
	`sdsˇtfmt
(ctx->info,

5902 
fõld
,

5903 
vÆue
);

5904  
REDISMODULE_OK
;

5906 
˘x
->
öfo
 = 
	`sdsˇtfmt
(ctx->info,

5908 
˘x
->
moduÀ
->
«me
,

5909 
fõld
,

5910 
vÆue
);

5911  
REDISMODULE_OK
;

5912 
	}
}

5914 
	$RM_InfoAddFõldDoubÀ
(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, 
vÆue
) {

5915 i‡(!
˘x
->
ö_£˘i⁄
)

5916  
REDISMODULE_ERR
;

5917 i‡(
˘x
->
ö_di˘_fõld
) {

5918 
˘x
->
öfo
 = 
	`sdsˇçrötf
(ctx->info,

5920 
fõld
,

5921 
vÆue
);

5922  
REDISMODULE_OK
;

5924 
˘x
->
öfo
 = 
	`sdsˇçrötf
(ctx->info,

5926 
˘x
->
moduÀ
->
«me
,

5927 
fõld
,

5928 
vÆue
);

5929  
REDISMODULE_OK
;

5930 
	}
}

5932 
	$RM_InfoAddFõldL⁄gL⁄g
(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, 
vÆue
) {

5933 i‡(!
˘x
->
ö_£˘i⁄
)

5934  
REDISMODULE_ERR
;

5935 i‡(
˘x
->
ö_di˘_fõld
) {

5936 
˘x
->
öfo
 = 
	`sdsˇtfmt
(ctx->info,

5938 
fõld
,

5939 
vÆue
);

5940  
REDISMODULE_OK
;

5942 
˘x
->
öfo
 = 
	`sdsˇtfmt
(ctx->info,

5944 
˘x
->
moduÀ
->
«me
,

5945 
fõld
,

5946 
vÆue
);

5947  
REDISMODULE_OK
;

5948 
	}
}

5950 
	$RM_InfoAddFõldUL⁄gL⁄g
(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, 
vÆue
) {

5951 i‡(!
˘x
->
ö_£˘i⁄
)

5952  
REDISMODULE_ERR
;

5953 i‡(
˘x
->
ö_di˘_fõld
) {

5954 
˘x
->
öfo
 = 
	`sdsˇtfmt
(ctx->info,

5956 
fõld
,

5957 
vÆue
);

5958  
REDISMODULE_OK
;

5960 
˘x
->
öfo
 = 
	`sdsˇtfmt
(ctx->info,

5962 
˘x
->
moduÀ
->
«me
,

5963 
fõld
,

5964 
vÆue
);

5965  
REDISMODULE_OK
;

5966 
	}
}

5968 
	$RM_Regi°îInfoFunc
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀInfoFunc
 
cb
) {

5969 
˘x
->
moduÀ
->
öfo_cb
 = 
cb
;

5970  
REDISMODULE_OK
;

5971 
	}
}

5973 
sds
 
	$moduÀsCﬁÀ˘Info
(
sds
 
öfo
, c⁄° *
£˘i⁄
, 
f‹_¸ash_ªp‹t
, 
£˘i⁄s
) {

5974 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
moduÀs
);

5975 
di˘E¡ry
 *
de
;

5977 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

5978 
RedisModuÀ
 *
moduÀ
 = 
	`di˘GëVÆ
(
de
);

5979 i‡(!
moduÀ
->
öfo_cb
)

5981 
RedisModuÀInfoCtx
 
öfo_˘x
 = {
moduÀ
, 
£˘i⁄
, 
öfo
, 
£˘i⁄s
, 0, 0};

5982 
moduÀ
->
	`öfo_cb
(&
öfo_˘x
, 
f‹_¸ash_ªp‹t
);

5984 i‡(
öfo_˘x
.
ö_di˘_fõld
)

5985 
	`RM_InfoEndDi˘Fõld
(&
öfo_˘x
);

5986 
öfo
 = 
öfo_˘x
.info;

5987 
£˘i⁄s
 = 
öfo_˘x
.sections;

5989 
	`di˘Rñó£Iãøt‹
(
di
);

5990  
öfo
;

5991 
	}
}

5999 
RedisModuÀSîvîInfoD©a
 *
	$RM_GëSîvîInfo
(
RedisModuÀCtx
 *
˘x
, c⁄° *
£˘i⁄
) {

6000 
RedisModuÀSîvîInfoD©a
 *
d
 = 
	`zmÆloc
((*d));

6001 
d
->
øx
 = 
	`øxNew
();

6002 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yAdd
(˘x,
REDISMODULE_AM_INFO
,
d
);

6003 
sds
 
öfo
 = 
	`gíRedisInfoSåög
(
£˘i⁄
);

6004 
tŸlöes
, 
i
;

6005 
sds
 *
löes
 = 
	`sds•lôÀn
(
öfo
, 
	`sd¶í
(öfo), "\r\n", 2, &
tŸlöes
);

6006 
i
=0; i<
tŸlöes
; i++) {

6007 
sds
 
löe
 = 
löes
[
i
];

6008 i‡(
löe
[0]=='#') ;

6009 *
£p
 = 
	`°rchr
(
löe
, ':');

6010 i‡(!
£p
) ;

6011 *
key
 = (*)
löe
;

6012 
size_t
 
keyÀn
 = (
öçå_t
)
£p
-(öçå_t)
löe
;

6013 
sds
 
vÆ
 = 
	`sd¢ewÀn
(
£p
+1,
	`sd¶í
(
löe
)-((
öçå_t
)sep-(intptr_t)line)-1);

6014 i‡(!
	`øxTryIn£π
(
d
->
øx
,
key
,
keyÀn
,
vÆ
,
NULL
))

6015 
	`sds‰ì
(
vÆ
);

6017 
	`sds‰ì
(
öfo
);

6018 
	`sds‰ì•lôªs
(
löes
,
tŸlöes
);

6019  
d
;

6020 
	}
}

6025 
	$RM_FªeSîvîInfo
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSîvîInfoD©a
 *
d©a
) {

6026 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yFªed
(˘x,
REDISMODULE_AM_INFO
,
d©a
);

6027 
øxIãøt‹
 
ri
;

6028 
	`øxSèπ
(&
ri
,
d©a
->
øx
);

6030 
	`øxSìk
(&
ri
,"^",
NULL
,0);

6031 i‡(!
	`øxNext
(&
ri
)) ;

6032 
	`øxRemove
(
d©a
->
øx
,(*)
ri
.
key
,ri.
key_Àn
,
NULL
);

6033 
	`sds‰ì
(
ri
.
d©a
);

6035 
	`øxSt›
(&
ri
);

6036 
	`øxFªe
(
d©a
->
øx
);

6037 
	`z‰ì
(
d©a
);

6038 
	}
}

6044 
RedisModuÀSåög
 *
	$RM_SîvîInfoGëFõld
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
) {

6045 
sds
 
vÆ
 = 
	`øxFöd
(
d©a
->
øx
, (*)
fõld
, 
	`°æí
(field));

6046 i‡(
vÆ
 =
øxNŸFound
Ë 
NULL
;

6047 
RedisModuÀSåög
 *
o
 = 
	`¸óãSåögObje˘
(
vÆ
,
	`sd¶í
(val));

6048 i‡(
˘x
 !
NULL
Ë
	`autoMem‹yAdd
(˘x,
REDISMODULE_AM_STRING
,
o
);

6049  
o
;

6050 
	}
}

6053 c⁄° *
	$RM_SîvîInfoGëFõldC
(
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
) {

6054 
sds
 
vÆ
 = 
	`øxFöd
(
d©a
->
øx
, (*)
fõld
, 
	`°æí
(field));

6055 i‡(
vÆ
 =
øxNŸFound
Ë 
NULL
;

6056  
vÆ
;

6057 
	}
}

6062 
	$RM_SîvîInfoGëFõldSig√d
(
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
, *
out_îr
) {

6063 
Œ
;

6064 
sds
 
vÆ
 = 
	`øxFöd
(
d©a
->
øx
, (*)
fõld
, 
	`°æí
(field));

6065 i‡(
vÆ
 =
øxNŸFound
) {

6066 i‡(
out_îr
Ë*out_î∏
REDISMODULE_ERR
;

6069 i‡(!
	`°rög2Œ
(
vÆ
,
	`sd¶í
(vÆ),&
Œ
)) {

6070 i‡(
out_îr
Ë*out_î∏
REDISMODULE_ERR
;

6073 i‡(
out_îr
Ë*out_î∏
REDISMODULE_OK
;

6074  
Œ
;

6075 
	}
}

6080 
	$RM_SîvîInfoGëFõldUnsig√d
(
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
, *
out_îr
) {

6081 
Œ
;

6082 
sds
 
vÆ
 = 
	`øxFöd
(
d©a
->
øx
, (*)
fõld
, 
	`°æí
(field));

6083 i‡(
vÆ
 =
øxNŸFound
) {

6084 i‡(
out_îr
Ë*out_î∏
REDISMODULE_ERR
;

6087 i‡(!
	`°rög2uŒ
(
vÆ
,&
Œ
)) {

6088 i‡(
out_îr
Ë*out_î∏
REDISMODULE_ERR
;

6091 i‡(
out_îr
Ë*out_î∏
REDISMODULE_OK
;

6092  
Œ
;

6093 
	}
}

6098 
	$RM_SîvîInfoGëFõldDoubÀ
(
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
, *
out_îr
) {

6099 
dbl
;

6100 
sds
 
vÆ
 = 
	`øxFöd
(
d©a
->
øx
, (*)
fõld
, 
	`°æí
(field));

6101 i‡(
vÆ
 =
øxNŸFound
) {

6102 i‡(
out_îr
Ë*out_î∏
REDISMODULE_ERR
;

6105 i‡(!
	`°rög2d
(
vÆ
,
	`sd¶í
(vÆ),&
dbl
)) {

6106 i‡(
out_îr
Ë*out_î∏
REDISMODULE_ERR
;

6109 i‡(
out_îr
Ë*out_î∏
REDISMODULE_OK
;

6110  
dbl
;

6111 
	}
}

6121 
	$RM_GëR™domByãs
(*
d°
, 
size_t
 
Àn
) {

6122 
	`gëR™domByãs
(
d°
,
Àn
);

6123 
	}
}

6128 
	$RM_GëR™domHexCh¨s
(*
d°
, 
size_t
 
Àn
) {

6129 
	`gëR™domHexCh¨s
(
d°
,
Àn
);

6130 
	}
}

6148 
	$RM_Exp‹tSh¨edAPI
(
RedisModuÀCtx
 *
˘x
, c⁄° *
≠öame
, *
func
) {

6149 
RedisModuÀSh¨edAPI
 *
ßpi
 = 
	`zmÆloc
((*sapi));

6150 
ßpi
->
moduÀ
 = 
˘x
->module;

6151 
ßpi
->
func
 = func;

6152 i‡(
	`di˘Add
(
£rvî
.
sh¨ed≠i
, (*)
≠öame
, 
ßpi
Ë!
DICT_OK
) {

6153 
	`z‰ì
(
ßpi
);

6154  
REDISMODULE_ERR
;

6156  
REDISMODULE_OK
;

6157 
	}
}

6192 *
	$RM_GëSh¨edAPI
(
RedisModuÀCtx
 *
˘x
, c⁄° *
≠öame
) {

6193 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
£rvî
.
sh¨ed≠i
, 
≠öame
);

6194 i‡(
de
 =
NULL
)  NULL;

6195 
RedisModuÀSh¨edAPI
 *
ßpi
 = 
	`di˘GëVÆ
(
de
);

6196 i‡(
	`li°SórchKey
(
ßpi
->
moduÀ
->
u£dby
,
˘x
->moduÀË=
NULL
) {

6197 
	`li°AddNodeTaû
(
ßpi
->
moduÀ
->
u£dby
,
˘x
->module);

6198 
	`li°AddNodeTaû
(
˘x
->
moduÀ
->
usög
,
ßpi
->module);

6200  
ßpi
->
func
;

6201 
	}
}

6209 
	$moduÀUƒegi°îSh¨edAPI
(
RedisModuÀ
 *
moduÀ
) {

6210 
cou¡
 = 0;

6211 
di˘Iãøt‹
 *
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
sh¨ed≠i
);

6212 
di˘E¡ry
 *
de
;

6213 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

6214 c⁄° *
≠öame
 = 
	`di˘GëKey
(
de
);

6215 
RedisModuÀSh¨edAPI
 *
ßpi
 = 
	`di˘GëVÆ
(
de
);

6216 i‡(
ßpi
->
moduÀ
 == module) {

6217 
	`di˘Dñëe
(
£rvî
.
sh¨ed≠i
,
≠öame
);

6218 
	`z‰ì
(
ßpi
);

6219 
cou¡
++;

6222 
	`di˘Rñó£Iãøt‹
(
di
);

6223  
cou¡
;

6224 
	}
}

6230 
	$moduÀUƒegi°îU£dAPI
(
RedisModuÀ
 *
moduÀ
) {

6231 
li°Iãr
 
li
;

6232 
li°Node
 *
 
;

6233 
cou¡
 = 0;

6235 
	`li°Rewöd
(
moduÀ
->
usög
,&
li
);

6236 (
 
 = 
	`li°Next
(&
li
))) {

6237 
RedisModuÀ
 *
u£d
 = 
 
->
vÆue
;

6238 
li°Node
 *
 
 = 
	`li°SórchKey
(
u£d
->
u£dby
,
moduÀ
);

6239 i‡(
 
) {

6240 
	`li°DñNode
(
u£d
->
u£dby
,
 
);

6241 
cou¡
++;

6244  
cou¡
;

6245 
	}
}

6251 
	$moduÀUƒegi°îFûãrs
(
RedisModuÀ
 *
moduÀ
) {

6252 
li°Iãr
 
li
;

6253 
li°Node
 *
 
;

6254 
cou¡
 = 0;

6256 
	`li°Rewöd
(
moduÀ
->
fûãrs
,&
li
);

6257 (
 
 = 
	`li°Next
(&
li
))) {

6258 
RedisModuÀComm™dFûãr
 *
fûãr
 = 
 
->
vÆue
;

6259 
li°Node
 *
 
 = 
	`li°SórchKey
(
moduÀComm™dFûãrs
,
fûãr
);

6260 i‡(
 
) {

6261 
	`li°DñNode
(
moduÀComm™dFûãrs
,
 
);

6262 
cou¡
++;

6264 
	`z‰ì
(
fûãr
);

6266  
cou¡
;

6267 
	}
}

6325 
RedisModuÀComm™dFûãr
 *
	$RM_Regi°îComm™dFûãr
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀComm™dFûãrFunc
 
ˇŒback
, 
Êags
) {

6326 
RedisModuÀComm™dFûãr
 *
fûãr
 = 
	`zmÆloc
((*filter));

6327 
fûãr
->
moduÀ
 = 
˘x
->module;

6328 
fûãr
->
ˇŒback
 = callback;

6329 
fûãr
->
Êags
 = flags;

6331 
	`li°AddNodeTaû
(
moduÀComm™dFûãrs
, 
fûãr
);

6332 
	`li°AddNodeTaû
(
˘x
->
moduÀ
->
fûãrs
, 
fûãr
);

6333  
fûãr
;

6334 
	}
}

6338 
	$RM_Uƒegi°îComm™dFûãr
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀComm™dFûãr
 *
fûãr
) {

6339 
li°Node
 *
 
;

6342 i‡(
fûãr
->
moduÀ
 !
˘x
->moduÀË 
REDISMODULE_ERR
;

6344 
 
 = 
	`li°SórchKey
(
moduÀComm™dFûãrs
,
fûãr
);

6345 i‡(!
 
Ë 
REDISMODULE_ERR
;

6346 
	`li°DñNode
(
moduÀComm™dFûãrs
,
 
);

6348 
 
 = 
	`li°SórchKey
(
˘x
->
moduÀ
->
fûãrs
,
fûãr
);

6349 i‡(!
 
Ë 
REDISMODULE_ERR
;

6350 
	`li°DñNode
(
˘x
->
moduÀ
->
fûãrs
,
 
);

6352 
	`z‰ì
(
fûãr
);

6354  
REDISMODULE_OK
;

6355 
	}
}

6357 
	$moduÀCÆlComm™dFûãrs
(
˛õ¡
 *
c
) {

6358 i‡(
	`li°Lígth
(
moduÀComm™dFûãrs
) == 0) ;

6360 
li°Iãr
 
li
;

6361 
li°Node
 *
 
;

6362 
	`li°Rewöd
(
moduÀComm™dFûãrs
,&
li
);

6364 
RedisModuÀComm™dFûãrCtx
 
fûãr
 = {

6365 .
¨gv
 = 
c
->argv,

6366 .
¨gc
 = 
c
->argc

6369 (
 
 = 
	`li°Next
(&
li
))) {

6370 
RedisModuÀComm™dFûãr
 *
f
 = 
 
->
vÆue
;

6375 i‡((
f
->
Êags
 & 
REDISMODULE_CMDFILTER_NOSELF
Ë&& f->
moduÀ
->
ö_ˇŒ
) ;

6378 
f
->
	`ˇŒback
(&
fûãr
);

6381 
c
->
¨gv
 = 
fûãr
.argv;

6382 
c
->
¨gc
 = 
fûãr
.argc;

6383 
	}
}

6388 
	$RM_Comm™dFûãrArgsCou¡
(
RedisModuÀComm™dFûãrCtx
 *
f˘x
)

6390  
f˘x
->
¨gc
;

6391 
	}
}

6396 c⁄° 
RedisModuÀSåög
 *
	$RM_Comm™dFûãrArgGë
(
RedisModuÀComm™dFûãrCtx
 *
f˘x
, 
pos
)

6398 i‡(
pos
 < 0 ||Öo†>
f˘x
->
¨gc
Ë 
NULL
;

6399  
f˘x
->
¨gv
[
pos
];

6400 
	}
}

6408 
	$RM_Comm™dFûãrArgIn£π
(
RedisModuÀComm™dFûãrCtx
 *
f˘x
, 
pos
, 
RedisModuÀSåög
 *
¨g
)

6410 
i
;

6412 i‡(
pos
 < 0 ||Öo†> 
f˘x
->
¨gc
Ë 
REDISMODULE_ERR
;

6414 
f˘x
->
¨gv
 = 
	`zªÆloc
(f˘x->¨gv, (f˘x->
¨gc
+1)*(
RedisModuÀSåög
 *));

6415 
i
 = 
f˘x
->
¨gc
; i > 
pos
; i--) {

6416 
f˘x
->
¨gv
[
i
] = fctx->argv[i-1];

6418 
f˘x
->
¨gv
[
pos
] = 
¨g
;

6419 
f˘x
->
¨gc
++;

6421  
REDISMODULE_OK
;

6422 
	}
}

6430 
	$RM_Comm™dFûãrArgRïœ˚
(
RedisModuÀComm™dFûãrCtx
 *
f˘x
, 
pos
, 
RedisModuÀSåög
 *
¨g
)

6432 i‡(
pos
 < 0 ||Öo†>
f˘x
->
¨gc
Ë 
REDISMODULE_ERR
;

6434 
	`de¸RefCou¡
(
f˘x
->
¨gv
[
pos
]);

6435 
f˘x
->
¨gv
[
pos
] = 
¨g
;

6437  
REDISMODULE_OK
;

6438 
	}
}

6443 
	$RM_Comm™dFûãrArgDñëe
(
RedisModuÀComm™dFûãrCtx
 *
f˘x
, 
pos
)

6445 
i
;

6446 i‡(
pos
 < 0 ||Öo†>
f˘x
->
¨gc
Ë 
REDISMODULE_ERR
;

6448 
	`de¸RefCou¡
(
f˘x
->
¨gv
[
pos
]);

6449 
i
 = 
pos
; i < 
f˘x
->
¨gc
-1; i++) {

6450 
f˘x
->
¨gv
[
i
] = fctx->argv[i+1];

6452 
f˘x
->
¨gc
--;

6454  
REDISMODULE_OK
;

6455 
	}
}

6463 
size_t
 
	$RM_MÆlocSize
(* 
±r
){

6464  
	`zmÆloc_size
(
±r
);

6465 
	}
}

6475 
	$RM_GëU£dMem‹yR©io
(){

6476 
Àvñ
;

6477 
	`gëMaxmem‹ySèã
(
NULL
, NULL, NULL, &
Àvñ
);

6478  
Àvñ
;

6479 
	}
}

6485 (*
	tRedisModuÀSˇnCB
)(
	tRedisModuÀCtx
 *
	t˘x
, 
	tRedisModuÀSåög
 *
	tkey«me
, 
	tRedisModuÀKey
 *
	tkey
, *
	t¥ivd©a
);

6487 
RedisModuÀCtx
 *
˘x
;

6488 * 
u£r_d©a
;

6489 
RedisModuÀSˇnCB
 
‚
;

6490 } 
	tSˇnCBD©a
;

6492 
	sRedisModuÀSˇnCurs‹
{

6493 
curs‹
;

6494 
d⁄e
;

6495 }
	tRedisModuÀSˇnCurs‹
;

6497 
	$moduÀSˇnCÆlback
(*
¥ivd©a
, c⁄° 
di˘E¡ry
 *
de
) {

6498 
SˇnCBD©a
 *
d©a
 = 
¥ivd©a
;

6499 
sds
 
key
 = 
	`di˘GëKey
(
de
);

6500 
robj
* 
vÆ
 = 
	`di˘GëVÆ
(
de
);

6501 
RedisModuÀSåög
 *
key«me
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sdsdup
(
key
));

6504 
RedisModuÀKey
 
kp
 = {0};

6505 
	`moduÀInôKey
(&
kp
, 
d©a
->
˘x
, 
key«me
, 
vÆ
, 
REDISMODULE_READ
);

6507 
d©a
->
	`‚
(d©a->
˘x
, 
key«me
, &
kp
, d©a->
u£r_d©a
);

6509 
	`moduÀClo£Key
(&
kp
);

6510 
	`de¸RefCou¡
(
key«me
);

6511 
	}
}

6514 
RedisModuÀSˇnCurs‹
 *
	$RM_SˇnCurs‹Cª©e
() {

6515 
RedisModuÀSˇnCurs‹
* 
curs‹
 = 
	`zmÆloc
((*cursor));

6516 
curs‹
->cursor = 0;

6517 
curs‹
->
d⁄e
 = 0;

6518  
curs‹
;

6519 
	}
}

6522 
	$RM_SˇnCurs‹Re°¨t
(
RedisModuÀSˇnCurs‹
 *
curs‹
) {

6523 
curs‹
->cursor = 0;

6524 
curs‹
->
d⁄e
 = 0;

6525 
	}
}

6528 
	$RM_SˇnCurs‹De°roy
(
RedisModuÀSˇnCurs‹
 *
curs‹
) {

6529 
	`z‰ì
(
curs‹
);

6530 
	}
}

6587 
	$RM_Sˇn
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSˇnCurs‹
 *
curs‹
, 
RedisModuÀSˇnCB
 
‚
, *
¥ivd©a
) {

6588 i‡(
curs‹
->
d⁄e
) {

6589 
î∫o
 = 
ENOENT
;

6592 
ªt
 = 1;

6593 
SˇnCBD©a
 
d©a
 = { 
˘x
, 
¥ivd©a
, 
‚
 };

6594 
curs‹
->curs‹ = 
	`di˘Sˇn
(
˘x
->
˛õ¡
->
db
->
di˘
, curs‹->curs‹, 
moduÀSˇnCÆlback
, 
NULL
, &
d©a
);

6595 i‡(
curs‹
->cursor == 0) {

6596 
curs‹
->
d⁄e
 = 1;

6597 
ªt
 = 0;

6599 
î∫o
 = 0;

6600  
ªt
;

6601 
	}
}

6603 (*
	tRedisModuÀSˇnKeyCB
)(
	tRedisModuÀKey
 *
	tkey
, 
	tRedisModuÀSåög
 *
	tfõld
, RedisModuÀSåög *
	tvÆue
, *
	t¥ivd©a
);

6605 
RedisModuÀKey
 *
key
;

6606 * 
u£r_d©a
;

6607 
RedisModuÀSˇnKeyCB
 
‚
;

6608 } 
	tSˇnKeyCBD©a
;

6610 
	$moduÀSˇnKeyCÆlback
(*
¥ivd©a
, c⁄° 
di˘E¡ry
 *
de
) {

6611 
SˇnKeyCBD©a
 *
d©a
 = 
¥ivd©a
;

6612 
sds
 
key
 = 
	`di˘GëKey
(
de
);

6613 
robj
 *
o
 = 
d©a
->
key
->
vÆue
;

6614 
robj
 *
fõld
 = 
	`¸óãSåögObje˘
(
key
, 
	`sd¶í
(key));

6615 
robj
 *
vÆue
 = 
NULL
;

6616 i‡(
o
->
ty≥
 =
OBJ_SET
) {

6617 
vÆue
 = 
NULL
;

6618 } i‡(
o
->
ty≥
 =
OBJ_HASH
) {

6619 
sds
 
vÆ
 = 
	`di˘GëVÆ
(
de
);

6620 
vÆue
 = 
	`¸óãSåögObje˘
(
vÆ
, 
	`sd¶í
(val));

6621 } i‡(
o
->
ty≥
 =
OBJ_ZSET
) {

6622 *
vÆ
 = (*)
	`di˘GëVÆ
(
de
);

6623 
vÆue
 = 
	`¸óãSåögObje˘FromL⁄gDoubÀ
(*
vÆ
, 0);

6626 
d©a
->
	`‚
(d©a->
key
, 
fõld
, 
vÆue
, d©a->
u£r_d©a
);

6627 
	`de¸RefCou¡
(
fõld
);

6628 i‡(
vÆue
Ë
	`de¸RefCou¡
(value);

6629 
	}
}

6675 
	$RM_SˇnKey
(
RedisModuÀKey
 *
key
, 
RedisModuÀSˇnCurs‹
 *
curs‹
, 
RedisModuÀSˇnKeyCB
 
‚
, *
¥ivd©a
) {

6676 i‡(
key
 =
NULL
 || key->
vÆue
 == NULL) {

6677 
î∫o
 = 
EINVAL
;

6680 
di˘
 *
ht
 = 
NULL
;

6681 
robj
 *
o
 = 
key
->
vÆue
;

6682 i‡(
o
->
ty≥
 =
OBJ_SET
) {

6683 i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
)

6684 
ht
 = 
o
->
±r
;

6685 } i‡(
o
->
ty≥
 =
OBJ_HASH
) {

6686 i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
)

6687 
ht
 = 
o
->
±r
;

6688 } i‡(
o
->
ty≥
 =
OBJ_ZSET
) {

6689 i‡(
o
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
)

6690 
ht
 = ((
z£t
 *)
o
->
±r
)->
di˘
;

6692 
î∫o
 = 
EINVAL
;

6695 i‡(
curs‹
->
d⁄e
) {

6696 
î∫o
 = 
ENOENT
;

6699 
ªt
 = 1;

6700 i‡(
ht
) {

6701 
SˇnKeyCBD©a
 
d©a
 = { 
key
, 
¥ivd©a
, 
‚
 };

6702 
curs‹
->curs‹ = 
	`di˘Sˇn
(
ht
, curs‹->curs‹, 
moduÀSˇnKeyCÆlback
, 
NULL
, &
d©a
);

6703 i‡(
curs‹
->cursor == 0) {

6704 
curs‹
->
d⁄e
 = 1;

6705 
ªt
 = 0;

6707 } i‡(
o
->
ty≥
 =
OBJ_SET
 && o->
ícodög
 =
OBJ_ENCODING_INTSET
) {

6708 
pos
 = 0;

6709 
öt64_t
 
Œ
;

6710 
	`öt£tGë
(
o
->
±r
,
pos
++,&
Œ
)) {

6711 
robj
 *
fõld
 = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
Œ
);

6712 
	`‚
(
key
, 
fõld
, 
NULL
, 
¥ivd©a
);

6713 
	`de¸RefCou¡
(
fõld
);

6715 
curs‹
->cursor = 1;

6716 
curs‹
->
d⁄e
 = 1;

6717 
ªt
 = 0;

6718 } i‡(
o
->
ty≥
 =
OBJ_HASH
 || o->ty≥ =
OBJ_ZSET
) {

6719 *
p
 = 
	`zùli°Index
(
o
->
±r
,0);

6720 *
v°r
;

6721 
vÀn
;

6722 
vŒ
;

6723 
p
) {

6724 
	`zùli°Gë
(
p
,&
v°r
,&
vÀn
,&
vŒ
);

6725 
robj
 *
fõld
 = (
v°r
 !
NULL
) ?

6726 
	`¸óãSåögObje˘
((*)
v°r
,
vÀn
) :

6727 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
vŒ
);

6728 
p
 = 
	`zùli°Next
(
o
->
±r
,p);

6729 
	`zùli°Gë
(
p
,&
v°r
,&
vÀn
,&
vŒ
);

6730 
robj
 *
vÆue
 = (
v°r
 !
NULL
) ?

6731 
	`¸óãSåögObje˘
((*)
v°r
,
vÀn
) :

6732 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
vŒ
);

6733 
	`‚
(
key
, 
fõld
, 
vÆue
, 
¥ivd©a
);

6734 
p
 = 
	`zùli°Next
(
o
->
±r
,p);

6735 
	`de¸RefCou¡
(
fõld
);

6736 
	`de¸RefCou¡
(
vÆue
);

6738 
curs‹
->cursor = 1;

6739 
curs‹
->
d⁄e
 = 1;

6740 
ªt
 = 0;

6742 
î∫o
 = 0;

6743  
ªt
;

6744 
	}
}

6762 
	$RM_F‹k
(
RedisModuÀF‹kD⁄eH™dÀr
 
cb
, *
u£r_d©a
) {

6763 
pid_t
 
chûdpid
;

6764 i‡(
	`hasA˘iveChûdPro˚ss
()) {

6768 
	`›íChûdInfoPùe
();

6769 i‡((
chûdpid
 = 
	`ªdisF‹k
()) == 0) {

6771 
	`ªdisSëProcTôÀ
("redis-module-fork");

6772 } i‡(
chûdpid
 == -1) {

6773 
	`˛o£ChûdInfoPùe
();

6774 
	`£rvîLog
(
LL_WARNING
,"C™'àf‹k f‹ moduÀ: %s", 
	`°ªº‹
(
î∫o
));

6777 
£rvî
.
moduÀ_chûd_pid
 = 
chûdpid
;

6778 
moduÀF‹kInfo
.
d⁄e_h™dÀr
 = 
cb
;

6779 
moduÀF‹kInfo
.
d⁄e_h™dÀr_u£r_d©a
 = 
u£r_d©a
;

6780 
	`£rvîLog
(
LL_VERBOSE
, "ModuÀ f‹k sèπedÖid: %d ", 
chûdpid
);

6782  
chûdpid
;

6783 
	}
}

6788 
	$RM_ExôFromChûd
(
ªtcode
) {

6789 
	`£ndChûdCOWInfo
(
CHILD_INFO_TYPE_MODULE
, "Module fork");

6790 
	`exôFromChûd
(
ªtcode
);

6791  
REDISMODULE_OK
;

6792 
	}
}

6797 
	$Tîmö©eModuÀF‹kChûd
(
chûd_pid
, 
waô
) {

6799 i‡(
£rvî
.
moduÀ_chûd_pid
 == -1 ||

6800 
£rvî
.
moduÀ_chûd_pid
 !
chûd_pid
Ë 
C_ERR
;

6802 
°©loc
;

6803 
	`£rvîLog
(
LL_VERBOSE
,"KillingÑunning module fork child: %ld",

6804 (Ë
£rvî
.
moduÀ_chûd_pid
);

6805 i‡(
	`kûl
(
£rvî
.
moduÀ_chûd_pid
,
SIGUSR1
Ë!-1 && 
waô
) {

6806 
	`waô4
(
£rvî
.
moduÀ_chûd_pid
,&
°©loc
,0,
NULL
) !=

6807 
£rvî
.
moduÀ_chûd_pid
);

6810 
£rvî
.
moduÀ_chûd_pid
 = -1;

6811 
moduÀF‹kInfo
.
d⁄e_h™dÀr
 = 
NULL
;

6812 
moduÀF‹kInfo
.
d⁄e_h™dÀr_u£r_d©a
 = 
NULL
;

6813 
	`˛o£ChûdInfoPùe
();

6814 
	`upd©eDi˘ResizePﬁicy
();

6815  
C_OK
;

6816 
	}
}

6820 
	$RM_KûlF‹kChûd
(
chûd_pid
) {

6822 i‡(
	`Tîmö©eModuÀF‹kChûd
(
chûd_pid
,1Ë=
C_OK
)

6823  
REDISMODULE_OK
;

6825  
REDISMODULE_ERR
;

6826 
	}
}

6828 
	$ModuÀF‹kD⁄eH™dÀr
(
exôcode
, 
bysig«l
) {

6829 
	`£rvîLog
(
LL_NOTICE
,

6831 
£rvî
.
moduÀ_chûd_pid
, 
exôcode
, 
bysig«l
);

6832 i‡(
moduÀF‹kInfo
.
d⁄e_h™dÀr
) {

6833 
moduÀF‹kInfo
.
	`d⁄e_h™dÀr
(
exôcode
, 
bysig«l
,

6834 
moduÀF‹kInfo
.
d⁄e_h™dÀr_u£r_d©a
);

6836 
£rvî
.
moduÀ_chûd_pid
 = -1;

6837 
moduÀF‹kInfo
.
d⁄e_h™dÀr
 = 
NULL
;

6838 
moduÀF‹kInfo
.
d⁄e_h™dÀr_u£r_d©a
 = 
NULL
;

6839 
	}
}

7047 
	$RM_Subs¸ibeToSîvîEvít
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀEvít
 
evít
, 
RedisModuÀEvítCÆlback
 
ˇŒback
) {

7048 
RedisModuÀEvítLi°íî
 *
ñ
;

7051 i‡(
˘x
->
moduÀ
 =
NULL
Ë 
REDISMODULE_ERR
;

7054 
li°Iãr
 
li
;

7055 
li°Node
 *
 
;

7056 
	`li°Rewöd
(
RedisModuÀ_EvítLi°íîs
,&
li
);

7057 (
 
 = 
	`li°Next
(&
li
))) {

7058 
ñ
 = 
 
->
vÆue
;

7059 i‡(
ñ
->
moduÀ
 =
˘x
->moduÀ &&Él->
evít
.
id
 ==Évent.id)

7064 i‡(
 
) {

7065 i‡(
ˇŒback
 =
NULL
) {

7066 
	`li°DñNode
(
RedisModuÀ_EvítLi°íîs
,
 
);

7067 
	`z‰ì
(
ñ
);

7069 
ñ
->
ˇŒback
 = callback;

7071  
REDISMODULE_OK
;

7075 
ñ
 = 
	`zmÆloc
((*el));

7076 
ñ
->
moduÀ
 = 
˘x
->module;

7077 
ñ
->
evít
 =Évent;

7078 
ñ
->
ˇŒback
 = callback;

7079 
	`li°AddNodeTaû
(
RedisModuÀ_EvítLi°íîs
,
ñ
);

7080  
REDISMODULE_OK
;

7081 
	}
}

7090 
	$moduÀFúeSîvîEvít
(
uöt64_t
 
eid
, 
subid
, *
d©a
) {

7094 i‡(
	`li°Lígth
(
RedisModuÀ_EvítLi°íîs
) == 0) ;

7096 
li°Iãr
 
li
;

7097 
li°Node
 *
 
;

7098 
	`li°Rewöd
(
RedisModuÀ_EvítLi°íîs
,&
li
);

7099 (
 
 = 
	`li°Next
(&
li
))) {

7100 
RedisModuÀEvítLi°íî
 *
ñ
 = 
 
->
vÆue
;

7101 i‡(
ñ
->
evít
.
id
 =
eid
) {

7102 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

7103 
˘x
.
moduÀ
 = 
ñ
->module;

7105 i‡(
ModuÀsInHooks
 == 0) {

7106 
˘x
.
˛õ¡
 = 
moduÀFªeC⁄ãxtReu£dClõ¡
;

7108 
˘x
.
˛õ¡
 = 
	`¸óãClõ¡
(
NULL
);

7109 
˘x
.
˛õ¡
->
Êags
 |
CLIENT_MODULE
;

7110 
˘x
.
˛õ¡
->
u£r
 = 
NULL
;

7113 *
moduÀd©a
 = 
NULL
;

7114 
RedisModuÀClõ¡InfoV1
 
civ1
;

7115 
RedisModuÀRïliˇti⁄InfoV1
 
riv1
;

7116 
RedisModuÀModuÀCh™geV1
 
mcv1
;

7121 
	`£À˘Db
(
˘x
.
˛õ¡
, 0);

7124 i‡(
eid
 =
REDISMODULE_EVENT_CLIENT_CHANGE
) {

7125 
	`moduÀP›uœãClõ¡InfoSåu˘uª
(&
civ1
,
d©a
,

7126 
ñ
->
evít
.
d©avî
);

7127 
moduÀd©a
 = &
civ1
;

7128 } i‡(
eid
 =
REDISMODULE_EVENT_REPLICATION_ROLE_CHANGED
) {

7129 
	`moduÀP›uœãRïliˇti⁄InfoSåu˘uª
(&
riv1
,
ñ
->
evít
.
d©avî
);

7130 
moduÀd©a
 = &
riv1
;

7131 } i‡(
eid
 =
REDISMODULE_EVENT_FLUSHDB
) {

7132 
moduÀd©a
 = 
d©a
;

7133 
RedisModuÀFlushInfoV1
 *
fi
 = 
d©a
;

7134 i‡(
fi
->
dbnum
 != -1)

7135 
	`£À˘Db
(
˘x
.
˛õ¡
, 
fi
->
dbnum
);

7136 } i‡(
eid
 =
REDISMODULE_EVENT_MODULE_CHANGE
) {

7137 
RedisModuÀ
 *
m
 = 
d©a
;

7138 i‡(
m
 =
ñ
->
moduÀ
)

7140 
mcv1
.
vîsi⁄
 = 
REDISMODULE_MODULE_CHANGE_VERSION
;

7141 
mcv1
.
moduÀ_«me
 = 
m
->
«me
;

7142 
mcv1
.
moduÀ_vîsi⁄
 = 
m
->
vî
;

7143 
moduÀd©a
 = &
mcv1
;

7144 } i‡(
eid
 =
REDISMODULE_EVENT_LOADING_PROGRESS
) {

7145 
moduÀd©a
 = 
d©a
;

7146 } i‡(
eid
 =
REDISMODULE_EVENT_CRON_LOOP
) {

7147 
moduÀd©a
 = 
d©a
;

7150 
ModuÀsInHooks
++;

7151 
ñ
->
moduÀ
->
ö_hook
++;

7152 
ñ
->
	`ˇŒback
(&
˘x
,ñ->
evít
,
subid
,
moduÀd©a
);

7153 
ñ
->
moduÀ
->
ö_hook
--;

7154 
ModuÀsInHooks
--;

7156 i‡(
ModuÀsInHooks
 !0Ë
	`‰ìClõ¡
(
˘x
.
˛õ¡
);

7157 
	`moduÀFªeC⁄ãxt
(&
˘x
);

7160 
	}
}

7164 
	$moduÀUnsubs¸ibeAŒSîvîEvíts
(
RedisModuÀ
 *
moduÀ
) {

7165 
RedisModuÀEvítLi°íî
 *
ñ
;

7166 
li°Iãr
 
li
;

7167 
li°Node
 *
 
;

7168 
	`li°Rewöd
(
RedisModuÀ_EvítLi°íîs
,&
li
);

7170 (
 
 = 
	`li°Next
(&
li
))) {

7171 
ñ
 = 
 
->
vÆue
;

7172 i‡(
ñ
->
moduÀ
 == module) {

7173 
	`li°DñNode
(
RedisModuÀ_EvítLi°íîs
,
 
);

7174 
	`z‰ì
(
ñ
);

7177 
	}
}

7179 
	$¥o˚ssModuÀLﬂdögProgªssEvít
(
is_aof
) {

7180 
now
 = 
	`u°ime
();

7181 
√xt_evít
 = 0;

7182 i‡(
now
 >
√xt_evít
) {

7184 
¥ogªss
 = -1;

7185 i‡(
£rvî
.
lﬂdög_tŸÆ_byãs
)

7186 
¥ogªss
 = (
£rvî
.
lﬂdög_tŸÆ_byãs
<<10) / server.loading_total_bytes;

7187 
RedisModuÀFlushInfoV1
 
fi
 = {
REDISMODULE_LOADING_PROGRESS_VERSION
,

7188 
£rvî
.
hz
,

7189 
¥ogªss
};

7190 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_LOADING_PROGRESS
,

7191 
is_aof
?

7192 
REDISMODULE_SUBEVENT_LOADING_PROGRESS_AOF
:

7193 
REDISMODULE_SUBEVENT_LOADING_PROGRESS_RDB
,

7194 &
fi
);

7196 
√xt_evít
 = 
now
 + 1000000 / 
£rvî
.
hz
;

7198 
	}
}

7207 
uöt64_t
 
	$di˘CSåögKeyHash
(c⁄° *
key
) {

7208  
	`di˘GíHashFun˘i⁄
((*)
key
, 
	`°æí
((*)key));

7209 
	}
}

7211 
	$di˘CSåögKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
, c⁄° *
key2
) {

7212 
	`UNUSED
(
¥ivd©a
);

7213  
	`°rcmp
(
key1
,
key2
) == 0;

7214 
	}
}

7216 
di˘Ty≥
 
	gmoduÀAPIDi˘Ty≥
 = {

7217 
di˘CSåögKeyHash
,

7218 
NULL
,

7219 
NULL
,

7220 
di˘CSåögKeyCom∑ª
,

7221 
NULL
,

7222 
NULL


7225 
	$moduÀRegi°îApi
(c⁄° *
fun˙ame
, *
fun˝å
) {

7226  
	`di˘Add
(
£rvî
.
moduÀ≠i
, (*)
fun˙ame
, 
fun˝å
);

7227 
	}
}

7229 
	#REGISTER_API
(
«me
) \

7230 
	`moduÀRegi°îApi
("RedisModuÀ_" #«me, (*)()
RM_
 ## 
«me
)

	)

7233 
moduÀRegi°îC‹eAPI
();

7235 
	$moduÀInôModuÀsSy°em
() {

7236 
moduÀUnblockedClõ¡s
 = 
	`li°Cª©e
();

7237 
£rvî
.
lﬂdmoduÀ_queue
 = 
	`li°Cª©e
();

7238 
moduÀs
 = 
	`di˘Cª©e
(&
moduÀsDi˘Ty≥
,
NULL
);

7241 
moduÀKey•a˚Subs¸ibîs
 = 
	`li°Cª©e
();

7242 
moduÀFªeC⁄ãxtReu£dClõ¡
 = 
	`¸óãClõ¡
(
NULL
);

7243 
moduÀFªeC⁄ãxtReu£dClõ¡
->
Êags
 |
CLIENT_MODULE
;

7244 
moduÀFªeC⁄ãxtReu£dClõ¡
->
u£r
 = 
NULL
;

7247 
moduÀComm™dFûãrs
 = 
	`li°Cª©e
();

7249 
	`moduÀRegi°îC‹eAPI
();

7250 i‡(
	`pùe
(
£rvî
.
moduÀ_blocked_pùe
) == -1) {

7251 
	`£rvîLog
(
LL_WARNING
,

7253 
	`°ªº‹
(
î∫o
));

7254 
	`exô
(1);

7258 
	`™ëN⁄Block
(
NULL
,
£rvî
.
moduÀ_blocked_pùe
[0]);

7259 
	`™ëN⁄Block
(
NULL
,
£rvî
.
moduÀ_blocked_pùe
[1]);

7262 
Timîs
 = 
	`øxNew
();

7265 
RedisModuÀ_EvítLi°íîs
 = 
	`li°Cª©e
();

7269 
	`±hªad_muãx_lock
(&
moduÀGIL
);

7270 
	}
}

7281 
	$moduÀLﬂdFromQueue
() {

7282 
li°Iãr
 
li
;

7283 
li°Node
 *
 
;

7285 
	`li°Rewöd
(
£rvî
.
lﬂdmoduÀ_queue
,&
li
);

7286 (
 
 = 
	`li°Next
(&
li
))) {

7287 
moduÀLﬂdQueueE¡ry
 *
lﬂdmod
 = 
 
->
vÆue
;

7288 i‡(
	`moduÀLﬂd
(
lﬂdmod
->
∑th
,(**Óﬂdmod->
¨gv
,lﬂdmod->
¨gc
)

7289 =
C_ERR
)

7291 
	`£rvîLog
(
LL_WARNING
,

7293 
lﬂdmod
->
∑th
);

7294 
	`exô
(1);

7297 
	}
}

7299 
	$moduÀFªeModuÀSåu˘uª
(
RedisModuÀ
 *
moduÀ
) {

7300 
	`li°Rñó£
(
moduÀ
->
ty≥s
);

7301 
	`li°Rñó£
(
moduÀ
->
fûãrs
);

7302 
	`li°Rñó£
(
moduÀ
->
u£dby
);

7303 
	`li°Rñó£
(
moduÀ
->
usög
);

7304 
	`sds‰ì
(
moduÀ
->
«me
);

7305 
	`z‰ì
(
moduÀ
);

7306 
	}
}

7308 
	$moduÀUƒegi°îComm™ds
(
RedisModuÀ
 *
moduÀ
) {

7310 
di˘Iãøt‹
 *
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
comm™ds
);

7311 
di˘E¡ry
 *
de
;

7312 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

7313 
ªdisComm™d
 *
cmd
 = 
	`di˘GëVÆ
(
de
);

7314 i‡(
cmd
->
¥oc
 =
RedisModuÀComm™dDi•©chî
) {

7315 
RedisModuÀComm™dProxy
 *
˝
 =

7316 (*)()
cmd
->
gëkeys_¥oc
;

7317 
sds
 
cmd«me
 = 
˝
->
ªdiscmd
->
«me
;

7318 i‡(
˝
->
moduÀ
 == module) {

7319 
	`di˘Dñëe
(
£rvî
.
comm™ds
,
cmd«me
);

7320 
	`di˘Dñëe
(
£rvî
.
‹ig_comm™ds
,
cmd«me
);

7321 
	`sds‰ì
(
cmd«me
);

7322 
	`z‰ì
(
˝
->
ªdiscmd
);

7323 
	`z‰ì
(
˝
);

7327 
	`di˘Rñó£Iãøt‹
(
di
);

7328 
	}
}

7332 
	$moduÀLﬂd
(c⁄° *
∑th
, **
moduÀ_¨gv
, 
moduÀ_¨gc
) {

7333 (*
⁄lﬂd
)(*, **, );

7334 *
h™dÀ
;

7335 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

7336 
˘x
.
˛õ¡
 = 
moduÀFªeC⁄ãxtReu£dClõ¡
;

7337 
	`£À˘Db
(
˘x
.
˛õ¡
, 0);

7339 
°©
 
°
;

7340 i‡(
	`°©
(
∑th
, &
°
) == 0)

7342 i‡(!(
°
.
°_mode
 & (
S_IXUSR
 | 
S_IXGRP
 | 
S_IXOTH
))) {

7343 
	`£rvîLog
(
LL_WARNING
, "ModuÀ %†ÁûedÅÿlﬂd: Iàd€†nŸ havêexecuãÖîmissi⁄s.", 
∑th
);

7344  
C_ERR
;

7348 
h™dÀ
 = 
	`dl›í
(
∑th
,
RTLD_NOW
|
RTLD_LOCAL
);

7349 i‡(
h™dÀ
 =
NULL
) {

7350 
	`£rvîLog
(
LL_WARNING
, "ModuÀ %†ÁûedÅÿlﬂd: %s", 
∑th
, 
	`dÀº‹
());

7351  
C_ERR
;

7353 
⁄lﬂd
 = ((*)(*, **, ))(Ë
	`dlsym
(
h™dÀ
,"RedisModule_OnLoad");

7354 i‡(
⁄lﬂd
 =
NULL
) {

7355 
	`dl˛o£
(
h™dÀ
);

7356 
	`£rvîLog
(
LL_WARNING
,

7358 "symbﬁ. ModuÀÇŸÜﬂded.",
∑th
);

7359  
C_ERR
;

7361 i‡(
	`⁄lﬂd
((*)&
˘x
,
moduÀ_¨gv
,
moduÀ_¨gc
Ë=
REDISMODULE_ERR
) {

7362 i‡(
˘x
.
moduÀ
) {

7363 
	`moduÀUƒegi°îComm™ds
(
˘x
.
moduÀ
);

7364 
	`moduÀUƒegi°îSh¨edAPI
(
˘x
.
moduÀ
);

7365 
	`moduÀUƒegi°îU£dAPI
(
˘x
.
moduÀ
);

7366 
	`moduÀFªeModuÀSåu˘uª
(
˘x
.
moduÀ
);

7368 
	`dl˛o£
(
h™dÀ
);

7369 
	`£rvîLog
(
LL_WARNING
,

7370 "ModuÀ %†öôüliz©i⁄ faûed. ModuÀÇŸÜﬂded",
∑th
);

7371  
C_ERR
;

7375 
	`di˘Add
(
moduÀs
,
˘x
.
moduÀ
->
«me
,ctx.module);

7376 
˘x
.
moduÀ
->
blocked_˛õ¡s
 = 0;

7377 
˘x
.
moduÀ
->
h™dÀ
 = handle;

7378 
	`£rvîLog
(
LL_NOTICE
,"ModuÀ '%s'Üﬂded from %s",
˘x
.
moduÀ
->
«me
,
∑th
);

7380 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_MODULE_CHANGE
,

7381 
REDISMODULE_SUBEVENT_MODULE_LOADED
,

7382 
˘x
.
moduÀ
);

7384 
	`moduÀFªeC⁄ãxt
(&
˘x
);

7385  
C_OK
;

7386 
	}
}

7395 
	$moduÀU∆ﬂd
(
sds
 
«me
) {

7396 
RedisModuÀ
 *
moduÀ
 = 
	`di˘FëchVÆue
(
moduÀs
,
«me
);

7398 i‡(
moduÀ
 =
NULL
) {

7399 
î∫o
 = 
ENOENT
;

7400  
REDISMODULE_ERR
;

7401 } i‡(
	`li°Lígth
(
moduÀ
->
ty≥s
)) {

7402 
î∫o
 = 
EBUSY
;

7403  
REDISMODULE_ERR
;

7404 } i‡(
	`li°Lígth
(
moduÀ
->
u£dby
)) {

7405 
î∫o
 = 
EPERM
;

7406  
REDISMODULE_ERR
;

7407 } i‡(
moduÀ
->
blocked_˛õ¡s
) {

7408 
î∫o
 = 
EAGAIN
;

7409  
REDISMODULE_ERR
;

7413 (*
⁄u∆ﬂd
)(*);

7414 
⁄u∆ﬂd
 = ((*)(*))(Ë
	`dlsym
(
moduÀ
->
h™dÀ
, "RedisModule_OnUnload");

7415 i‡(
⁄u∆ﬂd
) {

7416 
RedisModuÀCtx
 
˘x
 = 
REDISMODULE_CTX_INIT
;

7417 
˘x
.
moduÀ
 = module;

7418 
˘x
.
˛õ¡
 = 
moduÀFªeC⁄ãxtReu£dClõ¡
;

7419 
u∆ﬂd_°©us
 = 
	`⁄u∆ﬂd
((*)&
˘x
);

7420 
	`moduÀFªeC⁄ãxt
(&
˘x
);

7422 i‡(
u∆ﬂd_°©us
 =
REDISMODULE_ERR
) {

7423 
	`£rvîLog
(
LL_WARNING
, "ModuÀ %†OnU∆ﬂd faûed. U∆ﬂd c™˚Àd.", 
«me
);

7424 
î∫o
 = 
ECANCELED
;

7425  
REDISMODULE_ERR
;

7429 
	`moduÀFªeAuthítiˇãdClõ¡s
(
moduÀ
);

7430 
	`moduÀUƒegi°îComm™ds
(
moduÀ
);

7431 
	`moduÀUƒegi°îSh¨edAPI
(
moduÀ
);

7432 
	`moduÀUƒegi°îU£dAPI
(
moduÀ
);

7433 
	`moduÀUƒegi°îFûãrs
(
moduÀ
);

7436 
	`moduÀUnsubs¸ibeNŸifiˇti⁄s
(
moduÀ
);

7437 
	`moduÀUnsubs¸ibeAŒSîvîEvíts
(
moduÀ
);

7440 i‡(
	`dl˛o£
(
moduÀ
->
h™dÀ
) == -1) {

7441 *
îr‹
 = 
	`dÀº‹
();

7442 i‡(
îr‹
 =
NULL
)Érror = "UnknownÉrror";

7443 
	`£rvîLog
(
LL_WARNING
,"Error whenÅryingÅo closeÅhe %s module: %s",

7444 
moduÀ
->
«me
, 
îr‹
);

7448 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_MODULE_CHANGE
,

7449 
REDISMODULE_SUBEVENT_MODULE_UNLOADED
,

7450 
moduÀ
);

7453 
	`£rvîLog
(
LL_NOTICE
,"ModuÀ %†u∆ﬂded",
moduÀ
->
«me
);

7454 
	`di˘Dñëe
(
moduÀs
,
moduÀ
->
«me
);

7455 
moduÀ
->
«me
 = 
NULL
;

7456 
	`moduÀFªeModuÀSåu˘uª
(
moduÀ
);

7458  
REDISMODULE_OK
;

7459 
	}
}

7463 
	$addRïlyLﬂdedModuÀs
(
˛õ¡
 *
c
) {

7464 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
moduÀs
);

7465 
di˘E¡ry
 *
de
;

7467 
	`addRïlyAºayLí
(
c
,
	`di˘Size
(
moduÀs
));

7468 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

7469 
sds
 
«me
 = 
	`di˘GëKey
(
de
);

7470 
RedisModuÀ
 *
moduÀ
 = 
	`di˘GëVÆ
(
de
);

7471 
	`addRïlyM≠Lí
(
c
,2);

7472 
	`addRïlyBulkCSåög
(
c
,"name");

7473 
	`addRïlyBulkCBuf„r
(
c
,
«me
,
	`sd¶í
(name));

7474 
	`addRïlyBulkCSåög
(
c
,"ver");

7475 
	`addRïlyL⁄gL⁄g
(
c
,
moduÀ
->
vî
);

7477 
	`di˘Rñó£Iãøt‹
(
di
);

7478 
	}
}

7482 
sds
 
	$gíModuÀsInfoSåögRídîModuÀsLi°
(
li°
 *
l
) {

7483 
li°Iãr
 
li
;

7484 
li°Node
 *
 
;

7485 
	`li°Rewöd
(
l
,&
li
);

7486 
sds
 
ouçut
 = 
	`sd¢ew
("[");

7487 (
 
 = 
	`li°Next
(&
li
))) {

7488 
RedisModuÀ
 *
moduÀ
 = 
 
->
vÆue
;

7489 
ouçut
 = 
	`sdsˇt
(ouçut,
moduÀ
->
«me
);

7491 
ouçut
 = 
	`sd°rim
(output,"|");

7492 
ouçut
 = 
	`sdsˇt
(output,"]");

7493  
ouçut
;

7494 
	}
}

7497 
sds
 
	$gíModuÀsInfoSåögRídîModuÀO±i⁄s
(
RedisModuÀ
 *
moduÀ
) {

7498 
sds
 
ouçut
 = 
	`sd¢ew
("[");

7499 i‡(
moduÀ
->
›ti⁄s
 & 
REDISMODULE_OPTIONS_HANDLE_IO_ERRORS
)

7500 
ouçut
 = 
	`sdsˇt
(output,"handle-io-errors|");

7501 
ouçut
 = 
	`sd°rim
(output,"|");

7502 
ouçut
 = 
	`sdsˇt
(output,"]");

7503  
ouçut
;

7504 
	}
}

7512 
sds
 
	$gíModuÀsInfoSåög
(
sds
 
öfo
) {

7513 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
moduÀs
);

7514 
di˘E¡ry
 *
de
;

7516 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

7517 
sds
 
«me
 = 
	`di˘GëKey
(
de
);

7518 
RedisModuÀ
 *
moduÀ
 = 
	`di˘GëVÆ
(
de
);

7520 
sds
 
u£dby
 = 
	`gíModuÀsInfoSåögRídîModuÀsLi°
(
moduÀ
->usedby);

7521 
sds
 
usög
 = 
	`gíModuÀsInfoSåögRídîModuÀsLi°
(
moduÀ
->using);

7522 
sds
 
›ti⁄s
 = 
	`gíModuÀsInfoSåögRídîModuÀO±i⁄s
(
moduÀ
);

7523 
öfo
 = 
	`sdsˇtfmt
(info,

7526 
«me
, 
moduÀ
->
vî
, moduÀ->
≠ivî
,

7527 ()
	`li°Lígth
(
moduÀ
->
fûãrs
), 
u£dby
, 
usög
, 
›ti⁄s
);

7528 
	`sds‰ì
(
u£dby
);

7529 
	`sds‰ì
(
usög
);

7530 
	`sds‰ì
(
›ti⁄s
);

7532 
	`di˘Rñó£Iãøt‹
(
di
);

7533  
öfo
;

7534 
	}
}

7539 
	$moduÀComm™d
(
˛õ¡
 *
c
) {

7540 *
subcmd
 = 
c
->
¨gv
[1]->
±r
;

7541 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(
subcmd
,"help")) {

7542 c⁄° *
hñp
[] = {

7546 
NULL


7548 
	`addRïlyHñp
(
c
, 
hñp
);

7550 i‡(!
	`°rˇ£cmp
(
subcmd
,"lﬂd"Ë&& 
c
->
¨gc
 >= 3) {

7551 
robj
 **
¨gv
 = 
NULL
;

7552 
¨gc
 = 0;

7554 i‡(
c
->
¨gc
 > 3) {

7555 
¨gc
 = 
c
->argc - 3;

7556 
¨gv
 = &
c
->argv[3];

7559 i‡(
	`moduÀLﬂd
(
c
->
¨gv
[2]->
±r
,(**Ôrgv,
¨gc
Ë=
C_OK
)

7560 
	`addRïly
(
c
,
sh¨ed
.
ok
);

7562 
	`addRïlyEº‹
(
c
,

7564 } i‡(!
	`°rˇ£cmp
(
subcmd
,"u∆ﬂd"Ë&& 
c
->
¨gc
 == 3) {

7565 i‡(
	`moduÀU∆ﬂd
(
c
->
¨gv
[2]->
±r
Ë=
C_OK
)

7566 
	`addRïly
(
c
,
sh¨ed
.
ok
);

7568 *
îrmsg
;

7569 
î∫o
) {

7570 
ENOENT
:

7571 
îrmsg
 = "no such module withÅhatÇame";

7573 
EBUSY
:

7574 
îrmsg
 = "the moduleÉxports one or more module-side data "

7577 
EPERM
:

7578 
îrmsg
 = "the moduleÉxports APIs used by other modules. "

7581 
EAGAIN
:

7582 
îrmsg
 = "the module has blocked clients. "

7586 
îrmsg
 = "operationÇotÖossible.";

7589 
	`addRïlyEº‹F‹m©
(
c
,"Eº‹ u∆ﬂdög moduÀ: %s",
îrmsg
);

7591 } i‡(!
	`°rˇ£cmp
(
subcmd
,"li°"Ë&& 
c
->
¨gc
 == 2) {

7592 
	`addRïlyLﬂdedModuÀs
(
c
);

7594 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

7597 
	}
}

7600 
size_t
 
	$moduÀCou¡
() {

7601  
	`di˘Size
(
moduÀs
);

7602 
	}
}

7607 
	$RM_SëLRU
(
RedisModuÀKey
 *
key
, 
m°ime_t
 
Ãu_idÀ
) {

7608 i‡(!
key
->
vÆue
)

7609  
REDISMODULE_ERR
;

7610 i‡(
	`obje˘SëLRUOrLFU
(
key
->
vÆue
, -1, 
Ãu_idÀ
,Üru_idÀ>=0 ? 
	`LRU_CLOCK
() : 0, 1))

7611  
REDISMODULE_OK
;

7612  
REDISMODULE_ERR
;

7613 
	}
}

7619 
	$RM_GëLRU
(
RedisModuÀKey
 *
key
, 
m°ime_t
 *
Ãu_idÀ
) {

7620 *
Ãu_idÀ
 = -1;

7621 i‡(!
key
->
vÆue
)

7622  
REDISMODULE_ERR
;

7623 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
)

7624  
REDISMODULE_OK
;

7625 *
Ãu_idÀ
 = 
	`e°im©eObje˘IdÀTime
(
key
->
vÆue
);

7626  
REDISMODULE_OK
;

7627 
	}
}

7634 
	$RM_SëLFU
(
RedisModuÀKey
 *
key
, 
lfu_‰eq
) {

7635 i‡(!
key
->
vÆue
)

7636  
REDISMODULE_ERR
;

7637 i‡(
	`obje˘SëLRUOrLFU
(
key
->
vÆue
, 
lfu_‰eq
, -1, 0, 1))

7638  
REDISMODULE_OK
;

7639  
REDISMODULE_ERR
;

7640 
	}
}

7645 
	$RM_GëLFU
(
RedisModuÀKey
 *
key
, *
lfu_‰eq
) {

7646 *
lfu_‰eq
 = -1;

7647 i‡(!
key
->
vÆue
)

7648  
REDISMODULE_ERR
;

7649 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
)

7650 *
lfu_‰eq
 = 
	`LFUDe¸AndRëu∫
(
key
->
vÆue
);

7651  
REDISMODULE_OK
;

7652 
	}
}

7671 
	$RM_ModuÀTy≥Rïœ˚VÆue
(
RedisModuÀKey
 *
key
, 
moduÀTy≥
 *
mt
, *
√w_vÆue
, **
ﬁd_vÆue
) {

7672 i‡(!(
key
->
mode
 & 
REDISMODULE_WRITE
Ë|| key->
ôî
)

7673  
REDISMODULE_ERR
;

7674 i‡(!
key
->
vÆue
 || key->vÆue->
ty≥
 !
OBJ_MODULE
)

7675  
REDISMODULE_ERR
;

7677 
moduÀVÆue
 *
mv
 = 
key
->
vÆue
->
±r
;

7678 i‡(
mv
->
ty≥
 !
mt
)

7679  
REDISMODULE_ERR
;

7681 i‡(
ﬁd_vÆue
)

7682 *
ﬁd_vÆue
 = 
mv
->
vÆue
;

7683 
mv
->
vÆue
 = 
√w_vÆue
;

7685  
REDISMODULE_OK
;

7686 
	}
}

7690 
	$moduÀRegi°îC‹eAPI
() {

7691 
£rvî
.
moduÀ≠i
 = 
	`di˘Cª©e
(&
moduÀAPIDi˘Ty≥
,
NULL
);

7692 
£rvî
.
sh¨ed≠i
 = 
	`di˘Cª©e
(&
moduÀAPIDi˘Ty≥
,
NULL
);

7693 
	`REGISTER_API
(
AŒoc
);

7694 
	`REGISTER_API
(
CÆloc
);

7695 
	`REGISTER_API
(
RóŒoc
);

7696 
	`REGISTER_API
(
Fªe
);

7697 
	`REGISTER_API
(
Sådup
);

7698 
	`REGISTER_API
(
Cª©eComm™d
);

7699 
	`REGISTER_API
(
SëModuÀAâribs
);

7700 
	`REGISTER_API
(
IsModuÀNameBusy
);

7701 
	`REGISTER_API
(
Wr⁄gArôy
);

7702 
	`REGISTER_API
(
RïlyWôhL⁄gL⁄g
);

7703 
	`REGISTER_API
(
RïlyWôhEº‹
);

7704 
	`REGISTER_API
(
RïlyWôhSim∂eSåög
);

7705 
	`REGISTER_API
(
RïlyWôhAºay
);

7706 
	`REGISTER_API
(
RïlyWôhNuŒAºay
);

7707 
	`REGISTER_API
(
RïlyWôhEm±yAºay
);

7708 
	`REGISTER_API
(
RïlySëAºayLígth
);

7709 
	`REGISTER_API
(
RïlyWôhSåög
);

7710 
	`REGISTER_API
(
RïlyWôhEm±ySåög
);

7711 
	`REGISTER_API
(
RïlyWôhVîb©imSåög
);

7712 
	`REGISTER_API
(
RïlyWôhSåögBuf„r
);

7713 
	`REGISTER_API
(
RïlyWôhCSåög
);

7714 
	`REGISTER_API
(
RïlyWôhNuŒ
);

7715 
	`REGISTER_API
(
RïlyWôhCÆlRïly
);

7716 
	`REGISTER_API
(
RïlyWôhDoubÀ
);

7717 
	`REGISTER_API
(
RïlyWôhL⁄gDoubÀ
);

7718 
	`REGISTER_API
(
GëSñe˘edDb
);

7719 
	`REGISTER_API
(
Sñe˘Db
);

7720 
	`REGISTER_API
(
O≥nKey
);

7721 
	`REGISTER_API
(
Clo£Key
);

7722 
	`REGISTER_API
(
KeyTy≥
);

7723 
	`REGISTER_API
(
VÆueLígth
);

7724 
	`REGISTER_API
(
Li°Push
);

7725 
	`REGISTER_API
(
Li°P›
);

7726 
	`REGISTER_API
(
SåögToL⁄gL⁄g
);

7727 
	`REGISTER_API
(
SåögToDoubÀ
);

7728 
	`REGISTER_API
(
SåögToL⁄gDoubÀ
);

7729 
	`REGISTER_API
(
CÆl
);

7730 
	`REGISTER_API
(
CÆlRïlyPrŸo
);

7731 
	`REGISTER_API
(
FªeCÆlRïly
);

7732 
	`REGISTER_API
(
CÆlRïlyI¡egî
);

7733 
	`REGISTER_API
(
CÆlRïlyTy≥
);

7734 
	`REGISTER_API
(
CÆlRïlyLígth
);

7735 
	`REGISTER_API
(
CÆlRïlyAºayEÀmít
);

7736 
	`REGISTER_API
(
CÆlRïlySåögPå
);

7737 
	`REGISTER_API
(
Cª©eSåögFromCÆlRïly
);

7738 
	`REGISTER_API
(
Cª©eSåög
);

7739 
	`REGISTER_API
(
Cª©eSåögFromL⁄gL⁄g
);

7740 
	`REGISTER_API
(
Cª©eSåögFromDoubÀ
);

7741 
	`REGISTER_API
(
Cª©eSåögFromL⁄gDoubÀ
);

7742 
	`REGISTER_API
(
Cª©eSåögFromSåög
);

7743 
	`REGISTER_API
(
Cª©eSåögPrötf
);

7744 
	`REGISTER_API
(
FªeSåög
);

7745 
	`REGISTER_API
(
SåögPåLí
);

7746 
	`REGISTER_API
(
AutoMem‹y
);

7747 
	`REGISTER_API
(
Rïliˇã
);

7748 
	`REGISTER_API
(
RïliˇãVîb©im
);

7749 
	`REGISTER_API
(
DñëeKey
);

7750 
	`REGISTER_API
(
U∆ökKey
);

7751 
	`REGISTER_API
(
SåögSë
);

7752 
	`REGISTER_API
(
SåögDMA
);

7753 
	`REGISTER_API
(
SåögTrunˇã
);

7754 
	`REGISTER_API
(
SëExpúe
);

7755 
	`REGISTER_API
(
GëExpúe
);

7756 
	`REGISTER_API
(
Re£tD©a£t
);

7757 
	`REGISTER_API
(
DbSize
);

7758 
	`REGISTER_API
(
R™domKey
);

7759 
	`REGISTER_API
(
Z£tAdd
);

7760 
	`REGISTER_API
(
Z£tIn¸by
);

7761 
	`REGISTER_API
(
Z£tSc‹e
);

7762 
	`REGISTER_API
(
Z£tRem
);

7763 
	`REGISTER_API
(
Z£tR™geSt›
);

7764 
	`REGISTER_API
(
Z£tFú°InSc‹eR™ge
);

7765 
	`REGISTER_API
(
Z£tLa°InSc‹eR™ge
);

7766 
	`REGISTER_API
(
Z£tFú°InLexR™ge
);

7767 
	`REGISTER_API
(
Z£tLa°InLexR™ge
);

7768 
	`REGISTER_API
(
Z£tR™geCuºítEÀmít
);

7769 
	`REGISTER_API
(
Z£tR™geNext
);

7770 
	`REGISTER_API
(
Z£tR™gePªv
);

7771 
	`REGISTER_API
(
Z£tR™geEndRóched
);

7772 
	`REGISTER_API
(
HashSë
);

7773 
	`REGISTER_API
(
HashGë
);

7774 
	`REGISTER_API
(
IsKeysPosôi⁄Reque°
);

7775 
	`REGISTER_API
(
KeyAtPos
);

7776 
	`REGISTER_API
(
GëClõ¡Id
);

7777 
	`REGISTER_API
(
GëC⁄ãxtFœgs
);

7778 
	`REGISTER_API
(
AvoidRïliˇTøffic
);

7779 
	`REGISTER_API
(
PoﬁAŒoc
);

7780 
	`REGISTER_API
(
Cª©eD©aTy≥
);

7781 
	`REGISTER_API
(
ModuÀTy≥SëVÆue
);

7782 
	`REGISTER_API
(
ModuÀTy≥Rïœ˚VÆue
);

7783 
	`REGISTER_API
(
ModuÀTy≥GëTy≥
);

7784 
	`REGISTER_API
(
ModuÀTy≥GëVÆue
);

7785 
	`REGISTER_API
(
IsIOEº‹
);

7786 
	`REGISTER_API
(
SëModuÀO±i⁄s
);

7787 
	`REGISTER_API
(
Sig«lModifõdKey
);

7788 
	`REGISTER_API
(
SaveUnsig√d
);

7789 
	`REGISTER_API
(
LﬂdUnsig√d
);

7790 
	`REGISTER_API
(
SaveSig√d
);

7791 
	`REGISTER_API
(
LﬂdSig√d
);

7792 
	`REGISTER_API
(
SaveSåög
);

7793 
	`REGISTER_API
(
SaveSåögBuf„r
);

7794 
	`REGISTER_API
(
LﬂdSåög
);

7795 
	`REGISTER_API
(
LﬂdSåögBuf„r
);

7796 
	`REGISTER_API
(
SaveDoubÀ
);

7797 
	`REGISTER_API
(
LﬂdDoubÀ
);

7798 
	`REGISTER_API
(
SaveFlﬂt
);

7799 
	`REGISTER_API
(
LﬂdFlﬂt
);

7800 
	`REGISTER_API
(
SaveL⁄gDoubÀ
);

7801 
	`REGISTER_API
(
LﬂdL⁄gDoubÀ
);

7802 
	`REGISTER_API
(
SaveD©aTy≥ToSåög
);

7803 
	`REGISTER_API
(
LﬂdD©aTy≥FromSåög
);

7804 
	`REGISTER_API
(
EmôAOF
);

7805 
	`REGISTER_API
(
Log
);

7806 
	`REGISTER_API
(
LogIOEº‹
);

7807 
	`REGISTER_API
(
_As£π
);

7808 
	`REGISTER_API
(
L©ícyAddSam∂e
);

7809 
	`REGISTER_API
(
SåögAµídBuf„r
);

7810 
	`REGISTER_API
(
RëaöSåög
);

7811 
	`REGISTER_API
(
SåögCom∑ª
);

7812 
	`REGISTER_API
(
GëC⁄ãxtFromIO
);

7813 
	`REGISTER_API
(
GëKeyNameFromIO
);

7814 
	`REGISTER_API
(
GëKeyNameFromModuÀKey
);

7815 
	`REGISTER_API
(
BlockClõ¡
);

7816 
	`REGISTER_API
(
UnblockClõ¡
);

7817 
	`REGISTER_API
(
IsBlockedRïlyReque°
);

7818 
	`REGISTER_API
(
IsBlockedTimeoutReque°
);

7819 
	`REGISTER_API
(
GëBlockedClõ¡Priv©eD©a
);

7820 
	`REGISTER_API
(
Ab‹tBlock
);

7821 
	`REGISTER_API
(
Mûli£c⁄ds
);

7822 
	`REGISTER_API
(
GëThªadSa„C⁄ãxt
);

7823 
	`REGISTER_API
(
FªeThªadSa„C⁄ãxt
);

7824 
	`REGISTER_API
(
ThªadSa„C⁄ãxtLock
);

7825 
	`REGISTER_API
(
ThªadSa„C⁄ãxtU∆ock
);

7826 
	`REGISTER_API
(
Dige°AddSåögBuf„r
);

7827 
	`REGISTER_API
(
Dige°AddL⁄gL⁄g
);

7828 
	`REGISTER_API
(
Dige°EndSequí˚
);

7829 
	`REGISTER_API
(
NŸifyKey•a˚Evít
);

7830 
	`REGISTER_API
(
GëNŸifyKey•a˚Evíts
);

7831 
	`REGISTER_API
(
Subs¸ibeToKey•a˚Evíts
);

7832 
	`REGISTER_API
(
Regi°îClu°îMesßgeRe˚ivî
);

7833 
	`REGISTER_API
(
SídClu°îMesßge
);

7834 
	`REGISTER_API
(
GëClu°îNodeInfo
);

7835 
	`REGISTER_API
(
GëClu°îNodesLi°
);

7836 
	`REGISTER_API
(
FªeClu°îNodesLi°
);

7837 
	`REGISTER_API
(
Cª©eTimî
);

7838 
	`REGISTER_API
(
St›Timî
);

7839 
	`REGISTER_API
(
GëTimîInfo
);

7840 
	`REGISTER_API
(
GëMyClu°îID
);

7841 
	`REGISTER_API
(
GëClu°îSize
);

7842 
	`REGISTER_API
(
GëR™domByãs
);

7843 
	`REGISTER_API
(
GëR™domHexCh¨s
);

7844 
	`REGISTER_API
(
BlockedClõ¡Disc⁄√˘ed
);

7845 
	`REGISTER_API
(
SëDisc⁄√˘CÆlback
);

7846 
	`REGISTER_API
(
GëBlockedClõ¡H™dÀ
);

7847 
	`REGISTER_API
(
SëClu°îFœgs
);

7848 
	`REGISTER_API
(
Cª©eDi˘
);

7849 
	`REGISTER_API
(
FªeDi˘
);

7850 
	`REGISTER_API
(
Di˘Size
);

7851 
	`REGISTER_API
(
Di˘SëC
);

7852 
	`REGISTER_API
(
Di˘Rïœ˚C
);

7853 
	`REGISTER_API
(
Di˘Së
);

7854 
	`REGISTER_API
(
Di˘Rïœ˚
);

7855 
	`REGISTER_API
(
Di˘GëC
);

7856 
	`REGISTER_API
(
Di˘Gë
);

7857 
	`REGISTER_API
(
Di˘DñC
);

7858 
	`REGISTER_API
(
Di˘Dñ
);

7859 
	`REGISTER_API
(
Di˘Iãøt‹SèπC
);

7860 
	`REGISTER_API
(
Di˘Iãøt‹Sèπ
);

7861 
	`REGISTER_API
(
Di˘Iãøt‹St›
);

7862 
	`REGISTER_API
(
Di˘Iãøt‹Re£ekC
);

7863 
	`REGISTER_API
(
Di˘Iãøt‹Re£ek
);

7864 
	`REGISTER_API
(
Di˘NextC
);

7865 
	`REGISTER_API
(
Di˘PªvC
);

7866 
	`REGISTER_API
(
Di˘Next
);

7867 
	`REGISTER_API
(
Di˘Pªv
);

7868 
	`REGISTER_API
(
Di˘Com∑ªC
);

7869 
	`REGISTER_API
(
Di˘Com∑ª
);

7870 
	`REGISTER_API
(
Exp‹tSh¨edAPI
);

7871 
	`REGISTER_API
(
GëSh¨edAPI
);

7872 
	`REGISTER_API
(
Regi°îComm™dFûãr
);

7873 
	`REGISTER_API
(
Uƒegi°îComm™dFûãr
);

7874 
	`REGISTER_API
(
Comm™dFûãrArgsCou¡
);

7875 
	`REGISTER_API
(
Comm™dFûãrArgGë
);

7876 
	`REGISTER_API
(
Comm™dFûãrArgIn£π
);

7877 
	`REGISTER_API
(
Comm™dFûãrArgRïœ˚
);

7878 
	`REGISTER_API
(
Comm™dFûãrArgDñëe
);

7879 
	`REGISTER_API
(
F‹k
);

7880 
	`REGISTER_API
(
ExôFromChûd
);

7881 
	`REGISTER_API
(
KûlF‹kChûd
);

7882 
	`REGISTER_API
(
Regi°îInfoFunc
);

7883 
	`REGISTER_API
(
InfoAddSe˘i⁄
);

7884 
	`REGISTER_API
(
InfoBegöDi˘Fõld
);

7885 
	`REGISTER_API
(
InfoEndDi˘Fõld
);

7886 
	`REGISTER_API
(
InfoAddFõldSåög
);

7887 
	`REGISTER_API
(
InfoAddFõldCSåög
);

7888 
	`REGISTER_API
(
InfoAddFõldDoubÀ
);

7889 
	`REGISTER_API
(
InfoAddFõldL⁄gL⁄g
);

7890 
	`REGISTER_API
(
InfoAddFõldUL⁄gL⁄g
);

7891 
	`REGISTER_API
(
GëSîvîInfo
);

7892 
	`REGISTER_API
(
FªeSîvîInfo
);

7893 
	`REGISTER_API
(
SîvîInfoGëFõld
);

7894 
	`REGISTER_API
(
SîvîInfoGëFõldC
);

7895 
	`REGISTER_API
(
SîvîInfoGëFõldSig√d
);

7896 
	`REGISTER_API
(
SîvîInfoGëFõldUnsig√d
);

7897 
	`REGISTER_API
(
SîvîInfoGëFõldDoubÀ
);

7898 
	`REGISTER_API
(
GëClõ¡InfoById
);

7899 
	`REGISTER_API
(
PublishMesßge
);

7900 
	`REGISTER_API
(
Subs¸ibeToSîvîEvít
);

7901 
	`REGISTER_API
(
SëLRU
);

7902 
	`REGISTER_API
(
GëLRU
);

7903 
	`REGISTER_API
(
SëLFU
);

7904 
	`REGISTER_API
(
GëLFU
);

7905 
	`REGISTER_API
(
BlockClõ¡OnKeys
);

7906 
	`REGISTER_API
(
Sig«lKeyAsRódy
);

7907 
	`REGISTER_API
(
GëBlockedClõ¡RódyKey
);

7908 
	`REGISTER_API
(
GëU£dMem‹yR©io
);

7909 
	`REGISTER_API
(
MÆlocSize
);

7910 
	`REGISTER_API
(
SˇnCurs‹Cª©e
);

7911 
	`REGISTER_API
(
SˇnCurs‹De°roy
);

7912 
	`REGISTER_API
(
SˇnCurs‹Re°¨t
);

7913 
	`REGISTER_API
(
Sˇn
);

7914 
	`REGISTER_API
(
SˇnKey
);

7915 
	`REGISTER_API
(
Cª©eModuÀU£r
);

7916 
	`REGISTER_API
(
SëModuÀU£rACL
);

7917 
	`REGISTER_API
(
FªeModuÀU£r
);

7918 
	`REGISTER_API
(
DóuthítiˇãAndClo£Clõ¡
);

7919 
	`REGISTER_API
(
AuthítiˇãClõ¡WôhACLU£r
);

7920 
	`REGISTER_API
(
AuthítiˇãClõ¡WôhU£r
);

7921 
	}
}

	@modules/helloacl.c

34 
	#REDISMODULE_EXPERIMENTAL_API


	)

35 
	~"../ªdismoduÀ.h
"

36 
	~<±hªad.h
>

37 
	~<uni°d.h
>

40 
RedisModuÀU£r
 *
	gglobÆ
;

41 
uöt64_t
 
	gglobÆ_auth_˛õ¡_id
 = 0;

45 
	$RevokeComm™d_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

46 
	`REDISMODULE_NOT_USED
(
¨gv
);

47 
	`REDISMODULE_NOT_USED
(
¨gc
);

49 i‡(
globÆ_auth_˛õ¡_id
) {

50 
	`RedisModuÀ_DóuthítiˇãAndClo£Clõ¡
(
˘x
, 
globÆ_auth_˛õ¡_id
);

51  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

53  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
, "Global user currentlyÇot used");

55 
	}
}

59 
	$Re£tComm™d_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

60 
	`REDISMODULE_NOT_USED
(
¨gv
);

61 
	`REDISMODULE_NOT_USED
(
¨gc
);

63 
	`RedisModuÀ_FªeModuÀU£r
(
globÆ
);

64 
globÆ
 = 
	`RedisModuÀ_Cª©eModuÀU£r
("global");

65 
	`RedisModuÀ_SëModuÀU£rACL
(
globÆ
, "allcommands");

66 
	`RedisModuÀ_SëModuÀU£rACL
(
globÆ
, "allkeys");

67 
	`RedisModuÀ_SëModuÀU£rACL
(
globÆ
, "on");

69  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

70 
	}
}

74 
	$HñloACL_U£rCh™ged
(
uöt64_t
 
˛õ¡_id
, *
¥ivd©a
) {

75 
	`REDISMODULE_NOT_USED
(
¥ivd©a
);

76 
	`REDISMODULE_NOT_USED
(
˛õ¡_id
);

77 
globÆ_auth_˛õ¡_id
 = 0;

78 
	}
}

82 
	$AuthGlobÆComm™d_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

83 
	`REDISMODULE_NOT_USED
(
¨gv
);

84 
	`REDISMODULE_NOT_USED
(
¨gc
);

86 i‡(
globÆ_auth_˛õ¡_id
) {

87  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
, "Global user currently used");

90 
	`RedisModuÀ_AuthítiˇãClõ¡WôhU£r
(
˘x
, 
globÆ
, 
HñloACL_U£rCh™ged
, 
NULL
, &
globÆ_auth_˛õ¡_id
);

92  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

93 
	}
}

95 
	#TIMEOUT_TIME
 1000

	)

98 
	$HñloACL_Rïly
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

99 
	`REDISMODULE_NOT_USED
(
¨gv
);

100 
	`REDISMODULE_NOT_USED
(
¨gc
);

101 
size_t
 
Àngth
;

103 
RedisModuÀSåög
 *
u£r_°rög
 = 
	`RedisModuÀ_GëBlockedClõ¡Priv©eD©a
(
˘x
);

104 c⁄° *
«me
 = 
	`RedisModuÀ_SåögPåLí
(
u£r_°rög
, &
Àngth
);

106 i‡(
	`RedisModuÀ_AuthítiˇãClõ¡WôhACLU£r
(
˘x
, 
«me
, 
Àngth
, 
NULL
, NULL, NULL) ==

107 
REDISMODULE_ERR
) {

108  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
, "Invalid Username orÖassword");

110  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

111 
	}
}

114 
	$HñloACL_Timeout
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

115 
	`REDISMODULE_NOT_USED
(
¨gv
);

116 
	`REDISMODULE_NOT_USED
(
¨gc
);

117  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "RequestÅimedout");

118 
	}
}

121 
	$HñloACL_FªeD©a
(
RedisModuÀCtx
 *
˘x
, *
¥ivd©a
) {

122 
	`REDISMODULE_NOT_USED
(
˘x
);

123 
	`RedisModuÀ_FªeSåög
(
NULL
, 
¥ivd©a
);

124 
	}
}

127 *
	$HñloACL_ThªadMaö
(*
¨gs
) {

128 **
èrgs
 = 
¨gs
;

129 
RedisModuÀBlockedClõ¡
 *
bc
 = 
èrgs
[0];

130 
RedisModuÀSåög
 *
u£r
 = 
èrgs
[1];

131 
	`RedisModuÀ_Fªe
(
èrgs
);

133 
	`RedisModuÀ_UnblockClõ¡
(
bc
,
u£r
);

134  
NULL
;

135 
	}
}

139 
	$AuthAsyncComm™d_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

140 i‡(
¨gc
 !2Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

142 
±hªad_t
 
tid
;

143 
RedisModuÀBlockedClõ¡
 *
bc
 = 
	`RedisModuÀ_BlockClõ¡
(
˘x
, 
HñloACL_Rïly
, 
HñloACL_Timeout
, 
HñloACL_FªeD©a
, 
TIMEOUT_TIME
);

146 **
èrgs
 = 
	`RedisModuÀ_AŒoc
((*)*2);

147 
èrgs
[0] = 
bc
;

148 
èrgs
[1] = 
	`RedisModuÀ_Cª©eSåögFromSåög
(
NULL
, 
¨gv
[1]);

150 i‡(
	`±hªad_¸óã
(&
tid
, 
NULL
, 
HñloACL_ThªadMaö
, 
èrgs
) != 0) {

151 
	`RedisModuÀ_Ab‹tBlock
(
bc
);

152  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
, "-ERR Can't startÅhread");

155  
REDISMODULE_OK
;

156 
	}
}

160 
	$RedisModuÀ_OnLﬂd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

161 
	`REDISMODULE_NOT_USED
(
¨gv
);

162 
	`REDISMODULE_NOT_USED
(
¨gc
);

164 i‡(
	`RedisModuÀ_Inô
(
˘x
,"hñlﬂ˛",1,
REDISMODULE_APIVER_1
)

165 =
REDISMODULE_ERR
)  REDISMODULE_ERR;

167 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"helloacl.reset",

168 
Re£tComm™d_RedisComm™d
,"",0,0,0Ë=
REDISMODULE_ERR
)

169  
REDISMODULE_ERR
;

171 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"helloacl.revoke",

172 
RevokeComm™d_RedisComm™d
,"",0,0,0Ë=
REDISMODULE_ERR
)

173  
REDISMODULE_ERR
;

175 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"helloacl.authglobal",

176 
AuthGlobÆComm™d_RedisComm™d
,"no-auth",0,0,0Ë=
REDISMODULE_ERR
)

177  
REDISMODULE_ERR
;

179 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"helloacl.authasync",

180 
AuthAsyncComm™d_RedisComm™d
,"no-auth",0,0,0Ë=
REDISMODULE_ERR
)

181  
REDISMODULE_ERR
;

183 
globÆ
 = 
	`RedisModuÀ_Cª©eModuÀU£r
("global");

184 
	`RedisModuÀ_SëModuÀU£rACL
(
globÆ
, "allcommands");

185 
	`RedisModuÀ_SëModuÀU£rACL
(
globÆ
, "allkeys");

186 
	`RedisModuÀ_SëModuÀU£rACL
(
globÆ
, "on");

188 
globÆ_auth_˛õ¡_id
 = 0;

190  
REDISMODULE_OK
;

191 
	}
}

	@modules/helloblock.c

34 
	#REDISMODULE_EXPERIMENTAL_API


	)

35 
	~"../ªdismoduÀ.h
"

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

38 
	~<±hªad.h
>

39 
	~<uni°d.h
>

42 
	$HñloBlock_Rïly
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

43 
	`REDISMODULE_NOT_USED
(
¨gv
);

44 
	`REDISMODULE_NOT_USED
(
¨gc
);

45 *
myöt
 = 
	`RedisModuÀ_GëBlockedClõ¡Priv©eD©a
(
˘x
);

46  
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,*
myöt
);

47 
	}
}

50 
	$HñloBlock_Timeout
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

51 
	`REDISMODULE_NOT_USED
(
¨gv
);

52 
	`REDISMODULE_NOT_USED
(
¨gc
);

53  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
,"RequestÅimedout");

54 
	}
}

57 
	$HñloBlock_FªeD©a
(
RedisModuÀCtx
 *
˘x
, *
¥ivd©a
) {

58 
	`REDISMODULE_NOT_USED
(
˘x
);

59 
	`RedisModuÀ_Fªe
(
¥ivd©a
);

60 
	}
}

64 *
	$HñloBlock_ThªadMaö
(*
¨g
) {

65 **
èrg
 = 
¨g
;

66 
RedisModuÀBlockedClõ¡
 *
bc
 = 
èrg
[0];

67 
dñay
 = ()
èrg
[1];

68 
	`RedisModuÀ_Fªe
(
èrg
);

70 
	`¶ìp
(
dñay
);

71 *
r
 = 
	`RedisModuÀ_AŒoc
(());

72 *
r
 = 
	`ønd
();

73 
	`RedisModuÀ_UnblockClõ¡
(
bc
,
r
);

74  
NULL
;

75 
	}
}

85 
	$HñloBlock_Disc⁄√˘ed
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀBlockedClõ¡
 *
bc
) {

86 
	`RedisModuÀ_Log
(
˘x
,"warning","Blocked client %p disconnected!",

87 (*)
bc
);

92 
	}
}

97 
	$HñloBlock_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

98 i‡(
¨gc
 !3Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

99 
dñay
;

100 
timeout
;

102 i‡(
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[1],&
dñay
Ë!
REDISMODULE_OK
) {

103  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalid count");

106 i‡(
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[2],&
timeout
Ë!
REDISMODULE_OK
) {

107  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalid count");

110 
±hªad_t
 
tid
;

111 
RedisModuÀBlockedClõ¡
 *
bc
 = 
	`RedisModuÀ_BlockClõ¡
(
˘x
,
HñloBlock_Rïly
,
HñloBlock_Timeout
,
HñloBlock_FªeD©a
,
timeout
);

116 
	`RedisModuÀ_SëDisc⁄√˘CÆlback
(
bc
,
HñloBlock_Disc⁄√˘ed
);

121 **
èrg
 = 
	`RedisModuÀ_AŒoc
((*)*2);

122 
èrg
[0] = 
bc
;

123 
èrg
[1] = (*)(Ë
dñay
;

125 i‡(
	`±hªad_¸óã
(&
tid
,
NULL
,
HñloBlock_ThªadMaö
,
èrg
) != 0) {

126 
	`RedisModuÀ_Ab‹tBlock
(
bc
);

127  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"-ERR Can't startÅhread");

129  
REDISMODULE_OK
;

130 
	}
}

139 *
	$HñloKeys_ThªadMaö
(*
¨g
) {

140 
RedisModuÀBlockedClõ¡
 *
bc
 = 
¨g
;

141 
RedisModuÀCtx
 *
˘x
 = 
	`RedisModuÀ_GëThªadSa„C⁄ãxt
(
bc
);

142 
curs‹
 = 0;

143 
size_t
 
ª∂yÀn
 = 0;

145 
	`RedisModuÀ_RïlyWôhAºay
(
˘x
,
REDISMODULE_POSTPONED_ARRAY_LEN
);

147 
	`RedisModuÀ_ThªadSa„C⁄ãxtLock
(
˘x
);

148 
RedisModuÀCÆlRïly
 *
ª∂y
 = 
	`RedisModuÀ_CÆl
(
˘x
,

149 "SCAN","l",()
curs‹
);

150 
	`RedisModuÀ_ThªadSa„C⁄ãxtU∆ock
(
˘x
);

152 
RedisModuÀCÆlRïly
 *
¸_curs‹
 =

153 
	`RedisModuÀ_CÆlRïlyAºayEÀmít
(
ª∂y
,0);

154 
RedisModuÀCÆlRïly
 *
¸_keys
 =

155 
	`RedisModuÀ_CÆlRïlyAºayEÀmít
(
ª∂y
,1);

157 
RedisModuÀSåög
 *
s
 = 
	`RedisModuÀ_Cª©eSåögFromCÆlRïly
(
¸_curs‹
);

158 
	`RedisModuÀ_SåögToL⁄gL⁄g
(
s
,&
curs‹
);

159 
	`RedisModuÀ_FªeSåög
(
˘x
,
s
);

161 
size_t
 
ôems
 = 
	`RedisModuÀ_CÆlRïlyLígth
(
¸_keys
);

162 
size_t
 
j
 = 0; j < 
ôems
; j++) {

163 
RedisModuÀCÆlRïly
 *
ñe
 =

164 
	`RedisModuÀ_CÆlRïlyAºayEÀmít
(
¸_keys
,
j
);

165 
	`RedisModuÀ_RïlyWôhCÆlRïly
(
˘x
,
ñe
);

166 
ª∂yÀn
++;

168 
	`RedisModuÀ_FªeCÆlRïly
(
ª∂y
);

169 } 
curs‹
 != 0);

170 
	`RedisModuÀ_RïlySëAºayLígth
(
˘x
,
ª∂yÀn
);

172 
	`RedisModuÀ_FªeThªadSa„C⁄ãxt
(
˘x
);

173 
	`RedisModuÀ_UnblockClõ¡
(
bc
,
NULL
);

174  
NULL
;

175 
	}
}

181 
	$HñloKeys_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

182 
	`REDISMODULE_NOT_USED
(
¨gv
);

183 i‡(
¨gc
 !1Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

185 
±hªad_t
 
tid
;

190 
RedisModuÀBlockedClõ¡
 *
bc
 = 
	`RedisModuÀ_BlockClõ¡
(
˘x
,
NULL
,NULL,NULL,0);

195 i‡(
	`±hªad_¸óã
(&
tid
,
NULL
,
HñloKeys_ThªadMaö
,
bc
) != 0) {

196 
	`RedisModuÀ_Ab‹tBlock
(
bc
);

197  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"-ERR Can't startÅhread");

199  
REDISMODULE_OK
;

200 
	}
}

204 
	$RedisModuÀ_OnLﬂd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

205 
	`REDISMODULE_NOT_USED
(
¨gv
);

206 
	`REDISMODULE_NOT_USED
(
¨gc
);

208 i‡(
	`RedisModuÀ_Inô
(
˘x
,"hñloblock",1,
REDISMODULE_APIVER_1
)

209 =
REDISMODULE_ERR
)  REDISMODULE_ERR;

211 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.block",

212 
HñloBlock_RedisComm™d
,"",0,0,0Ë=
REDISMODULE_ERR
)

213  
REDISMODULE_ERR
;

214 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.keys",

215 
HñloKeys_RedisComm™d
,"",0,0,0Ë=
REDISMODULE_ERR
)

216  
REDISMODULE_ERR
;

218  
REDISMODULE_OK
;

219 
	}
}

	@modules/hellocluster.c

33 
	#REDISMODULE_EXPERIMENTAL_API


	)

34 
	~"../ªdismoduÀ.h
"

35 
	~<°dio.h
>

36 
	~<°dlib.h
>

37 
	~<˘y≥.h
>

38 
	~<°rög.h
>

40 
	#MSGTYPE_PING
 1

	)

41 
	#MSGTYPE_PONG
 2

	)

44 
	$PögÆlComm™d_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

45 
	`REDISMODULE_NOT_USED
(
¨gv
);

46 
	`REDISMODULE_NOT_USED
(
¨gc
);

48 
	`RedisModuÀ_SídClu°îMesßge
(
˘x
,
NULL
,
MSGTYPE_PING
,(*)"Hey",3);

49  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

50 
	}
}

53 
	$Li°Comm™d_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

54 
	`REDISMODULE_NOT_USED
(
¨gv
);

55 
	`REDISMODULE_NOT_USED
(
¨gc
);

57 
size_t
 
numnodes
;

58 **
ids
 = 
	`RedisModuÀ_GëClu°îNodesLi°
(
˘x
,&
numnodes
);

59 i‡(
ids
 =
NULL
) {

60  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ClusterÇotÉnabled");

63 
	`RedisModuÀ_RïlyWôhAºay
(
˘x
,
numnodes
);

64 
size_t
 
j
 = 0; j < 
numnodes
; j++) {

65 
p‹t
;

66 
	`RedisModuÀ_GëClu°îNodeInfo
(
˘x
,
ids
[
j
],
NULL
,NULL,&
p‹t
,NULL);

67 
	`RedisModuÀ_RïlyWôhAºay
(
˘x
,2);

68 
	`RedisModuÀ_RïlyWôhSåögBuf„r
(
˘x
,
ids
[
j
],
REDISMODULE_NODE_ID_LEN
);

69 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
p‹t
);

71 
	`RedisModuÀ_FªeClu°îNodesLi°
(
ids
);

72  
REDISMODULE_OK
;

73 
	}
}

76 
	$PögRe˚ivî
(
RedisModuÀCtx
 *
˘x
, c⁄° *
£ndî_id
, 
uöt8_t
 
ty≥
, c⁄° *
∑ylﬂd
, 
uöt32_t
 
Àn
) {

77 
	`RedisModuÀ_Log
(
˘x
,"notice","PING (type %d) RECEIVED from %.*s: '%.*s'",

78 
ty≥
,
REDISMODULE_NODE_ID_LEN
,
£ndî_id
,()
Àn
, 
∑ylﬂd
);

79 
	`RedisModuÀ_SídClu°îMesßge
(
˘x
,
NULL
,
MSGTYPE_PONG
,(*)"Ohi!",4);

80 
	`RedisModuÀ_CÆl
(
˘x
, "INCR", "c", "pings_received");

81 
	}
}

84 
	$P⁄gRe˚ivî
(
RedisModuÀCtx
 *
˘x
, c⁄° *
£ndî_id
, 
uöt8_t
 
ty≥
, c⁄° *
∑ylﬂd
, 
uöt32_t
 
Àn
) {

85 
	`RedisModuÀ_Log
(
˘x
,"notice","PONG (type %d) RECEIVED from %.*s: '%.*s'",

86 
ty≥
,
REDISMODULE_NODE_ID_LEN
,
£ndî_id
,()
Àn
, 
∑ylﬂd
);

87 
	}
}

91 
	$RedisModuÀ_OnLﬂd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

92 
	`REDISMODULE_NOT_USED
(
¨gv
);

93 
	`REDISMODULE_NOT_USED
(
¨gc
);

95 i‡(
	`RedisModuÀ_Inô
(
˘x
,"hñlo˛u°î",1,
REDISMODULE_APIVER_1
)

96 =
REDISMODULE_ERR
)  REDISMODULE_ERR;

98 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellocluster.pingall",

99 
PögÆlComm™d_RedisComm™d
,"ªad⁄ly",0,0,0Ë=
REDISMODULE_ERR
)

100  
REDISMODULE_ERR
;

102 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellocluster.list",

103 
Li°Comm™d_RedisComm™d
,"ªad⁄ly",0,0,0Ë=
REDISMODULE_ERR
)

104  
REDISMODULE_ERR
;

112 
	`RedisModuÀ_SëClu°îFœgs
(
˘x
,
REDISMODULE_CLUSTER_FLAG_NO_REDIRECTION
);

115 
	`RedisModuÀ_Regi°îClu°îMesßgeRe˚ivî
(
˘x
,
MSGTYPE_PING
,
PögRe˚ivî
);

116 
	`RedisModuÀ_Regi°îClu°îMesßgeRe˚ivî
(
˘x
,
MSGTYPE_PONG
,
P⁄gRe˚ivî
);

117  
REDISMODULE_OK
;

118 
	}
}

	@modules/hellodict.c

36 
	#REDISMODULE_EXPERIMENTAL_API


	)

37 
	~"../ªdismoduÀ.h
"

38 
	~<°dio.h
>

39 
	~<°dlib.h
>

40 
	~<˘y≥.h
>

41 
	~<°rög.h
>

43 
RedisModuÀDi˘
 *
	gKey•a˚
;

48 
	$cmd_SET
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

49 i‡(
¨gc
 !3Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

50 
	`RedisModuÀ_Di˘Së
(
Key•a˚
,
¨gv
[1],argv[2]);

53 
	`RedisModuÀ_RëaöSåög
(
NULL
,
¨gv
[2]);

54  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

55 
	}
}

61 
	$cmd_GET
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

62 i‡(
¨gc
 !2Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

63 
RedisModuÀSåög
 *
vÆ
 = 
	`RedisModuÀ_Di˘Gë
(
Key•a˚
,
¨gv
[1],
NULL
);

64 i‡(
vÆ
 =
NULL
) {

65  
	`RedisModuÀ_RïlyWôhNuŒ
(
˘x
);

67  
	`RedisModuÀ_RïlyWôhSåög
(
˘x
, 
vÆ
);

69 
	}
}

75 
	$cmd_KEYRANGE
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

76 i‡(
¨gc
 !4Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

79 
cou¡
;

80 i‡(
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[3],&
cou¡
Ë!
REDISMODULE_OK
) {

81  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalid count");

85 
RedisModuÀDi˘Iãr
 *
ôî
 = 
	`RedisModuÀ_Di˘Iãøt‹Sèπ
(

86 
Key•a˚
, ">=", 
¨gv
[1]);

89 *
key
;

90 
size_t
 
keyÀn
;

91 
ª∂yÀn
 = 0;

92 
	`RedisModuÀ_RïlyWôhAºay
(
˘x
,
REDISMODULE_POSTPONED_ARRAY_LEN
);

93 (
key
 = 
	`RedisModuÀ_Di˘NextC
(
ôî
,&
keyÀn
,
NULL
)) != NULL) {

94 i‡(
ª∂yÀn
 >
cou¡
) ;

95 i‡(
	`RedisModuÀ_Di˘Com∑ª
(
ôî
,"<=",
¨gv
[2]Ë=
REDISMODULE_ERR
)

97 
	`RedisModuÀ_RïlyWôhSåögBuf„r
(
˘x
,
key
,
keyÀn
);

98 
ª∂yÀn
++;

100 
	`RedisModuÀ_RïlySëAºayLígth
(
˘x
,
ª∂yÀn
);

103 
	`RedisModuÀ_Di˘Iãøt‹St›
(
ôî
);

104  
REDISMODULE_OK
;

105 
	}
}

109 
	$RedisModuÀ_OnLﬂd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

110 
	`REDISMODULE_NOT_USED
(
¨gv
);

111 
	`REDISMODULE_NOT_USED
(
¨gc
);

113 i‡(
	`RedisModuÀ_Inô
(
˘x
,"hñlodi˘",1,
REDISMODULE_APIVER_1
)

114 =
REDISMODULE_ERR
)  REDISMODULE_ERR;

116 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellodict.set",

117 
cmd_SET
,"wrôêdíy-oom",1,1,0Ë=
REDISMODULE_ERR
)

118  
REDISMODULE_ERR
;

120 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellodict.get",

121 
cmd_GET
,"ªad⁄ly",1,1,0Ë=
REDISMODULE_ERR
)

122  
REDISMODULE_ERR
;

124 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellodict.keyrange",

125 
cmd_KEYRANGE
,"ªad⁄ly",1,1,0Ë=
REDISMODULE_ERR
)

126  
REDISMODULE_ERR
;

129 
Key•a˚
 = 
	`RedisModuÀ_Cª©eDi˘
(
NULL
);

131  
REDISMODULE_OK
;

132 
	}
}

	@modules/hellohook.c

33 
	#REDISMODULE_EXPERIMENTAL_API


	)

34 
	~"../ªdismoduÀ.h
"

35 
	~<°dio.h
>

36 
	~<°dlib.h
>

37 
	~<˘y≥.h
>

38 
	~<°rög.h
>

41 
	$˛õ¡Ch™geCÆlback
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀEvít
 
e
, 
uöt64_t
 
sub
, *
d©a
)

43 
	`REDISMODULE_NOT_USED
(
˘x
);

44 
	`REDISMODULE_NOT_USED
(
e
);

46 
RedisModuÀClõ¡Info
 *
ci
 = 
d©a
;

47 
	`¥ötf
("Client %sÉvent for client #%llu %s:%d\n",

48 (
sub
 =
REDISMODULE_SUBEVENT_CLIENT_CHANGE_CONNECTED
) ?

50 
ci
->
id
,ci->
addr
,ci->
p‹t
);

51 
	}
}

53 
	$ÊushdbCÆlback
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀEvít
 
e
, 
uöt64_t
 
sub
, *
d©a
)

55 
	`REDISMODULE_NOT_USED
(
˘x
);

56 
	`REDISMODULE_NOT_USED
(
e
);

58 
RedisModuÀFlushInfo
 *
fi
 = 
d©a
;

59 i‡(
sub
 =
REDISMODULE_SUBEVENT_FLUSHDB_START
) {

60 i‡(
fi
->
dbnum
 != -1) {

61 
RedisModuÀCÆlRïly
 *
ª∂y
;

62 
ª∂y
 = 
	`RedisModuÀ_CÆl
(
˘x
,"DBSIZE","");

63 
numkeys
 = 
	`RedisModuÀ_CÆlRïlyI¡egî
(
ª∂y
);

64 
	`¥ötf
("FLUSHDBÉvent of database %d started (%lld keys in DB)\n",

65 
fi
->
dbnum
, 
numkeys
);

66 
	`RedisModuÀ_FªeCÆlRïly
(
ª∂y
);

68 
	`¥ötf
("FLUSHALLÉvent started\n");

71 i‡(
fi
->
dbnum
 != -1) {

72 
	`¥ötf
("FLUSHDBÉvíào‡d©aba£ %dÉnded\n",
fi
->
dbnum
);

74 
	`¥ötf
("FLUSHALLÉventÉnded\n");

77 
	}
}

81 
	$RedisModuÀ_OnLﬂd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

82 
	`REDISMODULE_NOT_USED
(
¨gv
);

83 
	`REDISMODULE_NOT_USED
(
¨gc
);

85 i‡(
	`RedisModuÀ_Inô
(
˘x
,"hñlohook",1,
REDISMODULE_APIVER_1
)

86 =
REDISMODULE_ERR
)  REDISMODULE_ERR;

88 
	`RedisModuÀ_Subs¸ibeToSîvîEvít
(
˘x
,

89 
RedisModuÀEvít_Clõ¡Ch™ge
, 
˛õ¡Ch™geCÆlback
);

90 
	`RedisModuÀ_Subs¸ibeToSîvîEvít
(
˘x
,

91 
RedisModuÀEvít_FlushDB
, 
ÊushdbCÆlback
);

92  
REDISMODULE_OK
;

93 
	}
}

	@modules/hellotimer.c

33 
	#REDISMODULE_EXPERIMENTAL_API


	)

34 
	~"../ªdismoduÀ.h
"

35 
	~<°dio.h
>

36 
	~<°dlib.h
>

37 
	~<˘y≥.h
>

38 
	~<°rög.h
>

41 
	$timîH™dÀr
(
RedisModuÀCtx
 *
˘x
, *
d©a
) {

42 
	`REDISMODULE_NOT_USED
(
˘x
);

43 
	`¥ötf
("Fúed %s!\n", 
d©a
);

44 
	`RedisModuÀ_Fªe
(
d©a
);

45 
	}
}

48 
	$TimîComm™d_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

49 
	`REDISMODULE_NOT_USED
(
¨gv
);

50 
	`REDISMODULE_NOT_USED
(
¨gc
);

52 
j
 = 0; j < 10; j++) {

53 
dñay
 = 
	`ønd
() % 5000;

54 *
buf
 = 
	`RedisModuÀ_AŒoc
(256);

55 
	`¢¥ötf
(
buf
,256,"A·î %d", 
dñay
);

56 
RedisModuÀTimîID
 
tid
 = 
	`RedisModuÀ_Cª©eTimî
(
˘x
,
dñay
,
timîH™dÀr
,
buf
);

57 
	`REDISMODULE_NOT_USED
(
tid
);

59  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

60 
	}
}

64 
	$RedisModuÀ_OnLﬂd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

65 
	`REDISMODULE_NOT_USED
(
¨gv
);

66 
	`REDISMODULE_NOT_USED
(
¨gc
);

68 i‡(
	`RedisModuÀ_Inô
(
˘x
,"hñlŸimî",1,
REDISMODULE_APIVER_1
)

69 =
REDISMODULE_ERR
)  REDISMODULE_ERR;

71 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellotimer.timer",

72 
TimîComm™d_RedisComm™d
,"ªad⁄ly",0,0,0Ë=
REDISMODULE_ERR
)

73  
REDISMODULE_ERR
;

75  
REDISMODULE_OK
;

76 
	}
}

	@modules/hellotype.c

38 
	~"../ªdismoduÀ.h
"

39 
	~<°dio.h
>

40 
	~<°dlib.h
>

41 
	~<˘y≥.h
>

42 
	~<°rög.h
>

43 
	~<°döt.h
>

45 
RedisModuÀTy≥
 *
	gHñloTy≥
;

53 
	sHñloTy≥Node
 {

54 
öt64_t
 
	mvÆue
;

55 
HñloTy≥Node
 *
	m√xt
;

58 
	sHñloTy≥Obje˘
 {

59 
HñloTy≥Node
 *
	mhód
;

60 
size_t
 
	mÀn
;

63 
HñloTy≥Obje˘
 *
	$¸óãHñloTy≥Obje˘
() {

64 
HñloTy≥Obje˘
 *
o
;

65 
o
 = 
	`RedisModuÀ_AŒoc
((*o));

66 
o
->
hód
 = 
NULL
;

67 
o
->
Àn
 = 0;

68  
o
;

69 
	}
}

71 
	$HñloTy≥In£π
(
HñloTy≥Obje˘
 *
o
, 
öt64_t
 
ñe
) {

72 
HñloTy≥Node
 *
√xt
 = 
o
->
hód
, *
√wnode
, *
¥ev
 = 
NULL
;

74 
√xt
 &&Çext->
vÆue
 < 
ñe
) {

75 
¥ev
 = 
√xt
;

76 
√xt
 =Çext->next;

78 
√wnode
 = 
	`RedisModuÀ_AŒoc
((*newnode));

79 
√wnode
->
vÆue
 = 
ñe
;

80 
√wnode
->
√xt
 =Çext;

81 i‡(
¥ev
) {

82 
¥ev
->
√xt
 = 
√wnode
;

84 
o
->
hód
 = 
√wnode
;

86 
o
->
Àn
++;

87 
	}
}

89 
	$HñloTy≥Rñó£Obje˘
(
HñloTy≥Obje˘
 *
o
) {

90 
HñloTy≥Node
 *
cur
, *
√xt
;

91 
cur
 = 
o
->
hód
;

92 
cur
) {

93 
√xt
 = 
cur
->next;

94 
	`RedisModuÀ_Fªe
(
cur
);

95 
cur
 = 
√xt
;

97 
	`RedisModuÀ_Fªe
(
o
);

98 
	}
}

103 
	$HñloTy≥In£π_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

104 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

106 i‡(
¨gc
 !3Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

107 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

108 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

109 
ty≥
 = 
	`RedisModuÀ_KeyTy≥
(
key
);

110 i‡(
ty≥
 !
REDISMODULE_KEYTYPE_EMPTY
 &&

111 
	`RedisModuÀ_ModuÀTy≥GëTy≥
(
key
Ë!
HñloTy≥
)

113  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

116 
vÆue
;

117 i‡((
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[2],&
vÆue
Ë!
REDISMODULE_OK
)) {

118  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalid value: must beá signed 64 bit integer");

122 
HñloTy≥Obje˘
 *
hto
;

123 i‡(
ty≥
 =
REDISMODULE_KEYTYPE_EMPTY
) {

124 
hto
 = 
	`¸óãHñloTy≥Obje˘
();

125 
	`RedisModuÀ_ModuÀTy≥SëVÆue
(
key
,
HñloTy≥
,
hto
);

127 
hto
 = 
	`RedisModuÀ_ModuÀTy≥GëVÆue
(
key
);

131 
	`HñloTy≥In£π
(
hto
,
vÆue
);

132 
	`RedisModuÀ_Sig«lKeyAsRódy
(
˘x
,
¨gv
[1]);

134 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
hto
->
Àn
);

135 
	`RedisModuÀ_RïliˇãVîb©im
(
˘x
);

136  
REDISMODULE_OK
;

137 
	}
}

140 
	$HñloTy≥R™ge_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

141 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

143 i‡(
¨gc
 !4Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

144 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

145 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

146 
ty≥
 = 
	`RedisModuÀ_KeyTy≥
(
key
);

147 i‡(
ty≥
 !
REDISMODULE_KEYTYPE_EMPTY
 &&

148 
	`RedisModuÀ_ModuÀTy≥GëTy≥
(
key
Ë!
HñloTy≥
)

150  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

153 
fú°
, 
cou¡
;

154 i‡(
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[2],&
fú°
Ë!
REDISMODULE_OK
 ||

155 
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[3],&
cou¡
Ë!
REDISMODULE_OK
 ||

156 
fú°
 < 0 || 
cou¡
 < 0)

158  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,

162 
HñloTy≥Obje˘
 *
hto
 = 
	`RedisModuÀ_ModuÀTy≥GëVÆue
(
key
);

163 
HñloTy≥Node
 *
node
 = 
hto
 ? hto->
hód
 : 
NULL
;

164 
	`RedisModuÀ_RïlyWôhAºay
(
˘x
,
REDISMODULE_POSTPONED_ARRAY_LEN
);

165 
¨øyÀn
 = 0;

166 
node
 && 
cou¡
--) {

167 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
node
->
vÆue
);

168 
¨øyÀn
++;

169 
node
 =Çode->
√xt
;

171 
	`RedisModuÀ_RïlySëAºayLígth
(
˘x
,
¨øyÀn
);

172  
REDISMODULE_OK
;

173 
	}
}

176 
	$HñloTy≥Lí_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

177 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

179 i‡(
¨gc
 !2Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

180 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

181 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

182 
ty≥
 = 
	`RedisModuÀ_KeyTy≥
(
key
);

183 i‡(
ty≥
 !
REDISMODULE_KEYTYPE_EMPTY
 &&

184 
	`RedisModuÀ_ModuÀTy≥GëTy≥
(
key
Ë!
HñloTy≥
)

186  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

189 
HñloTy≥Obje˘
 *
hto
 = 
	`RedisModuÀ_ModuÀTy≥GëVÆue
(
key
);

190 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
hto
 ? hto->
Àn
 : 0);

191  
REDISMODULE_OK
;

192 
	}
}

199 
	$HñloBlock_Rïly
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

200 
	`REDISMODULE_NOT_USED
(
¨gv
);

201 
	`REDISMODULE_NOT_USED
(
¨gc
);

203 
RedisModuÀSåög
 *
key«me
 = 
	`RedisModuÀ_GëBlockedClõ¡RódyKey
(
˘x
);

204 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
key«me
,
REDISMODULE_READ
);

205 
ty≥
 = 
	`RedisModuÀ_KeyTy≥
(
key
);

206 i‡(
ty≥
 !
REDISMODULE_KEYTYPE_MODULE
 ||

207 
	`RedisModuÀ_ModuÀTy≥GëTy≥
(
key
Ë!
HñloTy≥
)

209 
	`RedisModuÀ_Clo£Key
(
key
);

210  
REDISMODULE_ERR
;

215 
	`RedisModuÀ_Clo£Key
(
key
);

216  
	`HñloTy≥R™ge_RedisComm™d
(
˘x
,
¨gv
,
¨gc
-1);

217 
	}
}

220 
	$HñloBlock_Timeout
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

221 
	`REDISMODULE_NOT_USED
(
¨gv
);

222 
	`REDISMODULE_NOT_USED
(
¨gc
);

223  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
,"RequestÅimedout");

224 
	}
}

227 
	$HñloBlock_FªeD©a
(
RedisModuÀCtx
 *
˘x
, *
¥ivd©a
) {

228 
	`REDISMODULE_NOT_USED
(
˘x
);

229 
	`RedisModuÀ_Fªe
(
¥ivd©a
);

230 
	}
}

235 
	$HñloTy≥BR™ge_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

236 i‡(
¨gc
 !5Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

237 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

238 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

239 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

240 
ty≥
 = 
	`RedisModuÀ_KeyTy≥
(
key
);

241 i‡(
ty≥
 !
REDISMODULE_KEYTYPE_EMPTY
 &&

242 
	`RedisModuÀ_ModuÀTy≥GëTy≥
(
key
Ë!
HñloTy≥
)

244  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

249 
timeout
;

250 i‡(
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[4],&
timeout
Ë!
REDISMODULE_OK
) {

251  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,

256 i‡(
ty≥
 !
REDISMODULE_KEYTYPE_EMPTY
) {

257  
	`HñloTy≥R™ge_RedisComm™d
(
˘x
,
¨gv
,
¨gc
-1);

261 *
¥ivd©a
 = 
	`RedisModuÀ_AŒoc
(100);

262 
	`RedisModuÀ_BlockClõ¡OnKeys
(
˘x
,
HñloBlock_Rïly
,
HñloBlock_Timeout
,
HñloBlock_FªeD©a
,
timeout
,
¨gv
+1,1,
¥ivd©a
);

263  
REDISMODULE_OK
;

264 
	}
}

268 *
	$HñloTy≥RdbLﬂd
(
RedisModuÀIO
 *
rdb
, 
ícvî
) {

269 i‡(
ícvî
 != 0) {

271  
NULL
;

273 
uöt64_t
 
ñemíts
 = 
	`RedisModuÀ_LﬂdUnsig√d
(
rdb
);

274 
HñloTy≥Obje˘
 *
hto
 = 
	`¸óãHñloTy≥Obje˘
();

275 
ñemíts
--) {

276 
öt64_t
 
ñe
 = 
	`RedisModuÀ_LﬂdSig√d
(
rdb
);

277 
	`HñloTy≥In£π
(
hto
,
ñe
);

279  
hto
;

280 
	}
}

282 
	$HñloTy≥RdbSave
(
RedisModuÀIO
 *
rdb
, *
vÆue
) {

283 
HñloTy≥Obje˘
 *
hto
 = 
vÆue
;

284 
HñloTy≥Node
 *
node
 = 
hto
->
hód
;

285 
	`RedisModuÀ_SaveUnsig√d
(
rdb
,
hto
->
Àn
);

286 
node
) {

287 
	`RedisModuÀ_SaveSig√d
(
rdb
,
node
->
vÆue
);

288 
node
 =Çode->
√xt
;

290 
	}
}

292 
	$HñloTy≥AofRewrôe
(
RedisModuÀIO
 *
aof
, 
RedisModuÀSåög
 *
key
, *
vÆue
) {

293 
HñloTy≥Obje˘
 *
hto
 = 
vÆue
;

294 
HñloTy≥Node
 *
node
 = 
hto
->
hód
;

295 
node
) {

296 
	`RedisModuÀ_EmôAOF
(
aof
,"HELLOTYPE.INSERT","¶",
key
,
node
->
vÆue
);

297 
node
 =Çode->
√xt
;

299 
	}
}

303 
size_t
 
	$HñloTy≥MemUßge
(c⁄° *
vÆue
) {

304 c⁄° 
HñloTy≥Obje˘
 *
hto
 = 
vÆue
;

305 
HñloTy≥Node
 *
node
 = 
hto
->
hód
;

306  (*
hto
Ë+ (*
node
)*hto->
Àn
;

307 
	}
}

309 
	$HñloTy≥Fªe
(*
vÆue
) {

310 
	`HñloTy≥Rñó£Obje˘
(
vÆue
);

311 
	}
}

313 
	$HñloTy≥Dige°
(
RedisModuÀDige°
 *
md
, *
vÆue
) {

314 
HñloTy≥Obje˘
 *
hto
 = 
vÆue
;

315 
HñloTy≥Node
 *
node
 = 
hto
->
hód
;

316 
node
) {

317 
	`RedisModuÀ_Dige°AddL⁄gL⁄g
(
md
,
node
->
vÆue
);

318 
node
 =Çode->
√xt
;

320 
	`RedisModuÀ_Dige°EndSequí˚
(
md
);

321 
	}
}

325 
	$RedisModuÀ_OnLﬂd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

326 
	`REDISMODULE_NOT_USED
(
¨gv
);

327 
	`REDISMODULE_NOT_USED
(
¨gc
);

329 i‡(
	`RedisModuÀ_Inô
(
˘x
,"hñlŸy≥",1,
REDISMODULE_APIVER_1
)

330 =
REDISMODULE_ERR
)  REDISMODULE_ERR;

332 
RedisModuÀTy≥Mëhods
 
tm
 = {

333 .
vîsi⁄
 = 
REDISMODULE_TYPE_METHOD_VERSION
,

334 .
rdb_lﬂd
 = 
HñloTy≥RdbLﬂd
,

335 .
rdb_ßve
 = 
HñloTy≥RdbSave
,

336 .
aof_ªwrôe
 = 
HñloTy≥AofRewrôe
,

337 .
mem_ußge
 = 
HñloTy≥MemUßge
,

338 .
‰ì
 = 
HñloTy≥Fªe
,

339 .
dige°
 = 
HñloTy≥Dige°


342 
HñloTy≥
 = 
	`RedisModuÀ_Cª©eD©aTy≥
(
˘x
,"hñlŸy≥",0,&
tm
);

343 i‡(
HñloTy≥
 =
NULL
Ë 
REDISMODULE_ERR
;

345 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellotype.insert",

346 
HñloTy≥In£π_RedisComm™d
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

347  
REDISMODULE_ERR
;

349 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellotype.range",

350 
HñloTy≥R™ge_RedisComm™d
,"ªad⁄ly",1,1,1Ë=
REDISMODULE_ERR
)

351  
REDISMODULE_ERR
;

353 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellotype.len",

354 
HñloTy≥Lí_RedisComm™d
,"ªad⁄ly",1,1,1Ë=
REDISMODULE_ERR
)

355  
REDISMODULE_ERR
;

357 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hellotype.brange",

358 
HñloTy≥BR™ge_RedisComm™d
,"ªad⁄ly",1,1,1Ë=
REDISMODULE_ERR
)

359  
REDISMODULE_ERR
;

361  
REDISMODULE_OK
;

362 
	}
}

	@modules/helloworld.c

37 
	~"../ªdismoduÀ.h
"

38 
	~<°dio.h
>

39 
	~<°dlib.h
>

40 
	~<˘y≥.h
>

41 
	~<°rög.h
>

48 
	$HñloSim∂e_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

49 
	`REDISMODULE_NOT_USED
(
¨gv
);

50 
	`REDISMODULE_NOT_USED
(
¨gc
);

51 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
	`RedisModuÀ_GëSñe˘edDb
(ctx));

52  
REDISMODULE_OK
;

53 
	}
}

61 
	$HñloPushN©ive_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
)

63 i‡(
¨gc
 !3Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

65 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

66 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

68 
	`RedisModuÀ_Li°Push
(
key
,
REDISMODULE_LIST_TAIL
,
¨gv
[2]);

69 
size_t
 
√wÀn
 = 
	`RedisModuÀ_VÆueLígth
(
key
);

70 
	`RedisModuÀ_Clo£Key
(
key
);

71 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
√wÀn
);

72  
REDISMODULE_OK
;

73 
	}
}

80 
	$HñloPushCÆl_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
)

82 i‡(
¨gc
 !3Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

84 
RedisModuÀCÆlRïly
 *
ª∂y
;

86 
ª∂y
 = 
	`RedisModuÀ_CÆl
(
˘x
,"RPUSH","ss",
¨gv
[1],argv[2]);

87 
Àn
 = 
	`RedisModuÀ_CÆlRïlyI¡egî
(
ª∂y
);

88 
	`RedisModuÀ_FªeCÆlRïly
(
ª∂y
);

89 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
Àn
);

90  
REDISMODULE_OK
;

91 
	}
}

96 
	$HñloPushCÆl2_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
)

98 i‡(
¨gc
 !3Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

100 
RedisModuÀCÆlRïly
 *
ª∂y
;

102 
ª∂y
 = 
	`RedisModuÀ_CÆl
(
˘x
,"RPUSH","ss",
¨gv
[1],argv[2]);

103 
	`RedisModuÀ_RïlyWôhCÆlRïly
(
˘x
,
ª∂y
);

104 
	`RedisModuÀ_FªeCÆlRïly
(
ª∂y
);

105  
REDISMODULE_OK
;

106 
	}
}

111 
	$HñloLi°SumLí_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
)

113 i‡(
¨gc
 !2Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

115 
RedisModuÀCÆlRïly
 *
ª∂y
;

117 
ª∂y
 = 
	`RedisModuÀ_CÆl
(
˘x
,"LRANGE","¶l",
¨gv
[1],()0,()-1);

118 
size_t
 
°æí
 = 0;

119 
size_t
 
ôems
 = 
	`RedisModuÀ_CÆlRïlyLígth
(
ª∂y
);

120 
size_t
 
j
;

121 
j
 = 0; j < 
ôems
; j++) {

122 
RedisModuÀCÆlRïly
 *
ñe
 = 
	`RedisModuÀ_CÆlRïlyAºayEÀmít
(
ª∂y
,
j
);

123 
°æí
 +
	`RedisModuÀ_CÆlRïlyLígth
(
ñe
);

125 
	`RedisModuÀ_FªeCÆlRïly
(
ª∂y
);

126 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
°æí
);

127  
REDISMODULE_OK
;

128 
	}
}

134 
	$HñloLi°S∂i˚_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

135 i‡(
¨gc
 !4Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

137 
RedisModuÀKey
 *
§ckey
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

138 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

139 
RedisModuÀKey
 *
d°key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[2],

140 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

143 i‡((
	`RedisModuÀ_KeyTy≥
(
§ckey
Ë!
REDISMODULE_KEYTYPE_LIST
 &&

144 
	`RedisModuÀ_KeyTy≥
(
§ckey
Ë!
REDISMODULE_KEYTYPE_EMPTY
) ||

145 (
	`RedisModuÀ_KeyTy≥
(
d°key
Ë!
REDISMODULE_KEYTYPE_LIST
 &&

146 
	`RedisModuÀ_KeyTy≥
(
d°key
Ë!
REDISMODULE_KEYTYPE_EMPTY
))

148 
	`RedisModuÀ_Clo£Key
(
§ckey
);

149 
	`RedisModuÀ_Clo£Key
(
d°key
);

150  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

153 
cou¡
;

154 i‡((
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[3],&
cou¡
Ë!
REDISMODULE_OK
) ||

155 (
cou¡
 < 0)) {

156 
	`RedisModuÀ_Clo£Key
(
§ckey
);

157 
	`RedisModuÀ_Clo£Key
(
d°key
);

158  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalid count");

161 
cou¡
-- > 0) {

162 
RedisModuÀSåög
 *
ñe
;

164 
ñe
 = 
	`RedisModuÀ_Li°P›
(
§ckey
,
REDISMODULE_LIST_TAIL
);

165 i‡(
ñe
 =
NULL
) ;

166 
	`RedisModuÀ_Li°Push
(
d°key
,
REDISMODULE_LIST_HEAD
,
ñe
);

167 
	`RedisModuÀ_FªeSåög
(
˘x
,
ñe
);

170 
size_t
 
Àn
 = 
	`RedisModuÀ_VÆueLígth
(
§ckey
);

171 
	`RedisModuÀ_Clo£Key
(
§ckey
);

172 
	`RedisModuÀ_Clo£Key
(
d°key
);

173 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
Àn
);

174  
REDISMODULE_OK
;

175 
	}
}

179 
	$HñloLi°S∂i˚Auto_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

180 i‡(
¨gc
 !4Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

182 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

184 
RedisModuÀKey
 *
§ckey
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

185 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

186 
RedisModuÀKey
 *
d°key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[2],

187 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

190 i‡((
	`RedisModuÀ_KeyTy≥
(
§ckey
Ë!
REDISMODULE_KEYTYPE_LIST
 &&

191 
	`RedisModuÀ_KeyTy≥
(
§ckey
Ë!
REDISMODULE_KEYTYPE_EMPTY
) ||

192 (
	`RedisModuÀ_KeyTy≥
(
d°key
Ë!
REDISMODULE_KEYTYPE_LIST
 &&

193 
	`RedisModuÀ_KeyTy≥
(
d°key
Ë!
REDISMODULE_KEYTYPE_EMPTY
))

195  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

198 
cou¡
;

199 i‡((
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[3],&
cou¡
Ë!
REDISMODULE_OK
) ||

200 (
cou¡
 < 0))

202  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalid count");

205 
cou¡
-- > 0) {

206 
RedisModuÀSåög
 *
ñe
;

208 
ñe
 = 
	`RedisModuÀ_Li°P›
(
§ckey
,
REDISMODULE_LIST_TAIL
);

209 i‡(
ñe
 =
NULL
) ;

210 
	`RedisModuÀ_Li°Push
(
d°key
,
REDISMODULE_LIST_HEAD
,
ñe
);

213 
size_t
 
Àn
 = 
	`RedisModuÀ_VÆueLígth
(
§ckey
);

214 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
Àn
);

215  
REDISMODULE_OK
;

216 
	}
}

221 
	$HñloR™dAºay_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

222 i‡(
¨gc
 !2Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

223 
cou¡
;

224 i‡(
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[1],&
cou¡
Ë!
REDISMODULE_OK
 ||

225 
cou¡
 < 0)

226  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalid count");

231 
	`RedisModuÀ_RïlyWôhAºay
(
˘x
,
cou¡
);

232 
cou¡
--Ë
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
	`ønd
());

233  
REDISMODULE_OK
;

234 
	}
}

240 
	$HñloRïl1_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
)

242 
	`REDISMODULE_NOT_USED
(
¨gv
);

243 
	`REDISMODULE_NOT_USED
(
¨gc
);

244 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

256 
	`RedisModuÀ_Rïliˇã
(
˘x
,"ECHO","c","foo");

260 
	`RedisModuÀ_CÆl
(
˘x
,"INCR","c!","foo");

261 
	`RedisModuÀ_CÆl
(
˘x
,"INCR","c!","bar");

263 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,0);

265  
REDISMODULE_OK
;

266 
	}
}

278 
	$HñloRïl2_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

279 i‡(
¨gc
 !2Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

281 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

282 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

283 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

285 i‡(
	`RedisModuÀ_KeyTy≥
(
key
Ë!
REDISMODULE_KEYTYPE_LIST
)

286  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

288 
size_t
 
li°Àn
 = 
	`RedisModuÀ_VÆueLígth
(
key
);

289 
sum
 = 0;

292 
li°Àn
--) {

293 
RedisModuÀSåög
 *
ñe
 = 
	`RedisModuÀ_Li°P›
(
key
,
REDISMODULE_LIST_TAIL
);

294 
vÆ
;

295 i‡(
	`RedisModuÀ_SåögToL⁄gL⁄g
(
ñe
,&
vÆ
Ë!
REDISMODULE_OK
) val = 0;

296 
vÆ
++;

297 
sum
 +
vÆ
;

298 
RedisModuÀSåög
 *
√wñe
 = 
	`RedisModuÀ_Cª©eSåögFromL⁄gL⁄g
(
˘x
,
vÆ
);

299 
	`RedisModuÀ_Li°Push
(
key
,
REDISMODULE_LIST_HEAD
,
√wñe
);

301 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
sum
);

302 
	`RedisModuÀ_RïliˇãVîb©im
(
˘x
);

303  
REDISMODULE_OK
;

304 
	}
}

314 
	$HñloToggÀCa£_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

315 i‡(
¨gc
 !2Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

317 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

318 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

320 
keyty≥
 = 
	`RedisModuÀ_KeyTy≥
(
key
);

321 i‡(
keyty≥
 !
REDISMODULE_KEYTYPE_STRING
 &&

322 
keyty≥
 !
REDISMODULE_KEYTYPE_EMPTY
)

324 
	`RedisModuÀ_Clo£Key
(
key
);

325  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

328 i‡(
keyty≥
 =
REDISMODULE_KEYTYPE_STRING
) {

329 
size_t
 
Àn
, 
j
;

330 *
s
 = 
	`RedisModuÀ_SåögDMA
(
key
,&
Àn
,
REDISMODULE_WRITE
);

331 
j
 = 0; j < 
Àn
; j++) {

332 i‡(
	`isuµî
(
s
[
j
])) {

333 
s
[
j
] = 
	`tﬁowî
(s[j]);

335 
s
[
j
] = 
	`touµî
(s[j]);

340 
	`RedisModuÀ_Clo£Key
(
key
);

341 
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
,"OK");

342 
	`RedisModuÀ_RïliˇãVîb©im
(
˘x
);

343  
REDISMODULE_OK
;

344 
	}
}

350 
	$HñloM‹eExpúe_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

351 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

352 i‡(
¨gc
 !3Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

354 
m°ime_t
 
addms
, 
expúe
;

356 i‡(
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[2],&
addms
Ë!
REDISMODULE_OK
)

357  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalidÉxpireÅime");

359 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

360 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

361 
expúe
 = 
	`RedisModuÀ_GëExpúe
(
key
);

362 i‡(
expúe
 !
REDISMODULE_NO_EXPIRE
) {

363 
expúe
 +
addms
;

364 
	`RedisModuÀ_SëExpúe
(
key
,
expúe
);

366  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
,"OK");

367 
	}
}

375 
	$HñloZsumR™ge_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

376 
sc‹e_°¨t
, 
sc‹e_íd
;

377 i‡(
¨gc
 !4Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

379 i‡(
	`RedisModuÀ_SåögToDoubÀ
(
¨gv
[2],&
sc‹e_°¨t
Ë!
REDISMODULE_OK
 ||

380 
	`RedisModuÀ_SåögToDoubÀ
(
¨gv
[3],&
sc‹e_íd
Ë!
REDISMODULE_OK
)

382  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalidÑange");

385 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

386 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

387 i‡(
	`RedisModuÀ_KeyTy≥
(
key
Ë!
REDISMODULE_KEYTYPE_ZSET
) {

388  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

391 
sc‹esum_a
 = 0;

392 
sc‹esum_b
 = 0;

394 
	`RedisModuÀ_Z£tFú°InSc‹eR™ge
(
key
,
sc‹e_°¨t
,
sc‹e_íd
,0,0);

395 !
	`RedisModuÀ_Z£tR™geEndRóched
(
key
)) {

396 
sc‹e
;

397 
RedisModuÀSåög
 *
ñe
 = 
	`RedisModuÀ_Z£tR™geCuºítEÀmít
(
key
,&
sc‹e
);

398 
	`RedisModuÀ_FªeSåög
(
˘x
,
ñe
);

399 
sc‹esum_a
 +
sc‹e
;

400 
	`RedisModuÀ_Z£tR™geNext
(
key
);

402 
	`RedisModuÀ_Z£tR™geSt›
(
key
);

404 
	`RedisModuÀ_Z£tLa°InSc‹eR™ge
(
key
,
sc‹e_°¨t
,
sc‹e_íd
,0,0);

405 !
	`RedisModuÀ_Z£tR™geEndRóched
(
key
)) {

406 
sc‹e
;

407 
RedisModuÀSåög
 *
ñe
 = 
	`RedisModuÀ_Z£tR™geCuºítEÀmít
(
key
,&
sc‹e
);

408 
	`RedisModuÀ_FªeSåög
(
˘x
,
ñe
);

409 
sc‹esum_b
 +
sc‹e
;

410 
	`RedisModuÀ_Z£tR™gePªv
(
key
);

413 
	`RedisModuÀ_Z£tR™geSt›
(
key
);

415 
	`RedisModuÀ_Clo£Key
(
key
);

417 
	`RedisModuÀ_RïlyWôhAºay
(
˘x
,2);

418 
	`RedisModuÀ_RïlyWôhDoubÀ
(
˘x
,
sc‹esum_a
);

419 
	`RedisModuÀ_RïlyWôhDoubÀ
(
˘x
,
sc‹esum_b
);

420  
REDISMODULE_OK
;

421 
	}
}

430 
	$HñloLexR™ge_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

431 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

433 i‡(
¨gc
 !6Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

435 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

436 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

437 i‡(
	`RedisModuÀ_KeyTy≥
(
key
Ë!
REDISMODULE_KEYTYPE_ZSET
) {

438  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

441 i‡(
	`RedisModuÀ_Z£tFú°InLexR™ge
(
key
,
¨gv
[2],¨gv[3]Ë!
REDISMODULE_OK
) {

442  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"invalidÑange");

445 
¨øyÀn
 = 0;

446 
	`RedisModuÀ_RïlyWôhAºay
(
˘x
,
REDISMODULE_POSTPONED_ARRAY_LEN
);

447 !
	`RedisModuÀ_Z£tR™geEndRóched
(
key
)) {

448 
sc‹e
;

449 
RedisModuÀSåög
 *
ñe
 = 
	`RedisModuÀ_Z£tR™geCuºítEÀmít
(
key
,&
sc‹e
);

450 
	`RedisModuÀ_RïlyWôhSåög
(
˘x
,
ñe
);

451 
	`RedisModuÀ_FªeSåög
(
˘x
,
ñe
);

452 
	`RedisModuÀ_Z£tR™geNext
(
key
);

453 
¨øyÀn
++;

455 
	`RedisModuÀ_Z£tR™geSt›
(
key
);

456 
	`RedisModuÀ_RïlySëAºayLígth
(
˘x
,
¨øyÀn
);

457 
	`RedisModuÀ_Clo£Key
(
key
);

458  
REDISMODULE_OK
;

459 
	}
}

468 
	$HñloHC›y_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

469 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

471 i‡(
¨gc
 !4Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

472 
RedisModuÀKey
 *
key
 = 
	`RedisModuÀ_O≥nKey
(
˘x
,
¨gv
[1],

473 
REDISMODULE_READ
|
REDISMODULE_WRITE
);

474 
ty≥
 = 
	`RedisModuÀ_KeyTy≥
(
key
);

475 i‡(
ty≥
 !
REDISMODULE_KEYTYPE_HASH
 &&

476 
ty≥
 !
REDISMODULE_KEYTYPE_EMPTY
)

478  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,
REDISMODULE_ERRORMSG_WRONGTYPE
);

482 
RedisModuÀSåög
 *
ﬁdvÆ
;

483 
	`RedisModuÀ_HashGë
(
key
,
REDISMODULE_HASH_NONE
,
¨gv
[2],&
ﬁdvÆ
,
NULL
);

484 i‡(
ﬁdvÆ
) {

485 
	`RedisModuÀ_HashSë
(
key
,
REDISMODULE_HASH_NONE
,
¨gv
[3],
ﬁdvÆ
,
NULL
);

487 
	`RedisModuÀ_RïlyWôhL⁄gL⁄g
(
˘x
,
ﬁdvÆ
 !
NULL
);

488  
REDISMODULE_OK
;

489 
	}
}

509 
	$HñloLe·Pad_RedisComm™d
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

510 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

511 
∑dÀn
;

513 i‡(
¨gc
 !4Ë 
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

515 i‡((
	`RedisModuÀ_SåögToL⁄gL⁄g
(
¨gv
[2],&
∑dÀn
Ë!
REDISMODULE_OK
) ||

516 (
∑dÀn
< 0)) {

517  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,"ERR invalidÖaddingÜength");

519 
size_t
 
°æí
, 
chÀn
;

520 c⁄° *
°r
 = 
	`RedisModuÀ_SåögPåLí
(
¨gv
[1], &
°æí
);

521 c⁄° *
ch
 = 
	`RedisModuÀ_SåögPåLí
(
¨gv
[3], &
chÀn
);

525 i‡(
°æí
 >(
size_t
)
∑dÀn
)

526  
	`RedisModuÀ_RïlyWôhSåög
(
˘x
,
¨gv
[1]);

529 i‡(
chÀn
 != 1)

530  
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
,

534 
∑dÀn
 -
°æí
;

535 *
buf
 = 
	`RedisModuÀ_PoﬁAŒoc
(
˘x
,
∑dÀn
+
°æí
);

536 
j
 = 0; j < 
∑dÀn
; j++Ë
buf
[j] = *
ch
;

537 
	`mem˝y
(
buf
+
∑dÀn
,
°r
,
°æí
);

539 
	`RedisModuÀ_RïlyWôhSåögBuf„r
(
˘x
,
buf
,
∑dÀn
+
°æí
);

540  
REDISMODULE_OK
;

541 
	}
}

545 
	$RedisModuÀ_OnLﬂd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

546 i‡(
	`RedisModuÀ_Inô
(
˘x
,"hñlow‹ld",1,
REDISMODULE_APIVER_1
)

547 =
REDISMODULE_ERR
)  REDISMODULE_ERR;

550 
j
 = 0; j < 
¨gc
; j++) {

551 c⁄° *
s
 = 
	`RedisModuÀ_SåögPåLí
(
¨gv
[
j
],
NULL
);

552 
	`¥ötf
("ModuÀÜﬂded wôh ARGV[%d] = %s\n", 
j
, 
s
);

555 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.simple",

556 
HñloSim∂e_RedisComm™d
,"ªad⁄ly",0,0,0Ë=
REDISMODULE_ERR
)

557  
REDISMODULE_ERR
;

559 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.push.native",

560 
HñloPushN©ive_RedisComm™d
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

561  
REDISMODULE_ERR
;

563 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.push.call",

564 
HñloPushCÆl_RedisComm™d
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

565  
REDISMODULE_ERR
;

567 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.push.call2",

568 
HñloPushCÆl2_RedisComm™d
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

569  
REDISMODULE_ERR
;

571 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.list.sum.len",

572 
HñloLi°SumLí_RedisComm™d
,"ªad⁄ly",1,1,1Ë=
REDISMODULE_ERR
)

573  
REDISMODULE_ERR
;

575 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.list.splice",

576 
HñloLi°S∂i˚_RedisComm™d
,"wrôêdíy-oom",1,2,1Ë=
REDISMODULE_ERR
)

577  
REDISMODULE_ERR
;

579 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.list.splice.auto",

580 
HñloLi°S∂i˚Auto_RedisComm™d
,

581 "wrôêdíy-oom",1,2,1Ë=
REDISMODULE_ERR
)

582  
REDISMODULE_ERR
;

584 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.rand.array",

585 
HñloR™dAºay_RedisComm™d
,"ªad⁄ly",0,0,0Ë=
REDISMODULE_ERR
)

586  
REDISMODULE_ERR
;

588 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.repl1",

589 
HñloRïl1_RedisComm™d
,"wrôe",0,0,0Ë=
REDISMODULE_ERR
)

590  
REDISMODULE_ERR
;

592 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.repl2",

593 
HñloRïl2_RedisComm™d
,"wrôe",1,1,1Ë=
REDISMODULE_ERR
)

594  
REDISMODULE_ERR
;

596 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.toggle.case",

597 
HñloToggÀCa£_RedisComm™d
,"wrôe",1,1,1Ë=
REDISMODULE_ERR
)

598  
REDISMODULE_ERR
;

600 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.more.expire",

601 
HñloM‹eExpúe_RedisComm™d
,"wrôe",1,1,1Ë=
REDISMODULE_ERR
)

602  
REDISMODULE_ERR
;

604 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.zsumrange",

605 
HñloZsumR™ge_RedisComm™d
,"ªad⁄ly",1,1,1Ë=
REDISMODULE_ERR
)

606  
REDISMODULE_ERR
;

608 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.lexrange",

609 
HñloLexR™ge_RedisComm™d
,"ªad⁄ly",1,1,1Ë=
REDISMODULE_ERR
)

610  
REDISMODULE_ERR
;

612 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.hcopy",

613 
HñloHC›y_RedisComm™d
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

614  
REDISMODULE_ERR
;

616 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"hello.leftpad",

617 
HñloLe·Pad_RedisComm™d
,"",1,1,1Ë=
REDISMODULE_ERR
)

618  
REDISMODULE_ERR
;

620  
REDISMODULE_OK
;

621 
	}
}

	@modules/testmodule.c

33 
	#REDISMODULE_EXPERIMENTAL_API


	)

34 
	~"../ªdismoduÀ.h
"

35 
	~<°rög.h
>

40 
	$Te°M©chRïly
(
RedisModuÀCÆlRïly
 *
ª∂y
, *
°r
) {

41 
RedisModuÀSåög
 *
my°r
;

42 
my°r
 = 
	`RedisModuÀ_Cª©eSåögFromCÆlRïly
(
ª∂y
);

43 i‡(!
my°r
)  0;

44 c⁄° *
±r
 = 
	`RedisModuÀ_SåögPåLí
(
my°r
,
NULL
);

45  
	`°rcmp
(
±r
,
°r
) == 0;

46 
	}
}

51 
	$Te°CÆl
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

52 
	`REDISMODULE_NOT_USED
(
¨gv
);

53 
	`REDISMODULE_NOT_USED
(
¨gc
);

55 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

56 
RedisModuÀCÆlRïly
 *
ª∂y
;

58 
	`RedisModuÀ_CÆl
(
˘x
,"DEL","c","mylist");

59 
RedisModuÀSåög
 *
my°r
 = 
	`RedisModuÀ_Cª©eSåög
(
˘x
,"foo",3);

60 
	`RedisModuÀ_CÆl
(
˘x
,"RPUSH","c¶","myli°",
my°r
,()1234);

61 
ª∂y
 = 
	`RedisModuÀ_CÆl
(
˘x
,"LRANGE","ccc","mylist","0","-1");

62 
ôems
 = 
	`RedisModuÀ_CÆlRïlyLígth
(
ª∂y
);

63 i‡(
ôems
 !2Ë
Áû
;

65 
RedisModuÀCÆlRïly
 *
ôem0
, *
ôem1
;

67 
ôem0
 = 
	`RedisModuÀ_CÆlRïlyAºayEÀmít
(
ª∂y
,0);

68 
ôem1
 = 
	`RedisModuÀ_CÆlRïlyAºayEÀmít
(
ª∂y
,1);

69 i‡(!
	`Te°M©chRïly
(
ôem0
,"foo")Ë
Áû
;

70 i‡(!
	`Te°M©chRïly
(
ôem1
,"1234")Ë
Áû
;

72 
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
,"OK");

73  
REDISMODULE_OK
;

75 
Áû
:

76 
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
,"ERR");

77  
REDISMODULE_OK
;

78 
	}
}

81 
	$Te°SåögAµíd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

82 
	`REDISMODULE_NOT_USED
(
¨gv
);

83 
	`REDISMODULE_NOT_USED
(
¨gc
);

85 
RedisModuÀSåög
 *
s
 = 
	`RedisModuÀ_Cª©eSåög
(
˘x
,"foo",3);

86 
	`RedisModuÀ_SåögAµídBuf„r
(
˘x
,
s
,"bar",3);

87 
	`RedisModuÀ_RïlyWôhSåög
(
˘x
,
s
);

88 
	`RedisModuÀ_FªeSåög
(
˘x
,
s
);

89  
REDISMODULE_OK
;

90 
	}
}

93 
	$Te°SåögAµídAM
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

94 
	`REDISMODULE_NOT_USED
(
¨gv
);

95 
	`REDISMODULE_NOT_USED
(
¨gc
);

97 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

98 
RedisModuÀSåög
 *
s
 = 
	`RedisModuÀ_Cª©eSåög
(
˘x
,"foo",3);

99 
	`RedisModuÀ_RëaöSåög
(
˘x
,
s
);

100 
	`RedisModuÀ_SåögAµídBuf„r
(
˘x
,
s
,"bar",3);

101 
	`RedisModuÀ_RïlyWôhSåög
(
˘x
,
s
);

102 
	`RedisModuÀ_FªeSåög
(
˘x
,
s
);

103  
REDISMODULE_OK
;

104 
	}
}

107 
	$Te°SåögPrötf
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

108 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

109 i‡(
¨gc
 < 3) {

110  
	`RedisModuÀ_Wr⁄gArôy
(
˘x
);

112 
RedisModuÀSåög
 *
s
 = 
	`RedisModuÀ_Cª©eSåögPrötf
(
˘x
,

114 
¨gc
,

115 
	`RedisModuÀ_SåögPåLí
(
¨gv
[1], 
NULL
),

116 
	`RedisModuÀ_SåögPåLí
(
¨gv
[2], 
NULL
)

119 
	`RedisModuÀ_RïlyWôhSåög
(
˘x
,
s
);

121  
REDISMODULE_OK
;

122 
	}
}

124 
	$ÁûTe°
(
RedisModuÀCtx
 *
˘x
, c⁄° *
msg
) {

125 
	`RedisModuÀ_RïlyWôhEº‹
(
˘x
, 
msg
);

126  
REDISMODULE_ERR
;

127 
	}
}

129 
	$Te°U∆ök
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

130 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

131 
	`REDISMODULE_NOT_USED
(
¨gv
);

132 
	`REDISMODULE_NOT_USED
(
¨gc
);

134 
RedisModuÀKey
 *
k
 = 
	`RedisModuÀ_O≥nKey
(
˘x
, 
	`RedisModuÀ_Cª©eSåögPrötf
(˘x, "u∆öked"), 
REDISMODULE_WRITE
 | 
REDISMODULE_READ
);

135 i‡(!
k
Ë 
	`ÁûTe°
(
˘x
, "CouldÇot create key");

137 i‡(
REDISMODULE_ERR
 =
	`RedisModuÀ_SåögSë
(
k
, 
	`RedisModuÀ_Cª©eSåögPrötf
(
˘x
, "Foobar"))) {

138  
	`ÁûTe°
(
˘x
, "CouldÇot set string value");

141 
RedisModuÀCÆlRïly
 *
ªp
 = 
	`RedisModuÀ_CÆl
(
˘x
, "EXISTS", "c", "unlinked");

142 i‡(!
ªp
 || 
	`RedisModuÀ_CÆlRïlyI¡egî
(rep) != 1) {

143  
	`ÁûTe°
(
˘x
, "Key doesÇotÉxist before unlink");

146 i‡(
REDISMODULE_ERR
 =
	`RedisModuÀ_U∆ökKey
(
k
)) {

147  
	`ÁûTe°
(
˘x
, "CouldÇot unlink key");

150 
ªp
 = 
	`RedisModuÀ_CÆl
(
˘x
, "EXISTS", "c", "unlinked");

151 i‡(!
ªp
 || 
	`RedisModuÀ_CÆlRïlyI¡egî
(rep) != 0) {

152  
	`ÁûTe°
(
˘x
, "CouldÇot verify keyÅo be unlinked");

154  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

156 
	}
}

158 
	$NŸifyCÆlback
(
RedisModuÀCtx
 *
˘x
, 
ty≥
, c⁄° *
evít
,

159 
RedisModuÀSåög
 *
key
) {

162 
	`RedisModuÀ_Log
(
˘x
, "nŸi˚", "GŸÉvíàty≥ %d,Évíà%s, key %s", 
ty≥
,

163 
evít
, 
	`RedisModuÀ_SåögPåLí
(
key
, 
NULL
));

165 
	`RedisModuÀ_CÆl
(
˘x
, "HINCRBY", "csc", "nŸifiˇti⁄s", 
key
, "1");

166  
REDISMODULE_OK
;

167 
	}
}

170 
	$Te°NŸifiˇti⁄s
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

171 
	`REDISMODULE_NOT_USED
(
¨gv
);

172 
	`REDISMODULE_NOT_USED
(
¨gc
);

174 
	#FAIL
(
msg
, ...) \

176 
	`RedisModuÀ_Log
(
˘x
, "w¨nög", "Faûed NOTIFY Te°. Rós⁄: " #msg, ##
__VA_ARGS__
); \

177 
îr
; \

178 }

	)

179 
	`RedisModuÀ_CÆl
(
˘x
, "FLUSHDB", "");

181 
	`RedisModuÀ_CÆl
(
˘x
, "SET", "cc", "foo", "bar");

182 
	`RedisModuÀ_CÆl
(
˘x
, "SET", "cc", "foo", "baz");

183 
	`RedisModuÀ_CÆl
(
˘x
, "SADD", "cc", "bar", "x");

184 
	`RedisModuÀ_CÆl
(
˘x
, "SADD", "cc", "bar", "y");

186 
	`RedisModuÀ_CÆl
(
˘x
, "HSET", "ccc", "baz", "x", "y");

188 
	`RedisModuÀ_CÆl
(
˘x
, "LPUSH", "cc", "l", "y");

189 
	`RedisModuÀ_CÆl
(
˘x
, "LPUSH", "cc", "l", "y");

192 
	`RedisModuÀ_CÆl
(
˘x
, "GET", "c", "nosuchkey");

193 
	`RedisModuÀ_CÆl
(
˘x
, "SMEMBERS", "c", "nosuchkey");

195 
size_t
 
sz
;

196 c⁄° *
ªp
;

197 
RedisModuÀCÆlRïly
 *
r
 = 
	`RedisModuÀ_CÆl
(
˘x
, "HGET", "cc", "notifications", "foo");

198 i‡(
r
 =
NULL
 || 
	`RedisModuÀ_CÆlRïlyTy≥
‘Ë!
REDISMODULE_REPLY_STRING
) {

199 
	`FAIL
("Wrong orÇoÑeply for foo");

201 
ªp
 = 
	`RedisModuÀ_CÆlRïlySåögPå
(
r
, &
sz
);

202 i‡(
sz
 !1 || *
ªp
 != '2') {

203 
	`FAIL
("GŸÑïly '%s'.Éx≥˘ed '2'", 
	`RedisModuÀ_CÆlRïlySåögPå
(
r
, 
NULL
));

207 
r
 = 
	`RedisModuÀ_CÆl
(
˘x
, "HGET", "cc", "notifications", "bar");

208 i‡(
r
 =
NULL
 || 
	`RedisModuÀ_CÆlRïlyTy≥
‘Ë!
REDISMODULE_REPLY_STRING
) {

209 
	`FAIL
("Wrong orÇoÑeply for bar");

211 
ªp
 = 
	`RedisModuÀ_CÆlRïlySåögPå
(
r
, &
sz
);

212 i‡(
sz
 !1 || *
ªp
 != '2') {

213 
	`FAIL
("GŸÑïly '%s'.Éx≥˘ed '2'", 
ªp
);

217 
r
 = 
	`RedisModuÀ_CÆl
(
˘x
, "HGET", "cc", "notifications", "baz");

218 i‡(
r
 =
NULL
 || 
	`RedisModuÀ_CÆlRïlyTy≥
‘Ë!
REDISMODULE_REPLY_STRING
) {

219 
	`FAIL
("Wrong orÇoÑeply for baz");

221 
ªp
 = 
	`RedisModuÀ_CÆlRïlySåögPå
(
r
, &
sz
);

222 i‡(
sz
 !1 || *
ªp
 != '1') {

223 
	`FAIL
("GŸÑïly '%.*s'.Éx≥˘ed '1'", 
sz
, 
ªp
);

227 
r
 = 
	`RedisModuÀ_CÆl
(
˘x
, "HGET", "cc", "notifications", "l");

228 i‡(
r
 =
NULL
 || 
	`RedisModuÀ_CÆlRïlyTy≥
‘Ë!
REDISMODULE_REPLY_NULL
) {

229 
	`FAIL
("WrongÑeply forÜ");

232 
r
 = 
	`RedisModuÀ_CÆl
(
˘x
, "HGET", "cc", "notifications", "nosuchkey");

233 i‡(
r
 =
NULL
 || 
	`RedisModuÀ_CÆlRïlyTy≥
‘Ë!
REDISMODULE_REPLY_STRING
) {

234 
	`FAIL
("Wrong orÇoÑeply forÇosuchkey");

236 
ªp
 = 
	`RedisModuÀ_CÆlRïlySåögPå
(
r
, &
sz
);

237 i‡(
sz
 !1 || *
ªp
 != '2') {

238 
	`FAIL
("GŸÑïly '%.*s'.Éx≥˘ed '2'", 
sz
, 
ªp
);

242 
	`RedisModuÀ_CÆl
(
˘x
, "FLUSHDB", "");

244  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

245 
îr
:

246 
	`RedisModuÀ_CÆl
(
˘x
, "FLUSHDB", "");

248  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "ERR");

249 
	}
}

252 
	$Te°CtxFœgs
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

253 
	`REDISMODULE_NOT_USED
(
¨gc
);

254 
	`REDISMODULE_NOT_USED
(
¨gv
);

256 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

258 
ok
 = 1;

259 c⁄° *
îrSåög
 = 
NULL
;

260 #unde‡
FAIL


261 
	#FAIL
(
msg
) \

263 
ok
 = 0; \

264 
îrSåög
 = 
msg
; \

265 
íd
; \

266 }

	)

268 
Êags
 = 
	`RedisModuÀ_GëC⁄ãxtFœgs
(
˘x
);

269 i‡(
Êags
 == 0) {

270 
	`FAIL
("GotÇo flags");

273 i‡(
Êags
 & 
REDISMODULE_CTX_FLAGS_LUA
Ë
	`FAIL
("Lua flag was set");

274 i‡(
Êags
 & 
REDISMODULE_CTX_FLAGS_MULTI
Ë
	`FAIL
("Multi flag was set");

276 i‡(
Êags
 & 
REDISMODULE_CTX_FLAGS_AOF
Ë
	`FAIL
("AOF Flag was set")

278 
	`RedisModuÀ_CÆl
(
˘x
, "config", "ccc", "set", "appendonly", "yes");

279 
Êags
 = 
	`RedisModuÀ_GëC⁄ãxtFœgs
(
˘x
);

280 i‡(!(
Êags
 & 
REDISMODULE_CTX_FLAGS_AOF
)Ë
	`FAIL
("AOF FlagÇot setáfter config set");

282 i‡(
Êags
 & 
REDISMODULE_CTX_FLAGS_RDB
Ë
	`FAIL
("RDB Flag was set");

284 
	`RedisModuÀ_CÆl
(
˘x
, "config", "ccc", "set", "save", "900 1");

285 
Êags
 = 
	`RedisModuÀ_GëC⁄ãxtFœgs
(
˘x
);

286 i‡(!(
Êags
 & 
REDISMODULE_CTX_FLAGS_RDB
)Ë
	`FAIL
("RDB Flag wasÇot setáfter config set");

288 i‡(!(
Êags
 & 
REDISMODULE_CTX_FLAGS_MASTER
)Ë
	`FAIL
("Master flag wasÇot set");

289 i‡(
Êags
 & 
REDISMODULE_CTX_FLAGS_SLAVE
Ë
	`FAIL
("Slave flag was set");

290 i‡(
Êags
 & 
REDISMODULE_CTX_FLAGS_READONLY
Ë
	`FAIL
("Read-only flag was set");

291 i‡(
Êags
 & 
REDISMODULE_CTX_FLAGS_CLUSTER
Ë
	`FAIL
("Cluster flag was set");

293 i‡(
Êags
 & 
REDISMODULE_CTX_FLAGS_MAXMEMORY
Ë
	`FAIL
("Maxmemory flag was set");

295 
	`RedisModuÀ_CÆl
(
˘x
, "config", "ccc", "set", "maxmemory", "100000000");

296 
Êags
 = 
	`RedisModuÀ_GëC⁄ãxtFœgs
(
˘x
);

297 i‡(!(
Êags
 & 
REDISMODULE_CTX_FLAGS_MAXMEMORY
))

298 
	`FAIL
("Maxmemory flag wasÇot setáfter config set");

300 i‡(
Êags
 & 
REDISMODULE_CTX_FLAGS_EVICT
Ë
	`FAIL
("Eviction flag was set");

301 
	`RedisModuÀ_CÆl
(
˘x
, "config", "ccc", "set", "maxmemory-policy", "allkeys-lru");

302 
Êags
 = 
	`RedisModuÀ_GëC⁄ãxtFœgs
(
˘x
);

303 i‡(!(
Êags
 & 
REDISMODULE_CTX_FLAGS_EVICT
)Ë
	`FAIL
("Eviction flag wasÇot setáfter config set");

305 
íd
:

307 
	`RedisModuÀ_CÆl
(
˘x
, "config", "ccc", "set", "appendonly", "no");

308 
	`RedisModuÀ_CÆl
(
˘x
, "config", "ccc", "set", "save", "");

309 
	`RedisModuÀ_CÆl
(
˘x
, "config", "ccc", "set", "maxmemory", "0");

310 
	`RedisModuÀ_CÆl
(
˘x
, "config", "ccc", "set", "maxmemory-policy", "noeviction");

312 i‡(!
ok
) {

313 
	`RedisModuÀ_Log
(
˘x
, "w¨nög", "Faûed CTXFLAGS Te°. Rós⁄: %s", 
îrSåög
);

314  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "ERR");

317  
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
, "OK");

318 
	}
}

324 
	$Te°As£πSåögRïly
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀCÆlRïly
 *
ª∂y
, *
°r
, 
size_t
 
Àn
) {

325 
RedisModuÀSåög
 *
my°r
, *
ex≥˘ed
;

327 i‡(
	`RedisModuÀ_CÆlRïlyTy≥
(
ª∂y
Ë!
REDISMODULE_REPLY_STRING
) {

328 
	`RedisModuÀ_Log
(
˘x
,"warning","UnexpectedÑeplyÅype %d",

329 
	`RedisModuÀ_CÆlRïlyTy≥
(
ª∂y
));

332 
my°r
 = 
	`RedisModuÀ_Cª©eSåögFromCÆlRïly
(
ª∂y
);

333 
ex≥˘ed
 = 
	`RedisModuÀ_Cª©eSåög
(
˘x
,
°r
,
Àn
);

334 i‡(
	`RedisModuÀ_SåögCom∑ª
(
my°r
,
ex≥˘ed
) != 0) {

335 c⁄° *
my°r_±r
 = 
	`RedisModuÀ_SåögPåLí
(
my°r
,
NULL
);

336 c⁄° *
ex≥˘ed_±r
 = 
	`RedisModuÀ_SåögPåLí
(
ex≥˘ed
,
NULL
);

337 
	`RedisModuÀ_Log
(
˘x
,"warning",

339 
my°r_±r
, 
ex≥˘ed_±r
);

343 
	}
}

347 
	$Te°As£πI¡egîRïly
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀCÆlRïly
 *
ª∂y
, 
ex≥˘ed
) {

348 i‡(
	`RedisModuÀ_CÆlRïlyTy≥
(
ª∂y
Ë!
REDISMODULE_REPLY_INTEGER
) {

349 
	`RedisModuÀ_Log
(
˘x
,"warning","UnexpectedÑeplyÅype %d",

350 
	`RedisModuÀ_CÆlRïlyTy≥
(
ª∂y
));

353 
vÆ
 = 
	`RedisModuÀ_CÆlRïlyI¡egî
(
ª∂y
);

354 i‡(
vÆ
 !
ex≥˘ed
) {

355 
	`RedisModuÀ_Log
(
˘x
,"warning",

357 
vÆ
, 
ex≥˘ed
);

361 
	}
}

363 
	#T
(
«me
,...) \

365 
	`RedisModuÀ_Log
(
˘x
,"w¨nög","Te°ög %s", 
«me
); \

366 
ª∂y
 = 
	`RedisModuÀ_CÆl
(
˘x
,
«me
,
__VA_ARGS__
); \

367 } 0);

	)

370 
	$Te°It
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

371 
	`REDISMODULE_NOT_USED
(
¨gv
);

372 
	`REDISMODULE_NOT_USED
(
¨gc
);

374 
	`RedisModuÀ_AutoMem‹y
(
˘x
);

375 
RedisModuÀCÆlRïly
 *
ª∂y
;

378 
	`T
("dbsize","");

379 i‡(!
	`Te°As£πI¡egîRïly
(
˘x
,
ª∂y
,0)Ë
Áû
;

381 
	`T
("ping","");

382 i‡(!
	`Te°As£πSåögRïly
(
˘x
,
ª∂y
,"PONG",4)Ë
Áû
;

384 
	`T
("test.call","");

385 i‡(!
	`Te°As£πSåögRïly
(
˘x
,
ª∂y
,"OK",2)Ë
Áû
;

387 
	`T
("test.ctxflags","");

388 i‡(!
	`Te°As£πSåögRïly
(
˘x
,
ª∂y
,"OK",2)Ë
Áû
;

390 
	`T
("test.string.append","");

391 i‡(!
	`Te°As£πSåögRïly
(
˘x
,
ª∂y
,"foob¨",6)Ë
Áû
;

393 
	`T
("test.unlink","");

394 i‡(!
	`Te°As£πSåögRïly
(
˘x
,
ª∂y
,"OK",2)Ë
Áû
;

396 
	`T
("test.string.append.am","");

397 i‡(!
	`Te°As£πSåögRïly
(
˘x
,
ª∂y
,"foob¨",6)Ë
Áû
;

399 
	`T
("test.string.printf", "cc", "foo", "bar");

400 i‡(!
	`Te°As£πSåögRïly
(
˘x
,
ª∂y
,"GŸ 3árgs.árgv[1]: foo,árgv[2]: b¨",38)Ë
Áû
;

402 
	`T
("test.notify", "");

403 i‡(!
	`Te°As£πSåögRïly
(
˘x
,
ª∂y
,"OK",2)Ë
Áû
;

405 
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
,"ALL TESTS PASSED");

406  
REDISMODULE_OK
;

408 
Áû
:

409 
	`RedisModuÀ_RïlyWôhSim∂eSåög
(
˘x
,

411  
REDISMODULE_OK
;

412 
	}
}

414 
	$RedisModuÀ_OnLﬂd
(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 **
¨gv
, 
¨gc
) {

415 
	`REDISMODULE_NOT_USED
(
¨gv
);

416 
	`REDISMODULE_NOT_USED
(
¨gc
);

418 i‡(
	`RedisModuÀ_Inô
(
˘x
,"ã°",1,
REDISMODULE_APIVER_1
)

419 =
REDISMODULE_ERR
)  REDISMODULE_ERR;

421 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"test.call",

422 
Te°CÆl
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

423  
REDISMODULE_ERR
;

425 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"test.string.append",

426 
Te°SåögAµíd
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

427  
REDISMODULE_ERR
;

429 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"test.string.append.am",

430 
Te°SåögAµídAM
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

431  
REDISMODULE_ERR
;

433 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"test.string.printf",

434 
Te°SåögPrötf
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

435  
REDISMODULE_ERR
;

437 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"test.ctxflags",

438 
Te°CtxFœgs
,"ªad⁄ly",1,1,1Ë=
REDISMODULE_ERR
)

439  
REDISMODULE_ERR
;

441 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"test.unlink",

442 
Te°U∆ök
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

443  
REDISMODULE_ERR
;

445 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"test.it",

446 
Te°It
,"ªad⁄ly",1,1,1Ë=
REDISMODULE_ERR
)

447  
REDISMODULE_ERR
;

449 
	`RedisModuÀ_Subs¸ibeToKey•a˚Evíts
(
˘x
,

450 
REDISMODULE_NOTIFY_HASH
 |

451 
REDISMODULE_NOTIFY_SET
 |

452 
REDISMODULE_NOTIFY_STRING
 |

453 
REDISMODULE_NOTIFY_KEY_MISS
,

454 
NŸifyCÆlback
);

455 i‡(
	`RedisModuÀ_Cª©eComm™d
(
˘x
,"test.notify",

456 
Te°NŸifiˇti⁄s
,"wrôêdíy-oom",1,1,1Ë=
REDISMODULE_ERR
)

457  
REDISMODULE_ERR
;

459  
REDISMODULE_OK
;

460 
	}
}

	@multi.c

30 
	~"£rvî.h
"

35 
	$öôClõ¡Mu…iSèã
(
˛õ¡
 *
c
) {

36 
c
->
m°©e
.
comm™ds
 = 
NULL
;

37 
c
->
m°©e
.
cou¡
 = 0;

38 
c
->
m°©e
.
cmd_Êags
 = 0;

39 
	}
}

42 
	$‰ìClõ¡Mu…iSèã
(
˛õ¡
 *
c
) {

43 
j
;

45 
j
 = 0; j < 
c
->
m°©e
.
cou¡
; j++) {

46 
i
;

47 
mu…iCmd
 *
mc
 = 
c
->
m°©e
.
comm™ds
+
j
;

49 
i
 = 0; i < 
mc
->
¨gc
; i++)

50 
	`de¸RefCou¡
(
mc
->
¨gv
[
i
]);

51 
	`z‰ì
(
mc
->
¨gv
);

53 
	`z‰ì
(
c
->
m°©e
.
comm™ds
);

54 
	}
}

57 
	$queueMu…iComm™d
(
˛õ¡
 *
c
) {

58 
mu…iCmd
 *
mc
;

59 
j
;

61 
c
->
m°©e
.
comm™ds
 = 
	`zªÆloc
(c->mstate.commands,

62 (
mu…iCmd
)*(
c
->
m°©e
.
cou¡
+1));

63 
mc
 = 
c
->
m°©e
.
comm™ds
+c->m°©e.
cou¡
;

64 
mc
->
cmd
 = 
c
->cmd;

65 
mc
->
¨gc
 = 
c
->argc;

66 
mc
->
¨gv
 = 
	`zmÆloc
((
robj
*)*
c
->
¨gc
);

67 
	`mem˝y
(
mc
->
¨gv
,
c
->¨gv,(
robj
*)*c->
¨gc
);

68 
j
 = 0; j < 
c
->
¨gc
; j++)

69 
	`ö¸RefCou¡
(
mc
->
¨gv
[
j
]);

70 
c
->
m°©e
.
cou¡
++;

71 
c
->
m°©e
.
cmd_Êags
 |c->
cmd
->
Êags
;

72 
	}
}

74 
	$disˇrdTønß˘i⁄
(
˛õ¡
 *
c
) {

75 
	`‰ìClõ¡Mu…iSèã
(
c
);

76 
	`öôClõ¡Mu…iSèã
(
c
);

77 
c
->
Êags
 &~(
CLIENT_MULTI
|
CLIENT_DIRTY_CAS
|
CLIENT_DIRTY_EXEC
);

78 
	`unw©chAŒKeys
(
c
);

79 
	}
}

83 
	$ÊagTønß˘i⁄
(
˛õ¡
 *
c
) {

84 i‡(
c
->
Êags
 & 
CLIENT_MULTI
)

85 
c
->
Êags
 |
CLIENT_DIRTY_EXEC
;

86 
	}
}

88 
	$mu…iComm™d
(
˛õ¡
 *
c
) {

89 i‡(
c
->
Êags
 & 
CLIENT_MULTI
) {

90 
	`addRïlyEº‹
(
c
,"MULTI calls canÇot beÇested");

93 
c
->
Êags
 |
CLIENT_MULTI
;

94 
	`addRïly
(
c
,
sh¨ed
.
ok
);

95 
	}
}

97 
	$disˇrdComm™d
(
˛õ¡
 *
c
) {

98 i‡(!(
c
->
Êags
 & 
CLIENT_MULTI
)) {

99 
	`addRïlyEº‹
(
c
,"DISCARD without MULTI");

102 
	`disˇrdTønß˘i⁄
(
c
);

103 
	`addRïly
(
c
,
sh¨ed
.
ok
);

104 
	}
}

108 
	$execComm™dPr›ag©eMu…i
(
˛õ¡
 *
c
) {

109 
	`¥›ag©e
(
£rvî
.
mu…iComm™d
,
c
->
db
->
id
,&
sh¨ed
.
mu…i
,1,

110 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

111 
	}
}

113 
	$execComm™dPr›ag©eExec
(
˛õ¡
 *
c
) {

114 
	`¥›ag©e
(
£rvî
.
execComm™d
,
c
->
db
->
id
,&
sh¨ed
.
exec
,1,

115 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

116 
	}
}

118 
	$execComm™d
(
˛õ¡
 *
c
) {

119 
j
;

120 
robj
 **
‹ig_¨gv
;

121 
‹ig_¨gc
;

122 
ªdisComm™d
 *
‹ig_cmd
;

123 
mu°_¥›ag©e
 = 0;

124 
was_ma°î
 = 
£rvî
.
ma°îho°
 =
NULL
;

126 i‡(!(
c
->
Êags
 & 
CLIENT_MULTI
)) {

127 
	`addRïlyEº‹
(
c
,"EXEC without MULTI");

137 i‡(
c
->
Êags
 & (
CLIENT_DIRTY_CAS
|
CLIENT_DIRTY_EXEC
)) {

138 
	`addRïly
(
c
, c->
Êags
 & 
CLIENT_DIRTY_EXEC
 ? 
sh¨ed
.
exeˇb‹ãº
 :

139 
sh¨ed
.
nuŒ¨øy
[
c
->
ª•
]);

140 
	`disˇrdTønß˘i⁄
(
c
);

141 
h™dÀ_m⁄ô‹
;

149 i‡(!
£rvî
.
lﬂdög
 && sîvî.
ma°îho°
 && sîvî.
ª∂_¶ave_ro
 &&

150 !(
c
->
Êags
 & 
CLIENT_MASTER
Ë&& c->
m°©e
.
cmd_Êags
 & 
CMD_WRITE
)

152 
	`addRïlyEº‹
(
c
,

155 
	`disˇrdTønß˘i⁄
(
c
);

156 
h™dÀ_m⁄ô‹
;

160 
	`unw©chAŒKeys
(
c
);

161 
‹ig_¨gv
 = 
c
->
¨gv
;

162 
‹ig_¨gc
 = 
c
->
¨gc
;

163 
‹ig_cmd
 = 
c
->
cmd
;

164 
	`addRïlyAºayLí
(
c
,c->
m°©e
.
cou¡
);

165 
j
 = 0; j < 
c
->
m°©e
.
cou¡
; j++) {

166 
c
->
¨gc
 = c->
m°©e
.
comm™ds
[
j
].argc;

167 
c
->
¨gv
 = c->
m°©e
.
comm™ds
[
j
].argv;

168 
c
->
cmd
 = c->
m°©e
.
comm™ds
[
j
].cmd;

175 i‡(!
mu°_¥›ag©e
 &&

176 !
£rvî
.
lﬂdög
 &&

177 !(
c
->
cmd
->
Êags
 & (
CMD_READONLY
|
CMD_ADMIN
)))

179 
	`execComm™dPr›ag©eMu…i
(
c
);

180 
mu°_¥›ag©e
 = 1;

183 
a˛_keypos
;

184 
a˛_ªtvÆ
 = 
	`ACLCheckComm™dPîm
(
c
,&
a˛_keypos
);

185 i‡(
a˛_ªtvÆ
 !
ACL_OK
) {

186 
	`addACLLogE¡ry
(
c
,
a˛_ªtvÆ
,
a˛_keypos
,
NULL
);

187 
	`addRïlyEº‹F‹m©
(
c
,

192 (
a˛_ªtvÆ
 =
ACL_DENIED_CMD
) ?

196 
	`ˇŒ
(
c
,
£rvî
.
lﬂdög
 ? 
CMD_CALL_NONE
 : 
CMD_CALL_FULL
);

200 
c
->
m°©e
.
comm™ds
[
j
].
¨gc
 = c->argc;

201 
c
->
m°©e
.
comm™ds
[
j
].
¨gv
 = c->argv;

202 
c
->
m°©e
.
comm™ds
[
j
].
cmd
 = c->cmd;

204 
c
->
¨gv
 = 
‹ig_¨gv
;

205 
c
->
¨gc
 = 
‹ig_¨gc
;

206 
c
->
cmd
 = 
‹ig_cmd
;

207 
	`disˇrdTønß˘i⁄
(
c
);

211 i‡(
mu°_¥›ag©e
) {

212 
is_ma°î
 = 
£rvî
.
ma°îho°
 =
NULL
;

213 
£rvî
.
dúty
++;

219 i‡(
£rvî
.
ª∂_backlog
 && 
was_ma°î
 && !
is_ma°î
) {

220 *
execcmd
 = "*1\r\n$4\r\nEXEC\r\n";

221 
	`„edRïliˇti⁄Backlog
(
execcmd
,
	`°æí
(execcmd));

225 
h™dÀ_m⁄ô‹
:

231 i‡(
	`li°Lígth
(
£rvî
.
m⁄ô‹s
Ë&& !£rvî.
lﬂdög
)

232 
	`ª∂iˇti⁄FìdM⁄ô‹s
(
c
,
£rvî
.
m⁄ô‹s
,c->
db
->
id
,c->
¨gv
,c->
¨gc
);

233 
	}
}

247 
	sw©chedKey
 {

248 
robj
 *
	mkey
;

249 
ªdisDb
 *
	mdb
;

250 } 
	tw©chedKey
;

253 
	$w©chF‹Key
(
˛õ¡
 *
c
, 
robj
 *
key
) {

254 
li°
 *
˛õ¡s
 = 
NULL
;

255 
li°Iãr
 
li
;

256 
li°Node
 *
 
;

257 
w©chedKey
 *
wk
;

260 
	`li°Rewöd
(
c
->
w©ched_keys
,&
li
);

261 (
 
 = 
	`li°Next
(&
li
))) {

262 
wk
 = 
	`li°NodeVÆue
(
 
);

263 i‡(
wk
->
db
 =
c
->db && 
	`equÆSåögObje˘s
(
key
,wk->key))

267 
˛õ¡s
 = 
	`di˘FëchVÆue
(
c
->
db
->
w©ched_keys
,
key
);

268 i‡(!
˛õ¡s
) {

269 
˛õ¡s
 = 
	`li°Cª©e
();

270 
	`di˘Add
(
c
->
db
->
w©ched_keys
,
key
,
˛õ¡s
);

271 
	`ö¸RefCou¡
(
key
);

273 
	`li°AddNodeTaû
(
˛õ¡s
,
c
);

275 
wk
 = 
	`zmÆloc
((*wk));

276 
wk
->
key
 = key;

277 
wk
->
db
 = 
c
->db;

278 
	`ö¸RefCou¡
(
key
);

279 
	`li°AddNodeTaû
(
c
->
w©ched_keys
,
wk
);

280 
	}
}

284 
	$unw©chAŒKeys
(
˛õ¡
 *
c
) {

285 
li°Iãr
 
li
;

286 
li°Node
 *
 
;

288 i‡(
	`li°Lígth
(
c
->
w©ched_keys
) == 0) ;

289 
	`li°Rewöd
(
c
->
w©ched_keys
,&
li
);

290 (
 
 = 
	`li°Next
(&
li
))) {

291 
li°
 *
˛õ¡s
;

292 
w©chedKey
 *
wk
;

296 
wk
 = 
	`li°NodeVÆue
(
 
);

297 
˛õ¡s
 = 
	`di˘FëchVÆue
(
wk
->
db
->
w©ched_keys
, wk->
key
);

298 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
˛õ¡s
 != NULL);

299 
	`li°DñNode
(
˛õ¡s
,
	`li°SórchKey
(˛õ¡s,
c
));

301 i‡(
	`li°Lígth
(
˛õ¡s
) == 0)

302 
	`di˘Dñëe
(
wk
->
db
->
w©ched_keys
, wk->
key
);

304 
	`li°DñNode
(
c
->
w©ched_keys
,
 
);

305 
	`de¸RefCou¡
(
wk
->
key
);

306 
	`z‰ì
(
wk
);

308 
	}
}

312 
	$touchW©chedKey
(
ªdisDb
 *
db
, 
robj
 *
key
) {

313 
li°
 *
˛õ¡s
;

314 
li°Iãr
 
li
;

315 
li°Node
 *
 
;

317 i‡(
	`di˘Size
(
db
->
w©ched_keys
) == 0) ;

318 
˛õ¡s
 = 
	`di˘FëchVÆue
(
db
->
w©ched_keys
, 
key
);

319 i‡(!
˛õ¡s
) ;

323 
	`li°Rewöd
(
˛õ¡s
,&
li
);

324 (
 
 = 
	`li°Next
(&
li
))) {

325 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

327 
c
->
Êags
 |
CLIENT_DIRTY_CAS
;

329 
	}
}

335 
	$touchW©chedKeysOnFlush
(
dbid
) {

336 
li°Iãr
 
li1
, 
li2
;

337 
li°Node
 *
 
;

340 
	`li°Rewöd
(
£rvî
.
˛õ¡s
,&
li1
);

341 (
 
 = 
	`li°Next
(&
li1
))) {

342 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

343 
	`li°Rewöd
(
c
->
w©ched_keys
,&
li2
);

344 (
 
 = 
	`li°Next
(&
li2
))) {

345 
w©chedKey
 *
wk
 = 
	`li°NodeVÆue
(
 
);

350 i‡(
dbid
 =-1 || 
wk
->
db
->
id
 == dbid) {

351 i‡(
	`di˘Föd
(
wk
->
db
->
di˘
, wk->
key
->
±r
Ë!
NULL
)

352 
c
->
Êags
 |
CLIENT_DIRTY_CAS
;

356 
	}
}

358 
	$w©chComm™d
(
˛õ¡
 *
c
) {

359 
j
;

361 i‡(
c
->
Êags
 & 
CLIENT_MULTI
) {

362 
	`addRïlyEº‹
(
c
,"WATCH inside MULTI isÇotállowed");

365 
j
 = 1; j < 
c
->
¨gc
; j++)

366 
	`w©chF‹Key
(
c
,c->
¨gv
[
j
]);

367 
	`addRïly
(
c
,
sh¨ed
.
ok
);

368 
	}
}

370 
	$unw©chComm™d
(
˛õ¡
 *
c
) {

371 
	`unw©chAŒKeys
(
c
);

372 
c
->
Êags
 &(~
CLIENT_DIRTY_CAS
);

373 
	`addRïly
(
c
,
sh¨ed
.
ok
);

374 
	}
}

	@networking.c

30 
	~"£rvî.h
"

31 
	~"©omicv¨.h
"

32 
	~<sys/sockë.h
>

33 
	~<sys/uio.h
>

34 
	~<m©h.h
>

35 
	~<˘y≥.h
>

37 
£tPrŸocﬁEº‹
(c⁄° *
îr°r
, 
˛õ¡
 *
c
);

38 
po°p⁄eClõ¡Ród
(
˛õ¡
 *
c
);

39 
	gPro˚ssögEvítsWhûeBlocked
 = 0;

44 
size_t
 
	$sdsZmÆlocSize
(
sds
 
s
) {

45 *
sh
 = 
	`sdsAŒocPå
(
s
);

46  
	`zmÆloc_size
(
sh
);

47 
	}
}

51 
size_t
 
	$gëSåögObje˘SdsU£dMem‹y
(
robj
 *
o
) {

52 
	`£rvîAs£πWôhInfo
(
NULL
,
o
,o->
ty≥
 =
OBJ_STRING
);

53 
o
->
ícodög
) {

54 
OBJ_ENCODING_RAW
:  
	`sdsZmÆlocSize
(
o
->
±r
);

55 
OBJ_ENCODING_EMBSTR
:  
	`zmÆloc_size
(
o
)-(
robj
);

58 
	}
}

61 *
	$dupClõ¡RïlyVÆue
(*
o
) {

62 
˛õ¡RïlyBlock
 *
ﬁd
 = 
o
;

63 
˛õ¡RïlyBlock
 *
buf
 = 
	`zmÆloc
((˛õ¡RïlyBlockË+ 
ﬁd
->
size
);

64 
	`mem˝y
(
buf
, 
o
, (
˛õ¡RïlyBlock
Ë+ 
ﬁd
->
size
);

65  
buf
;

66 
	}
}

68 
	$‰ìClõ¡RïlyVÆue
(*
o
) {

69 
	`z‰ì
(
o
);

70 
	}
}

72 
	$li°M©chObje˘s
(*
a
, *
b
) {

73  
	`equÆSåögObje˘s
(
a
,
b
);

74 
	}
}

78 
	$lökClõ¡
(
˛õ¡
 *
c
) {

79 
	`li°AddNodeTaû
(
£rvî
.
˛õ¡s
,
c
);

83 
c
->
˛õ¡_li°_node
 = 
	`li°La°
(
£rvî
.
˛õ¡s
);

84 
uöt64_t
 
id
 = 
	`ht⁄u64
(
c
->id);

85 
	`øxIn£π
(
£rvî
.
˛õ¡s_ödex
,(*)&
id
,(id),
c
,
NULL
);

86 
	}
}

88 
˛õ¡
 *
	$¸óãClõ¡
(
c⁄√˘i⁄
 *
c⁄n
) {

89 
˛õ¡
 *
c
 = 
	`zmÆloc
((client));

95 i‡(
c⁄n
) {

96 
	`c⁄nN⁄Block
(
c⁄n
);

97 
	`c⁄nE«bÀT˝NoDñay
(
c⁄n
);

98 i‡(
£rvî
.
t˝kì∑live
)

99 
	`c⁄nKìpAlive
(
c⁄n
,
£rvî
.
t˝kì∑live
);

100 
	`c⁄nSëRódH™dÀr
(
c⁄n
, 
ªadQuîyFromClõ¡
);

101 
	`c⁄nSëPriv©eD©a
(
c⁄n
, 
c
);

104 
	`£À˘Db
(
c
,0);

105 
uöt64_t
 
˛õ¡_id
 = ++
£rvî
.
√xt_˛õ¡_id
;

106 
c
->
id
 = 
˛õ¡_id
;

107 
c
->
ª•
 = 2;

108 
c
->
c⁄n
 = conn;

109 
c
->
«me
 = 
NULL
;

110 
c
->
buÂos
 = 0;

111 
c
->
qb_pos
 = 0;

112 
c
->
quîybuf
 = 
	`sd£m±y
();

113 
c
->
≥ndög_quîybuf
 = 
	`sd£m±y
();

114 
c
->
quîybuf_≥ak
 = 0;

115 
c
->
ªqty≥
 = 0;

116 
c
->
¨gc
 = 0;

117 
c
->
¨gv
 = 
NULL
;

118 
c
->
cmd
 = c->
œ°cmd
 = 
NULL
;

119 
c
->
u£r
 = 
DeÁu…U£r
;

120 
c
->
mu…ibulkÀn
 = 0;

121 
c
->
bulkÀn
 = -1;

122 
c
->
£¡Àn
 = 0;

123 
c
->
Êags
 = 0;

124 
c
->
˘ime
 = c->
œ°öãø˘i⁄
 = 
£rvî
.
unixtime
;

127 
c
->
authítiˇãd
 = (c->
u£r
->
Êags
 & 
USER_FLAG_NOPASS
) &&

128 !(
c
->
u£r
->
Êags
 & 
USER_FLAG_DISABLED
);

129 
c
->
ª∂°©e
 = 
REPL_STATE_NONE
;

130 
c
->
ª∂_put_⁄löe_⁄_ack
 = 0;

131 
c
->
ª∂off
 = 0;

132 
c
->
ªad_ª∂off
 = 0;

133 
c
->
ª∂_ack_off
 = 0;

134 
c
->
ª∂_ack_time
 = 0;

135 
c
->
¶ave_li°íög_p‹t
 = 0;

136 
c
->
¶ave_ù
[0] = '\0';

137 
c
->
¶ave_ˇ∑
 = 
SLAVE_CAPA_NONE
;

138 
c
->
ª∂y
 = 
	`li°Cª©e
();

139 
c
->
ª∂y_byãs
 = 0;

140 
c
->
obuf_so·_limô_ªached_time
 = 0;

141 
	`li°SëFªeMëhod
(
c
->
ª∂y
,
‰ìClõ¡RïlyVÆue
);

142 
	`li°SëDupMëhod
(
c
->
ª∂y
,
dupClõ¡RïlyVÆue
);

143 
c
->
bty≥
 = 
BLOCKED_NONE
;

144 
c
->
bp›
.
timeout
 = 0;

145 
c
->
bp›
.
keys
 = 
	`di˘Cª©e
(&
obje˘KeyHópPoöãrVÆueDi˘Ty≥
,
NULL
);

146 
c
->
bp›
.
èrgë
 = 
NULL
;

147 
c
->
bp›
.
xªad_group
 = 
NULL
;

148 
c
->
bp›
.
xªad_c⁄sumî
 = 
NULL
;

149 
c
->
bp›
.
xªad_group_nﬂck
 = 0;

150 
c
->
bp›
.
numª∂iˇs
 = 0;

151 
c
->
bp›
.
ª∂off£t
 = 0;

152 
c
->
woff
 = 0;

153 
c
->
w©ched_keys
 = 
	`li°Cª©e
();

154 
c
->
pubsub_ch™√ls
 = 
	`di˘Cª©e
(&
obje˘KeyPoöãrVÆueDi˘Ty≥
,
NULL
);

155 
c
->
pubsub_∑âîns
 = 
	`li°Cª©e
();

156 
c
->
≥îid
 = 
NULL
;

157 
c
->
˛õ¡_li°_node
 = 
NULL
;

158 
c
->
˛õ¡_åackög_ªdúe˘i⁄
 = 0;

159 
c
->
˛õ¡_åackög_¥efixes
 = 
NULL
;

160 
c
->
˛õ¡_¸⁄_œ°_mem‹y_ußge
 = 0;

161 
c
->
˛õ¡_¸⁄_œ°_mem‹y_ty≥
 = 
CLIENT_TYPE_NORMAL
;

162 
c
->
auth_ˇŒback
 = 
NULL
;

163 
c
->
auth_ˇŒback_¥ivd©a
 = 
NULL
;

164 
c
->
auth_moduÀ
 = 
NULL
;

165 
	`li°SëFªeMëhod
(
c
->
pubsub_∑âîns
,
de¸RefCou¡Void
);

166 
	`li°SëM©chMëhod
(
c
->
pubsub_∑âîns
,
li°M©chObje˘s
);

167 i‡(
c⁄n
Ë
	`lökClõ¡
(
c
);

168 
	`öôClõ¡Mu…iSèã
(
c
);

169  
c
;

170 
	}
}

179 
	$˛õ¡In°ÆlWrôeH™dÀr
(
˛õ¡
 *
c
) {

183 i‡(!(
c
->
Êags
 & 
CLIENT_PENDING_WRITE
) &&

184 (
c
->
ª∂°©e
 =
REPL_STATE_NONE
 ||

185 (
c
->
ª∂°©e
 =
SLAVE_STATE_ONLINE
 && !c->
ª∂_put_⁄löe_⁄_ack
)))

193 
c
->
Êags
 |
CLIENT_PENDING_WRITE
;

194 
	`li°AddNodeHód
(
£rvî
.
˛õ¡s_≥ndög_wrôe
,
c
);

196 
	}
}

220 
	$¥ï¨eClõ¡ToWrôe
(
˛õ¡
 *
c
) {

223 i‡(
c
->
Êags
 & (
CLIENT_LUA
|
CLIENT_MODULE
)Ë 
C_OK
;

226 i‡(
c
->
Êags
 & (
CLIENT_REPLY_OFF
|
CLIENT_REPLY_SKIP
)Ë 
C_ERR
;

230 i‡((
c
->
Êags
 & 
CLIENT_MASTER
) &&

231 !(
c
->
Êags
 & 
CLIENT_MASTER_FORCE_REPLY
)Ë 
C_ERR
;

233 i‡(!
c
->
c⁄n
Ë 
C_ERR
;

237 i‡(!
	`˛õ¡HasPídögRïlõs
(
c
)Ë
	`˛õ¡In°ÆlWrôeH™dÀr
(c);

240  
C_OK
;

241 
	}
}

247 
	$_addRïlyToBuf„r
(
˛õ¡
 *
c
, c⁄° *
s
, 
size_t
 
Àn
) {

248 
size_t
 
avaûabÀ
 = (
c
->
buf
)-c->
buÂos
;

250 i‡(
c
->
Êags
 & 
CLIENT_CLOSE_AFTER_REPLY
Ë 
C_OK
;

254 i‡(
	`li°Lígth
(
c
->
ª∂y
Ë> 0Ë 
C_ERR
;

257 i‡(
Àn
 > 
avaûabÀ
Ë 
C_ERR
;

259 
	`mem˝y
(
c
->
buf
+c->
buÂos
,
s
,
Àn
);

260 
c
->
buÂos
+=
Àn
;

261  
C_OK
;

262 
	}
}

264 
	$_addRïlyPrŸoToLi°
(
˛õ¡
 *
c
, c⁄° *
s
, 
size_t
 
Àn
) {

265 i‡(
c
->
Êags
 & 
CLIENT_CLOSE_AFTER_REPLY
) ;

267 
li°Node
 *
 
 = 
	`li°La°
(
c
->
ª∂y
);

268 
˛õ¡RïlyBlock
 *
èû
 = 
 
? 
	`li°NodeVÆue
÷n): 
NULL
;

275 i‡(
èû
) {

278 
size_t
 
avaû
 = 
èû
->
size
 -Åaû->
u£d
;

279 
size_t
 
c›y
 = 
avaû
 >
Àn
?Üen:ávail;

280 
	`mem˝y
(
èû
->
buf
 +Åaû->
u£d
, 
s
, 
c›y
);

281 
èû
->
u£d
 +
c›y
;

282 
s
 +
c›y
;

283 
Àn
 -
c›y
;

285 i‡(
Àn
) {

288 
size_t
 
size
 = 
Àn
 < 
PROTO_REPLY_CHUNK_BYTES
? PROTO_REPLY_CHUNK_BYTES:Üen;

289 
èû
 = 
	`zmÆloc
(
size
 + (
˛õ¡RïlyBlock
));

291 
èû
->
size
 = 
	`zmÆloc_ußbÀ
—aûË- (
˛õ¡RïlyBlock
);

292 
èû
->
u£d
 = 
Àn
;

293 
	`mem˝y
(
èû
->
buf
, 
s
, 
Àn
);

294 
	`li°AddNodeTaû
(
c
->
ª∂y
, 
èû
);

295 
c
->
ª∂y_byãs
 +
èû
->
size
;

297 
	`asyncClo£Clõ¡OnOuçutBuf„rLimôRóched
(
c
);

298 
	}
}

306 
	$addRïly
(
˛õ¡
 *
c
, 
robj
 *
obj
) {

307 i‡(
	`¥ï¨eClõ¡ToWrôe
(
c
Ë!
C_OK
) ;

309 i‡(
	`sdsEncodedObje˘
(
obj
)) {

310 i‡(
	`_addRïlyToBuf„r
(
c
,
obj
->
±r
,
	`sd¶í
(obj->±r)Ë!
C_OK
)

311 
	`_addRïlyPrŸoToLi°
(
c
,
obj
->
±r
,
	`sd¶í
(obj->ptr));

312 } i‡(
obj
->
ícodög
 =
OBJ_ENCODING_INT
) {

316 
buf
[32];

317 
size_t
 
Àn
 = 
	`Œ2°rög
(
buf
,(buf),()
obj
->
±r
);

318 i‡(
	`_addRïlyToBuf„r
(
c
,
buf
,
Àn
Ë!
C_OK
)

319 
	`_addRïlyPrŸoToLi°
(
c
,
buf
,
Àn
);

321 
	`£rvîP™ic
("Wrong obj->encoding ináddReply()");

323 
	}
}

327 
	$addRïlySds
(
˛õ¡
 *
c
, 
sds
 
s
) {

328 i‡(
	`¥ï¨eClõ¡ToWrôe
(
c
Ë!
C_OK
) {

330 
	`sds‰ì
(
s
);

333 i‡(
	`_addRïlyToBuf„r
(
c
,
s
,
	`sd¶í
(s)Ë!
C_OK
)

334 
	`_addRïlyPrŸoToLi°
(
c
,
s
,
	`sd¶í
(s));

335 
	`sds‰ì
(
s
);

336 
	}
}

346 
	$addRïlyPrŸo
(
˛õ¡
 *
c
, c⁄° *
s
, 
size_t
 
Àn
) {

347 i‡(
	`¥ï¨eClõ¡ToWrôe
(
c
Ë!
C_OK
) ;

348 i‡(
	`_addRïlyToBuf„r
(
c
,
s
,
Àn
Ë!
C_OK
)

349 
	`_addRïlyPrŸoToLi°
(
c
,
s
,
Àn
);

350 
	}
}

360 
	$addRïlyEº‹Lígth
(
˛õ¡
 *
c
, c⁄° *
s
, 
size_t
 
Àn
) {

363 i‡(!
Àn
 || 
s
[0] !'-'Ë
	`addRïlyPrŸo
(
c
,"-ERR ",5);

364 
	`addRïlyPrŸo
(
c
,
s
,
Àn
);

365 
	`addRïlyPrŸo
(
c
,"\r\n",2);

377 
˘y≥
 = 
	`gëClõ¡Ty≥
(
c
);

378 i‡(
˘y≥
 =
CLIENT_TYPE_MASTER
 || cty≥ =
CLIENT_TYPE_SLAVE
 || 
c
->
id
 =
CLIENT_ID_AOF
) {

379 *
to
, *
‰om
;

381 i‡(
c
->
id
 =
CLIENT_ID_AOF
) {

382 
to
 = "AOF-loading-client";

383 
‰om
 = "server";

384 } i‡(
˘y≥
 =
CLIENT_TYPE_MASTER
) {

385 
to
 = "master";

386 
‰om
 = "replica";

388 
to
 = "replica";

389 
‰om
 = "master";

392 *
cmd«me
 = 
c
->
œ°cmd
 ? c->œ°cmd->
«me
 : "<unknown>";

393 
	`£rvîLog
(
LL_WARNING
,"== CRITICAL == This %s is sendingánÉrror "

395 "'%s'", 
‰om
, 
to
, 
s
, 
cmd«me
);

396 i‡(
˘y≥
 =
CLIENT_TYPE_MASTER
 && 
£rvî
.
ª∂_backlog
 &&

397 
£rvî
.
ª∂_backlog_hi°Àn
 > 0)

399 
dum∂í
 = 256;

400 i‡(
£rvî
.
ª∂_backlog_hi°Àn
 < 
dum∂í
)

401 
dum∂í
 = 
£rvî
.
ª∂_backlog_hi°Àn
;

404 
idx
 =

405 (
£rvî
.
ª∂_backlog_idx
 + (£rvî.
ª∂_backlog_size
 - 
dum∂í
)) %

406 
£rvî
.
ª∂_backlog_size
;

409 
sds
 
dump
 = 
	`sd£m±y
();

410 
dum∂í
) {

411 
thi¶í
 =

412 ((
£rvî
.
ª∂_backlog_size
 - 
idx
Ë< 
dum∂í
) ?

413 (
£rvî
.
ª∂_backlog_size
 - 
idx
Ë: 
dum∂í
;

415 
dump
 = 
	`sdsˇåïr
(dump,
£rvî
.
ª∂_backlog
+
idx
,
thi¶í
);

416 
dum∂í
 -
thi¶í
;

417 
idx
 = 0;

422 
	`£rvîLog
(
LL_WARNING
,"L©e° backlog is: '%s'", 
dump
);

423 
	`sds‰ì
(
dump
);

425 
£rvî
.
°©_u√x≥˘ed_îr‹_ª∂õs
++;

427 
	}
}

429 
	$addRïlyEº‹
(
˛õ¡
 *
c
, c⁄° *
îr
) {

430 
	`addRïlyEº‹Lígth
(
c
,
îr
,
	`°æí
(err));

431 
	}
}

433 
	$addRïlyEº‹F‹m©
(
˛õ¡
 *
c
, c⁄° *
fmt
, ...) {

434 
size_t
 
l
, 
j
;

435 
va_li°
 
≠
;

436 
	`va_°¨t
(
≠
,
fmt
);

437 
sds
 
s
 = 
	`sdsˇtv¥ötf
(
	`sd£m±y
(),
fmt
,
≠
);

438 
	`va_íd
(
≠
);

441 
l
 = 
	`sd¶í
(
s
);

442 
j
 = 0; j < 
l
; j++) {

443 i‡(
s
[
j
] == '\r' || s[j] == '\n') s[j] = ' ';

445 
	`addRïlyEº‹Lígth
(
c
,
s
,
	`sd¶í
(s));

446 
	`sds‰ì
(
s
);

447 
	}
}

449 
	$addRïlySètusLígth
(
˛õ¡
 *
c
, c⁄° *
s
, 
size_t
 
Àn
) {

450 
	`addRïlyPrŸo
(
c
,"+",1);

451 
	`addRïlyPrŸo
(
c
,
s
,
Àn
);

452 
	`addRïlyPrŸo
(
c
,"\r\n",2);

453 
	}
}

455 
	$addRïlySètus
(
˛õ¡
 *
c
, c⁄° *
°©us
) {

456 
	`addRïlySètusLígth
(
c
,
°©us
,
	`°æí
(status));

457 
	}
}

459 
	$addRïlySètusF‹m©
(
˛õ¡
 *
c
, c⁄° *
fmt
, ...) {

460 
va_li°
 
≠
;

461 
	`va_°¨t
(
≠
,
fmt
);

462 
sds
 
s
 = 
	`sdsˇtv¥ötf
(
	`sd£m±y
(),
fmt
,
≠
);

463 
	`va_íd
(
≠
);

464 
	`addRïlySètusLígth
(
c
,
s
,
	`sd¶í
(s));

465 
	`sds‰ì
(
s
);

466 
	}
}

471 
	$åimRïlyUnu£dTaûS∑˚
(
˛õ¡
 *
c
) {

472 
li°Node
 *
 
 = 
	`li°La°
(
c
->
ª∂y
);

473 
˛õ¡RïlyBlock
 *
èû
 = 
 
? 
	`li°NodeVÆue
÷n): 
NULL
;

477 i‡(!
èû
) ;

483 i‡(
èû
->
size
 -Åaû->
u£d
 >Åail->size / 4 &&

484 
èû
->
u£d
 < 
PROTO_REPLY_CHUNK_BYTES
)

486 
size_t
 
ﬁd_size
 = 
èû
->
size
;

487 
èû
 = 
	`zªÆloc
—aû,Åaû->
u£d
 + (
˛õ¡RïlyBlock
));

490 
èû
->
size
 = 
	`zmÆloc_ußbÀ
—aûË- (
˛õ¡RïlyBlock
);

491 
c
->
ª∂y_byãs
 +
èû
->
size
 - 
ﬁd_size
;

492 
	`li°NodeVÆue
(
 
Ë
èû
;

494 
	}
}

498 *
	$addRïlyDe„ºedLí
(
˛õ¡
 *
c
) {

502 i‡(
	`¥ï¨eClõ¡ToWrôe
(
c
Ë!
C_OK
Ë 
NULL
;

503 
	`åimRïlyUnu£dTaûS∑˚
(
c
);

504 
	`li°AddNodeTaû
(
c
->
ª∂y
,
NULL
);

505  
	`li°La°
(
c
->
ª∂y
);

506 
	}
}

509 
	$£tDe„ºedAggªg©eLí
(
˛õ¡
 *
c
, *
node
, 
Àngth
, 
¥efix
) {

510 
li°Node
 *
 
 = (li°Node*)
node
;

511 
˛õ¡RïlyBlock
 *
√xt
;

512 
Àn°r
[128];

513 
size_t
 
Àn°r_Àn
 = 
	`•rötf
(
Àn°r
, "%c%ld\r\n", 
¥efix
, 
Àngth
);

517 i‡(
node
 =
NULL
) ;

518 
	`£rvîAs£π
(!
	`li°NodeVÆue
(
 
));

530 i‡(
 
->
√xt
 !
NULL
 && (√xà
	`li°NodeVÆue
(ln->next)) &&

531 
√xt
->
size
 -Çext->
u£d
 >
Àn°r_Àn
 &&

532 
√xt
->
u£d
 < 
PROTO_REPLY_CHUNK_BYTES
 * 4) {

533 
	`memmove
(
√xt
->
buf
 + 
Àn°r_Àn
,Çext->buf,Çext->
u£d
);

534 
	`mem˝y
(
√xt
->
buf
, 
Àn°r
, 
Àn°r_Àn
);

535 
√xt
->
u£d
 +
Àn°r_Àn
;

536 
	`li°DñNode
(
c
->
ª∂y
,
 
);

539 
˛õ¡RïlyBlock
 *
buf
 = 
	`zmÆloc
(
Àn°r_Àn
 + (clientReplyBlock));

541 
buf
->
size
 = 
	`zmÆloc_ußbÀ
(bufË- (
˛õ¡RïlyBlock
);

542 
buf
->
u£d
 = 
Àn°r_Àn
;

543 
	`mem˝y
(
buf
->buf, 
Àn°r
, 
Àn°r_Àn
);

544 
	`li°NodeVÆue
(
 
Ë
buf
;

545 
c
->
ª∂y_byãs
 +
buf
->
size
;

547 
	`asyncClo£Clõ¡OnOuçutBuf„rLimôRóched
(
c
);

548 
	}
}

550 
	$£tDe„ºedAºayLí
(
˛õ¡
 *
c
, *
node
, 
Àngth
) {

551 
	`£tDe„ºedAggªg©eLí
(
c
,
node
,
Àngth
,'*');

552 
	}
}

554 
	$£tDe„ºedM≠Lí
(
˛õ¡
 *
c
, *
node
, 
Àngth
) {

555 
¥efix
 = 
c
->
ª•
 == 2 ? '*' : '%';

556 i‡(
c
->
ª•
 =2Ë
Àngth
 *= 2;

557 
	`£tDe„ºedAggªg©eLí
(
c
,
node
,
Àngth
,
¥efix
);

558 
	}
}

560 
	$£tDe„ºedSëLí
(
˛õ¡
 *
c
, *
node
, 
Àngth
) {

561 
¥efix
 = 
c
->
ª•
 == 2 ? '*' : '~';

562 
	`£tDe„ºedAggªg©eLí
(
c
,
node
,
Àngth
,
¥efix
);

563 
	}
}

565 
	$£tDe„ºedAâribuãLí
(
˛õ¡
 *
c
, *
node
, 
Àngth
) {

566 
¥efix
 = 
c
->
ª•
 == 2 ? '*' : '|';

567 i‡(
c
->
ª•
 =2Ë
Àngth
 *= 2;

568 
	`£tDe„ºedAggªg©eLí
(
c
,
node
,
Àngth
,
¥efix
);

569 
	}
}

571 
	$£tDe„ºedPushLí
(
˛õ¡
 *
c
, *
node
, 
Àngth
) {

572 
¥efix
 = 
c
->
ª•
 == 2 ? '*' : '>';

573 
	`£tDe„ºedAggªg©eLí
(
c
,
node
,
Àngth
,
¥efix
);

574 
	}
}

577 
	$addRïlyDoubÀ
(
˛õ¡
 *
c
, 
d
) {

578 i‡(
	`isöf
(
d
)) {

581 i‡(
c
->
ª•
 == 2) {

582 
	`addRïlyBulkCSåög
(
c
, 
d
 > 0 ? "inf" : "-inf");

584 
	`addRïlyPrŸo
(
c
, 
d
 > 0 ? ",inf\r\n" : ",-inf\r\n",

585 
d
 > 0 ? 6 : 7);

588 
dbuf
[
MAX_LONG_DOUBLE_CHARS
+3],

589 
sbuf
[
MAX_LONG_DOUBLE_CHARS
+32];

590 
dÀn
, 
¶í
;

591 i‡(
c
->
ª•
 == 2) {

592 
dÀn
 = 
	`¢¥ötf
(
dbuf
,(dbuf),"%.17g",
d
);

593 
¶í
 = 
	`¢¥ötf
(
sbuf
,(sbuf),"$%d\r\n%s\r\n",
dÀn
,
dbuf
);

594 
	`addRïlyPrŸo
(
c
,
sbuf
,
¶í
);

596 
dÀn
 = 
	`¢¥ötf
(
dbuf
,(dbuf),",%.17g\r\n",
d
);

597 
	`addRïlyPrŸo
(
c
,
dbuf
,
dÀn
);

600 
	}
}

605 
	$addRïlyHum™L⁄gDoubÀ
(
˛õ¡
 *
c
, 
d
) {

606 i‡(
c
->
ª•
 == 2) {

607 
robj
 *
o
 = 
	`¸óãSåögObje˘FromL⁄gDoubÀ
(
d
,1);

608 
	`addRïlyBulk
(
c
,
o
);

609 
	`de¸RefCou¡
(
o
);

611 
buf
[
MAX_LONG_DOUBLE_CHARS
];

612 
Àn
 = 
	`ld2°rög
(
buf
,(buf),
d
,
LD_STR_HUMAN
);

613 
	`addRïlyPrŸo
(
c
,",",1);

614 
	`addRïlyPrŸo
(
c
,
buf
,
Àn
);

615 
	`addRïlyPrŸo
(
c
,"\r\n",2);

617 
	}
}

621 
	$addRïlyL⁄gL⁄gWôhPªfix
(
˛õ¡
 *
c
, 
Œ
, 
¥efix
) {

622 
buf
[128];

623 
Àn
;

628 i‡(
¥efix
 ='*' && 
Œ
 < 
OBJ_SHARED_BULKHDR_LEN
 &&Ül >= 0) {

629 
	`addRïly
(
c
,
sh¨ed
.
mbulkhdr
[
Œ
]);

631 } i‡(
¥efix
 ='$' && 
Œ
 < 
OBJ_SHARED_BULKHDR_LEN
 &&Ül >= 0) {

632 
	`addRïly
(
c
,
sh¨ed
.
bulkhdr
[
Œ
]);

636 
buf
[0] = 
¥efix
;

637 
Àn
 = 
	`Œ2°rög
(
buf
+1,(buf)-1,
Œ
);

638 
buf
[
Àn
+1] = '\r';

639 
buf
[
Àn
+2] = '\n';

640 
	`addRïlyPrŸo
(
c
,
buf
,
Àn
+3);

641 
	}
}

643 
	$addRïlyL⁄gL⁄g
(
˛õ¡
 *
c
, 
Œ
) {

644 i‡(
Œ
 == 0)

645 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

646 i‡(
Œ
 == 1)

647 
	`addRïly
(
c
,
sh¨ed
.
c⁄e
);

649 
	`addRïlyL⁄gL⁄gWôhPªfix
(
c
,
Œ
,':');

650 
	}
}

652 
	$addRïlyAggªg©eLí
(
˛õ¡
 *
c
, 
Àngth
, 
¥efix
) {

653 i‡(
¥efix
 ='*' && 
Àngth
 < 
OBJ_SHARED_BULKHDR_LEN
)

654 
	`addRïly
(
c
,
sh¨ed
.
mbulkhdr
[
Àngth
]);

656 
	`addRïlyL⁄gL⁄gWôhPªfix
(
c
,
Àngth
,
¥efix
);

657 
	}
}

659 
	$addRïlyAºayLí
(
˛õ¡
 *
c
, 
Àngth
) {

660 
	`addRïlyAggªg©eLí
(
c
,
Àngth
,'*');

661 
	}
}

663 
	$addRïlyM≠Lí
(
˛õ¡
 *
c
, 
Àngth
) {

664 
¥efix
 = 
c
->
ª•
 == 2 ? '*' : '%';

665 i‡(
c
->
ª•
 =2Ë
Àngth
 *= 2;

666 
	`addRïlyAggªg©eLí
(
c
,
Àngth
,
¥efix
);

667 
	}
}

669 
	$addRïlySëLí
(
˛õ¡
 *
c
, 
Àngth
) {

670 
¥efix
 = 
c
->
ª•
 == 2 ? '*' : '~';

671 
	`addRïlyAggªg©eLí
(
c
,
Àngth
,
¥efix
);

672 
	}
}

674 
	$addRïlyAâribuãLí
(
˛õ¡
 *
c
, 
Àngth
) {

675 
¥efix
 = 
c
->
ª•
 == 2 ? '*' : '|';

676 i‡(
c
->
ª•
 =2Ë
Àngth
 *= 2;

677 
	`addRïlyAggªg©eLí
(
c
,
Àngth
,
¥efix
);

678 
	}
}

680 
	$addRïlyPushLí
(
˛õ¡
 *
c
, 
Àngth
) {

681 
¥efix
 = 
c
->
ª•
 == 2 ? '*' : '>';

682 
	`addRïlyAggªg©eLí
(
c
,
Àngth
,
¥efix
);

683 
	}
}

685 
	$addRïlyNuŒ
(
˛õ¡
 *
c
) {

686 i‡(
c
->
ª•
 == 2) {

687 
	`addRïlyPrŸo
(
c
,"$-1\r\n",5);

689 
	`addRïlyPrŸo
(
c
,"_\r\n",3);

691 
	}
}

693 
	$addRïlyBoﬁ
(
˛õ¡
 *
c
, 
b
) {

694 i‡(
c
->
ª•
 == 2) {

695 
	`addRïly
(
c
, 
b
 ? 
sh¨ed
.
c⁄e
 : sh¨ed.
czîo
);

697 
	`addRïlyPrŸo
(
c
, 
b
 ? "#t\r\n" : "#f\r\n",4);

699 
	}
}

705 
	$addRïlyNuŒAºay
(
˛õ¡
 *
c
) {

706 i‡(
c
->
ª•
 == 2) {

707 
	`addRïlyPrŸo
(
c
,"*-1\r\n",5);

709 
	`addRïlyPrŸo
(
c
,"_\r\n",3);

711 
	}
}

714 
	$addRïlyBulkLí
(
˛õ¡
 *
c
, 
robj
 *
obj
) {

715 
size_t
 
Àn
 = 
	`°rögObje˘Lí
(
obj
);

717 i‡(
Àn
 < 
OBJ_SHARED_BULKHDR_LEN
)

718 
	`addRïly
(
c
,
sh¨ed
.
bulkhdr
[
Àn
]);

720 
	`addRïlyL⁄gL⁄gWôhPªfix
(
c
,
Àn
,'$');

721 
	}
}

724 
	$addRïlyBulk
(
˛õ¡
 *
c
, 
robj
 *
obj
) {

725 
	`addRïlyBulkLí
(
c
,
obj
);

726 
	`addRïly
(
c
,
obj
);

727 
	`addRïly
(
c
,
sh¨ed
.
¸lf
);

728 
	}
}

731 
	$addRïlyBulkCBuf„r
(
˛õ¡
 *
c
, c⁄° *
p
, 
size_t
 
Àn
) {

732 
	`addRïlyL⁄gL⁄gWôhPªfix
(
c
,
Àn
,'$');

733 
	`addRïlyPrŸo
(
c
,
p
,
Àn
);

734 
	`addRïly
(
c
,
sh¨ed
.
¸lf
);

735 
	}
}

738 
	$addRïlyBulkSds
(
˛õ¡
 *
c
, 
sds
 
s
) {

739 
	`addRïlyL⁄gL⁄gWôhPªfix
(
c
,
	`sd¶í
(
s
),'$');

740 
	`addRïlySds
(
c
,
s
);

741 
	`addRïly
(
c
,
sh¨ed
.
¸lf
);

742 
	}
}

745 
	$addRïlyBulkCSåög
(
˛õ¡
 *
c
, c⁄° *
s
) {

746 i‡(
s
 =
NULL
) {

747 
	`addRïlyNuŒ
(
c
);

749 
	`addRïlyBulkCBuf„r
(
c
,
s
,
	`°æí
(s));

751 
	}
}

754 
	$addRïlyBulkL⁄gL⁄g
(
˛õ¡
 *
c
, 
Œ
) {

755 
buf
[64];

756 
Àn
;

758 
Àn
 = 
	`Œ2°rög
(
buf
,64,
Œ
);

759 
	`addRïlyBulkCBuf„r
(
c
,
buf
,
Àn
);

760 
	}
}

771 
	$addRïlyVîb©im
(
˛õ¡
 *
c
, c⁄° *
s
, 
size_t
 
Àn
, c⁄° *
ext
) {

772 i‡(
c
->
ª•
 == 2) {

773 
	`addRïlyBulkCBuf„r
(
c
,
s
,
Àn
);

775 
buf
[32];

776 
size_t
 
¥eÊí
 = 
	`¢¥ötf
(
buf
,(buf),"=%zu\r\nxxx:",
Àn
+4);

777 *
p
 = 
buf
+
¥eÊí
-4;

778 
i
 = 0; i < 3; i++) {

779 i‡(*
ext
 == '\0') {

780 
p
[
i
] = ' ';

782 
p
[
i
] = *
ext
++;

785 
	`addRïlyPrŸo
(
c
,
buf
,
¥eÊí
);

786 
	`addRïlyPrŸo
(
c
,
s
,
Àn
);

787 
	`addRïlyPrŸo
(
c
,"\r\n",2);

789 
	}
}

795 
	$addRïlyHñp
(
˛õ¡
 *
c
, c⁄° **
hñp
) {

796 
sds
 
cmd
 = 
	`sd¢ew
((*Ë
c
->
¨gv
[0]->
±r
);

797 *
bÀ≈
 = 
	`addRïlyDe„ºedLí
(
c
);

798 
bÀn
 = 0;

800 
	`sd°ouµî
(
cmd
);

801 
	`addRïlySètusF‹m©
(
c
,

802 "%†<subcomm™d>árgárg ...árg. Subcomm™d†¨e:",
cmd
);

803 
	`sds‰ì
(
cmd
);

805 
hñp
[
bÀn
]Ë
	`addRïlySètus
(
c
,help[blen++]);

807 
bÀn
++;

808 
	`£tDe„ºedAºayLí
(
c
,
bÀ≈
,
bÀn
);

809 
	}
}

814 
	$addRïlySubcomm™dSy¡axEº‹
(
˛õ¡
 *
c
) {

815 
sds
 
cmd
 = 
	`sd¢ew
((*Ë
c
->
¨gv
[0]->
±r
);

816 
	`sd°ouµî
(
cmd
);

817 
	`addRïlyEº‹F‹m©
(
c
,

819 (*)
c
->
¨gv
[1]->
±r
,
cmd
);

820 
	`sds‰ì
(
cmd
);

821 
	}
}

825 
	$AddRïlyFromClõ¡
(
˛õ¡
 *
d°
, clõ¡ *
§c
) {

826 i‡(
	`¥ï¨eClõ¡ToWrôe
(
d°
Ë!
C_OK
)

828 
	`addRïlyPrŸo
(
d°
,
§c
->
buf
, src->
buÂos
);

829 i‡(
	`li°Lígth
(
§c
->
ª∂y
))

830 
	`li°Joö
(
d°
->
ª∂y
,
§c
->reply);

831 
d°
->
ª∂y_byãs
 +
§c
->reply_bytes;

832 
§c
->
ª∂y_byãs
 = 0;

833 
§c
->
buÂos
 = 0;

834 
	}
}

839 
	$c›yClõ¡OuçutBuf„r
(
˛õ¡
 *
d°
, clõ¡ *
§c
) {

840 
	`li°Rñó£
(
d°
->
ª∂y
);

841 
d°
->
£¡Àn
 = 0;

842 
d°
->
ª∂y
 = 
	`li°Dup
(
§c
->reply);

843 
	`mem˝y
(
d°
->
buf
,
§c
->buf,§c->
buÂos
);

844 
d°
->
buÂos
 = 
§c
->bufpos;

845 
d°
->
ª∂y_byãs
 = 
§c
->reply_bytes;

846 
	}
}

850 
	$˛õ¡HasPídögRïlõs
(
˛õ¡
 *
c
) {

851  
c
->
buÂos
 || 
	`li°Lígth
(c->
ª∂y
);

852 
	}
}

854 
	$˛õ¡Ac˚±H™dÀr
(
c⁄√˘i⁄
 *
c⁄n
) {

855 
˛õ¡
 *
c
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

857 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë!
CONN_STATE_CONNECTED
) {

858 
	`£rvîLog
(
LL_WARNING
,

860 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

861 
	`‰ìClõ¡Async
(
c
);

869 i‡(
£rvî
.
¥Ÿe˘ed_mode
 &&

870 
£rvî
.
bödaddr_cou¡
 == 0 &&

871 
DeÁu…U£r
->
Êags
 & 
USER_FLAG_NOPASS
 &&

872 !(
c
->
Êags
 & 
CLIENT_UNIX_SOCKET
))

874 
cù
[
NET_IP_STR_LEN
+1] = { 0 };

875 
	`c⁄nPìrToSåög
(
c⁄n
, 
cù
, (cù)-1, 
NULL
);

877 i‡(
	`°rcmp
(
cù
,"127.0.0.1") && strcmp(cip,"::1")) {

878 *
îr
 =

899 i‡(
	`c⁄nWrôe
(
c
->
c⁄n
,
îr
,
	`°æí
(err)) == -1) {

902 
£rvî
.
°©_ªje˘ed_c⁄n
++;

903 
	`‰ìClõ¡Async
(
c
);

908 
£rvî
.
°©_numc⁄√˘i⁄s
++;

909 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_CLIENT_CHANGE
,

910 
REDISMODULE_SUBEVENT_CLIENT_CHANGE_CONNECTED
,

911 
c
);

912 
	}
}

914 
	#MAX_ACCEPTS_PER_CALL
 1000

	)

915 
	$ac˚±Comm⁄H™dÀr
(
c⁄√˘i⁄
 *
c⁄n
, 
Êags
, *
ù
) {

916 
˛õ¡
 *
c
;

917 
	`UNUSED
(
ù
);

923 i‡(
	`li°Lígth
(
£rvî
.
˛õ¡s
Ë>£rvî.
max˛õ¡s
) {

924 *
îr
 = "-ERR maxÇumber of clientsÑeached\r\n";

930 i‡(
	`c⁄nWrôe
(
c⁄n
,
îr
,
	`°æí
(err)) == -1) {

933 
£rvî
.
°©_ªje˘ed_c⁄n
++;

934 
	`c⁄nClo£
(
c⁄n
);

939 i‡((
c
 = 
	`¸óãClõ¡
(
c⁄n
)Ë=
NULL
) {

940 
c⁄nöfo
[100];

941 
	`£rvîLog
(
LL_WARNING
,

943 
	`c⁄nGëLa°Eº‹
(
c⁄n
),

944 
	`c⁄nGëInfo
(
c⁄n
, 
c⁄nöfo
, (conninfo)));

945 
	`c⁄nClo£
(
c⁄n
);

950 
c
->
Êags
 |= flags;

960 i‡(
	`c⁄nAc˚±
(
c⁄n
, 
˛õ¡Ac˚±H™dÀr
Ë=
C_ERR
) {

961 
c⁄nöfo
[100];

962 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë=
CONN_STATE_ERROR
)

963 
	`£rvîLog
(
LL_WARNING
,

965 
	`c⁄nGëLa°Eº‹
(
c⁄n
), 
	`c⁄nGëInfo
(c⁄n, 
c⁄nöfo
, (conninfo)));

966 
	`‰ìClõ¡
(
	`c⁄nGëPriv©eD©a
(
c⁄n
));

969 
	}
}

971 
	$ac˚±T˝H™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

972 
˝‹t
, 
cfd
, 
max
 = 
MAX_ACCEPTS_PER_CALL
;

973 
cù
[
NET_IP_STR_LEN
];

974 
	`UNUSED
(
ñ
);

975 
	`UNUSED
(
mask
);

976 
	`UNUSED
(
¥ivd©a
);

978 
max
--) {

979 
cfd
 = 
	`™ëT˝Ac˚±
(
£rvî
.
√ãº
, 
fd
, 
cù
, (cù), &
˝‹t
);

980 i‡(
cfd
 =
ANET_ERR
) {

981 i‡(
î∫o
 !
EWOULDBLOCK
)

982 
	`£rvîLog
(
LL_WARNING
,

983 "Ac˚±ög clõ¡ c⁄√˘i⁄: %s", 
£rvî
.
√ãº
);

986 
	`£rvîLog
(
LL_VERBOSE
,"Ac˚±ed %s:%d", 
cù
, 
˝‹t
);

987 
	`ac˚±Comm⁄H™dÀr
(
	`c⁄nCª©eAc˚±edSockë
(
cfd
),0,
cù
);

989 
	}
}

991 
	$ac˚±TLSH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

992 
˝‹t
, 
cfd
, 
max
 = 
MAX_ACCEPTS_PER_CALL
;

993 
cù
[
NET_IP_STR_LEN
];

994 
	`UNUSED
(
ñ
);

995 
	`UNUSED
(
mask
);

996 
	`UNUSED
(
¥ivd©a
);

998 
max
--) {

999 
cfd
 = 
	`™ëT˝Ac˚±
(
£rvî
.
√ãº
, 
fd
, 
cù
, (cù), &
˝‹t
);

1000 i‡(
cfd
 =
ANET_ERR
) {

1001 i‡(
î∫o
 !
EWOULDBLOCK
)

1002 
	`£rvîLog
(
LL_WARNING
,

1003 "Ac˚±ög clõ¡ c⁄√˘i⁄: %s", 
£rvî
.
√ãº
);

1006 
	`£rvîLog
(
LL_VERBOSE
,"Ac˚±ed %s:%d", 
cù
, 
˝‹t
);

1007 
	`ac˚±Comm⁄H™dÀr
(
	`c⁄nCª©eAc˚±edTLS
(
cfd
, 
£rvî
.
és_auth_˛õ¡s
),0,
cù
);

1009 
	}
}

1011 
	$ac˚±UnixH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

1012 
cfd
, 
max
 = 
MAX_ACCEPTS_PER_CALL
;

1013 
	`UNUSED
(
ñ
);

1014 
	`UNUSED
(
mask
);

1015 
	`UNUSED
(
¥ivd©a
);

1017 
max
--) {

1018 
cfd
 = 
	`™ëUnixAc˚±
(
£rvî
.
√ãº
, 
fd
);

1019 i‡(
cfd
 =
ANET_ERR
) {

1020 i‡(
î∫o
 !
EWOULDBLOCK
)

1021 
	`£rvîLog
(
LL_WARNING
,

1022 "Ac˚±ög clõ¡ c⁄√˘i⁄: %s", 
£rvî
.
√ãº
);

1025 
	`£rvîLog
(
LL_VERBOSE
,"Ac˚±ed c⁄√˘i⁄Åÿ%s", 
£rvî
.
unixsockë
);

1026 
	`ac˚±Comm⁄H™dÀr
(
	`c⁄nCª©eAc˚±edSockë
(
cfd
),
CLIENT_UNIX_SOCKET
,
NULL
);

1028 
	}
}

1030 
	$‰ìClõ¡Argv
(
˛õ¡
 *
c
) {

1031 
j
;

1032 
j
 = 0; j < 
c
->
¨gc
; j++)

1033 
	`de¸RefCou¡
(
c
->
¨gv
[
j
]);

1034 
c
->
¨gc
 = 0;

1035 
c
->
cmd
 = 
NULL
;

1036 
	}
}

1041 
	$disc⁄√˘Sœves
() {

1042 
	`li°Lígth
(
£rvî
.
¶aves
)) {

1043 
li°Node
 *
 
 = 
	`li°Fú°
(
£rvî
.
¶aves
);

1044 
	`‰ìClõ¡
((
˛õ¡
*)
 
->
vÆue
);

1046 
	}
}

1051 
	$u∆ökClõ¡
(
˛õ¡
 *
c
) {

1052 
li°Node
 *
 
;

1055 i‡(
£rvî
.
cuºít_˛õ¡
 =
c
Ë£rvî.cuºít_˛õ¡ = 
NULL
;

1060 i‡(
c
->
c⁄n
) {

1062 i‡(
c
->
˛õ¡_li°_node
) {

1063 
uöt64_t
 
id
 = 
	`ht⁄u64
(
c
->id);

1064 
	`øxRemove
(
£rvî
.
˛õ¡s_ödex
,(*)&
id
,(id),
NULL
);

1065 
	`li°DñNode
(
£rvî
.
˛õ¡s
,
c
->
˛õ¡_li°_node
);

1066 
c
->
˛õ¡_li°_node
 = 
NULL
;

1071 i‡(
c
->
Êags
 & 
CLIENT_SLAVE
 &&

1072 
c
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_END
 &&

1073 
£rvî
.
rdb_pùe_c⁄ns
)

1075 
i
;

1076 
i
=0; i < 
£rvî
.
rdb_pùe_numc⁄ns
; i++) {

1077 i‡(
£rvî
.
rdb_pùe_c⁄ns
[
i
] =
c
->
c⁄n
) {

1078 
	`rdbPùeWrôeH™dÀrC⁄nRemoved
(
c
->
c⁄n
);

1079 
£rvî
.
rdb_pùe_c⁄ns
[
i
] = 
NULL
;

1084 
	`c⁄nClo£
(
c
->
c⁄n
);

1085 
c
->
c⁄n
 = 
NULL
;

1089 i‡(
c
->
Êags
 & 
CLIENT_PENDING_WRITE
) {

1090 
 
 = 
	`li°SórchKey
(
£rvî
.
˛õ¡s_≥ndög_wrôe
,
c
);

1091 
	`£rvîAs£π
(
 
 !
NULL
);

1092 
	`li°DñNode
(
£rvî
.
˛õ¡s_≥ndög_wrôe
,
 
);

1093 
c
->
Êags
 &~
CLIENT_PENDING_WRITE
;

1097 i‡(
c
->
Êags
 & 
CLIENT_PENDING_READ
) {

1098 
 
 = 
	`li°SórchKey
(
£rvî
.
˛õ¡s_≥ndög_ªad
,
c
);

1099 
	`£rvîAs£π
(
 
 !
NULL
);

1100 
	`li°DñNode
(
£rvî
.
˛õ¡s_≥ndög_ªad
,
 
);

1101 
c
->
Êags
 &~
CLIENT_PENDING_READ
;

1106 i‡(
c
->
Êags
 & 
CLIENT_UNBLOCKED
) {

1107 
 
 = 
	`li°SórchKey
(
£rvî
.
unblocked_˛õ¡s
,
c
);

1108 
	`£rvîAs£π
(
 
 !
NULL
);

1109 
	`li°DñNode
(
£rvî
.
unblocked_˛õ¡s
,
 
);

1110 
c
->
Êags
 &~
CLIENT_UNBLOCKED
;

1114 i‡(
c
->
Êags
 & 
CLIENT_TRACKING
Ë
	`dißbÀTøckög
(c);

1115 
	}
}

1117 
	$‰ìClõ¡
(
˛õ¡
 *
c
) {

1118 
li°Node
 *
 
;

1122 i‡(
c
->
Êags
 & 
CLIENT_PROTECTED
) {

1123 
	`‰ìClõ¡Async
(
c
);

1128 i‡(
c
->
c⁄n
) {

1129 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_CLIENT_CHANGE
,

1130 
REDISMODULE_SUBEVENT_CLIENT_CHANGE_DISCONNECTED
,

1131 
c
);

1135 
	`moduÀNŸifyU£rCh™ged
(
c
);

1141 i‡(
c
->
Êags
 & 
CLIENT_CLOSE_ASAP
) {

1142 
 
 = 
	`li°SórchKey
(
£rvî
.
˛õ¡s_to_˛o£
,
c
);

1143 
	`£rvîAs£π
(
 
 !
NULL
);

1144 
	`li°DñNode
(
£rvî
.
˛õ¡s_to_˛o£
,
 
);

1152 i‡(
£rvî
.
ma°î
 && 
c
->
Êags
 & 
CLIENT_MASTER
) {

1153 
	`£rvîLog
(
LL_WARNING
,"Connection with masterÜost.");

1154 i‡(!(
c
->
Êags
 & (
CLIENT_PROTOCOL_ERROR
|
CLIENT_BLOCKED
))) {

1155 
c
->
Êags
 &~(
CLIENT_CLOSE_ASAP
|
CLIENT_CLOSE_AFTER_REPLY
);

1156 
	`ª∂iˇti⁄CacheMa°î
(
c
);

1162 i‡(
	`gëClõ¡Ty≥
(
c
Ë=
CLIENT_TYPE_SLAVE
) {

1163 
	`£rvîLog
(
LL_WARNING
,"Connection withÑeplica %sÜost.",

1164 
	`ª∂iˇti⁄GëSœveName
(
c
));

1168 
	`sds‰ì
(
c
->
quîybuf
);

1169 
	`sds‰ì
(
c
->
≥ndög_quîybuf
);

1170 
c
->
quîybuf
 = 
NULL
;

1173 i‡(
c
->
Êags
 & 
CLIENT_BLOCKED
Ë
	`unblockClõ¡
(c);

1174 
	`di˘Rñó£
(
c
->
bp›
.
keys
);

1177 
	`unw©chAŒKeys
(
c
);

1178 
	`li°Rñó£
(
c
->
w©ched_keys
);

1181 
	`pubsubUnsubs¸ibeAŒCh™√ls
(
c
,0);

1182 
	`pubsubUnsubs¸ibeAŒP©ã∫s
(
c
,0);

1183 
	`di˘Rñó£
(
c
->
pubsub_ch™√ls
);

1184 
	`li°Rñó£
(
c
->
pubsub_∑âîns
);

1187 
	`li°Rñó£
(
c
->
ª∂y
);

1188 
	`‰ìClõ¡Argv
(
c
);

1193 
	`u∆ökClõ¡
(
c
);

1197 i‡(
c
->
Êags
 & 
CLIENT_SLAVE
) {

1198 i‡(
c
->
ª∂°©e
 =
SLAVE_STATE_SEND_BULK
) {

1199 i‡(
c
->
ª∂dbfd
 !-1Ë
	`˛o£
(c->repldbfd);

1200 i‡(
c
->
ª∂¥ómbÀ
Ë
	`sds‰ì
(c->replpreamble);

1202 
li°
 *
l
 = (
c
->
Êags
 & 
CLIENT_MONITOR
Ë? 
£rvî
.
m⁄ô‹s
 : sîvî.
¶aves
;

1203 
 
 = 
	`li°SórchKey
(
l
,
c
);

1204 
	`£rvîAs£π
(
 
 !
NULL
);

1205 
	`li°DñNode
(
l
,
 
);

1209 i‡(
	`gëClõ¡Ty≥
(
c
Ë=
CLIENT_TYPE_SLAVE
 && 
	`li°Lígth
(
£rvî
.
¶aves
) == 0)

1210 
£rvî
.
ª∂_no_¶aves_sö˚
 = sîvî.
unixtime
;

1211 
	`ª‰eshGoodSœvesCou¡
();

1213 i‡(
c
->
ª∂°©e
 =
SLAVE_STATE_ONLINE
)

1214 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_REPLICA_CHANGE
,

1215 
REDISMODULE_SUBEVENT_REPLICA_CHANGE_OFFLINE
,

1216 
NULL
);

1221 i‡(
c
->
Êags
 & 
CLIENT_MASTER
Ë
	`ª∂iˇti⁄H™dÀMa°îDisc⁄√˘i⁄
();

1225 
£rvî
.
°©_˛õ¡s_ty≥_mem‹y
[
c
->
˛õ¡_¸⁄_œ°_mem‹y_ty≥
] -=

1226 
c
->
˛õ¡_¸⁄_œ°_mem‹y_ußge
;

1230 i‡(
c
->
«me
Ë
	`de¸RefCou¡
(c->name);

1231 
	`z‰ì
(
c
->
¨gv
);

1232 
	`‰ìClõ¡Mu…iSèã
(
c
);

1233 
	`sds‰ì
(
c
->
≥îid
);

1234 
	`z‰ì
(
c
);

1235 
	}
}

1241 
	$‰ìClõ¡Async
(
˛õ¡
 *
c
) {

1247 i‡(
c
->
Êags
 & 
CLIENT_CLOSE_ASAP
 || c->Êag†& 
CLIENT_LUA
) ;

1248 
c
->
Êags
 |
CLIENT_CLOSE_ASAP
;

1249 i‡(
£rvî
.
io_thªads_num
 == 1) {

1251 
	`li°AddNodeTaû
(
£rvî
.
˛õ¡s_to_˛o£
,
c
);

1254 
±hªad_muãx_t
 
async_‰ì_queue_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

1255 
	`±hªad_muãx_lock
(&
async_‰ì_queue_muãx
);

1256 
	`li°AddNodeTaû
(
£rvî
.
˛õ¡s_to_˛o£
,
c
);

1257 
	`±hªad_muãx_u∆ock
(&
async_‰ì_queue_muãx
);

1258 
	}
}

1262 
	$‰ìClõ¡sInAsyncFªeQueue
() {

1263 
‰ìd
 = 
	`li°Lígth
(
£rvî
.
˛õ¡s_to_˛o£
);

1264 
	`li°Lígth
(
£rvî
.
˛õ¡s_to_˛o£
)) {

1265 
li°Node
 *
 
 = 
	`li°Fú°
(
£rvî
.
˛õ¡s_to_˛o£
);

1266 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

1268 
c
->
Êags
 &~
CLIENT_CLOSE_ASAP
;

1269 
	`‰ìClõ¡
(
c
);

1270 
	`li°DñNode
(
£rvî
.
˛õ¡s_to_˛o£
,
 
);

1272  
‰ìd
;

1273 
	}
}

1278 
˛õ¡
 *
	$lookupClõ¡ByID
(
uöt64_t
 
id
) {

1279 
id
 = 
	`ht⁄u64
(id);

1280 
˛õ¡
 *
c
 = 
	`øxFöd
(
£rvî
.
˛õ¡s_ödex
,(*)&
id
,(id));

1281  (
c
 =
øxNŸFound
Ë? 
NULL
 : c;

1282 
	}
}

1292 
	$wrôeToClõ¡
(
˛õ¡
 *
c
, 
h™dÀr_ö°ÆÀd
) {

1293 
ssize_t
 
nwrôãn
 = 0, 
tŸwrôãn
 = 0;

1294 
size_t
 
objÀn
;

1295 
˛õ¡RïlyBlock
 *
o
;

1297 
	`˛õ¡HasPídögRïlõs
(
c
)) {

1298 i‡(
c
->
buÂos
 > 0) {

1299 
nwrôãn
 = 
	`c⁄nWrôe
(
c
->
c⁄n
,c->
buf
+c->
£¡Àn
,c->
buÂos
-c->sentlen);

1300 i‡(
nwrôãn
 <= 0) ;

1301 
c
->
£¡Àn
 +
nwrôãn
;

1302 
tŸwrôãn
 +
nwrôãn
;

1306 i‡(()
c
->
£¡Àn
 =c->
buÂos
) {

1307 
c
->
buÂos
 = 0;

1308 
c
->
£¡Àn
 = 0;

1311 
o
 = 
	`li°NodeVÆue
(
	`li°Fú°
(
c
->
ª∂y
));

1312 
objÀn
 = 
o
->
u£d
;

1314 i‡(
objÀn
 == 0) {

1315 
c
->
ª∂y_byãs
 -
o
->
size
;

1316 
	`li°DñNode
(
c
->
ª∂y
,
	`li°Fú°
(c->reply));

1320 
nwrôãn
 = 
	`c⁄nWrôe
(
c
->
c⁄n
, 
o
->
buf
 + c->
£¡Àn
, 
objÀn
 - c->sentlen);

1321 i‡(
nwrôãn
 <= 0) ;

1322 
c
->
£¡Àn
 +
nwrôãn
;

1323 
tŸwrôãn
 +
nwrôãn
;

1326 i‡(
c
->
£¡Àn
 =
objÀn
) {

1327 
c
->
ª∂y_byãs
 -
o
->
size
;

1328 
	`li°DñNode
(
c
->
ª∂y
,
	`li°Fú°
(c->reply));

1329 
c
->
£¡Àn
 = 0;

1332 i‡(
	`li°Lígth
(
c
->
ª∂y
) == 0)

1333 
	`£rvîAs£π
(
c
->
ª∂y_byãs
 == 0);

1348 i‡(
tŸwrôãn
 > 
NET_MAX_WRITES_PER_EVENT
 &&

1349 (
£rvî
.
maxmem‹y
 == 0 ||

1350 
	`zmÆloc_u£d_mem‹y
(Ë< 
£rvî
.
maxmem‹y
) &&

1351 !(
c
->
Êags
 & 
CLIENT_SLAVE
)) ;

1353 
£rvî
.
°©_√t_ouçut_byãs
 +
tŸwrôãn
;

1354 i‡(
nwrôãn
 == -1) {

1355 i‡(
	`c⁄nGëSèã
(
c
->
c⁄n
Ë=
CONN_STATE_CONNECTED
) {

1356 
nwrôãn
 = 0;

1358 
	`£rvîLog
(
LL_VERBOSE
,

1359 "Eº‹ wrôögÅÿ˛õ¡: %s", 
	`c⁄nGëLa°Eº‹
(
c
->
c⁄n
));

1360 
	`‰ìClõ¡Async
(
c
);

1361  
C_ERR
;

1364 i‡(
tŸwrôãn
 > 0) {

1369 i‡(!(
c
->
Êags
 & 
CLIENT_MASTER
)Ëc->
œ°öãø˘i⁄
 = 
£rvî
.
unixtime
;

1371 i‡(!
	`˛õ¡HasPídögRïlõs
(
c
)) {

1372 
c
->
£¡Àn
 = 0;

1377 i‡(
h™dÀr_ö°ÆÀd
Ë
	`c⁄nSëWrôeH™dÀr
(
c
->
c⁄n
, 
NULL
);

1380 i‡(
c
->
Êags
 & 
CLIENT_CLOSE_AFTER_REPLY
) {

1381 
	`‰ìClõ¡Async
(
c
);

1382  
C_ERR
;

1385  
C_OK
;

1386 
	}
}

1389 
	$£ndRïlyToClõ¡
(
c⁄√˘i⁄
 *
c⁄n
) {

1390 
˛õ¡
 *
c
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

1391 
	`wrôeToClõ¡
(
c
,1);

1392 
	}
}

1398 
	$h™dÀClõ¡sWôhPídögWrôes
() {

1399 
li°Iãr
 
li
;

1400 
li°Node
 *
 
;

1401 
¥o˚s£d
 = 
	`li°Lígth
(
£rvî
.
˛õ¡s_≥ndög_wrôe
);

1403 
	`li°Rewöd
(
£rvî
.
˛õ¡s_≥ndög_wrôe
,&
li
);

1404 (
 
 = 
	`li°Next
(&
li
))) {

1405 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

1406 
c
->
Êags
 &~
CLIENT_PENDING_WRITE
;

1407 
	`li°DñNode
(
£rvî
.
˛õ¡s_≥ndög_wrôe
,
 
);

1411 i‡(
c
->
Êags
 & 
CLIENT_PROTECTED
) ;

1414 i‡(
	`wrôeToClõ¡
(
c
,0Ë=
C_ERR
) ;

1418 i‡(
	`˛õ¡HasPídögRïlõs
(
c
)) {

1419 
´_b¨rõr
 = 0;

1425 i‡(
£rvî
.
aof_°©e
 =
AOF_ON
 &&

1426 
£rvî
.
aof_fsync
 =
AOF_FSYNC_ALWAYS
)

1428 
´_b¨rõr
 = 1;

1430 i‡(
	`c⁄nSëWrôeH™dÀrWôhB¨rõr
(
c
->
c⁄n
, 
£ndRïlyToClõ¡
, 
´_b¨rõr
Ë=
C_ERR
) {

1431 
	`‰ìClõ¡Async
(
c
);

1435  
¥o˚s£d
;

1436 
	}
}

1439 
	$ª£tClõ¡
(
˛õ¡
 *
c
) {

1440 
ªdisComm™dProc
 *
¥evcmd
 = 
c
->
cmd
 ? c->cmd->
¥oc
 : 
NULL
;

1442 
	`‰ìClõ¡Argv
(
c
);

1443 
c
->
ªqty≥
 = 0;

1444 
c
->
mu…ibulkÀn
 = 0;

1445 
c
->
bulkÀn
 = -1;

1449 i‡(!(
c
->
Êags
 & 
CLIENT_MULTI
Ë&& 
¥evcmd
 !
askögComm™d
)

1450 
c
->
Êags
 &~
CLIENT_ASKING
;

1455 i‡(!(
c
->
Êags
 & 
CLIENT_MULTI
Ë&& 
¥evcmd
 !
˛õ¡Comm™d
)

1456 
c
->
Êags
 &~
CLIENT_TRACKING_CACHING
;

1461 
c
->
Êags
 &~
CLIENT_REPLY_SKIP
;

1462 i‡(
c
->
Êags
 & 
CLIENT_REPLY_SKIP_NEXT
) {

1463 
c
->
Êags
 |
CLIENT_REPLY_SKIP
;

1464 
c
->
Êags
 &~
CLIENT_REPLY_SKIP_NEXT
;

1466 
	}
}

1481 
	$¥Ÿe˘Clõ¡
(
˛õ¡
 *
c
) {

1482 
c
->
Êags
 |
CLIENT_PROTECTED
;

1483 
	`c⁄nSëRódH™dÀr
(
c
->
c⁄n
,
NULL
);

1484 
	`c⁄nSëWrôeH™dÀr
(
c
->
c⁄n
,
NULL
);

1485 
	}
}

1488 
	$u≈rŸe˘Clõ¡
(
˛õ¡
 *
c
) {

1489 i‡(
c
->
Êags
 & 
CLIENT_PROTECTED
) {

1490 
c
->
Êags
 &~
CLIENT_PROTECTED
;

1491 
	`c⁄nSëRódH™dÀr
(
c
->
c⁄n
,
ªadQuîyFromClõ¡
);

1492 i‡(
	`˛õ¡HasPídögRïlõs
(
c
)Ë
	`˛õ¡In°ÆlWrôeH™dÀr
(c);

1494 
	}
}

1503 
	$¥o˚ssI∆öeBuf„r
(
˛õ¡
 *
c
) {

1504 *
√wlöe
;

1505 
¨gc
, 
j
, 
löe„ed_ch¨s
 = 1;

1506 
sds
 *
¨gv
, 
aux
;

1507 
size_t
 
quîyÀn
;

1510 
√wlöe
 = 
	`°rchr
(
c
->
quîybuf
+c->
qb_pos
,'\n');

1513 i‡(
√wlöe
 =
NULL
) {

1514 i‡(
	`sd¶í
(
c
->
quîybuf
)-c->
qb_pos
 > 
PROTO_INLINE_MAX_SIZE
) {

1515 
	`addRïlyEº‹
(
c
,"ProtocolÉrror:Åoo big inlineÑequest");

1516 
	`£tPrŸocﬁEº‹
("toÿbig i∆öêªque°",
c
);

1518  
C_ERR
;

1522 i‡(
√wlöe
 &&Çewlöê!
c
->
quîybuf
+c->
qb_pos
 && *(newline-1) == '\r')

1523 
√wlöe
--, 
löe„ed_ch¨s
++;

1526 
quîyÀn
 = 
√wlöe
-(
c
->
quîybuf
+c->
qb_pos
);

1527 
aux
 = 
	`sd¢ewÀn
(
c
->
quîybuf
+c->
qb_pos
,
quîyÀn
);

1528 
¨gv
 = 
	`sds•lô¨gs
(
aux
,&
¨gc
);

1529 
	`sds‰ì
(
aux
);

1530 i‡(
¨gv
 =
NULL
) {

1531 
	`addRïlyEº‹
(
c
,"ProtocolÉrror: unbalanced quotes inÑequest");

1532 
	`£tPrŸocﬁEº‹
("unbÆ™˚d quŸe†ö i∆öêªque°",
c
);

1533  
C_ERR
;

1539 i‡(
quîyÀn
 =0 && 
	`gëClõ¡Ty≥
(
c
Ë=
CLIENT_TYPE_SLAVE
)

1540 
c
->
ª∂_ack_time
 = 
£rvî
.
unixtime
;

1543 
c
->
qb_pos
 +
quîyÀn
+
löe„ed_ch¨s
;

1546 i‡(
¨gc
) {

1547 i‡(
c
->
¨gv
Ë
	`z‰ì
(c->argv);

1548 
c
->
¨gv
 = 
	`zmÆloc
((
robj
*)*
¨gc
);

1552 
c
->
¨gc
 = 0, 
j
 = 0; j <árgc; j++) {

1553 
c
->
¨gv
[c->
¨gc
] = 
	`¸óãObje˘
(
OBJ_STRING
,¨gv[
j
]);

1554 
c
->
¨gc
++;

1556 
	`z‰ì
(
¨gv
);

1557  
C_OK
;

1558 
	}
}

1563 
	#PROTO_DUMP_LEN
 128

	)

1564 
	$£tPrŸocﬁEº‹
(c⁄° *
îr°r
, 
˛õ¡
 *
c
) {

1565 i‡(
£rvî
.
vîbosôy
 <
LL_VERBOSE
) {

1566 
sds
 
˛õ¡
 = 
	`ˇtClõ¡InfoSåög
(
	`sd£m±y
(),
c
);

1569 
buf
[256];

1570 i‡(
	`sd¶í
(
c
->
quîybuf
)-c->
qb_pos
 < 
PROTO_DUMP_LEN
) {

1571 
	`¢¥ötf
(
buf
,(buf),"Quîy buf„∏durögÖrŸocﬁÉº‹: '%s'", 
c
->
quîybuf
+c->
qb_pos
);

1573 
	`¢¥ötf
(
buf
,(buf),"Quîy buf„∏durögÖrŸocﬁÉº‹: '%.*s' (... m‹ê%zu byã†...Ë'%.*s'", 
PROTO_DUMP_LEN
/2, 
c
->
quîybuf
+c->
qb_pos
, 
	`sd¶í
(c->querybuf)-c->qb_pos-PROTO_DUMP_LEN, PROTO_DUMP_LEN/2, c->querybuf+sdslen(c->querybuf)-PROTO_DUMP_LEN/2);

1577 *
p
 = 
buf
;

1578 *
p
 != '\0') {

1579 i‡(!
	`i•röt
(*
p
)) *p = '.';

1580 
p
++;

1584 
	`£rvîLog
(
LL_VERBOSE
,

1585 "PrŸocﬁÉº‹ (%sË‰om clõ¡: %s. %s", 
îr°r
, 
˛õ¡
, 
buf
);

1586 
	`sds‰ì
(
˛õ¡
);

1588 
c
->
Êags
 |(
CLIENT_CLOSE_AFTER_REPLY
|
CLIENT_PROTOCOL_ERROR
);

1589 
	}
}

1602 
	$¥o˚ssMu…ibulkBuf„r
(
˛õ¡
 *
c
) {

1603 *
√wlöe
 = 
NULL
;

1604 
ok
;

1605 
Œ
;

1607 i‡(
c
->
mu…ibulkÀn
 == 0) {

1609 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,c->
¨gc
 == 0);

1612 
√wlöe
 = 
	`°rchr
(
c
->
quîybuf
+c->
qb_pos
,'\r');

1613 i‡(
√wlöe
 =
NULL
) {

1614 i‡(
	`sd¶í
(
c
->
quîybuf
)-c->
qb_pos
 > 
PROTO_INLINE_MAX_SIZE
) {

1615 
	`addRïlyEº‹
(
c
,"ProtocolÉrror:Åoo big mbulk count string");

1616 
	`£tPrŸocﬁEº‹
("toÿbig mbulk cou¡ såög",
c
);

1618  
C_ERR
;

1622 i‡(
√wlöe
-(
c
->
quîybuf
+c->
qb_pos
Ë> (
ssize_t
)(
	`sd¶í
(c->querybuf)-c->qb_pos-2))

1623  
C_ERR
;

1627 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,c->
quîybuf
[c->
qb_pos
] == '*');

1628 
ok
 = 
	`°rög2Œ
(
c
->
quîybuf
+1+c->
qb_pos
,
√wlöe
-(c->quîybuf+1+c->qb_pos),&
Œ
);

1629 i‡(!
ok
 || 
Œ
 > 1024*1024) {

1630 
	`addRïlyEº‹
(
c
,"ProtocolÉrror: invalid multibulkÜength");

1631 
	`£tPrŸocﬁEº‹
("övÆid mbulk cou¡",
c
);

1632  
C_ERR
;

1635 
c
->
qb_pos
 = (
√wlöe
-c->
quîybuf
)+2;

1637 i‡(
Œ
 <0Ë 
C_OK
;

1639 
c
->
mu…ibulkÀn
 = 
Œ
;

1642 i‡(
c
->
¨gv
Ë
	`z‰ì
(c->argv);

1643 
c
->
¨gv
 = 
	`zmÆloc
((
robj
*)*c->
mu…ibulkÀn
);

1646 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,c->
mu…ibulkÀn
 > 0);

1647 
c
->
mu…ibulkÀn
) {

1649 i‡(
c
->
bulkÀn
 == -1) {

1650 
√wlöe
 = 
	`°rchr
(
c
->
quîybuf
+c->
qb_pos
,'\r');

1651 i‡(
√wlöe
 =
NULL
) {

1652 i‡(
	`sd¶í
(
c
->
quîybuf
)-c->
qb_pos
 > 
PROTO_INLINE_MAX_SIZE
) {

1653 
	`addRïlyEº‹
(
c
,

1655 
	`£tPrŸocﬁEº‹
("toÿbig bulk cou¡ såög",
c
);

1656  
C_ERR
;

1662 i‡(
√wlöe
-(
c
->
quîybuf
+c->
qb_pos
Ë> (
ssize_t
)(
	`sd¶í
(c->querybuf)-c->qb_pos-2))

1665 i‡(
c
->
quîybuf
[c->
qb_pos
] != '$') {

1666 
	`addRïlyEº‹F‹m©
(
c
,

1668 
c
->
quîybuf
[c->
qb_pos
]);

1669 
	`£tPrŸocﬁEº‹
("ex≥˘ed $ buàgŸ somëhögÉl£",
c
);

1670  
C_ERR
;

1673 
ok
 = 
	`°rög2Œ
(
c
->
quîybuf
+c->
qb_pos
+1,
√wlöe
-(c->quîybuf+c->qb_pos+1),&
Œ
);

1674 i‡(!
ok
 || 
Œ
 < 0 ||Ü»> 
£rvî
.
¥Ÿo_max_bulk_Àn
) {

1675 
	`addRïlyEº‹
(
c
,"ProtocolÉrror: invalid bulkÜength");

1676 
	`£tPrŸocﬁEº‹
("övÆid bulkÜígth",
c
);

1677  
C_ERR
;

1680 
c
->
qb_pos
 = 
√wlöe
-c->
quîybuf
+2;

1681 i‡(
Œ
 >
PROTO_MBULK_BIG_ARG
) {

1691 i‡(
	`sd¶í
(
c
->
quîybuf
)-c->
qb_pos
 <(
size_t
)
Œ
+2) {

1692 
	`sd§™ge
(
c
->
quîybuf
,c->
qb_pos
,-1);

1693 
c
->
qb_pos
 = 0;

1696 
c
->
quîybuf
 = 
	`sdsMakeRoomF‹
(c->quîybuf,
Œ
+2);

1699 
c
->
bulkÀn
 = 
Œ
;

1703 i‡(
	`sd¶í
(
c
->
quîybuf
)-c->
qb_pos
 < (
size_t
)(c->
bulkÀn
+2)) {

1710 i‡(
c
->
qb_pos
 == 0 &&

1711 
c
->
bulkÀn
 >
PROTO_MBULK_BIG_ARG
 &&

1712 
	`sd¶í
(
c
->
quîybuf
Ë=(
size_t
)(c->
bulkÀn
+2))

1714 
c
->
¨gv
[c->
¨gc
++] = 
	`¸óãObje˘
(
OBJ_STRING
,c->
quîybuf
);

1715 
	`sdsIn¸Lí
(
c
->
quîybuf
,-2);

1718 
c
->
quîybuf
 = 
	`sd¢ewÀn
(
SDS_NOINIT
,c->
bulkÀn
+2);

1719 
	`sds˛ór
(
c
->
quîybuf
);

1721 
c
->
¨gv
[c->
¨gc
++] =

1722 
	`¸óãSåögObje˘
(
c
->
quîybuf
+c->
qb_pos
,c->
bulkÀn
);

1723 
c
->
qb_pos
 +c->
bulkÀn
+2;

1725 
c
->
bulkÀn
 = -1;

1726 
c
->
mu…ibulkÀn
--;

1731 i‡(
c
->
mu…ibulkÀn
 =0Ë 
C_OK
;

1734  
C_ERR
;

1735 
	}
}

1742 
	$comm™dPro˚s£d
(
˛õ¡
 *
c
) {

1743 
cmd_is_pög
 = 
c
->
cmd
 && c->cmd->
¥oc
 =
pögComm™d
;

1744 
¥ev_off£t
 = 
c
->
ª∂off
;

1745 i‡(
c
->
Êags
 & 
CLIENT_MASTER
 && !(c->Êag†& 
CLIENT_MULTI
)) {

1747 
c
->
ª∂off
 = c->
ªad_ª∂off
 - 
	`sd¶í
(c->
quîybuf
Ë+ c->
qb_pos
;

1754 i‡(!(
c
->
Êags
 & 
CLIENT_BLOCKED
) ||

1755 
c
->
bty≥
 !
BLOCKED_MODULE
)

1757 
	`ª£tClõ¡
(
c
);

1766 i‡(
c
->
Êags
 & 
CLIENT_MASTER
) {

1767 
≠∂õd
 = 
c
->
ª∂off
 - 
¥ev_off£t
;

1768 
¥ev_ma°î_ª∂_mónögful_off£t
 = 
£rvî
.
ma°î_ª∂_mónögful_off£t
;

1769 i‡(
≠∂õd
) {

1770 
	`ª∂iˇti⁄FìdSœvesFromMa°îSåóm
(
£rvî
.
¶aves
,

1771 
c
->
≥ndög_quîybuf
, 
≠∂õd
);

1772 
	`sd§™ge
(
c
->
≥ndög_quîybuf
,
≠∂õd
,-1);

1776 i‡(
cmd_is_pög
)

1777 
£rvî
.
ma°î_ª∂_mónögful_off£t
 = 
¥ev_ma°î_ª∂_mónögful_off£t
;

1779 
	}
}

1789 
	$¥o˚ssComm™dAndRe£tClõ¡
(
˛õ¡
 *
c
) {

1790 
dód˛õ¡
 = 0;

1791 
£rvî
.
cuºít_˛õ¡
 = 
c
;

1792 i‡(
	`¥o˚ssComm™d
(
c
Ë=
C_OK
) {

1793 
	`comm™dPro˚s£d
(
c
);

1795 i‡(
£rvî
.
cuºít_˛õ¡
 =
NULL
Ë
dód˛õ¡
 = 1;

1796 
£rvî
.
cuºít_˛õ¡
 = 
NULL
;

1800  
dód˛õ¡
 ? 
C_ERR
 : 
C_OK
;

1801 
	}
}

1807 
	$¥o˚ssI≈utBuf„r
(
˛õ¡
 *
c
) {

1809 
c
->
qb_pos
 < 
	`sd¶í
(c->
quîybuf
)) {

1811 i‡(!(
c
->
Êags
 & 
CLIENT_SLAVE
Ë&& 
	`˛õ¡sAªPau£d
()) ;

1814 i‡(
c
->
Êags
 & 
CLIENT_BLOCKED
) ;

1818 i‡(
c
->
Êags
 & 
CLIENT_PENDING_COMMAND
) ;

1824 i‡(
£rvî
.
lua_timedout
 && 
c
->
Êags
 & 
CLIENT_MASTER
) ;

1831 i‡(
c
->
Êags
 & (
CLIENT_CLOSE_AFTER_REPLY
|
CLIENT_CLOSE_ASAP
)) ;

1834 i‡(!
c
->
ªqty≥
) {

1835 i‡(
c
->
quîybuf
[c->
qb_pos
] == '*') {

1836 
c
->
ªqty≥
 = 
PROTO_REQ_MULTIBULK
;

1838 
c
->
ªqty≥
 = 
PROTO_REQ_INLINE
;

1842 i‡(
c
->
ªqty≥
 =
PROTO_REQ_INLINE
) {

1843 i‡(
	`¥o˚ssI∆öeBuf„r
(
c
Ë!
C_OK
) ;

1846 i‡(
£rvî
.
g›hî_íabÀd
 &&

1847 ((
c
->
¨gc
 =1 && ((*)(c->
¨gv
[0]->
±r
))[0] == '/') ||

1848 
c
->
¨gc
 == 0))

1850 
	`¥o˚ssG›hîReque°
(
c
);

1851 
	`ª£tClõ¡
(
c
);

1852 
c
->
Êags
 |
CLIENT_CLOSE_AFTER_REPLY
;

1855 } i‡(
c
->
ªqty≥
 =
PROTO_REQ_MULTIBULK
) {

1856 i‡(
	`¥o˚ssMu…ibulkBuf„r
(
c
Ë!
C_OK
) ;

1858 
	`£rvîP™ic
("UnknownÑequestÅype");

1862 i‡(
c
->
¨gc
 == 0) {

1863 
	`ª£tClõ¡
(
c
);

1868 i‡(
c
->
Êags
 & 
CLIENT_PENDING_READ
) {

1869 
c
->
Êags
 |
CLIENT_PENDING_COMMAND
;

1874 i‡(
	`¥o˚ssComm™dAndRe£tClõ¡
(
c
Ë=
C_ERR
) {

1884 i‡(
c
->
qb_pos
) {

1885 
	`sd§™ge
(
c
->
quîybuf
,c->
qb_pos
,-1);

1886 
c
->
qb_pos
 = 0;

1888 
	}
}

1890 
	$ªadQuîyFromClõ¡
(
c⁄√˘i⁄
 *
c⁄n
) {

1891 
˛õ¡
 *
c
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

1892 
ƒód
, 
ªadÀn
;

1893 
size_t
 
qbÀn
;

1897 i‡(
	`po°p⁄eClõ¡Ród
(
c
)) ;

1899 
ªadÀn
 = 
PROTO_IOBUF_LEN
;

1906 i‡(
c
->
ªqty≥
 =
PROTO_REQ_MULTIBULK
 && c->
mu…ibulkÀn
 && c->
bulkÀn
 != -1

1907 && 
c
->
bulkÀn
 >
PROTO_MBULK_BIG_ARG
)

1909 
ssize_t
 
ªmaöög
 = (
size_t
)(
c
->
bulkÀn
+2)-
	`sd¶í
(c->
quîybuf
);

1913 i‡(
ªmaöög
 > 0 &&Ñemaöög < 
ªadÀn
)Ñeadlen =Ñemaining;

1916 
qbÀn
 = 
	`sd¶í
(
c
->
quîybuf
);

1917 i‡(
c
->
quîybuf_≥ak
 < 
qbÀn
) c->querybuf_peak = qblen;

1918 
c
->
quîybuf
 = 
	`sdsMakeRoomF‹
(c->quîybuf, 
ªadÀn
);

1919 
ƒód
 = 
	`c⁄nRód
(
c
->
c⁄n
, c->
quîybuf
+
qbÀn
, 
ªadÀn
);

1920 i‡(
ƒód
 == -1) {

1921 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë=
CONN_STATE_CONNECTED
) {

1924 
	`£rvîLog
(
LL_VERBOSE
, "Ródög from clõ¡: %s",
	`c⁄nGëLa°Eº‹
(
c
->
c⁄n
));

1925 
	`‰ìClõ¡Async
(
c
);

1928 } i‡(
ƒód
 == 0) {

1929 
	`£rvîLog
(
LL_VERBOSE
, "Client closed connection");

1930 
	`‰ìClõ¡Async
(
c
);

1932 } i‡(
c
->
Êags
 & 
CLIENT_MASTER
) {

1936 
c
->
≥ndög_quîybuf
 = 
	`sdsˇéí
(c->pending_querybuf,

1937 
c
->
quîybuf
+
qbÀn
,
ƒód
);

1940 
	`sdsIn¸Lí
(
c
->
quîybuf
,
ƒód
);

1941 
c
->
œ°öãø˘i⁄
 = 
£rvî
.
unixtime
;

1942 i‡(
c
->
Êags
 & 
CLIENT_MASTER
Ëc->
ªad_ª∂off
 +
ƒód
;

1943 
£rvî
.
°©_√t_öput_byãs
 +
ƒód
;

1944 i‡(
	`sd¶í
(
c
->
quîybuf
Ë> 
£rvî
.
˛õ¡_max_quîybuf_Àn
) {

1945 
sds
 
ci
 = 
	`ˇtClõ¡InfoSåög
(
	`sd£m±y
(),
c
), 
byãs
 = sdsempty();

1947 
byãs
 = 
	`sdsˇåïr
(byãs,
c
->
quîybuf
,64);

1948 
	`£rvîLog
(
LL_WARNING
,"Closög clõ¡Åh©Ñóched max quîy buf„∏Àngth: %†(qbu‡öôü»byãs: %s)", 
ci
, 
byãs
);

1949 
	`sds‰ì
(
ci
);

1950 
	`sds‰ì
(
byãs
);

1951 
	`‰ìClõ¡Async
(
c
);

1957 
	`¥o˚ssI≈utBuf„r
(
c
);

1958 
	}
}

1960 
	$gëClõ¡sMaxBuf„rs
(*
l⁄ge°_ouçut_li°
,

1961 *
bigge°_öput_buf„r
) {

1962 
˛õ¡
 *
c
;

1963 
li°Node
 *
 
;

1964 
li°Iãr
 
li
;

1965 
lﬁ
 = 0, 
bib
 = 0;

1967 
	`li°Rewöd
(
£rvî
.
˛õ¡s
,&
li
);

1968 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

1969 
c
 = 
	`li°NodeVÆue
(
 
);

1971 i‡(
	`li°Lígth
(
c
->
ª∂y
Ë> 
lﬁ
)Üol =ÜistLength(c->reply);

1972 i‡(
	`sd¶í
(
c
->
quîybuf
Ë> 
bib
) bib = sdslen(c->querybuf);

1974 *
l⁄ge°_ouçut_li°
 = 
lﬁ
;

1975 *
bigge°_öput_buf„r
 = 
bib
;

1976 
	}
}

1989 
	$gíClõ¡PìrId
(
˛õ¡
 *˛õ¡, *
≥îid
,

1990 
size_t
 
≥îid_Àn
) {

1991 i‡(
˛õ¡
->
Êags
 & 
CLIENT_UNIX_SOCKET
) {

1993 
	`¢¥ötf
(
≥îid
,
≥îid_Àn
,"%s:0",
£rvî
.
unixsockë
);

1996 
	`c⁄nF‹m©Pìr
(
˛õ¡
->
c⁄n
,
≥îid
,
≥îid_Àn
);

1998 
	}
}

2004 *
	$gëClõ¡PìrId
(
˛õ¡
 *
c
) {

2005 
≥îid
[
NET_PEER_ID_LEN
];

2007 i‡(
c
->
≥îid
 =
NULL
) {

2008 
	`gíClõ¡PìrId
(
c
,
≥îid
,(peerid));

2009 
c
->
≥îid
 = 
	`sd¢ew
(peerid);

2011  
c
->
≥îid
;

2012 
	}
}

2016 
sds
 
	$ˇtClõ¡InfoSåög
(
sds
 
s
, 
˛õ¡
 *client) {

2017 
Êags
[16], 
evíts
[3], 
c⁄nöfo
[
CONN_INFO_LEN
], *
p
;

2019 
p
 = 
Êags
;

2020 i‡(
˛õ¡
->
Êags
 & 
CLIENT_SLAVE
) {

2021 i‡(
˛õ¡
->
Êags
 & 
CLIENT_MONITOR
)

2022 *
p
++ = 'O';

2024 *
p
++ = 'S';

2026 i‡(
˛õ¡
->
Êags
 & 
CLIENT_MASTER
Ë*
p
++ = 'M';

2027 i‡(
˛õ¡
->
Êags
 & 
CLIENT_PUBSUB
Ë*
p
++ = 'P';

2028 i‡(
˛õ¡
->
Êags
 & 
CLIENT_MULTI
Ë*
p
++ = 'x';

2029 i‡(
˛õ¡
->
Êags
 & 
CLIENT_BLOCKED
Ë*
p
++ = 'b';

2030 i‡(
˛õ¡
->
Êags
 & 
CLIENT_TRACKING
Ë*
p
++ = 't';

2031 i‡(
˛õ¡
->
Êags
 & 
CLIENT_TRACKING_BROKEN_REDIR
Ë*
p
++ = 'R';

2032 i‡(
˛õ¡
->
Êags
 & 
CLIENT_DIRTY_CAS
Ë*
p
++ = 'd';

2033 i‡(
˛õ¡
->
Êags
 & 
CLIENT_CLOSE_AFTER_REPLY
Ë*
p
++ = 'c';

2034 i‡(
˛õ¡
->
Êags
 & 
CLIENT_UNBLOCKED
Ë*
p
++ = 'u';

2035 i‡(
˛õ¡
->
Êags
 & 
CLIENT_CLOSE_ASAP
Ë*
p
++ = 'A';

2036 i‡(
˛õ¡
->
Êags
 & 
CLIENT_UNIX_SOCKET
Ë*
p
++ = 'U';

2037 i‡(
˛õ¡
->
Êags
 & 
CLIENT_READONLY
Ë*
p
++ = 'r';

2038 i‡(
p
 =
Êags
) *p++ = 'N';

2039 *
p
++ = '\0';

2041 
p
 = 
evíts
;

2042 i‡(
˛õ¡
->
c⁄n
) {

2043 i‡(
	`c⁄nHasRódH™dÀr
(
˛õ¡
->
c⁄n
)Ë*
p
++ = 'r';

2044 i‡(
	`c⁄nHasWrôeH™dÀr
(
˛õ¡
->
c⁄n
)Ë*
p
++ = 'w';

2046 *
p
 = '\0';

2047  
	`sdsˇtfmt
(
s
,

2049 (Ë
˛õ¡
->
id
,

2050 
	`gëClõ¡PìrId
(
˛õ¡
),

2051 
	`c⁄nGëInfo
(
˛õ¡
->
c⁄n
, 
c⁄nöfo
, (conninfo)),

2052 
˛õ¡
->
«me
 ? (*)˛õ¡->«me->
±r
 : "",

2053 ()(
£rvî
.
unixtime
 - 
˛õ¡
->
˘ime
),

2054 ()(
£rvî
.
unixtime
 - 
˛õ¡
->
œ°öãø˘i⁄
),

2055 
Êags
,

2056 
˛õ¡
->
db
->
id
,

2057 (Ë
	`di˘Size
(
˛õ¡
->
pubsub_ch™√ls
),

2058 (Ë
	`li°Lígth
(
˛õ¡
->
pubsub_∑âîns
),

2059 (
˛õ¡
->
Êags
 & 
CLIENT_MULTI
Ë? clõ¡->
m°©e
.
cou¡
 : -1,

2060 (Ë
	`sd¶í
(
˛õ¡
->
quîybuf
),

2061 (Ë
	`sdßvaû
(
˛õ¡
->
quîybuf
),

2062 (Ë
˛õ¡
->
buÂos
,

2063 (Ë
	`li°Lígth
(
˛õ¡
->
ª∂y
),

2064 (Ë
	`gëClõ¡OuçutBuf„rMem‹yUßge
(
˛õ¡
),

2065 
evíts
,

2066 
˛õ¡
->
œ°cmd
 ? clõ¡->œ°cmd->
«me
 : "NULL",

2067 
˛õ¡
->
u£r
 ? clõ¡->u£r->
«me
 : "(superuser)");

2068 
	}
}

2070 
sds
 
	$gëAŒClõ¡sInfoSåög
(
ty≥
) {

2071 
li°Node
 *
 
;

2072 
li°Iãr
 
li
;

2073 
˛õ¡
 *client;

2074 
sds
 
o
 = 
	`sd¢ewÀn
(
SDS_NOINIT
,200*
	`li°Lígth
(
£rvî
.
˛õ¡s
));

2075 
	`sds˛ór
(
o
);

2076 
	`li°Rewöd
(
£rvî
.
˛õ¡s
,&
li
);

2077 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2078 
˛õ¡
 = 
	`li°NodeVÆue
(
 
);

2079 i‡(
ty≥
 !-1 && 
	`gëClõ¡Ty≥
(
˛õ¡
) !=Åype) ;

2080 
o
 = 
	`ˇtClõ¡InfoSåög
(o,
˛õ¡
);

2081 
o
 = 
	`sdsˇéí
(o,"\n",1);

2083  
o
;

2084 
	}
}

2095 
	$˛õ¡SëNameOrRïly
(
˛õ¡
 *
c
, 
robj
 *
«me
) {

2096 
Àn
 = 
	`sd¶í
(
«me
->
±r
);

2097 *
p
 = 
«me
->
±r
;

2101 i‡(
Àn
 == 0) {

2102 i‡(
c
->
«me
Ë
	`de¸RefCou¡
(c->name);

2103 
c
->
«me
 = 
NULL
;

2104  
C_OK
;

2110 
j
 = 0; j < 
Àn
; j++) {

2111 i‡(
p
[
j
] < '!' ||Ö[j] > '~') {

2112 
	`addRïlyEº‹
(
c
,

2115  
C_ERR
;

2118 i‡(
c
->
«me
Ë
	`de¸RefCou¡
(c->name);

2119 
c
->
«me
 =Çame;

2120 
	`ö¸RefCou¡
(
«me
);

2121  
C_OK
;

2122 
	}
}

2124 
	$˛õ¡Comm™d
(
˛õ¡
 *
c
) {

2125 
li°Node
 *
 
;

2126 
li°Iãr
 
li
;

2128 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"help")) {

2129 c⁄° *
hñp
[] = {

2146 
NULL


2148 
	`addRïlyHñp
(
c
, 
hñp
);

2149 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"id"Ë&& c->
¨gc
 == 2) {

2151 
	`addRïlyL⁄gL⁄g
(
c
,c->
id
);

2152 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"list")) {

2154 
ty≥
 = -1;

2155 i‡(
c
->
¨gc
 =4 && !
	`°rˇ£cmp
(c->
¨gv
[2]->
±r
,"type")) {

2156 
ty≥
 = 
	`gëClõ¡Ty≥ByName
(
c
->
¨gv
[3]->
±r
);

2157 i‡(
ty≥
 == -1) {

2158 
	`addRïlyEº‹F‹m©
(
c
,"Unknown clientÅype '%s'",

2159 (*Ë
c
->
¨gv
[3]->
±r
);

2162 } i‡(
c
->
¨gc
 != 2) {

2163 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2166 
sds
 
o
 = 
	`gëAŒClõ¡sInfoSåög
(
ty≥
);

2167 
	`addRïlyVîb©im
(
c
,
o
,
	`sd¶í
(o),"txt");

2168 
	`sds‰ì
(
o
);

2169 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ª∂y"Ë&& c->
¨gc
 == 3) {

2171 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"on")) {

2172 
c
->
Êags
 &~(
CLIENT_REPLY_SKIP
|
CLIENT_REPLY_OFF
);

2173 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2174 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"off")) {

2175 
c
->
Êags
 |
CLIENT_REPLY_OFF
;

2176 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"skip")) {

2177 i‡(!(
c
->
Êags
 & 
CLIENT_REPLY_OFF
))

2178 
c
->
Êags
 |
CLIENT_REPLY_SKIP_NEXT
;

2180 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2183 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"kill")) {

2186 *
addr
 = 
NULL
;

2187 
u£r
 *u£∏
NULL
;

2188 
ty≥
 = -1;

2189 
uöt64_t
 
id
 = 0;

2190 
skùme
 = 1;

2191 
kûÀd
 = 0, 
˛o£_this_˛õ¡
 = 0;

2193 i‡(
c
->
¨gc
 == 3) {

2195 
addr
 = 
c
->
¨gv
[2]->
±r
;

2196 
skùme
 = 0;

2197 } i‡(
c
->
¨gc
 > 3) {

2198 
i
 = 2;

2201 
i
 < 
c
->
¨gc
) {

2202 
m‹órgs
 = 
c
->
¨gc
 > 
i
+1;

2204 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
]->
±r
,"id"Ë&& 
m‹órgs
) {

2205 
tmp
;

2207 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
i
+1],&
tmp
,
NULL
)

2208 !
C_OK
) ;

2209 
id
 = 
tmp
;

2210 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
]->
±r
,"ty≥"Ë&& 
m‹órgs
) {

2211 
ty≥
 = 
	`gëClõ¡Ty≥ByName
(
c
->
¨gv
[
i
+1]->
±r
);

2212 i‡(
ty≥
 == -1) {

2213 
	`addRïlyEº‹F‹m©
(
c
,"Unknown clientÅype '%s'",

2214 (*Ë
c
->
¨gv
[
i
+1]->
±r
);

2217 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
]->
±r
,"addr"Ë&& 
m‹órgs
) {

2218 
addr
 = 
c
->
¨gv
[
i
+1]->
±r
;

2219 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
]->
±r
,"u£r"Ë&& 
m‹órgs
) {

2220 
u£r
 = 
	`ACLGëU£rByName
(
c
->
¨gv
[
i
+1]->
±r
,

2221 
	`sd¶í
(
c
->
¨gv
[
i
+1]->
±r
));

2222 i‡(
u£r
 =
NULL
) {

2223 
	`addRïlyEº‹F‹m©
(
c
,"No such user '%s'",

2224 (*Ë
c
->
¨gv
[
i
+1]->
±r
);

2227 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
]->
±r
,"skùme"Ë&& 
m‹órgs
) {

2228 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
+1]->
±r
,"yes")) {

2229 
skùme
 = 1;

2230 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
i
+1]->
±r
,"no")) {

2231 
skùme
 = 0;

2233 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2237 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2240 
i
 += 2;

2243 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2248 
	`li°Rewöd
(
£rvî
.
˛õ¡s
,&
li
);

2249 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2250 
˛õ¡
 *˛õ¡ = 
	`li°NodeVÆue
(
 
);

2251 i‡(
addr
 && 
	`°rcmp
(
	`gëClõ¡PìrId
(
˛õ¡
),addr) != 0) ;

2252 i‡(
ty≥
 !-1 && 
	`gëClõ¡Ty≥
(
˛õ¡
) !=Åype) ;

2253 i‡(
id
 !0 && 
˛õ¡
->id != id) ;

2254 i‡(
u£r
 && 
˛õ¡
->user != user) ;

2255 i‡(
c
 =
˛õ¡
 && 
skùme
) ;

2258 i‡(
c
 =
˛õ¡
) {

2259 
˛o£_this_˛õ¡
 = 1;

2261 
	`‰ìClõ¡
(
˛õ¡
);

2263 
kûÀd
++;

2267 i‡(
c
->
¨gc
 == 3) {

2268 i‡(
kûÀd
 == 0)

2269 
	`addRïlyEº‹
(
c
,"No such client");

2271 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2273 
	`addRïlyL⁄gL⁄g
(
c
,
kûÀd
);

2278 i‡(
˛o£_this_˛õ¡
Ë
c
->
Êags
 |
CLIENT_CLOSE_AFTER_REPLY
;

2279 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"unblock"Ë&& (c->
¨gc
 == 3 ||

2280 
c
->
¨gc
 == 4))

2283 
id
;

2284 
unblock_îr‹
 = 0;

2286 i‡(
c
->
¨gc
 == 4) {

2287 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[3]->
±r
,"timeout")) {

2288 
unblock_îr‹
 = 0;

2289 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[3]->
±r
,"error")) {

2290 
unblock_îr‹
 = 1;

2292 
	`addRïlyEº‹
(
c
,

2297 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
id
,
NULL
)

2298 !
C_OK
) ;

2299 
˛õ¡
 *
èrgë
 = 
	`lookupClõ¡ByID
(
id
);

2300 i‡(
èrgë
 &&Å¨gë->
Êags
 & 
CLIENT_BLOCKED
) {

2301 i‡(
unblock_îr‹
)

2302 
	`addRïlyEº‹
(
èrgë
,

2305 
	`ª∂yToBlockedClõ¡TimedOut
(
èrgë
);

2306 
	`unblockClõ¡
(
èrgë
);

2307 
	`addRïly
(
c
,
sh¨ed
.
c⁄e
);

2309 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

2311 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"£äame"Ë&& c->
¨gc
 == 3) {

2313 i‡(
	`˛õ¡SëNameOrRïly
(
c
,c->
¨gv
[2]Ë=
C_OK
)

2314 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2315 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"gë«me"Ë&& c->
¨gc
 == 2) {

2317 i‡(
c
->
«me
)

2318 
	`addRïlyBulk
(
c
,c->
«me
);

2320 
	`addRïlyNuŒ
(
c
);

2321 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"∑u£"Ë&& c->
¨gc
 == 3) {

2323 
duøti⁄
;

2325 i‡(
	`gëTimeoutFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
duøti⁄
,

2326 
UNIT_MILLISECONDS
Ë!
C_OK
) ;

2327 
	`∑u£Clõ¡s
(
duøti⁄
);

2328 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2329 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"åackög"Ë&& c->
¨gc
 >= 3) {

2332 
ªdú
 = 0;

2333 
uöt64_t
 
›ti⁄s
 = 0;

2334 
robj
 **
¥efix
 = 
NULL
;

2335 
size_t
 
num¥efix
 = 0;

2338 
j
 = 3; j < 
c
->
¨gc
; j++) {

2339 
m‹órgs
 = (
c
->
¨gc
-1Ë- 
j
;

2341 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"ªdúe˘"Ë&& 
m‹órgs
) {

2342 
j
++;

2343 i‡(
ªdú
 != 0) {

2344 
	`addRïlyEº‹
(
c
,"A client can onlyÑedirectÅoá single "

2346 
	`z‰ì
(
¥efix
);

2350 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
],&
ªdú
,
NULL
) !=

2351 
C_OK
)

2353 
	`z‰ì
(
¥efix
);

2359 i‡(
	`lookupClõ¡ByID
(
ªdú
Ë=
NULL
) {

2360 
	`addRïlyEº‹
(
c
,"The client ID you wantÑedirectÅo "

2362 
	`z‰ì
(
¥efix
);

2365 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"bcast")) {

2366 
›ti⁄s
 |
CLIENT_TRACKING_BCAST
;

2367 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"optin")) {

2368 
›ti⁄s
 |
CLIENT_TRACKING_OPTIN
;

2369 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"optout")) {

2370 
›ti⁄s
 |
CLIENT_TRACKING_OPTOUT
;

2371 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"noloop")) {

2372 
›ti⁄s
 |
CLIENT_TRACKING_NOLOOP
;

2373 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"¥efix"Ë&& 
m‹órgs
) {

2374 
j
++;

2375 
¥efix
 = 
	`zªÆloc
’ªfix,(
robj
*)*(
num¥efix
+1));

2376 
¥efix
[
num¥efix
++] = 
c
->
¨gv
[
j
];

2378 
	`z‰ì
(
¥efix
);

2379 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2385 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"on")) {

2388 i‡(!(
›ti⁄s
 & 
CLIENT_TRACKING_BCAST
Ë&& 
num¥efix
) {

2389 
	`addRïlyEº‹
(
c
,

2391 
	`z‰ì
(
¥efix
);

2395 i‡(
c
->
Êags
 & 
CLIENT_TRACKING
) {

2396 
ﬁdbˇ°
 = !!(
c
->
Êags
 & 
CLIENT_TRACKING_BCAST
);

2397 
√wbˇ°
 = !!(
›ti⁄s
 & 
CLIENT_TRACKING_BCAST
);

2398 i‡(
ﬁdbˇ°
 !
√wbˇ°
) {

2399 
	`addRïlyEº‹
(
c
,

2403 
	`z‰ì
(
¥efix
);

2408 i‡(
›ti⁄s
 & 
CLIENT_TRACKING_BCAST
 &&

2409 
›ti⁄s
 & (
CLIENT_TRACKING_OPTIN
|
CLIENT_TRACKING_OPTOUT
))

2411 
	`addRïlyEº‹
(
c
,

2413 
	`z‰ì
(
¥efix
);

2417 i‡(
›ti⁄s
 & 
CLIENT_TRACKING_OPTIN
 && o±i⁄†& 
CLIENT_TRACKING_OPTOUT
)

2419 
	`addRïlyEº‹
(
c
,

2421 
	`z‰ì
(
¥efix
);

2425 i‡((
›ti⁄s
 & 
CLIENT_TRACKING_OPTIN
 && 
c
->
Êags
 & 
CLIENT_TRACKING_OPTOUT
) ||

2426 (
›ti⁄s
 & 
CLIENT_TRACKING_OPTOUT
 && 
c
->
Êags
 & 
CLIENT_TRACKING_OPTIN
))

2428 
	`addRïlyEº‹
(
c
,

2432 
	`z‰ì
(
¥efix
);

2436 
	`íabÀTøckög
(
c
,
ªdú
,
›ti⁄s
,
¥efix
,
num¥efix
);

2437 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"off")) {

2438 
	`dißbÀTøckög
(
c
);

2440 
	`z‰ì
(
¥efix
);

2441 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2444 
	`z‰ì
(
¥efix
);

2445 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2446 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ˇchög"Ë&& c->
¨gc
 >= 3) {

2447 i‡(!(
c
->
Êags
 & 
CLIENT_TRACKING
)) {

2448 
	`addRïlyEº‹
(
c
,"CLIENT CACHING can be called only whenÅhe "

2454 *
›t
 = 
c
->
¨gv
[2]->
±r
;

2455 i‡(!
	`°rˇ£cmp
(
›t
,"yes")) {

2456 i‡(
c
->
Êags
 & 
CLIENT_TRACKING_OPTIN
) {

2457 
c
->
Êags
 |
CLIENT_TRACKING_CACHING
;

2459 
	`addRïlyEº‹
(
c
,"CLIENT CACHING YES is only valid whenÅracking isÉnabled in OPTIN mode.");

2462 } i‡(!
	`°rˇ£cmp
(
›t
,"no")) {

2463 i‡(
c
->
Êags
 & 
CLIENT_TRACKING_OPTOUT
) {

2464 
c
->
Êags
 |
CLIENT_TRACKING_CACHING
;

2466 
	`addRïlyEº‹
(
c
,"CLIENT CACHING NO is only valid whenÅracking isÉnabled in OPTOUT mode.");

2470 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2475 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2476 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"gëªdú"Ë&& c->
¨gc
 == 2) {

2478 i‡(
c
->
Êags
 & 
CLIENT_TRACKING
) {

2479 
	`addRïlyL⁄gL⁄g
(
c
,c->
˛õ¡_åackög_ªdúe˘i⁄
);

2481 
	`addRïlyL⁄gL⁄g
(
c
,-1);

2484 
	`addRïlyEº‹F‹m©
(
c
, "Unknow¿subcomm™d o∏wr⁄gÇumbî o‡¨gumít†f‹ '%s'. Try CLIENT HELP", (*)c->
¨gv
[1]->
±r
);

2486 
	}
}

2489 
	$hñloComm™d
(
˛õ¡
 *
c
) {

2490 
vî
;

2492 i‡(
	`gëL⁄gL⁄gFromObje˘
(
c
->
¨gv
[1],&
vî
Ë!
C_OK
 ||

2493 
vî
 < 2 || ver > 3)

2495 
	`addRïlyEº‹
(
c
,"-NOPROTO unsupportedÖrotocol version");

2499 
j
 = 2; j < 
c
->
¨gc
; j++) {

2500 
m‹órgs
 = (
c
->
¨gc
-1Ë- 
j
;

2501 c⁄° *
›t
 = 
c
->
¨gv
[
j
]->
±r
;

2502 i‡(!
	`°rˇ£cmp
(
›t
,"AUTH"Ë&& 
m‹órgs
 >= 2) {

2503 i‡(
	`ACLAuthítiˇãU£r
(
c
, c->
¨gv
[
j
+1], c->¨gv[j+2]Ë=
C_ERR
) {

2504 
	`addRïlyEº‹
(
c
,"-WRONGPASS invalid username-passwordÖair");

2507 
j
 += 2;

2508 } i‡(!
	`°rˇ£cmp
(
›t
,"SETNAME"Ë&& 
m‹órgs
) {

2509 i‡(
	`˛õ¡SëNameOrRïly
(
c
, c->
¨gv
[
j
+1]Ë=
C_ERR
) ;

2510 
j
++;

2512 
	`addRïlyEº‹F‹m©
(
c
,"Sy¡axÉº‹ i¿HELLO o±i⁄ '%s'",
›t
);

2518 i‡(!
c
->
authítiˇãd
) {

2519 
	`addRïlyEº‹
(
c
,"-NOAUTH HELLO must be called withÅhe clientálready "

2527 
c
->
ª•
 = 
vî
;

2528 
	`addRïlyM≠Lí
(
c
,6 + !
£rvî
.
£¡öñ_mode
);

2530 
	`addRïlyBulkCSåög
(
c
,"server");

2531 
	`addRïlyBulkCSåög
(
c
,"redis");

2533 
	`addRïlyBulkCSåög
(
c
,"version");

2534 
	`addRïlyBulkCSåög
(
c
,
REDIS_VERSION
);

2536 
	`addRïlyBulkCSåög
(
c
,"proto");

2537 
	`addRïlyL⁄gL⁄g
(
c
,3);

2539 
	`addRïlyBulkCSåög
(
c
,"id");

2540 
	`addRïlyL⁄gL⁄g
(
c
,c->
id
);

2542 
	`addRïlyBulkCSåög
(
c
,"mode");

2543 i‡(
£rvî
.
£¡öñ_mode
Ë
	`addRïlyBulkCSåög
(
c
,"sentinel");

2544 i‡(
£rvî
.
˛u°î_íabÀd
Ë
	`addRïlyBulkCSåög
(
c
,"cluster");

2545 
	`addRïlyBulkCSåög
(
c
,"standalone");

2547 i‡(!
£rvî
.
£¡öñ_mode
) {

2548 
	`addRïlyBulkCSåög
(
c
,"role");

2549 
	`addRïlyBulkCSåög
(
c
,
£rvî
.
ma°îho°
 ? "replica" : "master");

2552 
	`addRïlyBulkCSåög
(
c
,"modules");

2553 
	`addRïlyLﬂdedModuÀs
(
c
);

2554 
	}
}

2565 
	$£curôyW¨nögComm™d
(
˛õ¡
 *
c
) {

2566 
time_t
 
logged_time
;

2567 
time_t
 
now
 = 
	`time
(
NULL
);

2569 i‡(
	`œbs
(
now
-
logged_time
) > 60) {

2570 
	`£rvîLog
(
LL_WARNING
,"Possible SECURITY ATTACK detected. ItÜooksÜike somebody is sending POST or Host: commandsÅo Redis. This isÜikely dueÅoánáttackeráttemptingÅo use Cross Protocol ScriptingÅo compromise your Redis instance. Connectionáborted.");

2571 
logged_time
 = 
now
;

2573 
	`‰ìClõ¡Async
(
c
);

2574 
	}
}

2579 
	$ªwrôeClõ¡Comm™dVe˘‹
(
˛õ¡
 *
c
, 
¨gc
, ...) {

2580 
va_li°
 
≠
;

2581 
j
;

2582 
robj
 **
¨gv
;

2584 
¨gv
 = 
	`zmÆloc
((
robj
*)*
¨gc
);

2585 
	`va_°¨t
(
≠
,
¨gc
);

2586 
j
 = 0; j < 
¨gc
; j++) {

2587 
robj
 *
a
;

2589 
a
 = 
	`va_¨g
(
≠
, 
robj
*);

2590 
¨gv
[
j
] = 
a
;

2591 
	`ö¸RefCou¡
(
a
);

2596 
j
 = 0; j < 
c
->
¨gc
; j++Ë
	`de¸RefCou¡
(c->
¨gv
[j]);

2597 
	`z‰ì
(
c
->
¨gv
);

2599 
c
->
¨gv
 =árgv;

2600 
c
->
¨gc
 =árgc;

2601 
c
->
cmd
 = 
	`lookupComm™dOrOrigöÆ
(c->
¨gv
[0]->
±r
);

2602 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,c->
cmd
 != NULL);

2603 
	`va_íd
(
≠
);

2604 
	}
}

2607 
	$ª∂a˚Clõ¡Comm™dVe˘‹
(
˛õ¡
 *
c
, 
¨gc
, 
robj
 **
¨gv
) {

2608 
	`‰ìClõ¡Argv
(
c
);

2609 
	`z‰ì
(
c
->
¨gv
);

2610 
c
->
¨gv
 =árgv;

2611 
c
->
¨gc
 =árgc;

2612 
c
->
cmd
 = 
	`lookupComm™dOrOrigöÆ
(c->
¨gv
[0]->
±r
);

2613 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,c->
cmd
 != NULL);

2614 
	}
}

2627 
	$ªwrôeClõ¡Comm™dArgumít
(
˛õ¡
 *
c
, 
i
, 
robj
 *
√wvÆ
) {

2628 
robj
 *
ﬁdvÆ
;

2630 i‡(
i
 >
c
->
¨gc
) {

2631 
c
->
¨gv
 = 
	`zªÆloc
(c->¨gv,(
robj
*)*(
i
+1));

2632 
c
->
¨gc
 = 
i
+1;

2633 
c
->
¨gv
[
i
] = 
NULL
;

2635 
ﬁdvÆ
 = 
c
->
¨gv
[
i
];

2636 
c
->
¨gv
[
i
] = 
√wvÆ
;

2637 
	`ö¸RefCou¡
(
√wvÆ
);

2638 i‡(
ﬁdvÆ
Ë
	`de¸RefCou¡
(oldval);

2641 i‡(
i
 == 0) {

2642 
c
->
cmd
 = 
	`lookupComm™dOrOrigöÆ
(c->
¨gv
[0]->
±r
);

2643 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,c->
cmd
 != NULL);

2645 
	}
}

2653 
	$gëClõ¡OuçutBuf„rMem‹yUßge
(
˛õ¡
 *
c
) {

2654 
li°_ôem_size
 = (
li°Node
Ë+ (
˛õ¡RïlyBlock
);

2655  
c
->
ª∂y_byãs
 + (
li°_ôem_size
*
	`li°Lígth
(c->
ª∂y
));

2656 
	}
}

2667 
	$gëClõ¡Ty≥
(
˛õ¡
 *
c
) {

2668 i‡(
c
->
Êags
 & 
CLIENT_MASTER
Ë 
CLIENT_TYPE_MASTER
;

2671 i‡((
c
->
Êags
 & 
CLIENT_SLAVE
Ë&& !(c->Êag†& 
CLIENT_MONITOR
))

2672  
CLIENT_TYPE_SLAVE
;

2673 i‡(
c
->
Êags
 & 
CLIENT_PUBSUB
Ë 
CLIENT_TYPE_PUBSUB
;

2674  
CLIENT_TYPE_NORMAL
;

2675 
	}
}

2677 
	$gëClõ¡Ty≥ByName
(*
«me
) {

2678 i‡(!
	`°rˇ£cmp
(
«me
,"n‹mÆ")Ë 
CLIENT_TYPE_NORMAL
;

2679 i‡(!
	`°rˇ£cmp
(
«me
,"¶ave")Ë 
CLIENT_TYPE_SLAVE
;

2680 i‡(!
	`°rˇ£cmp
(
«me
,"ª∂iˇ")Ë 
CLIENT_TYPE_SLAVE
;

2681 i‡(!
	`°rˇ£cmp
(
«me
,"pubsub")Ë 
CLIENT_TYPE_PUBSUB
;

2682 i‡(!
	`°rˇ£cmp
(
«me
,"ma°î")Ë 
CLIENT_TYPE_MASTER
;

2684 
	}
}

2686 *
	$gëClõ¡Ty≥Name
(
˛ass
) {

2687 
˛ass
) {

2688 
CLIENT_TYPE_NORMAL
:  "normal";

2689 
CLIENT_TYPE_SLAVE
:  "slave";

2690 
CLIENT_TYPE_PUBSUB
:  "pubsub";

2691 
CLIENT_TYPE_MASTER
:  "master";

2692 :  
NULL
;

2694 
	}
}

2702 
	$checkClõ¡OuçutBuf„rLimôs
(
˛õ¡
 *
c
) {

2703 
so·
 = 0, 
h¨d
 = 0, 
˛ass
;

2704 
u£d_mem
 = 
	`gëClõ¡OuçutBuf„rMem‹yUßge
(
c
);

2706 
˛ass
 = 
	`gëClõ¡Ty≥
(
c
);

2709 i‡(
˛ass
 =
CLIENT_TYPE_MASTER
Ë˛as†
CLIENT_TYPE_NORMAL
;

2711 i‡(
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
h¨d_limô_byãs
 &&

2712 
u£d_mem
 >
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
h¨d_limô_byãs
)

2713 
h¨d
 = 1;

2714 i‡(
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
so·_limô_byãs
 &&

2715 
u£d_mem
 >
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
so·_limô_byãs
)

2716 
so·
 = 1;

2720 i‡(
so·
) {

2721 i‡(
c
->
obuf_so·_limô_ªached_time
 == 0) {

2722 
c
->
obuf_so·_limô_ªached_time
 = 
£rvî
.
unixtime
;

2723 
so·
 = 0;

2725 
time_t
 
ñ≠£d
 = 
£rvî
.
unixtime
 - 
c
->
obuf_so·_limô_ªached_time
;

2727 i‡(
ñ≠£d
 <=

2728 
£rvî
.
˛õ¡_obuf_limôs
[
˛ass
].
so·_limô_£c⁄ds
) {

2729 
so·
 = 0;

2735 
c
->
obuf_so·_limô_ªached_time
 = 0;

2737  
so·
 || 
h¨d
;

2738 
	}
}

2747 
	$asyncClo£Clõ¡OnOuçutBuf„rLimôRóched
(
˛õ¡
 *
c
) {

2748 i‡(!
c
->
c⁄n
) ;

2749 
	`£rvîAs£π
(
c
->
ª∂y_byãs
 < 
SIZE_MAX
-(1024*64));

2750 i‡(
c
->
ª∂y_byãs
 =0 || c->
Êags
 & 
CLIENT_CLOSE_ASAP
) ;

2751 i‡(
	`checkClõ¡OuçutBuf„rLimôs
(
c
)) {

2752 
sds
 
˛õ¡
 = 
	`ˇtClõ¡InfoSåög
(
	`sd£m±y
(),
c
);

2754 
	`‰ìClõ¡Async
(
c
);

2755 
	`£rvîLog
(
LL_WARNING
,"Clõ¡ %†scheduÀdÅÿbê˛o£d ASAP f‹ ovîcomög o‡ouçuàbuf„∏limôs.", 
˛õ¡
);

2756 
	`sds‰ì
(
˛õ¡
);

2758 
	}
}

2764 
	$ÊushSœvesOuçutBuf„rs
() {

2765 
li°Iãr
 
li
;

2766 
li°Node
 *
 
;

2768 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

2769 (
 
 = 
	`li°Next
(&
li
))) {

2770 
˛õ¡
 *
¶ave
 = 
	`li°NodeVÆue
(
 
);

2771 
ˇn_ª˚ive_wrôes
 = 
	`c⁄nHasWrôeH™dÀr
(
¶ave
->
c⁄n
) ||

2772 (
¶ave
->
Êags
 & 
CLIENT_PENDING_WRITE
);

2788 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_ONLINE
 &&

2789 
ˇn_ª˚ive_wrôes
 &&

2790 !
¶ave
->
ª∂_put_⁄löe_⁄_ack
 &&

2791 
	`˛õ¡HasPídögRïlõs
(
¶ave
))

2793 
	`wrôeToClõ¡
(
¶ave
,0);

2796 
	}
}

2815 
	$∑u£Clõ¡s
(
m°ime_t
 
íd
) {

2816 i‡(!
£rvî
.
˛õ¡s_∑u£d
 || 
íd
 > sîvî.
˛õ¡s_∑u£_íd_time
)

2817 
£rvî
.
˛õ¡s_∑u£_íd_time
 = 
íd
;

2818 
£rvî
.
˛õ¡s_∑u£d
 = 1;

2819 
	}
}

2823 
	$˛õ¡sAªPau£d
() {

2824 i‡(
£rvî
.
˛õ¡s_∑u£d
 &&

2825 
£rvî
.
˛õ¡s_∑u£_íd_time
 < sîvî.
m°ime
)

2827 
li°Node
 *
 
;

2828 
li°Iãr
 
li
;

2829 
˛õ¡
 *
c
;

2831 
£rvî
.
˛õ¡s_∑u£d
 = 0;

2835 
	`li°Rewöd
(
£rvî
.
˛õ¡s
,&
li
);

2836 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2837 
c
 = 
	`li°NodeVÆue
(
 
);

2841 i‡(
c
->
Êags
 & (
CLIENT_SLAVE
|
CLIENT_BLOCKED
)) ;

2842 
	`queueClõ¡F‹Rïro˚ssög
(
c
);

2845  
£rvî
.
˛õ¡s_∑u£d
;

2846 
	}
}

2860 
	$¥o˚ssEvítsWhûeBlocked
() {

2861 
ôî©i⁄s
 = 4;

2867 
Pro˚ssögEvítsWhûeBlocked
 = 1;

2868 
ôî©i⁄s
--) {

2869 
°¨tvÆ
 = 
£rvî
.
evíts_¥o˚s£d_whûe_blocked
;

2870 
´_evíts
 = 
	`´Pro˚ssEvíts
(
£rvî
.
ñ
,

2871 
AE_FILE_EVENTS
|
AE_DONT_WAIT
|

2872 
AE_CALL_BEFORE_SLEEP
|
AE_CALL_AFTER_SLEEP
);

2875 
£rvî
.
evíts_¥o˚s£d_whûe_blocked
 +
´_evíts
;

2876 
evíts
 = 
£rvî
.
evíts_¥o˚s£d_whûe_blocked
 - 
°¨tvÆ
;

2877 i‡(!
evíts
) ;

2879 
Pro˚ssögEvítsWhûeBlocked
 = 0;

2880 
	}
}

2886 
	gtio_debug
 = 0;

2888 
	#IO_THREADS_MAX_NUM
 128

	)

2889 
	#IO_THREADS_OP_READ
 0

	)

2890 
	#IO_THREADS_OP_WRITE
 1

	)

2892 
±hªad_t
 
	gio_thªads
[
IO_THREADS_MAX_NUM
];

2893 
±hªad_muãx_t
 
	gio_thªads_muãx
[
IO_THREADS_MAX_NUM
];

2894 
_Atomic
 
	gio_thªads_≥ndög
[
IO_THREADS_MAX_NUM
];

2895 
	gio_thªads_a˘ive
;

2896 
	gio_thªads_›
;

2901 
li°
 *
	gio_thªads_li°
[
IO_THREADS_MAX_NUM
];

2903 *
	$IOThªadMaö
(*
myid
) {

2906 
id
 = ()
myid
;

2907 
thd«me
[16];

2909 
	`¢¥ötf
(
thd«me
, —hd«me), "io_thd_%ld", 
id
);

2910 
	`ªdis_£t_thªad_tôÀ
(
thd«me
);

2911 
	`ªdisSëCpuAfföôy
(
£rvî
.
£rvî_˝uli°
);

2915 
j
 = 0; j < 1000000; j++) {

2916 i‡(
io_thªads_≥ndög
[
id
] != 0) ;

2920 i‡(
io_thªads_≥ndög
[
id
] == 0) {

2921 
	`±hªad_muãx_lock
(&
io_thªads_muãx
[
id
]);

2922 
	`±hªad_muãx_u∆ock
(&
io_thªads_muãx
[
id
]);

2926 
	`£rvîAs£π
(
io_thªads_≥ndög
[
id
] != 0);

2928 i‡(
tio_debug
Ë
	`¥ötf
("[%ld] %dÅÿh™dÀ\n", 
id
, ()
	`li°Lígth
(
io_thªads_li°
[id]));

2932 
li°Iãr
 
li
;

2933 
li°Node
 *
 
;

2934 
	`li°Rewöd
(
io_thªads_li°
[
id
],&
li
);

2935 (
 
 = 
	`li°Next
(&
li
))) {

2936 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

2937 i‡(
io_thªads_›
 =
IO_THREADS_OP_WRITE
) {

2938 
	`wrôeToClõ¡
(
c
,0);

2939 } i‡(
io_thªads_›
 =
IO_THREADS_OP_READ
) {

2940 
	`ªadQuîyFromClõ¡
(
c
->
c⁄n
);

2942 
	`£rvîP™ic
("io_threads_op value is unknown");

2945 
	`li°Em±y
(
io_thªads_li°
[
id
]);

2946 
io_thªads_≥ndög
[
id
] = 0;

2948 i‡(
tio_debug
Ë
	`¥ötf
("[%ld] D⁄e\n", 
id
);

2950 
	}
}

2953 
	$öôThªadedIO
() {

2954 
io_thªads_a˘ive
 = 0;

2958 i‡(
£rvî
.
io_thªads_num
 == 1) ;

2960 i‡(
£rvî
.
io_thªads_num
 > 
IO_THREADS_MAX_NUM
) {

2961 
	`£rvîLog
(
LL_WARNING
,"Fatal:Åoo many I/OÅhreads configured. "

2962 "ThêmaximumÇumbî i†%d.", 
IO_THREADS_MAX_NUM
);

2963 
	`exô
(1);

2967 
i
 = 0; i < 
£rvî
.
io_thªads_num
; i++) {

2969 
io_thªads_li°
[
i
] = 
	`li°Cª©e
();

2970 i‡(
i
 == 0) ;

2973 
±hªad_t
 
tid
;

2974 
	`±hªad_muãx_öô
(&
io_thªads_muãx
[
i
],
NULL
);

2975 
io_thªads_≥ndög
[
i
] = 0;

2976 
	`±hªad_muãx_lock
(&
io_thªads_muãx
[
i
]);

2977 i‡(
	`±hªad_¸óã
(&
tid
,
NULL
,
IOThªadMaö
,(*)()
i
) != 0) {

2978 
	`£rvîLog
(
LL_WARNING
,"Fatal: Can't initialize IOÅhread.");

2979 
	`exô
(1);

2981 
io_thªads
[
i
] = 
tid
;

2983 
	}
}

2985 
	$°¨tThªadedIO
() {

2986 i‡(
tio_debug
Ë{ 
	`¥ötf
("S"); 
	`fÊush
(
°dout
); }

2987 i‡(
tio_debug
Ë
	`¥ötf
("--- STARTING THREADED IO ---\n");

2988 
	`£rvîAs£π
(
io_thªads_a˘ive
 == 0);

2989 
j
 = 1; j < 
£rvî
.
io_thªads_num
; j++)

2990 
	`±hªad_muãx_u∆ock
(&
io_thªads_muãx
[
j
]);

2991 
io_thªads_a˘ive
 = 1;

2992 
	}
}

2994 
	$°›ThªadedIO
() {

2997 
	`h™dÀClõ¡sWôhPídögRódsUsögThªads
();

2998 i‡(
tio_debug
Ë{ 
	`¥ötf
("E"); 
	`fÊush
(
°dout
); }

2999 i‡(
tio_debug
Ë
	`¥ötf
("--- STOPPING THREADED IO [R%d] [W%d] ---\n",

3000 (Ë
	`li°Lígth
(
£rvî
.
˛õ¡s_≥ndög_ªad
),

3001 (Ë
	`li°Lígth
(
£rvî
.
˛õ¡s_≥ndög_wrôe
));

3002 
	`£rvîAs£π
(
io_thªads_a˘ive
 == 1);

3003 
j
 = 1; j < 
£rvî
.
io_thªads_num
; j++)

3004 
	`±hªad_muãx_lock
(&
io_thªads_muãx
[
j
]);

3005 
io_thªads_a˘ive
 = 0;

3006 
	}
}

3017 
	$°›ThªadedIOIfNìded
() {

3018 
≥ndög
 = 
	`li°Lígth
(
£rvî
.
˛õ¡s_≥ndög_wrôe
);

3021 i‡(
£rvî
.
io_thªads_num
 == 1)  1;

3023 i‡(
≥ndög
 < (
£rvî
.
io_thªads_num
*2)) {

3024 i‡(
io_thªads_a˘ive
Ë
	`°›ThªadedIO
();

3029 
	}
}

3031 
	$h™dÀClõ¡sWôhPídögWrôesUsögThªads
() {

3032 
¥o˚s£d
 = 
	`li°Lígth
(
£rvî
.
˛õ¡s_≥ndög_wrôe
);

3033 i‡(
¥o˚s£d
 == 0)  0;

3037 i‡(
£rvî
.
io_thªads_num
 =1 || 
	`°›ThªadedIOIfNìded
()) {

3038  
	`h™dÀClõ¡sWôhPídögWrôes
();

3042 i‡(!
io_thªads_a˘ive
Ë
	`°¨tThªadedIO
();

3044 i‡(
tio_debug
Ë
	`¥ötf
("%d TOTAL WRITEÖídög clõ¡s\n", 
¥o˚s£d
);

3047 
li°Iãr
 
li
;

3048 
li°Node
 *
 
;

3049 
	`li°Rewöd
(
£rvî
.
˛õ¡s_≥ndög_wrôe
,&
li
);

3050 
ôem_id
 = 0;

3051 (
 
 = 
	`li°Next
(&
li
))) {

3052 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

3053 
c
->
Êags
 &~
CLIENT_PENDING_WRITE
;

3054 
èrgë_id
 = 
ôem_id
 % 
£rvî
.
io_thªads_num
;

3055 
	`li°AddNodeTaû
(
io_thªads_li°
[
èrgë_id
],
c
);

3056 
ôem_id
++;

3061 
io_thªads_›
 = 
IO_THREADS_OP_WRITE
;

3062 
j
 = 1; j < 
£rvî
.
io_thªads_num
; j++) {

3063 
cou¡
 = 
	`li°Lígth
(
io_thªads_li°
[
j
]);

3064 
io_thªads_≥ndög
[
j
] = 
cou¡
;

3068 
	`li°Rewöd
(
io_thªads_li°
[0],&
li
);

3069 (
 
 = 
	`li°Next
(&
li
))) {

3070 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

3071 
	`wrôeToClõ¡
(
c
,0);

3073 
	`li°Em±y
(
io_thªads_li°
[0]);

3077 
≥ndög
 = 0;

3078 
j
 = 1; j < 
£rvî
.
io_thªads_num
; j++)

3079 
≥ndög
 +
io_thªads_≥ndög
[
j
];

3080 i‡(
≥ndög
 == 0) ;

3082 i‡(
tio_debug
Ë
	`¥ötf
("I/O WRITE AllÅhreads finshed\n");

3086 
	`li°Rewöd
(
£rvî
.
˛õ¡s_≥ndög_wrôe
,&
li
);

3087 (
 
 = 
	`li°Next
(&
li
))) {

3088 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

3092 i‡(
	`˛õ¡HasPídögRïlõs
(
c
) &&

3093 
	`c⁄nSëWrôeH™dÀr
(
c
->
c⁄n
, 
£ndRïlyToClõ¡
Ë=
AE_ERR
)

3095 
	`‰ìClõ¡Async
(
c
);

3098 
	`li°Em±y
(
£rvî
.
˛õ¡s_≥ndög_wrôe
);

3099  
¥o˚s£d
;

3100 
	}
}

3106 
	$po°p⁄eClõ¡Ród
(
˛õ¡
 *
c
) {

3107 i‡(
io_thªads_a˘ive
 &&

3108 
£rvî
.
io_thªads_do_ªads
 &&

3109 !
Pro˚ssögEvítsWhûeBlocked
 &&

3110 !(
c
->
Êags
 & (
CLIENT_MASTER
|
CLIENT_SLAVE
|
CLIENT_PENDING_READ
)))

3112 
c
->
Êags
 |
CLIENT_PENDING_READ
;

3113 
	`li°AddNodeHód
(
£rvî
.
˛õ¡s_≥ndög_ªad
,
c
);

3118 
	}
}

3126 
	$h™dÀClõ¡sWôhPídögRódsUsögThªads
() {

3127 i‡(!
io_thªads_a˘ive
 || !
£rvî
.
io_thªads_do_ªads
)  0;

3128 
¥o˚s£d
 = 
	`li°Lígth
(
£rvî
.
˛õ¡s_≥ndög_ªad
);

3129 i‡(
¥o˚s£d
 == 0)  0;

3131 i‡(
tio_debug
Ë
	`¥ötf
("%d TOTAL READÖídög clõ¡s\n", 
¥o˚s£d
);

3134 
li°Iãr
 
li
;

3135 
li°Node
 *
 
;

3136 
	`li°Rewöd
(
£rvî
.
˛õ¡s_≥ndög_ªad
,&
li
);

3137 
ôem_id
 = 0;

3138 (
 
 = 
	`li°Next
(&
li
))) {

3139 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

3140 
èrgë_id
 = 
ôem_id
 % 
£rvî
.
io_thªads_num
;

3141 
	`li°AddNodeTaû
(
io_thªads_li°
[
èrgë_id
],
c
);

3142 
ôem_id
++;

3147 
io_thªads_›
 = 
IO_THREADS_OP_READ
;

3148 
j
 = 1; j < 
£rvî
.
io_thªads_num
; j++) {

3149 
cou¡
 = 
	`li°Lígth
(
io_thªads_li°
[
j
]);

3150 
io_thªads_≥ndög
[
j
] = 
cou¡
;

3154 
	`li°Rewöd
(
io_thªads_li°
[0],&
li
);

3155 (
 
 = 
	`li°Next
(&
li
))) {

3156 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

3157 
	`ªadQuîyFromClõ¡
(
c
->
c⁄n
);

3159 
	`li°Em±y
(
io_thªads_li°
[0]);

3163 
≥ndög
 = 0;

3164 
j
 = 1; j < 
£rvî
.
io_thªads_num
; j++)

3165 
≥ndög
 +
io_thªads_≥ndög
[
j
];

3166 i‡(
≥ndög
 == 0) ;

3168 i‡(
tio_debug
Ë
	`¥ötf
("I/O READ AllÅhreads finshed\n");

3171 
	`li°Lígth
(
£rvî
.
˛õ¡s_≥ndög_ªad
)) {

3172 
 
 = 
	`li°Fú°
(
£rvî
.
˛õ¡s_≥ndög_ªad
);

3173 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

3174 
c
->
Êags
 &~
CLIENT_PENDING_READ
;

3175 
	`li°DñNode
(
£rvî
.
˛õ¡s_≥ndög_ªad
,
 
);

3177 i‡(
c
->
Êags
 & 
CLIENT_PENDING_COMMAND
) {

3178 
c
->
Êags
 &~
CLIENT_PENDING_COMMAND
;

3179 i‡(
	`¥o˚ssComm™dAndRe£tClõ¡
(
c
Ë=
C_ERR
) {

3186 
	`¥o˚ssI≈utBuf„r
(
c
);

3188  
¥o˚s£d
;

3189 
	}
}

	@notify.c

30 
	~"£rvî.h
"

40 
	$key•a˚EvítsSåögToFœgs
(*
˛as£s
) {

41 *
p
 = 
˛as£s
;

42 
c
, 
Êags
 = 0;

44 (
c
 = *
p
++) != '\0') {

45 
c
) {

46 'A': 
Êags
 |
NOTIFY_ALL
; ;

47 'g': 
Êags
 |
NOTIFY_GENERIC
; ;

48 '$': 
Êags
 |
NOTIFY_STRING
; ;

49 'l': 
Êags
 |
NOTIFY_LIST
; ;

50 's': 
Êags
 |
NOTIFY_SET
; ;

51 'h': 
Êags
 |
NOTIFY_HASH
; ;

52 'z': 
Êags
 |
NOTIFY_ZSET
; ;

53 'x': 
Êags
 |
NOTIFY_EXPIRED
; ;

54 'e': 
Êags
 |
NOTIFY_EVICTED
; ;

55 'K': 
Êags
 |
NOTIFY_KEYSPACE
; ;

56 'E': 
Êags
 |
NOTIFY_KEYEVENT
; ;

57 't': 
Êags
 |
NOTIFY_STREAM
; ;

58 'm': 
Êags
 |
NOTIFY_KEY_MISS
; ;

62  
Êags
;

63 
	}
}

69 
sds
 
	$key•a˚EvítsFœgsToSåög
(
Êags
) {

70 
sds
 
ªs
;

72 
ªs
 = 
	`sd£m±y
();

73 i‡((
Êags
 & 
NOTIFY_ALL
) == NOTIFY_ALL) {

74 
ªs
 = 
	`sdsˇéí
(res,"A",1);

76 i‡(
Êags
 & 
NOTIFY_GENERIC
Ë
ªs
 = 
	`sdsˇéí
(res,"g",1);

77 i‡(
Êags
 & 
NOTIFY_STRING
Ë
ªs
 = 
	`sdsˇéí
(res,"$",1);

78 i‡(
Êags
 & 
NOTIFY_LIST
Ë
ªs
 = 
	`sdsˇéí
(res,"l",1);

79 i‡(
Êags
 & 
NOTIFY_SET
Ë
ªs
 = 
	`sdsˇéí
(res,"s",1);

80 i‡(
Êags
 & 
NOTIFY_HASH
Ë
ªs
 = 
	`sdsˇéí
(res,"h",1);

81 i‡(
Êags
 & 
NOTIFY_ZSET
Ë
ªs
 = 
	`sdsˇéí
(res,"z",1);

82 i‡(
Êags
 & 
NOTIFY_EXPIRED
Ë
ªs
 = 
	`sdsˇéí
(res,"x",1);

83 i‡(
Êags
 & 
NOTIFY_EVICTED
Ë
ªs
 = 
	`sdsˇéí
(res,"e",1);

84 i‡(
Êags
 & 
NOTIFY_STREAM
Ë
ªs
 = 
	`sdsˇéí
(res,"t",1);

86 i‡(
Êags
 & 
NOTIFY_KEYSPACE
Ë
ªs
 = 
	`sdsˇéí
(res,"K",1);

87 i‡(
Êags
 & 
NOTIFY_KEYEVENT
Ë
ªs
 = 
	`sdsˇéí
(res,"E",1);

88 i‡(
Êags
 & 
NOTIFY_KEY_MISS
Ë
ªs
 = 
	`sdsˇéí
(res,"m",1);

89  
ªs
;

90 
	}
}

99 
	$nŸifyKey•a˚Evít
(
ty≥
, *
evít
, 
robj
 *
key
, 
dbid
) {

100 
sds
 
ch™
;

101 
robj
 *
ch™obj
, *
evítobj
;

102 
Àn
 = -1;

103 
buf
[24];

109 
	`moduÀNŸifyKey•a˚Evít
(
ty≥
, 
evít
, 
key
, 
dbid
);

112 i‡(!(
£rvî
.
nŸify_key•a˚_evíts
 & 
ty≥
)) ;

114 
evítobj
 = 
	`¸óãSåögObje˘
(
evít
,
	`°æí
(event));

117 i‡(
£rvî
.
nŸify_key•a˚_evíts
 & 
NOTIFY_KEYSPACE
) {

118 
ch™
 = 
	`sd¢ewÀn
("__keyspace@",11);

119 
Àn
 = 
	`Œ2°rög
(
buf
,(buf),
dbid
);

120 
ch™
 = 
	`sdsˇéí
(ch™, 
buf
, 
Àn
);

121 
ch™
 = 
	`sdsˇéí
(chan, "__:", 3);

122 
ch™
 = 
	`sdsˇtsds
(ch™, 
key
->
±r
);

123 
ch™obj
 = 
	`¸óãObje˘
(
OBJ_STRING
, 
ch™
);

124 
	`pubsubPublishMesßge
(
ch™obj
, 
evítobj
);

125 
	`de¸RefCou¡
(
ch™obj
);

129 i‡(
£rvî
.
nŸify_key•a˚_evíts
 & 
NOTIFY_KEYEVENT
) {

130 
ch™
 = 
	`sd¢ewÀn
("__keyevent@",11);

131 i‡(
Àn
 =-1ËÀ¿
	`Œ2°rög
(
buf
,(buf),
dbid
);

132 
ch™
 = 
	`sdsˇéí
(ch™, 
buf
, 
Àn
);

133 
ch™
 = 
	`sdsˇéí
(chan, "__:", 3);

134 
ch™
 = 
	`sdsˇtsds
(ch™, 
evítobj
->
±r
);

135 
ch™obj
 = 
	`¸óãObje˘
(
OBJ_STRING
, 
ch™
);

136 
	`pubsubPublishMesßge
(
ch™obj
, 
key
);

137 
	`de¸RefCou¡
(
ch™obj
);

139 
	`de¸RefCou¡
(
evítobj
);

140 
	}
}

	@object.c

31 
	~"£rvî.h
"

32 
	~<m©h.h
>

33 
	~<˘y≥.h
>

35 #ifde‡
__CYGWIN__


36 
	#°πﬁd
(
a
,
b
Ë(()
	`°πod
(◊),(b)))

	)

41 
robj
 *
	$¸óãObje˘
(
ty≥
, *
±r
) {

42 
robj
 *
o
 = 
	`zmÆloc
((*o));

43 
o
->
ty≥
 =Åype;

44 
o
->
ícodög
 = 
OBJ_ENCODING_RAW
;

45 
o
->
±r
 =Ötr;

46 
o
->
ªfcou¡
 = 1;

50 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
) {

51 
o
->
Ãu
 = (
	`LFUGëTimeInMöuãs
()<<8Ë| 
LFU_INIT_VAL
;

53 
o
->
Ãu
 = 
	`LRU_CLOCK
();

55  
o
;

56 
	}
}

69 
robj
 *
	$makeObje˘Sh¨ed
(
robj
 *
o
) {

70 
	`£rvîAs£π
(
o
->
ªfcou¡
 == 1);

71 
o
->
ªfcou¡
 = 
OBJ_SHARED_REFCOUNT
;

72  
o
;

73 
	}
}

77 
robj
 *
	$¸óãRawSåögObje˘
(c⁄° *
±r
, 
size_t
 
Àn
) {

78  
	`¸óãObje˘
(
OBJ_STRING
, 
	`sd¢ewÀn
(
±r
,
Àn
));

79 
	}
}

84 
robj
 *
	$¸óãEmbeddedSåögObje˘
(c⁄° *
±r
, 
size_t
 
Àn
) {

85 
robj
 *
o
 = 
	`zmÆloc
(‘obj)+(
sdshdr8
)+
Àn
+1);

86 
sdshdr8
 *
sh
 = (*)(
o
+1);

88 
o
->
ty≥
 = 
OBJ_STRING
;

89 
o
->
ícodög
 = 
OBJ_ENCODING_EMBSTR
;

90 
o
->
±r
 = 
sh
+1;

91 
o
->
ªfcou¡
 = 1;

92 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
) {

93 
o
->
Ãu
 = (
	`LFUGëTimeInMöuãs
()<<8Ë| 
LFU_INIT_VAL
;

95 
o
->
Ãu
 = 
	`LRU_CLOCK
();

98 
sh
->
Àn
 =Üen;

99 
sh
->
Æloc
 = 
Àn
;

100 
sh
->
Êags
 = 
SDS_TYPE_8
;

101 i‡(
±r
 =
SDS_NOINIT
)

102 
sh
->
buf
[
Àn
] = '\0';

103 i‡(
±r
) {

104 
	`mem˝y
(
sh
->
buf
,
±r
,
Àn
);

105 
sh
->
buf
[
Àn
] = '\0';

107 
	`mem£t
(
sh
->
buf
,0,
Àn
+1);

109  
o
;

110 
	}
}

118 
	#OBJ_ENCODING_EMBSTR_SIZE_LIMIT
 44

	)

119 
robj
 *
	$¸óãSåögObje˘
(c⁄° *
±r
, 
size_t
 
Àn
) {

120 i‡(
Àn
 <
OBJ_ENCODING_EMBSTR_SIZE_LIMIT
)

121  
	`¸óãEmbeddedSåögObje˘
(
±r
,
Àn
);

123  
	`¸óãRawSåögObje˘
(
±r
,
Àn
);

124 
	}
}

133 
robj
 *
	$¸óãSåögObje˘FromL⁄gL⁄gWôhO±i⁄s
(
vÆue
, 
vÆueobj
) {

134 
robj
 *
o
;

136 i‡(
£rvî
.
maxmem‹y
 == 0 ||

137 !(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_NO_SHARED_INTEGERS
))

141 
vÆueobj
 = 0;

144 i‡(
vÆue
 >0 && vÆuê< 
OBJ_SHARED_INTEGERS
 && 
vÆueobj
 == 0) {

145 
	`ö¸RefCou¡
(
sh¨ed
.
öãgîs
[
vÆue
]);

146 
o
 = 
sh¨ed
.
öãgîs
[
vÆue
];

148 i‡(
vÆue
 >
LONG_MIN
 && vÆuê<
LONG_MAX
) {

149 
o
 = 
	`¸óãObje˘
(
OBJ_STRING
, 
NULL
);

150 
o
->
ícodög
 = 
OBJ_ENCODING_INT
;

151 
o
->
±r
 = (*)(()
vÆue
);

153 
o
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sds‰oml⁄gl⁄g
(
vÆue
));

156  
o
;

157 
	}
}

161 
robj
 *
	$¸óãSåögObje˘FromL⁄gL⁄g
(
vÆue
) {

162  
	`¸óãSåögObje˘FromL⁄gL⁄gWôhO±i⁄s
(
vÆue
,0);

163 
	}
}

169 
robj
 *
	$¸óãSåögObje˘FromL⁄gL⁄gF‹VÆue
(
vÆue
) {

170  
	`¸óãSåögObje˘FromL⁄gL⁄gWôhO±i⁄s
(
vÆue
,1);

171 
	}
}

179 
robj
 *
	$¸óãSåögObje˘FromL⁄gDoubÀ
(
vÆue
, 
hum™‰õndly
) {

180 
buf
[
MAX_LONG_DOUBLE_CHARS
];

181 
Àn
 = 
	`ld2°rög
(
buf
,(buf),
vÆue
,
hum™‰õndly
? 
LD_STR_HUMAN
: 
LD_STR_AUTO
);

182  
	`¸óãSåögObje˘
(
buf
,
Àn
);

183 
	}
}

193 
robj
 *
	$dupSåögObje˘
(c⁄° 
robj
 *
o
) {

194 
robj
 *
d
;

196 
	`£rvîAs£π
(
o
->
ty≥
 =
OBJ_STRING
);

198 
o
->
ícodög
) {

199 
OBJ_ENCODING_RAW
:

200  
	`¸óãRawSåögObje˘
(
o
->
±r
,
	`sd¶í
(o->ptr));

201 
OBJ_ENCODING_EMBSTR
:

202  
	`¸óãEmbeddedSåögObje˘
(
o
->
±r
,
	`sd¶í
(o->ptr));

203 
OBJ_ENCODING_INT
:

204 
d
 = 
	`¸óãObje˘
(
OBJ_STRING
, 
NULL
);

205 
d
->
ícodög
 = 
OBJ_ENCODING_INT
;

206 
d
->
±r
 = 
o
->ptr;

207  
d
;

209 
	`£rvîP™ic
("WrongÉncoding.");

212 
	}
}

214 
robj
 *
	$¸óãQuickli°Obje˘
() {

215 
quickli°
 *
l
 = 
	`quickli°Cª©e
();

216 
robj
 *
o
 = 
	`¸óãObje˘
(
OBJ_LIST
,
l
);

217 
o
->
ícodög
 = 
OBJ_ENCODING_QUICKLIST
;

218  
o
;

219 
	}
}

221 
robj
 *
	$¸óãZùli°Obje˘
() {

222 *
zl
 = 
	`zùli°New
();

223 
robj
 *
o
 = 
	`¸óãObje˘
(
OBJ_LIST
,
zl
);

224 
o
->
ícodög
 = 
OBJ_ENCODING_ZIPLIST
;

225  
o
;

226 
	}
}

228 
robj
 *
	$¸óãSëObje˘
() {

229 
di˘
 *
d
 = 
	`di˘Cª©e
(&
£tDi˘Ty≥
,
NULL
);

230 
robj
 *
o
 = 
	`¸óãObje˘
(
OBJ_SET
,
d
);

231 
o
->
ícodög
 = 
OBJ_ENCODING_HT
;

232  
o
;

233 
	}
}

235 
robj
 *
	$¸óãI¡£tObje˘
() {

236 
öt£t
 *
is
 = 
	`öt£tNew
();

237 
robj
 *
o
 = 
	`¸óãObje˘
(
OBJ_SET
,
is
);

238 
o
->
ícodög
 = 
OBJ_ENCODING_INTSET
;

239  
o
;

240 
	}
}

242 
robj
 *
	$¸óãHashObje˘
() {

243 *
zl
 = 
	`zùli°New
();

244 
robj
 *
o
 = 
	`¸óãObje˘
(
OBJ_HASH
, 
zl
);

245 
o
->
ícodög
 = 
OBJ_ENCODING_ZIPLIST
;

246  
o
;

247 
	}
}

249 
robj
 *
	$¸óãZ£tObje˘
() {

250 
z£t
 *
zs
 = 
	`zmÆloc
((*zs));

251 
robj
 *
o
;

253 
zs
->
di˘
 = 
	`di˘Cª©e
(&
z£tDi˘Ty≥
,
NULL
);

254 
zs
->
z¶
 = 
	`z¶Cª©e
();

255 
o
 = 
	`¸óãObje˘
(
OBJ_ZSET
,
zs
);

256 
o
->
ícodög
 = 
OBJ_ENCODING_SKIPLIST
;

257  
o
;

258 
	}
}

260 
robj
 *
	$¸óãZ£tZùli°Obje˘
() {

261 *
zl
 = 
	`zùli°New
();

262 
robj
 *
o
 = 
	`¸óãObje˘
(
OBJ_ZSET
,
zl
);

263 
o
->
ícodög
 = 
OBJ_ENCODING_ZIPLIST
;

264  
o
;

265 
	}
}

267 
robj
 *
	$¸óãSåómObje˘
() {

268 
°ªam
 *
s
 = 
	`°ªamNew
();

269 
robj
 *
o
 = 
	`¸óãObje˘
(
OBJ_STREAM
,
s
);

270 
o
->
ícodög
 = 
OBJ_ENCODING_STREAM
;

271  
o
;

272 
	}
}

274 
robj
 *
	$¸óãModuÀObje˘
(
moduÀTy≥
 *
mt
, *
vÆue
) {

275 
moduÀVÆue
 *
mv
 = 
	`zmÆloc
((*mv));

276 
mv
->
ty≥
 = 
mt
;

277 
mv
->
vÆue
 = value;

278  
	`¸óãObje˘
(
OBJ_MODULE
,
mv
);

279 
	}
}

281 
	$‰ìSåögObje˘
(
robj
 *
o
) {

282 i‡(
o
->
ícodög
 =
OBJ_ENCODING_RAW
) {

283 
	`sds‰ì
(
o
->
±r
);

285 
	}
}

287 
	$‰ìLi°Obje˘
(
robj
 *
o
) {

288 i‡(
o
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

289 
	`quickli°Rñó£
(
o
->
±r
);

291 
	`£rvîP™ic
("UnknownÜistÉncodingÅype");

293 
	}
}

295 
	$‰ìSëObje˘
(
robj
 *
o
) {

296 
o
->
ícodög
) {

297 
OBJ_ENCODING_HT
:

298 
	`di˘Rñó£
((
di˘
*Ë
o
->
±r
);

300 
OBJ_ENCODING_INTSET
:

301 
	`z‰ì
(
o
->
±r
);

304 
	`£rvîP™ic
("Unknown setÉncodingÅype");

306 
	}
}

308 
	$‰ìZ£tObje˘
(
robj
 *
o
) {

309 
z£t
 *
zs
;

310 
o
->
ícodög
) {

311 
OBJ_ENCODING_SKIPLIST
:

312 
zs
 = 
o
->
±r
;

313 
	`di˘Rñó£
(
zs
->
di˘
);

314 
	`z¶Fªe
(
zs
->
z¶
);

315 
	`z‰ì
(
zs
);

317 
OBJ_ENCODING_ZIPLIST
:

318 
	`z‰ì
(
o
->
±r
);

321 
	`£rvîP™ic
("Unknown sorted setÉncoding");

323 
	}
}

325 
	$‰ìHashObje˘
(
robj
 *
o
) {

326 
o
->
ícodög
) {

327 
OBJ_ENCODING_HT
:

328 
	`di˘Rñó£
((
di˘
*Ë
o
->
±r
);

330 
OBJ_ENCODING_ZIPLIST
:

331 
	`z‰ì
(
o
->
±r
);

334 
	`£rvîP™ic
("Unknown hashÉncodingÅype");

337 
	}
}

339 
	$‰ìModuÀObje˘
(
robj
 *
o
) {

340 
moduÀVÆue
 *
mv
 = 
o
->
±r
;

341 
mv
->
ty≥
->
	`‰ì
(mv->
vÆue
);

342 
	`z‰ì
(
mv
);

343 
	}
}

345 
	$‰ìSåómObje˘
(
robj
 *
o
) {

346 
	`‰ìSåóm
(
o
->
±r
);

347 
	}
}

349 
	$ö¸RefCou¡
(
robj
 *
o
) {

350 i‡(
o
->
ªfcou¡
 < 
OBJ_FIRST_SPECIAL_REFCOUNT
) {

351 
o
->
ªfcou¡
++;

353 i‡(
o
->
ªfcou¡
 =
OBJ_SHARED_REFCOUNT
) {

355 } i‡(
o
->
ªfcou¡
 =
OBJ_STATIC_REFCOUNT
) {

356 
	`£rvîP™ic
("YouÅriedÅoÑetainán objectállocated inÅhe stack");

359 
	}
}

361 
	$de¸RefCou¡
(
robj
 *
o
) {

362 i‡(
o
->
ªfcou¡
 == 1) {

363 
o
->
ty≥
) {

364 
OBJ_STRING
: 
	`‰ìSåögObje˘
(
o
); ;

365 
OBJ_LIST
: 
	`‰ìLi°Obje˘
(
o
); ;

366 
OBJ_SET
: 
	`‰ìSëObje˘
(
o
); ;

367 
OBJ_ZSET
: 
	`‰ìZ£tObje˘
(
o
); ;

368 
OBJ_HASH
: 
	`‰ìHashObje˘
(
o
); ;

369 
OBJ_MODULE
: 
	`‰ìModuÀObje˘
(
o
); ;

370 
OBJ_STREAM
: 
	`‰ìSåómObje˘
(
o
); ;

371 : 
	`£rvîP™ic
("Unknown objectÅype"); ;

373 
	`z‰ì
(
o
);

375 i‡(
o
->
ªfcou¡
 <0Ë
	`£rvîP™ic
("decrRefCountágainstÑefcount <= 0");

376 i‡(
o
->
ªfcou¡
 !
OBJ_SHARED_REFCOUNT
) o->refcount--;

378 
	}
}

383 
	$de¸RefCou¡Void
(*
o
) {

384 
	`de¸RefCou¡
(
o
);

385 
	}
}

399 
robj
 *
	$ª£tRefCou¡
(
robj
 *
obj
) {

400 
obj
->
ªfcou¡
 = 0;

401  
obj
;

402 
	}
}

404 
	$checkTy≥
(
˛õ¡
 *
c
, 
robj
 *
o
, 
ty≥
) {

405 i‡(
o
->
ty≥
 !=Åype) {

406 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

410 
	}
}

412 
	$isSdsRïª£¡abÀAsL⁄gL⁄g
(
sds
 
s
, *
ŒvÆ
) {

413  
	`°rög2Œ
(
s
,
	`sd¶í
(s),
ŒvÆ
Ë? 
C_OK
 : 
C_ERR
;

414 
	}
}

416 
	$isObje˘Rïª£¡abÀAsL⁄gL⁄g
(
robj
 *
o
, *
ŒvÆ
) {

417 
	`£rvîAs£πWôhInfo
(
NULL
,
o
,o->
ty≥
 =
OBJ_STRING
);

418 i‡(
o
->
ícodög
 =
OBJ_ENCODING_INT
) {

419 i‡(
ŒvÆ
Ë*ŒvÆ = (Ë
o
->
±r
;

420  
C_OK
;

422  
	`isSdsRïª£¡abÀAsL⁄gL⁄g
(
o
->
±r
,
ŒvÆ
);

424 
	}
}

430 
	$åimSåögObje˘IfNìded
(
robj
 *
o
) {

431 i‡(
o
->
ícodög
 =
OBJ_ENCODING_RAW
 &&

432 
	`sdßvaû
(
o
->
±r
Ë> 
	`sd¶í
(o->ptr)/10)

434 
o
->
±r
 = 
	`sdsRemoveFªeS∑˚
(o->ptr);

436 
	}
}

439 
robj
 *
	$åyObje˘Encodög
(
robj
 *
o
) {

440 
vÆue
;

441 
sds
 
s
 = 
o
->
±r
;

442 
size_t
 
Àn
;

448 
	`£rvîAs£πWôhInfo
(
NULL
,
o
,o->
ty≥
 =
OBJ_STRING
);

453 i‡(!
	`sdsEncodedObje˘
(
o
))  o;

458 i‡(
o
->
ªfcou¡
 > 1)  o;

463 
Àn
 = 
	`sd¶í
(
s
);

464 i‡(
Àn
 <20 && 
	`°rög2l
(
s
,Àn,&
vÆue
)) {

469 i‡((
£rvî
.
maxmem‹y
 == 0 ||

470 !(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_NO_SHARED_INTEGERS
)) &&

471 
vÆue
 >= 0 &&

472 
vÆue
 < 
OBJ_SHARED_INTEGERS
)

474 
	`de¸RefCou¡
(
o
);

475 
	`ö¸RefCou¡
(
sh¨ed
.
öãgîs
[
vÆue
]);

476  
sh¨ed
.
öãgîs
[
vÆue
];

478 i‡(
o
->
ícodög
 =
OBJ_ENCODING_RAW
) {

479 
	`sds‰ì
(
o
->
±r
);

480 
o
->
ícodög
 = 
OBJ_ENCODING_INT
;

481 
o
->
±r
 = (*Ë
vÆue
;

482  
o
;

483 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_EMBSTR
) {

484 
	`de¸RefCou¡
(
o
);

485  
	`¸óãSåögObje˘FromL⁄gL⁄gF‹VÆue
(
vÆue
);

494 i‡(
Àn
 <
OBJ_ENCODING_EMBSTR_SIZE_LIMIT
) {

495 
robj
 *
emb
;

497 i‡(
o
->
ícodög
 =
OBJ_ENCODING_EMBSTR
)  o;

498 
emb
 = 
	`¸óãEmbeddedSåögObje˘
(
s
,
	`sd¶í
(s));

499 
	`de¸RefCou¡
(
o
);

500  
emb
;

512 
	`åimSåögObje˘IfNìded
(
o
);

515  
o
;

516 
	}
}

520 
robj
 *
	$gëDecodedObje˘
(
robj
 *
o
) {

521 
robj
 *
dec
;

523 i‡(
	`sdsEncodedObje˘
(
o
)) {

524 
	`ö¸RefCou¡
(
o
);

525  
o
;

527 i‡(
o
->
ty≥
 =
OBJ_STRING
 && o->
ícodög
 =
OBJ_ENCODING_INT
) {

528 
buf
[32];

530 
	`Œ2°rög
(
buf
,32,()
o
->
±r
);

531 
dec
 = 
	`¸óãSåögObje˘
(
buf
,
	`°æí
(buf));

532  
dec
;

534 
	`£rvîP™ic
("UnknownÉncodingÅype");

536 
	}
}

546 
	#REDIS_COMPARE_BINARY
 (1<<0)

	)

547 
	#REDIS_COMPARE_COLL
 (1<<1)

	)

549 
	$com∑ªSåögObje˘sWôhFœgs
(
robj
 *
a
,Ñobj *
b
, 
Êags
) {

550 
	`£rvîAs£πWôhInfo
(
NULL
,
a
,a->
ty≥
 =
OBJ_STRING
 && 
b
->type == OBJ_STRING);

551 
buÁ
[128], 
bufb
[128], *
a°r
, *
b°r
;

552 
size_t
 
Æí
, 
bÀn
, 
möÀn
;

554 i‡(
a
 =
b
)  0;

555 i‡(
	`sdsEncodedObje˘
(
a
)) {

556 
a°r
 = 
a
->
±r
;

557 
Æí
 = 
	`sd¶í
(
a°r
);

559 
Æí
 = 
	`Œ2°rög
(
buÁ
,(buÁ),(Ë
a
->
±r
);

560 
a°r
 = 
buÁ
;

562 i‡(
	`sdsEncodedObje˘
(
b
)) {

563 
b°r
 = 
b
->
±r
;

564 
bÀn
 = 
	`sd¶í
(
b°r
);

566 
bÀn
 = 
	`Œ2°rög
(
bufb
,(bufb),(Ë
b
->
±r
);

567 
b°r
 = 
bufb
;

569 i‡(
Êags
 & 
REDIS_COMPARE_COLL
) {

570  
	`°rcﬁl
(
a°r
,
b°r
);

572 
cmp
;

574 
möÀn
 = (
Æí
 < 
bÀn
) ?álen : blen;

575 
cmp
 = 
	`memcmp
(
a°r
,
b°r
,
möÀn
);

576 i‡(
cmp
 =0Ë 
Æí
-
bÀn
;

577  
cmp
;

579 
	}
}

582 
	$com∑ªSåögObje˘s
(
robj
 *
a
,Ñobj *
b
) {

583  
	`com∑ªSåögObje˘sWôhFœgs
(
a
,
b
,
REDIS_COMPARE_BINARY
);

584 
	}
}

587 
	$cﬁœãSåögObje˘s
(
robj
 *
a
,Ñobj *
b
) {

588  
	`com∑ªSåögObje˘sWôhFœgs
(
a
,
b
,
REDIS_COMPARE_COLL
);

589 
	}
}

595 
	$equÆSåögObje˘s
(
robj
 *
a
,Ñobj *
b
) {

596 i‡(
a
->
ícodög
 =
OBJ_ENCODING_INT
 &&

597 
b
->
ícodög
 =
OBJ_ENCODING_INT
){

600  
a
->
±r
 =
b
->ptr;

602  
	`com∑ªSåögObje˘s
(
a
,
b
) == 0;

604 
	}
}

606 
size_t
 
	$°rögObje˘Lí
(
robj
 *
o
) {

607 
	`£rvîAs£πWôhInfo
(
NULL
,
o
,o->
ty≥
 =
OBJ_STRING
);

608 i‡(
	`sdsEncodedObje˘
(
o
)) {

609  
	`sd¶í
(
o
->
±r
);

611  
	`sdigôs10
(()
o
->
±r
);

613 
	}
}

615 
	$gëDoubÀFromObje˘
(c⁄° 
robj
 *
o
, *
èrgë
) {

616 
vÆue
;

618 i‡(
o
 =
NULL
) {

619 
vÆue
 = 0;

621 
	`£rvîAs£πWôhInfo
(
NULL
,
o
,o->
ty≥
 =
OBJ_STRING
);

622 i‡(
	`sdsEncodedObje˘
(
o
)) {

623 i‡(!
	`°rög2d
(
o
->
±r
, 
	`sd¶í
(o->±r), &
vÆue
))

624  
C_ERR
;

625 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_INT
) {

626 
vÆue
 = ()
o
->
±r
;

628 
	`£rvîP™ic
("Unknown stringÉncoding");

631 *
èrgë
 = 
vÆue
;

632  
C_OK
;

633 
	}
}

635 
	$gëDoubÀFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
èrgë
, c⁄° *
msg
) {

636 
vÆue
;

637 i‡(
	`gëDoubÀFromObje˘
(
o
, &
vÆue
Ë!
C_OK
) {

638 i‡(
msg
 !
NULL
) {

639 
	`addRïlyEº‹
(
c
,(*)
msg
);

641 
	`addRïlyEº‹
(
c
,"value isÇotá valid float");

643  
C_ERR
;

645 *
èrgë
 = 
vÆue
;

646  
C_OK
;

647 
	}
}

649 
	$gëL⁄gDoubÀFromObje˘
(
robj
 *
o
, *
èrgë
) {

650 
vÆue
;

652 i‡(
o
 =
NULL
) {

653 
vÆue
 = 0;

655 
	`£rvîAs£πWôhInfo
(
NULL
,
o
,o->
ty≥
 =
OBJ_STRING
);

656 i‡(
	`sdsEncodedObje˘
(
o
)) {

657 i‡(!
	`°rög2ld
(
o
->
±r
, 
	`sd¶í
(o->±r), &
vÆue
))

658  
C_ERR
;

659 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_INT
) {

660 
vÆue
 = ()
o
->
±r
;

662 
	`£rvîP™ic
("Unknown stringÉncoding");

665 *
èrgë
 = 
vÆue
;

666  
C_OK
;

667 
	}
}

669 
	$gëL⁄gDoubÀFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
èrgë
, c⁄° *
msg
) {

670 
vÆue
;

671 i‡(
	`gëL⁄gDoubÀFromObje˘
(
o
, &
vÆue
Ë!
C_OK
) {

672 i‡(
msg
 !
NULL
) {

673 
	`addRïlyEº‹
(
c
,(*)
msg
);

675 
	`addRïlyEº‹
(
c
,"value isÇotá valid float");

677  
C_ERR
;

679 *
èrgë
 = 
vÆue
;

680  
C_OK
;

681 
	}
}

683 
	$gëL⁄gL⁄gFromObje˘
(
robj
 *
o
, *
èrgë
) {

684 
vÆue
;

686 i‡(
o
 =
NULL
) {

687 
vÆue
 = 0;

689 
	`£rvîAs£πWôhInfo
(
NULL
,
o
,o->
ty≥
 =
OBJ_STRING
);

690 i‡(
	`sdsEncodedObje˘
(
o
)) {

691 i‡(
	`°rög2Œ
(
o
->
±r
,
	`sd¶í
(o->±r),&
vÆue
Ë=0Ë 
C_ERR
;

692 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_INT
) {

693 
vÆue
 = ()
o
->
±r
;

695 
	`£rvîP™ic
("Unknown stringÉncoding");

698 i‡(
èrgë
Ë*èrgë = 
vÆue
;

699  
C_OK
;

700 
	}
}

702 
	$gëL⁄gL⁄gFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
èrgë
, c⁄° *
msg
) {

703 
vÆue
;

704 i‡(
	`gëL⁄gL⁄gFromObje˘
(
o
, &
vÆue
Ë!
C_OK
) {

705 i‡(
msg
 !
NULL
) {

706 
	`addRïlyEº‹
(
c
,(*)
msg
);

708 
	`addRïlyEº‹
(
c
,"value isÇotán integer or out ofÑange");

710  
C_ERR
;

712 *
èrgë
 = 
vÆue
;

713  
C_OK
;

714 
	}
}

716 
	$gëL⁄gFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
èrgë
, c⁄° *
msg
) {

717 
vÆue
;

719 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
, 
o
, &
vÆue
, 
msg
Ë!
C_OK
Ë 
C_ERR
;

720 i‡(
vÆue
 < 
LONG_MIN
 || vÆuê> 
LONG_MAX
) {

721 i‡(
msg
 !
NULL
) {

722 
	`addRïlyEº‹
(
c
,(*)
msg
);

724 
	`addRïlyEº‹
(
c
,"value is out ofÑange");

726  
C_ERR
;

728 *
èrgë
 = 
vÆue
;

729  
C_OK
;

730 
	}
}

732 *
	$°rEncodög
(
ícodög
) {

733 
ícodög
) {

734 
OBJ_ENCODING_RAW
:  "raw";

735 
OBJ_ENCODING_INT
:  "int";

736 
OBJ_ENCODING_HT
:  "hashtable";

737 
OBJ_ENCODING_QUICKLIST
:  "quicklist";

738 
OBJ_ENCODING_ZIPLIST
:  "ziplist";

739 
OBJ_ENCODING_INTSET
:  "intset";

740 
OBJ_ENCODING_SKIPLIST
:  "skiplist";

741 
OBJ_ENCODING_EMBSTR
:  "embstr";

744 
	}
}

763 
size_t
 
	$°ªamRadixTªeMem‹yUßge
(
øx
 *rax) {

764 
size_t
 
size
;

765 
size
 = 
øx
->
numñe
 * (
°ªamID
);

766 
size
 +
øx
->
numnodes
 * (
øxNode
);

768 
size
 +
øx
->
numnodes
 * ()*30;

769  
size
;

770 
	}
}

776 
	#OBJ_COMPUTE_SIZE_DEF_SAMPLES
 5

	)

777 
size_t
 
	$obje˘CompuãSize
(
robj
 *
o
, 
size_t
 
ßm∂e_size
) {

778 
sds
 
ñe
, 
ñe2
;

779 
di˘
 *
d
;

780 
di˘Iãøt‹
 *
di
;

781 
di˘E¡ry
 *
de
;

782 
size_t
 
asize
 = 0, 
ñesize
 = 0, 
ßm∂es
 = 0;

784 i‡(
o
->
ty≥
 =
OBJ_STRING
) {

785 if(
o
->
ícodög
 =
OBJ_ENCODING_INT
) {

786 
asize
 = (*
o
);

787 } if(
o
->
ícodög
 =
OBJ_ENCODING_RAW
) {

788 
asize
 = 
	`sdsAŒocSize
(
o
->
±r
)+(*o);

789 } if(
o
->
ícodög
 =
OBJ_ENCODING_EMBSTR
) {

790 
asize
 = 
	`sd¶í
(
o
->
±r
)+2+(*o);

792 
	`£rvîP™ic
("Unknown stringÉncoding");

794 } i‡(
o
->
ty≥
 =
OBJ_LIST
) {

795 i‡(
o
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

796 
quickli°
 *
ql
 = 
o
->
±r
;

797 
quickli°Node
 *
node
 = 
ql
->
hód
;

798 
asize
 = (*
o
)+(
quickli°
);

800 
ñesize
 +(
quickli°Node
)+
	`zùli°BlobLí
(
node
->
zl
);

801 
ßm∂es
++;

802 } (
node
 =Çode->
√xt
Ë&& 
ßm∂es
 < 
ßm∂e_size
);

803 
asize
 +()
ñesize
/
ßm∂es
*
ql
->
Àn
;

804 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

805 
asize
 = (*
o
)+
	`zùli°BlobLí
(o->
±r
);

807 
	`£rvîP™ic
("UnknownÜistÉncoding");

809 } i‡(
o
->
ty≥
 =
OBJ_SET
) {

810 i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

811 
d
 = 
o
->
±r
;

812 
di
 = 
	`di˘GëIãøt‹
(
d
);

813 
asize
 = (*
o
)+(
di˘
)+((
di˘E¡ry
*)*
	`di˘SlŸs
(
d
));

814 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
 && 
ßm∂es
 < 
ßm∂e_size
) {

815 
ñe
 = 
	`di˘GëKey
(
de
);

816 
ñesize
 +(
di˘E¡ry
Ë+ 
	`sdsAŒocSize
(
ñe
);

817 
ßm∂es
++;

819 
	`di˘Rñó£Iãøt‹
(
di
);

820 i‡(
ßm∂es
Ë
asize
 +()
ñesize
/ßm∂es*
	`di˘Size
(
d
);

821 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

822 
öt£t
 *
is
 = 
o
->
±r
;

823 
asize
 = (*
o
)+(*
is
)+is->
ícodög
*is->
Àngth
;

825 
	`£rvîP™ic
("Unknown setÉncoding");

827 } i‡(
o
->
ty≥
 =
OBJ_ZSET
) {

828 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

829 
asize
 = (*
o
)+(
	`zùli°BlobLí
(o->
±r
));

830 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

831 
d
 = ((
z£t
*)
o
->
±r
)->
di˘
;

832 
zskùli°
 *
z¶
 = ((
z£t
*)
o
->
±r
)->zsl;

833 
zskùli°Node
 *
znode
 = 
z¶
->
hódî
->
Àvñ
[0].
f‹w¨d
;

834 
asize
 = (*
o
)+(
z£t
)+(
zskùli°
)+(
di˘
)+

835 ((
di˘E¡ry
*)*
	`di˘SlŸs
(
d
))+

836 
	`zmÆloc_size
(
z¶
->
hódî
);

837 
znode
 !
NULL
 && 
ßm∂es
 < 
ßm∂e_size
) {

838 
ñesize
 +
	`sdsAŒocSize
(
znode
->
ñe
);

839 
ñesize
 +(
di˘E¡ry
Ë+ 
	`zmÆloc_size
(
znode
);

840 
ßm∂es
++;

841 
znode
 = znode->
Àvñ
[0].
f‹w¨d
;

843 i‡(
ßm∂es
Ë
asize
 +()
ñesize
/ßm∂es*
	`di˘Size
(
d
);

845 
	`£rvîP™ic
("Unknown sorted setÉncoding");

847 } i‡(
o
->
ty≥
 =
OBJ_HASH
) {

848 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

849 
asize
 = (*
o
)+(
	`zùli°BlobLí
(o->
±r
));

850 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

851 
d
 = 
o
->
±r
;

852 
di
 = 
	`di˘GëIãøt‹
(
d
);

853 
asize
 = (*
o
)+(
di˘
)+((
di˘E¡ry
*)*
	`di˘SlŸs
(
d
));

854 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
 && 
ßm∂es
 < 
ßm∂e_size
) {

855 
ñe
 = 
	`di˘GëKey
(
de
);

856 
ñe2
 = 
	`di˘GëVÆ
(
de
);

857 
ñesize
 +
	`sdsAŒocSize
(
ñe
Ë+ sdsAŒocSize(
ñe2
);

858 
ñesize
 +(
di˘E¡ry
);

859 
ßm∂es
++;

861 
	`di˘Rñó£Iãøt‹
(
di
);

862 i‡(
ßm∂es
Ë
asize
 +()
ñesize
/ßm∂es*
	`di˘Size
(
d
);

864 
	`£rvîP™ic
("Unknown hashÉncoding");

866 } i‡(
o
->
ty≥
 =
OBJ_STREAM
) {

867 
°ªam
 *
s
 = 
o
->
±r
;

868 
asize
 = (*
o
);

869 
asize
 +
	`°ªamRadixTªeMem‹yUßge
(
s
->
øx
);

875 
øxIãøt‹
 
ri
;

876 
	`øxSèπ
(&
ri
,
s
->
øx
);

877 
	`øxSìk
(&
ri
,"^",
NULL
,0);

878 
size_t
 
Õsize
 = 0, 
ßm∂es
 = 0;

879 
ßm∂es
 < 
ßm∂e_size
 && 
	`øxNext
(&
ri
)) {

880 *
Õ
 = 
ri
.
d©a
;

881 
Õsize
 +
	`ÕByãs
(
Õ
);

882 
ßm∂es
++;

884 i‡(
s
->
øx
->
numñe
 <
ßm∂es
) {

885 
asize
 +
Õsize
;

887 i‡(
ßm∂es
Ë
Õsize
 /= samples;

888 
asize
 +
Õsize
 * (
s
->
øx
->
numñe
-1);

891 
	`øxSìk
(&
ri
,"$",
NULL
,0);

892 
	`øxNext
(&
ri
);

893 
asize
 +
	`ÕByãs
(
ri
.
d©a
);

895 
	`øxSt›
(&
ri
);

901 i‡(
s
->
cgroups
) {

902 
	`øxSèπ
(&
ri
,
s
->
cgroups
);

903 
	`øxSìk
(&
ri
,"^",
NULL
,0);

904 
	`øxNext
(&
ri
)) {

905 
°ªamCG
 *
cg
 = 
ri
.
d©a
;

906 
asize
 +(*
cg
);

907 
asize
 +
	`°ªamRadixTªeMem‹yUßge
(
cg
->
≥l
);

908 
asize
 +(
°ªamNACK
)*
	`øxSize
(
cg
->
≥l
);

912 
øxIãøt‹
 
¸i
;

913 
	`øxSèπ
(&
¸i
,
cg
->
c⁄sumîs
);

914 
	`øxSìk
(&
¸i
,"^",
NULL
,0);

915 
	`øxNext
(&
¸i
)) {

916 
°ªamC⁄sumî
 *
c⁄sumî
 = 
¸i
.
d©a
;

917 
asize
 +(*
c⁄sumî
);

918 
asize
 +
	`sd¶í
(
c⁄sumî
->
«me
);

919 
asize
 +
	`°ªamRadixTªeMem‹yUßge
(
c⁄sumî
->
≥l
);

923 
	`øxSt›
(&
¸i
);

925 
	`øxSt›
(&
ri
);

927 } i‡(
o
->
ty≥
 =
OBJ_MODULE
) {

928 
moduÀVÆue
 *
mv
 = 
o
->
±r
;

929 
moduÀTy≥
 *
mt
 = 
mv
->
ty≥
;

930 i‡(
mt
->
mem_ußge
 !
NULL
) {

931 
asize
 = 
mt
->
	`mem_ußge
(
mv
->
vÆue
);

933 
asize
 = 0;

936 
	`£rvîP™ic
("Unknown objectÅype");

938  
asize
;

939 
	}
}

942 
	$‰ìMem‹yOvîhódD©a
(
ªdisMemOvîhód
 *
mh
) {

943 
	`z‰ì
(
mh
->
db
);

944 
	`z‰ì
(
mh
);

945 
	}
}

950 
ªdisMemOvîhód
 *
	$gëMem‹yOvîhódD©a
() {

951 
j
;

952 
size_t
 
mem_tŸÆ
 = 0;

953 
size_t
 
mem
 = 0;

954 
size_t
 
zmÆloc_u£d
 = 
	`zmÆloc_u£d_mem‹y
();

955 
ªdisMemOvîhód
 *
mh
 = 
	`zˇŒoc
((*mh));

957 
mh
->
tŸÆ_Æloˇãd
 = 
zmÆloc_u£d
;

958 
mh
->
°¨tup_Æloˇãd
 = 
£rvî
.
öôül_mem‹y_ußge
;

959 
mh
->
≥ak_Æloˇãd
 = 
£rvî
.
°©_≥ak_mem‹y
;

960 
mh
->
tŸÆ_‰ag
 =

961 ()
£rvî
.
¸⁄_mÆloc_°©s
.
¥o˚ss_rss
 / sîvî.¸⁄_mÆloc_°©s.
zmÆloc_u£d
;

962 
mh
->
tŸÆ_‰ag_byãs
 =

963 
£rvî
.
¸⁄_mÆloc_°©s
.
¥o˚ss_rss
 - sîvî.¸⁄_mÆloc_°©s.
zmÆloc_u£d
;

964 
mh
->
Æloˇt‹_‰ag
 =

965 ()
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_a˘ive
 / sîvî.¸⁄_mÆloc_°©s.
Æloˇt‹_Æloˇãd
;

966 
mh
->
Æloˇt‹_‰ag_byãs
 =

967 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_a˘ive
 - sîvî.¸⁄_mÆloc_°©s.
Æloˇt‹_Æloˇãd
;

968 
mh
->
Æloˇt‹_rss
 =

969 ()
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_ªsidít
 / sîvî.¸⁄_mÆloc_°©s.
Æloˇt‹_a˘ive
;

970 
mh
->
Æloˇt‹_rss_byãs
 =

971 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_ªsidít
 - sîvî.¸⁄_mÆloc_°©s.
Æloˇt‹_a˘ive
;

972 
mh
->
rss_exåa
 =

973 ()
£rvî
.
¸⁄_mÆloc_°©s
.
¥o˚ss_rss
 / sîvî.¸⁄_mÆloc_°©s.
Æloˇt‹_ªsidít
;

974 
mh
->
rss_exåa_byãs
 =

975 
£rvî
.
¸⁄_mÆloc_°©s
.
¥o˚ss_rss
 - sîvî.¸⁄_mÆloc_°©s.
Æloˇt‹_ªsidít
;

977 
mem_tŸÆ
 +
£rvî
.
öôül_mem‹y_ußge
;

979 
mem
 = 0;

980 i‡(
£rvî
.
ª∂_backlog
)

981 
mem
 +
	`zmÆloc_size
(
£rvî
.
ª∂_backlog
);

982 
mh
->
ª∂_backlog
 = 
mem
;

983 
mem_tŸÆ
 +
mem
;

988 
mh
->
˛õ¡s_¶aves
 = 
£rvî
.
°©_˛õ¡s_ty≥_mem‹y
[
CLIENT_TYPE_SLAVE
];

989 
mh
->
˛õ¡s_n‹mÆ
 = 
£rvî
.
°©_˛õ¡s_ty≥_mem‹y
[
CLIENT_TYPE_MASTER
]+

990 
£rvî
.
°©_˛õ¡s_ty≥_mem‹y
[
CLIENT_TYPE_PUBSUB
]+

991 
£rvî
.
°©_˛õ¡s_ty≥_mem‹y
[
CLIENT_TYPE_NORMAL
];

992 
mem_tŸÆ
 +
mh
->
˛õ¡s_¶aves
;

993 
mem_tŸÆ
 +
mh
->
˛õ¡s_n‹mÆ
;

995 
mem
 = 0;

996 i‡(
£rvî
.
aof_°©e
 !
AOF_OFF
) {

997 
mem
 +
	`sdßŒoc
(
£rvî
.
aof_buf
);

998 
mem
 +
	`aofRewrôeBuf„rSize
();

1000 
mh
->
aof_buf„r
 = 
mem
;

1001 
mem_tŸÆ
+=
mem
;

1003 
mem
 = 
£rvî
.
lua_s¸ùts_mem
;

1004 
mem
 +
	`di˘Size
(
£rvî
.
lua_s¸ùts
Ë* (
di˘E¡ry
) +

1005 
	`di˘SlŸs
(
£rvî
.
lua_s¸ùts
Ë* (
di˘E¡ry
*);

1006 
mem
 +
	`di˘Size
(
£rvî
.
ª∂_s¸ùtˇche_di˘
Ë* (
di˘E¡ry
) +

1007 
	`di˘SlŸs
(
£rvî
.
ª∂_s¸ùtˇche_di˘
Ë* (
di˘E¡ry
*);

1008 i‡(
	`li°Lígth
(
£rvî
.
ª∂_s¸ùtˇche_fifo
) > 0) {

1009 
mem
 +
	`li°Lígth
(
£rvî
.
ª∂_s¸ùtˇche_fifo
Ë* ((
li°Node
) +

1010 
	`sdsZmÆlocSize
(
	`li°NodeVÆue
(
	`li°Fú°
(
£rvî
.
ª∂_s¸ùtˇche_fifo
))));

1012 
mh
->
lua_ˇches
 = 
mem
;

1013 
mem_tŸÆ
+=
mem
;

1015 
j
 = 0; j < 
£rvî
.
dbnum
; j++) {

1016 
ªdisDb
 *
db
 = 
£rvî
.db+
j
;

1017 
keyscou¡
 = 
	`di˘Size
(
db
->
di˘
);

1018 i‡(
keyscou¡
==0) ;

1020 
mh
->
tŸÆ_keys
 +
keyscou¡
;

1021 
mh
->
db
 = 
	`zªÆloc
(mh->db,(mh->db[0])*(mh->
num_dbs
+1));

1022 
mh
->
db
[mh->
num_dbs
].
dbid
 = 
j
;

1024 
mem
 = 
	`di˘Size
(
db
->
di˘
Ë* (
di˘E¡ry
) +

1025 
	`di˘SlŸs
(
db
->
di˘
Ë* (
di˘E¡ry
*) +

1026 
	`di˘Size
(
db
->
di˘
Ë* (
robj
);

1027 
mh
->
db
[mh->
num_dbs
].
ovîhód_ht_maö
 = 
mem
;

1028 
mem_tŸÆ
+=
mem
;

1030 
mem
 = 
	`di˘Size
(
db
->
expúes
Ë* (
di˘E¡ry
) +

1031 
	`di˘SlŸs
(
db
->
expúes
Ë* (
di˘E¡ry
*);

1032 
mh
->
db
[mh->
num_dbs
].
ovîhód_ht_expúes
 = 
mem
;

1033 
mem_tŸÆ
+=
mem
;

1035 
mh
->
num_dbs
++;

1038 
mh
->
ovîhód_tŸÆ
 = 
mem_tŸÆ
;

1039 
mh
->
d©a£t
 = 
zmÆloc_u£d
 - 
mem_tŸÆ
;

1040 
mh
->
≥ak_≥rc
 = ()
zmÆloc_u£d
*100/mh->
≥ak_Æloˇãd
;

1044 
size_t
 
√t_ußge
 = 1;

1045 i‡(
zmÆloc_u£d
 > 
mh
->
°¨tup_Æloˇãd
)

1046 
√t_ußge
 = 
zmÆloc_u£d
 - 
mh
->
°¨tup_Æloˇãd
;

1047 
mh
->
d©a£t_≥rc
 = ()mh->
d©a£t
*100/
√t_ußge
;

1048 
mh
->
byãs_≥r_key
 = mh->
tŸÆ_keys
 ? (
√t_ußge
 / mh->total_keys) : 0;

1050  
mh
;

1051 
	}
}

1055 
	$öputC©Sds
(*
ªsu…
, c⁄° *
°r
) {

1057 
sds
 *
öfo
 = (sd†*)
ªsu…
;

1058 *
öfo
 = 
	`sdsˇt
(*öfo, 
°r
);

1059 
	}
}

1063 
sds
 
	$gëMem‹yDo˘‹Rï‹t
() {

1064 
em±y
 = 0;

1065 
big_≥ak
 = 0;

1066 
high_‰ag
 = 0;

1067 
high_Æloc_‰ag
 = 0;

1068 
high_¥oc_rss
 = 0;

1069 
high_Æloc_rss
 = 0;

1070 
big_¶ave_buf
 = 0;

1071 
big_˛õ¡_buf
 = 0;

1072 
m™y_s¸ùts
 = 0;

1073 
num_ªp‹ts
 = 0;

1074 
ªdisMemOvîhód
 *
mh
 = 
	`gëMem‹yOvîhódD©a
();

1076 i‡(
mh
->
tŸÆ_Æloˇãd
 < (1024*1024*5)) {

1077 
em±y
 = 1;

1078 
num_ªp‹ts
++;

1081 i‡((()
mh
->
≥ak_Æloˇãd
 / mh->
tŸÆ_Æloˇãd
) > 1.5) {

1082 
big_≥ak
 = 1;

1083 
num_ªp‹ts
++;

1087 i‡(
mh
->
tŸÆ_‰ag
 > 1.4 && mh->
tŸÆ_‰ag_byãs
 > 10<<20) {

1088 
high_‰ag
 = 1;

1089 
num_ªp‹ts
++;

1093 i‡(
mh
->
Æloˇt‹_‰ag
 > 1.1 && mh->
Æloˇt‹_‰ag_byãs
 > 10<<20) {

1094 
high_Æloc_‰ag
 = 1;

1095 
num_ªp‹ts
++;

1099 i‡(
mh
->
Æloˇt‹_rss
 > 1.1 && mh->
Æloˇt‹_rss_byãs
 > 10<<20) {

1100 
high_Æloc_rss
 = 1;

1101 
num_ªp‹ts
++;

1105 i‡(
mh
->
rss_exåa
 > 1.1 && mh->
rss_exåa_byãs
 > 10<<20) {

1106 
high_¥oc_rss
 = 1;

1107 
num_ªp‹ts
++;

1111 
num¶aves
 = 
	`li°Lígth
(
£rvî
.
¶aves
);

1112 
num˛õ¡s
 = 
	`li°Lígth
(
£rvî
.
˛õ¡s
)-
num¶aves
;

1113 i‡(
mh
->
˛õ¡s_n‹mÆ
 / 
num˛õ¡s
 > (1024*200)) {

1114 
big_˛õ¡_buf
 = 1;

1115 
num_ªp‹ts
++;

1119 i‡(
num¶aves
 > 0 && 
mh
->
˛õ¡s_¶aves
 /Çumslaves > (1024*1024*10)) {

1120 
big_¶ave_buf
 = 1;

1121 
num_ªp‹ts
++;

1125 i‡(
	`di˘Size
(
£rvî
.
lua_s¸ùts
) > 1000) {

1126 
m™y_s¸ùts
 = 1;

1127 
num_ªp‹ts
++;

1131 
sds
 
s
;

1132 i‡(
num_ªp‹ts
 == 0) {

1133 
s
 = 
	`sd¢ew
(

1136 } i‡(
em±y
 == 1) {

1137 
s
 = 
	`sd¢ew
(

1144 
s
 = 
	`sd¢ew
("Sam, I detectedá few issues inÅhis Redis instance memory implants:\n\n");

1145 i‡(
big_≥ak
) {

1146 
s
 = 
	`sdsˇt
(s," * Peak memory: InÅheÖastÅhis instance used moreÅhan 150%Åhe memoryÅhat is currently using. Theállocator isÇormallyÇotábleÅoÑelease memoryáfteráÖeak, so you canÉxpectÅo seeá big fragmentationÑatio, howeverÅhis isáctually harmlessánd is only dueÅoÅhe memoryÖeak,ánd ifÅhe Redis instance Resident Set Size (RSS) is currently biggerÅhanÉxpected,Åhe memory will be usedás soonás you fillÅhe Redis instance with more data. IfÅhe memoryÖeak was only occasionalánd you wantÅoÅryÅoÑeclaim memory,ÖleaseÅryÅhe MEMORY PURGE command, otherwiseÅhe only other option isÅo shutdownándÑestartÅhe instance.\n\n");

1148 i‡(
high_‰ag
) {

1149 
s
 = 
	`sdsˇçrötf
(s," * HighÅŸÆ RSS: Thi†ö°™˚ ha†®mem‹y føgmíèti⁄ánd RSS ovîhód gª©îÅh™ 1.4 (thi†món†th©ÅhêResidíàSë Sizêo‡thêRedi†¥o˚s†i†muchÜ¨gîÅh™Åhêsum o‡thêlogiˇ»Æloˇti⁄†Redi†≥rf‹med). Thi†¥obÀm i†usuÆly duêeôhîÅÿ®œrgê≥ak mem‹y (check i‡thîêi†®≥ak mem‹yÉ¡ryábovêöÅhêªp‹tË‹ mayÑesu… fromá w‹klﬂdÅh© cau£†thêÆloˇt‹Åÿ‰agmíàmem‹yáÜŸ. I‡thê¥obÀm i†®œrgê≥ak mem‹y,ÅhíÅhîêi†nÿissue. Othîwi£, makêsuª youáª usögÅhêJemÆlo¯Æloˇt‹ándÇŸÅhêdeÁu…Üib¯mÆloc. NŸe: Thêcuºíéy u£dáŒoˇt‹ i†\"%s\".\n\n", 
ZMALLOC_LIB
);

1151 i‡(
high_Æloc_‰ag
) {

1152 
s
 = 
	`sdsˇçrötf
(s," * Highállocator fragmentation: This instance hasánállocatorÉxternal fragmentation greaterÅhan 1.1. ThisÖroblem is usually dueÉitherÅoáÜargeÖeak memory (check ifÅhere isáÖeak memoryÉntryábove inÅheÑeport) or mayÑesult fromá workloadÅhat causesÅheállocatorÅo fragment memoryáÜot. You canÅryÉnabling 'activedefrag' config option.\n\n");

1154 i‡(
high_Æloc_rss
) {

1155 
s
 = 
	`sdsˇçrötf
(s," * Highállocator RSS overhead: This instance hasán RSS memory overhead is greaterÅhan 1.1 (this meansÅhatÅhe Resident Set Size ofÅheállocator is muchÜargerÅhanÅhe sum whatÅheállocatoráctually holds). ThisÖroblem is usually dueÅoáÜargeÖeak memory (check ifÅhere isáÖeak memoryÉntryábove inÅheÑeport), you canÅryÅhe MEMORY PURGE commandÅoÑeclaim it.\n\n");

1157 i‡(
high_¥oc_rss
) {

1158 
s
 = 
	`sdsˇçrötf
(s," * HighÖrocess RSS overhead: This instance hasÇon-allocator RSS memory overhead is greaterÅhan 1.1 (this meansÅhatÅhe Resident Set Size ofÅhe RedisÖrocess is muchÜargerÅhanÅhe RSSÅheállocator holds). ThisÖroblem may be dueÅo Lua scripts or Modules.\n\n");

1160 i‡(
big_¶ave_buf
) {

1161 
s
 = 
	`sdsˇt
(s," * BigÑeplica buffers: TheÑeplica output buffers inÅhis instanceáre greaterÅhan 10MB forÉachÑeplica (onáverage). ThisÜikely meansÅhatÅhere is someÑeplica instanceÅhat is strugglingÑeceiving data,Éither because it isÅoo slow or because ofÇetworking issues. AsáÑesult, dataÖiles onÅhe master output buffers. PleaseÅryÅo identify whatÑeplica isÇotÑeceiving data correctlyánd why. You can useÅhe INFO output in orderÅo checkÅheÑeplicas delaysándÅhe CLIENT LIST commandÅo checkÅhe output buffers ofÉachÑeplica.\n\n");

1163 i‡(
big_˛õ¡_buf
) {

1164 
s
 = 
	`sdsˇt
(s," * Big client buffers: The clients output buffers inÅhis instanceáre greaterÅhan 200KÖer client (onáverage). This mayÑesult from different causes,Üike Pub/Sub clients subscribedÅo channels botÇotÑeceiving data fastÉnough, soÅhat dataÖiles onÅhe Redis instance output buffer, or clients sending commands withÜargeÑeplies or veryÜarge sequences of commands inÅhe sameÖipeline. Please useÅhe CLIENT LIST command in orderÅo investigateÅhe issue if it causesÖroblems in your instance, orÅo understand better why certain clientsáre usingá bigámount of memory.\n\n");

1166 i‡(
m™y_s¸ùts
) {

1167 
s
 = 
	`sdsˇt
(s," * Many scripts: There seemÅo be many cached scripts inÅhis instance (moreÅhan 1000). This may be because scriptsáre generatedánd `EVAL`ed, instead of beingÖarameterized (with KEYSánd ARGV), `SCRIPT LOAD`edánd `EVALSHA`ed. Unless `SCRIPT FLUSH` is calledÖeriodically,Åhe scripts' caches mayÉnd up consuming most of your memory.\n\n");

1169 
s
 = 
	`sdsˇt
(s,"I'm hereÅo keep you safe, Sam. I wantÅo help you.\n");

1171 
	`‰ìMem‹yOvîhódD©a
(
mh
);

1172  
s
;

1173 
	}
}

1180 
	$obje˘SëLRUOrLFU
(
robj
 *
vÆ
, 
lfu_‰eq
, 
Ãu_idÀ
,

1181 
Ãu_˛ock
, 
Ãu_mu…ùlõr
) {

1182 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
) {

1183 i‡(
lfu_‰eq
 >= 0) {

1184 
	`£rvîAs£π
(
lfu_‰eq
 <= 255);

1185 
vÆ
->
Ãu
 = (
	`LFUGëTimeInMöuãs
()<<8Ë| 
lfu_‰eq
;

1188 } i‡(
Ãu_idÀ
 >= 0) {

1193 
Ãu_idÀ
 =Üru_idÀ*
Ãu_mu…ùlõr
/
LRU_CLOCK_RESOLUTION
;

1194 
Ãu_abs
 = 
Ãu_˛ock
 - 
Ãu_idÀ
;

1200 i‡(
Ãu_abs
 < 0)

1201 
Ãu_abs
 = (
Ãu_˛ock
+(
LRU_CLOCK_MAX
/2)) % LRU_CLOCK_MAX;

1202 
vÆ
->
Ãu
 = 
Ãu_abs
;

1206 
	}
}

1212 
robj
 *
	$obje˘Comm™dLookup
(
˛õ¡
 *
c
, 
robj
 *
key
) {

1213 
di˘E¡ry
 *
de
;

1215 i‡((
de
 = 
	`di˘Föd
(
c
->
db
->
di˘
,
key
->
±r
)Ë=
NULL
)  NULL;

1216  (
robj
*Ë
	`di˘GëVÆ
(
de
);

1217 
	}
}

1219 
robj
 *
	$obje˘Comm™dLookupOrRïly
(
˛õ¡
 *
c
, 
robj
 *
key
,Ñobj *
ª∂y
) {

1220 
robj
 *
o
 = 
	`obje˘Comm™dLookup
(
c
,
key
);

1222 i‡(!
o
Ë
	`addRïly
(
c
, 
ª∂y
);

1223  
o
;

1224 
	}
}

1228 
	$obje˘Comm™d
(
˛õ¡
 *
c
) {

1229 
robj
 *
o
;

1231 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"help")) {

1232 c⁄° *
hñp
[] = {

1237 
NULL


1239 
	`addRïlyHñp
(
c
, 
hñp
);

1240 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ªfcou¡"Ë&& c->
¨gc
 == 3) {

1241 i‡((
o
 = 
	`obje˘Comm™dLookupOrRïly
(
c
,c->
¨gv
[2],
sh¨ed
.
nuŒ
[c->
ª•
]))

1242 =
NULL
) ;

1243 
	`addRïlyL⁄gL⁄g
(
c
,
o
->
ªfcou¡
);

1244 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ícodög"Ë&& c->
¨gc
 == 3) {

1245 i‡((
o
 = 
	`obje˘Comm™dLookupOrRïly
(
c
,c->
¨gv
[2],
sh¨ed
.
nuŒ
[c->
ª•
]))

1246 =
NULL
) ;

1247 
	`addRïlyBulkCSåög
(
c
,
	`°rEncodög
(
o
->
ícodög
));

1248 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"idÀtime"Ë&& c->
¨gc
 == 3) {

1249 i‡((
o
 = 
	`obje˘Comm™dLookupOrRïly
(
c
,c->
¨gv
[2],
sh¨ed
.
nuŒ
[c->
ª•
]))

1250 =
NULL
) ;

1251 i‡(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
) {

1252 
	`addRïlyEº‹
(
c
,"An LFU maxmemoryÖolicy is selected, idleÅimeÇotÅracked. PleaseÇoteÅhat when switching betweenÖoliciesátÑuntime LRUánd LFU data willÅake someÅimeÅoádjust.");

1255 
	`addRïlyL⁄gL⁄g
(
c
,
	`e°im©eObje˘IdÀTime
(
o
)/1000);

1256 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"‰eq"Ë&& c->
¨gc
 == 3) {

1257 i‡((
o
 = 
	`obje˘Comm™dLookupOrRïly
(
c
,c->
¨gv
[2],
sh¨ed
.
nuŒ
[c->
ª•
]))

1258 =
NULL
) ;

1259 i‡(!(
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
)) {

1260 
	`addRïlyEº‹
(
c
,"An LFU maxmemoryÖolicy isÇot selected,áccess frequencyÇotÅracked. PleaseÇoteÅhat when switching betweenÖoliciesátÑuntime LRUánd LFU data willÅake someÅimeÅoádjust.");

1267 
	`addRïlyL⁄gL⁄g
(
c
,
	`LFUDe¸AndRëu∫
(
o
));

1269 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

1271 
	}
}

1277 
	$mem‹yComm™d
(
˛õ¡
 *
c
) {

1278 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"hñp"Ë&& c->
¨gc
 == 2) {

1279 c⁄° *
hñp
[] = {

1285 
NULL


1287 
	`addRïlyHñp
(
c
, 
hñp
);

1288 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ußge"Ë&& c->
¨gc
 >= 3) {

1289 
di˘E¡ry
 *
de
;

1290 
ßm∂es
 = 
OBJ_COMPUTE_SIZE_DEF_SAMPLES
;

1291 
j
 = 3; j < 
c
->
¨gc
; j++) {

1292 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"samples") &&

1293 
j
+1 < 
c
->
¨gc
)

1295 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
+1],&
ßm∂es
,
NULL
)

1296 =
C_ERR
) ;

1297 i‡(
ßm∂es
 < 0) {

1298 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

1301 i‡(
ßm∂es
 =0Ëßm∂e†
LLONG_MAX
;;

1302 
j
++;

1304 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

1308 i‡((
de
 = 
	`di˘Föd
(
c
->
db
->
di˘
,c->
¨gv
[2]->
±r
)Ë=
NULL
) {

1309 
	`addRïlyNuŒ
(
c
);

1312 
size_t
 
ußge
 = 
	`obje˘CompuãSize
(
	`di˘GëVÆ
(
de
),
ßm∂es
);

1313 
ußge
 +
	`sdsAŒocSize
(
	`di˘GëKey
(
de
));

1314 
ußge
 +(
di˘E¡ry
);

1315 
	`addRïlyL⁄gL⁄g
(
c
,
ußge
);

1316 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"°©s"Ë&& c->
¨gc
 == 2) {

1317 
ªdisMemOvîhód
 *
mh
 = 
	`gëMem‹yOvîhódD©a
();

1319 
	`addRïlyM≠Lí
(
c
,25+
mh
->
num_dbs
);

1321 
	`addRïlyBulkCSåög
(
c
,"peak.allocated");

1322 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
≥ak_Æloˇãd
);

1324 
	`addRïlyBulkCSåög
(
c
,"total.allocated");

1325 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
tŸÆ_Æloˇãd
);

1327 
	`addRïlyBulkCSåög
(
c
,"startup.allocated");

1328 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
°¨tup_Æloˇãd
);

1330 
	`addRïlyBulkCSåög
(
c
,"replication.backlog");

1331 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
ª∂_backlog
);

1333 
	`addRïlyBulkCSåög
(
c
,"clients.slaves");

1334 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
˛õ¡s_¶aves
);

1336 
	`addRïlyBulkCSåög
(
c
,"clients.normal");

1337 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
˛õ¡s_n‹mÆ
);

1339 
	`addRïlyBulkCSåög
(
c
,"aof.buffer");

1340 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
aof_buf„r
);

1342 
	`addRïlyBulkCSåög
(
c
,"lua.caches");

1343 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
lua_ˇches
);

1345 
size_t
 
j
 = 0; j < 
mh
->
num_dbs
; j++) {

1346 
db«me
[32];

1347 
	`¢¥ötf
(
db«me
,(db«me),"db.%zd",
mh
->
db
[
j
].
dbid
);

1348 
	`addRïlyBulkCSåög
(
c
,
db«me
);

1349 
	`addRïlyM≠Lí
(
c
,2);

1351 
	`addRïlyBulkCSåög
(
c
,"overhead.hashtable.main");

1352 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
db
[
j
].
ovîhód_ht_maö
);

1354 
	`addRïlyBulkCSåög
(
c
,"overhead.hashtable.expires");

1355 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
db
[
j
].
ovîhód_ht_expúes
);

1358 
	`addRïlyBulkCSåög
(
c
,"overhead.total");

1359 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
ovîhód_tŸÆ
);

1361 
	`addRïlyBulkCSåög
(
c
,"keys.count");

1362 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
tŸÆ_keys
);

1364 
	`addRïlyBulkCSåög
(
c
,"keys.bytes-per-key");

1365 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
byãs_≥r_key
);

1367 
	`addRïlyBulkCSåög
(
c
,"dataset.bytes");

1368 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
d©a£t
);

1370 
	`addRïlyBulkCSåög
(
c
,"dataset.percentage");

1371 
	`addRïlyDoubÀ
(
c
,
mh
->
d©a£t_≥rc
);

1373 
	`addRïlyBulkCSåög
(
c
,"peak.percentage");

1374 
	`addRïlyDoubÀ
(
c
,
mh
->
≥ak_≥rc
);

1376 
	`addRïlyBulkCSåög
(
c
,"allocator.allocated");

1377 
	`addRïlyL⁄gL⁄g
(
c
,
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_Æloˇãd
);

1379 
	`addRïlyBulkCSåög
(
c
,"allocator.active");

1380 
	`addRïlyL⁄gL⁄g
(
c
,
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_a˘ive
);

1382 
	`addRïlyBulkCSåög
(
c
,"allocator.resident");

1383 
	`addRïlyL⁄gL⁄g
(
c
,
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_ªsidít
);

1385 
	`addRïlyBulkCSåög
(
c
,"allocator-fragmentation.ratio");

1386 
	`addRïlyDoubÀ
(
c
,
mh
->
Æloˇt‹_‰ag
);

1388 
	`addRïlyBulkCSåög
(
c
,"allocator-fragmentation.bytes");

1389 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
Æloˇt‹_‰ag_byãs
);

1391 
	`addRïlyBulkCSåög
(
c
,"allocator-rss.ratio");

1392 
	`addRïlyDoubÀ
(
c
,
mh
->
Æloˇt‹_rss
);

1394 
	`addRïlyBulkCSåög
(
c
,"allocator-rss.bytes");

1395 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
Æloˇt‹_rss_byãs
);

1397 
	`addRïlyBulkCSåög
(
c
,"rss-overhead.ratio");

1398 
	`addRïlyDoubÀ
(
c
,
mh
->
rss_exåa
);

1400 
	`addRïlyBulkCSåög
(
c
,"rss-overhead.bytes");

1401 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
rss_exåa_byãs
);

1403 
	`addRïlyBulkCSåög
(
c
,"fragmentation");

1404 
	`addRïlyDoubÀ
(
c
,
mh
->
tŸÆ_‰ag
);

1406 
	`addRïlyBulkCSåög
(
c
,"fragmentation.bytes");

1407 
	`addRïlyL⁄gL⁄g
(
c
,
mh
->
tŸÆ_‰ag_byãs
);

1409 
	`‰ìMem‹yOvîhódD©a
(
mh
);

1410 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"mÆloc-°©s"Ë&& c->
¨gc
 == 2) {

1411 #i‡
	`deföed
(
USE_JEMALLOC
)

1412 
sds
 
öfo
 = 
	`sd£m±y
();

1413 
	`je_mÆloc_°©s_¥öt
(
öputC©Sds
, &
öfo
, 
NULL
);

1414 
	`addRïlyVîb©im
(
c
,
öfo
,
	`sd¶í
(info),"txt");

1415 
	`sds‰ì
(
öfo
);

1417 
	`addRïlyBulkCSåög
(
c
,"StatsÇot supported forÅhe currentállocator");

1419 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"do˘‹"Ë&& c->
¨gc
 == 2) {

1420 
sds
 
ªp‹t
 = 
	`gëMem‹yDo˘‹Rï‹t
();

1421 
	`addRïlyVîb©im
(
c
,
ªp‹t
,
	`sd¶í
(report),"txt");

1422 
	`sds‰ì
(
ªp‹t
);

1423 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"purge"Ë&& c->
¨gc
 == 2) {

1424 i‡(
	`jemÆloc_purge
() == 0)

1425 
	`addRïly
(
c
, 
sh¨ed
.
ok
);

1427 
	`addRïlyEº‹
(
c
, "ErrorÖurging dirtyÖages");

1429 
	`addRïlyEº‹F‹m©
(
c
, "Unknow¿subcomm™d o∏wr⁄gÇumbî o‡¨gumít†f‹ '%s'. Try MEMORY HELP", (*)c->
¨gv
[1]->
±r
);

1431 
	}
}

	@pqsort.c

40 
	~<sys/ty≥s.h
>

42 
	~<î∫o.h
>

43 
	~<°dlib.h
>

45 
ölöe
 *
med3
 (*, *, *,

47 
ölöe
 
	`sw≠func
 (*, *, 
size_t
, );

49 
	#mö
(
a
, 
b
Ë◊Ë< (bË?á : 
	)
b

54 
	#sw≠code
(
TYPE
, 
∑rmi
, 
∑rmj
, 
n
) { \

55 
size_t
 
i
 = (
n
Ë/  (
TYPE
); \

56 
TYPE
 *
pi
 = (TYPE *)(*)(
∑rmi
); \

57 
TYPE
 *
pj
 = (TYPE *)(*)(
∑rmj
); \

59 
TYPE
 
t
 = *
pi
; \

60 *
pi
++ = *
pj
; \

61 *
pj
++ = 
t
; \

62 } --
i
 > 0); \

63 
	}

	)
}

65 
	#SWAPINIT
(
a
, 
es
Ë
sw≠ty≥
 = ((*)a - (*)0) % () || \

66 
es
 % (Ë? 2 :É†=()? 0 : 1;

	)

68 
ölöe
 

69 
	$sw≠func
(*
a
, *
b
, 
size_t
 
n
, 
sw≠ty≥
)

72 i‡(
sw≠ty≥
 <= 1)

73 
	`sw≠code
(, 
a
, 
b
, 
n
)

75 
	`sw≠code
(, 
a
, 
b
, 
n
)

76 
	}
}

78 
	#sw≠
(
a
, 
b
) \

79 i‡(
sw≠ty≥
 == 0) { \

80 
t
 = *(*)(*)(
a
); \

81 *(*)(*)(
a
Ë*(*)(*)(
b
); \

82 *(*)(*)(
b
Ë
t
; \

84 
	`sw≠func
(
a
, 
b
, 
es
, 
sw≠ty≥
)

	)

86 
	#vecsw≠
(
a
, 
b
, 
n
Ëi‡(“Ë> 0Ë
	`sw≠func
(◊), (b), (
size_t
)“), 
sw≠ty≥
)

	)

88 
ölöe
 *

89 
	$med3
(*
a
, *
b
, *
c
,

90 (*
cmp
) (const *, const *))

93  
	`cmp
(
a
, 
b
) < 0 ?

94 (
	`cmp
(
b
, 
c
Ë< 0 ? b : (cmp(
a
, c) < 0 ? c :á ))

95 :(
	`cmp
(
b
, 
c
Ë> 0 ? b : (cmp(
a
, c) < 0 ?á : c ));

96 
	}
}

99 
	$_pqs‹t
(*
a
, 
size_t
 
n
, size_à
es
,

100 (*
cmp
Ë(c⁄° *, c⁄° *), *
Ã™ge
, *
º™ge
)

102 *
∑
, *
pb
, *
pc
, *
pd
, *
∂
, *
pm
, *
≤
;

103 
size_t
 
d
, 
r
;

104 
sw≠ty≥
, 
cmp_ªsu…
;

106 
lo›
: 
	`SWAPINIT
(
a
, 
es
);

107 i‡(
n
 < 7) {

108 
pm
 = (*Ë
a
 + 
es
;Öm < (*Ë®+ 
n
 *És;Öm +=És)

109 
∂
 = 
pm
;Ö»> (*Ë
a
 && 
	`cmp
’»- 
es
,Öl) > 0;

110 
∂
 -
es
)

111 
	`sw≠
(
∂
,Ö»- 
es
);

114 
pm
 = (*Ë
a
 + (
n
 / 2Ë* 
es
;

115 i‡(
n
 > 7) {

116 
∂
 = (*Ë
a
;

117 
≤
 = (*Ë
a
 + (
n
 - 1Ë* 
es
;

118 i‡(
n
 > 40) {

119 
d
 = (
n
 / 8Ë* 
es
;

120 
∂
 = 
	`med3
’l,Ö»+ 
d
,Ö»+ 2 * d, 
cmp
);

121 
pm
 = 
	`med3
’m - 
d
,Öm,Öm + d, 
cmp
);

122 
≤
 = 
	`med3
’¿- 2 * 
d
,Ö¿- d,Ön, 
cmp
);

124 
pm
 = 
	`med3
(
∂
,Öm, 
≤
, 
cmp
);

126 
	`sw≠
(
a
, 
pm
);

127 
∑
 = 
pb
 = (*Ë
a
 + 
es
;

129 
pc
 = 
pd
 = (*Ë
a
 + (
n
 - 1Ë* 
es
;

131 
pb
 <
pc
 && (
cmp_ªsu…
 = 
	`cmp
’b, 
a
)) <= 0) {

132 i‡(
cmp_ªsu…
 == 0) {

133 
	`sw≠
(
∑
, 
pb
);

134 
∑
 +
es
;

136 
pb
 +
es
;

138 
pb
 <
pc
 && (
cmp_ªsu…
 = 
	`cmp
’c, 
a
)) >= 0) {

139 i‡(
cmp_ªsu…
 == 0) {

140 
	`sw≠
(
pc
, 
pd
);

141 
pd
 -
es
;

143 
pc
 -
es
;

145 i‡(
pb
 > 
pc
)

147 
	`sw≠
(
pb
, 
pc
);

148 
pb
 +
es
;

149 
pc
 -
es
;

152 
≤
 = (*Ë
a
 + 
n
 * 
es
;

153 
r
 = 
	`mö
(
∑
 - (*Ë
a
, 
pb
 -Öa);

154 
	`vecsw≠
(
a
, 
pb
 - 
r
,Ñ);

155 
r
 = 
	`mö
((
size_t
)(
pd
 - 
pc
), 
≤
 -Öd - 
es
);

156 
	`vecsw≠
(
pb
, 
≤
 - 
r
,Ñ);

157 i‡((
r
 = 
pb
 - 
∑
Ë> 
es
) {

158 *
_l
 = 
a
, *
_r
 = ((*Ô)+
r
-1;

159 i‡(!((
Ã™ge
 < 
_l
 && 
º™ge
 < _l) ||

160 (
Ã™ge
 > 
_r
 && 
º™ge
 > _r)))

161 
	`_pqs‹t
(
a
, 
r
 / 
es
,És, 
cmp
, 
Ã™ge
, 
º™ge
);

163 i‡((
r
 = 
pd
 - 
pc
Ë> 
es
) {

164 *
_l
, *
_r
;

167 
a
 = 
≤
 - 
r
;

168 
n
 = 
r
 / 
es
;

170 
_l
 = 
a
;

171 
_r
 = ((*)
a
)+
r
-1;

172 i‡(!((
Ã™ge
 < 
_l
 && 
º™ge
 < _l) ||

173 (
Ã™ge
 > 
_r
 && 
º™ge
 > _r)))

174 
lo›
;

177 
	}
}

180 
	$pqs‹t
(*
a
, 
size_t
 
n
, size_à
es
,

181 (*
cmp
Ë(c⁄° *, c⁄° *), 
size_t
 
Ã™ge
, size_à
º™ge
)

183 
	`_pqs‹t
(
a
,
n
,
es
,
cmp
,((*Ô)+(
Ã™ge
*es),

184 ((*)
a
)+((
º™ge
+1)*
es
)-1);

185 
	}
}

	@pqsort.h

33 #i‚de‡
__PQSORT_H


34 
	#__PQSORT_H


	)

37 
pqs‹t
(*
a
, 
size_t
 
n
, size_à
es
,

38 (*
cmp
Ë(c⁄° *, c⁄° *), 
size_t
 
Ã™ge
, size_à
º™ge
);

	@pubsub.c

30 
	~"£rvî.h
"

32 
˛õ¡Subs¸ùti⁄sCou¡
(
˛õ¡
 *
c
);

43 
	$addRïlyPubsubMesßge
(
˛õ¡
 *
c
, 
robj
 *
ch™√l
,Ñobj *
msg
) {

44 i‡(
c
->
ª•
 == 2)

45 
	`addRïly
(
c
,
sh¨ed
.
mbulkhdr
[3]);

47 
	`addRïlyPushLí
(
c
,3);

48 
	`addRïly
(
c
,
sh¨ed
.
mesßgebulk
);

49 
	`addRïlyBulk
(
c
,
ch™√l
);

50 i‡(
msg
Ë
	`addRïlyBulk
(
c
,msg);

51 
	}
}

56 
	$addRïlyPubsubP©Mesßge
(
˛õ¡
 *
c
, 
robj
 *
∑t
,Ñobj *
ch™√l
,Ñobj *
msg
) {

57 i‡(
c
->
ª•
 == 2)

58 
	`addRïly
(
c
,
sh¨ed
.
mbulkhdr
[4]);

60 
	`addRïlyPushLí
(
c
,4);

61 
	`addRïly
(
c
,
sh¨ed
.
pmesßgebulk
);

62 
	`addRïlyBulk
(
c
,
∑t
);

63 
	`addRïlyBulk
(
c
,
ch™√l
);

64 
	`addRïlyBulk
(
c
,
msg
);

65 
	}
}

68 
	$addRïlyPubsubSubs¸ibed
(
˛õ¡
 *
c
, 
robj
 *
ch™√l
) {

69 i‡(
c
->
ª•
 == 2)

70 
	`addRïly
(
c
,
sh¨ed
.
mbulkhdr
[3]);

72 
	`addRïlyPushLí
(
c
,3);

73 
	`addRïly
(
c
,
sh¨ed
.
subs¸ibebulk
);

74 
	`addRïlyBulk
(
c
,
ch™√l
);

75 
	`addRïlyL⁄gL⁄g
(
c
,
	`˛õ¡Subs¸ùti⁄sCou¡
(c));

76 
	}
}

82 
	$addRïlyPubsubUnsubs¸ibed
(
˛õ¡
 *
c
, 
robj
 *
ch™√l
) {

83 i‡(
c
->
ª•
 == 2)

84 
	`addRïly
(
c
,
sh¨ed
.
mbulkhdr
[3]);

86 
	`addRïlyPushLí
(
c
,3);

87 
	`addRïly
(
c
,
sh¨ed
.
unsubs¸ibebulk
);

88 i‡(
ch™√l
)

89 
	`addRïlyBulk
(
c
,
ch™√l
);

91 
	`addRïlyNuŒ
(
c
);

92 
	`addRïlyL⁄gL⁄g
(
c
,
	`˛õ¡Subs¸ùti⁄sCou¡
(c));

93 
	}
}

96 
	$addRïlyPubsubP©Subs¸ibed
(
˛õ¡
 *
c
, 
robj
 *
∑âîn
) {

97 i‡(
c
->
ª•
 == 2)

98 
	`addRïly
(
c
,
sh¨ed
.
mbulkhdr
[3]);

100 
	`addRïlyPushLí
(
c
,3);

101 
	`addRïly
(
c
,
sh¨ed
.
psubs¸ibebulk
);

102 
	`addRïlyBulk
(
c
,
∑âîn
);

103 
	`addRïlyL⁄gL⁄g
(
c
,
	`˛õ¡Subs¸ùti⁄sCou¡
(c));

104 
	}
}

110 
	$addRïlyPubsubP©Unsubs¸ibed
(
˛õ¡
 *
c
, 
robj
 *
∑âîn
) {

111 i‡(
c
->
ª•
 == 2)

112 
	`addRïly
(
c
,
sh¨ed
.
mbulkhdr
[3]);

114 
	`addRïlyPushLí
(
c
,3);

115 
	`addRïly
(
c
,
sh¨ed
.
punsubs¸ibebulk
);

116 i‡(
∑âîn
)

117 
	`addRïlyBulk
(
c
,
∑âîn
);

119 
	`addRïlyNuŒ
(
c
);

120 
	`addRïlyL⁄gL⁄g
(
c
,
	`˛õ¡Subs¸ùti⁄sCou¡
(c));

121 
	}
}

127 
	$‰ìPubsubP©ã∫
(*
p
) {

128 
pubsubP©ã∫
 *
∑t
 = 
p
;

130 
	`de¸RefCou¡
(
∑t
->
∑âîn
);

131 
	`z‰ì
(
∑t
);

132 
	}
}

134 
	$li°M©chPubsubP©ã∫
(*
a
, *
b
) {

135 
pubsubP©ã∫
 *
∑
 = 
a
, *
pb
 = 
b
;

137  (
∑
->
˛õ¡
 =
pb
->client) &&

138 (
	`equÆSåögObje˘s
(
∑
->
∑âîn
,
pb
->pattern));

139 
	}
}

142 
	$˛õ¡Subs¸ùti⁄sCou¡
(
˛õ¡
 *
c
) {

143  
	`di˘Size
(
c
->
pubsub_ch™√ls
)+

144 
	`li°Lígth
(
c
->
pubsub_∑âîns
);

145 
	}
}

149 
	$pubsubSubs¸ibeCh™√l
(
˛õ¡
 *
c
, 
robj
 *
ch™√l
) {

150 
di˘E¡ry
 *
de
;

151 
li°
 *
˛õ¡s
 = 
NULL
;

152 
ªtvÆ
 = 0;

155 i‡(
	`di˘Add
(
c
->
pubsub_ch™√ls
,
ch™√l
,
NULL
Ë=
DICT_OK
) {

156 
ªtvÆ
 = 1;

157 
	`ö¸RefCou¡
(
ch™√l
);

159 
de
 = 
	`di˘Föd
(
£rvî
.
pubsub_ch™√ls
,
ch™√l
);

160 i‡(
de
 =
NULL
) {

161 
˛õ¡s
 = 
	`li°Cª©e
();

162 
	`di˘Add
(
£rvî
.
pubsub_ch™√ls
,
ch™√l
,
˛õ¡s
);

163 
	`ö¸RefCou¡
(
ch™√l
);

165 
˛õ¡s
 = 
	`di˘GëVÆ
(
de
);

167 
	`li°AddNodeTaû
(
˛õ¡s
,
c
);

170 
	`addRïlyPubsubSubs¸ibed
(
c
,
ch™√l
);

171  
ªtvÆ
;

172 
	}
}

176 
	$pubsubUnsubs¸ibeCh™√l
(
˛õ¡
 *
c
, 
robj
 *
ch™√l
, 
nŸify
) {

177 
di˘E¡ry
 *
de
;

178 
li°
 *
˛õ¡s
;

179 
li°Node
 *
 
;

180 
ªtvÆ
 = 0;

183 
	`ö¸RefCou¡
(
ch™√l
);

185 i‡(
	`di˘Dñëe
(
c
->
pubsub_ch™√ls
,
ch™√l
Ë=
DICT_OK
) {

186 
ªtvÆ
 = 1;

188 
de
 = 
	`di˘Föd
(
£rvî
.
pubsub_ch™√ls
,
ch™√l
);

189 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
de
 != NULL);

190 
˛õ¡s
 = 
	`di˘GëVÆ
(
de
);

191 
 
 = 
	`li°SórchKey
(
˛õ¡s
,
c
);

192 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
 
 != NULL);

193 
	`li°DñNode
(
˛õ¡s
,
 
);

194 i‡(
	`li°Lígth
(
˛õ¡s
) == 0) {

198 
	`di˘Dñëe
(
£rvî
.
pubsub_ch™√ls
,
ch™√l
);

202 i‡(
nŸify
Ë
	`addRïlyPubsubUnsubs¸ibed
(
c
,
ch™√l
);

203 
	`de¸RefCou¡
(
ch™√l
);

204  
ªtvÆ
;

205 
	}
}

208 
	$pubsubSubs¸ibeP©ã∫
(
˛õ¡
 *
c
, 
robj
 *
∑âîn
) {

209 
di˘E¡ry
 *
de
;

210 
li°
 *
˛õ¡s
;

211 
ªtvÆ
 = 0;

213 i‡(
	`li°SórchKey
(
c
->
pubsub_∑âîns
,
∑âîn
Ë=
NULL
) {

214 
ªtvÆ
 = 1;

215 
pubsubP©ã∫
 *
∑t
;

216 
	`li°AddNodeTaû
(
c
->
pubsub_∑âîns
,
∑âîn
);

217 
	`ö¸RefCou¡
(
∑âîn
);

218 
∑t
 = 
	`zmÆloc
((*pat));

219 
∑t
->
∑âîn
 = 
	`gëDecodedObje˘
(pattern);

220 
∑t
->
˛õ¡
 = 
c
;

221 
	`li°AddNodeTaû
(
£rvî
.
pubsub_∑âîns
,
∑t
);

223 
de
 = 
	`di˘Föd
(
£rvî
.
pubsub_∑âîns_di˘
,
∑âîn
);

224 i‡(
de
 =
NULL
) {

225 
˛õ¡s
 = 
	`li°Cª©e
();

226 
	`di˘Add
(
£rvî
.
pubsub_∑âîns_di˘
,
∑âîn
,
˛õ¡s
);

227 
	`ö¸RefCou¡
(
∑âîn
);

229 
˛õ¡s
 = 
	`di˘GëVÆ
(
de
);

231 
	`li°AddNodeTaû
(
˛õ¡s
,
c
);

234 
	`addRïlyPubsubP©Subs¸ibed
(
c
,
∑âîn
);

235  
ªtvÆ
;

236 
	}
}

240 
	$pubsubUnsubs¸ibeP©ã∫
(
˛õ¡
 *
c
, 
robj
 *
∑âîn
, 
nŸify
) {

241 
di˘E¡ry
 *
de
;

242 
li°
 *
˛õ¡s
;

243 
li°Node
 *
 
;

244 
pubsubP©ã∫
 
∑t
;

245 
ªtvÆ
 = 0;

247 
	`ö¸RefCou¡
(
∑âîn
);

248 i‡((
 
 = 
	`li°SórchKey
(
c
->
pubsub_∑âîns
,
∑âîn
)Ë!
NULL
) {

249 
ªtvÆ
 = 1;

250 
	`li°DñNode
(
c
->
pubsub_∑âîns
,
 
);

251 
∑t
.
˛õ¡
 = 
c
;

252 
∑t
.
∑âîn
 =Öattern;

253 
 
 = 
	`li°SórchKey
(
£rvî
.
pubsub_∑âîns
,&
∑t
);

254 
	`li°DñNode
(
£rvî
.
pubsub_∑âîns
,
 
);

256 
de
 = 
	`di˘Föd
(
£rvî
.
pubsub_∑âîns_di˘
,
∑âîn
);

257 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
de
 != NULL);

258 
˛õ¡s
 = 
	`di˘GëVÆ
(
de
);

259 
 
 = 
	`li°SórchKey
(
˛õ¡s
,
c
);

260 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
 
 != NULL);

261 
	`li°DñNode
(
˛õ¡s
,
 
);

262 i‡(
	`li°Lígth
(
˛õ¡s
) == 0) {

265 
	`di˘Dñëe
(
£rvî
.
pubsub_∑âîns_di˘
,
∑âîn
);

269 i‡(
nŸify
Ë
	`addRïlyPubsubP©Unsubs¸ibed
(
c
,
∑âîn
);

270 
	`de¸RefCou¡
(
∑âîn
);

271  
ªtvÆ
;

272 
	}
}

276 
	$pubsubUnsubs¸ibeAŒCh™√ls
(
˛õ¡
 *
c
, 
nŸify
) {

277 
di˘Iãøt‹
 *
di
 = 
	`di˘GëSa„Iãøt‹
(
c
->
pubsub_ch™√ls
);

278 
di˘E¡ry
 *
de
;

279 
cou¡
 = 0;

281 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

282 
robj
 *
ch™√l
 = 
	`di˘GëKey
(
de
);

284 
cou¡
 +
	`pubsubUnsubs¸ibeCh™√l
(
c
,
ch™√l
,
nŸify
);

287 i‡(
nŸify
 && 
cou¡
 =0Ë
	`addRïlyPubsubUnsubs¸ibed
(
c
,
NULL
);

288 
	`di˘Rñó£Iãøt‹
(
di
);

289  
cou¡
;

290 
	}
}

294 
	$pubsubUnsubs¸ibeAŒP©ã∫s
(
˛õ¡
 *
c
, 
nŸify
) {

295 
li°Node
 *
 
;

296 
li°Iãr
 
li
;

297 
cou¡
 = 0;

299 
	`li°Rewöd
(
c
->
pubsub_∑âîns
,&
li
);

300 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

301 
robj
 *
∑âîn
 = 
 
->
vÆue
;

303 
cou¡
 +
	`pubsubUnsubs¸ibeP©ã∫
(
c
,
∑âîn
,
nŸify
);

305 i‡(
nŸify
 && 
cou¡
 =0Ë
	`addRïlyPubsubP©Unsubs¸ibed
(
c
,
NULL
);

306  
cou¡
;

307 
	}
}

310 
	$pubsubPublishMesßge
(
robj
 *
ch™√l
,Ñobj *
mesßge
) {

311 
ª˚ivîs
 = 0;

312 
di˘E¡ry
 *
de
;

313 
di˘Iãøt‹
 *
di
;

314 
li°Node
 *
 
;

315 
li°Iãr
 
li
;

318 
de
 = 
	`di˘Föd
(
£rvî
.
pubsub_ch™√ls
,
ch™√l
);

319 i‡(
de
) {

320 
li°
 *li° = 
	`di˘GëVÆ
(
de
);

321 
li°Node
 *
 
;

322 
li°Iãr
 
li
;

324 
	`li°Rewöd
(
li°
,&
li
);

325 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

326 
˛õ¡
 *
c
 = 
 
->
vÆue
;

327 
	`addRïlyPubsubMesßge
(
c
,
ch™√l
,
mesßge
);

328 
ª˚ivîs
++;

332 
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
pubsub_∑âîns_di˘
);

333 i‡(
di
) {

334 
ch™√l
 = 
	`gëDecodedObje˘
(channel);

335 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

336 
robj
 *
∑âîn
 = 
	`di˘GëKey
(
de
);

337 
li°
 *
˛õ¡s
 = 
	`di˘GëVÆ
(
de
);

338 i‡(!
	`°rögm©chÀn
((*)
∑âîn
->
±r
,

339 
	`sd¶í
(
∑âîn
->
±r
),

340 (*)
ch™√l
->
±r
,

341 
	`sd¶í
(
ch™√l
->
±r
),0)) ;

343 
	`li°Rewöd
(
˛õ¡s
,&
li
);

344 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

345 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

346 
	`addRïlyPubsubP©Mesßge
(
c
,
∑âîn
,
ch™√l
,
mesßge
);

347 
ª˚ivîs
++;

350 
	`de¸RefCou¡
(
ch™√l
);

351 
	`di˘Rñó£Iãøt‹
(
di
);

353  
ª˚ivîs
;

354 
	}
}

360 
	$subs¸ibeComm™d
(
˛õ¡
 *
c
) {

361 
j
;

363 
j
 = 1; j < 
c
->
¨gc
; j++)

364 
	`pubsubSubs¸ibeCh™√l
(
c
,c->
¨gv
[
j
]);

365 
c
->
Êags
 |
CLIENT_PUBSUB
;

366 
	}
}

368 
	$unsubs¸ibeComm™d
(
˛õ¡
 *
c
) {

369 i‡(
c
->
¨gc
 == 1) {

370 
	`pubsubUnsubs¸ibeAŒCh™√ls
(
c
,1);

372 
j
;

374 
j
 = 1; j < 
c
->
¨gc
; j++)

375 
	`pubsubUnsubs¸ibeCh™√l
(
c
,c->
¨gv
[
j
],1);

377 i‡(
	`˛õ¡Subs¸ùti⁄sCou¡
(
c
Ë=0Ëc->
Êags
 &~
CLIENT_PUBSUB
;

378 
	}
}

380 
	$psubs¸ibeComm™d
(
˛õ¡
 *
c
) {

381 
j
;

383 
j
 = 1; j < 
c
->
¨gc
; j++)

384 
	`pubsubSubs¸ibeP©ã∫
(
c
,c->
¨gv
[
j
]);

385 
c
->
Êags
 |
CLIENT_PUBSUB
;

386 
	}
}

388 
	$punsubs¸ibeComm™d
(
˛õ¡
 *
c
) {

389 i‡(
c
->
¨gc
 == 1) {

390 
	`pubsubUnsubs¸ibeAŒP©ã∫s
(
c
,1);

392 
j
;

394 
j
 = 1; j < 
c
->
¨gc
; j++)

395 
	`pubsubUnsubs¸ibeP©ã∫
(
c
,c->
¨gv
[
j
],1);

397 i‡(
	`˛õ¡Subs¸ùti⁄sCou¡
(
c
Ë=0Ëc->
Êags
 &~
CLIENT_PUBSUB
;

398 
	}
}

400 
	$publishComm™d
(
˛õ¡
 *
c
) {

401 
ª˚ivîs
 = 
	`pubsubPublishMesßge
(
c
->
¨gv
[1],c->argv[2]);

402 i‡(
£rvî
.
˛u°î_íabÀd
)

403 
	`˛u°îPr›ag©ePublish
(
c
->
¨gv
[1],c->argv[2]);

405 
	`f‹˚Comm™dPr›ag©i⁄
(
c
,
PROPAGATE_REPL
);

406 
	`addRïlyL⁄gL⁄g
(
c
,
ª˚ivîs
);

407 
	}
}

410 
	$pubsubComm™d
(
˛õ¡
 *
c
) {

411 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"help")) {

412 c⁄° *
hñp
[] = {

416 
NULL


418 
	`addRïlyHñp
(
c
, 
hñp
);

419 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"channels") &&

420 (
c
->
¨gc
 == 2 || c->argc == 3))

423 
sds
 
∑t
 = (
c
->
¨gc
 =2Ë? 
NULL
 : c->
¨gv
[2]->
±r
;

424 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
pubsub_ch™√ls
);

425 
di˘E¡ry
 *
de
;

426 
mbÀn
 = 0;

427 *
ª∂yÀn
;

429 
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

430 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

431 
robj
 *
cobj
 = 
	`di˘GëKey
(
de
);

432 
sds
 
ch™√l
 = 
cobj
->
±r
;

434 i‡(!
∑t
 || 
	`°rögm©chÀn
’©, 
	`sd¶í
(pat),

435 
ch™√l
, 
	`sd¶í
(channel),0))

437 
	`addRïlyBulk
(
c
,
cobj
);

438 
mbÀn
++;

441 
	`di˘Rñó£Iãøt‹
(
di
);

442 
	`£tDe„ºedAºayLí
(
c
,
ª∂yÀn
,
mbÀn
);

443 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"numsub"Ë&& c->
¨gc
 >= 2) {

445 
j
;

447 
	`addRïlyAºayLí
(
c
,(c->
¨gc
-2)*2);

448 
j
 = 2; j < 
c
->
¨gc
; j++) {

449 
li°
 *
l
 = 
	`di˘FëchVÆue
(
£rvî
.
pubsub_ch™√ls
,
c
->
¨gv
[
j
]);

451 
	`addRïlyBulk
(
c
,c->
¨gv
[
j
]);

452 
	`addRïlyL⁄gL⁄g
(
c
,
l
 ? 
	`li°Lígth
(l) : 0);

454 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"num∑t"Ë&& c->
¨gc
 == 2) {

456 
	`addRïlyL⁄gL⁄g
(
c
,
	`li°Lígth
(
£rvî
.
pubsub_∑âîns
));

458 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

460 
	}
}

	@quicklist.c

31 
	~<°rög.h
>

32 
	~"quickli°.h
"

33 
	~"zmÆloc.h
"

34 
	~"zùli°.h
"

35 
	~"utû.h
"

36 
	~"lzf.h
"

38 #i‡
deföed
(
REDIS_TEST
Ë|| deföed(
REDIS_TEST_VERBOSE
)

39 
	~<°dio.h
>

42 #i‚de‡
REDIS_STATIC


43 
	#REDIS_STATIC
 

	)

47 c⁄° 
size_t
 
	g›timiz©i⁄_Àvñ
[] = {4096, 8192, 16384, 32768, 65536};

51 
	#SIZE_SAFETY_LIMIT
 8192

	)

54 
	#MIN_COMPRESS_BYTES
 48

	)

59 
	#MIN_COMPRESS_IMPROVE
 8

	)

62 #i‚de‡
REDIS_TEST_VERBOSE


63 
	#D
(...)

	)

65 
	#D
(...) \

67 
	`¥ötf
("%s:%s:%d:\t", 
__FILE__
, 
__FUNCTION__
, 
__LINE__
); \

68 
	`¥ötf
(
__VA_ARGS__
); \

69 
	`¥ötf
("\n"); \

70 } 0);

	)

74 
	#QL_MAX_BM
 ((1 << 
QL_BM_BITS
)-1)

	)

75 
quickli°Bookm¨k
 *
_quickli°Bookm¨kFödByName
(
quickli°
 *
ql
, c⁄° *
«me
);

76 
quickli°Bookm¨k
 *
_quickli°Bookm¨kFödByNode
(
quickli°
 *
ql
, 
quickli°Node
 *
node
);

77 
_quickli°Bookm¨kDñëe
(
quickli°
 *
ql
, 
quickli°Bookm¨k
 *
bm
);

80 
	#öôE¡ry
(
e
) \

82 (
e
)->
zi
 = (e)->
vÆue
 = 
NULL
; \

83 (
e
)->
l⁄gvÆ
 = -123456789; \

84 (
e
)->
quickli°
 = 
NULL
; \

85 (
e
)->
node
 = 
NULL
; \

86 (
e
)->
off£t
 = 123456789; \

87 (
e
)->
sz
 = 0; \

88 } 0)

	)

90 #i‡
__GNUC__
 >= 3

91 
	#likñy
(
x
Ë
	`__buûtö_ex≥˘
(!!(x), 1)

	)

92 
	#u∆ikñy
(
x
Ë
	`__buûtö_ex≥˘
(!!(x), 0)

	)

94 
	#likñy
(
x
Ë(x)

	)

95 
	#u∆ikñy
(
x
Ë(x)

	)

100 
quickli°
 *
	$quickli°Cª©e
() {

101 
quickli°
 *quicklist;

103 
quickli°
 = 
	`zmÆloc
((*quicklist));

104 
quickli°
->
hód
 = quickli°->
èû
 = 
NULL
;

105 
quickli°
->
Àn
 = 0;

106 
quickli°
->
cou¡
 = 0;

107 
quickli°
->
com¥ess
 = 0;

108 
quickli°
->
fûl
 = -2;

109 
quickli°
->
bookm¨k_cou¡
 = 0;

110  
quickli°
;

111 
	}
}

113 
	#COMPRESS_MAX
 ((1 << 
QL_COMP_BITS
)-1)

	)

114 
	$quickli°SëCom¥essDïth
(
quickli°
 *quickli°, 
com¥ess
) {

115 i‡(
com¥ess
 > 
COMPRESS_MAX
) {

116 
com¥ess
 = 
COMPRESS_MAX
;

117 } i‡(
com¥ess
 < 0) {

118 
com¥ess
 = 0;

120 
quickli°
->
com¥ess
 = compress;

121 
	}
}

123 
	#FILL_MAX
 ((1 << (
QL_FILL_BITS
-1))-1)

	)

124 
	$quickli°SëFûl
(
quickli°
 *quickli°, 
fûl
) {

125 i‡(
fûl
 > 
FILL_MAX
) {

126 
fûl
 = 
FILL_MAX
;

127 } i‡(
fûl
 < -5) {

128 
fûl
 = -5;

130 
quickli°
->
fûl
 = fill;

131 
	}
}

133 
	$quickli°SëO±i⁄s
(
quickli°
 *quickli°, 
fûl
, 
dïth
) {

134 
	`quickli°SëFûl
(
quickli°
, 
fûl
);

135 
	`quickli°SëCom¥essDïth
(
quickli°
, 
dïth
);

136 
	}
}

139 
quickli°
 *
	$quickli°New
(
fûl
, 
com¥ess
) {

140 
quickli°
 *quickli° = 
	`quickli°Cª©e
();

141 
	`quickli°SëO±i⁄s
(
quickli°
, 
fûl
, 
com¥ess
);

142  
quickli°
;

143 
	}
}

145 
REDIS_STATIC
 
quickli°Node
 *
	$quickli°Cª©eNode
() {

146 
quickli°Node
 *
node
;

147 
node
 = 
	`zmÆloc
((*node));

148 
node
->
zl
 = 
NULL
;

149 
node
->
cou¡
 = 0;

150 
node
->
sz
 = 0;

151 
node
->
√xt
 =Çode->
¥ev
 = 
NULL
;

152 
node
->
ícodög
 = 
QUICKLIST_NODE_ENCODING_RAW
;

153 
node
->
c⁄èöî
 = 
QUICKLIST_NODE_CONTAINER_ZIPLIST
;

154 
node
->
ªcom¥ess
 = 0;

155  
node
;

156 
	}
}

159 
	$quickli°Cou¡
(c⁄° 
quickli°
 *
ql
Ë{  ql->
cou¡
; 
	}
}

162 
	$quickli°Rñó£
(
quickli°
 *quicklist) {

163 
Àn
;

164 
quickli°Node
 *
cuºít
, *
√xt
;

166 
cuºít
 = 
quickli°
->
hód
;

167 
Àn
 = 
quickli°
->len;

168 
Àn
--) {

169 
√xt
 = 
cuºít
->next;

171 
	`z‰ì
(
cuºít
->
zl
);

172 
quickli°
->
cou¡
 -
cuºít
->count;

174 
	`z‰ì
(
cuºít
);

176 
quickli°
->
Àn
--;

177 
cuºít
 = 
√xt
;

179 
	`quickli°Bookm¨ksCÀ¨
(
quickli°
);

180 
	`z‰ì
(
quickli°
);

181 
	}
}

186 
REDIS_STATIC
 
	$__quickli°Com¥essNode
(
quickli°Node
 *
node
) {

187 #ifde‡
REDIS_TEST


188 
node
->
©ãm±ed_com¥ess
 = 1;

192 i‡(
node
->
sz
 < 
MIN_COMPRESS_BYTES
)

195 
quickli°LZF
 *
lzf
 = 
	`zmÆloc
((*lzfË+ 
node
->
sz
);

198 i‡(((
lzf
->
sz
 = 
	`lzf_com¥ess
(
node
->
zl
,Çode->sz,Üzf->
com¥es£d
,

199 
node
->
sz
)) == 0) ||

200 
lzf
->
sz
 + 
MIN_COMPRESS_IMPROVE
 >
node
->sz) {

202 
	`z‰ì
(
lzf
);

205 
lzf
 = 
	`zªÆloc
÷zf, (*lzfË+Üzf->
sz
);

206 
	`z‰ì
(
node
->
zl
);

207 
node
->
zl
 = (*)
lzf
;

208 
node
->
ícodög
 = 
QUICKLIST_NODE_ENCODING_LZF
;

209 
node
->
ªcom¥ess
 = 0;

211 
	}
}

214 
	#quickli°Com¥essNode
(
_node
) \

216 i‡((
_node
Ë&& (_node)->
ícodög
 =
QUICKLIST_NODE_ENCODING_RAW
) { \

217 
	`__quickli°Com¥essNode
((
_node
)); \

219 } 0)

	)

223 
REDIS_STATIC
 
	$__quickli°Decom¥essNode
(
quickli°Node
 *
node
) {

224 #ifde‡
REDIS_TEST


225 
node
->
©ãm±ed_com¥ess
 = 0;

228 *
decom¥es£d
 = 
	`zmÆloc
(
node
->
sz
);

229 
quickli°LZF
 *
lzf
 = (quickli°LZF *)
node
->
zl
;

230 i‡(
	`lzf_decom¥ess
(
lzf
->
com¥es£d
,Üzf->
sz
, 
decom¥es£d
, 
node
->sz) == 0) {

232 
	`z‰ì
(
decom¥es£d
);

235 
	`z‰ì
(
lzf
);

236 
node
->
zl
 = 
decom¥es£d
;

237 
node
->
ícodög
 = 
QUICKLIST_NODE_ENCODING_RAW
;

239 
	}
}

242 
	#quickli°Decom¥essNode
(
_node
) \

244 i‡((
_node
Ë&& (_node)->
ícodög
 =
QUICKLIST_NODE_ENCODING_LZF
) { \

245 
	`__quickli°Decom¥essNode
((
_node
)); \

247 } 0)

	)

250 
	#quickli°Decom¥essNodeF‹U£
(
_node
) \

252 i‡((
_node
Ë&& (_node)->
ícodög
 =
QUICKLIST_NODE_ENCODING_LZF
) { \

253 
	`__quickli°Decom¥essNode
((
_node
)); \

254 (
_node
)->
ªcom¥ess
 = 1; \

256 } 0)

	)

261 
size_t
 
	$quickli°GëLzf
(c⁄° 
quickli°Node
 *
node
, **
d©a
) {

262 
quickli°LZF
 *
lzf
 = (quickli°LZF *)
node
->
zl
;

263 *
d©a
 = 
lzf
->
com¥es£d
;

264  
lzf
->
sz
;

265 
	}
}

267 
	#quickli°AŒowsCom¥essi⁄
(
_ql
Ë((_ql)->
com¥ess
 !0)

	)

273 
REDIS_STATIC
 
	$__quickli°Com¥ess
(c⁄° 
quickli°
 *quicklist,

274 
quickli°Node
 *
node
) {

277 i‡(!
	`quickli°AŒowsCom¥essi⁄
(
quickli°
) ||

278 
quickli°
->
Àn
 < ()(quickli°->
com¥ess
 * 2))

283 i‡(
quickli°
->
com¥ess
 == 1) {

284 
quickli°Node
 *
h
 = 
quickli°
->
hód
, *
t
 = quickli°->
èû
;

285 
	`quickli°Decom¥essNode
(
h
);

286 
	`quickli°Decom¥essNode
(
t
);

287 i‡(
h
 !
node
 && 
t
 !=Çode)

288 
	`quickli°Com¥essNode
(
node
);

290 } i‡(
quickli°
->
com¥ess
 == 2) {

291 
quickli°Node
 *
h
 = 
quickli°
->
hód
, *
hn
 = h->
√xt
, *
h¬
 = hn->next;

292 
quickli°Node
 *
t
 = 
quickli°
->
èû
, *
ç
 =Å->
¥ev
, *
çp
 =Åp->prev;

293 
	`quickli°Decom¥essNode
(
h
);

294 
	`quickli°Decom¥essNode
(
hn
);

295 
	`quickli°Decom¥essNode
(
t
);

296 
	`quickli°Decom¥essNode
(
ç
);

297 i‡(
h
 !
node
 && 
hn
 !nodê&& 
t
 !nodê&& 
ç
 !=Çode) {

298 
	`quickli°Com¥essNode
(
node
);

300 i‡(
h¬
 !
t
) {

301 
	`quickli°Com¥essNode
(
h¬
);

303 i‡(
çp
 !
h
) {

304 
	`quickli°Com¥essNode
(
çp
);

313 
quickli°Node
 *
f‹w¨d
 = 
quickli°
->
hód
;

314 
quickli°Node
 *
ªvî£
 = 
quickli°
->
èû
;

315 
dïth
 = 0;

316 
ö_dïth
 = 0;

317 
dïth
++ < 
quickli°
->
com¥ess
) {

318 
	`quickli°Decom¥essNode
(
f‹w¨d
);

319 
	`quickli°Decom¥essNode
(
ªvî£
);

321 i‡(
f‹w¨d
 =
node
 || 
ªvî£
 ==Çode)

322 
ö_dïth
 = 1;

324 i‡(
f‹w¨d
 =
ªvî£
)

327 
f‹w¨d
 = f‹w¨d->
√xt
;

328 
ªvî£
 =Ñevî£->
¥ev
;

331 i‡(!
ö_dïth
)

332 
	`quickli°Com¥essNode
(
node
);

334 i‡(
dïth
 > 2) {

336 
	`quickli°Com¥essNode
(
f‹w¨d
);

337 
	`quickli°Com¥essNode
(
ªvî£
);

339 
	}
}

341 
	#quickli°Com¥ess
(
_ql
, 
_node
) \

343 i‡((
_node
)->
ªcom¥ess
) \

344 
	`quickli°Com¥essNode
((
_node
)); \

346 
	`__quickli°Com¥ess
((
_ql
), (
_node
)); \

347 } 0)

	)

350 
	#quickli°Recom¥essO∆y
(
_ql
, 
_node
) \

352 i‡((
_node
)->
ªcom¥ess
) \

353 
	`quickli°Com¥essNode
((
_node
)); \

354 } 0)

	)

360 
REDIS_STATIC
 
	$__quickli°In£πNode
(
quickli°
 *quicklist,

361 
quickli°Node
 *
ﬁd_node
,

362 
quickli°Node
 *
√w_node
, 
a·î
) {

363 i‡(
a·î
) {

364 
√w_node
->
¥ev
 = 
ﬁd_node
;

365 i‡(
ﬁd_node
) {

366 
√w_node
->
√xt
 = 
ﬁd_node
->next;

367 i‡(
ﬁd_node
->
√xt
)

368 
ﬁd_node
->
√xt
->
¥ev
 = 
√w_node
;

369 
ﬁd_node
->
√xt
 = 
√w_node
;

371 i‡(
quickli°
->
èû
 =
ﬁd_node
)

372 
quickli°
->
èû
 = 
√w_node
;

374 
√w_node
->
√xt
 = 
ﬁd_node
;

375 i‡(
ﬁd_node
) {

376 
√w_node
->
¥ev
 = 
ﬁd_node
->prev;

377 i‡(
ﬁd_node
->
¥ev
)

378 
ﬁd_node
->
¥ev
->
√xt
 = 
√w_node
;

379 
ﬁd_node
->
¥ev
 = 
√w_node
;

381 i‡(
quickli°
->
hód
 =
ﬁd_node
)

382 
quickli°
->
hód
 = 
√w_node
;

385 i‡(
quickli°
->
Àn
 == 0) {

386 
quickli°
->
hód
 = quickli°->
èû
 = 
√w_node
;

389 i‡(
ﬁd_node
)

390 
	`quickli°Com¥ess
(
quickli°
, 
ﬁd_node
);

392 
quickli°
->
Àn
++;

393 
	}
}

396 
REDIS_STATIC
 
	$_quickli°In£πNodeBef‹e
(
quickli°
 *quicklist,

397 
quickli°Node
 *
ﬁd_node
,

398 
quickli°Node
 *
√w_node
) {

399 
	`__quickli°In£πNode
(
quickli°
, 
ﬁd_node
, 
√w_node
, 0);

400 
	}
}

402 
REDIS_STATIC
 
	$_quickli°In£πNodeA·î
(
quickli°
 *quicklist,

403 
quickli°Node
 *
ﬁd_node
,

404 
quickli°Node
 *
√w_node
) {

405 
	`__quickli°In£πNode
(
quickli°
, 
ﬁd_node
, 
√w_node
, 1);

406 
	}
}

408 
REDIS_STATIC
 

409 
	$_quickli°NodeSizeMìtsO±imiz©i⁄Requúemít
(c⁄° 
size_t
 
sz
,

410 c⁄° 
fûl
) {

411 i‡(
fûl
 >= 0)

414 
size_t
 
off£t
 = (-
fûl
) - 1;

415 i‡(
off£t
 < ((
›timiz©i⁄_Àvñ
) / (*optimization_level))) {

416 i‡(
sz
 <
›timiz©i⁄_Àvñ
[
off£t
]) {

424 
	}
}

426 
	#sizeMìtsSa„tyLimô
(
sz
Ë((szË<
SIZE_SAFETY_LIMIT
)

	)

428 
REDIS_STATIC
 
	$_quickli°NodeAŒowIn£π
(c⁄° 
quickli°Node
 *
node
,

429 c⁄° 
fûl
, c⁄° 
size_t
 
sz
) {

430 i‡(
	`u∆ikñy
(!
node
))

433 
zùli°_ovîhód
;

435 i‡(
sz
 < 254)

436 
zùli°_ovîhód
 = 1;

438 
zùli°_ovîhód
 = 5;

441 i‡(
sz
 < 64)

442 
zùli°_ovîhód
 += 1;

443 i‡(
	`likñy
(
sz
 < 16384))

444 
zùli°_ovîhód
 += 2;

446 
zùli°_ovîhód
 += 5;

449 
√w_sz
 = 
node
->
sz
 + sz + 
zùli°_ovîhód
;

450 i‡(
	`likñy
(
	`_quickli°NodeSizeMìtsO±imiz©i⁄Requúemít
(
√w_sz
, 
fûl
)))

452 i‡(!
	`sizeMìtsSa„tyLimô
(
√w_sz
))

454 i‡(()
node
->
cou¡
 < 
fûl
)

458 
	}
}

460 
REDIS_STATIC
 
	$_quickli°NodeAŒowMîge
(c⁄° 
quickli°Node
 *
a
,

461 c⁄° 
quickli°Node
 *
b
,

462 c⁄° 
fûl
) {

463 i‡(!
a
 || !
b
)

468 
mîge_sz
 = 
a
->
sz
 + 
b
->sz - 11;

469 i‡(
	`likñy
(
	`_quickli°NodeSizeMìtsO±imiz©i⁄Requúemít
(
mîge_sz
, 
fûl
)))

471 i‡(!
	`sizeMìtsSa„tyLimô
(
mîge_sz
))

473 i‡(()(
a
->
cou¡
 + 
b
->cou¡Ë<
fûl
)

477 
	}
}

479 
	#quickli°NodeUpd©eSz
(
node
) \

481 (
node
)->
sz
 = 
	`zùli°BlobLí
(“ode)->
zl
); \

482 } 0)

	)

488 
	$quickli°PushHód
(
quickli°
 *quickli°, *
vÆue
, 
size_t
 
sz
) {

489 
quickli°Node
 *
‹ig_hód
 = 
quickli°
->
hód
;

490 i‡(
	`likñy
(

491 
	`_quickli°NodeAŒowIn£π
(
quickli°
->
hód
, quickli°->
fûl
, 
sz
))) {

492 
quickli°
->
hód
->
zl
 =

493 
	`zùli°Push
(
quickli°
->
hód
->
zl
, 
vÆue
, 
sz
, 
ZIPLIST_HEAD
);

494 
	`quickli°NodeUpd©eSz
(
quickli°
->
hód
);

496 
quickli°Node
 *
node
 = 
	`quickli°Cª©eNode
();

497 
node
->
zl
 = 
	`zùli°Push
(
	`zùli°New
(), 
vÆue
, 
sz
, 
ZIPLIST_HEAD
);

499 
	`quickli°NodeUpd©eSz
(
node
);

500 
	`_quickli°In£πNodeBef‹e
(
quickli°
, quickli°->
hód
, 
node
);

502 
quickli°
->
cou¡
++;

503 
quickli°
->
hód
->
cou¡
++;

504  (
‹ig_hód
 !
quickli°
->
hód
);

505 
	}
}

511 
	$quickli°PushTaû
(
quickli°
 *quickli°, *
vÆue
, 
size_t
 
sz
) {

512 
quickli°Node
 *
‹ig_èû
 = 
quickli°
->
èû
;

513 i‡(
	`likñy
(

514 
	`_quickli°NodeAŒowIn£π
(
quickli°
->
èû
, quickli°->
fûl
, 
sz
))) {

515 
quickli°
->
èû
->
zl
 =

516 
	`zùli°Push
(
quickli°
->
èû
->
zl
, 
vÆue
, 
sz
, 
ZIPLIST_TAIL
);

517 
	`quickli°NodeUpd©eSz
(
quickli°
->
èû
);

519 
quickli°Node
 *
node
 = 
	`quickli°Cª©eNode
();

520 
node
->
zl
 = 
	`zùli°Push
(
	`zùli°New
(), 
vÆue
, 
sz
, 
ZIPLIST_TAIL
);

522 
	`quickli°NodeUpd©eSz
(
node
);

523 
	`_quickli°In£πNodeA·î
(
quickli°
, quickli°->
èû
, 
node
);

525 
quickli°
->
cou¡
++;

526 
quickli°
->
èû
->
cou¡
++;

527  (
‹ig_èû
 !
quickli°
->
èû
);

528 
	}
}

533 
	$quickli°AµídZùli°
(
quickli°
 *quickli°, *
zl
) {

534 
quickli°Node
 *
node
 = 
	`quickli°Cª©eNode
();

536 
node
->
zl
 = zl;

537 
node
->
cou¡
 = 
	`zùli°Lí
“ode->
zl
);

538 
node
->
sz
 = 
	`zùli°BlobLí
(
zl
);

540 
	`_quickli°In£πNodeA·î
(
quickli°
, quickli°->
èû
, 
node
);

541 
quickli°
->
cou¡
 +
node
->count;

542 
	}
}

550 
quickli°
 *
	$quickli°AµídVÆuesFromZùli°
(
quickli°
 *quicklist,

551 *
zl
) {

552 *
vÆue
;

553 
sz
;

554 
l⁄gvÆ
;

555 
l⁄g°r
[32] = {0};

557 *
p
 = 
	`zùli°Index
(
zl
, 0);

558 
	`zùli°Gë
(
p
, &
vÆue
, &
sz
, &
l⁄gvÆ
)) {

559 i‡(!
vÆue
) {

561 
sz
 = 
	`Œ2°rög
(
l⁄g°r
, ÷⁄g°r), 
l⁄gvÆ
);

562 
vÆue
 = (*)
l⁄g°r
;

564 
	`quickli°PushTaû
(
quickli°
, 
vÆue
, 
sz
);

565 
p
 = 
	`zùli°Next
(
zl
,Ö);

567 
	`z‰ì
(
zl
);

568  
quickli°
;

569 
	}
}

574 
quickli°
 *
	$quickli°Cª©eFromZùli°
(
fûl
, 
com¥ess
,

575 *
zl
) {

576  
	`quickli°AµídVÆuesFromZùli°
(
	`quickli°New
(
fûl
, 
com¥ess
), 
zl
);

577 
	}
}

579 
	#quickli°DñëeIfEm±y
(
ql
, 
n
) \

581 i‡((
n
)->
cou¡
 == 0) { \

582 
	`__quickli°DñNode
((
ql
), (
n
)); \

583 (
n
Ë
NULL
; \

585 } 0)

	)

587 
REDIS_STATIC
 
	$__quickli°DñNode
(
quickli°
 *quicklist,

588 
quickli°Node
 *
node
) {

590 
quickli°Bookm¨k
 *
bm
 = 
	`_quickli°Bookm¨kFödByNode
(
quickli°
, 
node
);

591 i‡(
bm
) {

592 
bm
->
node
 =Çode->
√xt
;

594 i‡(!
bm
->
node
)

595 
	`_quickli°Bookm¨kDñëe
(
quickli°
, 
bm
);

598 i‡(
node
->
√xt
)

599 
node
->
√xt
->
¥ev
 =Çode->prev;

600 i‡(
node
->
¥ev
)

601 
node
->
¥ev
->
√xt
 =Çode->next;

603 i‡(
node
 =
quickli°
->
èû
) {

604 
quickli°
->
èû
 = 
node
->
¥ev
;

607 i‡(
node
 =
quickli°
->
hód
) {

608 
quickli°
->
hód
 = 
node
->
√xt
;

613 
	`__quickli°Com¥ess
(
quickli°
, 
NULL
);

615 
quickli°
->
cou¡
 -
node
->count;

617 
	`z‰ì
(
node
->
zl
);

618 
	`z‰ì
(
node
);

619 
quickli°
->
Àn
--;

620 
	}
}

630 
REDIS_STATIC
 
	$quickli°DñIndex
(
quickli°
 *quickli°, 
quickli°Node
 *
node
,

631 **
p
) {

632 
g⁄e
 = 0;

634 
node
->
zl
 = 
	`zùli°Dñëe
“ode->zl, 
p
);

635 
node
->
cou¡
--;

636 i‡(
node
->
cou¡
 == 0) {

637 
g⁄e
 = 1;

638 
	`__quickli°DñNode
(
quickli°
, 
node
);

640 
	`quickli°NodeUpd©eSz
(
node
);

642 
quickli°
->
cou¡
--;

644  
g⁄e
 ? 1 : 0;

645 
	}
}

651 
	$quickli°DñE¡ry
(
quickli°Iãr
 *
ôî
, 
quickli°E¡ry
 *
íåy
) {

652 
quickli°Node
 *
¥ev
 = 
íåy
->
node
->prev;

653 
quickli°Node
 *
√xt
 = 
íåy
->
node
->next;

654 
dñëed_node
 = 
	`quickli°DñIndex
((
quickli°
 *)
íåy
->quicklist,

655 
íåy
->
node
, &íåy->
zi
);

658 
ôî
->
zi
 = 
NULL
;

661 i‡(
dñëed_node
) {

662 i‡(
ôî
->
dúe˘i⁄
 =
AL_START_HEAD
) {

663 
ôî
->
cuºít
 = 
√xt
;

664 
ôî
->
off£t
 = 0;

665 } i‡(
ôî
->
dúe˘i⁄
 =
AL_START_TAIL
) {

666 
ôî
->
cuºít
 = 
¥ev
;

667 
ôî
->
off£t
 = -1;

678 
	}
}

684 
	$quickli°Rïœ˚AtIndex
(
quickli°
 *quickli°, 
ödex
, *
d©a
,

685 
sz
) {

686 
quickli°E¡ry
 
íåy
;

687 i‡(
	`likñy
(
	`quickli°Index
(
quickli°
, 
ödex
, &
íåy
))) {

689 
íåy
.
node
->
zl
 = 
	`zùli°Dñëe
”¡ry.node->zl, &íåy.
zi
);

690 
íåy
.
node
->
zl
 = 
	`zùli°In£π
”¡ry.node->zl,É¡ry.
zi
, 
d©a
, 
sz
);

691 
	`quickli°NodeUpd©eSz
(
íåy
.
node
);

692 
	`quickli°Com¥ess
(
quickli°
, 
íåy
.
node
);

697 
	}
}

712 
REDIS_STATIC
 
quickli°Node
 *
	$_quickli°Zùli°Mîge
(
quickli°
 *quicklist,

713 
quickli°Node
 *
a
,

714 
quickli°Node
 *
b
) {

715 
	`D
("Reque°ed mîgê◊,bË(%u, %u)", 
a
->
cou¡
, 
b
->count);

717 
	`quickli°Decom¥essNode
(
a
);

718 
	`quickli°Decom¥essNode
(
b
);

719 i‡((
	`zùli°Mîge
(&
a
->
zl
, &
b
->zl))) {

721 
quickli°Node
 *
kìp
 = 
NULL
, *
nokìp
 = NULL;

722 i‡(!
a
->
zl
) {

723 
nokìp
 = 
a
;

724 
kìp
 = 
b
;

725 } i‡(!
b
->
zl
) {

726 
nokìp
 = 
b
;

727 
kìp
 = 
a
;

729 
kìp
->
cou¡
 = 
	`zùli°Lí
(kìp->
zl
);

730 
	`quickli°NodeUpd©eSz
(
kìp
);

732 
nokìp
->
cou¡
 = 0;

733 
	`__quickli°DñNode
(
quickli°
, 
nokìp
);

734 
	`quickli°Com¥ess
(
quickli°
, 
kìp
);

735  
kìp
;

738  
NULL
;

740 
	}
}

750 
REDIS_STATIC
 
	$_quickli°MîgeNodes
(
quickli°
 *quicklist,

751 
quickli°Node
 *
˚¡î
) {

752 
fûl
 = 
quickli°
->fill;

753 
quickli°Node
 *
¥ev
, *
¥ev_¥ev
, *
√xt
, *
√xt_√xt
, *
èrgë
;

754 
¥ev
 = 
¥ev_¥ev
 = 
√xt
 = 
√xt_√xt
 = 
èrgë
 = 
NULL
;

756 i‡(
˚¡î
->
¥ev
) {

757 
¥ev
 = 
˚¡î
->prev;

758 i‡(
˚¡î
->
¥ev
->prev)

759 
¥ev_¥ev
 = 
˚¡î
->
¥ev
->prev;

762 i‡(
˚¡î
->
√xt
) {

763 
√xt
 = 
˚¡î
->next;

764 i‡(
˚¡î
->
√xt
->next)

765 
√xt_√xt
 = 
˚¡î
->
√xt
->next;

769 i‡(
	`_quickli°NodeAŒowMîge
(
¥ev
, 
¥ev_¥ev
, 
fûl
)) {

770 
	`_quickli°Zùli°Mîge
(
quickli°
, 
¥ev_¥ev
, 
¥ev
);

771 
¥ev_¥ev
 = 
¥ev
 = 
NULL
;

775 i‡(
	`_quickli°NodeAŒowMîge
(
√xt
, 
√xt_√xt
, 
fûl
)) {

776 
	`_quickli°Zùli°Mîge
(
quickli°
, 
√xt
, 
√xt_√xt
);

777 
√xt
 = 
√xt_√xt
 = 
NULL
;

781 i‡(
	`_quickli°NodeAŒowMîge
(
˚¡î
, cíãr->
¥ev
, 
fûl
)) {

782 
èrgë
 = 
	`_quickli°Zùli°Mîge
(
quickli°
, 
˚¡î
->
¥ev
, center);

783 
˚¡î
 = 
NULL
;

786 
èrgë
 = 
˚¡î
;

790 i‡(
	`_quickli°NodeAŒowMîge
(
èrgë
,Å¨gë->
√xt
, 
fûl
)) {

791 
	`_quickli°Zùli°Mîge
(
quickli°
, 
èrgë
,Å¨gë->
√xt
);

793 
	}
}

814 
REDIS_STATIC
 
quickli°Node
 *
	$_quickli°S∂ôNode
(
quickli°Node
 *
node
, 
off£t
,

815 
a·î
) {

816 
size_t
 
zl_sz
 = 
node
->
sz
;

818 
quickli°Node
 *
√w_node
 = 
	`quickli°Cª©eNode
();

819 
√w_node
->
zl
 = 
	`zmÆloc
(
zl_sz
);

822 
	`mem˝y
(
√w_node
->
zl
, 
node
->zl, 
zl_sz
);

825 
‹ig_°¨t
 = 
a·î
 ? 
off£t
 + 1 : 0;

826 
‹ig_exã¡
 = 
a·î
 ? -1 : 
off£t
;

827 
√w_°¨t
 = 
a·î
 ? 0 : 
off£t
;

828 
√w_exã¡
 = 
a·î
 ? 
off£t
 + 1 : -1;

830 
	`D
("A·î %d (%d);Ñ™ges: [%d, %d], [%d, %d]", 
a·î
, 
off£t
, 
‹ig_°¨t
,

831 
‹ig_exã¡
, 
√w_°¨t
, 
√w_exã¡
);

833 
node
->
zl
 = 
	`zùli°DñëeR™ge
“ode->zl, 
‹ig_°¨t
, 
‹ig_exã¡
);

834 
node
->
cou¡
 = 
	`zùli°Lí
“ode->
zl
);

835 
	`quickli°NodeUpd©eSz
(
node
);

837 
√w_node
->
zl
 = 
	`zùli°DñëeR™ge
“ew_node->zl, 
√w_°¨t
, 
√w_exã¡
);

838 
√w_node
->
cou¡
 = 
	`zùli°Lí
“ew_node->
zl
);

839 
	`quickli°NodeUpd©eSz
(
√w_node
);

841 
	`D
("A·î s∂ôÜígths: orig (%d),Çew (%d)", 
node
->
cou¡
, 
√w_node
->count);

842  
√w_node
;

843 
	}
}

849 
REDIS_STATIC
 
	$_quickli°In£π
(
quickli°
 *quickli°, 
quickli°E¡ry
 *
íåy
,

850 *
vÆue
, c⁄° 
size_t
 
sz
, 
a·î
) {

851 
fuŒ
 = 0, 
©_èû
 = 0, 
©_hód
 = 0, 
fuŒ_√xt
 = 0, 
fuŒ_¥ev
 = 0;

852 
fûl
 = 
quickli°
->fill;

853 
quickli°Node
 *
node
 = 
íåy
->node;

854 
quickli°Node
 *
√w_node
 = 
NULL
;

856 i‡(!
node
) {

858 
	`D
("NoÇode given!");

859 
√w_node
 = 
	`quickli°Cª©eNode
();

860 
√w_node
->
zl
 = 
	`zùli°Push
(
	`zùli°New
(), 
vÆue
, 
sz
, 
ZIPLIST_HEAD
);

861 
	`__quickli°In£πNode
(
quickli°
, 
NULL
, 
√w_node
, 
a·î
);

862 
√w_node
->
cou¡
++;

863 
quickli°
->
cou¡
++;

868 i‡(!
	`_quickli°NodeAŒowIn£π
(
node
, 
fûl
, 
sz
)) {

869 
	`D
("CurrentÇode is full with count %d withÑequested fill %lu",

870 
node
->
cou¡
, 
fûl
);

871 
fuŒ
 = 1;

874 i‡(
a·î
 && (
íåy
->
off£t
 =
node
->
cou¡
)) {

875 
	`D
("At Tail of current ziplist");

876 
©_èû
 = 1;

877 i‡(!
	`_quickli°NodeAŒowIn£π
(
node
->
√xt
, 
fûl
, 
sz
)) {

878 
	`D
("NextÇode is fullÅoo.");

879 
fuŒ_√xt
 = 1;

883 i‡(!
a·î
 && (
íåy
->
off£t
 == 0)) {

884 
	`D
("At Head");

885 
©_hód
 = 1;

886 i‡(!
	`_quickli°NodeAŒowIn£π
(
node
->
¥ev
, 
fûl
, 
sz
)) {

887 
	`D
("PrevÇode is fullÅoo.");

888 
fuŒ_¥ev
 = 1;

893 i‡(!
fuŒ
 && 
a·î
) {

894 
	`D
("Not full, insertingáfter currentÖosition.");

895 
	`quickli°Decom¥essNodeF‹U£
(
node
);

896 *
√xt
 = 
	`zùli°Next
(
node
->
zl
, 
íåy
->
zi
);

897 i‡(
√xt
 =
NULL
) {

898 
node
->
zl
 = 
	`zùli°Push
“ode->zl, 
vÆue
, 
sz
, 
ZIPLIST_TAIL
);

900 
node
->
zl
 = 
	`zùli°In£π
“ode->zl, 
√xt
, 
vÆue
, 
sz
);

902 
node
->
cou¡
++;

903 
	`quickli°NodeUpd©eSz
(
node
);

904 
	`quickli°Recom¥essO∆y
(
quickli°
, 
node
);

905 } i‡(!
fuŒ
 && !
a·î
) {

906 
	`D
("Not full, inserting before currentÖosition.");

907 
	`quickli°Decom¥essNodeF‹U£
(
node
);

908 
node
->
zl
 = 
	`zùli°In£π
“ode->zl, 
íåy
->
zi
, 
vÆue
, 
sz
);

909 
node
->
cou¡
++;

910 
	`quickli°NodeUpd©eSz
(
node
);

911 
	`quickli°Recom¥essO∆y
(
quickli°
, 
node
);

912 } i‡(
fuŒ
 && 
©_èû
 && 
node
->
√xt
 && !
fuŒ_√xt
 && 
a·î
) {

915 
	`D
("FullándÅail, butÇext isn't full; insertingÇextÇode head");

916 
√w_node
 = 
node
->
√xt
;

917 
	`quickli°Decom¥essNodeF‹U£
(
√w_node
);

918 
√w_node
->
zl
 = 
	`zùli°Push
“ew_node->zl, 
vÆue
, 
sz
, 
ZIPLIST_HEAD
);

919 
√w_node
->
cou¡
++;

920 
	`quickli°NodeUpd©eSz
(
√w_node
);

921 
	`quickli°Recom¥essO∆y
(
quickli°
, 
√w_node
);

922 } i‡(
fuŒ
 && 
©_hód
 && 
node
->
¥ev
 && !
fuŒ_¥ev
 && !
a·î
) {

925 
	`D
("Fullánd head, butÖrev isn't full, insertingÖrevÇodeÅail");

926 
√w_node
 = 
node
->
¥ev
;

927 
	`quickli°Decom¥essNodeF‹U£
(
√w_node
);

928 
√w_node
->
zl
 = 
	`zùli°Push
“ew_node->zl, 
vÆue
, 
sz
, 
ZIPLIST_TAIL
);

929 
√w_node
->
cou¡
++;

930 
	`quickli°NodeUpd©eSz
(
√w_node
);

931 
	`quickli°Recom¥essO∆y
(
quickli°
, 
√w_node
);

932 } i‡(
fuŒ
 && ((
©_èû
 && 
node
->
√xt
 && 
fuŒ_√xt
 && 
a·î
) ||

933 (
©_hód
 && 
node
->
¥ev
 && 
fuŒ_¥ev
 && !
a·î
))) {

936 
	`D
("\tprovisioningÇewÇode...");

937 
√w_node
 = 
	`quickli°Cª©eNode
();

938 
√w_node
->
zl
 = 
	`zùli°Push
(
	`zùli°New
(), 
vÆue
, 
sz
, 
ZIPLIST_HEAD
);

939 
√w_node
->
cou¡
++;

940 
	`quickli°NodeUpd©eSz
(
√w_node
);

941 
	`__quickli°In£πNode
(
quickli°
, 
node
, 
√w_node
, 
a·î
);

942 } i‡(
fuŒ
) {

945 
	`D
("\tsplittingÇode...");

946 
	`quickli°Decom¥essNodeF‹U£
(
node
);

947 
√w_node
 = 
	`_quickli°S∂ôNode
(
node
, 
íåy
->
off£t
, 
a·î
);

948 
√w_node
->
zl
 = 
	`zùli°Push
“ew_node->zl, 
vÆue
, 
sz
,

949 
a·î
 ? 
ZIPLIST_HEAD
 : 
ZIPLIST_TAIL
);

950 
√w_node
->
cou¡
++;

951 
	`quickli°NodeUpd©eSz
(
√w_node
);

952 
	`__quickli°In£πNode
(
quickli°
, 
node
, 
√w_node
, 
a·î
);

953 
	`_quickli°MîgeNodes
(
quickli°
, 
node
);

956 
quickli°
->
cou¡
++;

957 
	}
}

959 
	$quickli°In£πBef‹e
(
quickli°
 *quickli°, 
quickli°E¡ry
 *
íåy
,

960 *
vÆue
, c⁄° 
size_t
 
sz
) {

961 
	`_quickli°In£π
(
quickli°
, 
íåy
, 
vÆue
, 
sz
, 0);

962 
	}
}

964 
	$quickli°In£πA·î
(
quickli°
 *quickli°, 
quickli°E¡ry
 *
íåy
,

965 *
vÆue
, c⁄° 
size_t
 
sz
) {

966 
	`_quickli°In£π
(
quickli°
, 
íåy
, 
vÆue
, 
sz
, 1);

967 
	}
}

975 
	$quickli°DñR™ge
(
quickli°
 *quickli°, c⁄° 
°¨t
,

976 c⁄° 
cou¡
) {

977 i‡(
cou¡
 <= 0)

980 
exã¡
 = 
cou¡
;

982 i‡(
°¨t
 >0 && 
exã¡
 > (
quickli°
->
cou¡
 - start)) {

984 
exã¡
 = 
quickli°
->
cou¡
 - 
°¨t
;

985 } i‡(
°¨t
 < 0 && 
exã¡
 > ()(-start)) {

987 
exã¡
 = -
°¨t
;

990 
quickli°E¡ry
 
íåy
;

991 i‡(!
	`quickli°Index
(
quickli°
, 
°¨t
, &
íåy
))

994 
	`D
("Quickli° dñëêªque° f‹ sèπ %ld, cou¡ %ld,Éxã¡: %ld", 
°¨t
,

995 
cou¡
, 
exã¡
);

996 
quickli°Node
 *
node
 = 
íåy
.node;

999 
exã¡
) {

1000 
quickli°Node
 *
√xt
 = 
node
->next;

1002 
dñ
;

1003 
dñëe_ítúe_node
 = 0;

1004 i‡(
íåy
.
off£t
 =0 && 
exã¡
 >
node
->
cou¡
) {

1007 
dñëe_ítúe_node
 = 1;

1008 
dñ
 = 
node
->
cou¡
;

1009 } i‡(
íåy
.
off£t
 >0 && 
exã¡
 >
node
->
cou¡
) {

1012 
dñ
 = 
node
->
cou¡
 - 
íåy
.
off£t
;

1013 } i‡(
íåy
.
off£t
 < 0) {

1019 
dñ
 = -
íåy
.
off£t
;

1024 i‡(
dñ
 > 
exã¡
)

1025 
dñ
 = 
exã¡
;

1029 
dñ
 = 
exã¡
;

1032 
	`D
("[%ld]:áskingÅo del: %ld because offset: %d; (ENTIRE NODE: %d), "

1034 
exã¡
, 
dñ
, 
íåy
.
off£t
, 
dñëe_ítúe_node
, 
node
->
cou¡
);

1036 i‡(
dñëe_ítúe_node
) {

1037 
	`__quickli°DñNode
(
quickli°
, 
node
);

1039 
	`quickli°Decom¥essNodeF‹U£
(
node
);

1040 
node
->
zl
 = 
	`zùli°DñëeR™ge
“ode->zl, 
íåy
.
off£t
, 
dñ
);

1041 
	`quickli°NodeUpd©eSz
(
node
);

1042 
node
->
cou¡
 -
dñ
;

1043 
quickli°
->
cou¡
 -
dñ
;

1044 
	`quickli°DñëeIfEm±y
(
quickli°
, 
node
);

1045 i‡(
node
)

1046 
	`quickli°Recom¥essO∆y
(
quickli°
, 
node
);

1049 
exã¡
 -
dñ
;

1051 
node
 = 
√xt
;

1053 
íåy
.
off£t
 = 0;

1056 
	}
}

1059 
	$quickli°Com∑ª
(*
p1
, *
p2
, 
p2_Àn
) {

1060  
	`zùli°Com∑ª
(
p1
, 
p2
, 
p2_Àn
);

1061 
	}
}

1065 
quickli°Iãr
 *
	$quickli°GëIãøt‹
(c⁄° 
quickli°
 *quickli°, 
dúe˘i⁄
) {

1066 
quickli°Iãr
 *
ôî
;

1068 
ôî
 = 
	`zmÆloc
((*iter));

1070 i‡(
dúe˘i⁄
 =
AL_START_HEAD
) {

1071 
ôî
->
cuºít
 = 
quickli°
->
hód
;

1072 
ôî
->
off£t
 = 0;

1073 } i‡(
dúe˘i⁄
 =
AL_START_TAIL
) {

1074 
ôî
->
cuºít
 = 
quickli°
->
èû
;

1075 
ôî
->
off£t
 = -1;

1078 
ôî
->
dúe˘i⁄
 = direction;

1079 
ôî
->
quickli°
 = quicklist;

1081 
ôî
->
zi
 = 
NULL
;

1083  
ôî
;

1084 
	}
}

1088 
quickli°Iãr
 *
	$quickli°GëIãøt‹AtIdx
(c⁄° 
quickli°
 *quicklist,

1089 c⁄° 
dúe˘i⁄
,

1090 c⁄° 
idx
) {

1091 
quickli°E¡ry
 
íåy
;

1093 i‡(
	`quickli°Index
(
quickli°
, 
idx
, &
íåy
)) {

1094 
quickli°Iãr
 *
ba£
 = 
	`quickli°GëIãøt‹
(
quickli°
, 
dúe˘i⁄
);

1095 
ba£
->
zi
 = 
NULL
;

1096 
ba£
->
cuºít
 = 
íåy
.
node
;

1097 
ba£
->
off£t
 = 
íåy
.offset;

1098  
ba£
;

1100  
NULL
;

1102 
	}
}

1106 
	$quickli°Rñó£Iãøt‹
(
quickli°Iãr
 *
ôî
) {

1107 i‡(
ôî
->
cuºít
)

1108 
	`quickli°Com¥ess
(
ôî
->
quickli°
, iãr->
cuºít
);

1110 
	`z‰ì
(
ôî
);

1111 
	}
}

1134 
	$quickli°Next
(
quickli°Iãr
 *
ôî
, 
quickli°E¡ry
 *
íåy
) {

1135 
	`öôE¡ry
(
íåy
);

1137 i‡(!
ôî
) {

1138 
	`D
("Returning becauseÇo iter!");

1142 
íåy
->
quickli°
 = 
ôî
->quicklist;

1143 
íåy
->
node
 = 
ôî
->
cuºít
;

1145 i‡(!
ôî
->
cuºít
) {

1146 
	`D
("Returning because currentÇode is NULL")

1150 *(*
√xtFn
)(*, *Ë
NULL
;

1151 
off£t_upd©e
 = 0;

1153 i‡(!
ôî
->
zi
) {

1155 
	`quickli°Decom¥essNodeF‹U£
(
ôî
->
cuºít
);

1156 
ôî
->
zi
 = 
	`zùli°Index
(ôî->
cuºít
->
zl
, iãr->
off£t
);

1159 i‡(
ôî
->
dúe˘i⁄
 =
AL_START_HEAD
) {

1160 
√xtFn
 = 
zùli°Next
;

1161 
off£t_upd©e
 = 1;

1162 } i‡(
ôî
->
dúe˘i⁄
 =
AL_START_TAIL
) {

1163 
√xtFn
 = 
zùli°Pªv
;

1164 
off£t_upd©e
 = -1;

1166 
ôî
->
zi
 = 
	`√xtFn
(ôî->
cuºít
->
zl
, iter->zi);

1167 
ôî
->
off£t
 +
off£t_upd©e
;

1170 
íåy
->
zi
 = 
ôî
->zi;

1171 
íåy
->
off£t
 = 
ôî
->offset;

1173 i‡(
ôî
->
zi
) {

1175 
	`zùli°Gë
(
íåy
->
zi
, &íåy->
vÆue
, &íåy->
sz
, &íåy->
l⁄gvÆ
);

1180 
	`quickli°Com¥ess
(
ôî
->
quickli°
, iãr->
cuºít
);

1181 i‡(
ôî
->
dúe˘i⁄
 =
AL_START_HEAD
) {

1183 
	`D
("JumpingÅo start ofÇextÇode");

1184 
ôî
->
cuºít
 = iãr->cuºít->
√xt
;

1185 
ôî
->
off£t
 = 0;

1186 } i‡(
ôî
->
dúe˘i⁄
 =
AL_START_TAIL
) {

1188 
	`D
("JumpingÅoÉnd ofÖreviousÇode");

1189 
ôî
->
cuºít
 = iãr->cuºít->
¥ev
;

1190 
ôî
->
off£t
 = -1;

1192 
ôî
->
zi
 = 
NULL
;

1193  
	`quickli°Next
(
ôî
, 
íåy
);

1195 
	}
}

1203 
quickli°
 *
	$quickli°Dup
(
quickli°
 *
‹ig
) {

1204 
quickli°
 *
c›y
;

1206 
c›y
 = 
	`quickli°New
(
‹ig
->
fûl
, orig->
com¥ess
);

1208 
quickli°Node
 *
cuºít
 = 
‹ig
->
hód
; current;

1209 
cuºít
 = cuºít->
√xt
) {

1210 
quickli°Node
 *
node
 = 
	`quickli°Cª©eNode
();

1212 i‡(
cuºít
->
ícodög
 =
QUICKLIST_NODE_ENCODING_LZF
) {

1213 
quickli°LZF
 *
lzf
 = (quickli°LZF *)
cuºít
->
zl
;

1214 
size_t
 
lzf_sz
 = (*
lzf
Ë+Üzf->
sz
;

1215 
node
->
zl
 = 
	`zmÆloc
(
lzf_sz
);

1216 
	`mem˝y
(
node
->
zl
, 
cuºít
->zl, 
lzf_sz
);

1217 } i‡(
cuºít
->
ícodög
 =
QUICKLIST_NODE_ENCODING_RAW
) {

1218 
node
->
zl
 = 
	`zmÆloc
(
cuºít
->
sz
);

1219 
	`mem˝y
(
node
->
zl
, 
cuºít
->zl, cuºít->
sz
);

1222 
node
->
cou¡
 = 
cuºít
->count;

1223 
c›y
->
cou¡
 +
node
->count;

1224 
node
->
sz
 = 
cuºít
->sz;

1225 
node
->
ícodög
 = 
cuºít
->encoding;

1227 
	`_quickli°In£πNodeA·î
(
c›y
, c›y->
èû
, 
node
);

1231  
c›y
;

1232 
	}
}

1242 
	$quickli°Index
(c⁄° 
quickli°
 *quickli°, c⁄° 
idx
,

1243 
quickli°E¡ry
 *
íåy
) {

1244 
quickli°Node
 *
n
;

1245 
accum
 = 0;

1246 
ödex
;

1247 
f‹w¨d
 = 
idx
 < 0 ? 0 : 1;

1249 
	`öôE¡ry
(
íåy
);

1250 
íåy
->
quickli°
 = quicklist;

1252 i‡(!
f‹w¨d
) {

1253 
ödex
 = (-
idx
) - 1;

1254 
n
 = 
quickli°
->
èû
;

1256 
ödex
 = 
idx
;

1257 
n
 = 
quickli°
->
hód
;

1260 i‡(
ödex
 >
quickli°
->
cou¡
)

1263 
	`likñy
(
n
)) {

1264 i‡((
accum
 + 
n
->
cou¡
Ë> 
ödex
) {

1267 
	`D
("Skùpög ovî (%pË%uáàaccum %Œd", (*)
n
,Ç->
cou¡
,

1268 
accum
);

1269 
accum
 +
n
->
cou¡
;

1270 
n
 = 
f‹w¨d
 ?Ç->
√xt
 :Ç->
¥ev
;

1274 i‡(!
n
)

1277 
	`D
("FoundÇode: %∞©áccum %Œu, idx %Œu, sub+ %Œu, sub- %Œu", (*)
n
,

1278 
accum
, 
ödex
, index -áccum, (-index) - 1 +áccum);

1280 
íåy
->
node
 = 
n
;

1281 i‡(
f‹w¨d
) {

1283 
íåy
->
off£t
 = 
ödex
 - 
accum
;

1287 
íåy
->
off£t
 = (-
ödex
Ë- 1 + 
accum
;

1290 
	`quickli°Decom¥essNodeF‹U£
(
íåy
->
node
);

1291 
íåy
->
zi
 = 
	`zùli°Index
”¡ry->
node
->
zl
,É¡ry->
off£t
);

1292 
	`zùli°Gë
(
íåy
->
zi
, &íåy->
vÆue
, &íåy->
sz
, &íåy->
l⁄gvÆ
);

1296 
	}
}

1299 
	$quickli°RŸ©e
(
quickli°
 *quicklist) {

1300 i‡(
quickli°
->
cou¡
 <= 1)

1304 *
p
 = 
	`zùli°Index
(
quickli°
->
èû
->
zl
, -1);

1305 *
vÆue
;

1306 
l⁄gvÆ
;

1307 
sz
;

1308 
l⁄g°r
[32] = {0};

1309 
	`zùli°Gë
(
p
, &
vÆue
, &
sz
, &
l⁄gvÆ
);

1312 i‡(!
vÆue
) {

1314 
sz
 = 
	`Œ2°rög
(
l⁄g°r
, ÷⁄g°r), 
l⁄gvÆ
);

1315 
vÆue
 = (*)
l⁄g°r
;

1319 
	`quickli°PushHód
(
quickli°
, 
vÆue
, 
sz
);

1324 i‡(
quickli°
->
Àn
 == 1) {

1325 
p
 = 
	`zùli°Index
(
quickli°
->
èû
->
zl
, -1);

1329 
	`quickli°DñIndex
(
quickli°
, quickli°->
èû
, &
p
);

1330 
	}
}

1341 
	$quickli°P›Cu°om
(
quickli°
 *quickli°, 
whîe
, **
d©a
,

1342 *
sz
, *
svÆ
,

1343 *(*
ßvî
)(*
d©a
, 
sz
)) {

1344 *
p
;

1345 *
v°r
;

1346 
vÀn
;

1347 
vl⁄g
;

1348 
pos
 = (
whîe
 =
QUICKLIST_HEAD
) ? 0 : -1;

1350 i‡(
quickli°
->
cou¡
 == 0)

1353 i‡(
d©a
)

1354 *
d©a
 = 
NULL
;

1355 i‡(
sz
)

1356 *
sz
 = 0;

1357 i‡(
svÆ
)

1358 *
svÆ
 = -123456789;

1360 
quickli°Node
 *
node
;

1361 i‡(
whîe
 =
QUICKLIST_HEAD
 && 
quickli°
->
hód
) {

1362 
node
 = 
quickli°
->
hód
;

1363 } i‡(
whîe
 =
QUICKLIST_TAIL
 && 
quickli°
->
èû
) {

1364 
node
 = 
quickli°
->
èû
;

1369 
p
 = 
	`zùli°Index
(
node
->
zl
, 
pos
);

1370 i‡(
	`zùli°Gë
(
p
, &
v°r
, &
vÀn
, &
vl⁄g
)) {

1371 i‡(
v°r
) {

1372 i‡(
d©a
)

1373 *
d©a
 = 
	`ßvî
(
v°r
, 
vÀn
);

1374 i‡(
sz
)

1375 *
sz
 = 
vÀn
;

1377 i‡(
d©a
)

1378 *
d©a
 = 
NULL
;

1379 i‡(
svÆ
)

1380 *
svÆ
 = 
vl⁄g
;

1382 
	`quickli°DñIndex
(
quickli°
, 
node
, &
p
);

1386 
	}
}

1389 
REDIS_STATIC
 *
	$_quickli°Savî
(*
d©a
, 
sz
) {

1390 *
v°r
;

1391 i‡(
d©a
) {

1392 
v°r
 = 
	`zmÆloc
(
sz
);

1393 
	`mem˝y
(
v°r
, 
d©a
, 
sz
);

1394  
v°r
;

1396  
NULL
;

1397 
	}
}

1402 
	$quickli°P›
(
quickli°
 *quickli°, 
whîe
, **
d©a
,

1403 *
sz
, *
¶⁄g
) {

1404 *
v°r
;

1405 
vÀn
;

1406 
vl⁄g
;

1407 i‡(
quickli°
->
cou¡
 == 0)

1409 
ªt
 = 
	`quickli°P›Cu°om
(
quickli°
, 
whîe
, &
v°r
, &
vÀn
, &
vl⁄g
,

1410 
_quickli°Savî
);

1411 i‡(
d©a
)

1412 *
d©a
 = 
v°r
;

1413 i‡(
¶⁄g
)

1414 *
¶⁄g
 = 
vl⁄g
;

1415 i‡(
sz
)

1416 *
sz
 = 
vÀn
;

1417  
ªt
;

1418 
	}
}

1421 
	$quickli°Push
(
quickli°
 *quickli°, *
vÆue
, c⁄° 
size_t
 
sz
,

1422 
whîe
) {

1423 i‡(
whîe
 =
QUICKLIST_HEAD
) {

1424 
	`quickli°PushHód
(
quickli°
, 
vÆue
, 
sz
);

1425 } i‡(
whîe
 =
QUICKLIST_TAIL
) {

1426 
	`quickli°PushTaû
(
quickli°
, 
vÆue
, 
sz
);

1428 
	}
}

1438 
	$quickli°Bookm¨kCª©e
(
quickli°
 **
ql_ªf
, c⁄° *
«me
, 
quickli°Node
 *
node
) {

1439 
quickli°
 *
ql
 = *
ql_ªf
;

1440 i‡(
ql
->
bookm¨k_cou¡
 >
QL_MAX_BM
)

1442 
quickli°Bookm¨k
 *
bm
 = 
	`_quickli°Bookm¨kFödByName
(
ql
, 
«me
);

1443 i‡(
bm
) {

1444 
bm
->
node
 =Çode;

1447 
ql
 = 
	`zªÆloc
(ql, (
quickli°
Ë+ (ql->
bookm¨k_cou¡
+1Ë* (
quickli°Bookm¨k
));

1448 *
ql_ªf
 = 
ql
;

1449 
ql
->
bookm¨ks
[ql->
bookm¨k_cou¡
].
node
 =Çode;

1450 
ql
->
bookm¨ks
[ql->
bookm¨k_cou¡
].
«me
 = 
	`z°rdup
(name);

1451 
ql
->
bookm¨k_cou¡
++;

1453 
	}
}

1458 
quickli°Node
 *
	$quickli°Bookm¨kFöd
(
quickli°
 *
ql
, c⁄° *
«me
) {

1459 
quickli°Bookm¨k
 *
bm
 = 
	`_quickli°Bookm¨kFödByName
(
ql
, 
«me
);

1460 i‡(!
bm
Ë 
NULL
;

1461  
bm
->
node
;

1462 
	}
}

1467 
	$quickli°Bookm¨kDñëe
(
quickli°
 *
ql
, c⁄° *
«me
) {

1468 
quickli°Bookm¨k
 *
bm
 = 
	`_quickli°Bookm¨kFödByName
(
ql
, 
«me
);

1469 i‡(!
bm
)

1471 
	`_quickli°Bookm¨kDñëe
(
ql
, 
bm
);

1473 
	}
}

1475 
quickli°Bookm¨k
 *
	$_quickli°Bookm¨kFödByName
(
quickli°
 *
ql
, c⁄° *
«me
) {

1476 
i
;

1477 
i
=0; i<
ql
->
bookm¨k_cou¡
; i++) {

1478 i‡(!
	`°rcmp
(
ql
->
bookm¨ks
[
i
].
«me
,Çame)) {

1479  &
ql
->
bookm¨ks
[
i
];

1482  
NULL
;

1483 
	}
}

1485 
quickli°Bookm¨k
 *
	$_quickli°Bookm¨kFödByNode
(
quickli°
 *
ql
, 
quickli°Node
 *
node
) {

1486 
i
;

1487 
i
=0; i<
ql
->
bookm¨k_cou¡
; i++) {

1488 i‡(
ql
->
bookm¨ks
[
i
].
node
 ==Çode) {

1489  &
ql
->
bookm¨ks
[
i
];

1492  
NULL
;

1493 
	}
}

1495 
	$_quickli°Bookm¨kDñëe
(
quickli°
 *
ql
, 
quickli°Bookm¨k
 *
bm
) {

1496 
ödex
 = 
bm
 - 
ql
->
bookm¨ks
;

1497 
	`z‰ì
(
bm
->
«me
);

1498 
ql
->
bookm¨k_cou¡
--;

1499 
	`memmove
(
bm
, bm+1, (
ql
->
bookm¨k_cou¡
 - 
ödex
)* (*bm));

1502 
	}
}

1504 
	$quickli°Bookm¨ksCÀ¨
(
quickli°
 *
ql
) {

1505 
ql
->
bookm¨k_cou¡
)

1506 
	`z‰ì
(
ql
->
bookm¨ks
[--ql->
bookm¨k_cou¡
].
«me
);

1509 
	}
}

1512 #ifde‡
REDIS_TEST


1513 
	~<°döt.h
>

1514 
	~<sys/time.h
>

1516 
	#as£π
(
_e
) \

1518 i‡(!(
_e
)) { \

1519 
	`¥ötf
("\n\n=== ASSERTION FAILED ===\n"); \

1520 
	`¥ötf
("==> %s:%d '%s' i†nŸÅrue\n", 
__FILE__
, 
__LINE__
, #_e); \

1521 
îr
++; \

1523 } 0)

	)

1525 
	#yñl
(
°r
, ...Ë
	`¥ötf
("ERROR! " så "\n\n", 
__VA_ARGS__
)

	)

1527 
	#OK
 
	`¥ötf
("\tOK\n")

	)

1529 
	#ERROR
 \

1531 
	`¥ötf
("\tERROR!\n"); \

1532 
îr
++; \

1533 } 0)

	)

1535 
	#ERR
(
x
, ...) \

1537 
	`¥ötf
("%s:%s:%d:\t", 
__FILE__
, 
__FUNCTION__
, 
__LINE__
); \

1538 
	`¥ötf
("ERROR! " 
x
 "\n", 
__VA_ARGS__
); \

1539 
îr
++; \

1540 } 0)

	)

1542 
	#TEST
(
«me
Ë
	`¥ötf
("ã° ‚Äî %s\n",Çame);

	)

1543 
	#TEST_DESC
(
«me
, ...Ë
	`¥ötf
("ã° ‚Äî "Çamê"\n", 
__VA_ARGS__
);

	)

1545 
	#QL_TEST_VERBOSE
 0

	)

1547 
	#UNUSED
(
x
Ë()(x)

	)

1548 
	$ql_öfo
(
quickli°
 *
ql
) {

1549 #i‡
QL_TEST_VERBOSE


1550 
	`¥ötf
("C⁄èöîÜígth: %lu\n", 
ql
->
Àn
);

1551 
	`¥ötf
("C⁄èöî size: %lu\n", 
ql
->
cou¡
);

1552 i‡(
ql
->
hód
)

1553 
	`¥ötf
("\t(zsizêhód: %d)\n", 
	`zùli°Lí
(
ql
->
hód
->
zl
));

1554 i‡(
ql
->
èû
)

1555 
	`¥ötf
("\t(zsizêèû: %d)\n", 
	`zùli°Lí
(
ql
->
èû
->
zl
));

1556 
	`¥ötf
("\n");

1558 
	`UNUSED
(
ql
);

1560 
	}
}

1563 
	$u°ime
() {

1564 
timevÆ
 
tv
;

1565 
u°
;

1567 
	`gëtimeofday
(&
tv
, 
NULL
);

1568 
u°
 = (()
tv
.
tv_£c
) * 1000000;

1569 
u°
 +
tv
.
tv_u£c
;

1570  
u°
;

1571 
	}
}

1574 
	$m°ime
(Ë{  
	`u°ime
(Ë/ 1000; 
	}
}

1580 
	$_ôΩröå
(
quickli°
 *
ql
, 
¥öt
, 
f‹w¨d
) {

1581 
quickli°Iãr
 *
ôî
 =

1582 
	`quickli°GëIãøt‹
(
ql
, 
f‹w¨d
 ? 
AL_START_HEAD
 : 
AL_START_TAIL
);

1583 
quickli°E¡ry
 
íåy
;

1584 
i
 = 0;

1585 
p
 = 0;

1586 
quickli°Node
 *
¥ev
 = 
NULL
;

1587 
	`quickli°Next
(
ôî
, &
íåy
)) {

1588 i‡(
íåy
.
node
 !
¥ev
) {

1590 
p
++;

1591 
¥ev
 = 
íåy
.
node
;

1593 i‡(
¥öt
) {

1594 
	`¥ötf
("[%3d (%2d)]: [%.*s] (%Œd)\n", 
i
, 
p
, 
íåy
.
sz
,

1595 (*)
íåy
.
vÆue
,É¡ry.
l⁄gvÆ
);

1597 
i
++;

1599 
	`quickli°Rñó£Iãøt‹
(
ôî
);

1600  
i
;

1601 
	}
}

1602 
	$ôΩröå
(
quickli°
 *
ql
, 
¥öt
) {

1603  
	`_ôΩröå
(
ql
, 
¥öt
, 1);

1604 
	}
}

1606 
	$ôΩröå_ªv
(
quickli°
 *
ql
, 
¥öt
) {

1607  
	`_ôΩröå
(
ql
, 
¥öt
, 0);

1608 
	}
}

1610 
	#ql_vîify
(
a
, 
b
, 
c
, 
d
, 
e
) \

1612 
îr
 +
	`_ql_vîify
((
a
), (
b
), (
c
), (
d
), (
e
)); \

1613 } 0)

	)

1616 
	$_ql_vîify
(
quickli°
 *
ql
, 
uöt32_t
 
Àn
, uöt32_à
cou¡
,

1617 
uöt32_t
 
hód_cou¡
, uöt32_à
èû_cou¡
) {

1618 
îr‹s
 = 0;

1620 
	`ql_öfo
(
ql
);

1621 i‡(
Àn
 !
ql
->len) {

1622 
	`yñl
("quickli°Üígth wr⁄g:Éx≥˘ed %d, gŸ %u", 
Àn
, 
ql
->len);

1623 
îr‹s
++;

1626 i‡(
cou¡
 !
ql
->count) {

1627 
	`yñl
("quickli° cou¡ wr⁄g:Éx≥˘ed %d, gŸ %lu", 
cou¡
, 
ql
->count);

1628 
îr‹s
++;

1631 
lo›r
 = 
	`ôΩröå
(
ql
, 0);

1632 i‡(
lo›r
 !()
ql
->
cou¡
) {

1633 
	`yñl
("quicklist cached countÇot matcháctual count:Éxpected %lu, got "

1635 
ql
->
cou¡
, 
lo›r
);

1636 
îr‹s
++;

1639 
æo›r
 = 
	`ôΩröå_ªv
(
ql
, 0);

1640 i‡(
lo›r
 !
æo›r
) {

1641 
	`yñl
("quicklist has different forward countÅhanÑeverse count! "

1643 
lo›r
, 
æo›r
);

1644 
îr‹s
++;

1647 i‡(
ql
->
Àn
 =0 && !
îr‹s
) {

1648 
OK
;

1649  
îr‹s
;

1652 i‡(
ql
->
hód
 && 
hód_cou¡
 !ql->hód->
cou¡
 &&

1653 
hód_cou¡
 !
	`zùli°Lí
(
ql
->
hód
->
zl
)) {

1654 
	`yñl
("quicklist head count wrong:Éxpected %d, "

1656 
hód_cou¡
, 
ql
->
hód
->
cou¡
, 
	`zùli°Lí
(ql->hód->
zl
));

1657 
îr‹s
++;

1660 i‡(
ql
->
èû
 && 
èû_cou¡
 !ql->èû->
cou¡
 &&

1661 
èû_cou¡
 !
	`zùli°Lí
(
ql
->
èû
->
zl
)) {

1662 
	`yñl
("quicklistÅail count wrong:Éxpected %d, "

1664 
èû_cou¡
, 
ql
->
èû
->
cou¡
, 
	`zùli°Lí
(ql->èû->
zl
));

1665 
îr‹s
++;

1668 i‡(
	`quickli°AŒowsCom¥essi⁄
(
ql
)) {

1669 
quickli°Node
 *
node
 = 
ql
->
hód
;

1670 
low_øw
 = 
ql
->
com¥ess
;

1671 
high_øw
 = 
ql
->
Àn
 - ql->
com¥ess
;

1673 
©
 = 0;áà< 
ql
->
Àn
;át++, 
node
 =Çode->
√xt
) {

1674 i‡(
node
 && (
©
 < 
low_øw
 ||áà>
high_øw
)) {

1675 i‡(
node
->
ícodög
 !
QUICKLIST_NODE_ENCODING_RAW
) {

1676 
	`yñl
("Incorrect compression:Çode %d is "

1679 
©
, 
ql
->
com¥ess
, 
low_øw
, 
high_øw
, ql->
Àn
, 
node
->
sz
,

1680 
node
->
ªcom¥ess
);

1681 
îr‹s
++;

1684 i‡(
node
->
ícodög
 !
QUICKLIST_NODE_ENCODING_LZF
 &&

1685 !
node
->
©ãm±ed_com¥ess
) {

1686 
	`yñl
("IncorrectÇon-compression:Çode %d is NOT "

1689 
©
, 
ql
->
com¥ess
, 
low_øw
, 
high_øw
, ql->
Àn
, 
node
->
sz
,

1690 
node
->
ªcom¥ess
,Çode->
©ãm±ed_com¥ess
);

1691 
îr‹s
++;

1697 i‡(!
îr‹s
)

1698 
OK
;

1699  
îr‹s
;

1700 
	}
}

1703 *
	$gí°r
(*
¥efix
, 
i
) {

1704 
ªsu…
[64] = {0};

1705 
	`¢¥ötf
(
ªsu…
, ‘esu…), "%s%d", 
¥efix
, 
i
);

1706  
ªsu…
;

1707 
	}
}

1710 
	$quickli°Te°
(
¨gc
, *
¨gv
[]) {

1711 
	`UNUSED
(
¨gc
);

1712 
	`UNUSED
(
¨gv
);

1714 
îr
 = 0;

1715 
›timize_°¨t
 =

1716 -()((
›timiz©i⁄_Àvñ
) / (*optimization_level));

1718 
	`¥ötf
("Sèπög o±imiz©i⁄ off£à©: %d\n", 
›timize_°¨t
);

1720 
›ti⁄s
[] = {0, 1, 2, 3, 4, 5, 6, 10};

1721 
size_t
 
›ti⁄_cou¡
 = (
›ti⁄s
) / (*options);

1722 
ru¡ime
[
›ti⁄_cou¡
];

1724 
_i
 = 0; _ò< ()
›ti⁄_cou¡
; _i++) {

1725 
	`¥ötf
("Te°ög O±i⁄ %d\n", 
›ti⁄s
[
_i
]);

1726 
°¨t
 = 
	`m°ime
();

1728 
	`TEST
("createÜist") {

1729 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1730 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

1731 
	`quickli°Rñó£
(
ql
);

1734 
	`TEST
("addÅoÅail ofÉmptyÜist") {

1735 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1736 
	`quickli°PushTaû
(
ql
, "hello", 6);

1738 
	`ql_vîify
(
ql
, 1, 1, 1, 1);

1739 
	`quickli°Rñó£
(
ql
);

1742 
	`TEST
("addÅo head ofÉmptyÜist") {

1743 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1744 
	`quickli°PushHód
(
ql
, "hello", 6);

1746 
	`ql_vîify
(
ql
, 1, 1, 1, 1);

1747 
	`quickli°Rñó£
(
ql
);

1750 
f
 = 
›timize_°¨t
; f < 32; f++) {

1751 
	`TEST_DESC
("addÅÿèû 5xáàfû»%dáàcom¥es†%d", 
f
,

1752 
›ti⁄s
[
_i
]) {

1753 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

1754 
i
 = 0; i < 5; i++)

1755 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

1756 i‡(
ql
->
cou¡
 != 5)

1757 
ERROR
;

1758 i‡(
f
 == 32)

1759 
	`ql_vîify
(
ql
, 1, 5, 5, 5);

1760 
	`quickli°Rñó£
(
ql
);

1764 
f
 = 
›timize_°¨t
; f < 32; f++) {

1765 
	`TEST_DESC
("addÅÿhód 5xáàfû»%dáàcom¥es†%d", 
f
,

1766 
›ti⁄s
[
_i
]) {

1767 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

1768 
i
 = 0; i < 5; i++)

1769 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

1770 i‡(
ql
->
cou¡
 != 5)

1771 
ERROR
;

1772 i‡(
f
 == 32)

1773 
	`ql_vîify
(
ql
, 1, 5, 5, 5);

1774 
	`quickli°Rñó£
(
ql
);

1778 
f
 = 
›timize_°¨t
; f < 512; f++) {

1779 
	`TEST_DESC
("addÅÿèû 500xáàfû»%dáàcom¥es†%d", 
f
,

1780 
›ti⁄s
[
_i
]) {

1781 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

1782 
i
 = 0; i < 500; i++)

1783 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
), 64);

1784 i‡(
ql
->
cou¡
 != 500)

1785 
ERROR
;

1786 i‡(
f
 == 32)

1787 
	`ql_vîify
(
ql
, 16, 500, 32, 20);

1788 
	`quickli°Rñó£
(
ql
);

1792 
f
 = 
›timize_°¨t
; f < 512; f++) {

1793 
	`TEST_DESC
("addÅÿhód 500xáàfû»%dáàcom¥es†%d", 
f
,

1794 
›ti⁄s
[
_i
]) {

1795 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

1796 
i
 = 0; i < 500; i++)

1797 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

1798 i‡(
ql
->
cou¡
 != 500)

1799 
ERROR
;

1800 i‡(
f
 == 32)

1801 
	`ql_vîify
(
ql
, 16, 500, 20, 32);

1802 
	`quickli°Rñó£
(
ql
);

1806 
	`TEST
("rotateÉmpty") {

1807 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1808 
	`quickli°RŸ©e
(
ql
);

1809 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

1810 
	`quickli°Rñó£
(
ql
);

1813 
f
 = 
›timize_°¨t
; f < 32; f++) {

1814 
	`TEST
("rotate one val once") {

1815 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

1816 
	`quickli°PushHód
(
ql
, "hello", 6);

1817 
	`quickli°RŸ©e
(
ql
);

1820 
	`ql_vîify
(
ql
, 1, 1, 1, 1);

1821 
	`quickli°Rñó£
(
ql
);

1825 
f
 = 
›timize_°¨t
; f < 3; f++) {

1826 
	`TEST_DESC
("rŸ©ê500 vÆ 5000Åime†© fû»%dáàcom¥es†%d", 
f
,

1827 
›ti⁄s
[
_i
]) {

1828 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

1829 
	`quickli°PushHód
(
ql
, "900", 3);

1830 
	`quickli°PushHód
(
ql
, "7000", 4);

1831 
	`quickli°PushHód
(
ql
, "-1200", 5);

1832 
	`quickli°PushHód
(
ql
, "42", 2);

1833 
i
 = 0; i < 500; i++)

1834 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 64);

1835 
	`ql_öfo
(
ql
);

1836 
i
 = 0; i < 5000; i++) {

1837 
	`ql_öfo
(
ql
);

1838 
	`quickli°RŸ©e
(
ql
);

1840 i‡(
f
 == 1)

1841 
	`ql_vîify
(
ql
, 504, 504, 1, 1);

1842 i‡(
f
 == 2)

1843 
	`ql_vîify
(
ql
, 252, 504, 2, 2);

1844 i‡(
f
 == 32)

1845 
	`ql_vîify
(
ql
, 16, 504, 32, 24);

1846 
	`quickli°Rñó£
(
ql
);

1850 
	`TEST
("popÉmpty") {

1851 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1852 
	`quickli°P›
(
ql
, 
QUICKLIST_HEAD
, 
NULL
, NULL, NULL);

1853 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

1854 
	`quickli°Rñó£
(
ql
);

1857 
	`TEST
("pop 1 string from 1") {

1858 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1859 *
p›uœã
 = 
	`gí°r
("hello", 331);

1860 
	`quickli°PushHód
(
ql
, 
p›uœã
, 32);

1861 *
d©a
;

1862 
sz
;

1863 
lv
;

1864 
	`ql_öfo
(
ql
);

1865 
	`quickli°P›
(
ql
, 
QUICKLIST_HEAD
, &
d©a
, &
sz
, &
lv
);

1866 
	`as£π
(
d©a
 !
NULL
);

1867 
	`as£π
(
sz
 == 32);

1868 i‡(
	`°rcmp
(
p›uœã
, (*)
d©a
))

1869 
	`ERR
("P›'d vÆuê(%.*sËdidn'àequÆ origöÆ vÆuê(%s)", 
sz
,

1870 
d©a
, 
p›uœã
);

1871 
	`z‰ì
(
d©a
);

1872 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

1873 
	`quickli°Rñó£
(
ql
);

1876 
	`TEST
("pop head 1Çumber from 1") {

1877 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1878 
	`quickli°PushHód
(
ql
, "55513", 5);

1879 *
d©a
;

1880 
sz
;

1881 
lv
;

1882 
	`ql_öfo
(
ql
);

1883 
	`quickli°P›
(
ql
, 
QUICKLIST_HEAD
, &
d©a
, &
sz
, &
lv
);

1884 
	`as£π
(
d©a
 =
NULL
);

1885 
	`as£π
(
lv
 == 55513);

1886 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

1887 
	`quickli°Rñó£
(
ql
);

1890 
	`TEST
("pop head 500 from 500") {

1891 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1892 
i
 = 0; i < 500; i++)

1893 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

1894 
	`ql_öfo
(
ql
);

1895 
i
 = 0; i < 500; i++) {

1896 *
d©a
;

1897 
sz
;

1898 
lv
;

1899 
ªt
 = 
	`quickli°P›
(
ql
, 
QUICKLIST_HEAD
, &
d©a
, &
sz
, &
lv
);

1900 
	`as£π
(
ªt
 == 1);

1901 
	`as£π
(
d©a
 !
NULL
);

1902 
	`as£π
(
sz
 == 32);

1903 i‡(
	`°rcmp
(
	`gí°r
("hñlo", 499 - 
i
), (*)
d©a
))

1904 
	`ERR
("Pop'd value (%.*s) didn'tÉqual original value (%s)",

1905 
sz
, 
d©a
, 
	`gí°r
("hñlo", 499 - 
i
));

1906 
	`z‰ì
(
d©a
);

1908 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

1909 
	`quickli°Rñó£
(
ql
);

1912 
	`TEST
("pop head 5000 from 500") {

1913 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1914 
i
 = 0; i < 500; i++)

1915 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

1916 
i
 = 0; i < 5000; i++) {

1917 *
d©a
;

1918 
sz
;

1919 
lv
;

1920 
ªt
 = 
	`quickli°P›
(
ql
, 
QUICKLIST_HEAD
, &
d©a
, &
sz
, &
lv
);

1921 i‡(
i
 < 500) {

1922 
	`as£π
(
ªt
 == 1);

1923 
	`as£π
(
d©a
 !
NULL
);

1924 
	`as£π
(
sz
 == 32);

1925 i‡(
	`°rcmp
(
	`gí°r
("hñlo", 499 - 
i
), (*)
d©a
))

1926 
	`ERR
("Pop'd value (%.*s) didn'tÉqual original value "

1928 
sz
, 
d©a
, 
	`gí°r
("hñlo", 499 - 
i
));

1929 
	`z‰ì
(
d©a
);

1931 
	`as£π
(
ªt
 == 0);

1934 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

1935 
	`quickli°Rñó£
(
ql
);

1938 
	`TEST
("iterate forward over 500Üist") {

1939 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1940 
	`quickli°SëFûl
(
ql
, 32);

1941 
i
 = 0; i < 500; i++)

1942 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

1943 
quickli°Iãr
 *
ôî
 = 
	`quickli°GëIãøt‹
(
ql
, 
AL_START_HEAD
);

1944 
quickli°E¡ry
 
íåy
;

1945 
i
 = 499, 
cou¡
 = 0;

1946 
	`quickli°Next
(
ôî
, &
íåy
)) {

1947 *
h
 = 
	`gí°r
("hñlo", 
i
);

1948 i‡(
	`°rcmp
((*)
íåy
.
vÆue
, 
h
))

1949 
	`ERR
("value [%s] didn't match [%s]átÖosition %d",

1950 
íåy
.
vÆue
, 
h
, 
i
);

1951 
i
--;

1952 
cou¡
++;

1954 i‡(
cou¡
 != 500)

1955 
	`ERR
("Didn'àôî©êovîÉxa˘ly 500ÉÀmít†(%d)", 
i
);

1956 
	`ql_vîify
(
ql
, 16, 500, 20, 32);

1957 
	`quickli°Rñó£Iãøt‹
(
ôî
);

1958 
	`quickli°Rñó£
(
ql
);

1961 
	`TEST
("iterateÑeverse over 500Üist") {

1962 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1963 
	`quickli°SëFûl
(
ql
, 32);

1964 
i
 = 0; i < 500; i++)

1965 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

1966 
quickli°Iãr
 *
ôî
 = 
	`quickli°GëIãøt‹
(
ql
, 
AL_START_TAIL
);

1967 
quickli°E¡ry
 
íåy
;

1968 
i
 = 0;

1969 
	`quickli°Next
(
ôî
, &
íåy
)) {

1970 *
h
 = 
	`gí°r
("hñlo", 
i
);

1971 i‡(
	`°rcmp
((*)
íåy
.
vÆue
, 
h
))

1972 
	`ERR
("value [%s] didn't match [%s]átÖosition %d",

1973 
íåy
.
vÆue
, 
h
, 
i
);

1974 
i
++;

1976 i‡(
i
 != 500)

1977 
	`ERR
("Didn'àôî©êovîÉxa˘ly 500ÉÀmít†(%d)", 
i
);

1978 
	`ql_vîify
(
ql
, 16, 500, 20, 32);

1979 
	`quickli°Rñó£Iãøt‹
(
ôî
);

1980 
	`quickli°Rñó£
(
ql
);

1983 
	`TEST
("insert before with 0Élements") {

1984 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1985 
quickli°E¡ry
 
íåy
;

1986 
	`quickli°Index
(
ql
, 0, &
íåy
);

1987 
	`quickli°In£πBef‹e
(
ql
, &
íåy
, "abc", 4);

1988 
	`ql_vîify
(
ql
, 1, 1, 1, 1);

1989 
	`quickli°Rñó£
(
ql
);

1992 
	`TEST
("insertáfter with 0Élements") {

1993 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

1994 
quickli°E¡ry
 
íåy
;

1995 
	`quickli°Index
(
ql
, 0, &
íåy
);

1996 
	`quickli°In£πA·î
(
ql
, &
íåy
, "abc", 4);

1997 
	`ql_vîify
(
ql
, 1, 1, 1, 1);

1998 
	`quickli°Rñó£
(
ql
);

2001 
	`TEST
("insertáfter 1Élement") {

2002 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2003 
	`quickli°PushHód
(
ql
, "hello", 6);

2004 
quickli°E¡ry
 
íåy
;

2005 
	`quickli°Index
(
ql
, 0, &
íåy
);

2006 
	`quickli°In£πA·î
(
ql
, &
íåy
, "abc", 4);

2007 
	`ql_vîify
(
ql
, 1, 2, 2, 2);

2008 
	`quickli°Rñó£
(
ql
);

2011 
	`TEST
("insert before 1Élement") {

2012 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2013 
	`quickli°PushHód
(
ql
, "hello", 6);

2014 
quickli°E¡ry
 
íåy
;

2015 
	`quickli°Index
(
ql
, 0, &
íåy
);

2016 
	`quickli°In£πA·î
(
ql
, &
íåy
, "abc", 4);

2017 
	`ql_vîify
(
ql
, 1, 2, 2, 2);

2018 
	`quickli°Rñó£
(
ql
);

2021 
f
 = 
›timize_°¨t
; f < 12; f++) {

2022 
	`TEST_DESC
("insert once inÉlements while iteratingát fill %dát "

2024 
f
, 
›ti⁄s
[
_i
]) {

2025 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2026 
	`quickli°PushTaû
(
ql
, "abc", 3);

2027 
	`quickli°SëFûl
(
ql
, 1);

2028 
	`quickli°PushTaû
(
ql
, "def", 3);

2029 
	`quickli°SëFûl
(
ql
, 
f
);

2030 
	`quickli°PushTaû
(
ql
, "bob", 3);

2031 
	`quickli°PushTaû
(
ql
, "foo", 3);

2032 
	`quickli°PushTaû
(
ql
, "zoo", 3);

2034 
	`ôΩröå
(
ql
, 0);

2036 
quickli°Iãr
 *
ôî
 = 
	`quickli°GëIãøt‹
(
ql
, 
AL_START_HEAD
);

2037 
quickli°E¡ry
 
íåy
;

2038 
	`quickli°Next
(
ôî
, &
íåy
)) {

2039 i‡(!
	`°∫cmp
((*)
íåy
.
vÆue
, "bob", 3)) {

2041 
	`quickli°In£πBef‹e
(
ql
, &
íåy
, "bar", 3);

2045 
	`ôΩröå
(
ql
, 0);

2048 
	`quickli°Index
(
ql
, 0, &
íåy
);

2049 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, "abc", 3))

2050 
	`ERR
("VÆuê0 didn'àm©ch, in°ód gŸ: %.*s", 
íåy
.
sz
,

2051 
íåy
.
vÆue
);

2052 
	`quickli°Index
(
ql
, 1, &
íåy
);

2053 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, "def", 3))

2054 
	`ERR
("VÆuê1 didn'àm©ch, in°ód gŸ: %.*s", 
íåy
.
sz
,

2055 
íåy
.
vÆue
);

2056 
	`quickli°Index
(
ql
, 2, &
íåy
);

2057 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, "bar", 3))

2058 
	`ERR
("VÆuê2 didn'àm©ch, in°ód gŸ: %.*s", 
íåy
.
sz
,

2059 
íåy
.
vÆue
);

2060 
	`quickli°Index
(
ql
, 3, &
íåy
);

2061 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, "bob", 3))

2062 
	`ERR
("VÆuê3 didn'àm©ch, in°ód gŸ: %.*s", 
íåy
.
sz
,

2063 
íåy
.
vÆue
);

2064 
	`quickli°Index
(
ql
, 4, &
íåy
);

2065 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, "foo", 3))

2066 
	`ERR
("VÆuê4 didn'àm©ch, in°ód gŸ: %.*s", 
íåy
.
sz
,

2067 
íåy
.
vÆue
);

2068 
	`quickli°Index
(
ql
, 5, &
íåy
);

2069 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, "zoo", 3))

2070 
	`ERR
("VÆuê5 didn'àm©ch, in°ód gŸ: %.*s", 
íåy
.
sz
,

2071 
íåy
.
vÆue
);

2072 
	`quickli°Rñó£Iãøt‹
(
ôî
);

2073 
	`quickli°Rñó£
(
ql
);

2077 
f
 = 
›timize_°¨t
; f < 1024; f++) {

2078 
	`TEST_DESC
(

2081 
f
, 
›ti⁄s
[
_i
]) {

2082 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2083 
i
 = 0; i < 500; i++)

2084 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

2085 
i
 = 0; i < 250; i++) {

2086 
quickli°E¡ry
 
íåy
;

2087 
	`quickli°Index
(
ql
, 250, &
íåy
);

2088 
	`quickli°In£πBef‹e
(
ql
, &
íåy
, 
	`gí°r
("abc", 
i
), 32);

2090 i‡(
f
 == 32)

2091 
	`ql_vîify
(
ql
, 25, 750, 32, 20);

2092 
	`quickli°Rñó£
(
ql
);

2096 
f
 = 
›timize_°¨t
; f < 1024; f++) {

2097 
	`TEST_DESC
("insert [after] 250Çew in middle of 500Élementsát "

2099 
f
, 
›ti⁄s
[
_i
]) {

2100 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2101 
i
 = 0; i < 500; i++)

2102 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

2103 
i
 = 0; i < 250; i++) {

2104 
quickli°E¡ry
 
íåy
;

2105 
	`quickli°Index
(
ql
, 250, &
íåy
);

2106 
	`quickli°In£πA·î
(
ql
, &
íåy
, 
	`gí°r
("abc", 
i
), 32);

2109 i‡(
ql
->
cou¡
 != 750)

2110 
	`ERR
("Li° sizênŸ 750, buàøthî %ld", 
ql
->
cou¡
);

2112 i‡(
f
 == 32)

2113 
	`ql_vîify
(
ql
, 26, 750, 20, 32);

2114 
	`quickli°Rñó£
(
ql
);

2118 
	`TEST
("duplicateÉmptyÜist") {

2119 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2120 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

2121 
quickli°
 *
c›y
 = 
	`quickli°Dup
(
ql
);

2122 
	`ql_vîify
(
c›y
, 0, 0, 0, 0);

2123 
	`quickli°Rñó£
(
ql
);

2124 
	`quickli°Rñó£
(
c›y
);

2127 
	`TEST
("duplicateÜist of 1Élement") {

2128 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2129 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hello", 3), 32);

2130 
	`ql_vîify
(
ql
, 1, 1, 1, 1);

2131 
quickli°
 *
c›y
 = 
	`quickli°Dup
(
ql
);

2132 
	`ql_vîify
(
c›y
, 1, 1, 1, 1);

2133 
	`quickli°Rñó£
(
ql
);

2134 
	`quickli°Rñó£
(
c›y
);

2137 
	`TEST
("duplicateÜist of 500") {

2138 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2139 
	`quickli°SëFûl
(
ql
, 32);

2140 
i
 = 0; i < 500; i++)

2141 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

2142 
	`ql_vîify
(
ql
, 16, 500, 20, 32);

2144 
quickli°
 *
c›y
 = 
	`quickli°Dup
(
ql
);

2145 
	`ql_vîify
(
c›y
, 16, 500, 20, 32);

2146 
	`quickli°Rñó£
(
ql
);

2147 
	`quickli°Rñó£
(
c›y
);

2150 
f
 = 
›timize_°¨t
; f < 512; f++) {

2151 
	`TEST_DESC
("ödex 1,200 from 500Üi°áàfû»%dáàcom¥es†%d", 
f
,

2152 
›ti⁄s
[
_i
]) {

2153 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2154 
i
 = 0; i < 500; i++)

2155 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
 + 1), 32);

2156 
quickli°E¡ry
 
íåy
;

2157 
	`quickli°Index
(
ql
, 1, &
íåy
);

2158 i‡(!
	`°rcmp
((*)
íåy
.
vÆue
, "hello2"))

2159 
OK
;

2161 
	`ERR
("VÆue: %s", 
íåy
.
vÆue
);

2162 
	`quickli°Index
(
ql
, 200, &
íåy
);

2163 i‡(!
	`°rcmp
((*)
íåy
.
vÆue
, "hello201"))

2164 
OK
;

2166 
	`ERR
("VÆue: %s", 
íåy
.
vÆue
);

2167 
	`quickli°Rñó£
(
ql
);

2170 
	`TEST_DESC
("ödex -1,-2 from 500Üi°áàfû»%dáàcom¥es†%d", 
f
,

2171 
›ti⁄s
[
_i
]) {

2172 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2173 
i
 = 0; i < 500; i++)

2174 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
 + 1), 32);

2175 
quickli°E¡ry
 
íåy
;

2176 
	`quickli°Index
(
ql
, -1, &
íåy
);

2177 i‡(!
	`°rcmp
((*)
íåy
.
vÆue
, "hello500"))

2178 
OK
;

2180 
	`ERR
("VÆue: %s", 
íåy
.
vÆue
);

2181 
	`quickli°Index
(
ql
, -2, &
íåy
);

2182 i‡(!
	`°rcmp
((*)
íåy
.
vÆue
, "hello499"))

2183 
OK
;

2185 
	`ERR
("VÆue: %s", 
íåy
.
vÆue
);

2186 
	`quickli°Rñó£
(
ql
);

2189 
	`TEST_DESC
("ödex -100 from 500Üi°áàfû»%dáàcom¥es†%d", 
f
,

2190 
›ti⁄s
[
_i
]) {

2191 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2192 
i
 = 0; i < 500; i++)

2193 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
 + 1), 32);

2194 
quickli°E¡ry
 
íåy
;

2195 
	`quickli°Index
(
ql
, -100, &
íåy
);

2196 i‡(!
	`°rcmp
((*)
íåy
.
vÆue
, "hello401"))

2197 
OK
;

2199 
	`ERR
("VÆue: %s", 
íåy
.
vÆue
);

2200 
	`quickli°Rñó£
(
ql
);

2203 
	`TEST_DESC
("indexÅoo big +1 from 50Üistát fill %dát compress %d",

2204 
f
, 
›ti⁄s
[
_i
]) {

2205 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2206 
i
 = 0; i < 50; i++)

2207 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
 + 1), 32);

2208 
quickli°E¡ry
 
íåy
;

2209 i‡(
	`quickli°Index
(
ql
, 50, &
íåy
))

2210 
	`ERR
("Index foundáà50 wôh 50Üi°: %.*s", 
íåy
.
sz
,

2211 
íåy
.
vÆue
);

2213 
OK
;

2214 
	`quickli°Rñó£
(
ql
);

2218 
	`TEST
("deleteÑangeÉmptyÜist") {

2219 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2220 
	`quickli°DñR™ge
(
ql
, 5, 20);

2221 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

2222 
	`quickli°Rñó£
(
ql
);

2225 
	`TEST
("deleteÑange ofÉntireÇode inÜist of oneÇode") {

2226 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2227 
i
 = 0; i < 32; i++)

2228 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

2229 
	`ql_vîify
(
ql
, 1, 32, 32, 32);

2230 
	`quickli°DñR™ge
(
ql
, 0, 32);

2231 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

2232 
	`quickli°Rñó£
(
ql
);

2235 
	`TEST
("deleteÑange ofÉntireÇode with overflow counts") {

2236 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2237 
i
 = 0; i < 32; i++)

2238 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlo", 
i
), 32);

2239 
	`ql_vîify
(
ql
, 1, 32, 32, 32);

2240 
	`quickli°DñR™ge
(
ql
, 0, 128);

2241 
	`ql_vîify
(
ql
, 0, 0, 0, 0);

2242 
	`quickli°Rñó£
(
ql
);

2245 
	`TEST
("delete middle 100 of 500Üist") {

2246 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2247 
	`quickli°SëFûl
(
ql
, 32);

2248 
i
 = 0; i < 500; i++)

2249 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
 + 1), 32);

2250 
	`ql_vîify
(
ql
, 16, 500, 32, 20);

2251 
	`quickli°DñR™ge
(
ql
, 200, 100);

2252 
	`ql_vîify
(
ql
, 14, 400, 32, 20);

2253 
	`quickli°Rñó£
(
ql
);

2256 
	`TEST
("deleteÇegative 1 from 500Üist") {

2257 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2258 
	`quickli°SëFûl
(
ql
, 32);

2259 
i
 = 0; i < 500; i++)

2260 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
 + 1), 32);

2261 
	`ql_vîify
(
ql
, 16, 500, 32, 20);

2262 
	`quickli°DñR™ge
(
ql
, -1, 1);

2263 
	`ql_vîify
(
ql
, 16, 499, 32, 19);

2264 
	`quickli°Rñó£
(
ql
);

2267 
	`TEST
("deleteÇegative 1 from 500Üist with overflow counts") {

2268 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2269 
	`quickli°SëFûl
(
ql
, 32);

2270 
i
 = 0; i < 500; i++)

2271 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
 + 1), 32);

2272 
	`ql_vîify
(
ql
, 16, 500, 32, 20);

2273 
	`quickli°DñR™ge
(
ql
, -1, 128);

2274 
	`ql_vîify
(
ql
, 16, 499, 32, 19);

2275 
	`quickli°Rñó£
(
ql
);

2278 
	`TEST
("deleteÇegative 100 from 500Üist") {

2279 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2280 
	`quickli°SëFûl
(
ql
, 32);

2281 
i
 = 0; i < 500; i++)

2282 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
 + 1), 32);

2283 
	`quickli°DñR™ge
(
ql
, -100, 100);

2284 
	`ql_vîify
(
ql
, 13, 400, 32, 16);

2285 
	`quickli°Rñó£
(
ql
);

2288 
	`TEST
("delete -10 count 5 from 50Üist") {

2289 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2290 
	`quickli°SëFûl
(
ql
, 32);

2291 
i
 = 0; i < 50; i++)

2292 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlo", 
i
 + 1), 32);

2293 
	`ql_vîify
(
ql
, 2, 50, 32, 18);

2294 
	`quickli°DñR™ge
(
ql
, -10, 5);

2295 
	`ql_vîify
(
ql
, 2, 45, 32, 13);

2296 
	`quickli°Rñó£
(
ql
);

2299 
	`TEST
("numbers onlyÜistÑead") {

2300 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2301 
	`quickli°PushTaû
(
ql
, "1111", 4);

2302 
	`quickli°PushTaû
(
ql
, "2222", 4);

2303 
	`quickli°PushTaû
(
ql
, "3333", 4);

2304 
	`quickli°PushTaû
(
ql
, "4444", 4);

2305 
	`ql_vîify
(
ql
, 1, 4, 4, 4);

2306 
quickli°E¡ry
 
íåy
;

2307 
	`quickli°Index
(
ql
, 0, &
íåy
);

2308 i‡(
íåy
.
l⁄gvÆ
 != 1111)

2309 
	`ERR
("NŸ 1111, %Œd", 
íåy
.
l⁄gvÆ
);

2310 
	`quickli°Index
(
ql
, 1, &
íåy
);

2311 i‡(
íåy
.
l⁄gvÆ
 != 2222)

2312 
	`ERR
("NŸ 2222, %Œd", 
íåy
.
l⁄gvÆ
);

2313 
	`quickli°Index
(
ql
, 2, &
íåy
);

2314 i‡(
íåy
.
l⁄gvÆ
 != 3333)

2315 
	`ERR
("NŸ 3333, %Œd", 
íåy
.
l⁄gvÆ
);

2316 
	`quickli°Index
(
ql
, 3, &
íåy
);

2317 i‡(
íåy
.
l⁄gvÆ
 != 4444)

2318 
	`ERR
("NŸ 4444, %Œd", 
íåy
.
l⁄gvÆ
);

2319 i‡(
	`quickli°Index
(
ql
, 4, &
íåy
))

2320 
	`ERR
("IndexÖa°ÉÀmíts: %Œd", 
íåy
.
l⁄gvÆ
);

2321 
	`quickli°Index
(
ql
, -1, &
íåy
);

2322 i‡(
íåy
.
l⁄gvÆ
 != 4444)

2323 
	`ERR
("NŸ 4444 (ªvî£), %Œd", 
íåy
.
l⁄gvÆ
);

2324 
	`quickli°Index
(
ql
, -2, &
íåy
);

2325 i‡(
íåy
.
l⁄gvÆ
 != 3333)

2326 
	`ERR
("NŸ 3333 (ªvî£), %Œd", 
íåy
.
l⁄gvÆ
);

2327 
	`quickli°Index
(
ql
, -3, &
íåy
);

2328 i‡(
íåy
.
l⁄gvÆ
 != 2222)

2329 
	`ERR
("NŸ 2222 (ªvî£), %Œd", 
íåy
.
l⁄gvÆ
);

2330 
	`quickli°Index
(
ql
, -4, &
íåy
);

2331 i‡(
íåy
.
l⁄gvÆ
 != 1111)

2332 
	`ERR
("NŸ 1111 (ªvî£), %Œd", 
íåy
.
l⁄gvÆ
);

2333 i‡(
	`quickli°Index
(
ql
, -5, &
íåy
))

2334 
	`ERR
("IndexÖa°ÉÀmít†‘evî£), %Œd", 
íåy
.
l⁄gvÆ
);

2335 
	`quickli°Rñó£
(
ql
);

2338 
	`TEST
("numbersÜargerÜistÑead") {

2339 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2340 
	`quickli°SëFûl
(
ql
, 32);

2341 
num
[32];

2342 
nums
[5000];

2343 
i
 = 0; i < 5000; i++) {

2344 
nums
[
i
] = -5157318210846258176 + i;

2345 
sz
 = 
	`Œ2°rög
(
num
, “um), 
nums
[
i
]);

2346 
	`quickli°PushTaû
(
ql
, 
num
, 
sz
);

2348 
	`quickli°PushTaû
(
ql
, "xxxxxxxxxxxxxxxxxxxx", 20);

2349 
quickli°E¡ry
 
íåy
;

2350 
i
 = 0; i < 5000; i++) {

2351 
	`quickli°Index
(
ql
, 
i
, &
íåy
);

2352 i‡(
íåy
.
l⁄gvÆ
 !
nums
[
i
])

2353 
	`ERR
("[%d] NŸÜ⁄gvÆ %Œd buàøthî %Œd", 
i
, 
nums
[i],

2354 
íåy
.
l⁄gvÆ
);

2355 
íåy
.
l⁄gvÆ
 = 0xdeadbeef;

2357 
	`quickli°Index
(
ql
, 5000, &
íåy
);

2358 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, "xxxxxxxxxxxxxxxxxxxx", 20))

2359 
	`ERR
("Såög vÆÇŸ m©ch: %s", 
íåy
.
vÆue
);

2360 
	`ql_vîify
(
ql
, 157, 5001, 32, 9);

2361 
	`quickli°Rñó£
(
ql
);

2364 
	`TEST
("numbersÜargerÜistÑead B") {

2365 
quickli°
 *
ql
 = 
	`quickli°New
(-2, 
›ti⁄s
[
_i
]);

2366 
	`quickli°PushTaû
(
ql
, "99", 2);

2367 
	`quickli°PushTaû
(
ql
, "98", 2);

2368 
	`quickli°PushTaû
(
ql
, "xxxxxxxxxxxxxxxxxxxx", 20);

2369 
	`quickli°PushTaû
(
ql
, "96", 2);

2370 
	`quickli°PushTaû
(
ql
, "95", 2);

2371 
	`quickli°Rïœ˚AtIndex
(
ql
, 1, "foo", 3);

2372 
	`quickli°Rïœ˚AtIndex
(
ql
, -1, "bar", 3);

2373 
	`quickli°Rñó£
(
ql
);

2374 
OK
;

2377 
f
 = 
›timize_°¨t
; f < 16; f++) {

2378 
	`TEST_DESC
("ÃemÅe°áàfû»%dáàcom¥es†%d", 
f
, 
›ti⁄s
[
_i
]) {

2379 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2380 *
w‹ds
[] = {"abc", "foo", "bar", "foobar", "foobared",

2382 *
ªsu…
[] = {"abc", "foo", "foobar", "foobared",

2384 *
ªsu…B
[] = {"abc", "foo", "foobar",

2386 
i
 = 0; i < 9; i++)

2387 
	`quickli°PushTaû
(
ql
, 
w‹ds
[
i
], 
	`°æí
(words[i]));

2390 
quickli°Iãr
 *
ôî
 = 
	`quickli°GëIãøt‹
(
ql
, 
AL_START_HEAD
);

2391 
quickli°E¡ry
 
íåy
;

2392 
i
 = 0;

2393 
	`quickli°Next
(
ôî
, &
íåy
)) {

2394 i‡(
	`quickli°Com∑ª
(
íåy
.
zi
, (*)"bar", 3)) {

2395 
	`quickli°DñE¡ry
(
ôî
, &
íåy
);

2397 
i
++;

2399 
	`quickli°Rñó£Iãøt‹
(
ôî
);

2402 
ôî
 = 
	`quickli°GëIãøt‹
(
ql
, 
AL_START_HEAD
);

2403 
i
 = 0;

2404 
ok
 = 1;

2405 
	`quickli°Next
(
ôî
, &
íåy
)) {

2408 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, 
ªsu…
[
i
],É¡ry.
sz
)) {

2409 
	`ERR
("No matchátÖosition %d, got %.*s instead of %s",

2410 
i
, 
íåy
.
sz
,É¡ry.
vÆue
, 
ªsu…
[i]);

2411 
ok
 = 0;

2413 
i
++;

2415 
	`quickli°Rñó£Iãøt‹
(
ôî
);

2417 
	`quickli°PushTaû
(
ql
, "foo", 3);

2420 
ôî
 = 
	`quickli°GëIãøt‹
(
ql
, 
AL_START_TAIL
);

2421 
i
 = 0;

2422 
dñ
 = 2;

2423 
	`quickli°Next
(
ôî
, &
íåy
)) {

2424 i‡(
	`quickli°Com∑ª
(
íåy
.
zi
, (*)"foo", 3)) {

2425 
	`quickli°DñE¡ry
(
ôî
, &
íåy
);

2426 
dñ
--;

2428 i‡(!
dñ
)

2430 
i
++;

2432 
	`quickli°Rñó£Iãøt‹
(
ôî
);

2438 
ôî
 = 
	`quickli°GëIãøt‹
(
ql
, 
AL_START_TAIL
);

2439 
i
 = 0;

2440 
size_t
 
ªsB
 = (
ªsu…B
) / (*resultB);

2441 
	`quickli°Next
(
ôî
, &
íåy
)) {

2444 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, 
ªsu…B
[
ªsB
 - 1 - 
i
],

2445 
íåy
.
sz
)) {

2446 
	`ERR
("No matchátÖosition %d, got %.*s instead of %s",

2447 
i
, 
íåy
.
sz
,É¡ry.
vÆue
, 
ªsu…B
[
ªsB
 - 1 - i]);

2448 
ok
 = 0;

2450 
i
++;

2453 
	`quickli°Rñó£Iãøt‹
(
ôî
);

2455 i‡(
ok
)

2456 
OK
;

2457 
	`quickli°Rñó£
(
ql
);

2461 
f
 = 
›timize_°¨t
; f < 16; f++) {

2462 
	`TEST_DESC
("ôî©êªvî£ + dñëê© fû»%dáàcom¥es†%d", 
f
,

2463 
›ti⁄s
[
_i
]) {

2464 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2465 
	`quickli°PushTaû
(
ql
, "abc", 3);

2466 
	`quickli°PushTaû
(
ql
, "def", 3);

2467 
	`quickli°PushTaû
(
ql
, "hij", 3);

2468 
	`quickli°PushTaû
(
ql
, "jkl", 3);

2469 
	`quickli°PushTaû
(
ql
, "oop", 3);

2471 
quickli°E¡ry
 
íåy
;

2472 
quickli°Iãr
 *
ôî
 = 
	`quickli°GëIãøt‹
(
ql
, 
AL_START_TAIL
);

2473 
i
 = 0;

2474 
	`quickli°Next
(
ôî
, &
íåy
)) {

2475 i‡(
	`quickli°Com∑ª
(
íåy
.
zi
, (*)"hij", 3)) {

2476 
	`quickli°DñE¡ry
(
ôî
, &
íåy
);

2478 
i
++;

2480 
	`quickli°Rñó£Iãøt‹
(
ôî
);

2482 i‡(
i
 != 5)

2483 
	`ERR
("Didn'àôî©ê5Åimes, iãøãd %dÅimes.", 
i
);

2486 
ôî
 = 
	`quickli°GëIãøt‹
(
ql
, 
AL_START_HEAD
);

2487 
i
 = 0;

2488 *
vÆs
[] = {"abc", "def", "jkl", "oop"};

2489 
	`quickli°Next
(
ôî
, &
íåy
)) {

2490 i‡(!
	`quickli°Com∑ª
(
íåy
.
zi
, (*)
vÆs
[
i
],

2492 
	`ERR
("VÆuê© %d didn'àm©ch %s\n", 
i
, 
vÆs
[i]);

2494 
i
++;

2496 
	`quickli°Rñó£Iãøt‹
(
ôî
);

2497 
	`quickli°Rñó£
(
ql
);

2501 
f
 = 
›timize_°¨t
; f < 800; f++) {

2502 
	`TEST_DESC
("ôî©‹áàödexÅe°áàfû»%dáàcom¥es†%d", 
f
,

2503 
›ti⁄s
[
_i
]) {

2504 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2505 
num
[32];

2506 
nums
[5000];

2507 
i
 = 0; i < 760; i++) {

2508 
nums
[
i
] = -5157318210846258176 + i;

2509 
sz
 = 
	`Œ2°rög
(
num
, “um), 
nums
[
i
]);

2510 
	`quickli°PushTaû
(
ql
, 
num
, 
sz
);

2513 
quickli°E¡ry
 
íåy
;

2514 
quickli°Iãr
 *
ôî
 =

2515 
	`quickli°GëIãøt‹AtIdx
(
ql
, 
AL_START_HEAD
, 437);

2516 
i
 = 437;

2517 
	`quickli°Next
(
ôî
, &
íåy
)) {

2518 i‡(
íåy
.
l⁄gvÆ
 !
nums
[
i
])

2519 
	`ERR
("Ex≥˘ed %Œd, buàgŸ %Œd", 
íåy
.
l⁄gvÆ
,

2520 
nums
[
i
]);

2521 
i
++;

2523 
	`quickli°Rñó£Iãøt‹
(
ôî
);

2524 
	`quickli°Rñó£
(
ql
);

2528 
f
 = 
›timize_°¨t
; f < 40; f++) {

2529 
	`TEST_DESC
("…rimÅe° Aáàfû»%dáàcom¥es†%d", 
f
,

2530 
›ti⁄s
[
_i
]) {

2531 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2532 
num
[32];

2533 
nums
[5000];

2534 
i
 = 0; i < 32; i++) {

2535 
nums
[
i
] = -5157318210846258176 + i;

2536 
sz
 = 
	`Œ2°rög
(
num
, “um), 
nums
[
i
]);

2537 
	`quickli°PushTaû
(
ql
, 
num
, 
sz
);

2539 i‡(
f
 == 32)

2540 
	`ql_vîify
(
ql
, 1, 32, 32, 32);

2542 
	`quickli°DñR™ge
(
ql
, 0, 25);

2543 
	`quickli°DñR™ge
(
ql
, 0, 0);

2544 
quickli°E¡ry
 
íåy
;

2545 
i
 = 0; i < 7; i++) {

2546 
	`quickli°Index
(
ql
, 
i
, &
íåy
);

2547 i‡(
íåy
.
l⁄gvÆ
 !
nums
[25 + 
i
])

2548 
	`ERR
("Deleted invalidÑange! Expected %lld but got "

2550 
íåy
.
l⁄gvÆ
, 
nums
[25 + 
i
]);

2552 i‡(
f
 == 32)

2553 
	`ql_vîify
(
ql
, 1, 7, 7, 7);

2554 
	`quickli°Rñó£
(
ql
);

2558 
f
 = 
›timize_°¨t
; f < 40; f++) {

2559 
	`TEST_DESC
("…rimÅe° Báàfû»%dáàcom¥es†%d", 
f
,

2560 
›ti⁄s
[
_i
]) {

2563 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
QUICKLIST_NOCOMPRESS
);

2564 
num
[32];

2565 
nums
[5000];

2566 
i
 = 0; i < 33; i++) {

2567 
nums
[
i
] = i;

2568 
sz
 = 
	`Œ2°rög
(
num
, “um), 
nums
[
i
]);

2569 
	`quickli°PushTaû
(
ql
, 
num
, 
sz
);

2571 i‡(
f
 == 32)

2572 
	`ql_vîify
(
ql
, 2, 33, 32, 1);

2574 
	`quickli°DñR™ge
(
ql
, 0, 5);

2575 
	`quickli°DñR™ge
(
ql
, -16, 16);

2576 i‡(
f
 == 32)

2577 
	`ql_vîify
(
ql
, 1, 12, 12, 12);

2578 
quickli°E¡ry
 
íåy
;

2579 
	`quickli°Index
(
ql
, 0, &
íåy
);

2580 i‡(
íåy
.
l⁄gvÆ
 != 5)

2581 
	`ERR
("A:Ü⁄gvÆÇŸ 5, buà%Œd", 
íåy
.
l⁄gvÆ
);

2583 
OK
;

2584 
	`quickli°Index
(
ql
, -1, &
íåy
);

2585 i‡(
íåy
.
l⁄gvÆ
 != 16)

2586 
	`ERR
("B! gŸ in°ód: %Œd", 
íåy
.
l⁄gvÆ
);

2588 
OK
;

2589 
	`quickli°PushTaû
(
ql
, "bobobob", 7);

2590 
	`quickli°Index
(
ql
, -1, &
íåy
);

2591 i‡(
	`°∫cmp
((*)
íåy
.
vÆue
, "bobobob", 7))

2592 
	`ERR
("Tail doesn't match bobobob, it's %.*s instead",

2593 
íåy
.
sz
,É¡ry.
vÆue
);

2594 
i
 = 0; i < 12; i++) {

2595 
	`quickli°Index
(
ql
, 
i
, &
íåy
);

2596 i‡(
íåy
.
l⁄gvÆ
 !
nums
[5 + 
i
])

2597 
	`ERR
("Deleted invalidÑange! Expected %lld but got "

2599 
íåy
.
l⁄gvÆ
, 
nums
[5 + 
i
]);

2601 
	`quickli°Rñó£
(
ql
);

2605 
f
 = 
›timize_°¨t
; f < 40; f++) {

2606 
	`TEST_DESC
("…rimÅe° Cáàfû»%dáàcom¥es†%d", 
f
,

2607 
›ti⁄s
[
_i
]) {

2608 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2609 
num
[32];

2610 
nums
[5000];

2611 
i
 = 0; i < 33; i++) {

2612 
nums
[
i
] = -5157318210846258176 + i;

2613 
sz
 = 
	`Œ2°rög
(
num
, “um), 
nums
[
i
]);

2614 
	`quickli°PushTaû
(
ql
, 
num
, 
sz
);

2616 i‡(
f
 == 32)

2617 
	`ql_vîify
(
ql
, 2, 33, 32, 1);

2619 
	`quickli°DñR™ge
(
ql
, 0, 3);

2620 
	`quickli°DñR™ge
(
ql
, -29,

2622 i‡(
f
 == 32)

2623 
	`ql_vîify
(
ql
, 1, 1, 1, 1);

2624 
quickli°E¡ry
 
íåy
;

2625 
	`quickli°Index
(
ql
, 0, &
íåy
);

2626 i‡(
íåy
.
l⁄gvÆ
 != -5157318210846258173)

2627 
ERROR
;

2629 
OK
;

2630 
	`quickli°Rñó£
(
ql
);

2634 
f
 = 
›timize_°¨t
; f < 40; f++) {

2635 
	`TEST_DESC
("…rimÅe° Dáàfû»%dáàcom¥es†%d", 
f
,

2636 
›ti⁄s
[
_i
]) {

2637 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
›ti⁄s
[
_i
]);

2638 
num
[32];

2639 
nums
[5000];

2640 
i
 = 0; i < 33; i++) {

2641 
nums
[
i
] = -5157318210846258176 + i;

2642 
sz
 = 
	`Œ2°rög
(
num
, “um), 
nums
[
i
]);

2643 
	`quickli°PushTaû
(
ql
, 
num
, 
sz
);

2645 i‡(
f
 == 32)

2646 
	`ql_vîify
(
ql
, 2, 33, 32, 1);

2647 
	`quickli°DñR™ge
(
ql
, -12, 3);

2648 i‡(
ql
->
cou¡
 != 30)

2649 
	`ERR
("Didn't deleteÉxactlyÅhreeÉlements! Count is: %lu",

2650 
ql
->
cou¡
);

2651 
	`quickli°Rñó£
(
ql
);

2655 
f
 = 
›timize_°¨t
; f < 72; f++) {

2656 
	`TEST_DESC
("create quicklist from ziplistát fill %dát compress %d",

2657 
f
, 
›ti⁄s
[
_i
]) {

2658 *
zl
 = 
	`zùli°New
();

2659 
nums
[64];

2660 
num
[64];

2661 
i
 = 0; i < 33; i++) {

2662 
nums
[
i
] = -5157318210846258176 + i;

2663 
sz
 = 
	`Œ2°rög
(
num
, “um), 
nums
[
i
]);

2664 
zl
 =

2665 
	`zùli°Push
(
zl
, (*)
num
, 
sz
, 
ZIPLIST_TAIL
);

2667 
i
 = 0; i < 33; i++) {

2668 
zl
 = 
	`zùli°Push
(zl, (*)
	`gí°r
("hñlo", 
i
),

2669 32, 
ZIPLIST_TAIL
);

2671 
quickli°
 *
ql
 = 
	`quickli°Cª©eFromZùli°
(
f
, 
›ti⁄s
[
_i
], 
zl
);

2672 i‡(
f
 == 1)

2673 
	`ql_vîify
(
ql
, 66, 66, 1, 1);

2674 i‡(
f
 == 32)

2675 
	`ql_vîify
(
ql
, 3, 66, 32, 2);

2676 i‡(
f
 == 66)

2677 
	`ql_vîify
(
ql
, 1, 66, 66, 66);

2678 
	`quickli°Rñó£
(
ql
);

2682 
°›
 = 
	`m°ime
();

2683 
ru¡ime
[
_i
] = 
°›
 - 
°¨t
;

2687 
li°_sizes
[] = {250, 251, 500, 999, 1000};

2688 
°¨t
 = 
	`m°ime
();

2689 
li°
 = 0;Üi° < ()((
li°_sizes
) / (*list_sizes));

2690 
li°
++) {

2691 
f
 = 
›timize_°¨t
; f < 128; f++) {

2692 
dïth
 = 1; depth < 40; depth++) {

2694 
	`TEST_DESC
("verify specific compression of interiorÇodes with "

2697 
li°_sizes
[
li°
], 
f
, 
dïth
) {

2698 
quickli°
 *
ql
 = 
	`quickli°New
(
f
, 
dïth
);

2699 
i
 = 0; i < 
li°_sizes
[
li°
]; i++) {

2700 
	`quickli°PushTaû
(
ql
, 
	`gí°r
("hñlÿTAIL", 
i
 + 1), 64);

2701 
	`quickli°PushHód
(
ql
, 
	`gí°r
("hñlÿHEAD", 
i
 + 1), 64);

2704 
quickli°Node
 *
node
 = 
ql
->
hód
;

2705 
low_øw
 = 
ql
->
com¥ess
;

2706 
high_øw
 = 
ql
->
Àn
 - ql->
com¥ess
;

2708 
©
 = 0;áà< 
ql
->
Àn
;

2709 
©
++, 
node
 =Çode->
√xt
) {

2710 i‡(
©
 < 
low_øw
 ||áà>
high_øw
) {

2711 i‡(
node
->
ícodög
 !
QUICKLIST_NODE_ENCODING_RAW
) {

2712 
	`ERR
("Incorrect compression:Çode %d is "

2715 
©
, 
dïth
, 
low_øw
, 
high_øw
, 
ql
->
Àn
,

2716 
node
->
sz
);

2719 i‡(
node
->
ícodög
 !
QUICKLIST_NODE_ENCODING_LZF
) {

2720 
	`ERR
("IncorrectÇon-compression:Çode %d is NOT "

2723 
©
, 
dïth
, 
low_øw
, 
high_øw
, 
ql
->
Àn
,

2724 
node
->
sz
,Çode->
©ãm±ed_com¥ess
);

2728 
	`quickli°Rñó£
(
ql
);

2733 
°›
 = 
	`m°ime
();

2735 
	`¥ötf
("\n");

2736 
size_t
 
i
 = 0; i < 
›ti⁄_cou¡
; i++)

2737 
	`¥ötf
("Te° Lo› %02d: %0.2‡£c⁄ds.\n", 
›ti⁄s
[
i
],

2738 ()
ru¡ime
[
i
] / 1000);

2739 
	`¥ötf
("Com¥essi⁄s: %0.2‡£c⁄ds.\n", ()(
°›
 - 
°¨t
) / 1000);

2740 
	`¥ötf
("\n");

2742 
	`TEST
("bookmark get updatedÅoÇext item") {

2743 
quickli°
 *
ql
 = 
	`quickli°New
(1, 0);

2744 
	`quickli°PushTaû
(
ql
, "1", 1);

2745 
	`quickli°PushTaû
(
ql
, "2", 1);

2746 
	`quickli°PushTaû
(
ql
, "3", 1);

2747 
	`quickli°PushTaû
(
ql
, "4", 1);

2748 
	`quickli°PushTaû
(
ql
, "5", 1);

2749 
	`as£π
(
ql
->
Àn
==5);

2751 
	`as£π
(
	`quickli°Bookm¨kCª©e
(&
ql
, "_dummy", ql->
hód
->
√xt
));

2752 
	`as£π
(
	`quickli°Bookm¨kCª©e
(&
ql
, "_ã°", ql->
èû
->
¥ev
));

2754 
	`as£π
(
	`quickli°Bookm¨kFöd
(
ql
, "_ã°"Ë=ql->
èû
->
¥ev
);

2755 
	`as£π
(
	`quickli°DñR™ge
(
ql
, -2, 1));

2756 
	`as£π
(
	`quickli°Bookm¨kFöd
(
ql
, "_ã°"Ë=ql->
èû
);

2758 
	`as£π
(
	`quickli°DñR™ge
(
ql
, -1, 1));

2759 
	`as£π
(
	`quickli°Bookm¨kFöd
(
ql
, "_ã°"Ë=
NULL
);

2761 
	`as£π
(
	`quickli°Bookm¨kFöd
(
ql
, "_dummy"Ë=ql->
hód
->
√xt
);

2762 
	`as£π
(
	`quickli°Bookm¨kFöd
(
ql
, "_missög"Ë=
NULL
);

2763 
	`as£π
(
ql
->
Àn
==3);

2764 
	`quickli°Bookm¨ksCÀ¨
(
ql
);

2765 
	`as£π
(
	`quickli°Bookm¨kFöd
(
ql
, "_dummy"Ë=
NULL
);

2766 
	`quickli°Rñó£
(
ql
);

2769 
	`TEST
("bookmarkÜimit") {

2770 
i
;

2771 
quickli°
 *
ql
 = 
	`quickli°New
(1, 0);

2772 
	`quickli°PushHód
(
ql
, "1", 1);

2773 
i
=0; i<
QL_MAX_BM
; i++)

2774 
	`as£π
(
	`quickli°Bookm¨kCª©e
(&
ql
, 
	`gí°r
("",
i
), ql->
hód
));

2776 
	`as£π
(!
	`quickli°Bookm¨kCª©e
(&
ql
, "_ã°", ql->
hód
));

2778 
	`as£π
(
	`quickli°Bookm¨kDñëe
(
ql
, "0"));

2779 
	`as£π
(
	`quickli°Bookm¨kCª©e
(&
ql
, "_ã°", ql->
hód
));

2781 
	`as£π
(
	`quickli°Bookm¨kDñëe
(
ql
, "_test"));

2782 
i
=1; i<
QL_MAX_BM
; i++)

2783 
	`as£π
(
	`quickli°Bookm¨kFöd
(
ql
, 
	`gí°r
("",
i
)Ë=ql->
hód
);

2785 
	`as£π
(!
	`quickli°Bookm¨kFöd
(
ql
, "0"));

2786 
	`as£π
(!
	`quickli°Bookm¨kFöd
(
ql
, "_test"));

2787 
	`quickli°Rñó£
(
ql
);

2790 i‡(!
îr
)

2791 
	`¥ötf
("ALL TESTS PASSED!\n");

2793 
	`ERR
("S‹ry,ÇŸáŒÅe°†∑s£d! I¿Á˘, %dÅe°†Áûed.", 
îr
);

2795  
îr
;

2796 
	}
}

	@quicklist.h

31 
	~<°döt.h
>

33 #i‚de‡
__QUICKLIST_H__


34 
	#__QUICKLIST_H__


	)

46 
	squickli°Node
 {

47 
quickli°Node
 *
	m¥ev
;

48 
quickli°Node
 *
	m√xt
;

49 *
	mzl
;

50 
	msz
;

51 
	mcou¡
 : 16;

52 
	mícodög
 : 2;

53 
	mc⁄èöî
 : 2;

54 
	mªcom¥ess
 : 1;

55 
	m©ãm±ed_com¥ess
 : 1;

56 
	mexåa
 : 10;

57 } 
	tquickli°Node
;

64 
	squickli°LZF
 {

65 
	msz
;

66 
	mcom¥es£d
[];

67 } 
	tquickli°LZF
;

77 
	squickli°Bookm¨k
 {

78 
quickli°Node
 *
	mnode
;

79 *
	m«me
;

80 } 
	tquickli°Bookm¨k
;

82 #i‡
UINTPTR_MAX
 == 0xffffffff

84 
	#QL_FILL_BITS
 14

	)

85 
	#QL_COMP_BITS
 14

	)

86 
	#QL_BM_BITS
 4

	)

87 #ñi‡
UINTPTR_MAX
 == 0xffffffffffffffff

89 
	#QL_FILL_BITS
 16

	)

90 
	#QL_COMP_BITS
 16

	)

91 
	#QL_BM_BITS
 4

	)

94 #îr‹ 
unknown
 
¨ch
 
bôs
 
cou¡


105 
	squickli°
 {

106 
quickli°Node
 *
	mhód
;

107 
quickli°Node
 *
	mèû
;

108 
	mcou¡
;

109 
	mÀn
;

110 
	mfûl
 : 
QL_FILL_BITS
;

111 
	mcom¥ess
 : 
QL_COMP_BITS
;

112 
	mbookm¨k_cou¡
: 
QL_BM_BITS
;

113 
quickli°Bookm¨k
 
	mbookm¨ks
[];

114 } 
	tquickli°
;

116 
	squickli°Iãr
 {

117 c⁄° 
quickli°
 *
	mquickli°
;

118 
quickli°Node
 *
	mcuºít
;

119 *
	mzi
;

120 
	moff£t
;

121 
	mdúe˘i⁄
;

122 } 
	tquickli°Iãr
;

124 
	squickli°E¡ry
 {

125 c⁄° 
quickli°
 *
	mquickli°
;

126 
quickli°Node
 *
	mnode
;

127 *
	mzi
;

128 *
	mvÆue
;

129 
	ml⁄gvÆ
;

130 
	msz
;

131 
	moff£t
;

132 } 
	tquickli°E¡ry
;

134 
	#QUICKLIST_HEAD
 0

	)

135 
	#QUICKLIST_TAIL
 -1

	)

138 
	#QUICKLIST_NODE_ENCODING_RAW
 1

	)

139 
	#QUICKLIST_NODE_ENCODING_LZF
 2

	)

142 
	#QUICKLIST_NOCOMPRESS
 0

	)

145 
	#QUICKLIST_NODE_CONTAINER_NONE
 1

	)

146 
	#QUICKLIST_NODE_CONTAINER_ZIPLIST
 2

	)

148 
	#quickli°NodeIsCom¥es£d
(
node
) \

149 ((
node
)->
ícodög
 =
QUICKLIST_NODE_ENCODING_LZF
)

	)

152 
quickli°
 *
quickli°Cª©e
();

153 
quickli°
 *
quickli°New
(
fûl
, 
com¥ess
);

154 
quickli°SëCom¥essDïth
(
quickli°
 *quickli°, 
dïth
);

155 
quickli°SëFûl
(
quickli°
 *quickli°, 
fûl
);

156 
quickli°SëO±i⁄s
(
quickli°
 *quickli°, 
fûl
, 
dïth
);

157 
quickli°Rñó£
(
quickli°
 *quicklist);

158 
quickli°PushHód
(
quickli°
 *quickli°, *
vÆue
, c⁄° 
size_t
 
sz
);

159 
quickli°PushTaû
(
quickli°
 *quickli°, *
vÆue
, c⁄° 
size_t
 
sz
);

160 
quickli°Push
(
quickli°
 *quickli°, *
vÆue
, c⁄° 
size_t
 
sz
,

161 
whîe
);

162 
quickli°AµídZùli°
(
quickli°
 *quickli°, *
zl
);

163 
quickli°
 *
quickli°AµídVÆuesFromZùli°
(quicklist *quicklist,

164 *
zl
);

165 
quickli°
 *
quickli°Cª©eFromZùli°
(
fûl
, 
com¥ess
,

166 *
zl
);

167 
quickli°In£πA·î
(
quickli°
 *quickli°, 
quickli°E¡ry
 *
node
,

168 *
vÆue
, c⁄° 
size_t
 
sz
);

169 
quickli°In£πBef‹e
(
quickli°
 *quickli°, 
quickli°E¡ry
 *
node
,

170 *
vÆue
, c⁄° 
size_t
 
sz
);

171 
quickli°DñE¡ry
(
quickli°Iãr
 *
ôî
, 
quickli°E¡ry
 *
íåy
);

172 
quickli°Rïœ˚AtIndex
(
quickli°
 *quickli°, 
ödex
, *
d©a
,

173 
sz
);

174 
quickli°DñR™ge
(
quickli°
 *quickli°, c⁄° 
°¨t
, c⁄° 
°›
);

175 
quickli°Iãr
 *
quickli°GëIãøt‹
(c⁄° 
quickli°
 *quickli°, 
dúe˘i⁄
);

176 
quickli°Iãr
 *
quickli°GëIãøt‹AtIdx
(c⁄° 
quickli°
 *quicklist,

177 
dúe˘i⁄
, c⁄° 
idx
);

178 
quickli°Next
(
quickli°Iãr
 *
ôî
, 
quickli°E¡ry
 *
node
);

179 
quickli°Rñó£Iãøt‹
(
quickli°Iãr
 *
ôî
);

180 
quickli°
 *
quickli°Dup
(quickli° *
‹ig
);

181 
quickli°Index
(c⁄° 
quickli°
 *quickli°, c⁄° 
ödex
,

182 
quickli°E¡ry
 *
íåy
);

183 
quickli°Rewöd
(
quickli°
 *quickli°, 
quickli°Iãr
 *
li
);

184 
quickli°RewödTaû
(
quickli°
 *quickli°, 
quickli°Iãr
 *
li
);

185 
quickli°RŸ©e
(
quickli°
 *quicklist);

186 
quickli°P›Cu°om
(
quickli°
 *quickli°, 
whîe
, **
d©a
,

187 *
sz
, *
svÆ
,

188 *(*
ßvî
)(*
d©a
, 
sz
));

189 
quickli°P›
(
quickli°
 *quickli°, 
whîe
, **
d©a
,

190 *
sz
, *
¶⁄g
);

191 
quickli°Cou¡
(c⁄° 
quickli°
 *
ql
);

192 
quickli°Com∑ª
(*
p1
, *
p2
, 
p2_Àn
);

193 
size_t
 
quickli°GëLzf
(c⁄° 
quickli°Node
 *
node
, **
d©a
);

196 
quickli°Bookm¨kCª©e
(
quickli°
 **
ql_ªf
, c⁄° *
«me
, 
quickli°Node
 *
node
);

197 
quickli°Bookm¨kDñëe
(
quickli°
 *
ql
, c⁄° *
«me
);

198 
quickli°Node
 *
quickli°Bookm¨kFöd
(
quickli°
 *
ql
, c⁄° *
«me
);

199 
quickli°Bookm¨ksCÀ¨
(
quickli°
 *
ql
);

201 #ifde‡
REDIS_TEST


202 
quickli°Te°
(
¨gc
, *
¨gv
[]);

206 
	#AL_START_HEAD
 0

	)

207 
	#AL_START_TAIL
 1

	)

	@rand.c

44 
	~<°döt.h
>

46 
	#N
 16

	)

47 
	#MASK
 ((1 << (
N
 - 1)Ë+ (1 << (N - 1)Ë- 1)

	)

48 
	#LOW
(
x
Ë(()(xË& 
MASK
)

	)

49 
	#HIGH
(
x
Ë
	`LOW
((xË>> 
N
)

	)

50 
	#MUL
(
x
, 
y
, 
z
Ë{ 
öt32_t
 
l
 = ()(x) * ()(y); \

51 (
z
)[0] = 
	`LOW
(
l
); (z)[1] = 
	`HIGH
÷); }

	)

52 
	#CARRY
(
x
, 
y
Ë((
öt32_t
)(xË+ ()(yË> 
MASK
)

	)

53 
	#ADDEQU
(
x
, 
y
, 
z
Ë(z = 
	`CARRY
(x, (y)), x = 
	`LOW
(x + (y)))

	)

54 
	#X0
 0x330E

	)

55 
	#X1
 0xABCD

	)

56 
	#X2
 0x1234

	)

57 
	#A0
 0xE66D

	)

58 
	#A1
 0xDEEC

	)

59 
	#A2
 0x5

	)

60 
	#C
 0xB

	)

61 
	#SET3
(
x
, 
x0
, 
x1
, 
x2
Ë((x)[0] = (x0), (x)[1] = (x1), (x)[2] = (x2))

	)

62 
	#SETLOW
(
x
, 
y
, 
n
Ë
	`SET3
(x, 
	`LOW
((y)[n]), LOW((y)[“)+1]), LOW((y)[“)+2]))

	)

63 
	#SEED
(
x0
, 
x1
, 
x2
Ë(
	`SET3
(
x
, x0, x1, x2), SET3(
a
, 
A0
, 
A1
, 
A2
), 
c
 = 
C
)

	)

64 
	#REST
(
v
Ë
i
 = 0; i < 3; i++Ë{ 
xsubi
[i] = 
x
[i]; x[i] = 
ãmp
[i]; } \

65  (
v
);

	)

66 
	#HI_BIT
 (1L << (2 * 
N
 - 1))

	)

68 
uöt32_t
 
	gx
[3] = { 
X0
, 
X1
, 
X2
 }, 
	ga
[3] = { 
A0
, 
A1
, 
A2
 }, 
	gc
 = 
C
;

69 
√xt
();

71 
öt32_t
 
	$ªdisLønd48
() {

72 
	`√xt
();

73  (((
öt32_t
)
x
[2] << (
N
 - 1)) + (x[1] >> 1));

74 
	}
}

76 
	$ªdisSønd48
(
öt32_t
 
£edvÆ
) {

77 
	`SEED
(
X0
, 
	`LOW
(
£edvÆ
), 
	`HIGH
(seedval));

78 
	}
}

80 
	$√xt
() {

81 
uöt32_t
 
p
[2], 
q
[2], 
r
[2], 
ˇºy0
, 
ˇºy1
;

83 
	`MUL
(
a
[0], 
x
[0], 
p
);

84 
	`ADDEQU
(
p
[0], 
c
, 
ˇºy0
);

85 
	`ADDEQU
(
p
[1], 
ˇºy0
, 
ˇºy1
);

86 
	`MUL
(
a
[0], 
x
[1], 
q
);

87 
	`ADDEQU
(
p
[1], 
q
[0], 
ˇºy0
);

88 
	`MUL
(
a
[1], 
x
[0], 
r
);

89 
x
[2] = 
	`LOW
(
ˇºy0
 + 
ˇºy1
 + 
	`CARRY
(
p
[1], 
r
[0]Ë+ 
q
[1] +Ñ[1] +

90 
a
[0] * 
x
[2] +á[1] * x[1] +á[2] * x[0]);

91 
x
[1] = 
	`LOW
(
p
[1] + 
r
[0]);

92 
x
[0] = 
	`LOW
(
p
[0]);

93 
	}
}

	@rand.h

30 #i‚de‡
REDIS_RANDOM_H


31 
	#REDIS_RANDOM_H


	)

33 
öt32_t
 
ªdisLønd48
();

34 
ªdisSønd48
(
öt32_t
 
£edvÆ
);

36 
	#REDIS_LRAND48_MAX
 
INT32_MAX


	)

	@rax.c

33 
	~<°dlib.h
>

34 
	~<°rög.h
>

35 
	~<as£π.h
>

36 
	~<°dio.h
>

37 
	~<î∫o.h
>

38 
	~<m©h.h
>

39 
	~"øx.h
"

41 #i‚de‡
RAX_MALLOC_INCLUDE


42 
	#RAX_MALLOC_INCLUDE
 "øx_mÆloc.h"

	)

45 #ö˛udê
RAX_MALLOC_INCLUDE


50 *
	gøxNŸFound
 = (*)"rax-not-found-pointer";

54 
øxDebugShowNode
(c⁄° *
msg
, 
øxNode
 *
n
);

61 #ifde‡
RAX_DEBUG_MSG


62 
	#debugf
(...) \

63 i‡(
øxDebugMsg
) { \

64 
	`¥ötf
("%s:%s:%d:\t", 
__FILE__
, 
__FUNCTION__
, 
__LINE__
); \

65 
	`¥ötf
(
__VA_ARGS__
); \

66 
	`fÊush
(
°dout
); \

67 }

	)

69 
	#debugnode
(
msg
,
n
Ë
	`øxDebugShowNode
(msg,n)

	)

71 
	#debugf
(...)

	)

72 
	#debugnode
(
msg
,
n
)

	)

76 
	gøxDebugMsg
 = 1;

81 
	$øxSëDebugMsg
(
⁄off
) {

82 
øxDebugMsg
 = 
⁄off
;

83 
	}
}

94 
ölöe
 
	$øxSèckInô
(
øxSèck
 *
ts
) {

95 
ts
->
°ack
 =Ås->
°©ic_ôems
;

96 
ts
->
ôems
 = 0;

97 
ts
->
maxôems
 = 
RAX_STACK_STATIC_ITEMS
;

98 
ts
->
oom
 = 0;

99 
	}
}

102 
ölöe
 
	$øxSèckPush
(
øxSèck
 *
ts
, *
±r
) {

103 i‡(
ts
->
ôems
 =ts->
maxôems
) {

104 i‡(
ts
->
°ack
 =ts->
°©ic_ôems
) {

105 
ts
->
°ack
 = 
	`øx_mÆloc
((*)*ts->
maxôems
*2);

106 i‡(
ts
->
°ack
 =
NULL
) {

107 
ts
->
°ack
 =Ås->
°©ic_ôems
;

108 
ts
->
oom
 = 1;

109 
î∫o
 = 
ENOMEM
;

112 
	`mem˝y
(
ts
->
°ack
,ts->
°©ic_ôems
,(*)*ts->
maxôems
);

114 **
√wÆloc
 = 
	`øx_ªÆloc
(
ts
->
°ack
,(*)*ts->
maxôems
*2);

115 i‡(
√wÆloc
 =
NULL
) {

116 
ts
->
oom
 = 1;

117 
î∫o
 = 
ENOMEM
;

120 
ts
->
°ack
 = 
√wÆloc
;

122 
ts
->
maxôems
 *= 2;

124 
ts
->
°ack
[ts->
ôems
] = 
±r
;

125 
ts
->
ôems
++;

127 
	}
}

131 
ölöe
 *
	$øxSèckP›
(
øxSèck
 *
ts
) {

132 i‡(
ts
->
ôems
 =0Ë 
NULL
;

133 
ts
->
ôems
--;

134  
ts
->
°ack
[ts->
ôems
];

135 
	}
}

139 
ölöe
 *
	$øxSèckPìk
(
øxSèck
 *
ts
) {

140 i‡(
ts
->
ôems
 =0Ë 
NULL
;

141  
ts
->
°ack
[ts->
ôems
-1];

142 
	}
}

145 
ölöe
 
	$øxSèckFªe
(
øxSèck
 *
ts
) {

146 i‡(
ts
->
°ack
 !ts->
°©ic_ôems
Ë
	`øx_‰ì
(ts->stack);

147 
	}
}

157 
	#øxPaddög
(
nodesize
Ë(((*)-(“odesize+4Ë% (*))Ë& ((*)-1))

	)

161 
	#øxNodeLa°ChûdPå
(
n
Ë((
øxNode
**) ( \

162 ((*)(
n
)) + \

163 
	`øxNodeCuºítLígth
(
n
) - \

164 (
øxNode
*) - \

165 (((
n
)->
iskey
 && !“)->
i¢uŒ
) ? (*) : 0) \

166 ))

	)

169 
	#øxNodeFú°ChûdPå
(
n
Ë((
øxNode
**) ( \

170 (
n
)->
d©a
 + \

171 (
n
)->
size
 + \

172 
	`øxPaddög
((
n
)->
size
)))

	)

177 
	#øxNodeCuºítLígth
(
n
) ( \

178 (
øxNode
)+(
n
)->
size
+ \

179 
	`øxPaddög
((
n
)->
size
)+ \

180 ((
n
)->
iscom¥
 ? (
øxNode
*Ë: ‘axNode*)*“)->
size
)+ \

181 (((
n
)->
iskey
 && !“)->
i¢uŒ
)*(*)) \

182 )

	)

188 
øxNode
 *
	$øxNewNode
(
size_t
 
chûdªn
, 
d©afõld
) {

189 
size_t
 
nodesize
 = (
øxNode
)+
chûdªn
+
	`øxPaddög
(children)+

190 (
øxNode
*)*
chûdªn
;

191 i‡(
d©afõld
Ë
nodesize
 += (*);

192 
øxNode
 *
node
 = 
	`øx_mÆloc
(
nodesize
);

193 i‡(
node
 =
NULL
)  NULL;

194 
node
->
iskey
 = 0;

195 
node
->
i¢uŒ
 = 0;

196 
node
->
iscom¥
 = 0;

197 
node
->
size
 = 
chûdªn
;

198  
node
;

199 
	}
}

203 
øx
 *
	$øxNew
() {

204 
øx
 *øx = 
	`øx_mÆloc
((*rax));

205 i‡(
øx
 =
NULL
)  NULL;

206 
øx
->
numñe
 = 0;

207 
øx
->
numnodes
 = 1;

208 
øx
->
hód
 = 
	`øxNewNode
(0,0);

209 i‡(
øx
->
hód
 =
NULL
) {

210 
	`øx_‰ì
(
øx
);

211  
NULL
;

213  
øx
;

215 
	}
}

219 
øxNode
 *
	$øxRóŒocF‹D©a
(
øxNode
 *
n
, *
d©a
) {

220 i‡(
d©a
 =
NULL
Ë 
n
;

221 
size_t
 
cuæí
 = 
	`øxNodeCuºítLígth
(
n
);

222  
	`øx_ªÆloc
(
n
,
cuæí
+(*));

223 
	}
}

226 
	$øxSëD©a
(
øxNode
 *
n
, *
d©a
) {

227 
n
->
iskey
 = 1;

228 i‡(
d©a
 !
NULL
) {

229 
n
->
i¢uŒ
 = 0;

230 **
nd©a
 = (**)

231 ((*)
n
+
	`øxNodeCuºítLígth
(n)-(*));

232 
	`mem˝y
(
nd©a
,&
d©a
,(data));

234 
n
->
i¢uŒ
 = 1;

236 
	}
}

239 *
	$øxGëD©a
(
øxNode
 *
n
) {

240 i‡(
n
->
i¢uŒ
Ë 
NULL
;

241 **
nd©a
 =(**)((*)
n
+
	`øxNodeCuºítLígth
(n)-(*));

242 *
d©a
;

243 
	`mem˝y
(&
d©a
,
nd©a
,(data));

244  
d©a
;

245 
	}
}

256 
øxNode
 *
	$øxAddChûd
(
øxNode
 *
n
, 
c
,ÑaxNodê**
chûd±r
,ÑaxNodê***
∑ª¡lök
) {

257 
	`as£π
(
n
->
iscom¥
 == 0);

259 
size_t
 
cuæí
 = 
	`øxNodeCuºítLígth
(
n
);

260 
n
->
size
++;

261 
size_t
 
√wÀn
 = 
	`øxNodeCuºítLígth
(
n
);

262 
n
->
size
--;

266 
øxNode
 *
chûd
 = 
	`øxNewNode
(0,0);

267 i‡(
chûd
 =
NULL
)  NULL;

270 
øxNode
 *
√wn
 = 
	`øx_ªÆloc
(
n
,
√wÀn
);

271 i‡(
√wn
 =
NULL
) {

272 
	`øx_‰ì
(
chûd
);

273  
NULL
;

275 
n
 = 
√wn
;

305 
pos
;

306 
pos
 = 0;Öo†< 
n
->
size
;Öos++) {

307 i‡(
n
->
d©a
[
pos
] > 
c
) ;

316 *
§c
, *
d°
;

317 i‡(
n
->
iskey
 && !n->
i¢uŒ
) {

318 
§c
 = ((*)
n
+
cuæí
-(*));

319 
d°
 = ((*)
n
+
√wÀn
-(*));

320 
	`memmove
(
d°
,
§c
,(*));

334 
size_t
 
shi·
 = 
√wÀn
 - 
cuæí
 - (*);

346 
§c
 = 
n
->
d©a
+n->
size
+

347 
	`øxPaddög
(
n
->
size
)+

348 (
øxNode
*)*
pos
;

349 
	`memmove
(
§c
+
shi·
+(
øxNode
*),§c,‘axNode*)*(
n
->
size
-
pos
));

360 i‡(
shi·
) {

361 
§c
 = (*Ë
	`øxNodeFú°ChûdPå
(
n
);

362 
	`memmove
(
§c
+
shi·
,§c,(
øxNode
*)*
pos
);

371 
§c
 = 
n
->
d©a
+
pos
;

372 
	`memmove
(
§c
+1,§c,
n
->
size
-
pos
);

379 
n
->
d©a
[
pos
] = 
c
;

380 
n
->
size
++;

381 
§c
 = (*Ë
	`øxNodeFú°ChûdPå
(
n
);

382 
øxNode
 **
chûdfõld
 = (øxNode**)(
§c
+‘axNode*)*
pos
);

383 
	`mem˝y
(
chûdfõld
,&
chûd
,(child));

384 *
chûd±r
 = 
chûd
;

385 *
∑ª¡lök
 = 
chûdfõld
;

386  
n
;

387 
	}
}

397 
øxNode
 *
	$øxCom¥essNode
(
øxNode
 *
n
, *
s
, 
size_t
 
Àn
,ÑaxNodê**
chûd
) {

398 
	`as£π
(
n
->
size
 =0 &&Ç->
iscom¥
 == 0);

399 *
d©a
 = 
NULL
;

400 
size_t
 
√wsize
;

402 
	`debugf
("Com¥es†node: %.*s\n", ()
Àn
,
s
);

405 *
chûd
 = 
	`øxNewNode
(0,0);

406 i‡(*
chûd
 =
NULL
)  NULL;

409 
√wsize
 = (
øxNode
)+
Àn
+
	`øxPaddög
(len)+(raxNode*);

410 i‡(
n
->
iskey
) {

411 
d©a
 = 
	`øxGëD©a
(
n
);

412 i‡(!
n
->
i¢uŒ
Ë
√wsize
 += (*);

414 
øxNode
 *
√wn
 = 
	`øx_ªÆloc
(
n
,
√wsize
);

415 i‡(
√wn
 =
NULL
) {

416 
	`øx_‰ì
(*
chûd
);

417  
NULL
;

419 
n
 = 
√wn
;

421 
n
->
iscom¥
 = 1;

422 
n
->
size
 = 
Àn
;

423 
	`mem˝y
(
n
->
d©a
,
s
,
Àn
);

424 i‡(
n
->
iskey
Ë
	`øxSëD©a
“,
d©a
);

425 
øxNode
 **
chûdfõld
 = 
	`øxNodeLa°ChûdPå
(
n
);

426 
	`mem˝y
(
chûdfõld
,
chûd
,(*child));

427  
n
;

428 
	}
}

459 
ölöe
 
size_t
 
	$øxLowWÆk
(
øx
 *øx, *
s
, 
size_t
 
Àn
, 
øxNode
 **
°›node
,ÑaxNodê***
∂ök
, *
•lôpos
, 
øxSèck
 *
ts
) {

460 
øxNode
 *
h
 = 
øx
->
hód
;

461 
øxNode
 **
∑ª¡lök
 = &
øx
->
hód
;

463 
size_t
 
i
 = 0;

464 
size_t
 
j
 = 0;

465 
h
->
size
 && 
i
 < 
Àn
) {

466 
	`debugnode
("Looku∞cuºíànode",
h
);

467 *
v
 = 
h
->
d©a
;

469 i‡(
h
->
iscom¥
) {

470 
j
 = 0; j < 
h
->
size
 && 
i
 < 
Àn
; j++, i++) {

471 i‡(
v
[
j
] !
s
[
i
]) ;

473 i‡(
j
 !
h
->
size
) ;

478 
j
 = 0; j < 
h
->
size
; j++) {

479 i‡(
v
[
j
] =
s
[
i
]) ;

481 i‡(
j
 =
h
->
size
) ;

482 
i
++;

485 i‡(
ts
Ë
	`øxSèckPush
—s,
h
);

486 
øxNode
 **
chûdªn
 = 
	`øxNodeFú°ChûdPå
(
h
);

487 i‡(
h
->
iscom¥
Ë
j
 = 0;

488 
	`mem˝y
(&
h
,
chûdªn
+
j
,(h));

489 
∑ª¡lök
 = 
chûdªn
+
j
;

490 
j
 = 0;

495 
	`debugnode
("Looku∞°›Çodêis",
h
);

496 i‡(
°›node
Ë*°›nodê
h
;

497 i‡(
∂ök
Ë*∂ök = 
∑ª¡lök
;

498 i‡(
•lôpos
 && 
h
->
iscom¥
Ë*•lôpo†
j
;

499  
i
;

500 
	}
}

509 
	$øxGíîicIn£π
(
øx
 *øx, *
s
, 
size_t
 
Àn
, *
d©a
, **
ﬁd
, 
ovîwrôe
) {

510 
size_t
 
i
;

511 
j
 = 0;

515 
øxNode
 *
h
, **
∑ª¡lök
;

517 
	`debugf
("### In£π %.*†wôh vÆuê%p\n", ()
Àn
, 
s
, 
d©a
);

518 
i
 = 
	`øxLowWÆk
(
øx
,
s
,
Àn
,&
h
,&
∑ª¡lök
,&
j
,
NULL
);

525 i‡(
i
 =
Àn
 && (!
h
->
iscom¥
 || 
j
 == 0 )) {

526 
	`debugf
("### Insert:ÇodeÑepresenting keyÉxists\n");

528 i‡(!
h
->
iskey
 || (h->
i¢uŒ
 && 
ovîwrôe
)) {

529 
h
 = 
	`øxRóŒocF‹D©a
(h,
d©a
);

530 i‡(
h
Ë
	`mem˝y
(
∑ª¡lök
,&h,(h));

532 i‡(
h
 =
NULL
) {

533 
î∫o
 = 
ENOMEM
;

538 i‡(
h
->
iskey
) {

539 i‡(
ﬁd
Ë*ﬁd = 
	`øxGëD©a
(
h
);

540 i‡(
ovîwrôe
Ë
	`øxSëD©a
(
h
,
d©a
);

541 
î∫o
 = 0;

547 
	`øxSëD©a
(
h
,
d©a
);

548 
øx
->
numñe
++;

677 i‡(
h
->
iscom¥
 && 
i
 !
Àn
) {

678 
	`debugf
("ALGO 1: Stoppedát compressedÇode %.*s (%p)\n",

679 
h
->
size
, h->
d©a
, (*)h);

680 
	`debugf
("Stû»tÿö£π: %.*s\n", ()(
Àn
-
i
), 
s
+i);

681 
	`debugf
("S∂ôtögáà%d: '%c'\n", 
j
, ((*)
h
->
d©a
)[j]);

682 
	`debugf
("Othî (keyËÀâî i†'%c'\n", 
s
[
i
]);

685 
øxNode
 **
chûdfõld
 = 
	`øxNodeLa°ChûdPå
(
h
);

686 
øxNode
 *
√xt
;

687 
	`mem˝y
(&
√xt
,
chûdfõld
,(next));

688 
	`debugf
("Nexài†%p\n", (*)
√xt
);

689 
	`debugf
("iskey %d\n", 
h
->
iskey
);

690 i‡(
h
->
iskey
) {

691 
	`debugf
("key vÆuêi†%p\n", 
	`øxGëD©a
(
h
));

695 
size_t
 
åimmedÀn
 = 
j
;

696 
size_t
 
po°fixÀn
 = 
h
->
size
 - 
j
 - 1;

697 
•lô_node_is_key
 = !
åimmedÀn
 && 
h
->
iskey
 && !h->
i¢uŒ
;

698 
size_t
 
nodesize
;

702 
øxNode
 *
•lônode
 = 
	`øxNewNode
(1, 
•lô_node_is_key
);

703 
øxNode
 *
åimmed
 = 
NULL
;

704 
øxNode
 *
po°fix
 = 
NULL
;

706 i‡(
åimmedÀn
) {

707 
nodesize
 = (
øxNode
)+
åimmedÀn
+
	`øxPaddög
(trimmedlen)+

708 (
øxNode
*);

709 i‡(
h
->
iskey
 && !h->
i¢uŒ
Ë
nodesize
 += (*);

710 
åimmed
 = 
	`øx_mÆloc
(
nodesize
);

713 i‡(
po°fixÀn
) {

714 
nodesize
 = (
øxNode
)+
po°fixÀn
+
	`øxPaddög
(postfixlen)+

715 (
øxNode
*);

716 
po°fix
 = 
	`øx_mÆloc
(
nodesize
);

720 i‡(
•lônode
 =
NULL
 ||

721 (
åimmedÀn
 && 
åimmed
 =
NULL
) ||

722 (
po°fixÀn
 && 
po°fix
 =
NULL
))

724 
	`øx_‰ì
(
•lônode
);

725 
	`øx_‰ì
(
åimmed
);

726 
	`øx_‰ì
(
po°fix
);

727 
î∫o
 = 
ENOMEM
;

730 
•lônode
->
d©a
[0] = 
h
->d©a[
j
];

732 i‡(
j
 == 0) {

734 i‡(
h
->
iskey
) {

735 *
nd©a
 = 
	`øxGëD©a
(
h
);

736 
	`øxSëD©a
(
•lônode
,
nd©a
);

738 
	`mem˝y
(
∑ª¡lök
,&
•lônode
,(splitnode));

741 
åimmed
->
size
 = 
j
;

742 
	`mem˝y
(
åimmed
->
d©a
,
h
->d©a,
j
);

743 
åimmed
->
iscom¥
 = 
j
 > 1 ? 1 : 0;

744 
åimmed
->
iskey
 = 
h
->iskey;

745 
åimmed
->
i¢uŒ
 = 
h
->isnull;

746 i‡(
h
->
iskey
 && !h->
i¢uŒ
) {

747 *
nd©a
 = 
	`øxGëD©a
(
h
);

748 
	`øxSëD©a
(
åimmed
,
nd©a
);

750 
øxNode
 **
˝
 = 
	`øxNodeLa°ChûdPå
(
åimmed
);

751 
	`mem˝y
(
˝
,&
•lônode
,(splitnode));

752 
	`mem˝y
(
∑ª¡lök
,&
åimmed
,(trimmed));

753 
∑ª¡lök
 = 
˝
;

754 
øx
->
numnodes
++;

759 i‡(
po°fixÀn
) {

761 
po°fix
->
iskey
 = 0;

762 
po°fix
->
i¢uŒ
 = 0;

763 
po°fix
->
size
 = 
po°fixÀn
;

764 
po°fix
->
iscom¥
 = 
po°fixÀn
 > 1;

765 
	`mem˝y
(
po°fix
->
d©a
,
h
->d©a+
j
+1,
po°fixÀn
);

766 
øxNode
 **
˝
 = 
	`øxNodeLa°ChûdPå
(
po°fix
);

767 
	`mem˝y
(
˝
,&
√xt
,(next));

768 
øx
->
numnodes
++;

771 
po°fix
 = 
√xt
;

775 
øxNode
 **
•lôchûd
 = 
	`øxNodeLa°ChûdPå
(
•lônode
);

776 
	`mem˝y
(
•lôchûd
,&
po°fix
,(postfix));

781 
	`øx_‰ì
(
h
);

782 
h
 = 
•lônode
;

783 } i‡(
h
->
iscom¥
 && 
i
 =
Àn
) {

785 
	`debugf
("ALGO 2: Stoppedát compressedÇode %.*s (%p) j = %d\n",

786 
h
->
size
, h->
d©a
, (*)h, 
j
);

789 
size_t
 
po°fixÀn
 = 
h
->
size
 - 
j
;

790 
size_t
 
nodesize
 = (
øxNode
)+
po°fixÀn
+
	`øxPaddög
(postfixlen)+

791 (
øxNode
*);

792 i‡(
d©a
 !
NULL
Ë
nodesize
 += (*);

793 
øxNode
 *
po°fix
 = 
	`øx_mÆloc
(
nodesize
);

795 
nodesize
 = (
øxNode
)+
j
+
	`øxPaddög
(j)+(raxNode*);

796 i‡(
h
->
iskey
 && !h->
i¢uŒ
Ë
nodesize
 += (*);

797 
øxNode
 *
åimmed
 = 
	`øx_mÆloc
(
nodesize
);

799 i‡(
po°fix
 =
NULL
 || 
åimmed
 == NULL) {

800 
	`øx_‰ì
(
po°fix
);

801 
	`øx_‰ì
(
åimmed
);

802 
î∫o
 = 
ENOMEM
;

807 
øxNode
 **
chûdfõld
 = 
	`øxNodeLa°ChûdPå
(
h
);

808 
øxNode
 *
√xt
;

809 
	`mem˝y
(&
√xt
,
chûdfõld
,(next));

812 
po°fix
->
size
 = 
po°fixÀn
;

813 
po°fix
->
iscom¥
 = 
po°fixÀn
 > 1;

814 
po°fix
->
iskey
 = 1;

815 
po°fix
->
i¢uŒ
 = 0;

816 
	`mem˝y
(
po°fix
->
d©a
,
h
->d©a+
j
,
po°fixÀn
);

817 
	`øxSëD©a
(
po°fix
,
d©a
);

818 
øxNode
 **
˝
 = 
	`øxNodeLa°ChûdPå
(
po°fix
);

819 
	`mem˝y
(
˝
,&
√xt
,(next));

820 
øx
->
numnodes
++;

823 
åimmed
->
size
 = 
j
;

824 
åimmed
->
iscom¥
 = 
j
 > 1;

825 
åimmed
->
iskey
 = 0;

826 
åimmed
->
i¢uŒ
 = 0;

827 
	`mem˝y
(
åimmed
->
d©a
,
h
->d©a,
j
);

828 
	`mem˝y
(
∑ª¡lök
,&
åimmed
,(trimmed));

829 i‡(
h
->
iskey
) {

830 *
aux
 = 
	`øxGëD©a
(
h
);

831 
	`øxSëD©a
(
åimmed
,
aux
);

836 
˝
 = 
	`øxNodeLa°ChûdPå
(
åimmed
);

837 
	`mem˝y
(
˝
,&
po°fix
,(postfix));

841 
øx
->
numñe
++;

842 
	`øx_‰ì
(
h
);

848 
i
 < 
Àn
) {

849 
øxNode
 *
chûd
;

854 i‡(
h
->
size
 =0 && 
Àn
-
i
 > 1) {

855 
	`debugf
("Inserting compressedÇode\n");

856 
size_t
 
com¥size
 = 
Àn
-
i
;

857 i‡(
com¥size
 > 
RAX_NODE_MAX_SIZE
)

858 
com¥size
 = 
RAX_NODE_MAX_SIZE
;

859 
øxNode
 *
√wh
 = 
	`øxCom¥essNode
(
h
,
s
+
i
,
com¥size
,&
chûd
);

860 i‡(
√wh
 =
NULL
Ë
oom
;

861 
h
 = 
√wh
;

862 
	`mem˝y
(
∑ª¡lök
,&
h
,(h));

863 
∑ª¡lök
 = 
	`øxNodeLa°ChûdPå
(
h
);

864 
i
 +
com¥size
;

866 
	`debugf
("InsertingÇormalÇode\n");

867 
øxNode
 **
√w_∑ª¡lök
;

868 
øxNode
 *
√wh
 = 
	`øxAddChûd
(
h
,
s
[
i
],&
chûd
,&
√w_∑ª¡lök
);

869 i‡(
√wh
 =
NULL
Ë
oom
;

870 
h
 = 
√wh
;

871 
	`mem˝y
(
∑ª¡lök
,&
h
,(h));

872 
∑ª¡lök
 = 
√w_∑ª¡lök
;

873 
i
++;

875 
øx
->
numnodes
++;

876 
h
 = 
chûd
;

878 
øxNode
 *
√wh
 = 
	`øxRóŒocF‹D©a
(
h
,
d©a
);

879 i‡(
√wh
 =
NULL
Ë
oom
;

880 
h
 = 
√wh
;

881 i‡(!
h
->
iskey
Ë
øx
->
numñe
++;

882 
	`øxSëD©a
(
h
,
d©a
);

883 
	`mem˝y
(
∑ª¡lök
,&
h
,(h));

886 
oom
:

892 i‡(
h
->
size
 == 0) {

893 
h
->
i¢uŒ
 = 1;

894 
h
->
iskey
 = 1;

895 
øx
->
numñe
++;

896 
	`as£π
(
	`øxRemove
(
øx
,
s
,
i
,
NULL
) != 0);

898 
î∫o
 = 
ENOMEM
;

900 
	}
}

904 
	$øxIn£π
(
øx
 *øx, *
s
, 
size_t
 
Àn
, *
d©a
, **
ﬁd
) {

905  
	`øxGíîicIn£π
(
øx
,
s
,
Àn
,
d©a
,
ﬁd
,1);

906 
	}
}

911 
	$øxTryIn£π
(
øx
 *øx, *
s
, 
size_t
 
Àn
, *
d©a
, **
ﬁd
) {

912  
	`øxGíîicIn£π
(
øx
,
s
,
Àn
,
d©a
,
ﬁd
,0);

913 
	}
}

918 *
	$øxFöd
(
øx
 *øx, *
s
, 
size_t
 
Àn
) {

919 
øxNode
 *
h
;

921 
	`debugf
("### Lookup: %.*s\n", ()
Àn
, 
s
);

922 
•lôpos
 = 0;

923 
size_t
 
i
 = 
	`øxLowWÆk
(
øx
,
s
,
Àn
,&
h
,
NULL
,&
•lôpos
,NULL);

924 i‡(
i
 !
Àn
 || (
h
->
iscom¥
 && 
•lôpos
 !0Ë|| !h->
iskey
)

925  
øxNŸFound
;

926  
	`øxGëD©a
(
h
);

927 
	}
}

934 
øxNode
 **
	$øxFödP¨ítLök
(
øxNode
 *
∑ª¡
,ÑaxNodê*
chûd
) {

935 
øxNode
 **
˝
 = 
	`øxNodeFú°ChûdPå
(
∑ª¡
);

936 
øxNode
 *
c
;

938 
	`mem˝y
(&
c
,
˝
,(c));

939 i‡(
c
 =
chûd
) ;

940 
˝
++;

942  
˝
;

943 
	}
}

949 
øxNode
 *
	$øxRemoveChûd
(
øxNode
 *
∑ª¡
,ÑaxNodê*
chûd
) {

950 
	`debugnode
("øxRemoveChûd bef‹e", 
∑ª¡
);

954 i‡(
∑ª¡
->
iscom¥
) {

955 *
d©a
 = 
NULL
;

956 i‡(
∑ª¡
->
iskey
Ë
d©a
 = 
	`øxGëD©a
(parent);

957 
∑ª¡
->
i¢uŒ
 = 0;

958 
∑ª¡
->
iscom¥
 = 0;

959 
∑ª¡
->
size
 = 0;

960 i‡(
∑ª¡
->
iskey
Ë
	`øxSëD©a
’¨ít,
d©a
);

961 
	`debugnode
("øxRemoveChûdá·î", 
∑ª¡
);

962  
∑ª¡
;

970 
øxNode
 **
˝
 = 
	`øxNodeFú°ChûdPå
(
∑ª¡
);

971 
øxNode
 **
c
 = 
˝
;

972 *
e
 = 
∑ª¡
->
d©a
;

977 
øxNode
 *
aux
;

978 
	`mem˝y
(&
aux
,
c
,(aux));

979 i‡(
aux
 =
chûd
) ;

980 
c
++;

981 
e
++;

986 
èûÀn
 = 
∑ª¡
->
size
 - (
e
 -Ö¨ít->
d©a
) - 1;

987 
	`debugf
("øxRemoveChûdÅaûÜí: %d\n", 
èûÀn
);

988 
	`memmove
(
e
,e+1,
èûÀn
);

996 
size_t
 
shi·
 = ((
∑ª¡
->
size
+4) % (*)) == 1 ? (*) : 0;

999 i‡(
shi·
)

1000 
	`memmove
(((*)
˝
)-
shi·
,˝,(
∑ª¡
->
size
-
èûÀn
-1)*(
øxNode
**));

1003 
size_t
 
vÆuñí
 = (
∑ª¡
->
iskey
 && !∑ª¡->
i¢uŒ
) ? (*) : 0;

1004 
	`memmove
(((*)
c
)-
shi·
,c+1,
èûÀn
*(
øxNode
**)+
vÆuñí
);

1007 
∑ª¡
->
size
--;

1011 
øxNode
 *
√wnode
 = 
	`øx_ªÆloc
(
∑ª¡
,
	`øxNodeCuºítLígth
(parent));

1012 i‡(
√wnode
) {

1013 
	`debugnode
("øxRemoveChûdá·î", 
√wnode
);

1017  
√wnode
 ?Çewnodê: 
∑ª¡
;

1018 
	}
}

1022 
	$øxRemove
(
øx
 *øx, *
s
, 
size_t
 
Àn
, **
ﬁd
) {

1023 
øxNode
 *
h
;

1024 
øxSèck
 
ts
;

1026 
	`debugf
("### Dñëe: %.*s\n", ()
Àn
, 
s
);

1027 
	`øxSèckInô
(&
ts
);

1028 
•lôpos
 = 0;

1029 
size_t
 
i
 = 
	`øxLowWÆk
(
øx
,
s
,
Àn
,&
h
,
NULL
,&
•lôpos
,&
ts
);

1030 i‡(
i
 !
Àn
 || (
h
->
iscom¥
 && 
•lôpos
 !0Ë|| !h->
iskey
) {

1031 
	`øxSèckFªe
(&
ts
);

1034 i‡(
ﬁd
Ë*ﬁd = 
	`øxGëD©a
(
h
);

1035 
h
->
iskey
 = 0;

1036 
øx
->
numñe
--;

1044 
åycom¥ess
 = 0;

1047 i‡(
h
->
size
 == 0) {

1048 
	`debugf
("Key deleted inÇode without children. CleanupÇeeded.\n");

1049 
øxNode
 *
chûd
 = 
NULL
;

1050 
h
 !
øx
->
hód
) {

1051 
chûd
 = 
h
;

1052 
	`debugf
("Fªeög chûd %∞[%.*s] key:%d\n", (*)
chûd
,

1053 ()
chûd
->
size
, (*)chûd->
d©a
, chûd->
iskey
);

1054 
	`øx_‰ì
(
chûd
);

1055 
øx
->
numnodes
--;

1056 
h
 = 
	`øxSèckP›
(&
ts
);

1059 i‡(
h
->
iskey
 || (!h->
iscom¥
 && h->
size
 != 1)) ;

1061 i‡(
chûd
) {

1062 
	`debugf
("Unlinking child %p fromÖarent %p\n",

1063 (*)
chûd
, (*)
h
);

1064 
øxNode
 *
√w
 = 
	`øxRemoveChûd
(
h
,
chûd
);

1065 i‡(
√w
 !
h
) {

1066 
øxNode
 *
∑ª¡
 = 
	`øxSèckPìk
(&
ts
);

1067 
øxNode
 **
∑ª¡lök
;

1068 i‡(
∑ª¡
 =
NULL
) {

1069 
∑ª¡lök
 = &
øx
->
hód
;

1071 
∑ª¡lök
 = 
	`øxFödP¨ítLök
(
∑ª¡
,
h
);

1073 
	`mem˝y
(
∑ª¡lök
,&
√w
,(new));

1078 i‡(
√w
->
size
 =1 &&Çew->
iskey
 == 0) {

1079 
åycom¥ess
 = 1;

1080 
h
 = 
√w
;

1083 } i‡(
h
->
size
 == 1) {

1086 
åycom¥ess
 = 1;

1091 i‡(
åycom¥ess
 && 
ts
.
oom
)Årycompress = 0;

1136 i‡(
åycom¥ess
) {

1137 
	`debugf
("A·îÑemovög %.*s:\n", ()
Àn
, 
s
);

1138 
	`debugnode
("Com¥essi⁄ may bê√eded",
h
);

1139 
	`debugf
("Seek startÇode\n");

1144 
øxNode
 *
∑ª¡
;

1146 
∑ª¡
 = 
	`øxSèckP›
(&
ts
);

1147 i‡(!
∑ª¡
 ||Ö¨ít->
iskey
 ||

1148 (!
∑ª¡
->
iscom¥
 &&Ö¨ít->
size
 != 1)) ;

1149 
h
 = 
∑ª¡
;

1150 
	`debugnode
("Goög u∞to",
h
);

1152 
øxNode
 *
°¨t
 = 
h
;

1155 
size_t
 
com¥size
 = 
h
->
size
;

1156 
nodes
 = 1;

1157 
h
->
size
 != 0) {

1158 
øxNode
 **
˝
 = 
	`øxNodeLa°ChûdPå
(
h
);

1159 
	`mem˝y
(&
h
,
˝
,(h));

1160 i‡(
h
->
iskey
 || (!h->
iscom¥
 && h->
size
 != 1)) ;

1163 i‡(
com¥size
 + 
h
->
size
 > 
RAX_NODE_MAX_SIZE
) ;

1164 
nodes
++;

1165 
com¥size
 +
h
->
size
;

1167 i‡(
nodes
 > 1) {

1169 
size_t
 
nodesize
 =

1170 (
øxNode
)+
com¥size
+
	`øxPaddög
(comprsize)+(raxNode*);

1171 
øxNode
 *
√w
 = 
	`øx_mÆloc
(
nodesize
);

1174 i‡(
√w
 =
NULL
) {

1175 
	`øxSèckFªe
(&
ts
);

1178 
√w
->
iskey
 = 0;

1179 
√w
->
i¢uŒ
 = 0;

1180 
√w
->
iscom¥
 = 1;

1181 
√w
->
size
 = 
com¥size
;

1182 
øx
->
numnodes
++;

1187 
com¥size
 = 0;

1188 
h
 = 
°¨t
;

1189 
h
->
size
 != 0) {

1190 
	`mem˝y
(
√w
->
d©a
+
com¥size
,
h
->d©a,h->
size
);

1191 
com¥size
 +
h
->
size
;

1192 
øxNode
 **
˝
 = 
	`øxNodeLa°ChûdPå
(
h
);

1193 
øxNode
 *
to‰ì
 = 
h
;

1194 
	`mem˝y
(&
h
,
˝
,(h));

1195 
	`øx_‰ì
(
to‰ì
); 
øx
->
numnodes
--;

1196 i‡(
h
->
iskey
 || (!h->
iscom¥
 && h->
size
 != 1)) ;

1198 
	`debugnode
("NewÇode",
√w
);

1202 
øxNode
 **
˝
 = 
	`øxNodeLa°ChûdPå
(
√w
);

1203 
	`mem˝y
(
˝
,&
h
,(h));

1206 i‡(
∑ª¡
) {

1207 
øxNode
 **
∑ª¡lök
 = 
	`øxFödP¨ítLök
(
∑ª¡
,
°¨t
);

1208 
	`mem˝y
(
∑ª¡lök
,&
√w
,(new));

1210 
øx
->
hód
 = 
√w
;

1213 
	`debugf
("Compressed %dÇodes, %dÅotal bytes\n",

1214 
nodes
, ()
com¥size
);

1217 
	`øxSèckFªe
(&
ts
);

1219 
	}
}

1223 
	$øxRecursiveFªe
(
øx
 *øx, 
øxNode
 *
n
, (*
‰ì_ˇŒback
)(*)) {

1224 
	`debugnode
("‰ìÅøvîsög",
n
);

1225 
numchûdªn
 = 
n
->
iscom¥
 ? 1 :Ç->
size
;

1226 
øxNode
 **
˝
 = 
	`øxNodeLa°ChûdPå
(
n
);

1227 
numchûdªn
--) {

1228 
øxNode
 *
chûd
;

1229 
	`mem˝y
(&
chûd
,
˝
,(child));

1230 
	`øxRecursiveFªe
(
øx
,
chûd
,
‰ì_ˇŒback
);

1231 
˝
--;

1233 
	`debugnode
("‰ì dïth-fú°",
n
);

1234 i‡(
‰ì_ˇŒback
 && 
n
->
iskey
 && !n->
i¢uŒ
)

1235 
	`‰ì_ˇŒback
(
	`øxGëD©a
(
n
));

1236 
	`øx_‰ì
(
n
);

1237 
øx
->
numnodes
--;

1238 
	}
}

1242 
	$øxFªeWôhCÆlback
(
øx
 *øx, (*
‰ì_ˇŒback
)(*)) {

1243 
	`øxRecursiveFªe
(
øx
,øx->
hód
,
‰ì_ˇŒback
);

1244 
	`as£π
(
øx
->
numnodes
 == 0);

1245 
	`øx_‰ì
(
øx
);

1246 
	}
}

1249 
	$øxFªe
(
øx
 *rax) {

1250 
	`øxFªeWôhCÆlback
(
øx
,
NULL
);

1251 
	}
}

1258 
	$øxSèπ
(
øxIãøt‹
 *
ô
, 
øx
 *
π
) {

1259 
ô
->
Êags
 = 
RAX_ITER_EOF
;

1260 
ô
->
π
 =Ñt;

1261 
ô
->
key_Àn
 = 0;

1262 
ô
->
key
 = it->
key_°©ic_°rög
;

1263 
ô
->
key_max
 = 
RAX_ITER_STATIC_LEN
;

1264 
ô
->
d©a
 = 
NULL
;

1265 
ô
->
node_cb
 = 
NULL
;

1266 
	`øxSèckInô
(&
ô
->
°ack
);

1267 
	}
}

1272 
	$øxIãøt‹AddCh¨s
(
øxIãøt‹
 *
ô
, *
s
, 
size_t
 
Àn
) {

1273 i‡(
ô
->
key_max
 < it->
key_Àn
+
Àn
) {

1274 *
ﬁd
 = (
ô
->
key
 =ô->
key_°©ic_°rög
Ë? 
NULL
 :

1275 
ô
->
key
;

1276 
size_t
 
√w_max
 = (
ô
->
key_Àn
+
Àn
)*2;

1277 
ô
->
key
 = 
	`øx_ªÆloc
(
ﬁd
,
√w_max
);

1278 i‡(
ô
->
key
 =
NULL
) {

1279 
ô
->
key
 = (!
ﬁd
Ë? it->
key_°©ic_°rög
 : old;

1280 
î∫o
 = 
ENOMEM
;

1283 i‡(
ﬁd
 =
NULL
Ë
	`mem˝y
(
ô
->
key
,ô->
key_°©ic_°rög
,ô->
key_Àn
);

1284 
ô
->
key_max
 = 
√w_max
;

1288 
	`memmove
(
ô
->
key
+ô->
key_Àn
,
s
,
Àn
);

1289 
ô
->
key_Àn
 +
Àn
;

1291 
	}
}

1295 
	$øxIãøt‹DñCh¨s
(
øxIãøt‹
 *
ô
, 
size_t
 
cou¡
) {

1296 
ô
->
key_Àn
 -
cou¡
;

1297 
	}
}

1313 
	$øxIãøt‹NextSãp
(
øxIãøt‹
 *
ô
, 
noup
) {

1314 i‡(
ô
->
Êags
 & 
RAX_ITER_EOF
) {

1316 } i‡(
ô
->
Êags
 & 
RAX_ITER_JUST_SEEKED
) {

1317 
ô
->
Êags
 &~
RAX_ITER_JUST_SEEKED
;

1323 
size_t
 
‹ig_key_Àn
 = 
ô
->
key_Àn
;

1324 
size_t
 
‹ig_°ack_ôems
 = 
ô
->
°ack
.
ôems
;

1325 
øxNode
 *
‹ig_node
 = 
ô
->
node
;

1328 
chûdªn
 = 
ô
->
node
->
iscom¥
 ? 1 : it->node->
size
;

1329 i‡(!
noup
 && 
chûdªn
) {

1330 
	`debugf
("GO DEEPER\n");

1334 i‡(!
	`øxSèckPush
(&
ô
->
°ack
,ô->
node
))  0;

1335 
øxNode
 **
˝
 = 
	`øxNodeFú°ChûdPå
(
ô
->
node
);

1336 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,ô->
node
->
d©a
,

1337 
ô
->
node
->
iscom¥
 ? it->node->
size
 : 1))  0;

1338 
	`mem˝y
(&
ô
->
node
,
˝
,(it->node));

1341 i‡(
ô
->
node_cb
 && it->
	`node_cb
(&ô->
node
))

1342 
	`mem˝y
(
˝
,&
ô
->
node
,(it->node));

1346 i‡(
ô
->
node
->
iskey
) {

1347 
ô
->
d©a
 = 
	`øxGëD©a
(ô->
node
);

1356 
ﬁd_noup
 = 
noup
;

1359 i‡(!
noup
 && 
ô
->
node
 =ô->
π
->
hód
) {

1360 
ô
->
Êags
 |
RAX_ITER_EOF
;

1361 
ô
->
°ack
.
ôems
 = 
‹ig_°ack_ôems
;

1362 
ô
->
key_Àn
 = 
‹ig_key_Àn
;

1363 
ô
->
node
 = 
‹ig_node
;

1368 
¥evchûd
 = 
ô
->
key
[ô->
key_Àn
-1];

1369 i‡(!
noup
) {

1370 
ô
->
node
 = 
	`øxSèckP›
(&ô->
°ack
);

1372 
noup
 = 0;

1376 
todñ
 = 
ô
->
node
->
iscom¥
 ? it->node->
size
 : 1;

1377 
	`øxIãøt‹DñCh¨s
(
ô
,
todñ
);

1381 i‡(!
ô
->
node
->
iscom¥
 && it->node->
size
 > (
ﬁd_noup
 ? 0 : 1)) {

1382 
øxNode
 **
˝
 = 
	`øxNodeFú°ChûdPå
(
ô
->
node
);

1383 
i
 = 0;

1384 
i
 < 
ô
->
node
->
size
) {

1385 
	`debugf
("SCAN NEXT %c\n", 
ô
->
node
->
d©a
[
i
]);

1386 i‡(
ô
->
node
->
d©a
[
i
] > 
¥evchûd
) ;

1387 
i
++;

1388 
˝
++;

1390 i‡(
i
 !
ô
->
node
->
size
) {

1391 
	`debugf
("SCAN foundáÇewÇode\n");

1392 
	`øxIãøt‹AddCh¨s
(
ô
,ô->
node
->
d©a
+
i
,1);

1393 i‡(!
	`øxSèckPush
(&
ô
->
°ack
,ô->
node
))  0;

1394 
	`mem˝y
(&
ô
->
node
,
˝
,(it->node));

1397 i‡(
ô
->
node_cb
 && it->
	`node_cb
(&ô->
node
))

1398 
	`mem˝y
(
˝
,&
ô
->
node
,(it->node));

1399 i‡(
ô
->
node
->
iskey
) {

1400 
ô
->
d©a
 = 
	`øxGëD©a
(ô->
node
);

1409 
	}
}

1414 
	$øxSìkGª©e°
(
øxIãøt‹
 *
ô
) {

1415 
ô
->
node
->
size
) {

1416 i‡(
ô
->
node
->
iscom¥
) {

1417 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,ô->
node
->
d©a
,

1418 
ô
->
node
->
size
))  0;

1420 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,ô->
node
->
d©a
+ô->node->
size
-1,1))

1423 
øxNode
 **
˝
 = 
	`øxNodeLa°ChûdPå
(
ô
->
node
);

1424 i‡(!
	`øxSèckPush
(&
ô
->
°ack
,ô->
node
))  0;

1425 
	`mem˝y
(&
ô
->
node
,
˝
,(it->node));

1428 
	}
}

1433 
	$øxIãøt‹PªvSãp
(
øxIãøt‹
 *
ô
, 
noup
) {

1434 i‡(
ô
->
Êags
 & 
RAX_ITER_EOF
) {

1436 } i‡(
ô
->
Êags
 & 
RAX_ITER_JUST_SEEKED
) {

1437 
ô
->
Êags
 &~
RAX_ITER_JUST_SEEKED
;

1443 
size_t
 
‹ig_key_Àn
 = 
ô
->
key_Àn
;

1444 
size_t
 
‹ig_°ack_ôems
 = 
ô
->
°ack
.
ôems
;

1445 
øxNode
 *
‹ig_node
 = 
ô
->
node
;

1448 
ﬁd_noup
 = 
noup
;

1451 i‡(!
noup
 && 
ô
->
node
 =ô->
π
->
hód
) {

1452 
ô
->
Êags
 |
RAX_ITER_EOF
;

1453 
ô
->
°ack
.
ôems
 = 
‹ig_°ack_ôems
;

1454 
ô
->
key_Àn
 = 
‹ig_key_Àn
;

1455 
ô
->
node
 = 
‹ig_node
;

1459 
¥evchûd
 = 
ô
->
key
[ô->
key_Àn
-1];

1460 i‡(!
noup
) {

1461 
ô
->
node
 = 
	`øxSèckP›
(&ô->
°ack
);

1463 
noup
 = 0;

1468 
todñ
 = 
ô
->
node
->
iscom¥
 ? it->node->
size
 : 1;

1469 
	`øxIãøt‹DñCh¨s
(
ô
,
todñ
);

1473 i‡(!
ô
->
node
->
iscom¥
 && it->node->
size
 > (
ﬁd_noup
 ? 0 : 1)) {

1474 
øxNode
 **
˝
 = 
	`øxNodeLa°ChûdPå
(
ô
->
node
);

1475 
i
 = 
ô
->
node
->
size
-1;

1476 
i
 >= 0) {

1477 
	`debugf
("SCAN PREV %c\n", 
ô
->
node
->
d©a
[
i
]);

1478 i‡(
ô
->
node
->
d©a
[
i
] < 
¥evchûd
) ;

1479 
i
--;

1480 
˝
--;

1485 i‡(
i
 != -1) {

1486 
	`debugf
("SCAN foundáÇewÇode\n");

1488 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,ô->
node
->
d©a
+
i
,1))  0;

1489 i‡(!
	`øxSèckPush
(&
ô
->
°ack
,ô->
node
))  0;

1490 
	`mem˝y
(&
ô
->
node
,
˝
,(it->node));

1492 i‡(!
	`øxSìkGª©e°
(
ô
))  0;

1499 i‡(
ô
->
node
->
iskey
) {

1500 
ô
->
d©a
 = 
	`øxGëD©a
(ô->
node
);

1504 
	}
}

1510 
	$øxSìk
(
øxIãøt‹
 *
ô
, c⁄° *
›
, *
ñe
, 
size_t
 
Àn
) {

1511 
eq
 = 0, 
…
 = 0, 
gt
 = 0, 
fú°
 = 0, 
œ°
 = 0;

1513 
ô
->
°ack
.
ôems
 = 0;

1514 
ô
->
Êags
 |
RAX_ITER_JUST_SEEKED
;

1515 
ô
->
Êags
 &~
RAX_ITER_EOF
;

1516 
ô
->
key_Àn
 = 0;

1517 
ô
->
node
 = 
NULL
;

1520 i‡(
›
[0] == '>') {

1521 
gt
 = 1;

1522 i‡(
›
[1] ='='Ë
eq
 = 1;

1523 } i‡(
›
[0] == '<') {

1524 
…
 = 1;

1525 i‡(
›
[1] ='='Ë
eq
 = 1;

1526 } i‡(
›
[0] == '=') {

1527 
eq
 = 1;

1528 } i‡(
›
[0] == '^') {

1529 
fú°
 = 1;

1530 } i‡(
›
[0] == '$') {

1531 
œ°
 = 1;

1533 
î∫o
 = 0;

1539 i‡(
ô
->
π
->
numñe
 == 0) {

1540 
ô
->
Êags
 |
RAX_ITER_EOF
;

1544 i‡(
fú°
) {

1547  
	`øxSìk
(
ô
,">=",
NULL
,0);

1550 i‡(
œ°
) {

1553 
ô
->
node
 = it->
π
->
hód
;

1554 i‡(!
	`øxSìkGª©e°
(
ô
))  0;

1555 
	`as£π
(
ô
->
node
->
iskey
);

1556 
ô
->
d©a
 = 
	`øxGëD©a
(ô->
node
);

1563 
•lôpos
 = 0;

1564 
size_t
 
i
 = 
	`øxLowWÆk
(
ô
->
π
,
ñe
,
Àn
,&ô->
node
,
NULL
,&
•lôpos
,&ô->
°ack
);

1567 i‡(
ô
->
°ack
.
oom
)  0;

1569 i‡(
eq
 && 
i
 =
Àn
 && (!
ô
->
node
->
iscom¥
 || 
•lôpos
 == 0) &&

1570 
ô
->
node
->
iskey
)

1574 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,
ñe
,
Àn
))  0;

1575 
ô
->
d©a
 = 
	`øxGëD©a
(ô->
node
);

1576 } i‡(
…
 || 
gt
) {

1582 i‡(!
	`øxSèckPush
(&
ô
->
°ack
,ô->
node
))  0;

1583 
size_t
 
j
 = 1; j < 
ô
->
°ack
.
ôems
; j++) {

1584 
øxNode
 *
∑ª¡
 = 
ô
->
°ack
.°ack[
j
-1];

1585 
øxNode
 *
chûd
 = 
ô
->
°ack
.°ack[
j
];

1586 i‡(
∑ª¡
->
iscom¥
) {

1587 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,
∑ª¡
->
d©a
,∑ª¡->
size
))

1590 
øxNode
 **
˝
 = 
	`øxNodeFú°ChûdPå
(
∑ª¡
);

1591 *
p
 = 
∑ª¡
->
d©a
;

1593 
øxNode
 *
aux
;

1594 
	`mem˝y
(&
aux
,
˝
,(aux));

1595 i‡(
aux
 =
chûd
) ;

1596 
˝
++;

1597 
p
++;

1599 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,
p
,1))  0;

1602 
	`øxSèckP›
(&
ô
->
°ack
);

1606 
	`debugf
("After initial seek: i=%dÜen=%d key=%.*s\n",

1607 ()
i
, ()
Àn
, ()
ô
->
key_Àn
, it->
key
);

1608 i‡(
i
 !
Àn
 && !
ô
->
node
->
iscom¥
) {

1614 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,
ñe
+
i
,1))  0;

1615 
	`debugf
("SeekÇormalÇode on mismatch: %.*s\n",

1616 ()
ô
->
key_Àn
, (*)ô->
key
);

1618 
ô
->
Êags
 &~
RAX_ITER_JUST_SEEKED
;

1619 i‡(
…
 && !
	`øxIãøt‹PªvSãp
(
ô
,1))  0;

1620 i‡(
gt
 && !
	`øxIãøt‹NextSãp
(
ô
,1))  0;

1621 
ô
->
Êags
 |
RAX_ITER_JUST_SEEKED
;

1622 } i‡(
i
 !
Àn
 && 
ô
->
node
->
iscom¥
) {

1623 
	`debugf
("Compressed mismatch: %.*s\n",

1624 ()
ô
->
key_Àn
, (*)ô->
key
);

1626 
nodech¨
 = 
ô
->
node
->
d©a
[
•lôpos
];

1627 
keych¨
 = 
ñe
[
i
];

1628 
ô
->
Êags
 &~
RAX_ITER_JUST_SEEKED
;

1629 i‡(
gt
) {

1633 i‡(
nodech¨
 > 
keych¨
) {

1634 i‡(!
	`øxIãøt‹NextSãp
(
ô
,0))  0;

1636 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,ô->
node
->
d©a
,ô->node->
size
))

1638 i‡(!
	`øxIãøt‹NextSãp
(
ô
,1))  0;

1641 i‡(
…
) {

1646 i‡(
nodech¨
 < 
keych¨
) {

1647 i‡(!
	`øxSìkGª©e°
(
ô
))  0;

1648 
ô
->
d©a
 = 
	`øxGëD©a
(ô->
node
);

1650 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,ô->
node
->
d©a
,ô->node->
size
))

1652 i‡(!
	`øxIãøt‹PªvSãp
(
ô
,1))  0;

1655 
ô
->
Êags
 |
RAX_ITER_JUST_SEEKED
;

1657 
	`debugf
("No mismatch: %.*s\n",

1658 ()
ô
->
key_Àn
, (*)ô->
key
);

1664 
ô
->
Êags
 &~
RAX_ITER_JUST_SEEKED
;

1665 i‡(
ô
->
node
->
iscom¥
 && it->node->
iskey
 && 
•lôpos
 && 
…
) {

1678 
ô
->
d©a
 = 
	`øxGëD©a
(ô->
node
);

1680 i‡(
gt
 && !
	`øxIãøt‹NextSãp
(
ô
,0))  0;

1681 i‡(
…
 && !
	`øxIãøt‹PªvSãp
(
ô
,0))  0;

1683 
ô
->
Êags
 |
RAX_ITER_JUST_SEEKED
;

1687 
ô
->
Êags
 |
RAX_ITER_EOF
;

1691 
	}
}

1696 
	$øxNext
(
øxIãøt‹
 *
ô
) {

1697 i‡(!
	`øxIãøt‹NextSãp
(
ô
,0)) {

1698 
î∫o
 = 
ENOMEM
;

1701 i‡(
ô
->
Êags
 & 
RAX_ITER_EOF
) {

1702 
î∫o
 = 0;

1706 
	}
}

1711 
	$øxPªv
(
øxIãøt‹
 *
ô
) {

1712 i‡(!
	`øxIãøt‹PªvSãp
(
ô
,0)) {

1713 
î∫o
 = 
ENOMEM
;

1716 i‡(
ô
->
Êags
 & 
RAX_ITER_EOF
) {

1717 
î∫o
 = 0;

1721 
	}
}

1735 
	$øxR™domWÆk
(
øxIãøt‹
 *
ô
, 
size_t
 
°ïs
) {

1736 i‡(
ô
->
π
->
numñe
 == 0) {

1737 
ô
->
Êags
 |
RAX_ITER_EOF
;

1741 i‡(
°ïs
 == 0) {

1742 
size_t
 
Êe
 = 1+
	`Êo‹
(
	`log
(
ô
->
π
->
numñe
));

1743 
Êe
 *= 2;

1744 
°ïs
 = 1 + 
	`ønd
(Ë% 
Êe
;

1747 
øxNode
 *
n
 = 
ô
->
node
;

1748 
°ïs
 > 0 || !
n
->
iskey
) {

1749 
numchûdªn
 = 
n
->
iscom¥
 ? 1 :Ç->
size
;

1750 
r
 = 
	`ønd
(Ë% (
numchûdªn
+(
n
 !
ô
->
π
->
hód
));

1752 i‡(
r
 =
numchûdªn
) {

1754 
n
 = 
	`øxSèckP›
(&
ô
->
°ack
);

1755 
todñ
 = 
n
->
iscom¥
 ?Ç->
size
 : 1;

1756 
	`øxIãøt‹DñCh¨s
(
ô
,
todñ
);

1759 i‡(
n
->
iscom¥
) {

1760 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,
n
->
d©a
,n->
size
))  0;

1762 i‡(!
	`øxIãøt‹AddCh¨s
(
ô
,
n
->
d©a
+
r
,1))  0;

1764 
øxNode
 **
˝
 = 
	`øxNodeFú°ChûdPå
(
n
)+
r
;

1765 i‡(!
	`øxSèckPush
(&
ô
->
°ack
,
n
))  0;

1766 
	`mem˝y
(&
n
,
˝
,(n));

1768 i‡(
n
->
iskey
Ë
°ïs
--;

1770 
ô
->
node
 = 
n
;

1771 
ô
->
d©a
 = 
	`øxGëD©a
(ô->
node
);

1773 
	}
}

1778 
	$øxCom∑ª
(
øxIãøt‹
 *
ôî
, c⁄° *
›
, *
key
, 
size_t
 
key_Àn
) {

1779 
eq
 = 0, 
…
 = 0, 
gt
 = 0;

1781 i‡(
›
[0] ='=' || op[1] ='='Ë
eq
 = 1;

1782 i‡(
›
[0] ='>'Ë
gt
 = 1;

1783 i‡(
›
[0] ='<'Ë
…
 = 1;

1784 i‡(
›
[1] != '=')  0;

1786 
size_t
 
möÀn
 = 
key_Àn
 < 
ôî
->key_len ? key_len : iter->key_len;

1787 
cmp
 = 
	`memcmp
(
ôî
->
key
,key,
möÀn
);

1790 i‡(
…
 =0 && 
gt
 =0Ë 
cmp
 =0 && 
key_Àn
 =
ôî
->key_len;

1793 i‡(
cmp
 == 0) {

1795 i‡(
eq
 && 
key_Àn
 =
ôî
->key_len)  1;

1796 i‡(
…
Ë 
ôî
->
key_Àn
 < key_len;

1797 i‡(
gt
Ë 
ôî
->
key_Àn
 > key_len;

1799 } i‡(
cmp
 > 0) {

1800  
gt
 ? 1 : 0;

1802  
…
 ? 1 : 0;

1804 
	}
}

1807 
	$øxSt›
(
øxIãøt‹
 *
ô
) {

1808 i‡(
ô
->
key
 !ô->
key_°©ic_°rög
Ë
	`øx_‰ì
(it->key);

1809 
	`øxSèckFªe
(&
ô
->
°ack
);

1810 
	}
}

1816 
	$øxEOF
(
øxIãøt‹
 *
ô
) {

1817  
ô
->
Êags
 & 
RAX_ITER_EOF
;

1818 
	}
}

1821 
uöt64_t
 
	$øxSize
(
øx
 *rax) {

1822  
øx
->
numñe
;

1823 
	}
}

1853 
	$øxRecursiveShow
(
Àvñ
, 
Õad
, 
øxNode
 *
n
) {

1854 
s
 = 
n
->
iscom¥
 ? '"' : '[';

1855 
e
 = 
n
->
iscom¥
 ? '"' : ']';

1857 
numch¨s
 = 
	`¥ötf
("%c%.*s%c", 
s
, 
n
->
size
,Ç->
d©a
, 
e
);

1858 i‡(
n
->
iskey
) {

1859 
numch¨s
 +
	`¥ötf
("=%p",
	`øxGëD©a
(
n
));

1862 
numchûdªn
 = 
n
->
iscom¥
 ? 1 :Ç->
size
;

1865 i‡(
Àvñ
) {

1866 
Õad
 +(
numchûdªn
 > 1) ? 7 : 4;

1867 i‡(
numchûdªn
 =1Ë
Õad
 +
numch¨s
;

1869 
øxNode
 **
˝
 = 
	`øxNodeFú°ChûdPå
(
n
);

1870 
i
 = 0; i < 
numchûdªn
; i++) {

1871 *
bønch
 = " `-(%c) ";

1872 i‡(
numchûdªn
 > 1) {

1873 
	`¥ötf
("\n");

1874 
j
 = 0; j < 
Õad
; j++Ë
	`putch¨
(' ');

1875 
	`¥ötf
(
bønch
,
n
->
d©a
[
i
]);

1877 
	`¥ötf
(" -> ");

1879 
øxNode
 *
chûd
;

1880 
	`mem˝y
(&
chûd
,
˝
,(child));

1881 
	`øxRecursiveShow
(
Àvñ
+1,
Õad
,
chûd
);

1882 
˝
++;

1884 
	}
}

1887 
	$øxShow
(
øx
 *rax) {

1888 
	`øxRecursiveShow
(0,0,
øx
->
hód
);

1889 
	`putch¨
('\n');

1890 
	}
}

1893 
	$øxDebugShowNode
(c⁄° *
msg
, 
øxNode
 *
n
) {

1894 i‡(
øxDebugMsg
 == 0) ;

1895 
	`¥ötf
("%s: %p [%.*s] key:%d size:%d children:",

1896 
msg
, (*)
n
, (Í->
size
, (*Í->
d©a
,Ç->
iskey
,Ç->size);

1897 
num˛d
 = 
n
->
iscom¥
 ? 1 :Ç->
size
;

1898 
øxNode
 **
˛d±r
 = 
	`øxNodeLa°ChûdPå
(
n
Ë- (
num˛d
-1);

1899 
num˛d
--) {

1900 
øxNode
 *
chûd
;

1901 
	`mem˝y
(&
chûd
,
˛d±r
,(child));

1902 
˛d±r
++;

1903 
	`¥ötf
("%∞", (*)
chûd
);

1905 
	`¥ötf
("\n");

1906 
	`fÊush
(
°dout
);

1907 
	}
}

1926 
	$øxTouch
(
øxNode
 *
n
) {

1927 
	`debugf
("Touchög %p\n", (*)
n
);

1928 
sum
 = 0;

1929 i‡(
n
->
iskey
) {

1930 
sum
 +()
	`øxGëD©a
(
n
);

1933 
numchûdªn
 = 
n
->
iscom¥
 ? 1 :Ç->
size
;

1934 
øxNode
 **
˝
 = 
	`øxNodeFú°ChûdPå
(
n
);

1935 
cou¡
 = 0;

1936 
i
 = 0; i < 
numchûdªn
; i++) {

1937 i‡(
numchûdªn
 > 1) {

1938 
sum
 +()
n
->
d©a
[
i
];

1940 
øxNode
 *
chûd
;

1941 
	`mem˝y
(&
chûd
,
˝
,(child));

1942 i‡(
chûd
 =(*)0x65d1760Ë
cou¡
++;

1943 i‡(
cou¡
 > 1Ë
	`exô
(1);

1944 
sum
 +
	`øxTouch
(
chûd
);

1945 
˝
++;

1947  
sum
;

1948 
	}
}

	@rax.h

31 #i‚de‡
RAX_H


32 
	#RAX_H


	)

34 
	~<°döt.h
>

97 
	#RAX_NODE_MAX_SIZE
 ((1<<29)-1)

	)

98 
	søxNode
 {

99 
uöt32_t
 
	miskey
:1;

100 
uöt32_t
 
	mi¢uŒ
:1;

101 
uöt32_t
 
	miscom¥
:1;

102 
uöt32_t
 
	msize
:29;

130 
	md©a
[];

131 } 
	tøxNode
;

133 
	søx
 {

134 
øxNode
 *
	mhód
;

135 
uöt64_t
 
	mnumñe
;

136 
uöt64_t
 
	mnumnodes
;

137 } 
	tøx
;

142 
	#RAX_STACK_STATIC_ITEMS
 32

	)

143 
	søxSèck
 {

144 **
	m°ack
;

145 
size_t
 
	môems
, 
	mmaxôems
;

148 *
	m°©ic_ôems
[
RAX_STACK_STATIC_ITEMS
];

149 
	moom
;

150 } 
	tøxSèck
;

165 (*
	tøxNodeCÆlback
)(
	tøxNode
 **
	tnodîef
);

168 
	#RAX_ITER_STATIC_LEN
 128

	)

169 
	#RAX_ITER_JUST_SEEKED
 (1<<0Ë

	)

172 
	#RAX_ITER_EOF
 (1<<1Ë

	)

173 
	#RAX_ITER_SAFE
 (1<<2Ë

	)

175 
	søxIãøt‹
 {

176 
Êags
;

177 
øx
 *
π
;

178 *
key
;

179 *
d©a
;

180 
size_t
 
key_Àn
;

181 
size_t
 
key_max
;

182 
key_°©ic_°rög
[
RAX_ITER_STATIC_LEN
];

183 
øxNode
 *
node
;

184 
øxSèck
 
°ack
;

185 
øxNodeCÆlback
 
node_cb
;

186 } 
	tøxIãøt‹
;

189 *
øxNŸFound
;

192 
øx
 *
	`øxNew
();

193 
	`øxIn£π
(
øx
 *øx, *
s
, 
size_t
 
Àn
, *
d©a
, **
ﬁd
);

194 
	`øxTryIn£π
(
øx
 *øx, *
s
, 
size_t
 
Àn
, *
d©a
, **
ﬁd
);

195 
	`øxRemove
(
øx
 *øx, *
s
, 
size_t
 
Àn
, **
ﬁd
);

196 *
	`øxFöd
(
øx
 *øx, *
s
, 
size_t
 
Àn
);

197 
	`øxFªe
(
øx
 *rax);

198 
	`øxFªeWôhCÆlback
(
øx
 *øx, (*
‰ì_ˇŒback
)(*));

199 
	`øxSèπ
(
øxIãøt‹
 *
ô
, 
øx
 *
π
);

200 
	`øxSìk
(
øxIãøt‹
 *
ô
, c⁄° *
›
, *
ñe
, 
size_t
 
Àn
);

201 
	`øxNext
(
øxIãøt‹
 *
ô
);

202 
	`øxPªv
(
øxIãøt‹
 *
ô
);

203 
	`øxR™domWÆk
(
øxIãøt‹
 *
ô
, 
size_t
 
°ïs
);

204 
	`øxCom∑ª
(
øxIãøt‹
 *
ôî
, c⁄° *
›
, *
key
, 
size_t
 
key_Àn
);

205 
	`øxSt›
(
øxIãøt‹
 *
ô
);

206 
	`øxEOF
(
øxIãøt‹
 *
ô
);

207 
	`øxShow
(
øx
 *rax);

208 
uöt64_t
 
	`øxSize
(
øx
 *rax);

209 
	`øxTouch
(
øxNode
 *
n
);

210 
	`øxSëDebugMsg
(
⁄off
);

214 
	`øxSëD©a
(
øxNode
 *
n
, *
d©a
);

	@rax_malloc.h

38 #i‚de‡
RAX_ALLOC_H


39 
	#RAX_ALLOC_H


	)

40 
	~"zmÆloc.h
"

41 
	#øx_mÆloc
 
zmÆloc


	)

42 
	#øx_ªÆloc
 
zªÆloc


	)

43 
	#øx_‰ì
 
z‰ì


	)

	@rdb.c

30 
	~"£rvî.h
"

31 
	~"lzf.h
"

32 
	~"zùm≠.h
"

33 
	~"ídünc⁄v.h
"

34 
	~"°ªam.h
"

36 
	~<m©h.h
>

37 
	~<sys/ty≥s.h
>

38 
	~<sys/time.h
>

39 
	~<sys/ªsour˚.h
>

40 
	~<sys/waô.h
>

41 
	~<¨∑/öë.h
>

42 
	~<sys/°©.h
>

43 
	~<sys/∑øm.h
>

46 
	#rdbExôRï‹tC‹ru±RDB
(...Ë
	`rdbRï‹tEº‹
(1, 
__LINE__
,
__VA_ARGS__
)

	)

48 
	#rdbRï‹tRódEº‹
(...Ë
	`rdbRï‹tEº‹
(0, 
__LINE__
,
__VA_ARGS__
)

	)

50 * 
	grdbFûeBeögLﬂded
 = 
NULL
;

51 
rdbCheckMode
;

52 
rdbCheckEº‹
(c⁄° *
fmt
, ...);

53 
rdbCheckSëEº‹
(c⁄° *
fmt
, ...);

55 
	$rdbRï‹tEº‹
(
c‹ru±i⁄_îr‹
, 
löíum
, *
ªas⁄
, ...) {

56 
va_li°
 
≠
;

57 
msg
[1024];

58 
Àn
;

60 
Àn
 = 
	`¢¥ötf
(
msg
,(msg),

62 ()
£rvî
.
lﬂdög_lﬂded_byãs
, 
löíum
);

63 
	`va_°¨t
(
≠
,
ªas⁄
);

64 
	`v¢¥ötf
(
msg
+
Àn
,(msg)-Àn,
ªas⁄
,
≠
);

65 
	`va_íd
(
≠
);

67 i‡(!
rdbCheckMode
) {

68 i‡(
rdbFûeBeögLﬂded
 || 
c‹ru±i⁄_îr‹
) {

69 
	`£rvîLog
(
LL_WARNING
, "%s", 
msg
);

70 *
¨gv
[2] = {"",
rdbFûeBeögLﬂded
};

71 
	`ªdis_check_rdb_maö
(2,
¨gv
,
NULL
);

73 
	`£rvîLog
(
LL_WARNING
, "%s. FaûuªÜﬂdögÑdb f‹m© from sockë,ássumög c⁄√˘i⁄Éº‹,Ñesumög o≥øti⁄.", 
msg
);

77 
	`rdbCheckEº‹
("%s",
msg
);

79 
	`£rvîLog
(
LL_WARNING
, "Terminating serveráfterÑdb fileÑeading failure.");

80 
	`exô
(1);

81 
	}
}

83 
	$rdbWrôeRaw
(
rio
 *
rdb
, *
p
, 
size_t
 
Àn
) {

84 i‡(
rdb
 && 
	`rioWrôe
‘db,
p
,
Àn
) == 0)

86  
Àn
;

87 
	}
}

89 
	$rdbSaveTy≥
(
rio
 *
rdb
, 
ty≥
) {

90  
	`rdbWrôeRaw
(
rdb
,&
ty≥
,1);

91 
	}
}

96 
	$rdbLﬂdTy≥
(
rio
 *
rdb
) {

97 
ty≥
;

98 i‡(
	`rioRód
(
rdb
,&
ty≥
,1) == 0)  -1;

99  
ty≥
;

100 
	}
}

107 
time_t
 
	$rdbLﬂdTime
(
rio
 *
rdb
) {

108 
öt32_t
 
t32
;

109 i‡(
	`rioRód
(
rdb
,&
t32
,4) == 0)  -1;

110  (
time_t
)
t32
;

111 
	}
}

113 
	$rdbSaveMûli£c⁄dTime
(
rio
 *
rdb
, 
t
) {

114 
öt64_t
 
t64
 = (öt64_tË
t
;

115 
	`memªv64ifbe
(&
t64
);

116  
	`rdbWrôeRaw
(
rdb
,&
t64
,8);

117 
	}
}

134 
	$rdbLﬂdMûli£c⁄dTime
(
rio
 *
rdb
, 
rdbvî
) {

135 
öt64_t
 
t64
;

136 i‡(
	`rioRód
(
rdb
,&
t64
,8Ë=0Ë 
LLONG_MAX
;

137 i‡(
rdbvî
 >= 9)

138 
	`memªv64ifbe
(&
t64
);

139  ()
t64
;

140 
	}
}

145 
	$rdbSaveLí
(
rio
 *
rdb
, 
uöt64_t
 
Àn
) {

146 
buf
[2];

147 
size_t
 
nwrôãn
;

149 i‡(
Àn
 < (1<<6)) {

151 
buf
[0] = (
Àn
&0xFF)|(
RDB_6BITLEN
<<6);

152 i‡(
	`rdbWrôeRaw
(
rdb
,
buf
,1) == -1)  -1;

153 
nwrôãn
 = 1;

154 } i‡(
Àn
 < (1<<14)) {

156 
buf
[0] = ((
Àn
>>8)&0xFF)|(
RDB_14BITLEN
<<6);

157 
buf
[1] = 
Àn
&0xFF;

158 i‡(
	`rdbWrôeRaw
(
rdb
,
buf
,2) == -1)  -1;

159 
nwrôãn
 = 2;

160 } i‡(
Àn
 <
UINT32_MAX
) {

162 
buf
[0] = 
RDB_32BITLEN
;

163 i‡(
	`rdbWrôeRaw
(
rdb
,
buf
,1) == -1)  -1;

164 
uöt32_t
 
Àn32
 = 
	`ht⁄l
(
Àn
);

165 i‡(
	`rdbWrôeRaw
(
rdb
,&
Àn32
,4) == -1)  -1;

166 
nwrôãn
 = 1+4;

169 
buf
[0] = 
RDB_64BITLEN
;

170 i‡(
	`rdbWrôeRaw
(
rdb
,
buf
,1) == -1)  -1;

171 
Àn
 = 
	`ht⁄u64
(len);

172 i‡(
	`rdbWrôeRaw
(
rdb
,&
Àn
,8) == -1)  -1;

173 
nwrôãn
 = 1+8;

175  
nwrôãn
;

176 
	}
}

188 
	$rdbLﬂdLíByRef
(
rio
 *
rdb
, *
i£ncoded
, 
uöt64_t
 *
À≈å
) {

189 
buf
[2];

190 
ty≥
;

192 i‡(
i£ncoded
) *isencoded = 0;

193 i‡(
	`rioRód
(
rdb
,
buf
,1) == 0)  -1;

194 
ty≥
 = (
buf
[0]&0xC0)>>6;

195 i‡(
ty≥
 =
RDB_ENCVAL
) {

197 i‡(
i£ncoded
) *isencoded = 1;

198 *
À≈å
 = 
buf
[0]&0x3F;

199 } i‡(
ty≥
 =
RDB_6BITLEN
) {

201 *
À≈å
 = 
buf
[0]&0x3F;

202 } i‡(
ty≥
 =
RDB_14BITLEN
) {

204 i‡(
	`rioRód
(
rdb
,
buf
+1,1) == 0)  -1;

205 *
À≈å
 = ((
buf
[0]&0x3F)<<8)|buf[1];

206 } i‡(
buf
[0] =
RDB_32BITLEN
) {

208 
uöt32_t
 
Àn
;

209 i‡(
	`rioRód
(
rdb
,&
Àn
,4) == 0)  -1;

210 *
À≈å
 = 
	`¡ohl
(
Àn
);

211 } i‡(
buf
[0] =
RDB_64BITLEN
) {

213 
uöt64_t
 
Àn
;

214 i‡(
	`rioRód
(
rdb
,&
Àn
,8) == 0)  -1;

215 *
À≈å
 = 
	`¡ohu64
(
Àn
);

217 
	`rdbExôRï‹tC‹ru±RDB
(

218 "Unknow¿ÀngthÉncodög %d i¿rdbLﬂdLí()",
ty≥
);

222 
	}
}

228 
uöt64_t
 
	$rdbLﬂdLí
(
rio
 *
rdb
, *
i£ncoded
) {

229 
uöt64_t
 
Àn
;

231 i‡(
	`rdbLﬂdLíByRef
(
rdb
,
i£ncoded
,&
Àn
Ë=-1Ë 
RDB_LENERR
;

232  
Àn
;

233 
	}
}

239 
	$rdbEncodeI¡egî
(
vÆue
, *
íc
) {

240 i‡(
vÆue
 >= -(1<<7) && value <= (1<<7)-1) {

241 
íc
[0] = (
RDB_ENCVAL
<<6)|
RDB_ENC_INT8
;

242 
íc
[1] = 
vÆue
&0xFF;

244 } i‡(
vÆue
 >= -(1<<15) && value <= (1<<15)-1) {

245 
íc
[0] = (
RDB_ENCVAL
<<6)|
RDB_ENC_INT16
;

246 
íc
[1] = 
vÆue
&0xFF;

247 
íc
[2] = (
vÆue
>>8)&0xFF;

249 } i‡(
vÆue
 >= -(()1<<31) && value <= (()1<<31)-1) {

250 
íc
[0] = (
RDB_ENCVAL
<<6)|
RDB_ENC_INT32
;

251 
íc
[1] = 
vÆue
&0xFF;

252 
íc
[2] = (
vÆue
>>8)&0xFF;

253 
íc
[3] = (
vÆue
>>16)&0xFF;

254 
íc
[4] = (
vÆue
>>24)&0xFF;

259 
	}
}

264 *
	$rdbLﬂdI¡egîObje˘
(
rio
 *
rdb
, 
í˘y≥
, 
Êags
, 
size_t
 *
À≈å
) {

265 
∂aö
 = 
Êags
 & 
RDB_LOAD_PLAIN
;

266 
sds
 = 
Êags
 & 
RDB_LOAD_SDS
;

267 
ícode
 = 
Êags
 & 
RDB_LOAD_ENC
;

268 
íc
[4];

269 
vÆ
;

271 i‡(
í˘y≥
 =
RDB_ENC_INT8
) {

272 i‡(
	`rioRód
(
rdb
,
íc
,1Ë=0Ë 
NULL
;

273 
vÆ
 = (sig√d )
íc
[0];

274 } i‡(
í˘y≥
 =
RDB_ENC_INT16
) {

275 
uöt16_t
 
v
;

276 i‡(
	`rioRód
(
rdb
,
íc
,2Ë=0Ë 
NULL
;

277 
v
 = 
íc
[0]|(enc[1]<<8);

278 
vÆ
 = (
öt16_t
)
v
;

279 } i‡(
í˘y≥
 =
RDB_ENC_INT32
) {

280 
uöt32_t
 
v
;

281 i‡(
	`rioRód
(
rdb
,
íc
,4Ë=0Ë 
NULL
;

282 
v
 = 
íc
[0]|(enc[1]<<8)|(enc[2]<<16)|(enc[3]<<24);

283 
vÆ
 = (
öt32_t
)
v
;

285 
	`rdbExôRï‹tC‹ru±RDB
("Unknow¿RDB i¡egîÉncodögÅy≥ %d",
í˘y≥
);

286  
NULL
;

288 i‡(
∂aö
 || 
sds
) {

289 
buf
[
LONG_STR_SIZE
], *
p
;

290 
Àn
 = 
	`Œ2°rög
(
buf
,(buf),
vÆ
);

291 i‡(
À≈å
Ë*À≈å = 
Àn
;

292 
p
 = 
∂aö
 ? 
	`zmÆloc
(
Àn
Ë: 
	`sd¢ewÀn
(
SDS_NOINIT
,len);

293 
	`mem˝y
(
p
,
buf
,
Àn
);

294  
p
;

295 } i‡(
ícode
) {

296  
	`¸óãSåögObje˘FromL⁄gL⁄gF‹VÆue
(
vÆ
);

298  
	`¸óãObje˘
(
OBJ_STRING
,
	`sds‰oml⁄gl⁄g
(
vÆ
));

300 
	}
}

305 
	$rdbTryI¡egîEncodög
(*
s
, 
size_t
 
Àn
, *
íc
) {

306 
vÆue
;

307 *
íd±r
, 
buf
[32];

310 
vÆue
 = 
	`°πﬁl
(
s
, &
íd±r
, 10);

311 i‡(
íd±r
[0] != '\0')  0;

312 
	`Œ2°rög
(
buf
,32,
vÆue
);

316 i‡(
	`°æí
(
buf
Ë!
Àn
 || 
	`memcmp
(buf,
s
,len))  0;

318  
	`rdbEncodeI¡egî
(
vÆue
,
íc
);

319 
	}
}

321 
ssize_t
 
	$rdbSaveLzfBlob
(
rio
 *
rdb
, *
d©a
, 
size_t
 
com¥ess_Àn
,

322 
size_t
 
‹igöÆ_Àn
) {

323 
byã
;

324 
ssize_t
 
n
, 
nwrôãn
 = 0;

327 
byã
 = (
RDB_ENCVAL
<<6)|
RDB_ENC_LZF
;

328 i‡((
n
 = 
	`rdbWrôeRaw
(
rdb
,&
byã
,1)Ë=-1Ë
wrôìº
;

329 
nwrôãn
 +
n
;

331 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
com¥ess_Àn
)Ë=-1Ë
wrôìº
;

332 
nwrôãn
 +
n
;

334 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
‹igöÆ_Àn
)Ë=-1Ë
wrôìº
;

335 
nwrôãn
 +
n
;

337 i‡((
n
 = 
	`rdbWrôeRaw
(
rdb
,
d©a
,
com¥ess_Àn
)Ë=-1Ë
wrôìº
;

338 
nwrôãn
 +
n
;

340  
nwrôãn
;

342 
wrôìº
:

344 
	}
}

346 
ssize_t
 
	$rdbSaveLzfSåögObje˘
(
rio
 *
rdb
, *
s
, 
size_t
 
Àn
) {

347 
size_t
 
com¥Àn
, 
ouéí
;

348 *
out
;

351 i‡(
Àn
 <= 4)  0;

352 
ouéí
 = 
Àn
-4;

353 i‡((
out
 = 
	`zmÆloc
(
ouéí
+1)Ë=
NULL
)  0;

354 
com¥Àn
 = 
	`lzf_com¥ess
(
s
, 
Àn
, 
out
, 
ouéí
);

355 i‡(
com¥Àn
 == 0) {

356 
	`z‰ì
(
out
);

359 
ssize_t
 
nwrôãn
 = 
	`rdbSaveLzfBlob
(
rdb
, 
out
, 
com¥Àn
, 
Àn
);

360 
	`z‰ì
(
out
);

361  
nwrôãn
;

362 
	}
}

367 *
	$rdbLﬂdLzfSåögObje˘
(
rio
 *
rdb
, 
Êags
, 
size_t
 *
À≈å
) {

368 
∂aö
 = 
Êags
 & 
RDB_LOAD_PLAIN
;

369 
sds
 = 
Êags
 & 
RDB_LOAD_SDS
;

370 
uöt64_t
 
Àn
, 
˛í
;

371 *
c
 = 
NULL
;

372 *
vÆ
 = 
NULL
;

374 i‡((
˛í
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
)  NULL;

375 i‡((
Àn
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
)  NULL;

376 i‡((
c
 = 
	`zmÆloc
(
˛í
)Ë=
NULL
Ë
îr
;

379 i‡(
∂aö
) {

380 
vÆ
 = 
	`zmÆloc
(
Àn
);

382 
vÆ
 = 
	`sd¢ewÀn
(
SDS_NOINIT
,
Àn
);

384 i‡(
À≈å
Ë*À≈å = 
Àn
;

387 i‡(
	`rioRód
(
rdb
,
c
,
˛í
Ë=0Ë
îr
;

388 i‡(
	`lzf_decom¥ess
(
c
,
˛í
,
vÆ
,
Àn
) == 0) {

389 
	`rdbExôRï‹tC‹ru±RDB
("Invalid LZF compressed string");

391 
	`z‰ì
(
c
);

393 i‡(
∂aö
 || 
sds
) {

394  
vÆ
;

396  
	`¸óãObje˘
(
OBJ_STRING
,
vÆ
);

398 
îr
:

399 
	`z‰ì
(
c
);

400 i‡(
∂aö
)

401 
	`z‰ì
(
vÆ
);

403 
	`sds‰ì
(
vÆ
);

404  
NULL
;

405 
	}
}

409 
ssize_t
 
	$rdbSaveRawSåög
(
rio
 *
rdb
, *
s
, 
size_t
 
Àn
) {

410 
í˛í
;

411 
ssize_t
 
n
, 
nwrôãn
 = 0;

414 i‡(
Àn
 <= 11) {

415 
buf
[5];

416 i‡((
í˛í
 = 
	`rdbTryI¡egîEncodög
((*)
s
,
Àn
,
buf
)) > 0) {

417 i‡(
	`rdbWrôeRaw
(
rdb
,
buf
,
í˛í
) == -1)  -1;

418  
í˛í
;

424 i‡(
£rvî
.
rdb_com¥essi⁄
 && 
Àn
 > 20) {

425 
n
 = 
	`rdbSaveLzfSåögObje˘
(
rdb
,
s
,
Àn
);

426 i‡(
n
 == -1)  -1;

427 i‡(
n
 > 0) Ç;

432 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
Àn
)) == -1)  -1;

433 
nwrôãn
 +
n
;

434 i‡(
Àn
 > 0) {

435 i‡(
	`rdbWrôeRaw
(
rdb
,
s
,
Àn
) == -1)  -1;

436 
nwrôãn
 +
Àn
;

438  
nwrôãn
;

439 
	}
}

442 
ssize_t
 
	$rdbSaveL⁄gL⁄gAsSåögObje˘
(
rio
 *
rdb
, 
vÆue
) {

443 
buf
[32];

444 
ssize_t
 
n
, 
nwrôãn
 = 0;

445 
í˛í
 = 
	`rdbEncodeI¡egî
(
vÆue
,
buf
);

446 i‡(
í˛í
 > 0) {

447  
	`rdbWrôeRaw
(
rdb
,
buf
,
í˛í
);

450 
í˛í
 = 
	`Œ2°rög
((*)
buf
,32,
vÆue
);

451 
	`£rvîAs£π
(
í˛í
 < 32);

452 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
í˛í
)) == -1)  -1;

453 
nwrôãn
 +
n
;

454 i‡((
n
 = 
	`rdbWrôeRaw
(
rdb
,
buf
,
í˛í
)) == -1)  -1;

455 
nwrôãn
 +
n
;

457  
nwrôãn
;

458 
	}
}

461 
ssize_t
 
	$rdbSaveSåögObje˘
(
rio
 *
rdb
, 
robj
 *
obj
) {

464 i‡(
obj
->
ícodög
 =
OBJ_ENCODING_INT
) {

465  
	`rdbSaveL⁄gL⁄gAsSåögObje˘
(
rdb
,()
obj
->
±r
);

467 
	`£rvîAs£πWôhInfo
(
NULL
,
obj
,
	`sdsEncodedObje˘
(obj));

468  
	`rdbSaveRawSåög
(
rdb
,
obj
->
±r
,
	`sd¶í
(obj->ptr));

470 
	}
}

485 *
	$rdbGíîicLﬂdSåögObje˘
(
rio
 *
rdb
, 
Êags
, 
size_t
 *
À≈å
) {

486 
ícode
 = 
Êags
 & 
RDB_LOAD_ENC
;

487 
∂aö
 = 
Êags
 & 
RDB_LOAD_PLAIN
;

488 
sds
 = 
Êags
 & 
RDB_LOAD_SDS
;

489 
i£ncoded
;

490 
uöt64_t
 
Àn
;

492 
Àn
 = 
	`rdbLﬂdLí
(
rdb
,&
i£ncoded
);

493 i‡(
i£ncoded
) {

494 
Àn
) {

495 
RDB_ENC_INT8
:

496 
RDB_ENC_INT16
:

497 
RDB_ENC_INT32
:

498  
	`rdbLﬂdI¡egîObje˘
(
rdb
,
Àn
,
Êags
,
À≈å
);

499 
RDB_ENC_LZF
:

500  
	`rdbLﬂdLzfSåögObje˘
(
rdb
,
Êags
,
À≈å
);

502 
	`rdbExôRï‹tC‹ru±RDB
("Unknow¿RDB såögÉncodögÅy≥ %d",
Àn
);

503  
NULL
;

507 i‡(
Àn
 =
RDB_LENERR
Ë 
NULL
;

508 i‡(
∂aö
 || 
sds
) {

509 *
buf
 = 
∂aö
 ? 
	`zmÆloc
(
Àn
Ë: 
	`sd¢ewÀn
(
SDS_NOINIT
,len);

510 i‡(
À≈å
Ë*À≈å = 
Àn
;

511 i‡(
Àn
 && 
	`rioRód
(
rdb
,
buf
,len) == 0) {

512 i‡(
∂aö
)

513 
	`z‰ì
(
buf
);

515 
	`sds‰ì
(
buf
);

516  
NULL
;

518  
buf
;

520 
robj
 *
o
 = 
ícode
 ? 
	`¸óãSåögObje˘
(
SDS_NOINIT
,
Àn
) :

521 
	`¸óãRawSåögObje˘
(
SDS_NOINIT
,
Àn
);

522 i‡(
Àn
 && 
	`rioRód
(
rdb
,
o
->
±r
,len) == 0) {

523 
	`de¸RefCou¡
(
o
);

524  
NULL
;

526  
o
;

528 
	}
}

530 
robj
 *
	$rdbLﬂdSåögObje˘
(
rio
 *
rdb
) {

531  
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_NONE
,
NULL
);

532 
	}
}

534 
robj
 *
	$rdbLﬂdEncodedSåögObje˘
(
rio
 *
rdb
) {

535  
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_ENC
,
NULL
);

536 
	}
}

546 
	$rdbSaveDoubÀVÆue
(
rio
 *
rdb
, 
vÆ
) {

547 
buf
[128];

548 
Àn
;

550 i‡(
	`i¢™
(
vÆ
)) {

551 
buf
[0] = 253;

552 
Àn
 = 1;

553 } i‡(!
	`isföôe
(
vÆ
)) {

554 
Àn
 = 1;

555 
buf
[0] = (
vÆ
 < 0) ? 255 : 254;

557 #i‡(
DBL_MANT_DIG
 >52Ë&& (
LLONG_MAX
 == 0x7fffffffffffffffLL)

567 
mö
 = -4503599627370495;

568 
max
 = 4503599627370496;

569 i‡(
vÆ
 > 
mö
 && vÆ < 
max
 && val == (()(()val)))

570 
	`Œ2°rög
((*)
buf
+1,(buf)-1,()
vÆ
);

573 
	`¢¥ötf
((*)
buf
+1,(buf)-1,"%.17g",
vÆ
);

574 
buf
[0] = 
	`°æí
((*)buf+1);

575 
Àn
 = 
buf
[0]+1;

577  
	`rdbWrôeRaw
(
rdb
,
buf
,
Àn
);

578 
	}
}

581 
	$rdbLﬂdDoubÀVÆue
(
rio
 *
rdb
, *
vÆ
) {

582 
buf
[256];

583 
Àn
;

585 i‡(
	`rioRód
(
rdb
,&
Àn
,1) == 0)  -1;

586 
Àn
) {

587 255: *
vÆ
 = 
R_NegInf
;  0;

588 254: *
vÆ
 = 
R_PosInf
;  0;

589 253: *
vÆ
 = 
R_N™
;  0;

591 i‡(
	`rioRód
(
rdb
,
buf
,
Àn
) == 0)  -1;

592 
buf
[
Àn
] = '\0';

593 
	`ssˇnf
(
buf
, "%lg", 
vÆ
);

596 
	}
}

603 
	$rdbSaveBö¨yDoubÀVÆue
(
rio
 *
rdb
, 
vÆ
) {

604 
	`memªv64ifbe
(&
vÆ
);

605  
	`rdbWrôeRaw
(
rdb
,&
vÆ
,(val));

606 
	}
}

610 
	$rdbLﬂdBö¨yDoubÀVÆue
(
rio
 *
rdb
, *
vÆ
) {

611 i‡(
	`rioRód
(
rdb
,
vÆ
,(*val)) == 0)  -1;

612 
	`memªv64ifbe
(
vÆ
);

614 
	}
}

617 
	$rdbSaveBö¨yFlﬂtVÆue
(
rio
 *
rdb
, 
vÆ
) {

618 
	`memªv32ifbe
(&
vÆ
);

619  
	`rdbWrôeRaw
(
rdb
,&
vÆ
,(val));

620 
	}
}

623 
	$rdbLﬂdBö¨yFlﬂtVÆue
(
rio
 *
rdb
, *
vÆ
) {

624 i‡(
	`rioRód
(
rdb
,
vÆ
,(*val)) == 0)  -1;

625 
	`memªv32ifbe
(
vÆ
);

627 
	}
}

630 
	$rdbSaveObje˘Ty≥
(
rio
 *
rdb
, 
robj
 *
o
) {

631 
o
->
ty≥
) {

632 
OBJ_STRING
:

633  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_STRING
);

634 
OBJ_LIST
:

635 i‡(
o
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
)

636  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_LIST_QUICKLIST
);

638 
	`£rvîP™ic
("UnknownÜistÉncoding");

639 
OBJ_SET
:

640 i‡(
o
->
ícodög
 =
OBJ_ENCODING_INTSET
)

641  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_SET_INTSET
);

642 i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
)

643  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_SET
);

645 
	`£rvîP™ic
("Unknown setÉncoding");

646 
OBJ_ZSET
:

647 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
)

648  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_ZSET_ZIPLIST
);

649 i‡(
o
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
)

650  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_ZSET_2
);

652 
	`£rvîP™ic
("Unknown sorted setÉncoding");

653 
OBJ_HASH
:

654 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
)

655  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_HASH_ZIPLIST
);

656 i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
)

657  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_HASH
);

659 
	`£rvîP™ic
("Unknown hashÉncoding");

660 
OBJ_STREAM
:

661  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_STREAM_LISTPACKS
);

662 
OBJ_MODULE
:

663  
	`rdbSaveTy≥
(
rdb
,
RDB_TYPE_MODULE_2
);

665 
	`£rvîP™ic
("Unknown objectÅype");

668 
	}
}

672 
	$rdbLﬂdObje˘Ty≥
(
rio
 *
rdb
) {

673 
ty≥
;

674 i‡((
ty≥
 = 
	`rdbLﬂdTy≥
(
rdb
)) == -1)  -1;

675 i‡(!
	`rdbIsObje˘Ty≥
(
ty≥
))  -1;

676  
ty≥
;

677 
	}
}

686 
ssize_t
 
	$rdbSaveSåómPEL
(
rio
 *
rdb
, 
øx
 *
≥l
, 
«cks
) {

687 
ssize_t
 
n
, 
nwrôãn
 = 0;

690 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
	`øxSize
(
≥l
))) == -1)  -1;

691 
nwrôãn
 +
n
;

694 
øxIãøt‹
 
ri
;

695 
	`øxSèπ
(&
ri
,
≥l
);

696 
	`øxSìk
(&
ri
,"^",
NULL
,0);

697 
	`øxNext
(&
ri
)) {

700 i‡((
n
 = 
	`rdbWrôeRaw
(
rdb
,
ri
.
key
,(
°ªamID
))) == -1)  -1;

701 
nwrôãn
 +
n
;

703 i‡(
«cks
) {

704 
°ªamNACK
 *
«ck
 = 
ri
.
d©a
;

705 i‡((
n
 = 
	`rdbSaveMûli£c⁄dTime
(
rdb
,
«ck
->
dñivîy_time
)) == -1)

707 
nwrôãn
 +
n
;

708 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
«ck
->
dñivîy_cou¡
)) == -1)  -1;

709 
nwrôãn
 +
n
;

715 
	`øxSt›
(&
ri
);

716  
nwrôãn
;

717 
	}
}

722 
size_t
 
	$rdbSaveSåómC⁄sumîs
(
rio
 *
rdb
, 
°ªamCG
 *
cg
) {

723 
ssize_t
 
n
, 
nwrôãn
 = 0;

726 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
	`øxSize
(
cg
->
c⁄sumîs
))) == -1)  -1;

727 
nwrôãn
 +
n
;

730 
øxIãøt‹
 
ri
;

731 
	`øxSèπ
(&
ri
,
cg
->
c⁄sumîs
);

732 
	`øxSìk
(&
ri
,"^",
NULL
,0);

733 
	`øxNext
(&
ri
)) {

734 
°ªamC⁄sumî
 *
c⁄sumî
 = 
ri
.
d©a
;

737 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,
ri
.
key
,ri.
key_Àn
)) == -1)  -1;

738 
nwrôãn
 +
n
;

741 i‡((
n
 = 
	`rdbSaveMûli£c⁄dTime
(
rdb
,
c⁄sumî
->
£í_time
)) == -1)

743 
nwrôãn
 +
n
;

749 i‡((
n
 = 
	`rdbSaveSåómPEL
(
rdb
,
c⁄sumî
->
≥l
,0)) == -1)

751 
nwrôãn
 +
n
;

753 
	`øxSt›
(&
ri
);

754  
nwrôãn
;

755 
	}
}

759 
ssize_t
 
	$rdbSaveObje˘
(
rio
 *
rdb
, 
robj
 *
o
,Ñobj *
key
) {

760 
ssize_t
 
n
 = 0, 
nwrôãn
 = 0;

762 i‡(
o
->
ty≥
 =
OBJ_STRING
) {

764 i‡((
n
 = 
	`rdbSaveSåögObje˘
(
rdb
,
o
)) == -1)  -1;

765 
nwrôãn
 +
n
;

766 } i‡(
o
->
ty≥
 =
OBJ_LIST
) {

768 i‡(
o
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

769 
quickli°
 *
ql
 = 
o
->
±r
;

770 
quickli°Node
 *
node
 = 
ql
->
hód
;

772 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
ql
->
Àn
)) == -1)  -1;

773 
nwrôãn
 +
n
;

775 
node
) {

776 i‡(
	`quickli°NodeIsCom¥es£d
(
node
)) {

777 *
d©a
;

778 
size_t
 
com¥ess_Àn
 = 
	`quickli°GëLzf
(
node
, &
d©a
);

779 i‡((
n
 = 
	`rdbSaveLzfBlob
(
rdb
,
d©a
,
com¥ess_Àn
,
node
->
sz
)) == -1)  -1;

780 
nwrôãn
 +
n
;

782 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,
node
->
zl
,node->
sz
)) == -1)  -1;

783 
nwrôãn
 +
n
;

785 
node
 =Çode->
√xt
;

788 
	`£rvîP™ic
("UnknownÜistÉncoding");

790 } i‡(
o
->
ty≥
 =
OBJ_SET
) {

792 i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

793 
di˘
 *
£t
 = 
o
->
±r
;

794 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
£t
);

795 
di˘E¡ry
 *
de
;

797 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
	`di˘Size
(
£t
))) == -1) {

798 
	`di˘Rñó£Iãøt‹
(
di
);

801 
nwrôãn
 +
n
;

803 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

804 
sds
 
ñe
 = 
	`di˘GëKey
(
de
);

805 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,(*)
ñe
,
	`sd¶í
(ele)))

808 
	`di˘Rñó£Iãøt‹
(
di
);

811 
nwrôãn
 +
n
;

813 
	`di˘Rñó£Iãøt‹
(
di
);

814 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

815 
size_t
 
l
 = 
	`öt£tBlobLí
((
öt£t
*)
o
->
±r
);

817 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,
o
->
±r
,
l
)) == -1)  -1;

818 
nwrôãn
 +
n
;

820 
	`£rvîP™ic
("Unknown setÉncoding");

822 } i‡(
o
->
ty≥
 =
OBJ_ZSET
) {

824 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

825 
size_t
 
l
 = 
	`zùli°BlobLí
((*)
o
->
±r
);

827 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,
o
->
±r
,
l
)) == -1)  -1;

828 
nwrôãn
 +
n
;

829 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

830 
z£t
 *
zs
 = 
o
->
±r
;

831 
zskùli°
 *
z¶
 = 
zs
->zsl;

833 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
z¶
->
Àngth
)) == -1)  -1;

834 
nwrôãn
 +
n
;

842 
zskùli°Node
 *
zn
 = 
z¶
->
èû
;

843 
zn
 !
NULL
) {

844 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,

845 (*)
zn
->
ñe
,
	`sd¶í
(zn->ele))) == -1)

849 
nwrôãn
 +
n
;

850 i‡((
n
 = 
	`rdbSaveBö¨yDoubÀVÆue
(
rdb
,
zn
->
sc‹e
)) == -1)

852 
nwrôãn
 +
n
;

853 
zn
 = zn->
backw¨d
;

856 
	`£rvîP™ic
("Unknown sorted setÉncoding");

858 } i‡(
o
->
ty≥
 =
OBJ_HASH
) {

860 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

861 
size_t
 
l
 = 
	`zùli°BlobLí
((*)
o
->
±r
);

863 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,
o
->
±r
,
l
)) == -1)  -1;

864 
nwrôãn
 +
n
;

866 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

867 
di˘Iãøt‹
 *
di
 = 
	`di˘GëIãøt‹
(
o
->
±r
);

868 
di˘E¡ry
 *
de
;

870 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
	`di˘Size
((
di˘
*)
o
->
±r
))) == -1) {

871 
	`di˘Rñó£Iãøt‹
(
di
);

874 
nwrôãn
 +
n
;

876 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

877 
sds
 
fõld
 = 
	`di˘GëKey
(
de
);

878 
sds
 
vÆue
 = 
	`di˘GëVÆ
(
de
);

880 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,(*)
fõld
,

881 
	`sd¶í
(
fõld
))) == -1)

883 
	`di˘Rñó£Iãøt‹
(
di
);

886 
nwrôãn
 +
n
;

887 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,(*)
vÆue
,

888 
	`sd¶í
(
vÆue
))) == -1)

890 
	`di˘Rñó£Iãøt‹
(
di
);

893 
nwrôãn
 +
n
;

895 
	`di˘Rñó£Iãøt‹
(
di
);

897 
	`£rvîP™ic
("Unknown hashÉncoding");

899 } i‡(
o
->
ty≥
 =
OBJ_STREAM
) {

901 
°ªam
 *
s
 = 
o
->
±r
;

902 
øx
 *øx = 
s
->rax;

903 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
	`øxSize
(
øx
))) == -1)  -1;

904 
nwrôãn
 +
n
;

909 
øxIãøt‹
 
ri
;

910 
	`øxSèπ
(&
ri
,
øx
);

911 
	`øxSìk
(&
ri
,"^",
NULL
,0);

912 
	`øxNext
(&
ri
)) {

913 *
Õ
 = 
ri
.
d©a
;

914 
size_t
 
Õ_byãs
 = 
	`ÕByãs
(
Õ
);

915 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,
ri
.
key
,ri.
key_Àn
)) == -1)  -1;

916 
nwrôãn
 +
n
;

917 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,
Õ
,
Õ_byãs
)) == -1)  -1;

918 
nwrôãn
 +
n
;

920 
	`øxSt›
(&
ri
);

925 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
s
->
Àngth
)) == -1)  -1;

926 
nwrôãn
 +
n
;

928 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
s
->
œ°_id
.
ms
)) == -1)  -1;

929 
nwrôãn
 +
n
;

930 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
s
->
œ°_id
.
£q
)) == -1)  -1;

931 
nwrôãn
 +
n
;

937 
size_t
 
num_cgroups
 = 
s
->
cgroups
 ? 
	`øxSize
(s->cgroups) : 0;

938 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
num_cgroups
)) == -1)  -1;

939 
nwrôãn
 +
n
;

941 i‡(
num_cgroups
) {

943 
	`øxSèπ
(&
ri
,
s
->
cgroups
);

944 
	`øxSìk
(&
ri
,"^",
NULL
,0);

945 
	`øxNext
(&
ri
)) {

946 
°ªamCG
 *
cg
 = 
ri
.
d©a
;

949 i‡((
n
 = 
	`rdbSaveRawSåög
(
rdb
,
ri
.
key
,ri.
key_Àn
)) == -1)

951 
nwrôãn
 +
n
;

954 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
cg
->
œ°_id
.
ms
)) == -1)  -1;

955 
nwrôãn
 +
n
;

956 i‡((
n
 = 
	`rdbSaveLí
(
rdb
,
cg
->
œ°_id
.
£q
)) == -1)  -1;

957 
nwrôãn
 +
n
;

960 i‡((
n
 = 
	`rdbSaveSåómPEL
(
rdb
,
cg
->
≥l
,1)) == -1)  -1;

961 
nwrôãn
 +
n
;

964 i‡((
n
 = 
	`rdbSaveSåómC⁄sumîs
(
rdb
,
cg
)) == -1)  -1;

965 
nwrôãn
 +
n
;

967 
	`øxSt›
(&
ri
);

969 } i‡(
o
->
ty≥
 =
OBJ_MODULE
) {

971 
RedisModuÀIO
 
io
;

972 
moduÀVÆue
 *
mv
 = 
o
->
±r
;

973 
moduÀTy≥
 *
mt
 = 
mv
->
ty≥
;

977 
ªtvÆ
 = 
	`rdbSaveLí
(
rdb
,
mt
->
id
);

978 i‡(
ªtvÆ
 == -1)  -1;

979 
io
.
byãs
 +
ªtvÆ
;

982 
	`moduÀInôIOC⁄ãxt
(
io
,
mt
,
rdb
,
key
);

983 
mt
->
	`rdb_ßve
(&
io
,
mv
->
vÆue
);

984 
ªtvÆ
 = 
	`rdbSaveLí
(
rdb
,
RDB_MODULE_OPCODE_EOF
);

985 i‡(
ªtvÆ
 == -1)

986 
io
.
îr‹
 = 1;

988 
io
.
byãs
 +
ªtvÆ
;

990 i‡(
io
.
˘x
) {

991 
	`moduÀFªeC⁄ãxt
(
io
.
˘x
);

992 
	`z‰ì
(
io
.
˘x
);

994  
io
.
îr‹
 ? -1 : (
ssize_t
)io.
byãs
;

996 
	`£rvîP™ic
("Unknown objectÅype");

998  
nwrôãn
;

999 
	}
}

1005 
size_t
 
	$rdbSavedObje˘Lí
(
robj
 *
o
,Ñobj *
key
) {

1006 
ssize_t
 
Àn
 = 
	`rdbSaveObje˘
(
NULL
,
o
,
key
);

1007 
	`£rvîAs£πWôhInfo
(
NULL
,
o
,
Àn
 != -1);

1008  
Àn
;

1009 
	}
}

1015 
	$rdbSaveKeyVÆuePaú
(
rio
 *
rdb
, 
robj
 *
key
,Ñobj *
vÆ
, 
expúëime
) {

1016 
ßvñru
 = 
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LRU
;

1017 
ßvñfu
 = 
£rvî
.
maxmem‹y_pﬁicy
 & 
MAXMEMORY_FLAG_LFU
;

1020 i‡(
expúëime
 != -1) {

1021 i‡(
	`rdbSaveTy≥
(
rdb
,
RDB_OPCODE_EXPIRETIME_MS
) == -1)  -1;

1022 i‡(
	`rdbSaveMûli£c⁄dTime
(
rdb
,
expúëime
) == -1)  -1;

1026 i‡(
ßvñru
) {

1027 
uöt64_t
 
idÀtime
 = 
	`e°im©eObje˘IdÀTime
(
vÆ
);

1028 
idÀtime
 /= 1000;

1029 i‡(
	`rdbSaveTy≥
(
rdb
,
RDB_OPCODE_IDLE
) == -1)  -1;

1030 i‡(
	`rdbSaveLí
(
rdb
,
idÀtime
) == -1)  -1;

1034 i‡(
ßvñfu
) {

1035 
uöt8_t
 
buf
[1];

1036 
buf
[0] = 
	`LFUDe¸AndRëu∫
(
vÆ
);

1041 i‡(
	`rdbSaveTy≥
(
rdb
,
RDB_OPCODE_FREQ
) == -1)  -1;

1042 i‡(
	`rdbWrôeRaw
(
rdb
,
buf
,1) == -1)  -1;

1046 i‡(
	`rdbSaveObje˘Ty≥
(
rdb
,
vÆ
) == -1)  -1;

1047 i‡(
	`rdbSaveSåögObje˘
(
rdb
,
key
) == -1)  -1;

1048 i‡(
	`rdbSaveObje˘
(
rdb
,
vÆ
,
key
) == -1)  -1;

1051 i‡(
£rvî
.
rdb_key_ßve_dñay
)

1052 
	`u¶ìp
(
£rvî
.
rdb_key_ßve_dñay
);

1055 
	}
}

1058 
ssize_t
 
	$rdbSaveAuxFõld
(
rio
 *
rdb
, *
key
, 
size_t
 
keyÀn
, *
vÆ
, size_à
vÆÀn
) {

1059 
ssize_t
 
ªt
, 
Àn
 = 0;

1060 i‡((
ªt
 = 
	`rdbSaveTy≥
(
rdb
,
RDB_OPCODE_AUX
)) == -1)  -1;

1061 
Àn
 +
ªt
;

1062 i‡((
ªt
 = 
	`rdbSaveRawSåög
(
rdb
,
key
,
keyÀn
)) == -1)  -1;

1063 
Àn
 +
ªt
;

1064 i‡((
ªt
 = 
	`rdbSaveRawSåög
(
rdb
,
vÆ
,
vÆÀn
)) == -1)  -1;

1065 
Àn
 +
ªt
;

1066  
Àn
;

1067 
	}
}

1071 
ssize_t
 
	$rdbSaveAuxFõldSåSå
(
rio
 *
rdb
, *
key
, *
vÆ
) {

1072  
	`rdbSaveAuxFõld
(
rdb
,
key
,
	`°æí
(key),
vÆ
,strlen(val));

1073 
	}
}

1076 
ssize_t
 
	$rdbSaveAuxFõldSåI¡
(
rio
 *
rdb
, *
key
, 
vÆ
) {

1077 
buf
[
LONG_STR_SIZE
];

1078 
vÀn
 = 
	`Œ2°rög
(
buf
,(buf),
vÆ
);

1079  
	`rdbSaveAuxFõld
(
rdb
,
key
,
	`°æí
(key),
buf
,
vÀn
);

1080 
	}
}

1083 
	$rdbSaveInfoAuxFõlds
(
rio
 *
rdb
, 
rdbÊags
, 
rdbSaveInfo
 *
rsi
) {

1084 
ªdis_bôs
 = ((*) == 8) ? 64 : 32;

1085 
aof_¥ómbÀ
 = (
rdbÊags
 & 
RDBFLAGS_AOF_PREAMBLE
) != 0;

1088 i‡(
	`rdbSaveAuxFõldSåSå
(
rdb
,"ªdis-vî",
REDIS_VERSION
) == -1)  -1;

1089 i‡(
	`rdbSaveAuxFõldSåI¡
(
rdb
,"ªdis-bôs",
ªdis_bôs
) == -1)  -1;

1090 i‡(
	`rdbSaveAuxFõldSåI¡
(
rdb
,"˘ime",
	`time
(
NULL
)) == -1)  -1;

1091 i‡(
	`rdbSaveAuxFõldSåI¡
(
rdb
,"u£d-mem",
	`zmÆloc_u£d_mem‹y
()) == -1)  -1;

1094 i‡(
rsi
) {

1095 i‡(
	`rdbSaveAuxFõldSåI¡
(
rdb
,"ª∂-°ªam-db",
rsi
->
ª∂_°ªam_db
)

1097 i‡(
	`rdbSaveAuxFõldSåSå
(
rdb
,"ª∂-id",
£rvî
.
ª∂id
)

1099 i‡(
	`rdbSaveAuxFõldSåI¡
(
rdb
,"ª∂-off£t",
£rvî
.
ma°î_ª∂_off£t
)

1102 i‡(
	`rdbSaveAuxFõldSåI¡
(
rdb
,"aof-¥ómbÀ",
aof_¥ómbÀ
) == -1)  -1;

1104 
	}
}

1106 
ssize_t
 
	$rdbSaveSögÀModuÀAux
(
rio
 *
rdb
, 
whí
, 
moduÀTy≥
 *
mt
) {

1108 
RedisModuÀIO
 
io
;

1109 
ªtvÆ
 = 
	`rdbSaveTy≥
(
rdb
, 
RDB_OPCODE_MODULE_AUX
);

1113 
ªtvÆ
 = 
	`rdbSaveLí
(
rdb
,
mt
->
id
);

1114 i‡(
ªtvÆ
 == -1)  -1;

1115 
io
.
byãs
 +
ªtvÆ
;

1120 
ªtvÆ
 = 
	`rdbSaveLí
(
rdb
,
RDB_MODULE_OPCODE_UINT
);

1121 i‡(
ªtvÆ
 == -1)  -1;

1122 
io
.
byãs
 +
ªtvÆ
;

1123 
ªtvÆ
 = 
	`rdbSaveLí
(
rdb
,
whí
);

1124 i‡(
ªtvÆ
 == -1)  -1;

1125 
io
.
byãs
 +
ªtvÆ
;

1128 
	`moduÀInôIOC⁄ãxt
(
io
,
mt
,
rdb
,
NULL
);

1129 
mt
->
	`aux_ßve
(&
io
,
whí
);

1130 
ªtvÆ
 = 
	`rdbSaveLí
(
rdb
,
RDB_MODULE_OPCODE_EOF
);

1131 i‡(
ªtvÆ
 == -1)

1132 
io
.
îr‹
 = 1;

1134 
io
.
byãs
 +
ªtvÆ
;

1136 i‡(
io
.
˘x
) {

1137 
	`moduÀFªeC⁄ãxt
(
io
.
˘x
);

1138 
	`z‰ì
(
io
.
˘x
);

1140 i‡(
io
.
îr‹
)

1142  
io
.
byãs
;

1143 
	}
}

1153 
	$rdbSaveRio
(
rio
 *
rdb
, *
îr‹
, 
rdbÊags
, 
rdbSaveInfo
 *
rsi
) {

1154 
di˘Iãøt‹
 *
di
 = 
NULL
;

1155 
di˘E¡ry
 *
de
;

1156 
magic
[10];

1157 
j
;

1158 
uöt64_t
 
cksum
;

1159 
size_t
 
¥o˚s£d
 = 0;

1161 i‡(
£rvî
.
rdb_checksum
)

1162 
rdb
->
upd©e_cksum
 = 
rioGíîicUpd©eChecksum
;

1163 
	`¢¥ötf
(
magic
,(magic),"REDIS%04d",
RDB_VERSION
);

1164 i‡(
	`rdbWrôeRaw
(
rdb
,
magic
,9Ë=-1Ë
wîr
;

1165 i‡(
	`rdbSaveInfoAuxFõlds
(
rdb
,
rdbÊags
,
rsi
Ë=-1Ë
wîr
;

1166 i‡(
	`rdbSaveModuÀsAux
(
rdb
, 
REDISMODULE_AUX_BEFORE_RDB
Ë=-1Ë
wîr
;

1168 
j
 = 0; j < 
£rvî
.
dbnum
; j++) {

1169 
ªdisDb
 *
db
 = 
£rvî
.db+
j
;

1170 
di˘
 *
d
 = 
db
->dict;

1171 i‡(
	`di˘Size
(
d
) == 0) ;

1172 
di
 = 
	`di˘GëSa„Iãøt‹
(
d
);

1175 i‡(
	`rdbSaveTy≥
(
rdb
,
RDB_OPCODE_SELECTDB
Ë=-1Ë
wîr
;

1176 i‡(
	`rdbSaveLí
(
rdb
,
j
Ë=-1Ë
wîr
;

1179 
uöt64_t
 
db_size
, 
expúes_size
;

1180 
db_size
 = 
	`di˘Size
(
db
->
di˘
);

1181 
expúes_size
 = 
	`di˘Size
(
db
->
expúes
);

1182 i‡(
	`rdbSaveTy≥
(
rdb
,
RDB_OPCODE_RESIZEDB
Ë=-1Ë
wîr
;

1183 i‡(
	`rdbSaveLí
(
rdb
,
db_size
Ë=-1Ë
wîr
;

1184 i‡(
	`rdbSaveLí
(
rdb
,
expúes_size
Ë=-1Ë
wîr
;

1187 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1188 
sds
 
key°r
 = 
	`di˘GëKey
(
de
);

1189 
robj
 
key
, *
o
 = 
	`di˘GëVÆ
(
de
);

1190 
expúe
;

1192 
	`öôSèticSåögObje˘
(
key
,
key°r
);

1193 
expúe
 = 
	`gëExpúe
(
db
,&
key
);

1194 i‡(
	`rdbSaveKeyVÆuePaú
(
rdb
,&
key
,
o
,
expúe
Ë=-1Ë
wîr
;

1199 i‡(
rdbÊags
 & 
RDBFLAGS_AOF_PREAMBLE
 &&

1200 
rdb
->
¥o˚s£d_byãs
 > 
¥o˚s£d
+
AOF_READ_DIFF_INTERVAL_BYTES
)

1202 
¥o˚s£d
 = 
rdb
->
¥o˚s£d_byãs
;

1203 
	`aofRódDiffFromP¨ít
();

1206 
	`di˘Rñó£Iãøt‹
(
di
);

1207 
di
 = 
NULL
;

1214 i‡(
rsi
 && 
	`di˘Size
(
£rvî
.
lua_s¸ùts
)) {

1215 
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
lua_s¸ùts
);

1216 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1217 
robj
 *
body
 = 
	`di˘GëVÆ
(
de
);

1218 i‡(
	`rdbSaveAuxFõld
(
rdb
,"lua",3,
body
->
±r
,
	`sd¶í
(body->ptr)) == -1)

1219 
wîr
;

1221 
	`di˘Rñó£Iãøt‹
(
di
);

1222 
di
 = 
NULL
;

1225 i‡(
	`rdbSaveModuÀsAux
(
rdb
, 
REDISMODULE_AUX_AFTER_RDB
Ë=-1Ë
wîr
;

1228 i‡(
	`rdbSaveTy≥
(
rdb
,
RDB_OPCODE_EOF
Ë=-1Ë
wîr
;

1232 
cksum
 = 
rdb
->cksum;

1233 
	`memªv64ifbe
(&
cksum
);

1234 i‡(
	`rioWrôe
(
rdb
,&
cksum
,8Ë=0Ë
wîr
;

1235  
C_OK
;

1237 
wîr
:

1238 i‡(
îr‹
Ë*îr‹ = 
î∫o
;

1239 i‡(
di
Ë
	`di˘Rñó£Iãøt‹
(di);

1240  
C_ERR
;

1241 
	}
}

1251 
	$rdbSaveRioWôhEOFM¨k
(
rio
 *
rdb
, *
îr‹
, 
rdbSaveInfo
 *
rsi
) {

1252 
eofm¨k
[
RDB_EOF_MARK_SIZE
];

1254 
	`°¨tSavög
(
RDBFLAGS_REPLICATION
);

1255 
	`gëR™domHexCh¨s
(
eofm¨k
,
RDB_EOF_MARK_SIZE
);

1256 i‡(
îr‹
) *error = 0;

1257 i‡(
	`rioWrôe
(
rdb
,"$EOF:",5Ë=0Ë
wîr
;

1258 i‡(
	`rioWrôe
(
rdb
,
eofm¨k
,
RDB_EOF_MARK_SIZE
Ë=0Ë
wîr
;

1259 i‡(
	`rioWrôe
(
rdb
,"\r\n",2Ë=0Ë
wîr
;

1260 i‡(
	`rdbSaveRio
(
rdb
,
îr‹
,
RDBFLAGS_NONE
,
rsi
Ë=
C_ERR
Ë
wîr
;

1261 i‡(
	`rioWrôe
(
rdb
,
eofm¨k
,
RDB_EOF_MARK_SIZE
Ë=0Ë
wîr
;

1262 
	`°›Savög
(1);

1263  
C_OK
;

1265 
wîr
:

1267 i‡(
îr‹
 && *îr‹ =0Ë*îr‹ = 
î∫o
;

1268 
	`°›Savög
(0);

1269  
C_ERR
;

1270 
	}
}

1273 
	$rdbSave
(*
fûíame
, 
rdbSaveInfo
 *
rsi
) {

1274 
tmpfûe
[256];

1275 
cwd
[
MAXPATHLEN
];

1276 
FILE
 *
Â
;

1277 
rio
 
rdb
;

1278 
îr‹
 = 0;

1280 
	`¢¥ötf
(
tmpfûe
,256,"ãmp-%d.rdb", (Ë
	`gëpid
());

1281 
Â
 = 
	`f›í
(
tmpfûe
,"w");

1282 i‡(!
Â
) {

1283 *
cwdp
 = 
	`gëcwd
(
cwd
,
MAXPATHLEN
);

1284 
	`£rvîLog
(
LL_WARNING
,

1287 
fûíame
,

1288 
cwdp
 ? cwdp : "unknown",

1289 
	`°ªº‹
(
î∫o
));

1290  
C_ERR
;

1293 
	`rioInôWôhFûe
(&
rdb
,
Â
);

1294 
	`°¨tSavög
(
RDBFLAGS_NONE
);

1296 i‡(
£rvî
.
rdb_ßve_ö¸emíèl_fsync
)

1297 
	`rioSëAutoSync
(&
rdb
,
REDIS_AUTOSYNC_BYTES
);

1299 i‡(
	`rdbSaveRio
(&
rdb
,&
îr‹
,
RDBFLAGS_NONE
,
rsi
Ë=
C_ERR
) {

1300 
î∫o
 = 
îr‹
;

1301 
wîr
;

1305 i‡(
	`fÊush
(
Â
Ë=
EOF
Ë
wîr
;

1306 i‡(
	`fsync
(
	`fûío
(
Â
)Ë=-1Ë
wîr
;

1307 i‡(
	`f˛o£
(
Â
Ë=
EOF
Ë
wîr
;

1311 i‡(
	`ª«me
(
tmpfûe
,
fûíame
) == -1) {

1312 *
cwdp
 = 
	`gëcwd
(
cwd
,
MAXPATHLEN
);

1313 
	`£rvîLog
(
LL_WARNING
,

1316 
tmpfûe
,

1317 
fûíame
,

1318 
cwdp
 ? cwdp : "unknown",

1319 
	`°ªº‹
(
î∫o
));

1320 
	`u∆ök
(
tmpfûe
);

1321 
	`°›Savög
(0);

1322  
C_ERR
;

1325 
	`£rvîLog
(
LL_NOTICE
,"DB saved on disk");

1326 
£rvî
.
dúty
 = 0;

1327 
£rvî
.
œ°ßve
 = 
	`time
(
NULL
);

1328 
£rvî
.
œ°bgßve_°©us
 = 
C_OK
;

1329 
	`°›Savög
(1);

1330  
C_OK
;

1332 
wîr
:

1333 
	`£rvîLog
(
LL_WARNING
,"Wrôêîr‹ savög DB o¿disk: %s", 
	`°ªº‹
(
î∫o
));

1334 
	`f˛o£
(
Â
);

1335 
	`u∆ök
(
tmpfûe
);

1336 
	`°›Savög
(0);

1337  
C_ERR
;

1338 
	}
}

1340 
	$rdbSaveBackground
(*
fûíame
, 
rdbSaveInfo
 *
rsi
) {

1341 
pid_t
 
chûdpid
;

1343 i‡(
	`hasA˘iveChûdPro˚ss
()Ë 
C_ERR
;

1345 
£rvî
.
dúty_bef‹e_bgßve
 = sîvî.
dúty
;

1346 
£rvî
.
œ°bgßve_åy
 = 
	`time
(
NULL
);

1347 
	`›íChûdInfoPùe
();

1349 i‡((
chûdpid
 = 
	`ªdisF‹k
()) == 0) {

1350 
ªtvÆ
;

1353 
	`ªdisSëProcTôÀ
("redis-rdb-bgsave");

1354 
	`ªdisSëCpuAfföôy
(
£rvî
.
bgßve_˝uli°
);

1355 
ªtvÆ
 = 
	`rdbSave
(
fûíame
,
rsi
);

1356 i‡(
ªtvÆ
 =
C_OK
) {

1357 
	`£ndChûdCOWInfo
(
CHILD_INFO_TYPE_RDB
, "RDB");

1359 
	`exôFromChûd
((
ªtvÆ
 =
C_OK
) ? 0 : 1);

1362 i‡(
chûdpid
 == -1) {

1363 
	`˛o£ChûdInfoPùe
();

1364 
£rvî
.
œ°bgßve_°©us
 = 
C_ERR
;

1365 
	`£rvîLog
(
LL_WARNING
,"Can't save in background: fork: %s",

1366 
	`°ªº‹
(
î∫o
));

1367  
C_ERR
;

1369 
	`£rvîLog
(
LL_NOTICE
,"Background savög sèπed byÖid %d",
chûdpid
);

1370 
£rvî
.
rdb_ßve_time_°¨t
 = 
	`time
(
NULL
);

1371 
£rvî
.
rdb_chûd_pid
 = 
chûdpid
;

1372 
£rvî
.
rdb_chûd_ty≥
 = 
RDB_CHILD_TYPE_DISK
;

1373  
C_OK
;

1375  
C_OK
;

1376 
	}
}

1378 
	$rdbRemoveTempFûe
(
pid_t
 
chûdpid
) {

1379 
tmpfûe
[256];

1381 
	`¢¥ötf
(
tmpfûe
,—mpfûe),"ãmp-%d.rdb", (Ë
chûdpid
);

1382 
	`u∆ök
(
tmpfûe
);

1383 
	}
}

1389 
robj
 *
	$rdbLﬂdCheckModuÀVÆue
(
rio
 *
rdb
, *
moduÀ«me
) {

1390 
uöt64_t
 
›code
;

1391 (
›code
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë!
RDB_MODULE_OPCODE_EOF
) {

1392 i‡(
›code
 =
RDB_MODULE_OPCODE_SINT
 ||

1393 
›code
 =
RDB_MODULE_OPCODE_UINT
)

1395 
uöt64_t
 
Àn
;

1396 i‡(
	`rdbLﬂdLíByRef
(
rdb
,
NULL
,&
Àn
) == -1) {

1397 
	`rdbExôRï‹tC‹ru±RDB
(

1398 "Eº‹Ñódög i¡egî from moduÀ %†vÆue", 
moduÀ«me
);

1400 } i‡(
›code
 =
RDB_MODULE_OPCODE_STRING
) {

1401 
robj
 *
o
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_NONE
,
NULL
);

1402 i‡(
o
 =
NULL
) {

1403 
	`rdbExôRï‹tC‹ru±RDB
(

1404 "Eº‹Ñódög såög from moduÀ %†vÆue", 
moduÀ«me
);

1406 
	`de¸RefCou¡
(
o
);

1407 } i‡(
›code
 =
RDB_MODULE_OPCODE_FLOAT
) {

1408 
vÆ
;

1409 i‡(
	`rdbLﬂdBö¨yFlﬂtVÆue
(
rdb
,&
vÆ
) == -1) {

1410 
	`rdbExôRï‹tC‹ru±RDB
(

1411 "Eº‹Ñódög flﬂà‰om moduÀ %†vÆue", 
moduÀ«me
);

1413 } i‡(
›code
 =
RDB_MODULE_OPCODE_DOUBLE
) {

1414 
vÆ
;

1415 i‡(
	`rdbLﬂdBö¨yDoubÀVÆue
(
rdb
,&
vÆ
) == -1) {

1416 
	`rdbExôRï‹tC‹ru±RDB
(

1417 "Eº‹Ñódög doubÀ from moduÀ %†vÆue", 
moduÀ«me
);

1421  
	`¸óãSåögObje˘
("module-dummy-value",18);

1422 
	}
}

1426 
robj
 *
	$rdbLﬂdObje˘
(
rdbty≥
, 
rio
 *
rdb
, 
sds
 
key
) {

1427 
robj
 *
o
 = 
NULL
, *
ñe
, *
dec
;

1428 
uöt64_t
 
Àn
;

1429 
i
;

1431 i‡(
rdbty≥
 =
RDB_TYPE_STRING
) {

1433 i‡((
o
 = 
	`rdbLﬂdEncodedSåögObje˘
(
rdb
)Ë=
NULL
)  NULL;

1434 
o
 = 
	`åyObje˘Encodög
(o);

1435 } i‡(
rdbty≥
 =
RDB_TYPE_LIST
) {

1437 i‡((
Àn
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
)  NULL;

1439 
o
 = 
	`¸óãQuickli°Obje˘
();

1440 
	`quickli°SëO±i⁄s
(
o
->
±r
, 
£rvî
.
li°_max_zùli°_size
,

1441 
£rvî
.
li°_com¥ess_dïth
);

1444 
Àn
--) {

1445 i‡((
ñe
 = 
	`rdbLﬂdEncodedSåögObje˘
(
rdb
)Ë=
NULL
) {

1446 
	`de¸RefCou¡
(
o
);

1447  
NULL
;

1449 
dec
 = 
	`gëDecodedObje˘
(
ñe
);

1450 
size_t
 
Àn
 = 
	`sd¶í
(
dec
->
±r
);

1451 
	`quickli°PushTaû
(
o
->
±r
, 
dec
->±r, 
Àn
);

1452 
	`de¸RefCou¡
(
dec
);

1453 
	`de¸RefCou¡
(
ñe
);

1455 } i‡(
rdbty≥
 =
RDB_TYPE_SET
) {

1457 i‡((
Àn
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
)  NULL;

1460 i‡(
Àn
 > 
£rvî
.
£t_max_öt£t_íåõs
) {

1461 
o
 = 
	`¸óãSëObje˘
();

1464 i‡(
Àn
 > 
DICT_HT_INITIAL_SIZE
)

1465 
	`di˘Ex∑nd
(
o
->
±r
,
Àn
);

1467 
o
 = 
	`¸óãI¡£tObje˘
();

1471 
i
 = 0; i < 
Àn
; i++) {

1472 
ŒvÆ
;

1473 
sds
 
sd£À
;

1475 i‡((
sd£À
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
)) == NULL) {

1476 
	`de¸RefCou¡
(
o
);

1477  
NULL
;

1480 i‡(
o
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

1482 i‡(
	`isSdsRïª£¡abÀAsL⁄gL⁄g
(
sd£À
,&
ŒvÆ
Ë=
C_OK
) {

1483 
o
->
±r
 = 
	`öt£tAdd
(o->±r,
ŒvÆ
,
NULL
);

1485 
	`£tTy≥C⁄vît
(
o
,
OBJ_ENCODING_HT
);

1486 
	`di˘Ex∑nd
(
o
->
±r
,
Àn
);

1492 i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

1493 
	`di˘Add
((
di˘
*)
o
->
±r
,
sd£À
,
NULL
);

1495 
	`sds‰ì
(
sd£À
);

1498 } i‡(
rdbty≥
 =
RDB_TYPE_ZSET_2
 ||Ñdbty≥ =
RDB_TYPE_ZSET
) {

1500 
uöt64_t
 
z£éí
;

1501 
size_t
 
maxññí
 = 0;

1502 
z£t
 *
zs
;

1504 i‡((
z£éí
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
)  NULL;

1505 
o
 = 
	`¸óãZ£tObje˘
();

1506 
zs
 = 
o
->
±r
;

1508 i‡(
z£éí
 > 
DICT_HT_INITIAL_SIZE
)

1509 
	`di˘Ex∑nd
(
zs
->
di˘
,
z£éí
);

1512 
z£éí
--) {

1513 
sds
 
sd£À
;

1514 
sc‹e
;

1515 
zskùli°Node
 *
znode
;

1517 i‡((
sd£À
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
)) == NULL) {

1518 
	`de¸RefCou¡
(
o
);

1519  
NULL
;

1522 i‡(
rdbty≥
 =
RDB_TYPE_ZSET_2
) {

1523 i‡(
	`rdbLﬂdBö¨yDoubÀVÆue
(
rdb
,&
sc‹e
) == -1) {

1524 
	`de¸RefCou¡
(
o
);

1525 
	`sds‰ì
(
sd£À
);

1526  
NULL
;

1529 i‡(
	`rdbLﬂdDoubÀVÆue
(
rdb
,&
sc‹e
) == -1) {

1530 
	`de¸RefCou¡
(
o
);

1531 
	`sds‰ì
(
sd£À
);

1532  
NULL
;

1537 i‡(
	`sd¶í
(
sd£À
Ë> 
maxññí
) maxelelen = sdslen(sdsele);

1539 
znode
 = 
	`z¶In£π
(
zs
->
z¶
,
sc‹e
,
sd£À
);

1540 
	`di˘Add
(
zs
->
di˘
,
sd£À
,&
znode
->
sc‹e
);

1544 i‡(
	`z£tLígth
(
o
Ë<
£rvî
.
z£t_max_zùli°_íåõs
 &&

1545 
maxññí
 <
£rvî
.
z£t_max_zùli°_vÆue
)

1546 
	`z£tC⁄vît
(
o
,
OBJ_ENCODING_ZIPLIST
);

1547 } i‡(
rdbty≥
 =
RDB_TYPE_HASH
) {

1548 
uöt64_t
 
Àn
;

1549 
ªt
;

1550 
sds
 
fõld
, 
vÆue
;

1552 
Àn
 = 
	`rdbLﬂdLí
(
rdb
, 
NULL
);

1553 i‡(
Àn
 =
RDB_LENERR
Ë 
NULL
;

1555 
o
 = 
	`¸óãHashObje˘
();

1558 i‡(
Àn
 > 
£rvî
.
hash_max_zùli°_íåõs
)

1559 
	`hashTy≥C⁄vît
(
o
, 
OBJ_ENCODING_HT
);

1562 
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
 && 
Àn
 > 0) {

1563 
Àn
--;

1565 i‡((
fõld
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
)) == NULL) {

1566 
	`de¸RefCou¡
(
o
);

1567  
NULL
;

1569 i‡((
vÆue
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
)) == NULL) {

1570 
	`sds‰ì
(
fõld
);

1571 
	`de¸RefCou¡
(
o
);

1572  
NULL
;

1576 
o
->
±r
 = 
	`zùli°Push
(o->±r, (*)
fõld
,

1577 
	`sd¶í
(
fõld
), 
ZIPLIST_TAIL
);

1578 
o
->
±r
 = 
	`zùli°Push
(o->±r, (*)
vÆue
,

1579 
	`sd¶í
(
vÆue
), 
ZIPLIST_TAIL
);

1582 i‡(
	`sd¶í
(
fõld
Ë> 
£rvî
.
hash_max_zùli°_vÆue
 ||

1583 
	`sd¶í
(
vÆue
Ë> 
£rvî
.
hash_max_zùli°_vÆue
)

1585 
	`sds‰ì
(
fõld
);

1586 
	`sds‰ì
(
vÆue
);

1587 
	`hashTy≥C⁄vît
(
o
, 
OBJ_ENCODING_HT
);

1590 
	`sds‰ì
(
fõld
);

1591 
	`sds‰ì
(
vÆue
);

1594 i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
 && 
Àn
 > 
DICT_HT_INITIAL_SIZE
)

1595 
	`di˘Ex∑nd
(
o
->
±r
,
Àn
);

1598 
o
->
ícodög
 =
OBJ_ENCODING_HT
 && 
Àn
 > 0) {

1599 
Àn
--;

1601 i‡((
fõld
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
)) == NULL) {

1602 
	`de¸RefCou¡
(
o
);

1603  
NULL
;

1605 i‡((
vÆue
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
)) == NULL) {

1606 
	`sds‰ì
(
fõld
);

1607 
	`de¸RefCou¡
(
o
);

1608  
NULL
;

1612 
ªt
 = 
	`di˘Add
((
di˘
*)
o
->
±r
, 
fõld
, 
vÆue
);

1613 i‡(
ªt
 =
DICT_ERR
) {

1614 
	`rdbExôRï‹tC‹ru±RDB
("Duplicate keys detected");

1619 
	`£rvîAs£π
(
Àn
 == 0);

1620 } i‡(
rdbty≥
 =
RDB_TYPE_LIST_QUICKLIST
) {

1621 i‡((
Àn
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
)  NULL;

1622 
o
 = 
	`¸óãQuickli°Obje˘
();

1623 
	`quickli°SëO±i⁄s
(
o
->
±r
, 
£rvî
.
li°_max_zùli°_size
,

1624 
£rvî
.
li°_com¥ess_dïth
);

1626 
Àn
--) {

1627 *
zl
 =

1628 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_PLAIN
,
NULL
);

1629 i‡(
zl
 =
NULL
) {

1630 
	`de¸RefCou¡
(
o
);

1631  
NULL
;

1633 
	`quickli°AµídZùli°
(
o
->
±r
, 
zl
);

1635 } i‡(
rdbty≥
 =
RDB_TYPE_HASH_ZIPMAP
 ||

1636 
rdbty≥
 =
RDB_TYPE_LIST_ZIPLIST
 ||

1637 
rdbty≥
 =
RDB_TYPE_SET_INTSET
 ||

1638 
rdbty≥
 =
RDB_TYPE_ZSET_ZIPLIST
 ||

1639 
rdbty≥
 =
RDB_TYPE_HASH_ZIPLIST
)

1641 *
ícoded
 =

1642 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_PLAIN
,
NULL
);

1643 i‡(
ícoded
 =
NULL
)  NULL;

1644 
o
 = 
	`¸óãObje˘
(
OBJ_STRING
,
ícoded
);

1652 
rdbty≥
) {

1653 
RDB_TYPE_HASH_ZIPMAP
:

1657 *
zl
 = 
	`zùli°New
();

1658 *
zi
 = 
	`zùm≠Rewöd
(
o
->
±r
);

1659 *
f°r
, *
v°r
;

1660 
Êí
, 
vÀn
;

1661 
maxÀn
 = 0;

1663 (
zi
 = 
	`zùm≠Next
(zi, &
f°r
, &
Êí
, &
v°r
, &
vÀn
)Ë!
NULL
) {

1664 i‡(
Êí
 > 
maxÀn
) maxlen = flen;

1665 i‡(
vÀn
 > 
maxÀn
) maxlen = vlen;

1666 
zl
 = 
	`zùli°Push
(zl, 
f°r
, 
Êí
, 
ZIPLIST_TAIL
);

1667 
zl
 = 
	`zùli°Push
(zl, 
v°r
, 
vÀn
, 
ZIPLIST_TAIL
);

1670 
	`z‰ì
(
o
->
±r
);

1671 
o
->
±r
 = 
zl
;

1672 
o
->
ty≥
 = 
OBJ_HASH
;

1673 
o
->
ícodög
 = 
OBJ_ENCODING_ZIPLIST
;

1675 i‡(
	`hashTy≥Lígth
(
o
Ë> 
£rvî
.
hash_max_zùli°_íåõs
 ||

1676 
maxÀn
 > 
£rvî
.
hash_max_zùli°_vÆue
)

1678 
	`hashTy≥C⁄vît
(
o
, 
OBJ_ENCODING_HT
);

1682 
RDB_TYPE_LIST_ZIPLIST
:

1683 
o
->
ty≥
 = 
OBJ_LIST
;

1684 
o
->
ícodög
 = 
OBJ_ENCODING_ZIPLIST
;

1685 
	`li°Ty≥C⁄vît
(
o
,
OBJ_ENCODING_QUICKLIST
);

1687 
RDB_TYPE_SET_INTSET
:

1688 
o
->
ty≥
 = 
OBJ_SET
;

1689 
o
->
ícodög
 = 
OBJ_ENCODING_INTSET
;

1690 i‡(
	`öt£tLí
(
o
->
±r
Ë> 
£rvî
.
£t_max_öt£t_íåõs
)

1691 
	`£tTy≥C⁄vît
(
o
,
OBJ_ENCODING_HT
);

1693 
RDB_TYPE_ZSET_ZIPLIST
:

1694 
o
->
ty≥
 = 
OBJ_ZSET
;

1695 
o
->
ícodög
 = 
OBJ_ENCODING_ZIPLIST
;

1696 i‡(
	`z£tLígth
(
o
Ë> 
£rvî
.
z£t_max_zùli°_íåõs
)

1697 
	`z£tC⁄vît
(
o
,
OBJ_ENCODING_SKIPLIST
);

1699 
RDB_TYPE_HASH_ZIPLIST
:

1700 
o
->
ty≥
 = 
OBJ_HASH
;

1701 
o
->
ícodög
 = 
OBJ_ENCODING_ZIPLIST
;

1702 i‡(
	`hashTy≥Lígth
(
o
Ë> 
£rvî
.
hash_max_zùli°_íåõs
)

1703 
	`hashTy≥C⁄vît
(
o
, 
OBJ_ENCODING_HT
);

1707 
	`rdbExôRï‹tC‹ru±RDB
("Unknow¿RDBÉncodögÅy≥ %d",
rdbty≥
);

1710 } i‡(
rdbty≥
 =
RDB_TYPE_STREAM_LISTPACKS
) {

1711 
o
 = 
	`¸óãSåómObje˘
();

1712 
°ªam
 *
s
 = 
o
->
±r
;

1713 
uöt64_t
 
li°∑cks
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1714 i‡(
li°∑cks
 =
RDB_LENERR
) {

1715 
	`rdbRï‹tRódEº‹
("StreamÜistpacksÜenÜoading failed.");

1716 
	`de¸RefCou¡
(
o
);

1717  
NULL
;

1720 
li°∑cks
--) {

1724 
sds
 
nodekey
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
);

1725 i‡(
nodekey
 =
NULL
) {

1726 
	`rdbRï‹tRódEº‹
("Stream master IDÜoading failed: invalidÉncoding or I/OÉrror.");

1727 
	`de¸RefCou¡
(
o
);

1728  
NULL
;

1730 i‡(
	`sd¶í
(
nodekey
Ë!(
°ªamID
)) {

1731 
	`rdbExôRï‹tC‹ru±RDB
("StreamÇode keyÉntry isÇotÅhe "

1736 *
Õ
 =

1737 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_PLAIN
,
NULL
);

1738 i‡(
Õ
 =
NULL
) {

1739 
	`rdbRï‹tRódEº‹
("StreamÜistpacksÜoading failed.");

1740 
	`sds‰ì
(
nodekey
);

1741 
	`de¸RefCou¡
(
o
);

1742  
NULL
;

1744 *
fú°
 = 
	`ÕFú°
(
Õ
);

1745 i‡(
fú°
 =
NULL
) {

1749 
	`rdbExôRï‹tC‹ru±RDB
("EmptyÜistpack inside stream");

1753 
ªtvÆ
 = 
	`øxIn£π
(
s
->
øx
,

1754 (*)
nodekey
,(
°ªamID
),
Õ
,
NULL
);

1755 
	`sds‰ì
(
nodekey
);

1756 i‡(!
ªtvÆ
)

1757 
	`rdbExôRï‹tC‹ru±RDB
("ListpackÑe-added withÉxisting key");

1760 
s
->
Àngth
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1763 
s
->
œ°_id
.
ms
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1764 
s
->
œ°_id
.
£q
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1766 i‡(
	`rioGëRódEº‹
(
rdb
)) {

1767 
	`rdbRï‹tRódEº‹
("Stream object metadataÜoading failed.");

1768 
	`de¸RefCou¡
(
o
);

1769  
NULL
;

1773 
uöt64_t
 
cgroups_cou¡
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1774 i‡(
cgroups_cou¡
 =
RDB_LENERR
) {

1775 
	`rdbRï‹tRódEº‹
("Stream cgroup countÜoading failed.");

1776 
	`de¸RefCou¡
(
o
);

1777  
NULL
;

1779 
cgroups_cou¡
--) {

1783 
°ªamID
 
cg_id
;

1784 
sds
 
cg«me
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
);

1785 i‡(
cg«me
 =
NULL
) {

1786 
	`rdbRï‹tRódEº‹
(

1788 
	`de¸RefCou¡
(
o
);

1789  
NULL
;

1792 
cg_id
.
ms
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1793 
cg_id
.
£q
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1794 i‡(
	`rioGëRódEº‹
(
rdb
)) {

1795 
	`rdbRï‹tRódEº‹
("Stream cgroup IDÜoading failed.");

1796 
	`sds‰ì
(
cg«me
);

1797 
	`de¸RefCou¡
(
o
);

1798  
NULL
;

1801 
°ªamCG
 *
cgroup
 = 
	`°ªamCª©eCG
(
s
,
cg«me
,
	`sd¶í
(cg«me),&
cg_id
);

1802 i‡(
cgroup
 =
NULL
)

1803 
	`rdbExôRï‹tC‹ru±RDB
("Duplicated consumer groupÇame %s",

1804 
cg«me
);

1805 
	`sds‰ì
(
cg«me
);

1812 
uöt64_t
 
≥l_size
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1813 i‡(
≥l_size
 =
RDB_LENERR
) {

1814 
	`rdbRï‹tRódEº‹
("Stream PEL sizeÜoading failed.");

1815 
	`de¸RefCou¡
(
o
);

1816  
NULL
;

1818 
≥l_size
--) {

1819 
øwid
[(
°ªamID
)];

1820 i‡(
	`rioRód
(
rdb
,
øwid
,(rawid)) == 0) {

1821 
	`rdbRï‹tRódEº‹
("Stream PEL IDÜoading failed.");

1822 
	`de¸RefCou¡
(
o
);

1823  
NULL
;

1825 
°ªamNACK
 *
«ck
 = 
	`°ªamCª©eNACK
(
NULL
);

1826 
«ck
->
dñivîy_time
 = 
	`rdbLﬂdMûli£c⁄dTime
(
rdb
,
RDB_VERSION
);

1827 
«ck
->
dñivîy_cou¡
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1828 i‡(
	`rioGëRódEº‹
(
rdb
)) {

1829 
	`rdbRï‹tRódEº‹
("Stream PEL NACKÜoading failed.");

1830 
	`de¸RefCou¡
(
o
);

1831 
	`°ªamFªeNACK
(
«ck
);

1832  
NULL
;

1834 i‡(!
	`øxIn£π
(
cgroup
->
≥l
,
øwid
,‘awid),
«ck
,
NULL
))

1835 
	`rdbExôRï‹tC‹ru±RDB
("Duplicated gobal PELÉntry "

1841 
uöt64_t
 
c⁄sumîs_num
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1842 i‡(
c⁄sumîs_num
 =
RDB_LENERR
) {

1843 
	`rdbRï‹tRódEº‹
("Stream consumersÇumÜoading failed.");

1844 
	`de¸RefCou¡
(
o
);

1845  
NULL
;

1847 
c⁄sumîs_num
--) {

1848 
sds
 
˙ame
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
);

1849 i‡(
˙ame
 =
NULL
) {

1850 
	`rdbRï‹tRódEº‹
(

1852 
	`de¸RefCou¡
(
o
);

1853  
NULL
;

1855 
°ªamC⁄sumî
 *
c⁄sumî
 =

1856 
	`°ªamLookupC⁄sumî
(
cgroup
,
˙ame
,
SLC_NONE
);

1857 
	`sds‰ì
(
˙ame
);

1858 
c⁄sumî
->
£í_time
 = 
	`rdbLﬂdMûli£c⁄dTime
(
rdb
,
RDB_VERSION
);

1859 i‡(
	`rioGëRódEº‹
(
rdb
)) {

1860 
	`rdbRï‹tRódEº‹
("Stream shortÑeadÑeading seenÅime.");

1861 
	`de¸RefCou¡
(
o
);

1862  
NULL
;

1867 
≥l_size
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1868 i‡(
≥l_size
 =
RDB_LENERR
) {

1869 
	`rdbRï‹tRódEº‹
(

1871 
	`de¸RefCou¡
(
o
);

1872  
NULL
;

1874 
≥l_size
--) {

1875 
øwid
[(
°ªamID
)];

1876 i‡(
	`rioRód
(
rdb
,
øwid
,(rawid)) == 0) {

1877 
	`rdbRï‹tRódEº‹
(

1879 
	`de¸RefCou¡
(
o
);

1880  
NULL
;

1882 
°ªamNACK
 *
«ck
 = 
	`øxFöd
(
cgroup
->
≥l
,
øwid
,(rawid));

1883 i‡(
«ck
 =
øxNŸFound
)

1884 
	`rdbExôRï‹tC‹ru±RDB
("ConsumerÉntryÇot found in "

1890 
«ck
->
c⁄sumî
 = consumer;

1891 i‡(!
	`øxIn£π
(
c⁄sumî
->
≥l
,
øwid
,‘awid),
«ck
,
NULL
))

1892 
	`rdbExôRï‹tC‹ru±RDB
("Duplicated consumer PELÉntry "

1898 } i‡(
rdbty≥
 =
RDB_TYPE_MODULE
 ||Ñdbty≥ =
RDB_TYPE_MODULE_2
) {

1899 
uöt64_t
 
moduÀid
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1900 i‡(
	`rioGëRódEº‹
(
rdb
)) {

1901 
	`rdbRï‹tRódEº‹
("ShortÑead module id");

1902  
NULL
;

1904 
moduÀTy≥
 *
mt
 = 
	`moduÀTy≥LookupModuÀByID
(
moduÀid
);

1905 
«me
[10];

1907 i‡(
rdbCheckMode
 && 
rdbty≥
 =
RDB_TYPE_MODULE_2
) {

1908 
	`moduÀTy≥NameByID
(
«me
,
moduÀid
);

1909  
	`rdbLﬂdCheckModuÀVÆue
(
rdb
,
«me
);

1912 i‡(
mt
 =
NULL
) {

1913 
	`moduÀTy≥NameByID
(
«me
,
moduÀid
);

1914 
	`£rvîLog
(
LL_WARNING
,"ThêRDB fûêc⁄èö†moduÀ d©®I c™'àlﬂd:Çÿm©chög moduÀ '%s'", 
«me
);

1915 
	`exô
(1);

1917 
RedisModuÀIO
 
io
;

1918 
robj
 
keyobj
;

1919 
	`öôSèticSåögObje˘
(
keyobj
,
key
);

1920 
	`moduÀInôIOC⁄ãxt
(
io
,
mt
,
rdb
,&
keyobj
);

1921 
io
.
vî
 = (
rdbty≥
 =
RDB_TYPE_MODULE
) ? 1 : 2;

1924 *
±r
 = 
mt
->
	`rdb_lﬂd
(&
io
,
moduÀid
&1023);

1925 i‡(
io
.
˘x
) {

1926 
	`moduÀFªeC⁄ãxt
(
io
.
˘x
);

1927 
	`z‰ì
(
io
.
˘x
);

1931 i‡(
io
.
vî
 == 2) {

1932 
uöt64_t
 
eof
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

1933 i‡(
eof
 =
RDB_LENERR
) {

1934 
o
 = 
	`¸óãModuÀObje˘
(
mt
,
±r
);

1935 
	`de¸RefCou¡
(
o
);

1936  
NULL
;

1938 i‡(
eof
 !
RDB_MODULE_OPCODE_EOF
) {

1939 
	`£rvîLog
(
LL_WARNING
,"ThêRDB fûêc⁄èö†moduÀ d©®f‹ÅhêmoduÀ '%s'Åh© i†nŸÅîmö©ed byÅhê¥›î moduÀ vÆuêEOF m¨kî", 
«me
);

1940 
	`exô
(1);

1944 i‡(
±r
 =
NULL
) {

1945 
	`moduÀTy≥NameByID
(
«me
,
moduÀid
);

1946 
	`£rvîLog
(
LL_WARNING
,"ThêRDB fûêc⁄èö†moduÀ d©®f‹ÅhêmoduÀÅy≥ '%s',Åh©Åhêª•⁄sibÀ moduÀ i†nŸábÀÅÿlﬂd. Check f‹ moduÀ†logábovêf‹áddôi⁄Æ clues.", 
«me
);

1947 
	`exô
(1);

1949 
o
 = 
	`¸óãModuÀObje˘
(
mt
,
±r
);

1951 
	`rdbRï‹tRódEº‹
("Unknow¿RDBÉncodögÅy≥ %d",
rdbty≥
);

1952  
NULL
;

1954  
o
;

1955 
	}
}

1959 
	$°¨tLﬂdög
(
size_t
 
size
, 
rdbÊags
) {

1961 
£rvî
.
lﬂdög
 = 1;

1962 
£rvî
.
lﬂdög_°¨t_time
 = 
	`time
(
NULL
);

1963 
£rvî
.
lﬂdög_lﬂded_byãs
 = 0;

1964 
£rvî
.
lﬂdög_tŸÆ_byãs
 = 
size
;

1967 
subevít
;

1968 i‡(
rdbÊags
 & 
RDBFLAGS_AOF_PREAMBLE
)

1969 
subevít
 = 
REDISMODULE_SUBEVENT_LOADING_AOF_START
;

1970 if(
rdbÊags
 & 
RDBFLAGS_REPLICATION
)

1971 
subevít
 = 
REDISMODULE_SUBEVENT_LOADING_REPL_START
;

1973 
subevít
 = 
REDISMODULE_SUBEVENT_LOADING_RDB_START
;

1974 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_LOADING
,
subevít
,
NULL
);

1975 
	}
}

1980 
	$°¨tLﬂdögFûe
(
FILE
 *
Â
, * 
fûíame
, 
rdbÊags
) {

1981 
°©
 
sb
;

1982 i‡(
	`f°©
(
	`fûío
(
Â
), &
sb
) == -1)

1983 
sb
.
°_size
 = 0;

1984 
rdbFûeBeögLﬂded
 = 
fûíame
;

1985 
	`°¨tLﬂdög
(
sb
.
°_size
, 
rdbÊags
);

1986 
	}
}

1989 
	$lﬂdögProgªss
(
off_t
 
pos
) {

1990 
£rvî
.
lﬂdög_lﬂded_byãs
 = 
pos
;

1991 i‡(
£rvî
.
°©_≥ak_mem‹y
 < 
	`zmÆloc_u£d_mem‹y
())

1992 
£rvî
.
°©_≥ak_mem‹y
 = 
	`zmÆloc_u£d_mem‹y
();

1993 
	}
}

1996 
	$°›Lﬂdög
(
suc˚ss
) {

1997 
£rvî
.
lﬂdög
 = 0;

1998 
rdbFûeBeögLﬂded
 = 
NULL
;

2001 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_LOADING
,

2002 
suc˚ss
?

2003 
REDISMODULE_SUBEVENT_LOADING_ENDED
:

2004 
REDISMODULE_SUBEVENT_LOADING_FAILED
,

2005 
NULL
);

2006 
	}
}

2008 
	$°¨tSavög
(
rdbÊags
) {

2010 
subevít
;

2011 i‡(
rdbÊags
 & 
RDBFLAGS_AOF_PREAMBLE
)

2012 
subevít
 = 
REDISMODULE_SUBEVENT_PERSISTENCE_AOF_START
;

2013 i‡(
	`gëpid
()!=
£rvî
.
pid
)

2014 
subevít
 = 
REDISMODULE_SUBEVENT_PERSISTENCE_RDB_START
;

2016 
subevít
 = 
REDISMODULE_SUBEVENT_PERSISTENCE_SYNC_RDB_START
;

2017 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_PERSISTENCE
,
subevít
,
NULL
);

2018 
	}
}

2020 
	$°›Savög
(
suc˚ss
) {

2022 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_PERSISTENCE
,

2023 
suc˚ss
?

2024 
REDISMODULE_SUBEVENT_PERSISTENCE_ENDED
:

2025 
REDISMODULE_SUBEVENT_PERSISTENCE_FAILED
,

2026 
NULL
);

2027 
	}
}

2031 
	$rdbLﬂdProgªssCÆlback
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
) {

2032 i‡(
£rvî
.
rdb_checksum
)

2033 
	`rioGíîicUpd©eChecksum
(
r
, 
buf
, 
Àn
);

2034 i‡(
£rvî
.
lﬂdög_¥o˚ss_evíts_öãrvÆ_byãs
 &&

2035 (
r
->
¥o˚s£d_byãs
 + 
Àn
)/
£rvî
.
lﬂdög_¥o˚ss_evíts_öãrvÆ_byãs
 >Ñ->processed_bytes/server.loading_process_events_interval_bytes)

2040 
	`upd©eCachedTime
(0);

2041 i‡(
£rvî
.
ma°îho°
 && sîvî.
ª∂_°©e
 =
REPL_STATE_TRANSFER
)

2042 
	`ª∂iˇti⁄SídNewlöeToMa°î
();

2043 
	`lﬂdögProgªss
(
r
->
¥o˚s£d_byãs
);

2044 
	`¥o˚ssEvítsWhûeBlocked
();

2045 
	`¥o˚ssModuÀLﬂdögProgªssEvít
(0);

2047 
	}
}

2051 
	$rdbLﬂdRio
(
rio
 *
rdb
, 
rdbÊags
, 
rdbSaveInfo
 *
rsi
) {

2052 
uöt64_t
 
dbid
;

2053 
ty≥
, 
rdbvî
;

2054 
ªdisDb
 *
db
 = 
£rvî
.db+0;

2055 
buf
[1024];

2057 
rdb
->
upd©e_cksum
 = 
rdbLﬂdProgªssCÆlback
;

2058 
rdb
->
max_¥o˚ssög_chunk
 = 
£rvî
.
lﬂdög_¥o˚ss_evíts_öãrvÆ_byãs
;

2059 i‡(
	`rioRód
(
rdb
,
buf
,9Ë=0Ë
eo„º
;

2060 
buf
[9] = '\0';

2061 i‡(
	`memcmp
(
buf
,"REDIS",5) != 0) {

2062 
	`£rvîLog
(
LL_WARNING
,"Wrong signatureÅryingÅoÜoad DB from file");

2063 
î∫o
 = 
EINVAL
;

2064  
C_ERR
;

2066 
rdbvî
 = 
	`©oi
(
buf
+5);

2067 i‡(
rdbvî
 < 1 ||Ñdbvî > 
RDB_VERSION
) {

2068 
	`£rvîLog
(
LL_WARNING
,"C™'àh™dÀ RDB f‹m© vîsi⁄ %d",
rdbvî
);

2069 
î∫o
 = 
EINVAL
;

2070  
C_ERR
;

2074 
Ãu_idÀ
 = -1, 
lfu_‰eq
 = -1, 
expúëime
 = -1, 
now
 = 
	`m°ime
();

2075 
Ãu_˛ock
 = 
	`LRU_CLOCK
();

2078 
sds
 
key
;

2079 
robj
 *
vÆ
;

2082 i‡((
ty≥
 = 
	`rdbLﬂdTy≥
(
rdb
)Ë=-1Ë
eo„º
;

2085 i‡(
ty≥
 =
RDB_OPCODE_EXPIRETIME
) {

2089 
expúëime
 = 
	`rdbLﬂdTime
(
rdb
);

2090 
expúëime
 *= 1000;

2091 i‡(
	`rioGëRódEº‹
(
rdb
)Ë
eo„º
;

2093 } i‡(
ty≥
 =
RDB_OPCODE_EXPIRETIME_MS
) {

2096 
expúëime
 = 
	`rdbLﬂdMûli£c⁄dTime
(
rdb
,
rdbvî
);

2097 i‡(
	`rioGëRódEº‹
(
rdb
)Ë
eo„º
;

2099 } i‡(
ty≥
 =
RDB_OPCODE_FREQ
) {

2101 
uöt8_t
 
byã
;

2102 i‡(
	`rioRód
(
rdb
,&
byã
,1Ë=0Ë
eo„º
;

2103 
lfu_‰eq
 = 
byã
;

2105 } i‡(
ty≥
 =
RDB_OPCODE_IDLE
) {

2107 
uöt64_t
 
qw‹d
;

2108 i‡((
qw‹d
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
Ë
eo„º
;

2109 
Ãu_idÀ
 = 
qw‹d
;

2111 } i‡(
ty≥
 =
RDB_OPCODE_EOF
) {

2114 } i‡(
ty≥
 =
RDB_OPCODE_SELECTDB
) {

2116 i‡((
dbid
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
Ë
eo„º
;

2117 i‡(
dbid
 >()
£rvî
.
dbnum
) {

2118 
	`£rvîLog
(
LL_WARNING
,

2121 "d©aba£s. Exôög\n", 
£rvî
.
dbnum
);

2122 
	`exô
(1);

2124 
db
 = 
£rvî
.db+
dbid
;

2126 } i‡(
ty≥
 =
RDB_OPCODE_RESIZEDB
) {

2129 
uöt64_t
 
db_size
, 
expúes_size
;

2130 i‡((
db_size
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
)

2131 
eo„º
;

2132 i‡((
expúes_size
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
)Ë=
RDB_LENERR
)

2133 
eo„º
;

2134 
	`di˘Ex∑nd
(
db
->
di˘
,
db_size
);

2135 
	`di˘Ex∑nd
(
db
->
expúes
,
expúes_size
);

2137 } i‡(
ty≥
 =
RDB_OPCODE_AUX
) {

2143 
robj
 *
auxkey
, *
auxvÆ
;

2144 i‡((
auxkey
 = 
	`rdbLﬂdSåögObje˘
(
rdb
)Ë=
NULL
Ë
eo„º
;

2145 i‡((
auxvÆ
 = 
	`rdbLﬂdSåögObje˘
(
rdb
)Ë=
NULL
Ë
eo„º
;

2147 i‡(((*)
auxkey
->
±r
)[0] == '%') {

2151 
	`£rvîLog
(
LL_NOTICE
,"RDB '%s': %s",

2152 (*)
auxkey
->
±r
,

2153 (*)
auxvÆ
->
±r
);

2154 } i‡(!
	`°rˇ£cmp
(
auxkey
->
±r
,"repl-stream-db")) {

2155 i‡(
rsi
Ërsi->
ª∂_°ªam_db
 = 
	`©oi
(
auxvÆ
->
±r
);

2156 } i‡(!
	`°rˇ£cmp
(
auxkey
->
±r
,"repl-id")) {

2157 i‡(
rsi
 && 
	`sd¶í
(
auxvÆ
->
±r
Ë=
CONFIG_RUN_ID_SIZE
) {

2158 
	`mem˝y
(
rsi
->
ª∂_id
,
auxvÆ
->
±r
,
CONFIG_RUN_ID_SIZE
+1);

2159 
rsi
->
ª∂_id_is_£t
 = 1;

2161 } i‡(!
	`°rˇ£cmp
(
auxkey
->
±r
,"repl-offset")) {

2162 i‡(
rsi
Ërsi->
ª∂_off£t
 = 
	`°πﬁl
(
auxvÆ
->
±r
,
NULL
,10);

2163 } i‡(!
	`°rˇ£cmp
(
auxkey
->
±r
,"lua")) {

2165 i‡(
	`luaCª©eFun˘i⁄
(
NULL
,
£rvî
.
lua
,
auxvÆ
) == NULL) {

2166 
	`rdbExôRï‹tC‹ru±RDB
(

2168 "BODY: %s", 
auxvÆ
->
±r
);

2170 } i‡(!
	`°rˇ£cmp
(
auxkey
->
±r
,"redis-ver")) {

2171 
	`£rvîLog
(
LL_NOTICE
,"Loading RDBÖroduced by version %s",

2172 (*)
auxvÆ
->
±r
);

2173 } i‡(!
	`°rˇ£cmp
(
auxkey
->
±r
,"ctime")) {

2174 
time_t
 
age
 = 
	`time
(
NULL
)-
	`°πﬁ
(
auxvÆ
->
±r
,NULL,10);

2175 i‡(
age
 < 0)áge = 0;

2176 
	`£rvîLog
(
LL_NOTICE
,"RDBáge %ld seconds",

2177 (Ë
age
);

2178 } i‡(!
	`°rˇ£cmp
(
auxkey
->
±r
,"used-mem")) {

2179 
u£dmem
 = 
	`°πﬁl
(
auxvÆ
->
±r
,
NULL
,10);

2180 
	`£rvîLog
(
LL_NOTICE
,"RDB memory usage when created %.2f Mb",

2181 (Ë
u£dmem
 / (1024*1024));

2182 } i‡(!
	`°rˇ£cmp
(
auxkey
->
±r
,"aof-preamble")) {

2183 
ha•ªambÀ
 = 
	`°πﬁl
(
auxvÆ
->
±r
,
NULL
,10);

2184 i‡(
ha•ªambÀ
Ë
	`£rvîLog
(
LL_NOTICE
,"RDB hasán AOFÅail");

2185 } i‡(!
	`°rˇ£cmp
(
auxkey
->
±r
,"redis-bits")) {

2190 
	`£rvîLog
(
LL_DEBUG
,"Unrecognized RDB AUX field: '%s'",

2191 (*)
auxkey
->
±r
);

2194 
	`de¸RefCou¡
(
auxkey
);

2195 
	`de¸RefCou¡
(
auxvÆ
);

2197 } i‡(
ty≥
 =
RDB_OPCODE_MODULE_AUX
) {

2201 
uöt64_t
 
moduÀid
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

2202 
whí_›code
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

2203 
whí
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

2204 i‡(
	`rioGëRódEº‹
(
rdb
)Ë
eo„º
;

2205 i‡(
whí_›code
 !
RDB_MODULE_OPCODE_UINT
)

2206 
	`rdbRï‹tRódEº‹
("bad when_opcode");

2207 
moduÀTy≥
 *
mt
 = 
	`moduÀTy≥LookupModuÀByID
(
moduÀid
);

2208 
«me
[10];

2209 
	`moduÀTy≥NameByID
(
«me
,
moduÀid
);

2211 i‡(!
rdbCheckMode
 && 
mt
 =
NULL
) {

2213 
	`£rvîLog
(
LL_WARNING
,"ThêRDB fûêc⁄èö†AUX moduÀ d©®I c™'àlﬂd:Çÿm©chög moduÀ '%s'", 
«me
);

2214 
	`exô
(1);

2215 } i‡(!
rdbCheckMode
 && 
mt
 !
NULL
) {

2216 i‡(!
mt
->
aux_lﬂd
) {

2218 
	`£rvîLog
(
LL_WARNING
,"ThêRDB fûêc⁄èö†moduÀ AUX d©a, buàthêmoduÀ '%s' d€¢'à£emÅÿsuµ‹àô.", 
«me
);

2219 
	`exô
(1);

2222 
RedisModuÀIO
 
io
;

2223 
	`moduÀInôIOC⁄ãxt
(
io
,
mt
,
rdb
,
NULL
);

2224 
io
.
vî
 = 2;

2227 i‡(
mt
->
	`aux_lﬂd
(&
io
,
moduÀid
&1023, 
whí
Ë!
REDISMODULE_OK
 || io.
îr‹
) {

2228 
	`moduÀTy≥NameByID
(
«me
,
moduÀid
);

2229 
	`£rvîLog
(
LL_WARNING
,"ThêRDB fûêc⁄èö†moduÀ AUX d©®f‹ÅhêmoduÀÅy≥ '%s',Åh©Åhêª•⁄sibÀ moduÀ i†nŸábÀÅÿlﬂd. Check f‹ moduÀ†logábovêf‹áddôi⁄Æ clues.", 
«me
);

2230 
	`exô
(1);

2232 i‡(
io
.
˘x
) {

2233 
	`moduÀFªeC⁄ãxt
(
io
.
˘x
);

2234 
	`z‰ì
(
io
.
˘x
);

2236 
uöt64_t
 
eof
 = 
	`rdbLﬂdLí
(
rdb
,
NULL
);

2237 i‡(
eof
 !
RDB_MODULE_OPCODE_EOF
) {

2238 
	`£rvîLog
(
LL_WARNING
,"ThêRDB fûêc⁄èö†moduÀ AUX d©®f‹ÅhêmoduÀ '%s'Åh© i†nŸÅîmö©ed byÅhê¥›î moduÀ vÆuêEOF m¨kî", 
«me
);

2239 
	`exô
(1);

2244 
robj
 *
aux
 = 
	`rdbLﬂdCheckModuÀVÆue
(
rdb
,
«me
);

2245 
	`de¸RefCou¡
(
aux
);

2251 i‡((
key
 = 
	`rdbGíîicLﬂdSåögObje˘
(
rdb
,
RDB_LOAD_SDS
,
NULL
)) == NULL)

2252 
eo„º
;

2254 i‡((
vÆ
 = 
	`rdbLﬂdObje˘
(
ty≥
,
rdb
,
key
)Ë=
NULL
) {

2255 
	`sds‰ì
(
key
);

2256 
eo„º
;

2267 i‡(
	`iAmMa°î
() &&

2268 !(
rdbÊags
&
RDBFLAGS_AOF_PREAMBLE
) &&

2269 
expúëime
 !-1 &&Éxpúëimê< 
now
)

2271 
	`sds‰ì
(
key
);

2272 
	`de¸RefCou¡
(
vÆ
);

2274 
robj
 
keyobj
;

2277 
added
 = 
	`dbAddRDBLﬂd
(
db
,
key
,
vÆ
);

2278 i‡(!
added
) {

2279 i‡(
rdbÊags
 & 
RDBFLAGS_ALLOW_DUP
) {

2283 
	`öôSèticSåögObje˘
(
keyobj
,
key
);

2284 
	`dbSyncDñëe
(
db
,&
keyobj
);

2285 
	`dbAddRDBLﬂd
(
db
,
key
,
vÆ
);

2287 
	`£rvîLog
(
LL_WARNING
,

2288 "RDB ha†du∂iˇãd key '%s' i¿DB %d",
key
,
db
->
id
);

2289 
	`£rvîP™ic
("Duplicated key found in RDB file");

2294 i‡(
expúëime
 != -1) {

2295 
	`öôSèticSåögObje˘
(
keyobj
,
key
);

2296 
	`£tExpúe
(
NULL
,
db
,&
keyobj
,
expúëime
);

2300 
	`obje˘SëLRUOrLFU
(
vÆ
,
lfu_‰eq
,
Ãu_idÀ
,
Ãu_˛ock
,1000);

2305 i‡(
£rvî
.
key_lﬂd_dñay
Ë
	`u¶ìp
(server.key_load_delay);

2309 
expúëime
 = -1;

2310 
lfu_‰eq
 = -1;

2311 
Ãu_idÀ
 = -1;

2314 i‡(
rdbvî
 >= 5) {

2315 
uöt64_t
 
cksum
, 
ex≥˘ed
 = 
rdb
->cksum;

2317 i‡(
	`rioRód
(
rdb
,&
cksum
,8Ë=0Ë
eo„º
;

2318 i‡(
£rvî
.
rdb_checksum
) {

2319 
	`memªv64ifbe
(&
cksum
);

2320 i‡(
cksum
 == 0) {

2321 
	`£rvîLog
(
LL_WARNING
,"RDB file was saved with checksum disabled:Ço checkÖerformed.");

2322 } i‡(
cksum
 !
ex≥˘ed
) {

2323 
	`£rvîLog
(
LL_WARNING
,"Wrong RDB checksumÉxpected: (%llx) but "

2325 ()
ex≥˘ed
,

2326 ()
cksum
);

2327 
	`rdbExôRï‹tC‹ru±RDB
("RDB CRCÉrror");

2331  
C_OK
;

2337 
eo„º
:

2338 
	`£rvîLog
(
LL_WARNING
,

2340 
	`rdbRï‹tRódEº‹
("Unexpected EOFÑeading RDB file");

2341  
C_ERR
;

2342 
	}
}

2351 
	$rdbLﬂd
(*
fûíame
, 
rdbSaveInfo
 *
rsi
, 
rdbÊags
) {

2352 
FILE
 *
Â
;

2353 
rio
 
rdb
;

2354 
ªtvÆ
;

2356 i‡((
Â
 = 
	`f›í
(
fûíame
,"r")Ë=
NULL
Ë 
C_ERR
;

2357 
	`°¨tLﬂdögFûe
(
Â
, 
fûíame
,
rdbÊags
);

2358 
	`rioInôWôhFûe
(&
rdb
,
Â
);

2359 
ªtvÆ
 = 
	`rdbLﬂdRio
(&
rdb
,
rdbÊags
,
rsi
);

2360 
	`f˛o£
(
Â
);

2361 
	`°›Lﬂdög
(
ªtvÆ
==
C_OK
);

2362  
ªtvÆ
;

2363 
	}
}

2367 
	$backgroundSaveD⁄eH™dÀrDisk
(
exôcode
, 
bysig«l
) {

2368 i‡(!
bysig«l
 && 
exôcode
 == 0) {

2369 
	`£rvîLog
(
LL_NOTICE
,

2371 
£rvî
.
dúty
 = sîvî.dúty - sîvî.
dúty_bef‹e_bgßve
;

2372 
£rvî
.
œ°ßve
 = 
	`time
(
NULL
);

2373 
£rvî
.
œ°bgßve_°©us
 = 
C_OK
;

2374 } i‡(!
bysig«l
 && 
exôcode
 != 0) {

2375 
	`£rvîLog
(
LL_WARNING
, "Background savingÉrror");

2376 
£rvî
.
œ°bgßve_°©us
 = 
C_ERR
;

2378 
m°ime_t
 
œãncy
;

2380 
	`£rvîLog
(
LL_WARNING
,

2381 "Background savögÅîmö©ed by sig«»%d", 
bysig«l
);

2382 
	`œãncySèπM⁄ô‹
(
œãncy
);

2383 
	`rdbRemoveTempFûe
(
£rvî
.
rdb_chûd_pid
);

2384 
	`œãncyEndM⁄ô‹
(
œãncy
);

2385 
	`œãncyAddSam∂eIfNìded
("rdb-u∆ök-ãmp-fûe",
œãncy
);

2388 i‡(
bysig«l
 !
SIGUSR1
)

2389 
£rvî
.
œ°bgßve_°©us
 = 
C_ERR
;

2391 
£rvî
.
rdb_chûd_pid
 = -1;

2392 
£rvî
.
rdb_chûd_ty≥
 = 
RDB_CHILD_TYPE_NONE
;

2393 
£rvî
.
rdb_ßve_time_œ°
 = 
	`time
(
NULL
)-£rvî.
rdb_ßve_time_°¨t
;

2394 
£rvî
.
rdb_ßve_time_°¨t
 = -1;

2397 
	`upd©eSœvesWaôögBgßve
((!
bysig«l
 && 
exôcode
 =0Ë? 
C_OK
 : 
C_ERR
, 
RDB_CHILD_TYPE_DISK
);

2398 
	}
}

2403 
	$backgroundSaveD⁄eH™dÀrSockë
(
exôcode
, 
bysig«l
) {

2404 i‡(!
bysig«l
 && 
exôcode
 == 0) {

2405 
	`£rvîLog
(
LL_NOTICE
,

2407 } i‡(!
bysig«l
 && 
exôcode
 != 0) {

2408 
	`£rvîLog
(
LL_WARNING
, "BackgroundÅransferÉrror");

2410 
	`£rvîLog
(
LL_WARNING
,

2411 "BackgroundÅøns„∏ãrmö©ed by sig«»%d", 
bysig«l
);

2413 
£rvî
.
rdb_chûd_pid
 = -1;

2414 
£rvî
.
rdb_chûd_ty≥
 = 
RDB_CHILD_TYPE_NONE
;

2415 
£rvî
.
rdb_ßve_time_°¨t
 = -1;

2417 
	`upd©eSœvesWaôögBgßve
((!
bysig«l
 && 
exôcode
 =0Ë? 
C_OK
 : 
C_ERR
, 
RDB_CHILD_TYPE_SOCKET
);

2418 
	}
}

2421 
	$backgroundSaveD⁄eH™dÀr
(
exôcode
, 
bysig«l
) {

2422 
£rvî
.
rdb_chûd_ty≥
) {

2423 
RDB_CHILD_TYPE_DISK
:

2424 
	`backgroundSaveD⁄eH™dÀrDisk
(
exôcode
,
bysig«l
);

2426 
RDB_CHILD_TYPE_SOCKET
:

2427 
	`backgroundSaveD⁄eH™dÀrSockë
(
exôcode
,
bysig«l
);

2430 
	`£rvîP™ic
("Unknown RDB childÅype.");

2433 
	}
}

2438 
	$kûlRDBChûd
() {

2439 
	`kûl
(
£rvî
.
rdb_chûd_pid
,
SIGUSR1
);

2440 
	`rdbRemoveTempFûe
(
£rvî
.
rdb_chûd_pid
);

2441 
	`˛o£ChûdInfoPùe
();

2442 
	`upd©eDi˘ResizePﬁicy
();

2443 
	}
}

2447 
	$rdbSaveToSœvesSockës
(
rdbSaveInfo
 *
rsi
) {

2448 
li°Node
 *
 
;

2449 
li°Iãr
 
li
;

2450 
pid_t
 
chûdpid
;

2451 
pùefds
[2];

2453 i‡(
	`hasA˘iveChûdPro˚ss
()Ë 
C_ERR
;

2457 i‡(
£rvî
.
rdb_pùe_c⁄ns
Ë 
C_ERR
;

2463 i‡(
	`pùe
(
pùefds
Ë=-1Ë 
C_ERR
;

2464 
£rvî
.
rdb_pùe_ªad
 = 
pùefds
[0];

2465 
£rvî
.
rdb_pùe_wrôe
 = 
pùefds
[1];

2466 
	`™ëN⁄Block
(
NULL
, 
£rvî
.
rdb_pùe_ªad
);

2470 
£rvî
.
rdb_pùe_c⁄ns
 = 
	`zmÆloc
((
c⁄√˘i⁄
 *)*
	`li°Lígth
(£rvî.
¶aves
));

2471 
£rvî
.
rdb_pùe_numc⁄ns
 = 0;

2472 
£rvî
.
rdb_pùe_numc⁄ns_wrôög
 = 0;

2473 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

2474 (
 
 = 
	`li°Next
(&
li
))) {

2475 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

2476 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
) {

2477 
£rvî
.
rdb_pùe_c⁄ns
[£rvî.
rdb_pùe_numc⁄ns
++] = 
¶ave
->
c⁄n
;

2478 
	`ª∂iˇti⁄SëupSœveF‹FuŒResync
(
¶ave
,
	`gëPsyncInôülOff£t
());

2483 
	`›íChûdInfoPùe
();

2484 i‡((
chûdpid
 = 
	`ªdisF‹k
()) == 0) {

2486 
ªtvÆ
;

2487 
rio
 
rdb
;

2489 
	`rioInôWôhFd
(&
rdb
,
£rvî
.
rdb_pùe_wrôe
);

2491 
	`ªdisSëProcTôÀ
("redis-rdb-to-slaves");

2492 
	`ªdisSëCpuAfföôy
(
£rvî
.
bgßve_˝uli°
);

2494 
ªtvÆ
 = 
	`rdbSaveRioWôhEOFM¨k
(&
rdb
,
NULL
,
rsi
);

2495 i‡(
ªtvÆ
 =
C_OK
 && 
	`rioFlush
(&
rdb
) == 0)

2496 
ªtvÆ
 = 
C_ERR
;

2498 i‡(
ªtvÆ
 =
C_OK
) {

2499 
	`£ndChûdCOWInfo
(
CHILD_INFO_TYPE_RDB
, "RDB");

2502 
	`rioFªeFd
(&
rdb
);

2503 
	`˛o£
(
£rvî
.
rdb_pùe_wrôe
);

2504 
	`exôFromChûd
((
ªtvÆ
 =
C_OK
) ? 0 : 1);

2507 i‡(
chûdpid
 == -1) {

2508 
	`£rvîLog
(
LL_WARNING
,"Can't save in background: fork: %s",

2509 
	`°ªº‹
(
î∫o
));

2514 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

2515 (
 
 = 
	`li°Next
(&
li
))) {

2516 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

2517 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_END
) {

2518 
¶ave
->
ª∂°©e
 = 
SLAVE_STATE_WAIT_BGSAVE_START
;

2521 
	`˛o£
(
£rvî
.
rdb_pùe_wrôe
);

2522 
	`˛o£
(
£rvî
.
rdb_pùe_ªad
);

2523 
	`z‰ì
(
£rvî
.
rdb_pùe_c⁄ns
);

2524 
£rvî
.
rdb_pùe_c⁄ns
 = 
NULL
;

2525 
£rvî
.
rdb_pùe_numc⁄ns
 = 0;

2526 
£rvî
.
rdb_pùe_numc⁄ns_wrôög
 = 0;

2527 
	`˛o£ChûdInfoPùe
();

2529 
	`£rvîLog
(
LL_NOTICE
,"Background RDBÅransfer started byÖid %d",

2530 
chûdpid
);

2531 
£rvî
.
rdb_ßve_time_°¨t
 = 
	`time
(
NULL
);

2532 
£rvî
.
rdb_chûd_pid
 = 
chûdpid
;

2533 
£rvî
.
rdb_chûd_ty≥
 = 
RDB_CHILD_TYPE_SOCKET
;

2534 
	`˛o£
(
£rvî
.
rdb_pùe_wrôe
);

2535 i‡(
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, sîvî.
rdb_pùe_ªad
, 
AE_READABLE
, 
rdbPùeRódH™dÀr
,
NULL
Ë=
AE_ERR
) {

2536 
	`£rvîP™ic
("UnrecoverableÉrror creating server.rdb_pipe_read fileÉvent.");

2539  (
chûdpid
 =-1Ë? 
C_ERR
 : 
C_OK
;

2541  
C_OK
;

2542 
	}
}

2544 
	$ßveComm™d
(
˛õ¡
 *
c
) {

2545 i‡(
£rvî
.
rdb_chûd_pid
 != -1) {

2546 
	`addRïlyEº‹
(
c
,"Background saveálready inÖrogress");

2549 
rdbSaveInfo
 
rsi
, *
rsùå
;

2550 
rsùå
 = 
	`rdbP›uœãSaveInfo
(&
rsi
);

2551 i‡(
	`rdbSave
(
£rvî
.
rdb_fûíame
,
rsùå
Ë=
C_OK
) {

2552 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2554 
	`addRïly
(
c
,
sh¨ed
.
îr
);

2556 
	}
}

2559 
	$bgßveComm™d
(
˛õ¡
 *
c
) {

2560 
scheduÀ
 = 0;

2564 i‡(
c
->
¨gc
 > 1) {

2565 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"schedule")) {

2566 
scheduÀ
 = 1;

2568 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2573 
rdbSaveInfo
 
rsi
, *
rsùå
;

2574 
rsùå
 = 
	`rdbP›uœãSaveInfo
(&
rsi
);

2576 i‡(
£rvî
.
rdb_chûd_pid
 != -1) {

2577 
	`addRïlyEº‹
(
c
,"Background saveálready inÖrogress");

2578 } i‡(
	`hasA˘iveChûdPro˚ss
()) {

2579 i‡(
scheduÀ
) {

2580 
£rvî
.
rdb_bgßve_scheduÀd
 = 1;

2581 
	`addRïlySètus
(
c
,"Background saving scheduled");

2583 
	`addRïlyEº‹
(
c
,

2588 } i‡(
	`rdbSaveBackground
(
£rvî
.
rdb_fûíame
,
rsùå
Ë=
C_OK
) {

2589 
	`addRïlySètus
(
c
,"Background saving started");

2591 
	`addRïly
(
c
,
sh¨ed
.
îr
);

2593 
	}
}

2604 
rdbSaveInfo
 *
	$rdbP›uœãSaveInfo
(
rdbSaveInfo
 *
rsi
) {

2605 
rdbSaveInfo
 
rsi_öô
 = 
RDB_SAVE_INFO_INIT
;

2606 *
rsi
 = 
rsi_öô
;

2615 i‡(!
£rvî
.
ma°îho°
 && sîvî.
ª∂_backlog
) {

2621 
rsi
->
ª∂_°ªam_db
 = 
£rvî
.
¶ave£ldb
 == -1 ? 0 : server.slaveseldb;

2622  
rsi
;

2627 i‡(
£rvî
.
ma°î
) {

2628 
rsi
->
ª∂_°ªam_db
 = 
£rvî
.
ma°î
->
db
->
id
;

2629  
rsi
;

2637 i‡(
£rvî
.
ˇched_ma°î
) {

2638 
rsi
->
ª∂_°ªam_db
 = 
£rvî
.
ˇched_ma°î
->
db
->
id
;

2639  
rsi
;

2641  
NULL
;

2642 
	}
}

	@rdb.h

30 #i‚de‡
__RDB_H


31 
	#__RDB_H


	)

33 
	~<°dio.h
>

34 
	~"rio.h
"

37 
	~"£rvî.h
"

41 
	#RDB_VERSION
 9

	)

57 
	#RDB_6BITLEN
 0

	)

58 
	#RDB_14BITLEN
 1

	)

59 
	#RDB_32BITLEN
 0x80

	)

60 
	#RDB_64BITLEN
 0x81

	)

61 
	#RDB_ENCVAL
 3

	)

62 
	#RDB_LENERR
 
UINT64_MAX


	)

67 
	#RDB_ENC_INT8
 0

	)

68 
	#RDB_ENC_INT16
 1

	)

69 
	#RDB_ENC_INT32
 2

	)

70 
	#RDB_ENC_LZF
 3

	)

75 
	#RDB_TYPE_STRING
 0

	)

76 
	#RDB_TYPE_LIST
 1

	)

77 
	#RDB_TYPE_SET
 2

	)

78 
	#RDB_TYPE_ZSET
 3

	)

79 
	#RDB_TYPE_HASH
 4

	)

80 
	#RDB_TYPE_ZSET_2
 5

	)

81 
	#RDB_TYPE_MODULE
 6

	)

82 
	#RDB_TYPE_MODULE_2
 7

	)

87 
	#RDB_TYPE_HASH_ZIPMAP
 9

	)

88 
	#RDB_TYPE_LIST_ZIPLIST
 10

	)

89 
	#RDB_TYPE_SET_INTSET
 11

	)

90 
	#RDB_TYPE_ZSET_ZIPLIST
 12

	)

91 
	#RDB_TYPE_HASH_ZIPLIST
 13

	)

92 
	#RDB_TYPE_LIST_QUICKLIST
 14

	)

93 
	#RDB_TYPE_STREAM_LISTPACKS
 15

	)

97 
	#rdbIsObje˘Ty≥
(
t
Ë(— >0 &&Å <7Ë|| (à>9 &&Å <15))

	)

100 
	#RDB_OPCODE_MODULE_AUX
 247

	)

101 
	#RDB_OPCODE_IDLE
 248

	)

102 
	#RDB_OPCODE_FREQ
 249

	)

103 
	#RDB_OPCODE_AUX
 250

	)

104 
	#RDB_OPCODE_RESIZEDB
 251

	)

105 
	#RDB_OPCODE_EXPIRETIME_MS
 252

	)

106 
	#RDB_OPCODE_EXPIRETIME
 253

	)

107 
	#RDB_OPCODE_SELECTDB
 254

	)

108 
	#RDB_OPCODE_EOF
 255

	)

111 
	#RDB_MODULE_OPCODE_EOF
 0

	)

112 
	#RDB_MODULE_OPCODE_SINT
 1

	)

113 
	#RDB_MODULE_OPCODE_UINT
 2

	)

114 
	#RDB_MODULE_OPCODE_FLOAT
 3

	)

115 
	#RDB_MODULE_OPCODE_DOUBLE
 4

	)

116 
	#RDB_MODULE_OPCODE_STRING
 5

	)

119 
	#RDB_LOAD_NONE
 0

	)

120 
	#RDB_LOAD_ENC
 (1<<0)

	)

121 
	#RDB_LOAD_PLAIN
 (1<<1)

	)

122 
	#RDB_LOAD_SDS
 (1<<2)

	)

125 
	#RDBFLAGS_NONE
 0

	)

126 
	#RDBFLAGS_AOF_PREAMBLE
 (1<<0Ë

	)

127 
	#RDBFLAGS_REPLICATION
 (1<<1Ë

	)

128 
	#RDBFLAGS_ALLOW_DUP
 (1<<2Ë

	)

130 
rdbSaveTy≥
(
rio
 *
rdb
, 
ty≥
);

131 
rdbLﬂdTy≥
(
rio
 *
rdb
);

132 
rdbSaveTime
(
rio
 *
rdb
, 
time_t
 
t
);

133 
time_t
 
rdbLﬂdTime
(
rio
 *
rdb
);

134 
rdbSaveLí
(
rio
 *
rdb
, 
uöt64_t
 
Àn
);

135 
rdbSaveMûli£c⁄dTime
(
rio
 *
rdb
, 
t
);

136 
rdbLﬂdMûli£c⁄dTime
(
rio
 *
rdb
, 
rdbvî
);

137 
uöt64_t
 
rdbLﬂdLí
(
rio
 *
rdb
, *
i£ncoded
);

138 
rdbLﬂdLíByRef
(
rio
 *
rdb
, *
i£ncoded
, 
uöt64_t
 *
À≈å
);

139 
rdbSaveObje˘Ty≥
(
rio
 *
rdb
, 
robj
 *
o
);

140 
rdbLﬂdObje˘Ty≥
(
rio
 *
rdb
);

141 
rdbLﬂd
(*
fûíame
, 
rdbSaveInfo
 *
rsi
, 
rdbÊags
);

142 
rdbSaveBackground
(*
fûíame
, 
rdbSaveInfo
 *
rsi
);

143 
rdbSaveToSœvesSockës
(
rdbSaveInfo
 *
rsi
);

144 
rdbRemoveTempFûe
(
pid_t
 
chûdpid
);

145 
rdbSave
(*
fûíame
, 
rdbSaveInfo
 *
rsi
);

146 
ssize_t
 
rdbSaveObje˘
(
rio
 *
rdb
, 
robj
 *
o
,Ñobj *
key
);

147 
size_t
 
rdbSavedObje˘Lí
(
robj
 *
o
,Ñobj *
key
);

148 
robj
 *
rdbLﬂdObje˘
(
ty≥
, 
rio
 *
rdb
, 
sds
 
key
);

149 
backgroundSaveD⁄eH™dÀr
(
exôcode
, 
bysig«l
);

150 
rdbSaveKeyVÆuePaú
(
rio
 *
rdb
, 
robj
 *
key
,Ñobj *
vÆ
, 
expúëime
);

151 
ssize_t
 
rdbSaveSögÀModuÀAux
(
rio
 *
rdb
, 
whí
, 
moduÀTy≥
 *
mt
);

152 
robj
 *
rdbLﬂdSåögObje˘
(
rio
 *
rdb
);

153 
ssize_t
 
rdbSaveSåögObje˘
(
rio
 *
rdb
, 
robj
 *
obj
);

154 
ssize_t
 
rdbSaveRawSåög
(
rio
 *
rdb
, *
s
, 
size_t
 
Àn
);

155 *
rdbGíîicLﬂdSåögObje˘
(
rio
 *
rdb
, 
Êags
, 
size_t
 *
À≈å
);

156 
rdbSaveBö¨yDoubÀVÆue
(
rio
 *
rdb
, 
vÆ
);

157 
rdbLﬂdBö¨yDoubÀVÆue
(
rio
 *
rdb
, *
vÆ
);

158 
rdbSaveBö¨yFlﬂtVÆue
(
rio
 *
rdb
, 
vÆ
);

159 
rdbLﬂdBö¨yFlﬂtVÆue
(
rio
 *
rdb
, *
vÆ
);

160 
rdbLﬂdRio
(
rio
 *
rdb
, 
rdbÊags
, 
rdbSaveInfo
 *
rsi
);

161 
rdbSaveRio
(
rio
 *
rdb
, *
îr‹
, 
rdbÊags
, 
rdbSaveInfo
 *
rsi
);

162 
rdbSaveInfo
 *
rdbP›uœãSaveInfo
‘dbSaveInfÿ*
rsi
);

	@redis-benchmark.c

31 
	~"fma¸os.h
"

33 
	~<°dio.h
>

34 
	~<°rög.h
>

35 
	~<°dlib.h
>

36 
	~<uni°d.h
>

37 
	~<î∫o.h
>

38 
	~<time.h
>

39 
	~<sys/time.h
>

40 
	~<sig«l.h
>

41 
	~<as£π.h
>

42 
	~<m©h.h
>

43 
	~<±hªad.h
>

45 
	~<sds.h
>

46 
	~"´.h
"

47 
	~"húedis.h
"

48 
	~"adli°.h
"

49 
	~"di˘.h
"

50 
	~"zmÆloc.h
"

51 
	~"©omicv¨.h
"

52 
	~"¸c16_¶ŸèbÀ.h
"

54 
	#UNUSED
(
V
Ë((ËV)

	)

55 
	#RANDPTR_INITIAL_SIZE
 8

	)

56 
	#MAX_LATENCY_PRECISION
 3

	)

57 
	#MAX_THREADS
 500

	)

58 
	#CLUSTER_SLOTS
 16384

	)

60 
	#CLIENT_GET_EVENTLOOP
(
c
) \

61 (
c
->
thªad_id
 >0 ? 
c⁄fig
.
thªads
[c->thªad_id]->
ñ
 : c⁄fig.ñ)

	)

63 
	gbíchm¨kThªad
;

64 
	g˛u°îNode
;

65 
	gªdisC⁄fig
;

67 
	sc⁄fig
 {

68 
´EvítLo›
 *
	mñ
;

69 c⁄° *
	mho°ù
;

70 
	mho°p‹t
;

71 c⁄° *
	mho°sockë
;

72 
	mnum˛õ¡s
;

73 
	mlive˛õ¡s
;

74 
	mªque°s
;

75 
	mªque°s_issued
;

76 
	mªque°s_föished
;

77 
	mkeysize
;

78 
	md©asize
;

79 
	møndomkeys
;

80 
	møndomkeys_key•a˚Àn
;

81 
	mkì∑live
;

82 
	mpùñöe
;

83 
	mshowîr‹s
;

84 
	m°¨t
;

85 
	mtŸœãncy
;

86 *
	mœãncy
;

87 c⁄° *
	mtôÀ
;

88 
li°
 *
	m˛õ¡s
;

89 
	mquõt
;

90 
	mcsv
;

91 
	mlo›
;

92 
	midÀmode
;

93 
	mdbnum
;

94 
sds
 
	mdbnum°r
;

95 *
	mã°s
;

96 *
	mauth
;

97 c⁄° *
	mu£r
;

98 
	m¥ecisi⁄
;

99 
	mnum_thªads
;

100 
bíchm¨kThªad
 **
	mthªads
;

101 
	m˛u°î_mode
;

102 
	m˛u°î_node_cou¡
;

103 
˛u°îNode
 **
	m˛u°î_nodes
;

104 
ªdisC⁄fig
 *
	mªdis_c⁄fig
;

105 
	mis_„tchög_¶Ÿs
;

106 
	mis_upd©ög_¶Ÿs
;

107 
	m¶Ÿs_œ°_upd©e
;

108 
	míabÀ_åackög
;

110 
±hªad_muãx_t
 
	mªque°s_issued_muãx
;

111 
±hªad_muãx_t
 
	mªque°s_föished_muãx
;

112 
±hªad_muãx_t
 
	mlive˛õ¡s_muãx
;

113 
±hªad_muãx_t
 
	mis_„tchög_¶Ÿs_muãx
;

114 
±hªad_muãx_t
 
	mis_upd©ög_¶Ÿs_muãx
;

115 
±hªad_muãx_t
 
	mupd©ög_¶Ÿs_muãx
;

116 
±hªad_muãx_t
 
	m¶Ÿs_œ°_upd©e_muãx
;

117 } 
	gc⁄fig
;

119 
	s_˛õ¡
 {

120 
ªdisC⁄ãxt
 *
	mc⁄ãxt
;

121 
sds
 
	mobuf
;

122 **
	mønd±r
;

123 
size_t
 
	møndÀn
;

124 
size_t
 
	mønd‰ì
;

125 **
	m°ag±r
;

126 
size_t
 
	m°agÀn
;

127 
size_t
 
	m°ag‰ì
;

128 
size_t
 
	mwrôãn
;

129 
	m°¨t
;

130 
	mœãncy
;

131 
	m≥ndög
;

132 
	m¥efix_≥ndög
;

135 
	m¥efixÀn
;

136 
	mthªad_id
;

137 
˛u°îNode
 *
	m˛u°î_node
;

138 
	m¶Ÿs_œ°_upd©e
;

139 } *
	t˛õ¡
;

143 
	sbíchm¨kThªad
 {

144 
	mödex
;

145 
±hªad_t
 
	mthªad
;

146 
´EvítLo›
 *
	mñ
;

147 } 
	tbíchm¨kThªad
;

150 
	s˛u°îNode
 {

151 *
	mù
;

152 
	mp‹t
;

153 
sds
 
	m«me
;

154 
	mÊags
;

155 
sds
 
	mª∂iˇã
;

156 *
	m¶Ÿs
;

157 
	m¶Ÿs_cou¡
;

158 
	mcuºít_¶Ÿ_ödex
;

159 *
	mupd©ed_¶Ÿs
;

160 
	mupd©ed_¶Ÿs_cou¡
;

161 
	mª∂iˇs_cou¡
;

162 
sds
 *
	mmigøtög
;

164 
sds
 *
	mimp‹tög
;

166 
	mmigøtög_cou¡
;

167 
	mimp‹tög_cou¡
;

168 
ªdisC⁄fig
 *
	mªdis_c⁄fig
;

169 } 
	t˛u°îNode
;

171 
	sªdisC⁄fig
 {

172 
sds
 
	mßve
;

173 
sds
 
	m≠≥nd⁄ly
;

174 } 
	tªdisC⁄fig
;

177 
wrôeH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
);

178 
¸óãMissögClõ¡s
(
˛õ¡
 
c
);

179 
bíchm¨kThªad
 *
¸óãBíchm¨kThªad
(
ödex
);

180 
‰ìBíchm¨kThªad
(
bíchm¨kThªad
 *
thªad
);

181 
‰ìBíchm¨kThªads
();

182 *
execBíchm¨kThªad
(*
±r
);

183 
˛u°îNode
 *
¸óãClu°îNode
(*
ù
, 
p‹t
);

184 
ªdisC⁄fig
 *
gëRedisC⁄fig
(c⁄° *
ù
, 
p‹t
,

185 c⁄° *
ho°sockë
);

186 
‰ìRedisC⁄fig
(
ªdisC⁄fig
 *
cfg
);

187 
„tchClu°îSlŸsC⁄figuøti⁄
(
˛õ¡
 
c
);

188 
upd©eClu°îSlŸsC⁄figuøti⁄
();

189 
showThroughput
(
´EvítLo›
 *
evítLo›
, 
id
,

190 *
˛õ¡D©a
);

193 
uöt64_t
 
di˘SdsHash
(c⁄° *
key
);

194 
di˘SdsKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
,

195 c⁄° *
key2
);

198 
	$u°ime
() {

199 
timevÆ
 
tv
;

200 
u°
;

202 
	`gëtimeofday
(&
tv
, 
NULL
);

203 
u°
 = (()
tv
.
tv_£c
)*1000000;

204 
u°
 +
tv
.
tv_u£c
;

205  
u°
;

206 
	}
}

208 
	$m°ime
() {

209 
timevÆ
 
tv
;

210 
m°
;

212 
	`gëtimeofday
(&
tv
, 
NULL
);

213 
m°
 = (()
tv
.
tv_£c
)*1000;

214 
m°
 +
tv
.
tv_u£c
/1000;

215  
m°
;

216 
	}
}

218 
uöt64_t
 
	$di˘SdsHash
(c⁄° *
key
) {

219  
	`di˘GíHashFun˘i⁄
((*)
key
, 
	`sd¶í
((*)key));

220 
	}
}

222 
	$di˘SdsKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
,

223 c⁄° *
key2
)

225 
l1
,
l2
;

226 
	`DICT_NOTUSED
(
¥ivd©a
);

228 
l1
 = 
	`sd¶í
((
sds
)
key1
);

229 
l2
 = 
	`sd¶í
((
sds
)
key2
);

230 i‡(
l1
 !
l2
)  0;

231  
	`memcmp
(
key1
, 
key2
, 
l1
) == 0;

232 
	}
}

235 
	$_£rvîAs£π
(c⁄° *
e°r
, c⁄° *
fûe
, 
löe
) {

236 
	`Ârötf
(
°dîr
, "=== ASSERTION FAILED ===");

237 
	`Ârötf
(
°dîr
, "==> %s:%d '%s' i†nŸÅrue",
fûe
,
löe
,
e°r
);

239 
	}
}

241 
ªdisC⁄fig
 *
	$gëRedisC⁄fig
(c⁄° *
ù
, 
p‹t
,

242 c⁄° *
ho°sockë
)

244 
ªdisC⁄fig
 *
cfg
 = 
	`zˇŒoc
((*cfg));

245 i‡(!
cfg
Ë 
NULL
;

246 
ªdisC⁄ãxt
 *
c
 = 
NULL
;

247 
ªdisRïly
 *
ª∂y
 = 
NULL
, *
sub_ª∂y
 = NULL;

248 i‡(
ho°sockë
 =
NULL
)

249 
c
 = 
	`ªdisC⁄√˘
(
ù
, 
p‹t
);

251 
c
 = 
	`ªdisC⁄√˘Unix
(
ho°sockë
);

252 i‡(
c
 =
NULL
 || c->
îr
) {

253 
	`Ârötf
(
°dîr
,"CouldÇot connectÅo Redisát ");

254 *
îr
 = (
c
 !
NULL
 ? c->
îr°r
 : "");

255 i‡(
ho°sockë
 =
NULL
Ë
	`Ârötf
(
°dîr
,"%s:%d: %s\n",
ù
,
p‹t
,
îr
);

256 
	`Ârötf
(
°dîr
,"%s: %s\n",
ho°sockë
,
îr
);

257 
Áû
;

260 if(
c⁄fig
.
auth
) {

261 *
authRïly
 = 
NULL
;

262 i‡(
c⁄fig
.
u£r
 =
NULL
)

263 
	`ªdisAµídComm™d
(
c
, "AUTH %s", 
c⁄fig
.
auth
);

265 
	`ªdisAµídComm™d
(
c
, "AUTH %†%s", 
c⁄fig
.
u£r
, c⁄fig.
auth
);

266 i‡(
REDIS_OK
 !
	`ªdisGëRïly
(
c
, &
authRïly
)Ë
Áû
;

267 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

268 
ª∂y
 = ((
ªdisRïly
 *Ë
authRïly
);

269 i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

270 
	`Ârötf
(
°dîr
, "ERROR: %s\n", 
ª∂y
->
°r
);

271 
Áû
;

275 
	`ªdisAµídComm™d
(
c
, "CONFIG GET %s", "save");

276 
	`ªdisAµídComm™d
(
c
, "CONFIG GET %s", "appendonly");

277 
i
 = 0;

278 *
r
 = 
NULL
;

279 ; 
i
 < 2; i++) {

280 
ªs
 = 
	`ªdisGëRïly
(
c
, &
r
);

281 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

282 
ª∂y
 = 
ªs
 =
REDIS_OK
 ? ((
ªdisRïly
 *Ë
r
Ë: 
NULL
;

283 i‡(
ªs
 !
REDIS_OK
 || !
r
Ë
Áû
;

284 i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

285 
	`Ârötf
(
°dîr
, "ERROR: %s\n", 
ª∂y
->
°r
);

286 
Áû
;

288 i‡(
ª∂y
->
ty≥
 !
REDIS_REPLY_ARRAY
 ||Ñïly->
ñemíts
 < 2Ë
Áû
;

289 
sub_ª∂y
 = 
ª∂y
->
ñemít
[1];

290 *
vÆue
 = 
sub_ª∂y
->
°r
;

291 i‡(!
vÆue
) value = "";

292 
i
) {

293 0: 
cfg
->
ßve
 = 
	`sd¢ew
(
vÆue
); ;

294 1: 
cfg
->
≠≥nd⁄ly
 = 
	`sd¢ew
(
vÆue
); ;

297 
	`‰ìRïlyObje˘
(
ª∂y
);

298 
	`ªdisFªe
(
c
);

299  
cfg
;

300 
Áû
:

301 
	`Ârötf
(
°dîr
, "ERROR: failedÅo fetch CONFIG from ");

302 i‡(
ho°sockë
 =
NULL
Ë
	`Ârötf
(
°dîr
, "%s:%d\n", 
ù
, 
p‹t
);

303 
	`Ârötf
(
°dîr
, "%s\n", 
ho°sockë
);

304 
	`‰ìRïlyObje˘
(
ª∂y
);

305 
	`ªdisFªe
(
c
);

306 
	`z‰ì
(
cfg
);

307  
NULL
;

308 
	}
}

309 
	$‰ìRedisC⁄fig
(
ªdisC⁄fig
 *
cfg
) {

310 i‡(
cfg
->
ßve
Ë
	`sds‰ì
(cfg->save);

311 i‡(
cfg
->
≠≥nd⁄ly
Ë
	`sds‰ì
(cfg->appendonly);

312 
	`z‰ì
(
cfg
);

313 
	}
}

315 
	$‰ìClõ¡
(
˛õ¡
 
c
) {

316 
´EvítLo›
 *
ñ
 = 
	`CLIENT_GET_EVENTLOOP
(
c
);

317 
li°Node
 *
 
;

318 
	`´DñëeFûeEvít
(
ñ
,
c
->
c⁄ãxt
->
fd
,
AE_WRITABLE
);

319 
	`´DñëeFûeEvít
(
ñ
,
c
->
c⁄ãxt
->
fd
,
AE_READABLE
);

320 i‡(
c
->
thªad_id
 >= 0) {

321 
ªque°s_föished
 = 0;

322 
	`©omicGë
(
c⁄fig
.
ªque°s_föished
,Ñequests_finished);

323 i‡(
ªque°s_föished
 >
c⁄fig
.
ªque°s
) {

324 
	`´St›
(
ñ
);

327 
	`ªdisFªe
(
c
->
c⁄ãxt
);

328 
	`sds‰ì
(
c
->
obuf
);

329 
	`z‰ì
(
c
->
ønd±r
);

330 
	`z‰ì
(
c
->
°ag±r
);

331 
	`z‰ì
(
c
);

332 i‡(
c⁄fig
.
num_thªads
Ë
	`±hªad_muãx_lock
(&(c⁄fig.
live˛õ¡s_muãx
));

333 
c⁄fig
.
live˛õ¡s
--;

334 
 
 = 
	`li°SórchKey
(
c⁄fig
.
˛õ¡s
,
c
);

335 
	`as£π
(
 
 !
NULL
);

336 
	`li°DñNode
(
c⁄fig
.
˛õ¡s
,
 
);

337 i‡(
c⁄fig
.
num_thªads
Ë
	`±hªad_muãx_u∆ock
(&(c⁄fig.
live˛õ¡s_muãx
));

338 
	}
}

340 
	$‰ìAŒClõ¡s
() {

341 
li°Node
 *
 
 = 
c⁄fig
.
˛õ¡s
->
hód
, *
√xt
;

343 
 
) {

344 
√xt
 = 
 
->next;

345 
	`‰ìClõ¡
(
 
->
vÆue
);

346 
 
 = 
√xt
;

348 
	}
}

350 
	$ª£tClõ¡
(
˛õ¡
 
c
) {

351 
´EvítLo›
 *
ñ
 = 
	`CLIENT_GET_EVENTLOOP
(
c
);

352 
	`´DñëeFûeEvít
(
ñ
,
c
->
c⁄ãxt
->
fd
,
AE_WRITABLE
);

353 
	`´DñëeFûeEvít
(
ñ
,
c
->
c⁄ãxt
->
fd
,
AE_READABLE
);

354 
	`´Cª©eFûeEvít
(
ñ
,
c
->
c⁄ãxt
->
fd
,
AE_WRITABLE
,
wrôeH™dÀr
,c);

355 
c
->
wrôãn
 = 0;

356 
c
->
≥ndög
 = 
c⁄fig
.
pùñöe
;

357 
	}
}

359 
	$øndomizeClõ¡Key
(
˛õ¡
 
c
) {

360 
size_t
 
i
;

362 
i
 = 0; i < 
c
->
øndÀn
; i++) {

363 *
p
 = 
c
->
ønd±r
[
i
]+11;

364 
size_t
 
r
 = 0;

365 i‡(
c⁄fig
.
øndomkeys_key•a˚Àn
 != 0)

366 
r
 = 
	`øndom
(Ë% 
c⁄fig
.
øndomkeys_key•a˚Àn
;

367 
size_t
 
j
;

369 
j
 = 0; j < 12; j++) {

370 *
p
 = '0'+
r
%10;

371 
r
/=10;

372 
p
--;

375 
	}
}

377 
	$£tClu°îKeyHashTag
(
˛õ¡
 
c
) {

378 
	`as£π
(
c
->
thªad_id
 >= 0);

379 
˛u°îNode
 *
node
 = 
c
->
˛u°î_node
;

380 
	`as£π
(
node
);

381 
	`as£π
(
node
->
cuºít_¶Ÿ_ödex
 <Çode->
¶Ÿs_cou¡
);

382 
is_upd©ög_¶Ÿs
 = 0;

383 
	`©omicGë
(
c⁄fig
.
is_upd©ög_¶Ÿs
, is_updating_slots);

390 i‡(
is_upd©ög_¶Ÿs
Ë
	`upd©eClu°îSlŸsC⁄figuøti⁄
();

391 
¶Ÿ
 = 
node
->
¶Ÿs
[node->
cuºít_¶Ÿ_ödex
];

392 c⁄° *
èg
 = 
¸c16_¶Ÿ_èbÀ
[
¶Ÿ
];

393 
ègÀn
 = 
	`°æí
(
èg
);

394 
size_t
 
i
;

395 
i
 = 0; i < 
c
->
°agÀn
; i++) {

396 *
p
 = 
c
->
°ag±r
[
i
] + 1;

397 
p
[0] = 
èg
[0];

398 
p
[1] = (
ègÀn
 >2 ? 
èg
[1] : '}');

399 
p
[2] = (
ègÀn
 =3 ? 
èg
[2] : '}');

401 
	}
}

403 
	$˛õ¡D⁄e
(
˛õ¡
 
c
) {

404 
ªque°s_föished
 = 0;

405 
	`©omicGë
(
c⁄fig
.
ªque°s_föished
,Ñequests_finished);

406 i‡(
ªque°s_föished
 >
c⁄fig
.
ªque°s
) {

407 
	`‰ìClõ¡
(
c
);

408 i‡(!
c⁄fig
.
num_thªads
 && c⁄fig.
ñ
Ë
	`´St›
(config.el);

411 i‡(
c⁄fig
.
kì∑live
) {

412 
	`ª£tClõ¡
(
c
);

414 i‡(
c⁄fig
.
num_thªads
Ë
	`±hªad_muãx_lock
(&(c⁄fig.
live˛õ¡s_muãx
));

415 
c⁄fig
.
live˛õ¡s
--;

416 
	`¸óãMissögClõ¡s
(
c
);

417 
c⁄fig
.
live˛õ¡s
++;

418 i‡(
c⁄fig
.
num_thªads
)

419 
	`±hªad_muãx_u∆ock
(&(
c⁄fig
.
live˛õ¡s_muãx
));

420 
	`‰ìClõ¡
(
c
);

422 
	}
}

424 
	$ªadH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

425 
˛õ¡
 
c
 = 
¥ivd©a
;

426 *
ª∂y
 = 
NULL
;

427 
	`UNUSED
(
ñ
);

428 
	`UNUSED
(
fd
);

429 
	`UNUSED
(
mask
);

434 i‡(
c
->
œãncy
 < 0Ëc->œãncy = 
	`u°ime
()-(c->
°¨t
);

436 i‡(
	`ªdisBuf„rRód
(
c
->
c⁄ãxt
Ë!
REDIS_OK
) {

437 
	`Ârötf
(
°dîr
,"Eº‹: %s\n",
c
->
c⁄ãxt
->
îr°r
);

438 
	`exô
(1);

440 
c
->
≥ndög
) {

441 i‡(
	`ªdisGëRïly
(
c
->
c⁄ãxt
,&
ª∂y
Ë!
REDIS_OK
) {

442 
	`Ârötf
(
°dîr
,"Eº‹: %s\n",
c
->
c⁄ãxt
->
îr°r
);

443 
	`exô
(1);

445 i‡(
ª∂y
 !
NULL
) {

446 i‡(
ª∂y
 =(*)
REDIS_REPLY_ERROR
) {

447 
	`Ârötf
(
°dîr
,"UnexpectedÉrrorÑeply,Éxiting...\n");

448 
	`exô
(1);

450 
ªdisRïly
 *
r
 = 
ª∂y
;

451 
is_îr
 = (
r
->
ty≥
 =
REDIS_REPLY_ERROR
);

453 i‡(
is_îr
 && 
c⁄fig
.
showîr‹s
) {

455 
time_t
 
œ°îr_time
 = 0;

456 
time_t
 
now
 = 
	`time
(
NULL
);

457 i‡(
œ°îr_time
 !
now
) {

458 
œ°îr_time
 = 
now
;

459 i‡(
c
->
˛u°î_node
) {

460 
	`¥ötf
("Error from server %s:%d: %s\n",

461 
c
->
˛u°î_node
->
ù
,

462 
c
->
˛u°î_node
->
p‹t
,

463 
r
->
°r
);

464 } 
	`¥ötf
("Eº‹ from sîvî: %s\n", 
r
->
°r
);

471 i‡(
is_îr
 && 
c
->
˛u°î_node
 && c->
°agÀn
) {

472 
„tch_¶Ÿs
 = 0, 
do_waô
 = 0;

473 i‡(!
	`°∫cmp
(
r
->
°r
,"MOVED",5) || !strncmp(r->str,"ASK",3))

474 
„tch_¶Ÿs
 = 1;

475 i‡(!
	`°∫cmp
(
r
->
°r
,"CLUSTERDOWN",11)) {

479 
„tch_¶Ÿs
 = 1;

480 
do_waô
 = 1;

481 
	`¥ötf
("Error from server %s:%d: %s\n",

482 
c
->
˛u°î_node
->
ù
,

483 
c
->
˛u°î_node
->
p‹t
,

484 
r
->
°r
);

486 i‡(
do_waô
Ë
	`¶ìp
(1);

487 i‡(
„tch_¶Ÿs
 && !
	`„tchClu°îSlŸsC⁄figuøti⁄
(
c
))

488 
	`exô
(1);

491 
	`‰ìRïlyObje˘
(
ª∂y
);

493 i‡(
c
->
¥efix_≥ndög
 > 0) {

494 
c
->
¥efix_≥ndög
--;

495 
c
->
≥ndög
--;

497 i‡(
c
->
¥efixÀn
 > 0) {

498 
size_t
 
j
;

499 
	`sd§™ge
(
c
->
obuf
, c->
¥efixÀn
, -1);

502 
j
 = 0; j < 
c
->
øndÀn
; j++)

503 
c
->
ønd±r
[
j
] -c->
¥efixÀn
;

504 
c
->
¥efixÀn
 = 0;

508 
ªque°s_föished
 = 0;

509 
	`©omicGëIn¸
(
c⁄fig
.
ªque°s_föished
,Ñequests_finished, 1);

510 i‡(
ªque°s_föished
 < 
c⁄fig
.
ªque°s
)

511 
c⁄fig
.
œãncy
[
ªque°s_föished
] = 
c
->latency;

512 
c
->
≥ndög
--;

513 i‡(
c
->
≥ndög
 == 0) {

514 
	`˛õ¡D⁄e
(
c
);

522 
	}
}

524 
	$wrôeH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

525 
˛õ¡
 
c
 = 
¥ivd©a
;

526 
	`UNUSED
(
ñ
);

527 
	`UNUSED
(
fd
);

528 
	`UNUSED
(
mask
);

531 i‡(
c
->
wrôãn
 == 0) {

533 
ªque°s_issued
 = 0;

534 
	`©omicGëIn¸
(
c⁄fig
.
ªque°s_issued
,Ñequests_issued, 1);

535 i‡(
ªque°s_issued
 >
c⁄fig
.
ªque°s
) {

536 
	`‰ìClõ¡
(
c
);

541 i‡(
c⁄fig
.
øndomkeys
Ë
	`øndomizeClõ¡Key
(
c
);

542 i‡(
c⁄fig
.
˛u°î_mode
 && 
c
->
°agÀn
 > 0Ë
	`£tClu°îKeyHashTag
(c);

543 
	`©omicGë
(
c⁄fig
.
¶Ÿs_œ°_upd©e
, 
c
->slots_last_update);

544 
c
->
°¨t
 = 
	`u°ime
();

545 
c
->
œãncy
 = -1;

547 i‡(
	`sd¶í
(
c
->
obuf
Ë> c->
wrôãn
) {

548 *
±r
 = 
c
->
obuf
+c->
wrôãn
;

549 
ssize_t
 
nwrôãn
 = 
	`wrôe
(
c
->
c⁄ãxt
->
fd
,
±r
,
	`sd¶í
(c->
obuf
)-c->
wrôãn
);

550 i‡(
nwrôãn
 == -1) {

551 i‡(
î∫o
 !
EPIPE
)

552 
	`Ârötf
(
°dîr
, "WrôögÅÿsockë: %s\n", 
	`°ªº‹
(
î∫o
));

553 
	`‰ìClõ¡
(
c
);

556 
c
->
wrôãn
 +
nwrôãn
;

557 i‡(
	`sd¶í
(
c
->
obuf
Ë=c->
wrôãn
) {

558 
	`´DñëeFûeEvít
(
ñ
,
c
->
c⁄ãxt
->
fd
,
AE_WRITABLE
);

559 
	`´Cª©eFûeEvít
(
ñ
,
c
->
c⁄ãxt
->
fd
,
AE_READABLE
,
ªadH™dÀr
,c);

562 
	}
}

585 
˛õ¡
 
	$¸óãClõ¡
(*
cmd
, 
size_t
 
Àn
, 
˛õ¡
 
‰om
, 
thªad_id
) {

586 
j
;

587 
is_˛u°î_˛õ¡
 = (
c⁄fig
.
˛u°î_mode
 && 
thªad_id
 >= 0);

588 
˛õ¡
 
c
 = 
	`zmÆloc
((
_˛õ¡
));

590 c⁄° *
ù
 = 
NULL
;

591 
p‹t
 = 0;

592 
c
->
˛u°î_node
 = 
NULL
;

593 i‡(
c⁄fig
.
ho°sockë
 =
NULL
 || 
is_˛u°î_˛õ¡
) {

594 i‡(!
is_˛u°î_˛õ¡
) {

595 
ù
 = 
c⁄fig
.
ho°ù
;

596 
p‹t
 = 
c⁄fig
.
ho°p‹t
;

598 
node_idx
 = 0;

599 i‡(
c⁄fig
.
num_thªads
 < c⁄fig.
˛u°î_node_cou¡
)

600 
node_idx
 = 
c⁄fig
.
live˛õ¡s
 % c⁄fig.
˛u°î_node_cou¡
;

602 
node_idx
 = 
thªad_id
 % 
c⁄fig
.
˛u°î_node_cou¡
;

603 
˛u°îNode
 *
node
 = 
c⁄fig
.
˛u°î_nodes
[
node_idx
];

604 
	`as£π
(
node
 !
NULL
);

605 
ù
 = (c⁄° *Ë
node
->ip;

606 
p‹t
 = 
node
->port;

607 
c
->
˛u°î_node
 = 
node
;

609 
c
->
c⁄ãxt
 = 
	`ªdisC⁄√˘N⁄Block
(
ù
,
p‹t
);

611 
c
->
c⁄ãxt
 = 
	`ªdisC⁄√˘UnixN⁄Block
(
c⁄fig
.
ho°sockë
);

613 i‡(
c
->
c⁄ãxt
->
îr
) {

614 
	`Ârötf
(
°dîr
,"CouldÇot connectÅo Redisát ");

615 i‡(
c⁄fig
.
ho°sockë
 =
NULL
 || 
is_˛u°î_˛õ¡
)

616 
	`Ârötf
(
°dîr
,"%s:%d: %s\n",
ù
,
p‹t
,
c
->
c⁄ãxt
->
îr°r
);

618 
	`Ârötf
(
°dîr
,"%s: %s\n",
c⁄fig
.
ho°sockë
,
c
->
c⁄ãxt
->
îr°r
);

619 
	`exô
(1);

621 
c
->
thªad_id
 =Åhread_id;

623 
c
->
c⁄ãxt
->
ªadî
->
maxbuf
 = 0;

628 
c
->
obuf
 = 
	`sd£m±y
();

632 
c
->
¥efix_≥ndög
 = 0;

633 i‡(
c⁄fig
.
auth
) {

634 *
buf
 = 
NULL
;

635 
Àn
;

636 i‡(
c⁄fig
.
u£r
 =
NULL
)

637 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
buf
, "AUTH %s", 
c⁄fig
.
auth
);

639 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
buf
, "AUTH %s %s",

640 
c⁄fig
.
u£r
, c⁄fig.
auth
);

641 
c
->
obuf
 = 
	`sdsˇéí
(c->obuf, 
buf
, 
Àn
);

642 
	`‰ì
(
buf
);

643 
c
->
¥efix_≥ndög
++;

646 i‡(
c⁄fig
.
íabÀ_åackög
) {

647 *
buf
 = 
NULL
;

648 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
buf
, "CLIENT TRACKING on");

649 
c
->
obuf
 = 
	`sdsˇéí
(c->obuf, 
buf
, 
Àn
);

650 
	`‰ì
(
buf
);

651 
c
->
¥efix_≥ndög
++;

658 i‡(
c⁄fig
.
dbnum
 !0 && !
is_˛u°î_˛õ¡
) {

659 
c
->
obuf
 = 
	`sdsˇçrötf
(c->obuf,"*2\r\n$6\r\nSELECT\r\n$%d\r\n%s\r\n",

660 ()
	`sd¶í
(
c⁄fig
.
dbnum°r
),config.dbnumstr);

661 
c
->
¥efix_≥ndög
++;

663 
c
->
¥efixÀn
 = 
	`sd¶í
(c->
obuf
);

665 i‡(
‰om
) {

666 
c
->
obuf
 = 
	`sdsˇéí
(c->obuf,

667 
‰om
->
obuf
+‰om->
¥efixÀn
,

668 
	`sd¶í
(
‰om
->
obuf
)-‰om->
¥efixÀn
);

670 
j
 = 0; j < 
c⁄fig
.
pùñöe
; j++)

671 
c
->
obuf
 = 
	`sdsˇéí
(c->obuf,
cmd
,
Àn
);

674 
c
->
wrôãn
 = 0;

675 
c
->
≥ndög
 = 
c⁄fig
.
pùñöe
+c->
¥efix_≥ndög
;

676 
c
->
ønd±r
 = 
NULL
;

677 
c
->
øndÀn
 = 0;

678 
c
->
°ag±r
 = 
NULL
;

679 
c
->
°agÀn
 = 0;

682 i‡(
c⁄fig
.
øndomkeys
) {

683 i‡(
‰om
) {

684 
c
->
øndÀn
 = 
‰om
->randlen;

685 
c
->
ønd‰ì
 = 0;

686 
c
->
ønd±r
 = 
	`zmÆloc
((*)*c->
øndÀn
);

688 
j
 = 0; j < ()
c
->
øndÀn
; j++) {

689 
c
->
ønd±r
[
j
] = c->
obuf
 + (
‰om
->randptr[j]-from->obuf);

691 
c
->
ønd±r
[
j
] +c->
¥efixÀn
 - 
‰om
->prefixlen;

694 *
p
 = 
c
->
obuf
;

696 
c
->
øndÀn
 = 0;

697 
c
->
ønd‰ì
 = 
RANDPTR_INITIAL_SIZE
;

698 
c
->
ønd±r
 = 
	`zmÆloc
((*)*c->
ønd‰ì
);

699 (
p
 = 
	`°r°r
’,"__ønd_öt__")Ë!
NULL
) {

700 i‡(
c
->
ønd‰ì
 == 0) {

701 
c
->
ønd±r
 = 
	`zªÆloc
(c->ønd±r,(*)*c->
øndÀn
*2);

702 
c
->
ønd‰ì
 +c->
øndÀn
;

704 
c
->
ønd±r
[c->
øndÀn
++] = 
p
;

705 
c
->
ønd‰ì
--;

706 
p
 += 12;

711 i‡(
c⁄fig
.
˛u°î_mode
) {

712 i‡(
‰om
) {

713 
c
->
°agÀn
 = 
‰om
->staglen;

714 
c
->
°ag‰ì
 = 0;

715 
c
->
°ag±r
 = 
	`zmÆloc
((*)*c->
°agÀn
);

717 
j
 = 0; j < ()
c
->
°agÀn
; j++) {

718 
c
->
°ag±r
[
j
] = c->
obuf
 + (
‰om
->stagptr[j]-from->obuf);

720 
c
->
°ag±r
[
j
] +c->
¥efixÀn
 - 
‰om
->prefixlen;

723 *
p
 = 
c
->
obuf
;

725 
c
->
°agÀn
 = 0;

726 
c
->
°ag‰ì
 = 
RANDPTR_INITIAL_SIZE
;

727 
c
->
°ag±r
 = 
	`zmÆloc
((*)*c->
°ag‰ì
);

728 (
p
 = 
	`°r°r
’,"{èg}")Ë!
NULL
) {

729 i‡(
c
->
°ag‰ì
 == 0) {

730 
c
->
°ag±r
 = 
	`zªÆloc
(c->stagptr,

731 (*Ë* 
c
->
°agÀn
*2);

732 
c
->
°ag‰ì
 +c->
°agÀn
;

734 
c
->
°ag±r
[c->
°agÀn
++] = 
p
;

735 
c
->
°ag‰ì
--;

736 
p
 += 5;

740 
´EvítLo›
 *
ñ
 = 
NULL
;

741 i‡(
thªad_id
 < 0Ë
ñ
 = 
c⁄fig
.el;

743 
bíchm¨kThªad
 *
thªad
 = 
c⁄fig
.
thªads
[
thªad_id
];

744 
ñ
 = 
thªad
->el;

746 i‡(
c⁄fig
.
idÀmode
 == 0)

747 
	`´Cª©eFûeEvít
(
ñ
,
c
->
c⁄ãxt
->
fd
,
AE_WRITABLE
,
wrôeH™dÀr
,c);

748 
	`li°AddNodeTaû
(
c⁄fig
.
˛õ¡s
,
c
);

749 
	`©omicIn¸
(
c⁄fig
.
live˛õ¡s
, 1);

750 
	`©omicGë
(
c⁄fig
.
¶Ÿs_œ°_upd©e
, 
c
->slots_last_update);

751  
c
;

752 
	}
}

754 
	$¸óãMissögClõ¡s
(
˛õ¡
 
c
) {

755 
n
 = 0;

756 
c⁄fig
.
live˛õ¡s
 < c⁄fig.
num˛õ¡s
) {

757 
thªad_id
 = -1;

758 i‡(
c⁄fig
.
num_thªads
)

759 
thªad_id
 = 
c⁄fig
.
live˛õ¡s
 % c⁄fig.
num_thªads
;

760 
	`¸óãClõ¡
(
NULL
,0,
c
,
thªad_id
);

763 i‡(++
n
 > 64) {

764 
	`u¶ìp
(50000);

765 
n
 = 0;

768 
	}
}

770 
	$com∑ªL©ícy
(c⁄° *
a
, c⁄° *
b
) {

771  (*(*)
a
)-(*(*)
b
);

772 
	}
}

774 
	$ùow
(
ba£
, 
exp
) {

775 
ªsu…
 = 1;

776 
exp
) {

777 i‡(
exp
 & 1Ë
ªsu…
 *
ba£
;

778 
exp
 /= 2;

779 
ba£
 *= base;

781  
ªsu…
;

782 
	}
}

784 
	$showL©ícyRï‹t
() {

785 
i
, 
cuæ©
 = 0;

786 
usbëwì∆©
 = 
	`ùow
(10, 
MAX_LATENCY_PRECISION
-
c⁄fig
.
¥ecisi⁄
);

787 
≥rc
, 
ªq≥r£c
;

789 
ªq≥r£c
 = ()
c⁄fig
.
ªque°s_föished
/(()c⁄fig.
tŸœãncy
/1000);

790 i‡(!
c⁄fig
.
quõt
 && !c⁄fig.
csv
) {

791 
	`¥ötf
("=====%†======\n", 
c⁄fig
.
tôÀ
);

792 
	`¥ötf
(" %dÑeque°†com∂ëed i¿%.2‡£c⁄ds\n", 
c⁄fig
.
ªque°s_föished
,

793 ()
c⁄fig
.
tŸœãncy
/1000);

794 
	`¥ötf
(" %dÖ¨ÆÀ»˛õ¡s\n", 
c⁄fig
.
num˛õ¡s
);

795 
	`¥ötf
(" %d byã†∑ylﬂd\n", 
c⁄fig
.
d©asize
);

796 
	`¥ötf
(" kì∞Æive: %d\n", 
c⁄fig
.
kì∑live
);

797 i‡(
c⁄fig
.
˛u°î_mode
) {

798 
	`¥ötf
(" cluster mode: yes (%d masters)\n",

799 
c⁄fig
.
˛u°î_node_cou¡
);

800 
m
 ;

801 
m
 = 0; m < 
c⁄fig
.
˛u°î_node_cou¡
; m++) {

802 
˛u°îNode
 *
node
 = 
c⁄fig
.
˛u°î_nodes
[
m
];

803 
ªdisC⁄fig
 *
cfg
 = 
node
->
ªdis_c⁄fig
;

804 i‡(
cfg
 =
NULL
) ;

805 
	`¥ötf
("Çodê[%d] c⁄figuøti⁄:\n",
m
 );

806 
	`¥ötf
(" save: %s\n",

807 
	`sd¶í
(
cfg
->
ßve
) ? cfg->save : "NONE");

808 
	`¥ötf
("áµíd⁄ly: %s\n", 
cfg
->
≠≥nd⁄ly
);

811 i‡(
c⁄fig
.
ªdis_c⁄fig
) {

812 
	`¥ötf
(" host configuration \"save\": %s\n",

813 
c⁄fig
.
ªdis_c⁄fig
->
ßve
);

814 
	`¥ötf
(" host configuration \"appendonly\": %s\n",

815 
c⁄fig
.
ªdis_c⁄fig
->
≠≥nd⁄ly
);

818 
	`¥ötf
(" mu…i-thªad: %s\n", (
c⁄fig
.
num_thªads
 ? "yes" : "no"));

819 i‡(
c⁄fig
.
num_thªads
)

820 
	`¥ötf
("Åhªads: %d\n", 
c⁄fig
.
num_thªads
);

822 
	`¥ötf
("\n");

824 
	`qs‹t
(
c⁄fig
.
œãncy
,c⁄fig.
ªque°s
,(),
com∑ªL©ícy
);

825 
i
 = 0; i < 
c⁄fig
.
ªque°s
; i++) {

826 i‡(
c⁄fig
.
œãncy
[
i
]/
usbëwì∆©
 !
cuæ©
 ||

827 
i
 =(
c⁄fig
.
ªque°s
-1))

831 i‡(
c⁄fig
.
œãncy
[
i
] >= 2000) {

832 
c⁄fig
.
¥ecisi⁄
 = 0;

833 
usbëwì∆©
 = 
	`ùow
(10,

834 
MAX_LATENCY_PRECISION
-
c⁄fig
.
¥ecisi⁄
);

837 
cuæ©
 = 
c⁄fig
.
œãncy
[
i
]/
usbëwì∆©
;

838 
≥rc
 = (()(
i
+1)*100)/
c⁄fig
.
ªque°s
;

839 
	`¥ötf
("%.2f%% <%.*‡mûli£c⁄ds\n", 
≥rc
, 
c⁄fig
.
¥ecisi⁄
,

840 
cuæ©
/
	`pow
(10.0, 
c⁄fig
.
¥ecisi⁄
));

843 
	`¥ötf
("%.2‡ªque°†≥∏£c⁄d\n\n", 
ªq≥r£c
);

844 } i‡(
c⁄fig
.
csv
) {

845 
	`¥ötf
("\"%s\",\"%.2f\"\n", 
c⁄fig
.
tôÀ
, 
ªq≥r£c
);

847 
	`¥ötf
("%s: %.2‡ªque°†≥∏£c⁄d\n", 
c⁄fig
.
tôÀ
, 
ªq≥r£c
);

849 
	}
}

851 
	$öôBíchm¨kThªads
() {

852 
i
;

853 i‡(
c⁄fig
.
thªads
Ë
	`‰ìBíchm¨kThªads
();

854 
c⁄fig
.
thªads
 = 
	`zmÆloc
(c⁄fig.
num_thªads
 * (
bíchm¨kThªad
*));

855 
i
 = 0; i < 
c⁄fig
.
num_thªads
; i++) {

856 
bíchm¨kThªad
 *
thªad
 = 
	`¸óãBíchm¨kThªad
(
i
);

857 
c⁄fig
.
thªads
[
i
] = 
thªad
;

859 
	}
}

861 
	$°¨tBíchm¨kThªads
() {

862 
i
;

863 
i
 = 0; i < 
c⁄fig
.
num_thªads
; i++) {

864 
bíchm¨kThªad
 *
t
 = 
c⁄fig
.
thªads
[
i
];

865 i‡(
	`±hªad_¸óã
(&(
t
->
thªad
), 
NULL
, 
execBíchm¨kThªad
,Å)){

866 
	`Ârötf
(
°dîr
, "FATAL: FaûedÅÿ°¨àthªad %d.\n", 
i
);

867 
	`exô
(1);

870 
i
 = 0; i < 
c⁄fig
.
num_thªads
; i++)

871 
	`±hªad_joö
(
c⁄fig
.
thªads
[
i
]->
thªad
, 
NULL
);

872 
	}
}

874 
	$bíchm¨k
(*
tôÀ
, *
cmd
, 
Àn
) {

875 
˛õ¡
 
c
;

877 
c⁄fig
.
tôÀ
 =Åitle;

878 
c⁄fig
.
ªque°s_issued
 = 0;

879 
c⁄fig
.
ªque°s_föished
 = 0;

881 i‡(
c⁄fig
.
num_thªads
Ë
	`öôBíchm¨kThªads
();

883 
thªad_id
 = 
c⁄fig
.
num_thªads
 > 0 ? 0 : -1;

884 
c
 = 
	`¸óãClõ¡
(
cmd
,
Àn
,
NULL
,
thªad_id
);

885 
	`¸óãMissögClõ¡s
(
c
);

887 
c⁄fig
.
°¨t
 = 
	`m°ime
();

888 i‡(!
c⁄fig
.
num_thªads
Ë
	`´Maö
(c⁄fig.
ñ
);

889 
	`°¨tBíchm¨kThªads
();

890 
c⁄fig
.
tŸœãncy
 = 
	`m°ime
()-c⁄fig.
°¨t
;

892 
	`showL©ícyRï‹t
();

893 
	`‰ìAŒClõ¡s
();

894 i‡(
c⁄fig
.
thªads
Ë
	`‰ìBíchm¨kThªads
();

895 
	}
}

899 
bíchm¨kThªad
 *
	$¸óãBíchm¨kThªad
(
ödex
) {

900 
bíchm¨kThªad
 *
thªad
 = 
	`zmÆloc
((*thread));

901 i‡(
thªad
 =
NULL
)  NULL;

902 
thªad
->
ödex
 = index;

903 
thªad
->
ñ
 = 
	`´Cª©eEvítLo›
(1024*10);

904 
	`´Cª©eTimeEvít
(
thªad
->
ñ
,1,
showThroughput
,
NULL
,NULL);

905  
thªad
;

906 
	}
}

908 
	$‰ìBíchm¨kThªad
(
bíchm¨kThªad
 *
thªad
) {

909 i‡(
thªad
->
ñ
Ë
	`´DñëeEvítLo›
(thread->el);

910 
	`z‰ì
(
thªad
);

911 
	}
}

913 
	$‰ìBíchm¨kThªads
() {

914 
i
 = 0;

915 ; 
i
 < 
c⁄fig
.
num_thªads
; i++) {

916 
bíchm¨kThªad
 *
thªad
 = 
c⁄fig
.
thªads
[
i
];

917 i‡(
thªad
Ë
	`‰ìBíchm¨kThªad
(thread);

919 
	`z‰ì
(
c⁄fig
.
thªads
);

920 
c⁄fig
.
thªads
 = 
NULL
;

921 
	}
}

923 *
	$execBíchm¨kThªad
(*
±r
) {

924 
bíchm¨kThªad
 *
thªad
 = (bíchm¨kThªad *Ë
±r
;

925 
	`´Maö
(
thªad
->
ñ
);

926  
NULL
;

927 
	}
}

931 
˛u°îNode
 *
	$¸óãClu°îNode
(*
ù
, 
p‹t
) {

932 
˛u°îNode
 *
node
 = 
	`zmÆloc
((*node));

933 i‡(!
node
Ë 
NULL
;

934 
node
->
ù
 = ip;

935 
node
->
p‹t
 =Öort;

936 
node
->
«me
 = 
NULL
;

937 
node
->
Êags
 = 0;

938 
node
->
ª∂iˇã
 = 
NULL
;

939 
node
->
ª∂iˇs_cou¡
 = 0;

940 
node
->
¶Ÿs
 = 
	`zmÆloc
(
CLUSTER_SLOTS
 * ());

941 
node
->
¶Ÿs_cou¡
 = 0;

942 
node
->
cuºít_¶Ÿ_ödex
 = 0;

943 
node
->
upd©ed_¶Ÿs
 = 
NULL
;

944 
node
->
upd©ed_¶Ÿs_cou¡
 = 0;

945 
node
->
migøtög
 = 
NULL
;

946 
node
->
imp‹tög
 = 
NULL
;

947 
node
->
migøtög_cou¡
 = 0;

948 
node
->
imp‹tög_cou¡
 = 0;

949 
node
->
ªdis_c⁄fig
 = 
NULL
;

950  
node
;

951 
	}
}

953 
	$‰ìClu°îNode
(
˛u°îNode
 *
node
) {

954 
i
;

955 i‡(
node
->
«me
Ë
	`sds‰ì
(node->name);

956 i‡(
node
->
ª∂iˇã
Ë
	`sds‰ì
(node->replicate);

957 i‡(
node
->
migøtög
 !
NULL
) {

958 
i
 = 0; i < 
node
->
migøtög_cou¡
; i++Ë
	`sds‰ì
“ode->
migøtög
[i]);

959 
	`z‰ì
(
node
->
migøtög
);

961 i‡(
node
->
imp‹tög
 !
NULL
) {

962 
i
 = 0; i < 
node
->
imp‹tög_cou¡
; i++Ë
	`sds‰ì
“ode->
imp‹tög
[i]);

963 
	`z‰ì
(
node
->
imp‹tög
);

968 i‡(
node
->
ù
 && 
	`°rcmp
“ode->ù, 
c⁄fig
.
ho°ù
Ë!0Ë
	`sds‰ì
(node->ip);

969 i‡(
node
->
ªdis_c⁄fig
 !
NULL
Ë
	`‰ìRedisC⁄fig
(node->redis_config);

970 
	`z‰ì
(
node
->
¶Ÿs
);

971 
	`z‰ì
(
node
);

972 
	}
}

974 
	$‰ìClu°îNodes
() {

975 
i
 = 0;

976 ; 
i
 < 
c⁄fig
.
˛u°î_node_cou¡
; i++) {

977 
˛u°îNode
 *
n
 = 
c⁄fig
.
˛u°î_nodes
[
i
];

978 i‡(
n
Ë
	`‰ìClu°îNode
(n);

980 
	`z‰ì
(
c⁄fig
.
˛u°î_nodes
);

981 
c⁄fig
.
˛u°î_nodes
 = 
NULL
;

982 
	}
}

984 
˛u°îNode
 **
	$addClu°îNode
(
˛u°îNode
 *
node
) {

985 
cou¡
 = 
c⁄fig
.
˛u°î_node_cou¡
 + 1;

986 
c⁄fig
.
˛u°î_nodes
 = 
	`zªÆloc
(config.cluster_nodes,

987 
cou¡
 * (*
node
));

988 i‡(!
c⁄fig
.
˛u°î_nodes
Ë 
NULL
;

989 
c⁄fig
.
˛u°î_nodes
[c⁄fig.
˛u°î_node_cou¡
++] = 
node
;

990  
c⁄fig
.
˛u°î_nodes
;

991 
	}
}

993 
	$„tchClu°îC⁄figuøti⁄
() {

994 
suc˚ss
 = 1;

995 
ªdisC⁄ãxt
 *
˘x
 = 
NULL
;

996 
ªdisRïly
 *
ª∂y
 = 
NULL
;

997 i‡(
c⁄fig
.
ho°sockë
 =
NULL
)

998 
˘x
 = 
	`ªdisC⁄√˘
(
c⁄fig
.
ho°ù
,c⁄fig.
ho°p‹t
);

1000 
˘x
 = 
	`ªdisC⁄√˘Unix
(
c⁄fig
.
ho°sockë
);

1001 i‡(
˘x
->
îr
) {

1002 
	`Ârötf
(
°dîr
,"CouldÇot connectÅo Redisát ");

1003 i‡(
c⁄fig
.
ho°sockë
 =
NULL
) {

1004 
	`Ârötf
(
°dîr
,"%s:%d: %s\n",
c⁄fig
.
ho°ù
,c⁄fig.
ho°p‹t
,

1005 
˘x
->
îr°r
);

1006 } 
	`Ârötf
(
°dîr
,"%s: %s\n",
c⁄fig
.
ho°sockë
,
˘x
->
îr°r
);

1007 
	`exô
(1);

1009 
˛u°îNode
 *
fú°Node
 = 
	`¸óãClu°îNode
((*Ë
c⁄fig
.
ho°ù
,

1010 
c⁄fig
.
ho°p‹t
);

1011 i‡(!
fú°Node
Ë{
suc˚ss
 = 0; 
˛ónup
;}

1012 
ª∂y
 = 
	`ªdisComm™d
(
˘x
, "CLUSTER NODES");

1013 
suc˚ss
 = (
ª∂y
 !
NULL
);

1014 i‡(!
suc˚ss
Ë
˛ónup
;

1015 
suc˚ss
 = (
ª∂y
->
ty≥
 !
REDIS_REPLY_ERROR
);

1016 i‡(!
suc˚ss
) {

1017 i‡(
c⁄fig
.
ho°sockë
 =
NULL
) {

1018 
	`Ârötf
(
°dîr
, "ClusterÇode %s:%dÑeplied withÉrror:\n%s\n",

1019 
c⁄fig
.
ho°ù
, c⁄fig.
ho°p‹t
, 
ª∂y
->
°r
);

1021 
	`Ârötf
(
°dîr
, "ClusterÇode %sÑeplied withÉrror:\n%s\n",

1022 
c⁄fig
.
ho°sockë
, 
ª∂y
->
°r
);

1024 
˛ónup
;

1026 *
löes
 = 
ª∂y
->
°r
, *
p
, *
löe
;

1027 (
p
 = 
	`°r°r
(
löes
, "\n")Ë!
NULL
) {

1028 *
p
 = '\0';

1029 
löe
 = 
löes
;

1030 
löes
 = 
p
 + 1;

1031 *
«me
 = 
NULL
, *
addr
 = NULL, *
Êags
 = NULL, *
ma°î_id
 = NULL;

1032 
i
 = 0;

1033 (
p
 = 
	`°rchr
(
löe
, ' ')Ë!
NULL
) {

1034 *
p
 = '\0';

1035 *
tokí
 = 
löe
;

1036 
löe
 = 
p
 + 1;

1037 
i
++){

1038 0: 
«me
 = 
tokí
; ;

1039 1: 
addr
 = 
tokí
; ;

1040 2: 
Êags
 = 
tokí
; ;

1041 3: 
ma°î_id
 = 
tokí
; ;

1043 i‡(
i
 == 8) ;

1045 i‡(!
Êags
) {

1046 
	`Ârötf
(
°dîr
, "Invalid CLUSTER NODESÑeply: missing flags.\n");

1047 
suc˚ss
 = 0;

1048 
˛ónup
;

1050 
my£lf
 = (
	`°r°r
(
Êags
, "my£lf"Ë!
NULL
);

1051 
is_ª∂iˇ
 = (
	`°r°r
(
Êags
, "¶ave"Ë!
NULL
 ||

1052 (
ma°î_id
 !
NULL
 && master_id[0] != '-'));

1053 i‡(
is_ª∂iˇ
) ;

1054 i‡(
addr
 =
NULL
) {

1055 
	`Ârötf
(
°dîr
, "Invalid CLUSTER NODESÑeply: missingáddr.\n");

1056 
suc˚ss
 = 0;

1057 
˛ónup
;

1059 
˛u°îNode
 *
node
 = 
NULL
;

1060 *
ù
 = 
NULL
;

1061 
p‹t
 = 0;

1062 *
∑ddr
 = 
	`°rchr
(
addr
, ':');

1063 i‡(
∑ddr
 !
NULL
) {

1064 *
∑ddr
 = '\0';

1065 
ù
 = 
addr
;

1066 
addr
 = 
∑ddr
 + 1;

1068 i‡((
∑ddr
 = 
	`°rchr
(
addr
, '@')Ë!
NULL
) *paddr = '\0';

1069 
p‹t
 = 
	`©oi
(
addr
);

1071 i‡(
my£lf
) {

1072 
node
 = 
fú°Node
;

1073 i‡(
node
->
ù
 =
NULL
 && ip != NULL) {

1074 
node
->
ù
 = ip;

1075 
node
->
p‹t
 =Öort;

1078 
node
 = 
	`¸óãClu°îNode
(
	`sd¢ew
(
ù
), 
p‹t
);

1080 i‡(
node
 =
NULL
) {

1081 
suc˚ss
 = 0;

1082 
˛ónup
;

1084 i‡(
«me
 !
NULL
Ë
node
->«mê
	`sd¢ew
(name);

1085 i‡(
i
 == 8) {

1086 
ªmaöög
 = 
	`°æí
(
löe
);

1087 
ªmaöög
 > 0) {

1088 
p
 = 
	`°rchr
(
löe
, ' ');

1089 i‡(
p
 =
NULL
Ë∞
löe
 + 
ªmaöög
;

1090 
ªmaöög
 -(
p
 - 
löe
);

1092 *
¶Ÿsdef
 = 
löe
;

1093 *
p
 = '\0';

1094 i‡(
ªmaöög
) {

1095 
löe
 = 
p
 + 1;

1096 
ªmaöög
--;

1097 } 
löe
 = 
p
;

1098 *
dash
 = 
NULL
;

1099 i‡(
¶Ÿsdef
[0] == '[') {

1100 
¶Ÿsdef
++;

1101 i‡((
p
 = 
	`°r°r
(
¶Ÿsdef
, "->-"))) {

1102 *
p
 = '\0';

1103 
p
 += 3;

1104 *
˛osög_bøckë
 = 
	`°rchr
(
p
, ']');

1105 i‡(
˛osög_bøckë
) *closing_bracket = '\0';

1106 
sds
 
¶Ÿ
 = 
	`sd¢ew
(
¶Ÿsdef
);

1107 
sds
 
d°
 = 
	`sd¢ew
(
p
);

1108 
node
->
migøtög_cou¡
 += 2;

1109 
node
->
migøtög
 =

1110 
	`zªÆloc
(
node
->
migøtög
,

1111 (
node
->
migøtög_cou¡
 * (
sds
)));

1112 
node
->
migøtög
[node->
migøtög_cou¡
 - 2] =

1113 
¶Ÿ
;

1114 
node
->
migøtög
[node->
migøtög_cou¡
 - 1] =

1115 
d°
;

1116 } i‡((
p
 = 
	`°r°r
(
¶Ÿsdef
, "-<-"))) {

1117 *
p
 = '\0';

1118 
p
 += 3;

1119 *
˛osög_bøckë
 = 
	`°rchr
(
p
, ']');

1120 i‡(
˛osög_bøckë
) *closing_bracket = '\0';

1121 
sds
 
¶Ÿ
 = 
	`sd¢ew
(
¶Ÿsdef
);

1122 
sds
 
§c
 = 
	`sd¢ew
(
p
);

1123 
node
->
imp‹tög_cou¡
 += 2;

1124 
node
->
imp‹tög
 = 
	`zªÆloc
(node->importing,

1125 (
node
->
imp‹tög_cou¡
 * (
sds
)));

1126 
node
->
imp‹tög
[node->
imp‹tög_cou¡
 - 2] =

1127 
¶Ÿ
;

1128 
node
->
imp‹tög
[node->
imp‹tög_cou¡
 - 1] =

1129 
§c
;

1131 } i‡((
dash
 = 
	`°rchr
(
¶Ÿsdef
, '-')Ë!
NULL
) {

1132 
p
 = 
dash
;

1133 
°¨t
, 
°›
;

1134 *
p
 = '\0';

1135 
°¨t
 = 
	`©oi
(
¶Ÿsdef
);

1136 
°›
 = 
	`©oi
(
p
 + 1);

1137 
°¨t
 <
°›
) {

1138 
¶Ÿ
 = 
°¨t
++;

1139 
node
->
¶Ÿs
[node->
¶Ÿs_cou¡
++] = 
¶Ÿ
;

1141 } i‡(
p
 > 
¶Ÿsdef
) {

1142 
¶Ÿ
 = 
	`©oi
(
¶Ÿsdef
);

1143 
node
->
¶Ÿs
[node->
¶Ÿs_cou¡
++] = 
¶Ÿ
;

1147 i‡(
node
->
¶Ÿs_cou¡
 == 0) {

1148 
	`¥ötf
("WARNING: masterÇode %s:%d hasÇo slots, skipping...\n",

1149 
node
->
ù
,Çode->
p‹t
);

1152 i‡(!
	`addClu°îNode
(
node
)) {

1153 
suc˚ss
 = 0;

1154 
˛ónup
;

1157 
˛ónup
:

1158 i‡(
˘x
Ë
	`ªdisFªe
(ctx);

1159 i‡(!
suc˚ss
) {

1160 i‡(
c⁄fig
.
˛u°î_nodes
Ë
	`‰ìClu°îNodes
();

1162 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

1163  
suc˚ss
;

1164 
	}
}

1168 
	$„tchClu°îSlŸsC⁄figuøti⁄
(
˛õ¡
 
c
) {

1169 
	`UNUSED
(
c
);

1170 
suc˚ss
 = 1, 
is_„tchög_¶Ÿs
 = 0, 
œ°_upd©e
 = 0;

1171 
size_t
 
i
;

1172 
	`©omicGë
(
c⁄fig
.
¶Ÿs_œ°_upd©e
, 
œ°_upd©e
);

1173 i‡(
c
->
¶Ÿs_œ°_upd©e
 < 
œ°_upd©e
) {

1174 
c
->
¶Ÿs_œ°_upd©e
 = 
œ°_upd©e
;

1177 
ªdisRïly
 *
ª∂y
 = 
NULL
;

1178 
	`©omicGëIn¸
(
c⁄fig
.
is_„tchög_¶Ÿs
, is_fetching_slots, 1);

1179 i‡(
is_„tchög_¶Ÿs
)  -1;

1180 
	`©omicSë
(
c⁄fig
.
is_„tchög_¶Ÿs
, 1);

1181 i‡(
c⁄fig
.
showîr‹s
)

1182 
	`¥ötf
("Cluster slots configuration changed, fetchingÇew one...\n");

1183 c⁄° *
îrmsg
 = "FailedÅo update cluster slots configuration";

1184 
di˘Ty≥
 
dty≥
 = {

1185 
di˘SdsHash
,

1186 
NULL
,

1187 
NULL
,

1188 
di˘SdsKeyCom∑ª
,

1189 
NULL
,

1190 
NULL


1193 
di˘
 *
ma°îs
 = 
	`di˘Cª©e
(&
dty≥
, 
NULL
);

1194 
ªdisC⁄ãxt
 *
˘x
 = 
NULL
;

1195 
i
 = 0; i < (
size_t
Ë
c⁄fig
.
˛u°î_node_cou¡
; i++) {

1196 
˛u°îNode
 *
node
 = 
c⁄fig
.
˛u°î_nodes
[
i
];

1197 
	`as£π
(
node
->
ù
 !
NULL
);

1198 
	`as£π
(
node
->
«me
 !
NULL
);

1199 
	`as£π
(
node
->
p‹t
);

1201 i‡(
˘x
 =
NULL
) {

1202 
˘x
 = 
	`ªdisC⁄√˘
(
node
->
ù
,Çode->
p‹t
);

1203 i‡(!
˘x
 || ctx->
îr
) {

1204 
suc˚ss
 = 0;

1205 i‡(
˘x
 && ctx->
îr
)

1206 
	`Ârötf
(
°dîr
, "REDIS CONNECTION ERROR: %s\n", 
˘x
->
îr°r
);

1207 
˛ónup
;

1210 i‡(
node
->
upd©ed_¶Ÿs
 !
NULL
)

1211 
	`z‰ì
(
node
->
upd©ed_¶Ÿs
);

1212 
node
->
upd©ed_¶Ÿs
 = 
NULL
;

1213 
node
->
upd©ed_¶Ÿs_cou¡
 = 0;

1214 
	`di˘Rïœ˚
(
ma°îs
, 
node
->
«me
,Çode) ;

1216 
ª∂y
 = 
	`ªdisComm™d
(
˘x
, "CLUSTER SLOTS");

1217 i‡(
ª∂y
 =
NULL
 ||Ñïly->
ty≥
 =
REDIS_REPLY_ERROR
) {

1218 
suc˚ss
 = 0;

1219 i‡(
ª∂y
)

1220 
	`Ârötf
(
°dîr
,"%s\nCLUSTER SLOTS ERROR: %s\n",
îrmsg
,
ª∂y
->
°r
);

1221 
˛ónup
;

1223 
	`as£π
(
ª∂y
->
ty≥
 =
REDIS_REPLY_ARRAY
);

1224 
i
 = 0; i < 
ª∂y
->
ñemíts
; i++) {

1225 
ªdisRïly
 *
r
 = 
ª∂y
->
ñemít
[
i
];

1226 
	`as£π
(
r
->
ty≥
 =
REDIS_REPLY_ARRAY
);

1227 
	`as£π
(
r
->
ñemíts
 >= 3);

1228 
‰om
, 
to
, 
¶Ÿ
;

1229 
‰om
 = 
r
->
ñemít
[0]->
öãgî
;

1230 
to
 = 
r
->
ñemít
[1]->
öãgî
;

1231 
ªdisRïly
 *
ƒ
 = 
r
->
ñemít
[2];

1232 
	`as£π
(
ƒ
->
ty≥
 =
REDIS_REPLY_ARRAY
 &&Çr->
ñemíts
 >= 3);

1233 
	`as£π
(
ƒ
->
ñemít
[2]->
°r
 !
NULL
);

1234 
sds
 
«me
 = 
	`sd¢ew
(
ƒ
->
ñemít
[2]->
°r
);

1235 
di˘E¡ry
 *
íåy
 = 
	`di˘Föd
(
ma°îs
, 
«me
);

1236 i‡(
íåy
 =
NULL
) {

1237 
suc˚ss
 = 0;

1238 
	`Ârötf
(
°dîr
, "%s: couldÇot findÇode with ID %s in current "

1239 "c⁄figuøti⁄.\n", 
îrmsg
, 
«me
);

1240 i‡(
«me
Ë
	`sds‰ì
(name);

1241 
˛ónup
;

1243 
	`sds‰ì
(
«me
);

1244 
˛u°îNode
 *
node
 = 
	`di˘GëVÆ
(
íåy
);

1245 i‡(
node
->
upd©ed_¶Ÿs
 =
NULL
)

1246 
node
->
upd©ed_¶Ÿs
 = 
	`zˇŒoc
(
CLUSTER_SLOTS
 * ());

1247 
¶Ÿ
 = 
‰om
; slŸ <
to
; slot++)

1248 
node
->
upd©ed_¶Ÿs
[node->
upd©ed_¶Ÿs_cou¡
++] = 
¶Ÿ
;

1250 
	`upd©eClu°îSlŸsC⁄figuøti⁄
();

1251 
˛ónup
:

1252 
	`‰ìRïlyObje˘
(
ª∂y
);

1253 
	`ªdisFªe
(
˘x
);

1254 
	`di˘Rñó£
(
ma°îs
);

1255 
	`©omicSë
(
c⁄fig
.
is_„tchög_¶Ÿs
, 0);

1256  
suc˚ss
;

1257 
	}
}

1260 
	$upd©eClu°îSlŸsC⁄figuøti⁄
() {

1261 
	`±hªad_muãx_lock
(&
c⁄fig
.
is_upd©ög_¶Ÿs_muãx
);

1262 
	`©omicSë
(
c⁄fig
.
is_upd©ög_¶Ÿs
, 1);

1263 
i
;

1264 
i
 = 0; i < 
c⁄fig
.
˛u°î_node_cou¡
; i++) {

1265 
˛u°îNode
 *
node
 = 
c⁄fig
.
˛u°î_nodes
[
i
];

1266 i‡(
node
->
upd©ed_¶Ÿs
 !
NULL
) {

1267 *
ﬁd¶Ÿs
 = 
node
->
¶Ÿs
;

1268 
node
->
¶Ÿs
 =Çode->
upd©ed_¶Ÿs
;

1269 
node
->
¶Ÿs_cou¡
 =Çode->
upd©ed_¶Ÿs_cou¡
;

1270 
node
->
cuºít_¶Ÿ_ödex
 = 0;

1271 
node
->
upd©ed_¶Ÿs
 = 
NULL
;

1272 
node
->
upd©ed_¶Ÿs_cou¡
 = 0;

1273 
	`z‰ì
(
ﬁd¶Ÿs
);

1276 
	`©omicSë
(
c⁄fig
.
is_upd©ög_¶Ÿs
, 0);

1277 
	`©omicIn¸
(
c⁄fig
.
¶Ÿs_œ°_upd©e
, 1);

1278 
	`±hªad_muãx_u∆ock
(&
c⁄fig
.
is_upd©ög_¶Ÿs_muãx
);

1279 
	}
}

1282 
	$∑r£O±i⁄s
(
¨gc
, c⁄° **
¨gv
) {

1283 
i
;

1284 
œ°¨g
;

1285 
exô_°©us
 = 1;

1287 
i
 = 1; i < 
¨gc
; i++) {

1288 
œ°¨g
 = (
i
 =(
¨gc
-1));

1290 i‡(!
	`°rcmp
(
¨gv
[
i
],"-c")) {

1291 i‡(
œ°¨g
Ë
övÆid
;

1292 
c⁄fig
.
num˛õ¡s
 = 
	`©oi
(
¨gv
[++
i
]);

1293 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-n")) {

1294 i‡(
œ°¨g
Ë
övÆid
;

1295 
c⁄fig
.
ªque°s
 = 
	`©oi
(
¨gv
[++
i
]);

1296 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-k")) {

1297 i‡(
œ°¨g
Ë
övÆid
;

1298 
c⁄fig
.
kì∑live
 = 
	`©oi
(
¨gv
[++
i
]);

1299 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-h")) {

1300 i‡(
œ°¨g
Ë
övÆid
;

1301 
c⁄fig
.
ho°ù
 = 
	`°rdup
(
¨gv
[++
i
]);

1302 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-p")) {

1303 i‡(
œ°¨g
Ë
övÆid
;

1304 
c⁄fig
.
ho°p‹t
 = 
	`©oi
(
¨gv
[++
i
]);

1305 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-s")) {

1306 i‡(
œ°¨g
Ë
övÆid
;

1307 
c⁄fig
.
ho°sockë
 = 
	`°rdup
(
¨gv
[++
i
]);

1308 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-a") ) {

1309 i‡(
œ°¨g
Ë
övÆid
;

1310 
c⁄fig
.
auth
 = 
	`°rdup
(
¨gv
[++
i
]);

1311 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--user")) {

1312 i‡(
œ°¨g
Ë
övÆid
;

1313 
c⁄fig
.
u£r
 = 
¨gv
[++
i
];

1314 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-d")) {

1315 i‡(
œ°¨g
Ë
övÆid
;

1316 
c⁄fig
.
d©asize
 = 
	`©oi
(
¨gv
[++
i
]);

1317 i‡(
c⁄fig
.
d©asize
 < 1) config.datasize=1;

1318 i‡(
c⁄fig
.
d©asize
 > 1024*1024*1024) config.datasize = 1024*1024*1024;

1319 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-P")) {

1320 i‡(
œ°¨g
Ë
övÆid
;

1321 
c⁄fig
.
pùñöe
 = 
	`©oi
(
¨gv
[++
i
]);

1322 i‡(
c⁄fig
.
pùñöe
 <= 0) config.pipeline=1;

1323 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-r")) {

1324 i‡(
œ°¨g
Ë
övÆid
;

1325 c⁄° *
√xt
 = 
¨gv
[++
i
], *
p
 =Çext;

1326 i‡(*
p
 == '-') {

1327 
p
++;

1328 i‡(*
p
 < '0' || *∞> '9'Ë
övÆid
;

1330 
c⁄fig
.
øndomkeys
 = 1;

1331 
c⁄fig
.
øndomkeys_key•a˚Àn
 = 
	`©oi
(
√xt
);

1332 i‡(
c⁄fig
.
øndomkeys_key•a˚Àn
 < 0)

1333 
c⁄fig
.
øndomkeys_key•a˚Àn
 = 0;

1334 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-q")) {

1335 
c⁄fig
.
quõt
 = 1;

1336 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--csv")) {

1337 
c⁄fig
.
csv
 = 1;

1338 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-l")) {

1339 
c⁄fig
.
lo›
 = 1;

1340 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-I")) {

1341 
c⁄fig
.
idÀmode
 = 1;

1342 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-e")) {

1343 
c⁄fig
.
showîr‹s
 = 1;

1344 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-t")) {

1345 i‡(
œ°¨g
Ë
övÆid
;

1351 
c⁄fig
.
ã°s
 = 
	`sd¢ew
(",");

1352 
c⁄fig
.
ã°s
 = 
	`sdsˇt
(c⁄fig.ã°s,(*)
¨gv
[++
i
]);

1353 
c⁄fig
.
ã°s
 = 
	`sdsˇt
(config.tests,",");

1354 
	`sd°ﬁowî
(
c⁄fig
.
ã°s
);

1355 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--dbnum")) {

1356 i‡(
œ°¨g
Ë
övÆid
;

1357 
c⁄fig
.
dbnum
 = 
	`©oi
(
¨gv
[++
i
]);

1358 
c⁄fig
.
dbnum°r
 = 
	`sds‰oml⁄gl⁄g
(c⁄fig.
dbnum
);

1359 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--precision")) {

1360 i‡(
œ°¨g
Ë
övÆid
;

1361 
c⁄fig
.
¥ecisi⁄
 = 
	`©oi
(
¨gv
[++
i
]);

1362 i‡(
c⁄fig
.
¥ecisi⁄
 < 0) config.precision = 0;

1363 i‡(
c⁄fig
.
¥ecisi⁄
 > 
MAX_LATENCY_PRECISION
) config.precision = MAX_LATENCY_PRECISION;

1364 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--threads")) {

1365 i‡(
œ°¨g
Ë
övÆid
;

1366 
c⁄fig
.
num_thªads
 = 
	`©oi
(
¨gv
[++
i
]);

1367 i‡(
c⁄fig
.
num_thªads
 > 
MAX_THREADS
) {

1368 
	`¥ötf
("WARNING:Åoo manyÅhreads,ÜimitingÅhreadsÅo %d.\n",

1369 
MAX_THREADS
);

1370 
c⁄fig
.
num_thªads
 = 
MAX_THREADS
;

1371 } i‡(
c⁄fig
.
num_thªads
 < 0) config.num_threads = 0;

1372 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--cluster")) {

1373 
c⁄fig
.
˛u°î_mode
 = 1;

1374 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--enable-tracking")) {

1375 
c⁄fig
.
íabÀ_åackög
 = 1;

1376 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--help")) {

1377 
exô_°©us
 = 0;

1378 
ußge
;

1383 i‡(
¨gv
[
i
][0] ='-'Ë
övÆid
;

1384  
i
;

1388  
i
;

1390 
övÆid
:

1391 
	`¥ötf
("InvÆid o±i⁄ \"%s\" o∏›ti⁄árgumíàmissög\n\n",
¨gv
[
i
]);

1393 
ußge
:

1394 
	`¥ötf
(

1441 
	`exô
(
exô_°©us
);

1442 
	}
}

1444 
	$showThroughput
(
´EvítLo›
 *
evítLo›
, 
id
, *
˛õ¡D©a
) {

1445 
	`UNUSED
(
evítLo›
);

1446 
	`UNUSED
(
id
);

1447 
	`UNUSED
(
˛õ¡D©a
);

1448 
live˛õ¡s
 = 0;

1449 
ªque°s_föished
 = 0;

1450 
	`©omicGë
(
c⁄fig
.
live˛õ¡s
,Üiveclients);

1451 
	`©omicGë
(
c⁄fig
.
ªque°s_föished
,Ñequests_finished);

1453 i‡(
live˛õ¡s
 =0 && 
ªque°s_föished
 !
c⁄fig
.
ªque°s
) {

1454 
	`Ârötf
(
°dîr
,"All clients disconnected...áborting.\n");

1455 
	`exô
(1);

1457 i‡(
c⁄fig
.
num_thªads
 && 
ªque°s_föished
 >c⁄fig.
ªque°s
) {

1458 
	`´St›
(
evítLo›
);

1459  
AE_NOMORE
;

1461 i‡(
c⁄fig
.
csv
)  250;

1462 i‡(
c⁄fig
.
idÀmode
 == 1) {

1463 
	`¥ötf
("˛õ¡s: %d\r", 
c⁄fig
.
live˛õ¡s
);

1464 
	`fÊush
(
°dout
);

1467 
dt
 = ()(
	`m°ime
()-
c⁄fig
.
°¨t
)/1000.0;

1468 
Ωs
 = ()
ªque°s_föished
/
dt
;

1469 
	`¥ötf
("%s: %.2f\r", 
c⁄fig
.
tôÀ
, 
Ωs
);

1470 
	`fÊush
(
°dout
);

1472 
	}
}

1476 
	$ã°_is_£À˘ed
(*
«me
) {

1477 
buf
[256];

1478 
l
 = 
	`°æí
(
«me
);

1480 i‡(
c⁄fig
.
ã°s
 =
NULL
)  1;

1481 
buf
[0] = ',';

1482 
	`mem˝y
(
buf
+1,
«me
,
l
);

1483 
buf
[
l
+1] = ',';

1484 
buf
[
l
+2] = '\0';

1485  
	`°r°r
(
c⁄fig
.
ã°s
,
buf
Ë!
NULL
;

1486 
	}
}

1488 
	$maö
(
¨gc
, c⁄° **
¨gv
) {

1489 
i
;

1490 *
d©a
, *
cmd
;

1491 
Àn
;

1493 
˛õ¡
 
c
;

1495 
	`§™dom
(
	`time
(
NULL
));

1496 
	`sig«l
(
SIGHUP
, 
SIG_IGN
);

1497 
	`sig«l
(
SIGPIPE
, 
SIG_IGN
);

1499 
c⁄fig
.
num˛õ¡s
 = 50;

1500 
c⁄fig
.
ªque°s
 = 100000;

1501 
c⁄fig
.
live˛õ¡s
 = 0;

1502 
c⁄fig
.
ñ
 = 
	`´Cª©eEvítLo›
(1024*10);

1503 
	`´Cª©eTimeEvít
(
c⁄fig
.
ñ
,1,
showThroughput
,
NULL
,NULL);

1504 
c⁄fig
.
kì∑live
 = 1;

1505 
c⁄fig
.
d©asize
 = 3;

1506 
c⁄fig
.
pùñöe
 = 1;

1507 
c⁄fig
.
showîr‹s
 = 0;

1508 
c⁄fig
.
øndomkeys
 = 0;

1509 
c⁄fig
.
øndomkeys_key•a˚Àn
 = 0;

1510 
c⁄fig
.
quõt
 = 0;

1511 
c⁄fig
.
csv
 = 0;

1512 
c⁄fig
.
lo›
 = 0;

1513 
c⁄fig
.
idÀmode
 = 0;

1514 
c⁄fig
.
œãncy
 = 
NULL
;

1515 
c⁄fig
.
˛õ¡s
 = 
	`li°Cª©e
();

1516 
c⁄fig
.
ho°ù
 = "127.0.0.1";

1517 
c⁄fig
.
ho°p‹t
 = 6379;

1518 
c⁄fig
.
ho°sockë
 = 
NULL
;

1519 
c⁄fig
.
ã°s
 = 
NULL
;

1520 
c⁄fig
.
dbnum
 = 0;

1521 
c⁄fig
.
auth
 = 
NULL
;

1522 
c⁄fig
.
¥ecisi⁄
 = 1;

1523 
c⁄fig
.
num_thªads
 = 0;

1524 
c⁄fig
.
thªads
 = 
NULL
;

1525 
c⁄fig
.
˛u°î_mode
 = 0;

1526 
c⁄fig
.
˛u°î_node_cou¡
 = 0;

1527 
c⁄fig
.
˛u°î_nodes
 = 
NULL
;

1528 
c⁄fig
.
ªdis_c⁄fig
 = 
NULL
;

1529 
c⁄fig
.
is_„tchög_¶Ÿs
 = 0;

1530 
c⁄fig
.
is_upd©ög_¶Ÿs
 = 0;

1531 
c⁄fig
.
¶Ÿs_œ°_upd©e
 = 0;

1532 
c⁄fig
.
íabÀ_åackög
 = 0;

1534 
i
 = 
	`∑r£O±i⁄s
(
¨gc
,
¨gv
);

1535 
¨gc
 -
i
;

1536 
¨gv
 +
i
;

1538 
c⁄fig
.
œãncy
 = 
	`zmÆloc
(()*c⁄fig.
ªque°s
);

1540 i‡(
c⁄fig
.
˛u°î_mode
) {

1542 i‡(!
	`„tchClu°îC⁄figuøti⁄
(Ë|| !
c⁄fig
.
˛u°î_nodes
) {

1543 i‡(!
c⁄fig
.
ho°sockë
) {

1544 
	`Ârötf
(
°dîr
, "FailedÅo fetch cluster configuration from "

1545 "%s:%d\n", 
c⁄fig
.
ho°ù
, c⁄fig.
ho°p‹t
);

1547 
	`Ârötf
(
°dîr
, "FailedÅo fetch cluster configuration from "

1548 "%s\n", 
c⁄fig
.
ho°sockë
);

1550 
	`exô
(1);

1552 i‡(
c⁄fig
.
˛u°î_node_cou¡
 <= 1) {

1553 
	`Ârötf
(
°dîr
, "Invalid cluster: %dÇode(s).\n",

1554 
c⁄fig
.
˛u°î_node_cou¡
);

1555 
	`exô
(1);

1557 
	`¥ötf
("Clu°î ha†%d ma°îÇodes:\n\n", 
c⁄fig
.
˛u°î_node_cou¡
);

1558 
i
 = 0;

1559 ; 
i
 < 
c⁄fig
.
˛u°î_node_cou¡
; i++) {

1560 
˛u°îNode
 *
node
 = 
c⁄fig
.
˛u°î_nodes
[
i
];

1561 i‡(!
node
) {

1562 
	`Ârötf
(
°dîr
, "InvÆid clu°îÇodê#%d\n", 
i
);

1563 
	`exô
(1);

1565 
	`¥ötf
("Ma°î %d: ", 
i
);

1566 i‡(
node
->
«me
Ë
	`¥ötf
("%s ",Çode->name);

1567 
	`¥ötf
("%s:%d\n", 
node
->
ù
,Çode->
p‹t
);

1568 
node
->
ªdis_c⁄fig
 = 
	`gëRedisC⁄fig
“ode->
ù
,Çode->
p‹t
, 
NULL
);

1569 i‡(
node
->
ªdis_c⁄fig
 =
NULL
) {

1570 
	`Ârötf
(
°dîr
, "WARN: couldÇot fetchÇode CONFIG %s:%d\n",

1571 
node
->
ù
,Çode->
p‹t
);

1574 
	`¥ötf
("\n");

1577 i‡(
c⁄fig
.
num_thªads
 == 0)

1578 
c⁄fig
.
num_thªads
 = c⁄fig.
˛u°î_node_cou¡
;

1580 
c⁄fig
.
ªdis_c⁄fig
 =

1581 
	`gëRedisC⁄fig
(
c⁄fig
.
ho°ù
, c⁄fig.
ho°p‹t
, c⁄fig.
ho°sockë
);

1582 i‡(
c⁄fig
.
ªdis_c⁄fig
 =
NULL
)

1583 
	`Ârötf
(
°dîr
, "WARN: couldÇot fetch server CONFIG\n");

1586 i‡(
c⁄fig
.
num_thªads
 > 0) {

1587 
	`±hªad_muãx_öô
(&(
c⁄fig
.
ªque°s_issued_muãx
), 
NULL
);

1588 
	`±hªad_muãx_öô
(&(
c⁄fig
.
ªque°s_föished_muãx
), 
NULL
);

1589 
	`±hªad_muãx_öô
(&(
c⁄fig
.
live˛õ¡s_muãx
), 
NULL
);

1590 
	`±hªad_muãx_öô
(&(
c⁄fig
.
is_„tchög_¶Ÿs_muãx
), 
NULL
);

1591 
	`±hªad_muãx_öô
(&(
c⁄fig
.
is_upd©ög_¶Ÿs_muãx
), 
NULL
);

1592 
	`±hªad_muãx_öô
(&(
c⁄fig
.
upd©ög_¶Ÿs_muãx
), 
NULL
);

1593 
	`±hªad_muãx_öô
(&(
c⁄fig
.
¶Ÿs_œ°_upd©e_muãx
), 
NULL
);

1596 i‡(
c⁄fig
.
kì∑live
 == 0) {

1597 
	`¥ötf
("WARNING: keepalive disabled, youÖrobablyÇeed 'echo 1 > /proc/sys/net/ipv4/tcp_tw_reuse' for Linuxánd 'sudo sysctl -wÇet.inet.tcp.msl=1000' for Mac OS X in orderÅo useáÜot of clients/requests\n");

1600 i‡(
c⁄fig
.
idÀmode
) {

1601 
	`¥ötf
("Cª©ög %d idÀ c⁄√˘i⁄†™d waôög f‹evî (Cål+C whí d⁄e)\n", 
c⁄fig
.
num˛õ¡s
);

1602 
thªad_id
 = -1, 
u£_thªads
 = (
c⁄fig
.
num_thªads
 > 0);

1603 i‡(
u£_thªads
) {

1604 
thªad_id
 = 0;

1605 
	`öôBíchm¨kThªads
();

1607 
c
 = 
	`¸óãClõ¡
("",0,
NULL
,
thªad_id
);

1608 
	`¸óãMissögClõ¡s
(
c
);

1609 i‡(
u£_thªads
Ë
	`°¨tBíchm¨kThªads
();

1610 
	`´Maö
(
c⁄fig
.
ñ
);

1615 i‡(
¨gc
) {

1616 
sds
 
tôÀ
 = 
	`sd¢ew
(
¨gv
[0]);

1617 
i
 = 1; i < 
¨gc
; i++) {

1618 
tôÀ
 = 
	`sdsˇéí
(title, " ", 1);

1619 
tôÀ
 = 
	`sdsˇéí
—ôÀ, (*)
¨gv
[
i
], 
	`°æí
(argv[i]));

1623 
Àn
 = 
	`ªdisF‹m©Comm™dArgv
(&
cmd
,
¨gc
,
¨gv
,
NULL
);

1624 
	`bíchm¨k
(
tôÀ
,
cmd
,
Àn
);

1625 
	`‰ì
(
cmd
);

1626 } 
c⁄fig
.
lo›
);

1628 i‡(
c⁄fig
.
ªdis_c⁄fig
 !
NULL
Ë
	`‰ìRedisC⁄fig
(config.redis_config);

1633 
d©a
 = 
	`zmÆloc
(
c⁄fig
.
d©asize
+1);

1635 
	`mem£t
(
d©a
,'x',
c⁄fig
.
d©asize
);

1636 
d©a
[
c⁄fig
.
d©asize
] = '\0';

1638 i‡(
	`ã°_is_£À˘ed
("ping_inline") ||Åest_is_selected("ping"))

1639 
	`bíchm¨k
("PING_INLINE","PING\r\n",6);

1641 i‡(
	`ã°_is_£À˘ed
("ping_mbulk") ||Åest_is_selected("ping")) {

1642 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"PING");

1643 
	`bíchm¨k
("PING_BULK",
cmd
,
Àn
);

1644 
	`‰ì
(
cmd
);

1647 i‡(
	`ã°_is_£À˘ed
("set")) {

1648 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"SET key:{èg}:__ønd_öt__ %s",
d©a
);

1649 
	`bíchm¨k
("SET",
cmd
,
Àn
);

1650 
	`‰ì
(
cmd
);

1653 i‡(
	`ã°_is_£À˘ed
("get")) {

1654 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"GET key:{tag}:__rand_int__");

1655 
	`bíchm¨k
("GET",
cmd
,
Àn
);

1656 
	`‰ì
(
cmd
);

1659 i‡(
	`ã°_is_£À˘ed
("incr")) {

1660 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"INCR counter:{tag}:__rand_int__");

1661 
	`bíchm¨k
("INCR",
cmd
,
Àn
);

1662 
	`‰ì
(
cmd
);

1665 i‡(
	`ã°_is_£À˘ed
("lpush")) {

1666 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"LPUSH myli°:{èg} %s",
d©a
);

1667 
	`bíchm¨k
("LPUSH",
cmd
,
Àn
);

1668 
	`‰ì
(
cmd
);

1671 i‡(
	`ã°_is_£À˘ed
("rpush")) {

1672 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"RPUSH myli°:{èg} %s",
d©a
);

1673 
	`bíchm¨k
("RPUSH",
cmd
,
Àn
);

1674 
	`‰ì
(
cmd
);

1677 i‡(
	`ã°_is_£À˘ed
("lpop")) {

1678 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"LPOP mylist:{tag}");

1679 
	`bíchm¨k
("LPOP",
cmd
,
Àn
);

1680 
	`‰ì
(
cmd
);

1683 i‡(
	`ã°_is_£À˘ed
("rpop")) {

1684 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"RPOP mylist:{tag}");

1685 
	`bíchm¨k
("RPOP",
cmd
,
Àn
);

1686 
	`‰ì
(
cmd
);

1689 i‡(
	`ã°_is_£À˘ed
("sadd")) {

1690 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,

1692 
	`bíchm¨k
("SADD",
cmd
,
Àn
);

1693 
	`‰ì
(
cmd
);

1696 i‡(
	`ã°_is_£À˘ed
("hset")) {

1697 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,

1698 "HSET myhash:{èg}:__ønd_öt__ÉÀmít:__ønd_öt__ %s",
d©a
);

1699 
	`bíchm¨k
("HSET",
cmd
,
Àn
);

1700 
	`‰ì
(
cmd
);

1703 i‡(
	`ã°_is_£À˘ed
("spop")) {

1704 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"SPOP myset:{tag}");

1705 
	`bíchm¨k
("SPOP",
cmd
,
Àn
);

1706 
	`‰ì
(
cmd
);

1709 i‡(
	`ã°_is_£À˘ed
("lrange") ||

1710 
	`ã°_is_£À˘ed
("lrange_100") ||

1711 
	`ã°_is_£À˘ed
("lrange_300") ||

1712 
	`ã°_is_£À˘ed
("lrange_500") ||

1713 
	`ã°_is_£À˘ed
("lrange_600"))

1715 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"LPUSH myli°:{èg} %s",
d©a
);

1716 
	`bíchm¨k
("LPUSH (√ededÅÿbíchm¨k LRANGE)",
cmd
,
Àn
);

1717 
	`‰ì
(
cmd
);

1720 i‡(
	`ã°_is_£À˘ed
("lrange") ||Åest_is_selected("lrange_100")) {

1721 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"LRANGE mylist:{tag} 0 99");

1722 
	`bíchm¨k
("LRANGE_100 (fú° 100ÉÀmíts)",
cmd
,
Àn
);

1723 
	`‰ì
(
cmd
);

1726 i‡(
	`ã°_is_£À˘ed
("lrange") ||Åest_is_selected("lrange_300")) {

1727 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"LRANGE mylist:{tag} 0 299");

1728 
	`bíchm¨k
("LRANGE_300 (fú° 300ÉÀmíts)",
cmd
,
Àn
);

1729 
	`‰ì
(
cmd
);

1732 i‡(
	`ã°_is_£À˘ed
("lrange") ||Åest_is_selected("lrange_500")) {

1733 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"LRANGE mylist:{tag} 0 449");

1734 
	`bíchm¨k
("LRANGE_500 (fú° 450ÉÀmíts)",
cmd
,
Àn
);

1735 
	`‰ì
(
cmd
);

1738 i‡(
	`ã°_is_£À˘ed
("lrange") ||Åest_is_selected("lrange_600")) {

1739 
Àn
 = 
	`ªdisF‹m©Comm™d
(&
cmd
,"LRANGE mylist:{tag} 0 599");

1740 
	`bíchm¨k
("LRANGE_600 (fú° 600ÉÀmíts)",
cmd
,
Àn
);

1741 
	`‰ì
(
cmd
);

1744 i‡(
	`ã°_is_£À˘ed
("mset")) {

1745 c⁄° *
¨gv
[21];

1746 
¨gv
[0] = "MSET";

1747 
i
 = 1; i < 21; i += 2) {

1748 
¨gv
[
i
] = "key:{tag}:__rand_int__";

1749 
¨gv
[
i
+1] = 
d©a
;

1751 
Àn
 = 
	`ªdisF‹m©Comm™dArgv
(&
cmd
,21,
¨gv
,
NULL
);

1752 
	`bíchm¨k
("MSET (10 keys)",
cmd
,
Àn
);

1753 
	`‰ì
(
cmd
);

1756 i‡(!
c⁄fig
.
csv
Ë
	`¥ötf
("\n");

1757 } 
c⁄fig
.
lo›
);

1759 i‡(
c⁄fig
.
ªdis_c⁄fig
 !
NULL
Ë
	`‰ìRedisC⁄fig
(config.redis_config);

1762 
	}
}

	@redis-check-aof.c

31 
	~"£rvî.h
"

32 
	~<sys/°©.h
>

34 
	#ERROR
(...) { \

35 
__buf
[1024]; \

36 
	`¢¥ötf
(
__buf
, (__buf), 
__VA_ARGS__
); \

37 
	`¢¥ötf
(
îr‹
, ”º‹), "0x%16Œx: %s", ()
ïos
, 
__buf
); \

38 }

	)

40 
	gîr‹
[1044];

41 
off_t
 
	gïos
;

43 
	$c⁄sumeNewlöe
(*
buf
) {

44 i‡(
	`°∫cmp
(
buf
,"\r\n",2) != 0) {

45 
	`ERROR
("Ex≥˘ed \\r\\n, gŸ: %02x%02x",
buf
[0],buf[1]);

49 
	}
}

51 
	$ªadL⁄g
(
FILE
 *
Â
, 
¥efix
, *
èrgë
) {

52 
buf
[128], *
ïå
;

53 
ïos
 = 
	`·ñlo
(
Â
);

54 i‡(
	`fgës
(
buf
,(buf),
Â
Ë=
NULL
) {

57 i‡(
buf
[0] !
¥efix
) {

58 
	`ERROR
("Ex≥˘edÖªfix '%c', gŸ: '%c'",
¥efix
,
buf
[0]);

61 *
èrgë
 = 
	`°πﬁ
(
buf
+1,&
ïå
,10);

62  
	`c⁄sumeNewlöe
(
ïå
);

63 
	}
}

65 
	$ªadByãs
(
FILE
 *
Â
, *
èrgë
, 
Àngth
) {

66 
ªÆ
;

67 
ïos
 = 
	`·ñlo
(
Â
);

68 
ªÆ
 = 
	`‰ód
(
èrgë
,1,
Àngth
,
Â
);

69 i‡(
ªÆ
 !
Àngth
) {

70 
	`ERROR
("Ex≥˘edÅÿªad %ld byãs, gŸ %ld byãs",
Àngth
,
ªÆ
);

74 
	}
}

76 
	$ªadSåög
(
FILE
 *
Â
, ** 
èrgë
) {

77 
Àn
;

78 *
èrgë
 = 
NULL
;

79 i‡(!
	`ªadL⁄g
(
Â
,'$',&
Àn
)) {

84 
Àn
 += 2;

85 *
èrgë
 = (*)
	`zmÆloc
(
Àn
);

86 i‡(!
	`ªadByãs
(
Â
,*
èrgë
,
Àn
)) {

89 i‡(!
	`c⁄sumeNewlöe
(*
èrgë
+
Àn
-2)) {

92 (*
èrgë
)[
Àn
-2] = '\0';

94 
	}
}

96 
	$ªadArgc
(
FILE
 *
Â
, *
èrgë
) {

97  
	`ªadL⁄g
(
Â
,'*',
èrgë
);

98 
	}
}

100 
off_t
 
	$¥o˚ss
(
FILE
 *
Â
) {

101 
¨gc
;

102 
off_t
 
pos
 = 0;

103 
i
, 
mu…i
 = 0;

104 *
°r
;

107 i‡(!
mu…i
Ë
pos
 = 
	`·ñlo
(
Â
);

108 i‡(!
	`ªadArgc
(
Â
, &
¨gc
)) ;

110 
i
 = 0; i < 
¨gc
; i++) {

111 i‡(!
	`ªadSåög
(
Â
,&
°r
)) ;

112 i‡(
i
 == 0) {

113 i‡(
	`°rˇ£cmp
(
°r
, "multi") == 0) {

114 i‡(
mu…i
++) {

115 
	`ERROR
("Unexpected MULTI");

118 } i‡(
	`°rˇ£cmp
(
°r
, "exec") == 0) {

119 i‡(--
mu…i
) {

120 
	`ERROR
("Unexpected EXEC");

125 
	`z‰ì
(
°r
);

129 i‡(
i
 < 
¨gc
) {

130 i‡(
°r
Ë
	`z‰ì
(str);

135 i‡(
	`„of
(
Â
Ë&& 
mu…i
 && 
	`°æí
(
îr‹
) == 0) {

136 
	`ERROR
("Reached EOF beforeÑeading EXEC for MULTI");

138 i‡(
	`°æí
(
îr‹
) > 0) {

139 
	`¥ötf
("%s\n", 
îr‹
);

141  
pos
;

142 
	}
}

144 
	$ªdis_check_aof_maö
(
¨gc
, **
¨gv
) {

145 *
fûíame
;

146 
fix
 = 0;

148 i‡(
¨gc
 < 2) {

149 
	`¥ötf
("Ußge: %†[--fix] <fûe.aof>\n", 
¨gv
[0]);

150 
	`exô
(1);

151 } i‡(
¨gc
 == 2) {

152 
fûíame
 = 
¨gv
[1];

153 } i‡(
¨gc
 == 3) {

154 i‡(
	`°rcmp
(
¨gv
[1],"--fix") != 0) {

155 
	`¥ötf
("InvÆidárgumít: %s\n", 
¨gv
[1]);

156 
	`exô
(1);

158 
fûíame
 = 
¨gv
[2];

159 
fix
 = 1;

161 
	`¥ötf
("Invalidárguments\n");

162 
	`exô
(1);

165 
FILE
 *
Â
 = 
	`f›í
(
fûíame
,"r+");

166 i‡(
Â
 =
NULL
) {

167 
	`¥ötf
("C™nŸ o≥¿fûe: %s\n", 
fûíame
);

168 
	`exô
(1);

171 
ªdis_°©
 
sb
;

172 i‡(
	`ªdis_f°©
(
	`fûío
(
Â
),&
sb
) == -1) {

173 
	`¥ötf
("C™nŸ sèàfûe: %s\n", 
fûíame
);

174 
	`exô
(1);

177 
off_t
 
size
 = 
sb
.
°_size
;

178 i‡(
size
 == 0) {

179 
	`¥ötf
("Em±y fûe: %s\n", 
fûíame
);

180 
	`exô
(1);

185 i‡(
size
 >= 8) {

186 
sig
[5];

187 
has_¥ómbÀ
 = 
	`‰ód
(
sig
,(sig),1,
Â
) == 1 &&

188 
	`memcmp
(
sig
,"REDIS",(sig)) == 0;

189 
	`ªwöd
(
Â
);

190 i‡(
has_¥ómbÀ
) {

191 
	`¥ötf
("The AOFáppearsÅo start withán RDBÖreamble.\n"

193 i‡(
	`ªdis_check_rdb_maö
(
¨gc
,
¨gv
,
Â
Ë=
C_ERR
) {

194 
	`¥ötf
("RDBÖreamble of AOF file isÇot sane,áborting.\n");

195 
	`exô
(1);

197 
	`¥ötf
("RDBÖreamble is OK,Öroceeding with AOFÅail...\n");

202 
off_t
 
pos
 = 
	`¥o˚ss
(
Â
);

203 
off_t
 
diff
 = 
size
-
pos
;

204 
	`¥ötf
("AOFánalyzed: size=%lld, ok_up_to=%lld, diff=%lld\n",

205 (Ë
size
, (Ë
pos
, (Ë
diff
);

206 i‡(
diff
 > 0) {

207 i‡(
fix
) {

208 
buf
[2];

209 
	`¥ötf
("Thi†wû»shrökÅhêAOF from %Œd byãs, wôh %Œd byãs,Åÿ%Œd byãs\n",()
size
,()
diff
,()
pos
);

210 
	`¥ötf
("Continue? [y/N]: ");

211 i‡(
	`fgës
(
buf
,(buf),
°dö
Ë=
NULL
 ||

212 
	`°∫ˇ£cmp
(
buf
,"y",1) != 0) {

213 
	`¥ötf
("Aborting...\n");

214 
	`exô
(1);

216 i‡(
	`·runˇã
(
	`fûío
(
Â
), 
pos
) == -1) {

217 
	`¥ötf
("FailedÅoÅruncate AOF\n");

218 
	`exô
(1);

220 
	`¥ötf
("SuccessfullyÅruncated AOF\n");

223 
	`¥ötf
("AOF isÇot valid. "

225 
	`exô
(1);

228 
	`¥ötf
("AOF is valid\n");

231 
	`f˛o£
(
Â
);

232 
	`exô
(0);

233 
	}
}

	@redis-check-rdb.c

30 
	~"£rvî.h
"

31 
	~"rdb.h
"

33 
	~<°d¨g.h
>

35 
¸óãSh¨edObje˘s
();

36 
rdbLﬂdProgªssCÆlback
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
);

37 
	grdbCheckMode
 = 0;

40 
rio
 *
	mrio
;

41 
robj
 *
	mkey
;

42 
	mkey_ty≥
;

43 
	mkeys
;

44 
	mexpúes
;

45 
	mÆªady_expúed
;

46 
	mdoög
;

47 
	mîr‹_£t
;

48 
	mîr‹
[1024];

49 } 
	grdb°©e
;

53 
	#RDB_CHECK_DOING_START
 0

	)

54 
	#RDB_CHECK_DOING_READ_TYPE
 1

	)

55 
	#RDB_CHECK_DOING_READ_EXPIRE
 2

	)

56 
	#RDB_CHECK_DOING_READ_KEY
 3

	)

57 
	#RDB_CHECK_DOING_READ_OBJECT_VALUE
 4

	)

58 
	#RDB_CHECK_DOING_CHECK_SUM
 5

	)

59 
	#RDB_CHECK_DOING_READ_LEN
 6

	)

60 
	#RDB_CHECK_DOING_READ_AUX
 7

	)

62 *
	grdb_check_doög_°rög
[] = {

73 *
	grdb_ty≥_°rög
[] = {

92 
	$rdbShowGíîicInfo
() {

93 
	`¥ötf
("[öfo] %lu key†ªad\n", 
rdb°©e
.
keys
);

94 
	`¥ötf
("[öfo] %luÉxpúes\n", 
rdb°©e
.
expúes
);

95 
	`¥ötf
("[öfo] %luáÃódyÉxpúed\n", 
rdb°©e
.
Æªady_expúed
);

96 
	}
}

100 
	$rdbCheckEº‹
(c⁄° *
fmt
, ...) {

101 
msg
[1024];

102 
va_li°
 
≠
;

104 
	`va_°¨t
(
≠
, 
fmt
);

105 
	`v¢¥ötf
(
msg
, (msg), 
fmt
, 
≠
);

106 
	`va_íd
(
≠
);

108 
	`¥ötf
("--- RDB ERROR DETECTED ---\n");

109 
	`¥ötf
("[offset %llu] %s\n",

110 (Ë(
rdb°©e
.
rio
 ?

111 
rdb°©e
.
rio
->
¥o˚s£d_byãs
 : 0), 
msg
);

112 
	`¥ötf
("[additional info] While doing: %s\n",

113 
rdb_check_doög_°rög
[
rdb°©e
.
doög
]);

114 i‡(
rdb°©e
.
key
)

115 
	`¥ötf
("[additional info] Reading key '%s'\n",

116 (*)
rdb°©e
.
key
->
±r
);

117 i‡(
rdb°©e
.
key_ty≥
 != -1)

118 
	`¥ötf
("[additional info] ReadingÅype %d (%s)\n",

119 
rdb°©e
.
key_ty≥
,

120 (()
rdb°©e
.
key_ty≥
 <

121 (
rdb_ty≥_°rög
)/(*)) ?

122 
rdb_ty≥_°rög
[
rdb°©e
.
key_ty≥
] : "unknown");

123 
	`rdbShowGíîicInfo
();

124 
	}
}

127 
	$rdbCheckInfo
(c⁄° *
fmt
, ...) {

128 
msg
[1024];

129 
va_li°
 
≠
;

131 
	`va_°¨t
(
≠
, 
fmt
);

132 
	`v¢¥ötf
(
msg
, (msg), 
fmt
, 
≠
);

133 
	`va_íd
(
≠
);

135 
	`¥ötf
("[offset %llu] %s\n",

136 (Ë(
rdb°©e
.
rio
 ?

137 
rdb°©e
.
rio
->
¥o˚s£d_byãs
 : 0), 
msg
);

138 
	}
}

142 
	$rdbCheckSëEº‹
(c⁄° *
fmt
, ...) {

143 
va_li°
 
≠
;

145 
	`va_°¨t
(
≠
, 
fmt
);

146 
	`v¢¥ötf
(
rdb°©e
.
îr‹
, ‘db°©e.îr‹), 
fmt
, 
≠
);

147 
	`va_íd
(
≠
);

148 
rdb°©e
.
îr‹_£t
 = 1;

149 
	}
}

154 
	$rdbCheckH™dÀCøsh
(
sig
, 
sigöfo_t
 *
öfo
, *
£¸ë
) {

155 
	`UNUSED
(
sig
);

156 
	`UNUSED
(
öfo
);

157 
	`UNUSED
(
£¸ë
);

159 
	`rdbCheckEº‹
("Server crash checkingÅhe specified RDB file!");

160 
	`exô
(1);

161 
	}
}

163 
	$rdbCheckSëupSig«ls
() {

164 
siga˘i⁄
 
a˘
;

166 
	`sigem±y£t
(&
a˘
.
ß_mask
);

167 
a˘
.
ß_Êags
 = 
SA_NODEFER
 | 
SA_RESETHAND
 | 
SA_SIGINFO
;

168 
a˘
.
ß_siga˘i⁄
 = 
rdbCheckH™dÀCøsh
;

169 
	`siga˘i⁄
(
SIGSEGV
, &
a˘
, 
NULL
);

170 
	`siga˘i⁄
(
SIGBUS
, &
a˘
, 
NULL
);

171 
	`siga˘i⁄
(
SIGFPE
, &
a˘
, 
NULL
);

172 
	`siga˘i⁄
(
SIGILL
, &
a˘
, 
NULL
);

173 
	}
}

179 
	$ªdis_check_rdb
(*
rdbfûíame
, 
FILE
 *
Â
) {

180 
uöt64_t
 
dbid
;

181 
ty≥
, 
rdbvî
;

182 
buf
[1024];

183 
expúëime
, 
now
 = 
	`m°ime
();

184 
rio
 
rdb
;

186 
˛o£fûe
 = (
Â
 =
NULL
);

187 i‡(
Â
 =
NULL
 && (Â = 
	`f›í
(
rdbfûíame
,"r")) == NULL)  1;

189 
	`rioInôWôhFûe
(&
rdb
,
Â
);

190 
rdb°©e
.
rio
 = &
rdb
;

191 
rdb
.
upd©e_cksum
 = 
rdbLﬂdProgªssCÆlback
;

192 i‡(
	`rioRód
(&
rdb
,
buf
,9Ë=0Ë
eo„º
;

193 
buf
[9] = '\0';

194 i‡(
	`memcmp
(
buf
,"REDIS",5) != 0) {

195 
	`rdbCheckEº‹
("Wrong signatureÅryingÅoÜoad DB from file");

196 
îr
;

198 
rdbvî
 = 
	`©oi
(
buf
+5);

199 i‡(
rdbvî
 < 1 ||Ñdbvî > 
RDB_VERSION
) {

200 
	`rdbCheckEº‹
("C™'àh™dÀ RDB f‹m© vîsi⁄ %d",
rdbvî
);

201 
îr
;

204 
expúëime
 = -1;

205 
	`°¨tLﬂdögFûe
(
Â
, 
rdbfûíame
, 
RDBFLAGS_NONE
);

207 
robj
 *
key
, *
vÆ
;

210 
rdb°©e
.
doög
 = 
RDB_CHECK_DOING_READ_TYPE
;

211 i‡((
ty≥
 = 
	`rdbLﬂdTy≥
(&
rdb
)Ë=-1Ë
eo„º
;

214 i‡(
ty≥
 =
RDB_OPCODE_EXPIRETIME
) {

215 
rdb°©e
.
doög
 = 
RDB_CHECK_DOING_READ_EXPIRE
;

219 
expúëime
 = 
	`rdbLﬂdTime
(&
rdb
);

220 
expúëime
 *= 1000;

221 i‡(
	`rioGëRódEº‹
(&
rdb
)Ë
eo„º
;

223 } i‡(
ty≥
 =
RDB_OPCODE_EXPIRETIME_MS
) {

226 
rdb°©e
.
doög
 = 
RDB_CHECK_DOING_READ_EXPIRE
;

227 
expúëime
 = 
	`rdbLﬂdMûli£c⁄dTime
(&
rdb
, 
rdbvî
);

228 i‡(
	`rioGëRódEº‹
(&
rdb
)Ë
eo„º
;

230 } i‡(
ty≥
 =
RDB_OPCODE_FREQ
) {

232 
uöt8_t
 
byã
;

233 i‡(
	`rioRód
(&
rdb
,&
byã
,1Ë=0Ë
eo„º
;

235 } i‡(
ty≥
 =
RDB_OPCODE_IDLE
) {

237 i‡(
	`rdbLﬂdLí
(&
rdb
,
NULL
Ë=
RDB_LENERR
Ë
eo„º
;

239 } i‡(
ty≥
 =
RDB_OPCODE_EOF
) {

242 } i‡(
ty≥
 =
RDB_OPCODE_SELECTDB
) {

244 
rdb°©e
.
doög
 = 
RDB_CHECK_DOING_READ_LEN
;

245 i‡((
dbid
 = 
	`rdbLﬂdLí
(&
rdb
,
NULL
)Ë=
RDB_LENERR
)

246 
eo„º
;

247 
	`rdbCheckInfo
("Sñe˘ög DB ID %d", 
dbid
);

249 } i‡(
ty≥
 =
RDB_OPCODE_RESIZEDB
) {

252 
uöt64_t
 
db_size
, 
expúes_size
;

253 
rdb°©e
.
doög
 = 
RDB_CHECK_DOING_READ_LEN
;

254 i‡((
db_size
 = 
	`rdbLﬂdLí
(&
rdb
,
NULL
)Ë=
RDB_LENERR
)

255 
eo„º
;

256 i‡((
expúes_size
 = 
	`rdbLﬂdLí
(&
rdb
,
NULL
)Ë=
RDB_LENERR
)

257 
eo„º
;

259 } i‡(
ty≥
 =
RDB_OPCODE_AUX
) {

265 
robj
 *
auxkey
, *
auxvÆ
;

266 
rdb°©e
.
doög
 = 
RDB_CHECK_DOING_READ_AUX
;

267 i‡((
auxkey
 = 
	`rdbLﬂdSåögObje˘
(&
rdb
)Ë=
NULL
Ë
eo„º
;

268 i‡((
auxvÆ
 = 
	`rdbLﬂdSåögObje˘
(&
rdb
)Ë=
NULL
Ë
eo„º
;

270 
	`rdbCheckInfo
("AUX FIELD %s = '%s'",

271 (*)
auxkey
->
±r
, (*)
auxvÆ
->ptr);

272 
	`de¸RefCou¡
(
auxkey
);

273 
	`de¸RefCou¡
(
auxvÆ
);

276 i‡(!
	`rdbIsObje˘Ty≥
(
ty≥
)) {

277 
	`rdbCheckEº‹
("InvÆid obje˘Åy≥: %d", 
ty≥
);

278 
îr
;

280 
rdb°©e
.
key_ty≥
 = 
ty≥
;

284 
rdb°©e
.
doög
 = 
RDB_CHECK_DOING_READ_KEY
;

285 i‡((
key
 = 
	`rdbLﬂdSåögObje˘
(&
rdb
)Ë=
NULL
Ë
eo„º
;

286 
rdb°©e
.
key
 = key;

287 
rdb°©e
.
keys
++;

289 
rdb°©e
.
doög
 = 
RDB_CHECK_DOING_READ_OBJECT_VALUE
;

290 i‡((
vÆ
 = 
	`rdbLﬂdObje˘
(
ty≥
,&
rdb
,
key
->
±r
)Ë=
NULL
Ë
eo„º
;

292 i‡(
expúëime
 !-1 &&Éxpúëimê< 
now
)

293 
rdb°©e
.
Æªady_expúed
++;

294 i‡(
expúëime
 !-1Ë
rdb°©e
.
expúes
++;

295 
rdb°©e
.
key
 = 
NULL
;

296 
	`de¸RefCou¡
(
key
);

297 
	`de¸RefCou¡
(
vÆ
);

298 
rdb°©e
.
key_ty≥
 = -1;

299 
expúëime
 = -1;

302 i‡(
rdbvî
 >5 && 
£rvî
.
rdb_checksum
) {

303 
uöt64_t
 
cksum
, 
ex≥˘ed
 = 
rdb
.cksum;

305 
rdb°©e
.
doög
 = 
RDB_CHECK_DOING_CHECK_SUM
;

306 i‡(
	`rioRód
(&
rdb
,&
cksum
,8Ë=0Ë
eo„º
;

307 
	`memªv64ifbe
(&
cksum
);

308 i‡(
cksum
 == 0) {

309 
	`rdbCheckInfo
("RDB file was saved with checksum disabled:Ço checkÖerformed.");

310 } i‡(
cksum
 !
ex≥˘ed
) {

311 
	`rdbCheckEº‹
("RDB CRCÉrror");

312 
îr
;

314 
	`rdbCheckInfo
("Checksum OK");

318 i‡(
˛o£fûe
Ë
	`f˛o£
(
Â
);

319 
	`°›Lﬂdög
(1);

322 
eo„º
:

323 i‡(
rdb°©e
.
îr‹_£t
) {

324 
	`rdbCheckEº‹
(
rdb°©e
.
îr‹
);

326 
	`rdbCheckEº‹
("Unexpected EOFÑeading RDB file");

328 
îr
:

329 i‡(
˛o£fûe
Ë
	`f˛o£
(
Â
);

330 
	`°›Lﬂdög
(0);

332 
	}
}

346 
	$ªdis_check_rdb_maö
(
¨gc
, **
¨gv
, 
FILE
 *
Â
) {

347 i‡(
¨gc
 !2 && 
Â
 =
NULL
) {

348 
	`Ârötf
(
°dîr
, "Ußge: %†<rdb-fûe-«me>\n", 
¨gv
[0]);

349 
	`exô
(1);

354 i‡(
sh¨ed
.
öãgîs
[0] =
NULL
)

355 
	`¸óãSh¨edObje˘s
();

356 
£rvî
.
lﬂdög_¥o˚ss_evíts_öãrvÆ_byãs
 = 0;

357 
rdbCheckMode
 = 1;

358 
	`rdbCheckInfo
("Checkög RDB fûê%s", 
¨gv
[1]);

359 
	`rdbCheckSëupSig«ls
();

360 
ªtvÆ
 = 
	`ªdis_check_rdb
(
¨gv
[1],
Â
);

361 i‡(
ªtvÆ
 == 0) {

362 
	`rdbCheckInfo
("\\o/ RDBÜooks OK! \\o/");

363 
	`rdbShowGíîicInfo
();

365 i‡(
Â
Ë (
ªtvÆ
 =0Ë? 
C_OK
 : 
C_ERR
;

366 
	`exô
(
ªtvÆ
);

367 
	}
}

	@redis-cli.c

31 
	~"fma¸os.h
"

32 
	~"vîsi⁄.h
"

34 
	~<°dio.h
>

35 
	~<°rög.h
>

36 
	~<°dlib.h
>

37 
	~<sig«l.h
>

38 
	~<uni°d.h
>

39 
	~<time.h
>

40 
	~<˘y≥.h
>

41 
	~<î∫o.h
>

42 
	~<sys/°©.h
>

43 
	~<sys/time.h
>

44 
	~<as£π.h
>

45 
	~<f˙é.h
>

46 
	~<limôs.h
>

47 
	~<m©h.h
>

49 
	~<húedis.h
>

50 #ifde‡
USE_OPENSSL


51 
	~<›ís¶/s¶.h
>

52 
	~<›ís¶/îr.h
>

53 
	~<húedis_s¶.h
>

55 
	~<sds.h
>

56 
	~"di˘.h
"

57 
	~"adli°.h
"

58 
	~"zmÆloc.h
"

59 
	~"löíoi£.h
"

60 
	~"hñp.h
"

61 
	~"™ë.h
"

62 
	~"´.h
"

64 
	#UNUSED
(
V
Ë((ËV)

	)

66 
	#OUTPUT_STANDARD
 0

	)

67 
	#OUTPUT_RAW
 1

	)

68 
	#OUTPUT_CSV
 2

	)

69 
	#REDIS_CLI_KEEPALIVE_INTERVAL
 15

	)

70 
	#REDIS_CLI_DEFAULT_PIPE_TIMEOUT
 30

	)

71 
	#REDIS_CLI_HISTFILE_ENV
 "REDISCLI_HISTFILE"

	)

72 
	#REDIS_CLI_HISTFILE_DEFAULT
 ".ªdis˛i_hi°‹y"

	)

73 
	#REDIS_CLI_RCFILE_ENV
 "REDISCLI_RCFILE"

	)

74 
	#REDIS_CLI_RCFILE_DEFAULT
 ".ªdis˛úc"

	)

75 
	#REDIS_CLI_AUTH_ENV
 "REDISCLI_AUTH"

	)

77 
	#CLUSTER_MANAGER_SLOTS
 16384

	)

78 
	#CLUSTER_MANAGER_MIGRATE_TIMEOUT
 60000

	)

79 
	#CLUSTER_MANAGER_MIGRATE_PIPELINE
 10

	)

80 
	#CLUSTER_MANAGER_REBALANCE_THRESHOLD
 2

	)

82 
	#CLUSTER_MANAGER_INVALID_HOST_ARG
 \

85 "™dÖ‹à(õ. 120.0.0.1 7000)\n"

	)

86 
	#CLUSTER_MANAGER_MODE
(Ë(
c⁄fig
.
˛u°î_m™agî_comm™d
.
«me
 !
NULL
)

	)

87 
	#CLUSTER_MANAGER_MASTERS_COUNT
(
nodes
, 
ª∂iˇs
Ë“odes/‘ïliˇ†+ 1))

	)

88 
	#CLUSTER_MANAGER_COMMAND
(
n
,...) \

89 (
	`ªdisComm™d
(
n
->
c⁄ãxt
, 
__VA_ARGS__
))

	)

91 
	#CLUSTER_MANAGER_NODE_ARRAY_FREE
(
¨øy
Ë
	`z‰ì
◊ºay->
Æloc
)

	)

93 
	#CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
n
, 
îr
) \

94 
	`˛u°îM™agîLogEº
("Node %s:%dÑeplied withÉrror:\n%s\n", \

95 
n
->
ù
,Ç->
p‹t
, 
îr
);

	)

97 
	#˛u°îM™agîLogInfo
(...) \

98 
	`˛u°îM™agîLog
(
CLUSTER_MANAGER_LOG_LVL_INFO
,
__VA_ARGS__
)

	)

100 
	#˛u°îM™agîLogEº
(...) \

101 
	`˛u°îM™agîLog
(
CLUSTER_MANAGER_LOG_LVL_ERR
,
__VA_ARGS__
)

	)

103 
	#˛u°îM™agîLogW¨n
(...) \

104 
	`˛u°îM™agîLog
(
CLUSTER_MANAGER_LOG_LVL_WARN
,
__VA_ARGS__
)

	)

106 
	#˛u°îM™agîLogOk
(...) \

107 
	`˛u°îM™agîLog
(
CLUSTER_MANAGER_LOG_LVL_SUCCESS
,
__VA_ARGS__
)

	)

109 
	#CLUSTER_MANAGER_FLAG_MYSELF
 1 << 0

	)

110 
	#CLUSTER_MANAGER_FLAG_SLAVE
 1 << 1

	)

111 
	#CLUSTER_MANAGER_FLAG_FRIEND
 1 << 2

	)

112 
	#CLUSTER_MANAGER_FLAG_NOADDR
 1 << 3

	)

113 
	#CLUSTER_MANAGER_FLAG_DISCONNECT
 1 << 4

	)

114 
	#CLUSTER_MANAGER_FLAG_FAIL
 1 << 5

	)

116 
	#CLUSTER_MANAGER_CMD_FLAG_FIX
 1 << 0

	)

117 
	#CLUSTER_MANAGER_CMD_FLAG_SLAVE
 1 << 1

	)

118 
	#CLUSTER_MANAGER_CMD_FLAG_YES
 1 << 2

	)

119 
	#CLUSTER_MANAGER_CMD_FLAG_AUTOWEIGHTS
 1 << 3

	)

120 
	#CLUSTER_MANAGER_CMD_FLAG_EMPTYMASTER
 1 << 4

	)

121 
	#CLUSTER_MANAGER_CMD_FLAG_SIMULATE
 1 << 5

	)

122 
	#CLUSTER_MANAGER_CMD_FLAG_REPLACE
 1 << 6

	)

123 
	#CLUSTER_MANAGER_CMD_FLAG_COPY
 1 << 7

	)

124 
	#CLUSTER_MANAGER_CMD_FLAG_COLOR
 1 << 8

	)

125 
	#CLUSTER_MANAGER_CMD_FLAG_CHECK_OWNERS
 1 << 9

	)

126 
	#CLUSTER_MANAGER_CMD_FLAG_FIX_WITH_UNREACHABLE_MASTERS
 1 << 10

	)

128 
	#CLUSTER_MANAGER_OPT_GETFRIENDS
 1 << 0

	)

129 
	#CLUSTER_MANAGER_OPT_COLD
 1 << 1

	)

130 
	#CLUSTER_MANAGER_OPT_UPDATE
 1 << 2

	)

131 
	#CLUSTER_MANAGER_OPT_QUIET
 1 << 6

	)

132 
	#CLUSTER_MANAGER_OPT_VERBOSE
 1 << 7

	)

134 
	#CLUSTER_MANAGER_LOG_LVL_INFO
 1

	)

135 
	#CLUSTER_MANAGER_LOG_LVL_WARN
 2

	)

136 
	#CLUSTER_MANAGER_LOG_LVL_ERR
 3

	)

137 
	#CLUSTER_MANAGER_LOG_LVL_SUCCESS
 4

	)

139 
	#CLUSTER_JOIN_CHECK_AFTER
 20

	)

141 
	#LOG_COLOR_BOLD
 "29;1m"

	)

142 
	#LOG_COLOR_RED
 "31;1m"

	)

143 
	#LOG_COLOR_GREEN
 "32;1m"

	)

144 
	#LOG_COLOR_YELLOW
 "33;1m"

	)

145 
	#LOG_COLOR_RESET
 "0m"

	)

148 
	#CC_FORCE
 (1<<0Ë

	)

149 
	#CC_QUIET
 (1<<1Ë

	)

152 
	g•e˘rum_∑Àâe_cﬁ‹_size
 = 19;

153 
	g•e˘rum_∑Àâe_cﬁ‹
[] = {0,233,234,235,237,239,241,243,245,247,144,143,142,184,226,214,208,202,196};

155 
	g•e˘rum_∑Àâe_m⁄o_size
 = 13;

156 
	g•e˘rum_∑Àâe_m⁄o
[] = {0,233,234,235,237,239,241,243,245,247,249,251,253};

159 *
	g•e˘rum_∑Àâe
;

160 
	g•e˘rum_∑Àâe_size
;

164 
uöt64_t
 
di˘SdsHash
(c⁄° *
key
);

165 
di˘SdsKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
,

166 c⁄° *
key2
);

167 
di˘SdsDe°ru˘‹
(*
¥ivd©a
, *
vÆ
);

168 
di˘Li°De°ru˘‹
(*
¥ivd©a
, *
vÆ
);

171 
	s˛u°îM™agîComm™d
 {

172 *
	m«me
;

173 
	m¨gc
;

174 **
	m¨gv
;

175 
	mÊags
;

176 
	mª∂iˇs
;

177 *
	m‰om
;

178 *
	mto
;

179 **
	mweight
;

180 
	mweight_¨gc
;

181 *
	mma°î_id
;

182 
	m¶Ÿs
;

183 
	mtimeout
;

184 
	mpùñöe
;

185 
	mthªshﬁd
;

186 *
	mbackup_dú
;

187 } 
	t˛u°îM™agîComm™d
;

189 
¸óãClu°îM™agîComm™d
(*
cmd«me
, 
¨gc
, **
¨gv
);

192 
ªdisC⁄ãxt
 *
	gc⁄ãxt
;

193 
	sc⁄fig
 {

194 *
	mho°ù
;

195 
	mho°p‹t
;

196 *
	mho°sockë
;

197 
	més
;

198 *
	m¢i
;

199 *
	mˇ˚π
;

200 *
	mˇ˚πdú
;

201 *
	m˚π
;

202 *
	mkey
;

203 
	mª≥©
;

204 
	möãrvÆ
;

205 
	mdbnum
;

206 
	möãø˘ive
;

207 
	mshutdown
;

208 
	mm⁄ô‹_mode
;

209 
	mpubsub_mode
;

210 
	mœãncy_mode
;

211 
	mœãncy_di°_mode
;

212 
	mœãncy_hi°‹y
;

213 
	mÃu_ã°_mode
;

214 
	mÃu_ã°_ßm∂e_size
;

215 
	m˛u°î_mode
;

216 
	m˛u°î_ªissue_comm™d
;

217 
	m¶ave_mode
;

218 
	mpùe_mode
;

219 
	mpùe_timeout
;

220 
	mgërdb_mode
;

221 
	m°©_mode
;

222 
	msˇn_mode
;

223 
	möåösic_œãncy_mode
;

224 
	möåösic_œãncy_duøti⁄
;

225 *
	m∑âîn
;

226 *
	mrdb_fûíame
;

227 
	mbigkeys
;

228 
	mmemkeys
;

229 
	mmemkeys_ßm∂es
;

230 
	mhŸkeys
;

231 
	m°dö¨g
;

232 *
	mauth
;

233 
	mask∑ss
;

234 *
	mu£r
;

235 
	mouçut
;

236 
sds
 
	mmb_dñim
;

237 
	m¥om±
[128];

238 *
	mevÆ
;

239 
	mevÆ_ldb
;

240 
	mevÆ_ldb_sync
;

241 
	mevÆ_ldb_íd
;

242 
	míabÀ_ldb_⁄_evÆ
;

243 
	mœ°_cmd_ty≥
;

244 
	mvîbo£
;

245 
˛u°îM™agîComm™d
 
	m˛u°î_m™agî_comm™d
;

246 
	mno_auth_w¨nög
;

247 
	mª•3
;

248 } 
	gc⁄fig
;

251 
	s¥ef
 {

252 
	mhöts
;

253 } 
	g¥ef
;

255 vﬁ©ûê
sig_©omic_t
 
	gf‹˚_ˇn˚l_lo›
 = 0;

256 
ußge
();

257 
¶aveMode
();

258 *
ªdisGôSHA1
();

259 *
ªdisGôDúty
();

260 
˛iC⁄√˘
(
f‹˚
);

262 *
gëInfoFõld
(*
öfo
, *
fõld
);

263 
gëL⁄gInfoFõld
(*
öfo
, *
fõld
);

269 
uöt16_t
 
¸c16
(c⁄° *
buf
, 
Àn
);

271 
	$u°ime
() {

272 
timevÆ
 
tv
;

273 
u°
;

275 
	`gëtimeofday
(&
tv
, 
NULL
);

276 
u°
 = (()
tv
.
tv_£c
)*1000000;

277 
u°
 +
tv
.
tv_u£c
;

278  
u°
;

279 
	}
}

281 
	$m°ime
() {

282  
	`u°ime
()/1000;

283 
	}
}

285 
	$˛iRe‰eshProm±
() {

286 i‡(
c⁄fig
.
evÆ_ldb
) ;

288 
sds
 
¥om±
 = 
	`sd£m±y
();

289 i‡(
c⁄fig
.
ho°sockë
 !
NULL
) {

290 
¥om±
 = 
	`sdsˇtfmt
’rom±,"ªdi†%s",
c⁄fig
.
ho°sockë
);

292 
addr
[256];

293 
	`™ëF‹m©Addr
(
addr
, ◊ddr), 
c⁄fig
.
ho°ù
, c⁄fig.
ho°p‹t
);

294 
¥om±
 = 
	`sdsˇéí
’rom±,
addr
,
	`°æí
(addr));

298 i‡(
c⁄fig
.
dbnum
 != 0)

299 
¥om±
 = 
	`sdsˇtfmt
’rom±,"[%i]",
c⁄fig
.
dbnum
);

302 
¥om±
 = 
	`sdsˇéí
(prompt,"> ",2);

303 
	`¢¥ötf
(
c⁄fig
.
¥om±
,(config.prompt),"%s",prompt);

304 
	`sds‰ì
(
¥om±
);

305 
	}
}

315 
sds
 
	$gëDŸfûeP©h
(*
ívovîride
, *
dŸfûíame
) {

316 *
∑th
 = 
NULL
;

317 
sds
 
dŸP©h
 = 
NULL
;

320 
∑th
 = 
	`gëív
(
ívovîride
);

321 i‡(
∑th
 !
NULL
 && *path != '\0') {

322 i‡(!
	`°rcmp
("/dev/nuŒ", 
∑th
)) {

323  
NULL
;

327 
dŸP©h
 = 
	`sd¢ew
(
∑th
);

329 *
home
 = 
	`gëív
("HOME");

330 i‡(
home
 !
NULL
 && *home != '\0') {

332 
dŸP©h
 = 
	`sdsˇçrötf
(
	`sd£m±y
(), "%s/%s", 
home
, 
dŸfûíame
);

335  
dŸP©h
;

336 
	}
}

339 
	#isHexCh¨
(
c
Ë(
	`isdigô
(cË|| (¯>'a' && c <'f'))

	)

340 
	#decodeHexCh¨
(
c
Ë(
	`isdigô
(cË? c - '0' : c - 'a' + 10)

	)

341 
	#decodeHex
(
h
, 
l
Ë((
	`decodeHexCh¨
(hË<< 4Ë+ decodeHexCh¨÷))

	)

343 
sds
 
	$≥r˚¡Decode
(c⁄° *
≥
, 
size_t
 
Àn
) {

344 c⁄° *
íd
 = 
≥
 + 
Àn
;

345 
sds
 
ªt
 = 
	`sd£m±y
();

346 c⁄° *
cuº
 = 
≥
;

348 
cuº
 < 
íd
) {

349 i‡(*
cuº
 == '%') {

350 i‡((
íd
 - 
cuº
) < 2) {

351 
	`Ârötf
(
°dîr
, "Incomplete URIÉncoding\n");

352 
	`exô
(1);

355 
h
 = 
	`tﬁowî
(*(++
cuº
));

356 
l
 = 
	`tﬁowî
(*(++
cuº
));

357 i‡(!
	`isHexCh¨
(
h
Ë|| !isHexCh¨(
l
)) {

358 
	`Ârötf
(
°dîr
, "Illegal character in URIÉncoding\n");

359 
	`exô
(1);

361 
c
 = 
	`decodeHex
(
h
, 
l
);

362 
ªt
 = 
	`sdsˇéí
‘ë, &
c
, 1);

363 
cuº
++;

365 
ªt
 = 
	`sdsˇéí
‘ë, 
cuº
++, 1);

369  
ªt
;

370 
	}
}

380 
	$∑r£RedisUri
(c⁄° *
uri
) {

382 c⁄° *
scheme
 = "redis://";

383 c⁄° *
cuº
 = 
uri
;

384 c⁄° *
íd
 = 
uri
 + 
	`°æí
(uri);

385 c⁄° *
u£röfo
, *
u£∫ame
, *
p‹t
, *
ho°
, *
∑th
;

388 i‡(
	`°∫ˇ£cmp
(
scheme
, 
cuº
, 
	`°æí
(scheme))) {

389 
	`Ârötf
(
°dîr
,"Invalid URI scheme\n");

390 
	`exô
(1);

392 
cuº
 +
	`°æí
(
scheme
);

393 i‡(
cuº
 =
íd
) ;

396 i‡((
u£röfo
 = 
	`°rchr
(
cuº
,'@'))) {

397 i‡((
u£∫ame
 = 
	`°rchr
(
cuº
, ':')Ë&& u£∫amê< 
u£röfo
) {

399 
cuº
 = 
u£∫ame
 + 1;

402 
c⁄fig
.
auth
 = 
	`≥r˚¡Decode
(
cuº
, 
u£röfo
 - curr);

403 
cuº
 = 
u£röfo
 + 1;

405 i‡(
cuº
 =
íd
) ;

408 
∑th
 = 
	`°rchr
(
cuº
, '/');

409 i‡(*
cuº
 != '/') {

410 
ho°
 = 
∑th
 ?Ö©h - 1 : 
íd
;

411 i‡((
p‹t
 = 
	`°rchr
(
cuº
, ':'))) {

412 
c⁄fig
.
ho°p‹t
 = 
	`©oi
(
p‹t
 + 1);

413 
ho°
 = 
p‹t
 - 1;

415 
c⁄fig
.
ho°ù
 = 
	`sd¢ewÀn
(
cuº
, 
ho°
 - curr + 1);

417 
cuº
 = 
∑th
 ?Ö©h + 1 : 
íd
;

418 i‡(
cuº
 =
íd
) ;

421 
c⁄fig
.
dbnum
 = 
	`©oi
(
cuº
);

422 
	}
}

424 
uöt64_t
 
	$di˘SdsHash
(c⁄° *
key
) {

425  
	`di˘GíHashFun˘i⁄
((*)
key
, 
	`sd¶í
((*)key));

426 
	}
}

428 
	$di˘SdsKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
,

429 c⁄° *
key2
)

431 
l1
,
l2
;

432 
	`DICT_NOTUSED
(
¥ivd©a
);

434 
l1
 = 
	`sd¶í
((
sds
)
key1
);

435 
l2
 = 
	`sd¶í
((
sds
)
key2
);

436 i‡(
l1
 !
l2
)  0;

437  
	`memcmp
(
key1
, 
key2
, 
l1
) == 0;

438 
	}
}

440 
	$di˘SdsDe°ru˘‹
(*
¥ivd©a
, *
vÆ
)

442 
	`DICT_NOTUSED
(
¥ivd©a
);

443 
	`sds‰ì
(
vÆ
);

444 
	}
}

446 
	$di˘Li°De°ru˘‹
(*
¥ivd©a
, *
vÆ
)

448 
	`DICT_NOTUSED
(
¥ivd©a
);

449 
	`li°Rñó£
((
li°
*)
vÆ
);

450 
	}
}

453 
	$_£rvîAs£π
(c⁄° *
e°r
, c⁄° *
fûe
, 
löe
) {

454 
	`Ârötf
(
°dîr
, "=== ASSERTION FAILED ===");

455 
	`Ârötf
(
°dîr
, "==> %s:%d '%s' i†nŸÅrue",
fûe
,
löe
,
e°r
);

457 
	}
}

463 
	#CLI_HELP_COMMAND
 1

	)

464 
	#CLI_HELP_GROUP
 2

	)

467 
	mty≥
;

468 
	m¨gc
;

469 
sds
 *
	m¨gv
;

470 
sds
 
	mfuŒ
;

473 
comm™dHñp
 *
	m‹g
;

474 } 
	thñpE¡ry
;

476 
hñpE¡ry
 *
	ghñpE¡rõs
;

477 
	ghñpE¡rõsLí
;

479 
sds
 
	$˛iVîsi⁄
() {

480 
sds
 
vîsi⁄
;

481 
vîsi⁄
 = 
	`sdsˇçrötf
(
	`sd£m±y
(), "%s", 
REDIS_VERSION
);

484 i‡(
	`°πﬁl
(
	`ªdisGôSHA1
(),
NULL
,16)) {

485 
vîsi⁄
 = 
	`sdsˇçrötf
(vîsi⁄, " (gô:%s", 
	`ªdisGôSHA1
());

486 i‡(
	`°πﬁl
(
	`ªdisGôDúty
(),
NULL
,10))

487 
vîsi⁄
 = 
	`sdsˇçrötf
(version, "-dirty");

488 
vîsi⁄
 = 
	`sdsˇt
(version, ")");

490  
vîsi⁄
;

491 
	}
}

493 
	$˛iInôHñp
() {

494 
comm™d¶í
 = (
comm™dHñp
)/(commandHelp);

495 
group¶í
 = (
comm™dGroups
)/(*);

496 
i
, 
Àn
, 
pos
 = 0;

497 
hñpE¡ry
 
tmp
;

499 
hñpE¡rõsLí
 = 
Àn
 = 
comm™d¶í
+
group¶í
;

500 
hñpE¡rõs
 = 
	`zmÆloc
((
hñpE¡ry
)*
Àn
);

502 
i
 = 0; i < 
group¶í
; i++) {

503 
tmp
.
¨gc
 = 1;

504 
tmp
.
¨gv
 = 
	`zmÆloc
((
sds
));

505 
tmp
.
¨gv
[0] = 
	`sdsˇçrötf
(
	`sd£m±y
(),"@%s",
comm™dGroups
[
i
]);

506 
tmp
.
fuŒ
 =Åmp.
¨gv
[0];

507 
tmp
.
ty≥
 = 
CLI_HELP_GROUP
;

508 
tmp
.
‹g
 = 
NULL
;

509 
hñpE¡rõs
[
pos
++] = 
tmp
;

512 
i
 = 0; i < 
comm™d¶í
; i++) {

513 
tmp
.
¨gv
 = 
	`sds•lô¨gs
(
comm™dHñp
[
i
].
«me
,&tmp.
¨gc
);

514 
tmp
.
fuŒ
 = 
	`sd¢ew
(
comm™dHñp
[
i
].
«me
);

515 
tmp
.
ty≥
 = 
CLI_HELP_COMMAND
;

516 
tmp
.
‹g
 = &
comm™dHñp
[
i
];

517 
hñpE¡rõs
[
pos
++] = 
tmp
;

519 
	}
}

526 
	$˛iI¡egøãHñp
() {

527 i‡(
	`˛iC⁄√˘
(
CC_QUIET
Ë=
REDIS_ERR
) ;

529 
ªdisRïly
 *
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
, "COMMAND");

530 if(
ª∂y
 =
NULL
 ||Ñïly->
ty≥
 !
REDIS_REPLY_ARRAY
) ;

534 
size_t
 
j
 = 0; j < 
ª∂y
->
ñemíts
; j++) {

535 
ªdisRïly
 *
íåy
 = 
ª∂y
->
ñemít
[
j
];

536 i‡(
íåy
->
ty≥
 !
REDIS_REPLY_ARRAY
 ||É¡ry->
ñemíts
 < 4 ||

537 
íåy
->
ñemít
[0]->
ty≥
 !
REDIS_REPLY_STRING
 ||

538 
íåy
->
ñemít
[1]->
ty≥
 !
REDIS_REPLY_INTEGER
 ||

539 
íåy
->
ñemít
[3]->
ty≥
 !
REDIS_REPLY_INTEGER
) ;

540 *
cmd«me
 = 
íåy
->
ñemít
[0]->
°r
;

541 
i
;

543 
i
 = 0; i < 
hñpE¡rõsLí
; i++) {

544 
hñpE¡ry
 *
he
 = 
hñpE¡rõs
+
i
;

545 i‡(!
	`°rˇ£cmp
(
he
->
¨gv
[0],
cmd«me
))

548 i‡(
i
 !
hñpE¡rõsLí
) ;

550 
hñpE¡rõsLí
++;

551 
hñpE¡rõs
 = 
	`zªÆloc
(hñpE¡rõs,(
hñpE¡ry
)*
hñpE¡rõsLí
);

552 
hñpE¡ry
 *
√w
 = 
hñpE¡rõs
+(
hñpE¡rõsLí
-1);

554 
√w
->
¨gc
 = 1;

555 
√w
->
¨gv
 = 
	`zmÆloc
((
sds
));

556 
√w
->
¨gv
[0] = 
	`sd¢ew
(
cmd«me
);

557 
√w
->
fuŒ
 =Çew->
¨gv
[0];

558 
√w
->
ty≥
 = 
CLI_HELP_COMMAND
;

559 
	`sd°ouµî
(
√w
->
¨gv
[0]);

561 
comm™dHñp
 *
ch
 = 
	`zmÆloc
((*ch));

562 
ch
->
«me
 = 
√w
->
¨gv
[0];

563 
ch
->
∑øms
 = 
	`sd£m±y
();

564 
¨gs
 = 
	`Œabs
(
íåy
->
ñemít
[1]->
öãgî
);

565 
¨gs
--;

566 i‡(
íåy
->
ñemít
[3]->
öãgî
 == 1) {

567 
ch
->
∑øms
 = 
	`sdsˇt
(ch->params,"key ");

568 
¨gs
--;

570 
¨gs
-- > 0Ë
ch
->
∑øms
 = 
	`sdsˇt
(ch->params,"arg ");

571 i‡(
íåy
->
ñemít
[1]->
öãgî
 < 0)

572 
ch
->
∑øms
 = 
	`sdsˇt
(ch->params,"...options...");

573 
ch
->
summ¨y
 = "HelpÇotávailable";

574 
ch
->
group
 = 0;

575 
ch
->
sö˚
 = "not known";

576 
√w
->
‹g
 = 
ch
;

578 
	`‰ìRïlyObje˘
(
ª∂y
);

579 
	}
}

582 
	$˛iOuçutComm™dHñp
(
comm™dHñp
 *
hñp
, 
group
) {

583 
	`¥ötf
("\r\¿ \x1b[1m%s\x1b[0m \x1b[90m%s\x1b[0m\r\n", 
hñp
->
«me
, hñp->
∑øms
);

584 
	`¥ötf
(" \x1b[33msumm¨y:\x1b[0m %s\r\n", 
hñp
->
summ¨y
);

585 
	`¥ötf
(" \x1b[33msö˚:\x1b[0m %s\r\n", 
hñp
->
sö˚
);

586 i‡(
group
) {

587 
	`¥ötf
(" \x1b[33mgroup:\x1b[0m %s\r\n", 
comm™dGroups
[
hñp
->
group
]);

589 
	}
}

592 
	$˛iOuçutGíîicHñp
() {

593 
sds
 
vîsi⁄
 = 
	`˛iVîsi⁄
();

594 
	`¥ötf
(

606 
vîsi⁄


608 
	`sds‰ì
(
vîsi⁄
);

609 
	}
}

612 
	$˛iOuçutHñp
(
¨gc
, **
¨gv
) {

613 
i
, 
j
, 
Àn
;

614 
group
 = -1;

615 
hñpE¡ry
 *
íåy
;

616 
comm™dHñp
 *
hñp
;

618 i‡(
¨gc
 == 0) {

619 
	`˛iOuçutGíîicHñp
();

621 } i‡(
¨gc
 > 0 && 
¨gv
[0][0] == '@') {

622 
Àn
 = (
comm™dGroups
)/(*);

623 
i
 = 0; i < 
Àn
; i++) {

624 i‡(
	`°rˇ£cmp
(
¨gv
[0]+1,
comm™dGroups
[
i
]) == 0) {

625 
group
 = 
i
;

631 
	`as£π
(
¨gc
 > 0);

632 
i
 = 0; i < 
hñpE¡rõsLí
; i++) {

633 
íåy
 = &
hñpE¡rõs
[
i
];

634 i‡(
íåy
->
ty≥
 !
CLI_HELP_COMMAND
) ;

636 
hñp
 = 
íåy
->
‹g
;

637 i‡(
group
 == -1) {

639 i‡(
¨gc
 =
íåy
->argc) {

640 
j
 = 0; j < 
¨gc
; j++) {

641 i‡(
	`°rˇ£cmp
(
¨gv
[
j
],
íåy
->argv[j]) != 0) ;

643 i‡(
j
 =
¨gc
) {

644 
	`˛iOuçutComm™dHñp
(
hñp
,1);

648 i‡(
group
 =
hñp
->group) {

649 
	`˛iOuçutComm™dHñp
(
hñp
,0);

653 
	`¥ötf
("\r\n");

654 
	}
}

657 
	$com∂ëi⁄CÆlback
(c⁄° *
buf
, 
löíoi£Com∂ëi⁄s
 *
lc
) {

658 
size_t
 
°¨ços
 = 0;

659 
mask
;

660 
i
;

661 
size_t
 
m©chÀn
;

662 
sds
 
tmp
;

664 i‡(
	`°∫ˇ£cmp
(
buf
,"help ",5) == 0) {

665 
°¨ços
 = 5;

666 
	`is•a˚
(
buf
[
°¨ços
])) startpos++;

667 
mask
 = 
CLI_HELP_COMMAND
 | 
CLI_HELP_GROUP
;

669 
mask
 = 
CLI_HELP_COMMAND
;

672 
i
 = 0; i < 
hñpE¡rõsLí
; i++) {

673 i‡(!(
hñpE¡rõs
[
i
].
ty≥
 & 
mask
)) ;

675 
m©chÀn
 = 
	`°æí
(
buf
+
°¨ços
);

676 i‡(
	`°∫ˇ£cmp
(
buf
+
°¨ços
,
hñpE¡rõs
[
i
].
fuŒ
,
m©chÀn
) == 0) {

677 
tmp
 = 
	`sd¢ewÀn
(
buf
,
°¨ços
);

678 
tmp
 = 
	`sdsˇt
—mp,
hñpE¡rõs
[
i
].
fuŒ
);

679 
	`löíoi£AddCom∂ëi⁄
(
lc
,
tmp
);

680 
	`sds‰ì
(
tmp
);

683 
	}
}

686 *
	$hötsCÆlback
(c⁄° *
buf
, *
cﬁ‹
, *
bﬁd
) {

687 i‡(!
¥ef
.
höts
Ë 
NULL
;

689 
i
, 
¨gc
, 
buÊí
 = 
	`°æí
(
buf
);

690 
sds
 *
¨gv
 = 
	`sds•lô¨gs
(
buf
,&
¨gc
);

691 
íd•a˚
 = 
buÊí
 && 
	`is•a˚
(
buf
[buflen-1]);

694 i‡(
¨gc
 == 0) {

695 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

696  
NULL
;

699 
i
 = 0; i < 
hñpE¡rõsLí
; i++) {

700 i‡(!(
hñpE¡rõs
[
i
].
ty≥
 & 
CLI_HELP_COMMAND
)) ;

702 i‡(
	`°rˇ£cmp
(
¨gv
[0],
hñpE¡rõs
[
i
].
fuŒ
) == 0 ||

703 
	`°rˇ£cmp
(
buf
,
hñpE¡rõs
[
i
].
fuŒ
) == 0)

705 *
cﬁ‹
 = 90;

706 *
bﬁd
 = 0;

707 
sds
 
höt
 = 
	`sd¢ew
(
hñpE¡rõs
[
i
].
‹g
->
∑øms
);

711 
t‹emove
 = 
¨gc
-1;

712 
t‹emove
 > 0 && 
	`sd¶í
(
höt
)) {

713 i‡(
höt
[0] == '[') ;

714 i‡(
höt
[0] =' 'Ë
t‹emove
--;

715 
	`sd§™ge
(
höt
,1,-1);

719 i‡(!
íd•a˚
) {

720 
sds
 
√whöt
 = 
	`sd¢ewÀn
(" ",1);

721 
√whöt
 = 
	`sdsˇtsds
“ewhöt,
höt
);

722 
	`sds‰ì
(
höt
);

723 
höt
 = 
√whöt
;

726 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

727  
höt
;

730 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

731  
NULL
;

732 
	}
}

734 
	$‰ìHötsCÆlback
(*
±r
) {

735 
	`sds‰ì
(
±r
);

736 
	}
}

743 
	$˛iAuth
() {

744 
ªdisRïly
 *
ª∂y
;

745 i‡(
c⁄fig
.
auth
 =
NULL
Ë 
REDIS_OK
;

747 i‡(
c⁄fig
.
u£r
 =
NULL
)

748 
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
,"AUTH %s",
c⁄fig
.
auth
);

750 
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
,"AUTH %†%s",
c⁄fig
.
u£r
,c⁄fig.
auth
);

751 i‡(
ª∂y
 !
NULL
) {

752 i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
)

753 
	`Ârötf
(
°dîr
,"Warning: AUTH failed\n");

754 
	`‰ìRïlyObje˘
(
ª∂y
);

755  
REDIS_OK
;

757  
REDIS_ERR
;

758 
	}
}

761 
	$˛iSñe˘
() {

762 
ªdisRïly
 *
ª∂y
;

763 i‡(
c⁄fig
.
dbnum
 =0Ë 
REDIS_OK
;

765 
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
,"SELECT %d",
c⁄fig
.
dbnum
);

766 i‡(
ª∂y
 !
NULL
) {

767 
ªsu…
 = 
REDIS_OK
;

768 i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
Ë
ªsu…
 = 
REDIS_ERR
;

769 
	`‰ìRïlyObje˘
(
ª∂y
);

770  
ªsu…
;

772  
REDIS_ERR
;

773 
	}
}

778 
	$˛iSecuªC⁄√˘i⁄
(
ªdisC⁄ãxt
 *
c
, c⁄° **
îr
) {

779 #ifde‡
USE_OPENSSL


780 
SSL_CTX
 *
s¶_˘x
 = 
NULL
;

782 i‡(!
s¶_˘x
) {

783 
s¶_˘x
 = 
	`SSL_CTX_√w
(
	`SSLv23_˛õ¡_mëhod
());

784 i‡(!
s¶_˘x
) {

785 *
îr
 = "FailedÅo create SSL_CTX";

786 
îr‹
;

789 
	`SSL_CTX_£t_›ti⁄s
(
s¶_˘x
, 
SSL_OP_NO_SSLv2
 | 
SSL_OP_NO_SSLv3
);

790 
	`SSL_CTX_£t_vîify
(
s¶_˘x
, 
SSL_VERIFY_PEER
, 
NULL
);

792 i‡(
c⁄fig
.
ˇ˚π
 || c⁄fig.
ˇ˚πdú
) {

793 i‡(!
	`SSL_CTX_lﬂd_vîify_loˇti⁄s
(
s¶_˘x
, 
c⁄fig
.
ˇ˚π
, c⁄fig.
ˇ˚πdú
)) {

794 *
îr
 = "Invalid CA Certificate File/Directory";

795 
îr‹
;

798 i‡(!
	`SSL_CTX_£t_deÁu…_vîify_∑ths
(
s¶_˘x
)) {

799 *
îr
 = "FailedÅo use default CAÖaths";

800 
îr‹
;

804 i‡(
c⁄fig
.
˚π
 && !
	`SSL_CTX_u£_˚πifiˇã_chaö_fûe
(
s¶_˘x
, config.cert)) {

805 *
îr
 = "Invalid client certificate";

806 
îr‹
;

809 i‡(
c⁄fig
.
key
 && !
	`SSL_CTX_u£_Priv©eKey_fûe
(
s¶_˘x
, c⁄fig.key, 
SSL_FILETYPE_PEM
)) {

810 *
îr
 = "InvalidÖrivate key";

811 
îr‹
;

815 
SSL
 *
s¶
 = 
	`SSL_√w
(
s¶_˘x
);

816 i‡(!
s¶
) {

817 *
îr
 = "FailedÅo create SSL object";

818  
REDIS_ERR
;

821 i‡(
c⁄fig
.
¢i
 && !
	`SSL_£t_é£xt_ho°_«me
(
s¶
, config.sni)) {

822 *
îr
 = "FailedÅo configure SNI";

823 
	`SSL_‰ì
(
s¶
);

824  
REDIS_ERR
;

827  
	`ªdisInôüãSSL
(
c
, 
s¶
);

829 
îr‹
:

830 
	`SSL_CTX_‰ì
(
s¶_˘x
);

831 
s¶_˘x
 = 
NULL
;

832  
REDIS_ERR
;

834 (Ë
c
;

835 (Ë
îr
;

836  
REDIS_OK
;

838 
	}
}

841 
	$˛iSwôchPrŸo
() {

842 
ªdisRïly
 *
ª∂y
;

843 i‡(
c⁄fig
.
ª•3
 =0Ë 
REDIS_OK
;

845 
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
,"HELLO 3");

846 i‡(
ª∂y
 !
NULL
) {

847 
ªsu…
 = 
REDIS_OK
;

848 i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
Ë
ªsu…
 = 
REDIS_ERR
;

849 
	`‰ìRïlyObje˘
(
ª∂y
);

850  
ªsu…
;

852  
REDIS_ERR
;

853 
	}
}

859 
	$˛iC⁄√˘
(
Êags
) {

860 i‡(
c⁄ãxt
 =
NULL
 || 
Êags
 & 
CC_FORCE
) {

861 i‡(
c⁄ãxt
 !
NULL
) {

862 
	`ªdisFªe
(
c⁄ãxt
);

865 i‡(
c⁄fig
.
ho°sockë
 =
NULL
) {

866 
c⁄ãxt
 = 
	`ªdisC⁄√˘
(
c⁄fig
.
ho°ù
,c⁄fig.
ho°p‹t
);

868 
c⁄ãxt
 = 
	`ªdisC⁄√˘Unix
(
c⁄fig
.
ho°sockë
);

871 i‡(!
c⁄ãxt
->
îr
 && 
c⁄fig
.
és
) {

872 c⁄° *
îr
 = 
NULL
;

873 i‡(
	`˛iSecuªC⁄√˘i⁄
(
c⁄ãxt
, &
îr
Ë=
REDIS_ERR
 &&Érr) {

874 
	`Ârötf
(
°dîr
, "CouldÇŸÇegŸüãá TLS c⁄√˘i⁄: %s\n", 
îr
);

875 
c⁄ãxt
 = 
NULL
;

876 
	`ªdisFªe
(
c⁄ãxt
);

877  
REDIS_ERR
;

881 i‡(
c⁄ãxt
->
îr
) {

882 i‡(!(
Êags
 & 
CC_QUIET
)) {

883 
	`Ârötf
(
°dîr
,"CouldÇot connectÅo Redisát ");

884 i‡(
c⁄fig
.
ho°sockë
 =
NULL
)

885 
	`Ârötf
(
°dîr
,"%s:%d: %s\n",

886 
c⁄fig
.
ho°ù
,c⁄fig.
ho°p‹t
,
c⁄ãxt
->
îr°r
);

888 
	`Ârötf
(
°dîr
,"%s: %s\n",

889 
c⁄fig
.
ho°sockë
,
c⁄ãxt
->
îr°r
);

891 
	`ªdisFªe
(
c⁄ãxt
);

892 
c⁄ãxt
 = 
NULL
;

893  
REDIS_ERR
;

901 
	`™ëKìpAlive
(
NULL
, 
c⁄ãxt
->
fd
, 
REDIS_CLI_KEEPALIVE_INTERVAL
);

904 i‡(
	`˛iAuth
(Ë!
REDIS_OK
)

905  
REDIS_ERR
;

906 i‡(
	`˛iSñe˘
(Ë!
REDIS_OK
)

907  
REDIS_ERR
;

908 i‡(
	`˛iSwôchPrŸo
(Ë!
REDIS_OK
)

909  
REDIS_ERR
;

911  
REDIS_OK
;

912 
	}
}

914 
	$˛iPrötC⁄ãxtEº‹
() {

915 i‡(
c⁄ãxt
 =
NULL
) ;

916 
	`Ârötf
(
°dîr
,"Eº‹: %s\n",
c⁄ãxt
->
îr°r
);

917 
	}
}

919 
sds
 
	$˛iF‹m©RïlyTTY
(
ªdisRïly
 *
r
, *
¥efix
) {

920 
sds
 
out
 = 
	`sd£m±y
();

921 
r
->
ty≥
) {

922 
REDIS_REPLY_ERROR
:

923 
out
 = 
	`sdsˇçrötf
(out,"”º‹Ë%s\n", 
r
->
°r
);

925 
REDIS_REPLY_STATUS
:

926 
out
 = 
	`sdsˇt
(out,
r
->
°r
);

927 
out
 = 
	`sdsˇt
(out,"\n");

929 
REDIS_REPLY_INTEGER
:

930 
out
 = 
	`sdsˇçrötf
(out,"(öãgîË%Œd\n",
r
->
öãgî
);

932 
REDIS_REPLY_DOUBLE
:

933 
out
 = 
	`sdsˇçrötf
(out,"(doubÀË%s\n",
r
->
°r
);

935 
REDIS_REPLY_STRING
:

936 
REDIS_REPLY_VERB
:

940 i‡(
r
->
ty≥
 =
REDIS_REPLY_STRING
) {

941 
out
 = 
	`sdsˇåïr
(out,
r
->
°r
,r->
Àn
);

942 
out
 = 
	`sdsˇt
(out,"\n");

944 
out
 = 
	`sdsˇéí
(out,
r
->
°r
,r->
Àn
);

945 
out
 = 
	`sdsˇt
(out,"\n");

948 
REDIS_REPLY_NIL
:

949 
out
 = 
	`sdsˇt
(out,"(nil)\n");

951 
REDIS_REPLY_BOOL
:

952 
out
 = 
	`sdsˇt
(out,
r
->
öãgî
 ? "(true)\n" : "(false)\n");

954 
REDIS_REPLY_ARRAY
:

955 
REDIS_REPLY_MAP
:

956 
REDIS_REPLY_SET
:

957 i‡(
r
->
ñemíts
 == 0) {

958 i‡(
r
->
ty≥
 =
REDIS_REPLY_ARRAY
)

959 
out
 = 
	`sdsˇt
(out,"(emptyárray)\n");

960 i‡(
r
->
ty≥
 =
REDIS_REPLY_MAP
)

961 
out
 = 
	`sdsˇt
(out,"(empty hash)\n");

962 i‡(
r
->
ty≥
 =
REDIS_REPLY_SET
)

963 
out
 = 
	`sdsˇt
(out,"(empty set)\n");

965 
out
 = 
	`sdsˇt
(out,"(emptyággregateÅype)\n");

967 
i
, 
idxÀn
 = 0;

968 
_¥efixÀn
[16];

969 
_¥efixfmt
[16];

970 
sds
 
_¥efix
;

971 
sds
 
tmp
;

974 
i
 = 
r
->
ñemíts
;

975 i‡(
r
->
ty≥
 =
REDIS_REPLY_MAP
Ë
i
 /= 2;

977 
idxÀn
++;

978 
i
 /= 10;

979 } 
i
);

982 
	`mem£t
(
_¥efixÀn
,' ',
idxÀn
+2);

983 
_¥efixÀn
[
idxÀn
+2] = '\0';

984 
_¥efix
 = 
	`sdsˇt
(
	`sd¢ew
(
¥efix
),
_¥efixÀn
);

987 
num£p
;

988 i‡(
r
->
ty≥
 =
REDIS_REPLY_SET
Ë
num£p
 = '~';

989 i‡(
r
->
ty≥
 =
REDIS_REPLY_MAP
Ë
num£p
 = '#';

990 
num£p
 = ')';

991 
	`¢¥ötf
(
_¥efixfmt
,(_¥efixfmt),"%%s%%%ud%¯",
idxÀn
,
num£p
);

993 
i
 = 0; i < 
r
->
ñemíts
; i++) {

994 
hum™_idx
 = (
r
->
ty≥
 =
REDIS_REPLY_MAP
) ?

995 
i
/2 : i;

996 
hum™_idx
++;

1000 
out
 = 
	`sdsˇçrötf
(out,
_¥efixfmt
,
i
 =0 ? "" : 
¥efix
,
hum™_idx
);

1003 
tmp
 = 
	`˛iF‹m©RïlyTTY
(
r
->
ñemít
[
i
],
_¥efix
);

1004 
out
 = 
	`sdsˇéí
(out,
tmp
,
	`sd¶í
(tmp));

1005 
	`sds‰ì
(
tmp
);

1008 i‡(
r
->
ty≥
 =
REDIS_REPLY_MAP
) {

1009 
i
++;

1010 
	`sd§™ge
(
out
,0,-2);

1011 
out
 = 
	`sdsˇt
(out," => ");

1012 
tmp
 = 
	`˛iF‹m©RïlyTTY
(
r
->
ñemít
[
i
],
_¥efix
);

1013 
out
 = 
	`sdsˇéí
(out,
tmp
,
	`sd¶í
(tmp));

1014 
	`sds‰ì
(
tmp
);

1017 
	`sds‰ì
(
_¥efix
);

1021 
	`Ârötf
(
°dîr
,"Unknow¿ª∂yÅy≥: %d\n", 
r
->
ty≥
);

1022 
	`exô
(1);

1024  
out
;

1025 
	}
}

1027 
	$isCﬁ‹Tîm
() {

1028 *
t
 = 
	`gëív
("TERM");

1029  
t
 !
NULL
 && 
	`°r°r
(t,"xterm") != NULL;

1030 
	}
}

1034 
sds
 
	$sdsˇtcﬁ‹
(
sds
 
o
, *
s
, 
size_t
 
Àn
, *
cﬁ‹
) {

1035 i‡(!
	`isCﬁ‹Tîm
()Ë 
	`sdsˇéí
(
o
,
s
,
Àn
);

1037 
bﬁd
 = 
	`°r°r
(
cﬁ‹
,"bﬁd"Ë!
NULL
;

1038 
ccode
 = 37;

1039 i‡(
	`°r°r
(
cﬁ‹
,"ªd")Ë
ccode
 = 31;

1040 i‡(
	`°r°r
(
cﬁ‹
,"gªí")Ë
ccode
 = 32;

1041 i‡(
	`°r°r
(
cﬁ‹
,"yñlow")Ë
ccode
 = 33;

1042 i‡(
	`°r°r
(
cﬁ‹
,"blue")Ë
ccode
 = 34;

1043 i‡(
	`°r°r
(
cﬁ‹
,"magíè")Ë
ccode
 = 35;

1044 i‡(
	`°r°r
(
cﬁ‹
,"cy™")Ë
ccode
 = 36;

1045 i‡(
	`°r°r
(
cﬁ‹
,"whôe")Ë
ccode
 = 37;

1047 
o
 = 
	`sdsˇtfmt
(o,"\033[%i;%i;49m",
bﬁd
,
ccode
);

1048 
o
 = 
	`sdsˇéí
(o,
s
,
Àn
);

1049 
o
 = 
	`sdsˇt
(o,"\033[0m");

1050  
o
;

1051 
	}
}

1055 
sds
 
	$sdsC©Cﬁ‹izedLdbRïly
(
sds
 
o
, *
s
, 
size_t
 
Àn
) {

1056 *
cﬁ‹
 = "white";

1058 i‡(
	`°r°r
(
s
,"<debug>")Ë
cﬁ‹
 = "bold";

1059 i‡(
	`°r°r
(
s
,"<ªdis>")Ë
cﬁ‹
 = "green";

1060 i‡(
	`°r°r
(
s
,"<ª∂y>")Ë
cﬁ‹
 = "cyan";

1061 i‡(
	`°r°r
(
s
,"<îr‹>")Ë
cﬁ‹
 = "red";

1062 i‡(
	`°r°r
(
s
,"<höt>")Ë
cﬁ‹
 = "bold";

1063 i‡(
	`°r°r
(
s
,"<vÆue>"Ë|| så°r(s,"<ªtvÆ>")Ë
cﬁ‹
 = "magenta";

1064 i‡(
Àn
 > 4 && 
	`isdigô
(
s
[3])) {

1065 i‡(
s
[1] ='>'Ë
cﬁ‹
 = "yellow";

1066 i‡(
s
[2] ='#'Ë
cﬁ‹
 = "bold";

1068  
	`sdsˇtcﬁ‹
(
o
,
s
,
Àn
,
cﬁ‹
);

1069 
	}
}

1071 
sds
 
	$˛iF‹m©RïlyRaw
(
ªdisRïly
 *
r
) {

1072 
sds
 
out
 = 
	`sd£m±y
(), 
tmp
;

1073 
size_t
 
i
;

1075 
r
->
ty≥
) {

1076 
REDIS_REPLY_NIL
:

1079 
REDIS_REPLY_ERROR
:

1080 
out
 = 
	`sdsˇéí
(out,
r
->
°r
,r->
Àn
);

1081 
out
 = 
	`sdsˇéí
(out,"\n",1);

1083 
REDIS_REPLY_STATUS
:

1084 
REDIS_REPLY_STRING
:

1085 
REDIS_REPLY_VERB
:

1086 i‡(
r
->
ty≥
 =
REDIS_REPLY_STATUS
 && 
c⁄fig
.
evÆ_ldb
) {

1092 i‡(
	`°r°r
(
r
->
°r
,"<endsession>") ==Ñ->str) {

1093 
c⁄fig
.
íabÀ_ldb_⁄_evÆ
 = 0;

1094 
c⁄fig
.
evÆ_ldb
 = 0;

1095 
c⁄fig
.
evÆ_ldb_íd
 = 1;

1096 
c⁄fig
.
ouçut
 = 
OUTPUT_STANDARD
;

1097 
	`˛iRe‰eshProm±
();

1099 
out
 = 
	`sdsC©Cﬁ‹izedLdbRïly
(out,
r
->
°r
,r->
Àn
);

1102 
out
 = 
	`sdsˇéí
(out,
r
->
°r
,r->
Àn
);

1105 
REDIS_REPLY_BOOL
:

1106 
out
 = 
	`sdsˇt
(out,
r
->
öãgî
 ? "(true)" : "(false)");

1108 
REDIS_REPLY_INTEGER
:

1109 
out
 = 
	`sdsˇçrötf
(out,"%Œd",
r
->
öãgî
);

1111 
REDIS_REPLY_DOUBLE
:

1112 
out
 = 
	`sdsˇçrötf
(out,"%s",
r
->
°r
);

1114 
REDIS_REPLY_ARRAY
:

1115 
i
 = 0; i < 
r
->
ñemíts
; i++) {

1116 i‡(
i
 > 0Ë
out
 = 
	`sdsˇt
(out,
c⁄fig
.
mb_dñim
);

1117 
tmp
 = 
	`˛iF‹m©RïlyRaw
(
r
->
ñemít
[
i
]);

1118 
out
 = 
	`sdsˇéí
(out,
tmp
,
	`sd¶í
(tmp));

1119 
	`sds‰ì
(
tmp
);

1122 
REDIS_REPLY_MAP
:

1123 
i
 = 0; i < 
r
->
ñemíts
; i += 2) {

1124 i‡(
i
 > 0Ë
out
 = 
	`sdsˇt
(out,
c⁄fig
.
mb_dñim
);

1125 
tmp
 = 
	`˛iF‹m©RïlyRaw
(
r
->
ñemít
[
i
]);

1126 
out
 = 
	`sdsˇéí
(out,
tmp
,
	`sd¶í
(tmp));

1127 
	`sds‰ì
(
tmp
);

1129 
out
 = 
	`sdsˇéí
(out," ",1);

1130 
tmp
 = 
	`˛iF‹m©RïlyRaw
(
r
->
ñemít
[
i
+1]);

1131 
out
 = 
	`sdsˇéí
(out,
tmp
,
	`sd¶í
(tmp));

1132 
	`sds‰ì
(
tmp
);

1136 
	`Ârötf
(
°dîr
,"Unknow¿ª∂yÅy≥: %d\n", 
r
->
ty≥
);

1137 
	`exô
(1);

1139  
out
;

1140 
	}
}

1142 
sds
 
	$˛iF‹m©RïlyCSV
(
ªdisRïly
 *
r
) {

1143 
i
;

1145 
sds
 
out
 = 
	`sd£m±y
();

1146 
r
->
ty≥
) {

1147 
REDIS_REPLY_ERROR
:

1148 
out
 = 
	`sdsˇt
(out,"ERROR,");

1149 
out
 = 
	`sdsˇåïr
(out,
r
->
°r
,
	`°æí
(r->str));

1151 
REDIS_REPLY_STATUS
:

1152 
out
 = 
	`sdsˇåïr
(out,
r
->
°r
,r->
Àn
);

1154 
REDIS_REPLY_INTEGER
:

1155 
out
 = 
	`sdsˇçrötf
(out,"%Œd",
r
->
öãgî
);

1157 
REDIS_REPLY_DOUBLE
:

1158 
out
 = 
	`sdsˇçrötf
(out,"%s",
r
->
°r
);

1160 
REDIS_REPLY_STRING
:

1161 
REDIS_REPLY_VERB
:

1162 
out
 = 
	`sdsˇåïr
(out,
r
->
°r
,r->
Àn
);

1164 
REDIS_REPLY_NIL
:

1165 
out
 = 
	`sdsˇt
(out,"NULL");

1167 
REDIS_REPLY_BOOL
:

1168 
out
 = 
	`sdsˇt
(out,
r
->
öãgî
 ? "true" : "false");

1170 
REDIS_REPLY_ARRAY
:

1171 
REDIS_REPLY_MAP
:

1172 
i
 = 0; i < 
r
->
ñemíts
; i++) {

1173 
sds
 
tmp
 = 
	`˛iF‹m©RïlyCSV
(
r
->
ñemít
[
i
]);

1174 
out
 = 
	`sdsˇéí
(out,
tmp
,
	`sd¶í
(tmp));

1175 i‡(
i
 !
r
->
ñemíts
-1Ë
out
 = 
	`sdsˇt
(out,",");

1176 
	`sds‰ì
(
tmp
);

1180 
	`Ârötf
(
°dîr
,"Unknow¿ª∂yÅy≥: %d\n", 
r
->
ty≥
);

1181 
	`exô
(1);

1183  
out
;

1184 
	}
}

1186 
	$˛iRódRïly
(
ouçut_øw_°rögs
) {

1187 *
_ª∂y
;

1188 
ªdisRïly
 *
ª∂y
;

1189 
sds
 
out
 = 
NULL
;

1190 
ouçut
 = 1;

1192 i‡(
	`ªdisGëRïly
(
c⁄ãxt
,&
_ª∂y
Ë!
REDIS_OK
) {

1193 i‡(
c⁄fig
.
shutdown
) {

1194 
	`ªdisFªe
(
c⁄ãxt
);

1195 
c⁄ãxt
 = 
NULL
;

1196  
REDIS_OK
;

1198 i‡(
c⁄fig
.
öãø˘ive
) {

1200 i‡(
c⁄ãxt
->
îr
 =
REDIS_ERR_IO
 &&

1201 (
î∫o
 =
ECONNRESET
 ||Éºnÿ=
EPIPE
))

1202  
REDIS_ERR
;

1203 i‡(
c⁄ãxt
->
îr
 =
REDIS_ERR_EOF
)

1204  
REDIS_ERR
;

1206 
	`˛iPrötC⁄ãxtEº‹
();

1207 
	`exô
(1);

1208  
REDIS_ERR
;

1211 
ª∂y
 = (
ªdisRïly
*)
_ª∂y
;

1213 
c⁄fig
.
œ°_cmd_ty≥
 = 
ª∂y
->
ty≥
;

1217 i‡(
c⁄fig
.
˛u°î_mode
 && 
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
 &&

1218 (!
	`°∫cmp
(
ª∂y
->
°r
,"MOVED",5Ë|| !
	`°rcmp
(reply->str,"ASK")))

1220 *
p
 = 
ª∂y
->
°r
, *
s
;

1221 
¶Ÿ
;

1223 
ouçut
 = 0;

1229 
s
 = 
	`°rchr
(
p
,' ');

1230 
p
 = 
	`°rchr
(
s
+1,' ');

1231 *
p
 = '\0';

1232 
¶Ÿ
 = 
	`©oi
(
s
+1);

1233 
s
 = 
	`°ºchr
(
p
+1,':');

1234 *
s
 = '\0';

1235 
	`sds‰ì
(
c⁄fig
.
ho°ù
);

1236 
c⁄fig
.
ho°ù
 = 
	`sd¢ew
(
p
+1);

1237 
c⁄fig
.
ho°p‹t
 = 
	`©oi
(
s
+1);

1238 i‡(
c⁄fig
.
öãø˘ive
)

1239 
	`¥ötf
("-> RedirectedÅo slot [%d]Üocatedát %s:%d\n",

1240 
¶Ÿ
, 
c⁄fig
.
ho°ù
, c⁄fig.
ho°p‹t
);

1241 
c⁄fig
.
˛u°î_ªissue_comm™d
 = 1;

1242 
	`˛iRe‰eshProm±
();

1245 i‡(
ouçut
) {

1246 i‡(
ouçut_øw_°rögs
) {

1247 
out
 = 
	`˛iF‹m©RïlyRaw
(
ª∂y
);

1249 i‡(
c⁄fig
.
ouçut
 =
OUTPUT_RAW
) {

1250 
out
 = 
	`˛iF‹m©RïlyRaw
(
ª∂y
);

1251 
out
 = 
	`sdsˇt
(out,"\n");

1252 } i‡(
c⁄fig
.
ouçut
 =
OUTPUT_STANDARD
) {

1253 
out
 = 
	`˛iF‹m©RïlyTTY
(
ª∂y
,"");

1254 } i‡(
c⁄fig
.
ouçut
 =
OUTPUT_CSV
) {

1255 
out
 = 
	`˛iF‹m©RïlyCSV
(
ª∂y
);

1256 
out
 = 
	`sdsˇt
(out,"\n");

1259 
	`fwrôe
(
out
,
	`sd¶í
(out),1,
°dout
);

1260 
	`sds‰ì
(
out
);

1262 
	`‰ìRïlyObje˘
(
ª∂y
);

1263  
REDIS_OK
;

1264 
	}
}

1266 
	$˛iSídComm™d
(
¨gc
, **
¨gv
, 
ª≥©
) {

1267 *
comm™d
 = 
¨gv
[0];

1268 
size_t
 *
¨gvÀn
;

1269 
j
, 
ouçut_øw
;

1271 i‡(!
c⁄fig
.
evÆ_ldb
 &&

1272 (!
	`°rˇ£cmp
(
comm™d
,"help") || !strcasecmp(command,"?"))) {

1273 
	`˛iOuçutHñp
(--
¨gc
, ++
¨gv
);

1274  
REDIS_OK
;

1277 i‡(
c⁄ãxt
 =
NULL
Ë 
REDIS_ERR
;

1279 
ouçut_øw
 = 0;

1280 i‡(!
	`°rˇ£cmp
(
comm™d
,"info") ||

1281 !
	`°rˇ£cmp
(
comm™d
,"lolwut") ||

1282 (
¨gc
 >2 && !
	`°rˇ£cmp
(
comm™d
,"debug") &&

1283 !
	`°rˇ£cmp
(
¨gv
[1],"htstats")) ||

1284 (
¨gc
 >2 && !
	`°rˇ£cmp
(
comm™d
,"debug") &&

1285 !
	`°rˇ£cmp
(
¨gv
[1],"htstats-key")) ||

1286 (
¨gc
 >2 && !
	`°rˇ£cmp
(
comm™d
,"memory") &&

1287 (!
	`°rˇ£cmp
(
¨gv
[1],"malloc-stats") ||

1288 !
	`°rˇ£cmp
(
¨gv
[1],"doctor"))) ||

1289 (
¨gc
 =2 && !
	`°rˇ£cmp
(
comm™d
,"cluster") &&

1290 (!
	`°rˇ£cmp
(
¨gv
[1],"nodes") ||

1291 !
	`°rˇ£cmp
(
¨gv
[1],"info"))) ||

1292 (
¨gc
 >2 && !
	`°rˇ£cmp
(
comm™d
,"client") &&

1293 !
	`°rˇ£cmp
(
¨gv
[1],"list")) ||

1294 (
¨gc
 =3 && !
	`°rˇ£cmp
(
comm™d
,"latency") &&

1295 !
	`°rˇ£cmp
(
¨gv
[1],"graph")) ||

1296 (
¨gc
 =2 && !
	`°rˇ£cmp
(
comm™d
,"latency") &&

1297 !
	`°rˇ£cmp
(
¨gv
[1],"doctor")) ||

1300 (
¨gc
 >2 && !
	`°rˇ£cmp
(
comm™d
,"proxy") &&

1301 !
	`°rˇ£cmp
(
¨gv
[1],"info")))

1303 
ouçut_øw
 = 1;

1306 i‡(!
	`°rˇ£cmp
(
comm™d
,"shutdown")Ë
c⁄fig
.
shutdown
 = 1;

1307 i‡(!
	`°rˇ£cmp
(
comm™d
,"m⁄ô‹")Ë
c⁄fig
.
m⁄ô‹_mode
 = 1;

1308 i‡(!
	`°rˇ£cmp
(
comm™d
,"subscribe") ||

1309 !
	`°rˇ£cmp
(
comm™d
,"psubs¸ibe")Ë
c⁄fig
.
pubsub_mode
 = 1;

1310 i‡(!
	`°rˇ£cmp
(
comm™d
,"sync") ||

1311 !
	`°rˇ£cmp
(
comm™d
,"psync")Ë
c⁄fig
.
¶ave_mode
 = 1;

1315 i‡(
¨gc
 =3 && !
	`°rˇ£cmp
(
¨gv
[0],"script") &&

1316 !
	`°rˇ£cmp
(
¨gv
[1],"debug"))

1318 i‡(!
	`°rˇ£cmp
(
¨gv
[2],"yes") || !strcasecmp(argv[2],"sync")) {

1319 
c⁄fig
.
íabÀ_ldb_⁄_evÆ
 = 1;

1321 
c⁄fig
.
íabÀ_ldb_⁄_evÆ
 = 0;

1326 i‡(!
	`°rˇ£cmp
(
comm™d
,"evÆ"Ë&& 
c⁄fig
.
íabÀ_ldb_⁄_evÆ
) {

1327 
c⁄fig
.
evÆ_ldb
 = 1;

1328 
c⁄fig
.
ouçut
 = 
OUTPUT_RAW
;

1332 
¨gvÀn
 = 
	`zmÆloc
(
¨gc
*(
size_t
));

1333 
j
 = 0; j < 
¨gc
; j++)

1334 
¨gvÀn
[
j
] = 
	`sd¶í
(
¨gv
[j]);

1338 
ª≥©
 < 0 ||Ñepeat-- > 0) {

1339 
	`ªdisAµídComm™dArgv
(
c⁄ãxt
,
¨gc
,(c⁄° **)
¨gv
,
¨gvÀn
);

1340 
c⁄fig
.
m⁄ô‹_mode
) {

1341 i‡(
	`˛iRódRïly
(
ouçut_øw
Ë!
REDIS_OK
Ë
	`exô
(1);

1342 
	`fÊush
(
°dout
);

1345 i‡(
c⁄fig
.
pubsub_mode
) {

1346 i‡(
c⁄fig
.
ouçut
 !
OUTPUT_RAW
)

1347 
	`¥ötf
("Reading messages... (press Ctrl-CÅo quit)\n");

1349 i‡(
	`˛iRódRïly
(
ouçut_øw
Ë!
REDIS_OK
Ë
	`exô
(1);

1353 i‡(
c⁄fig
.
¶ave_mode
) {

1354 
	`¥ötf
("EnteringÑeplica output mode... (press Ctrl-CÅo quit)\n");

1355 
	`¶aveMode
();

1356 
c⁄fig
.
¶ave_mode
 = 0;

1357 
	`z‰ì
(
¨gvÀn
);

1358  
REDIS_ERR
;

1361 i‡(
	`˛iRódRïly
(
ouçut_øw
Ë!
REDIS_OK
) {

1362 
	`z‰ì
(
¨gvÀn
);

1363  
REDIS_ERR
;

1366 i‡(!
	`°rˇ£cmp
(
comm™d
,"£À˘"Ë&& 
¨gc
 =2 && 
c⁄fig
.
œ°_cmd_ty≥
 !
REDIS_REPLY_ERROR
) {

1367 
c⁄fig
.
dbnum
 = 
	`©oi
(
¨gv
[1]);

1368 
	`˛iRe‰eshProm±
();

1369 } i‡(!
	`°rˇ£cmp
(
comm™d
,"auth"Ë&& (
¨gc
 == 2 ||árgc == 3))

1371 
	`˛iSñe˘
();

1374 i‡(
c⁄fig
.
˛u°î_ªissue_comm™d
){

1379 i‡(
c⁄fig
.
öãrvÆ
Ë
	`u¶ìp
(config.interval);

1380 
	`fÊush
(
°dout
);

1383 
	`z‰ì
(
¨gvÀn
);

1384  
REDIS_OK
;

1385 
	}
}

1388 
ªdisRïly
 *
	$ªc⁄√˘ögRedisComm™d
(
ªdisC⁄ãxt
 *
c
, c⁄° *
fmt
, ...) {

1389 
ªdisRïly
 *
ª∂y
 = 
NULL
;

1390 
åõs
 = 0;

1391 
va_li°
 
≠
;

1393 
	`as£π
(!
c
->
îr
);

1394 
ª∂y
 =
NULL
) {

1395 
c
->
îr
 & (
REDIS_ERR_IO
 | 
REDIS_ERR_EOF
)) {

1396 
	`¥ötf
("\r\x1b[0K");

1397 
	`¥ötf
("Rec⁄√˘ög... %d\r", ++
åõs
);

1398 
	`fÊush
(
°dout
);

1400 
	`ªdisFªe
(
c
);

1401 
c
 = 
	`ªdisC⁄√˘
(
c⁄fig
.
ho°ù
,c⁄fig.
ho°p‹t
);

1402 i‡(!
c
->
îr
 && 
c⁄fig
.
és
) {

1403 c⁄° *
îr
 = 
NULL
;

1404 i‡(
	`˛iSecuªC⁄√˘i⁄
(
c
, &
îr
Ë=
REDIS_ERR
 &&Érr) {

1405 
	`Ârötf
(
°dîr
, "TLS Eº‹: %s\n", 
îr
);

1406 
	`exô
(1);

1409 
	`u¶ìp
(1000000);

1412 
	`va_°¨t
(
≠
,
fmt
);

1413 
ª∂y
 = 
	`ªdisvComm™d
(
c
,
fmt
,
≠
);

1414 
	`va_íd
(
≠
);

1416 i‡(
c
->
îr
 && !(c->î∏& (
REDIS_ERR_IO
 | 
REDIS_ERR_EOF
))) {

1417 
	`Ârötf
(
°dîr
, "Eº‹: %s\n", 
c
->
îr°r
);

1418 
	`exô
(1);

1419 } i‡(
åõs
 > 0) {

1420 
	`¥ötf
("\r\x1b[0K");

1424 
c⁄ãxt
 = 
c
;

1425  
ª∂y
;

1426 
	}
}

1432 
	$∑r£O±i⁄s
(
¨gc
, **
¨gv
) {

1433 
i
;

1435 
i
 = 1; i < 
¨gc
; i++) {

1436 
œ°¨g
 = 
i
==
¨gc
-1;

1438 i‡(!
	`°rcmp
(
¨gv
[
i
],"-h"Ë&& !
œ°¨g
) {

1439 
	`sds‰ì
(
c⁄fig
.
ho°ù
);

1440 
c⁄fig
.
ho°ù
 = 
	`sd¢ew
(
¨gv
[++
i
]);

1441 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-h"Ë&& 
œ°¨g
) {

1442 
	`ußge
();

1443 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--help")) {

1444 
	`ußge
();

1445 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-x")) {

1446 
c⁄fig
.
°dö¨g
 = 1;

1447 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-p"Ë&& !
œ°¨g
) {

1448 
c⁄fig
.
ho°p‹t
 = 
	`©oi
(
¨gv
[++
i
]);

1449 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-s"Ë&& !
œ°¨g
) {

1450 
c⁄fig
.
ho°sockë
 = 
¨gv
[++
i
];

1451 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-r"Ë&& !
œ°¨g
) {

1452 
c⁄fig
.
ª≥©
 = 
	`°πﬁl
(
¨gv
[++
i
],
NULL
,10);

1453 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-i"Ë&& !
œ°¨g
) {

1454 
£c⁄ds
 = 
	`©of
(
¨gv
[++
i
]);

1455 
c⁄fig
.
öãrvÆ
 = 
£c⁄ds
*1000000;

1456 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-n"Ë&& !
œ°¨g
) {

1457 
c⁄fig
.
dbnum
 = 
	`©oi
(
¨gv
[++
i
]);

1458 } i‡(!
	`°rcmp
(
¨gv
[
i
], "--no-auth-warning")) {

1459 
c⁄fig
.
no_auth_w¨nög
 = 1;

1460 } i‡(!
	`°rcmp
(
¨gv
[
i
], "--askpass")) {

1461 
c⁄fig
.
ask∑ss
 = 1;

1462 } i‡((!
	`°rcmp
(
¨gv
[
i
],"-a") || !strcmp(argv[i],"--pass"))

1463 && !
œ°¨g
)

1465 
c⁄fig
.
auth
 = 
¨gv
[++
i
];

1466 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--u£r"Ë&& !
œ°¨g
) {

1467 
c⁄fig
.
u£r
 = 
¨gv
[++
i
];

1468 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-u"Ë&& !
œ°¨g
) {

1469 
	`∑r£RedisUri
(
¨gv
[++
i
]);

1470 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--raw")) {

1471 
c⁄fig
.
ouçut
 = 
OUTPUT_RAW
;

1472 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--no-raw")) {

1473 
c⁄fig
.
ouçut
 = 
OUTPUT_STANDARD
;

1474 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--csv")) {

1475 
c⁄fig
.
ouçut
 = 
OUTPUT_CSV
;

1476 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--latency")) {

1477 
c⁄fig
.
œãncy_mode
 = 1;

1478 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--latency-dist")) {

1479 
c⁄fig
.
œãncy_di°_mode
 = 1;

1480 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--mono")) {

1481 
•e˘rum_∑Àâe
 = 
•e˘rum_∑Àâe_m⁄o
;

1482 
•e˘rum_∑Àâe_size
 = 
•e˘rum_∑Àâe_m⁄o_size
;

1483 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--latency-history")) {

1484 
c⁄fig
.
œãncy_mode
 = 1;

1485 
c⁄fig
.
œãncy_hi°‹y
 = 1;

1486 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--Ãu-ã°"Ë&& !
œ°¨g
) {

1487 
c⁄fig
.
Ãu_ã°_mode
 = 1;

1488 
c⁄fig
.
Ãu_ã°_ßm∂e_size
 = 
	`°πﬁl
(
¨gv
[++
i
],
NULL
,10);

1489 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--slave")) {

1490 
c⁄fig
.
¶ave_mode
 = 1;

1491 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--replica")) {

1492 
c⁄fig
.
¶ave_mode
 = 1;

1493 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--stat")) {

1494 
c⁄fig
.
°©_mode
 = 1;

1495 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--scan")) {

1496 
c⁄fig
.
sˇn_mode
 = 1;

1497 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--∑âîn"Ë&& !
œ°¨g
) {

1498 
c⁄fig
.
∑âîn
 = 
¨gv
[++
i
];

1499 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--öåösic-œãncy"Ë&& !
œ°¨g
) {

1500 
c⁄fig
.
öåösic_œãncy_mode
 = 1;

1501 
c⁄fig
.
öåösic_œãncy_duøti⁄
 = 
	`©oi
(
¨gv
[++
i
]);

1502 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--rdb"Ë&& !
œ°¨g
) {

1503 
c⁄fig
.
gërdb_mode
 = 1;

1504 
c⁄fig
.
rdb_fûíame
 = 
¨gv
[++
i
];

1505 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--pipe")) {

1506 
c⁄fig
.
pùe_mode
 = 1;

1507 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--pùe-timeout"Ë&& !
œ°¨g
) {

1508 
c⁄fig
.
pùe_timeout
 = 
	`©oi
(
¨gv
[++
i
]);

1509 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--bigkeys")) {

1510 
c⁄fig
.
bigkeys
 = 1;

1511 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--memkeys")) {

1512 
c⁄fig
.
memkeys
 = 1;

1513 
c⁄fig
.
memkeys_ßm∂es
 = 0;

1514 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--memkeys-samples")) {

1515 
c⁄fig
.
memkeys
 = 1;

1516 
c⁄fig
.
memkeys_ßm∂es
 = 
	`©oi
(
¨gv
[++
i
]);

1517 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--hotkeys")) {

1518 
c⁄fig
.
hŸkeys
 = 1;

1519 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--evÆ"Ë&& !
œ°¨g
) {

1520 
c⁄fig
.
evÆ
 = 
¨gv
[++
i
];

1521 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--ldb")) {

1522 
c⁄fig
.
evÆ_ldb
 = 1;

1523 
c⁄fig
.
ouçut
 = 
OUTPUT_RAW
;

1524 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--ldb-sync-mode")) {

1525 
c⁄fig
.
evÆ_ldb
 = 1;

1526 
c⁄fig
.
evÆ_ldb_sync
 = 1;

1527 
c⁄fig
.
ouçut
 = 
OUTPUT_RAW
;

1528 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-c")) {

1529 
c⁄fig
.
˛u°î_mode
 = 1;

1530 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-d"Ë&& !
œ°¨g
) {

1531 
	`sds‰ì
(
c⁄fig
.
mb_dñim
);

1532 
c⁄fig
.
mb_dñim
 = 
	`sd¢ew
(
¨gv
[++
i
]);

1533 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--verbose")) {

1534 
c⁄fig
.
vîbo£
 = 1;

1535 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î"Ë&& !
œ°¨g
) {

1536 i‡(
	`CLUSTER_MANAGER_MODE
()Ë
	`ußge
();

1537 *
cmd
 = 
¨gv
[++
i
];

1538 
j
 = 
i
;

1539 
j
 < 
¨gc
 && 
¨gv
[j][0] != '-') j++;

1540 i‡(
j
 > 
i
) j--;

1541 
	`¸óãClu°îM™agîComm™d
(
cmd
, 
j
 - 
i
, 
¨gv
 + i + 1);

1542 
i
 = 
j
;

1543 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î"Ë&& 
œ°¨g
) {

1544 
	`ußge
();

1545 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î-ª∂iˇs"Ë&& !
œ°¨g
) {

1546 
c⁄fig
.
˛u°î_m™agî_comm™d
.
ª∂iˇs
 = 
	`©oi
(
¨gv
[++
i
]);

1547 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î-ma°î-id"Ë&& !
œ°¨g
) {

1548 
c⁄fig
.
˛u°î_m™agî_comm™d
.
ma°î_id
 = 
¨gv
[++
i
];

1549 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î-‰om"Ë&& !
œ°¨g
) {

1550 
c⁄fig
.
˛u°î_m™agî_comm™d
.
‰om
 = 
¨gv
[++
i
];

1551 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î-to"Ë&& !
œ°¨g
) {

1552 
c⁄fig
.
˛u°î_m™agî_comm™d
.
to
 = 
¨gv
[++
i
];

1553 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î-weight"Ë&& !
œ°¨g
) {

1554 i‡(
c⁄fig
.
˛u°î_m™agî_comm™d
.
weight
 !
NULL
) {

1555 
	`Ârötf
(
°dîr
, "WARNING: you cannot use --cluster-weight "

1560 
	`exô
(1);

1562 
widx
 = 
i
 + 1;

1563 **
weight
 = 
¨gv
 + 
widx
;

1564 
w¨gc
 = 0;

1565 ; 
widx
 < 
¨gc
; widx++) {

1566 i‡(
	`°r°r
(
¨gv
[
widx
], "--") ==árgv[widx]) ;

1567 i‡(
	`°rchr
(
¨gv
[
widx
], '='Ë=
NULL
) ;

1568 
w¨gc
++;

1570 i‡(
w¨gc
 > 0) {

1571 
c⁄fig
.
˛u°î_m™agî_comm™d
.
weight
 = weight;

1572 
c⁄fig
.
˛u°î_m™agî_comm™d
.
weight_¨gc
 = 
w¨gc
;

1573 
i
 +
w¨gc
;

1575 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î-¶Ÿs"Ë&& !
œ°¨g
) {

1576 
c⁄fig
.
˛u°î_m™agî_comm™d
.
¶Ÿs
 = 
	`©oi
(
¨gv
[++
i
]);

1577 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î-timeout"Ë&& !
œ°¨g
) {

1578 
c⁄fig
.
˛u°î_m™agî_comm™d
.
timeout
 = 
	`©oi
(
¨gv
[++
i
]);

1579 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î-pùñöe"Ë&& !
œ°¨g
) {

1580 
c⁄fig
.
˛u°î_m™agî_comm™d
.
pùñöe
 = 
	`©oi
(
¨gv
[++
i
]);

1581 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˛u°î-thªshﬁd"Ë&& !
œ°¨g
) {

1582 
c⁄fig
.
˛u°î_m™agî_comm™d
.
thªshﬁd
 = 
	`©of
(
¨gv
[++
i
]);

1583 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--cluster-yes")) {

1584 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 |=

1585 
CLUSTER_MANAGER_CMD_FLAG_YES
;

1586 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--cluster-simulate")) {

1587 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 |=

1588 
CLUSTER_MANAGER_CMD_FLAG_SIMULATE
;

1589 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--cluster-replace")) {

1590 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 |=

1591 
CLUSTER_MANAGER_CMD_FLAG_REPLACE
;

1592 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--cluster-copy")) {

1593 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 |=

1594 
CLUSTER_MANAGER_CMD_FLAG_COPY
;

1595 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--cluster-slave")) {

1596 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 |=

1597 
CLUSTER_MANAGER_CMD_FLAG_SLAVE
;

1598 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--cluster-use-empty-masters")) {

1599 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 |=

1600 
CLUSTER_MANAGER_CMD_FLAG_EMPTYMASTER
;

1601 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--cluster-search-multiple-owners")) {

1602 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 |=

1603 
CLUSTER_MANAGER_CMD_FLAG_CHECK_OWNERS
;

1604 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--cluster-fix-with-unreachable-masters")) {

1605 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 |=

1606 
CLUSTER_MANAGER_CMD_FLAG_FIX_WITH_UNREACHABLE_MASTERS
;

1607 #ifde‡
USE_OPENSSL


1608 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--tls")) {

1609 
c⁄fig
.
és
 = 1;

1610 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--¢i"Ë&& !
œ°¨g
) {

1611 
c⁄fig
.
¢i
 = 
¨gv
[++
i
];

1612 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--ˇ˚πdú"Ë&& !
œ°¨g
) {

1613 
c⁄fig
.
ˇ˚πdú
 = 
¨gv
[++
i
];

1614 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--ˇ˚π"Ë&& !
œ°¨g
) {

1615 
c⁄fig
.
ˇ˚π
 = 
¨gv
[++
i
];

1616 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--˚π"Ë&& !
œ°¨g
) {

1617 
c⁄fig
.
˚π
 = 
¨gv
[++
i
];

1618 } i‡(!
	`°rcmp
(
¨gv
[
i
],"--key"Ë&& !
œ°¨g
) {

1619 
c⁄fig
.
key
 = 
¨gv
[++
i
];

1621 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-v") || !strcmp(argv[i], "--version")) {

1622 
sds
 
vîsi⁄
 = 
	`˛iVîsi⁄
();

1623 
	`¥ötf
("ªdis-˛ò%s\n", 
vîsi⁄
);

1624 
	`sds‰ì
(
vîsi⁄
);

1625 
	`exô
(0);

1626 } i‡(!
	`°rcmp
(
¨gv
[
i
],"-3")) {

1627 
c⁄fig
.
ª•3
 = 1;

1628 } i‡(
	`CLUSTER_MANAGER_MODE
(Ë&& 
¨gv
[
i
][0] != '-') {

1629 i‡(
c⁄fig
.
˛u°î_m™agî_comm™d
.
¨gc
 == 0) {

1630 
j
 = 
i
 + 1;

1631 
j
 < 
¨gc
 && 
¨gv
[j][0] != '-') j++;

1632 
cmd_¨gc
 = 
j
 - 
i
;

1633 
c⁄fig
.
˛u°î_m™agî_comm™d
.
¨gc
 = 
cmd_¨gc
;

1634 
c⁄fig
.
˛u°î_m™agî_comm™d
.
¨gv
 =árgv + 
i
;

1635 i‡(
cmd_¨gc
 > 1Ë
i
 = 
j
 - 1;

1638 i‡(
¨gv
[
i
][0] == '-') {

1639 
	`Ârötf
(
°dîr
,

1641 
¨gv
[
i
]);

1642 
	`exô
(1);

1651 i‡(
c⁄fig
.
evÆ_ldb
 && c⁄fig.
evÆ
 =
NULL
) {

1652 
	`Ârötf
(
°dîr
,"Options --ldbánd --ldb-sync-modeÑequire --eval.\n");

1653 
	`Ârötf
(
°dîr
,"Try %†--hñ∞f‹ m‹êöf‹m©i⁄.\n", 
¨gv
[0]);

1654 
	`exô
(1);

1657 i‡(!
c⁄fig
.
no_auth_w¨nög
 && c⁄fig.
auth
 !
NULL
) {

1658 
	`Âuts
("Warning: UsingáÖassword with '-a' or '-u' option onÅhe command"

1659 "ÜöêöãrÁ˚ mayÇŸ bêß„.\n", 
°dîr
);

1662  
i
;

1663 
	}
}

1665 
	$∑r£Env
() {

1667 *
auth
 = 
	`gëív
(
REDIS_CLI_AUTH_ENV
);

1668 i‡(
auth
 !
NULL
 && 
c⁄fig
.auth == NULL) {

1669 
c⁄fig
.
auth
 =áuth;

1671 
	}
}

1673 
sds
 
	$ªadArgFromStdö
() {

1674 
buf
[1024];

1675 
sds
 
¨g
 = 
	`sd£m±y
();

1678 
ƒód
 = 
	`ªad
(
	`fûío
(
°dö
),
buf
,1024);

1680 i‡(
ƒód
 == 0) ;

1681 i‡(
ƒód
 == -1) {

1682 
	`≥º‹
("Reading from standard input");

1683 
	`exô
(1);

1685 
¨g
 = 
	`sdsˇéí
◊rg,
buf
,
ƒód
);

1687  
¨g
;

1688 
	}
}

1690 
	$ußge
() {

1691 
sds
 
vîsi⁄
 = 
	`˛iVîsi⁄
();

1692 
	`Ârötf
(
°dîr
,

1700 " You c™álsÿu£Åhê" 
REDIS_CLI_AUTH_ENV
 "Énvironment\n"

1706 " I‡thi†¨gumíài†u£d, '-a'ánd " 
REDIS_CLI_AUTH_ENV
 "\n"

1717 #ifde‡
USE_OPENSSL


1738 "ándÉxôs.\n",
vîsi⁄
);

1740 
	`Ârötf
(
°dîr
,

1752 
REDIS_CLI_DEFAULT_PIPE_TIMEOUT
);

1753 
	`Ârötf
(
°dîr
,

1778 
	`Ârötf
(
°dîr
,

1796 
	`sds‰ì
(
vîsi⁄
);

1797 
	`exô
(1);

1798 
	}
}

1800 
	$c⁄fúmWôhYes
(*
msg
) {

1801 
	`¥ötf
("%†—y≥ 'yes'Åÿac˚±): ", 
msg
);

1802 
	`fÊush
(
°dout
);

1803 
buf
[4];

1804 
ƒód
 = 
	`ªad
(
	`fûío
(
°dö
),
buf
,4);

1805 
buf
[3] = '\0';

1806  (
ƒód
 !0 && !
	`°rcmp
("yes", 
buf
));

1807 
	}
}

1810 **
	$c⁄vîtToSds
(
cou¡
, ** 
¨gs
) {

1811 
j
;

1812 **
sds
 = 
	`zmÆloc
((*)*
cou¡
);

1814 
j
 = 0; j < 
cou¡
; j++)

1815 
sds
[
j
] = 
	`sd¢ew
(
¨gs
[j]);

1817  
sds
;

1818 
	}
}

1820 
	$issueComm™dRïót
(
¨gc
, **
¨gv
, 
ª≥©
) {

1822 
c⁄fig
.
˛u°î_ªissue_comm™d
 = 0;

1823 i‡(
	`˛iSídComm™d
(
¨gc
,
¨gv
,
ª≥©
Ë!
REDIS_OK
) {

1824 
	`˛iC⁄√˘
(
CC_FORCE
);

1828 i‡(
	`˛iSídComm™d
(
¨gc
,
¨gv
,
ª≥©
Ë!
REDIS_OK
) {

1829 
	`˛iPrötC⁄ãxtEº‹
();

1830  
REDIS_ERR
;

1834 i‡(
c⁄fig
.
˛u°î_mode
 && c⁄fig.
˛u°î_ªissue_comm™d
) {

1835 
	`˛iC⁄√˘
(
CC_FORCE
);

1840  
REDIS_OK
;

1841 
	}
}

1843 
	$issueComm™d
(
¨gc
, **
¨gv
) {

1844  
	`issueComm™dRïót
(
¨gc
, 
¨gv
, 
c⁄fig
.
ª≥©
);

1845 
	}
}

1853 
sds
 *
	$˛iS∂ôArgs
(*
löe
, *
¨gc
) {

1854 i‡(
c⁄fig
.
evÆ_ldb
 && (
	`°r°r
(
löe
,"eval ") ==Üine ||

1855 
	`°r°r
(
löe
,"e ") ==Üine))

1857 
sds
 *
¨gv
 = 
	`sds_mÆloc
((sds)*2);

1858 *
¨gc
 = 2;

1859 
Àn
 = 
	`°æí
(
löe
);

1860 
ñí
 = 
löe
[1] == ' ' ? 2 : 5;

1861 
¨gv
[0] = 
	`sd¢ewÀn
(
löe
,
ñí
-1);

1862 
¨gv
[1] = 
	`sd¢ewÀn
(
löe
+
ñí
,
Àn
-elen);

1863  
¨gv
;

1865  
	`sds•lô¨gs
(
löe
,
¨gc
);

1867 
	}
}

1872 
	$˛iSëPª„ªn˚s
(**
¨gv
, 
¨gc
, 
öãø˘ive
) {

1873 i‡(!
	`°rˇ£cmp
(
¨gv
[0],":£t"Ë&& 
¨gc
 >= 2) {

1874 i‡(!
	`°rˇ£cmp
(
¨gv
[1],"höts")Ë
¥ef
.
höts
 = 1;

1875 i‡(!
	`°rˇ£cmp
(
¨gv
[1],"nohöts")Ë
¥ef
.
höts
 = 0;

1877 
	`¥ötf
("%sunknownÑedis-cliÖreference '%s'\n",

1878 
öãø˘ive
 ? "" : ".redisclirc: ",

1879 
¨gv
[1]);

1882 
	`¥ötf
("%sunknownÑedis-cli internal command '%s'\n",

1883 
öãø˘ive
 ? "" : ".redisclirc: ",

1884 
¨gv
[0]);

1886 
	}
}

1889 
	$˛iLﬂdPª„ªn˚s
() {

1890 
sds
 
rcfûe
 = 
	`gëDŸfûeP©h
(
REDIS_CLI_RCFILE_ENV
,
REDIS_CLI_RCFILE_DEFAULT
);

1891 i‡(
rcfûe
 =
NULL
) ;

1892 
FILE
 *
Â
 = 
	`f›í
(
rcfûe
,"r");

1893 
buf
[1024];

1895 i‡(
Â
) {

1896 
	`fgës
(
buf
,(buf),
Â
Ë!
NULL
) {

1897 
sds
 *
¨gv
;

1898 
¨gc
;

1900 
¨gv
 = 
	`sds•lô¨gs
(
buf
,&
¨gc
);

1901 i‡(
¨gc
 > 0Ë
	`˛iSëPª„ªn˚s
(
¨gv
,argc,0);

1902 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

1904 
	`f˛o£
(
Â
);

1906 
	`sds‰ì
(
rcfûe
);

1907 
	}
}

1909 
	$ª∂
() {

1910 
sds
 
hi°‹yfûe
 = 
NULL
;

1911 
hi°‹y
 = 0;

1912 *
löe
;

1913 
¨gc
;

1914 
sds
 *
¨gv
;

1918 
	`˛iInôHñp
();

1919 
	`˛iI¡egøãHñp
();

1921 
c⁄fig
.
öãø˘ive
 = 1;

1922 
	`löíoi£SëMu…iLöe
(1);

1923 
	`löíoi£SëCom∂ëi⁄CÆlback
(
com∂ëi⁄CÆlback
);

1924 
	`löíoi£SëHötsCÆlback
(
hötsCÆlback
);

1925 
	`löíoi£SëFªeHötsCÆlback
(
‰ìHötsCÆlback
);

1928 i‡(
	`ißây
(
	`fûío
(
°dö
))) {

1929 
hi°‹yfûe
 = 
	`gëDŸfûeP©h
(
REDIS_CLI_HISTFILE_ENV
,
REDIS_CLI_HISTFILE_DEFAULT
);

1931 
hi°‹y
 = 1;

1932 i‡(
hi°‹yfûe
 !
NULL
) {

1933 
	`löíoi£Hi°‹yLﬂd
(
hi°‹yfûe
);

1935 
	`˛iLﬂdPª„ªn˚s
();

1938 
	`˛iRe‰eshProm±
();

1939 (
löe
 = 
	`löíoi£
(
c⁄ãxt
 ? 
c⁄fig
.
¥om±
 : "nŸ c⁄√˘ed> ")Ë!
NULL
) {

1940 i‡(
löe
[0] != '\0') {

1941 
ª≥©
 = 1;

1942 
skù¨gs
 = 0;

1943 *
íd±r
 = 
NULL
;

1945 
¨gv
 = 
	`˛iS∂ôArgs
(
löe
,&
¨gc
);

1949 i‡(
¨gv
 && 
¨gc
 > 0) {

1950 
î∫o
 = 0;

1951 
ª≥©
 = 
	`°πﬁ
(
¨gv
[0], &
íd±r
, 10);

1952 i‡(
¨gc
 > 1 && *
íd±r
 == '\0') {

1953 i‡(
î∫o
 =
ERANGE
 ||Éºnÿ=
EINVAL
 || 
ª≥©
 <= 0) {

1954 
	`Âuts
("InvÆidÑedis-˛òª≥© comm™d o±i⁄ vÆue.\n", 
°dout
);

1955 
	`sds‰ì•lôªs
(
¨gv
, 
¨gc
);

1956 
	`löíoi£Fªe
(
löe
);

1959 
skù¨gs
 = 1;

1961 
ª≥©
 = 1;

1966 
d™gîous
 = 0;

1967 i‡(
¨gv
 && 
¨gc
 > 0) {

1968 i‡(!
	`°rˇ£cmp
(
¨gv
[
skù¨gs
], "auth")) {

1969 
d™gîous
 = 1;

1970 } i‡(
skù¨gs
+1 < 
¨gc
 &&

1971 !
	`°rˇ£cmp
(
¨gv
[
skù¨gs
], "acl") &&

1972 !
	`°rˇ£cmp
(
¨gv
[
skù¨gs
+1], "setuser"))

1974 
d™gîous
 = 1;

1978 i‡(!
d™gîous
) {

1979 i‡(
hi°‹y
Ë
	`löíoi£Hi°‹yAdd
(
löe
);

1980 i‡(
hi°‹yfûe
Ë
	`löíoi£Hi°‹ySave
(historyfile);

1983 i‡(
¨gv
 =
NULL
) {

1984 
	`¥ötf
("Invalidárgument(s)\n");

1985 
	`löíoi£Fªe
(
löe
);

1987 } i‡(
¨gc
 > 0) {

1988 i‡(
	`°rˇ£cmp
(
¨gv
[0],"quit") == 0 ||

1989 
	`°rˇ£cmp
(
¨gv
[0],"exit") == 0)

1991 
	`exô
(0);

1992 } i‡(
¨gv
[0][0] == ':') {

1993 
	`˛iSëPª„ªn˚s
(
¨gv
,
¨gc
,1);

1994 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

1995 
	`löíoi£Fªe
(
löe
);

1997 } i‡(
	`°rˇ£cmp
(
¨gv
[0],"restart") == 0) {

1998 i‡(
c⁄fig
.
evÆ
) {

1999 
c⁄fig
.
evÆ_ldb
 = 1;

2000 
c⁄fig
.
ouçut
 = 
OUTPUT_RAW
;

2001 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

2002 
	`löíoi£Fªe
(
löe
);

2005 
	`¥ötf
("Use 'restart' only in Lua debugging mode.");

2007 } i‡(
¨gc
 =3 && !
	`°rˇ£cmp
(
¨gv
[0],"connect")) {

2008 
	`sds‰ì
(
c⁄fig
.
ho°ù
);

2009 
c⁄fig
.
ho°ù
 = 
	`sd¢ew
(
¨gv
[1]);

2010 
c⁄fig
.
ho°p‹t
 = 
	`©oi
(
¨gv
[2]);

2011 
	`˛iRe‰eshProm±
();

2012 
	`˛iC⁄√˘
(
CC_FORCE
);

2013 } i‡(
¨gc
 =1 && !
	`°rˇ£cmp
(
¨gv
[0],"clear")) {

2014 
	`löíoi£CÀ¨S¸ìn
();

2016 
°¨t_time
 = 
	`m°ime
(), 
ñ≠£d
;

2018 
	`issueComm™dRïót
(
¨gc
-
skù¨gs
, 
¨gv
+skù¨gs, 
ª≥©
);

2022 i‡(
c⁄fig
.
evÆ_ldb_íd
) {

2023 
c⁄fig
.
evÆ_ldb_íd
 = 0;

2024 
	`˛iRódRïly
(0);

2025 
	`¥ötf
("\n(Lua debugging sessionÉnded%s)\n\n",

2026 
c⁄fig
.
evÆ_ldb_sync
 ? "" :

2030 
ñ≠£d
 = 
	`m°ime
()-
°¨t_time
;

2031 i‡(
ñ≠£d
 >= 500 &&

2032 
c⁄fig
.
ouçut
 =
OUTPUT_STANDARD
)

2034 
	`¥ötf
("(%.2fs)\n",()
ñ≠£d
/1000);

2039 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

2042 
	`löíoi£Fªe
(
löe
);

2044 
	`exô
(0);

2045 
	}
}

2047 
	$n⁄öãø˘ive
(
¨gc
, **
¨gv
) {

2048 
ªtvÆ
 = 0;

2049 i‡(
c⁄fig
.
°dö¨g
) {

2050 
¨gv
 = 
	`zªÆloc
◊rgv, (
¨gc
+1)*(*));

2051 
¨gv
[
¨gc
] = 
	`ªadArgFromStdö
();

2052 
ªtvÆ
 = 
	`issueComm™d
(
¨gc
+1, 
¨gv
);

2054 
ªtvÆ
 = 
	`issueComm™d
(
¨gc
, 
¨gv
);

2056  
ªtvÆ
;

2057 
	}
}

2063 
	$evÆMode
(
¨gc
, **
¨gv
) {

2064 
sds
 
s¸ùt
 = 
NULL
;

2065 
FILE
 *
Â
;

2066 
buf
[1024];

2067 
size_t
 
ƒód
;

2068 **
¨gv2
;

2069 
j
, 
gŸ_comma
, 
keys
;

2070 
ªtvÆ
 = 
REDIS_OK
;

2073 i‡(
c⁄fig
.
evÆ_ldb
) {

2074 
	`¥ötf
(

2082 
	`sds‰ì
(
s¸ùt
);

2083 
s¸ùt
 = 
	`sd£m±y
();

2084 
gŸ_comma
 = 0;

2085 
keys
 = 0;

2088 
Â
 = 
	`f›í
(
c⁄fig
.
evÆ
,"r");

2089 i‡(!
Â
) {

2090 
	`Ârötf
(
°dîr
,

2091 "C™'à›í fûê'%s': %s\n", 
c⁄fig
.
evÆ
, 
	`°ªº‹
(
î∫o
));

2092 
	`exô
(1);

2094 (
ƒód
 = 
	`‰ód
(
buf
,1,(buf),
Â
)) != 0) {

2095 
s¸ùt
 = 
	`sdsˇéí
(s¸ùt,
buf
,
ƒód
);

2097 
	`f˛o£
(
Â
);

2100 i‡(
c⁄fig
.
evÆ_ldb
) {

2101 
ªdisRïly
 *
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
,

2102 
c⁄fig
.
evÆ_ldb_sync
 ?

2104 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

2108 
¨gv2
 = 
	`zmÆloc
((
sds
)*(
¨gc
+3));

2109 
¨gv2
[0] = 
	`sd¢ew
("EVAL");

2110 
¨gv2
[1] = 
s¸ùt
;

2111 
j
 = 0; j < 
¨gc
; j++) {

2112 i‡(!
gŸ_comma
 && 
¨gv
[
j
][0] == ',' &&árgv[j][1] == 0) {

2113 
gŸ_comma
 = 1;

2116 
¨gv2
[
j
+3-
gŸ_comma
] = 
	`sd¢ew
(
¨gv
[j]);

2117 i‡(!
gŸ_comma
Ë
keys
++;

2119 
¨gv2
[2] = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%d",
keys
);

2122 
evÆ_ldb
 = 
c⁄fig
.eval_ldb;

2123 
ªtvÆ
 = 
	`issueComm™d
(
¨gc
+3-
gŸ_comma
, 
¨gv2
);

2124 i‡(
evÆ_ldb
) {

2125 i‡(!
c⁄fig
.
evÆ_ldb
) {

2129 
	`¥ötf
("Eval debugging session can't start:\n");

2130 
	`˛iRódRïly
(0);

2133 
	`°∫˝y
(
c⁄fig
.
¥om±
,"lua debugger> ",(config.prompt));

2134 
	`ª∂
();

2136 
	`˛iC⁄√˘
(
CC_FORCE
);

2137 
	`¥ötf
("\n");

2143  
ªtvÆ
;

2144 
	}
}

2151 
	s˛u°îM™agî
 {

2152 
li°
 *
	mnodes
;

2153 
li°
 *
	mîr‹s
;

2154 
	muƒóchabÀ_ma°îs
;

2155 } 
	g˛u°î_m™agî
;

2158 
di˘
 *
	g˛u°îM™agîUncovîedSlŸs
 = 
NULL
;

2160 
	s˛u°îM™agîNode
 {

2161 
ªdisC⁄ãxt
 *
	mc⁄ãxt
;

2162 
sds
 
	m«me
;

2163 *
	mù
;

2164 
	mp‹t
;

2165 
uöt64_t
 
	mcuºít_ïoch
;

2166 
time_t
 
	mpög_£¡
;

2167 
time_t
 
	mpög_ªcv
;

2168 
	mÊags
;

2169 
li°
 *
	mÊags_°r
;

2170 
sds
 
	mª∂iˇã
;

2171 
	mdúty
;

2172 
uöt8_t
 
	m¶Ÿs
[
CLUSTER_MANAGER_SLOTS
];

2173 
	m¶Ÿs_cou¡
;

2174 
	mª∂iˇs_cou¡
;

2175 
li°
 *
	m‰õnds
;

2176 
sds
 *
	mmigøtög
;

2178 
sds
 *
	mimp‹tög
;

2180 
	mmigøtög_cou¡
;

2181 
	mimp‹tög_cou¡
;

2182 
	mweight
;

2183 
	mbÆ™˚
;

2184 } 
	t˛u°îM™agîNode
;

2187 
	s˛u°îM™agîNodeAºay
 {

2188 
˛u°îM™agîNode
 **
	mnodes
;

2189 
˛u°îM™agîNode
 **
	mÆloc
;

2190 
	mÀn
;

2191 
	mcou¡
;

2192 } 
	t˛u°îM™agîNodeAºay
;

2195 
	s˛u°îM™agîResh¨dTabÀIãm
 {

2196 
˛u°îM™agîNode
 *
	msour˚
;

2197 
	m¶Ÿ
;

2198 } 
	t˛u°îM™agîResh¨dTabÀIãm
;

2202 
	s˛u°îM™agîLök
 {

2203 
sds
 
	mnode_«me
;

2204 
sds
 
	mnode_addr
;

2205 
	mc⁄√˘ed
;

2206 
	mh™dshakög
;

2207 } 
	t˛u°îM™agîLök
;

2209 
di˘Ty≥
 
	g˛u°îM™agîDi˘Ty≥
 = {

2210 
di˘SdsHash
,

2211 
NULL
,

2212 
NULL
,

2213 
di˘SdsKeyCom∑ª
,

2214 
NULL
,

2215 
di˘SdsDe°ru˘‹


2218 
di˘Ty≥
 
	g˛u°îM™agîLökDi˘Ty≥
 = {

2219 
di˘SdsHash
,

2220 
NULL
,

2221 
NULL
,

2222 
di˘SdsKeyCom∑ª
,

2223 
di˘SdsDe°ru˘‹
,

2224 
di˘Li°De°ru˘‹


2227 
	t˛u°îM™agîComm™dProc
(
	t¨gc
, **
	t¨gv
);

2228 (*
	t˛u°îM™agîOnRïlyEº‹
)(
	tªdisRïly
 *
	tª∂y
,

2229 
	t˛u°îM™agîNode
 *
	tn
, 
	tbulk_idx
);

2233 
˛u°îM™agîNode
 *
	`˛u°îM™agîNewNode
(*
ù
, 
p‹t
);

2234 
˛u°îM™agîNode
 *
	`˛u°îM™agîNodeByName
(c⁄° *
«me
);

2235 
˛u°îM™agîNode
 *
	`˛u°îM™agîNodeByAbbªvüãdName
(c⁄° *
n
);

2236 
	`˛u°îM™agîNodeRe£tSlŸs
(
˛u°îM™agîNode
 *
node
);

2237 
	`˛u°îM™agîNodeIsClu°î
(
˛u°îM™agîNode
 *
node
, **
îr
);

2238 
	`˛u°îM™agîPrötNŸClu°îNodeEº‹
(
˛u°îM™agîNode
 *
node
,

2239 *
îr
);

2240 
	`˛u°îM™agîNodeLﬂdInfo
(
˛u°îM™agîNode
 *
node
, 
›ts
,

2241 **
îr
);

2242 
	`˛u°îM™agîLﬂdInfoFromNode
(
˛u°îM™agîNode
 *
node
, 
›ts
);

2243 
	`˛u°îM™agîNodeIsEm±y
(
˛u°îM™agîNode
 *
node
, **
îr
);

2244 
	`˛u°îM™agîGëA¡iAfföôySc‹e
(
˛u°îM™agîNodeAºay
 *
ùnodes
,

2245 
ù_cou¡
, 
˛u°îM™agîNode
 ***
of„ndög
, *
of„ndög_Àn
);

2246 
	`˛u°îM™agîO±imizeA¡iAfföôy
(
˛u°îM™agîNodeAºay
 *
ùnodes
,

2247 
ù_cou¡
);

2248 
sds
 
	`˛u°îM™agîNodeInfo
(
˛u°îM™agîNode
 *
node
, 
ödít
);

2249 
	`˛u°îM™agîShowNodes
();

2250 
	`˛u°îM™agîShowClu°îInfo
();

2251 
	`˛u°îM™agîFlushNodeC⁄fig
(
˛u°îM™agîNode
 *
node
, **
îr
);

2252 
	`˛u°îM™agîWaôF‹Clu°îJoö
();

2253 
	`˛u°îM™agîCheckClu°î
(
quõt
);

2254 
	`˛u°îM™agîLog
(
Àvñ
, c⁄° * 
fmt
, ...);

2255 
	`˛u°îM™agîIsC⁄figC⁄si°ít
();

2256 
di˘
 *
	`˛u°îM™agîGëLökSètus
();

2257 
	`˛u°îM™agîOnEº‹
(
sds
 
îr
);

2258 
	`˛u°îM™agîNodeAºayInô
(
˛u°îM™agîNodeAºay
 *
¨øy
,

2259 
Àn
);

2260 
	`˛u°îM™agîNodeAºayRe£t
(
˛u°îM™agîNodeAºay
 *
¨øy
);

2261 
	`˛u°îM™agîNodeAºayShi·
(
˛u°îM™agîNodeAºay
 *
¨øy
,

2262 
˛u°îM™agîNode
 **
nodïå
);

2263 
	`˛u°îM™agîNodeAºayAdd
(
˛u°îM™agîNodeAºay
 *
¨øy
,

2264 
˛u°îM™agîNode
 *
node
);

2268 
	`˛u°îM™agîComm™dCª©e
(
¨gc
, **
¨gv
);

2269 
	`˛u°îM™agîComm™dAddNode
(
¨gc
, **
¨gv
);

2270 
	`˛u°îM™agîComm™dDñëeNode
(
¨gc
, **
¨gv
);

2271 
	`˛u°îM™agîComm™dInfo
(
¨gc
, **
¨gv
);

2272 
	`˛u°îM™agîComm™dCheck
(
¨gc
, **
¨gv
);

2273 
	`˛u°îM™agîComm™dFix
(
¨gc
, **
¨gv
);

2274 
	`˛u°îM™agîComm™dResh¨d
(
¨gc
, **
¨gv
);

2275 
	`˛u°îM™agîComm™dRebÆ™˚
(
¨gc
, **
¨gv
);

2276 
	`˛u°îM™agîComm™dSëTimeout
(
¨gc
, **
¨gv
);

2277 
	`˛u°îM™agîComm™dImp‹t
(
¨gc
, **
¨gv
);

2278 
	`˛u°îM™agîComm™dCÆl
(
¨gc
, **
¨gv
);

2279 
	`˛u°îM™agîComm™dHñp
(
¨gc
, **
¨gv
);

2280 
	`˛u°îM™agîComm™dBackup
(
¨gc
, **
¨gv
);

2282 
	s˛u°îM™agîComm™dDef
 {

2283 *
«me
;

2284 
˛u°îM™agîComm™dProc
 *
¥oc
;

2285 
¨ôy
;

2286 *
¨gs
;

2287 *
›ti⁄s
;

2288 } 
	t˛u°îM™agîComm™dDef
;

2290 
˛u°îM™agîComm™dDef
 
˛u°îM™agîComm™ds
[] = {

2291 {"¸óã", 
˛u°îM™agîComm™dCª©e
, -2, "host1:port1 ... hostN:portN",

2293 {"check", 
˛u°îM™agîComm™dCheck
, -1, "host:port",

2295 {"öfo", 
˛u°îM™agîComm™dInfo
, -1, "ho°:p‹t", 
NULL
},

2296 {"fix", 
˛u°îM™agîComm™dFix
, -1, "host:port",

2298 {"ªsh¨d", 
˛u°îM™agîComm™dResh¨d
, -1, "host:port",

2301 {"ªbÆ™˚", 
˛u°îM™agîComm™dRebÆ™˚
, -1, "host:port",

2304 {"add-node", 
˛u°îM™agîComm™dAddNode
, 2,

2306 {"dñ-node", 
˛u°îM™agîComm™dDñëeNode
, 2, "ho°:p‹ànode_id",
NULL
},

2307 {"ˇŒ", 
˛u°îM™agîComm™dCÆl
, -2,

2308 "ho°:p‹àcomm™dárgárg ..árg", 
NULL
},

2309 {"£t-timeout", 
˛u°îM™agîComm™dSëTimeout
, 2,

2310 "ho°:p‹àmûli£c⁄ds", 
NULL
},

2311 {"imp‹t", 
˛u°îM™agîComm™dImp‹t
, 1, "host:port",

2313 {"backup", 
˛u°îM™agîComm™dBackup
, 2, "host:port backup_directory",

2314 
NULL
},

2315 {"hñp", 
˛u°îM™agîComm™dHñp
, 0, 
NULL
, NULL}

2316 
	}
};

2318 
gëRDB
(
˛u°îM™agîNode
 *
node
);

2320 
	$¸óãClu°îM™agîComm™d
(*
cmd«me
, 
¨gc
, **
¨gv
) {

2321 
˛u°îM™agîComm™d
 *
cmd
 = &
c⁄fig
.
˛u°î_m™agî_comm™d
;

2322 
cmd
->
«me
 = 
cmd«me
;

2323 
cmd
->
¨gc
 =árgc;

2324 
cmd
->
¨gv
 = 
¨gc
 ?árgv : 
NULL
;

2325 i‡(
	`isCﬁ‹Tîm
()Ë
cmd
->
Êags
 |
CLUSTER_MANAGER_CMD_FLAG_COLOR
;

2326 
	}
}

2329 
˛u°îM™agîComm™dProc
 *
	$vÆid©eClu°îM™agîComm™d
() {

2330 
i
, 
comm™ds_cou¡
 = (
˛u°îM™agîComm™ds
) /

2331 (
˛u°îM™agîComm™dDef
);

2332 
˛u°îM™agîComm™dProc
 *
¥oc
 = 
NULL
;

2333 *
cmd«me
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
«me
;

2334 
¨gc
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.argc;

2335 
i
 = 0; i < 
comm™ds_cou¡
; i++) {

2336 
˛u°îM™agîComm™dDef
 
cmddef
 = 
˛u°îM™agîComm™ds
[
i
];

2337 i‡(!
	`°rcmp
(
cmddef
.
«me
, 
cmd«me
)) {

2338 i‡((
cmddef
.
¨ôy
 > 0 && 
¨gc
 != cmddef.arity) ||

2339 (
cmddef
.
¨ôy
 < 0 && 
¨gc
 < (cmddef.arity * -1))) {

2340 
	`Ârötf
(
°dîr
, "[ERR] WrongÇumber ofárguments for "

2342  
NULL
;

2344 
¥oc
 = 
cmddef
.proc;

2347 i‡(!
¥oc
Ë
	`Ârötf
(
°dîr
, "Unknown --cluster subcommand\n");

2348  
¥oc
;

2349 
	}
}

2351 
	$∑r£Clu°îNodeAddªss
(*
addr
, **
ù_±r
, *
p‹t_±r
,

2352 *
bus_p‹t_±r
)

2354 *
c
 = 
	`°ºchr
(
addr
, '@');

2355 i‡(
c
 !
NULL
) {

2356 *
c
 = '\0';

2357 i‡(
bus_p‹t_±r
 !
NULL
)

2358 *
bus_p‹t_±r
 = 
	`©oi
(
c
 + 1);

2360 
c
 = 
	`°ºchr
(
addr
, ':');

2361 i‡(
c
 !
NULL
) {

2362 *
c
 = '\0';

2363 *
ù_±r
 = 
addr
;

2364 *
p‹t_±r
 = 
	`©oi
(++
c
);

2367 
	}
}

2375 
	$gëClu°îHo°FromCmdArgs
(
¨gc
, **
¨gv
,

2376 **
ù_±r
, *
p‹t_±r
) {

2377 
p‹t
 = 0;

2378 *
ù
 = 
NULL
;

2379 i‡(
¨gc
 == 1) {

2380 *
addr
 = 
¨gv
[0];

2381 i‡(!
	`∑r£Clu°îNodeAddªss
(
addr
, &
ù
, &
p‹t
, 
NULL
))  0;

2383 
ù
 = 
¨gv
[0];

2384 
p‹t
 = 
	`©oi
(
¨gv
[1]);

2386 i‡(!
ù
 || !
p‹t
)  0;

2388 *
ù_±r
 = 
ù
;

2389 *
p‹t_±r
 = 
p‹t
;

2392 
	}
}

2394 
	$‰ìClu°îM™agîNodeFœgs
(
li°
 *
Êags
) {

2395 
li°Iãr
 
li
;

2396 
li°Node
 *
 
;

2397 
	`li°Rewöd
(
Êags
, &
li
);

2398 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2399 
sds
 
Êag
 = 
 
->
vÆue
;

2400 
	`sds‰ì
(
Êag
);

2402 
	`li°Rñó£
(
Êags
);

2403 
	}
}

2405 
	$‰ìClu°îM™agîNode
(
˛u°îM™agîNode
 *
node
) {

2406 i‡(
node
->
c⁄ãxt
 !
NULL
Ë
	`ªdisFªe
(node->context);

2407 i‡(
node
->
‰õnds
 !
NULL
) {

2408 
li°Iãr
 
li
;

2409 
li°Node
 *
 
;

2410 
	`li°Rewöd
(
node
->
‰õnds
,&
li
);

2411 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2412 
˛u°îM™agîNode
 *
‚
 = 
 
->
vÆue
;

2413 
	`‰ìClu°îM™agîNode
(
‚
);

2415 
	`li°Rñó£
(
node
->
‰õnds
);

2416 
node
->
‰õnds
 = 
NULL
;

2418 i‡(
node
->
«me
 !
NULL
Ë
	`sds‰ì
(node->name);

2419 i‡(
node
->
ª∂iˇã
 !
NULL
Ë
	`sds‰ì
(node->replicate);

2420 i‡((
node
->
Êags
 & 
CLUSTER_MANAGER_FLAG_FRIEND
Ë&&Çode->
ù
)

2421 
	`sds‰ì
(
node
->
ù
);

2422 
i
;

2423 i‡(
node
->
migøtög
 !
NULL
) {

2424 
i
 = 0; i < 
node
->
migøtög_cou¡
; i++Ë
	`sds‰ì
“ode->
migøtög
[i]);

2425 
	`z‰ì
(
node
->
migøtög
);

2427 i‡(
node
->
imp‹tög
 !
NULL
) {

2428 
i
 = 0; i < 
node
->
imp‹tög_cou¡
; i++Ë
	`sds‰ì
“ode->
imp‹tög
[i]);

2429 
	`z‰ì
(
node
->
imp‹tög
);

2431 i‡(
node
->
Êags_°r
 !
NULL
) {

2432 
	`‰ìClu°îM™agîNodeFœgs
(
node
->
Êags_°r
);

2433 
node
->
Êags_°r
 = 
NULL
;

2435 
	`z‰ì
(
node
);

2436 
	}
}

2438 
	$‰ìClu°îM™agî
() {

2439 
li°Iãr
 
li
;

2440 
li°Node
 *
 
;

2441 i‡(
˛u°î_m™agî
.
nodes
 !
NULL
) {

2442 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
,&
li
);

2443 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2444 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

2445 
	`‰ìClu°îM™agîNode
(
n
);

2447 
	`li°Rñó£
(
˛u°î_m™agî
.
nodes
);

2448 
˛u°î_m™agî
.
nodes
 = 
NULL
;

2450 i‡(
˛u°î_m™agî
.
îr‹s
 !
NULL
) {

2451 
	`li°Rewöd
(
˛u°î_m™agî
.
îr‹s
,&
li
);

2452 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2453 
sds
 
îr
 = 
 
->
vÆue
;

2454 
	`sds‰ì
(
îr
);

2456 
	`li°Rñó£
(
˛u°î_m™agî
.
îr‹s
);

2457 
˛u°î_m™agî
.
îr‹s
 = 
NULL
;

2459 i‡(
˛u°îM™agîUncovîedSlŸs
 !
NULL
)

2460 
	`di˘Rñó£
(
˛u°îM™agîUncovîedSlŸs
);

2461 
	}
}

2463 
˛u°îM™agîNode
 *
	$˛u°îM™agîNewNode
(*
ù
, 
p‹t
) {

2464 
˛u°îM™agîNode
 *
node
 = 
	`zmÆloc
((*node));

2465 
node
->
c⁄ãxt
 = 
NULL
;

2466 
node
->
«me
 = 
NULL
;

2467 
node
->
ù
 = ip;

2468 
node
->
p‹t
 =Öort;

2469 
node
->
cuºít_ïoch
 = 0;

2470 
node
->
pög_£¡
 = 0;

2471 
node
->
pög_ªcv
 = 0;

2472 
node
->
Êags
 = 0;

2473 
node
->
Êags_°r
 = 
NULL
;

2474 
node
->
ª∂iˇã
 = 
NULL
;

2475 
node
->
dúty
 = 0;

2476 
node
->
‰õnds
 = 
NULL
;

2477 
node
->
migøtög
 = 
NULL
;

2478 
node
->
imp‹tög
 = 
NULL
;

2479 
node
->
migøtög_cou¡
 = 0;

2480 
node
->
imp‹tög_cou¡
 = 0;

2481 
node
->
ª∂iˇs_cou¡
 = 0;

2482 
node
->
weight
 = 1.0f;

2483 
node
->
bÆ™˚
 = 0;

2484 
	`˛u°îM™agîNodeRe£tSlŸs
(
node
);

2485  
node
;

2486 
	}
}

2488 
sds
 
	$˛u°îM™agîGëNodeRDBFûíame
(
˛u°îM™agîNode
 *
node
) {

2489 
	`as£π
(
c⁄fig
.
˛u°î_m™agî_comm™d
.
backup_dú
);

2490 
sds
 
fûíame
 = 
	`sd¢ew
(
c⁄fig
.
˛u°î_m™agî_comm™d
.
backup_dú
);

2491 i‡(
fûíame
[
	`sd¶í
(filename) - 1] != '/')

2492 
fûíame
 = 
	`sdsˇt
(filename, "/");

2493 
fûíame
 = 
	`sdsˇçrötf
(fûíame, "ªdis-node-%s-%d-%s.rdb", 
node
->
ù
,

2494 
node
->
p‹t
,Çode->
«me
);

2495  
fûíame
;

2496 
	}
}

2502 
	$˛u°îM™agîCheckRedisRïly
(
˛u°îM™agîNode
 *
n
,

2503 
ªdisRïly
 *
r
, **
îr
)

2505 
is_îr
 = 0;

2506 i‡(!
r
 || (
is_îr
 = (r->
ty≥
 =
REDIS_REPLY_ERROR
))) {

2507 i‡(
is_îr
) {

2508 i‡(
îr
 !
NULL
) {

2509 *
îr
 = 
	`zmÆloc
((
r
->
Àn
 + 1) * ());

2510 
	`°r˝y
(*
îr
, 
r
->
°r
);

2511 } 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
n
, 
r
->
°r
);

2516 
	}
}

2519 
	$˛u°îM™agîSèπTønß˘i⁄
(
˛u°îM™agîNode
 *
node
) {

2520 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "MULTI");

2521 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
NULL
);

2522 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

2523  
suc˚ss
;

2524 
	}
}

2527 
	$˛u°îM™agîExecTønß˘i⁄
(
˛u°îM™agîNode
 *
node
,

2528 
˛u°îM™agîOnRïlyEº‹
 
⁄îr‹
)

2530 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "EXEC");

2531 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
NULL
);

2532 i‡(
suc˚ss
) {

2533 i‡(
ª∂y
->
ty≥
 !
REDIS_REPLY_ARRAY
) {

2534 
suc˚ss
 = 0;

2535 
˛ónup
;

2537 
size_t
 
i
;

2538 
i
 = 0; i < 
ª∂y
->
ñemíts
; i++) {

2539 
ªdisRïly
 *
r
 = 
ª∂y
->
ñemít
[
i
];

2540 *
îr
 = 
NULL
;

2541 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
r
, &
îr
);

2542 i‡(!
suc˚ss
 && 
⁄îr‹
Ësuc˚s†
	`⁄îr‹
(
r
, 
node
, 
i
);

2543 i‡(
îr
) {

2544 i‡(!
suc˚ss
)

2545 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node
, 
îr
);

2546 
	`z‰ì
(
îr
);

2548 i‡(!
suc˚ss
) ;

2551 
˛ónup
:

2552 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

2553  
suc˚ss
;

2554 
	}
}

2556 
	$˛u°îM™agîNodeC⁄√˘
(
˛u°îM™agîNode
 *
node
) {

2557 i‡(
node
->
c⁄ãxt
Ë
	`ªdisFªe
(node->context);

2558 
node
->
c⁄ãxt
 = 
	`ªdisC⁄√˘
“ode->
ù
,Çode->
p‹t
);

2559 i‡(!
node
->
c⁄ãxt
->
îr
 && 
c⁄fig
.
és
) {

2560 c⁄° *
îr
 = 
NULL
;

2561 i‡(
	`˛iSecuªC⁄√˘i⁄
(
node
->
c⁄ãxt
, &
îr
Ë=
REDIS_ERR
 &&Érr) {

2562 
	`Ârötf
(
°dîr
,"TLS Eº‹: %s\n", 
îr
);

2563 
	`ªdisFªe
(
node
->
c⁄ãxt
);

2564 
node
->
c⁄ãxt
 = 
NULL
;

2568 i‡(
node
->
c⁄ãxt
->
îr
) {

2569 
	`Ârötf
(
°dîr
,"CouldÇot connectÅo Redisát ");

2570 
	`Ârötf
(
°dîr
,"%s:%d: %s\n", 
node
->
ù
,Çode->
p‹t
,

2571 
node
->
c⁄ãxt
->
îr°r
);

2572 
	`ªdisFªe
(
node
->
c⁄ãxt
);

2573 
node
->
c⁄ãxt
 = 
NULL
;

2580 
	`™ëKìpAlive
(
NULL
, 
node
->
c⁄ãxt
->
fd
, 
REDIS_CLI_KEEPALIVE_INTERVAL
);

2581 i‡(
c⁄fig
.
auth
) {

2582 
ªdisRïly
 *
ª∂y
;

2583 i‡(
c⁄fig
.
u£r
 =
NULL
)

2584 
ª∂y
 = 
	`ªdisComm™d
(
node
->
c⁄ãxt
,"AUTH %s", 
c⁄fig
.
auth
);

2586 
ª∂y
 = 
	`ªdisComm™d
(
node
->
c⁄ãxt
,"AUTH %s %s",

2587 
c⁄fig
.
u£r
,c⁄fig.
auth
);

2588 
ok
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
NULL
);

2589 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

2590 i‡(!
ok
)  0;

2593 
	}
}

2595 
	$˛u°îM™agîRemoveNodeFromLi°
(
li°
 *
nodñi°
,

2596 
˛u°îM™agîNode
 *
node
) {

2597 
li°Iãr
 
li
;

2598 
li°Node
 *
 
;

2599 
	`li°Rewöd
(
nodñi°
, &
li
);

2600 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2601 i‡(
node
 =
 
->
vÆue
) {

2602 
	`li°DñNode
(
nodñi°
, 
 
);

2606 
	}
}

2609 
˛u°îM™agîNode
 *
	$˛u°îM™agîNodeByName
(c⁄° *
«me
) {

2610 i‡(
˛u°î_m™agî
.
nodes
 =
NULL
)  NULL;

2611 
˛u°îM™agîNode
 *
found
 = 
NULL
;

2612 
sds
 
l˙ame
 = 
	`sd£m±y
();

2613 
l˙ame
 = 
	`sds˝y
÷˙ame, 
«me
);

2614 
	`sd°ﬁowî
(
l˙ame
);

2615 
li°Iãr
 
li
;

2616 
li°Node
 *
 
;

2617 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

2618 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2619 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

2620 i‡(
n
->
«me
 && !
	`sdscmp
“->«me, 
l˙ame
)) {

2621 
found
 = 
n
;

2625 
	`sds‰ì
(
l˙ame
);

2626  
found
;

2627 
	}
}

2633 
˛u°îM™agîNode
 *
	$˛u°îM™agîNodeByAbbªvüãdName
(c⁄° *
«me
)

2635 i‡(
˛u°î_m™agî
.
nodes
 =
NULL
)  NULL;

2636 
˛u°îM™agîNode
 *
found
 = 
NULL
;

2637 
sds
 
l˙ame
 = 
	`sd£m±y
();

2638 
l˙ame
 = 
	`sds˝y
÷˙ame, 
«me
);

2639 
	`sd°ﬁowî
(
l˙ame
);

2640 
li°Iãr
 
li
;

2641 
li°Node
 *
 
;

2642 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

2643 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2644 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

2645 i‡(
n
->
«me
 &&

2646 
	`°r°r
(
n
->
«me
, 
l˙ame
) ==Ç->name) {

2647 
found
 = 
n
;

2651 
	`sds‰ì
(
l˙ame
);

2652  
found
;

2653 
	}
}

2655 
	$˛u°îM™agîNodeRe£tSlŸs
(
˛u°îM™agîNode
 *
node
) {

2656 
	`mem£t
(
node
->
¶Ÿs
, 0, (node->slots));

2657 
node
->
¶Ÿs_cou¡
 = 0;

2658 
	}
}

2661 
ªdisRïly
 *
	$˛u°îM™agîGëNodeRedisInfo
(
˛u°îM™agîNode
 *
node
,

2662 **
îr
)

2664 
ªdisRïly
 *
öfo
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "INFO");

2665 i‡(
îr
 !
NULL
) *err = NULL;

2666 i‡(
öfo
 =
NULL
)  NULL;

2667 i‡(
öfo
->
ty≥
 =
REDIS_REPLY_ERROR
) {

2668 i‡(
îr
 !
NULL
) {

2669 *
îr
 = 
	`zmÆloc
((
öfo
->
Àn
 + 1) * ());

2670 
	`°r˝y
(*
îr
, 
öfo
->
°r
);

2672 
	`‰ìRïlyObje˘
(
öfo
);

2673  
NULL
;

2675  
öfo
;

2676 
	}
}

2678 
	$˛u°îM™agîNodeIsClu°î
(
˛u°îM™agîNode
 *
node
, **
îr
) {

2679 
ªdisRïly
 *
öfo
 = 
	`˛u°îM™agîGëNodeRedisInfo
(
node
, 
îr
);

2680 i‡(
öfo
 =
NULL
)  0;

2681 
is_˛u°î
 = (Ë
	`gëL⁄gInfoFõld
(
öfo
->
°r
, "cluster_enabled");

2682 
	`‰ìRïlyObje˘
(
öfo
);

2683  
is_˛u°î
;

2684 
	}
}

2688 
	$˛u°îM™agîNodeIsEm±y
(
˛u°îM™agîNode
 *
node
, **
îr
) {

2689 
ªdisRïly
 *
öfo
 = 
	`˛u°îM™agîGëNodeRedisInfo
(
node
, 
îr
);

2690 
is_em±y
 = 1;

2691 i‡(
öfo
 =
NULL
)  0;

2692 i‡(
	`°r°r
(
öfo
->
°r
, "db0:"Ë!
NULL
) {

2693 
is_em±y
 = 0;

2694 
ªsu…
;

2696 
	`‰ìRïlyObje˘
(
öfo
);

2697 
öfo
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "CLUSTER INFO");

2698 i‡(
îr
 !
NULL
) *err = NULL;

2699 i‡(!
	`˛u°îM™agîCheckRedisRïly
(
node
, 
öfo
, 
îr
)) {

2700 
is_em±y
 = 0;

2701 
ªsu…
;

2703 
known_nodes
 = 
	`gëL⁄gInfoFõld
(
öfo
->
°r
, "cluster_known_nodes");

2704 
is_em±y
 = (
known_nodes
 == 1);

2705 
ªsu…
:

2706 
	`‰ìRïlyObje˘
(
öfo
);

2707  
is_em±y
;

2708 
	}
}

2739 
	$˛u°îM™agîGëA¡iAfföôySc‹e
(
˛u°îM™agîNodeAºay
 *
ùnodes
,

2740 
ù_cou¡
, 
˛u°îM™agîNode
 ***
of„ndög
, *
of„ndög_Àn
)

2742 
sc‹e
 = 0, 
i
, 
j
;

2743 
node_Àn
 = 
˛u°î_m™agî
.
nodes
->
Àn
;

2744 
˛u°îM™agîNode
 **
of„ndög_p
 = 
NULL
;

2745 i‡(
of„ndög
 !
NULL
) {

2746 *
of„ndög
 = 
	`zˇŒoc
(
node_Àn
 * (
˛u°îM™agîNode
*));

2747 
of„ndög_p
 = *
of„ndög
;

2752 
i
 = 0; i < 
ù_cou¡
; i++) {

2753 
˛u°îM™agîNodeAºay
 *
node_¨øy
 = &(
ùnodes
[
i
]);

2754 
di˘
 *
ªœãd
 = 
	`di˘Cª©e
(&
˛u°îM™agîDi˘Ty≥
, 
NULL
);

2755 *
ù
 = 
NULL
;

2756 
j
 = 0; j < 
node_¨øy
->
Àn
; j++) {

2757 
˛u°îM™agîNode
 *
node
 = 
node_¨øy
->
nodes
[
j
];

2758 i‡(
node
 =
NULL
) ;

2759 i‡(!
ù
Ëù = 
node
->ip;

2760 
sds
 
ty≥s
;

2762 
sds
 
key
 = (!
node
->
ª∂iˇã
 ?Çode->
«me
 :Çode->replicate);

2763 
	`as£π
(
key
 !
NULL
);

2764 
di˘E¡ry
 *
íåy
 = 
	`di˘Föd
(
ªœãd
, 
key
);

2765 i‡(
íåy
Ë
ty≥s
 = 
	`sdsdup
((
sds
Ë
	`di˘GëVÆ
(entry));

2766 
ty≥s
 = 
	`sd£m±y
();

2769 i‡(!
node
->
ª∂iˇã
Ë
ty≥s
 = 
	`sdsˇçrötf
(types, "m%s",Åypes);

2770 
ty≥s
 = 
	`sdsˇt
(types, "s");

2771 
	`di˘Rïœ˚
(
ªœãd
, 
key
, 
ty≥s
);

2775 
di˘Iãøt‹
 *
ôî
 = 
	`di˘GëIãøt‹
(
ªœãd
);

2776 
di˘E¡ry
 *
íåy
;

2777 (
íåy
 = 
	`di˘Next
(
ôî
)Ë!
NULL
) {

2778 
sds
 
ty≥s
 = (sdsË
	`di˘GëVÆ
(
íåy
);

2779 
sds
 
«me
 = (sdsË
	`di˘GëKey
(
íåy
);

2780 
ty≥¶í
 = 
	`sd¶í
(
ty≥s
);

2781 i‡(
ty≥¶í
 < 2) ;

2782 i‡(
ty≥s
[0] ='m'Ë
sc‹e
 +(10000 * (
ty≥¶í
 - 1));

2783 
sc‹e
 +(1 * 
ty≥¶í
);

2784 i‡(
of„ndög
 =
NULL
) ;

2786 
li°Iãr
 
li
;

2787 
li°Node
 *
 
;

2788 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

2789 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2790 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

2791 i‡(
n
->
ª∂iˇã
 =
NULL
) ;

2792 i‡(!
	`°rcmp
(
n
->
ª∂iˇã
, 
«me
Ë&& !°rcmp“->
ù
, ip)) {

2793 *(
of„ndög_p
++Ë
n
;

2794 i‡(
of„ndög_Àn
 !
NULL
) (*offending_len)++;

2800 
	`di˘Rñó£Iãøt‹
(
ôî
);

2801 
	`di˘Rñó£
(
ªœãd
);

2803  
sc‹e
;

2804 
	}
}

2806 
	$˛u°îM™agîO±imizeA¡iAfföôy
(
˛u°îM™agîNodeAºay
 *
ùnodes
,

2807 
ù_cou¡
)

2809 
˛u°îM™agîNode
 **
of„ndîs
 = 
NULL
;

2810 
sc‹e
 = 
	`˛u°îM™agîGëA¡iAfföôySc‹e
(
ùnodes
, 
ù_cou¡
,

2811 
NULL
, NULL);

2812 i‡(
sc‹e
 =0Ë
˛ónup
;

2813 
	`˛u°îM™agîLogInfo
(">>> TryingÅo optimize slavesállocation "

2815 
node_Àn
 = 
˛u°î_m™agî
.
nodes
->
Àn
;

2816 
maxôî
 = 500 * 
node_Àn
;

2817 
	`§™d
(
	`time
(
NULL
));

2818 
maxôî
 > 0) {

2819 
of„ndög_Àn
 = 0;

2820 i‡(
of„ndîs
 !
NULL
) {

2821 
	`z‰ì
(
of„ndîs
);

2822 
of„ndîs
 = 
NULL
;

2824 
sc‹e
 = 
	`˛u°îM™agîGëA¡iAfföôySc‹e
(
ùnodes
,

2825 
ù_cou¡
,

2826 &
of„ndîs
,

2827 &
of„ndög_Àn
);

2828 i‡(
sc‹e
 == 0) ;

2832 
ønd_idx
 = 
	`ønd
(Ë% 
of„ndög_Àn
;

2833 
˛u°îM™agîNode
 *
fú°
 = 
of„ndîs
[
ønd_idx
],

2834 *
£c⁄d
 = 
NULL
;

2835 
˛u°îM™agîNode
 **
Ÿhî_ª∂iˇs
 = 
	`zˇŒoc
((
node_Àn
 - 1) *

2836 (*
Ÿhî_ª∂iˇs
));

2837 
Ÿhî_ª∂iˇs_cou¡
 = 0;

2838 
li°Iãr
 
li
;

2839 
li°Node
 *
 
;

2840 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

2841 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2842 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

2843 i‡(
n
 !
fú°
 &&Ç->
ª∂iˇã
 !
NULL
)

2844 
Ÿhî_ª∂iˇs
[
Ÿhî_ª∂iˇs_cou¡
++] = 
n
;

2846 i‡(
Ÿhî_ª∂iˇs_cou¡
 == 0) {

2847 
	`z‰ì
(
Ÿhî_ª∂iˇs
);

2850 
ønd_idx
 = 
	`ønd
(Ë% 
Ÿhî_ª∂iˇs_cou¡
;

2851 
£c⁄d
 = 
Ÿhî_ª∂iˇs
[
ønd_idx
];

2852 *
fú°_ma°î
 = 
fú°
->
ª∂iˇã
,

2853 *
£c⁄d_ma°î
 = 
£c⁄d
->
ª∂iˇã
;

2854 
fú°
->
ª∂iˇã
 = 
£c⁄d_ma°î
, fú°->
dúty
 = 1;

2855 
£c⁄d
->
ª∂iˇã
 = 
fú°_ma°î
, sec⁄d->
dúty
 = 1;

2856 
√w_sc‹e
 = 
	`˛u°îM™agîGëA¡iAfföôySc‹e
(
ùnodes
,

2857 
ù_cou¡
,

2858 
NULL
, NULL);

2862 i‡(
√w_sc‹e
 > 
sc‹e
) {

2863 
fú°
->
ª∂iˇã
 = 
fú°_ma°î
;

2864 
£c⁄d
->
ª∂iˇã
 = 
£c⁄d_ma°î
;

2866 
	`z‰ì
(
Ÿhî_ª∂iˇs
);

2867 
maxôî
--;

2869 
sc‹e
 = 
	`˛u°îM™agîGëA¡iAfföôySc‹e
(
ùnodes
, 
ù_cou¡
, 
NULL
, NULL);

2870 *
msg
;

2871 
≥r„˘
 = (
sc‹e
 == 0);

2872 
log_Àvñ
 = (
≥r„˘
 ? 
CLUSTER_MANAGER_LOG_LVL_SUCCESS
 :

2873 
CLUSTER_MANAGER_LOG_LVL_WARN
);

2874 i‡(
≥r„˘
Ë
msg
 = "[OK] Perfectánti-affinity obtained!";

2875 i‡(
sc‹e
 >= 10000)

2876 
msg
 = ("[WARNING] Some slavesáre inÅhe same hostásÅheir master");

2878 
msg
=("[WARNING] Some slaves ofÅhe same masteráre inÅhe same host");

2879 
	`˛u°îM™agîLog
(
log_Àvñ
, "%s\n", 
msg
);

2880 
˛ónup
:

2881 
	`z‰ì
(
of„ndîs
);

2882 
	}
}

2885 
sds
 
	$˛u°îM™agîNodeFœgSåög
(
˛u°îM™agîNode
 *
node
) {

2886 
sds
 
Êags
 = 
	`sd£m±y
();

2887 i‡(!
node
->
Êags_°r
Ë 
Êags
;

2888 
em±y
 = 1;

2889 
li°Iãr
 
li
;

2890 
li°Node
 *
 
;

2891 
	`li°Rewöd
(
node
->
Êags_°r
, &
li
);

2892 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

2893 
sds
 
Êag
 = 
 
->
vÆue
;

2894 i‡(
	`°rcmp
(
Êag
, "myself") == 0) ;

2895 i‡(!
em±y
Ë
Êags
 = 
	`sdsˇt
(flags, ",");

2896 
Êags
 = 
	`sdsˇtfmt
(Êags, "%S", 
Êag
);

2897 
em±y
 = 0;

2899  
Êags
;

2900 
	}
}

2903 
sds
 
	$˛u°îM™agîNodeSlŸsSåög
(
˛u°îM™agîNode
 *
node
) {

2904 
sds
 
¶Ÿs
 = 
	`sd£m±y
();

2905 
fú°_ønge_idx
 = -1, 
œ°_¶Ÿ_idx
 = -1, 
i
;

2906 
i
 = 0; i < 
CLUSTER_MANAGER_SLOTS
; i++) {

2907 
has_¶Ÿ
 = 
node
->
¶Ÿs
[
i
];

2908 i‡(
has_¶Ÿ
) {

2909 i‡(
fú°_ønge_idx
 == -1) {

2910 i‡(
	`sd¶í
(
¶Ÿs
)Ë¶Ÿ†
	`sdsˇt
(slots, ",");

2911 
fú°_ønge_idx
 = 
i
;

2912 
¶Ÿs
 = 
	`sdsˇtfmt
(¶Ÿs, "[%u", 
i
);

2914 
œ°_¶Ÿ_idx
 = 
i
;

2916 i‡(
œ°_¶Ÿ_idx
 >= 0) {

2917 i‡(
fú°_ønge_idx
 =
œ°_¶Ÿ_idx
)

2918 
¶Ÿs
 = 
	`sdsˇt
(slots, "]");

2919 
¶Ÿs
 = 
	`sdsˇtfmt
(¶Ÿs, "-%u]", 
œ°_¶Ÿ_idx
);

2921 
œ°_¶Ÿ_idx
 = -1;

2922 
fú°_ønge_idx
 = -1;

2925 i‡(
œ°_¶Ÿ_idx
 >= 0) {

2926 i‡(
fú°_ønge_idx
 =
œ°_¶Ÿ_idx
Ë
¶Ÿs
 = 
	`sdsˇt
(slots, "]");

2927 
¶Ÿs
 = 
	`sdsˇtfmt
(¶Ÿs, "-%u]", 
œ°_¶Ÿ_idx
);

2929  
¶Ÿs
;

2930 
	}
}

2932 
sds
 
	$˛u°îM™agîNodeGëJSON
(
˛u°îM™agîNode
 *
node
,

2933 
îr‹_cou¡
)

2935 
sds
 
js⁄
 = 
	`sd£m±y
();

2936 
sds
 
ª∂iˇã
 = 
	`sd£m±y
();

2937 i‡(
node
->
ª∂iˇã
)

2938 
ª∂iˇã
 = 
	`sdsˇçrötf
‘ïliˇã, "\"%s\"", 
node
->replicate);

2940 
ª∂iˇã
 = 
	`sdsˇt
(replicate, "null");

2941 
sds
 
¶Ÿs
 = 
	`˛u°îM™agîNodeSlŸsSåög
(
node
);

2942 
sds
 
Êags
 = 
	`˛u°îM™agîNodeFœgSåög
(
node
);

2943 *
p
 = 
¶Ÿs
;

2944 (
p
 = 
	`°rchr
’, '-')Ë!
NULL
)

2945 *(
p
++) = ',';

2946 
js⁄
 = 
	`sdsˇçrötf
(json,

2956 
node
->
«me
,

2957 
node
->
ù
,

2958 
node
->
p‹t
,

2959 
ª∂iˇã
,

2960 
¶Ÿs
,

2961 
node
->
¶Ÿs_cou¡
,

2962 
Êags
,

2963 ()
node
->
cuºít_ïoch


2965 i‡(
îr‹_cou¡
 > 0) {

2966 
js⁄
 = 
	`sdsˇçrötf
(json, ",\n \"cluster_errors\": %lu",

2967 
îr‹_cou¡
);

2969 i‡(
node
->
migøtög_cou¡
 > 0 &&Çode->
migøtög
 !
NULL
) {

2970 
i
 = 0;

2971 
sds
 
migøtög
 = 
	`sd£m±y
();

2972 ; 
i
 < 
node
->
migøtög_cou¡
; i += 2) {

2973 
sds
 
¶Ÿ
 = 
node
->
migøtög
[
i
];

2974 
sds
 
de°
 = 
node
->
migøtög
[
i
 + 1];

2975 i‡(
¶Ÿ
 && 
de°
) {

2976 i‡(
	`sd¶í
(
migøtög
Ë> 0Ëmigøtög = 
	`sdsˇt
(migrating, ",");

2977 
migøtög
 = 
	`sdsˇtfmt
(migøtög, "\"%S\": \"%S\"", 
¶Ÿ
, 
de°
);

2980 i‡(
	`sd¶í
(
migøtög
) > 0)

2981 
js⁄
 = 
	`sdsˇtfmt
(js⁄, ",\¿ \"migøtög\": {%S}", 
migøtög
);

2982 
	`sds‰ì
(
migøtög
);

2984 i‡(
node
->
imp‹tög_cou¡
 > 0 &&Çode->
imp‹tög
 !
NULL
) {

2985 
i
 = 0;

2986 
sds
 
imp‹tög
 = 
	`sd£m±y
();

2987 ; 
i
 < 
node
->
imp‹tög_cou¡
; i += 2) {

2988 
sds
 
¶Ÿ
 = 
node
->
imp‹tög
[
i
];

2989 
sds
 
‰om
 = 
node
->
imp‹tög
[
i
 + 1];

2990 i‡(
¶Ÿ
 && 
‰om
) {

2991 i‡(
	`sd¶í
(
imp‹tög
Ë> 0Ëimp‹tög = 
	`sdsˇt
(importing, ",");

2992 
imp‹tög
 = 
	`sdsˇtfmt
(imp‹tög, "\"%S\": \"%S\"", 
¶Ÿ
, 
‰om
);

2995 i‡(
	`sd¶í
(
imp‹tög
) > 0)

2996 
js⁄
 = 
	`sdsˇtfmt
(js⁄, ",\¿ \"imp‹tög\": {%S}", 
imp‹tög
);

2997 
	`sds‰ì
(
imp‹tög
);

2999 
js⁄
 = 
	`sdsˇt
(json, "\n }");

3000 
	`sds‰ì
(
ª∂iˇã
);

3001 
	`sds‰ì
(
¶Ÿs
);

3002 
	`sds‰ì
(
Êags
);

3003  
js⁄
;

3004 
	}
}

3017 
	$˛u°îM™agîKeyHashSlŸ
(*
key
, 
keyÀn
) {

3018 
s
, 
e
;

3020 
s
 = 0; s < 
keyÀn
; s++)

3021 i‡(
key
[
s
] == '{') ;

3024 i‡(
s
 =
keyÀn
Ë 
	`¸c16
(
key
,keylen) & 0x3FFF;

3027 
e
 = 
s
+1;É < 
keyÀn
;É++)

3028 i‡(
key
[
e
] == '}') ;

3031 i‡(
e
 =
keyÀn
 ||É =
s
+1Ë 
	`¸c16
(
key
,keylen) & 0x3FFF;

3035  
	`¸c16
(
key
+
s
+1,
e
-s-1) & 0x3FFF;

3036 
	}
}

3039 
sds
 
	$˛u°îM™agîNodeInfo
(
˛u°îM™agîNode
 *
node
, 
ödít
) {

3040 
sds
 
öfo
 = 
	`sd£m±y
();

3041 
sds
 
•a˚s
 = 
	`sd£m±y
();

3042 
i
;

3043 
i
 = 0; i < 
ödít
; i++Ë
•a˚s
 = 
	`sdsˇt
(spaces, " ");

3044 i‡(
ödít
Ë
öfo
 = 
	`sdsˇt
(öfo, 
•a˚s
);

3045 
is_ma°î
 = !(
node
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
);

3046 *
rﬁe
 = (
is_ma°î
 ? "M" : "S");

3047 
sds
 
¶Ÿs
 = 
NULL
;

3048 i‡(
node
->
dúty
 &&Çode->
ª∂iˇã
 !
NULL
)

3049 
öfo
 = 
	`sdsˇtfmt
(öfo, "S: %S %s:%u", 
node
->
«me
,Çode->
ù
,Çode->
p‹t
);

3051 
¶Ÿs
 = 
	`˛u°îM™agîNodeSlŸsSåög
(
node
);

3052 
sds
 
Êags
 = 
	`˛u°îM™agîNodeFœgSåög
(
node
);

3053 
öfo
 = 
	`sdsˇtfmt
(info, "%s: %S %s:%u\n"

3056 
rﬁe
, 
node
->
«me
,Çode->
ù
,Çode->
p‹t
, 
•a˚s
,

3057 
¶Ÿs
, 
node
->
¶Ÿs_cou¡
, 
Êags
);

3058 
	`sds‰ì
(
¶Ÿs
);

3059 
	`sds‰ì
(
Êags
);

3061 i‡(
node
->
ª∂iˇã
 !
NULL
)

3062 
öfo
 = 
	`sdsˇtfmt
(öfo, "\n%†Ñïliˇã†%S", 
•a˚s
, 
node
->
ª∂iˇã
);

3063 i‡(
node
->
ª∂iˇs_cou¡
)

3064 
öfo
 = 
	`sdsˇtfmt
(info, "\n%s %UádditionalÑeplica(s)",

3065 
•a˚s
, 
node
->
ª∂iˇs_cou¡
);

3066 
	`sds‰ì
(
•a˚s
);

3067  
öfo
;

3068 
	}
}

3070 
	$˛u°îM™agîShowNodes
() {

3071 
li°Iãr
 
li
;

3072 
li°Node
 *
 
;

3073 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

3074 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

3075 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

3076 
sds
 
öfo
 = 
	`˛u°îM™agîNodeInfo
(
node
, 0);

3077 
	`¥ötf
("%s\n", (*Ë
öfo
);

3078 
	`sds‰ì
(
öfo
);

3080 
	}
}

3082 
	$˛u°îM™agîShowClu°îInfo
() {

3083 
ma°îs
 = 0;

3084 
keys
 = 0;

3085 
li°Iãr
 
li
;

3086 
li°Node
 *
 
;

3087 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

3088 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

3089 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

3090 i‡(!(
node
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
)) {

3091 i‡(!
node
->
«me
) ;

3092 
ª∂iˇs
 = 0;

3093 
dbsize
 = -1;

3094 
«me
[9];

3095 
	`mem˝y
(
«me
, 
node
->name, 8);

3096 
«me
[8] = '\0';

3097 
li°Iãr
 
ri
;

3098 
li°Node
 *
∫
;

3099 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
ri
);

3100 (
∫
 = 
	`li°Next
(&
ri
)Ë!
NULL
) {

3101 
˛u°îM™agîNode
 *
n
 = 
∫
->
vÆue
;

3102 i‡(
n
 =
node
 || !“->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
))

3104 i‡(
n
->
ª∂iˇã
 && !
	`°rcmp
“->ª∂iˇã, 
node
->
«me
))

3105 
ª∂iˇs
++;

3107 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "DBSIZE");

3108 i‡(
ª∂y
 !
NULL
 &&Ñïly->
ty≥
 =
REDIS_REPLY_INTEGER
)

3109 
dbsize
 = 
ª∂y
->
öãgî
;

3110 i‡(
dbsize
 < 0) {

3111 *
îr
 = "";

3112 i‡(
ª∂y
 !
NULL
 &&Ñïly->
ty≥
 =
REDIS_REPLY_ERROR
)

3113 
îr
 = 
ª∂y
->
°r
;

3114 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node
, 
îr
);

3115 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

3118 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

3119 
	`¥ötf
("%s:%d (%s...) -> %d keys | %d slots | %d slaves.\n",

3120 
node
->
ù
,Çode->
p‹t
, 
«me
, 
dbsize
,

3121 
node
->
¶Ÿs_cou¡
, 
ª∂iˇs
);

3122 
ma°îs
++;

3123 
keys
 +
dbsize
;

3126 
	`˛u°îM™agîLogOk
("[OK] %d key†ö %d ma°îs.\n", 
keys
, 
ma°îs
);

3127 
keys_≥r_¶Ÿ
 = 
keys
 / (Ë
CLUSTER_MANAGER_SLOTS
;

3128 
	`¥ötf
("%.2‡key†≥∏¶Ÿ o¿avîage.\n", 
keys_≥r_¶Ÿ
);

3129 
	}
}

3132 
	$˛u°îM™agîAddSlŸs
(
˛u°îM™agîNode
 *
node
, **
îr
)

3134 
ªdisRïly
 *
ª∂y
 = 
NULL
;

3135 *
_ª∂y
 = 
NULL
;

3136 
suc˚ss
 = 1;

3138 
¨gc
 = 
node
->
¶Ÿs_cou¡
 + 2;

3139 
sds
 *
¨gv
 = 
	`zmÆloc
(
¨gc
 * (*argv));

3140 
size_t
 *
¨gvÀn
 = 
	`zmÆloc
(
¨gc
 * (*argvlen));

3141 
¨gv
[0] = "CLUSTER";

3142 
¨gv
[1] = "ADDSLOTS";

3143 
¨gvÀn
[0] = 7;

3144 
¨gvÀn
[1] = 8;

3145 *
îr
 = 
NULL
;

3146 
i
, 
¨gv_idx
 = 2;

3147 
i
 = 0; i < 
CLUSTER_MANAGER_SLOTS
; i++) {

3148 i‡(
¨gv_idx
 >
¨gc
) ;

3149 i‡(
node
->
¶Ÿs
[
i
]) {

3150 
¨gv
[
¨gv_idx
] = 
	`sds‰oml⁄gl⁄g
((Ë
i
);

3151 
¨gvÀn
[
¨gv_idx
] = 
	`sd¶í
(
¨gv
[argv_idx]);

3152 
¨gv_idx
++;

3155 i‡(!
¨gv_idx
) {

3156 
suc˚ss
 = 0;

3157 
˛ónup
;

3159 
	`ªdisAµídComm™dArgv
(
node
->
c⁄ãxt
,
¨gc
,(c⁄° **)
¨gv
,
¨gvÀn
);

3160 i‡(
	`ªdisGëRïly
(
node
->
c⁄ãxt
, &
_ª∂y
Ë!
REDIS_OK
) {

3161 
suc˚ss
 = 0;

3162 
˛ónup
;

3164 
ª∂y
 = (
ªdisRïly
*Ë
_ª∂y
;

3165 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
îr
);

3166 
˛ónup
:

3167 
	`z‰ì
(
¨gvÀn
);

3168 i‡(
¨gv
 !
NULL
) {

3169 
i
 = 2; i < 
¨gc
; i++Ë
	`sds‰ì
(
¨gv
[i]);

3170 
	`z‰ì
(
¨gv
);

3172 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

3173  
suc˚ss
;

3174 
	}
}

3180 
˛u°îM™agîNode
 *
	$˛u°îM™agîGëSlŸOw√r
(
˛u°îM™agîNode
 *
n
,

3181 
¶Ÿ
, **
îr
)

3183 
	`as£π
(
¶Ÿ
 >0 && slŸ < 
CLUSTER_MANAGER_SLOTS
);

3184 
˛u°îM™agîNode
 *
ow√r
 = 
NULL
;

3185 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
, "CLUSTER SLOTS");

3186 i‡(
	`˛u°îM™agîCheckRedisRïly
(
n
, 
ª∂y
, 
îr
)) {

3187 
	`as£π
(
ª∂y
->
ty≥
 =
REDIS_REPLY_ARRAY
);

3188 
size_t
 
i
;

3189 
i
 = 0; i < 
ª∂y
->
ñemíts
; i++) {

3190 
ªdisRïly
 *
r
 = 
ª∂y
->
ñemít
[
i
];

3191 
	`as£π
(
r
->
ty≥
 =
REDIS_REPLY_ARRAY
 &&Ñ->
ñemíts
 >= 3);

3192 
‰om
, 
to
;

3193 
‰om
 = 
r
->
ñemít
[0]->
öãgî
;

3194 
to
 = 
r
->
ñemít
[1]->
öãgî
;

3195 i‡(
¶Ÿ
 < 
‰om
 || slŸ > 
to
) ;

3196 
ªdisRïly
 *
ƒ
 = 
r
->
ñemít
[2];

3197 
	`as£π
(
ƒ
->
ty≥
 =
REDIS_REPLY_ARRAY
 &&Çr->
ñemíts
 >= 2);

3198 *
«me
 = 
NULL
;

3199 i‡(
ƒ
->
ñemíts
 >= 3)

3200 
«me
 = 
ƒ
->
ñemít
[2]->
°r
;

3201 i‡(
«me
 !
NULL
)

3202 
ow√r
 = 
	`˛u°îM™agîNodeByName
(
«me
);

3204 *
ù
 = 
ƒ
->
ñemít
[0]->
°r
;

3205 
	`as£π
(
ù
 !
NULL
);

3206 
p‹t
 = (Ë
ƒ
->
ñemít
[1]->
öãgî
;

3207 
li°Iãr
 
li
;

3208 
li°Node
 *
 
;

3209 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

3210 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

3211 
˛u°îM™agîNode
 *
nd
 = 
 
->
vÆue
;

3212 i‡(
	`°rcmp
(
nd
->
ù
, ipË=0 && 
p‹t
 ==Çd->port) {

3213 
ow√r
 = 
nd
;

3218 i‡(
ow√r
) ;

3221 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

3222  
ow√r
;

3223 
	}
}

3226 
	$˛u°îM™agîSëSlŸ
(
˛u°îM™agîNode
 *
node1
,

3227 
˛u°îM™agîNode
 *
node2
,

3228 
¶Ÿ
, c⁄° *
°©us
, **
îr
) {

3229 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node1
, "CLUSTER "

3231 
¶Ÿ
, 
°©us
,

3232 (*Ë
node2
->
«me
);

3233 i‡(
îr
 !
NULL
) *err = NULL;

3234 i‡(!
ª∂y
)  0;

3235 
suc˚ss
 = 1;

3236 i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

3237 
suc˚ss
 = 0;

3238 i‡(
îr
 !
NULL
) {

3239 *
îr
 = 
	`zmÆloc
((
ª∂y
->
Àn
 + 1) * ());

3240 
	`°r˝y
(*
îr
, 
ª∂y
->
°r
);

3241 } 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node1
, 
ª∂y
->
°r
);

3242 
˛ónup
;

3244 
˛ónup
:

3245 
	`‰ìRïlyObje˘
(
ª∂y
);

3246  
suc˚ss
;

3247 
	}
}

3249 
	$˛u°îM™agîCÀ¨SlŸSètus
(
˛u°îM™agîNode
 *
node
, 
¶Ÿ
) {

3250 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
,

3251 "CLUSTER SETSLOT %d %s", 
¶Ÿ
, "STABLE");

3252 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
NULL
);

3253 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

3254  
suc˚ss
;

3255 
	}
}

3257 
	$˛u°îM™agîDñSlŸ
(
˛u°îM™agîNode
 *
node
, 
¶Ÿ
,

3258 
ign‹e_u«ssig√d_îr
)

3260 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
,

3261 "CLUSTER DELSLOTS %d", 
¶Ÿ
);

3262 *
îr
 = 
NULL
;

3263 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, &
îr
);

3264 i‡(!
suc˚ss
 && 
ª∂y
 &&Ñïly->
ty≥
 =
REDIS_REPLY_ERROR
 &&

3265 
ign‹e_u«ssig√d_îr
)

3267 *
gë_ow√r_îr
 = 
NULL
;

3268 
˛u°îM™agîNode
 *
assig√d_to
 =

3269 
	`˛u°îM™agîGëSlŸOw√r
(
node
, 
¶Ÿ
, &
gë_ow√r_îr
);

3270 i‡(!
assig√d_to
) {

3271 i‡(
gë_ow√r_îr
 =
NULL
Ë
suc˚ss
 = 1;

3273 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node
, 
gë_ow√r_îr
);

3274 
	`z‰ì
(
gë_ow√r_îr
);

3278 i‡(!
suc˚ss
 && 
îr
 !
NULL
) {

3279 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node
, 
îr
);

3280 
	`z‰ì
(
îr
);

3282 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

3283  
suc˚ss
;

3284 
	}
}

3286 
	$˛u°îM™agîAddSlŸ
(
˛u°îM™agîNode
 *
node
, 
¶Ÿ
) {

3287 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
,

3288 "CLUSTER ADDSLOTS %d", 
¶Ÿ
);

3289 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
NULL
);

3290 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

3291  
suc˚ss
;

3292 
	}
}

3294 sig√d 
	$˛u°îM™agîCou¡KeysInSlŸ
(
˛u°îM™agîNode
 *
node
,

3295 
¶Ÿ
)

3297 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
,

3298 "CLUSTER COUNTKEYSINSLOT %d", 
¶Ÿ
);

3299 
cou¡
 = -1;

3300 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
NULL
);

3301 i‡(
suc˚ss
 && 
ª∂y
->
ty≥
 =
REDIS_REPLY_INTEGER
Ë
cou¡
 =Ñïly->
öãgî
;

3302 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

3303  
cou¡
;

3304 
	}
}

3306 
	$˛u°îM™agîBumpEpoch
(
˛u°îM™agîNode
 *
node
) {

3307 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "CLUSTER BUMPEPOCH");

3308 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
NULL
);

3309 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

3310  
suc˚ss
;

3311 
	}
}

3316 
	$˛u°îM™agîOnSëOw√rEº
(
ªdisRïly
 *
ª∂y
,

3317 
˛u°îM™agîNode
 *
n
, 
bulk_idx
)

3319 
	`UNUSED
(
ª∂y
);

3320 
	`UNUSED
(
n
);

3322  (
bulk_idx
 != 1);

3323 
	}
}

3325 
	$˛u°îM™agîSëSlŸOw√r
(
˛u°îM™agîNode
 *
ow√r
,

3326 
¶Ÿ
,

3327 
do_˛ór
)

3329 
suc˚ss
 = 
	`˛u°îM™agîSèπTønß˘i⁄
(
ow√r
);

3330 i‡(!
suc˚ss
)  0;

3332 
	`˛u°îM™agîDñSlŸ
(
ow√r
, 
¶Ÿ
, 1);

3334 
	`˛u°îM™agîAddSlŸ
(
ow√r
, 
¶Ÿ
);

3335 i‡(
do_˛ór
Ë
	`˛u°îM™agîCÀ¨SlŸSètus
(
ow√r
, 
¶Ÿ
);

3336 
	`˛u°îM™agîBumpEpoch
(
ow√r
);

3337 
suc˚ss
 = 
	`˛u°îM™agîExecTønß˘i⁄
(
ow√r
, 
˛u°îM™agîOnSëOw√rEº
);

3338  
suc˚ss
;

3339 
	}
}

3346 
	$˛u°îM™agîCom∑ªKeysVÆues
(
˛u°îM™agîNode
 *
n1
,

3347 
˛u°îM™agîNode
 *
n2
,

3348 
ªdisRïly
 *
keys_ª∂y
,

3349 
li°
 *
diffs
)

3351 
size_t
 
i
, 
¨gc
 = 
keys_ª∂y
->
ñemíts
 + 2;

3352 c⁄° *
hash_zîo
 = "0000000000000000000000000000000000000000";

3353 **
¨gv
 = 
	`zˇŒoc
(
¨gc
 * (*));

3354 
size_t
 *
¨gv_Àn
 = 
	`zˇŒoc
(
¨gc
 * (size_t));

3355 
¨gv
[0] = "DEBUG";

3356 
¨gv_Àn
[0] = 5;

3357 
¨gv
[1] = "DIGEST-VALUE";

3358 
¨gv_Àn
[1] = 12;

3359 
i
 = 0; i < 
keys_ª∂y
->
ñemíts
; i++) {

3360 
ªdisRïly
 *
íåy
 = 
keys_ª∂y
->
ñemít
[
i
];

3361 
idx
 = 
i
 + 2;

3362 
¨gv
[
idx
] = 
íåy
->
°r
;

3363 
¨gv_Àn
[
idx
] = 
íåy
->
Àn
;

3365 
suc˚ss
 = 0;

3366 *
_ª∂y1
 = 
NULL
, *
_ª∂y2
 = NULL;

3367 
ªdisRïly
 *
r1
 = 
NULL
, *
r2
 = NULL;

3368 
	`ªdisAµídComm™dArgv
(
n1
->
c⁄ãxt
,
¨gc
, (c⁄° **)
¨gv
,
¨gv_Àn
);

3369 
suc˚ss
 = (
	`ªdisGëRïly
(
n1
->
c⁄ãxt
, &
_ª∂y1
Ë=
REDIS_OK
);

3370 i‡(!
suc˚ss
Ë
˛ónup
;

3371 
r1
 = (
ªdisRïly
 *Ë
_ª∂y1
;

3372 
	`ªdisAµídComm™dArgv
(
n2
->
c⁄ãxt
,
¨gc
, (c⁄° **)
¨gv
,
¨gv_Àn
);

3373 
suc˚ss
 = (
	`ªdisGëRïly
(
n2
->
c⁄ãxt
, &
_ª∂y2
Ë=
REDIS_OK
);

3374 i‡(!
suc˚ss
Ë
˛ónup
;

3375 
r2
 = (
ªdisRïly
 *Ë
_ª∂y2
;

3376 
suc˚ss
 = (
r1
->
ty≥
 !
REDIS_REPLY_ERROR
 && 
r2
->type != REDIS_REPLY_ERROR);

3377 i‡(
r1
->
ty≥
 =
REDIS_REPLY_ERROR
) {

3378 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
n1
, 
r1
->
°r
);

3379 
suc˚ss
 = 0;

3381 i‡(
r2
->
ty≥
 =
REDIS_REPLY_ERROR
) {

3382 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
n2
, 
r2
->
°r
);

3383 
suc˚ss
 = 0;

3385 i‡(!
suc˚ss
Ë
˛ónup
;

3386 
	`as£π
(
keys_ª∂y
->
ñemíts
 =
r1
->elements &&

3387 
keys_ª∂y
->
ñemíts
 =
r2
->elements);

3388 
i
 = 0; i < 
keys_ª∂y
->
ñemíts
; i++) {

3389 *
key
 = 
keys_ª∂y
->
ñemít
[
i
]->
°r
;

3390 *
hash1
 = 
r1
->
ñemít
[
i
]->
°r
;

3391 *
hash2
 = 
r2
->
ñemít
[
i
]->
°r
;

3393 i‡(
	`°rcmp
(
hash1
, 
hash_zîo
Ë=0 || såcmp(
hash2
, hash_zero) == 0)

3395 i‡(
	`°rcmp
(
hash1
, 
hash2
Ë!0Ë
	`li°AddNodeTaû
(
diffs
, 
key
);

3397 
˛ónup
:

3398 i‡(
r1
Ë
	`‰ìRïlyObje˘
(r1);

3399 i‡(
r2
Ë
	`‰ìRïlyObje˘
(r2);

3400 
	`z‰ì
(
¨gv
);

3401 
	`z‰ì
(
¨gv_Àn
);

3402  
suc˚ss
;

3403 
	}
}

3408 
ªdisRïly
 *
	$˛u°îM™agîMigøãKeysInRïly
(
˛u°îM™agîNode
 *
sour˚
,

3409 
˛u°îM™agîNode
 *
èrgë
,

3410 
ªdisRïly
 *
ª∂y
,

3411 
ª∂a˚
, 
timeout
,

3412 *
dŸs
)

3414 
ªdisRïly
 *
migøã_ª∂y
 = 
NULL
;

3415 **
¨gv
 = 
NULL
;

3416 
size_t
 *
¨gv_Àn
 = 
NULL
;

3417 
c
 = (
ª∂a˚
 ? 8 : 7);

3418 i‡(
c⁄fig
.
auth
Ë
c
 += 2;

3419 
size_t
 
¨gc
 = 
c
 + 
ª∂y
->
ñemíts
;

3420 
size_t
 
i
, 
off£t
 = 6;

3421 
¨gv
 = 
	`zˇŒoc
(
¨gc
 * (*));

3422 
¨gv_Àn
 = 
	`zˇŒoc
(
¨gc
 * (
size_t
));

3423 
p‹t°r
[255];

3424 
timeout°r
[255];

3425 
	`¢¥ötf
(
p‹t°r
, 10, "%d", 
èrgë
->
p‹t
);

3426 
	`¢¥ötf
(
timeout°r
, 10, "%d", 
timeout
);

3427 
¨gv
[0] = "MIGRATE";

3428 
¨gv_Àn
[0] = 7;

3429 
¨gv
[1] = 
èrgë
->
ù
;

3430 
¨gv_Àn
[1] = 
	`°æí
(
èrgë
->
ù
);

3431 
¨gv
[2] = 
p‹t°r
;

3432 
¨gv_Àn
[2] = 
	`°æí
(
p‹t°r
);

3433 
¨gv
[3] = "";

3434 
¨gv_Àn
[3] = 0;

3435 
¨gv
[4] = "0";

3436 
¨gv_Àn
[4] = 1;

3437 
¨gv
[5] = 
timeout°r
;

3438 
¨gv_Àn
[5] = 
	`°æí
(
timeout°r
);

3439 i‡(
ª∂a˚
) {

3440 
¨gv
[
off£t
] = "REPLACE";

3441 
¨gv_Àn
[
off£t
] = 7;

3442 
off£t
++;

3444 i‡(
c⁄fig
.
auth
) {

3445 
¨gv
[
off£t
] = "AUTH";

3446 
¨gv_Àn
[
off£t
] = 4;

3447 
off£t
++;

3448 
¨gv
[
off£t
] = 
c⁄fig
.
auth
;

3449 
¨gv_Àn
[
off£t
] = 
	`°æí
(
c⁄fig
.
auth
);

3450 
off£t
++;

3452 
¨gv
[
off£t
] = "KEYS";

3453 
¨gv_Àn
[
off£t
] = 4;

3454 
off£t
++;

3455 
i
 = 0; i < 
ª∂y
->
ñemíts
; i++) {

3456 
ªdisRïly
 *
íåy
 = 
ª∂y
->
ñemít
[
i
];

3457 
size_t
 
idx
 = 
i
 + 
off£t
;

3458 
	`as£π
(
íåy
->
ty≥
 =
REDIS_REPLY_STRING
);

3459 
¨gv
[
idx
] = (*Ë
	`sd¢ewÀn
(
íåy
->
°r
,É¡ry->
Àn
);

3460 
¨gv_Àn
[
idx
] = 
íåy
->
Àn
;

3461 i‡(
dŸs
ËdŸs[
i
] = '.';

3463 i‡(
dŸs
ËdŸs[
ª∂y
->
ñemíts
] = '\0';

3464 *
_ª∂y
 = 
NULL
;

3465 
	`ªdisAµídComm™dArgv
(
sour˚
->
c⁄ãxt
,
¨gc
,

3466 (c⁄° **)
¨gv
,
¨gv_Àn
);

3467 
suc˚ss
 = (
	`ªdisGëRïly
(
sour˚
->
c⁄ãxt
, &
_ª∂y
Ë=
REDIS_OK
);

3468 
i
 = 0; i < 
ª∂y
->
ñemíts
; i++Ë
	`sds‰ì
(
¨gv
[ò+ 
off£t
]);

3469 i‡(!
suc˚ss
Ë
˛ónup
;

3470 
migøã_ª∂y
 = (
ªdisRïly
 *Ë
_ª∂y
;

3471 
˛ónup
:

3472 
	`z‰ì
(
¨gv
);

3473 
	`z‰ì
(
¨gv_Àn
);

3474  
migøã_ª∂y
;

3475 
	}
}

3478 
	$˛u°îM™agîMigøãKeysInSlŸ
(
˛u°îM™agîNode
 *
sour˚
,

3479 
˛u°îM™agîNode
 *
èrgë
,

3480 
¶Ÿ
, 
timeout
,

3481 
pùñöe
, 
vîbo£
,

3482 **
îr
)

3484 
suc˚ss
 = 1;

3485 
do_fix
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 &

3486 
CLUSTER_MANAGER_CMD_FLAG_FIX
;

3487 
do_ª∂a˚
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 &

3488 
CLUSTER_MANAGER_CMD_FLAG_REPLACE
;

3490 *
dŸs
 = 
NULL
;

3491 
ªdisRïly
 *
ª∂y
 = 
NULL
, *
migøã_ª∂y
 = NULL;

3492 
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
sour˚
, "CLUSTER "

3493 "GETKEYSINSLOT %d %d", 
¶Ÿ
,

3494 
pùñöe
);

3495 
suc˚ss
 = (
ª∂y
 !
NULL
);

3496 i‡(!
suc˚ss
)  0;

3497 i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

3498 
suc˚ss
 = 0;

3499 i‡(
îr
 !
NULL
) {

3500 *
îr
 = 
	`zmÆloc
((
ª∂y
->
Àn
 + 1) * ());

3501 
	`°r˝y
(*
îr
, 
ª∂y
->
°r
);

3502 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
sour˚
, *
îr
);

3504 
√xt
;

3506 
	`as£π
(
ª∂y
->
ty≥
 =
REDIS_REPLY_ARRAY
);

3507 
size_t
 
cou¡
 = 
ª∂y
->
ñemíts
;

3508 i‡(
cou¡
 == 0) {

3509 
	`‰ìRïlyObje˘
(
ª∂y
);

3512 i‡(
vîbo£
Ë
dŸs
 = 
	`zmÆloc
((
cou¡
+1) * ());

3514 
migøã_ª∂y
 = 
	`˛u°îM™agîMigøãKeysInRïly
(
sour˚
, 
èrgë
,

3515 
ª∂y
, 0, 
timeout
,

3516 
dŸs
);

3517 i‡(
migøã_ª∂y
 =
NULL
Ë
√xt
;

3518 i‡(
migøã_ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

3519 
is_busy
 = 
	`°r°r
(
migøã_ª∂y
->
°r
, "BUSYKEY"Ë!
NULL
;

3520 
nŸ_£rved
 = 0;

3521 i‡(!
is_busy
) {

3524 *
gë_ow√r_îr
 = 
NULL
;

3525 
˛u°îM™agîNode
 *
£rved_by
 =

3526 
	`˛u°îM™agîGëSlŸOw√r
(
sour˚
, 
¶Ÿ
, &
gë_ow√r_îr
);

3527 i‡(!
£rved_by
) {

3528 i‡(
gë_ow√r_îr
 =
NULL
Ë
nŸ_£rved
 = 1;

3530 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
sour˚
,

3531 
gë_ow√r_îr
);

3532 
	`z‰ì
(
gë_ow√r_îr
);

3537 i‡(
is_busy
 || 
nŸ_£rved
) {

3540 i‡(
do_fix
 && 
nŸ_£rved
) {

3541 
	`˛u°îM™agîLogW¨n
("*** Slot wasÇot served, setting "

3543 
èrgë
->
ù
,Å¨gë->
p‹t
);

3544 
	`˛u°îM™agîSëSlŸ
(
sour˚
, 
èrgë
, 
¶Ÿ
, "node", 
NULL
);

3555 i‡(
is_busy
) {

3556 
	`˛u°îM™agîLogW¨n
("\n*** Target keyÉxists\n");

3557 i‡(!
do_ª∂a˚
) {

3558 
	`˛u°îM™agîLogW¨n
("*** Checking key values on "

3560 
li°
 *
diffs
 = 
	`li°Cª©e
();

3561 
suc˚ss
 = 
	`˛u°îM™agîCom∑ªKeysVÆues
(
sour˚
,

3562 
èrgë
, 
ª∂y
, 
diffs
);

3563 i‡(!
suc˚ss
) {

3564 
	`˛u°îM™agîLogEº
("*** Value check failed!\n");

3565 
	`li°Rñó£
(
diffs
);

3566 
√xt
;

3568 i‡(
	`li°Lígth
(
diffs
) > 0) {

3569 
suc˚ss
 = 0;

3570 
	`˛u°îM™agîLogEº
(

3576 
	`li°Lígth
(
diffs
),

3577 
sour˚
->
ù
, sour˚->
p‹t
,

3578 
èrgë
->
ù
,Å¨gë->
p‹t
);

3579 
li°Iãr
 
dli
;

3580 
li°Node
 *
d 
;

3581 
	`li°Rewöd
(
diffs
, &
dli
);

3582 (
d 
 = 
	`li°Next
(&
dli
)Ë!
NULL
) {

3583 *
k
 = 
d 
->
vÆue
;

3584 
	`˛u°îM™agîLogEº
(" - %s\n", 
k
);

3586 
	`˛u°îM™agîLogEº
("Please fixÅheábove key(s) "

3592 
	`li°Rñó£
(
diffs
);

3593 
√xt
;

3595 
	`li°Rñó£
(
diffs
);

3597 
	`˛u°îM™agîLogW¨n
("*** ReplacingÅarget keys...\n");

3599 
	`‰ìRïlyObje˘
(
migøã_ª∂y
);

3600 
migøã_ª∂y
 = 
	`˛u°îM™agîMigøãKeysInRïly
(
sour˚
,

3601 
èrgë
,

3602 
ª∂y
,

3603 
is_busy
,

3604 
timeout
,

3605 
NULL
);

3606 
suc˚ss
 = (
migøã_ª∂y
 !
NULL
 &&

3607 
migøã_ª∂y
->
ty≥
 !
REDIS_REPLY_ERROR
);

3608 } 
suc˚ss
 = 0;

3609 i‡(!
suc˚ss
) {

3610 i‡(
migøã_ª∂y
 !
NULL
) {

3611 i‡(
îr
) {

3612 *
îr
 = 
	`zmÆloc
((
migøã_ª∂y
->
Àn
 + 1) * ());

3613 
	`°r˝y
(*
îr
, 
migøã_ª∂y
->
°r
);

3615 
	`¥ötf
("\n");

3616 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
sour˚
,

3617 
migøã_ª∂y
->
°r
);

3619 
√xt
;

3622 i‡(
vîbo£
) {

3623 
	`¥ötf
("%s", 
dŸs
);

3624 
	`fÊush
(
°dout
);

3626 
√xt
:

3627 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

3628 i‡(
migøã_ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(migrate_reply);

3629 i‡(
dŸs
Ë
	`z‰ì
(dots);

3630 i‡(!
suc˚ss
) ;

3632  
suc˚ss
;

3633 
	}
}

3644 
	$˛u°îM™agîMoveSlŸ
(
˛u°îM™agîNode
 *
sour˚
,

3645 
˛u°îM™agîNode
 *
èrgë
,

3646 
¶Ÿ
, 
›ts
, **
îr
)

3648 i‡(!(
›ts
 & 
CLUSTER_MANAGER_OPT_QUIET
)) {

3649 
	`¥ötf
("Movög slŸ %d from %s:%dÅÿ%s:%d: ", 
¶Ÿ
, 
sour˚
->
ù
,

3650 
sour˚
->
p‹t
, 
èrgë
->
ù
,Åarget->port);

3651 
	`fÊush
(
°dout
);

3653 i‡(
îr
 !
NULL
) *err = NULL;

3654 
pùñöe
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.pipeline,

3655 
timeout
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.timeout,

3656 
¥öt_dŸs
 = (
›ts
 & 
CLUSTER_MANAGER_OPT_VERBOSE
),

3657 
›ti⁄_cﬁd
 = (
›ts
 & 
CLUSTER_MANAGER_OPT_COLD
),

3658 
suc˚ss
 = 1;

3659 i‡(!
›ti⁄_cﬁd
) {

3660 
suc˚ss
 = 
	`˛u°îM™agîSëSlŸ
(
èrgë
, 
sour˚
, 
¶Ÿ
,

3661 "imp‹tög", 
îr
);

3662 i‡(!
suc˚ss
)  0;

3663 
suc˚ss
 = 
	`˛u°îM™agîSëSlŸ
(
sour˚
, 
èrgë
, 
¶Ÿ
,

3664 "migøtög", 
îr
);

3665 i‡(!
suc˚ss
)  0;

3667 
suc˚ss
 = 
	`˛u°îM™agîMigøãKeysInSlŸ
(
sour˚
, 
èrgë
, 
¶Ÿ
, 
timeout
,

3668 
pùñöe
, 
¥öt_dŸs
, 
îr
);

3669 i‡(!(
›ts
 & 
CLUSTER_MANAGER_OPT_QUIET
)Ë
	`¥ötf
("\n");

3670 i‡(!
suc˚ss
)  0;

3672 i‡(!
›ti⁄_cﬁd
) {

3673 
li°Iãr
 
li
;

3674 
li°Node
 *
 
;

3675 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

3676 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

3677 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

3678 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

3679 
ªdisRïly
 *
r
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
, "CLUSTER "

3681 
¶Ÿ
, "node",

3682 
èrgë
->
«me
);

3683 
suc˚ss
 = (
r
 !
NULL
);

3684 i‡(!
suc˚ss
)  0;

3685 i‡(
r
->
ty≥
 =
REDIS_REPLY_ERROR
) {

3686 
suc˚ss
 = 0;

3687 i‡(
îr
 !
NULL
) {

3688 *
îr
 = 
	`zmÆloc
((
r
->
Àn
 + 1) * ());

3689 
	`°r˝y
(*
îr
, 
r
->
°r
);

3690 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
n
, *
îr
);

3693 
	`‰ìRïlyObje˘
(
r
);

3694 i‡(!
suc˚ss
)  0;

3698 i‡(
›ts
 & 
CLUSTER_MANAGER_OPT_UPDATE
) {

3699 
sour˚
->
¶Ÿs
[
¶Ÿ
] = 0;

3700 
èrgë
->
¶Ÿs
[
¶Ÿ
] = 1;

3703 
	}
}

3707 
	$˛u°îM™agîFlushNodeC⁄fig
(
˛u°îM™agîNode
 *
node
, **
îr
) {

3708 i‡(!
node
->
dúty
)  0;

3709 
ªdisRïly
 *
ª∂y
 = 
NULL
;

3710 
is_îr
 = 0, 
suc˚ss
 = 1;

3711 i‡(
îr
 !
NULL
) *err = NULL;

3712 i‡(
node
->
ª∂iˇã
 !
NULL
) {

3713 
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "CLUSTER REPLICATE %s",

3714 
node
->
ª∂iˇã
);

3715 i‡(
ª∂y
 =
NULL
 || (
is_îr
 = (ª∂y->
ty≥
 =
REDIS_REPLY_ERROR
))) {

3716 i‡(
is_îr
 && 
îr
 !
NULL
) {

3717 *
îr
 = 
	`zmÆloc
((
ª∂y
->
Àn
 + 1) * ());

3718 
	`°r˝y
(*
îr
, 
ª∂y
->
°r
);

3720 
suc˚ss
 = 0;

3725 
˛ónup
;

3728 
added
 = 
	`˛u°îM™agîAddSlŸs
(
node
, 
îr
);

3729 i‡(!
added
 || *
îr
 !
NULL
Ë
suc˚ss
 = 0;

3731 
node
->
dúty
 = 0;

3732 
˛ónup
:

3733 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

3734  
suc˚ss
;

3735 
	}
}

3738 
	$˛u°îM™agîWaôF‹Clu°îJoö
() {

3739 
	`¥ötf
("Waiting forÅhe clusterÅo join\n");

3740 
cou¡î
 = 0,

3741 
check_a·î
 = 
CLUSTER_JOIN_CHECK_AFTER
 +

3742 ()(
	`li°Lígth
(
˛u°î_m™agî
.
nodes
) * 0.15f);

3743 !
	`˛u°îM™agîIsC⁄figC⁄si°ít
()) {

3744 
	`¥ötf
(".");

3745 
	`fÊush
(
°dout
);

3746 
	`¶ìp
(1);

3747 i‡(++
cou¡î
 > 
check_a·î
) {

3748 
di˘
 *
°©us
 = 
	`˛u°îM™agîGëLökSètus
();

3749 
di˘Iãøt‹
 *
ôî
 = 
NULL
;

3750 i‡(
°©us
 !
NULL
 && 
	`di˘Size
(status) > 0) {

3751 
	`¥ötf
("\n");

3752 
	`˛u°îM™agîLogEº
("Warning: %dÇode(s) may "

3753 "bêuƒóchabÀ\n", 
	`di˘Size
(
°©us
));

3754 
ôî
 = 
	`di˘GëIãøt‹
(
°©us
);

3755 
di˘E¡ry
 *
íåy
;

3756 (
íåy
 = 
	`di˘Next
(
ôî
)Ë!
NULL
) {

3757 
sds
 
nodóddr
 = (sdsË
	`di˘GëKey
(
íåy
);

3758 *
node_ù
 = 
NULL
;

3759 
node_p‹t
 = 0, 
node_bus_p‹t
 = 0;

3760 
li°
 *
‰om
 = (li° *Ë
	`di˘GëVÆ
(
íåy
);

3761 i‡(
	`∑r£Clu°îNodeAddªss
(
nodóddr
, &
node_ù
,

3762 &
node_p‹t
, &
node_bus_p‹t
) &&Çode_bus_port) {

3763 
	`˛u°îM™agîLogEº
(" - TheÖort %d ofÇode %s may "

3765 
node_bus_p‹t
, 
node_ù
);

3767 
	`˛u°îM™agîLogEº
(" - Node %s may be unreachable "

3768 "‰om:\n", 
nodóddr
);

3770 
li°Iãr
 
li
;

3771 
li°Node
 *
 
;

3772 
	`li°Rewöd
(
‰om
, &
li
);

3773 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

3774 
sds
 
‰om_addr
 = 
 
->
vÆue
;

3775 
	`˛u°îM™agîLogEº
(" %s\n", 
‰om_addr
);

3776 
	`sds‰ì
(
‰om_addr
);

3778 
	`˛u°îM™agîLogEº
("Cluster busÖorts must beÑeachable "

3782 
	`li°Em±y
(
‰om
);

3785 i‡(
ôî
 !
NULL
Ë
	`di˘Rñó£Iãøt‹
(iter);

3786 i‡(
°©us
 !
NULL
Ë
	`di˘Rñó£
(status);

3787 
cou¡î
 = 0;

3790 
	`¥ötf
("\n");

3791 
	}
}

3798 
	$˛u°îM™agîNodeLﬂdInfo
(
˛u°îM™agîNode
 *
node
, 
›ts
,

3799 **
îr
)

3801 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "CLUSTER NODES");

3802 
suc˚ss
 = 1;

3803 *
îr
 = 
NULL
;

3804 i‡(!
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
îr
)) {

3805 
suc˚ss
 = 0;

3806 
˛ónup
;

3808 
gë‰õnds
 = (
›ts
 & 
CLUSTER_MANAGER_OPT_GETFRIENDS
);

3809 *
löes
 = 
ª∂y
->
°r
, *
p
, *
löe
;

3810 (
p
 = 
	`°r°r
(
löes
, "\n")Ë!
NULL
) {

3811 *
p
 = '\0';

3812 
löe
 = 
löes
;

3813 
löes
 = 
p
 + 1;

3814 *
«me
 = 
NULL
, *
addr
 = NULL, *
Êags
 = NULL, *
ma°î_id
 = NULL,

3815 *
pög_£¡
 = 
NULL
, *
pög_ªcv
 = NULL, *
c⁄fig_ïoch
 = NULL,

3816 *
lök_°©us
 = 
NULL
;

3817 
	`UNUSED
(
lök_°©us
);

3818 
i
 = 0;

3819 (
p
 = 
	`°rchr
(
löe
, ' ')Ë!
NULL
) {

3820 *
p
 = '\0';

3821 *
tokí
 = 
löe
;

3822 
löe
 = 
p
 + 1;

3823 
i
++){

3824 0: 
«me
 = 
tokí
; ;

3825 1: 
addr
 = 
tokí
; ;

3826 2: 
Êags
 = 
tokí
; ;

3827 3: 
ma°î_id
 = 
tokí
; ;

3828 4: 
pög_£¡
 = 
tokí
; ;

3829 5: 
pög_ªcv
 = 
tokí
; ;

3830 6: 
c⁄fig_ïoch
 = 
tokí
; ;

3831 7: 
lök_°©us
 = 
tokí
; ;

3833 i‡(
i
 == 8) ;

3835 i‡(!
Êags
) {

3836 
suc˚ss
 = 0;

3837 
˛ónup
;

3839 
my£lf
 = (
	`°r°r
(
Êags
, "my£lf"Ë!
NULL
);

3840 
˛u°îM™agîNode
 *
cuºítNode
 = 
NULL
;

3841 i‡(
my£lf
) {

3842 
node
->
Êags
 |
CLUSTER_MANAGER_FLAG_MYSELF
;

3843 
cuºítNode
 = 
node
;

3844 
	`˛u°îM™agîNodeRe£tSlŸs
(
node
);

3845 i‡(
i
 == 8) {

3846 
ªmaöög
 = 
	`°æí
(
löe
);

3847 
ªmaöög
 > 0) {

3848 
p
 = 
	`°rchr
(
löe
, ' ');

3849 i‡(
p
 =
NULL
Ë∞
löe
 + 
ªmaöög
;

3850 
ªmaöög
 -(
p
 - 
löe
);

3852 *
¶Ÿsdef
 = 
löe
;

3853 *
p
 = '\0';

3854 i‡(
ªmaöög
) {

3855 
löe
 = 
p
 + 1;

3856 
ªmaöög
--;

3857 } 
löe
 = 
p
;

3858 *
dash
 = 
NULL
;

3859 i‡(
¶Ÿsdef
[0] == '[') {

3860 
¶Ÿsdef
++;

3861 i‡((
p
 = 
	`°r°r
(
¶Ÿsdef
, "->-"))) {

3862 *
p
 = '\0';

3863 
p
 += 3;

3864 *
˛osög_bøckë
 = 
	`°rchr
(
p
, ']');

3865 i‡(
˛osög_bøckë
) *closing_bracket = '\0';

3866 
sds
 
¶Ÿ
 = 
	`sd¢ew
(
¶Ÿsdef
);

3867 
sds
 
d°
 = 
	`sd¢ew
(
p
);

3868 
node
->
migøtög_cou¡
 += 2;

3869 
node
->
migøtög
 = 
	`zªÆloc
(node->migrating,

3870 (
node
->
migøtög_cou¡
 * (
sds
)));

3871 
node
->
migøtög
[node->
migøtög_cou¡
 - 2] =

3872 
¶Ÿ
;

3873 
node
->
migøtög
[node->
migøtög_cou¡
 - 1] =

3874 
d°
;

3875 } i‡((
p
 = 
	`°r°r
(
¶Ÿsdef
, "-<-"))) {

3876 *
p
 = '\0';

3877 
p
 += 3;

3878 *
˛osög_bøckë
 = 
	`°rchr
(
p
, ']');

3879 i‡(
˛osög_bøckë
) *closing_bracket = '\0';

3880 
sds
 
¶Ÿ
 = 
	`sd¢ew
(
¶Ÿsdef
);

3881 
sds
 
§c
 = 
	`sd¢ew
(
p
);

3882 
node
->
imp‹tög_cou¡
 += 2;

3883 
node
->
imp‹tög
 = 
	`zªÆloc
(node->importing,

3884 (
node
->
imp‹tög_cou¡
 * (
sds
)));

3885 
node
->
imp‹tög
[node->
imp‹tög_cou¡
 - 2] =

3886 
¶Ÿ
;

3887 
node
->
imp‹tög
[node->
imp‹tög_cou¡
 - 1] =

3888 
§c
;

3890 } i‡((
dash
 = 
	`°rchr
(
¶Ÿsdef
, '-')Ë!
NULL
) {

3891 
p
 = 
dash
;

3892 
°¨t
, 
°›
;

3893 *
p
 = '\0';

3894 
°¨t
 = 
	`©oi
(
¶Ÿsdef
);

3895 
°›
 = 
	`©oi
(
p
 + 1);

3896 
node
->
¶Ÿs_cou¡
 +(
°›
 - (
°¨t
 - 1));

3897 
°¨t
 <
°›
Ë
node
->
¶Ÿs
[start++] = 1;

3898 } i‡(
p
 > 
¶Ÿsdef
) {

3899 
node
->
¶Ÿs
[
	`©oi
(
¶Ÿsdef
)] = 1;

3900 
node
->
¶Ÿs_cou¡
++;

3904 
node
->
dúty
 = 0;

3905 } i‡(!
gë‰õnds
) {

3906 i‡(!(
node
->
Êags
 & 
CLUSTER_MANAGER_FLAG_MYSELF
)) ;

3909 i‡(
addr
 =
NULL
) {

3910 
	`Ârötf
(
°dîr
, "Error: invalid CLUSTER NODESÑeply\n");

3911 
suc˚ss
 = 0;

3912 
˛ónup
;

3914 *
c
 = 
	`°ºchr
(
addr
, '@');

3915 i‡(
c
 !
NULL
) *c = '\0';

3916 
c
 = 
	`°ºchr
(
addr
, ':');

3917 i‡(
c
 =
NULL
) {

3918 
	`Ârötf
(
°dîr
, "Error: invalid CLUSTER NODESÑeply\n");

3919 
suc˚ss
 = 0;

3920 
˛ónup
;

3922 *
c
 = '\0';

3923 
p‹t
 = 
	`©oi
(++
c
);

3924 
cuºítNode
 = 
	`˛u°îM™agîNewNode
(
	`sd¢ew
(
addr
), 
p‹t
);

3925 
cuºítNode
->
Êags
 |
CLUSTER_MANAGER_FLAG_FRIEND
;

3926 i‡(
node
->
‰õnds
 =
NULL
Ënode->‰õnd†
	`li°Cª©e
();

3927 
	`li°AddNodeTaû
(
node
->
‰õnds
, 
cuºítNode
);

3929 i‡(
«me
 !
NULL
) {

3930 i‡(
cuºítNode
->
«me
Ë
	`sds‰ì
(currentNode->name);

3931 
cuºítNode
->
«me
 = 
	`sd¢ew
(name);

3933 i‡(
cuºítNode
->
Êags_°r
 !
NULL
)

3934 
	`‰ìClu°îM™agîNodeFœgs
(
cuºítNode
->
Êags_°r
);

3935 
cuºítNode
->
Êags_°r
 = 
	`li°Cª©e
();

3936 
Êag_Àn
;

3937 (
Êag_Àn
 = 
	`°æí
(
Êags
)) > 0) {

3938 
sds
 
Êag
 = 
NULL
;

3939 *
Â
 = 
	`°rchr
(
Êags
, ',');

3940 i‡(
Â
) {

3941 *
Â
 = '\0';

3942 
Êag
 = 
	`sd¢ew
(
Êags
);

3943 
Êags
 = 
Â
 + 1;

3945 
Êag
 = 
	`sd¢ew
(
Êags
);

3946 
Êags
 +
Êag_Àn
;

3948 i‡(
	`°rcmp
(
Êag
, "noaddr") == 0)

3949 
cuºítNode
->
Êags
 |
CLUSTER_MANAGER_FLAG_NOADDR
;

3950 i‡(
	`°rcmp
(
Êag
, "disconnected") == 0)

3951 
cuºítNode
->
Êags
 |
CLUSTER_MANAGER_FLAG_DISCONNECT
;

3952 i‡(
	`°rcmp
(
Êag
, "fail") == 0)

3953 
cuºítNode
->
Êags
 |
CLUSTER_MANAGER_FLAG_FAIL
;

3954 i‡(
	`°rcmp
(
Êag
, "slave") == 0) {

3955 
cuºítNode
->
Êags
 |
CLUSTER_MANAGER_FLAG_SLAVE
;

3956 i‡(
ma°î_id
 !
NULL
) {

3957 i‡(
cuºítNode
->
ª∂iˇã
Ë
	`sds‰ì
(currentNode->replicate);

3958 
cuºítNode
->
ª∂iˇã
 = 
	`sd¢ew
(
ma°î_id
);

3961 
	`li°AddNodeTaû
(
cuºítNode
->
Êags_°r
, 
Êag
);

3963 i‡(
c⁄fig_ïoch
 !
NULL
)

3964 
cuºítNode
->
cuºít_ïoch
 = 
	`©ﬁl
(
c⁄fig_ïoch
);

3965 i‡(
pög_£¡
 !
NULL
Ë
cuºítNode
->pög_£¡ = 
	`©ﬁl
(ping_sent);

3966 i‡(
pög_ªcv
 !
NULL
Ë
cuºítNode
->pög_ªcv = 
	`©ﬁl
(ping_recv);

3967 i‡(!
gë‰õnds
 && 
my£lf
) ;

3969 
˛ónup
:

3970 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

3971  
suc˚ss
;

3972 
	}
}

3978 
	$˛u°îM™agîLﬂdInfoFromNode
(
˛u°îM™agîNode
 *
node
, 
›ts
) {

3979 i‡(
node
->
c⁄ãxt
 =
NULL
 && !
	`˛u°îM™agîNodeC⁄√˘
(node)) {

3980 
	`‰ìClu°îM™agîNode
(
node
);

3983 
›ts
 |
CLUSTER_MANAGER_OPT_GETFRIENDS
;

3984 *
e
 = 
NULL
;

3985 i‡(!
	`˛u°îM™agîNodeIsClu°î
(
node
, &
e
)) {

3986 
	`˛u°îM™agîPrötNŸClu°îNodeEº‹
(
node
, 
e
);

3987 i‡(
e
Ë
	`z‰ì
(e);

3988 
	`‰ìClu°îM™agîNode
(
node
);

3991 
e
 = 
NULL
;

3992 i‡(!
	`˛u°îM™agîNodeLﬂdInfo
(
node
, 
›ts
, &
e
)) {

3993 i‡(
e
) {

3994 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node
, 
e
);

3995 
	`z‰ì
(
e
);

3997 
	`‰ìClu°îM™agîNode
(
node
);

4000 
li°Iãr
 
li
;

4001 
li°Node
 *
 
;

4002 i‡(
˛u°î_m™agî
.
nodes
 !
NULL
) {

4003 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4004 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
)

4005 
	`‰ìClu°îM™agîNode
((
˛u°îM™agîNode
 *Ë
 
->
vÆue
);

4006 
	`li°Rñó£
(
˛u°î_m™agî
.
nodes
);

4008 
˛u°î_m™agî
.
nodes
 = 
	`li°Cª©e
();

4009 
	`li°AddNodeTaû
(
˛u°î_m™agî
.
nodes
, 
node
);

4010 i‡(
node
->
‰õnds
 !
NULL
) {

4011 
	`li°Rewöd
(
node
->
‰õnds
, &
li
);

4012 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4013 
˛u°îM™agîNode
 *
‰õnd
 = 
 
->
vÆue
;

4014 i‡(!
‰õnd
->
ù
 || !‰õnd->
p‹t
Ë
övÆid_‰õnd
;

4015 i‡(!
‰õnd
->
c⁄ãxt
 && !
	`˛u°îM™agîNodeC⁄√˘
(friend))

4016 
övÆid_‰õnd
;

4017 
e
 = 
NULL
;

4018 i‡(
	`˛u°îM™agîNodeLﬂdInfo
(
‰õnd
, 0, &
e
)) {

4019 i‡(
‰õnd
->
Êags
 & (
CLUSTER_MANAGER_FLAG_NOADDR
 |

4020 
CLUSTER_MANAGER_FLAG_DISCONNECT
 |

4021 
CLUSTER_MANAGER_FLAG_FAIL
))

4023 
övÆid_‰õnd
;

4025 
	`li°AddNodeTaû
(
˛u°î_m™agî
.
nodes
, 
‰õnd
);

4027 
	`˛u°îM™agîLogEº
("[ERR] UnableÅoÜoad info for "

4029 
‰õnd
->
ù
, frõnd->
p‹t
);

4030 
övÆid_‰õnd
;

4033 
övÆid_‰õnd
:

4034 i‡(!(
‰õnd
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
))

4035 
˛u°î_m™agî
.
uƒóchabÀ_ma°îs
++;

4036 
	`‰ìClu°îM™agîNode
(
‰õnd
);

4038 
	`li°Rñó£
(
node
->
‰õnds
);

4039 
node
->
‰õnds
 = 
NULL
;

4042 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4043 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4044 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4045 i‡(
n
->
ª∂iˇã
 !
NULL
) {

4046 
˛u°îM™agîNode
 *
ma°î
 = 
	`˛u°îM™agîNodeByName
(
n
->
ª∂iˇã
);

4047 i‡(
ma°î
 =
NULL
) {

4048 
	`˛u°îM™agîLogW¨n
("*** WARNING: %s:%d claimsÅo be "

4050 
n
->
ù
,Ç->
p‹t
,Ç->
ª∂iˇã
);

4051 } 
ma°î
->
ª∂iˇs_cou¡
++;

4055 
	}
}

4058 
	$˛u°îM™agîSlŸCom∑ª
(c⁄° *
¶Ÿ1
, c⁄° *
¶Ÿ2
) {

4059 c⁄° **
i1
 = (c⁄° **)
¶Ÿ1
;

4060 c⁄° **
i2
 = (c⁄° **)
¶Ÿ2
;

4061  
	`°rcmp
(*
i1
, *
i2
);

4062 
	}
}

4064 
	$˛u°îM™agîSlŸCou¡Com∑ªDesc
(c⁄° *
n1
, c⁄° *
n2
) {

4065 
˛u°îM™agîNode
 *
node1
 = *((˛u°îM™agîNodê**Ë
n1
);

4066 
˛u°îM™agîNode
 *
node2
 = *((˛u°îM™agîNodê**Ë
n2
);

4067  
node2
->
¶Ÿs_cou¡
 - 
node1
->slots_count;

4068 
	}
}

4070 
	$˛u°îM™agîCom∑ªNodeBÆ™˚
(c⁄° *
n1
, c⁄° *
n2
) {

4071 
˛u°îM™agîNode
 *
node1
 = *((˛u°îM™agîNodê**Ë
n1
);

4072 
˛u°îM™agîNode
 *
node2
 = *((˛u°îM™agîNodê**Ë
n2
);

4073  
node1
->
bÆ™˚
 - 
node2
->balance;

4074 
	}
}

4076 
sds
 
	$˛u°îM™agîGëC⁄figSig«tuª
(
˛u°îM™agîNode
 *
node
) {

4077 
sds
 
sig«tuª
 = 
NULL
;

4078 
node_cou¡
 = 0, 
i
 = 0, 
«me_Àn
 = 0;

4079 **
node_c⁄figs
 = 
NULL
;

4080 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "CLUSTER NODES");

4081 i‡(
ª∂y
 =
NULL
 ||Ñïly->
ty≥
 =
REDIS_REPLY_ERROR
)

4082 
˛ónup
;

4083 *
löes
 = 
ª∂y
->
°r
, *
p
, *
löe
;

4084 (
p
 = 
	`°r°r
(
löes
, "\n")Ë!
NULL
) {

4085 
i
 = 0;

4086 *
p
 = '\0';

4087 
löe
 = 
löes
;

4088 
löes
 = 
p
 + 1;

4089 *
nodíame
 = 
NULL
;

4090 
tŸ_size
 = 0;

4091 (
p
 = 
	`°rchr
(
löe
, ' ')Ë!
NULL
) {

4092 *
p
 = '\0';

4093 *
tokí
 = 
löe
;

4094 
löe
 = 
p
 + 1;

4095 i‡(
i
 == 0) {

4096 
nodíame
 = 
tokí
;

4097 
tŸ_size
 = (
p
 - 
tokí
);

4098 
«me_Àn
 = 
tŸ_size
++;

4100 i‡(++
i
 == 8) ;

4102 i‡(
i
 != 8) ;

4103 i‡(
nodíame
 =
NULL
) ;

4104 
ªmaöög
 = 
	`°æí
(
löe
);

4105 i‡(
ªmaöög
 == 0) ;

4106 **
¶Ÿs
 = 
NULL
;

4107 
c
 = 0;

4108 
ªmaöög
 > 0) {

4109 
p
 = 
	`°rchr
(
löe
, ' ');

4110 i‡(
p
 =
NULL
Ë∞
löe
 + 
ªmaöög
;

4111 
size
 = (
p
 - 
löe
);

4112 
ªmaöög
 -
size
;

4113 
tŸ_size
 +
size
;

4114 *
¶Ÿsdef
 = 
löe
;

4115 *
p
 = '\0';

4116 i‡(
ªmaöög
) {

4117 
löe
 = 
p
 + 1;

4118 
ªmaöög
--;

4119 } 
löe
 = 
p
;

4120 i‡(
¶Ÿsdef
[0] != '[') {

4121 
c
++;

4122 
¶Ÿs
 = 
	`zªÆloc
(¶Ÿs, (
c
 * (*)));

4123 
¶Ÿs
[
c
 - 1] = 
¶Ÿsdef
;

4126 i‡(
c
 > 0) {

4127 i‡(
c
 > 1)

4128 
	`qs‹t
(
¶Ÿs
, 
c
, (*), 
˛u°îM™agîSlŸCom∑ª
);

4129 
node_cou¡
++;

4130 
node_c⁄figs
 =

4131 
	`zªÆloc
(
node_c⁄figs
, (
node_cou¡
 * (*)));

4133 
tŸ_size
 +((Ë* (
c
 - 1));

4134 *
cfg
 = 
	`zmÆloc
(((Ë* 
tŸ_size
) + 1);

4135 
	`mem˝y
(
cfg
, 
nodíame
, 
«me_Àn
);

4136 *
•
 = 
cfg
 + 
«me_Àn
;

4137 *(
•
++) = ':';

4138 
i
 = 0; i < 
c
; i++) {

4139 i‡(
i
 > 0Ë*(
•
++) = ',';

4140 
¶í
 = 
	`°æí
(
¶Ÿs
[
i
]);

4141 
	`mem˝y
(
•
, 
¶Ÿs
[
i
], 
¶í
);

4142 
•
 +
¶í
;

4144 *(
•
++) = '\0';

4145 
node_c⁄figs
[
node_cou¡
 - 1] = 
cfg
;

4147 
	`z‰ì
(
¶Ÿs
);

4149 i‡(
node_cou¡
 > 0) {

4150 i‡(
node_cou¡
 > 1) {

4151 
	`qs‹t
(
node_c⁄figs
, 
node_cou¡
, (*),

4152 
˛u°îM™agîSlŸCom∑ª
);

4154 
sig«tuª
 = 
	`sd£m±y
();

4155 
i
 = 0; i < 
node_cou¡
; i++) {

4156 i‡(
i
 > 0Ë
sig«tuª
 = 
	`sdsˇçrötf
(signature, "%c", '|');

4157 
sig«tuª
 = 
	`sdsˇtfmt
(sig«tuª, "%s", 
node_c⁄figs
[
i
]);

4160 
˛ónup
:

4161 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

4162 i‡(
node_c⁄figs
 !
NULL
) {

4163 
i
 = 0; i < 
node_cou¡
; i++Ë
	`z‰ì
(
node_c⁄figs
[i]);

4164 
	`z‰ì
(
node_c⁄figs
);

4166  
sig«tuª
;

4167 
	}
}

4169 
	$˛u°îM™agîIsC⁄figC⁄si°ít
() {

4170 i‡(
˛u°î_m™agî
.
nodes
 =
NULL
)  0;

4171 
c⁄si°ít
 = (
	`li°Lígth
(
˛u°î_m™agî
.
nodes
) <= 1);

4173 i‡(
c⁄si°ít
)  1;

4174 
sds
 
fú°_cfg
 = 
NULL
;

4175 
li°Iãr
 
li
;

4176 
li°Node
 *
 
;

4177 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4178 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4179 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

4180 
sds
 
cfg
 = 
	`˛u°îM™agîGëC⁄figSig«tuª
(
node
);

4181 i‡(
cfg
 =
NULL
) {

4182 
c⁄si°ít
 = 0;

4185 i‡(
fú°_cfg
 =
NULL
Ëfú°_cfg = 
cfg
;

4187 
c⁄si°ít
 = !
	`sdscmp
(
fú°_cfg
, 
cfg
);

4188 
	`sds‰ì
(
cfg
);

4189 i‡(!
c⁄si°ít
) ;

4192 i‡(
fú°_cfg
 !
NULL
Ë
	`sds‰ì
(first_cfg);

4193  
c⁄si°ít
;

4194 
	}
}

4196 
li°
 *
	$˛u°îM™agîGëDisc⁄√˘edLöks
(
˛u°îM™agîNode
 *
node
) {

4197 
li°
 *
löks
 = 
NULL
;

4198 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "CLUSTER NODES");

4199 i‡(!
	`˛u°îM™agîCheckRedisRïly
(
node
, 
ª∂y
, 
NULL
)Ë
˛ónup
;

4200 
löks
 = 
	`li°Cª©e
();

4201 *
löes
 = 
ª∂y
->
°r
, *
p
, *
löe
;

4202 (
p
 = 
	`°r°r
(
löes
, "\n")Ë!
NULL
) {

4203 
i
 = 0;

4204 *
p
 = '\0';

4205 
löe
 = 
löes
;

4206 
löes
 = 
p
 + 1;

4207 *
nodíame
 = 
NULL
, *
addr
 = NULL, *
Êags
 = NULL, *
lök_°©us
 = NULL;

4208 (
p
 = 
	`°rchr
(
löe
, ' ')Ë!
NULL
) {

4209 *
p
 = '\0';

4210 *
tokí
 = 
löe
;

4211 
löe
 = 
p
 + 1;

4212 i‡(
i
 =0Ë
nodíame
 = 
tokí
;

4213 i‡(
i
 =1Ë
addr
 = 
tokí
;

4214 i‡(
i
 =2Ë
Êags
 = 
tokí
;

4215 i‡(
i
 =7Ë
lök_°©us
 = 
tokí
;

4216 i‡(
i
 == 8) ;

4217 
i
++;

4219 i‡(
i
 =7Ë
lök_°©us
 = 
löe
;

4220 i‡(
nodíame
 =
NULL
 || 
addr
 =NULL || 
Êags
 == NULL ||

4221 
lök_°©us
 =
NULL
) ;

4222 i‡(
	`°r°r
(
Êags
, "my£lf"Ë!
NULL
) ;

4223 
disc⁄√˘ed
 = ((
	`°r°r
(
Êags
, "disc⁄√˘ed"Ë!
NULL
) ||

4224 (
	`°r°r
(
lök_°©us
, "disconnected")));

4225 
h™dshakög
 = (
	`°r°r
(
Êags
, "h™dshake"Ë!
NULL
);

4226 i‡(
disc⁄√˘ed
 || 
h™dshakög
) {

4227 
˛u°îM™agîLök
 *
lök
 = 
	`zmÆloc
((*link));

4228 
lök
->
node_«me
 = 
	`sd¢ew
(
nodíame
);

4229 
lök
->
node_addr
 = 
	`sd¢ew
(
addr
);

4230 
lök
->
c⁄√˘ed
 = 0;

4231 
lök
->
h™dshakög
 = handshaking;

4232 
	`li°AddNodeTaû
(
löks
, 
lök
);

4235 
˛ónup
:

4236 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

4237  
löks
;

4238 
	}
}

4243 
di˘
 *
	$˛u°îM™agîGëLökSètus
() {

4244 i‡(
˛u°î_m™agî
.
nodes
 =
NULL
)  NULL;

4245 
di˘
 *
°©us
 = 
	`di˘Cª©e
(&
˛u°îM™agîLökDi˘Ty≥
, 
NULL
);

4246 
li°Iãr
 
li
;

4247 
li°Node
 *
 
;

4248 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4249 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4250 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

4251 
li°
 *
löks
 = 
	`˛u°îM™agîGëDisc⁄√˘edLöks
(
node
);

4252 i‡(
löks
) {

4253 
li°Iãr
 
Œi
;

4254 
li°Node
 *
Œn
;

4255 
	`li°Rewöd
(
löks
, &
Œi
);

4256 (
Œn
 = 
	`li°Next
(&
Œi
)Ë!
NULL
) {

4257 
˛u°îM™agîLök
 *
lök
 = 
Œn
->
vÆue
;

4258 
li°
 *
‰om
 = 
NULL
;

4259 
di˘E¡ry
 *
íåy
 = 
	`di˘Föd
(
°©us
, 
lök
->
node_addr
);

4260 i‡(
íåy
Ë
‰om
 = 
	`di˘GëVÆ
(entry);

4262 
‰om
 = 
	`li°Cª©e
();

4263 
	`di˘Add
(
°©us
, 
	`sdsdup
(
lök
->
node_addr
), 
‰om
);

4265 
sds
 
myaddr
 = 
	`sd£m±y
();

4266 
myaddr
 = 
	`sdsˇtfmt
(myaddr, "%s:%u", 
node
->
ù
,Çode->
p‹t
);

4267 
	`li°AddNodeTaû
(
‰om
, 
myaddr
);

4268 
	`sds‰ì
(
lök
->
node_«me
);

4269 
	`sds‰ì
(
lök
->
node_addr
);

4270 
	`z‰ì
(
lök
);

4272 
	`li°Rñó£
(
löks
);

4275  
°©us
;

4276 
	}
}

4279 
	$˛u°îM™agîOnEº‹
(
sds
 
îr
) {

4280 i‡(
˛u°î_m™agî
.
îr‹s
 =
NULL
)

4281 
˛u°î_m™agî
.
îr‹s
 = 
	`li°Cª©e
();

4282 
	`li°AddNodeTaû
(
˛u°î_m™agî
.
îr‹s
, 
îr
);

4283 
	`˛u°îM™agîLogEº
("%s\n", (*Ë
îr
);

4284 
	}
}

4289 
	$˛u°îM™agîGëCovîedSlŸs
(*
Æl_¶Ÿs
) {

4290 i‡(
˛u°î_m™agî
.
nodes
 =
NULL
)  0;

4291 
li°Iãr
 
li
;

4292 
li°Node
 *
 
;

4293 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4294 
tŸ¶Ÿs
 = 0, 
i
;

4295 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4296 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

4297 
i
 = 0; i < 
CLUSTER_MANAGER_SLOTS
; i++) {

4298 i‡(
node
->
¶Ÿs
[
i
] && !
Æl_¶Ÿs
[i]) {

4299 
Æl_¶Ÿs
[
i
] = 1;

4300 
tŸ¶Ÿs
++;

4304  
tŸ¶Ÿs
;

4305 
	}
}

4307 
	$˛u°îM™agîPrötSlŸsLi°
(
li°
 *
¶Ÿs
) {

4308 
˛u°îM™agîNode
 
n
 = {0};

4309 
li°Iãr
 
li
;

4310 
li°Node
 *
 
;

4311 
	`li°Rewöd
(
¶Ÿs
, &
li
);

4312 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4313 
¶Ÿ
 = 
	`©oi
(
 
->
vÆue
);

4314 i‡(
¶Ÿ
 >0 && slŸ < 
CLUSTER_MANAGER_SLOTS
)

4315 
n
.
¶Ÿs
[
¶Ÿ
] = 1;

4317 
sds
 
node¶i°
 = 
	`˛u°îM™agîNodeSlŸsSåög
(&
n
);

4318 
	`¥ötf
("%s\n", 
node¶i°
);

4319 
	`sds‰ì
(
node¶i°
);

4320 
	}
}

4324 
˛u°îM™agîNode
 * 
	$˛u°îM™agîGëNodeWôhMo°KeysInSlŸ
(
li°
 *
nodes
,

4325 
¶Ÿ
,

4326 **
îr
)

4328 
˛u°îM™agîNode
 *
node
 = 
NULL
;

4329 
numkeys
 = 0;

4330 
li°Iãr
 
li
;

4331 
li°Node
 *
 
;

4332 
	`li°Rewöd
(
nodes
, &
li
);

4333 i‡(
îr
Ë*î∏
NULL
;

4334 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4335 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4336 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
 ||Ç->
ª∂iˇã
)

4338 
ªdisRïly
 *
r
 =

4339 
	`CLUSTER_MANAGER_COMMAND
(
n
, "CLUSTER COUNTKEYSINSLOT %d", 
¶Ÿ
);

4340 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
n
, 
r
, 
îr
);

4341 i‡(
suc˚ss
) {

4342 i‡(
r
->
öãgî
 > 
numkeys
 || 
node
 =
NULL
) {

4343 
numkeys
 = 
r
->
öãgî
;

4344 
node
 = 
n
;

4347 i‡(
r
 !
NULL
Ë
	`‰ìRïlyObje˘
(r);

4349 i‡(!
suc˚ss
) {

4350 i‡(
îr
 !
NULL
 && *err != NULL)

4351 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
n
, 
îr
);

4352 
node
 = 
NULL
;

4356  
node
;

4357 
	}
}

4363 
˛u°îM™agîNode
 *
	$˛u°îM™agîNodeWôhLó°Rïliˇs
() {

4364 
˛u°îM™agîNode
 *
node
 = 
NULL
;

4365 
lowe°_cou¡
 = 0;

4366 
li°Iãr
 
li
;

4367 
li°Node
 *
 
;

4368 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4369 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4370 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4371 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

4372 i‡(
node
 =
NULL
 || 
n
->
ª∂iˇs_cou¡
 < 
lowe°_cou¡
) {

4373 
node
 = 
n
;

4374 
lowe°_cou¡
 = 
n
->
ª∂iˇs_cou¡
;

4377  
node
;

4378 
	}
}

4382 
˛u°îM™agîNode
 *
	$˛u°îM™agîNodeMa°îR™dom
() {

4383 
ma°î_cou¡
 = 0;

4384 
idx
;

4385 
li°Iãr
 
li
;

4386 
li°Node
 *
 
;

4387 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4388 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4389 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4390 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

4391 
ma°î_cou¡
++;

4394 
	`§™d
(
	`time
(
NULL
));

4395 
idx
 = 
	`ønd
(Ë% 
ma°î_cou¡
;

4396 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4397 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4398 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4399 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

4400 i‡(!
idx
--) {

4401  
n
;

4405  
NULL
;

4406 
	}
}

4408 
	$˛u°îM™agîFixSlŸsCovîage
(*
Æl_¶Ÿs
) {

4409 
f‹˚_fix
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 &

4410 
CLUSTER_MANAGER_CMD_FLAG_FIX_WITH_UNREACHABLE_MASTERS
;

4412 i‡(
˛u°î_m™agî
.
uƒóchabÀ_ma°îs
 > 0 && !
f‹˚_fix
) {

4413 
	`˛u°îM™agîLogW¨n
("*** Fixög slŸ†covîagêwôh %d uƒóchabÀ ma°î†i†d™gîous:Ñedis-˛òwû»assumêth© slŸ†abouàma°î†th©áªÇŸÑóchabÀáªÇŸ covîed,ánd wû»åyÅÿªassig¿themÅÿthêªachabÀÇodes. Thi†ˇ¿ˇu£ d©®los†™d i†øªly wh© you w™àtÿdo. I‡youÑóŒy w™àtÿ¥o˚ed u£Åhê--˛u°î-fix-wôh-uƒóchabÀ-ma°î†›ti⁄.\n", 
˛u°î_m™agî
.
uƒóchabÀ_ma°îs
);

4414 
	`exô
(1);

4417 
i
, 
fixed
 = 0;

4418 
li°
 *
n⁄e
 = 
NULL
, *
sögÀ
 = NULL, *
mu…i
 = NULL;

4419 
	`˛u°îM™agîLogInfo
(">>> Fixing slots coverage...\n");

4420 
i
 = 0; i < 
CLUSTER_MANAGER_SLOTS
; i++) {

4421 
covîed
 = 
Æl_¶Ÿs
[
i
];

4422 i‡(!
covîed
) {

4423 
sds
 
¶Ÿ
 = 
	`sds‰oml⁄gl⁄g
((Ë
i
);

4424 
li°
 *
¶Ÿ_nodes
 = 
	`li°Cª©e
();

4425 
sds
 
¶Ÿ_nodes_°r
 = 
	`sd£m±y
();

4426 
li°Iãr
 
li
;

4427 
li°Node
 *
 
;

4428 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4429 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4430 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4431 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
 ||Ç->
ª∂iˇã
)

4433 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
,

4434 "CLUSTER GETKEYSINSLOT %d %d", 
i
, 1);

4435 i‡(!
	`˛u°îM™agîCheckRedisRïly
(
n
, 
ª∂y
, 
NULL
)) {

4436 
fixed
 = -1;

4437 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

4438 
˛ónup
;

4440 
	`as£π
(
ª∂y
->
ty≥
 =
REDIS_REPLY_ARRAY
);

4441 i‡(
ª∂y
->
ñemíts
 > 0) {

4442 
	`li°AddNodeTaû
(
¶Ÿ_nodes
, 
n
);

4443 i‡(
	`li°Lígth
(
¶Ÿ_nodes
) > 1)

4444 
¶Ÿ_nodes_°r
 = 
	`sdsˇt
(slot_nodes_str, ", ");

4445 
¶Ÿ_nodes_°r
 = 
	`sdsˇtfmt
(slot_nodes_str,

4446 "%s:%u", 
n
->
ù
,Ç->
p‹t
);

4448 
	`‰ìRïlyObje˘
(
ª∂y
);

4450 
	`sds‰ì
(
¶Ÿ_nodes_°r
);

4451 
	`di˘Add
(
˛u°îM™agîUncovîedSlŸs
, 
¶Ÿ
, 
¶Ÿ_nodes
);

4459 
n⁄e
 = 
	`li°Cª©e
();

4460 
sögÀ
 = 
	`li°Cª©e
();

4461 
mu…i
 = 
	`li°Cª©e
();

4462 
di˘Iãøt‹
 *
ôî
 = 
	`di˘GëIãøt‹
(
˛u°îM™agîUncovîedSlŸs
);

4463 
di˘E¡ry
 *
íåy
;

4464 (
íåy
 = 
	`di˘Next
(
ôî
)Ë!
NULL
) {

4465 
sds
 
¶Ÿ
 = (sdsË
	`di˘GëKey
(
íåy
);

4466 
li°
 *
nodes
 = (li° *Ë
	`di˘GëVÆ
(
íåy
);

4467 
	`li°Lígth
(
nodes
)){

4468 0: 
	`li°AddNodeTaû
(
n⁄e
, 
¶Ÿ
); ;

4469 1: 
	`li°AddNodeTaû
(
sögÀ
, 
¶Ÿ
); ;

4470 : 
	`li°AddNodeTaû
(
mu…i
, 
¶Ÿ
); ;

4473 
	`di˘Rñó£Iãøt‹
(
ôî
);

4476 i‡(
	`li°Lígth
(
n⁄e
) > 0) {

4477 
	`¥ötf
("The following uncovered slots haveÇo keys "

4479 
	`˛u°îM™agîPrötSlŸsLi°
(
n⁄e
);

4480 i‡(
	`c⁄fúmWôhYes
("FixÅhese slots by covering witháÑandomÇode?")){

4481 
li°Iãr
 
li
;

4482 
li°Node
 *
 
;

4483 
	`li°Rewöd
(
n⁄e
, &
li
);

4484 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4485 
sds
 
¶Ÿ
 = 
 
->
vÆue
;

4486 
s
 = 
	`©oi
(
¶Ÿ
);

4487 
˛u°îM™agîNode
 *
n
 = 
	`˛u°îM™agîNodeMa°îR™dom
();

4488 
	`˛u°îM™agîLogInfo
(">>> Covering slot %s with %s:%d\n",

4489 
¶Ÿ
, 
n
->
ù
,Ç->
p‹t
);

4490 i‡(!
	`˛u°îM™agîSëSlŸOw√r
(
n
, 
s
, 0)) {

4491 
fixed
 = -1;

4492 
˛ónup
;

4496 
n
->
¶Ÿs
[
s
] = 1;

4497 
fixed
++;

4503 i‡(
	`li°Lígth
(
sögÀ
) > 0) {

4504 
	`¥ötf
("The following uncovered slots have keys in just oneÇode:\n");

4505 
	`˛u°îM™agîPrötSlŸsLi°
(
sögÀ
);

4506 i‡(
	`c⁄fúmWôhYes
("FixÅhese slots by covering withÅhoseÇodes?")){

4507 
li°Iãr
 
li
;

4508 
li°Node
 *
 
;

4509 
	`li°Rewöd
(
sögÀ
, &
li
);

4510 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4511 
sds
 
¶Ÿ
 = 
 
->
vÆue
;

4512 
s
 = 
	`©oi
(
¶Ÿ
);

4513 
di˘E¡ry
 *
íåy
 = 
	`di˘Föd
(
˛u°îM™agîUncovîedSlŸs
, 
¶Ÿ
);

4514 
	`as£π
(
íåy
 !
NULL
);

4515 
li°
 *
nodes
 = (li° *Ë
	`di˘GëVÆ
(
íåy
);

4516 
li°Node
 *
‚
 = 
	`li°Fú°
(
nodes
);

4517 
	`as£π
(
‚
 !
NULL
);

4518 
˛u°îM™agîNode
 *
n
 = 
‚
->
vÆue
;

4519 
	`˛u°îM™agîLogInfo
(">>> Covering slot %s with %s:%d\n",

4520 
¶Ÿ
, 
n
->
ù
,Ç->
p‹t
);

4521 i‡(!
	`˛u°îM™agîSëSlŸOw√r
(
n
, 
s
, 0)) {

4522 
fixed
 = -1;

4523 
˛ónup
;

4527 
n
->
¶Ÿs
[
	`©oi
(
¶Ÿ
)] = 1;

4528 
fixed
++;

4534 i‡(
	`li°Lígth
(
mu…i
) > 0) {

4535 
	`¥ötf
("The following uncovered slots have keys in multipleÇodes:\n");

4536 
	`˛u°îM™agîPrötSlŸsLi°
(
mu…i
);

4537 i‡(
	`c⁄fúmWôhYes
("FixÅhese slots by moving keys "

4539 
li°Iãr
 
li
;

4540 
li°Node
 *
 
;

4541 
	`li°Rewöd
(
mu…i
, &
li
);

4542 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4543 
sds
 
¶Ÿ
 = 
 
->
vÆue
;

4544 
di˘E¡ry
 *
íåy
 = 
	`di˘Föd
(
˛u°îM™agîUncovîedSlŸs
, 
¶Ÿ
);

4545 
	`as£π
(
íåy
 !
NULL
);

4546 
li°
 *
nodes
 = (li° *Ë
	`di˘GëVÆ
(
íåy
);

4547 
s
 = 
	`©oi
(
¶Ÿ
);

4548 
˛u°îM™agîNode
 *
èrgë
 =

4549 
	`˛u°îM™agîGëNodeWôhMo°KeysInSlŸ
(
nodes
, 
s
, 
NULL
);

4550 i‡(
èrgë
 =
NULL
) {

4551 
fixed
 = -1;

4552 
˛ónup
;

4554 
	`˛u°îM™agîLogInfo
(">>> Covering slot %s moving keys "

4555 "tÿ%s:%d\n", 
¶Ÿ
,

4556 
èrgë
->
ù
,Å¨gë->
p‹t
);

4557 i‡(!
	`˛u°îM™agîSëSlŸOw√r
(
èrgë
, 
s
, 1)) {

4558 
fixed
 = -1;

4559 
˛ónup
;

4563 
èrgë
->
¶Ÿs
[
	`©oi
(
¶Ÿ
)] = 1;

4564 
li°Iãr
 
∆i
;

4565 
li°Node
 *
∆n
;

4566 
	`li°Rewöd
(
nodes
, &
∆i
);

4567 (
∆n
 = 
	`li°Next
(&
∆i
)Ë!
NULL
) {

4568 
˛u°îM™agîNode
 *
§c
 = 
∆n
->
vÆue
;

4569 i‡(
§c
 =
èrgë
) ;

4571 i‡(!
	`˛u°îM™agîSëSlŸ
(
§c
, 
èrgë
, 
s
, "NODE", 
NULL
))

4572 
fixed
 = -1;

4573 i‡(
fixed
 < 0Ë
˛ónup
;

4578 i‡(!
	`˛u°îM™agîSëSlŸ
(
§c
, 
èrgë
, 
s
,

4579 "IMPORTING", 
NULL
)Ë
fixed
 = -1;

4580 i‡(
fixed
 < 0Ë
˛ónup
;

4581 
›ts
 = 
CLUSTER_MANAGER_OPT_VERBOSE
 |

4582 
CLUSTER_MANAGER_OPT_COLD
;

4583 i‡(!
	`˛u°îM™agîMoveSlŸ
(
§c
, 
èrgë
, 
s
, 
›ts
, 
NULL
)) {

4584 
fixed
 = -1;

4585 
˛ónup
;

4587 i‡(!
	`˛u°îM™agîCÀ¨SlŸSètus
(
§c
, 
s
))

4588 
fixed
 = -1;

4589 i‡(
fixed
 < 0Ë
˛ónup
;

4591 
fixed
++;

4595 
˛ónup
:

4596 i‡(
n⁄e
Ë
	`li°Rñó£
(none);

4597 i‡(
sögÀ
Ë
	`li°Rñó£
(single);

4598 i‡(
mu…i
Ë
	`li°Rñó£
(multi);

4599  
fixed
;

4600 
	}
}

4605 
	$˛u°îM™agîFixO≥nSlŸ
(
¶Ÿ
) {

4606 
f‹˚_fix
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 &

4607 
CLUSTER_MANAGER_CMD_FLAG_FIX_WITH_UNREACHABLE_MASTERS
;

4609 i‡(
˛u°î_m™agî
.
uƒóchabÀ_ma°îs
 > 0 && !
f‹˚_fix
) {

4610 
	`˛u°îM™agîLogW¨n
("*** Fixög o≥¿¶Ÿ†wôh %d uƒóchabÀ ma°î†i†d™gîous:Ñedis-˛òwû»assumêth© slŸ†abouàma°î†th©áªÇŸÑóchabÀáªÇŸ covîed,ánd wû»åyÅÿªassig¿themÅÿthêªachabÀÇodes. Thi†ˇ¿ˇu£ d©®los†™d i†øªly wh© you w™àtÿdo. I‡youÑóŒy w™àtÿ¥o˚ed u£Åhê--˛u°î-fix-wôh-uƒóchabÀ-ma°î†›ti⁄.\n", 
˛u°î_m™agî
.
uƒóchabÀ_ma°îs
);

4611 
	`exô
(1);

4614 
	`˛u°îM™agîLogInfo
(">>> Fixög o≥¿¶Ÿ %d\n", 
¶Ÿ
);

4617 
suc˚ss
 = 1;

4618 
li°
 *
ow√rs
 = 
	`li°Cª©e
();

4622 
li°
 *
migøtög
 = 
	`li°Cª©e
();

4623 
li°
 *
imp‹tög
 = 
	`li°Cª©e
();

4624 
sds
 
migøtög_°r
 = 
	`sd£m±y
();

4625 
sds
 
imp‹tög_°r
 = 
	`sd£m±y
();

4626 
˛u°îM™agîNode
 *
ow√r
 = 
NULL
;

4629 
li°Iãr
 
li
;

4630 
li°Node
 *
 
;

4631 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4632 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4633 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4634 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

4635 i‡(
n
->
¶Ÿs
[
¶Ÿ
]) {

4636 
	`li°AddNodeTaû
(
ow√rs
, 
n
);

4638 
ªdisRïly
 *
r
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
,

4639 "CLUSTER COUNTKEYSINSLOT %d", 
¶Ÿ
);

4640 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
n
, 
r
, 
NULL
);

4641 i‡(
suc˚ss
 && 
r
->
öãgî
 > 0) {

4642 
	`˛u°îM™agîLogW¨n
("*** Found keysábout slot %d "

4643 "öÇ⁄-ow√∏nodê%s:%d!\n", 
¶Ÿ
,

4644 
n
->
ù
,Ç->
p‹t
);

4645 
	`li°AddNodeTaû
(
ow√rs
, 
n
);

4647 i‡(
r
Ë
	`‰ìRïlyObje˘
(r);

4648 i‡(!
suc˚ss
Ë
˛ónup
;

4654 i‡(
	`li°Lígth
(
ow√rs
Ë=1Ë
ow√r
 = 
	`li°Fú°
(ow√rs)->
vÆue
;

4659 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4660 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4661 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4662 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

4663 
is_migøtög
 = 0, 
is_imp‹tög
 = 0;

4664 i‡(
n
->
migøtög
) {

4665 
i
 = 0; i < 
n
->
migøtög_cou¡
; i += 2) {

4666 
sds
 
migøtög_¶Ÿ
 = 
n
->
migøtög
[
i
];

4667 i‡(
	`©oi
(
migøtög_¶Ÿ
Ë=
¶Ÿ
) {

4668 *
£p
 = (
	`li°Lígth
(
migøtög
) == 0 ? "" : ",");

4669 
migøtög_°r
 = 
	`sdsˇtfmt
(migrating_str, "%s%s:%u",

4670 
£p
, 
n
->
ù
,Ç->
p‹t
);

4671 
	`li°AddNodeTaû
(
migøtög
, 
n
);

4672 
is_migøtög
 = 1;

4677 i‡(!
is_migøtög
 && 
n
->
imp‹tög
) {

4678 
i
 = 0; i < 
n
->
imp‹tög_cou¡
; i += 2) {

4679 
sds
 
imp‹tög_¶Ÿ
 = 
n
->
imp‹tög
[
i
];

4680 i‡(
	`©oi
(
imp‹tög_¶Ÿ
Ë=
¶Ÿ
) {

4681 *
£p
 = (
	`li°Lígth
(
imp‹tög
) == 0 ? "" : ",");

4682 
imp‹tög_°r
 = 
	`sdsˇtfmt
(importing_str, "%s%s:%u",

4683 
£p
, 
n
->
ù
,Ç->
p‹t
);

4684 
	`li°AddNodeTaû
(
imp‹tög
, 
n
);

4685 
is_imp‹tög
 = 1;

4694 i‡(!
is_migøtög
 && !
is_imp‹tög
 && 
n
 !
ow√r
) {

4695 
ªdisRïly
 *
r
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
,

4696 "CLUSTER COUNTKEYSINSLOT %d", 
¶Ÿ
);

4697 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
n
, 
r
, 
NULL
);

4698 i‡(
suc˚ss
 && 
r
->
öãgî
 > 0) {

4699 
	`˛u°îM™agîLogW¨n
("*** Found keysábout slot %d "

4700 "öÇodê%s:%d!\n", 
¶Ÿ
, 
n
->
ù
,

4701 
n
->
p‹t
);

4702 *
£p
 = (
	`li°Lígth
(
imp‹tög
) == 0 ? "" : ",");

4703 
imp‹tög_°r
 = 
	`sdsˇtfmt
(importing_str, "%s%S:%u",

4704 
£p
, 
n
->
ù
,Ç->
p‹t
);

4705 
	`li°AddNodeTaû
(
imp‹tög
, 
n
);

4707 i‡(
r
Ë
	`‰ìRïlyObje˘
(r);

4708 i‡(!
suc˚ss
Ë
˛ónup
;

4711 i‡(
	`sd¶í
(
migøtög_°r
) > 0)

4712 
	`¥ötf
("Sëá†migøtög in: %s\n", 
migøtög_°r
);

4713 i‡(
	`sd¶í
(
imp‹tög_°r
) > 0)

4714 
	`¥ötf
("Sëá†imp‹tög in: %s\n", 
imp‹tög_°r
);

4718 i‡(
ow√r
 =
NULL
) {

4719 
	`˛u°îM™agîLogInfo
(">>> No single clear owner forÅhe slot, "

4721 
ow√r
 = 
	`˛u°îM™agîGëNodeWôhMo°KeysInSlŸ
(
˛u°î_m™agî
.
nodes
,

4722 
¶Ÿ
, 
NULL
);

4724 i‡(
ow√r
 =
NULL
) {

4725 
	`˛u°îM™agîLogEº
("[ERR] Can't selectá slot owner. "

4727 
suc˚ss
 = 0;

4728 
˛ónup
;

4732 
	`˛u°îM™agîLogW¨n
("*** Configuring %s:%dásÅhe slot owner\n",

4733 
ow√r
->
ù
, ow√r->
p‹t
);

4734 
suc˚ss
 = 
	`˛u°îM™agîCÀ¨SlŸSètus
(
ow√r
, 
¶Ÿ
);

4735 i‡(!
suc˚ss
Ë
˛ónup
;

4736 
suc˚ss
 = 
	`˛u°îM™agîSëSlŸOw√r
(
ow√r
, 
¶Ÿ
, 0);

4737 i‡(!
suc˚ss
Ë
˛ónup
;

4740 
ow√r
->
¶Ÿs
[
¶Ÿ
] = 1;

4744 
suc˚ss
 = 
	`˛u°îM™agîBumpEpoch
(
ow√r
);

4745 i‡(!
suc˚ss
Ë
˛ónup
;

4748 
	`˛u°îM™agîRemoveNodeFromLi°
(
migøtög
, 
ow√r
);

4749 
	`˛u°îM™agîRemoveNodeFromLi°
(
imp‹tög
, 
ow√r
);

4760 i‡(
	`li°Lígth
(
ow√rs
) > 1) {

4763 
	`as£π
(
ow√r
 !
NULL
);

4764 
	`li°Rewöd
(
ow√rs
, &
li
);

4765 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4766 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4767 i‡(
n
 =
ow√r
) ;

4768 
suc˚ss
 = 
	`˛u°îM™agîDñSlŸ
(
n
, 
¶Ÿ
, 1);

4769 i‡(!
suc˚ss
Ë
˛ónup
;

4770 
n
->
¶Ÿs
[
¶Ÿ
] = 0;

4772 
suc˚ss
 = 
	`˛u°îM™agîSëSlŸ
(
n
, 
ow√r
, 
¶Ÿ
, "node", 
NULL
);

4773 i‡(!
suc˚ss
Ë
˛ónup
;

4774 
suc˚ss
 = 
	`˛u°îM™agîSëSlŸ
(
n
, 
ow√r
, 
¶Ÿ
, "imp‹tög", 
NULL
);

4775 i‡(!
suc˚ss
Ë
˛ónup
;

4777 
	`˛u°îM™agîRemoveNodeFromLi°
(
imp‹tög
, 
n
);

4778 
	`li°AddNodeTaû
(
imp‹tög
, 
n
);

4780 
	`˛u°îM™agîRemoveNodeFromLi°
(
migøtög
, 
n
);

4783 
move_›ts
 = 
CLUSTER_MANAGER_OPT_VERBOSE
;

4787 i‡(
	`li°Lígth
(
migøtög
Ë=1 &&Üi°Lígth(
imp‹tög
) == 1) {

4788 
˛u°îM™agîNode
 *
§c
 = 
	`li°Fú°
(
migøtög
)->
vÆue
;

4789 
˛u°îM™agîNode
 *
d°
 = 
	`li°Fú°
(
imp‹tög
)->
vÆue
;

4790 
	`˛u°îM™agîLogInfo
(">>> Case 1: Moving slot %d from "

4791 "%s:%dÅÿ%s:%d\n", 
¶Ÿ
,

4792 
§c
->
ù
, src->
p‹t
, 
d°
->ip, dst->port);

4793 
move_›ts
 |
CLUSTER_MANAGER_OPT_UPDATE
;

4794 
suc˚ss
 = 
	`˛u°îM™agîMoveSlŸ
(
§c
, 
d°
, 
¶Ÿ
, 
move_›ts
, 
NULL
);

4801 i‡(
	`li°Lígth
(
migøtög
Ë=0 &&Üi°Lígth(
imp‹tög
) > 0) {

4802 
	`˛u°îM™agîLogInfo
(">>> Case 2: MovingállÅhe %d slot keysÅo its "

4803 "ow√∏%s:%d\n", 
¶Ÿ
, 
ow√r
->
ù
, ow√r->
p‹t
);

4804 
move_›ts
 |
CLUSTER_MANAGER_OPT_COLD
;

4805 
	`li°Rewöd
(
imp‹tög
, &
li
);

4806 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4807 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4808 i‡(
n
 =
ow√r
) ;

4809 
suc˚ss
 = 
	`˛u°îM™agîMoveSlŸ
(
n
, 
ow√r
, 
¶Ÿ
, 
move_›ts
, 
NULL
);

4810 i‡(!
suc˚ss
Ë
˛ónup
;

4811 
	`˛u°îM™agîLogInfo
(">>> Setting %dás STABLE in "

4812 "%s:%d\n", 
¶Ÿ
, 
n
->
ù
,Ç->
p‹t
);

4813 
suc˚ss
 = 
	`˛u°îM™agîCÀ¨SlŸSètus
(
n
, 
¶Ÿ
);

4814 i‡(!
suc˚ss
Ë
˛ónup
;

4818 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4819 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4820 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4821 i‡(
n
 =
ow√r
) ;

4822 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

4823 
suc˚ss
 = 
	`˛u°îM™agîSëSlŸ
(
n
, 
ow√r
, 
¶Ÿ
, "NODE", 
NULL
);

4824 i‡(!
suc˚ss
Ë
˛ónup
;

4837 i‡(
	`li°Lígth
(
migøtög
Ë=1 &&Üi°Lígth(
imp‹tög
) > 1) {

4838 
åy_to_fix
 = 1;

4839 
˛u°îM™agîNode
 *
§c
 = 
	`li°Fú°
(
migøtög
)->
vÆue
;

4840 
˛u°îM™agîNode
 *
d°
 = 
NULL
;

4841 
sds
 
èrgë_id
 = 
NULL
;

4842 
i
 = 0; i < 
§c
->
migøtög_cou¡
; i += 2) {

4843 
sds
 
migøtög_¶Ÿ
 = 
§c
->
migøtög
[
i
];

4844 i‡(
	`©oi
(
migøtög_¶Ÿ
Ë=
¶Ÿ
) {

4845 
èrgë_id
 = 
§c
->
migøtög
[
i
 + 1];

4849 
	`as£π
(
èrgë_id
 !
NULL
);

4850 
li°Iãr
 
li
;

4851 
li°Node
 *
 
;

4852 
	`li°Rewöd
(
imp‹tög
, &
li
);

4853 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4854 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4855 
cou¡
 = 
	`˛u°îM™agîCou¡KeysInSlŸ
(
n
, 
¶Ÿ
);

4856 i‡(
cou¡
 > 0) {

4857 
åy_to_fix
 = 0;

4860 i‡(
	`°rcmp
(
n
->
«me
, 
èrgë_id
Ë=0Ë
d°
 =Ç;

4862 i‡(!
åy_to_fix
Ë
unh™dÀd_ˇ£
;

4863 i‡(
d°
 !
NULL
) {

4864 
	`˛u°îM™agîLogInfo
(">>> Case 3: Moving slot %d from %s:%dÅo "

4867 
¶Ÿ
, 
§c
->
ù
, src->
p‹t
,

4868 
d°
->
ù
, d°->
p‹t
);

4870 
suc˚ss
 = 
	`˛u°îM™agîMoveSlŸ
(
§c
, 
d°
, 
¶Ÿ
, 
move_›ts
, 
NULL
);

4871 i‡(!
suc˚ss
Ë
˛ónup
;

4873 
	`li°Rewöd
(
imp‹tög
, &
li
);

4874 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4875 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4876 i‡(
d°
 =
n
) ;

4877 
suc˚ss
 = 
	`˛u°îM™agîCÀ¨SlŸSètus
(
n
, 
¶Ÿ
);

4878 i‡(!
suc˚ss
Ë
˛ónup
;

4881 
	`˛u°îM™agîLogInfo
(">>> Case 3: Closing slot %d on both "

4882 "migøtögánd imp‹tögÇodes.\n", 
¶Ÿ
);

4885 
suc˚ss
 = 
	`˛u°îM™agîCÀ¨SlŸSètus
(
§c
, 
¶Ÿ
);

4886 i‡(!
suc˚ss
Ë
˛ónup
;

4887 
	`li°Rewöd
(
imp‹tög
, &
li
);

4888 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4889 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4890 
suc˚ss
 = 
	`˛u°îM™agîCÀ¨SlŸSètus
(
n
, 
¶Ÿ
);

4891 i‡(!
suc˚ss
Ë
˛ónup
;

4895 
åy_to_˛o£_¶Ÿ
 = (
	`li°Lígth
(
imp‹tög
) == 0 &&

4896 
	`li°Lígth
(
migøtög
) == 1);

4897 i‡(
åy_to_˛o£_¶Ÿ
) {

4898 
˛u°îM™agîNode
 *
n
 = 
	`li°Fú°
(
migøtög
)->
vÆue
;

4899 i‡(!
ow√r
 || ow√∏!
n
) {

4900 
ªdisRïly
 *
r
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
,

4901 "CLUSTER GETKEYSINSLOT %d %d", 
¶Ÿ
, 10);

4902 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
n
, 
r
, 
NULL
);

4903 i‡(
r
) {

4904 i‡(
suc˚ss
Ë
åy_to_˛o£_¶Ÿ
 = (
r
->
ñemíts
 == 0);

4905 
	`‰ìRïlyObje˘
(
r
);

4907 i‡(!
suc˚ss
Ë
˛ónup
;

4914 i‡(
åy_to_˛o£_¶Ÿ
) {

4915 
˛u°îM™agîNode
 *
n
 = 
	`li°Fú°
(
migøtög
)->
vÆue
;

4916 
	`˛u°îM™agîLogInfo
(">>> Case 4: Closing slot %d on %s:%d\n",

4917 
¶Ÿ
, 
n
->
ù
,Ç->
p‹t
);

4918 
ªdisRïly
 *
r
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
, "CLUSTER SETSLOT %d %s",

4919 
¶Ÿ
, "STABLE");

4920 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
n
, 
r
, 
NULL
);

4921 i‡(
r
Ë
	`‰ìRïlyObje˘
(r);

4922 i‡(!
suc˚ss
Ë
˛ónup
;

4924 
unh™dÀd_ˇ£
:

4925 
suc˚ss
 = 0;

4926 
	`˛u°îM™agîLogEº
("[ERR] Sorry,Ñedis-cli can't fixÅhis slot "

4929 "ow√∏i†%s:%d\n", 
migøtög_°r
,

4930 
imp‹tög_°r
, 
ow√r
->
ù
, ow√r->
p‹t
);

4933 
˛ónup
:

4934 
	`li°Rñó£
(
ow√rs
);

4935 
	`li°Rñó£
(
migøtög
);

4936 
	`li°Rñó£
(
imp‹tög
);

4937 
	`sds‰ì
(
migøtög_°r
);

4938 
	`sds‰ì
(
imp‹tög_°r
);

4939  
suc˚ss
;

4940 
	}
}

4942 
	$˛u°îM™agîFixMu…ùÀSlŸOw√rs
(
¶Ÿ
, 
li°
 *
ow√rs
) {

4943 
	`˛u°îM™agîLogInfo
(">>> Fixög mu…ùÀ ow√r†f‹ slŸ %d...\n", 
¶Ÿ
);

4944 
suc˚ss
 = 0;

4945 
	`as£π
(
	`li°Lígth
(
ow√rs
) > 1);

4946 
˛u°îM™agîNode
 *
ow√r
 = 
	`˛u°îM™agîGëNodeWôhMo°KeysInSlŸ
(
ow√rs
,

4947 
¶Ÿ
,

4948 
NULL
);

4949 i‡(!
ow√r
Ëow√∏
	`li°Fú°
(
ow√rs
)->
vÆue
;

4950 
	`˛u°îM™agîLogInfo
(">>> Setting slot %d owner: %s:%d\n",

4951 
¶Ÿ
, 
ow√r
->
ù
, ow√r->
p‹t
);

4953 i‡(!
	`˛u°îM™agîSëSlŸOw√r
(
ow√r
, 
¶Ÿ
, 0))  0;

4954 
li°Iãr
 
li
;

4955 
li°Node
 *
 
;

4956 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

4960 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

4961 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

4962 i‡(
n
 =
ow√r
) ;

4963 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

4964 
cou¡
 = 
	`˛u°îM™agîCou¡KeysInSlŸ
(
n
, 
¶Ÿ
);

4965 
suc˚ss
 = (
cou¡
 >= 0);

4966 i‡(!
suc˚ss
) ;

4967 
	`˛u°îM™agîDñSlŸ
(
n
, 
¶Ÿ
, 1);

4968 i‡(!
	`˛u°îM™agîSëSlŸ
(
n
, 
ow√r
, 
¶Ÿ
, "node", 
NULL
))  0;

4969 i‡(
cou¡
 > 0) {

4970 
›ts
 = 
CLUSTER_MANAGER_OPT_VERBOSE
 |

4971 
CLUSTER_MANAGER_OPT_COLD
;

4972 
suc˚ss
 = 
	`˛u°îM™agîMoveSlŸ
(
n
, 
ow√r
, 
¶Ÿ
, 
›ts
, 
NULL
);

4973 i‡(!
suc˚ss
) ;

4976  
suc˚ss
;

4977 
	}
}

4979 
	$˛u°îM™agîCheckClu°î
(
quõt
) {

4980 
li°Node
 *
 
 = 
	`li°Fú°
(
˛u°î_m™agî
.
nodes
);

4981 i‡(!
 
)  0;

4982 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

4983 
	`˛u°îM™agîLogInfo
(">>> Performing Cluster Check (usingÇode %s:%d)\n",

4984 
node
->
ù
,Çode->
p‹t
);

4985 
ªsu…
 = 1, 
c⁄si°ít
 = 0;

4986 
do_fix
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 &

4987 
CLUSTER_MANAGER_CMD_FLAG_FIX
;

4988 i‡(!
quõt
Ë
	`˛u°îM™agîShowNodes
();

4989 
c⁄si°ít
 = 
	`˛u°îM™agîIsC⁄figC⁄si°ít
();

4990 i‡(!
c⁄si°ít
) {

4991 
sds
 
îr
 = 
	`sd¢ew
("[ERR] Nodes don'tágreeábout configuration!");

4992 
	`˛u°îM™agîOnEº‹
(
îr
);

4993 
ªsu…
 = 0;

4995 
	`˛u°îM™agîLogOk
("[OK] AllÇodeságreeábout slots "

4999 
	`˛u°îM™agîLogInfo
(">>> Check for open slots...\n");

5000 
li°Iãr
 
li
;

5001 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5002 
i
;

5003 
di˘
 *
›í_¶Ÿs
 = 
NULL
;

5004 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5005 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

5006 i‡(
n
->
migøtög
 !
NULL
) {

5007 i‡(
›í_¶Ÿs
 =
NULL
)

5008 
›í_¶Ÿs
 = 
	`di˘Cª©e
(&
˛u°îM™agîDi˘Ty≥
, 
NULL
);

5009 
sds
 
îr°r
 = 
	`sd£m±y
();

5010 
îr°r
 = 
	`sdsˇçrötf
(errstr,

5013 
n
->
ù
,

5014 
n
->
p‹t
);

5015 
i
 = 0; i < 
n
->
migøtög_cou¡
; i += 2) {

5016 
sds
 
¶Ÿ
 = 
n
->
migøtög
[
i
];

5017 
	`di˘Rïœ˚
(
›í_¶Ÿs
, 
¶Ÿ
, 
	`sdsdup
(
n
->
migøtög
[
i
 + 1]));

5018 *
fmt
 = (
i
 > 0 ? ",%S" : "%S");

5019 
îr°r
 = 
	`sdsˇtfmt
”º°r, 
fmt
, 
¶Ÿ
);

5021 
îr°r
 = 
	`sdsˇt
(errstr, ".");

5022 
	`˛u°îM™agîOnEº‹
(
îr°r
);

5024 i‡(
n
->
imp‹tög
 !
NULL
) {

5025 i‡(
›í_¶Ÿs
 =
NULL
)

5026 
›í_¶Ÿs
 = 
	`di˘Cª©e
(&
˛u°îM™agîDi˘Ty≥
, 
NULL
);

5027 
sds
 
îr°r
 = 
	`sd£m±y
();

5028 
îr°r
 = 
	`sdsˇçrötf
(errstr,

5031 
n
->
ù
,

5032 
n
->
p‹t
);

5033 
i
 = 0; i < 
n
->
imp‹tög_cou¡
; i += 2) {

5034 
sds
 
¶Ÿ
 = 
n
->
imp‹tög
[
i
];

5035 
	`di˘Rïœ˚
(
›í_¶Ÿs
, 
¶Ÿ
, 
	`sdsdup
(
n
->
imp‹tög
[
i
 + 1]));

5036 *
fmt
 = (
i
 > 0 ? ",%S" : "%S");

5037 
îr°r
 = 
	`sdsˇtfmt
”º°r, 
fmt
, 
¶Ÿ
);

5039 
îr°r
 = 
	`sdsˇt
(errstr, ".");

5040 
	`˛u°îM™agîOnEº‹
(
îr°r
);

5043 i‡(
›í_¶Ÿs
 !
NULL
) {

5044 
ªsu…
 = 0;

5045 
di˘Iãøt‹
 *
ôî
 = 
	`di˘GëIãøt‹
(
›í_¶Ÿs
);

5046 
di˘E¡ry
 *
íåy
;

5047 
sds
 
îr°r
 = 
	`sd¢ew
("[WARNING] The following slotsáre open: ");

5048 
i
 = 0;

5049 (
íåy
 = 
	`di˘Next
(
ôî
)Ë!
NULL
) {

5050 
sds
 
¶Ÿ
 = (sdsË
	`di˘GëKey
(
íåy
);

5051 *
fmt
 = (
i
++ > 0 ? ",%S" : "%S");

5052 
îr°r
 = 
	`sdsˇtfmt
”º°r, 
fmt
, 
¶Ÿ
);

5054 
	`˛u°îM™agîLogEº
("%s.\n", (*Ë
îr°r
);

5055 
	`sds‰ì
(
îr°r
);

5056 i‡(
do_fix
) {

5058 
	`di˘Rñó£Iãøt‹
(
ôî
);

5059 
ôî
 = 
	`di˘GëIãøt‹
(
›í_¶Ÿs
);

5060 (
íåy
 = 
	`di˘Next
(
ôî
)Ë!
NULL
) {

5061 
sds
 
¶Ÿ
 = (sdsË
	`di˘GëKey
(
íåy
);

5062 
ªsu…
 = 
	`˛u°îM™agîFixO≥nSlŸ
(
	`©oi
(
¶Ÿ
));

5063 i‡(!
ªsu…
) ;

5066 
	`di˘Rñó£Iãøt‹
(
ôî
);

5067 
	`di˘Rñó£
(
›í_¶Ÿs
);

5069 
	`˛u°îM™agîLogInfo
(">>> Check slots coverage...\n");

5070 
¶Ÿs
[
CLUSTER_MANAGER_SLOTS
];

5071 
	`mem£t
(
¶Ÿs
, 0, 
CLUSTER_MANAGER_SLOTS
);

5072 
covîage
 = 
	`˛u°îM™agîGëCovîedSlŸs
(
¶Ÿs
);

5073 i‡(
covîage
 =
CLUSTER_MANAGER_SLOTS
) {

5074 
	`˛u°îM™agîLogOk
("[OK] All %d slots covered.\n",

5075 
CLUSTER_MANAGER_SLOTS
);

5077 
sds
 
îr
 = 
	`sd£m±y
();

5078 
îr
 = 
	`sdsˇçrötf
(err, "[ERR] Notáll %d slotsáre "

5080 
CLUSTER_MANAGER_SLOTS
);

5081 
	`˛u°îM™agîOnEº‹
(
îr
);

5082 
ªsu…
 = 0;

5083 i‡(
do_fix
 ) {

5084 
di˘Ty≥
 
dty≥
 = 
˛u°îM™agîDi˘Ty≥
;

5085 
dty≥
.
keyDe°ru˘‹
 = 
di˘SdsDe°ru˘‹
;

5086 
dty≥
.
vÆDe°ru˘‹
 = 
di˘Li°De°ru˘‹
;

5087 
˛u°îM™agîUncovîedSlŸs
 = 
	`di˘Cª©e
(&
dty≥
, 
NULL
);

5088 
fixed
 = 
	`˛u°îM™agîFixSlŸsCovîage
(
¶Ÿs
);

5089 i‡(
fixed
 > 0Ë
ªsu…
 = 1;

5092 
£¨ch_mu…ùÀ_ow√rs
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 &

5093 
CLUSTER_MANAGER_CMD_FLAG_CHECK_OWNERS
;

5094 i‡(
£¨ch_mu…ùÀ_ow√rs
) {

5097 
	`˛u°îM™agîLogInfo
(">>> Check for multiple slot owners...\n");

5098 
¶Ÿ
 = 0, 
¶Ÿs_wôh_mu…ùÀ_ow√rs
 = 0;

5099 ; 
¶Ÿ
 < 
CLUSTER_MANAGER_SLOTS
; slot++) {

5100 
li°Iãr
 
li
;

5101 
li°Node
 *
 
;

5102 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5103 
li°
 *
ow√rs
 = 
	`li°Cª©e
();

5104 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5105 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

5106 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

5107 i‡(
n
->
¶Ÿs
[
¶Ÿ
]Ë
	`li°AddNodeTaû
(
ow√rs
,Ç);

5111 
cou¡
 = 
	`˛u°îM™agîCou¡KeysInSlŸ
(
n
, 
¶Ÿ
);

5112 i‡(
cou¡
 > 0Ë
	`li°AddNodeTaû
(
ow√rs
, 
n
);

5115 i‡(
	`li°Lígth
(
ow√rs
) > 1) {

5116 
ªsu…
 = 0;

5117 
	`˛u°îM™agîLogEº
("[WARNING] Slot %d has %d owners:\n",

5118 
¶Ÿ
, 
	`li°Lígth
(
ow√rs
));

5119 
	`li°Rewöd
(
ow√rs
, &
li
);

5120 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5121 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

5122 
	`˛u°îM™agîLogEº
(" %s:%d\n", 
n
->
ù
,Ç->
p‹t
);

5124 
¶Ÿs_wôh_mu…ùÀ_ow√rs
++;

5125 i‡(
do_fix
) {

5126 
ªsu…
 = 
	`˛u°îM™agîFixMu…ùÀSlŸOw√rs
(
¶Ÿ
, 
ow√rs
);

5127 i‡(!
ªsu…
) {

5128 
	`˛u°îM™agîLogEº
("FailedÅo fix multiple owners "

5129 "f‹ slŸ %d\n", 
¶Ÿ
);

5130 
	`li°Rñó£
(
ow√rs
);

5132 } 
¶Ÿs_wôh_mu…ùÀ_ow√rs
--;

5135 
	`li°Rñó£
(
ow√rs
);

5137 i‡(
¶Ÿs_wôh_mu…ùÀ_ow√rs
 == 0)

5138 
	`˛u°îM™agîLogOk
("[OK] No multiple owners found.\n");

5140  
ªsu…
;

5141 
	}
}

5143 
˛u°îM™agîNode
 *
	$˛u°îNodeF‹Resh¨dög
(*
id
,

5144 
˛u°îM™agîNode
 *
èrgë
,

5145 *
øi£_îr
)

5147 
˛u°îM™agîNode
 *
node
 = 
NULL
;

5148 c⁄° *
övÆid_node_msg
 = "*** The specifiedÇode (%s) isÇot known "

5150 
node
 = 
	`˛u°îM™agîNodeByName
(
id
);

5151 *
øi£_îr
 = 0;

5152 i‡(!
node
 ||Çode->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) {

5153 
	`˛u°îM™agîLogEº
(
övÆid_node_msg
, 
id
);

5154 *
øi£_îr
 = 1;

5155  
NULL
;

5156 } i‡(
node
 !
NULL
 && 
èrgë
 != NULL) {

5157 i‡(!
	`°rcmp
(
node
->
«me
, 
èrgë
->name)) {

5158 
	`˛u°îM™agîLogEº
( "*** It isÇotÖossibleÅo use "

5161  
NULL
;

5164  
node
;

5165 
	}
}

5167 
li°
 *
	$˛u°îM™agîCompuãResh¨dTabÀ
(
li°
 *
sour˚s
, 
num¶Ÿs
) {

5168 
li°
 *
moved
 = 
	`li°Cª©e
();

5169 
§c_cou¡
 = 
	`li°Lígth
(
sour˚s
), 
i
 = 0, 
tŸ_¶Ÿs
 = 0, 
j
;

5170 
˛u°îM™agîNode
 **
s‹ãd
 = 
	`zmÆloc
(
§c_cou¡
 * (*sorted));

5171 
li°Iãr
 
li
;

5172 
li°Node
 *
 
;

5173 
	`li°Rewöd
(
sour˚s
, &
li
);

5174 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5175 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

5176 
tŸ_¶Ÿs
 +
node
->
¶Ÿs_cou¡
;

5177 
s‹ãd
[
i
++] = 
node
;

5179 
	`qs‹t
(
s‹ãd
, 
§c_cou¡
, (
˛u°îM™agîNode
 *),

5180 
˛u°îM™agîSlŸCou¡Com∑ªDesc
);

5181 
i
 = 0; i < 
§c_cou¡
; i++) {

5182 
˛u°îM™agîNode
 *
node
 = 
s‹ãd
[
i
];

5183 
n
 = ((Ë
num¶Ÿs
 / 
tŸ_¶Ÿs
 * 
node
->
¶Ÿs_cou¡
);

5184 i‡(
i
 =0Ë
n
 = 
	`˚û
(n);

5185 
n
 = 
	`Êo‹
(n);

5186 
max
 = (Ë
n
, 
cou¡
 = 0;

5187 
j
 = 0; j < 
CLUSTER_MANAGER_SLOTS
; j++) {

5188 
¶Ÿ
 = 
node
->
¶Ÿs
[
j
];

5189 i‡(!
¶Ÿ
) ;

5190 i‡(
cou¡
 >
max
 || ()
	`li°Lígth
(
moved
Ë>
num¶Ÿs
) ;

5191 
˛u°îM™agîResh¨dTabÀIãm
 *
ôem
 = 
	`zmÆloc
((*item));

5192 
ôem
->
sour˚
 = 
node
;

5193 
ôem
->
¶Ÿ
 = 
j
;

5194 
	`li°AddNodeTaû
(
moved
, 
ôem
);

5195 
cou¡
++;

5198 
	`z‰ì
(
s‹ãd
);

5199  
moved
;

5200 
	}
}

5202 
	$˛u°îM™agîShowResh¨dTabÀ
(
li°
 *
èbÀ
) {

5203 
li°Iãr
 
li
;

5204 
li°Node
 *
 
;

5205 
	`li°Rewöd
(
èbÀ
, &
li
);

5206 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5207 
˛u°îM™agîResh¨dTabÀIãm
 *
ôem
 = 
 
->
vÆue
;

5208 
˛u°îM™agîNode
 *
n
 = 
ôem
->
sour˚
;

5209 
	`¥ötf
(" Movög slŸ %d from %s\n", 
ôem
->
¶Ÿ
, (*Ë
n
->
«me
);

5211 
	}
}

5213 
	$˛u°îM™agîRñó£Resh¨dTabÀ
(
li°
 *
èbÀ
) {

5214 i‡(
èbÀ
 !
NULL
) {

5215 
li°Iãr
 
li
;

5216 
li°Node
 *
 
;

5217 
	`li°Rewöd
(
èbÀ
, &
li
);

5218 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5219 
˛u°îM™agîResh¨dTabÀIãm
 *
ôem
 = 
 
->
vÆue
;

5220 
	`z‰ì
(
ôem
);

5222 
	`li°Rñó£
(
èbÀ
);

5224 
	}
}

5226 
	$˛u°îM™agîLog
(
Àvñ
, c⁄° * 
fmt
, ...) {

5227 
u£_cﬁ‹s
 =

5228 (
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 & 
CLUSTER_MANAGER_CMD_FLAG_COLOR
);

5229 i‡(
u£_cﬁ‹s
) {

5230 
	`¥ötf
("\033[");

5231 
Àvñ
) {

5232 
CLUSTER_MANAGER_LOG_LVL_INFO
: 
	`¥ötf
(
LOG_COLOR_BOLD
); ;

5233 
CLUSTER_MANAGER_LOG_LVL_WARN
: 
	`¥ötf
(
LOG_COLOR_YELLOW
); ;

5234 
CLUSTER_MANAGER_LOG_LVL_ERR
: 
	`¥ötf
(
LOG_COLOR_RED
); ;

5235 
CLUSTER_MANAGER_LOG_LVL_SUCCESS
: 
	`¥ötf
(
LOG_COLOR_GREEN
); ;

5236 : 
	`¥ötf
(
LOG_COLOR_RESET
); ;

5239 
va_li°
 
≠
;

5240 
	`va_°¨t
(
≠
, 
fmt
);

5241 
	`v¥ötf
(
fmt
, 
≠
);

5242 
	`va_íd
(
≠
);

5243 i‡(
u£_cﬁ‹s
Ë
	`¥ötf
("\033[" 
LOG_COLOR_RESET
);

5244 
	}
}

5246 
	$˛u°îM™agîNodeAºayInô
(
˛u°îM™agîNodeAºay
 *
¨øy
,

5247 
Æloc_Àn
)

5249 
¨øy
->
nodes
 = 
	`zˇŒoc
(
Æloc_Àn
 * (
˛u°îM™agîNode
*));

5250 
¨øy
->
Æloc
 =áºay->
nodes
;

5251 
¨øy
->
Àn
 = 
Æloc_Àn
;

5252 
¨øy
->
cou¡
 = 0;

5253 
	}
}

5257 
	$˛u°îM™agîNodeAºayRe£t
(
˛u°îM™agîNodeAºay
 *
¨øy
) {

5258 i‡(
¨øy
->
nodes
 >áºay->
Æloc
) {

5259 
¨øy
->
Àn
 =áºay->
nodes
 -áºay->
Æloc
;

5260 
¨øy
->
nodes
 =áºay->
Æloc
;

5261 
¨øy
->
cou¡
 = 0;

5262 
i
 = 0;

5263 ; 
i
 < 
¨øy
->
Àn
; i++) {

5264 i‡(
¨øy
->
nodes
[
i
] !
NULL
Ë¨øy->
cou¡
++;

5267 
	}
}

5270 
	$˛u°îM™agîNodeAºayShi·
(
˛u°îM™agîNodeAºay
 *
¨øy
,

5271 
˛u°îM™agîNode
 **
nodïå
)

5273 
	`as£π
(
¨øy
->
nodes
 < (¨øy->node†+áºay->
Àn
));

5275 i‡(*
¨øy
->
nodes
 !
NULL
Ë¨øy->
cou¡
--;

5277 *
nodïå
 = *
¨øy
->
nodes
;

5279 
¨øy
->
nodes
++;

5280 
¨øy
->
Àn
--;

5281 
	}
}

5283 
	$˛u°îM™agîNodeAºayAdd
(
˛u°îM™agîNodeAºay
 *
¨øy
,

5284 
˛u°îM™agîNode
 *
node
)

5286 
	`as£π
(
¨øy
->
nodes
 < (¨øy->node†+áºay->
Àn
));

5287 
	`as£π
(
node
 !
NULL
);

5288 
	`as£π
(
¨øy
->
cou¡
 <áºay->
Àn
);

5289 
¨øy
->
nodes
[¨øy->
cou¡
++] = 
node
;

5290 
	}
}

5292 
	$˛u°îM™agîPrötNŸEm±yNodeEº‹
(
˛u°îM™agîNode
 *
node
,

5293 *
îr
)

5295 *
msg
;

5296 i‡(
îr
Ë
msg
 =Érr;

5298 
msg
 = "isÇotÉmpty. EitherÅheÇodeálready knows other "

5302 
	`˛u°îM™agîLogEº
("[ERR] Nodê%s:%d %s\n", 
node
->
ù
,Çode->
p‹t
, 
msg
);

5303 
	}
}

5305 
	$˛u°îM™agîPrötNŸClu°îNodeEº‹
(
˛u°îM™agîNode
 *
node
,

5306 *
îr
)

5308 *
msg
 = (
îr
 ?Érr : "isÇot configuredásá clusterÇode.");

5309 
	`˛u°îM™agîLogEº
("[ERR] Nodê%s:%d %s\n", 
node
->
ù
,Çode->
p‹t
, 
msg
);

5310 
	}
}

5313 
	$˛u°îM™agîMode
(
˛u°îM™agîComm™dProc
 *
¥oc
) {

5314 
¨gc
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.argc;

5315 **
¨gv
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.argv;

5316 
˛u°î_m™agî
.
nodes
 = 
NULL
;

5317 i‡(!
	`¥oc
(
¨gc
, 
¨gv
)Ë
˛u°î_m™agî_îr
;

5318 
	`‰ìClu°îM™agî
();

5319 
	`exô
(0);

5320 
˛u°î_m™agî_îr
:

5321 
	`‰ìClu°îM™agî
();

5322 
	`sds‰ì
(
c⁄fig
.
ho°ù
);

5323 
	`sds‰ì
(
c⁄fig
.
mb_dñim
);

5324 
	`exô
(1);

5325 
	}
}

5329 
	$˛u°îM™agîComm™dCª©e
(
¨gc
, **
¨gv
) {

5330 
i
, 
j
, 
suc˚ss
 = 1;

5331 
˛u°î_m™agî
.
nodes
 = 
	`li°Cª©e
();

5332 
i
 = 0; i < 
¨gc
; i++) {

5333 *
addr
 = 
¨gv
[
i
];

5334 *
c
 = 
	`°ºchr
(
addr
, '@');

5335 i‡(
c
 !
NULL
) *c = '\0';

5336 
c
 = 
	`°ºchr
(
addr
, ':');

5337 i‡(
c
 =
NULL
) {

5338 
	`Ârötf
(
°dîr
, "InvÆidáddªs†f‹m©: %s\n", 
addr
);

5341 *
c
 = '\0';

5342 *
ù
 = 
addr
;

5343 
p‹t
 = 
	`©oi
(++
c
);

5344 
˛u°îM™agîNode
 *
node
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

5345 i‡(!
	`˛u°îM™agîNodeC⁄√˘
(
node
)) {

5346 
	`‰ìClu°îM™agîNode
(
node
);

5349 *
îr
 = 
NULL
;

5350 i‡(!
	`˛u°îM™agîNodeIsClu°î
(
node
, &
îr
)) {

5351 
	`˛u°îM™agîPrötNŸClu°îNodeEº‹
(
node
, 
îr
);

5352 i‡(
îr
Ë
	`z‰ì
(err);

5353 
	`‰ìClu°îM™agîNode
(
node
);

5356 
îr
 = 
NULL
;

5357 i‡(!
	`˛u°îM™agîNodeLﬂdInfo
(
node
, 0, &
îr
)) {

5358 i‡(
îr
) {

5359 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node
, 
îr
);

5360 
	`z‰ì
(
îr
);

5362 
	`‰ìClu°îM™agîNode
(
node
);

5365 
îr
 = 
NULL
;

5366 i‡(!
	`˛u°îM™agîNodeIsEm±y
(
node
, &
îr
)) {

5367 
	`˛u°îM™agîPrötNŸEm±yNodeEº‹
(
node
, 
îr
);

5368 i‡(
îr
Ë
	`z‰ì
(err);

5369 
	`‰ìClu°îM™agîNode
(
node
);

5372 
	`li°AddNodeTaû
(
˛u°î_m™agî
.
nodes
, 
node
);

5374 
node_Àn
 = 
˛u°î_m™agî
.
nodes
->
Àn
;

5375 
ª∂iˇs
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.replicas;

5376 
ma°îs_cou¡
 = 
	`CLUSTER_MANAGER_MASTERS_COUNT
(
node_Àn
, 
ª∂iˇs
);

5377 i‡(
ma°îs_cou¡
 < 3) {

5378 
	`˛u°îM™agîLogEº
(

5382 
node_Àn
, 
ª∂iˇs
);

5383 
	`˛u°îM™agîLogEº
("\n*** AtÜeast %dÇodesáreÑequired.\n",

5384 3 * (
ª∂iˇs
 + 1));

5387 
	`˛u°îM™agîLogInfo
(">>> Performing hash slotsállocation "

5388 "⁄ %dÇodes...\n", 
node_Àn
);

5389 
öãæóved_Àn
 = 0, 
ù_cou¡
 = 0;

5390 
˛u°îM™agîNode
 **
öãæóved
 = 
	`zˇŒoc
(
node_Àn
*(**interleaved));

5391 **
ùs
 = 
	`zˇŒoc
(
node_Àn
 * (*));

5392 
˛u°îM™agîNodeAºay
 *
ù_nodes
 = 
	`zˇŒoc
(
node_Àn
 * (*ip_nodes));

5393 
li°Iãr
 
li
;

5394 
li°Node
 *
 
;

5395 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5396 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5397 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

5398 
found
 = 0;

5399 
i
 = 0; i < 
ù_cou¡
; i++) {

5400 *
ù
 = 
ùs
[
i
];

5401 i‡(!
	`°rcmp
(
ù
, 
n
->ip)) {

5402 
found
 = 1;

5406 i‡(!
found
) {

5407 
ùs
[
ù_cou¡
++] = 
n
->
ù
;

5409 
˛u°îM™agîNodeAºay
 *
node_¨øy
 = &(
ù_nodes
[
i
]);

5410 i‡(
node_¨øy
->
nodes
 =
NULL
)

5411 
	`˛u°îM™agîNodeAºayInô
(
node_¨øy
, 
node_Àn
);

5412 
	`˛u°îM™agîNodeAºayAdd
(
node_¨øy
, 
n
);

5414 
öãæóved_Àn
 < 
node_Àn
) {

5415 
i
 = 0; i < 
ù_cou¡
; i++) {

5416 
˛u°îM™agîNodeAºay
 *
node_¨øy
 = &(
ù_nodes
[
i
]);

5417 i‡(
node_¨øy
->
cou¡
 > 0) {

5418 
˛u°îM™agîNode
 *
n
 = 
NULL
;

5419 
	`˛u°îM™agîNodeAºayShi·
(
node_¨øy
, &
n
);

5420 
öãæóved
[
öãæóved_Àn
++] = 
n
;

5424 
˛u°îM™agîNode
 **
ma°îs
 = 
öãæóved
;

5425 
öãæóved
 +
ma°îs_cou¡
;

5426 
öãæóved_Àn
 -
ma°îs_cou¡
;

5427 
¶Ÿs_≥r_node
 = 
CLUSTER_MANAGER_SLOTS
 / (Ë
ma°îs_cou¡
;

5428 
fú°
 = 0;

5429 
curs‹
 = 0.0f;

5430 
i
 = 0; i < 
ma°îs_cou¡
; i++) {

5431 
˛u°îM™agîNode
 *
ma°î
 = 
ma°îs
[
i
];

5432 
œ°
 = 
	`Ãound
(
curs‹
 + 
¶Ÿs_≥r_node
 - 1);

5433 i‡(
œ°
 > 
CLUSTER_MANAGER_SLOTS
 || 
i
 =(
ma°îs_cou¡
 - 1))

5434 
œ°
 = 
CLUSTER_MANAGER_SLOTS
 - 1;

5435 i‡(
œ°
 < 
fú°
)Üast = first;

5436 
	`¥ötf
("Ma°î[%d] -> SlŸ†%lu - %lu\n", 
i
, 
fú°
, 
œ°
);

5437 
ma°î
->
¶Ÿs_cou¡
 = 0;

5438 
j
 = 
fú°
; j <
œ°
; j++) {

5439 
ma°î
->
¶Ÿs
[
j
] = 1;

5440 
ma°î
->
¶Ÿs_cou¡
++;

5442 
ma°î
->
dúty
 = 1;

5443 
fú°
 = 
œ°
 + 1;

5444 
curs‹
 +
¶Ÿs_≥r_node
;

5449 
˛u°îM™agîNode
 *
fú°_node
 = 
öãæóved
[0];

5450 
i
 = 0; i < (
öãæóved_Àn
 - 1); i++)

5451 
öãæóved
[
i
] = interleaved[i + 1];

5452 
öãæóved
[
öãæóved_Àn
 - 1] = 
fú°_node
;

5453 
assign_unu£d
 = 0, 
avaûabÀ_cou¡
 = 
öãæóved_Àn
;

5454 
assign_ª∂iˇs
:

5455 
i
 = 0; i < 
ma°îs_cou¡
; i++) {

5456 
˛u°îM™agîNode
 *
ma°î
 = 
ma°îs
[
i
];

5457 
assig√d_ª∂iˇs
 = 0;

5458 
assig√d_ª∂iˇs
 < 
ª∂iˇs
) {

5459 i‡(
avaûabÀ_cou¡
 == 0) ;

5460 
˛u°îM™agîNode
 *
found
 = 
NULL
, *
¶ave
 = NULL;

5461 
fú°NodeIdx
 = -1;

5462 
j
 = 0; j < 
öãæóved_Àn
; j++) {

5463 
˛u°îM™agîNode
 *
n
 = 
öãæóved
[
j
];

5464 i‡(
n
 =
NULL
) ;

5465 i‡(
	`°rcmp
(
n
->
ù
, 
ma°î
->ip)) {

5466 
found
 = 
n
;

5467 
öãæóved
[
j
] = 
NULL
;

5470 i‡(
fú°NodeIdx
 < 0Ëfú°NodeIdx = 
j
;

5472 i‡(
found
Ë
¶ave
 = found;

5473 i‡(
fú°NodeIdx
 >= 0) {

5474 
¶ave
 = 
öãæóved
[
fú°NodeIdx
];

5475 
öãæóved_Àn
 -(
öãæóved
 - (öãæóved + 
fú°NodeIdx
));

5476 
öãæóved
 +(
fú°NodeIdx
 + 1);

5478 i‡(
¶ave
 !
NULL
) {

5479 
assig√d_ª∂iˇs
++;

5480 
avaûabÀ_cou¡
--;

5481 i‡(
¶ave
->
ª∂iˇã
Ë
	`sds‰ì
(slave->replicate);

5482 
¶ave
->
ª∂iˇã
 = 
	`sd¢ew
(
ma°î
->
«me
);

5483 
¶ave
->
dúty
 = 1;

5485 
	`¥ötf
("AddögÑïliˇ %s:%dÅÿ%s:%d\n", 
¶ave
->
ù
, sœve->
p‹t
,

5486 
ma°î
->
ù
, ma°î->
p‹t
);

5487 i‡(
assign_unu£d
) ;

5490 i‡(!
assign_unu£d
 && 
avaûabÀ_cou¡
 > 0) {

5491 
assign_unu£d
 = 1;

5492 
	`¥ötf
("AddingÉxtraÑeplicas...\n");

5493 
assign_ª∂iˇs
;

5495 
i
 = 0; i < 
ù_cou¡
; i++) {

5496 
˛u°îM™agîNodeAºay
 *
node_¨øy
 = 
ù_nodes
 + 
i
;

5497 
	`˛u°îM™agîNodeAºayRe£t
(
node_¨øy
);

5499 
	`˛u°îM™agîO±imizeA¡iAfföôy
(
ù_nodes
, 
ù_cou¡
);

5500 
	`˛u°îM™agîShowNodes
();

5501 i‡(
	`c⁄fúmWôhYes
("Can I setÅheábove configuration?")) {

5502 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5503 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5504 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

5505 *
îr
 = 
NULL
;

5506 
Êushed
 = 
	`˛u°îM™agîFlushNodeC⁄fig
(
node
, &
îr
);

5507 i‡(!
Êushed
 && 
node
->
dúty
 && !node->
ª∂iˇã
) {

5508 i‡(
îr
 !
NULL
) {

5509 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node
, 
îr
);

5510 
	`z‰ì
(
îr
);

5512 
suc˚ss
 = 0;

5513 
˛ónup
;

5514 } i‡(
îr
 !
NULL
Ë
	`z‰ì
(err);

5516 
	`˛u°îM™agîLogInfo
(">>> Nodes configuration updated\n");

5517 
	`˛u°îM™agîLogInfo
(">>> Assigná different configÉpochÅo "

5519 
c⁄fig_ïoch
 = 1;

5520 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5521 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5522 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

5523 
ªdisRïly
 *
ª∂y
 = 
NULL
;

5524 
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
,

5526 
c⁄fig_ïoch
++);

5527 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

5529 
	`˛u°îM™agîLogInfo
(">>> Sending CLUSTER MEET messagesÅo join "

5531 
˛u°îM™agîNode
 *
fú°
 = 
NULL
;

5532 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5533 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5534 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

5535 i‡(
fú°
 =
NULL
) {

5536 
fú°
 = 
node
;

5539 
ªdisRïly
 *
ª∂y
 = 
NULL
;

5540 
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
node
, "cluster meet %s %d",

5541 
fú°
->
ù
, fú°->
p‹t
);

5542 
is_îr
 = 0;

5543 i‡(
ª∂y
 !
NULL
) {

5544 i‡((
is_îr
 = 
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
))

5545 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node
, 
ª∂y
->
°r
);

5546 
	`‰ìRïlyObje˘
(
ª∂y
);

5548 
is_îr
 = 1;

5549 
	`Ârötf
(
°dîr
, "FailedÅo send CLUSTER MEET command.\n");

5551 i‡(
is_îr
) {

5552 
suc˚ss
 = 0;

5553 
˛ónup
;

5559 
	`¶ìp
(1);

5560 
	`˛u°îM™agîWaôF‹Clu°îJoö
();

5562 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5563 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5564 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

5565 i‡(!
node
->
dúty
) ;

5566 *
îr
 = 
NULL
;

5567 
Êushed
 = 
	`˛u°îM™agîFlushNodeC⁄fig
(
node
, &
îr
);

5568 i‡(!
Êushed
 && !
node
->
ª∂iˇã
) {

5569 i‡(
îr
 !
NULL
) {

5570 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
node
, 
îr
);

5571 
	`z‰ì
(
îr
);

5573 
suc˚ss
 = 0;

5574 
˛ónup
;

5578 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5579 
˛u°îM™agîNode
 *
fú°_node
 = 
NULL
;

5580 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5581 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

5582 i‡(!
fú°_node
Ëfú°_nodê
node
;

5583 
	`‰ìClu°îM™agîNode
(
node
);

5585 
	`li°Em±y
(
˛u°î_m™agî
.
nodes
);

5586 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
fú°_node
, 0)) {

5587 
suc˚ss
 = 0;

5588 
˛ónup
;

5590 
	`˛u°îM™agîCheckClu°î
(0);

5592 
˛ónup
:

5594 
	`z‰ì
(
ma°îs
);

5595 
	`z‰ì
(
ùs
);

5596 
i
 = 0; i < 
node_Àn
; i++) {

5597 
˛u°îM™agîNodeAºay
 *
node_¨øy
 = 
ù_nodes
 + 
i
;

5598 
	`CLUSTER_MANAGER_NODE_ARRAY_FREE
(
node_¨øy
);

5600 
	`z‰ì
(
ù_nodes
);

5601  
suc˚ss
;

5602 
	}
}

5604 
	$˛u°îM™agîComm™dAddNode
(
¨gc
, **
¨gv
) {

5605 
suc˚ss
 = 1;

5606 
ªdisRïly
 *
ª∂y
 = 
NULL
;

5607 *
ªf_ù
 = 
NULL
, *
ù
 = NULL;

5608 
ªf_p‹t
 = 0, 
p‹t
 = 0;

5609 i‡(!
	`gëClu°îHo°FromCmdArgs
(
¨gc
 - 1, 
¨gv
 + 1, &
ªf_ù
, &
ªf_p‹t
))

5610 
övÆid_¨gs
;

5611 i‡(!
	`gëClu°îHo°FromCmdArgs
(1, 
¨gv
, &
ù
, &
p‹t
))

5612 
övÆid_¨gs
;

5613 
	`˛u°îM™agîLogInfo
(">>> AddögÇodê%s:%dÅÿ˛u°î %s:%d\n", 
ù
, 
p‹t
,

5614 
ªf_ù
, 
ªf_p‹t
);

5616 
˛u°îM™agîNode
 *
ª‚ode
 = 
	`˛u°îM™agîNewNode
(
ªf_ù
, 
ªf_p‹t
);

5617 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
ª‚ode
, 0))  0;

5618 i‡(!
	`˛u°îM™agîCheckClu°î
(0))  0;

5622 
˛u°îM™agîNode
 *
ma°î_node
 = 
NULL
;

5623 i‡(
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 & 
CLUSTER_MANAGER_CMD_FLAG_SLAVE
) {

5624 *
ma°î_id
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.master_id;

5625 i‡(
ma°î_id
 !
NULL
) {

5626 
ma°î_node
 = 
	`˛u°îM™agîNodeByName
(
ma°î_id
);

5627 i‡(
ma°î_node
 =
NULL
) {

5628 
	`˛u°îM™agîLogEº
("[ERR] Nÿsuch ma°î ID %s\n", 
ma°î_id
);

5632 
ma°î_node
 = 
	`˛u°îM™agîNodeWôhLó°Rïliˇs
();

5633 
	`as£π
(
ma°î_node
 !
NULL
);

5634 
	`¥ötf
("Autom©iˇŒy sñe˘ed ma°î %s:%d\n", 
ma°î_node
->
ù
,

5635 
ma°î_node
->
p‹t
);

5640 
˛u°îM™agîNode
 *
√w_node
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

5641 
added
 = 0;

5642 i‡(!
	`˛u°îM™agîNodeC⁄√˘
(
√w_node
)) {

5643 
	`˛u°îM™agîLogEº
("[ERR] Sorry, can't connectÅoÇode %s:%d\n",

5644 
ù
, 
p‹t
);

5645 
suc˚ss
 = 0;

5646 
˛ónup
;

5648 *
îr
 = 
NULL
;

5649 i‡(!(
suc˚ss
 = 
	`˛u°îM™agîNodeIsClu°î
(
√w_node
, &
îr
))) {

5650 
	`˛u°îM™agîPrötNŸClu°îNodeEº‹
(
√w_node
, 
îr
);

5651 i‡(
îr
Ë
	`z‰ì
(err);

5652 
˛ónup
;

5654 i‡(!
	`˛u°îM™agîNodeLﬂdInfo
(
√w_node
, 0, &
îr
)) {

5655 i‡(
îr
) {

5656 
	`CLUSTER_MANAGER_PRINT_REPLY_ERROR
(
√w_node
, 
îr
);

5657 
	`z‰ì
(
îr
);

5659 
suc˚ss
 = 0;

5660 
˛ónup
;

5662 i‡(!(
suc˚ss
 = 
	`˛u°îM™agîNodeIsEm±y
(
√w_node
, &
îr
))) {

5663 
	`˛u°îM™agîPrötNŸEm±yNodeEº‹
(
√w_node
, 
îr
);

5664 i‡(
îr
Ë
	`z‰ì
(err);

5665 
˛ónup
;

5667 
˛u°îM™agîNode
 *
fú°
 = 
	`li°Fú°
(
˛u°î_m™agî
.
nodes
)->
vÆue
;

5668 
	`li°AddNodeTaû
(
˛u°î_m™agî
.
nodes
, 
√w_node
);

5669 
added
 = 1;

5672 
	`˛u°îM™agîLogInfo
(">>> Send CLUSTER MEETÅoÇode %s:%dÅo make it "

5673 "joöÅhê˛u°î.\n", 
ù
, 
p‹t
);

5674 
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
√w_node
, "CLUSTER MEET %s %d",

5675 
fú°
->
ù
, fú°->
p‹t
);

5676 i‡(!(
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
√w_node
, 
ª∂y
, 
NULL
)))

5677 
˛ónup
;

5680 i‡(
ma°î_node
) {

5681 
	`¶ìp
(1);

5682 
	`˛u°îM™agîWaôF‹Clu°îJoö
();

5683 
	`˛u°îM™agîLogInfo
(">>> ConfigureÇodeásÑeplica of %s:%d.\n",

5684 
ma°î_node
->
ù
, ma°î_node->
p‹t
);

5685 
	`‰ìRïlyObje˘
(
ª∂y
);

5686 
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
√w_node
, "CLUSTER REPLICATE %s",

5687 
ma°î_node
->
«me
);

5688 i‡(!(
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
√w_node
, 
ª∂y
, 
NULL
)))

5689 
˛ónup
;

5691 
	`˛u°îM™agîLogOk
("[OK] NewÇodeádded correctly.\n");

5692 
˛ónup
:

5693 i‡(!
added
 && 
√w_node
Ë
	`‰ìClu°îM™agîNode
(new_node);

5694 i‡(
ª∂y
Ë
	`‰ìRïlyObje˘
(reply);

5695  
suc˚ss
;

5696 
övÆid_¨gs
:

5697 
	`Ârötf
(
°dîr
, 
CLUSTER_MANAGER_INVALID_HOST_ARG
);

5699 
	}
}

5701 
	$˛u°îM™agîComm™dDñëeNode
(
¨gc
, **
¨gv
) {

5702 
	`UNUSED
(
¨gc
);

5703 
suc˚ss
 = 1;

5704 
p‹t
 = 0;

5705 *
ù
 = 
NULL
;

5706 i‡(!
	`gëClu°îHo°FromCmdArgs
(1, 
¨gv
, &
ù
, &
p‹t
)Ë
övÆid_¨gs
;

5707 *
node_id
 = 
¨gv
[1];

5708 
	`˛u°îM™agîLogInfo
(">>> RemovingÇode %s from cluster %s:%d\n",

5709 
node_id
, 
ù
, 
p‹t
);

5710 
˛u°îM™agîNode
 *
ªf_node
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

5711 
˛u°îM™agîNode
 *
node
 = 
NULL
;

5714 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
ªf_node
, 0))  0;

5717 
node
 = 
	`˛u°îM™agîNodeByName
(
node_id
);

5718 i‡(
node
 =
NULL
) {

5719 
	`˛u°îM™agîLogEº
("[ERR] NÿsuchÇodêID %s\n", 
node_id
);

5722 i‡(
node
->
¶Ÿs_cou¡
 != 0) {

5723 
	`˛u°îM™agîLogEº
("[ERR] Node %s:%d isÇotÉmpty! Reshard data "

5724 "awayándÅryágaö.\n", 
node
->
ù
,Çode->
p‹t
);

5729 
	`˛u°îM™agîLogInfo
(">>> Sending CLUSTER FORGET messagesÅoÅhe "

5731 
li°Iãr
 
li
;

5732 
li°Node
 *
 
;

5733 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5734 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5735 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

5736 i‡(
n
 =
node
) ;

5737 i‡(
n
->
ª∂iˇã
 && !
	`°rˇ£cmp
“->ª∂iˇã, 
node_id
)) {

5739 
˛u°îM™agîNode
 *
ma°î
 = 
	`˛u°îM™agîNodeWôhLó°Rïliˇs
();

5740 
	`as£π
(
ma°î
 !
NULL
);

5741 
	`˛u°îM™agîLogInfo
(">>> %s:%dásÑeplica of %s:%d\n",

5742 
n
->
ù
,Ç->
p‹t
, 
ma°î
->ip, master->port);

5743 
ªdisRïly
 *
r
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
, "CLUSTER REPLICATE %s",

5744 
ma°î
->
«me
);

5745 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
n
, 
r
, 
NULL
);

5746 i‡(
r
Ë
	`‰ìRïlyObje˘
(r);

5747 i‡(!
suc˚ss
)  0;

5749 
ªdisRïly
 *
r
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
, "CLUSTER FORGET %s",

5750 
node_id
);

5751 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
n
, 
r
, 
NULL
);

5752 i‡(
r
Ë
	`‰ìRïlyObje˘
(r);

5753 i‡(!
suc˚ss
)  0;

5757 
	`˛u°îM™agîLogInfo
(">>> Sending CLUSTER RESET SOFTÅoÅhe "

5759 
ªdisRïly
 *
r
 = 
	`ªdisComm™d
(
node
->
c⁄ãxt
, "CLUSTER RESET %s", "SOFT");

5760 
suc˚ss
 = 
	`˛u°îM™agîCheckRedisRïly
(
node
, 
r
, 
NULL
);

5761 i‡(
r
Ë
	`‰ìRïlyObje˘
(r);

5762  
suc˚ss
;

5763 
övÆid_¨gs
:

5764 
	`Ârötf
(
°dîr
, 
CLUSTER_MANAGER_INVALID_HOST_ARG
);

5766 
	}
}

5768 
	$˛u°îM™agîComm™dInfo
(
¨gc
, **
¨gv
) {

5769 
p‹t
 = 0;

5770 *
ù
 = 
NULL
;

5771 i‡(!
	`gëClu°îHo°FromCmdArgs
(
¨gc
, 
¨gv
, &
ù
, &
p‹t
)Ë
övÆid_¨gs
;

5772 
˛u°îM™agîNode
 *
node
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

5773 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
node
, 0))  0;

5774 
	`˛u°îM™agîShowClu°îInfo
();

5776 
övÆid_¨gs
:

5777 
	`Ârötf
(
°dîr
, 
CLUSTER_MANAGER_INVALID_HOST_ARG
);

5779 
	}
}

5781 
	$˛u°îM™agîComm™dCheck
(
¨gc
, **
¨gv
) {

5782 
p‹t
 = 0;

5783 *
ù
 = 
NULL
;

5784 i‡(!
	`gëClu°îHo°FromCmdArgs
(
¨gc
, 
¨gv
, &
ù
, &
p‹t
)Ë
övÆid_¨gs
;

5785 
˛u°îM™agîNode
 *
node
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

5786 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
node
, 0))  0;

5787 
	`˛u°îM™agîShowClu°îInfo
();

5788  
	`˛u°îM™agîCheckClu°î
(0);

5789 
övÆid_¨gs
:

5790 
	`Ârötf
(
°dîr
, 
CLUSTER_MANAGER_INVALID_HOST_ARG
);

5792 
	}
}

5794 
	$˛u°îM™agîComm™dFix
(
¨gc
, **
¨gv
) {

5795 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 |
CLUSTER_MANAGER_CMD_FLAG_FIX
;

5796  
	`˛u°îM™agîComm™dCheck
(
¨gc
, 
¨gv
);

5797 
	}
}

5799 
	$˛u°îM™agîComm™dResh¨d
(
¨gc
, **
¨gv
) {

5800 
p‹t
 = 0;

5801 *
ù
 = 
NULL
;

5802 i‡(!
	`gëClu°îHo°FromCmdArgs
(
¨gc
, 
¨gv
, &
ù
, &
p‹t
)Ë
övÆid_¨gs
;

5803 
˛u°îM™agîNode
 *
node
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

5804 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
node
, 0))  0;

5805 
	`˛u°îM™agîCheckClu°î
(0);

5806 i‡(
˛u°î_m™agî
.
îr‹s
 && 
	`li°Lígth
(cluster_manager.errors) > 0) {

5807 
	`fÊush
(
°dout
);

5808 
	`Ârötf
(
°dîr
,

5812 
¶Ÿs
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.slots;

5813 i‡(!
¶Ÿs
) {

5814 
¶Ÿs
 <0 || slŸ†> 
CLUSTER_MANAGER_SLOTS
) {

5815 
	`¥ötf
("How many slots do you wantÅo move (from 1Åo %d)? ",

5816 
CLUSTER_MANAGER_SLOTS
);

5817 
	`fÊush
(
°dout
);

5818 
buf
[6];

5819 
ƒód
 = 
	`ªad
(
	`fûío
(
°dö
),
buf
,6);

5820 i‡(
ƒód
 <= 0) ;

5821 
œ°_idx
 = 
ƒód
 - 1;

5822 i‡(
buf
[
œ°_idx
] != '\n') {

5823 
ch
;

5824 (
ch
 = 
	`gëch¨
()Ë!'\n' && ch !
EOF
) {}

5826 
buf
[
œ°_idx
] = '\0';

5827 
¶Ÿs
 = 
	`©oi
(
buf
);

5830 
buf
[255];

5831 *
to
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.to,

5832 *
‰om
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.from;

5833 
to
 =
NULL
) {

5834 
	`¥ötf
("What isÅheÑeceivingÇode ID? ");

5835 
	`fÊush
(
°dout
);

5836 
ƒód
 = 
	`ªad
(
	`fûío
(
°dö
),
buf
,255);

5837 i‡(
ƒód
 <= 0) ;

5838 
œ°_idx
 = 
ƒód
 - 1;

5839 i‡(
buf
[
œ°_idx
] != '\n') {

5840 
ch
;

5841 (
ch
 = 
	`gëch¨
()Ë!'\n' && ch !
EOF
) {}

5843 
buf
[
œ°_idx
] = '\0';

5844 i‡(
	`°æí
(
buf
Ë> 0Ë
to
 = buf;

5846 
øi£_îr
 = 0;

5847 
˛u°îM™agîNode
 *
èrgë
 = 
	`˛u°îNodeF‹Resh¨dög
(
to
, 
NULL
, &
øi£_îr
);

5848 i‡(
èrgë
 =
NULL
)  0;

5849 
li°
 *
sour˚s
 = 
	`li°Cª©e
();

5850 
li°
 *
èbÀ
 = 
NULL
;

5851 
Æl
 = 0, 
ªsu…
 = 1;

5852 i‡(
‰om
 =
NULL
) {

5853 
	`¥ötf
("PleaseÉnterállÅhe sourceÇode IDs.\n");

5854 
	`¥ötf
(" Type 'all'Åo useállÅheÇodesás sourceÇodes for "

5856 
	`¥ötf
(" Type 'done' once youÉnteredállÅhe sourceÇodes IDs.\n");

5858 
	`¥ötf
("Sour˚Çodê#%lu: ", 
	`li°Lígth
(
sour˚s
) + 1);

5859 
	`fÊush
(
°dout
);

5860 
ƒód
 = 
	`ªad
(
	`fûío
(
°dö
),
buf
,255);

5861 i‡(
ƒód
 <= 0) ;

5862 
œ°_idx
 = 
ƒód
 - 1;

5863 i‡(
buf
[
œ°_idx
] != '\n') {

5864 
ch
;

5865 (
ch
 = 
	`gëch¨
()Ë!'\n' && ch !
EOF
) {}

5867 
buf
[
œ°_idx
] = '\0';

5868 i‡(!
	`°rcmp
(
buf
, "done")) ;

5869 i‡(!
	`°rcmp
(
buf
, "all")) {

5870 
Æl
 = 1;

5873 
˛u°îM™agîNode
 *
§c
 =

5874 
	`˛u°îNodeF‹Resh¨dög
(
buf
, 
èrgë
, &
øi£_îr
);

5875 i‡(
§c
 !
NULL
Ë
	`li°AddNodeTaû
(
sour˚s
, src);

5876 i‡(
øi£_îr
) {

5877 
ªsu…
 = 0;

5878 
˛ónup
;

5883 *
p
;

5884 (
p
 = 
	`°rchr
(
‰om
, ',')Ë!
NULL
) {

5885 *
p
 = '\0';

5886 i‡(!
	`°rcmp
(
‰om
, "all")) {

5887 
Æl
 = 1;

5890 
˛u°îM™agîNode
 *
§c
 =

5891 
	`˛u°îNodeF‹Resh¨dög
(
‰om
, 
èrgë
, &
øi£_îr
);

5892 i‡(
§c
 !
NULL
Ë
	`li°AddNodeTaû
(
sour˚s
, src);

5893 i‡(
øi£_îr
) {

5894 
ªsu…
 = 0;

5895 
˛ónup
;

5898 
‰om
 = 
p
 + 1;

5901 i‡(!
Æl
 && 
	`°æí
(
‰om
) > 0) {

5902 i‡(!
	`°rcmp
(
‰om
, "Æl")Ë
Æl
 = 1;

5903 i‡(!
Æl
) {

5904 
˛u°îM™agîNode
 *
§c
 =

5905 
	`˛u°îNodeF‹Resh¨dög
(
‰om
, 
èrgë
, &
øi£_îr
);

5906 i‡(
§c
 !
NULL
Ë
	`li°AddNodeTaû
(
sour˚s
, src);

5907 i‡(
øi£_îr
) {

5908 
ªsu…
 = 0;

5909 
˛ónup
;

5914 
li°Iãr
 
li
;

5915 
li°Node
 *
 
;

5916 i‡(
Æl
) {

5917 
	`li°Em±y
(
sour˚s
);

5918 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

5919 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5920 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

5921 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
 ||Ç->
ª∂iˇã
)

5923 i‡(!
	`sdscmp
(
n
->
«me
, 
èrgë
->name)) ;

5924 
	`li°AddNodeTaû
(
sour˚s
, 
n
);

5927 i‡(
	`li°Lígth
(
sour˚s
) == 0) {

5928 
	`Ârötf
(
°dîr
, "*** No sourceÇodes given, operationáborted.\n");

5929 
ªsu…
 = 0;

5930 
˛ónup
;

5932 
	`¥ötf
("\nRódyÅÿmovê%d slŸs.\n", 
¶Ÿs
);

5933 
	`¥ötf
(" SourceÇodes:\n");

5934 
	`li°Rewöd
(
sour˚s
, &
li
);

5935 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5936 
˛u°îM™agîNode
 *
§c
 = 
 
->
vÆue
;

5937 
sds
 
öfo
 = 
	`˛u°îM™agîNodeInfo
(
§c
, 4);

5938 
	`¥ötf
("%s\n", 
öfo
);

5939 
	`sds‰ì
(
öfo
);

5941 
	`¥ötf
(" DestinationÇode:\n");

5942 
sds
 
öfo
 = 
	`˛u°îM™agîNodeInfo
(
èrgë
, 4);

5943 
	`¥ötf
("%s\n", 
öfo
);

5944 
	`sds‰ì
(
öfo
);

5945 
èbÀ
 = 
	`˛u°îM™agîCompuãResh¨dTabÀ
(
sour˚s
, 
¶Ÿs
);

5946 
	`¥ötf
(" ReshardingÖlan:\n");

5947 
	`˛u°îM™agîShowResh¨dTabÀ
(
èbÀ
);

5948 i‡(!(
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 &

5949 
CLUSTER_MANAGER_CMD_FLAG_YES
))

5951 
	`¥ötf
("Do you wantÅoÖroceed withÅheÖroposed "

5953 
	`fÊush
(
°dout
);

5954 
buf
[4];

5955 
ƒód
 = 
	`ªad
(
	`fûío
(
°dö
),
buf
,4);

5956 
buf
[3] = '\0';

5957 i‡(
ƒód
 <0 || 
	`°rcmp
("yes", 
buf
) != 0) {

5958 
ªsu…
 = 0;

5959 
˛ónup
;

5962 
›ts
 = 
CLUSTER_MANAGER_OPT_VERBOSE
;

5963 
	`li°Rewöd
(
èbÀ
, &
li
);

5964 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

5965 
˛u°îM™agîResh¨dTabÀIãm
 *
ôem
 = 
 
->
vÆue
;

5966 *
îr
 = 
NULL
;

5967 
ªsu…
 = 
	`˛u°îM™agîMoveSlŸ
(
ôem
->
sour˚
, 
èrgë
, iãm->
¶Ÿ
,

5968 
›ts
, &
îr
);

5969 i‡(!
ªsu…
) {

5970 i‡(
îr
 !
NULL
) {

5972 
	`z‰ì
(
îr
);

5974 
˛ónup
;

5977 
˛ónup
:

5978 
	`li°Rñó£
(
sour˚s
);

5979 
	`˛u°îM™agîRñó£Resh¨dTabÀ
(
èbÀ
);

5980  
ªsu…
;

5981 
övÆid_¨gs
:

5982 
	`Ârötf
(
°dîr
, 
CLUSTER_MANAGER_INVALID_HOST_ARG
);

5984 
	}
}

5986 
	$˛u°îM™agîComm™dRebÆ™˚
(
¨gc
, **
¨gv
) {

5987 
p‹t
 = 0;

5988 *
ù
 = 
NULL
;

5989 
˛u°îM™agîNode
 **
weighãdNodes
 = 
NULL
;

5990 
li°
 *
övﬁved
 = 
NULL
;

5991 i‡(!
	`gëClu°îHo°FromCmdArgs
(
¨gc
, 
¨gv
, &
ù
, &
p‹t
)Ë
övÆid_¨gs
;

5992 
˛u°îM™agîNode
 *
node
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

5993 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
node
, 0))  0;

5994 
ªsu…
 = 1, 
i
;

5995 i‡(
c⁄fig
.
˛u°î_m™agî_comm™d
.
weight
 !
NULL
) {

5996 
i
 = 0; i < 
c⁄fig
.
˛u°î_m™agî_comm™d
.
weight_¨gc
; i++) {

5997 *
«me
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
weight
[
i
];

5998 *
p
 = 
	`°rchr
(
«me
, '=');

5999 i‡(
p
 =
NULL
) {

6000 
ªsu…
 = 0;

6001 
˛ónup
;

6003 *
p
 = '\0';

6004 
w
 = 
	`©of
(++
p
);

6005 
˛u°îM™agîNode
 *
n
 = 
	`˛u°îM™agîNodeByAbbªvüãdName
(
«me
);

6006 i‡(
n
 =
NULL
) {

6007 
	`˛u°îM™agîLogEº
("*** Nÿsuch ma°îÇodê%s\n", 
«me
);

6008 
ªsu…
 = 0;

6009 
˛ónup
;

6011 
n
->
weight
 = 
w
;

6014 
tŸÆ_weight
 = 0;

6015 
nodes_övﬁved
 = 0;

6016 
u£_em±y
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 &

6017 
CLUSTER_MANAGER_CMD_FLAG_EMPTYMASTER
;

6018 
övﬁved
 = 
	`li°Cª©e
();

6019 
li°Iãr
 
li
;

6020 
li°Node
 *
 
;

6021 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

6023 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

6024 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

6025 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
 ||Ç->
ª∂iˇã
)

6027 i‡(!
u£_em±y
 && 
n
->
¶Ÿs_cou¡
 == 0) {

6028 
n
->
weight
 = 0;

6031 
tŸÆ_weight
 +
n
->
weight
;

6032 
nodes_övﬁved
++;

6033 
	`li°AddNodeTaû
(
övﬁved
, 
n
);

6035 
weighãdNodes
 = 
	`zmÆloc
(
nodes_övﬁved
 * (
˛u°îM™agîNode
 *));

6036 i‡(
weighãdNodes
 =
NULL
Ë
˛ónup
;

6038 
	`˛u°îM™agîCheckClu°î
(1);

6039 i‡(
˛u°î_m™agî
.
îr‹s
 && 
	`li°Lígth
(cluster_manager.errors) > 0) {

6040 
	`˛u°îM™agîLogEº
("*** Please fix your clusterÖroblems "

6042 
ªsu…
 = 0;

6043 
˛ónup
;

6048 
thªshﬁd_ªached
 = 0, 
tŸÆ_bÆ™˚
 = 0;

6049 
thªshﬁd
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.threshold;

6050 
i
 = 0;

6051 
	`li°Rewöd
(
övﬁved
, &
li
);

6052 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

6053 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

6054 
weighãdNodes
[
i
++] = 
n
;

6055 
ex≥˘ed
 = (Ë((()
CLUSTER_MANAGER_SLOTS
 / 
tŸÆ_weight
) *

6056 
n
->
weight
);

6057 
n
->
bÆ™˚
 =Ç->
¶Ÿs_cou¡
 - 
ex≥˘ed
;

6058 
tŸÆ_bÆ™˚
 +
n
->
bÆ™˚
;

6062 
ovî_thªshﬁd
 = 0;

6063 i‡(
thªshﬁd
 > 0) {

6064 i‡(
n
->
¶Ÿs_cou¡
 > 0) {

6065 
îr_≥rc
 = 
	`Ábs
((100-(100.0*
ex≥˘ed
/
n
->
¶Ÿs_cou¡
)));

6066 i‡(
îr_≥rc
 > 
thªshﬁd
Ë
ovî_thªshﬁd
 = 1;

6067 } i‡(
ex≥˘ed
 > 1) {

6068 
ovî_thªshﬁd
 = 1;

6071 i‡(
ovî_thªshﬁd
Ë
thªshﬁd_ªached
 = 1;

6073 i‡(!
thªshﬁd_ªached
) {

6074 
	`˛u°îM™agîLogW¨n
("*** NoÑebalancingÇeeded! "

6076 
c⁄fig
.
˛u°î_m™agî_comm™d
.
thªshﬁd
);

6077 
˛ónup
;

6082 
tŸÆ_bÆ™˚
 > 0) {

6083 
	`li°Rewöd
(
övﬁved
, &
li
);

6084 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

6085 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

6086 i‡(
n
->
bÆ™˚
 <0 && 
tŸÆ_bÆ™˚
 > 0) {

6087 
n
->
bÆ™˚
--;

6088 
tŸÆ_bÆ™˚
--;

6093 
	`qs‹t
(
weighãdNodes
, 
nodes_övﬁved
, (
˛u°îM™agîNode
 *),

6094 
˛u°îM™agîCom∑ªNodeBÆ™˚
);

6095 
	`˛u°îM™agîLogInfo
(">>> Rebalancingácross %dÇodes. "

6097 
nodes_övﬁved
, 
tŸÆ_weight
);

6098 i‡(
c⁄fig
.
vîbo£
) {

6099 
i
 = 0; i < 
nodes_övﬁved
; i++) {

6100 
˛u°îM™agîNode
 *
n
 = 
weighãdNodes
[
i
];

6101 
	`¥ötf
("%s:%d bÆ™˚ i†%d slŸs\n", 
n
->
ù
,Ç->
p‹t
,Ç->
bÆ™˚
);

6109 
d°_idx
 = 0;

6110 
§c_idx
 = 
nodes_övﬁved
 - 1;

6111 
simuœã
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 &

6112 
CLUSTER_MANAGER_CMD_FLAG_SIMULATE
;

6113 
d°_idx
 < 
§c_idx
) {

6114 
˛u°îM™agîNode
 *
d°
 = 
weighãdNodes
[
d°_idx
];

6115 
˛u°îM™agîNode
 *
§c
 = 
weighãdNodes
[
§c_idx
];

6116 
db
 = 
	`abs
(
d°
->
bÆ™˚
);

6117 
sb
 = 
	`abs
(
§c
->
bÆ™˚
);

6118 
num¶Ÿs
 = (
db
 < 
sb
 ? db : sb);

6119 i‡(
num¶Ÿs
 > 0) {

6120 
	`¥ötf
("Movög %d slŸ†‰om %s:%dÅÿ%s:%d\n", 
num¶Ÿs
,

6121 
§c
->
ù
,

6122 
§c
->
p‹t
,

6123 
d°
->
ù
,

6124 
d°
->
p‹t
);

6126 
li°
 *
l§c
 = 
	`li°Cª©e
(), *
èbÀ
 = 
NULL
;

6127 
	`li°AddNodeTaû
(
l§c
, 
§c
);

6128 
èbÀ
 = 
	`˛u°îM™agîCompuãResh¨dTabÀ
(
l§c
, 
num¶Ÿs
);

6129 
	`li°Rñó£
(
l§c
);

6130 
èbÀ_Àn
 = (Ë
	`li°Lígth
(
èbÀ
);

6131 i‡(!
èbÀ
 || 
èbÀ_Àn
 !
num¶Ÿs
) {

6132 
	`˛u°îM™agîLogEº
("*** Assertion failed: ReshardÅable "

6134 
ªsu…
 = 0;

6135 
íd_move
;

6137 i‡(
simuœã
) {

6138 
i
 = 0; i < 
èbÀ_Àn
; i++Ë
	`¥ötf
("#");

6140 
›ts
 = 
CLUSTER_MANAGER_OPT_QUIET
 |

6141 
CLUSTER_MANAGER_OPT_UPDATE
;

6142 
	`li°Rewöd
(
èbÀ
, &
li
);

6143 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

6144 
˛u°îM™agîResh¨dTabÀIãm
 *
ôem
 = 
 
->
vÆue
;

6145 
ªsu…
 = 
	`˛u°îM™agîMoveSlŸ
(
ôem
->
sour˚
,

6146 
d°
,

6147 
ôem
->
¶Ÿ
,

6148 
›ts
, 
NULL
);

6149 i‡(!
ªsu…
Ë
íd_move
;

6150 
	`¥ötf
("#");

6151 
	`fÊush
(
°dout
);

6155 
	`¥ötf
("\n");

6156 
íd_move
:

6157 
	`˛u°îM™agîRñó£Resh¨dTabÀ
(
èbÀ
);

6158 i‡(!
ªsu…
Ë
˛ónup
;

6161 
d°
->
bÆ™˚
 +
num¶Ÿs
;

6162 
§c
->
bÆ™˚
 -
num¶Ÿs
;

6163 i‡(
d°
->
bÆ™˚
 =0Ë
d°_idx
++;

6164 i‡(
§c
->
bÆ™˚
 =0Ë
§c_idx
 --;

6166 
˛ónup
:

6167 i‡(
övﬁved
 !
NULL
Ë
	`li°Rñó£
(involved);

6168 i‡(
weighãdNodes
 !
NULL
Ë
	`z‰ì
(weightedNodes);

6169  
ªsu…
;

6170 
övÆid_¨gs
:

6171 
	`Ârötf
(
°dîr
, 
CLUSTER_MANAGER_INVALID_HOST_ARG
);

6173 
	}
}

6175 
	$˛u°îM™agîComm™dSëTimeout
(
¨gc
, **
¨gv
) {

6176 
	`UNUSED
(
¨gc
);

6177 
p‹t
 = 0;

6178 *
ù
 = 
NULL
;

6179 i‡(!
	`gëClu°îHo°FromCmdArgs
(1, 
¨gv
, &
ù
, &
p‹t
)Ë
övÆid_¨gs
;

6180 
timeout
 = 
	`©oi
(
¨gv
[1]);

6181 i‡(
timeout
 < 100) {

6182 
	`Ârötf
(
°dîr
, "SettingáÇodeÅimeout ofÜessÅhan 100 "

6187 
˛u°îM™agîNode
 *
node
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

6188 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
node
, 0))  0;

6189 
ok_cou¡
 = 0, 
îr_cou¡
 = 0;

6191 
	`˛u°îM™agîLogInfo
(">>> ReconfiguringÇodeÅimeout inÉvery "

6193 
li°Iãr
 
li
;

6194 
li°Node
 *
 
;

6195 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

6196 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

6197 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

6198 *
îr
 = 
NULL
;

6199 
ªdisRïly
 *
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
, "CONFIG %s %s %d",

6202 
timeout
);

6203 i‡(
ª∂y
 =
NULL
Ë
ª∂y_îr
;

6204 
ok
 = 
	`˛u°îM™agîCheckRedisRïly
(
n
, 
ª∂y
, &
îr
);

6205 
	`‰ìRïlyObje˘
(
ª∂y
);

6206 i‡(!
ok
Ë
ª∂y_îr
;

6207 
ª∂y
 = 
	`CLUSTER_MANAGER_COMMAND
(
n
, "CONFIG %s", "REWRITE");

6208 i‡(
ª∂y
 =
NULL
Ë
ª∂y_îr
;

6209 
ok
 = 
	`˛u°îM™agîCheckRedisRïly
(
n
, 
ª∂y
, &
îr
);

6210 
	`‰ìRïlyObje˘
(
ª∂y
);

6211 i‡(!
ok
Ë
ª∂y_îr
;

6212 
	`˛u°îM™agîLogW¨n
("*** NewÅimeouà£àf‹ %s:%d\n", 
n
->
ù
,

6213 
n
->
p‹t
);

6214 
ok_cou¡
++;

6216 
ª∂y_îr
:;

6217 
√ed_‰ì
 = 0;

6218 i‡(
îr
 =
NULL
)Érr = "";

6219 
√ed_‰ì
 = 1;

6220 
	`˛u°îM™agîLogEº
("ERR sëtögÇode-timeŸ f‹ %s:%d: %s\n", 
n
->
ù
,

6221 
n
->
p‹t
, 
îr
);

6222 i‡(
√ed_‰ì
Ë
	`z‰ì
(
îr
);

6223 
îr_cou¡
++;

6225 
	`˛u°îM™agîLogInfo
(">>> NewÇodeÅimeout set. %d OK, %d ERR.\n",

6226 
ok_cou¡
, 
îr_cou¡
);

6228 
övÆid_¨gs
:

6229 
	`Ârötf
(
°dîr
, 
CLUSTER_MANAGER_INVALID_HOST_ARG
);

6231 
	}
}

6233 
	$˛u°îM™agîComm™dImp‹t
(
¨gc
, **
¨gv
) {

6234 
suc˚ss
 = 1;

6235 
p‹t
 = 0, 
§c_p‹t
 = 0;

6236 *
ù
 = 
NULL
, *
§c_ù
 = NULL;

6237 *
övÆid_¨gs_msg
 = 
NULL
;

6238 i‡(!
	`gëClu°îHo°FromCmdArgs
(
¨gc
, 
¨gv
, &
ù
, &
p‹t
)) {

6239 
övÆid_¨gs_msg
 = 
CLUSTER_MANAGER_INVALID_HOST_ARG
;

6240 
övÆid_¨gs
;

6242 i‡(
c⁄fig
.
˛u°î_m™agî_comm™d
.
‰om
 =
NULL
) {

6243 
övÆid_¨gs_msg
 = "[ERR] Option '--cluster-from' isÑequired for "

6245 
övÆid_¨gs
;

6247 *
§c_ho°
[] = {
c⁄fig
.
˛u°î_m™agî_comm™d
.
‰om
};

6248 i‡(!
	`gëClu°îHo°FromCmdArgs
(1, 
§c_ho°
, &
§c_ù
, &
§c_p‹t
)) {

6249 
övÆid_¨gs_msg
 = "[ERR] Invalid --cluster-from host. YouÇeedÅo "

6251 
övÆid_¨gs
;

6253 
	`˛u°îM™agîLogInfo
(">>> Importing data from %s:%dÅo cluster %s:%d\n",

6254 
§c_ù
, 
§c_p‹t
, 
ù
, 
p‹t
);

6256 
˛u°îM™agîNode
 *
ª‚ode
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

6257 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
ª‚ode
, 0))  0;

6258 i‡(!
	`˛u°îM™agîCheckClu°î
(0))  0;

6259 *
ª∂y_îr
 = 
NULL
;

6260 
ªdisRïly
 *
§c_ª∂y
 = 
NULL
;

6262 
ªdisC⁄ãxt
 *
§c_˘x
 = 
	`ªdisC⁄√˘
(
§c_ù
, 
§c_p‹t
);

6263 i‡(
§c_˘x
->
îr
) {

6264 
suc˚ss
 = 0;

6265 
	`Ârötf
(
°dîr
,"CouldÇŸ c⁄√˘ÅÿRedi†© %s:%d: %s.\n", 
§c_ù
,

6266 
§c_p‹t
, 
§c_˘x
->
îr°r
);

6267 
˛ónup
;

6269 
§c_ª∂y
 = 
	`ªc⁄√˘ögRedisComm™d
(
§c_˘x
, "INFO");

6270 i‡(!
§c_ª∂y
 || src_ª∂y->
ty≥
 =
REDIS_REPLY_ERROR
) {

6271 i‡(
§c_ª∂y
 && src_ª∂y->
°r
Ë
ª∂y_îr
 = src_reply->str;

6272 
suc˚ss
 = 0;

6273 
˛ónup
;

6275 i‡(
	`gëL⁄gInfoFõld
(
§c_ª∂y
->
°r
, "cluster_enabled")) {

6276 
	`˛u°îM™agîLogEº
("[ERR] The sourceÇode shouldÇot beá "

6278 
suc˚ss
 = 0;

6279 
˛ónup
;

6281 
	`‰ìRïlyObje˘
(
§c_ª∂y
);

6282 
§c_ª∂y
 = 
	`ªc⁄√˘ögRedisComm™d
(
§c_˘x
, "DBSIZE");

6283 i‡(!
§c_ª∂y
 || src_ª∂y->
ty≥
 =
REDIS_REPLY_ERROR
) {

6284 i‡(
§c_ª∂y
 && src_ª∂y->
°r
Ë
ª∂y_îr
 = src_reply->str;

6285 
suc˚ss
 = 0;

6286 
˛ónup
;

6288 
size
 = 
§c_ª∂y
->
öãgî
, 
i
;

6289 
	`˛u°îM™agîLogW¨n
("*** Imp‹tög %d key†‰om DB 0\n", 
size
);

6292 
˛u°îM™agîNode
 *
¶Ÿs_m≠
[
CLUSTER_MANAGER_SLOTS
];

6293 
	`mem£t
(
¶Ÿs_m≠
, 0, (slots_map));

6294 
li°Iãr
 
li
;

6295 
li°Node
 *
 
;

6296 
i
 = 0; i < 
CLUSTER_MANAGER_SLOTS
; i++) {

6297 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

6298 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

6299 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

6300 i‡(
n
->
Êags
 & 
CLUSTER_MANAGER_FLAG_SLAVE
) ;

6301 i‡(
n
->
¶Ÿs_cou¡
 == 0) ;

6302 i‡(
n
->
¶Ÿs
[
i
]) {

6303 
¶Ÿs_m≠
[
i
] = 
n
;

6309 
cmdfmt
[50] = "MIGRATE %s %d %s %d %d";

6310 i‡(
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 & 
CLUSTER_MANAGER_CMD_FLAG_COPY
)

6311 
	`°rˇt
(
cmdfmt
, " %s");

6312 i‡(
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 & 
CLUSTER_MANAGER_CMD_FLAG_REPLACE
)

6313 
	`°rˇt
(
cmdfmt
, " %s");

6317 
curs‹
 = -999, 
timeout
 = 
c⁄fig
.
˛u°î_m™agî_comm™d
.timeout;

6318 
curs‹
 != 0) {

6319 i‡(
curs‹
 < 0) cursor = 0;

6320 
	`‰ìRïlyObje˘
(
§c_ª∂y
);

6321 
§c_ª∂y
 = 
	`ªc⁄√˘ögRedisComm™d
(
§c_˘x
, "SCAN %d COUNT %d",

6322 
curs‹
, 1000);

6323 i‡(!
§c_ª∂y
 || src_ª∂y->
ty≥
 =
REDIS_REPLY_ERROR
) {

6324 i‡(
§c_ª∂y
 && src_ª∂y->
°r
Ë
ª∂y_îr
 = src_reply->str;

6325 
suc˚ss
 = 0;

6326 
˛ónup
;

6328 
	`as£π
(
§c_ª∂y
->
ty≥
 =
REDIS_REPLY_ARRAY
);

6329 
	`as£π
(
§c_ª∂y
->
ñemíts
 >= 2);

6330 
	`as£π
(
§c_ª∂y
->
ñemít
[1]->
ty≥
 =
REDIS_REPLY_ARRAY
);

6331 i‡(
§c_ª∂y
->
ñemít
[0]->
ty≥
 =
REDIS_REPLY_STRING
)

6332 
curs‹
 = 
	`©oi
(
§c_ª∂y
->
ñemít
[0]->
°r
);

6333 i‡(
§c_ª∂y
->
ñemít
[0]->
ty≥
 =
REDIS_REPLY_INTEGER
)

6334 
curs‹
 = 
§c_ª∂y
->
ñemít
[0]->
öãgî
;

6335 
keycou¡
 = 
§c_ª∂y
->
ñemít
[1]->
ñemíts
;

6336 
i
 = 0; i < 
keycou¡
; i++) {

6337 
ªdisRïly
 *
kr
 = 
§c_ª∂y
->
ñemít
[1]->ñemít[
i
];

6338 
	`as£π
(
kr
->
ty≥
 =
REDIS_REPLY_STRING
);

6339 *
key
 = 
kr
->
°r
;

6340 
uöt16_t
 
¶Ÿ
 = 
	`˛u°îM™agîKeyHashSlŸ
(
key
, 
kr
->
Àn
);

6341 
˛u°îM™agîNode
 *
èrgë
 = 
¶Ÿs_m≠
[
¶Ÿ
];

6342 
	`¥ötf
("Migøtög %†tÿ%s:%d: ", 
key
, 
èrgë
->
ù
,Å¨gë->
p‹t
);

6343 
ªdisRïly
 *
r
 = 
	`ªc⁄√˘ögRedisComm™d
(
§c_˘x
, 
cmdfmt
,

6344 
èrgë
->
ù
,Å¨gë->
p‹t
,

6345 
key
, 0, 
timeout
,

6347 i‡(!
r
 ||Ñ->
ty≥
 =
REDIS_REPLY_ERROR
) {

6348 i‡(
r
 &&Ñ->
°r
) {

6349 
	`˛u°îM™agîLogEº
("Source %s:%dÑeplied with "

6350 "îr‹:\n%s\n", 
§c_ù
, 
§c_p‹t
,

6351 
r
->
°r
);

6353 
suc˚ss
 = 0;

6355 
	`‰ìRïlyObje˘
(
r
);

6356 i‡(!
suc˚ss
Ë
˛ónup
;

6357 
	`˛u°îM™agîLogOk
("OK\n");

6360 
˛ónup
:

6361 i‡(
ª∂y_îr
)

6362 
	`˛u°îM™agîLogEº
("Source %s:%dÑeplied withÉrror:\n%s\n",

6363 
§c_ù
, 
§c_p‹t
, 
ª∂y_îr
);

6364 i‡(
§c_˘x
Ë
	`ªdisFªe
(src_ctx);

6365 i‡(
§c_ª∂y
Ë
	`‰ìRïlyObje˘
(src_reply);

6366  
suc˚ss
;

6367 
övÆid_¨gs
:

6368 
	`Ârötf
(
°dîr
, "%s", 
övÆid_¨gs_msg
);

6370 
	}
}

6372 
	$˛u°îM™agîComm™dCÆl
(
¨gc
, **
¨gv
) {

6373 
p‹t
 = 0, 
i
;

6374 *
ù
 = 
NULL
;

6375 i‡(!
	`gëClu°îHo°FromCmdArgs
(1, 
¨gv
, &
ù
, &
p‹t
)Ë
övÆid_¨gs
;

6376 
˛u°îM™agîNode
 *
ª‚ode
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

6377 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
ª‚ode
, 0))  0;

6378 
¨gc
--;

6379 
¨gv
++;

6380 
size_t
 *
¨gvÀn
 = 
	`zmÆloc
(
¨gc
*(size_t));

6381 
	`˛u°îM™agîLogInfo
(">>> Calling");

6382 
i
 = 0; i < 
¨gc
; i++) {

6383 
¨gvÀn
[
i
] = 
	`°æí
(
¨gv
[i]);

6384 
	`¥ötf
(" %s", 
¨gv
[
i
]);

6386 
	`¥ötf
("\n");

6387 
li°Iãr
 
li
;

6388 
li°Node
 *
 
;

6389 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

6390 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

6391 
˛u°îM™agîNode
 *
n
 = 
 
->
vÆue
;

6392 i‡(!
n
->
c⁄ãxt
 && !
	`˛u°îM™agîNodeC⁄√˘
(n)) ;

6393 
ªdisRïly
 *
ª∂y
 = 
NULL
;

6394 
	`ªdisAµídComm™dArgv
(
n
->
c⁄ãxt
, 
¨gc
, (c⁄° **Ë
¨gv
, 
¨gvÀn
);

6395 
°©us
 = 
	`ªdisGëRïly
(
n
->
c⁄ãxt
, (**)(&
ª∂y
));

6396 i‡(
°©us
 !
REDIS_OK
 || 
ª∂y
 =
NULL
 )

6397 
	`¥ötf
("%s:%d: Faûed!\n", 
n
->
ù
,Ç->
p‹t
);

6399 
sds
 
f‹m©ãd_ª∂y
 = 
	`˛iF‹m©RïlyRaw
(
ª∂y
);

6400 
	`¥ötf
("%s:%d: %s\n", 
n
->
ù
,Ç->
p‹t
, (*Ë
f‹m©ãd_ª∂y
);

6401 
	`sds‰ì
(
f‹m©ãd_ª∂y
);

6403 i‡(
ª∂y
 !
NULL
Ë
	`‰ìRïlyObje˘
(reply);

6405 
	`z‰ì
(
¨gvÀn
);

6407 
övÆid_¨gs
:

6408 
	`Ârötf
(
°dîr
, 
CLUSTER_MANAGER_INVALID_HOST_ARG
);

6410 
	}
}

6412 
	$˛u°îM™agîComm™dBackup
(
¨gc
, **
¨gv
) {

6413 
	`UNUSED
(
¨gc
);

6414 
suc˚ss
 = 1, 
p‹t
 = 0;

6415 *
ù
 = 
NULL
;

6416 i‡(!
	`gëClu°îHo°FromCmdArgs
(1, 
¨gv
, &
ù
, &
p‹t
)Ë
övÆid_¨gs
;

6417 
˛u°îM™agîNode
 *
ª‚ode
 = 
	`˛u°îM™agîNewNode
(
ù
, 
p‹t
);

6418 i‡(!
	`˛u°îM™agîLﬂdInfoFromNode
(
ª‚ode
, 0))  0;

6419 
no_issues
 = 
	`˛u°îM™agîCheckClu°î
(0);

6420 
˛u°î_îr‹s_cou¡
 = (
no_issues
 ? 0 :

6421 
	`li°Lígth
(
˛u°î_m™agî
.
îr‹s
));

6422 
c⁄fig
.
˛u°î_m™agî_comm™d
.
backup_dú
 = 
¨gv
[1];

6424 
sds
 
js⁄
 = 
	`sd¢ew
("[\n");

6425 
fú°_node
 = 0;

6426 
li°Iãr
 
li
;

6427 
li°Node
 *
 
;

6428 
	`li°Rewöd
(
˛u°î_m™agî
.
nodes
, &
li
);

6429 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

6430 i‡(!
fú°_node
) first_node = 1;

6431 
js⁄
 = 
	`sdsˇt
(json, ",\n");

6432 
˛u°îM™agîNode
 *
node
 = 
 
->
vÆue
;

6433 
sds
 
node_js⁄
 = 
	`˛u°îM™agîNodeGëJSON
(
node
, 
˛u°î_îr‹s_cou¡
);

6434 
js⁄
 = 
	`sdsˇt
(js⁄, 
node_js⁄
);

6435 
	`sds‰ì
(
node_js⁄
);

6436 i‡(
node
->
ª∂iˇã
)

6438 
	`˛u°îM™agîLogInfo
(">>> Node %s:%d -> Saving RDB...\n",

6439 
node
->
ù
,Çode->
p‹t
);

6440 
	`fÊush
(
°dout
);

6441 
	`gëRDB
(
node
);

6443 
js⁄
 = 
	`sdsˇt
(json, "\n]");

6444 
sds
 
js⁄∑th
 = 
	`sd¢ew
(
c⁄fig
.
˛u°î_m™agî_comm™d
.
backup_dú
);

6445 i‡(
js⁄∑th
[
	`sd¶í
(jsonpath) - 1] != '/')

6446 
js⁄∑th
 = 
	`sdsˇt
(jsonpath, "/");

6447 
js⁄∑th
 = 
	`sdsˇt
(jsonpath, "nodes.json");

6448 
	`fÊush
(
°dout
);

6449 
	`˛u°îM™agîLogInfo
("Savög clu°î c⁄figuøti⁄Åo: %s\n", 
js⁄∑th
);

6450 
FILE
 *
out
 = 
	`f›í
(
js⁄∑th
, "w+");

6451 i‡(!
out
) {

6452 
	`˛u°îM™agîLogEº
("CouldÇŸ savênode†to: %s\n", 
js⁄∑th
);

6453 
suc˚ss
 = 0;

6454 
˛ónup
;

6456 
	`Âuts
(
js⁄
, 
out
);

6457 
	`f˛o£
(
out
);

6458 
˛ónup
:

6459 
	`sds‰ì
(
js⁄
);

6460 
	`sds‰ì
(
js⁄∑th
);

6461 i‡(
suc˚ss
) {

6462 i‡(!
no_issues
) {

6463 
	`˛u°îM™agîLogW¨n
("*** Cluster seemsÅo have someÖroblems, "

6467 
	`˛u°îM™agîLogOk
("[OK] Backup created into: %s\n",

6468 
c⁄fig
.
˛u°î_m™agî_comm™d
.
backup_dú
);

6469 } 
	`˛u°îM™agîLogOk
("[ERR] FailedÅo back cluster!\n");

6470  
suc˚ss
;

6471 
övÆid_¨gs
:

6472 
	`Ârötf
(
°dîr
, 
CLUSTER_MANAGER_INVALID_HOST_ARG
);

6474 
	}
}

6476 
	$˛u°îM™agîComm™dHñp
(
¨gc
, **
¨gv
) {

6477 
	`UNUSED
(
¨gc
);

6478 
	`UNUSED
(
¨gv
);

6479 
comm™ds_cou¡
 = (
˛u°îM™agîComm™ds
) /

6480 (
˛u°îM™agîComm™dDef
);

6481 
i
 = 0, 
j
;

6482 
	`Ârötf
(
°dîr
, "Cluster Manager Commands:\n");

6483 
∑ddög
 = 15;

6484 ; 
i
 < 
comm™ds_cou¡
; i++) {

6485 
˛u°îM™agîComm™dDef
 *
def
 = &(
˛u°îM™agîComm™ds
[
i
]);

6486 
«mñí
 = 
	`°æí
(
def
->
«me
), 
∑dÀn
 = 
∑ddög
 -Çamelen;

6487 
	`Ârötf
(
°dîr
, " %s", 
def
->
«me
);

6488 
j
 = 0; j < 
∑dÀn
; j++Ë
	`Ârötf
(
°dîr
, " ");

6489 
	`Ârötf
(
°dîr
, "%s\n", (
def
->
¨gs
 ? def->args : ""));

6490 i‡(
def
->
›ti⁄s
 !
NULL
) {

6491 
›t¶í
 = 
	`°æí
(
def
->
›ti⁄s
);

6492 *
p
 = 
def
->
›ti⁄s
, *
eos
 =Ö + 
›t¶í
;

6493 *
comma
 = 
NULL
;

6494 (
comma
 = 
	`°rchr
(
p
, ',')Ë!
NULL
) {

6495 
deÊí
 = ()(
comma
 - 
p
);

6496 
buf
[255];

6497 
	`mem˝y
(
buf
, 
p
, 
deÊí
);

6498 
buf
[
deÊí
] = '\0';

6499 
j
 = 0; j < 
∑ddög
; j++Ë
	`Ârötf
(
°dîr
, " ");

6500 
	`Ârötf
(
°dîr
, " --˛u°î-%s\n", 
buf
);

6501 
p
 = 
comma
 + 1;

6502 i‡(
p
 >
eos
) ;

6504 i‡(
p
 < 
eos
) {

6505 
j
 = 0; j < 
∑ddög
; j++Ë
	`Ârötf
(
°dîr
, " ");

6506 
	`Ârötf
(
°dîr
, " --˛u°î-%s\n", 
p
);

6510 
	`Ârötf
(
°dîr
, "\nFor check, fix,Ñeshard, del-node, set-timeout you "

6514 
	}
}

6520 
	$œãncyModePröt
(
mö
, 
max
, 
avg
, 
cou¡
) {

6521 i‡(
c⁄fig
.
ouçut
 =
OUTPUT_STANDARD
) {

6522 
	`¥ötf
("min: %lld, max: %lld,ávg: %.2f (%lld samples)",

6523 
mö
, 
max
, 
avg
, 
cou¡
);

6524 
	`fÊush
(
°dout
);

6525 } i‡(
c⁄fig
.
ouçut
 =
OUTPUT_CSV
) {

6526 
	`¥ötf
("%Œd,%Œd,%.2f,%Œd\n", 
mö
, 
max
, 
avg
, 
cou¡
);

6527 } i‡(
c⁄fig
.
ouçut
 =
OUTPUT_RAW
) {

6528 
	`¥ötf
("%Œd %Œd %.2‡%Œd\n", 
mö
, 
max
, 
avg
, 
cou¡
);

6530 
	}
}

6532 
	#LATENCY_SAMPLE_RATE
 10

	)

6533 
	#LATENCY_HISTORY_DEFAULT_INTERVAL
 15000

	)

6534 
	$œãncyMode
() {

6535 
ªdisRïly
 *
ª∂y
;

6536 
°¨t
, 
œãncy
, 
mö
 = 0, 
max
 = 0, 
tŸ
 = 0, 
cou¡
 = 0;

6537 
hi°‹y_öãrvÆ
 =

6538 
c⁄fig
.
öãrvÆ
 ? config.interval/1000 :

6539 
LATENCY_HISTORY_DEFAULT_INTERVAL
;

6540 
avg
;

6541 
hi°‹y_°¨t
 = 
	`m°ime
();

6545 i‡(
c⁄fig
.
öãrvÆ
 == 0) {

6546 
c⁄fig
.
öãrvÆ
 = 1000;

6548 
c⁄fig
.
öãrvÆ
 /= 1000;

6551 i‡(!
c⁄ãxt
Ë
	`exô
(1);

6553 
°¨t
 = 
	`m°ime
();

6554 
ª∂y
 = 
	`ªc⁄√˘ögRedisComm™d
(
c⁄ãxt
,"PING");

6555 i‡(
ª∂y
 =
NULL
) {

6556 
	`Ârötf
(
°dîr
,"\nI/OÉrror\n");

6557 
	`exô
(1);

6559 
œãncy
 = 
	`m°ime
()-
°¨t
;

6560 
	`‰ìRïlyObje˘
(
ª∂y
);

6561 
cou¡
++;

6562 i‡(
cou¡
 == 1) {

6563 
mö
 = 
max
 = 
tŸ
 = 
œãncy
;

6564 
avg
 = (Ë
œãncy
;

6566 i‡(
œãncy
 < 
mö
) min =Üatency;

6567 i‡(
œãncy
 > 
max
) max =Üatency;

6568 
tŸ
 +
œãncy
;

6569 
avg
 = (Ë
tŸ
/
cou¡
;

6572 i‡(
c⁄fig
.
ouçut
 =
OUTPUT_STANDARD
) {

6573 
	`¥ötf
("\x1b[0G\x1b[2K");

6574 
	`œãncyModePröt
(
mö
,
max
,
avg
,
cou¡
);

6576 i‡(
c⁄fig
.
œãncy_hi°‹y
) {

6577 
	`œãncyModePröt
(
mö
,
max
,
avg
,
cou¡
);

6578 } i‡(
	`m°ime
()-
hi°‹y_°¨t
 > 
c⁄fig
.
öãrvÆ
) {

6579 
	`œãncyModePröt
(
mö
,
max
,
avg
,
cou¡
);

6580 
	`exô
(0);

6584 i‡(
c⁄fig
.
œãncy_hi°‹y
 && 
	`m°ime
()-
hi°‹y_°¨t
 > 
hi°‹y_öãrvÆ
)

6586 
	`¥ötf
(" -- %.2‡£c⁄d†ønge\n", ()(
	`m°ime
()-
hi°‹y_°¨t
)/1000);

6587 
hi°‹y_°¨t
 = 
	`m°ime
();

6588 
mö
 = 
max
 = 
tŸ
 = 
cou¡
 = 0;

6590 
	`u¶ìp
(
LATENCY_SAMPLE_RATE
 * 1000);

6592 
	}
}

6598 
	#LATENCY_DIST_DEFAULT_INTERVAL
 1000

	)

6601 
	sdi°ßm∂es
 {

6602 
	mmax
;

6603 
	mcou¡
;

6604 
	mch¨a˘î
;

6618 
	$showL©ícyDi°Sam∂es
(
di°ßm∂es
 *
ßm∂es
, 
tŸ
) {

6619 
j
;

6626 
	`¥ötf
("\033[38;5;0m");

6627 
j
 = 0; ; j++) {

6628 
cﬁ‹idx
 =

6629 
	`˚û
((Ë
ßm∂es
[
j
].
cou¡
 / 
tŸ
 * (
•e˘rum_∑Àâe_size
-1));

6630 
cﬁ‹
 = 
•e˘rum_∑Àâe
[
cﬁ‹idx
];

6631 
	`¥ötf
("\033[48;5;%dm%c", ()
cﬁ‹
, 
ßm∂es
[
j
].
ch¨a˘î
);

6632 
ßm∂es
[
j
].
cou¡
 = 0;

6633 i‡(
ßm∂es
[
j
].
max
 == 0) ;

6635 
	`¥ötf
("\033[0m\n");

6636 
	`fÊush
(
°dout
);

6637 
	}
}

6641 
	$showL©ícyDi°Legíd
() {

6642 
j
;

6644 
	`¥ötf
("---------------------------------------------\n");

6645 
	`¥ötf
(". - * # .01 .125 .25 .5 milliseconds\n");

6646 
	`¥ötf
("1,2,3,...,9 from 1Åo 9 milliseconds\n");

6647 
	`¥ötf
("A,B,C,D,E 10,20,30,40,50 milliseconds\n");

6648 
	`¥ötf
("F,G,H,I,J .1,.2,.3,.4,.5 seconds\n");

6649 
	`¥ötf
("K,L,M,N,O,P,Q,? 1,2,4,8,16,30,60,>60 seconds\n");

6650 
	`¥ötf
("From 0Åo 100%%: ");

6651 
j
 = 0; j < 
•e˘rum_∑Àâe_size
; j++) {

6652 
	`¥ötf
("\033[48;5;%dm ", 
•e˘rum_∑Àâe
[
j
]);

6654 
	`¥ötf
("\033[0m\n");

6655 
	`¥ötf
("---------------------------------------------\n");

6656 
	}
}

6658 
	$œãncyDi°Mode
() {

6659 
ªdisRïly
 *
ª∂y
;

6660 
°¨t
, 
œãncy
, 
cou¡
 = 0;

6661 
hi°‹y_öãrvÆ
 =

6662 
c⁄fig
.
öãrvÆ
 ? config.interval/1000 :

6663 
LATENCY_DIST_DEFAULT_INTERVAL
;

6664 
hi°‹y_°¨t
 = 
	`u°ime
();

6665 
j
, 
ouçuts
 = 0;

6667 
di°ßm∂es
 
ßm∂es
[] = {

6704 i‡(!
c⁄ãxt
Ë
	`exô
(1);

6706 
°¨t
 = 
	`u°ime
();

6707 
ª∂y
 = 
	`ªc⁄√˘ögRedisComm™d
(
c⁄ãxt
,"PING");

6708 i‡(
ª∂y
 =
NULL
) {

6709 
	`Ârötf
(
°dîr
,"\nI/OÉrror\n");

6710 
	`exô
(1);

6712 
œãncy
 = 
	`u°ime
()-
°¨t
;

6713 
	`‰ìRïlyObje˘
(
ª∂y
);

6714 
cou¡
++;

6717 
j
 = 0; ; j++) {

6718 i‡(
ßm∂es
[
j
].
max
 =0 || 
œãncy
 <= samples[j].max) {

6719 
ßm∂es
[
j
].
cou¡
++;

6725 i‡(
cou¡
 && (
	`u°ime
()-
hi°‹y_°¨t
)/1000 > 
hi°‹y_öãrvÆ
) {

6726 i‡((
ouçuts
++ % 20) == 0)

6727 
	`showL©ícyDi°Legíd
();

6728 
	`showL©ícyDi°Sam∂es
(
ßm∂es
,
cou¡
);

6729 
hi°‹y_°¨t
 = 
	`u°ime
();

6730 
cou¡
 = 0;

6732 
	`u¶ìp
(
LATENCY_SAMPLE_RATE
 * 1000);

6734 
	}
}

6740 
	#RDB_EOF_MARK_SIZE
 40

	)

6742 
	$£ndRïlc⁄f
(c⁄° * 
¨g1
, c⁄° * 
¨g2
) {

6743 
	`¥ötf
("£ndög REPLCONF %†%s\n", 
¨g1
, 
¨g2
);

6744 
ªdisRïly
 *
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
, "REPLCONF %†%s", 
¨g1
, 
¨g2
);

6747 if(
ª∂y
 =
NULL
) {

6748 
	`Ârötf
(
°dîr
, "\nI/OÉrror\n");

6749 
	`exô
(1);

6750 } if(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

6751 
	`Ârötf
(
°dîr
, "REPLCONF %†îr‹: %s\n", 
¨g1
, 
ª∂y
->
°r
);

6754 
	`‰ìRïlyObje˘
(
ª∂y
);

6755 
	}
}

6757 
	$£ndC≠a
() {

6758 
	`£ndRïlc⁄f
("capa", "eof");

6759 
	}
}

6764 
	$£ndSync
(
fd
, *
out_eof
) {

6769 
buf
[4096], *
p
;

6770 
ssize_t
 
ƒód
;

6773 i‡(
	`wrôe
(
fd
,"SYNC\r\n",6) != 6) {

6774 
	`Ârötf
(
°dîr
,"Error writingÅo master\n");

6775 
	`exô
(1);

6779 
p
 = 
buf
;

6781 
ƒód
 = 
	`ªad
(
fd
,
p
,1);

6782 i‡(
ƒód
 <= 0) {

6783 
	`Ârötf
(
°dîr
,"ErrorÑeading bulkÜength while SYNCing\n");

6784 
	`exô
(1);

6786 i‡(*
p
 ='\n' &&Ö !
buf
) ;

6787 i‡(*
p
 != '\n')Ö++;

6789 *
p
 = '\0';

6790 i‡(
buf
[0] == '-') {

6791 
	`¥ötf
("SYNC wôh ma°î faûed: %s\n", 
buf
);

6792 
	`exô
(1);

6794 i‡(
	`°∫cmp
(
buf
+1,"EOF:",4Ë=0 && 
	`°æí
(buf+5Ë>
RDB_EOF_MARK_SIZE
) {

6795 
	`mem˝y
(
out_eof
, 
buf
+5, 
RDB_EOF_MARK_SIZE
);

6798  
	`°πouŒ
(
buf
+1,
NULL
,10);

6799 
	}
}

6801 
	$¶aveMode
() {

6802 
fd
 = 
c⁄ãxt
->fd;

6803 
eofm¨k
[
RDB_EOF_MARK_SIZE
];

6804 
œ°byãs
[
RDB_EOF_MARK_SIZE
];

6805 
u£m¨k
 = 0;

6806 
∑ylﬂd
 = 
	`£ndSync
(
fd
, 
eofm¨k
);

6807 
buf
[1024];

6808 
‹igöÆ_ouçut
 = 
c⁄fig
.
ouçut
;

6810 i‡(
∑ylﬂd
 == 0) {

6811 
∑ylﬂd
 = 
ULLONG_MAX
;

6812 
	`mem£t
(
œ°byãs
,0,
RDB_EOF_MARK_SIZE
);

6813 
u£m¨k
 = 1;

6814 
	`Ârötf
(
°dîr
,"SYNC with master, discarding "

6817 
	`Ârötf
(
°dîr
,"SYNC with master, discarding %llu "

6818 "byã†o‡bulkÅøns„r...\n", 
∑ylﬂd
);

6823 
∑ylﬂd
) {

6824 
ssize_t
 
ƒód
;

6826 
ƒód
 = 
	`ªad
(
fd
,
buf
,(
∑ylﬂd
 > (buf)) ? (buf) :Öayload);

6827 i‡(
ƒód
 <= 0) {

6828 
	`Ârötf
(
°dîr
,"ErrorÑeading RDBÖayload while SYNCing\n");

6829 
	`exô
(1);

6831 
∑ylﬂd
 -
ƒód
;

6833 i‡(
u£m¨k
) {

6835 i‡(
ƒód
 >
RDB_EOF_MARK_SIZE
) {

6836 
	`mem˝y
(
œ°byãs
,
buf
+
ƒód
-
RDB_EOF_MARK_SIZE
,RDB_EOF_MARK_SIZE);

6838 
ªm
 = 
RDB_EOF_MARK_SIZE
-
ƒód
;

6839 
	`memmove
(
œ°byãs
,œ°byãs+
ƒód
,
ªm
);

6840 
	`mem˝y
(
œ°byãs
+
ªm
,
buf
,
ƒód
);

6842 i‡(
	`memcmp
(
œ°byãs
,
eofm¨k
,
RDB_EOF_MARK_SIZE
) == 0)

6847 i‡(
u£m¨k
) {

6848 
off£t
 = 
ULLONG_MAX
 - 
∑ylﬂd
;

6849 
	`Ârötf
(
°dîr
,"SYNC d⁄êa·î %Œu byãs. Loggög comm™d†‰om ma°î.\n", 
off£t
);

6851 
	`¶ìp
(1);

6852 
	`£ndRïlc⁄f
("ACK", "0");

6854 
	`Ârötf
(
°dîr
,"SYNC done. Logging commands from master.\n");

6857 
c⁄fig
.
ouçut
 = 
OUTPUT_CSV
;

6858 
	`˛iRódRïly
(0Ë=
REDIS_OK
);

6859 
c⁄fig
.
ouçut
 = 
‹igöÆ_ouçut
;

6860 
	}
}

6868 
	$gëRDB
(
˛u°îM™agîNode
 *
node
) {

6869 
s
, 
fd
;

6870 *
fûíame
;

6871 i‡(
node
 !
NULL
) {

6872 
	`as£π
(
node
->
c⁄ãxt
);

6873 
s
 = 
node
->
c⁄ãxt
->
fd
;

6874 
fûíame
 = 
	`˛u°îM™agîGëNodeRDBFûíame
(
node
);

6876 
s
 = 
c⁄ãxt
->
fd
;

6877 
fûíame
 = 
c⁄fig
.
rdb_fûíame
;

6879 
eofm¨k
[
RDB_EOF_MARK_SIZE
];

6880 
œ°byãs
[
RDB_EOF_MARK_SIZE
];

6881 
u£m¨k
 = 0;

6882 
∑ylﬂd
 = 
	`£ndSync
(
s
, 
eofm¨k
);

6883 
buf
[4096];

6885 i‡(
∑ylﬂd
 == 0) {

6886 
∑ylﬂd
 = 
ULLONG_MAX
;

6887 
	`mem£t
(
œ°byãs
,0,
RDB_EOF_MARK_SIZE
);

6888 
u£m¨k
 = 1;

6889 
	`Ârötf
(
°dîr
,"SYNC sentÅo master, writing bytes of bulkÅransfer "

6890 "u¡û EOF m¨kîÅÿ'%s'\n", 
fûíame
);

6892 
	`Ârötf
(
°dîr
,"SYNC sentÅo master, writing %llu bytesÅo '%s'\n",

6893 
∑ylﬂd
, 
fûíame
);

6897 i‡(!
	`°rcmp
(
fûíame
,"-")) {

6898 
fd
 = 
STDOUT_FILENO
;

6900 
fd
 = 
	`›í
(
fûíame
, 
O_CREAT
|
O_WRONLY
, 0644);

6901 i‡(
fd
 == -1) {

6902 
	`Ârötf
(
°dîr
, "Eº‹ o≥nög '%s': %s\n", 
fûíame
,

6903 
	`°ªº‹
(
î∫o
));

6904 
	`exô
(1);

6908 
∑ylﬂd
) {

6909 
ssize_t
 
ƒód
, 
nwrôãn
;

6911 
ƒód
 = 
	`ªad
(
s
,
buf
,(
∑ylﬂd
 > (buf)) ? (buf) :Öayload);

6912 i‡(
ƒód
 <= 0) {

6913 
	`Ârötf
(
°dîr
,"I/O ErrorÑeading RDBÖayload from socket\n");

6914 
	`exô
(1);

6916 
nwrôãn
 = 
	`wrôe
(
fd
, 
buf
, 
ƒód
);

6917 i‡(
nwrôãn
 !
ƒód
) {

6918 
	`Ârötf
(
°dîr
,"Error writing dataÅo file: %s\n",

6919 (
nwrôãn
 =-1Ë? 
	`°ªº‹
(
î∫o
) : "short write");

6920 
	`exô
(1);

6922 
∑ylﬂd
 -
ƒód
;

6924 i‡(
u£m¨k
) {

6926 i‡(
ƒód
 >
RDB_EOF_MARK_SIZE
) {

6927 
	`mem˝y
(
œ°byãs
,
buf
+
ƒód
-
RDB_EOF_MARK_SIZE
,RDB_EOF_MARK_SIZE);

6929 
ªm
 = 
RDB_EOF_MARK_SIZE
-
ƒód
;

6930 
	`memmove
(
œ°byãs
,œ°byãs+
ƒód
,
ªm
);

6931 
	`mem˝y
(
œ°byãs
+
ªm
,
buf
,
ƒód
);

6933 i‡(
	`memcmp
(
œ°byãs
,
eofm¨k
,
RDB_EOF_MARK_SIZE
) == 0)

6937 i‡(
u£m¨k
) {

6938 
∑ylﬂd
 = 
ULLONG_MAX
 -Öaylﬂd - 
RDB_EOF_MARK_SIZE
;

6939 i‡(
	`·runˇã
(
fd
, 
∑ylﬂd
) == -1)

6940 
	`Ârötf
(
°dîr
,"·runˇã faûed: %s.\n", 
	`°ªº‹
(
î∫o
));

6941 
	`Ârötf
(
°dîr
,"Tøns„∏föished wôh suc˚s†a·î %Œu byãs\n", 
∑ylﬂd
);

6943 
	`Ârötf
(
°dîr
,"Transfer finished with success.\n");

6945 
	`˛o£
(
s
);

6946 
	`fsync
(
fd
);

6947 
	`˛o£
(
fd
);

6948 
	`Ârötf
(
°dîr
,"Transfer finished with success.\n");

6949 i‡(
node
) {

6950 
	`sds‰ì
(
fûíame
);

6953 
	`exô
(0);

6954 
	}
}

6960 
	#PIPEMODE_WRITE_LOOP_MAX_BYTES
 (128*1024)

	)

6961 
	$pùeMode
() {

6962 
fd
 = 
c⁄ãxt
->fd;

6963 
îr‹s
 = 0, 
ª∂õs
 = 0, 
obuf_Àn
 = 0, 
obuf_pos
 = 0;

6964 
ibuf
[1024*16], 
obuf
[1024*16];

6965 
™ëîr
[
ANET_ERR_LEN
];

6966 
ªdisRódî
 *
ªadî
 = 
	`ªdisRódîCª©e
();

6967 
ªdisRïly
 *
ª∂y
;

6968 
eof
 = 0;

6969 
d⁄e
 = 0;

6970 
magic
[20];

6971 
time_t
 
œ°_ªad_time
 = 
	`time
(
NULL
);

6973 
	`§™d
(
	`time
(
NULL
));

6976 i‡(
	`™ëN⁄Block
(
™ëîr
,
fd
Ë=
ANET_ERR
) {

6977 
	`Ârötf
(
°dîr
, "Can't setÅhe socket inÇon blocking mode: %s\n",

6978 
™ëîr
);

6979 
	`exô
(1);

6984 !
d⁄e
) {

6985 
mask
 = 
AE_READABLE
;

6987 i‡(!
eof
 || 
obuf_Àn
 !0Ë
mask
 |
AE_WRITABLE
;

6988 
mask
 = 
	`´Waô
(
fd
,mask,1000);

6991 i‡(
mask
 & 
AE_READABLE
) {

6992 
ssize_t
 
ƒód
;

6993 
ªad_îr‹
 = 0;

6997 
ƒód
 = 
	`ªad
(
fd
,
ibuf
,(ibuf));

6998 i‡(
ƒód
 =-1 && 
î∫o
 !
EAGAIN
 &&Éºnÿ!
EINTR
) {

6999 
	`Ârötf
(
°dîr
, "ErrorÑeading fromÅhe server: %s\n",

7000 
	`°ªº‹
(
î∫o
));

7001 
ªad_îr‹
 = 1;

7004 i‡(
ƒód
 > 0) {

7005 
	`ªdisRódîFìd
(
ªadî
,
ibuf
,
ƒód
);

7006 
œ°_ªad_time
 = 
	`time
(
NULL
);

7008 } 
ƒód
 > 0);

7012 i‡(
	`ªdisRódîGëRïly
(
ªadî
,(**)&
ª∂y
Ë=
REDIS_ERR
) {

7013 
	`Ârötf
(
°dîr
, "ErrorÑeadingÑeplies from server\n");

7014 
	`exô
(1);

7016 i‡(
ª∂y
) {

7017 i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

7018 
	`Ârötf
(
°dîr
,"%s\n", 
ª∂y
->
°r
);

7019 
îr‹s
++;

7020 } i‡(
eof
 && 
ª∂y
->
ty≥
 =
REDIS_REPLY_STRING
 &&

7021 
ª∂y
->
Àn
 == 20) {

7025 i‡(
	`memcmp
(
ª∂y
->
°r
,
magic
,20) == 0) {

7026 
	`¥ötf
("LastÑeplyÑeceived from server.\n");

7027 
d⁄e
 = 1;

7028 
ª∂õs
--;

7031 
ª∂õs
++;

7032 
	`‰ìRïlyObje˘
(
ª∂y
);

7034 } 
ª∂y
);

7039 i‡(
ªad_îr‹
Ë
	`exô
(1);

7043 i‡(
mask
 & 
AE_WRITABLE
) {

7044 
ssize_t
 
lo›_nwrôãn
 = 0;

7048 i‡(
obuf_Àn
 != 0) {

7049 
ssize_t
 
nwrôãn
 = 
	`wrôe
(
fd
,
obuf
+
obuf_pos
,
obuf_Àn
);

7051 i‡(
nwrôãn
 == -1) {

7052 i‡(
î∫o
 !
EAGAIN
 &&Éºnÿ!
EINTR
) {

7053 
	`Ârötf
(
°dîr
, "Error writingÅoÅhe server: %s\n",

7054 
	`°ªº‹
(
î∫o
));

7055 
	`exô
(1);

7057 
nwrôãn
 = 0;

7060 
obuf_Àn
 -
nwrôãn
;

7061 
obuf_pos
 +
nwrôãn
;

7062 
lo›_nwrôãn
 +
nwrôãn
;

7063 i‡(
obuf_Àn
 != 0) ;

7066 i‡(
obuf_Àn
 =0 && !
eof
) {

7067 
ssize_t
 
ƒód
 = 
	`ªad
(
STDIN_FILENO
,
obuf
,(obuf));

7069 i‡(
ƒód
 == 0) {

7074 
echo
[] =

7076 
j
;

7078 
eof
 = 1;

7082 
j
 = 0; j < 20; j++)

7083 
magic
[
j
] = 
	`ønd
() & 0xff;

7084 
	`mem˝y
(
echo
+21,
magic
,20);

7085 
	`mem˝y
(
obuf
,
echo
,(echo)-1);

7086 
obuf_Àn
 = (
echo
)-1;

7087 
obuf_pos
 = 0;

7088 
	`¥ötf
("All dataÅransferred. Waiting forÅheÜastÑeply...\n");

7089 } i‡(
ƒód
 == -1) {

7090 
	`Ârötf
(
°dîr
, "ErrorÑeading from stdin: %s\n",

7091 
	`°ªº‹
(
î∫o
));

7092 
	`exô
(1);

7094 
obuf_Àn
 = 
ƒód
;

7095 
obuf_pos
 = 0;

7098 i‡((
obuf_Àn
 =0 && 
eof
) ||

7099 
lo›_nwrôãn
 > 
PIPEMODE_WRITE_LOOP_MAX_BYTES
) ;

7106 i‡(
eof
 && 
c⁄fig
.
pùe_timeout
 > 0 &&

7107 
	`time
(
NULL
)-
œ°_ªad_time
 > 
c⁄fig
.
pùe_timeout
)

7109 
	`Ârötf
(
°dîr
,"NoÑeplies for %d seconds:Éxiting.\n",

7110 
c⁄fig
.
pùe_timeout
);

7111 
îr‹s
++;

7115 
	`ªdisRódîFªe
(
ªadî
);

7116 
	`¥ötf
("îr‹s: %Œd,Ñïlõs: %Œd\n", 
îr‹s
, 
ª∂õs
);

7117 i‡(
îr‹s
)

7118 
	`exô
(1);

7120 
	`exô
(0);

7121 
	}
}

7127 
ªdisRïly
 *
	$£ndSˇn
(*
ô
) {

7128 
ªdisRïly
 *
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
, "SCAN %Œu", *
ô
);

7131 if(
ª∂y
 =
NULL
) {

7132 
	`Ârötf
(
°dîr
, "\nI/OÉrror\n");

7133 
	`exô
(1);

7134 } if(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

7135 
	`Ârötf
(
°dîr
, "SCANÉº‹: %s\n", 
ª∂y
->
°r
);

7136 
	`exô
(1);

7137 } if(
ª∂y
->
ty≥
 !
REDIS_REPLY_ARRAY
) {

7138 
	`Ârötf
(
°dîr
, "Non ARRAYÑesponse from SCAN!\n");

7139 
	`exô
(1);

7140 } if(
ª∂y
->
ñemíts
 != 2) {

7141 
	`Ârötf
(
°dîr
, "InvalidÉlement count from SCAN!\n");

7142 
	`exô
(1);

7146 
	`as£π
(
ª∂y
->
ñemít
[0]->
ty≥
 =
REDIS_REPLY_STRING
);

7147 
	`as£π
(
ª∂y
->
ñemít
[1]->
ty≥
 =
REDIS_REPLY_ARRAY
);

7150 *
ô
 = 
	`°πouŒ
(
ª∂y
->
ñemít
[0]->
°r
, 
NULL
, 10);

7152  
ª∂y
;

7153 
	}
}

7155 
	$gëDbSize
() {

7156 
ªdisRïly
 *
ª∂y
;

7157 
size
;

7159 
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
, "DBSIZE");

7161 if(
ª∂y
 =
NULL
 ||Ñïly->
ty≥
 !
REDIS_REPLY_INTEGER
) {

7162 
	`Ârötf
(
°dîr
, "Couldn't determine DBSIZE!\n");

7163 
	`exô
(1);

7167 
size
 = 
ª∂y
->
öãgî
;

7168 
	`‰ìRïlyObje˘
(
ª∂y
);

7170  
size
;

7171 
	}
}

7174 *
	m«me
;

7175 *
	msizecmd
;

7176 *
	msizeunô
;

7177 
	mbigge°
;

7178 
	mcou¡
;

7179 
	mtŸÆsize
;

7180 
sds
 
	mbigge°_key
;

7181 } 
	tty≥öfo
;

7183 
ty≥öfo
 
	gty≥_°rög
 = { "string", "STRLEN", "bytes" };

7184 
ty≥öfo
 
	gty≥_li°
 = { "list", "LLEN", "items" };

7185 
ty≥öfo
 
	gty≥_£t
 = { "set", "SCARD", "members" };

7186 
ty≥öfo
 
	gty≥_hash
 = { "hash", "HLEN", "fields" };

7187 
ty≥öfo
 
	gty≥_z£t
 = { "zset", "ZCARD", "members" };

7188 
ty≥öfo
 
	gty≥_°ªam
 = { "stream", "XLEN", "entries" };

7189 
ty≥öfo
 
	gty≥_Ÿhî
 = { "Ÿhî", 
NULL
, "?" };

7191 
ty≥öfo
* 
	$ty≥öfo_add
(
di˘
 *
ty≥s
, * 
«me
, 
ty≥öfo
* 
ty≥_ãm∂©e
) {

7192 
ty≥öfo
 *
öfo
 = 
	`zmÆloc
((typeinfo));

7193 *
öfo
 = *
ty≥_ãm∂©e
;

7194 
öfo
->
«me
 = 
	`sd¢ew
(name);

7195 
	`di˘Add
(
ty≥s
, 
öfo
->
«me
, info);

7196  
öfo
;

7197 
	}
}

7199 
	$ty≥_‰ì
(* 
¥iv_d©a
, * 
vÆ
) {

7200 
ty≥öfo
 *
öfo
 = 
vÆ
;

7201 
	`UNUSED
(
¥iv_d©a
);

7202 i‡(
öfo
->
bigge°_key
)

7203 
	`sds‰ì
(
öfo
->
bigge°_key
);

7204 
	`sds‰ì
(
öfo
->
«me
);

7205 
	`z‰ì
(
öfo
);

7206 
	}
}

7208 
di˘Ty≥
 
	gty≥öfoDi˘Ty≥
 = {

7209 
di˘SdsHash
,

7210 
NULL
,

7211 
NULL
,

7212 
di˘SdsKeyCom∑ª
,

7213 
NULL
,

7214 
ty≥_‰ì


7217 
	$gëKeyTy≥s
(
di˘
 *
ty≥s_di˘
, 
ªdisRïly
 *
keys
, 
ty≥öfo
 **
ty≥s
) {

7218 
ªdisRïly
 *
ª∂y
;

7219 
i
;

7222 
i
=0;i<
keys
->
ñemíts
;i++) {

7223 
	`ªdisAµídComm™d
(
c⁄ãxt
, "TYPE %s", 
keys
->
ñemít
[
i
]->
°r
);

7227 
i
=0;i<
keys
->
ñemíts
;i++) {

7228 if(
	`ªdisGëRïly
(
c⁄ãxt
, (**)&
ª∂y
)!=
REDIS_OK
) {

7229 
	`Ârötf
(
°dîr
, "Error gettingÅype for key '%s' (%d: %s)\n",

7230 
keys
->
ñemít
[
i
]->
°r
, 
c⁄ãxt
->
îr
, c⁄ãxt->
îr°r
);

7231 
	`exô
(1);

7232 } if(
ª∂y
->
ty≥
 !
REDIS_REPLY_STATUS
) {

7233 if(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

7234 
	`Ârötf
(
°dîr
, "TYPEÑëu∫edá¿îr‹: %s\n", 
ª∂y
->
°r
);

7236 
	`Ârötf
(
°dîr
,

7238 
ª∂y
->
ty≥
, 
keys
->
ñemít
[
i
]->
°r
);

7240 
	`exô
(1);

7243 
sds
 
ty≥ª∂y
 = 
	`sd¢ew
(
ª∂y
->
°r
);

7244 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
ty≥s_di˘
, 
ty≥ª∂y
);

7245 
	`sds‰ì
(
ty≥ª∂y
);

7246 
ty≥öfo
 *
ty≥
 = 
NULL
;

7247 i‡(
de
)

7248 
ty≥
 = 
	`di˘GëVÆ
(
de
);

7249 i‡(
	`°rcmp
(
ª∂y
->
°r
, "none"))

7250 
ty≥
 = 
	`ty≥öfo_add
(
ty≥s_di˘
, 
ª∂y
->
°r
, &
ty≥_Ÿhî
);

7251 
ty≥s
[
i
] = 
ty≥
;

7252 
	`‰ìRïlyObje˘
(
ª∂y
);

7254 
	}
}

7256 
	$gëKeySizes
(
ªdisRïly
 *
keys
, 
ty≥öfo
 **
ty≥s
,

7257 *
sizes
, 
memkeys
,

7258 
memkeys_ßm∂es
)

7260 
ªdisRïly
 *
ª∂y
;

7261 
i
;

7264 
i
=0;i<
keys
->
ñemíts
;i++) {

7266 if(!
ty≥s
[
i
] || (!ty≥s[i]->
sizecmd
 && !
memkeys
))

7269 i‡(!
memkeys
)

7270 
	`ªdisAµídComm™d
(
c⁄ãxt
, "%s %s",

7271 
ty≥s
[
i
]->
sizecmd
, 
keys
->
ñemít
[i]->
°r
);

7272 i‡(
memkeys_ßm∂es
==0)

7273 
	`ªdisAµídComm™d
(
c⁄ãxt
, "%s %s %s",

7274 "MEMORY", "USAGE", 
keys
->
ñemít
[
i
]->
°r
);

7276 
	`ªdisAµídComm™d
(
c⁄ãxt
, "%s %s %s SAMPLES %u",

7277 "MEMORY", "USAGE", 
keys
->
ñemít
[
i
]->
°r
, 
memkeys_ßm∂es
);

7281 
i
=0;i<
keys
->
ñemíts
;i++) {

7283 if(!
ty≥s
[
i
] || (!ty≥s[i]->
sizecmd
 && !
memkeys
)) {

7284 
sizes
[
i
] = 0;

7289 if(
	`ªdisGëRïly
(
c⁄ãxt
, (**)&
ª∂y
)!=
REDIS_OK
) {

7290 
	`Ârötf
(
°dîr
, "Error getting size for key '%s' (%d: %s)\n",

7291 
keys
->
ñemít
[
i
]->
°r
, 
c⁄ãxt
->
îr
, c⁄ãxt->
îr°r
);

7292 
	`exô
(1);

7293 } if(
ª∂y
->
ty≥
 !
REDIS_REPLY_INTEGER
) {

7296 
	`Ârötf
(
°dîr
,

7298 !
memkeys
? 
ty≥s
[
i
]->
sizecmd
: "MEMORY USAGE",

7299 
keys
->
ñemít
[
i
]->
°r
);

7300 
sizes
[
i
] = 0;

7302 
sizes
[
i
] = 
ª∂y
->
öãgî
;

7305 
	`‰ìRïlyObje˘
(
ª∂y
);

7307 
	}
}

7309 
	$födBigKeys
(
memkeys
, 
memkeys_ßm∂es
) {

7310 
ßm∂ed
 = 0, 
tŸÆ_keys
, 
tŸÀn
=0, *
sizes
=
NULL
, 
ô
=0;

7311 
ªdisRïly
 *
ª∂y
, *
keys
;

7312 
¨rsize
=0, 
i
;

7313 
di˘Iãøt‹
 *
di
;

7314 
di˘E¡ry
 *
de
;

7315 
ty≥öfo
 **
ty≥s
 = 
NULL
;

7316 
p˘
;

7318 
di˘
 *
ty≥s_di˘
 = 
	`di˘Cª©e
(&
ty≥öfoDi˘Ty≥
, 
NULL
);

7319 
	`ty≥öfo_add
(
ty≥s_di˘
, "°rög", &
ty≥_°rög
);

7320 
	`ty≥öfo_add
(
ty≥s_di˘
, "li°", &
ty≥_li°
);

7321 
	`ty≥öfo_add
(
ty≥s_di˘
, "£t", &
ty≥_£t
);

7322 
	`ty≥öfo_add
(
ty≥s_di˘
, "hash", &
ty≥_hash
);

7323 
	`ty≥öfo_add
(
ty≥s_di˘
, "z£t", &
ty≥_z£t
);

7324 
	`ty≥öfo_add
(
ty≥s_di˘
, "°ªam", &
ty≥_°ªam
);

7327 
tŸÆ_keys
 = 
	`gëDbSize
();

7330 
	`¥ötf
("\n# ScanningÅheÉntire keyspaceÅo find biggest keysás wellás\n");

7331 
	`¥ötf
("#áverage sizesÖer keyÅype. You can use -i 0.1Åo sleep 0.1 sec\n");

7332 
	`¥ötf
("#Öer 100 SCAN commands (not usuallyÇeeded).\n\n");

7337 
p˘
 = 100 * ()
ßm∂ed
/
tŸÆ_keys
;

7340 
ª∂y
 = 
	`£ndSˇn
(&
ô
);

7341 
keys
 = 
ª∂y
->
ñemít
[1];

7344 if(
keys
->
ñemíts
 > 
¨rsize
) {

7345 
ty≥s
 = 
	`zªÆloc
—y≥s, (
ty≥öfo
*)*
keys
->
ñemíts
);

7346 
sizes
 = 
	`zªÆloc
(sizes, ()*
keys
->
ñemíts
);

7348 if(!
ty≥s
 || !
sizes
) {

7349 
	`Ârötf
(
°dîr
, "FailedÅoállocate storage for keys!\n");

7350 
	`exô
(1);

7353 
¨rsize
 = 
keys
->
ñemíts
;

7357 
	`gëKeyTy≥s
(
ty≥s_di˘
, 
keys
, 
ty≥s
);

7358 
	`gëKeySizes
(
keys
, 
ty≥s
, 
sizes
, 
memkeys
, 
memkeys_ßm∂es
);

7361 
i
=0;i<
keys
->
ñemíts
;i++) {

7362 
ty≥öfo
 *
ty≥
 = 
ty≥s
[
i
];

7364 if(!
ty≥
)

7367 
ty≥
->
tŸÆsize
 +
sizes
[
i
];

7368 
ty≥
->
cou¡
++;

7369 
tŸÀn
 +
keys
->
ñemít
[
i
]->
Àn
;

7370 
ßm∂ed
++;

7372 if(
ty≥
->
bigge°
<
sizes
[
i
]) {

7373 
	`¥ötf
(

7375 
p˘
, 
ty≥
->
«me
, 
keys
->
ñemít
[
i
]->
°r
, 
sizes
[i],

7376 !
memkeys
? 
ty≥
->
sizeunô
: "bytes");

7379 i‡(
ty≥
->
bigge°_key
)

7380 
	`sds‰ì
(
ty≥
->
bigge°_key
);

7381 
ty≥
->
bigge°_key
 = 
	`sd¢ew
(
keys
->
ñemít
[
i
]->
°r
);

7382 if(!
ty≥
->
bigge°_key
) {

7383 
	`Ârötf
(
°dîr
, "FailedÅoállocate memory for key!\n");

7384 
	`exô
(1);

7388 
ty≥
->
bigge°
 = 
sizes
[
i
];

7392 if(
ßm∂ed
 % 1000000 == 0) {

7393 
	`¥ötf
("[%05.2f%%] Sam∂ed %Œu key†sÿÁr\n", 
p˘
, 
ßm∂ed
);

7398 if(
ßm∂ed
 && (ßm∂ed %100Ë=0 && 
c⁄fig
.
öãrvÆ
) {

7399 
	`u¶ìp
(
c⁄fig
.
öãrvÆ
);

7402 
	`‰ìRïlyObje˘
(
ª∂y
);

7403 } 
ô
 != 0);

7405 if(
ty≥s
Ë
	`z‰ì
(types);

7406 if(
sizes
Ë
	`z‰ì
(sizes);

7409 
	`¥ötf
("\n-------- summary -------\n\n");

7411 
	`¥ötf
("Sam∂ed %Œu key†öÅhêkey•a˚!\n", 
ßm∂ed
);

7412 
	`¥ötf
("Total keyÜength in bytes is %llu (avgÜen %.2f)\n\n",

7413 
tŸÀn
,ÅŸÀ¿? (ÈŸÀn/
ßm∂ed
 : 0);

7416 
di
 = 
	`di˘GëIãøt‹
(
ty≥s_di˘
);

7417 (
de
 = 
	`di˘Next
(
di
))) {

7418 
ty≥öfo
 *
ty≥
 = 
	`di˘GëVÆ
(
de
);

7419 if(
ty≥
->
bigge°_key
) {

7420 
	`¥ötf
("Bigge° %6†found '%s' ha†%Œu %s\n", 
ty≥
->
«me
,Åy≥->
bigge°_key
,

7421 
ty≥
->
bigge°
, !
memkeys
?Åy≥->
sizeunô
: "bytes");

7424 
	`di˘Rñó£Iãøt‹
(
di
);

7426 
	`¥ötf
("\n");

7428 
di
 = 
	`di˘GëIãøt‹
(
ty≥s_di˘
);

7429 (
de
 = 
	`di˘Next
(
di
))) {

7430 
ty≥öfo
 *
ty≥
 = 
	`di˘GëVÆ
(
de
);

7431 
	`¥ötf
("%llu %ss with %llu %s (%05.2f%% of keys,ávg size %.2f)\n",

7432 
ty≥
->
cou¡
,Åy≥->
«me
,Åy≥->
tŸÆsize
, !
memkeys
?Åy≥->
sizeunô
: "bytes",

7433 
ßm∂ed
 ? 100 * ()
ty≥
->
cou¡
/sampled : 0,

7434 
ty≥
->
cou¡
 ? (Èy≥->
tŸÆsize
/type->count : 0);

7436 
	`di˘Rñó£Iãøt‹
(
di
);

7438 
	`di˘Rñó£
(
ty≥s_di˘
);

7441 
	`exô
(0);

7442 
	}
}

7444 
	$gëKeyFªqs
(
ªdisRïly
 *
keys
, *
‰eqs
) {

7445 
ªdisRïly
 *
ª∂y
;

7446 
i
;

7449 
i
=0;i<
keys
->
ñemíts
;i++) {

7450 
	`ªdisAµídComm™d
(
c⁄ãxt
, "OBJECT fªq %s", 
keys
->
ñemít
[
i
]->
°r
);

7454 
i
=0;i<
keys
->
ñemíts
;i++) {

7455 if(
	`ªdisGëRïly
(
c⁄ãxt
, (**)&
ª∂y
)!=
REDIS_OK
) {

7456 
	`Ârötf
(
°dîr
, "Error getting freq for key '%s' (%d: %s)\n",

7457 
keys
->
ñemít
[
i
]->
°r
, 
c⁄ãxt
->
îr
, c⁄ãxt->
îr°r
);

7458 
	`exô
(1);

7459 } if(
ª∂y
->
ty≥
 !
REDIS_REPLY_INTEGER
) {

7460 if(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

7461 
	`Ârötf
(
°dîr
, "Eº‹: %s\n", 
ª∂y
->
°r
);

7462 
	`exô
(1);

7464 
	`Ârötf
(
°dîr
, "W¨nög: OBJECT fªq o¿'%s' faûed (may havêbì¿dñëed)\n", 
keys
->
ñemít
[
i
]->
°r
);

7465 
‰eqs
[
i
] = 0;

7468 
‰eqs
[
i
] = 
ª∂y
->
öãgî
;

7470 
	`‰ìRïlyObje˘
(
ª∂y
);

7472 
	}
}

7474 
	#HOTKEYS_SAMPLE
 16

	)

7475 
	$födHŸKeys
() {

7476 
ªdisRïly
 *
keys
, *
ª∂y
;

7477 
cou¡îs
[
HOTKEYS_SAMPLE
] = {0};

7478 
sds
 
hŸkeys
[
HOTKEYS_SAMPLE
] = {
NULL
};

7479 
ßm∂ed
 = 0, 
tŸÆ_keys
, *
‰eqs
 = 
NULL
, 
ô
 = 0;

7480 
¨rsize
 = 0, 
i
, 
k
;

7481 
p˘
;

7484 
tŸÆ_keys
 = 
	`gëDbSize
();

7487 
	`¥ötf
("\n# ScanningÅheÉntire keyspaceÅo find hot keysás wellás\n");

7488 
	`¥ötf
("#áverage sizesÖer keyÅype. You can use -i 0.1Åo sleep 0.1 sec\n");

7489 
	`¥ötf
("#Öer 100 SCAN commands (not usuallyÇeeded).\n\n");

7494 
p˘
 = 100 * ()
ßm∂ed
/
tŸÆ_keys
;

7497 
ª∂y
 = 
	`£ndSˇn
(&
ô
);

7498 
keys
 = 
ª∂y
->
ñemít
[1];

7501 if(
keys
->
ñemíts
 > 
¨rsize
) {

7502 
‰eqs
 = 
	`zªÆloc
(‰eqs, ()*
keys
->
ñemíts
);

7504 if(!
‰eqs
) {

7505 
	`Ârötf
(
°dîr
, "FailedÅoállocate storage for keys!\n");

7506 
	`exô
(1);

7509 
¨rsize
 = 
keys
->
ñemíts
;

7512 
	`gëKeyFªqs
(
keys
, 
‰eqs
);

7515 
i
=0;i<
keys
->
ñemíts
;i++) {

7516 
ßm∂ed
++;

7518 if(
ßm∂ed
 % 1000000 == 0) {

7519 
	`¥ötf
("[%05.2f%%] Sam∂ed %Œu key†sÿÁr\n", 
p˘
, 
ßm∂ed
);

7523 
k
 = 0;

7524 
k
 < 
HOTKEYS_SAMPLE
 && 
‰eqs
[
i
] > 
cou¡îs
[k]) k++;

7525 i‡(
k
 == 0) ;

7526 
k
--;

7527 i‡(
k
 =0 || 
cou¡îs
[k] == 0) {

7528 
	`sds‰ì
(
hŸkeys
[
k
]);

7530 
	`sds‰ì
(
hŸkeys
[0]);

7531 
	`memmove
(
cou¡îs
,cou¡îs+1,(cou¡îs[0])*
k
);

7532 
	`memmove
(
hŸkeys
,hŸkeys+1,(hŸkeys[0])*
k
);

7534 
cou¡îs
[
k
] = 
‰eqs
[
i
];

7535 
hŸkeys
[
k
] = 
	`sd¢ew
(
keys
->
ñemít
[
i
]->
°r
);

7536 
	`¥ötf
(

7538 
p˘
, 
keys
->
ñemít
[
i
]->
°r
, 
‰eqs
[i]);

7542 if(
ßm∂ed
 && (ßm∂ed %100Ë=0 && 
c⁄fig
.
öãrvÆ
) {

7543 
	`u¶ìp
(
c⁄fig
.
öãrvÆ
);

7546 
	`‰ìRïlyObje˘
(
ª∂y
);

7547 } 
ô
 != 0);

7549 i‡(
‰eqs
Ë
	`z‰ì
(freqs);

7552 
	`¥ötf
("\n-------- summary -------\n\n");

7554 
	`¥ötf
("Sam∂ed %Œu key†öÅhêkey•a˚!\n", 
ßm∂ed
);

7556 
i
=1; i<
HOTKEYS_SAMPLE
; i++) {

7557 
k
 = 
HOTKEYS_SAMPLE
 - 
i
;

7558 if(
cou¡îs
[
k
]>0) {

7559 
	`¥ötf
("hŸ key found wôh cou¡î: %Œu\tkey«me: %s\n", 
cou¡îs
[
k
], 
hŸkeys
[k]);

7560 
	`sds‰ì
(
hŸkeys
[
k
]);

7564 
	`exô
(0);

7565 
	}
}

7574 *
	$gëInfoFõld
(*
öfo
, *
fõld
) {

7575 *
p
 = 
	`°r°r
(
öfo
,
fõld
);

7576 *
n1
, *
n2
;

7577 *
ªsu…
;

7579 i‡(!
p
Ë 
NULL
;

7580 
p
 +
	`°æí
(
fõld
)+1;

7581 
n1
 = 
	`°rchr
(
p
,'\r');

7582 
n2
 = 
	`°rchr
(
p
,',');

7583 i‡(
n2
 &&Ç2 < 
n1
)Ç1 =Ç2;

7584 
ªsu…
 = 
	`zmÆloc
(()*(
n1
-
p
)+1);

7585 
	`mem˝y
(
ªsu…
,
p
,(
n1
-p));

7586 
ªsu…
[
n1
-
p
] = '\0';

7587  
ªsu…
;

7588 
	}
}

7592 
	$gëL⁄gInfoFõld
(*
öfo
, *
fõld
) {

7593 *
vÆue
 = 
	`gëInfoFõld
(
öfo
,
fõld
);

7594 
l
;

7596 i‡(!
vÆue
Ë 
LONG_MIN
;

7597 
l
 = 
	`°πﬁ
(
vÆue
,
NULL
,10);

7598 
	`z‰ì
(
vÆue
);

7599  
l
;

7600 
	}
}

7604 
	$byãsToHum™
(*
s
, 
n
) {

7605 
d
;

7607 i‡(
n
 < 0) {

7608 *
s
 = '-';

7609 
s
++;

7610 
n
 = -n;

7612 i‡(
n
 < 1024) {

7614 
	`•rötf
(
s
,"%ŒdB",
n
);

7616 } i‡(
n
 < (1024*1024)) {

7617 
d
 = ()
n
/(1024);

7618 
	`•rötf
(
s
,"%.2fK",
d
);

7619 } i‡(
n
 < (1024LL*1024*1024)) {

7620 
d
 = ()
n
/(1024*1024);

7621 
	`•rötf
(
s
,"%.2fM",
d
);

7622 } i‡(
n
 < (1024LL*1024*1024*1024)) {

7623 
d
 = ()
n
/(1024LL*1024*1024);

7624 
	`•rötf
(
s
,"%.2fG",
d
);

7626 
	}
}

7628 
	$°©Mode
() {

7629 
ªdisRïly
 *
ª∂y
;

7630 
aux
, 
ªque°s
 = 0;

7631 
i
 = 0;

7634 
buf
[64];

7635 
j
;

7637 
ª∂y
 = 
	`ªc⁄√˘ögRedisComm™d
(
c⁄ãxt
,"INFO");

7638 i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

7639 
	`¥ötf
("ERROR: %s\n", 
ª∂y
->
°r
);

7640 
	`exô
(1);

7643 i‡((
i
++ % 20) == 0) {

7644 
	`¥ötf
(

7650 
aux
 = 0;

7651 
j
 = 0; j < 20; j++) {

7652 
k
;

7654 
	`•rötf
(
buf
,"db%d:keys",
j
);

7655 
k
 = 
	`gëL⁄gInfoFõld
(
ª∂y
->
°r
,
buf
);

7656 i‡(
k
 =
LONG_MIN
) ;

7657 
aux
 +
k
;

7659 
	`•rötf
(
buf
,"%ld",
aux
);

7660 
	`¥ötf
("%-11s",
buf
);

7663 
aux
 = 
	`gëL⁄gInfoFõld
(
ª∂y
->
°r
,"used_memory");

7664 
	`byãsToHum™
(
buf
,
aux
);

7665 
	`¥ötf
("%-8s",
buf
);

7668 
aux
 = 
	`gëL⁄gInfoFõld
(
ª∂y
->
°r
,"connected_clients");

7669 
	`•rötf
(
buf
,"%ld",
aux
);

7670 
	`¥ötf
(" %-8s",
buf
);

7673 
aux
 = 
	`gëL⁄gInfoFõld
(
ª∂y
->
°r
,"blocked_clients");

7674 
	`•rötf
(
buf
,"%ld",
aux
);

7675 
	`¥ötf
("%-8s",
buf
);

7678 
aux
 = 
	`gëL⁄gInfoFõld
(
ª∂y
->
°r
,"total_commands_processed");

7679 
	`•rötf
(
buf
,"%ld (+%ld)",
aux
,
ªque°s
 == 0 ? 0 :áux-requests);

7680 
	`¥ötf
("%-19s",
buf
);

7681 
ªque°s
 = 
aux
;

7684 
aux
 = 
	`gëL⁄gInfoFõld
(
ª∂y
->
°r
,"total_connections_received");

7685 
	`•rötf
(
buf
,"%ld",
aux
);

7686 
	`¥ötf
(" %-12s",
buf
);

7689 
aux
 = 
	`gëL⁄gInfoFõld
(
ª∂y
->
°r
,"bgsave_in_progress");

7690 
aux
 |
	`gëL⁄gInfoFõld
(
ª∂y
->
°r
,"aof_rewrite_in_progress") << 1;

7691 
aux
 |
	`gëL⁄gInfoFõld
(
ª∂y
->
°r
,"loading") << 2;

7692 
aux
) {

7695 
	`¥ötf
("SAVE");

7698 
	`¥ötf
("AOF");

7701 
	`¥ötf
("SAVE+AOF");

7704 
	`¥ötf
("LOAD");

7708 
	`¥ötf
("\n");

7709 
	`‰ìRïlyObje˘
(
ª∂y
);

7710 
	`u¶ìp
(
c⁄fig
.
öãrvÆ
);

7712 
	}
}

7718 
	$sˇnMode
() {

7719 
ªdisRïly
 *
ª∂y
;

7720 
cur
 = 0;

7723 i‡(
c⁄fig
.
∑âîn
)

7724 
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
,"SCAN %llu MATCH %s",

7725 
cur
,
c⁄fig
.
∑âîn
);

7727 
ª∂y
 = 
	`ªdisComm™d
(
c⁄ãxt
,"SCAN %Œu",
cur
);

7728 i‡(
ª∂y
 =
NULL
) {

7729 
	`¥ötf
("I/OÉrror\n");

7730 
	`exô
(1);

7731 } i‡(
ª∂y
->
ty≥
 =
REDIS_REPLY_ERROR
) {

7732 
	`¥ötf
("ERROR: %s\n", 
ª∂y
->
°r
);

7733 
	`exô
(1);

7735 
j
;

7737 
cur
 = 
	`°πouŒ
(
ª∂y
->
ñemít
[0]->
°r
,
NULL
,10);

7738 
j
 = 0; j < 
ª∂y
->
ñemít
[1]->
ñemíts
; j++)

7739 
	`¥ötf
("%s\n", 
ª∂y
->
ñemít
[1]->ñemít[
j
]->
°r
);

7741 
	`‰ìRïlyObje˘
(
ª∂y
);

7742 } 
cur
 != 0);

7744 
	`exô
(0);

7745 
	}
}

7757 
	$powîLawR™d
(
mö
, 
max
, 
Æpha
) {

7758 
∂
, 
r
;

7760 
max
 += 1;

7761 
r
 = (()
	`ønd
()Ë/ 
RAND_MAX
;

7762 
∂
 = 
	`pow
(

7763 ((
	`pow
(
max
,
Æpha
+1Ë-Öow(
mö
,Æpha+1))*
r
 +Öow(min,alpha+1)),

7764 (1.0/(
Æpha
+1)));

7765  (
max
-1-()
∂
)+
mö
;

7766 
	}
}

7770 
	$LRUTe°GíKey
(*
buf
, 
size_t
 
buÊí
) {

7771 
	`¢¥ötf
(
buf
, 
buÊí
, "lru:%lld",

7772 
	`powîLawR™d
(1, 
c⁄fig
.
Ãu_ã°_ßm∂e_size
, 6.2));

7773 
	}
}

7775 
	#LRU_CYCLE_PERIOD
 1000

	)

7776 
	#LRU_CYCLE_PIPELINE_SIZE
 250

	)

7777 
	$LRUTe°Mode
() {

7778 
ªdisRïly
 *
ª∂y
;

7779 
key
[128];

7780 
°¨t_cy˛e
;

7781 
j
;

7783 
	`§™d
(
	`time
(
NULL
)^
	`gëpid
());

7788 
°¨t_cy˛e
 = 
	`m°ime
();

7789 
hôs
 = 0, 
mis£s
 = 0;

7790 
	`m°ime
(Ë- 
°¨t_cy˛e
 < 
LRU_CYCLE_PERIOD
) {

7792 
j
 = 0; j < 
LRU_CYCLE_PIPELINE_SIZE
; j++) {

7793 
vÆ
[6];

7794 
vÆ
[5] = '\0';

7795 
i
 = 0; i < 5; i++Ë
vÆ
[i] = 'A'+
	`ønd
()%('z'-'A');

7796 
	`LRUTe°GíKey
(
key
,(key));

7797 
	`ªdisAµídComm™d
(
c⁄ãxt
, "SET %†%s",
key
,
vÆ
);

7799 
j
 = 0; j < 
LRU_CYCLE_PIPELINE_SIZE
; j++)

7800 
	`ªdisGëRïly
(
c⁄ãxt
, (**)&
ª∂y
);

7803 
j
 = 0; j < 
LRU_CYCLE_PIPELINE_SIZE
; j++) {

7804 
	`LRUTe°GíKey
(
key
,(key));

7805 
	`ªdisAµídComm™d
(
c⁄ãxt
, "GET %s",
key
);

7807 
j
 = 0; j < 
LRU_CYCLE_PIPELINE_SIZE
; j++) {

7808 i‡(
	`ªdisGëRïly
(
c⁄ãxt
, (**)&
ª∂y
Ë=
REDIS_OK
) {

7809 
ª∂y
->
ty≥
) {

7810 
REDIS_REPLY_ERROR
:

7811 
	`¥ötf
("%s\n", 
ª∂y
->
°r
);

7813 
REDIS_REPLY_NIL
:

7814 
mis£s
++;

7817 
hôs
++;

7823 i‡(
c⁄ãxt
->
îr
) {

7824 
	`Ârötf
(
°dîr
,"I/OÉrror during LRUÅest\n");

7825 
	`exô
(1);

7829 
	`¥ötf
(

7831 
hôs
+
mis£s
,

7832 
hôs
, ()hôs/(hôs+
mis£s
)*100,

7833 
mis£s
, ()mis£s/(
hôs
+misses)*100);

7835 
	`exô
(0);

7836 
	}
}

7849 
	$compuã_somëhög_Á°
() {

7850 
s
[256], 
i
, 
j
, 
t
;

7851 
cou¡
 = 1000, 
k
;

7852 
ouçut
 = 0;

7854 
k
 = 0; k < 256; k++Ë
s
[k] = k;

7856 
i
 = 0;

7857 
j
 = 0;

7858 
cou¡
--) {

7859 
i
++;

7860 
j
 = j + 
s
[
i
];

7861 
t
 = 
s
[
i
];

7862 
s
[
i
] = s[
j
];

7863 
s
[
j
] = 
t
;

7864 
ouçut
 +
s
[(s[
i
]+s[
j
])&255];

7866  
ouçut
;

7867 
	}
}

7869 
	$öåösicL©ícyModeSt›
(
s
) {

7870 
	`UNUSED
(
s
);

7871 
f‹˚_ˇn˚l_lo›
 = 1;

7872 
	}
}

7874 
	$öåösicL©ícyMode
() {

7875 
ã°_íd
, 
run_time
, 
max_œãncy
 = 0, 
runs
 = 0;

7877 
run_time
 = 
c⁄fig
.
öåösic_œãncy_duøti⁄
*1000000;

7878 
ã°_íd
 = 
	`u°ime
(Ë+ 
run_time
;

7879 
	`sig«l
(
SIGINT
, 
öåösicL©ícyModeSt›
);

7882 
°¨t
, 
íd
, 
œãncy
;

7884 
°¨t
 = 
	`u°ime
();

7885 
	`compuã_somëhög_Á°
();

7886 
íd
 = 
	`u°ime
();

7887 
œãncy
 = 
íd
-
°¨t
;

7888 
runs
++;

7889 i‡(
œãncy
 <= 0) ;

7892 i‡(
œãncy
 > 
max_œãncy
) {

7893 
max_œãncy
 = 
œãncy
;

7894 
	`¥ötf
("MaxÜ©ícy sÿÁr: %Œd mi¸o£c⁄ds.\n", 
max_œãncy
);

7897 
avg_us
 = ()
run_time
/
runs
;

7898 
avg_ns
 = 
avg_us
 * 1e3;

7899 i‡(
f‹˚_ˇn˚l_lo›
 || 
íd
 > 
ã°_íd
) {

7900 
	`¥ötf
("\n%lldÅotalÑuns "

7903 
runs
, 
avg_us
, 
avg_ns
);

7904 
	`¥ötf
("WorstÑunÅook %.0fxÜongerÅhanÅheáverageÜatency.\n",

7905 
max_œãncy
 / 
avg_us
);

7906 
	`exô
(0);

7909 
	}
}

7911 
sds
 
	$askPassw‹d
() {

7912 
	`löíoi£MaskModeE«bÀ
();

7913 
sds
 
auth
 = 
	`löíoi£
("Please inputÖassword: ");

7914 
	`löíoi£MaskModeDißbÀ
();

7915  
auth
;

7916 
	}
}

7922 
	$maö
(
¨gc
, **
¨gv
) {

7923 
fú°¨g
;

7925 
c⁄fig
.
ho°ù
 = 
	`sd¢ew
("127.0.0.1");

7926 
c⁄fig
.
ho°p‹t
 = 6379;

7927 
c⁄fig
.
ho°sockë
 = 
NULL
;

7928 
c⁄fig
.
ª≥©
 = 1;

7929 
c⁄fig
.
öãrvÆ
 = 0;

7930 
c⁄fig
.
dbnum
 = 0;

7931 
c⁄fig
.
öãø˘ive
 = 0;

7932 
c⁄fig
.
shutdown
 = 0;

7933 
c⁄fig
.
m⁄ô‹_mode
 = 0;

7934 
c⁄fig
.
pubsub_mode
 = 0;

7935 
c⁄fig
.
œãncy_mode
 = 0;

7936 
c⁄fig
.
œãncy_di°_mode
 = 0;

7937 
c⁄fig
.
œãncy_hi°‹y
 = 0;

7938 
c⁄fig
.
Ãu_ã°_mode
 = 0;

7939 
c⁄fig
.
Ãu_ã°_ßm∂e_size
 = 0;

7940 
c⁄fig
.
˛u°î_mode
 = 0;

7941 
c⁄fig
.
¶ave_mode
 = 0;

7942 
c⁄fig
.
gërdb_mode
 = 0;

7943 
c⁄fig
.
°©_mode
 = 0;

7944 
c⁄fig
.
sˇn_mode
 = 0;

7945 
c⁄fig
.
öåösic_œãncy_mode
 = 0;

7946 
c⁄fig
.
∑âîn
 = 
NULL
;

7947 
c⁄fig
.
rdb_fûíame
 = 
NULL
;

7948 
c⁄fig
.
pùe_mode
 = 0;

7949 
c⁄fig
.
pùe_timeout
 = 
REDIS_CLI_DEFAULT_PIPE_TIMEOUT
;

7950 
c⁄fig
.
bigkeys
 = 0;

7951 
c⁄fig
.
hŸkeys
 = 0;

7952 
c⁄fig
.
°dö¨g
 = 0;

7953 
c⁄fig
.
auth
 = 
NULL
;

7954 
c⁄fig
.
ask∑ss
 = 0;

7955 
c⁄fig
.
u£r
 = 
NULL
;

7956 
c⁄fig
.
evÆ
 = 
NULL
;

7957 
c⁄fig
.
evÆ_ldb
 = 0;

7958 
c⁄fig
.
evÆ_ldb_íd
 = 0;

7959 
c⁄fig
.
evÆ_ldb_sync
 = 0;

7960 
c⁄fig
.
íabÀ_ldb_⁄_evÆ
 = 0;

7961 
c⁄fig
.
œ°_cmd_ty≥
 = -1;

7962 
c⁄fig
.
vîbo£
 = 0;

7963 
c⁄fig
.
no_auth_w¨nög
 = 0;

7964 
c⁄fig
.
˛u°î_m™agî_comm™d
.
«me
 = 
NULL
;

7965 
c⁄fig
.
˛u°î_m™agî_comm™d
.
¨gc
 = 0;

7966 
c⁄fig
.
˛u°î_m™agî_comm™d
.
¨gv
 = 
NULL
;

7967 
c⁄fig
.
˛u°î_m™agî_comm™d
.
Êags
 = 0;

7968 
c⁄fig
.
˛u°î_m™agî_comm™d
.
ª∂iˇs
 = 0;

7969 
c⁄fig
.
˛u°î_m™agî_comm™d
.
‰om
 = 
NULL
;

7970 
c⁄fig
.
˛u°î_m™agî_comm™d
.
to
 = 
NULL
;

7971 
c⁄fig
.
˛u°î_m™agî_comm™d
.
weight
 = 
NULL
;

7972 
c⁄fig
.
˛u°î_m™agî_comm™d
.
weight_¨gc
 = 0;

7973 
c⁄fig
.
˛u°î_m™agî_comm™d
.
¶Ÿs
 = 0;

7974 
c⁄fig
.
˛u°î_m™agî_comm™d
.
timeout
 = 
CLUSTER_MANAGER_MIGRATE_TIMEOUT
;

7975 
c⁄fig
.
˛u°î_m™agî_comm™d
.
pùñöe
 = 
CLUSTER_MANAGER_MIGRATE_PIPELINE
;

7976 
c⁄fig
.
˛u°î_m™agî_comm™d
.
thªshﬁd
 =

7977 
CLUSTER_MANAGER_REBALANCE_THRESHOLD
;

7978 
c⁄fig
.
˛u°î_m™agî_comm™d
.
backup_dú
 = 
NULL
;

7979 
¥ef
.
höts
 = 1;

7981 
•e˘rum_∑Àâe
 = 
•e˘rum_∑Àâe_cﬁ‹
;

7982 
•e˘rum_∑Àâe_size
 = 
•e˘rum_∑Àâe_cﬁ‹_size
;

7984 i‡(!
	`ißây
(
	`fûío
(
°dout
)Ë&& (
	`gëív
("FAKETTY"Ë=
NULL
))

7985 
c⁄fig
.
ouçut
 = 
OUTPUT_RAW
;

7987 
c⁄fig
.
ouçut
 = 
OUTPUT_STANDARD
;

7988 
c⁄fig
.
mb_dñim
 = 
	`sd¢ew
("\n");

7990 
fú°¨g
 = 
	`∑r£O±i⁄s
(
¨gc
,
¨gv
);

7991 
¨gc
 -
fú°¨g
;

7992 
¨gv
 +
fú°¨g
;

7994 
	`∑r£Env
();

7996 i‡(
c⁄fig
.
ask∑ss
) {

7997 
c⁄fig
.
auth
 = 
	`askPassw‹d
();

8000 #ifde‡
USE_OPENSSL


8001 i‡(
c⁄fig
.
és
) {

8002 
	`ERR_lﬂd_¸y±o_°rögs
();

8003 
	`SSL_lﬂd_îr‹_°rögs
();

8004 
	`SSL_libøry_öô
();

8009 i‡(
	`CLUSTER_MANAGER_MODE
()) {

8010 
˛u°îM™agîComm™dProc
 *
¥oc
 = 
	`vÆid©eClu°îM™agîComm™d
();

8011 i‡(!
¥oc
) {

8012 
	`sds‰ì
(
c⁄fig
.
ho°ù
);

8013 
	`sds‰ì
(
c⁄fig
.
mb_dñim
);

8014 
	`exô
(1);

8016 
	`˛u°îM™agîMode
(
¥oc
);

8020 i‡(
c⁄fig
.
œãncy_mode
) {

8021 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8022 
	`œãncyMode
();

8026 i‡(
c⁄fig
.
œãncy_di°_mode
) {

8027 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8028 
	`œãncyDi°Mode
();

8032 i‡(
c⁄fig
.
¶ave_mode
) {

8033 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8034 
	`£ndC≠a
();

8035 
	`¶aveMode
();

8039 i‡(
c⁄fig
.
gërdb_mode
) {

8040 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8041 
	`£ndC≠a
();

8042 
	`gëRDB
(
NULL
);

8046 i‡(
c⁄fig
.
pùe_mode
) {

8047 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8048 
	`pùeMode
();

8052 i‡(
c⁄fig
.
bigkeys
) {

8053 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8054 
	`födBigKeys
(0, 0);

8058 i‡(
c⁄fig
.
memkeys
) {

8059 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8060 
	`födBigKeys
(1, 
c⁄fig
.
memkeys_ßm∂es
);

8064 i‡(
c⁄fig
.
hŸkeys
) {

8065 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8066 
	`födHŸKeys
();

8070 i‡(
c⁄fig
.
°©_mode
) {

8071 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8072 i‡(
c⁄fig
.
öãrvÆ
 == 0) config.interval = 1000000;

8073 
	`°©Mode
();

8077 i‡(
c⁄fig
.
sˇn_mode
) {

8078 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8079 
	`sˇnMode
();

8083 i‡(
c⁄fig
.
Ãu_ã°_mode
) {

8084 i‡(
	`˛iC⁄√˘
(0Ë=
REDIS_ERR
Ë
	`exô
(1);

8085 
	`LRUTe°Mode
();

8089 i‡(
c⁄fig
.
öåösic_œãncy_mode
Ë
	`öåösicL©ícyMode
();

8092 i‡(
¨gc
 =0 && !
c⁄fig
.
evÆ
) {

8094 
	`sig«l
(
SIGPIPE
, 
SIG_IGN
);

8098 
	`˛iC⁄√˘
(0);

8099 
	`ª∂
();

8103 i‡(
	`˛iC⁄√˘
(0Ë!
REDIS_OK
Ë
	`exô
(1);

8104 i‡(
c⁄fig
.
evÆ
) {

8105  
	`evÆMode
(
¨gc
,
¨gv
);

8107  
	`n⁄öãø˘ive
(
¨gc
,
	`c⁄vîtToSds
◊rgc,
¨gv
));

8109 
	}
}

	@redisassert.h

38 #i‚de‡
__REDIS_ASSERT_H__


39 
	#__REDIS_ASSERT_H__


	)

41 
	~<uni°d.h
>

43 
	#as£π
(
_e
Ë((_e)?()0 : (
	`_£rvîAs£π
(#_e,
__FILE__
,
__LINE__
),
	`_exô
(1)))

	)

44 
	#∑nic
(...Ë
	`_£rvîP™ic
(
__FILE__
,
__LINE__
,
__VA_ARGS__
),
	`_exô
(1)

	)

46 
_£rvîAs£π
(*
e°r
, *
fûe
, 
löe
);

47 
_£rvîP™ic
(c⁄° *
fûe
, 
löe
, c⁄° *
msg
, ...);

	@redismodule.h

1 #i‚de‡
REDISMODULE_H


2 
	#REDISMODULE_H


	)

4 
	~<sys/ty≥s.h
>

5 
	~<°döt.h
>

6 
	~<°dio.h
>

11 
	#REDISMODULE_OK
 0

	)

12 
	#REDISMODULE_ERR
 1

	)

15 
	#REDISMODULE_APIVER_1
 1

	)

18 
	#REDISMODULE_READ
 (1<<0)

	)

19 
	#REDISMODULE_WRITE
 (1<<1)

	)

23 
	#REDISMODULE_OPEN_KEY_NOTOUCH
 (1<<16)

	)

25 
	#REDISMODULE_LIST_HEAD
 0

	)

26 
	#REDISMODULE_LIST_TAIL
 1

	)

29 
	#REDISMODULE_KEYTYPE_EMPTY
 0

	)

30 
	#REDISMODULE_KEYTYPE_STRING
 1

	)

31 
	#REDISMODULE_KEYTYPE_LIST
 2

	)

32 
	#REDISMODULE_KEYTYPE_HASH
 3

	)

33 
	#REDISMODULE_KEYTYPE_SET
 4

	)

34 
	#REDISMODULE_KEYTYPE_ZSET
 5

	)

35 
	#REDISMODULE_KEYTYPE_MODULE
 6

	)

36 
	#REDISMODULE_KEYTYPE_STREAM
 7

	)

39 
	#REDISMODULE_REPLY_UNKNOWN
 -1

	)

40 
	#REDISMODULE_REPLY_STRING
 0

	)

41 
	#REDISMODULE_REPLY_ERROR
 1

	)

42 
	#REDISMODULE_REPLY_INTEGER
 2

	)

43 
	#REDISMODULE_REPLY_ARRAY
 3

	)

44 
	#REDISMODULE_REPLY_NULL
 4

	)

47 
	#REDISMODULE_POSTPONED_ARRAY_LEN
 -1

	)

50 
	#REDISMODULE_NO_EXPIRE
 -1

	)

53 
	#REDISMODULE_ZADD_XX
 (1<<0)

	)

54 
	#REDISMODULE_ZADD_NX
 (1<<1)

	)

55 
	#REDISMODULE_ZADD_ADDED
 (1<<2)

	)

56 
	#REDISMODULE_ZADD_UPDATED
 (1<<3)

	)

57 
	#REDISMODULE_ZADD_NOP
 (1<<4)

	)

60 
	#REDISMODULE_HASH_NONE
 0

	)

61 
	#REDISMODULE_HASH_NX
 (1<<0)

	)

62 
	#REDISMODULE_HASH_XX
 (1<<1)

	)

63 
	#REDISMODULE_HASH_CFIELDS
 (1<<2)

	)

64 
	#REDISMODULE_HASH_EXISTS
 (1<<3)

	)

70 
	#REDISMODULE_CTX_FLAGS_LUA
 (1<<0)

	)

72 
	#REDISMODULE_CTX_FLAGS_MULTI
 (1<<1)

	)

74 
	#REDISMODULE_CTX_FLAGS_MASTER
 (1<<2)

	)

76 
	#REDISMODULE_CTX_FLAGS_SLAVE
 (1<<3)

	)

78 
	#REDISMODULE_CTX_FLAGS_READONLY
 (1<<4)

	)

80 
	#REDISMODULE_CTX_FLAGS_CLUSTER
 (1<<5)

	)

82 
	#REDISMODULE_CTX_FLAGS_AOF
 (1<<6)

	)

84 
	#REDISMODULE_CTX_FLAGS_RDB
 (1<<7)

	)

86 
	#REDISMODULE_CTX_FLAGS_MAXMEMORY
 (1<<8)

	)

88 
	#REDISMODULE_CTX_FLAGS_EVICT
 (1<<9)

	)

90 
	#REDISMODULE_CTX_FLAGS_OOM
 (1<<10)

	)

92 
	#REDISMODULE_CTX_FLAGS_OOM_WARNING
 (1<<11)

	)

94 
	#REDISMODULE_CTX_FLAGS_REPLICATED
 (1<<12)

	)

96 
	#REDISMODULE_CTX_FLAGS_LOADING
 (1<<13)

	)

103 
	#REDISMODULE_CTX_FLAGS_REPLICA_IS_STALE
 (1<<14)

	)

106 
	#REDISMODULE_CTX_FLAGS_REPLICA_IS_CONNECTING
 (1<<15)

	)

108 
	#REDISMODULE_CTX_FLAGS_REPLICA_IS_TRANSFERRING
 (1<<16)

	)

110 
	#REDISMODULE_CTX_FLAGS_REPLICA_IS_ONLINE
 (1<<17)

	)

112 
	#REDISMODULE_CTX_FLAGS_ACTIVE_CHILD
 (1<<18)

	)

114 
	#REDISMODULE_CTX_FLAGS_MULTI_DIRTY
 (1<<19)

	)

119 
	#REDISMODULE_NOTIFY_KEYSPACE
 (1<<0Ë

	)

120 
	#REDISMODULE_NOTIFY_KEYEVENT
 (1<<1Ë

	)

121 
	#REDISMODULE_NOTIFY_GENERIC
 (1<<2Ë

	)

122 
	#REDISMODULE_NOTIFY_STRING
 (1<<3Ë

	)

123 
	#REDISMODULE_NOTIFY_LIST
 (1<<4Ë

	)

124 
	#REDISMODULE_NOTIFY_SET
 (1<<5Ë

	)

125 
	#REDISMODULE_NOTIFY_HASH
 (1<<6Ë

	)

126 
	#REDISMODULE_NOTIFY_ZSET
 (1<<7Ë

	)

127 
	#REDISMODULE_NOTIFY_EXPIRED
 (1<<8Ë

	)

128 
	#REDISMODULE_NOTIFY_EVICTED
 (1<<9Ë

	)

129 
	#REDISMODULE_NOTIFY_STREAM
 (1<<10Ë

	)

130 
	#REDISMODULE_NOTIFY_KEY_MISS
 (1<<11Ë

	)

131 
	#REDISMODULE_NOTIFY_ALL
 (
REDISMODULE_NOTIFY_GENERIC
 | 
REDISMODULE_NOTIFY_STRING
 | 
REDISMODULE_NOTIFY_LIST
 | 
REDISMODULE_NOTIFY_SET
 | 
REDISMODULE_NOTIFY_HASH
 | 
REDISMODULE_NOTIFY_ZSET
 | 
REDISMODULE_NOTIFY_EXPIRED
 | 
REDISMODULE_NOTIFY_EVICTED
 | 
REDISMODULE_NOTIFY_STREAM
Ë

	)

136 
	#REDISMODULE_HASH_DELETE
 ((
RedisModuÀSåög
*)()1)

	)

139 
	#REDISMODULE_ERRORMSG_WRONGTYPE
 "WRONGTYPE O≥øti⁄ágaö°á key hﬁdögÅhêwr⁄g köd o‡vÆue"

	)

141 
	#REDISMODULE_POSITIVE_INFINITE
 (1.0/0.0)

	)

142 
	#REDISMODULE_NEGATIVE_INFINITE
 (-1.0/0.0)

	)

145 
	#REDISMODULE_NODE_ID_LEN
 40

	)

146 
	#REDISMODULE_NODE_MYSELF
 (1<<0)

	)

147 
	#REDISMODULE_NODE_MASTER
 (1<<1)

	)

148 
	#REDISMODULE_NODE_SLAVE
 (1<<2)

	)

149 
	#REDISMODULE_NODE_PFAIL
 (1<<3)

	)

150 
	#REDISMODULE_NODE_FAIL
 (1<<4)

	)

151 
	#REDISMODULE_NODE_NOFAILOVER
 (1<<5)

	)

153 
	#REDISMODULE_CLUSTER_FLAG_NONE
 0

	)

154 
	#REDISMODULE_CLUSTER_FLAG_NO_FAILOVER
 (1<<1)

	)

155 
	#REDISMODULE_CLUSTER_FLAG_NO_REDIRECTION
 (1<<2)

	)

157 
	#REDISMODULE_NOT_USED
(
V
Ë((ËV)

	)

160 
	#REDISMODULE_AUX_BEFORE_RDB
 (1<<0)

	)

161 
	#REDISMODULE_AUX_AFTER_RDB
 (1<<1)

	)

167 
uöt64_t
 
	tRedisModuÀTimîID
;

172 
	#REDISMODULE_CMDFILTER_NOSELF
 (1<<0)

	)

175 
	#REDISMODULE_OPTIONS_HANDLE_IO_ERRORS
 (1<<0)

	)

179 
	#REDISMODULE_OPTION_NO_IMPLICIT_SIGNAL_MODIFIED
 (1<<1)

	)

182 
	#REDISMODULE_EVENT_REPLICATION_ROLE_CHANGED
 0

	)

183 
	#REDISMODULE_EVENT_PERSISTENCE
 1

	)

184 
	#REDISMODULE_EVENT_FLUSHDB
 2

	)

185 
	#REDISMODULE_EVENT_LOADING
 3

	)

186 
	#REDISMODULE_EVENT_CLIENT_CHANGE
 4

	)

187 
	#REDISMODULE_EVENT_SHUTDOWN
 5

	)

188 
	#REDISMODULE_EVENT_REPLICA_CHANGE
 6

	)

189 
	#REDISMODULE_EVENT_MASTER_LINK_CHANGE
 7

	)

190 
	#REDISMODULE_EVENT_CRON_LOOP
 8

	)

191 
	#REDISMODULE_EVENT_MODULE_CHANGE
 9

	)

192 
	#REDISMODULE_EVENT_LOADING_PROGRESS
 10

	)

194 
	sRedisModuÀEvít
 {

195 
uöt64_t
 
	mid
;

196 
uöt64_t
 
	md©avî
;

197 } 
	tRedisModuÀEvít
;

199 
	gRedisModuÀCtx
;

200 (*
	tRedisModuÀEvítCÆlback
)(
	tRedisModuÀCtx
 *
	t˘x
, 
	tRedisModuÀEvít
 
	teid
, 
	tuöt64_t
 
	tsubevít
, *
	td©a
);

202 c⁄° 
RedisModuÀEvít


203 
RedisModuÀEvít_Rïliˇti⁄RﬁeCh™ged
 = {

204 
REDISMODULE_EVENT_REPLICATION_ROLE_CHANGED
,

206 
	}
},

207 
	gRedisModuÀEvít_Pîsi°í˚
 = {

208 
REDISMODULE_EVENT_PERSISTENCE
,

211 
	gRedisModuÀEvít_FlushDB
 = {

212 
REDISMODULE_EVENT_FLUSHDB
,

215 
	gRedisModuÀEvít_Lﬂdög
 = {

216 
REDISMODULE_EVENT_LOADING
,

219 
	gRedisModuÀEvít_Clõ¡Ch™ge
 = {

220 
REDISMODULE_EVENT_CLIENT_CHANGE
,

223 
	gRedisModuÀEvít_Shutdown
 = {

224 
REDISMODULE_EVENT_SHUTDOWN
,

227 
	gRedisModuÀEvít_RïliˇCh™ge
 = {

228 
REDISMODULE_EVENT_REPLICA_CHANGE
,

231 
	gRedisModuÀEvít_Cr⁄Lo›
 = {

232 
REDISMODULE_EVENT_CRON_LOOP
,

235 
	gRedisModuÀEvít_Ma°îLökCh™ge
 = {

236 
REDISMODULE_EVENT_MASTER_LINK_CHANGE
,

239 
	gRedisModuÀEvít_ModuÀCh™ge
 = {

240 
REDISMODULE_EVENT_MODULE_CHANGE
,

243 
	gRedisModuÀEvít_LﬂdögProgªss
 = {

244 
REDISMODULE_EVENT_LOADING_PROGRESS
,

249 
	#REDISMODULE_SUBEVENT_PERSISTENCE_RDB_START
 0

	)

250 
	#REDISMODULE_SUBEVENT_PERSISTENCE_AOF_START
 1

	)

251 
	#REDISMODULE_SUBEVENT_PERSISTENCE_SYNC_RDB_START
 2

	)

252 
	#REDISMODULE_SUBEVENT_PERSISTENCE_ENDED
 3

	)

253 
	#REDISMODULE_SUBEVENT_PERSISTENCE_FAILED
 4

	)

255 
	#REDISMODULE_SUBEVENT_LOADING_RDB_START
 0

	)

256 
	#REDISMODULE_SUBEVENT_LOADING_AOF_START
 1

	)

257 
	#REDISMODULE_SUBEVENT_LOADING_REPL_START
 2

	)

258 
	#REDISMODULE_SUBEVENT_LOADING_ENDED
 3

	)

259 
	#REDISMODULE_SUBEVENT_LOADING_FAILED
 4

	)

261 
	#REDISMODULE_SUBEVENT_CLIENT_CHANGE_CONNECTED
 0

	)

262 
	#REDISMODULE_SUBEVENT_CLIENT_CHANGE_DISCONNECTED
 1

	)

264 
	#REDISMODULE_SUBEVENT_MASTER_LINK_UP
 0

	)

265 
	#REDISMODULE_SUBEVENT_MASTER_LINK_DOWN
 1

	)

267 
	#REDISMODULE_SUBEVENT_REPLICA_CHANGE_ONLINE
 0

	)

268 
	#REDISMODULE_SUBEVENT_REPLICA_CHANGE_OFFLINE
 1

	)

270 
	#REDISMODULE_EVENT_REPLROLECHANGED_NOW_MASTER
 0

	)

271 
	#REDISMODULE_EVENT_REPLROLECHANGED_NOW_REPLICA
 1

	)

273 
	#REDISMODULE_SUBEVENT_FLUSHDB_START
 0

	)

274 
	#REDISMODULE_SUBEVENT_FLUSHDB_END
 1

	)

276 
	#REDISMODULE_SUBEVENT_MODULE_LOADED
 0

	)

277 
	#REDISMODULE_SUBEVENT_MODULE_UNLOADED
 1

	)

279 
	#REDISMODULE_SUBEVENT_LOADING_PROGRESS_RDB
 0

	)

280 
	#REDISMODULE_SUBEVENT_LOADING_PROGRESS_AOF
 1

	)

283 
	#REDISMODULE_CLIENTINFO_FLAG_SSL
 (1<<0)

	)

284 
	#REDISMODULE_CLIENTINFO_FLAG_PUBSUB
 (1<<1)

	)

285 
	#REDISMODULE_CLIENTINFO_FLAG_BLOCKED
 (1<<2)

	)

286 
	#REDISMODULE_CLIENTINFO_FLAG_TRACKING
 (1<<3)

	)

287 
	#REDISMODULE_CLIENTINFO_FLAG_UNIXSOCKET
 (1<<4)

	)

288 
	#REDISMODULE_CLIENTINFO_FLAG_MULTI
 (1<<5)

	)

305 
	#REDISMODULE_CLIENTINFO_VERSION
 1

	)

306 
	sRedisModuÀClõ¡Info
 {

307 
uöt64_t
 
	mvîsi⁄
;

308 
uöt64_t
 
	mÊags
;

309 
uöt64_t
 
	mid
;

310 
	maddr
[46];

311 
uöt16_t
 
	mp‹t
;

312 
uöt16_t
 
	mdb
;

313 } 
	tRedisModuÀClõ¡InfoV1
;

315 
	#RedisModuÀClõ¡Info
 
RedisModuÀClõ¡InfoV1


	)

317 
	#REDISMODULE_REPLICATIONINFO_VERSION
 1

	)

318 
	sRedisModuÀRïliˇti⁄Info
 {

319 
uöt64_t
 
	mvîsi⁄
;

322 
	mma°î
;

323 *
	mma°îho°
;

324 
	mma°îp‹t
;

325 *
	mª∂id1
;

326 *
	mª∂id2
;

327 
uöt64_t
 
	mª∂1_off£t
;

328 
uöt64_t
 
	mª∂2_off£t
;

329 } 
	tRedisModuÀRïliˇti⁄InfoV1
;

331 
	#RedisModuÀRïliˇti⁄Info
 
RedisModuÀRïliˇti⁄InfoV1


	)

333 
	#REDISMODULE_FLUSHINFO_VERSION
 1

	)

334 
	sRedisModuÀFlushInfo
 {

335 
uöt64_t
 
	mvîsi⁄
;

338 
öt32_t
 
	msync
;

339 
öt32_t
 
	mdbnum
;

340 } 
	tRedisModuÀFlushInfoV1
;

342 
	#RedisModuÀFlushInfo
 
RedisModuÀFlushInfoV1


	)

344 
	#REDISMODULE_MODULE_CHANGE_VERSION
 1

	)

345 
	sRedisModuÀModuÀCh™ge
 {

346 
uöt64_t
 
	mvîsi⁄
;

349 c⁄° * 
	mmoduÀ_«me
;

350 
öt32_t
 
	mmoduÀ_vîsi⁄
;

351 } 
	tRedisModuÀModuÀCh™geV1
;

353 
	#RedisModuÀModuÀCh™ge
 
RedisModuÀModuÀCh™geV1


	)

355 
	#REDISMODULE_CRON_LOOP_VERSION
 1

	)

356 
	sRedisModuÀCr⁄Lo›Info
 {

357 
uöt64_t
 
	mvîsi⁄
;

360 
öt32_t
 
	mhz
;

361 } 
	tRedisModuÀCr⁄Lo›V1
;

363 
	#RedisModuÀCr⁄Lo›
 
RedisModuÀCr⁄Lo›V1


	)

365 
	#REDISMODULE_LOADING_PROGRESS_VERSION
 1

	)

366 
	sRedisModuÀLﬂdögProgªssInfo
 {

367 
uöt64_t
 
	mvîsi⁄
;

370 
öt32_t
 
	mhz
;

371 
öt32_t
 
	m¥ogªss
;

373 } 
	tRedisModuÀLﬂdögProgªssV1
;

375 
	#RedisModuÀLﬂdögProgªss
 
RedisModuÀLﬂdögProgªssV1


	)

379 #i‚de‡
REDISMODULE_CORE


381 
	tm°ime_t
;

384 
RedisModuÀCtx
 
	tRedisModuÀCtx
;

385 
RedisModuÀKey
 
	tRedisModuÀKey
;

386 
RedisModuÀSåög
 
	tRedisModuÀSåög
;

387 
RedisModuÀCÆlRïly
 
	tRedisModuÀCÆlRïly
;

388 
RedisModuÀIO
 
	tRedisModuÀIO
;

389 
RedisModuÀTy≥
 
	tRedisModuÀTy≥
;

390 
RedisModuÀDige°
 
	tRedisModuÀDige°
;

391 
RedisModuÀBlockedClõ¡
 
	tRedisModuÀBlockedClõ¡
;

392 
RedisModuÀClu°îInfo
 
	tRedisModuÀClu°îInfo
;

393 
RedisModuÀDi˘
 
	tRedisModuÀDi˘
;

394 
RedisModuÀDi˘Iãr
 
	tRedisModuÀDi˘Iãr
;

395 
RedisModuÀComm™dFûãrCtx
 
	tRedisModuÀComm™dFûãrCtx
;

396 
RedisModuÀComm™dFûãr
 
	tRedisModuÀComm™dFûãr
;

397 
RedisModuÀInfoCtx
 
	tRedisModuÀInfoCtx
;

398 
RedisModuÀSîvîInfoD©a
 
	tRedisModuÀSîvîInfoD©a
;

399 
RedisModuÀSˇnCurs‹
 
	tRedisModuÀSˇnCurs‹
;

400 
RedisModuÀU£r
 
	tRedisModuÀU£r
;

402 (*
	tRedisModuÀCmdFunc
)(
	tRedisModuÀCtx
 *
	t˘x
, 
	tRedisModuÀSåög
 **
	t¨gv
, 
	t¨gc
);

403 (*
	tRedisModuÀDisc⁄√˘Func
)(
	tRedisModuÀCtx
 *
	t˘x
, 
	tRedisModuÀBlockedClõ¡
 *
	tbc
);

404 (*
	tRedisModuÀNŸifiˇti⁄Func
)(
	tRedisModuÀCtx
 *
	t˘x
, 
	tty≥
, c⁄° *
	tevít
, 
	tRedisModuÀSåög
 *
	tkey
);

405 *(*
	tRedisModuÀTy≥LﬂdFunc
)(
	tRedisModuÀIO
 *
	trdb
, 
	tícvî
);

406 (*
	tRedisModuÀTy≥SaveFunc
)(
	tRedisModuÀIO
 *
	trdb
, *
	tvÆue
);

407 (*
	tRedisModuÀTy≥AuxLﬂdFunc
)(
	tRedisModuÀIO
 *
	trdb
, 
	tícvî
, 
	twhí
);

408 (*
	tRedisModuÀTy≥AuxSaveFunc
)(
	tRedisModuÀIO
 *
	trdb
, 
	twhí
);

409 (*
	tRedisModuÀTy≥RewrôeFunc
)(
	tRedisModuÀIO
 *
	taof
, 
	tRedisModuÀSåög
 *
	tkey
, *
	tvÆue
);

410 
	$size_t
 (*
	tRedisModuÀTy≥MemUßgeFunc
)(c⁄° *
	tvÆue
);

411 (*
	tRedisModuÀTy≥Dige°Func
)(
	tRedisModuÀDige°
 *
	tdige°
, *
	tvÆue
);

412 (*
	tRedisModuÀTy≥FªeFunc
)(*
	tvÆue
);

413 (*
	tRedisModuÀClu°îMesßgeRe˚ivî
)(
	tRedisModuÀCtx
 *
	t˘x
, c⁄° *
	t£ndî_id
, 
	tuöt8_t
 
	tty≥
, c⁄° *
	t∑ylﬂd
, 
	tuöt32_t
 
	tÀn
);

414 (*
	tRedisModuÀTimîProc
)(
	tRedisModuÀCtx
 *
	t˘x
, *
	td©a
);

415 (*
	tRedisModuÀComm™dFûãrFunc
Ë(
	tRedisModuÀComm™dFûãrCtx
 *
	tfûãr
);

416 (*
	tRedisModuÀF‹kD⁄eH™dÀr
Ë(
	texôcode
, 
	tbysig«l
, *
	tu£r_d©a
);

417 (*
	tRedisModuÀInfoFunc
)(
	tRedisModuÀInfoCtx
 *
	t˘x
, 
	tf‹_¸ash_ªp‹t
);

418 (*
	tRedisModuÀSˇnCB
)(
	tRedisModuÀCtx
 *
	t˘x
, 
	tRedisModuÀSåög
 *
	tkey«me
, 
	tRedisModuÀKey
 *
	tkey
, *
	t¥ivd©a
);

419 (*
	tRedisModuÀSˇnKeyCB
)(
	tRedisModuÀKey
 *
	tkey
, 
	tRedisModuÀSåög
 *
	tfõld
, RedisModuÀSåög *
	tvÆue
, *
	t¥ivd©a
);

420 (*
	tRedisModuÀU£rCh™gedFunc
Ë(
	tuöt64_t
 
	t˛õ¡_id
, *
	t¥ivd©a
);

422 
	#REDISMODULE_TYPE_METHOD_VERSION
 2

	)

423 
	sRedisModuÀTy≥Mëhods
 {

424 
uöt64_t
 
vîsi⁄
;

425 
RedisModuÀTy≥LﬂdFunc
 
rdb_lﬂd
;

426 
RedisModuÀTy≥SaveFunc
 
rdb_ßve
;

427 
RedisModuÀTy≥RewrôeFunc
 
aof_ªwrôe
;

428 
RedisModuÀTy≥MemUßgeFunc
 
mem_ußge
;

429 
RedisModuÀTy≥Dige°Func
 
dige°
;

430 
RedisModuÀTy≥FªeFunc
 
‰ì
;

431 
RedisModuÀTy≥AuxLﬂdFunc
 
aux_lﬂd
;

432 
RedisModuÀTy≥AuxSaveFunc
 
aux_ßve
;

433 
aux_ßve_åiggîs
;

434 } 
	tRedisModuÀTy≥Mëhods
;

436 
	#REDISMODULE_GET_API
(
«me
) \

437 
	`RedisModuÀ_GëApi
("RedisModuÀ_" #«me, ((**)&
RedisModuÀ_
 ## 
«me
))

	)

439 
	#REDISMODULE_API_FUNC
(
x
Ë(*x)

	)

442 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_AŒoc
)(
size_t
 
byãs
);

443 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RóŒoc
)(*
±r
, 
size_t
 
byãs
);

444 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Fªe
)(*
±r
);

445 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_CÆloc
)(
size_t
 
nmemb
, size_à
size
);

446 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Sådup
)(c⁄° *
°r
);

447 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëApi
)(const *, *);

448 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eComm™d
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
RedisModuÀCmdFunc
 
cmdfunc
, c⁄° *
°rÊags
, 
fú°key
, 
œ°key
, 
key°ï
);

449 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SëModuÀAâribs
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
vî
, 
≠ivî
);

450 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_IsModuÀNameBusy
)(c⁄° *
«me
);

451 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Wr⁄gArôy
)(
RedisModuÀCtx
 *
˘x
);

452 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhL⁄gL⁄g
)(
RedisModuÀCtx
 *
˘x
, 
Œ
);

453 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëSñe˘edDb
)(
RedisModuÀCtx
 *
˘x
);

454 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Sñe˘Db
)(
RedisModuÀCtx
 *
˘x
, 
√wid
);

455 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_O≥nKey
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
key«me
, 
mode
);

456 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Clo£Key
)(
RedisModuÀKey
 *
kp
);

457 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_KeyTy≥
)(
RedisModuÀKey
 *
kp
);

458 
size_t
 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_VÆueLígth
)(
RedisModuÀKey
 *
kp
);

459 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Li°Push
)(
RedisModuÀKey
 *
kp
, 
whîe
, 
RedisModuÀSåög
 *
ñe
);

460 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Li°P›
)(
RedisModuÀKey
 *
key
, 
whîe
);

461 
RedisModuÀCÆlRïly
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_CÆl
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
cmd«me
, c⁄° *
fmt
, ...);

462 c⁄° *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_CÆlRïlyPrŸo
)(
RedisModuÀCÆlRïly
 *
ª∂y
, 
size_t
 *
Àn
);

463 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_FªeCÆlRïly
)(
RedisModuÀCÆlRïly
 *
ª∂y
);

464 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_CÆlRïlyTy≥
)(
RedisModuÀCÆlRïly
 *
ª∂y
);

465 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_CÆlRïlyI¡egî
)(
RedisModuÀCÆlRïly
 *
ª∂y
);

466 
size_t
 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_CÆlRïlyLígth
)(
RedisModuÀCÆlRïly
 *
ª∂y
);

467 
RedisModuÀCÆlRïly
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_CÆlRïlyAºayEÀmít
)(
RedisModuÀCÆlRïly
 *
ª∂y
, 
size_t
 
idx
);

468 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eSåög
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
±r
, 
size_t
 
Àn
);

469 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eSåögFromL⁄gL⁄g
)(
RedisModuÀCtx
 *
˘x
, 
Œ
);

470 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eSåögFromDoubÀ
)(
RedisModuÀCtx
 *
˘x
, 
d
);

471 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eSåögFromL⁄gDoubÀ
)(
RedisModuÀCtx
 *
˘x
, 
ld
, 
hum™‰õndly
);

472 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eSåögFromSåög
)(
RedisModuÀCtx
 *
˘x
, c⁄° 
RedisModuÀSåög
 *
°r
);

473 #ifde‡
__GNUC__


474 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eSåögPrötf
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
fmt
, ...Ë
	`__©åibuã__
 ((
	`f‹m©
 (
¥ötf
, 2, 3)));

476 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eSåögPrötf
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
fmt
, ...);

478 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_FªeSåög
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
°r
);

479 c⁄° *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SåögPåLí
)(c⁄° 
RedisModuÀSåög
 *
°r
, 
size_t
 *
Àn
);

480 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhEº‹
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
îr
);

481 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhSim∂eSåög
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
msg
);

482 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhAºay
)(
RedisModuÀCtx
 *
˘x
, 
Àn
);

483 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhNuŒAºay
)(
RedisModuÀCtx
 *
˘x
);

484 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhEm±yAºay
)(
RedisModuÀCtx
 *
˘x
);

485 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlySëAºayLígth
)(
RedisModuÀCtx
 *
˘x
, 
Àn
);

486 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhSåögBuf„r
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
buf
, 
size_t
 
Àn
);

487 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhCSåög
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
buf
);

488 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhSåög
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
°r
);

489 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhEm±ySåög
)(
RedisModuÀCtx
 *
˘x
);

490 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhVîb©imSåög
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
buf
, 
size_t
 
Àn
);

491 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhNuŒ
)(
RedisModuÀCtx
 *
˘x
);

492 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhDoubÀ
)(
RedisModuÀCtx
 *
˘x
, 
d
);

493 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhL⁄gDoubÀ
)(
RedisModuÀCtx
 *
˘x
, 
d
);

494 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïlyWôhCÆlRïly
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀCÆlRïly
 *
ª∂y
);

495 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SåögToL⁄gL⁄g
)(c⁄° 
RedisModuÀSåög
 *
°r
, *
Œ
);

496 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SåögToDoubÀ
)(c⁄° 
RedisModuÀSåög
 *
°r
, *
d
);

497 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SåögToL⁄gDoubÀ
)(c⁄° 
RedisModuÀSåög
 *
°r
, *
d
);

498 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_AutoMem‹y
)(
RedisModuÀCtx
 *
˘x
);

499 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Rïliˇã
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
cmd«me
, c⁄° *
fmt
, ...);

500 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RïliˇãVîb©im
)(
RedisModuÀCtx
 *
˘x
);

501 c⁄° *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_CÆlRïlySåögPå
)(
RedisModuÀCÆlRïly
 *
ª∂y
, 
size_t
 *
Àn
);

502 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eSåögFromCÆlRïly
)(
RedisModuÀCÆlRïly
 *
ª∂y
);

503 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_DñëeKey
)(
RedisModuÀKey
 *
key
);

504 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_U∆ökKey
)(
RedisModuÀKey
 *
key
);

505 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SåögSë
)(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
°r
);

506 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SåögDMA
)(
RedisModuÀKey
 *
key
, 
size_t
 *
Àn
, 
mode
);

507 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SåögTrunˇã
)(
RedisModuÀKey
 *
key
, 
size_t
 
√wÀn
);

508 
m°ime_t
 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëExpúe
)(
RedisModuÀKey
 *
key
);

509 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SëExpúe
)(
RedisModuÀKey
 *
key
, 
m°ime_t
 
expúe
);

510 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Re£tD©a£t
)(
ª°¨t_aof
, 
async
);

511 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_DbSize
)(
RedisModuÀCtx
 *
˘x
);

512 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_R™domKey
)(
RedisModuÀCtx
 *
˘x
);

513 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tAdd
)(
RedisModuÀKey
 *
key
, 
sc‹e
, 
RedisModuÀSåög
 *
ñe
, *
Êag•å
);

514 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tIn¸by
)(
RedisModuÀKey
 *
key
, 
sc‹e
, 
RedisModuÀSåög
 *
ñe
, *
Êag•å
, *
√wsc‹e
);

515 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tSc‹e
)(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
ñe
, *
sc‹e
);

516 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tRem
)(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
ñe
, *
dñëed
);

517 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tR™geSt›
)(
RedisModuÀKey
 *
key
);

518 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tFú°InSc‹eR™ge
)(
RedisModuÀKey
 *
key
, 
mö
, 
max
, 
möex
, 
maxex
);

519 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tLa°InSc‹eR™ge
)(
RedisModuÀKey
 *
key
, 
mö
, 
max
, 
möex
, 
maxex
);

520 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tFú°InLexR™ge
)(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
mö
, RedisModuÀSåög *
max
);

521 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tLa°InLexR™ge
)(
RedisModuÀKey
 *
key
, 
RedisModuÀSåög
 *
mö
, RedisModuÀSåög *
max
);

522 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tR™geCuºítEÀmít
)(
RedisModuÀKey
 *
key
, *
sc‹e
);

523 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tR™geNext
)(
RedisModuÀKey
 *
key
);

524 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tR™gePªv
)(
RedisModuÀKey
 *
key
);

525 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Z£tR™geEndRóched
)(
RedisModuÀKey
 *
key
);

526 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_HashSë
)(
RedisModuÀKey
 *
key
, 
Êags
, ...);

527 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_HashGë
)(
RedisModuÀKey
 *
key
, 
Êags
, ...);

528 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_IsKeysPosôi⁄Reque°
)(
RedisModuÀCtx
 *
˘x
);

529 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_KeyAtPos
)(
RedisModuÀCtx
 *
˘x
, 
pos
);

530 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëClõ¡Id
)(
RedisModuÀCtx
 *
˘x
);

531 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëClõ¡InfoById
)(*
ci
, 
uöt64_t
 
id
);

532 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_PublishMesßge
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
ch™√l
, RedisModuÀSåög *
mesßge
);

533 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëC⁄ãxtFœgs
)(
RedisModuÀCtx
 *
˘x
);

534 
	`REDISMODULE_API_FUNC
(
RedisModuÀ_AvoidRïliˇTøffic
)();

535 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_PoﬁAŒoc
)(
RedisModuÀCtx
 *
˘x
, 
size_t
 
byãs
);

536 
RedisModuÀTy≥
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eD©aTy≥
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
ícvî
, 
RedisModuÀTy≥Mëhods
 *
ty≥mëhods
);

537 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_ModuÀTy≥SëVÆue
)(
RedisModuÀKey
 *
key
, 
RedisModuÀTy≥
 *
mt
, *
vÆue
);

538 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_ModuÀTy≥Rïœ˚VÆue
)(
RedisModuÀKey
 *
key
, 
RedisModuÀTy≥
 *
mt
, *
√w_vÆue
, **
ﬁd_vÆue
);

539 
RedisModuÀTy≥
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_ModuÀTy≥GëTy≥
)(
RedisModuÀKey
 *
key
);

540 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_ModuÀTy≥GëVÆue
)(
RedisModuÀKey
 *
key
);

541 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_IsIOEº‹
)(
RedisModuÀIO
 *
io
);

542 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SëModuÀO±i⁄s
)(
RedisModuÀCtx
 *
˘x
, 
›ti⁄s
);

543 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Sig«lModifõdKey
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
key«me
);

544 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SaveUnsig√d
)(
RedisModuÀIO
 *
io
, 
uöt64_t
 
vÆue
);

545 
uöt64_t
 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LﬂdUnsig√d
)(
RedisModuÀIO
 *
io
);

546 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SaveSig√d
)(
RedisModuÀIO
 *
io
, 
öt64_t
 
vÆue
);

547 
öt64_t
 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LﬂdSig√d
)(
RedisModuÀIO
 *
io
);

548 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_EmôAOF
)(
RedisModuÀIO
 *
io
, c⁄° *
cmd«me
, c⁄° *
fmt
, ...);

549 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SaveSåög
)(
RedisModuÀIO
 *
io
, 
RedisModuÀSåög
 *
s
);

550 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SaveSåögBuf„r
)(
RedisModuÀIO
 *
io
, c⁄° *
°r
, 
size_t
 
Àn
);

551 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LﬂdSåög
)(
RedisModuÀIO
 *
io
);

552 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LﬂdSåögBuf„r
)(
RedisModuÀIO
 *
io
, 
size_t
 *
À≈å
);

553 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SaveDoubÀ
)(
RedisModuÀIO
 *
io
, 
vÆue
);

554 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LﬂdDoubÀ
)(
RedisModuÀIO
 *
io
);

555 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SaveFlﬂt
)(
RedisModuÀIO
 *
io
, 
vÆue
);

556 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LﬂdFlﬂt
)(
RedisModuÀIO
 *
io
);

557 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SaveL⁄gDoubÀ
)(
RedisModuÀIO
 *
io
, 
vÆue
);

558 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LﬂdL⁄gDoubÀ
)(
RedisModuÀIO
 *
io
);

559 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LﬂdD©aTy≥FromSåög
)(c⁄° 
RedisModuÀSåög
 *
°r
, c⁄° 
RedisModuÀTy≥
 *
mt
);

560 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SaveD©aTy≥ToSåög
)(
RedisModuÀCtx
 *
˘x
, *
d©a
, c⁄° 
RedisModuÀTy≥
 *
mt
);

561 #ifde‡
__GNUC__


562 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Log
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
Àvñ
, c⁄° *
fmt
, ...Ë
	`__©åibuã__
 ((
	`f‹m©
 (
¥ötf
, 3, 4)));

563 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LogIOEº‹
)(
RedisModuÀIO
 *
io
, c⁄° *
Àvñ°r
, c⁄° *
fmt
, ...Ë
	`__©åibuã__
 ((
	`f‹m©
 (
¥ötf
, 3, 4)));

565 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Log
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
Àvñ
, c⁄° *
fmt
, ...);

566 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_LogIOEº‹
)(
RedisModuÀIO
 *
io
, c⁄° *
Àvñ°r
, c⁄° *
fmt
, ...);

568 
	$REDISMODULE_API_FUNC
(
RedisModuÀ__As£π
)(c⁄° *
e°r
, c⁄° *
fûe
, 
löe
);

569 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_L©ícyAddSam∂e
)(c⁄° *
evít
, 
m°ime_t
 
œãncy
);

570 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SåögAµídBuf„r
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
°r
, c⁄° *
buf
, 
size_t
 
Àn
);

571 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_RëaöSåög
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
°r
);

572 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SåögCom∑ª
)(
RedisModuÀSåög
 *
a
, RedisModuÀSåög *
b
);

573 
RedisModuÀCtx
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëC⁄ãxtFromIO
)(
RedisModuÀIO
 *
io
);

574 c⁄° 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëKeyNameFromIO
)(
RedisModuÀIO
 *
io
);

575 c⁄° 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëKeyNameFromModuÀKey
)(
RedisModuÀKey
 *
key
);

576 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Mûli£c⁄ds
)();

577 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Dige°AddSåögBuf„r
)(
RedisModuÀDige°
 *
md
, *
ñe
, 
size_t
 
Àn
);

578 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Dige°AddL⁄gL⁄g
)(
RedisModuÀDige°
 *
md
, 
ñe
);

579 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Dige°EndSequí˚
)(
RedisModuÀDige°
 *
md
);

580 
RedisModuÀDi˘
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eDi˘
)(
RedisModuÀCtx
 *
˘x
);

581 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_FªeDi˘
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀDi˘
 *
d
);

582 
uöt64_t
 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Size
)(
RedisModuÀDi˘
 *
d
);

583 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘SëC
)(
RedisModuÀDi˘
 *
d
, *
key
, 
size_t
 
keyÀn
, *
±r
);

584 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Rïœ˚C
)(
RedisModuÀDi˘
 *
d
, *
key
, 
size_t
 
keyÀn
, *
±r
);

585 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Së
)(
RedisModuÀDi˘
 *
d
, 
RedisModuÀSåög
 *
key
, *
±r
);

586 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Rïœ˚
)(
RedisModuÀDi˘
 *
d
, 
RedisModuÀSåög
 *
key
, *
±r
);

587 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘GëC
)(
RedisModuÀDi˘
 *
d
, *
key
, 
size_t
 
keyÀn
, *
nokey
);

588 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Gë
)(
RedisModuÀDi˘
 *
d
, 
RedisModuÀSåög
 *
key
, *
nokey
);

589 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘DñC
)(
RedisModuÀDi˘
 *
d
, *
key
, 
size_t
 
keyÀn
, *
ﬁdvÆ
);

590 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Dñ
)(
RedisModuÀDi˘
 *
d
, 
RedisModuÀSåög
 *
key
, *
ﬁdvÆ
);

591 
RedisModuÀDi˘Iãr
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Iãøt‹SèπC
)(
RedisModuÀDi˘
 *
d
, c⁄° *
›
, *
key
, 
size_t
 
keyÀn
);

592 
RedisModuÀDi˘Iãr
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Iãøt‹Sèπ
)(
RedisModuÀDi˘
 *
d
, c⁄° *
›
, 
RedisModuÀSåög
 *
key
);

593 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Iãøt‹St›
)(
RedisModuÀDi˘Iãr
 *
di
);

594 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Iãøt‹Re£ekC
)(
RedisModuÀDi˘Iãr
 *
di
, c⁄° *
›
, *
key
, 
size_t
 
keyÀn
);

595 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Iãøt‹Re£ek
)(
RedisModuÀDi˘Iãr
 *
di
, c⁄° *
›
, 
RedisModuÀSåög
 *
key
);

596 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘NextC
)(
RedisModuÀDi˘Iãr
 *
di
, 
size_t
 *
keyÀn
, **
d©≠å
);

597 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘PªvC
)(
RedisModuÀDi˘Iãr
 *
di
, 
size_t
 *
keyÀn
, **
d©≠å
);

598 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Next
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀDi˘Iãr
 *
di
, **
d©≠å
);

599 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Pªv
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀDi˘Iãr
 *
di
, **
d©≠å
);

600 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Com∑ªC
)(
RedisModuÀDi˘Iãr
 *
di
, c⁄° *
›
, *
key
, 
size_t
 
keyÀn
);

601 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Di˘Com∑ª
)(
RedisModuÀDi˘Iãr
 *
di
, c⁄° *
›
, 
RedisModuÀSåög
 *
key
);

602 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Regi°îInfoFunc
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀInfoFunc
 
cb
);

603 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_InfoAddSe˘i⁄
)(
RedisModuÀInfoCtx
 *
˘x
, *
«me
);

604 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_InfoBegöDi˘Fõld
)(
RedisModuÀInfoCtx
 *
˘x
, *
«me
);

605 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_InfoEndDi˘Fõld
)(
RedisModuÀInfoCtx
 *
˘x
);

606 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_InfoAddFõldSåög
)(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, 
RedisModuÀSåög
 *
vÆue
);

607 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_InfoAddFõldCSåög
)(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, *
vÆue
);

608 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_InfoAddFõldDoubÀ
)(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, 
vÆue
);

609 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_InfoAddFõldL⁄gL⁄g
)(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, 
vÆue
);

610 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_InfoAddFõldUL⁄gL⁄g
)(
RedisModuÀInfoCtx
 *
˘x
, *
fõld
, 
vÆue
);

611 
RedisModuÀSîvîInfoD©a
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëSîvîInfo
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
£˘i⁄
);

612 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_FªeSîvîInfo
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSîvîInfoD©a
 *
d©a
);

613 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SîvîInfoGëFõld
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
);

614 c⁄° *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SîvîInfoGëFõldC
)(
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
);

615 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SîvîInfoGëFõldSig√d
)(
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
, *
out_îr
);

616 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SîvîInfoGëFõldUnsig√d
)(
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
, *
out_îr
);

617 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SîvîInfoGëFõldDoubÀ
)(
RedisModuÀSîvîInfoD©a
 *
d©a
, c⁄° * 
fõld
, *
out_îr
);

618 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Subs¸ibeToSîvîEvít
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀEvít
 
evít
, 
RedisModuÀEvítCÆlback
 
ˇŒback
);

619 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SëLRU
)(
RedisModuÀKey
 *
key
, 
m°ime_t
 
Ãu_idÀ
);

620 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëLRU
)(
RedisModuÀKey
 *
key
, 
m°ime_t
 *
Ãu_idÀ
);

621 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SëLFU
)(
RedisModuÀKey
 *
key
, 
lfu_‰eq
);

622 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëLFU
)(
RedisModuÀKey
 *
key
, *
lfu_‰eq
);

623 
RedisModuÀBlockedClõ¡
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_BlockClõ¡OnKeys
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀCmdFunc
 
ª∂y_ˇŒback
, RedisModuÀCmdFun¯
timeout_ˇŒback
, (*
‰ì_¥ivd©a
)(RedisModuÀCtx*,*), 
timeout_ms
, 
RedisModuÀSåög
 **
keys
, 
numkeys
, *
¥ivd©a
);

624 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Sig«lKeyAsRódy
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSåög
 *
key
);

625 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëBlockedClõ¡RódyKey
)(
RedisModuÀCtx
 *
˘x
);

626 
RedisModuÀSˇnCurs‹
 *
	`REDISMODULE_API_FUNC
(
RedisModuÀ_SˇnCurs‹Cª©e
)();

627 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SˇnCurs‹Re°¨t
)(
RedisModuÀSˇnCurs‹
 *
curs‹
);

628 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SˇnCurs‹De°roy
)(
RedisModuÀSˇnCurs‹
 *
curs‹
);

629 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Sˇn
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀSˇnCurs‹
 *
curs‹
, 
RedisModuÀSˇnCB
 
‚
, *
¥ivd©a
);

630 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SˇnKey
)(
RedisModuÀKey
 *
key
, 
RedisModuÀSˇnCurs‹
 *
curs‹
, 
RedisModuÀSˇnKeyCB
 
‚
, *
¥ivd©a
);

632 #ifde‡
REDISMODULE_EXPERIMENTAL_API


633 
	#REDISMODULE_EXPERIMENTAL_API_VERSION
 3

	)

634 
RedisModuÀBlockedClõ¡
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_BlockClõ¡
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀCmdFunc
 
ª∂y_ˇŒback
, RedisModuÀCmdFun¯
timeout_ˇŒback
, (*
‰ì_¥ivd©a
)(RedisModuÀCtx*,*), 
timeout_ms
);

635 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_UnblockClõ¡
)(
RedisModuÀBlockedClõ¡
 *
bc
, *
¥ivd©a
);

636 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_IsBlockedRïlyReque°
)(
RedisModuÀCtx
 *
˘x
);

637 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_IsBlockedTimeoutReque°
)(
RedisModuÀCtx
 *
˘x
);

638 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëBlockedClõ¡Priv©eD©a
)(
RedisModuÀCtx
 *
˘x
);

639 
RedisModuÀBlockedClõ¡
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëBlockedClõ¡H™dÀ
)(
RedisModuÀCtx
 *
˘x
);

640 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Ab‹tBlock
)(
RedisModuÀBlockedClõ¡
 *
bc
);

641 
RedisModuÀCtx
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëThªadSa„C⁄ãxt
)(
RedisModuÀBlockedClõ¡
 *
bc
);

642 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_FªeThªadSa„C⁄ãxt
)(
RedisModuÀCtx
 *
˘x
);

643 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_ThªadSa„C⁄ãxtLock
)(
RedisModuÀCtx
 *
˘x
);

644 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_ThªadSa„C⁄ãxtU∆ock
)(
RedisModuÀCtx
 *
˘x
);

645 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Subs¸ibeToKey•a˚Evíts
)(
RedisModuÀCtx
 *
˘x
, 
ty≥s
, 
RedisModuÀNŸifiˇti⁄Func
 
cb
);

646 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_NŸifyKey•a˚Evít
)(
RedisModuÀCtx
 *
˘x
, 
ty≥
, c⁄° *
evít
, 
RedisModuÀSåög
 *
key
);

647 
	`REDISMODULE_API_FUNC
(
RedisModuÀ_GëNŸifyKey•a˚Evíts
)();

648 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_BlockedClõ¡Disc⁄√˘ed
)(
RedisModuÀCtx
 *
˘x
);

649 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Regi°îClu°îMesßgeRe˚ivî
)(
RedisModuÀCtx
 *
˘x
, 
uöt8_t
 
ty≥
, 
RedisModuÀClu°îMesßgeRe˚ivî
 
ˇŒback
);

650 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SídClu°îMesßge
)(
RedisModuÀCtx
 *
˘x
, *
èrgë_id
, 
uöt8_t
 
ty≥
, *
msg
, 
uöt32_t
 
Àn
);

651 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëClu°îNodeInfo
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
id
, *
ù
, *
ma°î_id
, *
p‹t
, *
Êags
);

652 **
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëClu°îNodesLi°
)(
RedisModuÀCtx
 *
˘x
, 
size_t
 *
numnodes
);

653 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_FªeClu°îNodesLi°
)(**
ids
);

654 
RedisModuÀTimîID
 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eTimî
)(
RedisModuÀCtx
 *
˘x
, 
m°ime_t
 
≥riod
, 
RedisModuÀTimîProc
 
ˇŒback
, *
d©a
);

655 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_St›Timî
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀTimîID
 
id
, **
d©a
);

656 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëTimîInfo
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀTimîID
 
id
, 
uöt64_t
 *
ªmaöög
, **
d©a
);

657 c⁄° *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëMyClu°îID
)();

658 
size_t
 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëClu°îSize
)();

659 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëR™domByãs
)(*
d°
, 
size_t
 
Àn
);

660 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëR™domHexCh¨s
)(*
d°
, 
size_t
 
Àn
);

661 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SëDisc⁄√˘CÆlback
)(
RedisModuÀBlockedClõ¡
 *
bc
, 
RedisModuÀDisc⁄√˘Func
 
ˇŒback
);

662 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SëClu°îFœgs
)(
RedisModuÀCtx
 *
˘x
, 
uöt64_t
 
Êags
);

663 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Exp‹tSh¨edAPI
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
≠öame
, *
func
);

664 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_GëSh¨edAPI
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
≠öame
);

665 
RedisModuÀComm™dFûãr
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Regi°îComm™dFûãr
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀComm™dFûãrFunc
 
cb
, 
Êags
);

666 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Uƒegi°îComm™dFûãr
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀComm™dFûãr
 *
fûãr
);

667 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Comm™dFûãrArgsCou¡
)(
RedisModuÀComm™dFûãrCtx
 *
f˘x
);

668 c⁄° 
RedisModuÀSåög
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Comm™dFûãrArgGë
)(
RedisModuÀComm™dFûãrCtx
 *
f˘x
, 
pos
);

669 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Comm™dFûãrArgIn£π
)(
RedisModuÀComm™dFûãrCtx
 *
f˘x
, 
pos
, 
RedisModuÀSåög
 *
¨g
);

670 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Comm™dFûãrArgRïœ˚
)(
RedisModuÀComm™dFûãrCtx
 *
f˘x
, 
pos
, 
RedisModuÀSåög
 *
¨g
);

671 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Comm™dFûãrArgDñëe
)(
RedisModuÀComm™dFûãrCtx
 *
f˘x
, 
pos
);

672 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_F‹k
)(
RedisModuÀF‹kD⁄eH™dÀr
 
cb
, *
u£r_d©a
);

673 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_ExôFromChûd
)(
ªtcode
);

674 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_KûlF‹kChûd
)(
chûd_pid
);

675 
	`REDISMODULE_API_FUNC
(
RedisModuÀ_GëU£dMem‹yR©io
)();

676 
size_t
 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_MÆlocSize
)(* 
±r
);

677 
RedisModuÀU£r
 *
	$REDISMODULE_API_FUNC
(
RedisModuÀ_Cª©eModuÀU£r
)(c⁄° *
«me
);

678 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_FªeModuÀU£r
)(
RedisModuÀU£r
 *
u£r
);

679 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_SëModuÀU£rACL
)(
RedisModuÀU£r
 *
u£r
, c⁄° * 
a˛
);

680 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_AuthítiˇãClõ¡WôhACLU£r
)(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
size_t
 
Àn
, 
RedisModuÀU£rCh™gedFunc
 
ˇŒback
, *
¥ivd©a
, 
uöt64_t
 *
˛õ¡_id
);

681 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_AuthítiˇãClõ¡WôhU£r
)(
RedisModuÀCtx
 *
˘x
, 
RedisModuÀU£r
 *
u£r
, 
RedisModuÀU£rCh™gedFunc
 
ˇŒback
, *
¥ivd©a
, 
uöt64_t
 *
˛õ¡_id
);

682 
	$REDISMODULE_API_FUNC
(
RedisModuÀ_DóuthítiˇãAndClo£Clõ¡
)(
RedisModuÀCtx
 *
˘x
, 
uöt64_t
 
˛õ¡_id
);

685 
	#RedisModuÀ_IsAOFClõ¡
(
id
Ë((idË=
CLIENT_ID_AOF
)

	)

688 
	$RedisModuÀ_Inô
(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
vî
, 
≠ivî
Ë
	`__©åibuã__
((
unu£d
));

689 
	$RedisModuÀ_Inô
(
RedisModuÀCtx
 *
˘x
, c⁄° *
«me
, 
vî
, 
≠ivî
) {

690 *
gë≠ifun˝å
 = ((**)
˘x
)[0];

691 
RedisModuÀ_GëApi
 = ((*)(c⁄° *, *)Ë()
gë≠ifun˝å
;

692 
	`REDISMODULE_GET_API
(
AŒoc
);

693 
	`REDISMODULE_GET_API
(
CÆloc
);

694 
	`REDISMODULE_GET_API
(
Fªe
);

695 
	`REDISMODULE_GET_API
(
RóŒoc
);

696 
	`REDISMODULE_GET_API
(
Sådup
);

697 
	`REDISMODULE_GET_API
(
Cª©eComm™d
);

698 
	`REDISMODULE_GET_API
(
SëModuÀAâribs
);

699 
	`REDISMODULE_GET_API
(
IsModuÀNameBusy
);

700 
	`REDISMODULE_GET_API
(
Wr⁄gArôy
);

701 
	`REDISMODULE_GET_API
(
RïlyWôhL⁄gL⁄g
);

702 
	`REDISMODULE_GET_API
(
RïlyWôhEº‹
);

703 
	`REDISMODULE_GET_API
(
RïlyWôhSim∂eSåög
);

704 
	`REDISMODULE_GET_API
(
RïlyWôhAºay
);

705 
	`REDISMODULE_GET_API
(
RïlyWôhNuŒAºay
);

706 
	`REDISMODULE_GET_API
(
RïlyWôhEm±yAºay
);

707 
	`REDISMODULE_GET_API
(
RïlySëAºayLígth
);

708 
	`REDISMODULE_GET_API
(
RïlyWôhSåögBuf„r
);

709 
	`REDISMODULE_GET_API
(
RïlyWôhCSåög
);

710 
	`REDISMODULE_GET_API
(
RïlyWôhSåög
);

711 
	`REDISMODULE_GET_API
(
RïlyWôhEm±ySåög
);

712 
	`REDISMODULE_GET_API
(
RïlyWôhVîb©imSåög
);

713 
	`REDISMODULE_GET_API
(
RïlyWôhNuŒ
);

714 
	`REDISMODULE_GET_API
(
RïlyWôhCÆlRïly
);

715 
	`REDISMODULE_GET_API
(
RïlyWôhDoubÀ
);

716 
	`REDISMODULE_GET_API
(
RïlyWôhL⁄gDoubÀ
);

717 
	`REDISMODULE_GET_API
(
GëSñe˘edDb
);

718 
	`REDISMODULE_GET_API
(
Sñe˘Db
);

719 
	`REDISMODULE_GET_API
(
O≥nKey
);

720 
	`REDISMODULE_GET_API
(
Clo£Key
);

721 
	`REDISMODULE_GET_API
(
KeyTy≥
);

722 
	`REDISMODULE_GET_API
(
VÆueLígth
);

723 
	`REDISMODULE_GET_API
(
Li°Push
);

724 
	`REDISMODULE_GET_API
(
Li°P›
);

725 
	`REDISMODULE_GET_API
(
SåögToL⁄gL⁄g
);

726 
	`REDISMODULE_GET_API
(
SåögToDoubÀ
);

727 
	`REDISMODULE_GET_API
(
SåögToL⁄gDoubÀ
);

728 
	`REDISMODULE_GET_API
(
CÆl
);

729 
	`REDISMODULE_GET_API
(
CÆlRïlyPrŸo
);

730 
	`REDISMODULE_GET_API
(
FªeCÆlRïly
);

731 
	`REDISMODULE_GET_API
(
CÆlRïlyI¡egî
);

732 
	`REDISMODULE_GET_API
(
CÆlRïlyTy≥
);

733 
	`REDISMODULE_GET_API
(
CÆlRïlyLígth
);

734 
	`REDISMODULE_GET_API
(
CÆlRïlyAºayEÀmít
);

735 
	`REDISMODULE_GET_API
(
CÆlRïlySåögPå
);

736 
	`REDISMODULE_GET_API
(
Cª©eSåögFromCÆlRïly
);

737 
	`REDISMODULE_GET_API
(
Cª©eSåög
);

738 
	`REDISMODULE_GET_API
(
Cª©eSåögFromL⁄gL⁄g
);

739 
	`REDISMODULE_GET_API
(
Cª©eSåögFromDoubÀ
);

740 
	`REDISMODULE_GET_API
(
Cª©eSåögFromL⁄gDoubÀ
);

741 
	`REDISMODULE_GET_API
(
Cª©eSåögFromSåög
);

742 
	`REDISMODULE_GET_API
(
Cª©eSåögPrötf
);

743 
	`REDISMODULE_GET_API
(
FªeSåög
);

744 
	`REDISMODULE_GET_API
(
SåögPåLí
);

745 
	`REDISMODULE_GET_API
(
AutoMem‹y
);

746 
	`REDISMODULE_GET_API
(
Rïliˇã
);

747 
	`REDISMODULE_GET_API
(
RïliˇãVîb©im
);

748 
	`REDISMODULE_GET_API
(
DñëeKey
);

749 
	`REDISMODULE_GET_API
(
U∆ökKey
);

750 
	`REDISMODULE_GET_API
(
SåögSë
);

751 
	`REDISMODULE_GET_API
(
SåögDMA
);

752 
	`REDISMODULE_GET_API
(
SåögTrunˇã
);

753 
	`REDISMODULE_GET_API
(
GëExpúe
);

754 
	`REDISMODULE_GET_API
(
SëExpúe
);

755 
	`REDISMODULE_GET_API
(
Re£tD©a£t
);

756 
	`REDISMODULE_GET_API
(
DbSize
);

757 
	`REDISMODULE_GET_API
(
R™domKey
);

758 
	`REDISMODULE_GET_API
(
Z£tAdd
);

759 
	`REDISMODULE_GET_API
(
Z£tIn¸by
);

760 
	`REDISMODULE_GET_API
(
Z£tSc‹e
);

761 
	`REDISMODULE_GET_API
(
Z£tRem
);

762 
	`REDISMODULE_GET_API
(
Z£tR™geSt›
);

763 
	`REDISMODULE_GET_API
(
Z£tFú°InSc‹eR™ge
);

764 
	`REDISMODULE_GET_API
(
Z£tLa°InSc‹eR™ge
);

765 
	`REDISMODULE_GET_API
(
Z£tFú°InLexR™ge
);

766 
	`REDISMODULE_GET_API
(
Z£tLa°InLexR™ge
);

767 
	`REDISMODULE_GET_API
(
Z£tR™geCuºítEÀmít
);

768 
	`REDISMODULE_GET_API
(
Z£tR™geNext
);

769 
	`REDISMODULE_GET_API
(
Z£tR™gePªv
);

770 
	`REDISMODULE_GET_API
(
Z£tR™geEndRóched
);

771 
	`REDISMODULE_GET_API
(
HashSë
);

772 
	`REDISMODULE_GET_API
(
HashGë
);

773 
	`REDISMODULE_GET_API
(
IsKeysPosôi⁄Reque°
);

774 
	`REDISMODULE_GET_API
(
KeyAtPos
);

775 
	`REDISMODULE_GET_API
(
GëClõ¡Id
);

776 
	`REDISMODULE_GET_API
(
GëC⁄ãxtFœgs
);

777 
	`REDISMODULE_GET_API
(
AvoidRïliˇTøffic
);

778 
	`REDISMODULE_GET_API
(
PoﬁAŒoc
);

779 
	`REDISMODULE_GET_API
(
Cª©eD©aTy≥
);

780 
	`REDISMODULE_GET_API
(
ModuÀTy≥SëVÆue
);

781 
	`REDISMODULE_GET_API
(
ModuÀTy≥Rïœ˚VÆue
);

782 
	`REDISMODULE_GET_API
(
ModuÀTy≥GëTy≥
);

783 
	`REDISMODULE_GET_API
(
ModuÀTy≥GëVÆue
);

784 
	`REDISMODULE_GET_API
(
IsIOEº‹
);

785 
	`REDISMODULE_GET_API
(
SëModuÀO±i⁄s
);

786 
	`REDISMODULE_GET_API
(
Sig«lModifõdKey
);

787 
	`REDISMODULE_GET_API
(
SaveUnsig√d
);

788 
	`REDISMODULE_GET_API
(
LﬂdUnsig√d
);

789 
	`REDISMODULE_GET_API
(
SaveSig√d
);

790 
	`REDISMODULE_GET_API
(
LﬂdSig√d
);

791 
	`REDISMODULE_GET_API
(
SaveSåög
);

792 
	`REDISMODULE_GET_API
(
SaveSåögBuf„r
);

793 
	`REDISMODULE_GET_API
(
LﬂdSåög
);

794 
	`REDISMODULE_GET_API
(
LﬂdSåögBuf„r
);

795 
	`REDISMODULE_GET_API
(
SaveDoubÀ
);

796 
	`REDISMODULE_GET_API
(
LﬂdDoubÀ
);

797 
	`REDISMODULE_GET_API
(
SaveFlﬂt
);

798 
	`REDISMODULE_GET_API
(
LﬂdFlﬂt
);

799 
	`REDISMODULE_GET_API
(
SaveL⁄gDoubÀ
);

800 
	`REDISMODULE_GET_API
(
LﬂdL⁄gDoubÀ
);

801 
	`REDISMODULE_GET_API
(
SaveD©aTy≥ToSåög
);

802 
	`REDISMODULE_GET_API
(
LﬂdD©aTy≥FromSåög
);

803 
	`REDISMODULE_GET_API
(
EmôAOF
);

804 
	`REDISMODULE_GET_API
(
Log
);

805 
	`REDISMODULE_GET_API
(
LogIOEº‹
);

806 
	`REDISMODULE_GET_API
(
_As£π
);

807 
	`REDISMODULE_GET_API
(
L©ícyAddSam∂e
);

808 
	`REDISMODULE_GET_API
(
SåögAµídBuf„r
);

809 
	`REDISMODULE_GET_API
(
RëaöSåög
);

810 
	`REDISMODULE_GET_API
(
SåögCom∑ª
);

811 
	`REDISMODULE_GET_API
(
GëC⁄ãxtFromIO
);

812 
	`REDISMODULE_GET_API
(
GëKeyNameFromIO
);

813 
	`REDISMODULE_GET_API
(
GëKeyNameFromModuÀKey
);

814 
	`REDISMODULE_GET_API
(
Mûli£c⁄ds
);

815 
	`REDISMODULE_GET_API
(
Dige°AddSåögBuf„r
);

816 
	`REDISMODULE_GET_API
(
Dige°AddL⁄gL⁄g
);

817 
	`REDISMODULE_GET_API
(
Dige°EndSequí˚
);

818 
	`REDISMODULE_GET_API
(
Cª©eDi˘
);

819 
	`REDISMODULE_GET_API
(
FªeDi˘
);

820 
	`REDISMODULE_GET_API
(
Di˘Size
);

821 
	`REDISMODULE_GET_API
(
Di˘SëC
);

822 
	`REDISMODULE_GET_API
(
Di˘Rïœ˚C
);

823 
	`REDISMODULE_GET_API
(
Di˘Së
);

824 
	`REDISMODULE_GET_API
(
Di˘Rïœ˚
);

825 
	`REDISMODULE_GET_API
(
Di˘GëC
);

826 
	`REDISMODULE_GET_API
(
Di˘Gë
);

827 
	`REDISMODULE_GET_API
(
Di˘DñC
);

828 
	`REDISMODULE_GET_API
(
Di˘Dñ
);

829 
	`REDISMODULE_GET_API
(
Di˘Iãøt‹SèπC
);

830 
	`REDISMODULE_GET_API
(
Di˘Iãøt‹Sèπ
);

831 
	`REDISMODULE_GET_API
(
Di˘Iãøt‹St›
);

832 
	`REDISMODULE_GET_API
(
Di˘Iãøt‹Re£ekC
);

833 
	`REDISMODULE_GET_API
(
Di˘Iãøt‹Re£ek
);

834 
	`REDISMODULE_GET_API
(
Di˘NextC
);

835 
	`REDISMODULE_GET_API
(
Di˘PªvC
);

836 
	`REDISMODULE_GET_API
(
Di˘Next
);

837 
	`REDISMODULE_GET_API
(
Di˘Pªv
);

838 
	`REDISMODULE_GET_API
(
Di˘Com∑ª
);

839 
	`REDISMODULE_GET_API
(
Di˘Com∑ªC
);

840 
	`REDISMODULE_GET_API
(
Regi°îInfoFunc
);

841 
	`REDISMODULE_GET_API
(
InfoAddSe˘i⁄
);

842 
	`REDISMODULE_GET_API
(
InfoBegöDi˘Fõld
);

843 
	`REDISMODULE_GET_API
(
InfoEndDi˘Fõld
);

844 
	`REDISMODULE_GET_API
(
InfoAddFõldSåög
);

845 
	`REDISMODULE_GET_API
(
InfoAddFõldCSåög
);

846 
	`REDISMODULE_GET_API
(
InfoAddFõldDoubÀ
);

847 
	`REDISMODULE_GET_API
(
InfoAddFõldL⁄gL⁄g
);

848 
	`REDISMODULE_GET_API
(
InfoAddFõldUL⁄gL⁄g
);

849 
	`REDISMODULE_GET_API
(
GëSîvîInfo
);

850 
	`REDISMODULE_GET_API
(
FªeSîvîInfo
);

851 
	`REDISMODULE_GET_API
(
SîvîInfoGëFõld
);

852 
	`REDISMODULE_GET_API
(
SîvîInfoGëFõldC
);

853 
	`REDISMODULE_GET_API
(
SîvîInfoGëFõldSig√d
);

854 
	`REDISMODULE_GET_API
(
SîvîInfoGëFõldUnsig√d
);

855 
	`REDISMODULE_GET_API
(
SîvîInfoGëFõldDoubÀ
);

856 
	`REDISMODULE_GET_API
(
GëClõ¡InfoById
);

857 
	`REDISMODULE_GET_API
(
PublishMesßge
);

858 
	`REDISMODULE_GET_API
(
Subs¸ibeToSîvîEvít
);

859 
	`REDISMODULE_GET_API
(
SëLRU
);

860 
	`REDISMODULE_GET_API
(
GëLRU
);

861 
	`REDISMODULE_GET_API
(
SëLFU
);

862 
	`REDISMODULE_GET_API
(
GëLFU
);

863 
	`REDISMODULE_GET_API
(
BlockClõ¡OnKeys
);

864 
	`REDISMODULE_GET_API
(
Sig«lKeyAsRódy
);

865 
	`REDISMODULE_GET_API
(
GëBlockedClõ¡RódyKey
);

866 
	`REDISMODULE_GET_API
(
SˇnCurs‹Cª©e
);

867 
	`REDISMODULE_GET_API
(
SˇnCurs‹Re°¨t
);

868 
	`REDISMODULE_GET_API
(
SˇnCurs‹De°roy
);

869 
	`REDISMODULE_GET_API
(
Sˇn
);

870 
	`REDISMODULE_GET_API
(
SˇnKey
);

872 #ifde‡
REDISMODULE_EXPERIMENTAL_API


873 
	`REDISMODULE_GET_API
(
GëThªadSa„C⁄ãxt
);

874 
	`REDISMODULE_GET_API
(
FªeThªadSa„C⁄ãxt
);

875 
	`REDISMODULE_GET_API
(
ThªadSa„C⁄ãxtLock
);

876 
	`REDISMODULE_GET_API
(
ThªadSa„C⁄ãxtU∆ock
);

877 
	`REDISMODULE_GET_API
(
BlockClõ¡
);

878 
	`REDISMODULE_GET_API
(
UnblockClõ¡
);

879 
	`REDISMODULE_GET_API
(
IsBlockedRïlyReque°
);

880 
	`REDISMODULE_GET_API
(
IsBlockedTimeoutReque°
);

881 
	`REDISMODULE_GET_API
(
GëBlockedClõ¡Priv©eD©a
);

882 
	`REDISMODULE_GET_API
(
GëBlockedClõ¡H™dÀ
);

883 
	`REDISMODULE_GET_API
(
Ab‹tBlock
);

884 
	`REDISMODULE_GET_API
(
SëDisc⁄√˘CÆlback
);

885 
	`REDISMODULE_GET_API
(
Subs¸ibeToKey•a˚Evíts
);

886 
	`REDISMODULE_GET_API
(
NŸifyKey•a˚Evít
);

887 
	`REDISMODULE_GET_API
(
GëNŸifyKey•a˚Evíts
);

888 
	`REDISMODULE_GET_API
(
BlockedClõ¡Disc⁄√˘ed
);

889 
	`REDISMODULE_GET_API
(
Regi°îClu°îMesßgeRe˚ivî
);

890 
	`REDISMODULE_GET_API
(
SídClu°îMesßge
);

891 
	`REDISMODULE_GET_API
(
GëClu°îNodeInfo
);

892 
	`REDISMODULE_GET_API
(
GëClu°îNodesLi°
);

893 
	`REDISMODULE_GET_API
(
FªeClu°îNodesLi°
);

894 
	`REDISMODULE_GET_API
(
Cª©eTimî
);

895 
	`REDISMODULE_GET_API
(
St›Timî
);

896 
	`REDISMODULE_GET_API
(
GëTimîInfo
);

897 
	`REDISMODULE_GET_API
(
GëMyClu°îID
);

898 
	`REDISMODULE_GET_API
(
GëClu°îSize
);

899 
	`REDISMODULE_GET_API
(
GëR™domByãs
);

900 
	`REDISMODULE_GET_API
(
GëR™domHexCh¨s
);

901 
	`REDISMODULE_GET_API
(
SëClu°îFœgs
);

902 
	`REDISMODULE_GET_API
(
Exp‹tSh¨edAPI
);

903 
	`REDISMODULE_GET_API
(
GëSh¨edAPI
);

904 
	`REDISMODULE_GET_API
(
Regi°îComm™dFûãr
);

905 
	`REDISMODULE_GET_API
(
Uƒegi°îComm™dFûãr
);

906 
	`REDISMODULE_GET_API
(
Comm™dFûãrArgsCou¡
);

907 
	`REDISMODULE_GET_API
(
Comm™dFûãrArgGë
);

908 
	`REDISMODULE_GET_API
(
Comm™dFûãrArgIn£π
);

909 
	`REDISMODULE_GET_API
(
Comm™dFûãrArgRïœ˚
);

910 
	`REDISMODULE_GET_API
(
Comm™dFûãrArgDñëe
);

911 
	`REDISMODULE_GET_API
(
F‹k
);

912 
	`REDISMODULE_GET_API
(
ExôFromChûd
);

913 
	`REDISMODULE_GET_API
(
KûlF‹kChûd
);

914 
	`REDISMODULE_GET_API
(
GëU£dMem‹yR©io
);

915 
	`REDISMODULE_GET_API
(
MÆlocSize
);

916 
	`REDISMODULE_GET_API
(
Cª©eModuÀU£r
);

917 
	`REDISMODULE_GET_API
(
FªeModuÀU£r
);

918 
	`REDISMODULE_GET_API
(
SëModuÀU£rACL
);

919 
	`REDISMODULE_GET_API
(
DóuthítiˇãAndClo£Clõ¡
);

920 
	`REDISMODULE_GET_API
(
AuthítiˇãClõ¡WôhACLU£r
);

921 
	`REDISMODULE_GET_API
(
AuthítiˇãClõ¡WôhU£r
);

924 i‡(
RedisModuÀ_IsModuÀNameBusy
 && 
	`RedisModuÀ_IsModuÀNameBusy
(
«me
)Ë 
REDISMODULE_ERR
;

925 
	`RedisModuÀ_SëModuÀAâribs
(
˘x
,
«me
,
vî
,
≠ivî
);

926  
REDISMODULE_OK
;

927 
	}
}

929 
	#RedisModuÀ_As£π
(
_e
Ë((_e)?()0 : (
	`RedisModuÀ__As£π
(#_e,
__FILE__
,
__LINE__
),
	`exô
(1)))

	)

935 
	#RedisModuÀSåög
 
robj


	)

	@release.c

34 
	~<°rög.h
>

35 
	~<°dio.h
>

37 
	~"ªÀa£.h
"

38 
	~"vîsi⁄.h
"

39 
	~"¸c64.h
"

41 *
	$ªdisGôSHA1
() {

42  
REDIS_GIT_SHA1
;

43 
	}
}

45 *
	$ªdisGôDúty
() {

46  
REDIS_GIT_DIRTY
;

47 
	}
}

49 
uöt64_t
 
	$ªdisBuûdId
() {

50 *
buûdid
 = 
REDIS_VERSION
 
REDIS_BUILD_ID
 
REDIS_GIT_DIRTY
 
REDIS_GIT_SHA1
;

52  
	`¸c64
(0,(*)
buûdid
,
	`°æí
(buildid));

53 
	}
}

58 *
	$ªdisBuûdIdSåög
() {

59 
buf
[32];

60 
ˇched
 = 0;

61 i‡(!
ˇched
) {

62 
	`¢¥ötf
(
buf
,(buf),"%Œx",(Ë
	`ªdisBuûdId
());

63 
ˇched
 = 1;

65  
buf
;

66 
	}
}

	@release.h

1 
	#REDIS_GIT_SHA1
 "00000000"

	)

2 
	#REDIS_GIT_DIRTY
 "0"

	)

3 
	#REDIS_BUILD_ID
 "debün-ho°«me-1590504883"

	)

	@replication.c

32 
	~"£rvî.h
"

33 
	~"˛u°î.h
"

34 
	~"bio.h
"

36 
	~<sys/time.h
>

37 
	~<uni°d.h
>

38 
	~<f˙é.h
>

39 
	~<sys/sockë.h
>

40 
	~<sys/°©.h
>

42 
adju°MónögfulRïlOff£t
();

43 
ª∂iˇti⁄DisˇrdCachedMa°î
();

44 
ª∂iˇti⁄Resuºe˘CachedMa°î
(
c⁄√˘i⁄
 *
c⁄n
);

45 
ª∂iˇti⁄SídAck
();

46 
putSœveO∆öe
(
˛õ¡
 *
¶ave
);

47 
ˇn˚lRïliˇti⁄H™dshake
();

52 
	gRDBGíî©edByRïliˇti⁄
 = 0;

60 *
	$ª∂iˇti⁄GëSœveName
(
˛õ¡
 *
c
) {

61 
buf
[
NET_PEER_ID_LEN
];

62 
ù
[
NET_IP_STR_LEN
];

64 
ù
[0] = '\0';

65 
buf
[0] = '\0';

66 i‡(
c
->
¶ave_ù
[0] != '\0' ||

67 
	`c⁄nPìrToSåög
(
c
->
c⁄n
,
ù
,(ù),
NULL
) != -1)

70 i‡(
c
->
¶ave_ù
[0] !'\0'Ë
	`mem˝y
(
ù
,c->slave_ip,(c->slave_ip));

72 i‡(
c
->
¶ave_li°íög_p‹t
)

73 
	`™ëF‹m©Addr
(
buf
,(buf),
ù
,
c
->
¶ave_li°íög_p‹t
);

75 
	`¢¥ötf
(
buf
,(buf),"%s:<unknown-ª∂iˇ-p‹t>",
ù
);

77 
	`¢¥ötf
(
buf
,(buf),"client id #%llu",

78 (Ë
c
->
id
);

80  
buf
;

81 
	}
}

89 
	$bg_u∆ök
(c⁄° *
fûíame
) {

90 
fd
 = 
	`›í
(
fûíame
,
O_RDONLY
|
O_NONBLOCK
);

91 i‡(
fd
 == -1) {

93  
	`u∆ök
(
fûíame
);

97 
ªtvÆ
 = 
	`u∆ök
(
fûíame
);

98 i‡(
ªtvÆ
 == -1) {

101 
ﬁd_î∫o
 = 
î∫o
;

102 
	`˛o£
(
fd
);

103 
î∫o
 = 
ﬁd_î∫o
;

106 
	`bioCª©eBackgroundJob
(
BIO_CLOSE_FILE
,(*)()
fd
,
NULL
,NULL);

109 
	}
}

113 
	$¸óãRïliˇti⁄Backlog
() {

114 
	`£rvîAs£π
(
£rvî
.
ª∂_backlog
 =
NULL
);

115 
£rvî
.
ª∂_backlog
 = 
	`zmÆloc
(£rvî.
ª∂_backlog_size
);

116 
£rvî
.
ª∂_backlog_hi°Àn
 = 0;

117 
£rvî
.
ª∂_backlog_idx
 = 0;

122 
£rvî
.
ª∂_backlog_off
 = sîvî.
ma°î_ª∂_off£t
+1;

123 
	}
}

131 
	$ªsizeRïliˇti⁄Backlog
(
√wsize
) {

132 i‡(
√wsize
 < 
CONFIG_REPL_BACKLOG_MIN_SIZE
)

133 
√wsize
 = 
CONFIG_REPL_BACKLOG_MIN_SIZE
;

134 i‡(
£rvî
.
ª∂_backlog_size
 =
√wsize
) ;

136 
£rvî
.
ª∂_backlog_size
 = 
√wsize
;

137 i‡(
£rvî
.
ª∂_backlog
 !
NULL
) {

143 
	`z‰ì
(
£rvî
.
ª∂_backlog
);

144 
£rvî
.
ª∂_backlog
 = 
	`zmÆloc
(£rvî.
ª∂_backlog_size
);

145 
£rvî
.
ª∂_backlog_hi°Àn
 = 0;

146 
£rvî
.
ª∂_backlog_idx
 = 0;

148 
£rvî
.
ª∂_backlog_off
 = sîvî.
ma°î_ª∂_off£t
+1;

150 
	}
}

152 
	$‰ìRïliˇti⁄Backlog
() {

153 
	`£rvîAs£π
(
	`li°Lígth
(
£rvî
.
¶aves
) == 0);

154 
	`z‰ì
(
£rvî
.
ª∂_backlog
);

155 
£rvî
.
ª∂_backlog
 = 
NULL
;

156 
	}
}

162 
	$„edRïliˇti⁄Backlog
(*
±r
, 
size_t
 
Àn
) {

163 *
p
 = 
±r
;

165 
£rvî
.
ma°î_ª∂_off£t
 +
Àn
;

166 
£rvî
.
ma°î_ª∂_mónögful_off£t
 = sîvî.
ma°î_ª∂_off£t
;

170 
Àn
) {

171 
size_t
 
thi¶í
 = 
£rvî
.
ª∂_backlog_size
 - sîvî.
ª∂_backlog_idx
;

172 i‡(
thi¶í
 > 
Àn
)Åhislen =Üen;

173 
	`mem˝y
(
£rvî
.
ª∂_backlog
+£rvî.
ª∂_backlog_idx
,
p
,
thi¶í
);

174 
£rvî
.
ª∂_backlog_idx
 +
thi¶í
;

175 i‡(
£rvî
.
ª∂_backlog_idx
 =£rvî.
ª∂_backlog_size
)

176 
£rvî
.
ª∂_backlog_idx
 = 0;

177 
Àn
 -
thi¶í
;

178 
p
 +
thi¶í
;

179 
£rvî
.
ª∂_backlog_hi°Àn
 +
thi¶í
;

181 i‡(
£rvî
.
ª∂_backlog_hi°Àn
 > sîvî.
ª∂_backlog_size
)

182 
£rvî
.
ª∂_backlog_hi°Àn
 = sîvî.
ª∂_backlog_size
;

184 
£rvî
.
ª∂_backlog_off
 = sîvî.
ma°î_ª∂_off£t
 -

185 
£rvî
.
ª∂_backlog_hi°Àn
 + 1;

186 
	}
}

190 
	$„edRïliˇti⁄BacklogWôhObje˘
(
robj
 *
o
) {

191 
Œ°r
[
LONG_STR_SIZE
];

192 *
p
;

193 
size_t
 
Àn
;

195 i‡(
o
->
ícodög
 =
OBJ_ENCODING_INT
) {

196 
Àn
 = 
	`Œ2°rög
(
Œ°r
,÷l°r),()
o
->
±r
);

197 
p
 = 
Œ°r
;

199 
Àn
 = 
	`sd¶í
(
o
->
±r
);

200 
p
 = 
o
->
±r
;

202 
	`„edRïliˇti⁄Backlog
(
p
,
Àn
);

203 
	}
}

210 
	$ª∂iˇti⁄FìdSœves
(
li°
 *
¶aves
, 
di˘id
, 
robj
 **
¨gv
, 
¨gc
) {

211 
li°Node
 *
 
;

212 
li°Iãr
 
li
;

213 
j
, 
Àn
;

214 
Œ°r
[
LONG_STR_SIZE
];

221 i‡(
£rvî
.
ma°îho°
 !
NULL
) ;

225 i‡(
£rvî
.
ª∂_backlog
 =
NULL
 && 
	`li°Lígth
(
¶aves
) == 0) ;

228 
	`£rvîAs£π
(!(
	`li°Lígth
(
¶aves
Ë!0 && 
£rvî
.
ª∂_backlog
 =
NULL
));

231 i‡(
£rvî
.
¶ave£ldb
 !
di˘id
) {

232 
robj
 *
£À˘cmd
;

235 i‡(
di˘id
 >0 && di˘id < 
PROTO_SHARED_SELECT_CMDS
) {

236 
£À˘cmd
 = 
sh¨ed
.
£À˘
[
di˘id
];

238 
di˘id_Àn
;

240 
di˘id_Àn
 = 
	`Œ2°rög
(
Œ°r
,÷l°r),
di˘id
);

241 
£À˘cmd
 = 
	`¸óãObje˘
(
OBJ_STRING
,

242 
	`sdsˇçrötf
(
	`sd£m±y
(),

244 
di˘id_Àn
, 
Œ°r
));

248 i‡(
£rvî
.
ª∂_backlog
Ë
	`„edRïliˇti⁄BacklogWôhObje˘
(
£À˘cmd
);

251 
	`li°Rewöd
(
¶aves
,&
li
);

252 (
 
 = 
	`li°Next
(&
li
))) {

253 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

254 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
) ;

255 
	`addRïly
(
¶ave
,
£À˘cmd
);

258 i‡(
di˘id
 < 0 || di˘id >
PROTO_SHARED_SELECT_CMDS
)

259 
	`de¸RefCou¡
(
£À˘cmd
);

261 
£rvî
.
¶ave£ldb
 = 
di˘id
;

264 i‡(
£rvî
.
ª∂_backlog
) {

265 
aux
[
LONG_STR_SIZE
+3];

268 
aux
[0] = '*';

269 
Àn
 = 
	`Œ2°rög
(
aux
+1,◊ux)-1,
¨gc
);

270 
aux
[
Àn
+1] = '\r';

271 
aux
[
Àn
+2] = '\n';

272 
	`„edRïliˇti⁄Backlog
(
aux
,
Àn
+3);

274 
j
 = 0; j < 
¨gc
; j++) {

275 
objÀn
 = 
	`°rögObje˘Lí
(
¨gv
[
j
]);

280 
aux
[0] = '$';

281 
Àn
 = 
	`Œ2°rög
(
aux
+1,◊ux)-1,
objÀn
);

282 
aux
[
Àn
+1] = '\r';

283 
aux
[
Àn
+2] = '\n';

284 
	`„edRïliˇti⁄Backlog
(
aux
,
Àn
+3);

285 
	`„edRïliˇti⁄BacklogWôhObje˘
(
¨gv
[
j
]);

286 
	`„edRïliˇti⁄Backlog
(
aux
+
Àn
+1,2);

291 
	`li°Rewöd
(
¶aves
,&
li
);

292 (
 
 = 
	`li°Next
(&
li
))) {

293 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

296 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
) ;

303 
	`addRïlyAºayLí
(
¶ave
,
¨gc
);

307 
j
 = 0; j < 
¨gc
; j++)

308 
	`addRïlyBulk
(
¶ave
,
¨gv
[
j
]);

310 
	}
}

314 
	~<˘y≥.h
>

315 
	$ª∂iˇti⁄FìdSœvesFromMa°îSåóm
(
li°
 *
¶aves
, *
buf
, 
size_t
 
buÊí
) {

316 
li°Node
 *
 
;

317 
li°Iãr
 
li
;

322 
	`¥ötf
("%zu:",
buÊí
);

323 
size_t
 
j
 = 0; j < 
buÊí
; j++) {

324 
	`¥ötf
("%c", 
	`i•röt
(
buf
[
j
]) ? buf[j] : '.');

326 
	`¥ötf
("\n");

329 i‡(
£rvî
.
ª∂_backlog
Ë
	`„edRïliˇti⁄Backlog
(
buf
,
buÊí
);

330 
	`li°Rewöd
(
¶aves
,&
li
);

331 (
 
 = 
	`li°Next
(&
li
))) {

332 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

335 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
) ;

336 
	`addRïlyPrŸo
(
¶ave
,
buf
,
buÊí
);

338 
	}
}

340 
	$ª∂iˇti⁄FìdM⁄ô‹s
(
˛õ¡
 *
c
, 
li°
 *
m⁄ô‹s
, 
di˘id
, 
robj
 **
¨gv
, 
¨gc
) {

341 
li°Node
 *
 
;

342 
li°Iãr
 
li
;

343 
j
;

344 
sds
 
cmdª¥
 = 
	`sd¢ew
("+");

345 
robj
 *
cmdobj
;

346 
timevÆ
 
tv
;

348 
	`gëtimeofday
(&
tv
,
NULL
);

349 
cmdª¥
 = 
	`sdsˇçrötf
(cmdª¥,"%ld.%06ld ",()
tv
.
tv_£c
,(Èv.
tv_u£c
);

350 i‡(
c
->
Êags
 & 
CLIENT_LUA
) {

351 
cmdª¥
 = 
	`sdsˇçrötf
(cmdª¥,"[%dÜua] ",
di˘id
);

352 } i‡(
c
->
Êags
 & 
CLIENT_UNIX_SOCKET
) {

353 
cmdª¥
 = 
	`sdsˇçrötf
(cmdª¥,"[%d unix:%s] ",
di˘id
,
£rvî
.
unixsockë
);

355 
cmdª¥
 = 
	`sdsˇçrötf
(cmdª¥,"[%d %s] ",
di˘id
,
	`gëClõ¡PìrId
(
c
));

358 
j
 = 0; j < 
¨gc
; j++) {

359 i‡(
¨gv
[
j
]->
ícodög
 =
OBJ_ENCODING_INT
) {

360 
cmdª¥
 = 
	`sdsˇçrötf
(cmdª¥, "\"%ld\"", ()
¨gv
[
j
]->
±r
);

362 
cmdª¥
 = 
	`sdsˇåïr
(cmdª¥,(*)
¨gv
[
j
]->
±r
,

363 
	`sd¶í
(
¨gv
[
j
]->
±r
));

365 i‡(
j
 !
¨gc
-1)

366 
cmdª¥
 = 
	`sdsˇéí
(cmdrepr," ",1);

368 
cmdª¥
 = 
	`sdsˇéí
(cmdrepr,"\r\n",2);

369 
cmdobj
 = 
	`¸óãObje˘
(
OBJ_STRING
,
cmdª¥
);

371 
	`li°Rewöd
(
m⁄ô‹s
,&
li
);

372 (
 
 = 
	`li°Next
(&
li
))) {

373 
˛õ¡
 *
m⁄ô‹
 = 
 
->
vÆue
;

374 
	`addRïly
(
m⁄ô‹
,
cmdobj
);

376 
	`de¸RefCou¡
(
cmdobj
);

377 
	}
}

381 
	$addRïlyRïliˇti⁄Backlog
(
˛õ¡
 *
c
, 
off£t
) {

382 
j
, 
skù
, 
Àn
;

384 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC] RïliˇÑeque° off£t: %Œd", 
off£t
);

386 i‡(
£rvî
.
ª∂_backlog_hi°Àn
 == 0) {

387 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC] Backlog historyÜen is zero");

391 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC] Backlog size: %lld",

392 
£rvî
.
ª∂_backlog_size
);

393 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC] First byte: %lld",

394 
£rvî
.
ª∂_backlog_off
);

395 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC] HistoryÜen: %lld",

396 
£rvî
.
ª∂_backlog_hi°Àn
);

397 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC] Current index: %lld",

398 
£rvî
.
ª∂_backlog_idx
);

401 
skù
 = 
off£t
 - 
£rvî
.
ª∂_backlog_off
;

402 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC] Skùpög: %Œd", 
skù
);

406 
j
 = (
£rvî
.
ª∂_backlog_idx
 +

407 (
£rvî
.
ª∂_backlog_size
-£rvî.
ª∂_backlog_hi°Àn
)) %

408 
£rvî
.
ª∂_backlog_size
;

409 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC] Index o‡fú° byã: %Œd", 
j
);

412 
j
 = (j + 
skù
Ë% 
£rvî
.
ª∂_backlog_size
;

416 
Àn
 = 
£rvî
.
ª∂_backlog_hi°Àn
 - 
skù
;

417 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC] RïlyÅŸÆÜígth: %Œd", 
Àn
);

418 
Àn
) {

419 
thi¶í
 =

420 ((
£rvî
.
ª∂_backlog_size
 - 
j
Ë< 
Àn
) ?

421 (
£rvî
.
ª∂_backlog_size
 - 
j
Ë: 
Àn
;

423 
	`£rvîLog
(
LL_DEBUG
, "[PSYNC]áddRïly(ËÀngth: %Œd", 
thi¶í
);

424 
	`addRïlySds
(
c
,
	`sd¢ewÀn
(
£rvî
.
ª∂_backlog
 + 
j
, 
thi¶í
));

425 
Àn
 -
thi¶í
;

426 
j
 = 0;

428  
£rvî
.
ª∂_backlog_hi°Àn
 - 
skù
;

429 
	}
}

435 
	$gëPsyncInôülOff£t
() {

436  
£rvî
.
ma°î_ª∂_off£t
;

437 
	}
}

455 
	$ª∂iˇti⁄SëupSœveF‹FuŒResync
(
˛õ¡
 *
¶ave
, 
off£t
) {

456 
buf
[128];

457 
buÊí
;

459 
¶ave
->
psync_öôül_off£t
 = 
off£t
;

460 
¶ave
->
ª∂°©e
 = 
SLAVE_STATE_WAIT_BGSAVE_END
;

464 
£rvî
.
¶ave£ldb
 = -1;

468 i‡(!(
¶ave
->
Êags
 & 
CLIENT_PRE_PSYNC
)) {

469 
buÊí
 = 
	`¢¥ötf
(
buf
,(buf),"+FULLRESYNC %s %lld\r\n",

470 
£rvî
.
ª∂id
,
off£t
);

471 i‡(
	`c⁄nWrôe
(
¶ave
->
c⁄n
,
buf
,
buÊí
) != buflen) {

472 
	`‰ìClõ¡Async
(
¶ave
);

473  
C_ERR
;

476  
C_OK
;

477 
	}
}

484 
	$ma°îTryP¨tülResynchr⁄iz©i⁄
(
˛õ¡
 *
c
) {

485 
psync_off£t
, 
psync_Àn
;

486 *
ma°î_ª∂id
 = 
c
->
¨gv
[1]->
±r
;

487 
buf
[128];

488 
buÊí
;

493 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
psync_off£t
,
NULL
) !=

494 
C_OK
Ë
√ed_fuŒ_ªsync
;

502 i‡(
	`°rˇ£cmp
(
ma°î_ª∂id
, 
£rvî
.
ª∂id
) &&

503 (
	`°rˇ£cmp
(
ma°î_ª∂id
, 
£rvî
.
ª∂id2
) ||

504 
psync_off£t
 > 
£rvî
.
£c⁄d_ª∂id_off£t
))

507 i‡(
ma°î_ª∂id
[0] != '?') {

508 i‡(
	`°rˇ£cmp
(
ma°î_ª∂id
, 
£rvî
.
ª∂id
) &&

509 
	`°rˇ£cmp
(
ma°î_ª∂id
, 
£rvî
.
ª∂id2
))

511 
	`£rvîLog
(
LL_NOTICE
,"PartialÑesynchronizationÇotáccepted: "

514 
ma°î_ª∂id
, 
£rvî
.
ª∂id
, sîvî.
ª∂id2
);

516 
	`£rvîLog
(
LL_NOTICE
,"PartialÑesynchronizationÇotáccepted: "

518 "u∞tÿ%Œd", 
psync_off£t
, 
£rvî
.
£c⁄d_ª∂id_off£t
);

521 
	`£rvîLog
(
LL_NOTICE
,"FullÑesyncÑequested byÑeplica %s",

522 
	`ª∂iˇti⁄GëSœveName
(
c
));

524 
√ed_fuŒ_ªsync
;

528 i‡(!
£rvî
.
ª∂_backlog
 ||

529 
psync_off£t
 < 
£rvî
.
ª∂_backlog_off
 ||

530 
psync_off£t
 > (
£rvî
.
ª∂_backlog_off
 + sîvî.
ª∂_backlog_hi°Àn
))

532 
	`£rvîLog
(
LL_NOTICE
,

533 "U«bÀÅÿ∑πü»ªsyn¯wôhÑïliˇ %†f‹Üack o‡backlog (RïliˇÑeque° was: %Œd).", 
	`ª∂iˇti⁄GëSœveName
(
c
), 
psync_off£t
);

534 i‡(
psync_off£t
 > 
£rvî
.
ma°î_ª∂_off£t
) {

535 
	`£rvîLog
(
LL_WARNING
,

536 "W¨nög:Ñïliˇ %†åõdÅÿPSYNC wôhá¿off£àth© i†gª©îÅh™Åhêma°îÑïliˇti⁄ off£t.", 
	`ª∂iˇti⁄GëSœveName
(
c
));

538 
√ed_fuŒ_ªsync
;

545 
c
->
Êags
 |
CLIENT_SLAVE
;

546 
c
->
ª∂°©e
 = 
SLAVE_STATE_ONLINE
;

547 
c
->
ª∂_ack_time
 = 
£rvî
.
unixtime
;

548 
c
->
ª∂_put_⁄löe_⁄_ack
 = 0;

549 
	`li°AddNodeTaû
(
£rvî
.
¶aves
,
c
);

553 i‡(
c
->
¶ave_ˇ∑
 & 
SLAVE_CAPA_PSYNC2
) {

554 
buÊí
 = 
	`¢¥ötf
(
buf
,(buf),"+CONTINUE %s\r\n", 
£rvî
.
ª∂id
);

556 
buÊí
 = 
	`¢¥ötf
(
buf
,(buf),"+CONTINUE\r\n");

558 i‡(
	`c⁄nWrôe
(
c
->
c⁄n
,
buf
,
buÊí
) != buflen) {

559 
	`‰ìClõ¡Async
(
c
);

560  
C_OK
;

562 
psync_Àn
 = 
	`addRïlyRïliˇti⁄Backlog
(
c
,
psync_off£t
);

563 
	`£rvîLog
(
LL_NOTICE
,

565 
	`ª∂iˇti⁄GëSœveName
(
c
),

566 
psync_Àn
, 
psync_off£t
);

571 
	`ª‰eshGoodSœvesCou¡
();

574 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_REPLICA_CHANGE
,

575 
REDISMODULE_SUBEVENT_REPLICA_CHANGE_ONLINE
,

576 
NULL
);

578  
C_OK
;

580 
√ed_fuŒ_ªsync
:

585  
C_ERR
;

586 
	}
}

606 
	$°¨tBgßveF‹Rïliˇti⁄
(
möˇ∑
) {

607 
ªtvÆ
;

608 
sockë_èrgë
 = 
£rvî
.
ª∂_diskÀss_sync
 && (
möˇ∑
 & 
SLAVE_CAPA_EOF
);

609 
li°Iãr
 
li
;

610 
li°Node
 *
 
;

612 
	`£rvîLog
(
LL_NOTICE
,"Starting BGSAVE for SYNC withÅarget: %s",

613 
sockë_èrgë
 ? "replicas sockets" : "disk");

615 
rdbSaveInfo
 
rsi
, *
rsùå
;

616 
rsùå
 = 
	`rdbP›uœãSaveInfo
(&
rsi
);

619 i‡(
rsùå
) {

620 i‡(
sockë_èrgë
)

621 
ªtvÆ
 = 
	`rdbSaveToSœvesSockës
(
rsùå
);

623 
ªtvÆ
 = 
	`rdbSaveBackground
(
£rvî
.
rdb_fûíame
,
rsùå
);

625 
	`£rvîLog
(
LL_WARNING
,"BGSAVE forÑeplication:Ñeplication informationÇotávailable, can't generateÅhe RDB fileÑightÇow. TryÜater.");

626 
ªtvÆ
 = 
C_ERR
;

634 i‡(
ªtvÆ
 =
C_OK
 && !
sockë_èrgë
 && 
£rvî
.
rdb_dñ_sync_fûes
)

635 
RDBGíî©edByRïliˇti⁄
 = 1;

640 i‡(
ªtvÆ
 =
C_ERR
) {

641 
	`£rvîLog
(
LL_WARNING
,"BGSAVE forÑeplication failed");

642 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

643 (
 
 = 
	`li°Next
(&
li
))) {

644 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

646 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
) {

647 
¶ave
->
ª∂°©e
 = 
REPL_STATE_NONE
;

648 
¶ave
->
Êags
 &~
CLIENT_SLAVE
;

649 
	`li°DñNode
(
£rvî
.
¶aves
,
 
);

650 
	`addRïlyEº‹
(
¶ave
,

652 
¶ave
->
Êags
 |
CLIENT_CLOSE_AFTER_REPLY
;

655  
ªtvÆ
;

660 i‡(!
sockë_èrgë
) {

661 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

662 (
 
 = 
	`li°Next
(&
li
))) {

663 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

665 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
) {

666 
	`ª∂iˇti⁄SëupSœveF‹FuŒResync
(
¶ave
,

667 
	`gëPsyncInôülOff£t
());

674 i‡(
ªtvÆ
 =
C_OK
Ë
	`ª∂iˇti⁄S¸ùtCacheFlush
();

675  
ªtvÆ
;

676 
	}
}

679 
	$syncComm™d
(
˛õ¡
 *
c
) {

681 i‡(
c
->
Êags
 & 
CLIENT_SLAVE
) ;

685 i‡(
£rvî
.
ma°îho°
 && sîvî.
ª∂_°©e
 !
REPL_STATE_CONNECTED
) {

686 
	`addRïlySds
(
c
,
	`sd¢ew
("-NOMASTERLINK Can't SYNC whileÇot connected with my master\r\n"));

694 i‡(
	`˛õ¡HasPídögRïlõs
(
c
)) {

695 
	`addRïlyEº‹
(
c
,"SYNCánd PSYNCáre invalid withÖending output");

699 
	`£rvîLog
(
LL_NOTICE
,"Replica %sásks for synchronization",

700 
	`ª∂iˇti⁄GëSœveName
(
c
));

711 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[0]->
±r
,"psync")) {

712 i‡(
	`ma°îTryP¨tülResynchr⁄iz©i⁄
(
c
Ë=
C_OK
) {

713 
£rvî
.
°©_sync_∑πül_ok
++;

716 *
ma°î_ª∂id
 = 
c
->
¨gv
[1]->
±r
;

722 i‡(
ma°î_ª∂id
[0] !'?'Ë
£rvî
.
°©_sync_∑πül_îr
++;

728 
c
->
Êags
 |
CLIENT_PRE_PSYNC
;

732 
£rvî
.
°©_sync_fuŒ
++;

736 
c
->
ª∂°©e
 = 
SLAVE_STATE_WAIT_BGSAVE_START
;

737 i‡(
£rvî
.
ª∂_dißbÀ_t˝_nodñay
)

738 
	`c⁄nDißbÀT˝NoDñay
(
c
->
c⁄n
);

739 
c
->
ª∂dbfd
 = -1;

740 
c
->
Êags
 |
CLIENT_SLAVE
;

741 
	`li°AddNodeTaû
(
£rvî
.
¶aves
,
c
);

744 i‡(
	`li°Lígth
(
£rvî
.
¶aves
Ë=1 && sîvî.
ª∂_backlog
 =
NULL
) {

748 
	`ch™geRïliˇti⁄Id
();

749 
	`˛órRïliˇti⁄Id2
();

750 
	`¸óãRïliˇti⁄Backlog
();

754 i‡(
£rvî
.
rdb_chûd_pid
 != -1 &&

755 
£rvî
.
rdb_chûd_ty≥
 =
RDB_CHILD_TYPE_DISK
)

760 
˛õ¡
 *
¶ave
;

761 
li°Node
 *
 
;

762 
li°Iãr
 
li
;

764 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

765 (
 
 = 
	`li°Next
(&
li
))) {

766 
¶ave
 = 
 
->
vÆue
;

767 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_END
) ;

771 i‡(
 
 && ((
c
->
¶ave_ˇ∑
 & 
¶ave
->slave_capa) == slave->slave_capa)) {

774 
	`c›yClõ¡OuçutBuf„r
(
c
,
¶ave
);

775 
	`ª∂iˇti⁄SëupSœveF‹FuŒResync
(
c
,
¶ave
->
psync_öôül_off£t
);

776 
	`£rvîLog
(
LL_NOTICE
,"Waiting forÉnd of BGSAVE for SYNC");

780 
	`£rvîLog
(
LL_NOTICE
,"Can'táttachÅheÑeplicaÅoÅhe current BGSAVE. Waiting forÇext BGSAVE for SYNC");

784 } i‡(
£rvî
.
rdb_chûd_pid
 != -1 &&

785 
£rvî
.
rdb_chûd_ty≥
 =
RDB_CHILD_TYPE_SOCKET
)

790 
	`£rvîLog
(
LL_NOTICE
,"Current BGSAVE has socketÅarget. Waiting forÇext BGSAVE for SYNC");

794 i‡(
£rvî
.
ª∂_diskÀss_sync
 && (
c
->
¶ave_ˇ∑
 & 
SLAVE_CAPA_EOF
)) {

798 i‡(
£rvî
.
ª∂_diskÀss_sync_dñay
)

799 
	`£rvîLog
(
LL_NOTICE
,"DelayÇext BGSAVE for diskless SYNC");

804 i‡(!
	`hasA˘iveChûdPro˚ss
()) {

805 
	`°¨tBgßveF‹Rïliˇti⁄
(
c
->
¶ave_ˇ∑
);

807 
	`£rvîLog
(
LL_NOTICE
,

814 
	}
}

828 
	$ª∂c⁄fComm™d
(
˛õ¡
 *
c
) {

829 
j
;

831 i‡((
c
->
¨gc
 % 2) == 0) {

834 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

839 
j
 = 1; j < 
c
->
¨gc
; j+=2) {

840 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"listening-port")) {

841 
p‹t
;

843 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
+1],

844 &
p‹t
,
NULL
Ë!
C_OK
))

846 
c
->
¶ave_li°íög_p‹t
 = 
p‹t
;

847 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"ip-address")) {

848 
sds
 
ù
 = 
c
->
¨gv
[
j
+1]->
±r
;

849 i‡(
	`sd¶í
(
ù
Ë< (
c
->
¶ave_ù
)) {

850 
	`mem˝y
(
c
->
¶ave_ù
,
ù
,
	`sd¶í
(ip)+1);

852 
	`addRïlyEº‹F‹m©
(
c
,"REPLCONF ip-addressÖrovided by "

853 "ª∂iˇ in°™˚ i†toÿl⁄g: %zd byãs", 
	`sd¶í
(
ù
));

856 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"capa")) {

858 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
+1]->
±r
,"eof"))

859 
c
->
¶ave_ˇ∑
 |
SLAVE_CAPA_EOF
;

860 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
+1]->
±r
,"psync2"))

861 
c
->
¶ave_ˇ∑
 |
SLAVE_CAPA_PSYNC2
;

862 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"ack")) {

866 
off£t
;

868 i‡(!(
c
->
Êags
 & 
CLIENT_SLAVE
)) ;

869 i‡((
	`gëL⁄gL⁄gFromObje˘
(
c
->
¨gv
[
j
+1], &
off£t
Ë!
C_OK
))

871 i‡(
off£t
 > 
c
->
ª∂_ack_off
)

872 
c
->
ª∂_ack_off
 = 
off£t
;

873 
c
->
ª∂_ack_time
 = 
£rvî
.
unixtime
;

879 i‡(
c
->
ª∂_put_⁄löe_⁄_ack
 && c->
ª∂°©e
 =
SLAVE_STATE_ONLINE
)

880 
	`putSœveO∆öe
(
c
);

883 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"getack")) {

886 i‡(
£rvî
.
ma°îho°
 && sîvî.
ma°î
Ë
	`ª∂iˇti⁄SídAck
();

889 
	`addRïlyEº‹F‹m©
(
c
,"Unrecognized REPLCONF option: %s",

890 (*)
c
->
¨gv
[
j
]->
±r
);

894 
	`addRïly
(
c
,
sh¨ed
.
ok
);

895 
	}
}

911 
	$putSœveO∆öe
(
˛õ¡
 *
¶ave
) {

912 
¶ave
->
ª∂°©e
 = 
SLAVE_STATE_ONLINE
;

913 
¶ave
->
ª∂_put_⁄löe_⁄_ack
 = 0;

914 
¶ave
->
ª∂_ack_time
 = 
£rvî
.
unixtime
;

915 i‡(
	`c⁄nSëWrôeH™dÀr
(
¶ave
->
c⁄n
, 
£ndRïlyToClõ¡
Ë=
C_ERR
) {

916 
	`£rvîLog
(
LL_WARNING
,"U«bÀÅÿªgi°î wrôabÀÉvíàf‹Ñïliˇ bulkÅøns„r: %s", 
	`°ªº‹
(
î∫o
));

917 
	`‰ìClõ¡
(
¶ave
);

920 
	`ª‰eshGoodSœvesCou¡
();

922 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_REPLICA_CHANGE
,

923 
REDISMODULE_SUBEVENT_REPLICA_CHANGE_ONLINE
,

924 
NULL
);

925 
	`£rvîLog
(
LL_NOTICE
,"Synchronization withÑeplica %s succeeded",

926 
	`ª∂iˇti⁄GëSœveName
(
¶ave
));

927 
	}
}

934 
	$ªmoveRDBU£dToSyncRïliˇs
() {

941 i‡(!
£rvî
.
rdb_dñ_sync_fûes
) {

942 
RDBGíî©edByRïliˇti⁄
 = 0;

946 i‡(
	`ÆlPîsi°í˚DißbÀd
(Ë&& 
RDBGíî©edByRïliˇti⁄
) {

947 
˛õ¡
 *
¶ave
;

948 
li°Node
 *
 
;

949 
li°Iãr
 
li
;

951 
dñrdb
 = 1;

952 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

953 (
 
 = 
	`li°Next
(&
li
))) {

954 
¶ave
 = 
 
->
vÆue
;

955 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
 ||

956 
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_END
 ||

957 
¶ave
->
ª∂°©e
 =
SLAVE_STATE_SEND_BULK
)

959 
dñrdb
 = 0;

963 i‡(
dñrdb
) {

964 
°©
 
sb
;

965 i‡(
	`l°©
(
£rvî
.
rdb_fûíame
,&
sb
) != -1) {

966 
RDBGíî©edByRïliˇti⁄
 = 0;

967 
	`£rvîLog
(
LL_NOTICE
,

970 
	`bg_u∆ök
(
£rvî
.
rdb_fûíame
);

974 
	}
}

976 
	$£ndBulkToSœve
(
c⁄√˘i⁄
 *
c⁄n
) {

977 
˛õ¡
 *
¶ave
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

978 
buf
[
PROTO_IOBUF_LEN
];

979 
ssize_t
 
nwrôãn
, 
buÊí
;

984 i‡(
¶ave
->
ª∂¥ómbÀ
) {

985 
nwrôãn
 = 
	`c⁄nWrôe
(
c⁄n
,
¶ave
->
ª∂¥ómbÀ
,
	`sd¶í
(slave->replpreamble));

986 i‡(
nwrôãn
 == -1) {

987 
	`£rvîLog
(
LL_VERBOSE
,

989 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

990 
	`‰ìClõ¡
(
¶ave
);

993 
£rvî
.
°©_√t_ouçut_byãs
 +
nwrôãn
;

994 
	`sd§™ge
(
¶ave
->
ª∂¥ómbÀ
,
nwrôãn
,-1);

995 i‡(
	`sd¶í
(
¶ave
->
ª∂¥ómbÀ
) == 0) {

996 
	`sds‰ì
(
¶ave
->
ª∂¥ómbÀ
);

997 
¶ave
->
ª∂¥ómbÀ
 = 
NULL
;

1005 
	`l£ek
(
¶ave
->
ª∂dbfd
,¶ave->
ª∂dboff
,
SEEK_SET
);

1006 
buÊí
 = 
	`ªad
(
¶ave
->
ª∂dbfd
,
buf
,
PROTO_IOBUF_LEN
);

1007 i‡(
buÊí
 <= 0) {

1008 
	`£rvîLog
(
LL_WARNING
,"ReadÉrror sending DBÅoÑeplica: %s",

1009 (
buÊí
 =0Ë? "¥em©uª EOF" : 
	`°ªº‹
(
î∫o
));

1010 
	`‰ìClõ¡
(
¶ave
);

1013 i‡((
nwrôãn
 = 
	`c⁄nWrôe
(
c⁄n
,
buf
,
buÊí
)) == -1) {

1014 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë!
CONN_STATE_CONNECTED
) {

1015 
	`£rvîLog
(
LL_WARNING
,"WriteÉrror sending DBÅoÑeplica: %s",

1016 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

1017 
	`‰ìClõ¡
(
¶ave
);

1021 
¶ave
->
ª∂dboff
 +
nwrôãn
;

1022 
£rvî
.
°©_√t_ouçut_byãs
 +
nwrôãn
;

1023 i‡(
¶ave
->
ª∂dboff
 =¶ave->
ª∂dbsize
) {

1024 
	`˛o£
(
¶ave
->
ª∂dbfd
);

1025 
¶ave
->
ª∂dbfd
 = -1;

1026 
	`c⁄nSëWrôeH™dÀr
(
¶ave
->
c⁄n
,
NULL
);

1027 
	`putSœveO∆öe
(
¶ave
);

1029 
	}
}

1033 
	$rdbPùeWrôeH™dÀrC⁄nRemoved
(
c⁄√˘i⁄
 *
c⁄n
) {

1034 i‡(!
	`c⁄nHasWrôeH™dÀr
(
c⁄n
))

1036 
	`c⁄nSëWrôeH™dÀr
(
c⁄n
, 
NULL
);

1037 
£rvî
.
rdb_pùe_numc⁄ns_wrôög
--;

1039 i‡(
£rvî
.
rdb_pùe_numc⁄ns_wrôög
 == 0) {

1040 i‡(
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, sîvî.
rdb_pùe_ªad
, 
AE_READABLE
, 
rdbPùeRódH™dÀr
,
NULL
Ë=
AE_ERR
) {

1041 
	`£rvîP™ic
("UnrecoverableÉrror creating server.rdb_pipe_read fileÉvent.");

1044 
	}
}

1048 
	$rdbPùeWrôeH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
) {

1049 
	`£rvîAs£π
(
£rvî
.
rdb_pùe_bufÊí
>0);

1050 
˛õ¡
 *
¶ave
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

1051 
nwrôãn
;

1052 i‡((
nwrôãn
 = 
	`c⁄nWrôe
(
c⁄n
, 
£rvî
.
rdb_pùe_buff
 + 
¶ave
->
ª∂dboff
,

1053 
£rvî
.
rdb_pùe_bufÊí
 - 
¶ave
->
ª∂dboff
)) == -1)

1055 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë=
CONN_STATE_CONNECTED
)

1057 
	`£rvîLog
(
LL_WARNING
,"WriteÉrror sending DBÅoÑeplica: %s",

1058 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

1059 
	`‰ìClõ¡
(
¶ave
);

1062 
¶ave
->
ª∂dboff
 +
nwrôãn
;

1063 
£rvî
.
°©_√t_ouçut_byãs
 +
nwrôãn
;

1064 i‡(
¶ave
->
ª∂dboff
 < 
£rvî
.
rdb_pùe_bufÊí
)

1067 
	`rdbPùeWrôeH™dÀrC⁄nRemoved
(
c⁄n
);

1068 
	}
}

1073 
	$RdbPùeCÀ™up
() {

1074 
	`˛o£
(
£rvî
.
rdb_pùe_ªad
);

1075 
	`z‰ì
(
£rvî
.
rdb_pùe_c⁄ns
);

1076 
£rvî
.
rdb_pùe_c⁄ns
 = 
NULL
;

1077 
£rvî
.
rdb_pùe_numc⁄ns
 = 0;

1078 
£rvî
.
rdb_pùe_numc⁄ns_wrôög
 = 0;

1079 
	`z‰ì
(
£rvî
.
rdb_pùe_buff
);

1080 
£rvî
.
rdb_pùe_buff
 = 
NULL
;

1081 
£rvî
.
rdb_pùe_bufÊí
 = 0;

1085 
	`checkChûdªnD⁄e
();

1086 
	}
}

1089 
	$rdbPùeRódH™dÀr
(
´EvítLo›
 *
evítLo›
, 
fd
, *
˛õ¡D©a
, 
mask
) {

1090 
	`UNUSED
(
mask
);

1091 
	`UNUSED
(
˛õ¡D©a
);

1092 
	`UNUSED
(
evítLo›
);

1093 
i
;

1094 i‡(!
£rvî
.
rdb_pùe_buff
)

1095 
£rvî
.
rdb_pùe_buff
 = 
	`zmÆloc
(
PROTO_IOBUF_LEN
);

1096 
	`£rvîAs£π
(
£rvî
.
rdb_pùe_numc⁄ns_wrôög
==0);

1099 
£rvî
.
rdb_pùe_bufÊí
 = 
	`ªad
(
fd
, sîvî.
rdb_pùe_buff
, 
PROTO_IOBUF_LEN
);

1100 i‡(
£rvî
.
rdb_pùe_bufÊí
 < 0) {

1101 i‡(
î∫o
 =
EAGAIN
 ||Éºnÿ=
EWOULDBLOCK
)

1103 
	`£rvîLog
(
LL_WARNING
,"DiskÀs†rdbÅøns„r,ÑódÉº‹ sídög DBÅÿª∂iˇs: %s", 
	`°ªº‹
(
î∫o
));

1104 
i
=0; i < 
£rvî
.
rdb_pùe_numc⁄ns
; i++) {

1105 
c⁄√˘i⁄
 *
c⁄n
 = 
£rvî
.
rdb_pùe_c⁄ns
[
i
];

1106 i‡(!
c⁄n
)

1108 
˛õ¡
 *
¶ave
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

1109 
	`‰ìClõ¡
(
¶ave
);

1110 
£rvî
.
rdb_pùe_c⁄ns
[
i
] = 
NULL
;

1112 
	`kûlRDBChûd
();

1116 i‡(
£rvî
.
rdb_pùe_bufÊí
 == 0) {

1118 
°ûlUp
 = 0;

1119 
	`´DñëeFûeEvít
(
£rvî
.
ñ
, sîvî.
rdb_pùe_ªad
, 
AE_READABLE
);

1120 
i
=0; i < 
£rvî
.
rdb_pùe_numc⁄ns
; i++)

1122 
c⁄√˘i⁄
 *
c⁄n
 = 
£rvî
.
rdb_pùe_c⁄ns
[
i
];

1123 i‡(!
c⁄n
)

1125 
°ûlUp
++;

1127 
	`£rvîLog
(
LL_WARNING
,"DiskÀs†rdbÅøns„r, d⁄êªadög fromÖùe, %dÑïliˇ†°û»up.", 
°ûlUp
);

1128 
	`RdbPùeCÀ™up
();

1132 
°ûlAlive
 = 0;

1133 
i
=0; i < 
£rvî
.
rdb_pùe_numc⁄ns
; i++)

1135 
nwrôãn
;

1136 
c⁄√˘i⁄
 *
c⁄n
 = 
£rvî
.
rdb_pùe_c⁄ns
[
i
];

1137 i‡(!
c⁄n
)

1140 
˛õ¡
 *
¶ave
 = 
	`c⁄nGëPriv©eD©a
(
c⁄n
);

1141 i‡((
nwrôãn
 = 
	`c⁄nWrôe
(
c⁄n
, 
£rvî
.
rdb_pùe_buff
, sîvî.
rdb_pùe_bufÊí
)) == -1) {

1142 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë!
CONN_STATE_CONNECTED
) {

1143 
	`£rvîLog
(
LL_WARNING
,"DisklessÑdbÅransfer, writeÉrror sending DBÅoÑeplica: %s",

1144 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

1145 
	`‰ìClõ¡
(
¶ave
);

1146 
£rvî
.
rdb_pùe_c⁄ns
[
i
] = 
NULL
;

1150 
¶ave
->
ª∂dboff
 = 0;

1152 
¶ave
->
ª∂dboff
 = 
nwrôãn
;

1153 
£rvî
.
°©_√t_ouçut_byãs
 +
nwrôãn
;

1157 i‡(
nwrôãn
 !
£rvî
.
rdb_pùe_bufÊí
) {

1158 
£rvî
.
rdb_pùe_numc⁄ns_wrôög
++;

1159 
	`c⁄nSëWrôeH™dÀr
(
c⁄n
, 
rdbPùeWrôeH™dÀr
);

1161 
°ûlAlive
++;

1164 i‡(
°ûlAlive
 == 0) {

1165 
	`£rvîLog
(
LL_WARNING
,"DisklessÑdbÅransfer,ÜastÑeplica dropped, killing fork child.");

1166 
	`kûlRDBChûd
();

1167 
	`RdbPùeCÀ™up
();

1170 i‡(
£rvî
.
rdb_pùe_numc⁄ns_wrôög
 || 
°ûlAlive
 == 0) {

1171 
	`´DñëeFûeEvít
(
£rvî
.
ñ
, sîvî.
rdb_pùe_ªad
, 
AE_READABLE
);

1175 
	}
}

1191 
	$upd©eSœvesWaôögBgßve
(
bgßvìº
, 
ty≥
) {

1192 
li°Node
 *
 
;

1193 
°¨tbgßve
 = 0;

1194 
möˇ∑
 = -1;

1195 
li°Iãr
 
li
;

1197 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

1198 (
 
 = 
	`li°Next
(&
li
))) {

1199 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

1201 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
) {

1202 
°¨tbgßve
 = 1;

1203 
möˇ∑
 = (möˇ∑ =-1Ë? 
¶ave
->
¶ave_ˇ∑
 :

1204 (
möˇ∑
 & 
¶ave
->
¶ave_ˇ∑
);

1205 } i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_END
) {

1206 
ªdis_°©
 
buf
;

1213 i‡(
ty≥
 =
RDB_CHILD_TYPE_SOCKET
) {

1214 
	`£rvîLog
(
LL_NOTICE
,

1216 
	`ª∂iˇti⁄GëSœveName
(
¶ave
));

1242 
¶ave
->
ª∂°©e
 = 
SLAVE_STATE_ONLINE
;

1243 
¶ave
->
ª∂_put_⁄löe_⁄_ack
 = 1;

1244 
¶ave
->
ª∂_ack_time
 = 
£rvî
.
unixtime
;

1246 i‡(
bgßvìº
 !
C_OK
) {

1247 
	`‰ìClõ¡
(
¶ave
);

1248 
	`£rvîLog
(
LL_WARNING
,"SYNC failed. BGSAVE childÑeturnedánÉrror");

1251 i‡((
¶ave
->
ª∂dbfd
 = 
	`›í
(
£rvî
.
rdb_fûíame
,
O_RDONLY
)) == -1 ||

1252 
	`ªdis_f°©
(
¶ave
->
ª∂dbfd
,&
buf
) == -1) {

1253 
	`‰ìClõ¡
(
¶ave
);

1254 
	`£rvîLog
(
LL_WARNING
,"SYNC faûed. C™'à›í/°© DBá·î BGSAVE: %s", 
	`°ªº‹
(
î∫o
));

1257 
¶ave
->
ª∂dboff
 = 0;

1258 
¶ave
->
ª∂dbsize
 = 
buf
.
°_size
;

1259 
¶ave
->
ª∂°©e
 = 
SLAVE_STATE_SEND_BULK
;

1260 
¶ave
->
ª∂¥ómbÀ
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"$%lld\r\n",

1261 (Ë
¶ave
->
ª∂dbsize
);

1263 
	`c⁄nSëWrôeH™dÀr
(
¶ave
->
c⁄n
,
NULL
);

1264 i‡(
	`c⁄nSëWrôeH™dÀr
(
¶ave
->
c⁄n
,
£ndBulkToSœve
Ë=
C_ERR
) {

1265 
	`‰ìClõ¡
(
¶ave
);

1271 i‡(
°¨tbgßve
Ë
	`°¨tBgßveF‹Rïliˇti⁄
(
möˇ∑
);

1272 
	}
}

1278 
	$ch™geRïliˇti⁄Id
() {

1279 
	`gëR™domHexCh¨s
(
£rvî
.
ª∂id
,
CONFIG_RUN_ID_SIZE
);

1280 
£rvî
.
ª∂id
[
CONFIG_RUN_ID_SIZE
] = '\0';

1281 
	}
}

1286 
	$˛órRïliˇti⁄Id2
() {

1287 
	`mem£t
(
£rvî
.
ª∂id2
,'0',(£rvî.
ª∂id
));

1288 
£rvî
.
ª∂id2
[
CONFIG_RUN_ID_SIZE
] = '\0';

1289 
£rvî
.
£c⁄d_ª∂id_off£t
 = -1;

1290 
	}
}

1297 
	$shi·Rïliˇti⁄Id
() {

1298 
	`mem˝y
(
£rvî
.
ª∂id2
,£rvî.
ª∂id
,(server.replid));

1306 
£rvî
.
£c⁄d_ª∂id_off£t
 = sîvî.
ma°î_ª∂_off£t
+1;

1307 
	`ch™geRïliˇti⁄Id
();

1308 
	`£rvîLog
(
LL_WARNING
,"Sëtög sec⁄d¨yÑïliˇti⁄ IDÅÿ%s, vÆid u∞tÿoff£t: %Œd. NewÑïliˇti⁄ ID i†%s", 
£rvî
.
ª∂id2
, sîvî.
£c⁄d_ª∂id_off£t
, sîvî.
ª∂id
);

1309 
	}
}

1315 
	$¶aveIsInH™dshakeSèã
() {

1316  
£rvî
.
ª∂_°©e
 >
REPL_STATE_RECEIVE_PONG
 &&

1317 
£rvî
.
ª∂_°©e
 <
REPL_STATE_RECEIVE_PSYNC
;

1318 
	}
}

1328 
	$ª∂iˇti⁄SídNewlöeToMa°î
() {

1329 
time_t
 
√wlöe_£¡
;

1330 i‡(
	`time
(
NULL
Ë!
√wlöe_£¡
) {

1331 
√wlöe_£¡
 = 
	`time
(
NULL
);

1333 i‡(
£rvî
.
ª∂_å™s„r_s
Ë
	`c⁄nWrôe
(server.repl_transfer_s, "\n", 1);

1335 
	}
}

1339 
	$ª∂iˇti⁄Em±yDbCÆlback
(*
¥ivd©a
) {

1340 
	`UNUSED
(
¥ivd©a
);

1341 
	`ª∂iˇti⁄SídNewlöeToMa°î
();

1342 
	}
}

1347 
	$ª∂iˇti⁄Cª©eMa°îClõ¡
(
c⁄√˘i⁄
 *
c⁄n
, 
dbid
) {

1348 
£rvî
.
ma°î
 = 
	`¸óãClõ¡
(
c⁄n
);

1349 i‡(
c⁄n
)

1350 
	`c⁄nSëRódH™dÀr
(
£rvî
.
ma°î
->
c⁄n
, 
ªadQuîyFromClõ¡
);

1351 
£rvî
.
ma°î
->
Êags
 |
CLIENT_MASTER
;

1352 
£rvî
.
ma°î
->
authítiˇãd
 = 1;

1353 
£rvî
.
ma°î
->
ª∂off
 = sîvî.
ma°î_öôül_off£t
;

1354 
£rvî
.
ma°î
->
ªad_ª∂off
 = sîvî.ma°î->
ª∂off
;

1355 
£rvî
.
ma°î
->
u£r
 = 
NULL
;

1356 
	`mem˝y
(
£rvî
.
ma°î
->
ª∂id
, sîvî.
ma°î_ª∂id
,

1357 (
£rvî
.
ma°î_ª∂id
));

1360 i‡(
£rvî
.
ma°î
->
ª∂off
 == -1)

1361 
£rvî
.
ma°î
->
Êags
 |
CLIENT_PRE_PSYNC
;

1362 i‡(
dbid
 !-1Ë
	`£À˘Db
(
£rvî
.
ma°î
,dbid);

1363 
	}
}

1369 
	$ª°¨tAOFA·îSYNC
() {

1370 
åõs
, 
max_åõs
 = 10;

1371 
åõs
 = 0;Årõ†< 
max_åõs
; ++tries) {

1372 i‡(
	`°¨tAµídO∆y
(Ë=
C_OK
) ;

1373 
	`£rvîLog
(
LL_WARNING
,

1376 
	`¶ìp
(1);

1378 i‡(
åõs
 =
max_åõs
) {

1379 
	`£rvîLog
(
LL_WARNING
,

1382 
	`exô
(1);

1384 
	}
}

1386 
	$u£DiskÀssLﬂd
() {

1388 
íabÀd
 = 
£rvî
.
ª∂_diskÀss_lﬂd
 =
REPL_DISKLESS_LOAD_SWAPDB
 ||

1389 (
£rvî
.
ª∂_diskÀss_lﬂd
 =
REPL_DISKLESS_LOAD_WHEN_DB_EMPTY
 && 
	`dbTŸÆSîvîKeyCou¡
()==0);

1391 i‡(
íabÀd
 && !
	`moduÀAŒD©©y≥sH™dÀEº‹s
()) {

1392 
	`£rvîLog
(
LL_WARNING
,

1394 
íabÀd
 = 0;

1396  
íabÀd
;

1397 
	}
}

1402 
ªdisDb
 *
	$diskÀssLﬂdMakeBackups
() {

1403 
ªdisDb
 *
backups
 = 
	`zmÆloc
(‘edisDb)*
£rvî
.
dbnum
);

1404 
i
=0; i<
£rvî
.
dbnum
; i++) {

1405 
backups
[
i
] = 
£rvî
.
db
[i];

1406 
£rvî
.
db
[
i
].
di˘
 = 
	`di˘Cª©e
(&
dbDi˘Ty≥
,
NULL
);

1407 
£rvî
.
db
[
i
].
expúes
 = 
	`di˘Cª©e
(&
key±rDi˘Ty≥
,
NULL
);

1409  
backups
;

1410 
	}
}

1422 
	$diskÀssLﬂdRe°‹eBackups
(
ªdisDb
 *
backup
, 
ª°‹e
, 
em±y_db_Êags
)

1424 i‡(
ª°‹e
) {

1426 
	`em±yDbGíîic
(
£rvî
.
db
,-1,
em±y_db_Êags
,
ª∂iˇti⁄Em±yDbCÆlback
);

1427 
i
=0; i<
£rvî
.
dbnum
; i++) {

1428 
	`di˘Rñó£
(
£rvî
.
db
[
i
].
di˘
);

1429 
	`di˘Rñó£
(
£rvî
.
db
[
i
].
expúes
);

1430 
£rvî
.
db
[
i
] = 
backup
[i];

1434 
	`em±yDbGíîic
(
backup
,-1,
em±y_db_Êags
|
EMPTYDB_BACKUP
,
ª∂iˇti⁄Em±yDbCÆlback
);

1435 
i
=0; i<
£rvî
.
dbnum
; i++) {

1436 
	`di˘Rñó£
(
backup
[
i
].
di˘
);

1437 
	`di˘Rñó£
(
backup
[
i
].
expúes
);

1440 
	`z‰ì
(
backup
);

1441 
	}
}

1444 
	#REPL_MAX_WRITTEN_BEFORE_FSYNC
 (1024*1024*8Ë

	)

1445 
	$ªadSyncBulkPaylﬂd
(
c⁄√˘i⁄
 *
c⁄n
) {

1446 
buf
[
PROTO_IOBUF_LEN
];

1447 
ssize_t
 
ƒód
, 
ªadÀn
, 
nwrôãn
;

1448 
u£_diskÀss_lﬂd
 = 
	`u£DiskÀssLﬂd
();

1449 
ªdisDb
 *
diskÀss_lﬂd_backup
 = 
NULL
;

1450 
em±y_db_Êags
 = 
£rvî
.
ª∂_¶ave_œzy_Êush
 ? 
EMPTYDB_ASYNC
 :

1451 
EMPTYDB_NO_FLAGS
;

1452 
off_t
 
À·
;

1456 
eofm¨k
[
CONFIG_RUN_ID_SIZE
];

1457 
œ°byãs
[
CONFIG_RUN_ID_SIZE
];

1458 
u£m¨k
 = 0;

1462 i‡(
£rvî
.
ª∂_å™s„r_size
 == -1) {

1463 i‡(
	`c⁄nSyncRódLöe
(
c⁄n
,
buf
,1024,
£rvî
.
ª∂_syncio_timeout
*1000) == -1) {

1464 
	`£rvîLog
(
LL_WARNING
,

1466 
	`°ªº‹
(
î∫o
));

1467 
îr‹
;

1470 i‡(
buf
[0] == '-') {

1471 
	`£rvîLog
(
LL_WARNING
,

1473 
buf
+1);

1474 
îr‹
;

1475 } i‡(
buf
[0] == '\0') {

1479 
£rvî
.
ª∂_å™s„r_œ°io
 = sîvî.
unixtime
;

1481 } i‡(
buf
[0] != '$') {

1482 
	`£rvîLog
(
LL_WARNING
,"BadÖrŸocﬁ from MASTER,Åhêfú° byã i†nŸ '$' (wêª˚ived '%s'),áª you suªÅhêho°ándÖ‹à¨êright?", 
buf
);

1483 
îr‹
;

1496 i‡(
	`°∫cmp
(
buf
+1,"EOF:",4Ë=0 && 
	`°æí
(buf+5Ë>
CONFIG_RUN_ID_SIZE
) {

1497 
u£m¨k
 = 1;

1498 
	`mem˝y
(
eofm¨k
,
buf
+5,
CONFIG_RUN_ID_SIZE
);

1499 
	`mem£t
(
œ°byãs
,0,
CONFIG_RUN_ID_SIZE
);

1502 
£rvî
.
ª∂_å™s„r_size
 = 0;

1503 
	`£rvîLog
(
LL_NOTICE
,

1505 
u£_diskÀss_lﬂd
? "toÖarser":"to disk");

1507 
u£m¨k
 = 0;

1508 
£rvî
.
ª∂_å™s„r_size
 = 
	`°πﬁ
(
buf
+1,
NULL
,10);

1509 
	`£rvîLog
(
LL_NOTICE
,

1511 (Ë
£rvî
.
ª∂_å™s„r_size
,

1512 
u£_diskÀss_lﬂd
? "toÖarser":"to disk");

1517 i‡(!
u£_diskÀss_lﬂd
) {

1520 i‡(
u£m¨k
) {

1521 
ªadÀn
 = (
buf
);

1523 
À·
 = 
£rvî
.
ª∂_å™s„r_size
 - sîvî.
ª∂_å™s„r_ªad
;

1524 
ªadÀn
 = (
À·
 < (sig√d)(
buf
)) ?Üeft : (signed)(buf);

1527 
ƒód
 = 
	`c⁄nRód
(
c⁄n
,
buf
,
ªadÀn
);

1528 i‡(
ƒód
 <= 0) {

1529 
	`£rvîLog
(
LL_WARNING
,"I/OÉrrorÅryingÅo sync with MASTER: %s",

1530 (
ƒód
 =-1Ë? 
	`°ªº‹
(
î∫o
) : "connectionÜost");

1531 
	`ˇn˚lRïliˇti⁄H™dshake
();

1534 
£rvî
.
°©_√t_öput_byãs
 +
ƒód
;

1538 
eof_ªached
 = 0;

1540 i‡(
u£m¨k
) {

1543 i‡(
ƒód
 >
CONFIG_RUN_ID_SIZE
) {

1544 
	`mem˝y
(
œ°byãs
,
buf
+
ƒód
-
CONFIG_RUN_ID_SIZE
,

1545 
CONFIG_RUN_ID_SIZE
);

1547 
ªm
 = 
CONFIG_RUN_ID_SIZE
-
ƒód
;

1548 
	`memmove
(
œ°byãs
,œ°byãs+
ƒód
,
ªm
);

1549 
	`mem˝y
(
œ°byãs
+
ªm
,
buf
,
ƒód
);

1551 i‡(
	`memcmp
(
œ°byãs
,
eofm¨k
,
CONFIG_RUN_ID_SIZE
) == 0)

1552 
eof_ªached
 = 1;

1558 
£rvî
.
ª∂_å™s„r_œ°io
 = sîvî.
unixtime
;

1559 i‡((
nwrôãn
 = 
	`wrôe
(
£rvî
.
ª∂_å™s„r_fd
,
buf
,
ƒód
)) !=Çread) {

1560 
	`£rvîLog
(
LL_WARNING
,

1563 (
nwrôãn
 =-1Ë? 
	`°ªº‹
(
î∫o
) : "short write");

1564 
îr‹
;

1566 
£rvî
.
ª∂_å™s„r_ªad
 +
ƒód
;

1569 i‡(
u£m¨k
 && 
eof_ªached
) {

1570 i‡(
	`·runˇã
(
£rvî
.
ª∂_å™s„r_fd
,

1571 
£rvî
.
ª∂_å™s„r_ªad
 - 
CONFIG_RUN_ID_SIZE
) == -1)

1573 
	`£rvîLog
(
LL_WARNING
,

1575 "f‹ SYNC: %s", 
	`°ªº‹
(
î∫o
));

1576 
îr‹
;

1583 i‡(
£rvî
.
ª∂_å™s„r_ªad
 >=

1584 
£rvî
.
ª∂_å™s„r_œ°_fsync_off
 + 
REPL_MAX_WRITTEN_BEFORE_FSYNC
)

1586 
off_t
 
sync_size
 = 
£rvî
.
ª∂_å™s„r_ªad
 -

1587 
£rvî
.
ª∂_å™s„r_œ°_fsync_off
;

1588 
	`rdb_fsync_ønge
(
£rvî
.
ª∂_å™s„r_fd
,

1589 
£rvî
.
ª∂_å™s„r_œ°_fsync_off
, 
sync_size
);

1590 
£rvî
.
ª∂_å™s„r_œ°_fsync_off
 +
sync_size
;

1594 i‡(!
u£m¨k
) {

1595 i‡(
£rvî
.
ª∂_å™s„r_ªad
 =£rvî.
ª∂_å™s„r_size
)

1596 
eof_ªached
 = 1;

1601 i‡(!
eof_ªached
) ;

1613 
	`£rvîLog
(
LL_NOTICE
, "MASTER <-> REPLICA sync: Flushing old data");

1617 i‡(
£rvî
.
aof_°©e
 !
AOF_OFF
Ë
	`°›AµídO∆y
();

1622 i‡(
u£_diskÀss_lﬂd
 &&

1623 
£rvî
.
ª∂_diskÀss_lﬂd
 =
REPL_DISKLESS_LOAD_SWAPDB
)

1627 
diskÀss_lﬂd_backup
 = 
	`diskÀssLﬂdMakeBackups
();

1633 
	`em±yDb
(-1,
em±y_db_Êags
,
ª∂iˇti⁄Em±yDbCÆlback
);

1639 
	`c⁄nSëRódH™dÀr
(
c⁄n
, 
NULL
);

1640 
	`£rvîLog
(
LL_NOTICE
, "MASTER <-> REPLICA sync: Loading DB in memory");

1641 
rdbSaveInfo
 
rsi
 = 
RDB_SAVE_INFO_INIT
;

1642 i‡(
u£_diskÀss_lﬂd
) {

1643 
rio
 
rdb
;

1644 
	`rioInôWôhC⁄n
(&
rdb
,
c⁄n
,
£rvî
.
ª∂_å™s„r_size
);

1648 
	`c⁄nBlock
(
c⁄n
);

1649 
	`c⁄nRecvTimeout
(
c⁄n
, 
£rvî
.
ª∂_timeout
*1000);

1650 
	`°¨tLﬂdög
(
£rvî
.
ª∂_å™s„r_size
, 
RDBFLAGS_REPLICATION
);

1652 i‡(
	`rdbLﬂdRio
(&
rdb
,
RDBFLAGS_REPLICATION
,&
rsi
Ë!
C_OK
) {

1654 
	`°›Lﬂdög
(0);

1655 
	`£rvîLog
(
LL_WARNING
,

1658 
	`ˇn˚lRïliˇti⁄H™dshake
();

1659 
	`rioFªeC⁄n
(&
rdb
, 
NULL
);

1660 i‡(
£rvî
.
ª∂_diskÀss_lﬂd
 =
REPL_DISKLESS_LOAD_SWAPDB
) {

1662 
	`diskÀssLﬂdRe°‹eBackups
(
diskÀss_lﬂd_backup
,1,

1663 
em±y_db_Êags
);

1667 
	`em±yDb
(-1,
em±y_db_Êags
,
ª∂iˇti⁄Em±yDbCÆlback
);

1675 
	`°›Lﬂdög
(1);

1678 i‡(
£rvî
.
ª∂_diskÀss_lﬂd
 =
REPL_DISKLESS_LOAD_SWAPDB
) {

1682 
	`diskÀssLﬂdRe°‹eBackups
(
diskÀss_lﬂd_backup
,0,
em±y_db_Êags
);

1686 i‡(
u£m¨k
) {

1687 i‡(!
	`rioRód
(&
rdb
,
buf
,
CONFIG_RUN_ID_SIZE
) ||

1688 
	`memcmp
(
buf
,
eofm¨k
,
CONFIG_RUN_ID_SIZE
) != 0)

1690 
	`£rvîLog
(
LL_WARNING
,"Replication stream EOF marker is broken");

1691 
	`ˇn˚lRïliˇti⁄H™dshake
();

1692 
	`rioFªeC⁄n
(&
rdb
, 
NULL
);

1699 
	`rioFªeC⁄n
(&
rdb
, 
NULL
);

1700 
	`c⁄nN⁄Block
(
c⁄n
);

1701 
	`c⁄nRecvTimeout
(
c⁄n
,0);

1704 i‡(
£rvî
.
rdb_chûd_pid
 != -1) {

1705 
	`£rvîLog
(
LL_NOTICE
,

1710 (Ë
£rvî
.
rdb_chûd_pid
);

1711 
	`kûlRDBChûd
();

1715 
ﬁd_rdb_fd
 = 
	`›í
(
£rvî
.
rdb_fûíame
,
O_RDONLY
|
O_NONBLOCK
);

1716 i‡(
	`ª«me
(
£rvî
.
ª∂_å™s„r_tmpfûe
,£rvî.
rdb_fûíame
) == -1) {

1717 
	`£rvîLog
(
LL_WARNING
,

1720 
£rvî
.
rdb_fûíame
, 
	`°ªº‹
(
î∫o
));

1721 
	`ˇn˚lRïliˇti⁄H™dshake
();

1722 i‡(
ﬁd_rdb_fd
 !-1Ë
	`˛o£
(old_rdb_fd);

1726 i‡(
ﬁd_rdb_fd
 !-1Ë
	`bioCª©eBackgroundJob
(
BIO_CLOSE_FILE
,(*)()ﬁd_rdb_fd,
NULL
,NULL);

1728 i‡(
	`rdbLﬂd
(
£rvî
.
rdb_fûíame
,&
rsi
,
RDBFLAGS_REPLICATION
Ë!
C_OK
) {

1729 
	`£rvîLog
(
LL_WARNING
,

1732 
	`ˇn˚lRïliˇti⁄H™dshake
();

1733 i‡(
£rvî
.
rdb_dñ_sync_fûes
 && 
	`ÆlPîsi°í˚DißbÀd
()) {

1734 
	`£rvîLog
(
LL_NOTICE
,"RemovingÅhe RDB file obtained from "

1737 
	`bg_u∆ök
(
£rvî
.
rdb_fûíame
);

1745 i‡(
£rvî
.
rdb_dñ_sync_fûes
 && 
	`ÆlPîsi°í˚DißbÀd
()) {

1746 
	`£rvîLog
(
LL_NOTICE
,"RemovingÅhe RDB file obtained from "

1749 
	`bg_u∆ök
(
£rvî
.
rdb_fûíame
);

1752 
	`z‰ì
(
£rvî
.
ª∂_å™s„r_tmpfûe
);

1753 
	`˛o£
(
£rvî
.
ª∂_å™s„r_fd
);

1754 
£rvî
.
ª∂_å™s„r_fd
 = -1;

1755 
£rvî
.
ª∂_å™s„r_tmpfûe
 = 
NULL
;

1759 
	`ª∂iˇti⁄Cª©eMa°îClõ¡
(
£rvî
.
ª∂_å™s„r_s
,
rsi
.
ª∂_°ªam_db
);

1760 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_CONNECTED
;

1761 
£rvî
.
ª∂_down_sö˚
 = 0;

1764 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_MASTER_LINK_CHANGE
,

1765 
REDISMODULE_SUBEVENT_MASTER_LINK_UP
,

1766 
NULL
);

1771 
	`mem˝y
(
£rvî
.
ª∂id
,£rvî.
ma°î
->replid,(server.replid));

1772 
£rvî
.
ma°î_ª∂_off£t
 = sîvî.
ma°î
->
ª∂off
;

1773 
£rvî
.
ma°î_ª∂_mónögful_off£t
 = sîvî.
ma°î
->
ª∂off
;

1774 
	`˛órRïliˇti⁄Id2
();

1780 i‡(
£rvî
.
ª∂_backlog
 =
NULL
Ë
	`¸óãRïliˇti⁄Backlog
();

1781 
	`£rvîLog
(
LL_NOTICE
, "MASTER <-> REPLICA sync: Finished with success");

1783 i‡(
£rvî
.
su≥rvi£d_mode
 =
SUPERVISED_SYSTEMD
) {

1784 
	`ªdisCommuniˇãSy°emd
("STATUS=MASTER <-> REPLICA sync: Finished with success. ReadyÅoáccept connections.\n");

1785 
	`ªdisCommuniˇãSy°emd
("READY=1\n");

1791 i‡(
£rvî
.
aof_íabÀd
Ë
	`ª°¨tAOFA·îSYNC
();

1794 
îr‹
:

1795 
	`ˇn˚lRïliˇti⁄H™dshake
();

1797 
	}
}

1805 
	#SYNC_CMD_READ
 (1<<0)

	)

1806 
	#SYNC_CMD_WRITE
 (1<<1)

	)

1807 
	#SYNC_CMD_FULL
 (
SYNC_CMD_READ
|
SYNC_CMD_WRITE
)

	)

1808 *
	$£ndSynchr⁄ousComm™d
(
Êags
, 
c⁄√˘i⁄
 *
c⁄n
, ...) {

1813 i‡(
Êags
 & 
SYNC_CMD_WRITE
) {

1814 *
¨g
;

1815 
va_li°
 
≠
;

1816 
sds
 
cmd
 = 
	`sd£m±y
();

1817 
sds
 
cmd¨gs
 = 
	`sd£m±y
();

1818 
size_t
 
¨g¶í
 = 0;

1819 
	`va_°¨t
(
≠
,
c⁄n
);

1822 
¨g
 = 
	`va_¨g
(
≠
, *);

1823 i‡(
¨g
 =
NULL
) ;

1825 
cmd¨gs
 = 
	`sdsˇçrötf
(cmd¨gs,"$%zu\r\n%s\r\n",
	`°æí
(
¨g
),arg);

1826 
¨g¶í
++;

1829 
	`va_íd
(
≠
);

1831 
cmd
 = 
	`sdsˇçrötf
(cmd,"*%zu\r\n",
¨g¶í
);

1832 
cmd
 = 
	`sdsˇtsds
(cmd,
cmd¨gs
);

1833 
	`sds‰ì
(
cmd¨gs
);

1836 i‡(
	`c⁄nSyncWrôe
(
c⁄n
,
cmd
,
	`sd¶í
(cmd),
£rvî
.
ª∂_syncio_timeout
*1000)

1839 
	`sds‰ì
(
cmd
);

1840  
	`sdsˇçrötf
(
	`sd£m±y
(),"-WritingÅo master: %s",

1841 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

1843 
	`sds‰ì
(
cmd
);

1847 i‡(
Êags
 & 
SYNC_CMD_READ
) {

1848 
buf
[256];

1850 i‡(
	`c⁄nSyncRódLöe
(
c⁄n
,
buf
,(buf),
£rvî
.
ª∂_syncio_timeout
*1000)

1853  
	`sdsˇçrötf
(
	`sd£m±y
(),"-Reading from master: %s",

1854 
	`°ªº‹
(
î∫o
));

1856 
£rvî
.
ª∂_å™s„r_œ°io
 = sîvî.
unixtime
;

1857  
	`sd¢ew
(
buf
);

1859  
NULL
;

1860 
	}
}

1910 
	#PSYNC_WRITE_ERROR
 0

	)

1911 
	#PSYNC_WAIT_REPLY
 1

	)

1912 
	#PSYNC_CONTINUE
 2

	)

1913 
	#PSYNC_FULLRESYNC
 3

	)

1914 
	#PSYNC_NOT_SUPPORTED
 4

	)

1915 
	#PSYNC_TRY_LATER
 5

	)

1916 
	$¶aveTryP¨tülResynchr⁄iz©i⁄
(
c⁄√˘i⁄
 *
c⁄n
, 
ªad_ª∂y
) {

1917 *
psync_ª∂id
;

1918 
psync_off£t
[32];

1919 
sds
 
ª∂y
;

1922 i‡(!
ªad_ª∂y
) {

1928 
£rvî
.
ma°î_öôül_off£t
 = -1;

1930 i‡(
£rvî
.
ˇched_ma°î
) {

1931 
psync_ª∂id
 = 
£rvî
.
ˇched_ma°î
->
ª∂id
;

1932 
	`¢¥ötf
(
psync_off£t
,’sync_off£t),"%Œd", 
£rvî
.
ˇched_ma°î
->
ª∂off
+1);

1933 
	`£rvîLog
(
LL_NOTICE
,"TryögáÖ¨tü»ªsynchr⁄iz©i⁄ (ªque° %s:%s).", 
psync_ª∂id
, 
psync_off£t
);

1935 
	`£rvîLog
(
LL_NOTICE
,"PartialÑesynchronizationÇotÖossible (no cached master)");

1936 
psync_ª∂id
 = "?";

1937 
	`mem˝y
(
psync_off£t
,"-1",3);

1941 
ª∂y
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_WRITE
,
c⁄n
,"PSYNC",
psync_ª∂id
,
psync_off£t
,
NULL
);

1942 i‡(
ª∂y
 !
NULL
) {

1943 
	`£rvîLog
(
LL_WARNING
,"U«bÀÅÿ£nd PSYNCÅÿma°î: %s",
ª∂y
);

1944 
	`sds‰ì
(
ª∂y
);

1945 
	`c⁄nSëRódH™dÀr
(
c⁄n
, 
NULL
);

1946  
PSYNC_WRITE_ERROR
;

1948  
PSYNC_WAIT_REPLY
;

1952 
ª∂y
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_READ
,
c⁄n
,
NULL
);

1953 i‡(
	`sd¶í
(
ª∂y
) == 0) {

1956 
	`sds‰ì
(
ª∂y
);

1957  
PSYNC_WAIT_REPLY
;

1960 
	`c⁄nSëRódH™dÀr
(
c⁄n
, 
NULL
);

1962 i‡(!
	`°∫cmp
(
ª∂y
,"+FULLRESYNC",11)) {

1963 *
ª∂id
 = 
NULL
, *
off£t
 = NULL;

1967 
ª∂id
 = 
	`°rchr
(
ª∂y
,' ');

1968 i‡(
ª∂id
) {

1969 
ª∂id
++;

1970 
off£t
 = 
	`°rchr
(
ª∂id
,' ');

1971 i‡(
off£t
) offset++;

1973 i‡(!
ª∂id
 || !
off£t
 || (off£t-ª∂id-1Ë!
CONFIG_RUN_ID_SIZE
) {

1974 
	`£rvîLog
(
LL_WARNING
,

1980 
	`mem£t
(
£rvî
.
ma°î_ª∂id
,0,
CONFIG_RUN_ID_SIZE
+1);

1982 
	`mem˝y
(
£rvî
.
ma°î_ª∂id
, 
ª∂id
, 
off£t
-replid-1);

1983 
£rvî
.
ma°î_ª∂id
[
CONFIG_RUN_ID_SIZE
] = '\0';

1984 
£rvî
.
ma°î_öôül_off£t
 = 
	`°πﬁl
(
off£t
,
NULL
,10);

1985 
	`£rvîLog
(
LL_NOTICE
,"FullÑesync from master: %s:%lld",

1986 
£rvî
.
ma°î_ª∂id
,

1987 
£rvî
.
ma°î_öôül_off£t
);

1990 
	`ª∂iˇti⁄DisˇrdCachedMa°î
();

1991 
	`sds‰ì
(
ª∂y
);

1992  
PSYNC_FULLRESYNC
;

1995 i‡(!
	`°∫cmp
(
ª∂y
,"+CONTINUE",9)) {

1997 
	`£rvîLog
(
LL_NOTICE
,

2005 *
°¨t
 = 
ª∂y
+10;

2006 *
íd
 = 
ª∂y
+9;

2007 
íd
[0] != '\r' &&Énd[0] != '\n' &&Énd[0] != '\0')Énd++;

2008 i‡(
íd
-
°¨t
 =
CONFIG_RUN_ID_SIZE
) {

2009 
√w
[
CONFIG_RUN_ID_SIZE
+1];

2010 
	`mem˝y
(
√w
,
°¨t
,
CONFIG_RUN_ID_SIZE
);

2011 
√w
[
CONFIG_RUN_ID_SIZE
] = '\0';

2013 i‡(
	`°rcmp
(
√w
,
£rvî
.
ˇched_ma°î
->
ª∂id
)) {

2015 
	`£rvîLog
(
LL_WARNING
,"Ma°îÑïliˇti⁄ ID ch™gedÅÿ%s",
√w
);

2018 
	`mem˝y
(
£rvî
.
ª∂id2
,£rvî.
ˇched_ma°î
->
ª∂id
,

2019 (
£rvî
.
ª∂id2
));

2020 
£rvî
.
£c⁄d_ª∂id_off£t
 = sîvî.
ma°î_ª∂_off£t
+1;

2024 
	`mem˝y
(
£rvî
.
ª∂id
,
√w
,(server.replid));

2025 
	`mem˝y
(
£rvî
.
ˇched_ma°î
->
ª∂id
,
√w
,(server.replid));

2028 
	`disc⁄√˘Sœves
();

2033 
	`sds‰ì
(
ª∂y
);

2034 
	`ª∂iˇti⁄Resuºe˘CachedMa°î
(
c⁄n
);

2039 i‡(
£rvî
.
ª∂_backlog
 =
NULL
Ë
	`¸óãRïliˇti⁄Backlog
();

2040  
PSYNC_CONTINUE
;

2050 i‡(!
	`°∫cmp
(
ª∂y
,"-NOMASTERLINK",13) ||

2051 !
	`°∫cmp
(
ª∂y
,"-LOADING",8))

2053 
	`£rvîLog
(
LL_NOTICE
,

2055 "buàshould bêöÅhêfutuª: %s", 
ª∂y
);

2056 
	`sds‰ì
(
ª∂y
);

2057  
PSYNC_TRY_LATER
;

2060 i‡(
	`°∫cmp
(
ª∂y
,"-ERR",4)) {

2062 
	`£rvîLog
(
LL_WARNING
,

2063 "U√x≥˘edÑïlyÅÿPSYNC from ma°î: %s", 
ª∂y
);

2065 
	`£rvîLog
(
LL_NOTICE
,

2067 "îr‹ sèã (ª∂y: %s)", 
ª∂y
);

2069 
	`sds‰ì
(
ª∂y
);

2070 
	`ª∂iˇti⁄DisˇrdCachedMa°î
();

2071  
PSYNC_NOT_SUPPORTED
;

2072 
	}
}

2076 
	$syncWôhMa°î
(
c⁄√˘i⁄
 *
c⁄n
) {

2077 
tmpfûe
[256], *
îr
 = 
NULL
;

2078 
dfd
 = -1, 
maxåõs
 = 5;

2079 
psync_ªsu…
;

2083 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_NONE
) {

2084 
	`c⁄nClo£
(
c⁄n
);

2090 i‡(
	`c⁄nGëSèã
(
c⁄n
Ë!
CONN_STATE_CONNECTED
) {

2091 
	`£rvîLog
(
LL_WARNING
,"Error condition on socket for SYNC: %s",

2092 
	`c⁄nGëLa°Eº‹
(
c⁄n
));

2093 
îr‹
;

2097 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTING
) {

2098 
	`£rvîLog
(
LL_NOTICE
,"Non blocking connect for SYNC firedÅheÉvent.");

2101 
	`c⁄nSëRódH™dÀr
(
c⁄n
, 
syncWôhMa°î
);

2102 
	`c⁄nSëWrôeH™dÀr
(
c⁄n
, 
NULL
);

2103 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_RECEIVE_PONG
;

2106 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_WRITE
,
c⁄n
,"PING",
NULL
);

2107 i‡(
îr
Ë
wrôe_îr‹
;

2112 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_RECEIVE_PONG
) {

2113 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_READ
,
c⁄n
,
NULL
);

2120 i‡(
îr
[0] != '+' &&

2121 
	`°∫cmp
(
îr
,"-NOAUTH",7) != 0 &&

2122 
	`°∫cmp
(
îr
,"-ERR operationÇotÖermitted",28) != 0)

2124 
	`£rvîLog
(
LL_WARNING
,"Eº‹ÑïlyÅÿPING from ma°î: '%s'",
îr
);

2125 
	`sds‰ì
(
îr
);

2126 
îr‹
;

2128 
	`£rvîLog
(
LL_NOTICE
,

2131 
	`sds‰ì
(
îr
);

2132 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_SEND_AUTH
;

2136 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_SEND_AUTH
) {

2137 i‡(
£rvî
.
ma°îu£r
 && sîvî.
ma°îauth
) {

2138 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_WRITE
,
c⁄n
,"AUTH",

2139 
£rvî
.
ma°îu£r
,£rvî.
ma°îauth
,
NULL
);

2140 i‡(
îr
Ë
wrôe_îr‹
;

2141 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_RECEIVE_AUTH
;

2143 } i‡(
£rvî
.
ma°îauth
) {

2144 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_WRITE
,
c⁄n
,"AUTH",
£rvî
.
ma°îauth
,
NULL
);

2145 i‡(
îr
Ë
wrôe_îr‹
;

2146 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_RECEIVE_AUTH
;

2149 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_SEND_PORT
;

2154 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_RECEIVE_AUTH
) {

2155 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_READ
,
c⁄n
,
NULL
);

2156 i‡(
îr
[0] == '-') {

2157 
	`£rvîLog
(
LL_WARNING
,"U«bÀÅÿAUTHÅÿMASTER: %s",
îr
);

2158 
	`sds‰ì
(
îr
);

2159 
îr‹
;

2161 
	`sds‰ì
(
îr
);

2162 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_SEND_PORT
;

2167 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_SEND_PORT
) {

2168 
p‹t
;

2169 i‡(
£rvî
.
¶ave_™noun˚_p‹t
Ë
p‹t
 = server.slave_announce_port;

2170 i‡(
£rvî
.
és_ª∂iˇti⁄
 && sîvî.
és_p‹t
Ë
p‹t
 = server.tls_port;

2171 
p‹t
 = 
£rvî
.port;

2172 
sds
 
p‹t°r
 = 
	`sds‰oml⁄gl⁄g
(
p‹t
);

2173 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_WRITE
,
c⁄n
,"REPLCONF",

2174 "li°íög-p‹t",
p‹t°r
, 
NULL
);

2175 
	`sds‰ì
(
p‹t°r
);

2176 i‡(
îr
Ë
wrôe_îr‹
;

2177 
	`sds‰ì
(
îr
);

2178 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_RECEIVE_PORT
;

2183 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_RECEIVE_PORT
) {

2184 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_READ
,
c⁄n
,
NULL
);

2187 i‡(
îr
[0] == '-') {

2188 
	`£rvîLog
(
LL_NOTICE
,"(Non critical) Master doesÇot understand "

2189 "REPLCONFÜi°íög-p‹t: %s", 
îr
);

2191 
	`sds‰ì
(
îr
);

2192 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_SEND_IP
;

2196 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_SEND_IP
 &&

2197 
£rvî
.
¶ave_™noun˚_ù
 =
NULL
)

2199 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_SEND_CAPA
;

2204 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_SEND_IP
) {

2205 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_WRITE
,
c⁄n
,"REPLCONF",

2206 "ù-addªss",
£rvî
.
¶ave_™noun˚_ù
, 
NULL
);

2207 i‡(
îr
Ë
wrôe_îr‹
;

2208 
	`sds‰ì
(
îr
);

2209 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_RECEIVE_IP
;

2214 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_RECEIVE_IP
) {

2215 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_READ
,
c⁄n
,
NULL
);

2218 i‡(
îr
[0] == '-') {

2219 
	`£rvîLog
(
LL_NOTICE
,"(Non critical) Master doesÇot understand "

2220 "REPLCONF ip-addªss: %s", 
îr
);

2222 
	`sds‰ì
(
îr
);

2223 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_SEND_CAPA
;

2232 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_SEND_CAPA
) {

2233 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_WRITE
,
c⁄n
,"REPLCONF",

2234 "ˇ∑","eof","ˇ∑","psync2",
NULL
);

2235 i‡(
îr
Ë
wrôe_îr‹
;

2236 
	`sds‰ì
(
îr
);

2237 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_RECEIVE_CAPA
;

2242 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_RECEIVE_CAPA
) {

2243 
îr
 = 
	`£ndSynchr⁄ousComm™d
(
SYNC_CMD_READ
,
c⁄n
,
NULL
);

2246 i‡(
îr
[0] == '-') {

2247 
	`£rvîLog
(
LL_NOTICE
,"(Non critical) Master doesÇot understand "

2248 "REPLCONF c≠a: %s", 
îr
);

2250 
	`sds‰ì
(
îr
);

2251 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_SEND_PSYNC
;

2259 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_SEND_PSYNC
) {

2260 i‡(
	`¶aveTryP¨tülResynchr⁄iz©i⁄
(
c⁄n
,0Ë=
PSYNC_WRITE_ERROR
) {

2261 
îr
 = 
	`sd¢ew
("WriteÉrror sendingÅhe PSYNC command.");

2262 
wrôe_îr‹
;

2264 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_RECEIVE_PSYNC
;

2269 i‡(
£rvî
.
ª∂_°©e
 !
REPL_STATE_RECEIVE_PSYNC
) {

2270 
	`£rvîLog
(
LL_WARNING
,"syncWithMaster(): state machineÉrror, "

2272 
£rvî
.
ª∂_°©e
);

2273 
îr‹
;

2276 
psync_ªsu…
 = 
	`¶aveTryP¨tülResynchr⁄iz©i⁄
(
c⁄n
,1);

2277 i‡(
psync_ªsu…
 =
PSYNC_WAIT_REPLY
) ;

2283 i‡(
psync_ªsu…
 =
PSYNC_TRY_LATER
Ë
îr‹
;

2288 i‡(
psync_ªsu…
 =
PSYNC_CONTINUE
) {

2289 
	`£rvîLog
(
LL_NOTICE
, "MASTER <-> REPLICA sync: Masterácceptedá Partial Resynchronization.");

2290 i‡(
£rvî
.
su≥rvi£d_mode
 =
SUPERVISED_SYSTEMD
) {

2291 
	`ªdisCommuniˇãSy°emd
("STATUS=MASTER <-> REPLICA sync: Partial Resynchronizationáccepted. ReadyÅoáccept connections.\n");

2292 
	`ªdisCommuniˇãSy°emd
("READY=1\n");

2301 
	`disc⁄√˘Sœves
();

2302 
	`‰ìRïliˇti⁄Backlog
();

2307 i‡(
psync_ªsu…
 =
PSYNC_NOT_SUPPORTED
) {

2308 
	`£rvîLog
(
LL_NOTICE
,"Retrying with SYNC...");

2309 i‡(
	`c⁄nSyncWrôe
(
c⁄n
,"SYNC\r\n",6,
£rvî
.
ª∂_syncio_timeout
*1000) == -1) {

2310 
	`£rvîLog
(
LL_WARNING
,"I/OÉrror writingÅo MASTER: %s",

2311 
	`°ªº‹
(
î∫o
));

2312 
îr‹
;

2317 i‡(!
	`u£DiskÀssLﬂd
()) {

2318 
maxåõs
--) {

2319 
	`¢¥ötf
(
tmpfûe
,256,

2320 "ãmp-%d.%ld.rdb",()
£rvî
.
unixtime
,()
	`gëpid
());

2321 
dfd
 = 
	`›í
(
tmpfûe
,
O_CREAT
|
O_WRONLY
|
O_EXCL
,0644);

2322 i‡(
dfd
 != -1) ;

2323 
	`¶ìp
(1);

2325 i‡(
dfd
 == -1) {

2326 
	`£rvîLog
(
LL_WARNING
,"O≥nögÅhêãm∞fûê√eded f‹ MASTER <-> REPLICA synchr⁄iz©i⁄: %s",
	`°ªº‹
(
î∫o
));

2327 
îr‹
;

2329 
£rvî
.
ª∂_å™s„r_tmpfûe
 = 
	`z°rdup
(
tmpfûe
);

2330 
£rvî
.
ª∂_å™s„r_fd
 = 
dfd
;

2334 i‡(
	`c⁄nSëRódH™dÀr
(
c⁄n
, 
ªadSyncBulkPaylﬂd
)

2335 =
C_ERR
)

2337 
c⁄nöfo
[
CONN_INFO_LEN
];

2338 
	`£rvîLog
(
LL_WARNING
,

2340 
	`°ªº‹
(
î∫o
), 
	`c⁄nGëInfo
(
c⁄n
, 
c⁄nöfo
, (conninfo)));

2341 
îr‹
;

2344 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_TRANSFER
;

2345 
£rvî
.
ª∂_å™s„r_size
 = -1;

2346 
£rvî
.
ª∂_å™s„r_ªad
 = 0;

2347 
£rvî
.
ª∂_å™s„r_œ°_fsync_off
 = 0;

2348 
£rvî
.
ª∂_å™s„r_œ°io
 = sîvî.
unixtime
;

2351 
îr‹
:

2352 i‡(
dfd
 !-1Ë
	`˛o£
(dfd);

2353 
	`c⁄nClo£
(
c⁄n
);

2354 
£rvî
.
ª∂_å™s„r_s
 = 
NULL
;

2355 i‡(
£rvî
.
ª∂_å™s„r_fd
 != -1)

2356 
	`˛o£
(
£rvî
.
ª∂_å™s„r_fd
);

2357 i‡(
£rvî
.
ª∂_å™s„r_tmpfûe
)

2358 
	`z‰ì
(
£rvî
.
ª∂_å™s„r_tmpfûe
);

2359 
£rvî
.
ª∂_å™s„r_tmpfûe
 = 
NULL
;

2360 
£rvî
.
ª∂_å™s„r_fd
 = -1;

2361 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_CONNECT
;

2364 
wrôe_îr‹
:

2365 
	`£rvîLog
(
LL_WARNING
,"Sídög comm™dÅÿma°î i¿ª∂iˇti⁄ h™dshake: %s", 
îr
);

2366 
	`sds‰ì
(
îr
);

2367 
îr‹
;

2368 
	}
}

2370 
	$c⁄√˘WôhMa°î
() {

2371 
£rvî
.
ª∂_å™s„r_s
 = sîvî.
és_ª∂iˇti⁄
 ? 
	`c⁄nCª©eTLS
(Ë: 
	`c⁄nCª©eSockë
();

2372 i‡(
	`c⁄nC⁄√˘
(
£rvî
.
ª∂_å™s„r_s
, sîvî.
ma°îho°
, sîvî.
ma°îp‹t
,

2373 
NET_FIRST_BIND_ADDR
, 
syncWôhMa°î
Ë=
C_ERR
) {

2374 
	`£rvîLog
(
LL_WARNING
,"UnableÅo connectÅo MASTER: %s",

2375 
	`c⁄nGëLa°Eº‹
(
£rvî
.
ª∂_å™s„r_s
));

2376 
	`c⁄nClo£
(
£rvî
.
ª∂_å™s„r_s
);

2377 
£rvî
.
ª∂_å™s„r_s
 = 
NULL
;

2378  
C_ERR
;

2382 
£rvî
.
ª∂_å™s„r_œ°io
 = sîvî.
unixtime
;

2383 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_CONNECTING
;

2384  
C_OK
;

2385 
	}
}

2391 
	$undoC⁄√˘WôhMa°î
() {

2392 
	`c⁄nClo£
(
£rvî
.
ª∂_å™s„r_s
);

2393 
£rvî
.
ª∂_å™s„r_s
 = 
NULL
;

2394 
	}
}

2399 
	$ª∂iˇti⁄Ab‹tSyncTøns„r
() {

2400 
	`£rvîAs£π
(
£rvî
.
ª∂_°©e
 =
REPL_STATE_TRANSFER
);

2401 
	`undoC⁄√˘WôhMa°î
();

2402 i‡(
£rvî
.
ª∂_å™s„r_fd
!=-1) {

2403 
	`˛o£
(
£rvî
.
ª∂_å™s„r_fd
);

2404 
	`u∆ök
(
£rvî
.
ª∂_å™s„r_tmpfûe
);

2405 
	`z‰ì
(
£rvî
.
ª∂_å™s„r_tmpfûe
);

2406 
£rvî
.
ª∂_å™s„r_tmpfûe
 = 
NULL
;

2407 
£rvî
.
ª∂_å™s„r_fd
 = -1;

2409 
	}
}

2419 
	$ˇn˚lRïliˇti⁄H™dshake
() {

2420 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_TRANSFER
) {

2421 
	`ª∂iˇti⁄Ab‹tSyncTøns„r
();

2422 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_CONNECT
;

2423 } i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTING
 ||

2424 
	`¶aveIsInH™dshakeSèã
())

2426 
	`undoC⁄√˘WôhMa°î
();

2427 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_CONNECT
;

2432 
	}
}

2435 
	$ª∂iˇti⁄SëMa°î
(*
ù
, 
p‹t
) {

2436 
was_ma°î
 = 
£rvî
.
ma°îho°
 =
NULL
;

2438 
	`sds‰ì
(
£rvî
.
ma°îho°
);

2439 
£rvî
.
ma°îho°
 = 
	`sd¢ew
(
ù
);

2440 
£rvî
.
ma°îp‹t
 = 
p‹t
;

2441 i‡(
£rvî
.
ma°î
) {

2442 
	`‰ìClõ¡
(
£rvî
.
ma°î
);

2444 
	`disc⁄√˘AŒBlockedClõ¡s
();

2448 
	`disc⁄√˘Sœves
();

2449 
	`ˇn˚lRïliˇti⁄H™dshake
();

2452 i‡(
was_ma°î
) {

2453 
	`ª∂iˇti⁄DisˇrdCachedMa°î
();

2454 
	`ª∂iˇti⁄CacheMa°îUsögMy£lf
();

2458 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_REPLICATION_ROLE_CHANGED
,

2459 
REDISMODULE_EVENT_REPLROLECHANGED_NOW_REPLICA
,

2460 
NULL
);

2463 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTED
)

2464 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_MASTER_LINK_CHANGE
,

2465 
REDISMODULE_SUBEVENT_MASTER_LINK_DOWN
,

2466 
NULL
);

2468 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_CONNECT
;

2469 
	}
}

2472 
	$ª∂iˇti⁄Un£tMa°î
() {

2473 i‡(
£rvî
.
ma°îho°
 =
NULL
) ;

2476 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTED
)

2477 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_MASTER_LINK_CHANGE
,

2478 
REDISMODULE_SUBEVENT_MASTER_LINK_DOWN
,

2479 
NULL
);

2481 
	`sds‰ì
(
£rvî
.
ma°îho°
);

2482 
£rvî
.
ma°îho°
 = 
NULL
;

2487 
	`shi·Rïliˇti⁄Id
();

2488 i‡(
£rvî
.
ma°î
Ë
	`‰ìClõ¡
(server.master);

2489 
	`ª∂iˇti⁄DisˇrdCachedMa°î
();

2490 
	`ˇn˚lRïliˇti⁄H™dshake
();

2495 
	`disc⁄√˘Sœves
();

2496 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_NONE
;

2502 
£rvî
.
¶ave£ldb
 = -1;

2508 
£rvî
.
ª∂_no_¶aves_sö˚
 = sîvî.
unixtime
;

2511 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_REPLICATION_ROLE_CHANGED
,

2512 
REDISMODULE_EVENT_REPLROLECHANGED_NOW_MASTER
,

2513 
NULL
);

2517 i‡(
£rvî
.
aof_íabÀd
 && sîvî.
aof_°©e
 =
AOF_OFF
Ë
	`ª°¨tAOFA·îSYNC
();

2518 
	}
}

2522 
	$ª∂iˇti⁄H™dÀMa°îDisc⁄√˘i⁄
() {

2524 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTED
)

2525 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_MASTER_LINK_CHANGE
,

2526 
REDISMODULE_SUBEVENT_MASTER_LINK_DOWN
,

2527 
NULL
);

2529 
£rvî
.
ma°î
 = 
NULL
;

2530 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_CONNECT
;

2531 
£rvî
.
ª∂_down_sö˚
 = sîvî.
unixtime
;

2535 
	}
}

2537 
	$ª∂iˇofComm™d
(
˛õ¡
 *
c
) {

2540 i‡(
£rvî
.
˛u°î_íabÀd
) {

2541 
	`addRïlyEº‹
(
c
,"REPLICAOFÇotállowed in cluster mode.");

2547 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"no") &&

2548 !
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"one")) {

2549 i‡(
£rvî
.
ma°îho°
) {

2550 
	`ª∂iˇti⁄Un£tMa°î
();

2551 
sds
 
˛õ¡
 = 
	`ˇtClõ¡InfoSåög
(
	`sd£m±y
(),
c
);

2552 
	`£rvîLog
(
LL_NOTICE
,"MASTER MODEÉnabled (userÑequest from '%s')",

2553 
˛õ¡
);

2554 
	`sds‰ì
(
˛õ¡
);

2557 
p‹t
;

2559 i‡(
c
->
Êags
 & 
CLIENT_SLAVE
)

2564 
	`addRïlyEº‹
(
c
, "Command isÇot valid when client isáÑeplica.");

2568 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
p‹t
, 
NULL
Ë!
C_OK
))

2572 i‡(
£rvî
.
ma°îho°
 && !
	`°rˇ£cmp
(£rvî.ma°îho°,
c
->
¨gv
[1]->
±r
)

2573 && 
£rvî
.
ma°îp‹t
 =
p‹t
) {

2574 
	`£rvîLog
(
LL_NOTICE
,"REPLICAOF wouldÑesult into synchronization "

2577 
	`addRïlySds
(
c
,
	`sd¢ew
("+OK Already connectedÅo specified "

2583 
	`ª∂iˇti⁄SëMa°î
(
c
->
¨gv
[1]->
±r
, 
p‹t
);

2584 
sds
 
˛õ¡
 = 
	`ˇtClõ¡InfoSåög
(
	`sd£m±y
(),
c
);

2585 
	`£rvîLog
(
LL_NOTICE
,"REPLICAOF %s:%dÉnabled (userÑequest from '%s')",

2586 
£rvî
.
ma°îho°
, sîvî.
ma°îp‹t
, 
˛õ¡
);

2587 
	`sds‰ì
(
˛õ¡
);

2589 
	`addRïly
(
c
,
sh¨ed
.
ok
);

2590 
	}
}

2595 
	$rﬁeComm™d
(
˛õ¡
 *
c
) {

2596 i‡(
£rvî
.
ma°îho°
 =
NULL
) {

2597 
li°Iãr
 
li
;

2598 
li°Node
 *
 
;

2599 *
mbcou¡
;

2600 
¶aves
 = 0;

2602 
	`addRïlyAºayLí
(
c
,3);

2603 
	`addRïlyBulkCBuf„r
(
c
,"master",6);

2604 
	`addRïlyL⁄gL⁄g
(
c
,
£rvî
.
ma°î_ª∂_off£t
);

2605 
mbcou¡
 = 
	`addRïlyDe„ºedLí
(
c
);

2606 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

2607 (
 
 = 
	`li°Next
(&
li
))) {

2608 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

2609 
ù
[
NET_IP_STR_LEN
], *
¶aveù
 = 
¶ave
->
¶ave_ù
;

2611 i‡(
¶aveù
[0] == '\0') {

2612 i‡(
	`c⁄nPìrToSåög
(
¶ave
->
c⁄n
,
ù
,(ù),
NULL
) == -1)

2614 
¶aveù
 = 
ù
;

2616 i‡(
¶ave
->
ª∂°©e
 !
SLAVE_STATE_ONLINE
) ;

2617 
	`addRïlyAºayLí
(
c
,3);

2618 
	`addRïlyBulkCSåög
(
c
,
¶aveù
);

2619 
	`addRïlyBulkL⁄gL⁄g
(
c
,
¶ave
->
¶ave_li°íög_p‹t
);

2620 
	`addRïlyBulkL⁄gL⁄g
(
c
,
¶ave
->
ª∂_ack_off
);

2621 
¶aves
++;

2623 
	`£tDe„ºedAºayLí
(
c
,
mbcou¡
,
¶aves
);

2625 *
¶ave°©e
 = 
NULL
;

2627 
	`addRïlyAºayLí
(
c
,5);

2628 
	`addRïlyBulkCBuf„r
(
c
,"slave",5);

2629 
	`addRïlyBulkCSåög
(
c
,
£rvî
.
ma°îho°
);

2630 
	`addRïlyL⁄gL⁄g
(
c
,
£rvî
.
ma°îp‹t
);

2631 i‡(
	`¶aveIsInH™dshakeSèã
()) {

2632 
¶ave°©e
 = "handshake";

2634 
£rvî
.
ª∂_°©e
) {

2635 
REPL_STATE_NONE
: 
¶ave°©e
 = "none"; ;

2636 
REPL_STATE_CONNECT
: 
¶ave°©e
 = "connect"; ;

2637 
REPL_STATE_CONNECTING
: 
¶ave°©e
 = "connecting"; ;

2638 
REPL_STATE_TRANSFER
: 
¶ave°©e
 = "sync"; ;

2639 
REPL_STATE_CONNECTED
: 
¶ave°©e
 = "connected"; ;

2640 : 
¶ave°©e
 = "unknown"; ;

2643 
	`addRïlyBulkCSåög
(
c
,
¶ave°©e
);

2644 
	`addRïlyL⁄gL⁄g
(
c
,
£rvî
.
ma°î
 ? sîvî.ma°î->
ª∂off
 : -1);

2646 
	}
}

2651 
	$ª∂iˇti⁄SídAck
() {

2652 
˛õ¡
 *
c
 = 
£rvî
.
ma°î
;

2654 i‡(
c
 !
NULL
) {

2655 
c
->
Êags
 |
CLIENT_MASTER_FORCE_REPLY
;

2656 
	`addRïlyAºayLí
(
c
,3);

2657 
	`addRïlyBulkCSåög
(
c
,"REPLCONF");

2658 
	`addRïlyBulkCSåög
(
c
,"ACK");

2659 
	`addRïlyBulkL⁄gL⁄g
(
c
,c->
ª∂off
);

2660 
c
->
Êags
 &~
CLIENT_MASTER_FORCE_REPLY
;

2662 
	}
}

2684 
	$ª∂iˇti⁄CacheMa°î
(
˛õ¡
 *
c
) {

2685 
	`£rvîAs£π
(
£rvî
.
ma°î
 !
NULL
 && sîvî.
ˇched_ma°î
 == NULL);

2686 
	`£rvîLog
(
LL_NOTICE
,"CachingÅhe disconnected master state.");

2689 
	`u∆ökClõ¡
(
c
);

2695 
	`sds˛ór
(
£rvî
.
ma°î
->
quîybuf
);

2696 
	`sds˛ór
(
£rvî
.
ma°î
->
≥ndög_quîybuf
);

2700 
£rvî
.
ma°î
->
ª∂off
 = 
	`adju°MónögfulRïlOff£t
();

2701 
£rvî
.
ma°î
->
ªad_ª∂off
 = sîvî.ma°î->
ª∂off
;

2702 i‡(
c
->
Êags
 & 
CLIENT_MULTI
Ë
	`disˇrdTønß˘i⁄
(c);

2703 
	`li°Em±y
(
c
->
ª∂y
);

2704 
c
->
£¡Àn
 = 0;

2705 
c
->
ª∂y_byãs
 = 0;

2706 
c
->
buÂos
 = 0;

2707 
	`ª£tClõ¡
(
c
);

2711 
£rvî
.
ˇched_ma°î
 = sîvî.
ma°î
;

2714 i‡(
c
->
≥îid
) {

2715 
	`sds‰ì
(
c
->
≥îid
);

2716 
c
->
≥îid
 = 
NULL
;

2722 
	`ª∂iˇti⁄H™dÀMa°îDisc⁄√˘i⁄
();

2723 
	}
}

2733 
	$adju°MónögfulRïlOff£t
() {

2734 i‡(
£rvî
.
ma°î_ª∂_off£t
 > sîvî.
ma°î_ª∂_mónögful_off£t
) {

2735 
dñè
 = 
£rvî
.
ma°î_ª∂_off£t
 -

2736 
£rvî
.
ma°î_ª∂_mónögful_off£t
;

2737 
	`£rvîLog
(
LL_NOTICE
,

2740 
£rvî
.
ma°î_ª∂_mónögful_off£t
,

2741 
£rvî
.
ma°î_ª∂_off£t
,

2742 
dñè
);

2743 
£rvî
.
ma°î_ª∂_off£t
 = sîvî.
ma°î_ª∂_mónögful_off£t
;

2744 i‡(
£rvî
.
ª∂_backlog_hi°Àn
 <
dñè
) {

2745 
£rvî
.
ª∂_backlog_hi°Àn
 = 0;

2746 
£rvî
.
ª∂_backlog_idx
 = 0;

2748 
£rvî
.
ª∂_backlog_hi°Àn
 -
dñè
;

2749 
£rvî
.
ª∂_backlog_idx
 =

2750 (
£rvî
.
ª∂_backlog_idx
 + (£rvî.
ª∂_backlog_size
 - 
dñè
)) %

2751 
£rvî
.
ª∂_backlog_size
;

2754  
£rvî
.
ma°î_ª∂_off£t
;

2755 
	}
}

2766 
	$ª∂iˇti⁄CacheMa°îUsögMy£lf
() {

2767 
	`£rvîLog
(
LL_NOTICE
,

2776 
£rvî
.
ma°î_öôül_off£t
 = 
	`adju°MónögfulRïlOff£t
();

2780 
	`ª∂iˇti⁄Cª©eMa°îClõ¡
(
NULL
,-1);

2783 
	`mem˝y
(
£rvî
.
ma°î
->
ª∂id
, server.replid, (server.replid));

2786 
	`u∆ökClõ¡
(
£rvî
.
ma°î
);

2787 
£rvî
.
ˇched_ma°î
 = sîvî.
ma°î
;

2788 
£rvî
.
ma°î
 = 
NULL
;

2789 
	}
}

2793 
	$ª∂iˇti⁄DisˇrdCachedMa°î
() {

2794 i‡(
£rvî
.
ˇched_ma°î
 =
NULL
) ;

2796 
	`£rvîLog
(
LL_NOTICE
,"DiscardingÖreviously cached master state.");

2797 
£rvî
.
ˇched_ma°î
->
Êags
 &~
CLIENT_MASTER
;

2798 
	`‰ìClõ¡
(
£rvî
.
ˇched_ma°î
);

2799 
£rvî
.
ˇched_ma°î
 = 
NULL
;

2800 
	}
}

2808 
	$ª∂iˇti⁄Resuºe˘CachedMa°î
(
c⁄√˘i⁄
 *
c⁄n
) {

2809 
£rvî
.
ma°î
 = sîvî.
ˇched_ma°î
;

2810 
£rvî
.
ˇched_ma°î
 = 
NULL
;

2811 
£rvî
.
ma°î
->
c⁄n
 = conn;

2812 
	`c⁄nSëPriv©eD©a
(
£rvî
.
ma°î
->
c⁄n
, server.master);

2813 
£rvî
.
ma°î
->
Êags
 &~(
CLIENT_CLOSE_AFTER_REPLY
|
CLIENT_CLOSE_ASAP
);

2814 
£rvî
.
ma°î
->
authítiˇãd
 = 1;

2815 
£rvî
.
ma°î
->
œ°öãø˘i⁄
 = sîvî.
unixtime
;

2816 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_CONNECTED
;

2817 
£rvî
.
ª∂_down_sö˚
 = 0;

2820 
	`lökClõ¡
(
£rvî
.
ma°î
);

2821 i‡(
	`c⁄nSëRódH™dÀr
(
£rvî
.
ma°î
->
c⁄n
, 
ªadQuîyFromClõ¡
)) {

2822 
	`£rvîLog
(
LL_WARNING
,"Eº‹Ñesuºe˘ögÅhêˇched ma°î, impossibÀÅÿaddÅhêªadabÀ h™dÀr: %s", 
	`°ªº‹
(
î∫o
));

2823 
	`‰ìClõ¡Async
(
£rvî
.
ma°î
);

2828 i‡(
	`˛õ¡HasPídögRïlõs
(
£rvî
.
ma°î
)) {

2829 i‡(
	`c⁄nSëWrôeH™dÀr
(
£rvî
.
ma°î
->
c⁄n
, 
£ndRïlyToClõ¡
)) {

2830 
	`£rvîLog
(
LL_WARNING
,"Eº‹Ñesuºe˘ögÅhêˇched ma°î, impossibÀÅÿaddÅhêwrôabÀ h™dÀr: %s", 
	`°ªº‹
(
î∫o
));

2831 
	`‰ìClõ¡Async
(
£rvî
.
ma°î
);

2834 
	}
}

2841 
	$ª‰eshGoodSœvesCou¡
() {

2842 
li°Iãr
 
li
;

2843 
li°Node
 *
 
;

2844 
good
 = 0;

2846 i‡(!
£rvî
.
ª∂_mö_¶aves_to_wrôe
 ||

2847 !
£rvî
.
ª∂_mö_¶aves_max_œg
) ;

2849 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

2850 (
 
 = 
	`li°Next
(&
li
))) {

2851 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

2852 
time_t
 
œg
 = 
£rvî
.
unixtime
 - 
¶ave
->
ª∂_ack_time
;

2854 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_ONLINE
 &&

2855 
œg
 <
£rvî
.
ª∂_mö_¶aves_max_œg
Ë
good
++;

2857 
£rvî
.
ª∂_good_¶aves_cou¡
 = 
good
;

2858 
	}
}

2892 
	$ª∂iˇti⁄S¸ùtCacheInô
() {

2893 
£rvî
.
ª∂_s¸ùtˇche_size
 = 10000;

2894 
£rvî
.
ª∂_s¸ùtˇche_di˘
 = 
	`di˘Cª©e
(&
ª∂S¸ùtCacheDi˘Ty≥
,
NULL
);

2895 
£rvî
.
ª∂_s¸ùtˇche_fifo
 = 
	`li°Cª©e
();

2896 
	}
}

2909 
	$ª∂iˇti⁄S¸ùtCacheFlush
() {

2910 
	`di˘Em±y
(
£rvî
.
ª∂_s¸ùtˇche_di˘
,
NULL
);

2911 
	`li°Rñó£
(
£rvî
.
ª∂_s¸ùtˇche_fifo
);

2912 
£rvî
.
ª∂_s¸ùtˇche_fifo
 = 
	`li°Cª©e
();

2913 
	}
}

2917 
	$ª∂iˇti⁄S¸ùtCacheAdd
(
sds
 
sha1
) {

2918 
ªtvÆ
;

2919 
sds
 
key
 = 
	`sdsdup
(
sha1
);

2922 i‡(
	`li°Lígth
(
£rvî
.
ª∂_s¸ùtˇche_fifo
Ë=£rvî.
ª∂_s¸ùtˇche_size
)

2924 
li°Node
 *
 
 = 
	`li°La°
(
£rvî
.
ª∂_s¸ùtˇche_fifo
);

2925 
sds
 
ﬁde°
 = 
	`li°NodeVÆue
(
 
);

2927 
ªtvÆ
 = 
	`di˘Dñëe
(
£rvî
.
ª∂_s¸ùtˇche_di˘
,
ﬁde°
);

2928 
	`£rvîAs£π
(
ªtvÆ
 =
DICT_OK
);

2929 
	`li°DñNode
(
£rvî
.
ª∂_s¸ùtˇche_fifo
,
 
);

2933 
ªtvÆ
 = 
	`di˘Add
(
£rvî
.
ª∂_s¸ùtˇche_di˘
,
key
,
NULL
);

2934 
	`li°AddNodeHód
(
£rvî
.
ª∂_s¸ùtˇche_fifo
,
key
);

2935 
	`£rvîAs£π
(
ªtvÆ
 =
DICT_OK
);

2936 
	}
}

2940 
	$ª∂iˇti⁄S¸ùtCacheExi°s
(
sds
 
sha1
) {

2941  
	`di˘Föd
(
£rvî
.
ª∂_s¸ùtˇche_di˘
,
sha1
Ë!
NULL
;

2942 
	}
}

2974 
	$ª∂iˇti⁄Reque°AckFromSœves
() {

2975 
£rvî
.
gë_ack_‰om_¶aves
 = 1;

2976 
	}
}

2980 
	$ª∂iˇti⁄Cou¡AcksByOff£t
(
off£t
) {

2981 
li°Iãr
 
li
;

2982 
li°Node
 *
 
;

2983 
cou¡
 = 0;

2985 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

2986 (
 
 = 
	`li°Next
(&
li
))) {

2987 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

2989 i‡(
¶ave
->
ª∂°©e
 !
SLAVE_STATE_ONLINE
) ;

2990 i‡(
¶ave
->
ª∂_ack_off
 >
off£t
Ë
cou¡
++;

2992  
cou¡
;

2993 
	}
}

2997 
	$waôComm™d
(
˛õ¡
 *
c
) {

2998 
m°ime_t
 
timeout
;

2999 
numª∂iˇs
, 
ackª∂iˇs
;

3000 
off£t
 = 
c
->
woff
;

3002 i‡(
£rvî
.
ma°îho°
) {

3003 
	`addRïlyEº‹
(
c
,"WAIT cannot be used withÑeplica instances. PleaseálsoÇoteÅhat since Redis 4.0 ifáÑeplica is configuredÅo be writable (which isÇotÅhe default) writesÅoÑeplicasáre justÜocalándáreÇotÖropagated.");

3008 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[1],&
numª∂iˇs
,
NULL
Ë!
C_OK
)

3010 i‡(
	`gëTimeoutFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
timeout
,
UNIT_MILLISECONDS
)

3011 !
C_OK
) ;

3014 
ackª∂iˇs
 = 
	`ª∂iˇti⁄Cou¡AcksByOff£t
(
c
->
woff
);

3015 i‡(
ackª∂iˇs
 >
numª∂iˇs
 || 
c
->
Êags
 & 
CLIENT_MULTI
) {

3016 
	`addRïlyL⁄gL⁄g
(
c
,
ackª∂iˇs
);

3022 
c
->
bp›
.
timeout
 =Åimeout;

3023 
c
->
bp›
.
ª∂off£t
 = 
off£t
;

3024 
c
->
bp›
.
numª∂iˇs
 =Çumreplicas;

3025 
	`li°AddNodeTaû
(
£rvî
.
˛õ¡s_waôög_acks
,
c
);

3026 
	`blockClõ¡
(
c
,
BLOCKED_WAIT
);

3030 
	`ª∂iˇti⁄Reque°AckFromSœves
();

3031 
	}
}

3037 
	$unblockClõ¡WaôögRïliˇs
(
˛õ¡
 *
c
) {

3038 
li°Node
 *
 
 = 
	`li°SórchKey
(
£rvî
.
˛õ¡s_waôög_acks
,
c
);

3039 
	`£rvîAs£π
(
 
 !
NULL
);

3040 
	`li°DñNode
(
£rvî
.
˛õ¡s_waôög_acks
,
 
);

3041 
	}
}

3045 
	$¥o˚ssClõ¡sWaôögRïliˇs
() {

3046 
œ°_off£t
 = 0;

3047 
œ°_numª∂iˇs
 = 0;

3049 
li°Iãr
 
li
;

3050 
li°Node
 *
 
;

3052 
	`li°Rewöd
(
£rvî
.
˛õ¡s_waôög_acks
,&
li
);

3053 (
 
 = 
	`li°Next
(&
li
))) {

3054 
˛õ¡
 *
c
 = 
 
->
vÆue
;

3060 i‡(
œ°_off£t
 &&Üa°_off£à> 
c
->
bp›
.
ª∂off£t
 &&

3061 
œ°_numª∂iˇs
 > 
c
->
bp›
.
numª∂iˇs
)

3063 
	`unblockClõ¡
(
c
);

3064 
	`addRïlyL⁄gL⁄g
(
c
,
œ°_numª∂iˇs
);

3066 
numª∂iˇs
 = 
	`ª∂iˇti⁄Cou¡AcksByOff£t
(
c
->
bp›
.
ª∂off£t
);

3068 i‡(
numª∂iˇs
 >
c
->
bp›
.numreplicas) {

3069 
œ°_off£t
 = 
c
->
bp›
.
ª∂off£t
;

3070 
œ°_numª∂iˇs
 = 
numª∂iˇs
;

3071 
	`unblockClõ¡
(
c
);

3072 
	`addRïlyL⁄gL⁄g
(
c
,
numª∂iˇs
);

3076 
	}
}

3080 
	$ª∂iˇti⁄GëSœveOff£t
() {

3081 
off£t
 = 0;

3083 i‡(
£rvî
.
ma°îho°
 !
NULL
) {

3084 i‡(
£rvî
.
ma°î
) {

3085 
off£t
 = 
£rvî
.
ma°î
->
ª∂off
;

3086 } i‡(
£rvî
.
ˇched_ma°î
) {

3087 
off£t
 = 
£rvî
.
ˇched_ma°î
->
ª∂off
;

3094 i‡(
off£t
 < 0) offset = 0;

3095  
off£t
;

3096 
	}
}

3101 
	$ª∂iˇti⁄Cr⁄
() {

3102 
ª∂iˇti⁄_¸⁄_lo›s
 = 0;

3105 i‡(
£rvî
.
ma°îho°
 &&

3106 (
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTING
 ||

3107 
	`¶aveIsInH™dshakeSèã
()) &&

3108 (
	`time
(
NULL
)-
£rvî
.
ª∂_å™s„r_œ°io
Ë> sîvî.
ª∂_timeout
)

3110 
	`£rvîLog
(
LL_WARNING
,"Timeout connectingÅoÅhe MASTER...");

3111 
	`ˇn˚lRïliˇti⁄H™dshake
();

3115 i‡(
£rvî
.
ma°îho°
 && sîvî.
ª∂_°©e
 =
REPL_STATE_TRANSFER
 &&

3116 (
	`time
(
NULL
)-
£rvî
.
ª∂_å™s„r_œ°io
Ë> sîvî.
ª∂_timeout
)

3118 
	`£rvîLog
(
LL_WARNING
,"TimeoutÑeceiving bulk data from MASTER... IfÅheÖroblemÖersistsÅryÅo setÅhe 'repl-timeout'Öarameter inÑedis.confÅoáÜarger value.");

3119 
	`ˇn˚lRïliˇti⁄H™dshake
();

3123 i‡(
£rvî
.
ma°îho°
 && sîvî.
ª∂_°©e
 =
REPL_STATE_CONNECTED
 &&

3124 (
	`time
(
NULL
)-
£rvî
.
ma°î
->
œ°öãø˘i⁄
Ë> sîvî.
ª∂_timeout
)

3126 
	`£rvîLog
(
LL_WARNING
,"MASTERÅimeout:Ço dataÇor PINGÑeceived...");

3127 
	`‰ìClõ¡
(
£rvî
.
ma°î
);

3131 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECT
) {

3132 
	`£rvîLog
(
LL_NOTICE
,"ConnectingÅo MASTER %s:%d",

3133 
£rvî
.
ma°îho°
, sîvî.
ma°îp‹t
);

3134 i‡(
	`c⁄√˘WôhMa°î
(Ë=
C_OK
) {

3135 
	`£rvîLog
(
LL_NOTICE
,"MASTER <-> REPLICA sync started");

3142 i‡(
£rvî
.
ma°îho°
 && sîvî.
ma°î
 &&

3143 !(
£rvî
.
ma°î
->
Êags
 & 
CLIENT_PRE_PSYNC
))

3144 
	`ª∂iˇti⁄SídAck
();

3150 
li°Iãr
 
li
;

3151 
li°Node
 *
 
;

3152 
robj
 *
pög_¨gv
[1];

3155 i‡((
ª∂iˇti⁄_¸⁄_lo›s
 % 
£rvî
.
ª∂_pög_¶ave_≥riod
) == 0 &&

3156 
	`li°Lígth
(
£rvî
.
¶aves
))

3162 
m™uÆ_Áûovî_ö_¥ogªss
 =

3163 
£rvî
.
˛u°î_íabÀd
 &&

3164 
£rvî
.
˛u°î
->
mf_íd
 &&

3165 
	`˛õ¡sAªPau£d
();

3167 i‡(!
m™uÆ_Áûovî_ö_¥ogªss
) {

3168 
bef‹e_pög
 = 
£rvî
.
ma°î_ª∂_mónögful_off£t
;

3169 
pög_¨gv
[0] = 
	`¸óãSåögObje˘
("PING",4);

3170 
	`ª∂iˇti⁄FìdSœves
(
£rvî
.
¶aves
, sîvî.
¶ave£ldb
,

3171 
pög_¨gv
, 1);

3172 
	`de¸RefCou¡
(
pög_¨gv
[0]);

3179 
£rvî
.
ma°î_ª∂_mónögful_off£t
 = 
bef‹e_pög
;

3197 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

3198 (
 
 = 
	`li°Next
(&
li
))) {

3199 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

3201 
is_¥esync
 =

3202 (
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
 ||

3203 (
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_END
 &&

3204 
£rvî
.
rdb_chûd_ty≥
 !
RDB_CHILD_TYPE_SOCKET
));

3206 i‡(
is_¥esync
) {

3207 
	`c⁄nWrôe
(
¶ave
->
c⁄n
, "\n", 1);

3212 i‡(
	`li°Lígth
(
£rvî
.
¶aves
)) {

3213 
li°Iãr
 
li
;

3214 
li°Node
 *
 
;

3216 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

3217 (
 
 = 
	`li°Next
(&
li
))) {

3218 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

3220 i‡(
¶ave
->
ª∂°©e
 !
SLAVE_STATE_ONLINE
) ;

3221 i‡(
¶ave
->
Êags
 & 
CLIENT_PRE_PSYNC
) ;

3222 i‡((
£rvî
.
unixtime
 - 
¶ave
->
ª∂_ack_time
Ë> sîvî.
ª∂_timeout
)

3224 
	`£rvîLog
(
LL_WARNING
, "DisconnectingÅimedoutÑeplica: %s",

3225 
	`ª∂iˇti⁄GëSœveName
(
¶ave
));

3226 
	`‰ìClõ¡
(
¶ave
);

3237 i‡(
	`li°Lígth
(
£rvî
.
¶aves
Ë=0 && sîvî.
ª∂_backlog_time_limô
 &&

3238 
£rvî
.
ª∂_backlog
 && sîvî.
ma°îho°
 =
NULL
)

3240 
time_t
 
idÀ
 = 
£rvî
.
unixtime
 - sîvî.
ª∂_no_¶aves_sö˚
;

3242 i‡(
idÀ
 > 
£rvî
.
ª∂_backlog_time_limô
) {

3258 
	`ch™geRïliˇti⁄Id
();

3259 
	`˛órRïliˇti⁄Id2
();

3260 
	`‰ìRïliˇti⁄Backlog
();

3261 
	`£rvîLog
(
LL_NOTICE
,

3264 (Ë
£rvî
.
ª∂_backlog_time_limô
);

3271 i‡(
	`li°Lígth
(
£rvî
.
¶aves
) == 0 &&

3272 
£rvî
.
aof_°©e
 =
AOF_OFF
 &&

3273 
	`li°Lígth
(
£rvî
.
ª∂_s¸ùtˇche_fifo
) != 0)

3275 
	`ª∂iˇti⁄S¸ùtCacheFlush
();

3284 i‡(!
	`hasA˘iveChûdPro˚ss
()) {

3285 
time_t
 
idÀ
, 
max_idÀ
 = 0;

3286 
¶aves_waôög
 = 0;

3287 
möˇ∑
 = -1;

3288 
li°Node
 *
 
;

3289 
li°Iãr
 
li
;

3291 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

3292 (
 
 = 
	`li°Next
(&
li
))) {

3293 
˛õ¡
 *
¶ave
 = 
 
->
vÆue
;

3294 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_WAIT_BGSAVE_START
) {

3295 
idÀ
 = 
£rvî
.
unixtime
 - 
¶ave
->
œ°öãø˘i⁄
;

3296 i‡(
idÀ
 > 
max_idÀ
) max_idle = idle;

3297 
¶aves_waôög
++;

3298 
möˇ∑
 = (möˇ∑ =-1Ë? 
¶ave
->
¶ave_ˇ∑
 :

3299 (
möˇ∑
 & 
¶ave
->
¶ave_ˇ∑
);

3303 i‡(
¶aves_waôög
 &&

3304 (!
£rvî
.
ª∂_diskÀss_sync
 ||

3305 
max_idÀ
 > 
£rvî
.
ª∂_diskÀss_sync_dñay
))

3310 
	`°¨tBgßveF‹Rïliˇti⁄
(
möˇ∑
);

3316 
	`ªmoveRDBU£dToSyncRïliˇs
();

3319 
	`ª‰eshGoodSœvesCou¡
();

3320 
ª∂iˇti⁄_¸⁄_lo›s
++;

3321 
	}
}

	@rio.c

48 
	~"fma¸os.h
"

49 
	~<°rög.h
>

50 
	~<°dio.h
>

51 
	~<uni°d.h
>

52 
	~"rio.h
"

53 
	~"utû.h
"

54 
	~"¸c64.h
"

55 
	~"c⁄fig.h
"

56 
	~"£rvî.h
"

61 
size_t
 
	$rioBuf„rWrôe
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
) {

62 
r
->
io
.
buf„r
.
±r
 = 
	`sdsˇéí
‘->io.buf„r.±r,(*)
buf
,
Àn
);

63 
r
->
io
.
buf„r
.
pos
 +
Àn
;

65 
	}
}

68 
size_t
 
	$rioBuf„rRód
(
rio
 *
r
, *
buf
, 
size_t
 
Àn
) {

69 i‡(
	`sd¶í
(
r
->
io
.
buf„r
.
±r
)-r->io.buf„r.
pos
 < 
Àn
)

71 
	`mem˝y
(
buf
,
r
->
io
.
buf„r
.
±r
+r->io.buf„r.
pos
,
Àn
);

72 
r
->
io
.
buf„r
.
pos
 +
Àn
;

74 
	}
}

77 
off_t
 
	$rioBuf„rTñl
(
rio
 *
r
) {

78  
r
->
io
.
buf„r
.
pos
;

79 
	}
}

83 
	$rioBuf„rFlush
(
rio
 *
r
) {

84 
	`UNUSED
(
r
);

86 
	}
}

88 c⁄° 
rio
 
	grioBuf„rIO
 = {

89 
rioBuf„rRód
,

90 
rioBuf„rWrôe
,

91 
rioBuf„rTñl
,

92 
rioBuf„rFlush
,

93 
NULL
,

98 { { 
NULL
, 0 } }

101 
	$rioInôWôhBuf„r
(
rio
 *
r
, 
sds
 
s
) {

102 *
r
 = 
rioBuf„rIO
;

103 
r
->
io
.
buf„r
.
±r
 = 
s
;

104 
r
->
io
.
buf„r
.
pos
 = 0;

105 
	}
}

110 
size_t
 
	$rioFûeWrôe
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
) {

111 
size_t
 
ªtvÆ
;

113 
ªtvÆ
 = 
	`fwrôe
(
buf
,
Àn
,1,
r
->
io
.
fûe
.
Â
);

114 
r
->
io
.
fûe
.
buf„ªd
 +
Àn
;

116 i‡(
r
->
io
.
fûe
.
autosync
 &&

117 
r
->
io
.
fûe
.
buf„ªd
 >r->io.fûe.
autosync
)

119 
	`fÊush
(
r
->
io
.
fûe
.
Â
);

120 
	`ªdis_fsync
(
	`fûío
(
r
->
io
.
fûe
.
Â
));

121 
r
->
io
.
fûe
.
buf„ªd
 = 0;

123  
ªtvÆ
;

124 
	}
}

127 
size_t
 
	$rioFûeRód
(
rio
 *
r
, *
buf
, 
size_t
 
Àn
) {

128  
	`‰ód
(
buf
,
Àn
,1,
r
->
io
.
fûe
.
Â
);

129 
	}
}

132 
off_t
 
	$rioFûeTñl
(
rio
 *
r
) {

133  
	`·ñlo
(
r
->
io
.
fûe
.
Â
);

134 
	}
}

138 
	$rioFûeFlush
(
rio
 *
r
) {

139  (
	`fÊush
(
r
->
io
.
fûe
.
Â
) == 0) ? 1 : 0;

140 
	}
}

142 c⁄° 
rio
 
	grioFûeIO
 = {

143 
rioFûeRód
,

144 
rioFûeWrôe
,

145 
rioFûeTñl
,

146 
rioFûeFlush
,

147 
NULL
,

152 { { 
NULL
, 0 } }

155 
	$rioInôWôhFûe
(
rio
 *
r
, 
FILE
 *
Â
) {

156 *
r
 = 
rioFûeIO
;

157 
r
->
io
.
fûe
.
Â
 = fp;

158 
r
->
io
.
fûe
.
buf„ªd
 = 0;

159 
r
->
io
.
fûe
.
autosync
 = 0;

160 
	}
}

168 
size_t
 
	$rioC⁄nWrôe
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
) {

169 
	`UNUSED
(
r
);

170 
	`UNUSED
(
buf
);

171 
	`UNUSED
(
Àn
);

173 
	}
}

176 
size_t
 
	$rioC⁄nRód
(
rio
 *
r
, *
buf
, 
size_t
 
Àn
) {

177 
size_t
 
avaû
 = 
	`sd¶í
(
r
->
io
.
c⁄n
.
buf
)-r->io.c⁄n.
pos
;

180 i‡(
	`sd¶í
(
r
->
io
.
c⁄n
.
buf
Ë+ 
	`sdßvaû
‘->io.c⁄n.bufË< 
Àn
)

181 
r
->
io
.
c⁄n
.
buf
 = 
	`sdsMakeRoomF‹
‘->io.c⁄n.buf, 
Àn
 - 
	`sd¶í
(r->io.conn.buf));

185 i‡(
Àn
 > 
avaû
 && 
	`sdßvaû
(
r
->
io
.
c⁄n
.
buf
) <Üen -ávail) {

186 
	`sd§™ge
(
r
->
io
.
c⁄n
.
buf
,Ñ->io.c⁄n.
pos
, -1);

187 
r
->
io
.
c⁄n
.
pos
 = 0;

191 
Àn
 > 
	`sd¶í
(
r
->
io
.
c⁄n
.
buf
Ë-Ñ->io.c⁄n.
pos
) {

192 
size_t
 
buf„ªd
 = 
	`sd¶í
(
r
->
io
.
c⁄n
.
buf
Ë-Ñ->io.c⁄n.
pos
;

193 
size_t
 
t‹ód
 = 
Àn
 - 
buf„ªd
;

196 i‡(
t‹ód
 < 
PROTO_IOBUF_LEN
)Åoread = PROTO_IOBUF_LEN;

197 i‡(
t‹ód
 > 
	`sdßvaû
(
r
->
io
.
c⁄n
.
buf
))Åoread = sdsavail(r->io.conn.buf);

198 i‡(
r
->
io
.
c⁄n
.
ªad_limô
 != 0 &&

199 
r
->
io
.
c⁄n
.
ªad_so_Ár
 + 
buf„ªd
 + 
t‹ód
 >Ñ->io.c⁄n.
ªad_limô
)

201 i‡(
r
->
io
.
c⁄n
.
ªad_limô
 >r->io.c⁄n.
ªad_so_Ár
 - 
buf„ªd
)

202 
t‹ód
 = 
r
->
io
.
c⁄n
.
ªad_limô
 -Ñ->io.c⁄n.
ªad_so_Ár
 - 
buf„ªd
;

204 
î∫o
 = 
EOVERFLOW
;

208 
ªtvÆ
 = 
	`c⁄nRód
(
r
->
io
.
c⁄n
.conn,

209 (*)
r
->
io
.
c⁄n
.
buf
 + 
	`sd¶í
(r->io.conn.buf),

210 
t‹ód
);

211 i‡(
ªtvÆ
 <= 0) {

212 i‡(
î∫o
 =
EWOULDBLOCK
Ëî∫ÿ
ETIMEDOUT
;

215 
	`sdsIn¸Lí
(
r
->
io
.
c⁄n
.
buf
, 
ªtvÆ
);

218 
	`mem˝y
(
buf
, (*)
r
->
io
.
c⁄n
.bu‡+Ñ->io.c⁄n.
pos
, 
Àn
);

219 
r
->
io
.
c⁄n
.
ªad_so_Ár
 +
Àn
;

220 
r
->
io
.
c⁄n
.
pos
 +
Àn
;

221  
Àn
;

222 
	}
}

225 
off_t
 
	$rioC⁄nTñl
(
rio
 *
r
) {

226  
r
->
io
.
c⁄n
.
ªad_so_Ár
;

227 
	}
}

231 
	$rioC⁄nFlush
(
rio
 *
r
) {

234  
	`rioC⁄nWrôe
(
r
,
NULL
,0);

235 
	}
}

237 c⁄° 
rio
 
	grioC⁄nIO
 = {

238 
rioC⁄nRód
,

239 
rioC⁄nWrôe
,

240 
rioC⁄nTñl
,

241 
rioC⁄nFlush
,

242 
NULL
,

247 { { 
NULL
, 0 } }

252 
	$rioInôWôhC⁄n
(
rio
 *
r
, 
c⁄√˘i⁄
 *
c⁄n
, 
size_t
 
ªad_limô
) {

253 *
r
 = 
rioC⁄nIO
;

254 
r
->
io
.
c⁄n
.conn = conn;

255 
r
->
io
.
c⁄n
.
pos
 = 0;

256 
r
->
io
.
c⁄n
.
ªad_limô
 =Ñead_limit;

257 
r
->
io
.
c⁄n
.
ªad_so_Ár
 = 0;

258 
r
->
io
.
c⁄n
.
buf
 = 
	`sd¢ewÀn
(
NULL
, 
PROTO_IOBUF_LEN
);

259 
	`sds˛ór
(
r
->
io
.
c⁄n
.
buf
);

260 
	}
}

264 
	$rioFªeC⁄n
(
rio
 *
r
, 
sds
 *
ªmaöög
) {

265 i‡(
ªmaöög
 && (
size_t
)
r
->
io
.
c⁄n
.
pos
 < 
	`sd¶í
‘->io.c⁄n.
buf
)) {

266 i‡(
r
->
io
.
c⁄n
.
pos
 > 0Ë
	`sd§™ge
‘->io.c⁄n.
buf
,Ñ->io.conn.pos, -1);

267 *
ªmaöög
 = 
r
->
io
.
c⁄n
.
buf
;

269 
	`sds‰ì
(
r
->
io
.
c⁄n
.
buf
);

270 i‡(
ªmaöög
Ë*ªmaöög = 
NULL
;

272 
r
->
io
.
c⁄n
.
buf
 = 
NULL
;

273 
	}
}

286 
size_t
 
	$rioFdWrôe
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
) {

287 
ssize_t
 
ªtvÆ
;

288 *
p
 = (*Ë
buf
;

289 
doÊush
 = (
buf
 =
NULL
 && 
Àn
 == 0);

295 i‡(
Àn
 > 
PROTO_IOBUF_LEN
) {

297 i‡(
	`sd¶í
(
r
->
io
.
fd
.
buf
)) {

298 i‡(
	`rioFdWrôe
(
r
, 
NULL
, 0) == 0)

303 i‡(
Àn
) {

304 
r
->
io
.
fd
.
buf
 = 
	`sdsˇéí
‘->io.fd.buf,buf,
Àn
);

305 i‡(
	`sd¶í
(
r
->
io
.
fd
.
buf
Ë> 
PROTO_IOBUF_LEN
)

306 
doÊush
 = 1;

307 i‡(!
doÊush
)

311 
p
 = (*Ë
r
->
io
.
fd
.
buf
;

312 
Àn
 = 
	`sd¶í
(
r
->
io
.
fd
.
buf
);

315 
size_t
 
nwrôãn
 = 0;

316 
nwrôãn
 !
Àn
) {

317 
ªtvÆ
 = 
	`wrôe
(
r
->
io
.
fd
.fd,
p
+
nwrôãn
,
Àn
-nwritten);

318 i‡(
ªtvÆ
 <= 0) {

323 i‡(
ªtvÆ
 =-1 && 
î∫o
 =
EWOULDBLOCK
Ëî∫ÿ
ETIMEDOUT
;

326 
nwrôãn
 +
ªtvÆ
;

329 
r
->
io
.
fd
.
pos
 +
Àn
;

330 
	`sds˛ór
(
r
->
io
.
fd
.
buf
);

332 
	}
}

335 
size_t
 
	$rioFdRód
(
rio
 *
r
, *
buf
, 
size_t
 
Àn
) {

336 
	`UNUSED
(
r
);

337 
	`UNUSED
(
buf
);

338 
	`UNUSED
(
Àn
);

340 
	}
}

343 
off_t
 
	$rioFdTñl
(
rio
 *
r
) {

344  
r
->
io
.
fd
.
pos
;

345 
	}
}

349 
	$rioFdFlush
(
rio
 *
r
) {

352  
	`rioFdWrôe
(
r
,
NULL
,0);

353 
	}
}

355 c⁄° 
rio
 
	grioFdIO
 = {

356 
rioFdRód
,

357 
rioFdWrôe
,

358 
rioFdTñl
,

359 
rioFdFlush
,

360 
NULL
,

365 { { 
NULL
, 0 } }

368 
	$rioInôWôhFd
(
rio
 *
r
, 
fd
) {

369 *
r
 = 
rioFdIO
;

370 
r
->
io
.
fd
.fd = fd;

371 
r
->
io
.
fd
.
pos
 = 0;

372 
r
->
io
.
fd
.
buf
 = 
	`sd£m±y
();

373 
	}
}

376 
	$rioFªeFd
(
rio
 *
r
) {

377 
	`sds‰ì
(
r
->
io
.
fd
.
buf
);

378 
	}
}

384 
	$rioGíîicUpd©eChecksum
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
) {

385 
r
->
cksum
 = 
	`¸c64
‘->cksum,
buf
,
Àn
);

386 
	}
}

396 
	$rioSëAutoSync
(
rio
 *
r
, 
off_t
 
byãs
) {

397 if(
r
->
wrôe
 !
rioFûeIO
.write) ;

398 
r
->
io
.
fûe
.
autosync
 = 
byãs
;

399 
	}
}

407 
size_t
 
	$rioWrôeBulkCou¡
(
rio
 *
r
, 
¥efix
, 
cou¡
) {

408 
cbuf
[128];

409 
˛í
;

411 
cbuf
[0] = 
¥efix
;

412 
˛í
 = 1+
	`Œ2°rög
(
cbuf
+1,(cbuf)-1,
cou¡
);

413 
cbuf
[
˛í
++] = '\r';

414 
cbuf
[
˛í
++] = '\n';

415 i‡(
	`rioWrôe
(
r
,
cbuf
,
˛í
) == 0)  0;

416  
˛í
;

417 
	}
}

420 
size_t
 
	$rioWrôeBulkSåög
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
) {

421 
size_t
 
nwrôãn
;

423 i‡((
nwrôãn
 = 
	`rioWrôeBulkCou¡
(
r
,'$',
Àn
)) == 0)  0;

424 i‡(
Àn
 > 0 && 
	`rioWrôe
(
r
,
buf
,len) == 0)  0;

425 i‡(
	`rioWrôe
(
r
,"\r\n",2) == 0)  0;

426  
nwrôãn
+
Àn
+2;

427 
	}
}

430 
size_t
 
	$rioWrôeBulkL⁄gL⁄g
(
rio
 *
r
, 
l
) {

431 
lbuf
[32];

432 
Œí
;

434 
Œí
 = 
	`Œ2°rög
(
lbuf
,÷buf),
l
);

435  
	`rioWrôeBulkSåög
(
r
,
lbuf
,
Œí
);

436 
	}
}

439 
size_t
 
	$rioWrôeBulkDoubÀ
(
rio
 *
r
, 
d
) {

440 
dbuf
[128];

441 
dÀn
;

443 
dÀn
 = 
	`¢¥ötf
(
dbuf
,(dbuf),"%.17g",
d
);

444  
	`rioWrôeBulkSåög
(
r
,
dbuf
,
dÀn
);

445 
	}
}

	@rio.h

32 #i‚de‡
__REDIS_RIO_H


33 
	#__REDIS_RIO_H


	)

35 
	~<°dio.h
>

36 
	~<°döt.h
>

37 
	~"sds.h
"

38 
	~"c⁄√˘i⁄.h
"

40 
	#RIO_FLAG_READ_ERROR
 (1<<0)

	)

41 
	#RIO_FLAG_WRITE_ERROR
 (1<<1)

	)

43 
	s_rio
 {

47 
size_t
 (*
ªad
)(
	m_rio
 *, *
	mbuf
, size_à
	mÀn
);

48 
size_t
 (*
wrôe
)(
	m_rio
 *, c⁄° *
	mbuf
, size_à
	mÀn
);

49 
off_t
 (*
ãŒ
)(
	m_rio
 *);

50 (*
	mÊush
)(
	m_rio
 *);

56 (*
	mupd©e_cksum
)(
	m_rio
 *, c⁄° *
	mbuf
, 
size_t
 
	mÀn
);

59 
uöt64_t
 
	mcksum
, 
	mÊags
;

62 
size_t
 
	m¥o˚s£d_byãs
;

65 
size_t
 
	mmax_¥o˚ssög_chunk
;

71 
sds
 
	m±r
;

72 
off_t
 
	mpos
;

73 } 
	mbuf„r
;

76 
FILE
 *
	mÂ
;

77 
off_t
 
	mbuf„ªd
;

78 
off_t
 
	mautosync
;

79 } 
	mfûe
;

82 
c⁄√˘i⁄
 *
	mc⁄n
;

83 
off_t
 
	mpos
;

84 
sds
 
	mbuf
;

85 
size_t
 
	mªad_limô
;

86 
size_t
 
	mªad_so_Ár
;

87 } 
	mc⁄n
;

90 
	mfd
;

91 
off_t
 
	mpos
;

92 
sds
 
	mbuf
;

93 } 
	mfd
;

94 } 
	mio
;

97 
_rio
 
	trio
;

103 
ölöe
 
size_t
 
	$rioWrôe
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
) {

104 i‡(
r
->
Êags
 & 
RIO_FLAG_WRITE_ERROR
)  0;

105 
Àn
) {

106 
size_t
 
byãs_to_wrôe
 = (
r
->
max_¥o˚ssög_chunk
 &&Ñ->max_¥o˚ssög_chunk < 
Àn
) ?Ñ->max_processing_chunk :Üen;

107 i‡(
r
->
upd©e_cksum
Ër->
	`upd©e_cksum
‘,
buf
,
byãs_to_wrôe
);

108 i‡(
r
->
	`wrôe
‘,
buf
,
byãs_to_wrôe
) == 0) {

109 
r
->
Êags
 |
RIO_FLAG_WRITE_ERROR
;

112 
buf
 = (*)bu‡+ 
byãs_to_wrôe
;

113 
Àn
 -
byãs_to_wrôe
;

114 
r
->
¥o˚s£d_byãs
 +
byãs_to_wrôe
;

117 
	}
}

119 
ölöe
 
size_t
 
	$rioRód
(
rio
 *
r
, *
buf
, 
size_t
 
Àn
) {

120 i‡(
r
->
Êags
 & 
RIO_FLAG_READ_ERROR
)  0;

121 
Àn
) {

122 
size_t
 
byãs_to_ªad
 = (
r
->
max_¥o˚ssög_chunk
 &&Ñ->max_¥o˚ssög_chunk < 
Àn
) ?Ñ->max_processing_chunk :Üen;

123 i‡(
r
->
	`ªad
‘,
buf
,
byãs_to_ªad
) == 0) {

124 
r
->
Êags
 |
RIO_FLAG_READ_ERROR
;

127 i‡(
r
->
upd©e_cksum
Ër->
	`upd©e_cksum
‘,
buf
,
byãs_to_ªad
);

128 
buf
 = (*)bu‡+ 
byãs_to_ªad
;

129 
Àn
 -
byãs_to_ªad
;

130 
r
->
¥o˚s£d_byãs
 +
byãs_to_ªad
;

133 
	}
}

135 
ölöe
 
off_t
 
	$rioTñl
(
rio
 *
r
) {

136  
r
->
	`ãŒ
(r);

137 
	}
}

139 
ölöe
 
	$rioFlush
(
rio
 *
r
) {

140  
r
->
	`Êush
(r);

141 
	}
}

146 
ölöe
 
	$rioGëRódEº‹
(
rio
 *
r
) {

147  (
r
->
Êags
 & 
RIO_FLAG_READ_ERROR
) != 0;

148 
	}
}

151 
ölöe
 
	$rioGëWrôeEº‹
(
rio
 *
r
) {

152  (
r
->
Êags
 & 
RIO_FLAG_WRITE_ERROR
) != 0;

153 
	}
}

155 
ölöe
 
	$rioCÀ¨Eº‹s
(
rio
 *
r
) {

156 
r
->
Êags
 &~(
RIO_FLAG_READ_ERROR
|
RIO_FLAG_WRITE_ERROR
);

157 
	}
}

159 
rioInôWôhFûe
(
rio
 *
r
, 
FILE
 *
Â
);

160 
rioInôWôhBuf„r
(
rio
 *
r
, 
sds
 
s
);

161 
rioInôWôhC⁄n
(
rio
 *
r
, 
c⁄√˘i⁄
 *
c⁄n
, 
size_t
 
ªad_limô
);

162 
rioInôWôhFd
(
rio
 *
r
, 
fd
);

164 
rioFªeFd
(
rio
 *
r
);

165 
rioFªeC⁄n
(
rio
 *
r
, 
sds
* 
out_ªmaöögBuf„ªdD©a
);

167 
size_t
 
rioWrôeBulkCou¡
(
rio
 *
r
, 
¥efix
, 
cou¡
);

168 
size_t
 
rioWrôeBulkSåög
(
rio
 *
r
, c⁄° *
buf
, size_à
Àn
);

169 
size_t
 
rioWrôeBulkL⁄gL⁄g
(
rio
 *
r
, 
l
);

170 
size_t
 
rioWrôeBulkDoubÀ
(
rio
 *
r
, 
d
);

172 
	gªdisObje˘
;

173 
rioWrôeBulkObje˘
(
rio
 *
r
, 
ªdisObje˘
 *
obj
);

175 
rioGíîicUpd©eChecksum
(
rio
 *
r
, c⁄° *
buf
, 
size_t
 
Àn
);

176 
rioSëAutoSync
(
rio
 *
r
, 
off_t
 
byãs
);

	@scripting.c

30 
	~"£rvî.h
"

31 
	~"sha1.h
"

32 
	~"ønd.h
"

33 
	~"˛u°î.h
"

35 
	~<lua.h
>

36 
	~<œuxlib.h
>

37 
	~<luÆib.h
>

38 
	~<˘y≥.h
>

39 
	~<m©h.h
>

41 *
ªdisPrŸocﬁToLuaTy≥_I¡
(
lua_Sèã
 *
lua
, *
ª∂y
);

42 *
ªdisPrŸocﬁToLuaTy≥_Bulk
(
lua_Sèã
 *
lua
, *
ª∂y
);

43 *
ªdisPrŸocﬁToLuaTy≥_Sètus
(
lua_Sèã
 *
lua
, *
ª∂y
);

44 *
ªdisPrŸocﬁToLuaTy≥_Eº‹
(
lua_Sèã
 *
lua
, *
ª∂y
);

45 *
ªdisPrŸocﬁToLuaTy≥_Aggªg©e
(
lua_Sèã
 *
lua
, *
ª∂y
, 
©y≥
);

46 *
ªdisPrŸocﬁToLuaTy≥_NuŒ
(
lua_Sèã
 *
lua
, *
ª∂y
);

47 *
ªdisPrŸocﬁToLuaTy≥_Boﬁ
(
lua_Sèã
 *
lua
, *
ª∂y
, 
tf
);

48 *
ªdisPrŸocﬁToLuaTy≥_DoubÀ
(
lua_Sèã
 *
lua
, *
ª∂y
);

49 
ªdis_m©h_øndom
 (
lua_Sèã
 *
L
);

50 
ªdis_m©h_øndom£ed
 (
lua_Sèã
 *
L
);

51 
ldbInô
();

52 
ldbDißbÀ
(
˛õ¡
 *
c
);

53 
ldbE«bÀ
(
˛õ¡
 *
c
);

54 
evÆGíîicComm™dWôhDebuggög
(
˛õ¡
 *
c
, 
evÆsha
);

55 
luaLdbLöeHook
(
lua_Sèã
 *
lua
, 
lua_Debug
 *
¨
);

56 
ldbLog
(
sds
 
íåy
);

57 
ldbLogRedisRïly
(*
ª∂y
);

58 
sds
 
ldbC©SèckVÆue
(sd†
s
, 
lua_Sèã
 *
lua
, 
idx
);

61 
	#LDB_BREAKPOINTS_MAX
 64

	)

62 
	#LDB_MAX_LEN_DEFAULT
 256

	)

63 
	sldbSèã
 {

64 
c⁄√˘i⁄
 *
	mc⁄n
;

65 
	ma˘ive
;

66 
	mf‹ked
;

67 
li°
 *
	mlogs
;

68 
li°
 *
	måa˚s
;

69 
li°
 *
	mchûdªn
;

70 
	mbp
[
LDB_BREAKPOINTS_MAX
];

71 
	mbpcou¡
;

72 
	m°ï
;

73 
	mluabp
;

74 
sds
 *
	m§c
;

75 
	mlöes
;

76 
	mcuºíéöe
;

77 
sds
 
	mcbuf
;

78 
size_t
 
	mmaxÀn
;

79 
	mmaxÀn_höt_£¡
;

80 } 
	gldb
;

92 
	$sha1hex
(*
dige°
, *
s¸ùt
, 
size_t
 
Àn
) {

93 
SHA1_CTX
 
˘x
;

94 
hash
[20];

95 *
c£t
 = "0123456789abcdef";

96 
j
;

98 
	`SHA1Inô
(&
˘x
);

99 
	`SHA1Upd©e
(&
˘x
,(*)
s¸ùt
,
Àn
);

100 
	`SHA1FöÆ
(
hash
,&
˘x
);

102 
j
 = 0; j < 20; j++) {

103 
dige°
[
j
*2] = 
c£t
[((
hash
[j]&0xF0)>>4)];

104 
dige°
[
j
*2+1] = 
c£t
[(
hash
[j]&0xF)];

106 
dige°
[40] = '\0';

107 
	}
}

130 *
	$ªdisPrŸocﬁToLuaTy≥
(
lua_Sèã
 *
lua
, * 
ª∂y
) {

131 *
p
 = 
ª∂y
;

133 *
p
) {

134 ':': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_I¡
(
lua
,
ª∂y
); ;

135 '$': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_Bulk
(
lua
,
ª∂y
); ;

136 '+': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_Sètus
(
lua
,
ª∂y
); ;

137 '-': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_Eº‹
(
lua
,
ª∂y
); ;

138 '*': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_Aggªg©e
(
lua
,
ª∂y
,*p); ;

139 '%': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_Aggªg©e
(
lua
,
ª∂y
,*p); ;

140 '~': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_Aggªg©e
(
lua
,
ª∂y
,*p); ;

141 '_': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_NuŒ
(
lua
,
ª∂y
); ;

142 '#': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_Boﬁ
(
lua
,
ª∂y
,p[1]); ;

143 ',': 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥_DoubÀ
(
lua
,
ª∂y
); ;

145  
p
;

146 
	}
}

148 *
	$ªdisPrŸocﬁToLuaTy≥_I¡
(
lua_Sèã
 *
lua
, *
ª∂y
) {

149 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

150 
vÆue
;

152 
	`°rög2Œ
(
ª∂y
+1,
p
-ª∂y-1,&
vÆue
);

153 
	`lua_pushnumbî
(
lua
,(
lua_Numbî
)
vÆue
);

154  
p
+2;

155 
	}
}

157 *
	$ªdisPrŸocﬁToLuaTy≥_Bulk
(
lua_Sèã
 *
lua
, *
ª∂y
) {

158 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

159 
bulkÀn
;

161 
	`°rög2Œ
(
ª∂y
+1,
p
-ª∂y-1,&
bulkÀn
);

162 i‡(
bulkÀn
 == -1) {

163 
	`lua_pushboﬁón
(
lua
,0);

164  
p
+2;

166 
	`lua_pushl°rög
(
lua
,
p
+2,
bulkÀn
);

167  
p
+2+
bulkÀn
+2;

169 
	}
}

171 *
	$ªdisPrŸocﬁToLuaTy≥_Sètus
(
lua_Sèã
 *
lua
, *
ª∂y
) {

172 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

174 
	`lua_√wèbÀ
(
lua
);

175 
	`lua_push°rög
(
lua
,"ok");

176 
	`lua_pushl°rög
(
lua
,
ª∂y
+1,
p
-reply-1);

177 
	`lua_£âabÀ
(
lua
,-3);

178  
p
+2;

179 
	}
}

181 *
	$ªdisPrŸocﬁToLuaTy≥_Eº‹
(
lua_Sèã
 *
lua
, *
ª∂y
) {

182 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

184 
	`lua_√wèbÀ
(
lua
);

185 
	`lua_push°rög
(
lua
,"err");

186 
	`lua_pushl°rög
(
lua
,
ª∂y
+1,
p
-reply-1);

187 
	`lua_£âabÀ
(
lua
,-3);

188  
p
+2;

189 
	}
}

191 *
	$ªdisPrŸocﬁToLuaTy≥_Aggªg©e
(
lua_Sèã
 *
lua
, *
ª∂y
, 
©y≥
) {

192 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

193 
mbulkÀn
;

194 
j
 = 0;

196 
	`°rög2Œ
(
ª∂y
+1,
p
-ª∂y-1,&
mbulkÀn
);

197 i‡(
£rvî
.
lua_˛õ¡
->
ª•
 =2 || 
©y≥
 == '*') {

198 
p
 += 2;

199 i‡(
mbulkÀn
 == -1) {

200 
	`lua_pushboﬁón
(
lua
,0);

201  
p
;

203 
	`lua_√wèbÀ
(
lua
);

204 
j
 = 0; j < 
mbulkÀn
; j++) {

205 
	`lua_pushnumbî
(
lua
,
j
+1);

206 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥
(
lua
,p);

207 
	`lua_£âabÀ
(
lua
,-3);

209 } i‡(
£rvî
.
lua_˛õ¡
->
ª•
 == 3) {

214 
p
 += 2;

215 
	`lua_√wèbÀ
(
lua
);

216 
	`lua_push°rög
(
lua
,
©y≥
 == '%' ? "map" : "set");

217 
	`lua_√wèbÀ
(
lua
);

218 
j
 = 0; j < 
mbulkÀn
; j++) {

219 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥
(
lua
,p);

220 i‡(
©y≥
 == '%') {

221 
p
 = 
	`ªdisPrŸocﬁToLuaTy≥
(
lua
,p);

223 
	`lua_pushboﬁón
(
lua
,1);

225 
	`lua_£âabÀ
(
lua
,-3);

227 
	`lua_£âabÀ
(
lua
,-3);

229  
p
;

230 
	}
}

232 *
	$ªdisPrŸocﬁToLuaTy≥_NuŒ
(
lua_Sèã
 *
lua
, *
ª∂y
) {

233 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

234 
	`lua_pushnû
(
lua
);

235  
p
+2;

236 
	}
}

238 *
	$ªdisPrŸocﬁToLuaTy≥_Boﬁ
(
lua_Sèã
 *
lua
, *
ª∂y
, 
tf
) {

239 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

240 
	`lua_pushboﬁón
(
lua
,
tf
 == 't');

241  
p
+2;

242 
	}
}

244 *
	$ªdisPrŸocﬁToLuaTy≥_DoubÀ
(
lua_Sèã
 *
lua
, *
ª∂y
) {

245 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

246 
buf
[
MAX_LONG_DOUBLE_CHARS
+1];

247 
size_t
 
Àn
 = 
p
-
ª∂y
-1;

248 
d
;

250 i‡(
Àn
 <
MAX_LONG_DOUBLE_CHARS
) {

251 
	`mem˝y
(
buf
,
ª∂y
+1,
Àn
);

252 
buf
[
Àn
] = '\0';

253 
d
 = 
	`°πod
(
buf
,
NULL
);

255 
d
 = 0;

258 
	`lua_√wèbÀ
(
lua
);

259 
	`lua_push°rög
(
lua
,"double");

260 
	`lua_pushnumbî
(
lua
,
d
);

261 
	`lua_£âabÀ
(
lua
,-3);

262  
p
+2;

263 
	}
}

270 
	$luaPushEº‹
(
lua_Sèã
 *
lua
, *
îr‹
) {

271 
lua_Debug
 
dbg
;

275 i‡(
ldb
.
a˘ive
 &&Üdb.
°ï
) {

276 
	`ldbLog
(
	`sdsˇçrötf
(
	`sd£m±y
(),"<îr‹> %s",
îr‹
));

279 
	`lua_√wèbÀ
(
lua
);

280 
	`lua_push°rög
(
lua
,"err");

283 if(
	`lua_gë°ack
(
lua
, 1, &
dbg
Ë&& 
	`lua_gëöfo
(lua, "nSl", &dbg)) {

284 
sds
 
msg
 = 
	`sdsˇçrötf
(
	`sd£m±y
(), "%s: %d: %s",

285 
dbg
.
sour˚
, dbg.
cuºíéöe
, 
îr‹
);

286 
	`lua_push°rög
(
lua
, 
msg
);

287 
	`sds‰ì
(
msg
);

289 
	`lua_push°rög
(
lua
, 
îr‹
);

291 
	`lua_£âabÀ
(
lua
,-3);

292 
	}
}

298 
	$luaRai£Eº‹
(
lua_Sèã
 *
lua
) {

299 
	`lua_push°rög
(
lua
,"err");

300 
	`lua_gëèbÀ
(
lua
,-2);

301  
	`lua_îr‹
(
lua
);

302 
	}
}

310 
	$luaS‹tAºay
(
lua_Sèã
 *
lua
) {

312 
	`lua_gëglobÆ
(
lua
,"table");

313 
	`lua_push°rög
(
lua
,"sort");

314 
	`lua_gëèbÀ
(
lua
,-2);

315 
	`lua_pushvÆue
(
lua
,-3);

316 i‡(
	`lua_pˇŒ
(
lua
,1,0,0)) {

323 
	`lua_p›
(
lua
,1);

324 
	`lua_push°rög
(
lua
,"sort");

325 
	`lua_gëèbÀ
(
lua
,-2);

326 
	`lua_pushvÆue
(
lua
,-3);

327 
	`lua_gëglobÆ
(
lua
,"__redis__compare_helper");

329 
	`lua_ˇŒ
(
lua
,2,0);

332 
	`lua_p›
(
lua
,1);

333 
	}
}

341 
	$luaRïlyToRedisRïly
(
˛õ¡
 *
c
, 
lua_Sèã
 *
lua
) {

342 
t
 = 
	`lua_ty≥
(
lua
,-1);

344 
t
) {

345 
LUA_TSTRING
:

346 
	`addRïlyBulkCBuf„r
(
c
,(*)
	`lua_to°rög
(
lua
,-1),
	`lua_°æí
(lua,-1));

348 
LUA_TBOOLEAN
:

349 i‡(
£rvî
.
lua_˛õ¡
->
ª•
 == 2)

350 
	`addRïly
(
c
,
	`lua_toboﬁón
(
lua
,-1Ë? 
sh¨ed
.
c⁄e
 :

351 
sh¨ed
.
nuŒ
[
c
->
ª•
]);

353 
	`addRïlyBoﬁ
(
c
,
	`lua_toboﬁón
(
lua
,-1));

355 
LUA_TNUMBER
:

356 
	`addRïlyL⁄gL⁄g
(
c
,()
	`lua_t⁄umbî
(
lua
,-1));

358 
LUA_TTABLE
:

365 
	`lua_push°rög
(
lua
,"err");

366 
	`lua_gëèbÀ
(
lua
,-2);

367 
t
 = 
	`lua_ty≥
(
lua
,-1);

368 i‡(
t
 =
LUA_TSTRING
) {

369 
sds
 
îr
 = 
	`sd¢ew
(
	`lua_to°rög
(
lua
,-1));

370 
	`sdsm≠ch¨s
(
îr
,"\r\n"," ",2);

371 
	`addRïlySds
(
c
,
	`sdsˇçrötf
(
	`sd£m±y
(),"-%s\r\n",
îr
));

372 
	`sds‰ì
(
îr
);

373 
	`lua_p›
(
lua
,2);

376 
	`lua_p›
(
lua
,1);

379 
	`lua_push°rög
(
lua
,"ok");

380 
	`lua_gëèbÀ
(
lua
,-2);

381 
t
 = 
	`lua_ty≥
(
lua
,-1);

382 i‡(
t
 =
LUA_TSTRING
) {

383 
sds
 
ok
 = 
	`sd¢ew
(
	`lua_to°rög
(
lua
,-1));

384 
	`sdsm≠ch¨s
(
ok
,"\r\n"," ",2);

385 
	`addRïlySds
(
c
,
	`sdsˇçrötf
(
	`sd£m±y
(),"+%s\r\n",
ok
));

386 
	`sds‰ì
(
ok
);

387 
	`lua_p›
(
lua
,2);

390 
	`lua_p›
(
lua
,1);

393 
	`lua_push°rög
(
lua
,"double");

394 
	`lua_gëèbÀ
(
lua
,-2);

395 
t
 = 
	`lua_ty≥
(
lua
,-1);

396 i‡(
t
 =
LUA_TNUMBER
) {

397 
	`addRïlyDoubÀ
(
c
,
	`lua_t⁄umbî
(
lua
,-1));

398 
	`lua_p›
(
lua
,2);

401 
	`lua_p›
(
lua
,1);

404 
	`lua_push°rög
(
lua
,"map");

405 
	`lua_gëèbÀ
(
lua
,-2);

406 
t
 = 
	`lua_ty≥
(
lua
,-1);

407 i‡(
t
 =
LUA_TTABLE
) {

408 
m≠Àn
 = 0;

409 *
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

410 
	`lua_pushnû
(
lua
);

411 
	`lua_√xt
(
lua
,-2)) {

413 
	`luaRïlyToRedisRïly
(
c
, 
lua
);

414 
	`lua_pushvÆue
(
lua
,-1);

415 
	`luaRïlyToRedisRïly
(
c
, 
lua
);

417 
m≠Àn
++;

419 
	`£tDe„ºedM≠Lí
(
c
,
ª∂yÀn
,
m≠Àn
);

420 
	`lua_p›
(
lua
,2);

423 
	`lua_p›
(
lua
,1);

426 
	`lua_push°rög
(
lua
,"set");

427 
	`lua_gëèbÀ
(
lua
,-2);

428 
t
 = 
	`lua_ty≥
(
lua
,-1);

429 i‡(
t
 =
LUA_TTABLE
) {

430 
£éí
 = 0;

431 *
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

432 
	`lua_pushnû
(
lua
);

433 
	`lua_√xt
(
lua
,-2)) {

435 
	`lua_p›
(
lua
,1);

436 
	`lua_pushvÆue
(
lua
,-1);

437 
	`luaRïlyToRedisRïly
(
c
, 
lua
);

439 
£éí
++;

441 
	`£tDe„ºedSëLí
(
c
,
ª∂yÀn
,
£éí
);

442 
	`lua_p›
(
lua
,2);

445 
	`lua_p›
(
lua
,1);

448 *
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

449 
j
 = 1, 
mbulkÀn
 = 0;

451 
	`lua_pushnumbî
(
lua
,
j
++);

452 
	`lua_gëèbÀ
(
lua
,-2);

453 
t
 = 
	`lua_ty≥
(
lua
,-1);

454 i‡(
t
 =
LUA_TNIL
) {

455 
	`lua_p›
(
lua
,1);

458 
	`luaRïlyToRedisRïly
(
c
, 
lua
);

459 
mbulkÀn
++;

461 
	`£tDe„ºedAºayLí
(
c
,
ª∂yÀn
,
mbulkÀn
);

464 
	`addRïlyNuŒ
(
c
);

466 
	`lua_p›
(
lua
,1);

467 
	}
}

473 
	#LUA_CMD_OBJCACHE_SIZE
 32

	)

474 
	#LUA_CMD_OBJCACHE_MAX_LEN
 64

	)

475 
	$luaRedisGíîicComm™d
(
lua_Sèã
 *
lua
, 
øi£_îr‹
) {

476 
j
, 
¨gc
 = 
	`lua_gët›
(
lua
);

477 
ªdisComm™d
 *
cmd
;

478 
˛õ¡
 *
c
 = 
£rvî
.
lua_˛õ¡
;

479 
sds
 
ª∂y
;

482 
robj
 **
¨gv
 = 
NULL
;

483 
¨gv_size
 = 0;

484 
robj
 *
ˇched_obje˘s
[
LUA_CMD_OBJCACHE_SIZE
];

485 
size_t
 
ˇched_obje˘s_Àn
[
LUA_CMD_OBJCACHE_SIZE
];

486 
öu£
 = 0;

492 i‡(
öu£
) {

493 *
ªcursi⁄_w¨nög
 =

496 
	`£rvîLog
(
LL_WARNING
,"%s",
ªcursi⁄_w¨nög
);

497 
	`luaPushEº‹
(
lua
,
ªcursi⁄_w¨nög
);

500 
öu£
++;

503 i‡(
¨gc
 == 0) {

504 
	`luaPushEº‹
(
lua
,

506 
öu£
--;

507  
øi£_îr‹
 ? 
	`luaRai£Eº‹
(
lua
) : 1;

511 i‡(
¨gv_size
 < 
¨gc
) {

512 
¨gv
 = 
	`zªÆloc
◊rgv,(
robj
*)*
¨gc
);

513 
¨gv_size
 = 
¨gc
;

516 
j
 = 0; j < 
¨gc
; j++) {

517 *
obj_s
;

518 
size_t
 
obj_Àn
;

519 
dbuf
[64];

521 i‡(
	`lua_ty≥
(
lua
,
j
+1Ë=
LUA_TNUMBER
) {

524 
lua_Numbî
 
num
 = 
	`lua_t⁄umbî
(
lua
,
j
+1);

526 
obj_Àn
 = 
	`¢¥ötf
(
dbuf
,(dbuf),"%.17g",()
num
);

527 
obj_s
 = 
dbuf
;

529 
obj_s
 = (*)
	`lua_tﬁ°rög
(
lua
,
j
+1,&
obj_Àn
);

530 i‡(
obj_s
 =
NULL
) ;

534 i‡(
j
 < 
LUA_CMD_OBJCACHE_SIZE
 && 
ˇched_obje˘s
[j] &&

535 
ˇched_obje˘s_Àn
[
j
] >
obj_Àn
)

537 
sds
 
s
 = 
ˇched_obje˘s
[
j
]->
±r
;

538 
¨gv
[
j
] = 
ˇched_obje˘s
[j];

539 
ˇched_obje˘s
[
j
] = 
NULL
;

540 
	`mem˝y
(
s
,
obj_s
,
obj_Àn
+1);

541 
	`sds£éí
(
s
, 
obj_Àn
);

543 
¨gv
[
j
] = 
	`¸óãSåögObje˘
(
obj_s
, 
obj_Àn
);

550 i‡(
j
 !
¨gc
) {

551 
j
--;

552 
j
 >= 0) {

553 
	`de¸RefCou¡
(
¨gv
[
j
]);

554 
j
--;

556 
	`luaPushEº‹
(
lua
,

558 
öu£
--;

559  
øi£_îr‹
 ? 
	`luaRai£Eº‹
(
lua
) : 1;

563 
c
->
¨gv
 =árgv;

564 
c
->
¨gc
 =árgc;

565 
c
->
u£r
 = 
£rvî
.
lua_ˇŒî
->user;

568 
	`moduÀCÆlComm™dFûãrs
(
c
);

569 
¨gv
 = 
c
->argv;

570 
¨gc
 = 
c
->argc;

573 i‡(
ldb
.
a˘ive
 &&Üdb.
°ï
) {

574 
sds
 
cmdlog
 = 
	`sd¢ew
("<redis>");

575 
j
 = 0; j < 
c
->
¨gc
; j++) {

576 i‡(
j
 == 10) {

577 
cmdlog
 = 
	`sdsˇçrötf
(cmdlog," ... (%d more)",

578 
c
->
¨gc
-
j
-1);

581 
cmdlog
 = 
	`sdsˇéí
(cmdlog," ",1);

582 
cmdlog
 = 
	`sdsˇtsds
(cmdlog,
c
->
¨gv
[
j
]->
±r
);

585 
	`ldbLog
(
cmdlog
);

589 
cmd
 = 
	`lookupComm™d
(
¨gv
[0]->
±r
);

590 i‡(!
cmd
 || ((cmd->
¨ôy
 > 0 && cmd->¨ôy !
¨gc
) ||

591 (
¨gc
 < -
cmd
->
¨ôy
)))

593 i‡(
cmd
)

594 
	`luaPushEº‹
(
lua
,

597 
	`luaPushEº‹
(
lua
,"Unknown Redis command called from Lua script");

598 
˛ónup
;

600 
c
->
cmd
 = c->
œ°cmd
 = cmd;

603 i‡(
cmd
->
Êags
 & 
CMD_NOSCRIPT
) {

604 
	`luaPushEº‹
(
lua
, "This Redis command isÇotállowed from scripts");

605 
˛ónup
;

609 
a˛_keypos
;

610 
a˛_ªtvÆ
 = 
	`ACLCheckComm™dPîm
(
c
,&
a˛_keypos
);

611 i‡(
a˛_ªtvÆ
 !
ACL_OK
) {

612 
	`addACLLogE¡ry
(
c
,
a˛_ªtvÆ
,
a˛_keypos
,
NULL
);

613 i‡(
a˛_ªtvÆ
 =
ACL_DENIED_CMD
)

614 
	`luaPushEº‹
(
lua
, "The userÉxecutingÅhe script can'tÑunÅhis "

617 
	`luaPushEº‹
(
lua
, "The userÉxecutingÅhe script can'táccess "

620 
˛ónup
;

626 i‡(
cmd
->
Êags
 & 
CMD_WRITE
) {

627 
díy_wrôe_ty≥
 = 
	`wrôeComm™dsDíõdByDiskEº‹
();

628 i‡(
£rvî
.
lua_øndom_dúty
 && !£rvî.
lua_ª∂iˇã_comm™ds
) {

629 
	`luaPushEº‹
(
lua
,

631 
˛ónup
;

632 } i‡(
£rvî
.
ma°îho°
 && sîvî.
ª∂_¶ave_ro
 &&

633 !
£rvî
.
lﬂdög
 &&

634 !(
£rvî
.
lua_ˇŒî
->
Êags
 & 
CLIENT_MASTER
))

636 
	`luaPushEº‹
(
lua
, 
sh¨ed
.
ro¶avìº
->
±r
);

637 
˛ónup
;

638 } i‡(
díy_wrôe_ty≥
 !
DISK_ERROR_TYPE_NONE
) {

639 i‡(
díy_wrôe_ty≥
 =
DISK_ERROR_TYPE_RDB
) {

640 
	`luaPushEº‹
(
lua
, 
sh¨ed
.
bgßvìº
->
±r
);

642 
sds
 
aof_wrôe_îr
 = 
	`sdsˇtfmt
(
	`sd£m±y
(),

644 
	`°ªº‹
(
£rvî
.
aof_œ°_wrôe_î∫o
));

645 
	`luaPushEº‹
(
lua
, 
aof_wrôe_îr
);

646 
	`sds‰ì
(
aof_wrôe_îr
);

648 
˛ónup
;

656 i‡(
£rvî
.
maxmem‹y
 &&

657 !
£rvî
.
lﬂdög
 &&

658 !
£rvî
.
ma°îho°
 &&

659 
£rvî
.
lua_wrôe_dúty
 == 0 &&

660 
£rvî
.
lua_oom
 &&

661 (
cmd
->
Êags
 & 
CMD_DENYOOM
))

663 
	`luaPushEº‹
(
lua
, 
sh¨ed
.
oomîr
->
±r
);

664 
˛ónup
;

667 i‡(
cmd
->
Êags
 & 
CMD_RANDOM
Ë
£rvî
.
lua_øndom_dúty
 = 1;

668 i‡(
cmd
->
Êags
 & 
CMD_WRITE
Ë
£rvî
.
lua_wrôe_dúty
 = 1;

673 i‡(
£rvî
.
˛u°î_íabÀd
 && !£rvî.
lﬂdög
 &&

674 !(
£rvî
.
lua_ˇŒî
->
Êags
 & 
CLIENT_MASTER
))

676 
îr‹_code
;

678 
c
->
Êags
 &~(
CLIENT_READONLY
|
CLIENT_ASKING
);

679 
c
->
Êags
 |
£rvî
.
lua_ˇŒî
->Êag†& (
CLIENT_READONLY
|
CLIENT_ASKING
);

680 i‡(
	`gëNodeByQuîy
(
c
,c->
cmd
,c->
¨gv
,c->
¨gc
,
NULL
,&
îr‹_code
) !=

681 
£rvî
.
˛u°î
->
my£lf
)

683 i‡(
îr‹_code
 =
CLUSTER_REDIR_DOWN_RO_STATE
) {

684 
	`luaPushEº‹
(
lua
,

687 } i‡(
îr‹_code
 =
CLUSTER_REDIR_DOWN_STATE
) {

688 
	`luaPushEº‹
(
lua
,

692 
	`luaPushEº‹
(
lua
,

697 
˛ónup
;

704 i‡(
£rvî
.
lua_ª∂iˇã_comm™ds
 &&

705 !
£rvî
.
lua_mu…i_emôãd
 &&

706 !(
£rvî
.
lua_ˇŒî
->
Êags
 & 
CLIENT_MULTI
) &&

707 
£rvî
.
lua_wrôe_dúty
 &&

708 
£rvî
.
lua_ª∂
 !
PROPAGATE_NONE
)

710 
	`execComm™dPr›ag©eMu…i
(
£rvî
.
lua_ˇŒî
);

711 
£rvî
.
lua_mu…i_emôãd
 = 1;

714 
c
->
Êags
 |
CLIENT_MULTI
;

718 
ˇŒ_Êags
 = 
CMD_CALL_SLOWLOG
 | 
CMD_CALL_STATS
;

719 i‡(
£rvî
.
lua_ª∂iˇã_comm™ds
) {

721 i‡(
£rvî
.
lua_ª∂
 & 
PROPAGATE_AOF
)

722 
ˇŒ_Êags
 |
CMD_CALL_PROPAGATE_AOF
;

723 i‡(
£rvî
.
lua_ª∂
 & 
PROPAGATE_REPL
)

724 
ˇŒ_Êags
 |
CMD_CALL_PROPAGATE_REPL
;

726 
	`ˇŒ
(
c
,
ˇŒ_Êags
);

731 i‡(
	`li°Lígth
(
c
->
ª∂y
Ë=0 && c->
buÂos
 < 
PROTO_REPLY_CHUNK_BYTES
) {

735 
c
->
buf
[c->
buÂos
] = '\0';

736 
ª∂y
 = 
c
->
buf
;

737 
c
->
buÂos
 = 0;

739 
ª∂y
 = 
	`sd¢ewÀn
(
c
->
buf
,c->
buÂos
);

740 
c
->
buÂos
 = 0;

741 
	`li°Lígth
(
c
->
ª∂y
)) {

742 
˛õ¡RïlyBlock
 *
o
 = 
	`li°NodeVÆue
(
	`li°Fú°
(
c
->
ª∂y
));

744 
ª∂y
 = 
	`sdsˇéí
‘ïly,
o
->
buf
,o->
u£d
);

745 
	`li°DñNode
(
c
->
ª∂y
,
	`li°Fú°
(c->reply));

748 i‡(
øi£_îr‹
 && 
ª∂y
[0] != '-')Ñaise_error = 0;

749 
	`ªdisPrŸocﬁToLuaTy≥
(
lua
,
ª∂y
);

752 i‡(
ldb
.
a˘ive
 &&Üdb.
°ï
)

753 
	`ldbLogRedisRïly
(
ª∂y
);

757 i‡((
cmd
->
Êags
 & 
CMD_SORT_FOR_SCRIPT
) &&

758 (
£rvî
.
lua_ª∂iˇã_comm™ds
 == 0) &&

759 (
ª∂y
[0] == '*' &&Ñeply[1] != '-')) {

760 
	`luaS‹tAºay
(
lua
);

762 i‡(
ª∂y
 !
c
->
buf
Ë
	`sds‰ì
(reply);

763 
c
->
ª∂y_byãs
 = 0;

765 
˛ónup
:

768 
j
 = 0; j < 
c
->
¨gc
; j++) {

769 
robj
 *
o
 = 
c
->
¨gv
[
j
];

774 i‡(
j
 < 
LUA_CMD_OBJCACHE_SIZE
 &&

775 
o
->
ªfcou¡
 == 1 &&

776 (
o
->
ícodög
 =
OBJ_ENCODING_RAW
 ||

777 
o
->
ícodög
 =
OBJ_ENCODING_EMBSTR
) &&

778 
	`sd¶í
(
o
->
±r
Ë<
LUA_CMD_OBJCACHE_MAX_LEN
)

780 
sds
 
s
 = 
o
->
±r
;

781 i‡(
ˇched_obje˘s
[
j
]Ë
	`de¸RefCou¡
(cached_objects[j]);

782 
ˇched_obje˘s
[
j
] = 
o
;

783 
ˇched_obje˘s_Àn
[
j
] = 
	`sdßŒoc
(
s
);

785 
	`de¸RefCou¡
(
o
);

789 i‡(
c
->
¨gv
 !=árgv) {

790 
	`z‰ì
(
c
->
¨gv
);

791 
¨gv
 = 
NULL
;

792 
¨gv_size
 = 0;

795 
c
->
u£r
 = 
NULL
;

797 i‡(
øi£_îr‹
) {

801 
öu£
--;

802  
	`luaRai£Eº‹
(
lua
);

804 
öu£
--;

806 
	}
}

809 
	$luaRedisCÆlComm™d
(
lua_Sèã
 *
lua
) {

810  
	`luaRedisGíîicComm™d
(
lua
,1);

811 
	}
}

814 
	$luaRedisPCÆlComm™d
(
lua_Sèã
 *
lua
) {

815  
	`luaRedisGíîicComm™d
(
lua
,0);

816 
	}
}

820 
	$luaRedisSha1hexComm™d
(
lua_Sèã
 *
lua
) {

821 
¨gc
 = 
	`lua_gët›
(
lua
);

822 
dige°
[41];

823 
size_t
 
Àn
;

824 *
s
;

826 i‡(
¨gc
 != 1) {

827 
	`lua_push°rög
(
lua
, "wrongÇumber ofárguments");

828  
	`lua_îr‹
(
lua
);

831 
s
 = (*)
	`lua_tﬁ°rög
(
lua
,1,&
Àn
);

832 
	`sha1hex
(
dige°
,
s
,
Àn
);

833 
	`lua_push°rög
(
lua
,
dige°
);

835 
	}
}

844 
	$luaRedisRëu∫SögÀFõldTabÀ
(
lua_Sèã
 *
lua
, *
fõld
) {

845 i‡(
	`lua_gët›
(
lua
Ë!1 || 
	`lua_ty≥
÷ua,-1Ë!
LUA_TSTRING
) {

846 
	`luaPushEº‹
(
lua
, "wrongÇumber orÅype ofárguments");

850 
	`lua_√wèbÀ
(
lua
);

851 
	`lua_push°rög
(
lua
, 
fõld
);

852 
	`lua_pushvÆue
(
lua
, -3);

853 
	`lua_£âabÀ
(
lua
, -3);

855 
	}
}

858 
	$luaRedisEº‹RïlyComm™d
(
lua_Sèã
 *
lua
) {

859  
	`luaRedisRëu∫SögÀFõldTabÀ
(
lua
,"err");

860 
	}
}

863 
	$luaRedisSètusRïlyComm™d
(
lua_Sèã
 *
lua
) {

864  
	`luaRedisRëu∫SögÀFõldTabÀ
(
lua
,"ok");

865 
	}
}

873 
	$luaRedisRïliˇãComm™dsComm™d
(
lua_Sèã
 *
lua
) {

874 i‡(
£rvî
.
lua_wrôe_dúty
) {

875 
	`lua_pushboﬁón
(
lua
,0);

877 
£rvî
.
lua_ª∂iˇã_comm™ds
 = 1;

881 
	`ªdisSønd48
(
	`ønd
());

882 
	`lua_pushboﬁón
(
lua
,1);

885 
	}
}

892 
	$luaRedisBªakpoötComm™d
(
lua_Sèã
 *
lua
) {

893 i‡(
ldb
.
a˘ive
) {

894 
ldb
.
luabp
 = 1;

895 
	`lua_pushboﬁón
(
lua
,1);

897 
	`lua_pushboﬁón
(
lua
,0);

900 
	}
}

907 
	$luaRedisDebugComm™d
(
lua_Sèã
 *
lua
) {

908 i‡(!
ldb
.
a˘ive
)  0;

909 
¨gc
 = 
	`lua_gët›
(
lua
);

910 
sds
 
log
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"<debug>Üöê%d: ", 
ldb
.
cuºíéöe
);

911 
¨gc
--) {

912 
log
 = 
	`ldbC©SèckVÆue
÷og,
lua
,-1 - 
¨gc
);

913 i‡(
¨gc
 !0Ë
log
 = 
	`sdsˇéí
(log,", ",2);

915 
	`ldbLog
(
log
);

917 
	}
}

923 
	$luaRedisSëRïlComm™d
(
lua_Sèã
 *
lua
) {

924 
¨gc
 = 
	`lua_gët›
(
lua
);

925 
Êags
;

927 i‡(
£rvî
.
lua_ª∂iˇã_comm™ds
 == 0) {

928 
	`lua_push°rög
(
lua
, "You can setÅheÑeplication behavior onlyáfterÅurning on single commandsÑeplication withÑedis.replicate_commands().");

929  
	`lua_îr‹
(
lua
);

930 } i‡(
¨gc
 != 1) {

931 
	`lua_push°rög
(
lua
, "redis.set_repl()ÑequiresÅwoárguments.");

932  
	`lua_îr‹
(
lua
);

935 
Êags
 = 
	`lua_t⁄umbî
(
lua
,-1);

936 i‡((
Êags
 & ~(
PROPAGATE_AOF
|
PROPAGATE_REPL
)) != 0) {

937 
	`lua_push°rög
(
lua
, "InvalidÑeplication flags. Use REPL_AOF, REPL_REPLICA, REPL_ALL or REPL_NONE.");

938  
	`lua_îr‹
(
lua
);

940 
£rvî
.
lua_ª∂
 = 
Êags
;

942 
	}
}

945 
	$luaLogComm™d
(
lua_Sèã
 *
lua
) {

946 
j
, 
¨gc
 = 
	`lua_gët›
(
lua
);

947 
Àvñ
;

948 
sds
 
log
;

950 i‡(
¨gc
 < 2) {

951 
	`lua_push°rög
(
lua
, "redis.log()ÑequiresÅwoárguments or more.");

952  
	`lua_îr‹
(
lua
);

953 } i‡(!
	`lua_i¢umbî
(
lua
,-
¨gc
)) {

954 
	`lua_push°rög
(
lua
, "Firstárgument must beáÇumber (logÜevel).");

955  
	`lua_îr‹
(
lua
);

957 
Àvñ
 = 
	`lua_t⁄umbî
(
lua
,-
¨gc
);

958 i‡(
Àvñ
 < 
LL_DEBUG
 ||Üevñ > 
LL_WARNING
) {

959 
	`lua_push°rög
(
lua
, "Invalid debugÜevel.");

960  
	`lua_îr‹
(
lua
);

962 i‡(
Àvñ
 < 
£rvî
.
vîbosôy
)  0;

965 
log
 = 
	`sd£m±y
();

966 
j
 = 1; j < 
¨gc
; j++) {

967 
size_t
 
Àn
;

968 *
s
;

970 
s
 = (*)
	`lua_tﬁ°rög
(
lua
,(-
¨gc
)+
j
,&
Àn
);

971 i‡(
s
) {

972 i‡(
j
 !1Ë
log
 = 
	`sdsˇéí
(log," ",1);

973 
log
 = 
	`sdsˇéí
÷og,
s
,
Àn
);

976 
	`£rvîLogRaw
(
Àvñ
,
log
);

977 
	`sds‰ì
(
log
);

979 
	}
}

982 
	$luaSëRe•
(
lua_Sèã
 *
lua
) {

983 
¨gc
 = 
	`lua_gët›
(
lua
);

985 i‡(
¨gc
 != 1) {

986 
	`lua_push°rög
(
lua
, "redis.setresp()Ñequires oneárgument.");

987  
	`lua_îr‹
(
lua
);

990 
ª•
 = 
	`lua_t⁄umbî
(
lua
,-
¨gc
);

991 i‡(
ª•
 != 2 &&Ñesp != 3) {

992 
	`lua_push°rög
(
lua
, "RESP version must be 2 or 3.");

993  
	`lua_îr‹
(
lua
);

996 
£rvî
.
lua_˛õ¡
->
ª•
 =Ñesp;

998 
	}
}

1004 
	$luaLﬂdLib
(
lua_Sèã
 *
lua
, c⁄° *
lib«me
, 
lua_CFun˘i⁄
 
luafunc
) {

1005 
	`lua_pushcfun˘i⁄
(
lua
, 
luafunc
);

1006 
	`lua_push°rög
(
lua
, 
lib«me
);

1007 
	`lua_ˇŒ
(
lua
, 1, 0);

1008 
	}
}

1010 
LUALIB_API
 (
lua›í_cjs⁄
Ë(
lua_Sèã
 *
L
);

1011 
LUALIB_API
 (
lua›í_°ru˘
Ë(
lua_Sèã
 *
L
);

1012 
LUALIB_API
 (
lua›í_cmsg∑ck
Ë(
lua_Sèã
 *
L
);

1013 
LUALIB_API
 (
lua›í_bô
Ë(
lua_Sèã
 *
L
);

1015 
	$luaLﬂdLibørõs
(
lua_Sèã
 *
lua
) {

1016 
	`luaLﬂdLib
(
lua
, "", 
lua›í_ba£
);

1017 
	`luaLﬂdLib
(
lua
, 
LUA_TABLIBNAME
, 
lua›í_èbÀ
);

1018 
	`luaLﬂdLib
(
lua
, 
LUA_STRLIBNAME
, 
lua›í_°rög
);

1019 
	`luaLﬂdLib
(
lua
, 
LUA_MATHLIBNAME
, 
lua›í_m©h
);

1020 
	`luaLﬂdLib
(
lua
, 
LUA_DBLIBNAME
, 
lua›í_debug
);

1021 
	`luaLﬂdLib
(
lua
, "cjs⁄", 
lua›í_cjs⁄
);

1022 
	`luaLﬂdLib
(
lua
, "°ru˘", 
lua›í_°ru˘
);

1023 
	`luaLﬂdLib
(
lua
, "cmsg∑ck", 
lua›í_cmsg∑ck
);

1024 
	`luaLﬂdLib
(
lua
, "bô", 
lua›í_bô
);

1027 
	`luaLﬂdLib
(
lua
, 
LUA_LOADLIBNAME
, 
lua›í_∑ckage
);

1028 
	`luaLﬂdLib
(
lua
, 
LUA_OSLIBNAME
, 
lua›í_os
);

1030 
	}
}

1034 
	$luaRemoveUnsuµ‹ãdFun˘i⁄s
(
lua_Sèã
 *
lua
) {

1035 
	`lua_pushnû
(
lua
);

1036 
	`lua_£tglobÆ
(
lua
,"loadfile");

1037 
	`lua_pushnû
(
lua
);

1038 
	`lua_£tglobÆ
(
lua
,"dofile");

1039 
	}
}

1046 
	$s¸ùtögE«bÀGlobÆsPrŸe˘i⁄
(
lua_Sèã
 *
lua
) {

1047 *
s
[32];

1048 
sds
 
code
 = 
	`sd£m±y
();

1049 
j
 = 0;

1053 
s
[
j
++]="local dbg=debug\n";

1054 
s
[
j
++]="local mt = {}\n";

1055 
s
[
j
++]="setmetatable(_G, mt)\n";

1056 
s
[
j
++]="mt.__newindex = function (t,Ç, v)\n";

1057 
s
[
j
++]=" if dbg.getinfo(2)Åhen\n";

1058 
s
[
j
++]="Üocal w = dbg.getinfo(2, \"S\").what\n";

1059 
s
[
j
++]=" if w ~= \"main\"ánd w ~= \"C\"Åhen\n";

1060 
s
[
j
++]="Érror(\"ScriptáttemptedÅo create global variable '\"..tostring(n)..\"'\", 2)\n";

1061 
s
[
j
++]="Énd\n";

1062 
s
[
j
++]="Énd\n";

1063 
s
[
j
++]="Ñawset(t,Ç, v)\n";

1064 
s
[
j
++]="end\n";

1065 
s
[
j
++]="mt.__index = function (t,Ç)\n";

1066 
s
[
j
++]=" if dbg.getinfo(2)ánd dbg.getinfo(2, \"S\").what ~= \"C\"Åhen\n";

1067 
s
[
j
++]="Érror(\"ScriptáttemptedÅoáccessÇonexistent global variable '\"..tostring(n)..\"'\", 2)\n";

1068 
s
[
j
++]="Énd\n";

1069 
s
[
j
++]="ÑeturnÑawget(t,Ç)\n";

1070 
s
[
j
++]="end\n";

1071 
s
[
j
++]="debug =Çil\n";

1072 
s
[
j
++]=
NULL
;

1074 
j
 = 0; 
s
[j] !
NULL
; j++Ë
code
 = 
	`sdsˇéí
(code,s[j],
	`°æí
(s[j]));

1075 
	`luaL_lﬂdbuf„r
(
lua
,
code
,
	`sd¶í
(code),"@enable_strict_lua");

1076 
	`lua_pˇŒ
(
lua
,0,0,0);

1077 
	`sds‰ì
(
code
);

1078 
	}
}

1090 
	$s¸ùtögInô
(
£tup
) {

1091 
lua_Sèã
 *
lua
 = 
	`lua_›í
();

1093 i‡(
£tup
) {

1094 
£rvî
.
lua_˛õ¡
 = 
NULL
;

1095 
£rvî
.
lua_ˇŒî
 = 
NULL
;

1096 
£rvî
.
lua_cur_s¸ùt
 = 
NULL
;

1097 
£rvî
.
lua_timedout
 = 0;

1098 
	`ldbInô
();

1101 
	`luaLﬂdLibørõs
(
lua
);

1102 
	`luaRemoveUnsuµ‹ãdFun˘i⁄s
(
lua
);

1107 
£rvî
.
lua_s¸ùts
 = 
	`di˘Cª©e
(&
shaS¸ùtObje˘Di˘Ty≥
,
NULL
);

1108 
£rvî
.
lua_s¸ùts_mem
 = 0;

1111 
	`lua_√wèbÀ
(
lua
);

1114 
	`lua_push°rög
(
lua
,"call");

1115 
	`lua_pushcfun˘i⁄
(
lua
,
luaRedisCÆlComm™d
);

1116 
	`lua_£âabÀ
(
lua
,-3);

1119 
	`lua_push°rög
(
lua
,"pcall");

1120 
	`lua_pushcfun˘i⁄
(
lua
,
luaRedisPCÆlComm™d
);

1121 
	`lua_£âabÀ
(
lua
,-3);

1124 
	`lua_push°rög
(
lua
,"log");

1125 
	`lua_pushcfun˘i⁄
(
lua
,
luaLogComm™d
);

1126 
	`lua_£âabÀ
(
lua
,-3);

1129 
	`lua_push°rög
(
lua
,"setresp");

1130 
	`lua_pushcfun˘i⁄
(
lua
,
luaSëRe•
);

1131 
	`lua_£âabÀ
(
lua
,-3);

1133 
	`lua_push°rög
(
lua
,"LOG_DEBUG");

1134 
	`lua_pushnumbî
(
lua
,
LL_DEBUG
);

1135 
	`lua_£âabÀ
(
lua
,-3);

1137 
	`lua_push°rög
(
lua
,"LOG_VERBOSE");

1138 
	`lua_pushnumbî
(
lua
,
LL_VERBOSE
);

1139 
	`lua_£âabÀ
(
lua
,-3);

1141 
	`lua_push°rög
(
lua
,"LOG_NOTICE");

1142 
	`lua_pushnumbî
(
lua
,
LL_NOTICE
);

1143 
	`lua_£âabÀ
(
lua
,-3);

1145 
	`lua_push°rög
(
lua
,"LOG_WARNING");

1146 
	`lua_pushnumbî
(
lua
,
LL_WARNING
);

1147 
	`lua_£âabÀ
(
lua
,-3);

1150 
	`lua_push°rög
(
lua
, "sha1hex");

1151 
	`lua_pushcfun˘i⁄
(
lua
, 
luaRedisSha1hexComm™d
);

1152 
	`lua_£âabÀ
(
lua
, -3);

1155 
	`lua_push°rög
(
lua
, "error_reply");

1156 
	`lua_pushcfun˘i⁄
(
lua
, 
luaRedisEº‹RïlyComm™d
);

1157 
	`lua_£âabÀ
(
lua
, -3);

1158 
	`lua_push°rög
(
lua
, "status_reply");

1159 
	`lua_pushcfun˘i⁄
(
lua
, 
luaRedisSètusRïlyComm™d
);

1160 
	`lua_£âabÀ
(
lua
, -3);

1163 
	`lua_push°rög
(
lua
, "replicate_commands");

1164 
	`lua_pushcfun˘i⁄
(
lua
, 
luaRedisRïliˇãComm™dsComm™d
);

1165 
	`lua_£âabÀ
(
lua
, -3);

1168 
	`lua_push°rög
(
lua
,"set_repl");

1169 
	`lua_pushcfun˘i⁄
(
lua
,
luaRedisSëRïlComm™d
);

1170 
	`lua_£âabÀ
(
lua
,-3);

1172 
	`lua_push°rög
(
lua
,"REPL_NONE");

1173 
	`lua_pushnumbî
(
lua
,
PROPAGATE_NONE
);

1174 
	`lua_£âabÀ
(
lua
,-3);

1176 
	`lua_push°rög
(
lua
,"REPL_AOF");

1177 
	`lua_pushnumbî
(
lua
,
PROPAGATE_AOF
);

1178 
	`lua_£âabÀ
(
lua
,-3);

1180 
	`lua_push°rög
(
lua
,"REPL_SLAVE");

1181 
	`lua_pushnumbî
(
lua
,
PROPAGATE_REPL
);

1182 
	`lua_£âabÀ
(
lua
,-3);

1184 
	`lua_push°rög
(
lua
,"REPL_REPLICA");

1185 
	`lua_pushnumbî
(
lua
,
PROPAGATE_REPL
);

1186 
	`lua_£âabÀ
(
lua
,-3);

1188 
	`lua_push°rög
(
lua
,"REPL_ALL");

1189 
	`lua_pushnumbî
(
lua
,
PROPAGATE_AOF
|
PROPAGATE_REPL
);

1190 
	`lua_£âabÀ
(
lua
,-3);

1193 
	`lua_push°rög
(
lua
,"breakpoint");

1194 
	`lua_pushcfun˘i⁄
(
lua
,
luaRedisBªakpoötComm™d
);

1195 
	`lua_£âabÀ
(
lua
,-3);

1198 
	`lua_push°rög
(
lua
,"debug");

1199 
	`lua_pushcfun˘i⁄
(
lua
,
luaRedisDebugComm™d
);

1200 
	`lua_£âabÀ
(
lua
,-3);

1203 
	`lua_£tglobÆ
(
lua
,"redis");

1206 
	`lua_gëglobÆ
(
lua
,"math");

1208 
	`lua_push°rög
(
lua
,"random");

1209 
	`lua_pushcfun˘i⁄
(
lua
,
ªdis_m©h_øndom
);

1210 
	`lua_£âabÀ
(
lua
,-3);

1212 
	`lua_push°rög
(
lua
,"randomseed");

1213 
	`lua_pushcfun˘i⁄
(
lua
,
ªdis_m©h_øndom£ed
);

1214 
	`lua_£âabÀ
(
lua
,-3);

1216 
	`lua_£tglobÆ
(
lua
,"math");

1221 *
com∑ª_func
 = "function __redis__compare_helper(a,b)\n"

1226 
	`luaL_lﬂdbuf„r
(
lua
,
com∑ª_func
,
	`°æí
(compare_func),"@cmp_func_def");

1227 
	`lua_pˇŒ
(
lua
,0,0,0);

1235 *
îrh_func
 = "local dbg = debug\n"

1247 
	`luaL_lﬂdbuf„r
(
lua
,
îrh_func
,
	`°æí
(errh_func),"@err_handler_def");

1248 
	`lua_pˇŒ
(
lua
,0,0,0);

1255 i‡(
£rvî
.
lua_˛õ¡
 =
NULL
) {

1256 
£rvî
.
lua_˛õ¡
 = 
	`¸óãClõ¡
(
NULL
);

1257 
£rvî
.
lua_˛õ¡
->
Êags
 |
CLIENT_LUA
;

1263 
	`s¸ùtögE«bÀGlobÆsPrŸe˘i⁄
(
lua
);

1265 
£rvî
.
lua
 =Üua;

1266 
	}
}

1270 
	$s¸ùtögRñó£
() {

1271 
	`di˘Rñó£
(
£rvî
.
lua_s¸ùts
);

1272 
£rvî
.
lua_s¸ùts_mem
 = 0;

1273 
	`lua_˛o£
(
£rvî
.
lua
);

1274 
	}
}

1276 
	$s¸ùtögRe£t
() {

1277 
	`s¸ùtögRñó£
();

1278 
	`s¸ùtögInô
(0);

1279 
	}
}

1283 
	$luaSëGlobÆAºay
(
lua_Sèã
 *
lua
, *
v¨
, 
robj
 **
ñev
, 
ñec
) {

1284 
j
;

1286 
	`lua_√wèbÀ
(
lua
);

1287 
j
 = 0; j < 
ñec
; j++) {

1288 
	`lua_pushl°rög
(
lua
,(*)
ñev
[
j
]->
±r
,
	`sd¶í
(elev[j]->ptr));

1289 
	`lua_øw£ti
(
lua
,-2,
j
+1);

1291 
	`lua_£tglobÆ
(
lua
,
v¨
);

1292 
	}
}

1304 
	$ªdis_m©h_øndom
 (
lua_Sèã
 *
L
) {

1307 
lua_Numbî
 
r
 = (lua_Numbî)(
	`ªdisLønd48
()%
REDIS_LRAND48_MAX
) /

1308 (
lua_Numbî
)
REDIS_LRAND48_MAX
;

1309 
	`lua_gët›
(
L
)) {

1311 
	`lua_pushnumbî
(
L
, 
r
);

1315 
u
 = 
	`luaL_checköt
(
L
, 1);

1316 
	`luaL_¨gcheck
(
L
, 1<=
u
, 1, "interval isÉmpty");

1317 
	`lua_pushnumbî
(
L
, 
	`Êo‹
(
r
*
u
)+1);

1321 
l
 = 
	`luaL_checköt
(
L
, 1);

1322 
u
 = 
	`luaL_checköt
(
L
, 2);

1323 
	`luaL_¨gcheck
(
L
, 
l
<=
u
, 2, "interval isÉmpty");

1324 
	`lua_pushnumbî
(
L
, 
	`Êo‹
(
r
*(
u
-
l
+1))+l);

1327 :  
	`luaL_îr‹
(
L
, "wrongÇumber ofárguments");

1330 
	}
}

1332 
	$ªdis_m©h_øndom£ed
 (
lua_Sèã
 *
L
) {

1333 
	`ªdisSønd48
(
	`luaL_checköt
(
L
, 1));

1335 
	}
}

1358 
sds
 
	$luaCª©eFun˘i⁄
(
˛õ¡
 *
c
, 
lua_Sèã
 *
lua
, 
robj
 *
body
) {

1359 
fun˙ame
[43];

1360 
di˘E¡ry
 *
de
;

1362 
fun˙ame
[0] = 'f';

1363 
fun˙ame
[1] = '_';

1364 
	`sha1hex
(
fun˙ame
+2,
body
->
±r
,
	`sd¶í
(body->ptr));

1366 
sds
 
sha
 = 
	`sd¢ewÀn
(
fun˙ame
+2,40);

1367 i‡((
de
 = 
	`di˘Föd
(
£rvî
.
lua_s¸ùts
,
sha
)Ë!
NULL
) {

1368 
	`sds‰ì
(
sha
);

1369  
	`di˘GëKey
(
de
);

1372 
sds
 
funcdef
 = 
	`sd£m±y
();

1373 
funcdef
 = 
	`sdsˇt
(funcdef,"function ");

1374 
funcdef
 = 
	`sdsˇéí
(funcdef,
fun˙ame
,42);

1375 
funcdef
 = 
	`sdsˇéí
(funcdef,"() ",3);

1376 
funcdef
 = 
	`sdsˇéí
(funcdef,
body
->
±r
,
	`sd¶í
(body->ptr));

1377 
funcdef
 = 
	`sdsˇéí
(funcdef,"\nend",4);

1379 i‡(
	`luaL_lﬂdbuf„r
(
lua
,
funcdef
,
	`sd¶í
(funcdef),"@user_script")) {

1380 i‡(
c
 !
NULL
) {

1381 
	`addRïlyEº‹F‹m©
(
c
,

1383 
	`lua_to°rög
(
lua
,-1));

1385 
	`lua_p›
(
lua
,1);

1386 
	`sds‰ì
(
sha
);

1387 
	`sds‰ì
(
funcdef
);

1388  
NULL
;

1390 
	`sds‰ì
(
funcdef
);

1392 i‡(
	`lua_pˇŒ
(
lua
,0,0,0)) {

1393 i‡(
c
 !
NULL
) {

1394 
	`addRïlyEº‹F‹m©
(
c
,"ErrorÑunning script (new function): %s\n",

1395 
	`lua_to°rög
(
lua
,-1));

1397 
	`lua_p›
(
lua
,1);

1398 
	`sds‰ì
(
sha
);

1399  
NULL
;

1405 
ªtvÆ
 = 
	`di˘Add
(
£rvî
.
lua_s¸ùts
,
sha
,
body
);

1406 
	`£rvîAs£πWôhInfo
(
c
 ? c : 
£rvî
.
lua_˛õ¡
,
NULL
,
ªtvÆ
 =
DICT_OK
);

1407 
£rvî
.
lua_s¸ùts_mem
 +
	`sdsZmÆlocSize
(
sha
Ë+ 
	`gëSåögObje˘SdsU£dMem‹y
(
body
);

1408 
	`ö¸RefCou¡
(
body
);

1409  
sha
;

1410 
	}
}

1413 
	$luaMaskCou¡Hook
(
lua_Sèã
 *
lua
, 
lua_Debug
 *
¨
) {

1414 
ñ≠£d
 = 
	`m°ime
(Ë- 
£rvî
.
lua_time_°¨t
;

1415 
	`UNUSED
(
¨
);

1416 
	`UNUSED
(
lua
);

1420 i‡(
ñ≠£d
 >
£rvî
.
lua_time_limô
 && sîvî.
lua_timedout
 == 0) {

1421 
	`£rvîLog
(
LL_WARNING
,

1425 
ñ≠£d
, 
£rvî
.
lua_cur_s¸ùt
);

1426 
£rvî
.
lua_timedout
 = 1;

1432 
	`¥Ÿe˘Clõ¡
(
£rvî
.
lua_ˇŒî
);

1434 i‡(
£rvî
.
lua_timedout
Ë
	`¥o˚ssEvítsWhûeBlocked
();

1435 i‡(
£rvî
.
lua_kûl
) {

1436 
	`£rvîLog
(
LL_WARNING
,"Lua script killed by user with SCRIPT KILL.");

1437 
	`lua_push°rög
(
lua
,"Script killed by user with SCRIPT KILL...");

1438 
	`lua_îr‹
(
lua
);

1440 
	}
}

1442 
	$¥ï¨eLuaClõ¡
() {

1444 
	`£À˘Db
(
£rvî
.
lua_˛õ¡
,£rvî.
lua_ˇŒî
->
db
->
id
);

1445 
£rvî
.
lua_˛õ¡
->
ª•
 = 2;

1448 i‡(
£rvî
.
lua_ˇŒî
->
Êags
 & 
CLIENT_MULTI
) {

1449 
£rvî
.
lua_˛õ¡
->
Êags
 |
CLIENT_MULTI
;

1451 
	}
}

1453 
	$ª£tLuaClõ¡
() {

1455 
£rvî
.
lua_˛õ¡
->
Êags
 &~
CLIENT_MULTI
;

1456 
	}
}

1458 
	$evÆGíîicComm™d
(
˛õ¡
 *
c
, 
evÆsha
) {

1459 
lua_Sèã
 *
lua
 = 
£rvî
.lua;

1460 
fun˙ame
[43];

1461 
numkeys
;

1462 
öôül_£rvî_dúty
 = 
£rvî
.
dúty
;

1463 
dñhook
 = 0, 
îr
;

1467 
	`ªdisSønd48
(0);

1477 
£rvî
.
lua_øndom_dúty
 = 0;

1478 
£rvî
.
lua_wrôe_dúty
 = 0;

1479 
£rvî
.
lua_ª∂iˇã_comm™ds
 = sîvî.
lua_Æways_ª∂iˇã_comm™ds
;

1480 
£rvî
.
lua_mu…i_emôãd
 = 0;

1481 
£rvî
.
lua_ª∂
 = 
PROPAGATE_AOF
|
PROPAGATE_REPL
;

1484 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
numkeys
,
NULL
Ë!
C_OK
)

1486 i‡(
numkeys
 > (
c
->
¨gc
 - 3)) {

1487 
	`addRïlyEº‹
(
c
,"Number of keys can't be greaterÅhanÇumber ofárgs");

1489 } i‡(
numkeys
 < 0) {

1490 
	`addRïlyEº‹
(
c
,"Number of keys can't beÇegative");

1496 
fun˙ame
[0] = 'f';

1497 
fun˙ame
[1] = '_';

1498 i‡(!
evÆsha
) {

1500 
	`sha1hex
(
fun˙ame
+2,
c
->
¨gv
[1]->
±r
,
	`sd¶í
(c->argv[1]->ptr));

1503 
j
;

1504 *
sha
 = 
c
->
¨gv
[1]->
±r
;

1509 
j
 = 0; j < 40; j++)

1510 
fun˙ame
[
j
+2] = (
sha
[j] >= 'A' && sha[j] <= 'Z') ?

1511 
sha
[
j
]+('a'-'A') : sha[j];

1512 
fun˙ame
[42] = '\0';

1516 
	`lua_gëglobÆ
(
lua
, "__redis__err__handler");

1519 
	`lua_gëglobÆ
(
lua
, 
fun˙ame
);

1520 i‡(
	`lua_i¢û
(
lua
,-1)) {

1521 
	`lua_p›
(
lua
,1);

1525 i‡(
evÆsha
) {

1526 
	`lua_p›
(
lua
,1);

1527 
	`addRïly
(
c
, 
sh¨ed
.
nos¸ùãº
);

1530 i‡(
	`luaCª©eFun˘i⁄
(
c
,
lua
,c->
¨gv
[1]Ë=
NULL
) {

1531 
	`lua_p›
(
lua
,1);

1537 
	`lua_gëglobÆ
(
lua
, 
fun˙ame
);

1538 
	`£rvîAs£π
(!
	`lua_i¢û
(
lua
,-1));

1543 
	`luaSëGlobÆAºay
(
lua
,"KEYS",
c
->
¨gv
+3,
numkeys
);

1544 
	`luaSëGlobÆAºay
(
lua
,"ARGV",
c
->
¨gv
+3+
numkeys
,c->
¨gc
-3-numkeys);

1553 
£rvî
.
lua_ˇŒî
 = 
c
;

1554 
£rvî
.
lua_cur_s¸ùt
 = 
fun˙ame
 + 2;

1555 
£rvî
.
lua_time_°¨t
 = 
	`m°ime
();

1556 
£rvî
.
lua_kûl
 = 0;

1557 i‡(
£rvî
.
lua_time_limô
 > 0 && 
ldb
.
a˘ive
 == 0) {

1558 
	`lua_£thook
(
lua
,
luaMaskCou¡Hook
,
LUA_MASKCOUNT
,100000);

1559 
dñhook
 = 1;

1560 } i‡(
ldb
.
a˘ive
) {

1561 
	`lua_£thook
(
£rvî
.
lua
,
luaLdbLöeHook
,
LUA_MASKLINE
|
LUA_MASKCOUNT
,100000);

1562 
dñhook
 = 1;

1565 
	`¥ï¨eLuaClõ¡
();

1570 
îr
 = 
	`lua_pˇŒ
(
lua
,0,1,-2);

1572 
	`ª£tLuaClõ¡
();

1575 i‡(
dñhook
Ë
	`lua_£thook
(
lua
,
NULL
,0,0);

1576 i‡(
£rvî
.
lua_timedout
) {

1577 
£rvî
.
lua_timedout
 = 0;

1580 
	`u≈rŸe˘Clõ¡
(
c
);

1581 i‡(
£rvî
.
ma°îho°
 && sîvî.
ma°î
)

1582 
	`queueClõ¡F‹Rïro˚ssög
(
£rvî
.
ma°î
);

1584 
£rvî
.
lua_ˇŒî
 = 
NULL
;

1585 
£rvî
.
lua_cur_s¸ùt
 = 
NULL
;

1593 
	#LUA_GC_CYCLE_PERIOD
 50

	)

1595 
gc_cou¡
 = 0;

1597 
gc_cou¡
++;

1598 i‡(
gc_cou¡
 =
LUA_GC_CYCLE_PERIOD
) {

1599 
	`lua_gc
(
lua
,
LUA_GCSTEP
,
LUA_GC_CYCLE_PERIOD
);

1600 
gc_cou¡
 = 0;

1604 i‡(
îr
) {

1605 
	`addRïlyEº‹F‹m©
(
c
,"ErrorÑunning script (callÅo %s): %s\n",

1606 
fun˙ame
, 
	`lua_to°rög
(
lua
,-1));

1607 
	`lua_p›
(
lua
,2);

1611 
	`luaRïlyToRedisRïly
(
c
,
lua
);

1612 
	`lua_p›
(
lua
,1);

1617 i‡(
£rvî
.
lua_ª∂iˇã_comm™ds
) {

1618 
	`¥evítComm™dPr›ag©i⁄
(
c
);

1619 i‡(
£rvî
.
lua_mu…i_emôãd
) {

1620 
	`execComm™dPr›ag©eExec
(
c
);

1634 i‡(
evÆsha
 && !
£rvî
.
lua_ª∂iˇã_comm™ds
) {

1635 i‡(!
	`ª∂iˇti⁄S¸ùtCacheExi°s
(
c
->
¨gv
[1]->
±r
)) {

1639 
robj
 *
s¸ùt
 = 
	`di˘FëchVÆue
(
£rvî
.
lua_s¸ùts
,
c
->
¨gv
[1]->
±r
);

1641 
	`ª∂iˇti⁄S¸ùtCacheAdd
(
c
->
¨gv
[1]->
±r
);

1642 
	`£rvîAs£πWôhInfo
(
c
,
NULL
,
s¸ùt
 != NULL);

1648 i‡(
£rvî
.
dúty
 =
öôül_£rvî_dúty
) {

1649 
	`ªwrôeClõ¡Comm™dVe˘‹
(
c
,3,

1650 
	`ª£tRefCou¡
(
	`¸óãSåögObje˘
("SCRIPT",6)),

1651 
	`ª£tRefCou¡
(
	`¸óãSåögObje˘
("LOAD",4)),

1652 
s¸ùt
);

1654 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,0,

1655 
	`ª£tRefCou¡
(
	`¸óãSåögObje˘
("EVAL",4)));

1656 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,1,
s¸ùt
);

1658 
	`f‹˚Comm™dPr›ag©i⁄
(
c
,
PROPAGATE_REPL
|
PROPAGATE_AOF
);

1661 
	}
}

1663 
	$evÆComm™d
(
˛õ¡
 *
c
) {

1664 i‡(!(
c
->
Êags
 & 
CLIENT_LUA_DEBUG
))

1665 
	`evÆGíîicComm™d
(
c
,0);

1667 
	`evÆGíîicComm™dWôhDebuggög
(
c
,0);

1668 
	}
}

1670 
	$evÆShaComm™d
(
˛õ¡
 *
c
) {

1671 i‡(
	`sd¶í
(
c
->
¨gv
[1]->
±r
) != 40) {

1676 
	`addRïly
(
c
, 
sh¨ed
.
nos¸ùãº
);

1679 i‡(!(
c
->
Êags
 & 
CLIENT_LUA_DEBUG
))

1680 
	`evÆGíîicComm™d
(
c
,1);

1682 
	`addRïlyEº‹
(
c
,"Please use EVAL instead of EVALSHA for debugging");

1685 
	}
}

1687 
	$s¸ùtComm™d
(
˛õ¡
 *
c
) {

1688 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"help")) {

1689 c⁄° *
hñp
[] = {

1695 
NULL


1697 
	`addRïlyHñp
(
c
, 
hñp
);

1698 } i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"flush")) {

1699 
	`s¸ùtögRe£t
();

1700 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1701 
	`ª∂iˇti⁄S¸ùtCacheFlush
();

1702 
£rvî
.
dúty
++;

1703 } i‡(
c
->
¨gc
 >2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"exists")) {

1704 
j
;

1706 
	`addRïlyAºayLí
(
c
, c->
¨gc
-2);

1707 
j
 = 2; j < 
c
->
¨gc
; j++) {

1708 i‡(
	`di˘Föd
(
£rvî
.
lua_s¸ùts
,
c
->
¨gv
[
j
]->
±r
))

1709 
	`addRïly
(
c
,
sh¨ed
.
c⁄e
);

1711 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

1713 } i‡(
c
->
¨gc
 =3 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"load")) {

1714 
sds
 
sha
 = 
	`luaCª©eFun˘i⁄
(
c
,
£rvî
.
lua
,c->
¨gv
[2]);

1715 i‡(
sha
 =
NULL
) ;

1716 
	`addRïlyBulkCBuf„r
(
c
,
sha
,40);

1717 
	`f‹˚Comm™dPr›ag©i⁄
(
c
,
PROPAGATE_REPL
|
PROPAGATE_AOF
);

1718 } i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"kill")) {

1719 i‡(
£rvî
.
lua_ˇŒî
 =
NULL
) {

1720 
	`addRïlySds
(
c
,
	`sd¢ew
("-NOTBUSY No scripts inÉxecutionÑightÇow.\r\n"));

1721 } i‡(
£rvî
.
lua_ˇŒî
->
Êags
 & 
CLIENT_MASTER
) {

1722 
	`addRïlySds
(
c
,
	`sd¢ew
("-UNKILLABLE The busy script was sent byá master instance inÅhe context ofÑeplicationánd cannot be killed.\r\n"));

1723 } i‡(
£rvî
.
lua_wrôe_dúty
) {

1724 
	`addRïlySds
(
c
,
	`sd¢ew
("-UNKILLABLE SorryÅhe scriptálreadyÉxecuted write commandságainstÅhe dataset. You canÉither waitÅhe scriptÅermination or killÅhe server iná hard way usingÅhe SHUTDOWN NOSAVE command.\r\n"));

1726 
£rvî
.
lua_kûl
 = 1;

1727 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1729 } i‡(
c
->
¨gc
 =3 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"debug")) {

1730 i‡(
	`˛õ¡HasPídögRïlõs
(
c
)) {

1731 
	`addRïlyEº‹
(
c
,"SCRIPT DEBUG must be called outsideáÖipeline");

1734 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"no")) {

1735 
	`ldbDißbÀ
(
c
);

1736 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1737 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"yes")) {

1738 
	`ldbE«bÀ
(
c
);

1739 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1740 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"sync")) {

1741 
	`ldbE«bÀ
(
c
);

1742 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1743 
c
->
Êags
 |
CLIENT_LUA_DEBUG_SYNC
;

1745 
	`addRïlyEº‹
(
c
,"Use SCRIPT DEBUG yes/sync/no");

1749 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

1751 
	}
}

1758 
	$ldbInô
() {

1759 
ldb
.
c⁄n
 = 
NULL
;

1760 
ldb
.
a˘ive
 = 0;

1761 
ldb
.
logs
 = 
	`li°Cª©e
();

1762 
	`li°SëFªeMëhod
(
ldb
.
logs
,((*)(*))
sds‰ì
);

1763 
ldb
.
chûdªn
 = 
	`li°Cª©e
();

1764 
ldb
.
§c
 = 
NULL
;

1765 
ldb
.
löes
 = 0;

1766 
ldb
.
cbuf
 = 
	`sd£m±y
();

1767 
	}
}

1770 
	$ldbFlushLog
(
li°
 *
log
) {

1771 
li°Node
 *
 
;

1773 (
 
 = 
	`li°Fú°
(
log
)Ë!
NULL
)

1774 
	`li°DñNode
(
log
,
 
);

1775 
	}
}

1778 
	$ldbE«bÀ
(
˛õ¡
 *
c
) {

1779 
c
->
Êags
 |
CLIENT_LUA_DEBUG
;

1780 
	`ldbFlushLog
(
ldb
.
logs
);

1781 
ldb
.
c⁄n
 = 
c
->conn;

1782 
ldb
.
°ï
 = 1;

1783 
ldb
.
bpcou¡
 = 0;

1784 
ldb
.
luabp
 = 0;

1785 
	`sds‰ì
(
ldb
.
cbuf
);

1786 
ldb
.
cbuf
 = 
	`sd£m±y
();

1787 
ldb
.
maxÀn
 = 
LDB_MAX_LEN_DEFAULT
;

1788 
ldb
.
maxÀn_höt_£¡
 = 0;

1789 
	}
}

1794 
	$ldbDißbÀ
(
˛õ¡
 *
c
) {

1795 
c
->
Êags
 &~(
CLIENT_LUA_DEBUG
|
CLIENT_LUA_DEBUG_SYNC
);

1796 
	}
}

1799 
	$ldbLog
(
sds
 
íåy
) {

1800 
	`li°AddNodeTaû
(
ldb
.
logs
,
íåy
);

1801 
	}
}

1807 
	$ldbLogWôhMaxLí
(
sds
 
íåy
) {

1808 
åimmed
 = 0;

1809 i‡(
ldb
.
maxÀn
 && 
	`sd¶í
(
íåy
) >Üdb.maxlen) {

1810 
	`sd§™ge
(
íåy
,0,
ldb
.
maxÀn
-1);

1811 
íåy
 = 
	`sdsˇéí
(entry," ...",4);

1812 
åimmed
 = 1;

1814 
	`ldbLog
(
íåy
);

1815 i‡(
åimmed
 && 
ldb
.
maxÀn_höt_£¡
 == 0) {

1816 
ldb
.
maxÀn_höt_£¡
 = 1;

1817 
	`ldbLog
(
	`sd¢ew
(

1820 
	}
}

1825 
	$ldbSídLogs
() {

1826 
sds
 
¥Ÿo
 = 
	`sd£m±y
();

1827 
¥Ÿo
 = 
	`sdsˇtfmt
’rŸo,"*%i\r\n", ()
	`li°Lígth
(
ldb
.
logs
));

1828 
	`li°Lígth
(
ldb
.
logs
)) {

1829 
li°Node
 *
 
 = 
	`li°Fú°
(
ldb
.
logs
);

1830 
¥Ÿo
 = 
	`sdsˇéí
(proto,"+",1);

1831 
	`sdsm≠ch¨s
(
 
->
vÆue
,"\r\n"," ",2);

1832 
¥Ÿo
 = 
	`sdsˇtsds
’rŸo,
 
->
vÆue
);

1833 
¥Ÿo
 = 
	`sdsˇéí
(proto,"\r\n",2);

1834 
	`li°DñNode
(
ldb
.
logs
,
 
);

1836 i‡(
	`c⁄nWrôe
(
ldb
.
c⁄n
,
¥Ÿo
,
	`sd¶í
(proto)) == -1) {

1841 
	`sds‰ì
(
¥Ÿo
);

1842 
	}
}

1856 
	$ldbSèπSessi⁄
(
˛õ¡
 *
c
) {

1857 
ldb
.
f‹ked
 = (
c
->
Êags
 & 
CLIENT_LUA_DEBUG_SYNC
) == 0;

1858 i‡(
ldb
.
f‹ked
) {

1859 
pid_t
 
˝
 = 
	`ªdisF‹k
();

1860 i‡(
˝
 == -1) {

1861 
	`addRïlyEº‹
(
c
,"Fork() failed: can'tÑun EVAL in debugging mode.");

1863 } i‡(
˝
 == 0) {

1865 
siga˘i⁄
 
a˘
;

1866 
	`sigem±y£t
(&
a˘
.
ß_mask
);

1867 
a˘
.
ß_Êags
 = 0;

1868 
a˘
.
ß_h™dÀr
 = 
SIG_IGN
;

1869 
	`siga˘i⁄
(
SIGTERM
, &
a˘
, 
NULL
);

1870 
	`siga˘i⁄
(
SIGINT
, &
a˘
, 
NULL
);

1875 
	`£rvîLog
(
LL_WARNING
,"Redis forked for debuggingÉval");

1878 
	`li°AddNodeTaû
(
ldb
.
chûdªn
,(*)()
˝
);

1879 
	`‰ìClõ¡Async
(
c
);

1883 
	`£rvîLog
(
LL_WARNING
,

1888 
	`c⁄nBlock
(
ldb
.
c⁄n
);

1889 
	`c⁄nSídTimeout
(
ldb
.
c⁄n
,5000);

1890 
ldb
.
a˘ive
 = 1;

1894 
sds
 
§c°rög
 = 
	`sdsdup
(
c
->
¨gv
[1]->
±r
);

1895 
size_t
 
§˛í
 = 
	`sd¶í
(
§c°rög
);

1896 
§˛í
 && (
§c°rög
[srclen-1] == '\n' ||

1897 
§c°rög
[
§˛í
-1] == '\r'))

1899 
§c°rög
[--
§˛í
] = '\0';

1901 
	`sds£éí
(
§c°rög
,
§˛í
);

1902 
ldb
.
§c
 = 
	`sds•lôÀn
(
§c°rög
,
	`sd¶í
(§c°rög),"\n",1,&ldb.
löes
);

1903 
	`sds‰ì
(
§c°rög
);

1905 
	}
}

1909 
	$ldbEndSessi⁄
(
˛õ¡
 *
c
) {

1911 
	`ldbLog
(
	`sd¢ew
("<endsession>"));

1912 
	`ldbSídLogs
();

1915 i‡(
ldb
.
f‹ked
) {

1916 
	`wrôeToClõ¡
(
c
,0);

1917 
	`£rvîLog
(
LL_WARNING
,"Lua debugging session childÉxiting");

1918 
	`exôFromChûd
(0);

1920 
	`£rvîLog
(
LL_WARNING
,

1925 
	`c⁄nN⁄Block
(
ldb
.
c⁄n
);

1926 
	`c⁄nSídTimeout
(
ldb
.
c⁄n
,0);

1930 
c
->
Êags
 |
CLIENT_CLOSE_AFTER_REPLY
;

1933 
	`sds‰ì•lôªs
(
ldb
.
§c
,ldb.
löes
);

1934 
ldb
.
löes
 = 0;

1935 
ldb
.
a˘ive
 = 0;

1936 
	}
}

1941 
	$ldbRemoveChûd
(
pid_t
 
pid
) {

1942 
li°Node
 *
 
 = 
	`li°SórchKey
(
ldb
.
chûdªn
,(*)()
pid
);

1943 i‡(
 
) {

1944 
	`li°DñNode
(
ldb
.
chûdªn
,
 
);

1948 
	}
}

1952 
	$ldbPídögChûdªn
() {

1953  
	`li°Lígth
(
ldb
.
chûdªn
);

1954 
	}
}

1957 
	$ldbKûlF‹kedSessi⁄s
() {

1958 
li°Iãr
 
li
;

1959 
li°Node
 *
 
;

1961 
	`li°Rewöd
(
ldb
.
chûdªn
,&
li
);

1962 (
 
 = 
	`li°Next
(&
li
))) {

1963 
pid_t
 
pid
 = (Ë
 
->
vÆue
;

1964 
	`£rvîLog
(
LL_WARNING
,"Kûlög debuggög sessi⁄ %ld",()
pid
);

1965 
	`kûl
(
pid
,
SIGKILL
);

1967 
	`li°Rñó£
(
ldb
.
chûdªn
);

1968 
ldb
.
chûdªn
 = 
	`li°Cª©e
();

1969 
	}
}

1973 
	$evÆGíîicComm™dWôhDebuggög
(
˛õ¡
 *
c
, 
evÆsha
) {

1974 i‡(
	`ldbSèπSessi⁄
(
c
)) {

1975 
	`evÆGíîicComm™d
(
c
,
evÆsha
);

1976 
	`ldbEndSessi⁄
(
c
);

1978 
	`ldbDißbÀ
(
c
);

1980 
	}
}

1984 *
	$ldbGëSour˚Löe
(
löe
) {

1985 
idx
 = 
löe
-1;

1986 i‡(
idx
 < 0 || idx >
ldb
.
löes
)  "<out ofÑange source codeÜine>";

1987  
ldb
.
§c
[
idx
];

1988 
	}
}

1991 
	$ldbIsBªakpoöt
(
löe
) {

1992 
j
;

1994 
j
 = 0; j < 
ldb
.
bpcou¡
; j++)

1995 i‡(
ldb
.
bp
[
j
] =
löe
)  1;

1997 
	}
}

2002 
	$ldbAddBªakpoöt
(
löe
) {

2003 i‡(
löe
 <0 ||Üöê> 
ldb
.
löes
)  0;

2004 i‡(!
	`ldbIsBªakpoöt
(
löe
Ë&& 
ldb
.
bpcou¡
 !
LDB_BREAKPOINTS_MAX
) {

2005 
ldb
.
bp
[ldb.
bpcou¡
++] = 
löe
;

2009 
	}
}

2013 
	$ldbDñBªakpoöt
(
löe
) {

2014 
j
;

2016 
j
 = 0; j < 
ldb
.
bpcou¡
; j++) {

2017 i‡(
ldb
.
bp
[
j
] =
löe
) {

2018 
ldb
.
bpcou¡
--;

2019 
	`memmove
(
ldb
.
bp
+
j
,ldb.bp+j+1,ldb.
bpcou¡
-j);

2024 
	}
}

2029 
sds
 *
	$ldbRïlP¨£Comm™d
(*
¨g˝
) {

2030 
sds
 *
¨gv
 = 
NULL
;

2031 
¨gc
 = 0;

2032 i‡(
	`sd¶í
(
ldb
.
cbuf
Ë=0Ë 
NULL
;

2036 
sds
 
c›y
 = 
	`sdsdup
(
ldb
.
cbuf
);

2037 *
p
 = 
c›y
;

2044 
p
 = 
	`°rchr
’,'*'); i‡(!pË
¥Ÿ€º
;

2045 *
∂í
 = 
p
+1;

2046 
p
 = 
	`°r°r
’,"\r\n"); i‡(!pË
¥Ÿ€º
;

2047 *
p
 = '\0';Ö += 2;

2048 *
¨g˝
 = 
	`©oi
(
∂í
);

2049 i‡(*
¨g˝
 <0 || *¨g˝ > 1024Ë
¥Ÿ€º
;

2052 
¨gv
 = 
	`zmÆloc
((
sds
)*(*
¨g˝
));

2053 
¨gc
 = 0;

2054 
¨gc
 < *
¨g˝
) {

2055 i‡(*
p
 !'$'Ë
¥Ÿ€º
;

2056 
∂í
 = 
p
+1;

2057 
p
 = 
	`°r°r
’,"\r\n"); i‡(!pË
¥Ÿ€º
;

2058 *
p
 = '\0';Ö += 2;

2059 
¶í
 = 
	`©oi
(
∂í
);

2060 i‡(
¶í
 <0 || sÀ¿> 1024Ë
¥Ÿ€º
;

2061 
¨gv
[
¨gc
++] = 
	`sd¢ewÀn
(
p
,
¶í
);

2062 
p
 +
¶í
;

2063 i‡(
p
[0] !'\r' ||Ö[1] !'\n'Ë
¥Ÿ€º
;

2064 
p
 += 2;

2066 
	`sds‰ì
(
c›y
);

2067  
¨gv
;

2069 
¥Ÿ€º
:

2070 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

2071 
	`sds‰ì
(
c›y
);

2072  
NULL
;

2073 
	}
}

2076 
	$ldbLogSour˚Löe
(
 um
) {

2077 *
löe
 = 
	`ldbGëSour˚Löe
(
 um
);

2078 *
¥efix
;

2079 
bp
 = 
	`ldbIsBªakpoöt
(
 um
);

2080 
cuºít
 = 
ldb
.
cuºíéöe
 =
 um
;

2082 i‡(
cuºít
 && 
bp
)

2083 
¥efix
 = "->#";

2084 i‡(
cuºít
)

2085 
¥efix
 = "-> ";

2086 i‡(
bp
)

2087 
¥efix
 = " #";

2089 
¥efix
 = " ";

2090 
sds
 
thi¶öe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%s%-3d %s", 
¥efix
, 
 um
, 
löe
);

2091 
	`ldbLog
(
thi¶öe
);

2092 
	}
}

2099 
	$ldbLi°
(
¨ound
, 
c⁄ãxt
) {

2100 
j
;

2102 
j
 = 1; j <
ldb
.
löes
; j++) {

2103 i‡(
¨ound
 !0 && 
	`abs
◊round-
j
Ë> 
c⁄ãxt
) ;

2104 
	`ldbLogSour˚Löe
(
j
);

2106 
	}
}

2115 
	#LDB_MAX_VALUES_DEPTH
 (
LUA_MINSTACK
/2)

	)

2116 
sds
 
	$ldbC©SèckVÆueRec
(
sds
 
s
, 
lua_Sèã
 *
lua
, 
idx
, 
Àvñ
) {

2117 
t
 = 
	`lua_ty≥
(
lua
,
idx
);

2119 i‡(
Àvñ
++ =
LDB_MAX_VALUES_DEPTH
)

2120  
	`sdsˇt
(
s
,"<maxÑecursionÜevelÑeached! NestedÅable?>");

2122 
t
) {

2123 
LUA_TSTRING
:

2125 
size_t
 
°æ
;

2126 *
°Ω
 = (*)
	`lua_tﬁ°rög
(
lua
,
idx
,&
°æ
);

2127 
s
 = 
	`sdsˇåïr
(s,
°Ω
,
°æ
);

2130 
LUA_TBOOLEAN
:

2131 
s
 = 
	`sdsˇt
(s,
	`lua_toboﬁón
(
lua
,
idx
) ? "true" : "false");

2133 
LUA_TNUMBER
:

2134 
s
 = 
	`sdsˇçrötf
(s,"%g",()
	`lua_t⁄umbî
(
lua
,
idx
));

2136 
LUA_TNIL
:

2137 
s
 = 
	`sdsˇéí
(s,"nil",3);

2139 
LUA_TTABLE
:

2141 
ex≥˘ed_ödex
 = 1;

2142 
is_¨øy
 = 1;

2146 
sds
 
ª¥1
 = 
	`sd£m±y
();

2147 
sds
 
ª¥2
 = 
	`sd£m±y
();

2148 
	`lua_pushnû
(
lua
);

2149 
	`lua_√xt
(
lua
,
idx
-1)) {

2151 i‡(
is_¨øy
 &&

2152 (
	`lua_ty≥
(
lua
,-2Ë!
LUA_TNUMBER
 ||

2153 
	`lua_t⁄umbî
(
lua
,-2Ë!
ex≥˘ed_ödex
)Ë
is_¨øy
 = 0;

2156 
ª¥1
 = 
	`ldbC©SèckVÆueRec
‘ïr1,
lua
,-1,
Àvñ
);

2157 
ª¥1
 = 
	`sdsˇéí
(repr1,"; ",2);

2159 
ª¥2
 = 
	`sdsˇéí
(repr2,"[",1);

2160 
ª¥2
 = 
	`ldbC©SèckVÆueRec
‘ïr2,
lua
,-2,
Àvñ
);

2161 
ª¥2
 = 
	`sdsˇéí
(repr2,"]=",2);

2162 
ª¥2
 = 
	`ldbC©SèckVÆueRec
‘ïr2,
lua
,-1,
Àvñ
);

2163 
ª¥2
 = 
	`sdsˇéí
(repr2,"; ",2);

2164 
	`lua_p›
(
lua
,1);

2165 
ex≥˘ed_ödex
++;

2168 i‡(
	`sd¶í
(
ª¥1
)Ë
	`sd§™ge
(repr1,0,-3);

2169 i‡(
	`sd¶í
(
ª¥2
)Ë
	`sd§™ge
(repr2,0,-3);

2171 
s
 = 
	`sdsˇéí
(s,"{",1);

2172 
s
 = 
	`sdsˇtsds
(s,
is_¨øy
 ? 
ª¥1
 : 
ª¥2
);

2173 
s
 = 
	`sdsˇéí
(s,"}",1);

2174 
	`sds‰ì
(
ª¥1
);

2175 
	`sds‰ì
(
ª¥2
);

2178 
LUA_TFUNCTION
:

2179 
LUA_TUSERDATA
:

2180 
LUA_TTHREAD
:

2181 
LUA_TLIGHTUSERDATA
:

2183 c⁄° *
p
 = 
	`lua_t›oöãr
(
lua
,
idx
);

2184 *
ty≥«me
 = "unknown";

2185 i‡(
t
 =
LUA_TFUNCTION
Ë
ty≥«me
 = "function";

2186 i‡(
t
 =
LUA_TUSERDATA
Ë
ty≥«me
 = "userdata";

2187 i‡(
t
 =
LUA_TTHREAD
Ë
ty≥«me
 = "thread";

2188 i‡(
t
 =
LUA_TLIGHTUSERDATA
Ë
ty≥«me
 = "light-userdata";

2189 
s
 = 
	`sdsˇçrötf
(s,"\"%s@%p\"",
ty≥«me
,
p
);

2193 
s
 = 
	`sdsˇt
(s,"\"<unknown-lua-type>\"");

2196  
s
;

2197 
	}
}

2201 
sds
 
	$ldbC©SèckVÆue
(
sds
 
s
, 
lua_Sèã
 *
lua
, 
idx
) {

2202  
	`ldbC©SèckVÆueRec
(
s
,
lua
,
idx
,0);

2203 
	}
}

2208 
	$ldbLogSèckVÆue
(
lua_Sèã
 *
lua
, *
¥efix
) {

2209 
sds
 
s
 = 
	`sd¢ew
(
¥efix
);

2210 
s
 = 
	`ldbC©SèckVÆue
(s,
lua
,-1);

2211 
	`ldbLogWôhMaxLí
(
s
);

2212 
	}
}

2214 *
ldbRedisPrŸocﬁToHum™_I¡
(
sds
 *
o
, *
ª∂y
);

2215 *
ldbRedisPrŸocﬁToHum™_Bulk
(
sds
 *
o
, *
ª∂y
);

2216 *
ldbRedisPrŸocﬁToHum™_Sètus
(
sds
 *
o
, *
ª∂y
);

2217 *
ldbRedisPrŸocﬁToHum™_Mu…iBulk
(
sds
 *
o
, *
ª∂y
);

2218 *
ldbRedisPrŸocﬁToHum™_Së
(
sds
 *
o
, *
ª∂y
);

2219 *
ldbRedisPrŸocﬁToHum™_M≠
(
sds
 *
o
, *
ª∂y
);

2220 *
ldbRedisPrŸocﬁToHum™_NuŒ
(
sds
 *
o
, *
ª∂y
);

2221 *
ldbRedisPrŸocﬁToHum™_Boﬁ
(
sds
 *
o
, *
ª∂y
);

2222 *
ldbRedisPrŸocﬁToHum™_DoubÀ
(
sds
 *
o
, *
ª∂y
);

2229 *
	$ldbRedisPrŸocﬁToHum™
(
sds
 *
o
, *
ª∂y
) {

2230 *
p
 = 
ª∂y
;

2231 *
p
) {

2232 ':': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_I¡
(
o
,
ª∂y
); ;

2233 '$': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_Bulk
(
o
,
ª∂y
); ;

2234 '+': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_Sètus
(
o
,
ª∂y
); ;

2235 '-': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_Sètus
(
o
,
ª∂y
); ;

2236 '*': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_Mu…iBulk
(
o
,
ª∂y
); ;

2237 '~': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_Së
(
o
,
ª∂y
); ;

2238 '%': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_M≠
(
o
,
ª∂y
); ;

2239 '_': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_NuŒ
(
o
,
ª∂y
); ;

2240 '#': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_Boﬁ
(
o
,
ª∂y
); ;

2241 ',': 
p
 = 
	`ldbRedisPrŸocﬁToHum™_DoubÀ
(
o
,
ª∂y
); ;

2243  
p
;

2244 
	}
}

2249 *
	$ldbRedisPrŸocﬁToHum™_I¡
(
sds
 *
o
, *
ª∂y
) {

2250 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

2251 *
o
 = 
	`sdsˇéí
(*o,
ª∂y
+1,
p
-reply-1);

2252  
p
+2;

2253 
	}
}

2255 *
	$ldbRedisPrŸocﬁToHum™_Bulk
(
sds
 *
o
, *
ª∂y
) {

2256 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

2257 
bulkÀn
;

2259 
	`°rög2Œ
(
ª∂y
+1,
p
-ª∂y-1,&
bulkÀn
);

2260 i‡(
bulkÀn
 == -1) {

2261 *
o
 = 
	`sdsˇéí
(*o,"NULL",4);

2262  
p
+2;

2264 *
o
 = 
	`sdsˇåïr
(*o,
p
+2,
bulkÀn
);

2265  
p
+2+
bulkÀn
+2;

2267 
	}
}

2269 *
	$ldbRedisPrŸocﬁToHum™_Sètus
(
sds
 *
o
, *
ª∂y
) {

2270 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

2272 *
o
 = 
	`sdsˇåïr
(*o,
ª∂y
,
p
-reply);

2273  
p
+2;

2274 
	}
}

2276 *
	$ldbRedisPrŸocﬁToHum™_Mu…iBulk
(
sds
 *
o
, *
ª∂y
) {

2277 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

2278 
mbulkÀn
;

2279 
j
 = 0;

2281 
	`°rög2Œ
(
ª∂y
+1,
p
-ª∂y-1,&
mbulkÀn
);

2282 
p
 += 2;

2283 i‡(
mbulkÀn
 == -1) {

2284 *
o
 = 
	`sdsˇéí
(*o,"NULL",4);

2285  
p
;

2287 *
o
 = 
	`sdsˇéí
(*o,"[",1);

2288 
j
 = 0; j < 
mbulkÀn
; j++) {

2289 
p
 = 
	`ldbRedisPrŸocﬁToHum™
(
o
,p);

2290 i‡(
j
 !
mbulkÀn
-1Ë*
o
 = 
	`sdsˇéí
(*o,",",1);

2292 *
o
 = 
	`sdsˇéí
(*o,"]",1);

2293  
p
;

2294 
	}
}

2296 *
	$ldbRedisPrŸocﬁToHum™_Së
(
sds
 *
o
, *
ª∂y
) {

2297 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

2298 
mbulkÀn
;

2299 
j
 = 0;

2301 
	`°rög2Œ
(
ª∂y
+1,
p
-ª∂y-1,&
mbulkÀn
);

2302 
p
 += 2;

2303 *
o
 = 
	`sdsˇéí
(*o,"~(",2);

2304 
j
 = 0; j < 
mbulkÀn
; j++) {

2305 
p
 = 
	`ldbRedisPrŸocﬁToHum™
(
o
,p);

2306 i‡(
j
 !
mbulkÀn
-1Ë*
o
 = 
	`sdsˇéí
(*o,",",1);

2308 *
o
 = 
	`sdsˇéí
(*o,")",1);

2309  
p
;

2310 
	}
}

2312 *
	$ldbRedisPrŸocﬁToHum™_M≠
(
sds
 *
o
, *
ª∂y
) {

2313 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

2314 
mbulkÀn
;

2315 
j
 = 0;

2317 
	`°rög2Œ
(
ª∂y
+1,
p
-ª∂y-1,&
mbulkÀn
);

2318 
p
 += 2;

2319 *
o
 = 
	`sdsˇéí
(*o,"{",1);

2320 
j
 = 0; j < 
mbulkÀn
; j++) {

2321 
p
 = 
	`ldbRedisPrŸocﬁToHum™
(
o
,p);

2322 *
o
 = 
	`sdsˇéí
(*o," => ",4);

2323 
p
 = 
	`ldbRedisPrŸocﬁToHum™
(
o
,p);

2324 i‡(
j
 !
mbulkÀn
-1Ë*
o
 = 
	`sdsˇéí
(*o,",",1);

2326 *
o
 = 
	`sdsˇéí
(*o,"}",1);

2327  
p
;

2328 
	}
}

2330 *
	$ldbRedisPrŸocﬁToHum™_NuŒ
(
sds
 *
o
, *
ª∂y
) {

2331 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

2332 *
o
 = 
	`sdsˇéí
(*o,"(null)",6);

2333  
p
+2;

2334 
	}
}

2336 *
	$ldbRedisPrŸocﬁToHum™_Boﬁ
(
sds
 *
o
, *
ª∂y
) {

2337 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

2338 i‡(
ª∂y
[1] == 't')

2339 *
o
 = 
	`sdsˇéí
(*o,"#true",5);

2341 *
o
 = 
	`sdsˇéí
(*o,"#false",6);

2342  
p
+2;

2343 
	}
}

2345 *
	$ldbRedisPrŸocﬁToHum™_DoubÀ
(
sds
 *
o
, *
ª∂y
) {

2346 *
p
 = 
	`°rchr
(
ª∂y
+1,'\r');

2347 *
o
 = 
	`sdsˇéí
(*o,"(double) ",9);

2348 *
o
 = 
	`sdsˇéí
(*o,
ª∂y
+1,
p
-reply-1);

2349  
p
+2;

2350 
	}
}

2355 
	$ldbLogRedisRïly
(*
ª∂y
) {

2356 
sds
 
log
 = 
	`sd¢ew
("<reply> ");

2357 
	`ldbRedisPrŸocﬁToHum™
(&
log
,
ª∂y
);

2358 
	`ldbLogWôhMaxLí
(
log
);

2359 
	}
}

2364 
	$ldbPröt
(
lua_Sèã
 *
lua
, *
v¨«me
) {

2365 
lua_Debug
 
¨
;

2367 
l
 = 0;

2368 
	`lua_gë°ack
(
lua
,
l
,&
¨
) != 0) {

2369 
l
++;

2370 c⁄° *
«me
;

2371 
i
 = 1;

2372 (
«me
 = 
	`lua_gëloˇl
(
lua
,&
¨
,
i
)Ë!
NULL
) {

2373 
i
++;

2374 i‡(
	`°rcmp
(
v¨«me
,
«me
) == 0) {

2375 
	`ldbLogSèckVÆue
(
lua
,"<value> ");

2376 
	`lua_p›
(
lua
,1);

2379 
	`lua_p›
(
lua
,1);

2385 i‡(!
	`°rcmp
(
v¨«me
,"ARGV") || !strcmp(varname,"KEYS")) {

2386 
	`lua_gëglobÆ
(
lua
, 
v¨«me
);

2387 
	`ldbLogSèckVÆue
(
lua
,"<value> ");

2388 
	`lua_p›
(
lua
,1);

2390 
	`ldbLog
(
	`sd¢ew
("No such variable."));

2392 
	}
}

2396 
	$ldbPrötAŒ
(
lua_Sèã
 *
lua
) {

2397 
lua_Debug
 
¨
;

2398 
v¨s
 = 0;

2400 i‡(
	`lua_gë°ack
(
lua
,0,&
¨
) != 0) {

2401 c⁄° *
«me
;

2402 
i
 = 1;

2403 (
«me
 = 
	`lua_gëloˇl
(
lua
,&
¨
,
i
)Ë!
NULL
) {

2404 
i
++;

2405 i‡(!
	`°r°r
(
«me
,"(*temporary)")) {

2406 
sds
 
¥efix
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"<vÆue> %†",
«me
);

2407 
	`ldbLogSèckVÆue
(
lua
,
¥efix
);

2408 
	`sds‰ì
(
¥efix
);

2409 
v¨s
++;

2411 
	`lua_p›
(
lua
,1);

2415 i‡(
v¨s
 == 0) {

2416 
	`ldbLog
(
	`sd¢ew
("NoÜocal variables inÅhe current context."));

2418 
	}
}

2421 
	$ldbBªak
(
sds
 *
¨gv
, 
¨gc
) {

2422 i‡(
¨gc
 == 1) {

2423 i‡(
ldb
.
bpcou¡
 == 0) {

2424 
	`ldbLog
(
	`sd¢ew
("No breakpoints set. Use 'b <line>'Åoádd one."));

2427 
	`ldbLog
(
	`sdsˇtfmt
(
	`sd£m±y
(),"%òbªakpoöt†£t:",
ldb
.
bpcou¡
));

2428 
j
;

2429 
j
 = 0; j < 
ldb
.
bpcou¡
; j++)

2430 
	`ldbLogSour˚Löe
(
ldb
.
bp
[
j
]);

2433 
j
;

2434 
j
 = 1; j < 
¨gc
; j++) {

2435 *
¨g
 = 
¨gv
[
j
];

2436 
löe
;

2437 i‡(!
	`°rög2l
(
¨g
,
	`sd¶í
◊rg),&
löe
)) {

2438 
	`ldbLog
(
	`sdsˇtfmt
(
	`sd£m±y
(),"InvÆidárgumít:'%s'",
¨g
));

2440 i‡(
löe
 == 0) {

2441 
ldb
.
bpcou¡
 = 0;

2442 
	`ldbLog
(
	`sd¢ew
("All breakpointsÑemoved."));

2443 } i‡(
löe
 > 0) {

2444 i‡(
ldb
.
bpcou¡
 =
LDB_BREAKPOINTS_MAX
) {

2445 
	`ldbLog
(
	`sd¢ew
("Too many breakpoints set."));

2446 } i‡(
	`ldbAddBªakpoöt
(
löe
)) {

2447 
	`ldbLi°
(
löe
,1);

2449 
	`ldbLog
(
	`sd¢ew
("WrongÜineÇumber."));

2451 } i‡(
löe
 < 0) {

2452 i‡(
	`ldbDñBªakpoöt
(-
löe
))

2453 
	`ldbLog
(
	`sd¢ew
("BreakpointÑemoved."));

2455 
	`ldbLog
(
	`sd¢ew
("No breakpoint inÅhe specifiedÜine."));

2460 
	}
}

2465 
	$ldbEvÆ
(
lua_Sèã
 *
lua
, 
sds
 *
¨gv
, 
¨gc
) {

2467 
sds
 
code
 = 
	`sdsjoösds
(
¨gv
+1,
¨gc
-1," ",1);

2468 
sds
 
ex¥
 = 
	`sdsˇtsds
(
	`sd¢ew
("ªtu∫ "),
code
);

2471 i‡(
	`luaL_lﬂdbuf„r
(
lua
,
ex¥
,
	`sd¶í
(expr),"@ldb_eval")) {

2472 
	`lua_p›
(
lua
,1);

2474 i‡(
	`luaL_lﬂdbuf„r
(
lua
,
code
,
	`sd¶í
(code),"@ldb_eval")) {

2475 
	`ldbLog
(
	`sdsˇtfmt
(
	`sd£m±y
(),"<îr‹> %s",
	`lua_to°rög
(
lua
,-1)));

2476 
	`lua_p›
(
lua
,1);

2477 
	`sds‰ì
(
code
);

2478 
	`sds‰ì
(
ex¥
);

2484 
	`sds‰ì
(
code
);

2485 
	`sds‰ì
(
ex¥
);

2486 i‡(
	`lua_pˇŒ
(
lua
,0,1,0)) {

2487 
	`ldbLog
(
	`sdsˇtfmt
(
	`sd£m±y
(),"<îr‹> %s",
	`lua_to°rög
(
lua
,-1)));

2488 
	`lua_p›
(
lua
,1);

2491 
	`ldbLogSèckVÆue
(
lua
,"<retval> ");

2492 
	`lua_p›
(
lua
,1);

2493 
	}
}

2499 
	$ldbRedis
(
lua_Sèã
 *
lua
, 
sds
 *
¨gv
, 
¨gc
) {

2500 
j
, 
ßved_rc
 = 
£rvî
.
lua_ª∂iˇã_comm™ds
;

2502 
	`lua_gëglobÆ
(
lua
,"redis");

2503 
	`lua_push°rög
(
lua
,"call");

2504 
	`lua_gëèbÀ
(
lua
,-2);

2505 
j
 = 1; j < 
¨gc
; j++)

2506 
	`lua_pushl°rög
(
lua
,
¨gv
[
j
],
	`sd¶í
(argv[j]));

2507 
ldb
.
°ï
 = 1;

2508 
£rvî
.
lua_ª∂iˇã_comm™ds
 = 1;

2509 
	`lua_pˇŒ
(
lua
,
¨gc
-1,1,0);

2510 
ldb
.
°ï
 = 0;

2511 
£rvî
.
lua_ª∂iˇã_comm™ds
 = 
ßved_rc
;

2512 
	`lua_p›
(
lua
,2);

2513 
	}
}

2517 
	$ldbTø˚
(
lua_Sèã
 *
lua
) {

2518 
lua_Debug
 
¨
;

2519 
Àvñ
 = 0;

2521 
	`lua_gë°ack
(
lua
,
Àvñ
,&
¨
)) {

2522 
	`lua_gëöfo
(
lua
,"S∆",&
¨
);

2523 if(
	`°r°r
(
¨
.
sh‹t_§c
,"u£r_s¸ùt"Ë!
NULL
) {

2524 
	`ldbLog
(
	`sdsˇçrötf
(
	`sd£m±y
(),"%s %s:",

2525 (
Àvñ
 == 0) ? "In" : "From",

2526 
¨
.
«me
 ?ár.name : "topÜevel"));

2527 
	`ldbLogSour˚Löe
(
¨
.
cuºíéöe
);

2529 
Àvñ
++;

2531 i‡(
Àvñ
 == 0) {

2532 
	`ldbLog
(
	`sd¢ew
("<error> Can'tÑetrieve Lua stack."));

2534 
	}
}

2538 
	$ldbMaxÀn
(
sds
 *
¨gv
, 
¨gc
) {

2539 i‡(
¨gc
 == 2) {

2540 
√wvÆ
 = 
	`©oi
(
¨gv
[1]);

2541 
ldb
.
maxÀn_höt_£¡
 = 1;

2542 i‡(
√wvÆ
 != 0 &&Çewval <= 60)Çewval = 60;

2543 
ldb
.
maxÀn
 = 
√wvÆ
;

2545 i‡(
ldb
.
maxÀn
) {

2546 
	`ldbLog
(
	`sdsˇçrötf
(
	`sd£m±y
(),"<vÆue>Ñïlõ†¨êåunˇãdáà%d byãs.",()
ldb
.
maxÀn
));

2548 
	`ldbLog
(
	`sdsˇçrötf
(
	`sd£m±y
(),"<value>Ñepliesáre unlimited."));

2550 
	}
}

2555 
	$ldbRïl
(
lua_Sèã
 *
lua
) {

2556 
sds
 *
¨gv
;

2557 
¨gc
;

2562 (
¨gv
 = 
	`ldbRïlP¨£Comm™d
(&
¨gc
)Ë=
NULL
) {

2563 
buf
[1024];

2564 
ƒód
 = 
	`c⁄nRód
(
ldb
.
c⁄n
,
buf
,(buf));

2565 i‡(
ƒód
 <= 0) {

2568 
ldb
.
°ï
 = 0;

2569 
ldb
.
bpcou¡
 = 0;

2570  
C_ERR
;

2572 
ldb
.
cbuf
 = 
	`sdsˇéí
÷db.cbuf,
buf
,
ƒód
);

2576 
	`sds‰ì
(
ldb
.
cbuf
);

2577 
ldb
.
cbuf
 = 
	`sd£m±y
();

2580 i‡(!
	`°rˇ£cmp
(
¨gv
[0],"h") || !strcasecmp(argv[0],"help")) {

2581 
	`ldbLog
(
	`sd¢ew
("Redis Lua debugger help:"));

2582 
	`ldbLog
(
	`sd¢ew
("[h]elp ShowÅhis help."));

2583 
	`ldbLog
(
	`sd¢ew
("[s]tep Run currentÜineánd stopágain."));

2584 
	`ldbLog
(
	`sd¢ew
("[n]ext Alias for step."));

2585 
	`ldbLog
(
	`sd¢ew
("[c]continue RunÅillÇext breakpoint."));

2586 
	`ldbLog
(
	`sd¢ew
("[l]list List source codeáround currentÜine."));

2587 
	`ldbLog
(
	`sd¢ew
("[l]list [line] List source codeáround [line]."));

2588 
	`ldbLog
(
	`sd¢ew
("Üine = 0 means: currentÖosition."));

2589 
	`ldbLog
(
	`sd¢ew
("[l]list [line] [ctx] InÅhis form [ctx] specifies how manyÜines"));

2590 
	`ldbLog
(
	`sd¢ew
("Åo show before/after [line]."));

2591 
	`ldbLog
(
	`sd¢ew
("[w]hole Listáll source code. Alias for 'list 1 1000000'."));

2592 
	`ldbLog
(
	`sd¢ew
("[p]rint ShowállÅheÜocal variables."));

2593 
	`ldbLog
(
	`sd¢ew
("[p]rint <var> ShowÅhe value ofÅhe specified variable."));

2594 
	`ldbLog
(
	`sd¢ew
(" Canálso show global vars KEYSánd ARGV."));

2595 
	`ldbLog
(
	`sd¢ew
("[b]reak Showáll breakpoints."));

2596 
	`ldbLog
(
	`sd¢ew
("[b]reak <line> Addá breakpointÅoÅhe specifiedÜine."));

2597 
	`ldbLog
(
	`sd¢ew
("[b]reak -<line> Remove breakpoint fromÅhe specifiedÜine."));

2598 
	`ldbLog
(
	`sd¢ew
("[b]reak 0 Removeáll breakpoints."));

2599 
	`ldbLog
(
	`sd¢ew
("[t]race Showá backtrace."));

2600 
	`ldbLog
(
	`sd¢ew
("[e]eval <code> Execute some Lua code (iná different callframe)."));

2601 
	`ldbLog
(
	`sd¢ew
("[r]edis <cmd> Executeá Redis command."));

2602 
	`ldbLog
(
	`sd¢ew
("[m]axlen [len] TrimÜogged RedisÑepliesánd Lua var dumpsÅoÜen."));

2603 
	`ldbLog
(
	`sd¢ew
(" Specifying zeroás <len> means unlimited."));

2604 
	`ldbLog
(
	`sd¢ew
("[a]bort StopÅheÉxecution ofÅhe script. In sync"));

2605 
	`ldbLog
(
	`sd¢ew
(" mode dataset changes will beÑetained."));

2606 
	`ldbLog
(
	`sd¢ew
(""));

2607 
	`ldbLog
(
	`sd¢ew
("Debugger functions you can call from Lua scripts:"));

2608 
	`ldbLog
(
	`sd¢ew
("redis.debug() ProduceÜogs inÅhe debugger console."));

2609 
	`ldbLog
(
	`sd¢ew
("redis.breakpoint() StopÉxecutionÜike ifÅhere wasá breakpoing."));

2610 
	`ldbLog
(
	`sd¢ew
(" inÅheÇextÜine of code."));

2611 
	`ldbSídLogs
();

2612 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"s") || !strcasecmp(argv[0],"step") ||

2613 !
	`°rˇ£cmp
(
¨gv
[0],"n") || !strcasecmp(argv[0],"next")) {

2614 
ldb
.
°ï
 = 1;

2616 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"c") || !strcasecmp(argv[0],"continue")){

2618 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"t") || !strcasecmp(argv[0],"trace")) {

2619 
	`ldbTø˚
(
lua
);

2620 
	`ldbSídLogs
();

2621 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"m") || !strcasecmp(argv[0],"maxlen")) {

2622 
	`ldbMaxÀn
(
¨gv
,
¨gc
);

2623 
	`ldbSídLogs
();

2624 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"b") || !strcasecmp(argv[0],"break")) {

2625 
	`ldbBªak
(
¨gv
,
¨gc
);

2626 
	`ldbSídLogs
();

2627 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"e") || !strcasecmp(argv[0],"eval")) {

2628 
	`ldbEvÆ
(
lua
,
¨gv
,
¨gc
);

2629 
	`ldbSídLogs
();

2630 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"a") || !strcasecmp(argv[0],"abort")) {

2631 
	`lua_push°rög
(
lua
, "scriptáborted for userÑequest");

2632 
	`lua_îr‹
(
lua
);

2633 } i‡(
¨gc
 > 1 &&

2634 (!
	`°rˇ£cmp
(
¨gv
[0],"r") || !strcasecmp(argv[0],"redis"))) {

2635 
	`ldbRedis
(
lua
,
¨gv
,
¨gc
);

2636 
	`ldbSídLogs
();

2637 } i‡((!
	`°rˇ£cmp
(
¨gv
[0],"p") || !strcasecmp(argv[0],"print"))) {

2638 i‡(
¨gc
 == 2)

2639 
	`ldbPröt
(
lua
,
¨gv
[1]);

2641 
	`ldbPrötAŒ
(
lua
);

2642 
	`ldbSídLogs
();

2643 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"l") || !strcasecmp(argv[0],"list")){

2644 
¨ound
 = 
ldb
.
cuºíéöe
, 
˘x
 = 5;

2645 i‡(
¨gc
 > 1) {

2646 
num
 = 
	`©oi
(
¨gv
[1]);

2647 i‡(
num
 > 0Ë
¨ound
 =Çum;

2649 i‡(
¨gc
 > 2Ë
˘x
 = 
	`©oi
(
¨gv
[2]);

2650 
	`ldbLi°
(
¨ound
,
˘x
);

2651 
	`ldbSídLogs
();

2652 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"w") || !strcasecmp(argv[0],"whole")){

2653 
	`ldbLi°
(1,1000000);

2654 
	`ldbSídLogs
();

2656 
	`ldbLog
(
	`sd¢ew
("<error> Unknown Redis Lua debugger command or "

2658 
	`ldbSídLogs
();

2662 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

2666 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

2667  
C_OK
;

2668 
	}
}

2672 
	$luaLdbLöeHook
(
lua_Sèã
 *
lua
, 
lua_Debug
 *
¨
) {

2673 
	`lua_gë°ack
(
lua
,0,
¨
);

2674 
	`lua_gëöfo
(
lua
,"Sl",
¨
);

2675 
ldb
.
cuºíéöe
 = 
¨
->currentline;

2677 
bp
 = 
	`ldbIsBªakpoöt
(
ldb
.
cuºíéöe
Ë||Üdb.
luabp
;

2678 
timeout
 = 0;

2681 if(
	`°r°r
(
¨
->
sh‹t_§c
,"u£r_s¸ùt"Ë=
NULL
) ;

2684 i‡(
¨
->
evít
 =
LUA_HOOKCOUNT
 && 
ldb
.
°ï
 =0 && 
bp
 == 0) {

2685 
m°ime_t
 
ñ≠£d
 = 
	`m°ime
(Ë- 
£rvî
.
lua_time_°¨t
;

2686 
m°ime_t
 
timñimô
 = 
£rvî
.
lua_time_limô
 ?

2687 
£rvî
.
lua_time_limô
 : 5000;

2688 i‡(
ñ≠£d
 >
timñimô
) {

2689 
timeout
 = 1;

2690 
ldb
.
°ï
 = 1;

2696 i‡(
ldb
.
°ï
 || 
bp
) {

2697 *
ªas⁄
 = "step over";

2698 i‡(
bp
Ë
ªas⁄
 = 
ldb
.
luabp
 ? "redis.breakpoint() called" :

2700 i‡(
timeout
Ë
ªas⁄
 = "timeoutÑeached, infiniteÜoop?";

2701 
ldb
.
°ï
 = 0;

2702 
ldb
.
luabp
 = 0;

2703 
	`ldbLog
(
	`sdsˇçrötf
(
	`sd£m±y
(),

2705 
ldb
.
cuºíéöe
, 
ªas⁄
));

2706 
	`ldbLogSour˚Löe
(
ldb
.
cuºíéöe
);

2707 
	`ldbSídLogs
();

2708 i‡(
	`ldbRïl
(
lua
Ë=
C_ERR
 && 
timeout
) {

2712 
	`lua_push°rög
(
lua
, "timeout during Lua debugging with client closing connection");

2713 
	`lua_îr‹
(
lua
);

2715 
£rvî
.
lua_time_°¨t
 = 
	`m°ime
();

2717 
	}
}

	@sds.c

33 
	~<°dio.h
>

34 
	~<°dlib.h
>

35 
	~<°rög.h
>

36 
	~<˘y≥.h
>

37 
	~<as£π.h
>

38 
	~<limôs.h
>

39 
	~"sds.h
"

40 
	~"sdßŒoc.h
"

42 c⁄° *
	gSDS_NOINIT
 = "SDS_NOINIT";

44 
ölöe
 
	$sdsHdrSize
(
ty≥
) {

45 
ty≥
&
SDS_TYPE_MASK
) {

46 
SDS_TYPE_5
:

47  (
sdshdr5
);

48 
SDS_TYPE_8
:

49  (
sdshdr8
);

50 
SDS_TYPE_16
:

51  (
sdshdr16
);

52 
SDS_TYPE_32
:

53  (
sdshdr32
);

54 
SDS_TYPE_64
:

55  (
sdshdr64
);

58 
	}
}

60 
ölöe
 
	$sdsReqTy≥
(
size_t
 
°rög_size
) {

61 i‡(
°rög_size
 < 1<<5)

62  
SDS_TYPE_5
;

63 i‡(
°rög_size
 < 1<<8)

64  
SDS_TYPE_8
;

65 i‡(
°rög_size
 < 1<<16)

66  
SDS_TYPE_16
;

67 #i‡(
LONG_MAX
 =
LLONG_MAX
)

68 i‡(
°rög_size
 < 1ll<<32)

69  
SDS_TYPE_32
;

70  
SDS_TYPE_64
;

72  
SDS_TYPE_32
;

74 
	}
}

89 
sds
 
	$sd¢ewÀn
(c⁄° *
öô
, 
size_t
 
öôÀn
) {

90 *
sh
;

91 
sds
 
s
;

92 
ty≥
 = 
	`sdsReqTy≥
(
öôÀn
);

95 i‡(
ty≥
 =
SDS_TYPE_5
 && 
öôÀn
 =0Ëty≥ = 
SDS_TYPE_8
;

96 
hdæí
 = 
	`sdsHdrSize
(
ty≥
);

97 *
Â
;

99 
sh
 = 
	`s_mÆloc
(
hdæí
+
öôÀn
+1);

100 i‡(
sh
 =
NULL
)  NULL;

101 i‡(
öô
==
SDS_NOINIT
)

102 
öô
 = 
NULL
;

103 i‡(!
öô
)

104 
	`mem£t
(
sh
, 0, 
hdæí
+
öôÀn
+1);

105 
s
 = (*)
sh
+
hdæí
;

106 
Â
 = ((*)
s
)-1;

107 
ty≥
) {

108 
SDS_TYPE_5
: {

109 *
Â
 = 
ty≥
 | (
öôÀn
 << 
SDS_TYPE_BITS
);

112 
SDS_TYPE_8
: {

113 
	`SDS_HDR_VAR
(8,
s
);

114 
sh
->
Àn
 = 
öôÀn
;

115 
sh
->
Æloc
 = 
öôÀn
;

116 *
Â
 = 
ty≥
;

119 
SDS_TYPE_16
: {

120 
	`SDS_HDR_VAR
(16,
s
);

121 
sh
->
Àn
 = 
öôÀn
;

122 
sh
->
Æloc
 = 
öôÀn
;

123 *
Â
 = 
ty≥
;

126 
SDS_TYPE_32
: {

127 
	`SDS_HDR_VAR
(32,
s
);

128 
sh
->
Àn
 = 
öôÀn
;

129 
sh
->
Æloc
 = 
öôÀn
;

130 *
Â
 = 
ty≥
;

133 
SDS_TYPE_64
: {

134 
	`SDS_HDR_VAR
(64,
s
);

135 
sh
->
Àn
 = 
öôÀn
;

136 
sh
->
Æloc
 = 
öôÀn
;

137 *
Â
 = 
ty≥
;

141 i‡(
öôÀn
 && 
öô
)

142 
	`mem˝y
(
s
, 
öô
, 
öôÀn
);

143 
s
[
öôÀn
] = '\0';

144  
s
;

145 
	}
}

149 
sds
 
	$sd£m±y
() {

150  
	`sd¢ewÀn
("",0);

151 
	}
}

154 
sds
 
	$sd¢ew
(c⁄° *
öô
) {

155 
size_t
 
öôÀn
 = (
öô
 =
NULL
Ë? 0 : 
	`°æí
(init);

156  
	`sd¢ewÀn
(
öô
, 
öôÀn
);

157 
	}
}

160 
sds
 
	$sdsdup
(c⁄° 
sds
 
s
) {

161  
	`sd¢ewÀn
(
s
, 
	`sd¶í
(s));

162 
	}
}

165 
	$sds‰ì
(
sds
 
s
) {

166 i‡(
s
 =
NULL
) ;

167 
	`s_‰ì
((*)
s
-
	`sdsHdrSize
(s[-1]));

168 
	}
}

184 
	$sdsupd©ñí
(
sds
 
s
) {

185 
size_t
 
ªÆÀn
 = 
	`°æí
(
s
);

186 
	`sds£éí
(
s
, 
ªÆÀn
);

187 
	}
}

193 
	$sds˛ór
(
sds
 
s
) {

194 
	`sds£éí
(
s
, 0);

195 
s
[0] = '\0';

196 
	}
}

204 
sds
 
	$sdsMakeRoomF‹
(
sds
 
s
, 
size_t
 
addÀn
) {

205 *
sh
, *
√wsh
;

206 
size_t
 
avaû
 = 
	`sdßvaû
(
s
);

207 
size_t
 
Àn
, 
√wÀn
;

208 
ty≥
, 
ﬁdty≥
 = 
s
[-1] & 
SDS_TYPE_MASK
;

209 
hdæí
;

212 i‡(
avaû
 >
addÀn
Ë 
s
;

214 
Àn
 = 
	`sd¶í
(
s
);

215 
sh
 = (*)
s
-
	`sdsHdrSize
(
ﬁdty≥
);

216 
√wÀn
 = (
Àn
+
addÀn
);

217 i‡(
√wÀn
 < 
SDS_MAX_PREALLOC
)

218 
√wÀn
 *= 2;

220 
√wÀn
 +
SDS_MAX_PREALLOC
;

222 
ty≥
 = 
	`sdsReqTy≥
(
√wÀn
);

227 i‡(
ty≥
 =
SDS_TYPE_5
Ëty≥ = 
SDS_TYPE_8
;

229 
hdæí
 = 
	`sdsHdrSize
(
ty≥
);

230 i‡(
ﬁdty≥
==
ty≥
) {

231 
√wsh
 = 
	`s_ªÆloc
(
sh
, 
hdæí
+
√wÀn
+1);

232 i‡(
√wsh
 =
NULL
)  NULL;

233 
s
 = (*)
√wsh
+
hdæí
;

237 
√wsh
 = 
	`s_mÆloc
(
hdæí
+
√wÀn
+1);

238 i‡(
√wsh
 =
NULL
)  NULL;

239 
	`mem˝y
((*)
√wsh
+
hdæí
, 
s
, 
Àn
+1);

240 
	`s_‰ì
(
sh
);

241 
s
 = (*)
√wsh
+
hdæí
;

242 
s
[-1] = 
ty≥
;

243 
	`sds£éí
(
s
, 
Àn
);

245 
	`sds£èŒoc
(
s
, 
√wÀn
);

246  
s
;

247 
	}
}

255 
sds
 
	$sdsRemoveFªeS∑˚
(
sds
 
s
) {

256 *
sh
, *
√wsh
;

257 
ty≥
, 
ﬁdty≥
 = 
s
[-1] & 
SDS_TYPE_MASK
;

258 
hdæí
, 
ﬁdhdæí
 = 
	`sdsHdrSize
(
ﬁdty≥
);

259 
size_t
 
Àn
 = 
	`sd¶í
(
s
);

260 
size_t
 
avaû
 = 
	`sdßvaû
(
s
);

261 
sh
 = (*)
s
-
ﬁdhdæí
;

264 i‡(
avaû
 =0Ë 
s
;

268 
ty≥
 = 
	`sdsReqTy≥
(
Àn
);

269 
hdæí
 = 
	`sdsHdrSize
(
ty≥
);

275 i‡(
ﬁdty≥
==
ty≥
 ||Åy≥ > 
SDS_TYPE_8
) {

276 
√wsh
 = 
	`s_ªÆloc
(
sh
, 
ﬁdhdæí
+
Àn
+1);

277 i‡(
√wsh
 =
NULL
)  NULL;

278 
s
 = (*)
√wsh
+
ﬁdhdæí
;

280 
√wsh
 = 
	`s_mÆloc
(
hdæí
+
Àn
+1);

281 i‡(
√wsh
 =
NULL
)  NULL;

282 
	`mem˝y
((*)
√wsh
+
hdæí
, 
s
, 
Àn
+1);

283 
	`s_‰ì
(
sh
);

284 
s
 = (*)
√wsh
+
hdæí
;

285 
s
[-1] = 
ty≥
;

286 
	`sds£éí
(
s
, 
Àn
);

288 
	`sds£èŒoc
(
s
, 
Àn
);

289  
s
;

290 
	}
}

299 
size_t
 
	$sdsAŒocSize
(
sds
 
s
) {

300 
size_t
 
Æloc
 = 
	`sdßŒoc
(
s
);

301  
	`sdsHdrSize
(
s
[-1])+
Æloc
+1;

302 
	}
}

306 *
	$sdsAŒocPå
(
sds
 
s
) {

307  (*Ë(
s
-
	`sdsHdrSize
(s[-1]));

308 
	}
}

333 
	$sdsIn¸Lí
(
sds
 
s
, 
ssize_t
 
ö¸
) {

334 
Êags
 = 
s
[-1];

335 
size_t
 
Àn
;

336 
Êags
&
SDS_TYPE_MASK
) {

337 
SDS_TYPE_5
: {

338 *
Â
 = ((*)
s
)-1;

339 
ﬁdÀn
 = 
	`SDS_TYPE_5_LEN
(
Êags
);

340 
	`as£π
((
ö¸
 > 0 && 
ﬁdÀn
+incr < 32) || (incr < 0 && oldlen >= ()(-incr)));

341 *
Â
 = 
SDS_TYPE_5
 | ((
ﬁdÀn
+
ö¸
Ë<< 
SDS_TYPE_BITS
);

342 
Àn
 = 
ﬁdÀn
+
ö¸
;

345 
SDS_TYPE_8
: {

346 
	`SDS_HDR_VAR
(8,
s
);

347 
	`as£π
((
ö¸
 >0 && 
sh
->
Æloc
-sh->
Àn
 >= incr) || (incr < 0 && sh->len >= ()(-incr)));

348 
Àn
 = (
sh
->À¿+
ö¸
);

351 
SDS_TYPE_16
: {

352 
	`SDS_HDR_VAR
(16,
s
);

353 
	`as£π
((
ö¸
 >0 && 
sh
->
Æloc
-sh->
Àn
 >= incr) || (incr < 0 && sh->len >= ()(-incr)));

354 
Àn
 = (
sh
->À¿+
ö¸
);

357 
SDS_TYPE_32
: {

358 
	`SDS_HDR_VAR
(32,
s
);

359 
	`as£π
((
ö¸
 >0 && 
sh
->
Æloc
-sh->
Àn
 >= ()incr) || (incr < 0 && sh->len >= ()(-incr)));

360 
Àn
 = (
sh
->À¿+
ö¸
);

363 
SDS_TYPE_64
: {

364 
	`SDS_HDR_VAR
(64,
s
);

365 
	`as£π
((
ö¸
 >0 && 
sh
->
Æloc
-sh->
Àn
 >(
uöt64_t
)incr) || (incr < 0 && sh->len >= (uint64_t)(-incr)));

366 
Àn
 = (
sh
->À¿+
ö¸
);

369 : 
Àn
 = 0;

371 
s
[
Àn
] = '\0';

372 
	}
}

379 
sds
 
	$sdsgrowzîo
(
sds
 
s
, 
size_t
 
Àn
) {

380 
size_t
 
cuæí
 = 
	`sd¶í
(
s
);

382 i‡(
Àn
 <
cuæí
Ë 
s
;

383 
s
 = 
	`sdsMakeRoomF‹
(s,
Àn
-
cuæí
);

384 i‡(
s
 =
NULL
)  NULL;

387 
	`mem£t
(
s
+
cuæí
,0,(
Àn
-curlen+1));

388 
	`sds£éí
(
s
, 
Àn
);

389  
s
;

390 
	}
}

397 
sds
 
	$sdsˇéí
(
sds
 
s
, c⁄° *
t
, 
size_t
 
Àn
) {

398 
size_t
 
cuæí
 = 
	`sd¶í
(
s
);

400 
s
 = 
	`sdsMakeRoomF‹
(s,
Àn
);

401 i‡(
s
 =
NULL
)  NULL;

402 
	`mem˝y
(
s
+
cuæí
, 
t
, 
Àn
);

403 
	`sds£éí
(
s
, 
cuæí
+
Àn
);

404 
s
[
cuæí
+
Àn
] = '\0';

405  
s
;

406 
	}
}

412 
sds
 
	$sdsˇt
(
sds
 
s
, c⁄° *
t
) {

413  
	`sdsˇéí
(
s
, 
t
, 
	`°æí
(t));

414 
	}
}

420 
sds
 
	$sdsˇtsds
(
sds
 
s
, c⁄° sd†
t
) {

421  
	`sdsˇéí
(
s
, 
t
, 
	`sd¶í
(t));

422 
	}
}

426 
sds
 
	$sds˝yÀn
(
sds
 
s
, c⁄° *
t
, 
size_t
 
Àn
) {

427 i‡(
	`sdßŒoc
(
s
Ë< 
Àn
) {

428 
s
 = 
	`sdsMakeRoomF‹
(s,
Àn
-
	`sd¶í
(s));

429 i‡(
s
 =
NULL
)  NULL;

431 
	`mem˝y
(
s
, 
t
, 
Àn
);

432 
s
[
Àn
] = '\0';

433 
	`sds£éí
(
s
, 
Àn
);

434  
s
;

435 
	}
}

439 
sds
 
	$sds˝y
(
sds
 
s
, c⁄° *
t
) {

440  
	`sds˝yÀn
(
s
, 
t
, 
	`°æí
(t));

441 
	}
}

449 
	#SDS_LLSTR_SIZE
 21

	)

450 
	$sd¶l2°r
(*
s
, 
vÆue
) {

451 *
p
, 
aux
;

452 
v
;

453 
size_t
 
l
;

457 
v
 = (
vÆue
 < 0) ? -value : value;

458 
p
 = 
s
;

460 *
p
++ = '0'+(
v
%10);

461 
v
 /= 10;

462 } 
v
);

463 i‡(
vÆue
 < 0Ë*
p
++ = '-';

466 
l
 = 
p
-
s
;

467 *
p
 = '\0';

470 
p
--;

471 
s
 < 
p
) {

472 
aux
 = *
s
;

473 *
s
 = *
p
;

474 *
p
 = 
aux
;

475 
s
++;

476 
p
--;

478  
l
;

479 
	}
}

482 
	$sdsuŒ2°r
(*
s
, 
v
) {

483 *
p
, 
aux
;

484 
size_t
 
l
;

488 
p
 = 
s
;

490 *
p
++ = '0'+(
v
%10);

491 
v
 /= 10;

492 } 
v
);

495 
l
 = 
p
-
s
;

496 *
p
 = '\0';

499 
p
--;

500 
s
 < 
p
) {

501 
aux
 = *
s
;

502 *
s
 = *
p
;

503 *
p
 = 
aux
;

504 
s
++;

505 
p
--;

507  
l
;

508 
	}
}

514 
sds
 
	$sds‰oml⁄gl⁄g
(
vÆue
) {

515 
buf
[
SDS_LLSTR_SIZE
];

516 
Àn
 = 
	`sd¶l2°r
(
buf
,
vÆue
);

518  
	`sd¢ewÀn
(
buf
,
Àn
);

519 
	}
}

522 
sds
 
	$sdsˇtv¥ötf
(
sds
 
s
, c⁄° *
fmt
, 
va_li°
 
≠
) {

523 
va_li°
 
˝y
;

524 
°©icbuf
[1024], *
buf
 = sèticbuf, *
t
;

525 
size_t
 
buÊí
 = 
	`°æí
(
fmt
)*2;

529 i‡(
buÊí
 > (
°©icbuf
)) {

530 
buf
 = 
	`s_mÆloc
(
buÊí
);

531 i‡(
buf
 =
NULL
)  NULL;

533 
buÊí
 = (
°©icbuf
);

539 
buf
[
buÊí
-2] = '\0';

540 
	`va_c›y
(
˝y
,
≠
);

541 
	`v¢¥ötf
(
buf
, 
buÊí
, 
fmt
, 
˝y
);

542 
	`va_íd
(
˝y
);

543 i‡(
buf
[
buÊí
-2] != '\0') {

544 i‡(
buf
 !
°©icbuf
Ë
	`s_‰ì
(buf);

545 
buÊí
 *= 2;

546 
buf
 = 
	`s_mÆloc
(
buÊí
);

547 i‡(
buf
 =
NULL
)  NULL;

554 
t
 = 
	`sdsˇt
(
s
, 
buf
);

555 i‡(
buf
 !
°©icbuf
Ë
	`s_‰ì
(buf);

556  
t
;

557 
	}
}

575 
sds
 
	$sdsˇçrötf
(
sds
 
s
, c⁄° *
fmt
, ...) {

576 
va_li°
 
≠
;

577 *
t
;

578 
	`va_°¨t
(
≠
, 
fmt
);

579 
t
 = 
	`sdsˇtv¥ötf
(
s
,
fmt
,
≠
);

580 
	`va_íd
(
≠
);

581  
t
;

582 
	}
}

600 
sds
 
	$sdsˇtfmt
(
sds
 
s
, c⁄° *
fmt
, ...) {

601 
size_t
 
öôÀn
 = 
	`sd¶í
(
s
);

602 c⁄° *
f
 = 
fmt
;

603 
i
;

604 
va_li°
 
≠
;

609 
s
 = 
	`sdsMakeRoomF‹
(s, 
öôÀn
 + 
	`°æí
(
fmt
)*2);

610 
	`va_°¨t
(
≠
,
fmt
);

611 
f
 = 
fmt
;

612 
i
 = 
öôÀn
;

613 *
f
) {

614 
√xt
, *
°r
;

615 
size_t
 
l
;

616 
num
;

617 
unum
;

620 i‡(
	`sdßvaû
(
s
)==0) {

621 
s
 = 
	`sdsMakeRoomF‹
(s,1);

624 *
f
) {

626 
√xt
 = *(
f
+1);

627 
f
++;

628 
√xt
) {

631 
°r
 = 
	`va_¨g
(
≠
,*);

632 
l
 = (
√xt
 ='s'Ë? 
	`°æí
(
°r
Ë: 
	`sd¶í
(str);

633 i‡(
	`sdßvaû
(
s
Ë< 
l
) {

634 
s
 = 
	`sdsMakeRoomF‹
(s,
l
);

636 
	`mem˝y
(
s
+
i
,
°r
,
l
);

637 
	`sdsö˛í
(
s
,
l
);

638 
i
 +
l
;

642 i‡(
√xt
 == 'i')

643 
num
 = 
	`va_¨g
(
≠
,);

645 
num
 = 
	`va_¨g
(
≠
,);

647 
buf
[
SDS_LLSTR_SIZE
];

648 
l
 = 
	`sd¶l2°r
(
buf
,
num
);

649 i‡(
	`sdßvaû
(
s
Ë< 
l
) {

650 
s
 = 
	`sdsMakeRoomF‹
(s,
l
);

652 
	`mem˝y
(
s
+
i
,
buf
,
l
);

653 
	`sdsö˛í
(
s
,
l
);

654 
i
 +
l
;

659 i‡(
√xt
 == 'u')

660 
unum
 = 
	`va_¨g
(
≠
,);

662 
unum
 = 
	`va_¨g
(
≠
,);

664 
buf
[
SDS_LLSTR_SIZE
];

665 
l
 = 
	`sdsuŒ2°r
(
buf
,
unum
);

666 i‡(
	`sdßvaû
(
s
Ë< 
l
) {

667 
s
 = 
	`sdsMakeRoomF‹
(s,
l
);

669 
	`mem˝y
(
s
+
i
,
buf
,
l
);

670 
	`sdsö˛í
(
s
,
l
);

671 
i
 +
l
;

675 
s
[
i
++] = 
√xt
;

676 
	`sdsö˛í
(
s
,1);

681 
s
[
i
++] = *
f
;

682 
	`sdsö˛í
(
s
,1);

685 
f
++;

687 
	`va_íd
(
≠
);

690 
s
[
i
] = '\0';

691  
s
;

692 
	}
}

708 
sds
 
	$sd°rim
(
sds
 
s
, c⁄° *
c£t
) {

709 *
°¨t
, *
íd
, *
•
, *
ï
;

710 
size_t
 
Àn
;

712 
•
 = 
°¨t
 = 
s
;

713 
ï
 = 
íd
 = 
s
+
	`sd¶í
(s)-1;

714 
•
 <
íd
 && 
	`°rchr
(
c£t
, *sp)) sp++;

715 
ï
 > 
•
 && 
	`°rchr
(
c£t
, *ep))Ép--;

716 
Àn
 = (
•
 > 
ï
) ? 0 : ((ep-sp)+1);

717 i‡(
s
 !
•
Ë
	`memmove
(s, sp, 
Àn
);

718 
s
[
Àn
] = '\0';

719 
	`sds£éí
(
s
,
Àn
);

720  
s
;

721 
	}
}

739 
	$sd§™ge
(
sds
 
s
, 
ssize_t
 
°¨t
, ssize_à
íd
) {

740 
size_t
 
√wÀn
, 
Àn
 = 
	`sd¶í
(
s
);

742 i‡(
Àn
 == 0) ;

743 i‡(
°¨t
 < 0) {

744 
°¨t
 = 
Àn
+start;

745 i‡(
°¨t
 < 0) start = 0;

747 i‡(
íd
 < 0) {

748 
íd
 = 
Àn
+end;

749 i‡(
íd
 < 0)Énd = 0;

751 
√wÀn
 = (
°¨t
 > 
íd
) ? 0 : (end-start)+1;

752 i‡(
√wÀn
 != 0) {

753 i‡(
°¨t
 >(
ssize_t
)
Àn
) {

754 
√wÀn
 = 0;

755 } i‡(
íd
 >(
ssize_t
)
Àn
) {

756 
íd
 = 
Àn
-1;

757 
√wÀn
 = (
°¨t
 > 
íd
) ? 0 : (end-start)+1;

760 
°¨t
 = 0;

762 i‡(
°¨t
 && 
√wÀn
Ë
	`memmove
(
s
, s+start,Çewlen);

763 
s
[
√wÀn
] = 0;

764 
	`sds£éí
(
s
,
√wÀn
);

765 
	}
}

768 
	$sd°ﬁowî
(
sds
 
s
) {

769 
size_t
 
Àn
 = 
	`sd¶í
(
s
), 
j
;

771 
j
 = 0; j < 
Àn
; j++Ë
s
[j] = 
	`tﬁowî
(s[j]);

772 
	}
}

775 
	$sd°ouµî
(
sds
 
s
) {

776 
size_t
 
Àn
 = 
	`sd¶í
(
s
), 
j
;

778 
j
 = 0; j < 
Àn
; j++Ë
s
[j] = 
	`touµî
(s[j]);

779 
	}
}

792 
	$sdscmp
(c⁄° 
sds
 
s1
, c⁄° sd†
s2
) {

793 
size_t
 
l1
, 
l2
, 
möÀn
;

794 
cmp
;

796 
l1
 = 
	`sd¶í
(
s1
);

797 
l2
 = 
	`sd¶í
(
s2
);

798 
möÀn
 = (
l1
 < 
l2
) ?Ü1 :Ü2;

799 
cmp
 = 
	`memcmp
(
s1
,
s2
,
möÀn
);

800 i‡(
cmp
 =0Ë 
l1
>
l2
? 1: (l1<l2? -1: 0);

801  
cmp
;

802 
	}
}

820 
sds
 *
	$sds•lôÀn
(c⁄° *
s
, 
ssize_t
 
Àn
, c⁄° *
£p
, 
£∂í
, *
cou¡
) {

821 
ñemíts
 = 0, 
¶Ÿs
 = 5;

822 
°¨t
 = 0, 
j
;

823 
sds
 *
tokís
;

825 i‡(
£∂í
 < 1 || 
Àn
 < 0Ë 
NULL
;

827 
tokís
 = 
	`s_mÆloc
((
sds
)*
¶Ÿs
);

828 i‡(
tokís
 =
NULL
)  NULL;

830 i‡(
Àn
 == 0) {

831 *
cou¡
 = 0;

832  
tokís
;

834 
j
 = 0; j < (
Àn
-(
£∂í
-1)); j++) {

836 i‡(
¶Ÿs
 < 
ñemíts
+2) {

837 
sds
 *
√wtokís
;

839 
¶Ÿs
 *= 2;

840 
√wtokís
 = 
	`s_ªÆloc
(
tokís
,(
sds
)*
¶Ÿs
);

841 i‡(
√wtokís
 =
NULL
Ë
˛ónup
;

842 
tokís
 = 
√wtokís
;

845 i‡((
£∂í
 =1 && *(
s
+
j
Ë=
£p
[0]Ë|| (
	`memcmp
(s+j,sep,seplen) == 0)) {

846 
tokís
[
ñemíts
] = 
	`sd¢ewÀn
(
s
+
°¨t
,
j
-start);

847 i‡(
tokís
[
ñemíts
] =
NULL
Ë
˛ónup
;

848 
ñemíts
++;

849 
°¨t
 = 
j
+
£∂í
;

850 
j
 = j+
£∂í
-1;

854 
tokís
[
ñemíts
] = 
	`sd¢ewÀn
(
s
+
°¨t
,
Àn
-start);

855 i‡(
tokís
[
ñemíts
] =
NULL
Ë
˛ónup
;

856 
ñemíts
++;

857 *
cou¡
 = 
ñemíts
;

858  
tokís
;

860 
˛ónup
:

862 
i
;

863 
i
 = 0; i < 
ñemíts
; i++Ë
	`sds‰ì
(
tokís
[i]);

864 
	`s_‰ì
(
tokís
);

865 *
cou¡
 = 0;

866  
NULL
;

868 
	}
}

871 
	$sds‰ì•lôªs
(
sds
 *
tokís
, 
cou¡
) {

872 i‡(!
tokís
) ;

873 
cou¡
--)

874 
	`sds‰ì
(
tokís
[
cou¡
]);

875 
	`s_‰ì
(
tokís
);

876 
	}
}

884 
sds
 
	$sdsˇåïr
(
sds
 
s
, c⁄° *
p
, 
size_t
 
Àn
) {

885 
s
 = 
	`sdsˇéí
(s,"\"",1);

886 
Àn
--) {

887 *
p
) {

890 
s
 = 
	`sdsˇçrötf
(s,"\\%c",*
p
);

892 '\n': 
s
 = 
	`sdsˇéí
(s,"\\n",2); ;

893 '\r': 
s
 = 
	`sdsˇéí
(s,"\\r",2); ;

894 '\t': 
s
 = 
	`sdsˇéí
(s,"\\t",2); ;

895 '\a': 
s
 = 
	`sdsˇéí
(s,"\\a",2); ;

896 '\b': 
s
 = 
	`sdsˇéí
(s,"\\b",2); ;

898 i‡(
	`i•röt
(*
p
))

899 
s
 = 
	`sdsˇçrötf
(s,"%c",*
p
);

901 
s
 = 
	`sdsˇçrötf
(s,"\\x%02x",()*
p
);

904 
p
++;

906  
	`sdsˇéí
(
s
,"\"",1);

907 
	}
}

911 
	$is_hex_digô
(
c
) {

912  (
c
 >= '0' && c <= '9') || (c >= 'a' && c <= 'f') ||

913 (
c
 >= 'A' && c <= 'F');

914 
	}
}

918 
	$hex_digô_to_öt
(
c
) {

919 
c
) {

938 
	}
}

959 
sds
 *
	$sds•lô¨gs
(c⁄° *
löe
, *
¨gc
) {

960 c⁄° *
p
 = 
löe
;

961 *
cuºít
 = 
NULL
;

962 **
ve˘‹
 = 
NULL
;

964 *
¨gc
 = 0;

967 *
p
 && 
	`is•a˚
(*p))Ö++;

968 i‡(*
p
) {

970 
öq
=0;

971 
ösq
=0;

972 
d⁄e
=0;

974 i‡(
cuºít
 =
NULL
Ëcuºíà
	`sd£m±y
();

975 !
d⁄e
) {

976 i‡(
öq
) {

977 i‡(*
p
 == '\\' && *(p+1) == 'x' &&

978 
	`is_hex_digô
(*(
p
+2)) &&

979 
	`is_hex_digô
(*(
p
+3)))

981 
byã
;

983 
byã
 = (
	`hex_digô_to_öt
(*(
p
+2))*16)+

984 
	`hex_digô_to_öt
(*(
p
+3));

985 
cuºít
 = 
	`sdsˇéí
(cuºít,(*)&
byã
,1);

986 
p
 += 3;

987 } i‡(*
p
 == '\\' && *(p+1)) {

988 
c
;

990 
p
++;

991 *
p
) {

992 'n': 
c
 = '\n'; ;

993 'r': 
c
 = '\r'; ;

994 't': 
c
 = '\t'; ;

995 'b': 
c
 = '\b'; ;

996 'a': 
c
 = '\a'; ;

997 : 
c
 = *
p
; ;

999 
cuºít
 = 
	`sdsˇéí
(cuºít,&
c
,1);

1000 } i‡(*
p
 == '"') {

1003 i‡(*(
p
+1Ë&& !
	`is•a˚
(*’+1))Ë
îr
;

1004 
d⁄e
=1;

1005 } i‡(!*
p
) {

1007 
îr
;

1009 
cuºít
 = 
	`sdsˇéí
(cuºít,
p
,1);

1011 } i‡(
ösq
) {

1012 i‡(*
p
 == '\\' && *(p+1) == '\'') {

1013 
p
++;

1014 
cuºít
 = 
	`sdsˇéí
(current,"'",1);

1015 } i‡(*
p
 == '\'') {

1018 i‡(*(
p
+1Ë&& !
	`is•a˚
(*’+1))Ë
îr
;

1019 
d⁄e
=1;

1020 } i‡(!*
p
) {

1022 
îr
;

1024 
cuºít
 = 
	`sdsˇéí
(cuºít,
p
,1);

1027 *
p
) {

1033 
d⁄e
=1;

1036 
öq
=1;

1039 
ösq
=1;

1042 
cuºít
 = 
	`sdsˇéí
(cuºít,
p
,1);

1046 i‡(*
p
)Ö++;

1049 
ve˘‹
 = 
	`s_ªÆloc
(ve˘‹,((*
¨gc
)+1)*(*));

1050 
ve˘‹
[*
¨gc
] = 
cuºít
;

1051 (*
¨gc
)++;

1052 
cuºít
 = 
NULL
;

1055 i‡(
ve˘‹
 =
NULL
Ëve˘‹ = 
	`s_mÆloc
((*));

1056  
ve˘‹
;

1060 
îr
:

1061 (*
¨gc
)--)

1062 
	`sds‰ì
(
ve˘‹
[*
¨gc
]);

1063 
	`s_‰ì
(
ve˘‹
);

1064 i‡(
cuºít
Ë
	`sds‰ì
(current);

1065 *
¨gc
 = 0;

1066  
NULL
;

1067 
	}
}

1078 
sds
 
	$sdsm≠ch¨s
(
sds
 
s
, c⁄° *
‰om
, c⁄° *
to
, 
size_t
 
£éí
) {

1079 
size_t
 
j
, 
i
, 
l
 = 
	`sd¶í
(
s
);

1081 
j
 = 0; j < 
l
; j++) {

1082 
i
 = 0; i < 
£éí
; i++) {

1083 i‡(
s
[
j
] =
‰om
[
i
]) {

1084 
s
[
j
] = 
to
[
i
];

1089  
s
;

1090 
	}
}

1094 
sds
 
	$sdsjoö
(**
¨gv
, 
¨gc
, *
£p
) {

1095 
sds
 
joö
 = 
	`sd£m±y
();

1096 
j
;

1098 
j
 = 0; j < 
¨gc
; j++) {

1099 
joö
 = 
	`sdsˇt
(joö, 
¨gv
[
j
]);

1100 i‡(
j
 !
¨gc
-1Ë
joö
 = 
	`sdsˇt
(joö,
£p
);

1102  
joö
;

1103 
	}
}

1106 
sds
 
	$sdsjoösds
(
sds
 *
¨gv
, 
¨gc
, c⁄° *
£p
, 
size_t
 
£∂í
) {

1107 
sds
 
joö
 = 
	`sd£m±y
();

1108 
j
;

1110 
j
 = 0; j < 
¨gc
; j++) {

1111 
joö
 = 
	`sdsˇtsds
(joö, 
¨gv
[
j
]);

1112 i‡(
j
 !
¨gc
-1Ë
joö
 = 
	`sdsˇéí
(joö,
£p
,
£∂í
);

1114  
joö
;

1115 
	}
}

1122 *
	$sds_mÆloc
(
size_t
 
size
Ë{  
	`s_mÆloc
(size); 
	}
}

1123 *
	$sds_ªÆloc
(*
±r
, 
size_t
 
size
Ë{  
	`s_ªÆloc
’å,size); 
	}
}

1124 
	$sds_‰ì
(*
±r
Ë{ 
	`s_‰ì
’å); 
	}
}

1126 #i‡
deföed
(
SDS_TEST_MAIN
)

1127 
	~<°dio.h
>

1128 
	~"ã°hñp.h
"

1129 
	~"limôs.h
"

1131 
	#UNUSED
(
x
Ë()(x)

	)

1132 
	$sdsTe°
() {

1134 
sds
 
x
 = 
	`sd¢ew
("foo"), 
y
;

1136 
	`ã°_c⁄d
("Createá stringánd obtainÅheÜength",

1137 
	`sd¶í
(
x
Ë=3 && 
	`memcmp
(x,"foo\0",4) == 0)

1139 
	`sds‰ì
(
x
);

1140 
x
 = 
	`sd¢ewÀn
("foo",2);

1141 
	`ã°_c⁄d
("Createá string with specifiedÜength",

1142 
	`sd¶í
(
x
Ë=2 && 
	`memcmp
(x,"fo\0",3) == 0)

1144 
x
 = 
	`sdsˇt
(x,"bar");

1145 
	`ã°_c⁄d
("Strings concatenation",

1146 
	`sd¶í
(
x
Ë=5 && 
	`memcmp
(x,"fobar\0",6) == 0);

1148 
x
 = 
	`sds˝y
(x,"a");

1149 
	`ã°_c⁄d
("sdscpy()ágainstán originallyÜonger string",

1150 
	`sd¶í
(
x
Ë=1 && 
	`memcmp
(x,"a\0",2) == 0)

1152 
x
 = 
	`sds˝y
(x,"xyzxxxxxxxxxxyyyyyyyyyykkkkkkkkkk");

1153 
	`ã°_c⁄d
("sdscpy()ágainstán originally shorter string",

1154 
	`sd¶í
(
x
) == 33 &&

1155 
	`memcmp
(
x
,"xyzxxxxxxxxxxyyyyyyyyyykkkkkkkkkk\0",33) == 0)

1157 
	`sds‰ì
(
x
);

1158 
x
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"%d",123);

1159 
	`ã°_c⁄d
("sdscatprintf() seems working inÅhe base case",

1160 
	`sd¶í
(
x
Ë=3 && 
	`memcmp
(x,"123\0",4) == 0)

1162 
	`sds‰ì
(
x
);

1163 
x
 = 
	`sd¢ew
("--");

1164 
x
 = 
	`sdsˇtfmt
(x, "Hñlÿ%†W‹ld %I,%I--", "Hi!", 
LLONG_MIN
,
LLONG_MAX
);

1165 
	`ã°_c⁄d
("sdscatfmt() seems working inÅhe base case",

1166 
	`sd¶í
(
x
) == 60 &&

1167 
	`memcmp
(
x
,"--Hello Hi! World -9223372036854775808,"

1169 
	`¥ötf
("[%s]\n",
x
);

1171 
	`sds‰ì
(
x
);

1172 
x
 = 
	`sd¢ew
("--");

1173 
x
 = 
	`sdsˇtfmt
(x, "%u,%U--", 
UINT_MAX
, 
ULLONG_MAX
);

1174 
	`ã°_c⁄d
("sdscatfmt() seems working with unsignedÇumbers",

1175 
	`sd¶í
(
x
) == 35 &&

1176 
	`memcmp
(
x
,"--4294967295,18446744073709551615--",35) == 0)

1178 
	`sds‰ì
(
x
);

1179 
x
 = 
	`sd¢ew
(" x ");

1180 
	`sd°rim
(
x
," x");

1181 
	`ã°_c⁄d
("sdstrim() works whenáll chars match",

1182 
	`sd¶í
(
x
) == 0)

1184 
	`sds‰ì
(
x
);

1185 
x
 = 
	`sd¢ew
(" x ");

1186 
	`sd°rim
(
x
," ");

1187 
	`ã°_c⁄d
("sdstrim() works whená single charÑemains",

1188 
	`sd¶í
(
x
) == 1 && x[0] == 'x')

1190 
	`sds‰ì
(
x
);

1191 
x
 = 
	`sd¢ew
("xxciaoyyy");

1192 
	`sd°rim
(
x
,"xy");

1193 
	`ã°_c⁄d
("sdstrim() correctlyÅrims characters",

1194 
	`sd¶í
(
x
Ë=4 && 
	`memcmp
(x,"ciao\0",5) == 0)

1196 
y
 = 
	`sdsdup
(
x
);

1197 
	`sd§™ge
(
y
,1,1);

1198 
	`ã°_c⁄d
("sdsrange(...,1,1)",

1199 
	`sd¶í
(
y
Ë=1 && 
	`memcmp
(y,"i\0",2) == 0)

1201 
	`sds‰ì
(
y
);

1202 
y
 = 
	`sdsdup
(
x
);

1203 
	`sd§™ge
(
y
,1,-1);

1204 
	`ã°_c⁄d
("sdsrange(...,1,-1)",

1205 
	`sd¶í
(
y
Ë=3 && 
	`memcmp
(y,"iao\0",4) == 0)

1207 
	`sds‰ì
(
y
);

1208 
y
 = 
	`sdsdup
(
x
);

1209 
	`sd§™ge
(
y
,-2,-1);

1210 
	`ã°_c⁄d
("sdsrange(...,-2,-1)",

1211 
	`sd¶í
(
y
Ë=2 && 
	`memcmp
(y,"ao\0",3) == 0)

1213 
	`sds‰ì
(
y
);

1214 
y
 = 
	`sdsdup
(
x
);

1215 
	`sd§™ge
(
y
,2,1);

1216 
	`ã°_c⁄d
("sdsrange(...,2,1)",

1217 
	`sd¶í
(
y
Ë=0 && 
	`memcmp
(y,"\0",1) == 0)

1219 
	`sds‰ì
(
y
);

1220 
y
 = 
	`sdsdup
(
x
);

1221 
	`sd§™ge
(
y
,1,100);

1222 
	`ã°_c⁄d
("sdsrange(...,1,100)",

1223 
	`sd¶í
(
y
Ë=3 && 
	`memcmp
(y,"iao\0",4) == 0)

1225 
	`sds‰ì
(
y
);

1226 
y
 = 
	`sdsdup
(
x
);

1227 
	`sd§™ge
(
y
,100,100);

1228 
	`ã°_c⁄d
("sdsrange(...,100,100)",

1229 
	`sd¶í
(
y
Ë=0 && 
	`memcmp
(y,"\0",1) == 0)

1231 
	`sds‰ì
(
y
);

1232 
	`sds‰ì
(
x
);

1233 
x
 = 
	`sd¢ew
("foo");

1234 
y
 = 
	`sd¢ew
("foa");

1235 
	`ã°_c⁄d
("sdscmp(foo,fﬂ)", 
	`sdscmp
(
x
,
y
) > 0)

1237 
	`sds‰ì
(
y
);

1238 
	`sds‰ì
(
x
);

1239 
x
 = 
	`sd¢ew
("bar");

1240 
y
 = 
	`sd¢ew
("bar");

1241 
	`ã°_c⁄d
("sdscmp(b¨,b¨)", 
	`sdscmp
(
x
,
y
) == 0)

1243 
	`sds‰ì
(
y
);

1244 
	`sds‰ì
(
x
);

1245 
x
 = 
	`sd¢ew
("aar");

1246 
y
 = 
	`sd¢ew
("bar");

1247 
	`ã°_c⁄d
("sdscmp(b¨,b¨)", 
	`sdscmp
(
x
,
y
) < 0)

1249 
	`sds‰ì
(
y
);

1250 
	`sds‰ì
(
x
);

1251 
x
 = 
	`sd¢ewÀn
("\a\n\0foo\r",7);

1252 
y
 = 
	`sdsˇåïr
(
	`sd£m±y
(),
x
,
	`sd¶í
(x));

1253 
	`ã°_c⁄d
("sdscatrepr(...data...)",

1254 
	`memcmp
(
y
,"\"\\a\\n\\x00foo\\r\"",15) == 0)

1257 
ﬁd‰ì
;

1258 *
p
;

1259 
°ï
 = 10, 
j
, 
i
;

1261 
	`sds‰ì
(
x
);

1262 
	`sds‰ì
(
y
);

1263 
x
 = 
	`sd¢ew
("0");

1264 
	`ã°_c⁄d
("sd¢ew(Ë‰ì/À¿buf„rs", 
	`sd¶í
(
x
Ë=1 && 
	`sdßvaû
(x) == 0);

1268 
i
 = 0; i < 10; i++) {

1269 
ﬁdÀn
 = 
	`sd¶í
(
x
);

1270 
x
 = 
	`sdsMakeRoomF‹
(x,
°ï
);

1271 
ty≥
 = 
x
[-1]&
SDS_TYPE_MASK
;

1273 
	`ã°_c⁄d
("sdsMakeRoomF‹(ËÀn", 
	`sd¶í
(
x
Ë=
ﬁdÀn
);

1274 i‡(
ty≥
 !
SDS_TYPE_5
) {

1275 
	`ã°_c⁄d
("sdsMakeRoomF‹(Ë‰ì", 
	`sdßvaû
(
x
Ë>
°ï
);

1276 
ﬁd‰ì
 = 
	`sdßvaû
(
x
);

1278 
p
 = 
x
+
ﬁdÀn
;

1279 
j
 = 0; j < 
°ï
; j++) {

1280 
p
[
j
] = 'A'+j;

1282 
	`sdsIn¸Lí
(
x
,
°ï
);

1284 
	`ã°_c⁄d
("sdsMakeRoomFor() content",

1285 
	`memcmp
("0ABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJ",
x
,101) == 0);

1286 
	`ã°_c⁄d
("sdsMakeRoomF‹(ËföÆÜígth",
	`sd¶í
(
x
)==101);

1288 
	`sds‰ì
(
x
);

1291 
	`ã°_ªp‹t
()

1293 
	}
}

1296 #ifde‡
SDS_TEST_MAIN


1297 
	$maö
() {

1298  
	`sdsTe°
();

1299 
	}
}

	@sds.h

33 #i‚de‡
__SDS_H


34 
	#__SDS_H


	)

36 
	#SDS_MAX_PREALLOC
 (1024*1024)

	)

37 c⁄° *
SDS_NOINIT
;

39 
	~<sys/ty≥s.h
>

40 
	~<°d¨g.h
>

41 
	~<°döt.h
>

43 *
	tsds
;

47 
__©åibuã__
 ((
__∑cked__
)Ë
	gsdshdr5
 {

48 
	gÊags
;

49 
	gbuf
[];

51 
__©åibuã__
 ((
__∑cked__
)Ë
	gsdshdr8
 {

52 
uöt8_t
 
	gÀn
;

53 
uöt8_t
 
	gÆloc
;

54 
	gÊags
;

55 
	gbuf
[];

57 
__©åibuã__
 ((
__∑cked__
)Ë
	gsdshdr16
 {

58 
uöt16_t
 
	gÀn
;

59 
uöt16_t
 
	gÆloc
;

60 
	gÊags
;

61 
	gbuf
[];

63 
__©åibuã__
 ((
__∑cked__
)Ë
	gsdshdr32
 {

64 
uöt32_t
 
	gÀn
;

65 
uöt32_t
 
	gÆloc
;

66 
	gÊags
;

67 
	gbuf
[];

69 
__©åibuã__
 ((
__∑cked__
)Ë
	gsdshdr64
 {

70 
uöt64_t
 
	gÀn
;

71 
uöt64_t
 
	gÆloc
;

72 
	gÊags
;

73 
	gbuf
[];

76 
	#SDS_TYPE_5
 0

	)

77 
	#SDS_TYPE_8
 1

	)

78 
	#SDS_TYPE_16
 2

	)

79 
	#SDS_TYPE_32
 3

	)

80 
	#SDS_TYPE_64
 4

	)

81 
	#SDS_TYPE_MASK
 7

	)

82 
	#SDS_TYPE_BITS
 3

	)

83 
	#SDS_HDR_VAR
(
T
,
s
Ë
sdshdr
##T *
sh
 = (*)((s)-((sdshdr##T)));

	)

84 
	#SDS_HDR
(
T
,
s
Ë((
sdshdr
##T *)((s)-((sdshdr##T))))

	)

85 
	#SDS_TYPE_5_LEN
(
f
Ë((f)>>
SDS_TYPE_BITS
)

	)

87 
ölöe
 
size_t
 
	$sd¶í
(c⁄° 
sds
 
s
) {

88 
Êags
 = 
s
[-1];

89 
Êags
&
SDS_TYPE_MASK
) {

90 
SDS_TYPE_5
:

91  
	`SDS_TYPE_5_LEN
(
Êags
);

92 
SDS_TYPE_8
:

93  
	`SDS_HDR
(8,
s
)->
Àn
;

94 
SDS_TYPE_16
:

95  
	`SDS_HDR
(16,
s
)->
Àn
;

96 
SDS_TYPE_32
:

97  
	`SDS_HDR
(32,
s
)->
Àn
;

98 
SDS_TYPE_64
:

99  
	`SDS_HDR
(64,
s
)->
Àn
;

102 
	}
}

104 
ölöe
 
size_t
 
	$sdßvaû
(c⁄° 
sds
 
s
) {

105 
Êags
 = 
s
[-1];

106 
Êags
&
SDS_TYPE_MASK
) {

107 
SDS_TYPE_5
: {

110 
SDS_TYPE_8
: {

111 
	`SDS_HDR_VAR
(8,
s
);

112  
sh
->
Æloc
 - sh->
Àn
;

114 
SDS_TYPE_16
: {

115 
	`SDS_HDR_VAR
(16,
s
);

116  
sh
->
Æloc
 - sh->
Àn
;

118 
SDS_TYPE_32
: {

119 
	`SDS_HDR_VAR
(32,
s
);

120  
sh
->
Æloc
 - sh->
Àn
;

122 
SDS_TYPE_64
: {

123 
	`SDS_HDR_VAR
(64,
s
);

124  
sh
->
Æloc
 - sh->
Àn
;

128 
	}
}

130 
ölöe
 
	$sds£éí
(
sds
 
s
, 
size_t
 
√wÀn
) {

131 
Êags
 = 
s
[-1];

132 
Êags
&
SDS_TYPE_MASK
) {

133 
SDS_TYPE_5
:

135 *
Â
 = ((*)
s
)-1;

136 *
Â
 = 
SDS_TYPE_5
 | (
√wÀn
 << 
SDS_TYPE_BITS
);

139 
SDS_TYPE_8
:

140 
	`SDS_HDR
(8,
s
)->
Àn
 = 
√wÀn
;

142 
SDS_TYPE_16
:

143 
	`SDS_HDR
(16,
s
)->
Àn
 = 
√wÀn
;

145 
SDS_TYPE_32
:

146 
	`SDS_HDR
(32,
s
)->
Àn
 = 
√wÀn
;

148 
SDS_TYPE_64
:

149 
	`SDS_HDR
(64,
s
)->
Àn
 = 
√wÀn
;

152 
	}
}

154 
ölöe
 
	$sdsö˛í
(
sds
 
s
, 
size_t
 
öc
) {

155 
Êags
 = 
s
[-1];

156 
Êags
&
SDS_TYPE_MASK
) {

157 
SDS_TYPE_5
:

159 *
Â
 = ((*)
s
)-1;

160 
√wÀn
 = 
	`SDS_TYPE_5_LEN
(
Êags
)+
öc
;

161 *
Â
 = 
SDS_TYPE_5
 | (
√wÀn
 << 
SDS_TYPE_BITS
);

164 
SDS_TYPE_8
:

165 
	`SDS_HDR
(8,
s
)->
Àn
 +
öc
;

167 
SDS_TYPE_16
:

168 
	`SDS_HDR
(16,
s
)->
Àn
 +
öc
;

170 
SDS_TYPE_32
:

171 
	`SDS_HDR
(32,
s
)->
Àn
 +
öc
;

173 
SDS_TYPE_64
:

174 
	`SDS_HDR
(64,
s
)->
Àn
 +
öc
;

177 
	}
}

180 
ölöe
 
size_t
 
	$sdßŒoc
(c⁄° 
sds
 
s
) {

181 
Êags
 = 
s
[-1];

182 
Êags
&
SDS_TYPE_MASK
) {

183 
SDS_TYPE_5
:

184  
	`SDS_TYPE_5_LEN
(
Êags
);

185 
SDS_TYPE_8
:

186  
	`SDS_HDR
(8,
s
)->
Æloc
;

187 
SDS_TYPE_16
:

188  
	`SDS_HDR
(16,
s
)->
Æloc
;

189 
SDS_TYPE_32
:

190  
	`SDS_HDR
(32,
s
)->
Æloc
;

191 
SDS_TYPE_64
:

192  
	`SDS_HDR
(64,
s
)->
Æloc
;

195 
	}
}

197 
ölöe
 
	$sds£èŒoc
(
sds
 
s
, 
size_t
 
√wÀn
) {

198 
Êags
 = 
s
[-1];

199 
Êags
&
SDS_TYPE_MASK
) {

200 
SDS_TYPE_5
:

203 
SDS_TYPE_8
:

204 
	`SDS_HDR
(8,
s
)->
Æloc
 = 
√wÀn
;

206 
SDS_TYPE_16
:

207 
	`SDS_HDR
(16,
s
)->
Æloc
 = 
√wÀn
;

209 
SDS_TYPE_32
:

210 
	`SDS_HDR
(32,
s
)->
Æloc
 = 
√wÀn
;

212 
SDS_TYPE_64
:

213 
	`SDS_HDR
(64,
s
)->
Æloc
 = 
√wÀn
;

216 
	}
}

218 
sds
 
sd¢ewÀn
(c⁄° *
öô
, 
size_t
 
öôÀn
);

219 
sds
 
sd¢ew
(c⁄° *
öô
);

220 
sds
 
sd£m±y
();

221 
sds
 
sdsdup
(c⁄° sd†
s
);

222 
sds‰ì
(
sds
 
s
);

223 
sds
 
sdsgrowzîo
(sd†
s
, 
size_t
 
Àn
);

224 
sds
 
sdsˇéí
(sd†
s
, c⁄° *
t
, 
size_t
 
Àn
);

225 
sds
 
sdsˇt
(sd†
s
, c⁄° *
t
);

226 
sds
 
sdsˇtsds
(sd†
s
, c⁄° sd†
t
);

227 
sds
 
sds˝yÀn
(sd†
s
, c⁄° *
t
, 
size_t
 
Àn
);

228 
sds
 
sds˝y
(sd†
s
, c⁄° *
t
);

230 
sds
 
sdsˇtv¥ötf
(sd†
s
, c⁄° *
fmt
, 
va_li°
 
≠
);

231 #ifde‡
__GNUC__


232 
sds
 
	$sdsˇçrötf
(
sds
 
s
, c⁄° *
fmt
, ...)

233 
	`__©åibuã__
((
	`f‹m©
(
¥ötf
, 2, 3)));

235 
sds
 
	`sdsˇçrötf
(sd†
s
, c⁄° *
fmt
, ...);

238 
sds
 
	`sdsˇtfmt
(sd†
s
, c⁄° *
fmt
, ...);

239 
sds
 
	`sd°rim
(sd†
s
, c⁄° *
c£t
);

240 
	`sd§™ge
(
sds
 
s
, 
ssize_t
 
°¨t
, ssize_à
íd
);

241 
	`sdsupd©ñí
(
sds
 
s
);

242 
	`sds˛ór
(
sds
 
s
);

243 
	`sdscmp
(c⁄° 
sds
 
s1
, c⁄° sd†
s2
);

244 
sds
 *
	`sds•lôÀn
(c⁄° *
s
, 
ssize_t
 
Àn
, c⁄° *
£p
, 
£∂í
, *
cou¡
);

245 
	`sds‰ì•lôªs
(
sds
 *
tokís
, 
cou¡
);

246 
	`sd°ﬁowî
(
sds
 
s
);

247 
	`sd°ouµî
(
sds
 
s
);

248 
sds
 
	`sds‰oml⁄gl⁄g
(
vÆue
);

249 
sds
 
	`sdsˇåïr
(sd†
s
, c⁄° *
p
, 
size_t
 
Àn
);

250 
sds
 *
	`sds•lô¨gs
(c⁄° *
löe
, *
¨gc
);

251 
sds
 
	`sdsm≠ch¨s
(sd†
s
, c⁄° *
‰om
, c⁄° *
to
, 
size_t
 
£éí
);

252 
sds
 
	`sdsjoö
(**
¨gv
, 
¨gc
, *
£p
);

253 
sds
 
	`sdsjoösds
(sd†*
¨gv
, 
¨gc
, c⁄° *
£p
, 
size_t
 
£∂í
);

256 
sds
 
	`sdsMakeRoomF‹
(sd†
s
, 
size_t
 
addÀn
);

257 
	`sdsIn¸Lí
(
sds
 
s
, 
ssize_t
 
ö¸
);

258 
sds
 
	`sdsRemoveFªeS∑˚
(sd†
s
);

259 
size_t
 
	`sdsAŒocSize
(
sds
 
s
);

260 *
	`sdsAŒocPå
(
sds
 
s
);

266 *
	`sds_mÆloc
(
size_t
 
size
);

267 *
	`sds_ªÆloc
(*
±r
, 
size_t
 
size
);

268 
	`sds_‰ì
(*
±r
);

270 #ifde‡
REDIS_TEST


271 
	`sdsTe°
(
¨gc
, *
¨gv
[]);

	@sdsalloc.h

39 #i‚de‡
__SDS_ALLOC_H__


40 
	#__SDS_ALLOC_H__


	)

42 
	~"zmÆloc.h
"

43 
	#s_mÆloc
 
zmÆloc


	)

44 
	#s_ªÆloc
 
zªÆloc


	)

45 
	#s_‰ì
 
z‰ì


	)

	@sentinel.c

31 
	~"£rvî.h
"

32 
	~"húedis.h
"

33 #ifde‡
USE_OPENSSL


34 
	~"›ís¶/s¶.h
"

35 
	~"húedis_s¶.h
"

37 
	~"async.h
"

39 
	~<˘y≥.h
>

40 
	~<¨∑/öë.h
>

41 
	~<sys/sockë.h
>

42 
	~<sys/waô.h
>

43 
	~<f˙é.h
>

45 **
ívú⁄
;

47 #ifde‡
USE_OPENSSL


48 
SSL_CTX
 *
ªdis_és_˘x
;

51 
	#REDIS_SENTINEL_PORT
 26379

	)

56 
	s£¡öñAddr
 {

57 *
	mù
;

58 
	mp‹t
;

59 } 
	t£¡öñAddr
;

62 
	#SRI_MASTER
 (1<<0)

	)

63 
	#SRI_SLAVE
 (1<<1)

	)

64 
	#SRI_SENTINEL
 (1<<2)

	)

65 
	#SRI_S_DOWN
 (1<<3Ë

	)

66 
	#SRI_O_DOWN
 (1<<4Ë

	)

67 
	#SRI_MASTER_DOWN
 (1<<5Ë

	)

69 
	#SRI_FAILOVER_IN_PROGRESS
 (1<<6Ë

	)

71 
	#SRI_PROMOTED
 (1<<7Ë

	)

72 
	#SRI_RECONF_SENT
 (1<<8Ë

	)

73 
	#SRI_RECONF_INPROG
 (1<<9Ë

	)

74 
	#SRI_RECONF_DONE
 (1<<10Ë

	)

75 
	#SRI_FORCE_FAILOVER
 (1<<11Ë

	)

76 
	#SRI_SCRIPT_KILL_SENT
 (1<<12Ë

	)

79 
	#SENTINEL_INFO_PERIOD
 10000

	)

80 
	#SENTINEL_PING_PERIOD
 1000

	)

81 
	#SENTINEL_ASK_PERIOD
 1000

	)

82 
	#SENTINEL_PUBLISH_PERIOD
 2000

	)

83 
	#SENTINEL_DEFAULT_DOWN_AFTER
 30000

	)

84 
	#SENTINEL_HELLO_CHANNEL
 "__£¡öñ__:hñlo"

	)

85 
	#SENTINEL_TILT_TRIGGER
 2000

	)

86 
	#SENTINEL_TILT_PERIOD
 (
SENTINEL_PING_PERIOD
*30)

	)

87 
	#SENTINEL_DEFAULT_SLAVE_PRIORITY
 100

	)

88 
	#SENTINEL_SLAVE_RECONF_TIMEOUT
 10000

	)

89 
	#SENTINEL_DEFAULT_PARALLEL_SYNCS
 1

	)

90 
	#SENTINEL_MIN_LINK_RECONNECT_PERIOD
 15000

	)

91 
	#SENTINEL_DEFAULT_FAILOVER_TIMEOUT
 (60*3*1000)

	)

92 
	#SENTINEL_MAX_PENDING_COMMANDS
 100

	)

93 
	#SENTINEL_ELECTION_TIMEOUT
 10000

	)

94 
	#SENTINEL_MAX_DESYNC
 1000

	)

95 
	#SENTINEL_DEFAULT_DENY_SCRIPTS_RECONFIG
 1

	)

98 
	#SENTINEL_FAILOVER_STATE_NONE
 0

	)

99 
	#SENTINEL_FAILOVER_STATE_WAIT_START
 1

	)

100 
	#SENTINEL_FAILOVER_STATE_SELECT_SLAVE
 2

	)

101 
	#SENTINEL_FAILOVER_STATE_SEND_SLAVEOF_NOONE
 3

	)

102 
	#SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
 4

	)

103 
	#SENTINEL_FAILOVER_STATE_RECONF_SLAVES
 5

	)

104 
	#SENTINEL_FAILOVER_STATE_UPDATE_CONFIG
 6

	)

106 
	#SENTINEL_MASTER_LINK_STATUS_UP
 0

	)

107 
	#SENTINEL_MASTER_LINK_STATUS_DOWN
 1

	)

112 
	#SENTINEL_NO_FLAGS
 0

	)

113 
	#SENTINEL_GENERATE_EVENT
 (1<<16)

	)

114 
	#SENTINEL_LEADER
 (1<<17)

	)

115 
	#SENTINEL_OBSERVER
 (1<<18)

	)

118 
	#SENTINEL_SCRIPT_NONE
 0

	)

119 
	#SENTINEL_SCRIPT_RUNNING
 1

	)

120 
	#SENTINEL_SCRIPT_MAX_QUEUE
 256

	)

121 
	#SENTINEL_SCRIPT_MAX_RUNNING
 16

	)

122 
	#SENTINEL_SCRIPT_MAX_RUNTIME
 60000

	)

123 
	#SENTINEL_SCRIPT_MAX_RETRY
 10

	)

124 
	#SENTINEL_SCRIPT_RETRY_DELAY
 30000

	)

127 
	#SENTINEL_SIMFAILURE_NONE
 0

	)

128 
	#SENTINEL_SIMFAILURE_CRASH_AFTER_ELECTION
 (1<<0)

	)

129 
	#SENTINEL_SIMFAILURE_CRASH_AFTER_PROMOTION
 (1<<1)

	)

145 
	sö°™˚Lök
 {

146 
	mªfcou¡
;

147 
	mdisc⁄√˘ed
;

148 
	m≥ndög_comm™ds
;

149 
ªdisAsyncC⁄ãxt
 *
	mcc
;

150 
ªdisAsyncC⁄ãxt
 *
	mpc
;

151 
m°ime_t
 
	mcc_c⁄n_time
;

152 
m°ime_t
 
	mpc_c⁄n_time
;

153 
m°ime_t
 
	mpc_œ°_a˘ivôy
;

154 
m°ime_t
 
	mœ°_avaû_time
;

156 
m°ime_t
 
	ma˘_pög_time
;

161 
m°ime_t
 
	mœ°_pög_time
;

165 
m°ime_t
 
	mœ°_p⁄g_time
;

168 
m°ime_t
 
	mœ°_ªc⁄n_time
;

170 } 
	tö°™˚Lök
;

172 
	s£¡öñRedisIn°™˚
 {

173 
	mÊags
;

174 *
	m«me
;

175 *
	mrunid
;

176 
uöt64_t
 
	mc⁄fig_ïoch
;

177 
£¡öñAddr
 *
	maddr
;

178 
ö°™˚Lök
 *
	mlök
;

179 
m°ime_t
 
	mœ°_pub_time
;

180 
m°ime_t
 
	mœ°_hñlo_time
;

183 
m°ime_t
 
	mœ°_ma°î_down_ª∂y_time
;

185 
m°ime_t
 
	ms_down_sö˚_time
;

186 
m°ime_t
 
	mo_down_sö˚_time
;

187 
m°ime_t
 
	mdown_a·î_≥riod
;

188 
m°ime_t
 
	möfo_ª‰esh
;

189 
di˘
 *
	mª«med_comm™ds
;

199 
	mrﬁe_ªp‹ãd
;

200 
m°ime_t
 
	mrﬁe_ªp‹ãd_time
;

201 
m°ime_t
 
	m¶ave_c⁄f_ch™ge_time
;

204 
di˘
 *
	m£¡öñs
;

205 
di˘
 *
	m¶aves
;

206 
	mqu‹um
;

207 
	m∑øŒñ_syncs
;

208 *
	mauth_∑ss
;

209 *
	mauth_u£r
;

212 
m°ime_t
 
	mma°î_lök_down_time
;

213 
	m¶ave_¥i‹ôy
;

214 
m°ime_t
 
	m¶ave_ªc⁄f_£¡_time
;

215 
£¡öñRedisIn°™˚
 *
	mma°î
;

216 *
	m¶ave_ma°î_ho°
;

217 
	m¶ave_ma°î_p‹t
;

218 
	m¶ave_ma°î_lök_°©us
;

219 
	m¶ave_ª∂_off£t
;

221 *
	mÀadî
;

225 
uöt64_t
 
	mÀadî_ïoch
;

226 
uöt64_t
 
	mÁûovî_ïoch
;

227 
	mÁûovî_°©e
;

228 
m°ime_t
 
	mÁûovî_°©e_ch™ge_time
;

229 
m°ime_t
 
	mÁûovî_°¨t_time
;

230 
m°ime_t
 
	mÁûovî_timeout
;

231 
m°ime_t
 
	mÁûovî_dñay_logged
;

233 
£¡öñRedisIn°™˚
 *
	m¥omŸed_¶ave
;

236 *
	mnŸifiˇti⁄_s¸ùt
;

237 *
	m˛õ¡_ªc⁄fig_s¸ùt
;

238 
sds
 
	möfo
;

239 } 
	t£¡öñRedisIn°™˚
;

242 
	s£¡öñSèã
 {

243 
	mmyid
[
CONFIG_RUN_ID_SIZE
+1];

244 
uöt64_t
 
	mcuºít_ïoch
;

245 
di˘
 *
	mma°îs
;

248 
	mtût
;

249 
	mru¬ög_s¸ùts
;

250 
m°ime_t
 
	mtût_°¨t_time
;

251 
m°ime_t
 
	m¥evious_time
;

252 
li°
 *
	ms¸ùts_queue
;

253 *
	m™noun˚_ù
;

255 
	m™noun˚_p‹t
;

257 
	msimÁûuª_Êags
;

258 
	mdíy_s¸ùts_ªc⁄fig
;

260 } 
	g£¡öñ
;

263 
	s£¡öñS¸ùtJob
 {

264 
	mÊags
;

265 
	mªåy_num
;

266 **
	m¨gv
;

267 
m°ime_t
 
	m°¨t_time
;

272 
pid_t
 
	mpid
;

273 } 
	t£¡öñS¸ùtJob
;

280 
	sªdisAeEvíts
 {

281 
ªdisAsyncC⁄ãxt
 *
	mc⁄ãxt
;

282 
´EvítLo›
 *
	mlo›
;

283 
	mfd
;

284 
	mªadög
, 
	mwrôög
;

285 } 
	tªdisAeEvíts
;

287 
	$ªdisAeRódEvít
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

288 (()
ñ
); (()
fd
); (()
mask
);

290 
ªdisAeEvíts
 *
e
 = (ªdisAeEvíts*)
¥ivd©a
;

291 
	`ªdisAsyncH™dÀRód
(
e
->
c⁄ãxt
);

292 
	}
}

294 
	$ªdisAeWrôeEvít
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
) {

295 (()
ñ
); (()
fd
); (()
mask
);

297 
ªdisAeEvíts
 *
e
 = (ªdisAeEvíts*)
¥ivd©a
;

298 
	`ªdisAsyncH™dÀWrôe
(
e
->
c⁄ãxt
);

299 
	}
}

301 
	$ªdisAeAddRód
(*
¥ivd©a
) {

302 
ªdisAeEvíts
 *
e
 = (ªdisAeEvíts*)
¥ivd©a
;

303 
´EvítLo›
 *
lo›
 = 
e
->loop;

304 i‡(!
e
->
ªadög
) {

305 
e
->
ªadög
 = 1;

306 
	`´Cª©eFûeEvít
(
lo›
,
e
->
fd
,
AE_READABLE
,
ªdisAeRódEvít
,e);

308 
	}
}

310 
	$ªdisAeDñRód
(*
¥ivd©a
) {

311 
ªdisAeEvíts
 *
e
 = (ªdisAeEvíts*)
¥ivd©a
;

312 
´EvítLo›
 *
lo›
 = 
e
->loop;

313 i‡(
e
->
ªadög
) {

314 
e
->
ªadög
 = 0;

315 
	`´DñëeFûeEvít
(
lo›
,
e
->
fd
,
AE_READABLE
);

317 
	}
}

319 
	$ªdisAeAddWrôe
(*
¥ivd©a
) {

320 
ªdisAeEvíts
 *
e
 = (ªdisAeEvíts*)
¥ivd©a
;

321 
´EvítLo›
 *
lo›
 = 
e
->loop;

322 i‡(!
e
->
wrôög
) {

323 
e
->
wrôög
 = 1;

324 
	`´Cª©eFûeEvít
(
lo›
,
e
->
fd
,
AE_WRITABLE
,
ªdisAeWrôeEvít
,e);

326 
	}
}

328 
	$ªdisAeDñWrôe
(*
¥ivd©a
) {

329 
ªdisAeEvíts
 *
e
 = (ªdisAeEvíts*)
¥ivd©a
;

330 
´EvítLo›
 *
lo›
 = 
e
->loop;

331 i‡(
e
->
wrôög
) {

332 
e
->
wrôög
 = 0;

333 
	`´DñëeFûeEvít
(
lo›
,
e
->
fd
,
AE_WRITABLE
);

335 
	}
}

337 
	$ªdisAeCÀ™up
(*
¥ivd©a
) {

338 
ªdisAeEvíts
 *
e
 = (ªdisAeEvíts*)
¥ivd©a
;

339 
	`ªdisAeDñRód
(
¥ivd©a
);

340 
	`ªdisAeDñWrôe
(
¥ivd©a
);

341 
	`z‰ì
(
e
);

342 
	}
}

344 
	$ªdisAeAâach
(
´EvítLo›
 *
lo›
, 
ªdisAsyncC⁄ãxt
 *
ac
) {

345 
ªdisC⁄ãxt
 *
c
 = &(
ac
->c);

346 
ªdisAeEvíts
 *
e
;

349 i‡(
ac
->
ev
.
d©a
 !
NULL
)

350  
C_ERR
;

353 
e
 = (
ªdisAeEvíts
*)
	`zmÆloc
((*e));

354 
e
->
c⁄ãxt
 = 
ac
;

355 
e
->
lo›
 =Üoop;

356 
e
->
fd
 = 
c
->fd;

357 
e
->
ªadög
 =É->
wrôög
 = 0;

360 
ac
->
ev
.
addRód
 = 
ªdisAeAddRód
;

361 
ac
->
ev
.
dñRód
 = 
ªdisAeDñRód
;

362 
ac
->
ev
.
addWrôe
 = 
ªdisAeAddWrôe
;

363 
ac
->
ev
.
dñWrôe
 = 
ªdisAeDñWrôe
;

364 
ac
->
ev
.
˛ónup
 = 
ªdisAeCÀ™up
;

365 
ac
->
ev
.
d©a
 = 
e
;

367  
C_OK
;

368 
	}
}

372 
£¡öñLökE°ablishedCÆlback
(c⁄° 
ªdisAsyncC⁄ãxt
 *
c
, 
°©us
);

373 
£¡öñDisc⁄√˘CÆlback
(c⁄° 
ªdisAsyncC⁄ãxt
 *
c
, 
°©us
);

374 
£¡öñRe˚iveHñloMesßges
(
ªdisAsyncC⁄ãxt
 *
c
, *
ª∂y
, *
¥ivd©a
);

375 
£¡öñRedisIn°™˚
 *
£¡öñGëMa°îByName
(*
«me
);

376 *
£¡öñGëSubje˘iveLódî
(
£¡öñRedisIn°™˚
 *
ma°î
);

377 *
£¡öñGëObje˘iveLódî
(
£¡öñRedisIn°™˚
 *
ma°î
);

378 
ye¢Ÿoi
(*
s
);

379 
ö°™˚LökC⁄√˘i⁄Eº‹
(c⁄° 
ªdisAsyncC⁄ãxt
 *
c
);

380 c⁄° *
£¡öñRedisIn°™˚Ty≥Så
(
£¡öñRedisIn°™˚
 *
ri
);

381 
£¡öñAb‹tFaûovî
(
£¡öñRedisIn°™˚
 *
ri
);

382 
£¡öñEvít
(
Àvñ
, *
ty≥
, 
£¡öñRedisIn°™˚
 *
ri
, c⁄° *
fmt
, ...);

383 
£¡öñRedisIn°™˚
 *
£¡öñSñe˘Sœve
(£¡öñRedisIn°™˚ *
ma°î
);

384 
£¡öñScheduÀS¸ùtExecuti⁄
(*
∑th
, ...);

385 
£¡öñSèπFaûovî
(
£¡öñRedisIn°™˚
 *
ma°î
);

386 
£¡öñDisˇrdRïlyCÆlback
(
ªdisAsyncC⁄ãxt
 *
c
, *
ª∂y
, *
¥ivd©a
);

387 
£¡öñSídSœveOf
(
£¡öñRedisIn°™˚
 *
ri
, *
ho°
, 
p‹t
);

388 *
£¡öñVŸeLódî
(
£¡öñRedisIn°™˚
 *
ma°î
, 
uöt64_t
 
ªq_ïoch
, *
ªq_runid
, uöt64_à*
Àadî_ïoch
);

389 
£¡öñFlushC⁄fig
();

390 
£¡öñGíî©eInôülM⁄ô‹Evíts
();

391 
£¡öñSídPög
(
£¡öñRedisIn°™˚
 *
ri
);

392 
£¡öñF‹˚HñloUpd©eF‹Ma°î
(
£¡öñRedisIn°™˚
 *
ma°î
);

393 
£¡öñRedisIn°™˚
 *
gëSítöñRedisIn°™˚ByAddrAndRunID
(
di˘
 *
ö°™˚s
, *
ù
, 
p‹t
, *
runid
);

394 
£¡öñSimFaûuªCøsh
();

398 
uöt64_t
 
di˘SdsHash
(c⁄° *
key
);

399 
uöt64_t
 
di˘SdsCa£Hash
(c⁄° *
key
);

400 
di˘SdsKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
, c⁄° *
key2
);

401 
di˘SdsKeyCa£Com∑ª
(*
¥ivd©a
, c⁄° *
key1
, c⁄° *
key2
);

402 
ªÀa£SítöñRedisIn°™˚
(
£¡öñRedisIn°™˚
 *
ri
);

404 
	$di˘In°™˚sVÆDe°ru˘‹
 (*
¥ivd©a
, *
obj
) {

405 
	`UNUSED
(
¥ivd©a
);

406 
	`ªÀa£SítöñRedisIn°™˚
(
obj
);

407 
	}
}

413 
di˘Ty≥
 
	gö°™˚sDi˘Ty≥
 = {

414 
di˘SdsHash
,

415 
NULL
,

416 
NULL
,

417 
di˘SdsKeyCom∑ª
,

418 
NULL
,

419 
di˘In°™˚sVÆDe°ru˘‹


426 
di˘Ty≥
 
	gÀadîVŸesDi˘Ty≥
 = {

427 
di˘SdsHash
,

428 
NULL
,

429 
NULL
,

430 
di˘SdsKeyCom∑ª
,

431 
NULL
,

432 
NULL


436 
di˘Ty≥
 
	gª«medComm™dsDi˘Ty≥
 = {

437 
di˘SdsCa£Hash
,

438 
NULL
,

439 
NULL
,

440 
di˘SdsKeyCa£Com∑ª
,

441 
di˘SdsDe°ru˘‹
,

442 
di˘SdsDe°ru˘‹


447 
£¡öñComm™d
(
˛õ¡
 *
c
);

448 
£¡öñInfoComm™d
(
˛õ¡
 *
c
);

449 
£¡öñSëComm™d
(
˛õ¡
 *
c
);

450 
£¡öñPublishComm™d
(
˛õ¡
 *
c
);

451 
£¡öñRﬁeComm™d
(
˛õ¡
 *
c
);

453 
ªdisComm™d
 
	g£¡öñcmds
[] = {

454 {"pög",
pögComm™d
,1,"",0,
NULL
,0,0,0,0,0},

455 {"£¡öñ",
£¡öñComm™d
,-2,"",0,
NULL
,0,0,0,0,0},

456 {"subs¸ibe",
subs¸ibeComm™d
,-2,"",0,
NULL
,0,0,0,0,0},

457 {"unsubs¸ibe",
unsubs¸ibeComm™d
,-1,"",0,
NULL
,0,0,0,0,0},

458 {"psubs¸ibe",
psubs¸ibeComm™d
,-2,"",0,
NULL
,0,0,0,0,0},

459 {"punsubs¸ibe",
punsubs¸ibeComm™d
,-1,"",0,
NULL
,0,0,0,0,0},

460 {"publish",
£¡öñPublishComm™d
,3,"",0,
NULL
,0,0,0,0,0},

461 {"öfo",
£¡öñInfoComm™d
,-1,"",0,
NULL
,0,0,0,0,0},

462 {"rﬁe",
£¡öñRﬁeComm™d
,1,"ok-lﬂdög",0,
NULL
,0,0,0,0,0},

463 {"˛õ¡",
˛õ¡Comm™d
,-2,"ªad-⁄lyÇo-s¸ùt",0,
NULL
,0,0,0,0,0},

464 {"shutdown",
shutdownComm™d
,-1,"",0,
NULL
,0,0,0,0,0},

465 {"auth",
authComm™d
,2,"no-authÇo-s¸ùàok-lﬂdög ok-°ÆêÁ°",0,
NULL
,0,0,0,0,0},

466 {"hñlo",
hñloComm™d
,-2,"no-authÇo-s¸ùàÁ°",0,
NULL
,0,0,0,0,0}

471 
	$öôSítöñC⁄fig
() {

472 
£rvî
.
p‹t
 = 
REDIS_SENTINEL_PORT
;

473 
£rvî
.
¥Ÿe˘ed_mode
 = 0;

474 
	}
}

477 
	$öôSítöñ
() {

478 
j
;

482 
	`di˘Em±y
(
£rvî
.
comm™ds
,
NULL
);

483 
j
 = 0; j < (
£¡öñcmds
)/(sentinelcmds[0]); j++) {

484 
ªtvÆ
;

485 
ªdisComm™d
 *
cmd
 = 
£¡öñcmds
+
j
;

487 
ªtvÆ
 = 
	`di˘Add
(
£rvî
.
comm™ds
, 
	`sd¢ew
(
cmd
->
«me
), cmd);

488 
	`£rvîAs£π
(
ªtvÆ
 =
DICT_OK
);

492 i‡(
	`p›uœãComm™dTabÀP¨£Fœgs
(
cmd
,cmd->
sÊags
Ë=
C_ERR
)

493 
	`£rvîP™ic
("Unsupported command flag");

497 
£¡öñ
.
cuºít_ïoch
 = 0;

498 
£¡öñ
.
ma°îs
 = 
	`di˘Cª©e
(&
ö°™˚sDi˘Ty≥
,
NULL
);

499 
£¡öñ
.
tût
 = 0;

500 
£¡öñ
.
tût_°¨t_time
 = 0;

501 
£¡öñ
.
¥evious_time
 = 
	`m°ime
();

502 
£¡öñ
.
ru¬ög_s¸ùts
 = 0;

503 
£¡öñ
.
s¸ùts_queue
 = 
	`li°Cª©e
();

504 
£¡öñ
.
™noun˚_ù
 = 
NULL
;

505 
£¡öñ
.
™noun˚_p‹t
 = 0;

506 
£¡öñ
.
simÁûuª_Êags
 = 
SENTINEL_SIMFAILURE_NONE
;

507 
£¡öñ
.
díy_s¸ùts_ªc⁄fig
 = 
SENTINEL_DEFAULT_DENY_SCRIPTS_RECONFIG
;

508 
	`mem£t
(
£¡öñ
.
myid
,0,(sentinel.myid));

509 
	}
}

513 
	$£¡öñIsRu¬ög
() {

514 
j
;

516 i‡(
£rvî
.
c⁄figfûe
 =
NULL
) {

517 
	`£rvîLog
(
LL_WARNING
,

519 
	`exô
(1);

520 } i‡(
	`ac˚ss
(
£rvî
.
c⁄figfûe
,
W_OK
) == -1) {

521 
	`£rvîLog
(
LL_WARNING
,

523 
£rvî
.
c⁄figfûe
,
	`°ªº‹
(
î∫o
));

524 
	`exô
(1);

530 
j
 = 0; j < 
CONFIG_RUN_ID_SIZE
; j++)

531 i‡(
£¡öñ
.
myid
[
j
] != 0) ;

533 i‡(
j
 =
CONFIG_RUN_ID_SIZE
) {

535 
	`gëR™domHexCh¨s
(
£¡öñ
.
myid
,
CONFIG_RUN_ID_SIZE
);

536 
	`£¡öñFlushC⁄fig
();

540 
	`£rvîLog
(
LL_WARNING
,"Sítöñ ID i†%s", 
£¡öñ
.
myid
);

544 
	`£¡öñGíî©eInôülM⁄ô‹Evíts
();

545 
	}
}

554 
£¡öñAddr
 *
	$¸óãSítöñAddr
(*
ho°«me
, 
p‹t
) {

555 
ù
[
NET_IP_STR_LEN
];

556 
£¡öñAddr
 *
ß
;

558 i‡(
p‹t
 < 0 ||Öort > 65535) {

559 
î∫o
 = 
EINVAL
;

560  
NULL
;

562 i‡(
	`™ëResﬁve
(
NULL
,
ho°«me
,
ù
,(ù)Ë=
ANET_ERR
) {

563 
î∫o
 = 
ENOENT
;

564  
NULL
;

566 
ß
 = 
	`zmÆloc
((*sa));

567 
ß
->
ù
 = 
	`sd¢ew
(ip);

568 
ß
->
p‹t
 =Öort;

569  
ß
;

570 
	}
}

573 
£¡öñAddr
 *
	$dupSítöñAddr
(
£¡öñAddr
 *
§c
) {

574 
£¡öñAddr
 *
ß
;

576 
ß
 = 
	`zmÆloc
((*sa));

577 
ß
->
ù
 = 
	`sd¢ew
(
§c
->ip);

578 
ß
->
p‹t
 = 
§c
->port;

579  
ß
;

580 
	}
}

583 
	$ªÀa£SítöñAddr
(
£¡öñAddr
 *
ß
) {

584 
	`sds‰ì
(
ß
->
ù
);

585 
	`z‰ì
(
ß
);

586 
	}
}

589 
	$£¡öñAddrIsEquÆ
(
£¡öñAddr
 *
a
, sítöñAdd∏*
b
) {

590  
a
->
p‹t
 =
b
->p‹à&& !
	`°rˇ£cmp
◊->
ù
,b->ip);

591 
	}
}

619 
	$£¡öñEvít
(
Àvñ
, *
ty≥
, 
£¡öñRedisIn°™˚
 *
ri
,

620 c⁄° *
fmt
, ...) {

621 
va_li°
 
≠
;

622 
msg
[
LOG_MAX_LEN
];

623 
robj
 *
ch™√l
, *
∑ylﬂd
;

626 i‡(
fmt
[0] == '%' && fmt[1] == '@') {

627 
£¡öñRedisIn°™˚
 *
ma°î
 = (
ri
->
Êags
 & 
SRI_MASTER
) ?

628 
NULL
 : 
ri
->
ma°î
;

630 i‡(
ma°î
) {

631 
	`¢¥ötf
(
msg
, (msg), "%s %s %s %d @ %s %s %d",

632 
	`£¡öñRedisIn°™˚Ty≥Så
(
ri
),

633 
ri
->
«me
,Ñi->
addr
->
ù
,Ñi->addr->
p‹t
,

634 
ma°î
->
«me
, ma°î->
addr
->
ù
, ma°î->addr->
p‹t
);

636 
	`¢¥ötf
(
msg
, (msg), "%s %s %s %d",

637 
	`£¡öñRedisIn°™˚Ty≥Så
(
ri
),

638 
ri
->
«me
,Ñi->
addr
->
ù
,Ñi->addr->
p‹t
);

640 
fmt
 += 2;

642 
msg
[0] = '\0';

646 i‡(
fmt
[0] != '\0') {

647 
	`va_°¨t
(
≠
, 
fmt
);

648 
	`v¢¥ötf
(
msg
+
	`°æí
(msg), (msg)-°æí(msg), 
fmt
, 
≠
);

649 
	`va_íd
(
≠
);

653 i‡(
Àvñ
 >
£rvî
.
vîbosôy
)

654 
	`£rvîLog
(
Àvñ
,"%†%s",
ty≥
,
msg
);

657 i‡(
Àvñ
 !
LL_DEBUG
) {

658 
ch™√l
 = 
	`¸óãSåögObje˘
(
ty≥
,
	`°æí
(type));

659 
∑ylﬂd
 = 
	`¸óãSåögObje˘
(
msg
,
	`°æí
(msg));

660 
	`pubsubPublishMesßge
(
ch™√l
,
∑ylﬂd
);

661 
	`de¸RefCou¡
(
ch™√l
);

662 
	`de¸RefCou¡
(
∑ylﬂd
);

666 i‡(
Àvñ
 =
LL_WARNING
 && 
ri
 !
NULL
) {

667 
£¡öñRedisIn°™˚
 *
ma°î
 = (
ri
->
Êags
 & 
SRI_MASTER
) ?

668 
ri
 :Ñi->
ma°î
;

669 i‡(
ma°î
 && ma°î->
nŸifiˇti⁄_s¸ùt
) {

670 
	`£¡öñScheduÀS¸ùtExecuti⁄
(
ma°î
->
nŸifiˇti⁄_s¸ùt
,

671 
ty≥
,
msg
,
NULL
);

674 
	}
}

680 
	$£¡öñGíî©eInôülM⁄ô‹Evíts
() {

681 
di˘Iãøt‹
 *
di
;

682 
di˘E¡ry
 *
de
;

684 
di
 = 
	`di˘GëIãøt‹
(
£¡öñ
.
ma°îs
);

685 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

686 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

687 
	`£¡öñEvít
(
LL_WARNING
,"+m⁄ô‹",
ri
,"%@ qu‹um %d",ri->
qu‹um
);

689 
	`di˘Rñó£Iãøt‹
(
di
);

690 
	}
}

695 
	$£¡öñRñó£S¸ùtJob
(
£¡öñS¸ùtJob
 *
sj
) {

696 
j
 = 0;

698 
sj
->
¨gv
[
j
]Ë
	`sds‰ì
(sj->argv[j++]);

699 
	`z‰ì
(
sj
->
¨gv
);

700 
	`z‰ì
(
sj
);

701 
	}
}

703 
	#SENTINEL_SCRIPT_MAX_ARGS
 16

	)

704 
	$£¡öñScheduÀS¸ùtExecuti⁄
(*
∑th
, ...) {

705 
va_li°
 
≠
;

706 *
¨gv
[
SENTINEL_SCRIPT_MAX_ARGS
+1];

707 
¨gc
 = 1;

708 
£¡öñS¸ùtJob
 *
sj
;

710 
	`va_°¨t
(
≠
, 
∑th
);

711 
¨gc
 < 
SENTINEL_SCRIPT_MAX_ARGS
) {

712 
¨gv
[
¨gc
] = 
	`va_¨g
(
≠
,*);

713 i‡(!
¨gv
[
¨gc
]) ;

714 
¨gv
[
¨gc
] = 
	`sd¢ew
(argv[argc]);

715 
¨gc
++;

717 
	`va_íd
(
≠
);

718 
¨gv
[0] = 
	`sd¢ew
(
∑th
);

720 
sj
 = 
	`zmÆloc
((*sj));

721 
sj
->
Êags
 = 
SENTINEL_SCRIPT_NONE
;

722 
sj
->
ªåy_num
 = 0;

723 
sj
->
¨gv
 = 
	`zmÆloc
((*)*(
¨gc
+1));

724 
sj
->
°¨t_time
 = 0;

725 
sj
->
pid
 = 0;

726 
	`mem˝y
(
sj
->
¨gv
,¨gv,(*)*(
¨gc
+1));

728 
	`li°AddNodeTaû
(
£¡öñ
.
s¸ùts_queue
,
sj
);

731 i‡(
	`li°Lígth
(
£¡öñ
.
s¸ùts_queue
Ë> 
SENTINEL_SCRIPT_MAX_QUEUE
) {

732 
li°Node
 *
 
;

733 
li°Iãr
 
li
;

735 
	`li°Rewöd
(
£¡öñ
.
s¸ùts_queue
,&
li
);

736 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

737 
sj
 = 
 
->
vÆue
;

739 i‡(
sj
->
Êags
 & 
SENTINEL_SCRIPT_RUNNING
) ;

741 
	`li°DñNode
(
£¡öñ
.
s¸ùts_queue
,
 
);

742 
	`£¡öñRñó£S¸ùtJob
(
sj
);

745 
	`£rvîAs£π
(
	`li°Lígth
(
£¡öñ
.
s¸ùts_queue
) <=

746 
SENTINEL_SCRIPT_MAX_QUEUE
);

748 
	}
}

752 
li°Node
 *
	$£¡öñGëS¸ùtLi°NodeByPid
(
pid_t
 
pid
) {

753 
li°Node
 *
 
;

754 
li°Iãr
 
li
;

756 
	`li°Rewöd
(
£¡öñ
.
s¸ùts_queue
,&
li
);

757 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

758 
£¡öñS¸ùtJob
 *
sj
 = 
 
->
vÆue
;

760 i‡((
sj
->
Êags
 & 
SENTINEL_SCRIPT_RUNNING
Ë&& sj->
pid
 ==Öid)

761  
 
;

763  
NULL
;

764 
	}
}

768 
	$£¡öñRunPídögS¸ùts
() {

769 
li°Node
 *
 
;

770 
li°Iãr
 
li
;

771 
m°ime_t
 
now
 = 
	`m°ime
();

775 
	`li°Rewöd
(
£¡öñ
.
s¸ùts_queue
,&
li
);

776 
£¡öñ
.
ru¬ög_s¸ùts
 < 
SENTINEL_SCRIPT_MAX_RUNNING
 &&

777 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
)

779 
£¡öñS¸ùtJob
 *
sj
 = 
 
->
vÆue
;

780 
pid_t
 
pid
;

783 i‡(
sj
->
Êags
 & 
SENTINEL_SCRIPT_RUNNING
) ;

786 i‡(
sj
->
°¨t_time
 && sj->°¨t_timê> 
now
) ;

788 
sj
->
Êags
 |
SENTINEL_SCRIPT_RUNNING
;

789 
sj
->
°¨t_time
 = 
	`m°ime
();

790 
sj
->
ªåy_num
++;

791 
pid
 = 
	`f‹k
();

793 i‡(
pid
 == -1) {

797 
	`£¡öñEvít
(
LL_WARNING
,"-s¸ùt-îr‹",
NULL
,

798 "%†%d %d", 
sj
->
¨gv
[0], 99, 0);

799 
sj
->
Êags
 &~
SENTINEL_SCRIPT_RUNNING
;

800 
sj
->
pid
 = 0;

801 } i‡(
pid
 == 0) {

803 
	`execve
(
sj
->
¨gv
[0],sj->¨gv,
ívú⁄
);

805 
	`_exô
(2);

807 
£¡öñ
.
ru¬ög_s¸ùts
++;

808 
sj
->
pid
 =Öid;

809 
	`£¡öñEvít
(
LL_DEBUG
,"+s¸ùt-chûd",
NULL
,"%ld",()
pid
);

812 
	}
}

821 
m°ime_t
 
	$£¡öñS¸ùtRëryDñay
(
ªåy_num
) {

822 
m°ime_t
 
dñay
 = 
SENTINEL_SCRIPT_RETRY_DELAY
;

824 
ªåy_num
-- > 1Ë
dñay
 *= 2;

825  
dñay
;

826 
	}
}

832 
	$£¡öñCﬁÀ˘Tîmö©edS¸ùts
() {

833 
°©loc
;

834 
pid_t
 
pid
;

836 (
pid
 = 
	`waô3
(&
°©loc
,
WNOHANG
,
NULL
)) > 0) {

837 
exôcode
 = 
	`WEXITSTATUS
(
°©loc
);

838 
bysig«l
 = 0;

839 
li°Node
 *
 
;

840 
£¡öñS¸ùtJob
 *
sj
;

842 i‡(
	`WIFSIGNALED
(
°©loc
)Ë
bysig«l
 = 
	`WTERMSIG
(statloc);

843 
	`£¡öñEvít
(
LL_DEBUG
,"-s¸ùt-chûd",
NULL
,"%ld %d %d",

844 ()
pid
, 
exôcode
, 
bysig«l
);

846 
 
 = 
	`£¡öñGëS¸ùtLi°NodeByPid
(
pid
);

847 i‡(
 
 =
NULL
) {

848 
	`£rvîLog
(
LL_WARNING
,"waô3(Ëªtu∫edáÖid (%ldËwêˇn'àföd i¿ou∏s¸ùt†executi⁄ queue!", ()
pid
);

851 
sj
 = 
 
->
vÆue
;

856 i‡((
bysig«l
 || 
exôcode
 == 1) &&

857 
sj
->
ªåy_num
 !
SENTINEL_SCRIPT_MAX_RETRY
)

859 
sj
->
Êags
 &~
SENTINEL_SCRIPT_RUNNING
;

860 
sj
->
pid
 = 0;

861 
sj
->
°¨t_time
 = 
	`m°ime
() +

862 
	`£¡öñS¸ùtRëryDñay
(
sj
->
ªåy_num
);

866 i‡(
bysig«l
 || 
exôcode
 != 0) {

867 
	`£¡öñEvít
(
LL_WARNING
,"-s¸ùt-îr‹",
NULL
,

868 "%†%d %d", 
sj
->
¨gv
[0], 
bysig«l
, 
exôcode
);

870 
	`li°DñNode
(
£¡öñ
.
s¸ùts_queue
,
 
);

871 
	`£¡öñRñó£S¸ùtJob
(
sj
);

873 
£¡öñ
.
ru¬ög_s¸ùts
--;

875 
	}
}

879 
	$£¡öñKûlTimedoutS¸ùts
() {

880 
li°Node
 *
 
;

881 
li°Iãr
 
li
;

882 
m°ime_t
 
now
 = 
	`m°ime
();

884 
	`li°Rewöd
(
£¡öñ
.
s¸ùts_queue
,&
li
);

885 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

886 
£¡öñS¸ùtJob
 *
sj
 = 
 
->
vÆue
;

888 i‡(
sj
->
Êags
 & 
SENTINEL_SCRIPT_RUNNING
 &&

889 (
now
 - 
sj
->
°¨t_time
Ë> 
SENTINEL_SCRIPT_MAX_RUNTIME
)

891 
	`£¡öñEvít
(
LL_WARNING
,"-s¸ùt-timeout",
NULL
,"%s %ld",

892 
sj
->
¨gv
[0], ()sj->
pid
);

893 
	`kûl
(
sj
->
pid
,
SIGKILL
);

896 
	}
}

899 
	$£¡öñPídögS¸ùtsComm™d
(
˛õ¡
 *
c
) {

900 
li°Node
 *
 
;

901 
li°Iãr
 
li
;

903 
	`addRïlyAºayLí
(
c
,
	`li°Lígth
(
£¡öñ
.
s¸ùts_queue
));

904 
	`li°Rewöd
(
£¡öñ
.
s¸ùts_queue
,&
li
);

905 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

906 
£¡öñS¸ùtJob
 *
sj
 = 
 
->
vÆue
;

907 
j
 = 0;

909 
	`addRïlyM≠Lí
(
c
,5);

911 
	`addRïlyBulkCSåög
(
c
,"argv");

912 
sj
->
¨gv
[
j
]) j++;

913 
	`addRïlyAºayLí
(
c
,
j
);

914 
j
 = 0;

915 
sj
->
¨gv
[
j
]Ë
	`addRïlyBulkCSåög
(
c
,sj->argv[j++]);

917 
	`addRïlyBulkCSåög
(
c
,"flags");

918 
	`addRïlyBulkCSåög
(
c
,

919 (
sj
->
Êags
 & 
SENTINEL_SCRIPT_RUNNING
) ? "running" : "scheduled");

921 
	`addRïlyBulkCSåög
(
c
,"pid");

922 
	`addRïlyBulkL⁄gL⁄g
(
c
,
sj
->
pid
);

924 i‡(
sj
->
Êags
 & 
SENTINEL_SCRIPT_RUNNING
) {

925 
	`addRïlyBulkCSåög
(
c
,"run-time");

926 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`m°ime
(Ë- 
sj
->
°¨t_time
);

928 
m°ime_t
 
dñay
 = 
sj
->
°¨t_time
 ? (sj->°¨t_time-
	`m°ime
()) : 0;

929 i‡(
dñay
 < 0) delay = 0;

930 
	`addRïlyBulkCSåög
(
c
,"run-delay");

931 
	`addRïlyBulkL⁄gL⁄g
(
c
,
dñay
);

934 
	`addRïlyBulkCSåög
(
c
,"retry-num");

935 
	`addRïlyBulkL⁄gL⁄g
(
c
,
sj
->
ªåy_num
);

937 
	}
}

951 
	$£¡öñCÆlClõ¡Rec⁄fS¸ùt
(
£¡öñRedisIn°™˚
 *
ma°î
, 
rﬁe
, *
°©e
, 
£¡öñAddr
 *
‰om
, sítöñAdd∏*
to
) {

952 
‰omp‹t
[32], 
t›‹t
[32];

954 i‡(
ma°î
->
˛õ¡_ªc⁄fig_s¸ùt
 =
NULL
) ;

955 
	`Œ2°rög
(
‰omp‹t
,(‰omp‹t),
‰om
->
p‹t
);

956 
	`Œ2°rög
(
t›‹t
,—›‹t),
to
->
p‹t
);

957 
	`£¡öñScheduÀS¸ùtExecuti⁄
(
ma°î
->
˛õ¡_ªc⁄fig_s¸ùt
,

958 
ma°î
->
«me
,

959 (
rﬁe
 =
SENTINEL_LEADER
) ? "leader" : "observer",

960 
°©e
, 
‰om
->
ù
, 
‰omp‹t
, 
to
->ù, 
t›‹t
, 
NULL
);

961 
	}
}

966 
ö°™˚Lök
 *
	$¸óãIn°™˚Lök
() {

967 
ö°™˚Lök
 *
lök
 = 
	`zmÆloc
((*link));

969 
lök
->
ªfcou¡
 = 1;

970 
lök
->
disc⁄√˘ed
 = 1;

971 
lök
->
≥ndög_comm™ds
 = 0;

972 
lök
->
cc
 = 
NULL
;

973 
lök
->
pc
 = 
NULL
;

974 
lök
->
cc_c⁄n_time
 = 0;

975 
lök
->
pc_c⁄n_time
 = 0;

976 
lök
->
œ°_ªc⁄n_time
 = 0;

977 
lök
->
pc_œ°_a˘ivôy
 = 0;

982 
lök
->
a˘_pög_time
 = 
	`m°ime
();

983 
lök
->
œ°_pög_time
 = 0;

984 
lök
->
œ°_avaû_time
 = 
	`m°ime
();

985 
lök
->
œ°_p⁄g_time
 = 
	`m°ime
();

986  
lök
;

987 
	}
}

990 
	$ö°™˚LökClo£C⁄√˘i⁄
(
ö°™˚Lök
 *
lök
, 
ªdisAsyncC⁄ãxt
 *
c
) {

991 i‡(
c
 =
NULL
) ;

993 i‡(
lök
->
cc
 =
c
) {

994 
lök
->
cc
 = 
NULL
;

995 
lök
->
≥ndög_comm™ds
 = 0;

997 i‡(
lök
->
pc
 =
c
Ëlök->p¯
NULL
;

998 
c
->
d©a
 = 
NULL
;

999 
lök
->
disc⁄√˘ed
 = 1;

1000 
	`ªdisAsyncFªe
(
c
);

1001 
	}
}

1011 
ö°™˚Lök
 *
	$ªÀa£In°™˚Lök
(
ö°™˚Lök
 *
lök
, 
£¡öñRedisIn°™˚
 *
ri
)

1013 
	`£rvîAs£π
(
lök
->
ªfcou¡
 > 0);

1014 
lök
->
ªfcou¡
--;

1015 i‡(
lök
->
ªfcou¡
 != 0) {

1016 i‡(
ri
 &&Ñi->
lök
->
cc
) {

1022 
ªdisCÆlback
 *
cb
;

1023 
ªdisCÆlbackLi°
 *
ˇŒbacks
 = &
lök
->
cc
->
ª∂õs
;

1025 
cb
 = 
ˇŒbacks
->
hód
;

1026 
cb
) {

1027 i‡(
cb
->
¥ivd©a
 =
ri
) {

1028 
cb
->
‚
 = 
£¡öñDisˇrdRïlyCÆlback
;

1029 
cb
->
¥ivd©a
 = 
NULL
;

1031 
cb
 = cb->
√xt
;

1034  
lök
;

1037 
	`ö°™˚LökClo£C⁄√˘i⁄
(
lök
,lök->
cc
);

1038 
	`ö°™˚LökClo£C⁄√˘i⁄
(
lök
,lök->
pc
);

1039 
	`z‰ì
(
lök
);

1040  
NULL
;

1041 
	}
}

1055 
	$£¡öñTryC⁄√˘i⁄Sh¨ög
(
£¡öñRedisIn°™˚
 *
ri
) {

1056 
	`£rvîAs£π
(
ri
->
Êags
 & 
SRI_SENTINEL
);

1057 
di˘Iãøt‹
 *
di
;

1058 
di˘E¡ry
 *
de
;

1060 i‡(
ri
->
runid
 =
NULL
Ë 
C_ERR
;

1061 i‡(
ri
->
lök
->
ªfcou¡
 > 1Ë 
C_ERR
;

1063 
di
 = 
	`di˘GëIãøt‹
(
£¡öñ
.
ma°îs
);

1064 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1065 
£¡öñRedisIn°™˚
 *
ma°î
 = 
	`di˘GëVÆ
(
de
), *
m©ch
;

1068 i‡(
ma°î
 =
ri
->master) ;

1069 
m©ch
 = 
	`gëSítöñRedisIn°™˚ByAddrAndRunID
(
ma°î
->
£¡öñs
,

1070 
NULL
,0,
ri
->
runid
);

1071 i‡(
m©ch
 =
NULL
) ;

1072 i‡(
m©ch
 =
ri
) ;

1076 
	`ªÀa£In°™˚Lök
(
ri
->
lök
,
NULL
);

1077 
ri
->
lök
 = 
m©ch
->link;

1078 
m©ch
->
lök
->
ªfcou¡
++;

1079  
C_OK
;

1081 
	`di˘Rñó£Iãøt‹
(
di
);

1082  
C_ERR
;

1083 
	}
}

1091 
	$£¡öñUpd©eSítöñAddªssInAŒMa°îs
(
£¡öñRedisIn°™˚
 *
ri
) {

1092 
	`£rvîAs£π
(
ri
->
Êags
 & 
SRI_SENTINEL
);

1093 
di˘Iãøt‹
 *
di
;

1094 
di˘E¡ry
 *
de
;

1095 
ªc⁄figuªd
 = 0;

1097 
di
 = 
	`di˘GëIãøt‹
(
£¡öñ
.
ma°îs
);

1098 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1099 
£¡öñRedisIn°™˚
 *
ma°î
 = 
	`di˘GëVÆ
(
de
), *
m©ch
;

1100 
m©ch
 = 
	`gëSítöñRedisIn°™˚ByAddrAndRunID
(
ma°î
->
£¡öñs
,

1101 
NULL
,0,
ri
->
runid
);

1104 i‡(
m©ch
 =
NULL
) ;

1107 i‡(
m©ch
->
lök
->
cc
 !
NULL
)

1108 
	`ö°™˚LökClo£C⁄√˘i⁄
(
m©ch
->
lök
,m©ch->lök->
cc
);

1109 i‡(
m©ch
->
lök
->
pc
 !
NULL
)

1110 
	`ö°™˚LökClo£C⁄√˘i⁄
(
m©ch
->
lök
,m©ch->lök->
pc
);

1112 i‡(
m©ch
 =
ri
) ;

1116 
	`ªÀa£SítöñAddr
(
m©ch
->
addr
);

1117 
m©ch
->
addr
 = 
	`dupSítöñAddr
(
ri
->addr);

1118 
ªc⁄figuªd
++;

1120 
	`di˘Rñó£Iãøt‹
(
di
);

1121 i‡(
ªc⁄figuªd
)

1122 
	`£¡öñEvít
(
LL_NOTICE
,"+£¡öñ-addªss-upd©e", 
ri
,

1123 "%@ %dáddôi⁄Æ m©chög in°™˚s", 
ªc⁄figuªd
);

1124  
ªc⁄figuªd
;

1125 
	}
}

1133 
	$ö°™˚LökC⁄√˘i⁄Eº‹
(c⁄° 
ªdisAsyncC⁄ãxt
 *
c
) {

1134 
ö°™˚Lök
 *
lök
 = 
c
->
d©a
;

1135 
pubsub
;

1137 i‡(!
lök
) ;

1139 
pubsub
 = (
lök
->
pc
 =
c
);

1140 i‡(
pubsub
)

1141 
lök
->
pc
 = 
NULL
;

1143 
lök
->
cc
 = 
NULL
;

1144 
lök
->
disc⁄√˘ed
 = 1;

1145 
	}
}

1149 
	$£¡öñLökE°ablishedCÆlback
(c⁄° 
ªdisAsyncC⁄ãxt
 *
c
, 
°©us
) {

1150 i‡(
°©us
 !
C_OK
Ë
	`ö°™˚LökC⁄√˘i⁄Eº‹
(
c
);

1151 
	}
}

1153 
	$£¡öñDisc⁄√˘CÆlback
(c⁄° 
ªdisAsyncC⁄ãxt
 *
c
, 
°©us
) {

1154 
	`UNUSED
(
°©us
);

1155 
	`ö°™˚LökC⁄√˘i⁄Eº‹
(
c
);

1156 
	}
}

1182 
£¡öñRedisIn°™˚
 *
	$¸óãSítöñRedisIn°™˚
(*
«me
, 
Êags
, *
ho°«me
, 
p‹t
, 
qu‹um
, 
£¡öñRedisIn°™˚
 *
ma°î
) {

1183 
£¡öñRedisIn°™˚
 *
ri
;

1184 
£¡öñAddr
 *
addr
;

1185 
di˘
 *
èbÀ
 = 
NULL
;

1186 
¶avíame
[
NET_PEER_ID_LEN
], *
sd¢ame
;

1188 
	`£rvîAs£π
(
Êags
 & (
SRI_MASTER
|
SRI_SLAVE
|
SRI_SENTINEL
));

1189 
	`£rvîAs£π
((
Êags
 & 
SRI_MASTER
Ë|| 
ma°î
 !
NULL
);

1192 
addr
 = 
	`¸óãSítöñAddr
(
ho°«me
,
p‹t
);

1193 i‡(
addr
 =
NULL
)  NULL;

1196 i‡(
Êags
 & 
SRI_SLAVE
) {

1197 
	`™ëF‹m©Addr
(
¶avíame
, (¶avíame), 
ho°«me
, 
p‹t
);

1198 
«me
 = 
¶avíame
;

1205 i‡(
Êags
 & 
SRI_MASTER
Ë
èbÀ
 = 
£¡öñ
.
ma°îs
;

1206 i‡(
Êags
 & 
SRI_SLAVE
Ë
èbÀ
 = 
ma°î
->
¶aves
;

1207 i‡(
Êags
 & 
SRI_SENTINEL
Ë
èbÀ
 = 
ma°î
->
£¡öñs
;

1208 
sd¢ame
 = 
	`sd¢ew
(
«me
);

1209 i‡(
	`di˘Föd
(
èbÀ
,
sd¢ame
)) {

1210 
	`ªÀa£SítöñAddr
(
addr
);

1211 
	`sds‰ì
(
sd¢ame
);

1212 
î∫o
 = 
EBUSY
;

1213  
NULL
;

1217 
ri
 = 
	`zmÆloc
((*ri));

1220 
ri
->
Êags
 = flags;

1221 
ri
->
«me
 = 
sd¢ame
;

1222 
ri
->
runid
 = 
NULL
;

1223 
ri
->
c⁄fig_ïoch
 = 0;

1224 
ri
->
addr
 =áddr;

1225 
ri
->
lök
 = 
	`¸óãIn°™˚Lök
();

1226 
ri
->
œ°_pub_time
 = 
	`m°ime
();

1227 
ri
->
œ°_hñlo_time
 = 
	`m°ime
();

1228 
ri
->
œ°_ma°î_down_ª∂y_time
 = 
	`m°ime
();

1229 
ri
->
s_down_sö˚_time
 = 0;

1230 
ri
->
o_down_sö˚_time
 = 0;

1231 
ri
->
down_a·î_≥riod
 = 
ma°î
 ? master->down_after_period :

1232 
SENTINEL_DEFAULT_DOWN_AFTER
;

1233 
ri
->
ma°î_lök_down_time
 = 0;

1234 
ri
->
auth_∑ss
 = 
NULL
;

1235 
ri
->
auth_u£r
 = 
NULL
;

1236 
ri
->
¶ave_¥i‹ôy
 = 
SENTINEL_DEFAULT_SLAVE_PRIORITY
;

1237 
ri
->
¶ave_ªc⁄f_£¡_time
 = 0;

1238 
ri
->
¶ave_ma°î_ho°
 = 
NULL
;

1239 
ri
->
¶ave_ma°î_p‹t
 = 0;

1240 
ri
->
¶ave_ma°î_lök_°©us
 = 
SENTINEL_MASTER_LINK_STATUS_DOWN
;

1241 
ri
->
¶ave_ª∂_off£t
 = 0;

1242 
ri
->
£¡öñs
 = 
	`di˘Cª©e
(&
ö°™˚sDi˘Ty≥
,
NULL
);

1243 
ri
->
qu‹um
 = quorum;

1244 
ri
->
∑øŒñ_syncs
 = 
SENTINEL_DEFAULT_PARALLEL_SYNCS
;

1245 
ri
->
ma°î
 = master;

1246 
ri
->
¶aves
 = 
	`di˘Cª©e
(&
ö°™˚sDi˘Ty≥
,
NULL
);

1247 
ri
->
öfo_ª‰esh
 = 0;

1248 
ri
->
ª«med_comm™ds
 = 
	`di˘Cª©e
(&
ª«medComm™dsDi˘Ty≥
,
NULL
);

1251 
ri
->
Àadî
 = 
NULL
;

1252 
ri
->
Àadî_ïoch
 = 0;

1253 
ri
->
Áûovî_ïoch
 = 0;

1254 
ri
->
Áûovî_°©e
 = 
SENTINEL_FAILOVER_STATE_NONE
;

1255 
ri
->
Áûovî_°©e_ch™ge_time
 = 0;

1256 
ri
->
Áûovî_°¨t_time
 = 0;

1257 
ri
->
Áûovî_timeout
 = 
SENTINEL_DEFAULT_FAILOVER_TIMEOUT
;

1258 
ri
->
Áûovî_dñay_logged
 = 0;

1259 
ri
->
¥omŸed_¶ave
 = 
NULL
;

1260 
ri
->
nŸifiˇti⁄_s¸ùt
 = 
NULL
;

1261 
ri
->
˛õ¡_ªc⁄fig_s¸ùt
 = 
NULL
;

1262 
ri
->
öfo
 = 
NULL
;

1265 
ri
->
rﬁe_ªp‹ãd
 =Ñi->
Êags
 & (
SRI_MASTER
|
SRI_SLAVE
);

1266 
ri
->
rﬁe_ªp‹ãd_time
 = 
	`m°ime
();

1267 
ri
->
¶ave_c⁄f_ch™ge_time
 = 
	`m°ime
();

1270 
	`di˘Add
(
èbÀ
, 
ri
->
«me
,Ñi);

1271  
ri
;

1272 
	}
}

1278 
	$ªÀa£SítöñRedisIn°™˚
(
£¡öñRedisIn°™˚
 *
ri
) {

1280 
	`di˘Rñó£
(
ri
->
£¡öñs
);

1281 
	`di˘Rñó£
(
ri
->
¶aves
);

1284 
	`ªÀa£In°™˚Lök
(
ri
->
lök
,ri);

1287 
	`sds‰ì
(
ri
->
«me
);

1288 
	`sds‰ì
(
ri
->
runid
);

1289 
	`sds‰ì
(
ri
->
nŸifiˇti⁄_s¸ùt
);

1290 
	`sds‰ì
(
ri
->
˛õ¡_ªc⁄fig_s¸ùt
);

1291 
	`sds‰ì
(
ri
->
¶ave_ma°î_ho°
);

1292 
	`sds‰ì
(
ri
->
Àadî
);

1293 
	`sds‰ì
(
ri
->
auth_∑ss
);

1294 
	`sds‰ì
(
ri
->
auth_u£r
);

1295 
	`sds‰ì
(
ri
->
öfo
);

1296 
	`ªÀa£SítöñAddr
(
ri
->
addr
);

1297 
	`di˘Rñó£
(
ri
->
ª«med_comm™ds
);

1300 i‡((
ri
->
Êags
 & 
SRI_SLAVE
Ë&& (ri->Êag†& 
SRI_PROMOTED
Ë&&Ñi->
ma°î
)

1301 
ri
->
ma°î
->
¥omŸed_¶ave
 = 
NULL
;

1303 
	`z‰ì
(
ri
);

1304 
	}
}

1307 
£¡öñRedisIn°™˚
 *
	$£¡öñRedisIn°™˚LookupSœve
(

1308 
£¡öñRedisIn°™˚
 *
ri
, *
ù
, 
p‹t
)

1310 
sds
 
key
;

1311 
£¡öñRedisIn°™˚
 *
¶ave
;

1312 
buf
[
NET_PEER_ID_LEN
];

1314 
	`£rvîAs£π
(
ri
->
Êags
 & 
SRI_MASTER
);

1315 
	`™ëF‹m©Addr
(
buf
,(buf),
ù
,
p‹t
);

1316 
key
 = 
	`sd¢ew
(
buf
);

1317 
¶ave
 = 
	`di˘FëchVÆue
(
ri
->
¶aves
,
key
);

1318 
	`sds‰ì
(
key
);

1319  
¶ave
;

1320 
	}
}

1323 c⁄° *
	$£¡öñRedisIn°™˚Ty≥Så
(
£¡öñRedisIn°™˚
 *
ri
) {

1324 i‡(
ri
->
Êags
 & 
SRI_MASTER
)  "master";

1325 i‡(
ri
->
Êags
 & 
SRI_SLAVE
)  "slave";

1326 i‡(
ri
->
Êags
 & 
SRI_SENTINEL
)  "sentinel";

1328 
	}
}

1341 
	$ªmoveM©chögSítöñFromMa°î
(
£¡öñRedisIn°™˚
 *
ma°î
, *
runid
) {

1342 
di˘Iãøt‹
 *
di
;

1343 
di˘E¡ry
 *
de
;

1344 
ªmoved
 = 0;

1346 i‡(
runid
 =
NULL
)  0;

1348 
di
 = 
	`di˘GëSa„Iãøt‹
(
ma°î
->
£¡öñs
);

1349 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1350 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

1352 i‡(
ri
->
runid
 && 
	`°rcmp
(ri->runid,runid) == 0) {

1353 
	`di˘Dñëe
(
ma°î
->
£¡öñs
,
ri
->
«me
);

1354 
ªmoved
++;

1357 
	`di˘Rñó£Iãøt‹
(
di
);

1358  
ªmoved
;

1359 
	}
}

1367 
£¡öñRedisIn°™˚
 *
	$gëSítöñRedisIn°™˚ByAddrAndRunID
(
di˘
 *
ö°™˚s
, *
ù
, 
p‹t
, *
runid
) {

1368 
di˘Iãøt‹
 *
di
;

1369 
di˘E¡ry
 *
de
;

1370 
£¡öñRedisIn°™˚
 *
ö°™˚
 = 
NULL
;

1372 
	`£rvîAs£π
(
ù
 || 
runid
);

1373 
di
 = 
	`di˘GëIãøt‹
(
ö°™˚s
);

1374 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1375 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

1377 i‡(
runid
 && !
ri
->runid) ;

1378 i‡((
runid
 =
NULL
 || 
	`°rcmp
(
ri
->runid,Ñunid) == 0) &&

1379 (
ù
 =
NULL
 || (
	`°rcmp
(
ri
->
addr
->ip, ip) == 0 &&

1380 
ri
->
addr
->
p‹t
 ==Öort)))

1382 
ö°™˚
 = 
ri
;

1386 
	`di˘Rñó£Iãøt‹
(
di
);

1387  
ö°™˚
;

1388 
	}
}

1391 
£¡öñRedisIn°™˚
 *
	$£¡öñGëMa°îByName
(*
«me
) {

1392 
£¡öñRedisIn°™˚
 *
ri
;

1393 
sds
 
sd¢ame
 = 
	`sd¢ew
(
«me
);

1395 
ri
 = 
	`di˘FëchVÆue
(
£¡öñ
.
ma°îs
,
sd¢ame
);

1396 
	`sds‰ì
(
sd¢ame
);

1397  
ri
;

1398 
	}
}

1401 
	$£¡öñAddFœgsToDi˘OfRedisIn°™˚s
(
di˘
 *
ö°™˚s
, 
Êags
) {

1402 
di˘Iãøt‹
 *
di
;

1403 
di˘E¡ry
 *
de
;

1405 
di
 = 
	`di˘GëIãøt‹
(
ö°™˚s
);

1406 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1407 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

1408 
ri
->
Êags
 |= flags;

1410 
	`di˘Rñó£Iãøt‹
(
di
);

1411 
	}
}

1415 
	$£¡öñDñFœgsToDi˘OfRedisIn°™˚s
(
di˘
 *
ö°™˚s
, 
Êags
) {

1416 
di˘Iãøt‹
 *
di
;

1417 
di˘E¡ry
 *
de
;

1419 
di
 = 
	`di˘GëIãøt‹
(
ö°™˚s
);

1420 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1421 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

1422 
ri
->
Êags
 &= ~flags;

1424 
	`di˘Rñó£Iãøt‹
(
di
);

1425 
	}
}

1438 
	#SENTINEL_RESET_NO_SENTINELS
 (1<<0)

	)

1439 
	$£¡öñRe£tMa°î
(
£¡öñRedisIn°™˚
 *
ri
, 
Êags
) {

1440 
	`£rvîAs£π
(
ri
->
Êags
 & 
SRI_MASTER
);

1441 
	`di˘Rñó£
(
ri
->
¶aves
);

1442 
ri
->
¶aves
 = 
	`di˘Cª©e
(&
ö°™˚sDi˘Ty≥
,
NULL
);

1443 i‡(!(
Êags
 & 
SENTINEL_RESET_NO_SENTINELS
)) {

1444 
	`di˘Rñó£
(
ri
->
£¡öñs
);

1445 
ri
->
£¡öñs
 = 
	`di˘Cª©e
(&
ö°™˚sDi˘Ty≥
,
NULL
);

1447 
	`ö°™˚LökClo£C⁄√˘i⁄
(
ri
->
lök
,ri->lök->
cc
);

1448 
	`ö°™˚LökClo£C⁄√˘i⁄
(
ri
->
lök
,ri->lök->
pc
);

1449 
ri
->
Êags
 &
SRI_MASTER
;

1450 i‡(
ri
->
Àadî
) {

1451 
	`sds‰ì
(
ri
->
Àadî
);

1452 
ri
->
Àadî
 = 
NULL
;

1454 
ri
->
Áûovî_°©e
 = 
SENTINEL_FAILOVER_STATE_NONE
;

1455 
ri
->
Áûovî_°©e_ch™ge_time
 = 0;

1456 
ri
->
Áûovî_°¨t_time
 = 0;

1457 
ri
->
¥omŸed_¶ave
 = 
NULL
;

1458 
	`sds‰ì
(
ri
->
runid
);

1459 
	`sds‰ì
(
ri
->
¶ave_ma°î_ho°
);

1460 
ri
->
runid
 = 
NULL
;

1461 
ri
->
¶ave_ma°î_ho°
 = 
NULL
;

1462 
ri
->
lök
->
a˘_pög_time
 = 
	`m°ime
();

1463 
ri
->
lök
->
œ°_pög_time
 = 0;

1464 
ri
->
lök
->
œ°_avaû_time
 = 
	`m°ime
();

1465 
ri
->
lök
->
œ°_p⁄g_time
 = 
	`m°ime
();

1466 
ri
->
rﬁe_ªp‹ãd_time
 = 
	`m°ime
();

1467 
ri
->
rﬁe_ªp‹ãd
 = 
SRI_MASTER
;

1468 i‡(
Êags
 & 
SENTINEL_GENERATE_EVENT
)

1469 
	`£¡öñEvít
(
LL_WARNING
,"+ª£t-ma°î",
ri
,"%@");

1470 
	}
}

1474 
	$£¡öñRe£tMa°îsByP©ã∫
(*
∑âîn
, 
Êags
) {

1475 
di˘Iãøt‹
 *
di
;

1476 
di˘E¡ry
 *
de
;

1477 
ª£t
 = 0;

1479 
di
 = 
	`di˘GëIãøt‹
(
£¡öñ
.
ma°îs
);

1480 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1481 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

1483 i‡(
ri
->
«me
) {

1484 i‡(
	`°rögm©ch
(
∑âîn
,
ri
->
«me
,0)) {

1485 
	`£¡öñRe£tMa°î
(
ri
,
Êags
);

1486 
ª£t
++;

1490 
	`di˘Rñó£Iãøt‹
(
di
);

1491  
ª£t
;

1492 
	}
}

1501 
	$£¡öñRe£tMa°îAndCh™geAddªss
(
£¡öñRedisIn°™˚
 *
ma°î
, *
ù
, 
p‹t
) {

1502 
£¡öñAddr
 *
ﬁdaddr
, *
√waddr
;

1503 
£¡öñAddr
 **
¶aves
 = 
NULL
;

1504 
num¶aves
 = 0, 
j
;

1505 
di˘Iãøt‹
 *
di
;

1506 
di˘E¡ry
 *
de
;

1508 
√waddr
 = 
	`¸óãSítöñAddr
(
ù
,
p‹t
);

1509 i‡(
√waddr
 =
NULL
Ë 
C_ERR
;

1513 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
¶aves
);

1514 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1515 
£¡öñRedisIn°™˚
 *
¶ave
 = 
	`di˘GëVÆ
(
de
);

1517 i‡(
	`£¡öñAddrIsEquÆ
(
¶ave
->
addr
,
√waddr
)) ;

1518 
¶aves
 = 
	`zªÆloc
(¶aves,(
£¡öñAddr
*)*(
num¶aves
+1));

1519 
¶aves
[
num¶aves
++] = 
	`¸óãSítöñAddr
(
¶ave
->
addr
->
ù
,

1520 
¶ave
->
addr
->
p‹t
);

1522 
	`di˘Rñó£Iãøt‹
(
di
);

1527 i‡(!
	`£¡öñAddrIsEquÆ
(
√waddr
,
ma°î
->
addr
)) {

1528 
¶aves
 = 
	`zªÆloc
(¶aves,(
£¡öñAddr
*)*(
num¶aves
+1));

1529 
¶aves
[
num¶aves
++] = 
	`¸óãSítöñAddr
(
ma°î
->
addr
->
ù
,

1530 
ma°î
->
addr
->
p‹t
);

1534 
	`£¡öñRe£tMa°î
(
ma°î
,
SENTINEL_RESET_NO_SENTINELS
);

1535 
ﬁdaddr
 = 
ma°î
->
addr
;

1536 
ma°î
->
addr
 = 
√waddr
;

1537 
ma°î
->
o_down_sö˚_time
 = 0;

1538 
ma°î
->
s_down_sö˚_time
 = 0;

1541 
j
 = 0; j < 
num¶aves
; j++) {

1542 
£¡öñRedisIn°™˚
 *
¶ave
;

1544 
¶ave
 = 
	`¸óãSítöñRedisIn°™˚
(
NULL
,
SRI_SLAVE
,
¶aves
[
j
]->
ù
,

1545 
¶aves
[
j
]->
p‹t
, 
ma°î
->
qu‹um
, master);

1546 
	`ªÀa£SítöñAddr
(
¶aves
[
j
]);

1547 i‡(
¶ave
Ë
	`£¡öñEvít
(
LL_NOTICE
,"+slave",slave,"%@");

1549 
	`z‰ì
(
¶aves
);

1553 
	`ªÀa£SítöñAddr
(
ﬁdaddr
);

1554 
	`£¡öñFlushC⁄fig
();

1555  
C_OK
;

1556 
	}
}

1560 
	$£¡öñRedisIn°™˚NoDownF‹
(
£¡öñRedisIn°™˚
 *
ri
, 
m°ime_t
 
ms
) {

1561 
m°ime_t
 
mo°_ª˚¡
;

1563 
mo°_ª˚¡
 = 
ri
->
s_down_sö˚_time
;

1564 i‡(
ri
->
o_down_sö˚_time
 > 
mo°_ª˚¡
)

1565 
mo°_ª˚¡
 = 
ri
->
o_down_sö˚_time
;

1566  
mo°_ª˚¡
 =0 || (
	`m°ime
(Ë- mo°_ª˚¡Ë> 
ms
;

1567 
	}
}

1571 
£¡öñAddr
 *
	$£¡öñGëCuºítMa°îAddªss
(
£¡öñRedisIn°™˚
 *
ma°î
) {

1577 i‡((
ma°î
->
Êags
 & 
SRI_FAILOVER_IN_PROGRESS
) &&

1578 
ma°î
->
¥omŸed_¶ave
 &&

1579 
ma°î
->
Áûovî_°©e
 >
SENTINEL_FAILOVER_STATE_RECONF_SLAVES
)

1581  
ma°î
->
¥omŸed_¶ave
->
addr
;

1583  
ma°î
->
addr
;

1585 
	}
}

1589 
	$£¡öñPr›ag©eDownA·îPîiod
(
£¡öñRedisIn°™˚
 *
ma°î
) {

1590 
di˘Iãøt‹
 *
di
;

1591 
di˘E¡ry
 *
de
;

1592 
j
;

1593 
di˘
 *
d
[] = {
ma°î
->
¶aves
, ma°î->
£¡öñs
, 
NULL
};

1595 
j
 = 0; 
d
[j]; j++) {

1596 
di
 = 
	`di˘GëIãøt‹
(
d
[
j
]);

1597 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1598 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

1599 
ri
->
down_a·î_≥riod
 = 
ma°î
->down_after_period;

1601 
	`di˘Rñó£Iãøt‹
(
di
);

1603 
	}
}

1605 *
	$£¡öñGëIn°™˚Ty≥Såög
(
£¡öñRedisIn°™˚
 *
ri
) {

1606 i‡(
ri
->
Êags
 & 
SRI_MASTER
)  "master";

1607 i‡(
ri
->
Êags
 & 
SRI_SLAVE
)  "slave";

1608 i‡(
ri
->
Êags
 & 
SRI_SENTINEL
)  "sentinel";

1610 
	}
}

1619 *
	$£¡öñIn°™˚M≠Comm™d
(
£¡öñRedisIn°™˚
 *
ri
, *
comm™d
) {

1620 
sds
 
sc
 = 
	`sd¢ew
(
comm™d
);

1621 i‡(
ri
->
ma°î
)Ñi =Ñi->master;

1622 *
ªtvÆ
 = 
	`di˘FëchVÆue
(
ri
->
ª«med_comm™ds
, 
sc
);

1623 
	`sds‰ì
(
sc
);

1624  
ªtvÆ
 ?ÑëvÆ : 
comm™d
;

1625 
	}
}

1628 *
	$£¡öñH™dÀC⁄figuøti⁄
(**
¨gv
, 
¨gc
) {

1629 
£¡öñRedisIn°™˚
 *
ri
;

1631 i‡(!
	`°rˇ£cmp
(
¨gv
[0],"m⁄ô‹"Ë&& 
¨gc
 == 5) {

1633 
qu‹um
 = 
	`©oi
(
¨gv
[4]);

1635 i‡(
qu‹um
 <= 0)  "Quorum must be 1 or greater.";

1636 i‡(
	`¸óãSítöñRedisIn°™˚
(
¨gv
[1],
SRI_MASTER
,argv[2],

1637 
	`©oi
(
¨gv
[3]),
qu‹um
,
NULL
) == NULL)

1639 
î∫o
) {

1640 
EBUSY
:  "Duplicated masterÇame.";

1641 
ENOENT
:  "Can'tÑesolve master instance hostname.";

1642 
EINVAL
:  "InvalidÖortÇumber";

1645 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"down-a·î-mûli£c⁄ds"Ë&& 
¨gc
 == 3) {

1647 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1648 i‡(!
ri
)  "No such master with specifiedÇame.";

1649 
ri
->
down_a·î_≥riod
 = 
	`©oi
(
¨gv
[2]);

1650 i‡(
ri
->
down_a·î_≥riod
 <= 0)

1652 
	`£¡öñPr›ag©eDownA·îPîiod
(
ri
);

1653 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"Áûovî-timeout"Ë&& 
¨gc
 == 3) {

1655 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1656 i‡(!
ri
)  "No such master with specifiedÇame.";

1657 
ri
->
Áûovî_timeout
 = 
	`©oi
(
¨gv
[2]);

1658 i‡(
ri
->
Áûovî_timeout
 <= 0)

1660 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"∑øŒñ-syncs"Ë&& 
¨gc
 == 3) {

1662 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1663 i‡(!
ri
)  "No such master with specifiedÇame.";

1664 
ri
->
∑øŒñ_syncs
 = 
	`©oi
(
¨gv
[2]);

1665 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"nŸifiˇti⁄-s¸ùt"Ë&& 
¨gc
 == 3) {

1667 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1668 i‡(!
ri
)  "No such master with specifiedÇame.";

1669 i‡(
	`ac˚ss
(
¨gv
[2],
X_OK
) == -1)

1671 
ri
->
nŸifiˇti⁄_s¸ùt
 = 
	`sd¢ew
(
¨gv
[2]);

1672 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"˛õ¡-ªc⁄fig-s¸ùt"Ë&& 
¨gc
 == 3) {

1674 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1675 i‡(!
ri
)  "No such master with specifiedÇame.";

1676 i‡(
	`ac˚ss
(
¨gv
[2],
X_OK
) == -1)

1679 
ri
->
˛õ¡_ªc⁄fig_s¸ùt
 = 
	`sd¢ew
(
¨gv
[2]);

1680 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"auth-∑ss"Ë&& 
¨gc
 == 3) {

1682 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1683 i‡(!
ri
)  "No such master with specifiedÇame.";

1684 
ri
->
auth_∑ss
 = 
	`sd¢ew
(
¨gv
[2]);

1685 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"auth-u£r"Ë&& 
¨gc
 == 3) {

1687 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1688 i‡(!
ri
)  "No such master with specifiedÇame.";

1689 
ri
->
auth_u£r
 = 
	`sd¢ew
(
¨gv
[2]);

1690 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"cuºít-ïoch"Ë&& 
¨gc
 == 2) {

1692 
cuºít_ïoch
 = 
	`°πouŒ
(
¨gv
[1],
NULL
,10);

1693 i‡(
cuºít_ïoch
 > 
£¡öñ
.current_epoch)

1694 
£¡öñ
.
cuºít_ïoch
 = current_epoch;

1695 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"myid"Ë&& 
¨gc
 == 2) {

1696 i‡(
	`°æí
(
¨gv
[1]Ë!
CONFIG_RUN_ID_SIZE
)

1698 
	`mem˝y
(
£¡öñ
.
myid
,
¨gv
[1],
CONFIG_RUN_ID_SIZE
);

1699 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"c⁄fig-ïoch"Ë&& 
¨gc
 == 3) {

1701 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1702 i‡(!
ri
)  "No such master with specifiedÇame.";

1703 
ri
->
c⁄fig_ïoch
 = 
	`°πouŒ
(
¨gv
[2],
NULL
,10);

1707 i‡(
ri
->
c⁄fig_ïoch
 > 
£¡öñ
.
cuºít_ïoch
)

1708 
£¡öñ
.
cuºít_ïoch
 = 
ri
->
c⁄fig_ïoch
;

1709 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"Àadî-ïoch"Ë&& 
¨gc
 == 3) {

1711 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1712 i‡(!
ri
)  "No such master with specifiedÇame.";

1713 
ri
->
Àadî_ïoch
 = 
	`°πouŒ
(
¨gv
[2],
NULL
,10);

1714 } i‡((!
	`°rˇ£cmp
(
¨gv
[0],"known-slave") ||

1715 !
	`°rˇ£cmp
(
¨gv
[0],"known-ª∂iˇ")Ë&& 
¨gc
 == 4)

1717 
£¡öñRedisIn°™˚
 *
¶ave
;

1720 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1721 i‡(!
ri
)  "No such master with specifiedÇame.";

1722 i‡((
¶ave
 = 
	`¸óãSítöñRedisIn°™˚
(
NULL
,
SRI_SLAVE
,
¨gv
[2],

1723 
	`©oi
(
¨gv
[3]), 
ri
->
qu‹um
,Ñi)Ë=
NULL
)

1727 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"known-sentinel") &&

1728 (
¨gc
 == 4 ||árgc == 5)) {

1729 
£¡öñRedisIn°™˚
 *
si
;

1731 i‡(
¨gc
 == 5) {

1733 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1734 i‡(!
ri
)  "No such master with specifiedÇame.";

1735 i‡((
si
 = 
	`¸óãSítöñRedisIn°™˚
(
¨gv
[4],
SRI_SENTINEL
,argv[2],

1736 
	`©oi
(
¨gv
[3]), 
ri
->
qu‹um
,Ñi)Ë=
NULL
)

1740 
si
->
runid
 = 
	`sd¢ew
(
¨gv
[4]);

1741 
	`£¡öñTryC⁄√˘i⁄Sh¨ög
(
si
);

1743 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"ª«me-comm™d"Ë&& 
¨gc
 == 4) {

1745 
ri
 = 
	`£¡öñGëMa°îByName
(
¨gv
[1]);

1746 i‡(!
ri
)  "No such master with specifiedÇame.";

1747 
sds
 
ﬁdcmd
 = 
	`sd¢ew
(
¨gv
[2]);

1748 
sds
 
√wcmd
 = 
	`sd¢ew
(
¨gv
[3]);

1749 i‡(
	`di˘Add
(
ri
->
ª«med_comm™ds
,
ﬁdcmd
,
√wcmd
Ë!
DICT_OK
) {

1750 
	`sds‰ì
(
ﬁdcmd
);

1751 
	`sds‰ì
(
√wcmd
);

1754 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"™noun˚-ù"Ë&& 
¨gc
 == 2) {

1756 i‡(
	`°æí
(
¨gv
[1]))

1757 
£¡öñ
.
™noun˚_ù
 = 
	`sd¢ew
(
¨gv
[1]);

1758 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"™noun˚-p‹t"Ë&& 
¨gc
 == 2) {

1760 
£¡öñ
.
™noun˚_p‹t
 = 
	`©oi
(
¨gv
[1]);

1761 } i‡(!
	`°rˇ£cmp
(
¨gv
[0],"díy-s¸ùts-ªc⁄fig"Ë&& 
¨gc
 == 2) {

1763 i‡((
£¡öñ
.
díy_s¸ùts_ªc⁄fig
 = 
	`ye¢Ÿoi
(
¨gv
[1])) == -1) {

1770  
NULL
;

1771 
	}
}

1778 
	$ªwrôeC⁄figSítöñO±i⁄
(
ªwrôeC⁄figSèã
 *
°©e
) {

1779 
di˘Iãøt‹
 *
di
, *
di2
;

1780 
di˘E¡ry
 *
de
;

1781 
sds
 
löe
;

1784 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(), "£¡öñ myid %s", 
£¡öñ
.
myid
);

1785 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1788 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(), "sentinel deny-scripts-reconfig %s",

1789 
£¡öñ
.
díy_s¸ùts_ªc⁄fig
 ? "yes" : "no");

1790 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,

1791 
£¡öñ
.
díy_s¸ùts_ªc⁄fig
 !
SENTINEL_DEFAULT_DENY_SCRIPTS_RECONFIG
);

1794 
di
 = 
	`di˘GëIãøt‹
(
£¡öñ
.
ma°îs
);

1795 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

1796 
£¡öñRedisIn°™˚
 *
ma°î
, *
ri
;

1797 
£¡öñAddr
 *
ma°î_addr
;

1800 
ma°î
 = 
	`di˘GëVÆ
(
de
);

1801 
ma°î_addr
 = 
	`£¡öñGëCuºítMa°îAddªss
(
ma°î
);

1802 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"sentinel monitor %s %s %d %d",

1803 
ma°î
->
«me
, 
ma°î_addr
->
ù
, ma°î_addr->
p‹t
,

1804 
ma°î
->
qu‹um
);

1805 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1808 i‡(
ma°î
->
down_a·î_≥riod
 !
SENTINEL_DEFAULT_DOWN_AFTER
) {

1809 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1811 
ma°î
->
«me
, (Ëma°î->
down_a·î_≥riod
);

1812 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1816 i‡(
ma°î
->
Áûovî_timeout
 !
SENTINEL_DEFAULT_FAILOVER_TIMEOUT
) {

1817 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1819 
ma°î
->
«me
, (Ëma°î->
Áûovî_timeout
);

1820 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1824 i‡(
ma°î
->
∑øŒñ_syncs
 !
SENTINEL_DEFAULT_PARALLEL_SYNCS
) {

1825 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1827 
ma°î
->
«me
, ma°î->
∑øŒñ_syncs
);

1828 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1832 i‡(
ma°î
->
nŸifiˇti⁄_s¸ùt
) {

1833 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1835 
ma°î
->
«me
, ma°î->
nŸifiˇti⁄_s¸ùt
);

1836 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1840 i‡(
ma°î
->
˛õ¡_ªc⁄fig_s¸ùt
) {

1841 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1843 
ma°î
->
«me
, ma°î->
˛õ¡_ªc⁄fig_s¸ùt
);

1844 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1848 i‡(
ma°î
->
auth_∑ss
) {

1849 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1851 
ma°î
->
«me
, ma°î->
auth_∑ss
);

1852 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1855 i‡(
ma°î
->
auth_u£r
) {

1856 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1858 
ma°î
->
«me
, ma°î->
auth_u£r
);

1859 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1863 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1865 
ma°î
->
«me
, (Ëma°î->
c⁄fig_ïoch
);

1866 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1869 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1871 
ma°î
->
«me
, (Ëma°î->
Àadî_ïoch
);

1872 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1875 
di2
 = 
	`di˘GëIãøt‹
(
ma°î
->
¶aves
);

1876 (
de
 = 
	`di˘Next
(
di2
)Ë!
NULL
) {

1877 
£¡öñAddr
 *
¶ave_addr
;

1879 
ri
 = 
	`di˘GëVÆ
(
de
);

1880 
¶ave_addr
 = 
ri
->
addr
;

1887 i‡(
	`£¡öñAddrIsEquÆ
(
¶ave_addr
,
ma°î_addr
))

1888 
¶ave_addr
 = 
ma°î
->
addr
;

1889 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1891 
ma°î
->
«me
, 
¶ave_addr
->
ù
, sœve_addr->
p‹t
);

1892 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1894 
	`di˘Rñó£Iãøt‹
(
di2
);

1897 
di2
 = 
	`di˘GëIãøt‹
(
ma°î
->
£¡öñs
);

1898 (
de
 = 
	`di˘Next
(
di2
)Ë!
NULL
) {

1899 
ri
 = 
	`di˘GëVÆ
(
de
);

1900 i‡(
ri
->
runid
 =
NULL
) ;

1901 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1903 
ma°î
->
«me
, 
ri
->
addr
->
ù
,Ñi->addr->
p‹t
,Ñi->
runid
);

1904 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1906 
	`di˘Rñó£Iãøt‹
(
di2
);

1909 
di2
 = 
	`di˘GëIãøt‹
(
ma°î
->
ª«med_comm™ds
);

1910 (
de
 = 
	`di˘Next
(
di2
)Ë!
NULL
) {

1911 
sds
 
ﬁd«me
 = 
	`di˘GëKey
(
de
);

1912 
sds
 
√w«me
 = 
	`di˘GëVÆ
(
de
);

1913 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1915 
ma°î
->
«me
, 
ﬁd«me
, 
√w«me
);

1916 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1918 
	`di˘Rñó£Iãøt‹
(
di2
);

1922 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),

1923 "£¡öñ cuºít-ïoch %Œu", (Ë
£¡öñ
.
cuºít_ïoch
);

1924 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1927 i‡(
£¡öñ
.
™noun˚_ù
) {

1928 
löe
 = 
	`sd¢ew
("sentinelánnounce-ip ");

1929 
löe
 = 
	`sdsˇåïr
÷öe, 
£¡öñ
.
™noun˚_ù
, 
	`sd¶í
(sentinel.announce_ip));

1930 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1934 i‡(
£¡öñ
.
™noun˚_p‹t
) {

1935 
löe
 = 
	`sdsˇçrötf
(
	`sd£m±y
(),"sentinelánnounce-port %d",

1936 
£¡öñ
.
™noun˚_p‹t
);

1937 
	`ªwrôeC⁄figRewrôeLöe
(
°©e
,"£¡öñ",
löe
,1);

1940 
	`di˘Rñó£Iãøt‹
(
di
);

1941 
	}
}

1950 
	$£¡öñFlushC⁄fig
() {

1951 
fd
 = -1;

1952 
ßved_hz
 = 
£rvî
.
hz
;

1953 
ªwrôe_°©us
;

1955 
£rvî
.
hz
 = 
CONFIG_DEFAULT_HZ
;

1956 
ªwrôe_°©us
 = 
	`ªwrôeC⁄fig
(
£rvî
.
c⁄figfûe
);

1957 
£rvî
.
hz
 = 
ßved_hz
;

1959 i‡(
ªwrôe_°©us
 =-1Ë
wîr
;

1960 i‡((
fd
 = 
	`›í
(
£rvî
.
c⁄figfûe
,
O_RDONLY
)Ë=-1Ë
wîr
;

1961 i‡(
	`fsync
(
fd
Ë=-1Ë
wîr
;

1962 i‡(
	`˛o£
(
fd
Ë=
EOF
Ë
wîr
;

1965 
wîr
:

1966 i‡(
fd
 !-1Ë
	`˛o£
(fd);

1967 
	`£rvîLog
(
LL_WARNING
,"WARNING: Sítöñ wa†nŸábÀÅÿßvêthê√w c⁄figuøti⁄ o¿disk!!!: %s", 
	`°ªº‹
(
î∫o
));

1968 
	}
}

1984 
	$£¡öñSídAuthIfNìded
(
£¡öñRedisIn°™˚
 *
ri
, 
ªdisAsyncC⁄ãxt
 *
c
) {

1985 *
auth_∑ss
 = 
NULL
;

1986 *
auth_u£r
 = 
NULL
;

1988 i‡(
ri
->
Êags
 & 
SRI_MASTER
) {

1989 
auth_∑ss
 = 
ri
->auth_pass;

1990 
auth_u£r
 = 
ri
->auth_user;

1991 } i‡(
ri
->
Êags
 & 
SRI_SLAVE
) {

1992 
auth_∑ss
 = 
ri
->
ma°î
->auth_pass;

1993 
auth_u£r
 = 
ri
->
ma°î
->auth_user;

1994 } i‡(
ri
->
Êags
 & 
SRI_SENTINEL
) {

1995 
auth_∑ss
 = 
£rvî
.
ªquúïass
;

1996 
auth_u£r
 = 
NULL
;

1999 i‡(
auth_∑ss
 && 
auth_u£r
 =
NULL
) {

2000 i‡(
	`ªdisAsyncComm™d
(
c
, 
£¡öñDisˇrdRïlyCÆlback
, 
ri
, "%s %s",

2001 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"AUTH"),

2002 
auth_∑ss
Ë=
C_OK
Ë
ri
->
lök
->
≥ndög_comm™ds
++;

2003 } i‡(
auth_∑ss
 && 
auth_u£r
) {

2006 i‡(
	`ªdisAsyncComm™d
(
c
, 
£¡öñDisˇrdRïlyCÆlback
, 
ri
, "%s %s %s",

2007 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"AUTH"),

2008 
auth_u£r
, 
auth_∑ss
Ë=
C_OK
Ë
ri
->
lök
->
≥ndög_comm™ds
++;

2010 
	}
}

2018 
	$£¡öñSëClõ¡Name
(
£¡öñRedisIn°™˚
 *
ri
, 
ªdisAsyncC⁄ãxt
 *
c
, *
ty≥
) {

2019 
«me
[64];

2021 
	`¢¥ötf
(
«me
,“ame),"£¡öñ-%.8s-%s",
£¡öñ
.
myid
,
ty≥
);

2022 i‡(
	`ªdisAsyncComm™d
(
c
, 
£¡öñDisˇrdRïlyCÆlback
, 
ri
,

2024 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"CLIENT"),

2025 
«me
Ë=
C_OK
)

2027 
ri
->
lök
->
≥ndög_comm™ds
++;

2029 
	}
}

2031 
	$ö°™˚LökNegŸüãTLS
(
ªdisAsyncC⁄ãxt
 *
c⁄ãxt
) {

2032 #i‚de‡
USE_OPENSSL


2033 (Ë
c⁄ãxt
;

2035 i‡(!
ªdis_és_˘x
Ë 
C_ERR
;

2036 
SSL
 *
s¶
 = 
	`SSL_√w
(
ªdis_és_˘x
);

2037 i‡(!
s¶
Ë 
C_ERR
;

2039 i‡(
	`ªdisInôüãSSL
(&
c⁄ãxt
->
c
, 
s¶
Ë=
REDIS_ERR
Ë 
C_ERR
;

2041  
C_OK
;

2042 
	}
}

2047 
	$£¡öñRec⁄√˘In°™˚
(
£¡öñRedisIn°™˚
 *
ri
) {

2048 i‡(
ri
->
lök
->
disc⁄√˘ed
 == 0) ;

2049 i‡(
ri
->
addr
->
p‹t
 == 0) ;

2050 
ö°™˚Lök
 *
lök
 = 
ri
->link;

2051 
m°ime_t
 
now
 = 
	`m°ime
();

2053 i‡(
now
 - 
ri
->
lök
->
œ°_ªc⁄n_time
 < 
SENTINEL_PING_PERIOD
) ;

2054 
ri
->
lök
->
œ°_ªc⁄n_time
 = 
now
;

2057 i‡(
lök
->
cc
 =
NULL
) {

2058 
lök
->
cc
 = 
	`ªdisAsyncC⁄√˘Böd
(
ri
->
addr
->
ù
,ri->addr->
p‹t
,
NET_FIRST_BIND_ADDR
);

2059 i‡(!
lök
->
cc
->
îr
 && 
£rvî
.
és_ª∂iˇti⁄
 &&

2060 (
	`ö°™˚LökNegŸüãTLS
(
lök
->
cc
Ë=
C_ERR
)) {

2061 
	`£¡öñEvít
(
LL_DEBUG
,"-cmd-lök-ªc⁄√˘i⁄",
ri
,"%@ #FailedÅo initialize TLS");

2062 
	`ö°™˚LökClo£C⁄√˘i⁄
(
lök
,lök->
cc
);

2063 } i‡(
lök
->
cc
->
îr
) {

2064 
	`£¡öñEvít
(
LL_DEBUG
,"-cmd-lök-ªc⁄√˘i⁄",
ri
,"%@ #%s",

2065 
lök
->
cc
->
îr°r
);

2066 
	`ö°™˚LökClo£C⁄√˘i⁄
(
lök
,lök->
cc
);

2068 
lök
->
≥ndög_comm™ds
 = 0;

2069 
lök
->
cc_c⁄n_time
 = 
	`m°ime
();

2070 
lök
->
cc
->
d©a
 =Üink;

2071 
	`ªdisAeAâach
(
£rvî
.
ñ
,
lök
->
cc
);

2072 
	`ªdisAsyncSëC⁄√˘CÆlback
(
lök
->
cc
,

2073 
£¡öñLökE°ablishedCÆlback
);

2074 
	`ªdisAsyncSëDisc⁄√˘CÆlback
(
lök
->
cc
,

2075 
£¡öñDisc⁄√˘CÆlback
);

2076 
	`£¡öñSídAuthIfNìded
(
ri
,
lök
->
cc
);

2077 
	`£¡öñSëClõ¡Name
(
ri
,
lök
->
cc
,"cmd");

2080 
	`£¡öñSídPög
(
ri
);

2084 i‡((
ri
->
Êags
 & (
SRI_MASTER
|
SRI_SLAVE
)Ë&& 
lök
->
pc
 =
NULL
) {

2085 
lök
->
pc
 = 
	`ªdisAsyncC⁄√˘Böd
(
ri
->
addr
->
ù
,ri->addr->
p‹t
,
NET_FIRST_BIND_ADDR
);

2086 i‡(!
lök
->
pc
->
îr
 && 
£rvî
.
és_ª∂iˇti⁄
 &&

2087 (
	`ö°™˚LökNegŸüãTLS
(
lök
->
pc
Ë=
C_ERR
)) {

2088 
	`£¡öñEvít
(
LL_DEBUG
,"-pubsub-lök-ªc⁄√˘i⁄",
ri
,"%@ #FailedÅo initialize TLS");

2089 } i‡(
lök
->
pc
->
îr
) {

2090 
	`£¡öñEvít
(
LL_DEBUG
,"-pubsub-lök-ªc⁄√˘i⁄",
ri
,"%@ #%s",

2091 
lök
->
pc
->
îr°r
);

2092 
	`ö°™˚LökClo£C⁄√˘i⁄
(
lök
,lök->
pc
);

2094 
ªtvÆ
;

2096 
lök
->
pc_c⁄n_time
 = 
	`m°ime
();

2097 
lök
->
pc
->
d©a
 =Üink;

2098 
	`ªdisAeAâach
(
£rvî
.
ñ
,
lök
->
pc
);

2099 
	`ªdisAsyncSëC⁄√˘CÆlback
(
lök
->
pc
,

2100 
£¡öñLökE°ablishedCÆlback
);

2101 
	`ªdisAsyncSëDisc⁄√˘CÆlback
(
lök
->
pc
,

2102 
£¡öñDisc⁄√˘CÆlback
);

2103 
	`£¡öñSídAuthIfNìded
(
ri
,
lök
->
pc
);

2104 
	`£¡öñSëClõ¡Name
(
ri
,
lök
->
pc
,"pubsub");

2106 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
lök
->
pc
,

2107 
£¡öñRe˚iveHñloMesßges
, 
ri
, "%s %s",

2108 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"SUBSCRIBE"),

2109 
SENTINEL_HELLO_CHANNEL
);

2110 i‡(
ªtvÆ
 !
C_OK
) {

2113 
	`ö°™˚LökClo£C⁄√˘i⁄
(
lök
,lök->
pc
);

2120 i‡(
lök
->
cc
 && (
ri
->
Êags
 & 
SRI_SENTINEL
 ||Üök->
pc
))

2121 
lök
->
disc⁄√˘ed
 = 0;

2122 
	}
}

2131 
	$£¡öñMa°îLooksS™e
(
£¡öñRedisIn°™˚
 *
ma°î
) {

2133 
ma°î
->
Êags
 & 
SRI_MASTER
 &&

2134 
ma°î
->
rﬁe_ªp‹ãd
 =
SRI_MASTER
 &&

2135 (
ma°î
->
Êags
 & (
SRI_S_DOWN
|
SRI_O_DOWN
)) == 0 &&

2136 (
	`m°ime
(Ë- 
ma°î
->
öfo_ª‰esh
Ë< 
SENTINEL_INFO_PERIOD
*2;

2137 
	}
}

2140 
	$£¡öñRe‰eshIn°™˚Info
(
£¡öñRedisIn°™˚
 *
ri
, c⁄° *
öfo
) {

2141 
sds
 *
löes
;

2142 
numlöes
, 
j
;

2143 
rﬁe
 = 0;

2146 
	`sds‰ì
(
ri
->
öfo
);

2147 
ri
->
öfo
 = 
	`sd¢ew
(info);

2151 
ri
->
ma°î_lök_down_time
 = 0;

2154 
löes
 = 
	`sds•lôÀn
(
öfo
,
	`°æí
(öfo),"\r\n",2,&
numlöes
);

2155 
j
 = 0; j < 
numlöes
; j++) {

2156 
£¡öñRedisIn°™˚
 *
¶ave
;

2157 
sds
 
l
 = 
löes
[
j
];

2160 i‡(
	`sd¶í
(
l
Ë>47 && !
	`memcmp
(l,"run_id:",7)) {

2161 i‡(
ri
->
runid
 =
NULL
) {

2162 
ri
->
runid
 = 
	`sd¢ewÀn
(
l
+7,40);

2164 i‡(
	`°∫cmp
(
ri
->
runid
,
l
+7,40) != 0) {

2165 
	`£¡öñEvít
(
LL_NOTICE
,"+ªboŸ",
ri
,"%@");

2166 
	`sds‰ì
(
ri
->
runid
);

2167 
ri
->
runid
 = 
	`sd¢ewÀn
(
l
+7,40);

2174 i‡((
ri
->
Êags
 & 
SRI_MASTER
) &&

2175 
	`sd¶í
(
l
) >= 7 &&

2176 !
	`memcmp
(
l
,"¶ave",5Ë&& 
	`isdigô
(l[5]))

2178 *
ù
, *
p‹t
, *
íd
;

2180 i‡(
	`°r°r
(
l
,"ù="Ë=
NULL
) {

2182 
ù
 = 
	`°rchr
(
l
,':'); if (!ip) ;

2183 
ù
++;

2184 
p‹t
 = 
	`°rchr
(
ù
,','); if (!port) ;

2185 *
p‹t
 = '\0';

2186 
p‹t
++;

2187 
íd
 = 
	`°rchr
(
p‹t
,','); if (!end) ;

2188 *
íd
 = '\0';

2191 
ù
 = 
	`°r°r
(
l
,"ip="); if (!ip) ;

2192 
ù
 += 3;

2193 
p‹t
 = 
	`°r°r
(
l
,"port="); if (!port) ;

2194 
p‹t
 += 5;

2196 
íd
 = 
	`°rchr
(
ù
,','); if (end) *end = '\0';

2197 
íd
 = 
	`°rchr
(
p‹t
,','); if (end) *end = '\0';

2202 i‡(
	`£¡öñRedisIn°™˚LookupSœve
(
ri
,
ù
,
	`©oi
(
p‹t
)Ë=
NULL
) {

2203 i‡((
¶ave
 = 
	`¸óãSítöñRedisIn°™˚
(
NULL
,
SRI_SLAVE
,
ù
,

2204 
	`©oi
(
p‹t
), 
ri
->
qu‹um
,Ñi)Ë!
NULL
)

2206 
	`£¡öñEvít
(
LL_NOTICE
,"+¶ave",
¶ave
,"%@");

2207 
	`£¡öñFlushC⁄fig
();

2213 i‡(
	`sd¶í
(
l
) >= 32 &&

2214 !
	`memcmp
(
l
,"master_link_down_since_seconds",30))

2216 
ri
->
ma°î_lök_down_time
 = 
	`°πﬁl
(
l
+31,
NULL
,10)*1000;

2220 i‡(!
	`memcmp
(
l
,"rﬁe:ma°î",11)Ë
rﬁe
 = 
SRI_MASTER
;

2221 i‡(!
	`memcmp
(
l
,"rﬁe:¶ave",10)Ë
rﬁe
 = 
SRI_SLAVE
;

2223 i‡(
rﬁe
 =
SRI_SLAVE
) {

2225 i‡(
	`sd¶í
(
l
Ë>12 && !
	`memcmp
(l,"master_host:",12)) {

2226 i‡(
ri
->
¶ave_ma°î_ho°
 =
NULL
 ||

2227 
	`°rˇ£cmp
(
l
+12,
ri
->
¶ave_ma°î_ho°
))

2229 
	`sds‰ì
(
ri
->
¶ave_ma°î_ho°
);

2230 
ri
->
¶ave_ma°î_ho°
 = 
	`sd¢ew
(
l
+12);

2231 
ri
->
¶ave_c⁄f_ch™ge_time
 = 
	`m°ime
();

2236 i‡(
	`sd¶í
(
l
Ë>12 && !
	`memcmp
(l,"master_port:",12)) {

2237 
¶ave_ma°î_p‹t
 = 
	`©oi
(
l
+12);

2239 i‡(
ri
->
¶ave_ma°î_p‹t
 != slave_master_port) {

2240 
ri
->
¶ave_ma°î_p‹t
 = slave_master_port;

2241 
ri
->
¶ave_c⁄f_ch™ge_time
 = 
	`m°ime
();

2246 i‡(
	`sd¶í
(
l
Ë>19 && !
	`memcmp
(l,"master_link_status:",19)) {

2247 
ri
->
¶ave_ma°î_lök_°©us
 =

2248 (
	`°rˇ£cmp
(
l
+19,"up") == 0) ?

2249 
SENTINEL_MASTER_LINK_STATUS_UP
 :

2250 
SENTINEL_MASTER_LINK_STATUS_DOWN
;

2254 i‡(
	`sd¶í
(
l
Ë>15 && !
	`memcmp
(l,"slave_priority:",15))

2255 
ri
->
¶ave_¥i‹ôy
 = 
	`©oi
(
l
+15);

2258 i‡(
	`sd¶í
(
l
Ë>18 && !
	`memcmp
(l,"slave_repl_offset:",18))

2259 
ri
->
¶ave_ª∂_off£t
 = 
	`°πouŒ
(
l
+18,
NULL
,10);

2262 
ri
->
öfo_ª‰esh
 = 
	`m°ime
();

2263 
	`sds‰ì•lôªs
(
löes
,
numlöes
);

2270 i‡(
rﬁe
 !
ri
->
rﬁe_ªp‹ãd
) {

2271 
ri
->
rﬁe_ªp‹ãd_time
 = 
	`m°ime
();

2272 
ri
->
rﬁe_ªp‹ãd
 = 
rﬁe
;

2273 i‡(
rﬁe
 =
SRI_SLAVE
Ë
ri
->
¶ave_c⁄f_ch™ge_time
 = 
	`m°ime
();

2276 
	`£¡öñEvít
(
LL_VERBOSE
,

2277 ((
ri
->
Êags
 & (
SRI_MASTER
|
SRI_SLAVE
)Ë=
rﬁe
) ?

2279 
ri
, "%@ÇewÑeportedÑole is %s",

2280 
rﬁe
 =
SRI_MASTER
 ? "master" : "slave",

2281 
ri
->
Êags
 & 
SRI_MASTER
 ? "master" : "slave");

2286 i‡(
£¡öñ
.
tût
) ;

2289 i‡((
ri
->
Êags
 & 
SRI_MASTER
Ë&& 
rﬁe
 =
SRI_SLAVE
) {

2296 i‡((
ri
->
Êags
 & 
SRI_SLAVE
Ë&& 
rﬁe
 =
SRI_MASTER
) {

2299 i‡((
ri
->
Êags
 & 
SRI_PROMOTED
) &&

2300 (
ri
->
ma°î
->
Êags
 & 
SRI_FAILOVER_IN_PROGRESS
) &&

2301 (
ri
->
ma°î
->
Áûovî_°©e
 ==

2302 
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
))

2309 
ri
->
ma°î
->
c⁄fig_ïoch
 =Ñi->ma°î->
Áûovî_ïoch
;

2310 
ri
->
ma°î
->
Áûovî_°©e
 = 
SENTINEL_FAILOVER_STATE_RECONF_SLAVES
;

2311 
ri
->
ma°î
->
Áûovî_°©e_ch™ge_time
 = 
	`m°ime
();

2312 
	`£¡öñFlushC⁄fig
();

2313 
	`£¡öñEvít
(
LL_WARNING
,"+¥omŸed-¶ave",
ri
,"%@");

2314 i‡(
£¡öñ
.
simÁûuª_Êags
 &

2315 
SENTINEL_SIMFAILURE_CRASH_AFTER_PROMOTION
)

2316 
	`£¡öñSimFaûuªCøsh
();

2317 
	`£¡öñEvít
(
LL_WARNING
,"+failover-state-reconf-slaves",

2318 
ri
->
ma°î
,"%@");

2319 
	`£¡öñCÆlClõ¡Rec⁄fS¸ùt
(
ri
->
ma°î
,
SENTINEL_LEADER
,

2320 "°¨t",
ri
->
ma°î
->
addr
,ri->addr);

2321 
	`£¡öñF‹˚HñloUpd©eF‹Ma°î
(
ri
->
ma°î
);

2326 
m°ime_t
 
waô_time
 = 
SENTINEL_PUBLISH_PERIOD
*4;

2328 i‡(!(
ri
->
Êags
 & 
SRI_PROMOTED
) &&

2329 
	`£¡öñMa°îLooksS™e
(
ri
->
ma°î
) &&

2330 
	`£¡öñRedisIn°™˚NoDownF‹
(
ri
,
waô_time
) &&

2331 
	`m°ime
(Ë- 
ri
->
rﬁe_ªp‹ãd_time
 > 
waô_time
)

2333 
ªtvÆ
 = 
	`£¡öñSídSœveOf
(
ri
,

2334 
ri
->
ma°î
->
addr
->
ù
,

2335 
ri
->
ma°î
->
addr
->
p‹t
);

2336 i‡(
ªtvÆ
 =
C_OK
)

2337 
	`£¡öñEvít
(
LL_NOTICE
,"+c⁄vît-to-¶ave",
ri
,"%@");

2343 i‡((
ri
->
Êags
 & 
SRI_SLAVE
) &&

2344 
rﬁe
 =
SRI_SLAVE
 &&

2345 (
ri
->
¶ave_ma°î_p‹t
 !ri->
ma°î
->
addr
->
p‹t
 ||

2346 
	`°rˇ£cmp
(
ri
->
¶ave_ma°î_ho°
,ri->
ma°î
->
addr
->
ù
)))

2348 
m°ime_t
 
waô_time
 = 
ri
->
ma°î
->
Áûovî_timeout
;

2352 i‡(
	`£¡öñMa°îLooksS™e
(
ri
->
ma°î
) &&

2353 
	`£¡öñRedisIn°™˚NoDownF‹
(
ri
,
waô_time
) &&

2354 
	`m°ime
(Ë- 
ri
->
¶ave_c⁄f_ch™ge_time
 > 
waô_time
)

2356 
ªtvÆ
 = 
	`£¡öñSídSœveOf
(
ri
,

2357 
ri
->
ma°î
->
addr
->
ù
,

2358 
ri
->
ma°î
->
addr
->
p‹t
);

2359 i‡(
ªtvÆ
 =
C_OK
)

2360 
	`£¡öñEvít
(
LL_NOTICE
,"+fix-¶ave-c⁄fig",
ri
,"%@");

2366 i‡((
ri
->
Êags
 & 
SRI_SLAVE
Ë&& 
rﬁe
 == SRI_SLAVE &&

2367 (
ri
->
Êags
 & (
SRI_RECONF_SENT
|
SRI_RECONF_INPROG
)))

2370 i‡((
ri
->
Êags
 & 
SRI_RECONF_SENT
) &&

2371 
ri
->
¶ave_ma°î_ho°
 &&

2372 
	`°rcmp
(
ri
->
¶ave_ma°î_ho°
,

2373 
ri
->
ma°î
->
¥omŸed_¶ave
->
addr
->
ù
) == 0 &&

2374 
ri
->
¶ave_ma°î_p‹t
 =ri->
ma°î
->
¥omŸed_¶ave
->
addr
->
p‹t
)

2376 
ri
->
Êags
 &~
SRI_RECONF_SENT
;

2377 
ri
->
Êags
 |
SRI_RECONF_INPROG
;

2378 
	`£¡öñEvít
(
LL_NOTICE
,"+¶ave-ªc⁄f-ö¥og",
ri
,"%@");

2382 i‡((
ri
->
Êags
 & 
SRI_RECONF_INPROG
) &&

2383 
ri
->
¶ave_ma°î_lök_°©us
 =
SENTINEL_MASTER_LINK_STATUS_UP
)

2385 
ri
->
Êags
 &~
SRI_RECONF_INPROG
;

2386 
ri
->
Êags
 |
SRI_RECONF_DONE
;

2387 
	`£¡öñEvít
(
LL_NOTICE
,"+¶ave-ªc⁄f-d⁄e",
ri
,"%@");

2390 
	}
}

2392 
	$£¡öñInfoRïlyCÆlback
(
ªdisAsyncC⁄ãxt
 *
c
, *
ª∂y
, *
¥ivd©a
) {

2393 
£¡öñRedisIn°™˚
 *
ri
 = 
¥ivd©a
;

2394 
ö°™˚Lök
 *
lök
 = 
c
->
d©a
;

2395 
ªdisRïly
 *
r
;

2397 i‡(!
ª∂y
 || !
lök
) ;

2398 
lök
->
≥ndög_comm™ds
--;

2399 
r
 = 
ª∂y
;

2401 i‡(
r
->
ty≥
 =
REDIS_REPLY_STRING
)

2402 
	`£¡öñRe‰eshIn°™˚Info
(
ri
,
r
->
°r
);

2403 
	}
}

2407 
	$£¡öñDisˇrdRïlyCÆlback
(
ªdisAsyncC⁄ãxt
 *
c
, *
ª∂y
, *
¥ivd©a
) {

2408 
ö°™˚Lök
 *
lök
 = 
c
->
d©a
;

2409 
	`UNUSED
(
ª∂y
);

2410 
	`UNUSED
(
¥ivd©a
);

2412 i‡(
lök
Ëlök->
≥ndög_comm™ds
--;

2413 
	}
}

2415 
	$£¡öñPögRïlyCÆlback
(
ªdisAsyncC⁄ãxt
 *
c
, *
ª∂y
, *
¥ivd©a
) {

2416 
£¡öñRedisIn°™˚
 *
ri
 = 
¥ivd©a
;

2417 
ö°™˚Lök
 *
lök
 = 
c
->
d©a
;

2418 
ªdisRïly
 *
r
;

2420 i‡(!
ª∂y
 || !
lök
) ;

2421 
lök
->
≥ndög_comm™ds
--;

2422 
r
 = 
ª∂y
;

2424 i‡(
r
->
ty≥
 =
REDIS_REPLY_STATUS
 ||

2425 
r
->
ty≥
 =
REDIS_REPLY_ERROR
) {

2428 i‡(
	`°∫cmp
(
r
->
°r
,"PONG",4) == 0 ||

2429 
	`°∫cmp
(
r
->
°r
,"LOADING",7) == 0 ||

2430 
	`°∫cmp
(
r
->
°r
,"MASTERDOWN",10) == 0)

2432 
lök
->
œ°_avaû_time
 = 
	`m°ime
();

2433 
lök
->
a˘_pög_time
 = 0;

2437 i‡(
	`°∫cmp
(
r
->
°r
,"BUSY",4) == 0 &&

2438 (
ri
->
Êags
 & 
SRI_S_DOWN
) &&

2439 !(
ri
->
Êags
 & 
SRI_SCRIPT_KILL_SENT
))

2441 i‡(
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

2442 
£¡öñDisˇrdRïlyCÆlback
, 
ri
,

2444 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"SCRIPT")Ë=
C_OK
)

2446 
ri
->
lök
->
≥ndög_comm™ds
++;

2448 
ri
->
Êags
 |
SRI_SCRIPT_KILL_SENT
;

2452 
lök
->
œ°_p⁄g_time
 = 
	`m°ime
();

2453 
	}
}

2457 
	$£¡öñPublishRïlyCÆlback
(
ªdisAsyncC⁄ãxt
 *
c
, *
ª∂y
, *
¥ivd©a
) {

2458 
£¡öñRedisIn°™˚
 *
ri
 = 
¥ivd©a
;

2459 
ö°™˚Lök
 *
lök
 = 
c
->
d©a
;

2460 
ªdisRïly
 *
r
;

2462 i‡(!
ª∂y
 || !
lök
) ;

2463 
lök
->
≥ndög_comm™ds
--;

2464 
r
 = 
ª∂y
;

2468 i‡(
r
->
ty≥
 !
REDIS_REPLY_ERROR
)

2469 
ri
->
œ°_pub_time
 = 
	`m°ime
();

2470 
	}
}

2477 
	$£¡öñPro˚ssHñloMesßge
(*
hñlo
, 
hñlo_Àn
) {

2481 
numtokís
, 
p‹t
, 
ªmoved
, 
ma°î_p‹t
;

2482 
uöt64_t
 
cuºít_ïoch
, 
ma°î_c⁄fig_ïoch
;

2483 **
tokí
 = 
	`sds•lôÀn
(
hñlo
, 
hñlo_Àn
, ",", 1, &
numtokís
);

2484 
£¡öñRedisIn°™˚
 *
si
, *
ma°î
;

2486 i‡(
numtokís
 == 8) {

2488 
ma°î
 = 
	`£¡öñGëMa°îByName
(
tokí
[4]);

2489 i‡(!
ma°î
Ë
˛ónup
;

2492 
p‹t
 = 
	`©oi
(
tokí
[1]);

2493 
ma°î_p‹t
 = 
	`©oi
(
tokí
[6]);

2494 
si
 = 
	`gëSítöñRedisIn°™˚ByAddrAndRunID
(

2495 
ma°î
->
£¡öñs
,
tokí
[0],
p‹t
,token[2]);

2496 
cuºít_ïoch
 = 
	`°πouŒ
(
tokí
[3],
NULL
,10);

2497 
ma°î_c⁄fig_ïoch
 = 
	`°πouŒ
(
tokí
[7],
NULL
,10);

2499 i‡(!
si
) {

2503 
ªmoved
 = 
	`ªmoveM©chögSítöñFromMa°î
(
ma°î
,
tokí
[2]);

2504 i‡(
ªmoved
) {

2505 
	`£¡öñEvít
(
LL_NOTICE
,"+£¡öñ-addªss-swôch",
ma°î
,

2506 "%@ i∞%†p‹à%d f‹ %s", 
tokí
[0],
p‹t
,token[2]);

2512 
£¡öñRedisIn°™˚
 *
Ÿhî
 =

2513 
	`gëSítöñRedisIn°™˚ByAddrAndRunID
(

2514 
ma°î
->
£¡öñs
, 
tokí
[0],
p‹t
,
NULL
);

2515 i‡(
Ÿhî
) {

2516 
	`£¡öñEvít
(
LL_NOTICE
,"+£¡öñ-övÆid-addr",
Ÿhî
,"%@");

2517 
Ÿhî
->
addr
->
p‹t
 = 0;

2518 
	`£¡öñUpd©eSítöñAddªssInAŒMa°îs
(
Ÿhî
);

2523 
si
 = 
	`¸óãSítöñRedisIn°™˚
(
tokí
[2],
SRI_SENTINEL
,

2524 
tokí
[0],
p‹t
,
ma°î
->
qu‹um
,master);

2526 i‡(
si
) {

2527 i‡(!
ªmoved
Ë
	`£¡öñEvít
(
LL_NOTICE
,"+£¡öñ",
si
,"%@");

2531 
si
->
runid
 = 
	`sd¢ew
(
tokí
[2]);

2532 
	`£¡öñTryC⁄√˘i⁄Sh¨ög
(
si
);

2533 i‡(
ªmoved
Ë
	`£¡öñUpd©eSítöñAddªssInAŒMa°îs
(
si
);

2534 
	`£¡öñFlushC⁄fig
();

2539 i‡(
cuºít_ïoch
 > 
£¡öñ
.current_epoch) {

2540 
£¡öñ
.
cuºít_ïoch
 = current_epoch;

2541 
	`£¡öñFlushC⁄fig
();

2542 
	`£¡öñEvít
(
LL_WARNING
,"+√w-ïoch",
ma°î
,"%llu",

2543 (Ë
£¡öñ
.
cuºít_ïoch
);

2547 i‡(
si
 && 
ma°î
->
c⁄fig_ïoch
 < 
ma°î_c⁄fig_ïoch
) {

2548 
ma°î
->
c⁄fig_ïoch
 = 
ma°î_c⁄fig_ïoch
;

2549 i‡(
ma°î_p‹t
 !
ma°î
->
addr
->
p‹t
 ||

2550 
	`°rcmp
(
ma°î
->
addr
->
ù
, 
tokí
[5]))

2552 
£¡öñAddr
 *
ﬁd_addr
;

2554 
	`£¡öñEvít
(
LL_WARNING
,"+c⁄fig-upd©e-‰om",
si
,"%@");

2555 
	`£¡öñEvít
(
LL_WARNING
,"+switch-master",

2556 
ma°î
,"%s %s %d %s %d",

2557 
ma°î
->
«me
,

2558 
ma°î
->
addr
->
ù
, ma°î->addr->
p‹t
,

2559 
tokí
[5], 
ma°î_p‹t
);

2561 
ﬁd_addr
 = 
	`dupSítöñAddr
(
ma°î
->
addr
);

2562 
	`£¡öñRe£tMa°îAndCh™geAddªss
(
ma°î
, 
tokí
[5], 
ma°î_p‹t
);

2563 
	`£¡öñCÆlClõ¡Rec⁄fS¸ùt
(
ma°î
,

2564 
SENTINEL_OBSERVER
,"start",

2565 
ﬁd_addr
,
ma°î
->
addr
);

2566 
	`ªÀa£SítöñAddr
(
ﬁd_addr
);

2571 i‡(
si
Ësi->
œ°_hñlo_time
 = 
	`m°ime
();

2574 
˛ónup
:

2575 
	`sds‰ì•lôªs
(
tokí
,
numtokís
);

2576 
	}
}

2581 
	$£¡öñRe˚iveHñloMesßges
(
ªdisAsyncC⁄ãxt
 *
c
, *
ª∂y
, *
¥ivd©a
) {

2582 
£¡öñRedisIn°™˚
 *
ri
 = 
¥ivd©a
;

2583 
ªdisRïly
 *
r
;

2584 
	`UNUSED
(
c
);

2586 i‡(!
ª∂y
 || !
ri
) ;

2587 
r
 = 
ª∂y
;

2592 
ri
->
lök
->
pc_œ°_a˘ivôy
 = 
	`m°ime
();

2596 i‡(
r
->
ty≥
 !
REDIS_REPLY_ARRAY
 ||

2597 
r
->
ñemíts
 != 3 ||

2598 
r
->
ñemít
[0]->
ty≥
 !
REDIS_REPLY_STRING
 ||

2599 
r
->
ñemít
[1]->
ty≥
 !
REDIS_REPLY_STRING
 ||

2600 
r
->
ñemít
[2]->
ty≥
 !
REDIS_REPLY_STRING
 ||

2601 
	`°rcmp
(
r
->
ñemít
[0]->
°r
,"message") != 0) ;

2604 i‡(
	`°r°r
(
r
->
ñemít
[2]->
°r
,
£¡öñ
.
myid
Ë!
NULL
) ;

2606 
	`£¡öñPro˚ssHñloMesßge
(
r
->
ñemít
[2]->
°r
,Ñ->ñemít[2]->
Àn
);

2607 
	}
}

2620 
	$£¡öñSídHñlo
(
£¡öñRedisIn°™˚
 *
ri
) {

2621 
ù
[
NET_IP_STR_LEN
];

2622 
∑ylﬂd
[
NET_IP_STR_LEN
+1024];

2623 
ªtvÆ
;

2624 *
™noun˚_ù
;

2625 
™noun˚_p‹t
;

2626 
£¡öñRedisIn°™˚
 *
ma°î
 = (
ri
->
Êags
 & 
SRI_MASTER
) ?Ñi :Ñi->master;

2627 
£¡öñAddr
 *
ma°î_addr
 = 
	`£¡öñGëCuºítMa°îAddªss
(
ma°î
);

2629 i‡(
ri
->
lök
->
disc⁄√˘ed
Ë 
C_ERR
;

2633 i‡(
£¡öñ
.
™noun˚_ù
) {

2634 
™noun˚_ù
 = 
£¡öñ
.announce_ip;

2636 i‡(
	`™ëSockName
(
ri
->
lök
->
cc
->
c
.
fd
,
ù
,(ù),
NULL
) == -1)

2637  
C_ERR
;

2638 
™noun˚_ù
 = 
ù
;

2640 i‡(
£¡öñ
.
™noun˚_p‹t
)ánnounce_port = sentinel.announce_port;

2641 i‡(
£rvî
.
és_ª∂iˇti⁄
 && sîvî.
és_p‹t
Ë
™noun˚_p‹t
 = server.tls_port;

2642 
™noun˚_p‹t
 = 
£rvî
.
p‹t
;

2645 
	`¢¥ötf
(
∑ylﬂd
,(payload),

2648 
™noun˚_ù
, 
™noun˚_p‹t
, 
£¡öñ
.
myid
,

2649 (Ë
£¡öñ
.
cuºít_ïoch
,

2651 
ma°î
->
«me
,
ma°î_addr
->
ù
,ma°î_addr->
p‹t
,

2652 (Ë
ma°î
->
c⁄fig_ïoch
);

2653 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

2654 
£¡öñPublishRïlyCÆlback
, 
ri
, "%s %s %s",

2655 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"PUBLISH"),

2656 
SENTINEL_HELLO_CHANNEL
,
∑ylﬂd
);

2657 i‡(
ªtvÆ
 !
C_OK
Ë 
C_ERR
;

2658 
ri
->
lök
->
≥ndög_comm™ds
++;

2659  
C_OK
;

2660 
	}
}

2664 
	$£¡öñF‹˚HñloUpd©eDi˘OfRedisIn°™˚s
(
di˘
 *
ö°™˚s
) {

2665 
di˘Iãøt‹
 *
di
;

2666 
di˘E¡ry
 *
de
;

2668 
di
 = 
	`di˘GëSa„Iãøt‹
(
ö°™˚s
);

2669 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

2670 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

2671 i‡(
ri
->
œ°_pub_time
 >(
SENTINEL_PUBLISH_PERIOD
+1))

2672 
ri
->
œ°_pub_time
 -(
SENTINEL_PUBLISH_PERIOD
+1);

2674 
	`di˘Rñó£Iãøt‹
(
di
);

2675 
	}
}

2685 
	$£¡öñF‹˚HñloUpd©eF‹Ma°î
(
£¡öñRedisIn°™˚
 *
ma°î
) {

2686 i‡(!(
ma°î
->
Êags
 & 
SRI_MASTER
)Ë 
C_ERR
;

2687 i‡(
ma°î
->
œ°_pub_time
 >(
SENTINEL_PUBLISH_PERIOD
+1))

2688 
ma°î
->
œ°_pub_time
 -(
SENTINEL_PUBLISH_PERIOD
+1);

2689 
	`£¡öñF‹˚HñloUpd©eDi˘OfRedisIn°™˚s
(
ma°î
->
£¡öñs
);

2690 
	`£¡öñF‹˚HñloUpd©eDi˘OfRedisIn°™˚s
(
ma°î
->
¶aves
);

2691  
C_OK
;

2692 
	}
}

2699 
	$£¡öñSídPög
(
£¡öñRedisIn°™˚
 *
ri
) {

2700 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

2701 
£¡öñPögRïlyCÆlback
, 
ri
, "%s",

2702 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"PING"));

2703 i‡(
ªtvÆ
 =
C_OK
) {

2704 
ri
->
lök
->
≥ndög_comm™ds
++;

2705 
ri
->
lök
->
œ°_pög_time
 = 
	`m°ime
();

2709 i‡(
ri
->
lök
->
a˘_pög_time
 == 0)

2710 
ri
->
lök
->
a˘_pög_time
 =Ñi->lök->
œ°_pög_time
;

2715 
	}
}

2719 
	$£¡öñSídPîiodicComm™ds
(
£¡öñRedisIn°™˚
 *
ri
) {

2720 
m°ime_t
 
now
 = 
	`m°ime
();

2721 
m°ime_t
 
öfo_≥riod
, 
pög_≥riod
;

2722 
ªtvÆ
;

2726 i‡(
ri
->
lök
->
disc⁄√˘ed
) ;

2734 i‡(
ri
->
lök
->
≥ndög_comm™ds
 >=

2735 
SENTINEL_MAX_PENDING_COMMANDS
 * 
ri
->
lök
->
ªfcou¡
) ;

2745 i‡((
ri
->
Êags
 & 
SRI_SLAVE
) &&

2746 ((
ri
->
ma°î
->
Êags
 & (
SRI_O_DOWN
|
SRI_FAILOVER_IN_PROGRESS
)) ||

2747 (
ri
->
ma°î_lök_down_time
 != 0)))

2749 
öfo_≥riod
 = 1000;

2751 
öfo_≥riod
 = 
SENTINEL_INFO_PERIOD
;

2757 
pög_≥riod
 = 
ri
->
down_a·î_≥riod
;

2758 i‡(
pög_≥riod
 > 
SENTINEL_PING_PERIOD
)Öing_period = SENTINEL_PING_PERIOD;

2761 i‡((
ri
->
Êags
 & 
SRI_SENTINEL
) == 0 &&

2762 (
ri
->
öfo_ª‰esh
 == 0 ||

2763 (
now
 - 
ri
->
öfo_ª‰esh
Ë> 
öfo_≥riod
))

2765 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

2766 
£¡öñInfoRïlyCÆlback
, 
ri
, "%s",

2767 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"INFO"));

2768 i‡(
ªtvÆ
 =
C_OK
Ë
ri
->
lök
->
≥ndög_comm™ds
++;

2772 i‡((
now
 - 
ri
->
lök
->
œ°_p⁄g_time
Ë> 
pög_≥riod
 &&

2773 (
now
 - 
ri
->
lök
->
œ°_pög_time
Ë> 
pög_≥riod
/2) {

2774 
	`£¡öñSídPög
(
ri
);

2778 i‡((
now
 - 
ri
->
œ°_pub_time
Ë> 
SENTINEL_PUBLISH_PERIOD
) {

2779 
	`£¡öñSídHñlo
(
ri
);

2781 
	}
}

2785 c⁄° *
	$£¡öñFaûovîSèãSå
(
°©e
) {

2786 
°©e
) {

2787 
SENTINEL_FAILOVER_STATE_NONE
:  "none";

2788 
SENTINEL_FAILOVER_STATE_WAIT_START
:  "wait_start";

2789 
SENTINEL_FAILOVER_STATE_SELECT_SLAVE
:  "select_slave";

2790 
SENTINEL_FAILOVER_STATE_SEND_SLAVEOF_NOONE
:  "send_slaveof_noone";

2791 
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
:  "wait_promotion";

2792 
SENTINEL_FAILOVER_STATE_RECONF_SLAVES
:  "reconf_slaves";

2793 
SENTINEL_FAILOVER_STATE_UPDATE_CONFIG
:  "update_config";

2796 
	}
}

2799 
	$addRïlySítöñRedisIn°™˚
(
˛õ¡
 *
c
, 
£¡öñRedisIn°™˚
 *
ri
) {

2800 *
Êags
 = 
	`sd£m±y
();

2801 *
mbl
;

2802 
fõlds
 = 0;

2804 
mbl
 = 
	`addRïlyDe„ºedLí
(
c
);

2806 
	`addRïlyBulkCSåög
(
c
,"name");

2807 
	`addRïlyBulkCSåög
(
c
,
ri
->
«me
);

2808 
fõlds
++;

2810 
	`addRïlyBulkCSåög
(
c
,"ip");

2811 
	`addRïlyBulkCSåög
(
c
,
ri
->
addr
->
ù
);

2812 
fõlds
++;

2814 
	`addRïlyBulkCSåög
(
c
,"port");

2815 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
addr
->
p‹t
);

2816 
fõlds
++;

2818 
	`addRïlyBulkCSåög
(
c
,"runid");

2819 
	`addRïlyBulkCSåög
(
c
,
ri
->
runid
 ?Ñi->runid : "");

2820 
fõlds
++;

2822 
	`addRïlyBulkCSåög
(
c
,"flags");

2823 i‡(
ri
->
Êags
 & 
SRI_S_DOWN
ËÊag†
	`sdsˇt
(flags,"s_down,");

2824 i‡(
ri
->
Êags
 & 
SRI_O_DOWN
ËÊag†
	`sdsˇt
(flags,"o_down,");

2825 i‡(
ri
->
Êags
 & 
SRI_MASTER
ËÊag†
	`sdsˇt
(flags,"master,");

2826 i‡(
ri
->
Êags
 & 
SRI_SLAVE
ËÊag†
	`sdsˇt
(flags,"slave,");

2827 i‡(
ri
->
Êags
 & 
SRI_SENTINEL
ËÊag†
	`sdsˇt
(flags,"sentinel,");

2828 i‡(
ri
->
lök
->
disc⁄√˘ed
Ë
Êags
 = 
	`sdsˇt
(flags,"disconnected,");

2829 i‡(
ri
->
Êags
 & 
SRI_MASTER_DOWN
ËÊag†
	`sdsˇt
(flags,"master_down,");

2830 i‡(
ri
->
Êags
 & 
SRI_FAILOVER_IN_PROGRESS
)

2831 
Êags
 = 
	`sdsˇt
(flags,"failover_in_progress,");

2832 i‡(
ri
->
Êags
 & 
SRI_PROMOTED
ËÊag†
	`sdsˇt
(flags,"promoted,");

2833 i‡(
ri
->
Êags
 & 
SRI_RECONF_SENT
ËÊag†
	`sdsˇt
(flags,"reconf_sent,");

2834 i‡(
ri
->
Êags
 & 
SRI_RECONF_INPROG
ËÊag†
	`sdsˇt
(flags,"reconf_inprog,");

2835 i‡(
ri
->
Êags
 & 
SRI_RECONF_DONE
ËÊag†
	`sdsˇt
(flags,"reconf_done,");

2837 i‡(
	`sd¶í
(
Êags
Ë!0Ë
	`sd§™ge
(flags,0,-2);

2838 
	`addRïlyBulkCSåög
(
c
,
Êags
);

2839 
	`sds‰ì
(
Êags
);

2840 
fõlds
++;

2842 
	`addRïlyBulkCSåög
(
c
,"link-pending-commands");

2843 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
lök
->
≥ndög_comm™ds
);

2844 
fõlds
++;

2846 
	`addRïlyBulkCSåög
(
c
,"link-refcount");

2847 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
lök
->
ªfcou¡
);

2848 
fõlds
++;

2850 i‡(
ri
->
Êags
 & 
SRI_FAILOVER_IN_PROGRESS
) {

2851 
	`addRïlyBulkCSåög
(
c
,"failover-state");

2852 
	`addRïlyBulkCSåög
(
c
,(*)
	`£¡öñFaûovîSèãSå
(
ri
->
Áûovî_°©e
));

2853 
fõlds
++;

2856 
	`addRïlyBulkCSåög
(
c
,"last-ping-sent");

2857 
	`addRïlyBulkL⁄gL⁄g
(
c
,

2858 
ri
->
lök
->
a˘_pög_time
 ? (
	`m°ime
() -Ñi->link->act_ping_time) : 0);

2859 
fõlds
++;

2861 
	`addRïlyBulkCSåög
(
c
,"last-ok-ping-reply");

2862 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`m°ime
(Ë- 
ri
->
lök
->
œ°_avaû_time
);

2863 
fõlds
++;

2865 
	`addRïlyBulkCSåög
(
c
,"last-ping-reply");

2866 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`m°ime
(Ë- 
ri
->
lök
->
œ°_p⁄g_time
);

2867 
fõlds
++;

2869 i‡(
ri
->
Êags
 & 
SRI_S_DOWN
) {

2870 
	`addRïlyBulkCSåög
(
c
,"s-down-time");

2871 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`m°ime
()-
ri
->
s_down_sö˚_time
);

2872 
fõlds
++;

2875 i‡(
ri
->
Êags
 & 
SRI_O_DOWN
) {

2876 
	`addRïlyBulkCSåög
(
c
,"o-down-time");

2877 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`m°ime
()-
ri
->
o_down_sö˚_time
);

2878 
fõlds
++;

2881 
	`addRïlyBulkCSåög
(
c
,"down-after-milliseconds");

2882 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
down_a·î_≥riod
);

2883 
fõlds
++;

2886 i‡(
ri
->
Êags
 & (
SRI_MASTER
|
SRI_SLAVE
)) {

2887 
	`addRïlyBulkCSåög
(
c
,"info-refresh");

2888 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`m°ime
(Ë- 
ri
->
öfo_ª‰esh
);

2889 
fõlds
++;

2891 
	`addRïlyBulkCSåög
(
c
,"role-reported");

2892 
	`addRïlyBulkCSåög
(
c
, (
ri
->
rﬁe_ªp‹ãd
 =
SRI_MASTER
) ? "master" :

2894 
fõlds
++;

2896 
	`addRïlyBulkCSåög
(
c
,"role-reported-time");

2897 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`m°ime
(Ë- 
ri
->
rﬁe_ªp‹ãd_time
);

2898 
fõlds
++;

2902 i‡(
ri
->
Êags
 & 
SRI_MASTER
) {

2903 
	`addRïlyBulkCSåög
(
c
,"config-epoch");

2904 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
c⁄fig_ïoch
);

2905 
fõlds
++;

2907 
	`addRïlyBulkCSåög
(
c
,"num-slaves");

2908 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`di˘Size
(
ri
->
¶aves
));

2909 
fõlds
++;

2911 
	`addRïlyBulkCSåög
(
c
,"num-other-sentinels");

2912 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`di˘Size
(
ri
->
£¡öñs
));

2913 
fõlds
++;

2915 
	`addRïlyBulkCSåög
(
c
,"quorum");

2916 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
qu‹um
);

2917 
fõlds
++;

2919 
	`addRïlyBulkCSåög
(
c
,"failover-timeout");

2920 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
Áûovî_timeout
);

2921 
fõlds
++;

2923 
	`addRïlyBulkCSåög
(
c
,"parallel-syncs");

2924 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
∑øŒñ_syncs
);

2925 
fõlds
++;

2927 i‡(
ri
->
nŸifiˇti⁄_s¸ùt
) {

2928 
	`addRïlyBulkCSåög
(
c
,"notification-script");

2929 
	`addRïlyBulkCSåög
(
c
,
ri
->
nŸifiˇti⁄_s¸ùt
);

2930 
fõlds
++;

2933 i‡(
ri
->
˛õ¡_ªc⁄fig_s¸ùt
) {

2934 
	`addRïlyBulkCSåög
(
c
,"client-reconfig-script");

2935 
	`addRïlyBulkCSåög
(
c
,
ri
->
˛õ¡_ªc⁄fig_s¸ùt
);

2936 
fõlds
++;

2941 i‡(
ri
->
Êags
 & 
SRI_SLAVE
) {

2942 
	`addRïlyBulkCSåög
(
c
,"master-link-down-time");

2943 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
ma°î_lök_down_time
);

2944 
fõlds
++;

2946 
	`addRïlyBulkCSåög
(
c
,"master-link-status");

2947 
	`addRïlyBulkCSåög
(
c
,

2948 (
ri
->
¶ave_ma°î_lök_°©us
 =
SENTINEL_MASTER_LINK_STATUS_UP
) ?

2950 
fõlds
++;

2952 
	`addRïlyBulkCSåög
(
c
,"master-host");

2953 
	`addRïlyBulkCSåög
(
c
,

2954 
ri
->
¶ave_ma°î_ho°
 ?Ñi->slave_master_host : "?");

2955 
fõlds
++;

2957 
	`addRïlyBulkCSåög
(
c
,"master-port");

2958 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
¶ave_ma°î_p‹t
);

2959 
fõlds
++;

2961 
	`addRïlyBulkCSåög
(
c
,"slave-priority");

2962 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
¶ave_¥i‹ôy
);

2963 
fõlds
++;

2965 
	`addRïlyBulkCSåög
(
c
,"slave-repl-offset");

2966 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
¶ave_ª∂_off£t
);

2967 
fõlds
++;

2971 i‡(
ri
->
Êags
 & 
SRI_SENTINEL
) {

2972 
	`addRïlyBulkCSåög
(
c
,"last-hello-message");

2973 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`m°ime
(Ë- 
ri
->
œ°_hñlo_time
);

2974 
fõlds
++;

2976 
	`addRïlyBulkCSåög
(
c
,"voted-leader");

2977 
	`addRïlyBulkCSåög
(
c
,
ri
->
Àadî
 ?Ñi->leader : "?");

2978 
fõlds
++;

2980 
	`addRïlyBulkCSåög
(
c
,"voted-leader-epoch");

2981 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ri
->
Àadî_ïoch
);

2982 
fõlds
++;

2985 
	`£tDe„ºedM≠Lí
(
c
,
mbl
,
fõlds
);

2986 
	}
}

2990 
	$addRïlyDi˘OfRedisIn°™˚s
(
˛õ¡
 *
c
, 
di˘
 *
ö°™˚s
) {

2991 
di˘Iãøt‹
 *
di
;

2992 
di˘E¡ry
 *
de
;

2994 
di
 = 
	`di˘GëIãøt‹
(
ö°™˚s
);

2995 
	`addRïlyAºayLí
(
c
,
	`di˘Size
(
ö°™˚s
));

2996 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

2997 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

2999 
	`addRïlySítöñRedisIn°™˚
(
c
,
ri
);

3001 
	`di˘Rñó£Iãøt‹
(
di
);

3002 
	}
}

3007 
£¡öñRedisIn°™˚
 *
	$£¡öñGëMa°îByNameOrRïlyEº‹
(
˛õ¡
 *
c
,

3008 
robj
 *
«me
)

3010 
£¡öñRedisIn°™˚
 *
ri
;

3012 
ri
 = 
	`di˘FëchVÆue
(
£¡öñ
.
ma°îs
,
«me
->
±r
);

3013 i‡(!
ri
) {

3014 
	`addRïlyEº‹
(
c
,"No such master withÅhatÇame");

3015  
NULL
;

3017  
ri
;

3018 
	}
}

3020 
	#SENTINEL_ISQR_OK
 0

	)

3021 
	#SENTINEL_ISQR_NOQUORUM
 (1<<0)

	)

3022 
	#SENTINEL_ISQR_NOAUTH
 (1<<1)

	)

3023 
	$£¡öñIsQu‹umRóchabÀ
(
£¡öñRedisIn°™˚
 *
ma°î
, *
ußbÀ±r
) {

3024 
di˘Iãøt‹
 *
di
;

3025 
di˘E¡ry
 *
de
;

3026 
ußbÀ
 = 1;

3027 
ªsu…
 = 
SENTINEL_ISQR_OK
;

3028 
vŸîs
 = 
	`di˘Size
(
ma°î
->
£¡öñs
)+1;

3030 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
£¡öñs
);

3031 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3032 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

3034 i‡(
ri
->
Êags
 & (
SRI_S_DOWN
|
SRI_O_DOWN
)) ;

3035 
ußbÀ
++;

3037 
	`di˘Rñó£Iãøt‹
(
di
);

3039 i‡(
ußbÀ
 < ()
ma°î
->
qu‹um
Ë
ªsu…
 |
SENTINEL_ISQR_NOQUORUM
;

3040 i‡(
ußbÀ
 < 
vŸîs
/2+1Ë
ªsu…
 |
SENTINEL_ISQR_NOAUTH
;

3041 i‡(
ußbÀ±r
Ë*ußbÀ±∏
ußbÀ
;

3042  
ªsu…
;

3043 
	}
}

3045 
	$£¡öñComm™d
(
˛õ¡
 *
c
) {

3046 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"masters")) {

3048 i‡(
c
->
¨gc
 !2Ë
num¨g£º
;

3049 
	`addRïlyDi˘OfRedisIn°™˚s
(
c
,
£¡öñ
.
ma°îs
);

3050 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"master")) {

3052 
£¡öñRedisIn°™˚
 *
ri
;

3054 i‡(
c
->
¨gc
 !3Ë
num¨g£º
;

3055 i‡((
ri
 = 
	`£¡öñGëMa°îByNameOrRïlyEº‹
(
c
,c->
¨gv
[2]))

3056 =
NULL
) ;

3057 
	`addRïlySítöñRedisIn°™˚
(
c
,
ri
);

3058 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"slaves") ||

3059 !
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"replicas"))

3062 
£¡öñRedisIn°™˚
 *
ri
;

3064 i‡(
c
->
¨gc
 !3Ë
num¨g£º
;

3065 i‡((
ri
 = 
	`£¡öñGëMa°îByNameOrRïlyEº‹
(
c
,c->
¨gv
[2])Ë=
NULL
)

3067 
	`addRïlyDi˘OfRedisIn°™˚s
(
c
,
ri
->
¶aves
);

3068 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"sentinels")) {

3070 
£¡öñRedisIn°™˚
 *
ri
;

3072 i‡(
c
->
¨gc
 !3Ë
num¨g£º
;

3073 i‡((
ri
 = 
	`£¡öñGëMa°îByNameOrRïlyEº‹
(
c
,c->
¨gv
[2])Ë=
NULL
)

3075 
	`addRïlyDi˘OfRedisIn°™˚s
(
c
,
ri
->
£¡öñs
);

3076 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"is-master-down-by-addr")) {

3094 
£¡öñRedisIn°™˚
 *
ri
;

3095 
ªq_ïoch
;

3096 
uöt64_t
 
Àadî_ïoch
 = 0;

3097 *
Àadî
 = 
NULL
;

3098 
p‹t
;

3099 
isdown
 = 0;

3101 i‡(
c
->
¨gc
 !6Ë
num¨g£º
;

3102 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
p‹t
,
NULL
Ë!
C_OK
 ||

3103 
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[4],&
ªq_ïoch
,
NULL
)

3104 !
C_OK
)

3106 
ri
 = 
	`gëSítöñRedisIn°™˚ByAddrAndRunID
(
£¡öñ
.
ma°îs
,

3107 
c
->
¨gv
[2]->
±r
,
p‹t
,
NULL
);

3111 i‡(!
£¡öñ
.
tût
 && 
ri
 && (ri->
Êags
 & 
SRI_S_DOWN
) &&

3112 (
ri
->
Êags
 & 
SRI_MASTER
))

3113 
isdown
 = 1;

3117 i‡(
ri
 &&Ñi->
Êags
 & 
SRI_MASTER
 && 
	`°rˇ£cmp
(
c
->
¨gv
[5]->
±r
,"*")) {

3118 
Àadî
 = 
	`£¡öñVŸeLódî
(
ri
,(
uöt64_t
)
ªq_ïoch
,

3119 
c
->
¨gv
[5]->
±r
,

3120 &
Àadî_ïoch
);

3125 
	`addRïlyAºayLí
(
c
,3);

3126 
	`addRïly
(
c
, 
isdown
 ? 
sh¨ed
.
c⁄e
 : sh¨ed.
czîo
);

3127 
	`addRïlyBulkCSåög
(
c
, 
Àadî
 ?Üeader : "*");

3128 
	`addRïlyL⁄gL⁄g
(
c
, ()
Àadî_ïoch
);

3129 i‡(
Àadî
Ë
	`sds‰ì
(leader);

3130 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"reset")) {

3132 i‡(
c
->
¨gc
 !3Ë
num¨g£º
;

3133 
	`addRïlyL⁄gL⁄g
(
c
,
	`£¡öñRe£tMa°îsByP©ã∫
(c->
¨gv
[2]->
±r
,
SENTINEL_GENERATE_EVENT
));

3134 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"get-master-addr-by-name")) {

3136 
£¡öñRedisIn°™˚
 *
ri
;

3138 i‡(
c
->
¨gc
 !3Ë
num¨g£º
;

3139 
ri
 = 
	`£¡öñGëMa°îByName
(
c
->
¨gv
[2]->
±r
);

3140 i‡(
ri
 =
NULL
) {

3141 
	`addRïlyNuŒAºay
(
c
);

3143 
£¡öñAddr
 *
addr
 = 
	`£¡öñGëCuºítMa°îAddªss
(
ri
);

3145 
	`addRïlyAºayLí
(
c
,2);

3146 
	`addRïlyBulkCSåög
(
c
,
addr
->
ù
);

3147 
	`addRïlyBulkL⁄gL⁄g
(
c
,
addr
->
p‹t
);

3149 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"failover")) {

3151 
£¡öñRedisIn°™˚
 *
ri
;

3153 i‡(
c
->
¨gc
 !3Ë
num¨g£º
;

3154 i‡((
ri
 = 
	`£¡öñGëMa°îByNameOrRïlyEº‹
(
c
,c->
¨gv
[2])Ë=
NULL
)

3156 i‡(
ri
->
Êags
 & 
SRI_FAILOVER_IN_PROGRESS
) {

3157 
	`addRïlySds
(
c
,
	`sd¢ew
("-INPROG Failoverálready inÖrogress\r\n"));

3160 i‡(
	`£¡öñSñe˘Sœve
(
ri
Ë=
NULL
) {

3161 
	`addRïlySds
(
c
,
	`sd¢ew
("-NOGOODSLAVE No suitableÑeplicaÅoÖromote\r\n"));

3164 
	`£rvîLog
(
LL_WARNING
,"Executing userÑequested FAILOVER of '%s'",

3165 
ri
->
«me
);

3166 
	`£¡öñSèπFaûovî
(
ri
);

3167 
ri
->
Êags
 |
SRI_FORCE_FAILOVER
;

3168 
	`addRïly
(
c
,
sh¨ed
.
ok
);

3169 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"pending-scripts")) {

3172 i‡(
c
->
¨gc
 !2Ë
num¨g£º
;

3173 
	`£¡öñPídögS¸ùtsComm™d
(
c
);

3174 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"monitor")) {

3176 
£¡öñRedisIn°™˚
 *
ri
;

3177 
qu‹um
, 
p‹t
;

3178 
ù
[
NET_IP_STR_LEN
];

3180 i‡(
c
->
¨gc
 !6Ë
num¨g£º
;

3181 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[5],&
qu‹um
,"Invalid quorum")

3182 !
C_OK
) ;

3183 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[4],&
p‹t
,"InvalidÖort")

3184 !
C_OK
) ;

3186 i‡(
qu‹um
 <= 0) {

3187 
	`addRïlyEº‹
(
c
, "Quorum must be 1 or greater.");

3194 i‡(
	`™ëResﬁveIP
(
NULL
,
c
->
¨gv
[3]->
±r
,
ù
,(ù)Ë=
ANET_ERR
) {

3195 
	`addRïlyEº‹
(
c
,"Invalid IPáddress specified");

3200 
ri
 = 
	`¸óãSítöñRedisIn°™˚
(
c
->
¨gv
[2]->
±r
,
SRI_MASTER
,

3201 
c
->
¨gv
[3]->
±r
,
p‹t
,
qu‹um
,
NULL
);

3202 i‡(
ri
 =
NULL
) {

3203 
î∫o
) {

3204 
EBUSY
:

3205 
	`addRïlyEº‹
(
c
,"Duplicated masterÇame");

3207 
EINVAL
:

3208 
	`addRïlyEº‹
(
c
,"InvalidÖortÇumber");

3211 
	`addRïlyEº‹
(
c
,"UnspecifiedÉrroráddingÅhe instance");

3215 
	`£¡öñFlushC⁄fig
();

3216 
	`£¡öñEvít
(
LL_WARNING
,"+m⁄ô‹",
ri
,"%@ qu‹um %d",ri->
qu‹um
);

3217 
	`addRïly
(
c
,
sh¨ed
.
ok
);

3219 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"flushconfig")) {

3220 i‡(
c
->
¨gc
 !2Ë
num¨g£º
;

3221 
	`£¡öñFlushC⁄fig
();

3222 
	`addRïly
(
c
,
sh¨ed
.
ok
);

3224 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"remove")) {

3226 
£¡öñRedisIn°™˚
 *
ri
;

3228 i‡(
c
->
¨gc
 !3Ë
num¨g£º
;

3229 i‡((
ri
 = 
	`£¡öñGëMa°îByNameOrRïlyEº‹
(
c
,c->
¨gv
[2]))

3230 =
NULL
) ;

3231 
	`£¡öñEvít
(
LL_WARNING
,"-m⁄ô‹",
ri
,"%@");

3232 
	`di˘Dñëe
(
£¡öñ
.
ma°îs
,
c
->
¨gv
[2]->
±r
);

3233 
	`£¡öñFlushC⁄fig
();

3234 
	`addRïly
(
c
,
sh¨ed
.
ok
);

3235 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"ckquorum")) {

3237 
£¡öñRedisIn°™˚
 *
ri
;

3238 
ußbÀ
;

3240 i‡(
c
->
¨gc
 !3Ë
num¨g£º
;

3241 i‡((
ri
 = 
	`£¡öñGëMa°îByNameOrRïlyEº‹
(
c
,c->
¨gv
[2]))

3242 =
NULL
) ;

3243 
ªsu…
 = 
	`£¡öñIsQu‹umRóchabÀ
(
ri
,&
ußbÀ
);

3244 i‡(
ªsu…
 =
SENTINEL_ISQR_OK
) {

3245 
	`addRïlySds
(
c
, 
	`sdsˇtfmt
(
	`sd£m±y
(),

3247 "ˇ¿bêªached\r\n",
ußbÀ
));

3249 
sds
 
e
 = 
	`sdsˇtfmt
(
	`sd£m±y
(),

3250 "-NOQUORUM %òußbÀ Sítöñs. ",
ußbÀ
);

3251 i‡(
ªsu…
 & 
SENTINEL_ISQR_NOQUORUM
)

3252 
e
 = 
	`sdsˇt
(e,"NotÉnoughávailable SentinelsÅoÑeachÅhe"

3254 i‡(
ªsu…
 & 
SENTINEL_ISQR_NOAUTH
) {

3255 i‡(
ªsu…
 & 
SENTINEL_ISQR_NOQUORUM
Ë
e
 = 
	`sdsˇt
(e,". ");

3256 
e
 = 
	`sdsˇt
(e, "NotÉnoughávailable SentinelsÅoÑeachÅhe"

3259 
e
 = 
	`sdsˇt
(e,"\r\n");

3260 
	`addRïlySds
(
c
,
e
);

3262 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"set")) {

3263 i‡(
c
->
¨gc
 < 3Ë
num¨g£º
;

3264 
	`£¡öñSëComm™d
(
c
);

3265 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"info-cache")) {

3267 i‡(
c
->
¨gc
 < 2Ë
num¨g£º
;

3268 
m°ime_t
 
now
 = 
	`m°ime
();

3273 
di˘Ty≥
 
c›y_kì≥r
 = 
ö°™˚sDi˘Ty≥
;

3274 
c›y_kì≥r
.
vÆDe°ru˘‹
 = 
NULL
;

3275 
di˘
 *
ma°îs_loˇl
 = 
£¡öñ
.
ma°îs
;

3276 i‡(
c
->
¨gc
 > 2) {

3277 
ma°îs_loˇl
 = 
	`di˘Cª©e
(&
c›y_kì≥r
, 
NULL
);

3279 
i
 = 2; i < 
c
->
¨gc
; i++) {

3280 
£¡öñRedisIn°™˚
 *
ri
;

3281 
ri
 = 
	`£¡öñGëMa°îByName
(
c
->
¨gv
[
i
]->
±r
);

3282 i‡(!
ri
) ;

3283 
	`di˘Add
(
ma°îs_loˇl
, 
ri
->
«me
,Ñi);

3295 
	`addRïlyAºayLí
(
c
,
	`di˘Size
(
ma°îs_loˇl
) * 2);

3297 
di˘Iãøt‹
 *
di
;

3298 
di˘E¡ry
 *
de
;

3299 
di
 = 
	`di˘GëIãøt‹
(
ma°îs_loˇl
);

3300 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3301 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

3302 
	`addRïlyBulkCBuf„r
(
c
,
ri
->
«me
,
	`°æí
(ri->name));

3303 
	`addRïlyAºayLí
(
c
,
	`di˘Size
(
ri
->
¶aves
) + 1);

3304 
	`addRïlyAºayLí
(
c
,2);

3305 
	`addRïlyL⁄gL⁄g
(
c
, 
now
 - 
ri
->
öfo_ª‰esh
);

3306 i‡(
ri
->
öfo
)

3307 
	`addRïlyBulkCBuf„r
(
c
,
ri
->
öfo
,
	`sd¶í
(ri->info));

3309 
	`addRïlyNuŒ
(
c
);

3311 
di˘Iãøt‹
 *
sdi
;

3312 
di˘E¡ry
 *
sde
;

3313 
sdi
 = 
	`di˘GëIãøt‹
(
ri
->
¶aves
);

3314 (
sde
 = 
	`di˘Next
(
sdi
)Ë!
NULL
) {

3315 
£¡öñRedisIn°™˚
 *
§i
 = 
	`di˘GëVÆ
(
sde
);

3316 
	`addRïlyAºayLí
(
c
,2);

3317 
	`addRïlyL⁄gL⁄g
(
c
, 
now
 - 
§i
->
öfo_ª‰esh
);

3318 i‡(
§i
->
öfo
)

3319 
	`addRïlyBulkCBuf„r
(
c
,
§i
->
öfo
,
	`sd¶í
(sri->info));

3321 
	`addRïlyNuŒ
(
c
);

3323 
	`di˘Rñó£Iãøt‹
(
sdi
);

3325 
	`di˘Rñó£Iãøt‹
(
di
);

3326 i‡(
ma°îs_loˇl
 !
£¡öñ
.
ma°îs
Ë
	`di˘Rñó£
(masters_local);

3327 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"simulate-failure")) {

3329 
j
;

3331 
£¡öñ
.
simÁûuª_Êags
 = 
SENTINEL_SIMFAILURE_NONE
;

3332 
j
 = 2; j < 
c
->
¨gc
; j++) {

3333 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"crash-after-election")) {

3334 
£¡öñ
.
simÁûuª_Êags
 |=

3335 
SENTINEL_SIMFAILURE_CRASH_AFTER_ELECTION
;

3336 
	`£rvîLog
(
LL_WARNING
,"Failure simulation:Åhis Sentinel "

3339 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"crash-after-promotion")) {

3340 
£¡öñ
.
simÁûuª_Êags
 |=

3341 
SENTINEL_SIMFAILURE_CRASH_AFTER_PROMOTION
;

3342 
	`£rvîLog
(
LL_WARNING
,"Failure simulation:Åhis Sentinel "

3344 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"help")) {

3345 
	`addRïlyAºayLí
(
c
,2);

3346 
	`addRïlyBulkCSåög
(
c
,"crash-after-election");

3347 
	`addRïlyBulkCSåög
(
c
,"crash-after-promotion");

3349 
	`addRïlyEº‹
(
c
,"Unknown failure simulation specified");

3353 
	`addRïly
(
c
,
sh¨ed
.
ok
);

3355 
	`addRïlyEº‹F‹m©
(
c
,"Unknown sentinel subcommand '%s'",

3356 (*)
c
->
¨gv
[1]->
±r
);

3360 
num¨g£º
:

3361 
	`addRïlyEº‹F‹m©
(
c
,"WrongÇumber ofárguments for 'sentinel %s'",

3362 (*)
c
->
¨gv
[1]->
±r
);

3363 
	}
}

3365 
	#öfo_£˘i⁄_‰om_ªdis
(
£˘i⁄_«me
) do { \

3366 i‡(
def£˘i⁄s
 || 
Æl£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,
£˘i⁄_«me
)) { \

3367 
sds
 
ªdis£˘i⁄
; \

3368 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n"); \

3369 
ªdis£˘i⁄
 = 
	`gíRedisInfoSåög
(
£˘i⁄_«me
); \

3370 
öfo
 = 
	`sdsˇéí
(öfo,
ªdis£˘i⁄
,
	`sd¶í
(redissection)); \

3371 
	`sds‰ì
(
ªdis£˘i⁄
); \

3373 } 0)

	)

3376 
	$£¡öñInfoComm™d
(
˛õ¡
 *
c
) {

3377 i‡(
c
->
¨gc
 > 2) {

3378 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

3382 
def£˘i⁄s
 = 0, 
Æl£˘i⁄s
 = 0;

3383 *
£˘i⁄
 = 
c
->
¨gc
 =2 ? c->
¨gv
[1]->
±r
 : 
NULL
;

3384 i‡(
£˘i⁄
) {

3385 
Æl£˘i⁄s
 = !
	`°rˇ£cmp
(
£˘i⁄
,"all");

3386 
def£˘i⁄s
 = !
	`°rˇ£cmp
(
£˘i⁄
,"default");

3388 
def£˘i⁄s
 = 1;

3391 
£˘i⁄s
 = 0;

3392 
sds
 
öfo
 = 
	`sd£m±y
();

3394 
	`öfo_£˘i⁄_‰om_ªdis
("server");

3395 
	`öfo_£˘i⁄_‰om_ªdis
("clients");

3396 
	`öfo_£˘i⁄_‰om_ªdis
("cpu");

3397 
	`öfo_£˘i⁄_‰om_ªdis
("stats");

3399 i‡(
def£˘i⁄s
 || 
Æl£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"sentinel")) {

3400 
di˘Iãøt‹
 *
di
;

3401 
di˘E¡ry
 *
de
;

3402 
ma°î_id
 = 0;

3404 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

3405 
öfo
 = 
	`sdsˇçrötf
(info,

3412 
	`di˘Size
(
£¡öñ
.
ma°îs
),

3413 
£¡öñ
.
tût
,

3414 
£¡öñ
.
ru¬ög_s¸ùts
,

3415 
	`li°Lígth
(
£¡öñ
.
s¸ùts_queue
),

3416 
£¡öñ
.
simÁûuª_Êags
);

3418 
di
 = 
	`di˘GëIãøt‹
(
£¡öñ
.
ma°îs
);

3419 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3420 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

3421 *
°©us
 = "ok";

3423 i‡(
ri
->
Êags
 & 
SRI_O_DOWN
Ë
°©us
 = "odown";

3424 i‡(
ri
->
Êags
 & 
SRI_S_DOWN
Ë
°©us
 = "sdown";

3425 
öfo
 = 
	`sdsˇçrötf
(info,

3428 
ma°î_id
++, 
ri
->
«me
, 
°©us
,

3429 
ri
->
addr
->
ù
,Ñi->addr->
p‹t
,

3430 
	`di˘Size
(
ri
->
¶aves
),

3431 
	`di˘Size
(
ri
->
£¡öñs
)+1);

3433 
	`di˘Rñó£Iãøt‹
(
di
);

3436 
	`addRïlyBulkSds
(
c
, 
öfo
);

3437 
	}
}

3441 
	$£¡öñRﬁeComm™d
(
˛õ¡
 *
c
) {

3442 
di˘Iãøt‹
 *
di
;

3443 
di˘E¡ry
 *
de
;

3445 
	`addRïlyAºayLí
(
c
,2);

3446 
	`addRïlyBulkCBuf„r
(
c
,"sentinel",8);

3447 
	`addRïlyAºayLí
(
c
,
	`di˘Size
(
£¡öñ
.
ma°îs
));

3449 
di
 = 
	`di˘GëIãøt‹
(
£¡öñ
.
ma°îs
);

3450 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3451 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

3453 
	`addRïlyBulkCSåög
(
c
,
ri
->
«me
);

3455 
	`di˘Rñó£Iãøt‹
(
di
);

3456 
	}
}

3459 
	$£¡öñSëComm™d
(
˛õ¡
 *
c
) {

3460 
£¡öñRedisIn°™˚
 *
ri
;

3461 
j
, 
ch™ges
 = 0;

3462 
bad¨g
 = 0;

3463 *
›ti⁄
;

3465 i‡((
ri
 = 
	`£¡öñGëMa°îByNameOrRïlyEº‹
(
c
,c->
¨gv
[2]))

3466 =
NULL
) ;

3469 
j
 = 3; j < 
c
->
¨gc
; j++) {

3470 
m‹órgs
 = (
c
->
¨gc
-1Ë- 
j
;

3471 
›ti⁄
 = 
c
->
¨gv
[
j
]->
±r
;

3472 
Œ
;

3473 
ﬁd_j
 = 
j
;

3475 i‡(!
	`°rˇ£cmp
(
›ti⁄
,"down-a·î-mûli£c⁄ds"Ë&& 
m‹órgs
 > 0) {

3477 
robj
 *
o
 = 
c
->
¨gv
[++
j
];

3478 i‡(
	`gëL⁄gL⁄gFromObje˘
(
o
,&
Œ
Ë=
C_ERR
 ||Ül <= 0) {

3479 
bad¨g
 = 
j
;

3480 
badfmt
;

3482 
ri
->
down_a·î_≥riod
 = 
Œ
;

3483 
	`£¡öñPr›ag©eDownA·îPîiod
(
ri
);

3484 
ch™ges
++;

3485 } i‡(!
	`°rˇ£cmp
(
›ti⁄
,"Áûovî-timeout"Ë&& 
m‹órgs
 > 0) {

3487 
robj
 *
o
 = 
c
->
¨gv
[++
j
];

3488 i‡(
	`gëL⁄gL⁄gFromObje˘
(
o
,&
Œ
Ë=
C_ERR
 ||Ül <= 0) {

3489 
bad¨g
 = 
j
;

3490 
badfmt
;

3492 
ri
->
Áûovî_timeout
 = 
Œ
;

3493 
ch™ges
++;

3494 } i‡(!
	`°rˇ£cmp
(
›ti⁄
,"∑øŒñ-syncs"Ë&& 
m‹órgs
 > 0) {

3496 
robj
 *
o
 = 
c
->
¨gv
[++
j
];

3497 i‡(
	`gëL⁄gL⁄gFromObje˘
(
o
,&
Œ
Ë=
C_ERR
 ||Ül <= 0) {

3498 
bad¨g
 = 
j
;

3499 
badfmt
;

3501 
ri
->
∑øŒñ_syncs
 = 
Œ
;

3502 
ch™ges
++;

3503 } i‡(!
	`°rˇ£cmp
(
›ti⁄
,"nŸifiˇti⁄-s¸ùt"Ë&& 
m‹órgs
 > 0) {

3505 *
vÆue
 = 
c
->
¨gv
[++
j
]->
±r
;

3506 i‡(
£¡öñ
.
díy_s¸ùts_ªc⁄fig
) {

3507 
	`addRïlyEº‹
(
c
,

3514 i‡(
	`°æí
(
vÆue
Ë&& 
	`ac˚ss
(vÆue,
X_OK
) == -1) {

3515 
	`addRïlyEº‹
(
c
,

3517 i‡(
ch™ges
Ë
	`£¡öñFlushC⁄fig
();

3520 
	`sds‰ì
(
ri
->
nŸifiˇti⁄_s¸ùt
);

3521 
ri
->
nŸifiˇti⁄_s¸ùt
 = 
	`°æí
(
vÆue
Ë? 
	`sd¢ew
(vÆueË: 
NULL
;

3522 
ch™ges
++;

3523 } i‡(!
	`°rˇ£cmp
(
›ti⁄
,"˛õ¡-ªc⁄fig-s¸ùt"Ë&& 
m‹órgs
 > 0) {

3525 *
vÆue
 = 
c
->
¨gv
[++
j
]->
±r
;

3526 i‡(
£¡öñ
.
díy_s¸ùts_ªc⁄fig
) {

3527 
	`addRïlyEº‹
(
c
,

3534 i‡(
	`°æí
(
vÆue
Ë&& 
	`ac˚ss
(vÆue,
X_OK
) == -1) {

3535 
	`addRïlyEº‹
(
c
,

3538 i‡(
ch™ges
Ë
	`£¡öñFlushC⁄fig
();

3541 
	`sds‰ì
(
ri
->
˛õ¡_ªc⁄fig_s¸ùt
);

3542 
ri
->
˛õ¡_ªc⁄fig_s¸ùt
 = 
	`°æí
(
vÆue
Ë? 
	`sd¢ew
(vÆueË: 
NULL
;

3543 
ch™ges
++;

3544 } i‡(!
	`°rˇ£cmp
(
›ti⁄
,"auth-∑ss"Ë&& 
m‹órgs
 > 0) {

3546 *
vÆue
 = 
c
->
¨gv
[++
j
]->
±r
;

3547 
	`sds‰ì
(
ri
->
auth_∑ss
);

3548 
ri
->
auth_∑ss
 = 
	`°æí
(
vÆue
Ë? 
	`sd¢ew
(vÆueË: 
NULL
;

3549 
ch™ges
++;

3550 } i‡(!
	`°rˇ£cmp
(
›ti⁄
,"auth-u£r"Ë&& 
m‹órgs
 > 0) {

3552 *
vÆue
 = 
c
->
¨gv
[++
j
]->
±r
;

3553 
	`sds‰ì
(
ri
->
auth_u£r
);

3554 
ri
->
auth_u£r
 = 
	`°æí
(
vÆue
Ë? 
	`sd¢ew
(vÆueË: 
NULL
;

3555 
ch™ges
++;

3556 } i‡(!
	`°rˇ£cmp
(
›ti⁄
,"qu‹um"Ë&& 
m‹órgs
 > 0) {

3558 
robj
 *
o
 = 
c
->
¨gv
[++
j
];

3559 i‡(
	`gëL⁄gL⁄gFromObje˘
(
o
,&
Œ
Ë=
C_ERR
 ||Ül <= 0) {

3560 
bad¨g
 = 
j
;

3561 
badfmt
;

3563 
ri
->
qu‹um
 = 
Œ
;

3564 
ch™ges
++;

3565 } i‡(!
	`°rˇ£cmp
(
›ti⁄
,"ª«me-comm™d"Ë&& 
m‹órgs
 > 1) {

3567 
sds
 
ﬁd«me
 = 
c
->
¨gv
[++
j
]->
±r
;

3568 
sds
 
√w«me
 = 
c
->
¨gv
[++
j
]->
±r
;

3570 i‡((
	`sd¶í
(
ﬁd«me
Ë=0Ë|| (sd¶í(
√w«me
) == 0)) {

3571 
bad¨g
 = 
	`sd¶í
(
√w«me
Ë? 
j
-1 : j;

3572 
badfmt
;

3576 
	`di˘Dñëe
(
ri
->
ª«med_comm™ds
,
ﬁd«me
);

3580 i‡(!
	`di˘SdsKeyCa£Com∑ª
(
NULL
,
ﬁd«me
,
√w«me
)) {

3581 
ﬁd«me
 = 
	`sdsdup
(oldname);

3582 
√w«me
 = 
	`sdsdup
(newname);

3583 
	`di˘Add
(
ri
->
ª«med_comm™ds
,
ﬁd«me
,
√w«me
);

3585 
ch™ges
++;

3587 
	`addRïlyEº‹F‹m©
(
c
,"Unknown option orÇumber ofárguments for "

3588 "SENTINEL SET '%s'", 
›ti⁄
);

3589 i‡(
ch™ges
Ë
	`£¡öñFlushC⁄fig
();

3594 
num¨gs
 = 
j
-
ﬁd_j
+1;

3595 
num¨gs
) {

3597 
	`£¡öñEvít
(
LL_WARNING
,"+£t",
ri
,"%@ %†%s",
c
->
¨gv
[
ﬁd_j
]->
±r
,

3598 
c
->
¨gv
[
ﬁd_j
+1]->
±r
);

3601 
	`£¡öñEvít
(
LL_WARNING
,"+£t",
ri
,"%@ %†%†%s",
c
->
¨gv
[
ﬁd_j
]->
±r
,

3602 
c
->
¨gv
[
ﬁd_j
+1]->
±r
,

3603 
c
->
¨gv
[
ﬁd_j
+2]->
±r
);

3606 
	`£¡öñEvít
(
LL_WARNING
,"+£t",
ri
,"%@ %s",
c
->
¨gv
[
ﬁd_j
]->
±r
);

3611 i‡(
ch™ges
Ë
	`£¡öñFlushC⁄fig
();

3612 
	`addRïly
(
c
,
sh¨ed
.
ok
);

3615 
badfmt
:

3616 i‡(
ch™ges
Ë
	`£¡öñFlushC⁄fig
();

3617 
	`addRïlyEº‹F‹m©
(
c
,"Invalidárgument '%s' for SENTINEL SET '%s'",

3618 (*)
c
->
¨gv
[
bad¨g
]->
±r
,
›ti⁄
);

3619 
	}
}

3627 
	$£¡öñPublishComm™d
(
˛õ¡
 *
c
) {

3628 i‡(
	`°rcmp
(
c
->
¨gv
[1]->
±r
,
SENTINEL_HELLO_CHANNEL
)) {

3629 
	`addRïlyEº‹
(
c
, "Only HELLO messagesáreáccepted by Sentinel instances.");

3632 
	`£¡öñPro˚ssHñloMesßge
(
c
->
¨gv
[2]->
±r
,
	`sd¶í
(c->argv[2]->ptr));

3633 
	`addRïlyL⁄gL⁄g
(
c
,1);

3634 
	}
}

3639 
	$£¡öñCheckSubje˘ivñyDown
(
£¡öñRedisIn°™˚
 *
ri
) {

3640 
m°ime_t
 
ñ≠£d
 = 0;

3642 i‡(
ri
->
lök
->
a˘_pög_time
)

3643 
ñ≠£d
 = 
	`m°ime
(Ë- 
ri
->
lök
->
a˘_pög_time
;

3644 i‡(
ri
->
lök
->
disc⁄√˘ed
)

3645 
ñ≠£d
 = 
	`m°ime
(Ë- 
ri
->
lök
->
œ°_avaû_time
;

3653 i‡(
ri
->
lök
->
cc
 &&

3654 (
	`m°ime
(Ë- 
ri
->
lök
->
cc_c⁄n_time
) >

3655 
SENTINEL_MIN_LINK_RECONNECT_PERIOD
 &&

3656 
ri
->
lök
->
a˘_pög_time
 != 0 &&

3659 (
	`m°ime
(Ë- 
ri
->
lök
->
a˘_pög_time
Ë> (ri->
down_a·î_≥riod
/2) &&

3660 (
	`m°ime
(Ë- 
ri
->
lök
->
œ°_p⁄g_time
Ë> (ri->
down_a·î_≥riod
/2))

3662 
	`ö°™˚LökClo£C⁄√˘i⁄
(
ri
->
lök
,ri->lök->
cc
);

3670 i‡(
ri
->
lök
->
pc
 &&

3671 (
	`m°ime
(Ë- 
ri
->
lök
->
pc_c⁄n_time
) >

3672 
SENTINEL_MIN_LINK_RECONNECT_PERIOD
 &&

3673 (
	`m°ime
(Ë- 
ri
->
lök
->
pc_œ°_a˘ivôy
Ë> (
SENTINEL_PUBLISH_PERIOD
*3))

3675 
	`ö°™˚LökClo£C⁄√˘i⁄
(
ri
->
lök
,ri->lök->
pc
);

3684 i‡(
ñ≠£d
 > 
ri
->
down_a·î_≥riod
 ||

3685 (
ri
->
Êags
 & 
SRI_MASTER
 &&

3686 
ri
->
rﬁe_ªp‹ãd
 =
SRI_SLAVE
 &&

3687 
	`m°ime
(Ë- 
ri
->
rﬁe_ªp‹ãd_time
 >

3688 (
ri
->
down_a·î_≥riod
+
SENTINEL_INFO_PERIOD
*2)))

3691 i‡((
ri
->
Êags
 & 
SRI_S_DOWN
) == 0) {

3692 
	`£¡öñEvít
(
LL_WARNING
,"+sdown",
ri
,"%@");

3693 
ri
->
s_down_sö˚_time
 = 
	`m°ime
();

3694 
ri
->
Êags
 |
SRI_S_DOWN
;

3698 i‡(
ri
->
Êags
 & 
SRI_S_DOWN
) {

3699 
	`£¡öñEvít
(
LL_WARNING
,"-sdown",
ri
,"%@");

3700 
ri
->
Êags
 &~(
SRI_S_DOWN
|
SRI_SCRIPT_KILL_SENT
);

3703 
	}
}

3711 
	$£¡öñCheckObje˘ivñyDown
(
£¡öñRedisIn°™˚
 *
ma°î
) {

3712 
di˘Iãøt‹
 *
di
;

3713 
di˘E¡ry
 *
de
;

3714 
qu‹um
 = 0, 
odown
 = 0;

3716 i‡(
ma°î
->
Êags
 & 
SRI_S_DOWN
) {

3718 
qu‹um
 = 1;

3720 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
£¡öñs
);

3721 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3722 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

3724 i‡(
ri
->
Êags
 & 
SRI_MASTER_DOWN
Ë
qu‹um
++;

3726 
	`di˘Rñó£Iãøt‹
(
di
);

3727 i‡(
qu‹um
 >
ma°î
->qu‹umË
odown
 = 1;

3731 i‡(
odown
) {

3732 i‡((
ma°î
->
Êags
 & 
SRI_O_DOWN
) == 0) {

3733 
	`£¡öñEvít
(
LL_WARNING
,"+odown",
ma°î
,"%@ #quorum %d/%d",

3734 
qu‹um
, 
ma°î
->quorum);

3735 
ma°î
->
Êags
 |
SRI_O_DOWN
;

3736 
ma°î
->
o_down_sö˚_time
 = 
	`m°ime
();

3739 i‡(
ma°î
->
Êags
 & 
SRI_O_DOWN
) {

3740 
	`£¡öñEvít
(
LL_WARNING
,"-odown",
ma°î
,"%@");

3741 
ma°î
->
Êags
 &~
SRI_O_DOWN
;

3744 
	}
}

3748 
	$£¡öñRe˚iveIsMa°îDownRïly
(
ªdisAsyncC⁄ãxt
 *
c
, *
ª∂y
, *
¥ivd©a
) {

3749 
£¡öñRedisIn°™˚
 *
ri
 = 
¥ivd©a
;

3750 
ö°™˚Lök
 *
lök
 = 
c
->
d©a
;

3751 
ªdisRïly
 *
r
;

3753 i‡(!
ª∂y
 || !
lök
) ;

3754 
lök
->
≥ndög_comm™ds
--;

3755 
r
 = 
ª∂y
;

3760 i‡(
r
->
ty≥
 =
REDIS_REPLY_ARRAY
 &&Ñ->
ñemíts
 == 3 &&

3761 
r
->
ñemít
[0]->
ty≥
 =
REDIS_REPLY_INTEGER
 &&

3762 
r
->
ñemít
[1]->
ty≥
 =
REDIS_REPLY_STRING
 &&

3763 
r
->
ñemít
[2]->
ty≥
 =
REDIS_REPLY_INTEGER
)

3765 
ri
->
œ°_ma°î_down_ª∂y_time
 = 
	`m°ime
();

3766 i‡(
r
->
ñemít
[0]->
öãgî
 == 1) {

3767 
ri
->
Êags
 |
SRI_MASTER_DOWN
;

3769 
ri
->
Êags
 &~
SRI_MASTER_DOWN
;

3771 i‡(
	`°rcmp
(
r
->
ñemít
[1]->
°r
,"*")) {

3774 
	`sds‰ì
(
ri
->
Àadî
);

3775 i‡(()
ri
->
Àadî_ïoch
 !
r
->
ñemít
[2]->
öãgî
)

3776 
	`£rvîLog
(
LL_WARNING
,

3777 "%†vŸed f‹ %†%Œu", 
ri
->
«me
,

3778 
r
->
ñemít
[1]->
°r
,

3779 (Ë
r
->
ñemít
[2]->
öãgî
);

3780 
ri
->
Àadî
 = 
	`sd¢ew
(
r
->
ñemít
[1]->
°r
);

3781 
ri
->
Àadî_ïoch
 = 
r
->
ñemít
[2]->
öãgî
;

3784 
	}
}

3790 
	#SENTINEL_ASK_FORCED
 (1<<0)

	)

3791 
	$£¡öñAskMa°îSèãToOthîSítöñs
(
£¡öñRedisIn°™˚
 *
ma°î
, 
Êags
) {

3792 
di˘Iãøt‹
 *
di
;

3793 
di˘E¡ry
 *
de
;

3795 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
£¡öñs
);

3796 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3797 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

3798 
m°ime_t
 
ñ≠£d
 = 
	`m°ime
(Ë- 
ri
->
œ°_ma°î_down_ª∂y_time
;

3799 
p‹t
[32];

3800 
ªtvÆ
;

3803 i‡(
ñ≠£d
 > 
SENTINEL_ASK_PERIOD
*5) {

3804 
ri
->
Êags
 &~
SRI_MASTER_DOWN
;

3805 
	`sds‰ì
(
ri
->
Àadî
);

3806 
ri
->
Àadî
 = 
NULL
;

3814 i‡((
ma°î
->
Êags
 & 
SRI_S_DOWN
) == 0) ;

3815 i‡(
ri
->
lök
->
disc⁄√˘ed
) ;

3816 i‡(!(
Êags
 & 
SENTINEL_ASK_FORCED
) &&

3817 
	`m°ime
(Ë- 
ri
->
œ°_ma°î_down_ª∂y_time
 < 
SENTINEL_ASK_PERIOD
)

3821 
	`Œ2°rög
(
p‹t
,’‹t),
ma°î
->
addr
->port);

3822 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

3823 
£¡öñRe˚iveIsMa°îDownRïly
, 
ri
,

3825 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"SENTINEL"),

3826 
ma°î
->
addr
->
ù
, 
p‹t
,

3827 
£¡öñ
.
cuºít_ïoch
,

3828 (
ma°î
->
Áûovî_°©e
 > 
SENTINEL_FAILOVER_STATE_NONE
) ?

3829 
£¡öñ
.
myid
 : "*");

3830 i‡(
ªtvÆ
 =
C_OK
Ë
ri
->
lök
->
≥ndög_comm™ds
++;

3832 
	`di˘Rñó£Iãøt‹
(
di
);

3833 
	}
}

3838 
	$£¡öñSimFaûuªCøsh
() {

3839 
	`£rvîLog
(
LL_WARNING
,

3841 
	`exô
(99);

3842 
	}
}

3849 *
	$£¡öñVŸeLódî
(
£¡öñRedisIn°™˚
 *
ma°î
, 
uöt64_t
 
ªq_ïoch
, *
ªq_runid
, uöt64_à*
Àadî_ïoch
) {

3850 i‡(
ªq_ïoch
 > 
£¡öñ
.
cuºít_ïoch
) {

3851 
£¡öñ
.
cuºít_ïoch
 = 
ªq_ïoch
;

3852 
	`£¡öñFlushC⁄fig
();

3853 
	`£¡öñEvít
(
LL_WARNING
,"+√w-ïoch",
ma°î
,"%llu",

3854 (Ë
£¡öñ
.
cuºít_ïoch
);

3857 i‡(
ma°î
->
Àadî_ïoch
 < 
ªq_ïoch
 && 
£¡öñ
.
cuºít_ïoch
 <=Ñeq_epoch)

3859 
	`sds‰ì
(
ma°î
->
Àadî
);

3860 
ma°î
->
Àadî
 = 
	`sd¢ew
(
ªq_runid
);

3861 
ma°î
->
Àadî_ïoch
 = 
£¡öñ
.
cuºít_ïoch
;

3862 
	`£¡öñFlushC⁄fig
();

3863 
	`£¡öñEvít
(
LL_WARNING
,"+vŸe-f‹-Àadî",
ma°î
,"%s %llu",

3864 
ma°î
->
Àadî
, (Ëma°î->
Àadî_ïoch
);

3868 i‡(
	`°rˇ£cmp
(
ma°î
->
Àadî
,
£¡öñ
.
myid
))

3869 
ma°î
->
Áûovî_°¨t_time
 = 
	`m°ime
()+
	`ønd
()%
SENTINEL_MAX_DESYNC
;

3872 *
Àadî_ïoch
 = 
ma°î
->leader_epoch;

3873  
ma°î
->
Àadî
 ? 
	`sd¢ew
(ma°î->ÀadîË: 
NULL
;

3874 
	}
}

3876 
	s£¡öñLódî
 {

3877 *
	mrunid
;

3878 
	mvŸes
;

3883 
	$£¡öñLódîIn¸
(
di˘
 *
cou¡îs
, *
runid
) {

3884 
di˘E¡ry
 *
exi°ög
, *
de
;

3885 
uöt64_t
 
ﬁdvÆ
;

3887 
de
 = 
	`di˘AddRaw
(
cou¡îs
,
runid
,&
exi°ög
);

3888 i‡(
exi°ög
) {

3889 
ﬁdvÆ
 = 
	`di˘GëUnsig√dI¡egîVÆ
(
exi°ög
);

3890 
	`di˘SëUnsig√dI¡egîVÆ
(
exi°ög
,
ﬁdvÆ
+1);

3891  
ﬁdvÆ
+1;

3893 
	`£rvîAs£π
(
de
 !
NULL
);

3894 
	`di˘SëUnsig√dI¡egîVÆ
(
de
,1);

3897 
	}
}

3905 *
	$£¡öñGëLódî
(
£¡öñRedisIn°™˚
 *
ma°î
, 
uöt64_t
 
ïoch
) {

3906 
di˘
 *
cou¡îs
;

3907 
di˘Iãøt‹
 *
di
;

3908 
di˘E¡ry
 *
de
;

3909 
vŸîs
 = 0, 
vŸîs_qu‹um
;

3910 *
myvŸe
;

3911 *
wö√r
 = 
NULL
;

3912 
uöt64_t
 
Àadî_ïoch
;

3913 
uöt64_t
 
max_vŸes
 = 0;

3915 
	`£rvîAs£π
(
ma°î
->
Êags
 & (
SRI_O_DOWN
|
SRI_FAILOVER_IN_PROGRESS
));

3916 
cou¡îs
 = 
	`di˘Cª©e
(&
ÀadîVŸesDi˘Ty≥
,
NULL
);

3918 
vŸîs
 = 
	`di˘Size
(
ma°î
->
£¡öñs
)+1;

3921 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
£¡öñs
);

3922 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3923 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

3924 i‡(
ri
->
Àadî
 !
NULL
 &&Ñi->
Àadî_ïoch
 =
£¡öñ
.
cuºít_ïoch
)

3925 
	`£¡öñLódîIn¸
(
cou¡îs
,
ri
->
Àadî
);

3927 
	`di˘Rñó£Iãøt‹
(
di
);

3932 
di
 = 
	`di˘GëIãøt‹
(
cou¡îs
);

3933 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3934 
uöt64_t
 
vŸes
 = 
	`di˘GëUnsig√dI¡egîVÆ
(
de
);

3936 i‡(
vŸes
 > 
max_vŸes
) {

3937 
max_vŸes
 = 
vŸes
;

3938 
wö√r
 = 
	`di˘GëKey
(
de
);

3941 
	`di˘Rñó£Iãøt‹
(
di
);

3946 i‡(
wö√r
)

3947 
myvŸe
 = 
	`£¡öñVŸeLódî
(
ma°î
,
ïoch
,
wö√r
,&
Àadî_ïoch
);

3949 
myvŸe
 = 
	`£¡öñVŸeLódî
(
ma°î
,
ïoch
,
£¡öñ
.
myid
,&
Àadî_ïoch
);

3951 i‡(
myvŸe
 && 
Àadî_ïoch
 =
ïoch
) {

3952 
uöt64_t
 
vŸes
 = 
	`£¡öñLódîIn¸
(
cou¡îs
,
myvŸe
);

3954 i‡(
vŸes
 > 
max_vŸes
) {

3955 
max_vŸes
 = 
vŸes
;

3956 
wö√r
 = 
myvŸe
;

3960 
vŸîs_qu‹um
 = 
vŸîs
/2+1;

3961 i‡(
wö√r
 && (
max_vŸes
 < 
vŸîs_qu‹um
 || max_vŸe†< 
ma°î
->
qu‹um
))

3962 
wö√r
 = 
NULL
;

3964 
wö√r
 = wö√∏? 
	`sd¢ew
(wö√rË: 
NULL
;

3965 
	`sds‰ì
(
myvŸe
);

3966 
	`di˘Rñó£
(
cou¡îs
);

3967  
wö√r
;

3968 
	}
}

3980 
	$£¡öñSídSœveOf
(
£¡öñRedisIn°™˚
 *
ri
, *
ho°
, 
p‹t
) {

3981 
p‹t°r
[32];

3982 
ªtvÆ
;

3984 
	`Œ2°rög
(
p‹t°r
,’‹t°r),
p‹t
);

3988 i‡(
ho°
 =
NULL
) {

3989 
ho°
 = "NO";

3990 
	`mem˝y
(
p‹t°r
,"ONE",4);

4003 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

4004 
£¡öñDisˇrdRïlyCÆlback
, 
ri
, "%s",

4005 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"MULTI"));

4006 i‡(
ªtvÆ
 =
C_ERR
) Ñetval;

4007 
ri
->
lök
->
≥ndög_comm™ds
++;

4009 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

4010 
£¡öñDisˇrdRïlyCÆlback
, 
ri
, "%s %s %s",

4011 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"SLAVEOF"),

4012 
ho°
, 
p‹t°r
);

4013 i‡(
ªtvÆ
 =
C_ERR
) Ñetval;

4014 
ri
->
lök
->
≥ndög_comm™ds
++;

4016 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

4017 
£¡öñDisˇrdRïlyCÆlback
, 
ri
, "%s REWRITE",

4018 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"CONFIG"));

4019 i‡(
ªtvÆ
 =
C_ERR
) Ñetval;

4020 
ri
->
lök
->
≥ndög_comm™ds
++;

4027 
ty≥
 = 0;Åype < 2;Åype++) {

4028 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

4029 
£¡öñDisˇrdRïlyCÆlback
, 
ri
, "%s KILL TYPE %s",

4030 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"CLIENT"),

4031 
ty≥
 == 0 ? "normal" : "pubsub");

4032 i‡(
ªtvÆ
 =
C_ERR
) Ñetval;

4033 
ri
->
lök
->
≥ndög_comm™ds
++;

4036 
ªtvÆ
 = 
	`ªdisAsyncComm™d
(
ri
->
lök
->
cc
,

4037 
£¡öñDisˇrdRïlyCÆlback
, 
ri
, "%s",

4038 
	`£¡öñIn°™˚M≠Comm™d
(
ri
,"EXEC"));

4039 i‡(
ªtvÆ
 =
C_ERR
) Ñetval;

4040 
ri
->
lök
->
≥ndög_comm™ds
++;

4042  
C_OK
;

4043 
	}
}

4046 
	$£¡öñSèπFaûovî
(
£¡öñRedisIn°™˚
 *
ma°î
) {

4047 
	`£rvîAs£π
(
ma°î
->
Êags
 & 
SRI_MASTER
);

4049 
ma°î
->
Áûovî_°©e
 = 
SENTINEL_FAILOVER_STATE_WAIT_START
;

4050 
ma°î
->
Êags
 |
SRI_FAILOVER_IN_PROGRESS
;

4051 
ma°î
->
Áûovî_ïoch
 = ++
£¡öñ
.
cuºít_ïoch
;

4052 
	`£¡öñEvít
(
LL_WARNING
,"+√w-ïoch",
ma°î
,"%llu",

4053 (Ë
£¡öñ
.
cuºít_ïoch
);

4054 
	`£¡öñEvít
(
LL_WARNING
,"+åy-Áûovî",
ma°î
,"%@");

4055 
ma°î
->
Áûovî_°¨t_time
 = 
	`m°ime
()+
	`ønd
()%
SENTINEL_MAX_DESYNC
;

4056 
ma°î
->
Áûovî_°©e_ch™ge_time
 = 
	`m°ime
();

4057 
	}
}

4070 
	$£¡öñSèπFaûovîIfNìded
(
£¡öñRedisIn°™˚
 *
ma°î
) {

4072 i‡(!(
ma°î
->
Êags
 & 
SRI_O_DOWN
))  0;

4075 i‡(
ma°î
->
Êags
 & 
SRI_FAILOVER_IN_PROGRESS
)  0;

4078 i‡(
	`m°ime
(Ë- 
ma°î
->
Áûovî_°¨t_time
 <

4079 
ma°î
->
Áûovî_timeout
*2)

4081 i‡(
ma°î
->
Áûovî_dñay_logged
 !ma°î->
Áûovî_°¨t_time
) {

4082 
time_t
 
˛ock
 = (
ma°î
->
Áûovî_°¨t_time
 +

4083 
ma°î
->
Áûovî_timeout
*2) / 1000;

4084 
˘imebuf
[26];

4086 
	`˘ime_r
(&
˛ock
,
˘imebuf
);

4087 
˘imebuf
[24] = '\0';

4088 
ma°î
->
Áûovî_dñay_logged
 = ma°î->
Áûovî_°¨t_time
;

4089 
	`£rvîLog
(
LL_WARNING
,

4091 
˘imebuf
);

4096 
	`£¡öñSèπFaûovî
(
ma°î
);

4098 
	}
}

4132 
	$com∑ªSœvesF‹PromŸi⁄
(c⁄° *
a
, c⁄° *
b
) {

4133 
£¡öñRedisIn°™˚
 **
ß
 = (£¡öñRedisIn°™˚ **)
a
,

4134 **
sb
 = (
£¡öñRedisIn°™˚
 **)
b
;

4135 *
ß_runid
, *
sb_runid
;

4137 i‡((*
ß
)->
¶ave_¥i‹ôy
 !(*
sb
)->slave_priority)

4138  (*
ß
)->
¶ave_¥i‹ôy
 - (*
sb
)->slave_priority;

4142 i‡((*
ß
)->
¶ave_ª∂_off£t
 > (*
sb
)->slave_repl_offset) {

4144 } i‡((*
ß
)->
¶ave_ª∂_off£t
 < (*
sb
)->slave_repl_offset) {

4152 
ß_runid
 = (*
ß
)->
runid
;

4153 
sb_runid
 = (*
sb
)->
runid
;

4154 i‡(
ß_runid
 =
NULL
 && 
sb_runid
 == NULL)  0;

4155 i‡(
ß_runid
 =
NULL
)  1;

4156 i‡(
sb_runid
 =
NULL
)  -1;

4157  
	`°rˇ£cmp
(
ß_runid
, 
sb_runid
);

4158 
	}
}

4160 
£¡öñRedisIn°™˚
 *
	$£¡öñSñe˘Sœve
(
£¡öñRedisIn°™˚
 *
ma°î
) {

4161 
£¡öñRedisIn°™˚
 **
ö°™˚
 =

4162 
	`zmÆloc
((
ö°™˚
[0])*
	`di˘Size
(
ma°î
->
¶aves
));

4163 
£¡öñRedisIn°™˚
 *
£À˘ed
 = 
NULL
;

4164 
ö°™˚s
 = 0;

4165 
di˘Iãøt‹
 *
di
;

4166 
di˘E¡ry
 *
de
;

4167 
m°ime_t
 
max_ma°î_down_time
 = 0;

4169 i‡(
ma°î
->
Êags
 & 
SRI_S_DOWN
)

4170 
max_ma°î_down_time
 +
	`m°ime
(Ë- 
ma°î
->
s_down_sö˚_time
;

4171 
max_ma°î_down_time
 +
ma°î
->
down_a·î_≥riod
 * 10;

4173 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
¶aves
);

4174 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

4175 
£¡öñRedisIn°™˚
 *
¶ave
 = 
	`di˘GëVÆ
(
de
);

4176 
m°ime_t
 
öfo_vÆidôy_time
;

4178 i‡(
¶ave
->
Êags
 & (
SRI_S_DOWN
|
SRI_O_DOWN
)) ;

4179 i‡(
¶ave
->
lök
->
disc⁄√˘ed
) ;

4180 i‡(
	`m°ime
(Ë- 
¶ave
->
lök
->
œ°_avaû_time
 > 
SENTINEL_PING_PERIOD
*5) ;

4181 i‡(
¶ave
->
¶ave_¥i‹ôy
 == 0) ;

4186 i‡(
ma°î
->
Êags
 & 
SRI_S_DOWN
)

4187 
öfo_vÆidôy_time
 = 
SENTINEL_PING_PERIOD
*5;

4189 
öfo_vÆidôy_time
 = 
SENTINEL_INFO_PERIOD
*3;

4190 i‡(
	`m°ime
(Ë- 
¶ave
->
öfo_ª‰esh
 > 
öfo_vÆidôy_time
) ;

4191 i‡(
¶ave
->
ma°î_lök_down_time
 > 
max_ma°î_down_time
) ;

4192 
ö°™˚
[
ö°™˚s
++] = 
¶ave
;

4194 
	`di˘Rñó£Iãøt‹
(
di
);

4195 i‡(
ö°™˚s
) {

4196 
	`qs‹t
(
ö°™˚
,
ö°™˚s
,(
£¡öñRedisIn°™˚
*),

4197 
com∑ªSœvesF‹PromŸi⁄
);

4198 
£À˘ed
 = 
ö°™˚
[0];

4200 
	`z‰ì
(
ö°™˚
);

4201  
£À˘ed
;

4202 
	}
}

4205 
	$£¡öñFaûovîWaôSèπ
(
£¡öñRedisIn°™˚
 *
ri
) {

4206 *
Àadî
;

4207 
i¶ódî
;

4210 
Àadî
 = 
	`£¡öñGëLódî
(
ri
,Ñi->
Áûovî_ïoch
);

4211 
i¶ódî
 = 
Àadî
 && 
	`°rˇ£cmp
÷ódî,
£¡öñ
.
myid
) == 0;

4212 
	`sds‰ì
(
Àadî
);

4216 i‡(!
i¶ódî
 && !(
ri
->
Êags
 & 
SRI_FORCE_FAILOVER
)) {

4217 
ñe˘i⁄_timeout
 = 
SENTINEL_ELECTION_TIMEOUT
;

4221 i‡(
ñe˘i⁄_timeout
 > 
ri
->
Áûovî_timeout
)

4222 
ñe˘i⁄_timeout
 = 
ri
->
Áûovî_timeout
;

4224 i‡(
	`m°ime
(Ë- 
ri
->
Áûovî_°¨t_time
 > 
ñe˘i⁄_timeout
) {

4225 
	`£¡öñEvít
(
LL_WARNING
,"-Áûovî-ab‹t-nŸ-ñe˘ed",
ri
,"%@");

4226 
	`£¡öñAb‹tFaûovî
(
ri
);

4230 
	`£¡öñEvít
(
LL_WARNING
,"+ñe˘ed-Àadî",
ri
,"%@");

4231 i‡(
£¡öñ
.
simÁûuª_Êags
 & 
SENTINEL_SIMFAILURE_CRASH_AFTER_ELECTION
)

4232 
	`£¡öñSimFaûuªCøsh
();

4233 
ri
->
Áûovî_°©e
 = 
SENTINEL_FAILOVER_STATE_SELECT_SLAVE
;

4234 
ri
->
Áûovî_°©e_ch™ge_time
 = 
	`m°ime
();

4235 
	`£¡öñEvít
(
LL_WARNING
,"+Áûovî-°©e-£À˘-¶ave",
ri
,"%@");

4236 
	}
}

4238 
	$£¡öñFaûovîSñe˘Sœve
(
£¡öñRedisIn°™˚
 *
ri
) {

4239 
£¡öñRedisIn°™˚
 *
¶ave
 = 
	`£¡öñSñe˘Sœve
(
ri
);

4243 i‡(
¶ave
 =
NULL
) {

4244 
	`£¡öñEvít
(
LL_WARNING
,"-Áûovî-ab‹t-no-good-¶ave",
ri
,"%@");

4245 
	`£¡öñAb‹tFaûovî
(
ri
);

4247 
	`£¡öñEvít
(
LL_WARNING
,"+£À˘ed-¶ave",
¶ave
,"%@");

4248 
¶ave
->
Êags
 |
SRI_PROMOTED
;

4249 
ri
->
¥omŸed_¶ave
 = 
¶ave
;

4250 
ri
->
Áûovî_°©e
 = 
SENTINEL_FAILOVER_STATE_SEND_SLAVEOF_NOONE
;

4251 
ri
->
Áûovî_°©e_ch™ge_time
 = 
	`m°ime
();

4252 
	`£¡öñEvít
(
LL_NOTICE
,"+failover-state-send-slaveof-noone",

4253 
¶ave
, "%@");

4255 
	}
}

4257 
	$£¡öñFaûovîSídSœveOfNoO√
(
£¡öñRedisIn°™˚
 *
ri
) {

4258 
ªtvÆ
;

4263 i‡(
ri
->
¥omŸed_¶ave
->
lök
->
disc⁄√˘ed
) {

4264 i‡(
	`m°ime
(Ë- 
ri
->
Áûovî_°©e_ch™ge_time
 >Ñi->
Áûovî_timeout
) {

4265 
	`£¡öñEvít
(
LL_WARNING
,"-Áûovî-ab‹t-¶ave-timeout",
ri
,"%@");

4266 
	`£¡öñAb‹tFaûovî
(
ri
);

4275 
ªtvÆ
 = 
	`£¡öñSídSœveOf
(
ri
->
¥omŸed_¶ave
,
NULL
,0);

4276 i‡(
ªtvÆ
 !
C_OK
) ;

4277 
	`£¡öñEvít
(
LL_NOTICE
, "+failover-state-wait-promotion",

4278 
ri
->
¥omŸed_¶ave
,"%@");

4279 
ri
->
Áûovî_°©e
 = 
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
;

4280 
ri
->
Áûovî_°©e_ch™ge_time
 = 
	`m°ime
();

4281 
	}
}

4285 
	$£¡öñFaûovîWaôPromŸi⁄
(
£¡öñRedisIn°™˚
 *
ri
) {

4288 i‡(
	`m°ime
(Ë- 
ri
->
Áûovî_°©e_ch™ge_time
 >Ñi->
Áûovî_timeout
) {

4289 
	`£¡öñEvít
(
LL_WARNING
,"-Áûovî-ab‹t-¶ave-timeout",
ri
,"%@");

4290 
	`£¡öñAb‹tFaûovî
(
ri
);

4292 
	}
}

4294 
	$£¡öñFaûovîDëe˘End
(
£¡öñRedisIn°™˚
 *
ma°î
) {

4295 
nŸ_ªc⁄figuªd
 = 0, 
timeout
 = 0;

4296 
di˘Iãøt‹
 *
di
;

4297 
di˘E¡ry
 *
de
;

4298 
m°ime_t
 
ñ≠£d
 = 
	`m°ime
(Ë- 
ma°î
->
Áûovî_°©e_ch™ge_time
;

4302 i‡(
ma°î
->
¥omŸed_¶ave
 =
NULL
 ||

4303 
ma°î
->
¥omŸed_¶ave
->
Êags
 & 
SRI_S_DOWN
) ;

4307 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
¶aves
);

4308 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

4309 
£¡öñRedisIn°™˚
 *
¶ave
 = 
	`di˘GëVÆ
(
de
);

4311 i‡(
¶ave
->
Êags
 & (
SRI_PROMOTED
|
SRI_RECONF_DONE
)) ;

4312 i‡(
¶ave
->
Êags
 & 
SRI_S_DOWN
) ;

4313 
nŸ_ªc⁄figuªd
++;

4315 
	`di˘Rñó£Iãøt‹
(
di
);

4318 i‡(
ñ≠£d
 > 
ma°î
->
Áûovî_timeout
) {

4319 
nŸ_ªc⁄figuªd
 = 0;

4320 
timeout
 = 1;

4321 
	`£¡öñEvít
(
LL_WARNING
,"+Áûovî-íd-f‹-timeout",
ma°î
,"%@");

4324 i‡(
nŸ_ªc⁄figuªd
 == 0) {

4325 
	`£¡öñEvít
(
LL_WARNING
,"+Áûovî-íd",
ma°î
,"%@");

4326 
ma°î
->
Áûovî_°©e
 = 
SENTINEL_FAILOVER_STATE_UPDATE_CONFIG
;

4327 
ma°î
->
Áûovî_°©e_ch™ge_time
 = 
	`m°ime
();

4333 i‡(
timeout
) {

4334 
di˘Iãøt‹
 *
di
;

4335 
di˘E¡ry
 *
de
;

4337 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
¶aves
);

4338 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

4339 
£¡öñRedisIn°™˚
 *
¶ave
 = 
	`di˘GëVÆ
(
de
);

4340 
ªtvÆ
;

4342 i‡(
¶ave
->
Êags
 & (
SRI_PROMOTED
|
SRI_RECONF_DONE
|
SRI_RECONF_SENT
)) ;

4343 i‡(
¶ave
->
lök
->
disc⁄√˘ed
) ;

4345 
ªtvÆ
 = 
	`£¡öñSídSœveOf
(
¶ave
,

4346 
ma°î
->
¥omŸed_¶ave
->
addr
->
ù
,

4347 
ma°î
->
¥omŸed_¶ave
->
addr
->
p‹t
);

4348 i‡(
ªtvÆ
 =
C_OK
) {

4349 
	`£¡öñEvít
(
LL_NOTICE
,"+¶ave-ªc⁄f-£¡-be",
¶ave
,"%@");

4350 
¶ave
->
Êags
 |
SRI_RECONF_SENT
;

4353 
	`di˘Rñó£Iãøt‹
(
di
);

4355 
	}
}

4359 
	$£¡öñFaûovîRec⁄fNextSœve
(
£¡öñRedisIn°™˚
 *
ma°î
) {

4360 
di˘Iãøt‹
 *
di
;

4361 
di˘E¡ry
 *
de
;

4362 
ö_¥ogªss
 = 0;

4364 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
¶aves
);

4365 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

4366 
£¡öñRedisIn°™˚
 *
¶ave
 = 
	`di˘GëVÆ
(
de
);

4368 i‡(
¶ave
->
Êags
 & (
SRI_RECONF_SENT
|
SRI_RECONF_INPROG
))

4369 
ö_¥ogªss
++;

4371 
	`di˘Rñó£Iãøt‹
(
di
);

4373 
di
 = 
	`di˘GëIãøt‹
(
ma°î
->
¶aves
);

4374 
ö_¥ogªss
 < 
ma°î
->
∑øŒñ_syncs
 &&

4375 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
)

4377 
£¡öñRedisIn°™˚
 *
¶ave
 = 
	`di˘GëVÆ
(
de
);

4378 
ªtvÆ
;

4381 i‡(
¶ave
->
Êags
 & (
SRI_PROMOTED
|
SRI_RECONF_DONE
)) ;

4387 i‡((
¶ave
->
Êags
 & 
SRI_RECONF_SENT
) &&

4388 (
	`m°ime
(Ë- 
¶ave
->
¶ave_ªc⁄f_£¡_time
) >

4389 
SENTINEL_SLAVE_RECONF_TIMEOUT
)

4391 
	`£¡öñEvít
(
LL_NOTICE
,"-¶ave-ªc⁄f-£¡-timeout",
¶ave
,"%@");

4392 
¶ave
->
Êags
 &~
SRI_RECONF_SENT
;

4393 
¶ave
->
Êags
 |
SRI_RECONF_DONE
;

4398 i‡(
¶ave
->
Êags
 & (
SRI_RECONF_SENT
|
SRI_RECONF_INPROG
)) ;

4399 i‡(
¶ave
->
lök
->
disc⁄√˘ed
) ;

4402 
ªtvÆ
 = 
	`£¡öñSídSœveOf
(
¶ave
,

4403 
ma°î
->
¥omŸed_¶ave
->
addr
->
ù
,

4404 
ma°î
->
¥omŸed_¶ave
->
addr
->
p‹t
);

4405 i‡(
ªtvÆ
 =
C_OK
) {

4406 
¶ave
->
Êags
 |
SRI_RECONF_SENT
;

4407 
¶ave
->
¶ave_ªc⁄f_£¡_time
 = 
	`m°ime
();

4408 
	`£¡öñEvít
(
LL_NOTICE
,"+¶ave-ªc⁄f-£¡",
¶ave
,"%@");

4409 
ö_¥ogªss
++;

4412 
	`di˘Rñó£Iãøt‹
(
di
);

4415 
	`£¡öñFaûovîDëe˘End
(
ma°î
);

4416 
	}
}

4421 
	$£¡öñFaûovîSwôchToPromŸedSœve
(
£¡öñRedisIn°™˚
 *
ma°î
) {

4422 
£¡öñRedisIn°™˚
 *
ªf
 = 
ma°î
->
¥omŸed_¶ave
 ?

4423 
ma°î
->
¥omŸed_¶ave
 : master;

4425 
	`£¡öñEvít
(
LL_WARNING
,"+swôch-ma°î",
ma°î
,"%s %s %d %s %d",

4426 
ma°î
->
«me
, ma°î->
addr
->
ù
, ma°î->addr->
p‹t
,

4427 
ªf
->
addr
->
ù
,Ñef->addr->
p‹t
);

4429 
	`£¡öñRe£tMa°îAndCh™geAddªss
(
ma°î
,
ªf
->
addr
->
ù
,ªf->addr->
p‹t
);

4430 
	}
}

4432 
	$£¡öñFaûovîSèãMachöe
(
£¡öñRedisIn°™˚
 *
ri
) {

4433 
	`£rvîAs£π
(
ri
->
Êags
 & 
SRI_MASTER
);

4435 i‡(!(
ri
->
Êags
 & 
SRI_FAILOVER_IN_PROGRESS
)) ;

4437 
ri
->
Áûovî_°©e
) {

4438 
SENTINEL_FAILOVER_STATE_WAIT_START
:

4439 
	`£¡öñFaûovîWaôSèπ
(
ri
);

4441 
SENTINEL_FAILOVER_STATE_SELECT_SLAVE
:

4442 
	`£¡öñFaûovîSñe˘Sœve
(
ri
);

4444 
SENTINEL_FAILOVER_STATE_SEND_SLAVEOF_NOONE
:

4445 
	`£¡öñFaûovîSídSœveOfNoO√
(
ri
);

4447 
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
:

4448 
	`£¡öñFaûovîWaôPromŸi⁄
(
ri
);

4450 
SENTINEL_FAILOVER_STATE_RECONF_SLAVES
:

4451 
	`£¡öñFaûovîRec⁄fNextSœve
(
ri
);

4454 
	}
}

4461 
	$£¡öñAb‹tFaûovî
(
£¡öñRedisIn°™˚
 *
ri
) {

4462 
	`£rvîAs£π
(
ri
->
Êags
 & 
SRI_FAILOVER_IN_PROGRESS
);

4463 
	`£rvîAs£π
(
ri
->
Áûovî_°©e
 <
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
);

4465 
ri
->
Êags
 &~(
SRI_FAILOVER_IN_PROGRESS
|
SRI_FORCE_FAILOVER
);

4466 
ri
->
Áûovî_°©e
 = 
SENTINEL_FAILOVER_STATE_NONE
;

4467 
ri
->
Áûovî_°©e_ch™ge_time
 = 
	`m°ime
();

4468 i‡(
ri
->
¥omŸed_¶ave
) {

4469 
ri
->
¥omŸed_¶ave
->
Êags
 &~
SRI_PROMOTED
;

4470 
ri
->
¥omŸed_¶ave
 = 
NULL
;

4472 
	}
}

4480 
	$£¡öñH™dÀRedisIn°™˚
(
£¡öñRedisIn°™˚
 *
ri
) {

4483 
	`£¡öñRec⁄√˘In°™˚
(
ri
);

4484 
	`£¡öñSídPîiodicComm™ds
(
ri
);

4490 i‡(
£¡öñ
.
tût
) {

4491 i‡(
	`m°ime
()-
£¡öñ
.
tût_°¨t_time
 < 
SENTINEL_TILT_PERIOD
) ;

4492 
£¡öñ
.
tût
 = 0;

4493 
	`£¡öñEvít
(
LL_WARNING
,"-tût",
NULL
,"#tilt modeÉxited");

4497 
	`£¡öñCheckSubje˘ivñyDown
(
ri
);

4500 i‡(
ri
->
Êags
 & (
SRI_MASTER
|
SRI_SLAVE
)) {

4505 i‡(
ri
->
Êags
 & 
SRI_MASTER
) {

4506 
	`£¡öñCheckObje˘ivñyDown
(
ri
);

4507 i‡(
	`£¡öñSèπFaûovîIfNìded
(
ri
))

4508 
	`£¡öñAskMa°îSèãToOthîSítöñs
(
ri
,
SENTINEL_ASK_FORCED
);

4509 
	`£¡öñFaûovîSèãMachöe
(
ri
);

4510 
	`£¡öñAskMa°îSèãToOthîSítöñs
(
ri
,
SENTINEL_NO_FLAGS
);

4512 
	}
}

4516 
	$£¡öñH™dÀDi˘OfRedisIn°™˚s
(
di˘
 *
ö°™˚s
) {

4517 
di˘Iãøt‹
 *
di
;

4518 
di˘E¡ry
 *
de
;

4519 
£¡öñRedisIn°™˚
 *
swôch_to_¥omŸed
 = 
NULL
;

4522 
di
 = 
	`di˘GëIãøt‹
(
ö°™˚s
);

4523 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

4524 
£¡öñRedisIn°™˚
 *
ri
 = 
	`di˘GëVÆ
(
de
);

4526 
	`£¡öñH™dÀRedisIn°™˚
(
ri
);

4527 i‡(
ri
->
Êags
 & 
SRI_MASTER
) {

4528 
	`£¡öñH™dÀDi˘OfRedisIn°™˚s
(
ri
->
¶aves
);

4529 
	`£¡öñH™dÀDi˘OfRedisIn°™˚s
(
ri
->
£¡öñs
);

4530 i‡(
ri
->
Áûovî_°©e
 =
SENTINEL_FAILOVER_STATE_UPDATE_CONFIG
) {

4531 
swôch_to_¥omŸed
 = 
ri
;

4535 i‡(
swôch_to_¥omŸed
)

4536 
	`£¡öñFaûovîSwôchToPromŸedSœve
(
swôch_to_¥omŸed
);

4537 
	`di˘Rñó£Iãøt‹
(
di
);

4538 
	}
}

4559 
	$£¡öñCheckTûtC⁄dôi⁄
() {

4560 
m°ime_t
 
now
 = 
	`m°ime
();

4561 
m°ime_t
 
dñè
 = 
now
 - 
£¡öñ
.
¥evious_time
;

4563 i‡(
dñè
 < 0 || dñè > 
SENTINEL_TILT_TRIGGER
) {

4564 
£¡öñ
.
tût
 = 1;

4565 
£¡öñ
.
tût_°¨t_time
 = 
	`m°ime
();

4566 
	`£¡öñEvít
(
LL_WARNING
,"+tût",
NULL
,"#tilt modeÉntered");

4568 
£¡öñ
.
¥evious_time
 = 
	`m°ime
();

4569 
	}
}

4571 
	$£¡öñTimî
() {

4572 
	`£¡öñCheckTûtC⁄dôi⁄
();

4573 
	`£¡öñH™dÀDi˘OfRedisIn°™˚s
(
£¡öñ
.
ma°îs
);

4574 
	`£¡öñRunPídögS¸ùts
();

4575 
	`£¡öñCﬁÀ˘Tîmö©edS¸ùts
();

4576 
	`£¡öñKûlTimedoutS¸ùts
();

4584 
£rvî
.
hz
 = 
CONFIG_DEFAULT_HZ
 + 
	`ønd
() % CONFIG_DEFAULT_HZ;

4585 
	}
}

	@server.c

30 
	~"£rvî.h
"

31 
	~"˛u°î.h
"

32 
	~"¶owlog.h
"

33 
	~"bio.h
"

34 
	~"œãncy.h
"

35 
	~"©omicv¨.h
"

37 
	~<time.h
>

38 
	~<sig«l.h
>

39 
	~<sys/waô.h
>

40 
	~<î∫o.h
>

41 
	~<as£π.h
>

42 
	~<˘y≥.h
>

43 
	~<°d¨g.h
>

44 
	~<¨∑/öë.h
>

45 
	~<sys/°©.h
>

46 
	~<f˙é.h
>

47 
	~<sys/time.h
>

48 
	~<sys/ªsour˚.h
>

49 
	~<sys/uio.h
>

50 
	~<sys/un.h
>

51 
	~<limôs.h
>

52 
	~<Êﬂt.h
>

53 
	~<m©h.h
>

54 
	~<sys/ªsour˚.h
>

55 
	~<sys/ut¢ame.h
>

56 
	~<loˇÀ.h
>

57 
	~<sys/sockë.h
>

61 
sh¨edObje˘sSåu˘
 
	gsh¨ed
;

67 
	gR_Zîo
, 
	gR_PosInf
, 
	gR_NegInf
, 
	gR_N™
;

72 
ªdisSîvî
 
	g£rvî
;

73 vﬁ©ûê
	gÃu_˛ock
;

182 
ªdisComm™d
 
	gªdisComm™dTabÀ
[] = {

183 {"moduÀ",
moduÀComm™d
,-2,

185 0,
NULL
,0,0,0,0,0,0},

187 {"gë",
gëComm™d
,2,

189 0,
NULL
,1,1,1,0,0,0},

193 {"£t",
£tComm™d
,-3,

195 0,
NULL
,1,1,1,0,0,0},

197 {"£äx",
£äxComm™d
,3,

199 0,
NULL
,1,1,1,0,0,0},

201 {"£ãx",
£ãxComm™d
,4,

203 0,
NULL
,1,1,1,0,0,0},

205 {"p£ãx",
p£ãxComm™d
,4,

207 0,
NULL
,1,1,1,0,0,0},

209 {"≠≥nd",
≠≥ndComm™d
,3,

211 0,
NULL
,1,1,1,0,0,0},

213 {"°æí",
°æíComm™d
,2,

215 0,
NULL
,1,1,1,0,0,0},

217 {"dñ",
dñComm™d
,-2,

219 0,
NULL
,1,-1,1,0,0,0},

221 {"u∆ök",
u∆ökComm™d
,-2,

223 0,
NULL
,1,-1,1,0,0,0},

225 {"exi°s",
exi°sComm™d
,-2,

227 0,
NULL
,1,-1,1,0,0,0},

229 {"£tbô",
£tbôComm™d
,4,

231 0,
NULL
,1,1,1,0,0,0},

233 {"gëbô",
gëbôComm™d
,3,

235 0,
NULL
,1,1,1,0,0,0},

237 {"bôfõld",
bôfõldComm™d
,-2,

239 0,
NULL
,1,1,1,0,0,0},

241 {"bôfõld_ro",
bôfõldroComm™d
,-2,

243 0,
NULL
,1,1,1,0,0,0},

245 {"£å™ge",
£å™geComm™d
,4,

247 0,
NULL
,1,1,1,0,0,0},

249 {"gëønge",
gëøngeComm™d
,4,

251 0,
NULL
,1,1,1,0,0,0},

253 {"sub°r",
gëøngeComm™d
,4,

255 0,
NULL
,1,1,1,0,0,0},

257 {"ö¸",
ö¸Comm™d
,2,

259 0,
NULL
,1,1,1,0,0,0},

261 {"de¸",
de¸Comm™d
,2,

263 0,
NULL
,1,1,1,0,0,0},

265 {"mgë",
mgëComm™d
,-2,

267 0,
NULL
,1,-1,1,0,0,0},

269 {"Ωush",
ΩushComm™d
,-3,

271 0,
NULL
,1,1,1,0,0,0},

273 {"Õush",
ÕushComm™d
,-3,

275 0,
NULL
,1,1,1,0,0,0},

277 {"Ωushx",
ΩushxComm™d
,-3,

279 0,
NULL
,1,1,1,0,0,0},

281 {"Õushx",
ÕushxComm™d
,-3,

283 0,
NULL
,1,1,1,0,0,0},

285 {"lö£π",
lö£πComm™d
,5,

287 0,
NULL
,1,1,1,0,0,0},

289 {"Ω›",
Ω›Comm™d
,2,

291 0,
NULL
,1,1,1,0,0,0},

293 {"Õ›",
Õ›Comm™d
,2,

295 0,
NULL
,1,1,1,0,0,0},

297 {"bΩ›",
bΩ›Comm™d
,-3,

299 0,
NULL
,1,-2,1,0,0,0},

301 {"bΩ›Õush",
bΩ›ÕushComm™d
,4,

303 0,
NULL
,1,2,1,0,0,0},

305 {"bÕ›",
bÕ›Comm™d
,-3,

307 0,
NULL
,1,-2,1,0,0,0},

309 {"Œí",
ŒíComm™d
,2,

311 0,
NULL
,1,1,1,0,0,0},

313 {"lödex",
lödexComm™d
,3,

315 0,
NULL
,1,1,1,0,0,0},

317 {"l£t",
l£tComm™d
,4,

319 0,
NULL
,1,1,1,0,0,0},

321 {"Ã™ge",
Ã™geComm™d
,4,

323 0,
NULL
,1,1,1,0,0,0},

325 {"…rim",
…rimComm™d
,4,

327 0,
NULL
,1,1,1,0,0,0},

329 {"Ãem",
ÃemComm™d
,4,

331 0,
NULL
,1,1,1,0,0,0},

333 {"Ω›Õush",
Ω›ÕushComm™d
,3,

335 0,
NULL
,1,2,1,0,0,0},

337 {"ßdd",
ßddComm™d
,-3,

339 0,
NULL
,1,1,1,0,0,0},

341 {"§em",
§emComm™d
,-3,

343 0,
NULL
,1,1,1,0,0,0},

345 {"smove",
smoveComm™d
,4,

347 0,
NULL
,1,2,1,0,0,0},

349 {"sismembî",
sismembîComm™d
,3,

351 0,
NULL
,1,1,1,0,0,0},

353 {"sˇrd",
sˇrdComm™d
,2,

355 0,
NULL
,1,1,1,0,0,0},

357 {"•›",
•›Comm™d
,-2,

359 0,
NULL
,1,1,1,0,0,0},

361 {"§™dmembî",
§™dmembîComm™d
,-2,

363 0,
NULL
,1,1,1,0,0,0},

365 {"söãr",
söãrComm™d
,-2,

367 0,
NULL
,1,-1,1,0,0,0},

369 {"söãr°‹e",
söãr°‹eComm™d
,-3,

371 0,
NULL
,1,-1,1,0,0,0},

373 {"suni⁄",
suni⁄Comm™d
,-2,

375 0,
NULL
,1,-1,1,0,0,0},

377 {"suni⁄°‹e",
suni⁄°‹eComm™d
,-3,

379 0,
NULL
,1,-1,1,0,0,0},

381 {"sdiff",
sdiffComm™d
,-2,

383 0,
NULL
,1,-1,1,0,0,0},

385 {"sdiff°‹e",
sdiff°‹eComm™d
,-3,

387 0,
NULL
,1,-1,1,0,0,0},

389 {"smembîs",
söãrComm™d
,2,

391 0,
NULL
,1,1,1,0,0,0},

393 {"ssˇn",
ssˇnComm™d
,-3,

395 0,
NULL
,1,1,1,0,0,0},

397 {"zadd",
zaddComm™d
,-4,

399 0,
NULL
,1,1,1,0,0,0},

401 {"zö¸by",
zö¸byComm™d
,4,

403 0,
NULL
,1,1,1,0,0,0},

405 {"zªm",
zªmComm™d
,-3,

407 0,
NULL
,1,1,1,0,0,0},

409 {"zªmøngebysc‹e",
zªmøngebysc‹eComm™d
,4,

411 0,
NULL
,1,1,1,0,0,0},

413 {"zªmøngebyønk",
zªmøngebyønkComm™d
,4,

415 0,
NULL
,1,1,1,0,0,0},

417 {"zªmøngebyÀx",
zªmøngebyÀxComm™d
,4,

419 0,
NULL
,1,1,1,0,0,0},

421 {"zuni⁄°‹e",
zuni⁄°‹eComm™d
,-4,

423 0,
zuni⁄I¡îGëKeys
,0,0,0,0,0,0},

425 {"zöãr°‹e",
zöãr°‹eComm™d
,-4,

427 0,
zuni⁄I¡îGëKeys
,0,0,0,0,0,0},

429 {"zønge",
zøngeComm™d
,-4,

431 0,
NULL
,1,1,1,0,0,0},

433 {"zøngebysc‹e",
zøngebysc‹eComm™d
,-4,

435 0,
NULL
,1,1,1,0,0,0},

437 {"zªvøngebysc‹e",
zªvøngebysc‹eComm™d
,-4,

439 0,
NULL
,1,1,1,0,0,0},

441 {"zøngebyÀx",
zøngebyÀxComm™d
,-4,

443 0,
NULL
,1,1,1,0,0,0},

445 {"zªvøngebyÀx",
zªvøngebyÀxComm™d
,-4,

447 0,
NULL
,1,1,1,0,0,0},

449 {"zcou¡",
zcou¡Comm™d
,4,

451 0,
NULL
,1,1,1,0,0,0},

453 {"zÀxcou¡",
zÀxcou¡Comm™d
,4,

455 0,
NULL
,1,1,1,0,0,0},

457 {"zªvønge",
zªvøngeComm™d
,-4,

459 0,
NULL
,1,1,1,0,0,0},

461 {"zˇrd",
zˇrdComm™d
,2,

463 0,
NULL
,1,1,1,0,0,0},

465 {"zsc‹e",
zsc‹eComm™d
,3,

467 0,
NULL
,1,1,1,0,0,0},

469 {"zønk",
zønkComm™d
,3,

471 0,
NULL
,1,1,1,0,0,0},

473 {"zªvønk",
zªvønkComm™d
,3,

475 0,
NULL
,1,1,1,0,0,0},

477 {"zsˇn",
zsˇnComm™d
,-3,

479 0,
NULL
,1,1,1,0,0,0},

481 {"zp›mö",
zp›möComm™d
,-2,

483 0,
NULL
,1,1,1,0,0,0},

485 {"zp›max",
zp›maxComm™d
,-2,

487 0,
NULL
,1,1,1,0,0,0},

489 {"bzp›mö",
bzp›möComm™d
,-3,

491 0,
NULL
,1,-2,1,0,0,0},

493 {"bzp›max",
bzp›maxComm™d
,-3,

495 0,
NULL
,1,-2,1,0,0,0},

497 {"h£t",
h£tComm™d
,-4,

499 0,
NULL
,1,1,1,0,0,0},

501 {"h£äx",
h£äxComm™d
,4,

503 0,
NULL
,1,1,1,0,0,0},

505 {"hgë",
hgëComm™d
,3,

507 0,
NULL
,1,1,1,0,0,0},

509 {"hm£t",
h£tComm™d
,-4,

511 0,
NULL
,1,1,1,0,0,0},

513 {"hmgë",
hmgëComm™d
,-3,

515 0,
NULL
,1,1,1,0,0,0},

517 {"hö¸by",
hö¸byComm™d
,4,

519 0,
NULL
,1,1,1,0,0,0},

521 {"hö¸byÊﬂt",
hö¸byÊﬂtComm™d
,4,

523 0,
NULL
,1,1,1,0,0,0},

525 {"hdñ",
hdñComm™d
,-3,

527 0,
NULL
,1,1,1,0,0,0},

529 {"hÀn",
hÀnComm™d
,2,

531 0,
NULL
,1,1,1,0,0,0},

533 {"h°æí",
h°æíComm™d
,3,

535 0,
NULL
,1,1,1,0,0,0},

537 {"hkeys",
hkeysComm™d
,2,

539 0,
NULL
,1,1,1,0,0,0},

541 {"hvÆs",
hvÆsComm™d
,2,

543 0,
NULL
,1,1,1,0,0,0},

545 {"hgëÆl",
hgëÆlComm™d
,2,

547 0,
NULL
,1,1,1,0,0,0},

549 {"hexi°s",
hexi°sComm™d
,3,

551 0,
NULL
,1,1,1,0,0,0},

553 {"hsˇn",
hsˇnComm™d
,-3,

555 0,
NULL
,1,1,1,0,0,0},

557 {"ö¸by",
ö¸byComm™d
,3,

559 0,
NULL
,1,1,1,0,0,0},

561 {"de¸by",
de¸byComm™d
,3,

563 0,
NULL
,1,1,1,0,0,0},

565 {"ö¸byÊﬂt",
ö¸byÊﬂtComm™d
,3,

567 0,
NULL
,1,1,1,0,0,0},

569 {"gë£t",
gë£tComm™d
,3,

571 0,
NULL
,1,1,1,0,0,0},

573 {"m£t",
m£tComm™d
,-3,

575 0,
NULL
,1,-1,2,0,0,0},

577 {"m£äx",
m£äxComm™d
,-3,

579 0,
NULL
,1,-1,2,0,0,0},

581 {"øndomkey",
øndomkeyComm™d
,1,

583 0,
NULL
,0,0,0,0,0,0},

585 {"£À˘",
£À˘Comm™d
,2,

587 0,
NULL
,0,0,0,0,0,0},

589 {"sw≠db",
sw≠dbComm™d
,3,

591 0,
NULL
,0,0,0,0,0,0},

593 {"move",
moveComm™d
,3,

595 0,
NULL
,1,1,1,0,0,0},

599 {"ª«me",
ª«meComm™d
,3,

601 0,
NULL
,1,2,1,0,0,0},

603 {"ª«míx",
ª«míxComm™d
,3,

605 0,
NULL
,1,2,1,0,0,0},

607 {"expúe",
expúeComm™d
,3,

609 0,
NULL
,1,1,1,0,0,0},

611 {"expúót",
expúótComm™d
,3,

613 0,
NULL
,1,1,1,0,0,0},

615 {"≥xpúe",
≥xpúeComm™d
,3,

617 0,
NULL
,1,1,1,0,0,0},

619 {"≥xpúót",
≥xpúótComm™d
,3,

621 0,
NULL
,1,1,1,0,0,0},

623 {"keys",
keysComm™d
,2,

625 0,
NULL
,0,0,0,0,0,0},

627 {"sˇn",
sˇnComm™d
,-2,

629 0,
NULL
,0,0,0,0,0,0},

631 {"dbsize",
dbsizeComm™d
,1,

633 0,
NULL
,0,0,0,0,0,0},

635 {"auth",
authComm™d
,-2,

637 0,
NULL
,0,0,0,0,0,0},

642 {"pög",
pögComm™d
,-1,

644 0,
NULL
,0,0,0,0,0,0},

646 {"echo",
echoComm™d
,2,

648 0,
NULL
,0,0,0,0,0,0},

650 {"ßve",
ßveComm™d
,1,

652 0,
NULL
,0,0,0,0,0,0},

654 {"bgßve",
bgßveComm™d
,-1,

656 0,
NULL
,0,0,0,0,0,0},

658 {"bgªwrôóof",
bgªwrôóofComm™d
,1,

660 0,
NULL
,0,0,0,0,0,0},

662 {"shutdown",
shutdownComm™d
,-1,

664 0,
NULL
,0,0,0,0,0,0},

666 {"œ°ßve",
œ°ßveComm™d
,1,

668 0,
NULL
,0,0,0,0,0,0},

670 {"ty≥",
ty≥Comm™d
,2,

672 0,
NULL
,1,1,1,0,0,0},

674 {"mu…i",
mu…iComm™d
,1,

676 0,
NULL
,0,0,0,0,0,0},

678 {"exec",
execComm™d
,1,

680 0,
NULL
,0,0,0,0,0,0},

682 {"disˇrd",
disˇrdComm™d
,1,

684 0,
NULL
,0,0,0,0,0,0},

686 {"sync",
syncComm™d
,1,

688 0,
NULL
,0,0,0,0,0,0},

690 {"psync",
syncComm™d
,3,

692 0,
NULL
,0,0,0,0,0,0},

694 {"ª∂c⁄f",
ª∂c⁄fComm™d
,-1,

696 0,
NULL
,0,0,0,0,0,0},

698 {"Êushdb",
ÊushdbComm™d
,-1,

700 0,
NULL
,0,0,0,0,0,0},

702 {"ÊushÆl",
ÊushÆlComm™d
,-1,

704 0,
NULL
,0,0,0,0,0,0},

706 {"s‹t",
s‹tComm™d
,-2,

708 0,
s‹tGëKeys
,1,1,1,0,0,0},

710 {"öfo",
öfoComm™d
,-1,

712 0,
NULL
,0,0,0,0,0,0},

714 {"m⁄ô‹",
m⁄ô‹Comm™d
,1,

716 0,
NULL
,0,0,0,0,0,0},

718 {"âl",
âlComm™d
,2,

720 0,
NULL
,1,1,1,0,0,0},

722 {"touch",
touchComm™d
,-2,

724 0,
NULL
,1,-1,1,0,0,0},

726 {"±é",
±éComm™d
,2,

728 0,
NULL
,1,1,1,0,0,0},

730 {"≥rsi°",
≥rsi°Comm™d
,2,

732 0,
NULL
,1,1,1,0,0,0},

734 {"¶aveof",
ª∂iˇofComm™d
,3,

736 0,
NULL
,0,0,0,0,0,0},

738 {"ª∂iˇof",
ª∂iˇofComm™d
,3,

740 0,
NULL
,0,0,0,0,0,0},

742 {"rﬁe",
rﬁeComm™d
,1,

744 0,
NULL
,0,0,0,0,0,0},

746 {"debug",
debugComm™d
,-2,

748 0,
NULL
,0,0,0,0,0,0},

750 {"c⁄fig",
c⁄figComm™d
,-2,

752 0,
NULL
,0,0,0,0,0,0},

754 {"subs¸ibe",
subs¸ibeComm™d
,-2,

756 0,
NULL
,0,0,0,0,0,0},

758 {"unsubs¸ibe",
unsubs¸ibeComm™d
,-1,

760 0,
NULL
,0,0,0,0,0,0},

762 {"psubs¸ibe",
psubs¸ibeComm™d
,-2,

764 0,
NULL
,0,0,0,0,0,0},

766 {"punsubs¸ibe",
punsubs¸ibeComm™d
,-1,

768 0,
NULL
,0,0,0,0,0,0},

770 {"publish",
publishComm™d
,3,

772 0,
NULL
,0,0,0,0,0,0},

774 {"pubsub",
pubsubComm™d
,-2,

776 0,
NULL
,0,0,0,0,0,0},

778 {"w©ch",
w©chComm™d
,-2,

780 0,
NULL
,1,-1,1,0,0,0},

782 {"unw©ch",
unw©chComm™d
,1,

784 0,
NULL
,0,0,0,0,0,0},

786 {"˛u°î",
˛u°îComm™d
,-2,

788 0,
NULL
,0,0,0,0,0,0},

790 {"ª°‹e",
ª°‹eComm™d
,-4,

792 0,
NULL
,1,1,1,0,0,0},

794 {"ª°‹e-askög",
ª°‹eComm™d
,-4,

796 0,
NULL
,1,1,1,0,0,0},

798 {"migøã",
migøãComm™d
,-6,

800 0,
migøãGëKeys
,0,0,0,0,0,0},

802 {"askög",
askögComm™d
,1,

804 0,
NULL
,0,0,0,0,0,0},

806 {"ªad⁄ly",
ªad⁄lyComm™d
,1,

808 0,
NULL
,0,0,0,0,0,0},

810 {"ªadwrôe",
ªadwrôeComm™d
,1,

812 0,
NULL
,0,0,0,0,0,0},

814 {"dump",
dumpComm™d
,2,

816 0,
NULL
,1,1,1,0,0,0},

818 {"obje˘",
obje˘Comm™d
,-2,

820 0,
NULL
,2,2,1,0,0,0},

822 {"mem‹y",
mem‹yComm™d
,-2,

824 0,
mem‹yGëKeys
,0,0,0,0,0,0},

826 {"˛õ¡",
˛õ¡Comm™d
,-2,

828 0,
NULL
,0,0,0,0,0,0},

830 {"hñlo",
hñloComm™d
,-2,

832 0,
NULL
,0,0,0,0,0,0},

836 {"evÆ",
evÆComm™d
,-3,

838 0,
evÆGëKeys
,0,0,0,0,0,0},

840 {"evÆsha",
evÆShaComm™d
,-3,

842 0,
evÆGëKeys
,0,0,0,0,0,0},

844 {"¶owlog",
¶owlogComm™d
,-2,

846 0,
NULL
,0,0,0,0,0,0},

848 {"s¸ùt",
s¸ùtComm™d
,-2,

850 0,
NULL
,0,0,0,0,0,0},

852 {"time",
timeComm™d
,1,

854 0,
NULL
,0,0,0,0,0,0},

856 {"bô›",
bô›Comm™d
,-4,

858 0,
NULL
,2,-1,1,0,0,0},

860 {"bôcou¡",
bôcou¡Comm™d
,-2,

862 0,
NULL
,1,1,1,0,0,0},

864 {"bôpos",
bôposComm™d
,-3,

866 0,
NULL
,1,1,1,0,0,0},

868 {"waô",
waôComm™d
,3,

870 0,
NULL
,0,0,0,0,0,0},

872 {"comm™d",
comm™dComm™d
,-1,

874 0,
NULL
,0,0,0,0,0,0},

876 {"geﬂdd",
geﬂddComm™d
,-5,

878 0,
NULL
,1,1,1,0,0,0},

881 {"ge‹adius",
ge‹adiusComm™d
,-6,

883 0,
ge‹adiusGëKeys
,1,1,1,0,0,0},

885 {"ge‹adius_ro",
ge‹adiu§oComm™d
,-6,

887 0,
ge‹adiusGëKeys
,1,1,1,0,0,0},

889 {"ge‹adiusbymembî",
ge‹adiusbymembîComm™d
,-5,

891 0,
ge‹adiusGëKeys
,1,1,1,0,0,0},

893 {"ge‹adiusbymembî_ro",
ge‹adiusbymembîroComm™d
,-5,

895 0,
ge‹adiusGëKeys
,1,1,1,0,0,0},

897 {"geohash",
geohashComm™d
,-2,

899 0,
NULL
,1,1,1,0,0,0},

901 {"ge›os",
ge›osComm™d
,-2,

903 0,
NULL
,1,1,1,0,0,0},

905 {"geodi°",
geodi°Comm™d
,-4,

907 0,
NULL
,1,1,1,0,0,0},

909 {"pf£l·e°",
pf£l·e°Comm™d
,1,

911 0,
NULL
,0,0,0,0,0,0},

913 {"pÁdd",
pÁddComm™d
,-2,

915 0,
NULL
,1,1,1,0,0,0},

921 {"pfcou¡",
pfcou¡Comm™d
,-2,

923 0,
NULL
,1,-1,1,0,0,0},

925 {"pfmîge",
pfmîgeComm™d
,-2,

927 0,
NULL
,1,-1,1,0,0,0},

929 {"pfdebug",
pfdebugComm™d
,-3,

931 0,
NULL
,0,0,0,0,0,0},

933 {"xadd",
xaddComm™d
,-5,

935 0,
NULL
,1,1,1,0,0,0},

937 {"xønge",
xøngeComm™d
,-4,

939 0,
NULL
,1,1,1,0,0,0},

941 {"xªvønge",
xªvøngeComm™d
,-4,

943 0,
NULL
,1,1,1,0,0,0},

945 {"xÀn",
xÀnComm™d
,2,

947 0,
NULL
,1,1,1,0,0,0},

949 {"xªad",
xªadComm™d
,-4,

951 0,
xªadGëKeys
,1,1,1,0,0,0},

953 {"xªadgroup",
xªadComm™d
,-7,

955 0,
xªadGëKeys
,1,1,1,0,0,0},

957 {"xgroup",
xgroupComm™d
,-2,

959 0,
NULL
,2,2,1,0,0,0},

961 {"x£tid",
x£tidComm™d
,3,

963 0,
NULL
,1,1,1,0,0,0},

965 {"xack",
xackComm™d
,-4,

967 0,
NULL
,1,1,1,0,0,0},

969 {"x≥ndög",
x≥ndögComm™d
,-3,

971 0,
NULL
,1,1,1,0,0,0},

973 {"x˛aim",
x˛aimComm™d
,-6,

975 0,
NULL
,1,1,1,0,0,0},

977 {"xöfo",
xöfoComm™d
,-2,

979 0,
NULL
,2,2,1,0,0,0},

981 {"xdñ",
xdñComm™d
,-3,

983 0,
NULL
,1,1,1,0,0,0},

985 {"xåim",
xåimComm™d
,-2,

987 0,
NULL
,1,1,1,0,0,0},

989 {"po°",
£curôyW¨nögComm™d
,-1,

991 0,
NULL
,0,0,0,0,0,0},

993 {"ho°:",
£curôyW¨nögComm™d
,-1,

995 0,
NULL
,0,0,0,0,0,0},

997 {"œãncy",
œãncyComm™d
,-2,

999 0,
NULL
,0,0,0,0,0,0},

1001 {"lﬁwut",
lﬁwutComm™d
,-1,

1003 0,
NULL
,0,0,0,0,0,0},

1005 {"a˛",
a˛Comm™d
,-2,

1007 0,
NULL
,0,0,0,0,0,0},

1009 {"°ølgo",
°ølgoComm™d
,-2,

1011 0,
lcsGëKeys
,0,0,0,0,0,0}

1018 
nﬁocks_loˇ…ime
(
tm
 *
tmp
, 
time_t
 
t
,Åime_à
tz
, 
d°
);

1022 
	$£rvîLogRaw
(
Àvñ
, c⁄° *
msg
) {

1023 c⁄° 
sy¶ogLevñM≠
[] = { 
LOG_DEBUG
, 
LOG_INFO
, 
LOG_NOTICE
, 
LOG_WARNING
 };

1024 c⁄° *
c
 = ".-*#";

1025 
FILE
 *
Â
;

1026 
buf
[64];

1027 
øwmode
 = (
Àvñ
 & 
LL_RAW
);

1028 
log_to_°dout
 = 
£rvî
.
logfûe
[0] == '\0';

1030 
Àvñ
 &= 0xff;

1031 i‡(
Àvñ
 < 
£rvî
.
vîbosôy
) ;

1033 
Â
 = 
log_to_°dout
 ? 
°dout
 : 
	`f›í
(
£rvî
.
logfûe
,"a");

1034 i‡(!
Â
) ;

1036 i‡(
øwmode
) {

1037 
	`Ârötf
(
Â
,"%s",
msg
);

1039 
off
;

1040 
timevÆ
 
tv
;

1041 
rﬁe_ch¨
;

1042 
pid_t
 
pid
 = 
	`gëpid
();

1044 
	`gëtimeofday
(&
tv
,
NULL
);

1045 
tm
Åm;

1046 
	`nﬁocks_loˇ…ime
(&
tm
,
tv
.
tv_£c
,
£rvî
.
timez⁄e
,£rvî.
daylight_a˘ive
);

1047 
off
 = 
	`°r·ime
(
buf
,(buf),"%d %b %Y %H:%M:%S.",&
tm
);

1048 
	`¢¥ötf
(
buf
+
off
,(buf)-off,"%03d",()
tv
.
tv_u£c
/1000);

1049 i‡(
£rvî
.
£¡öñ_mode
) {

1050 
rﬁe_ch¨
 = 'X';

1051 } i‡(
pid
 !
£rvî
.pid) {

1052 
rﬁe_ch¨
 = 'C';

1054 
rﬁe_ch¨
 = (
£rvî
.
ma°îho°
 ? 'S':'M');

1056 
	`Ârötf
(
Â
,"%d:%c %s %c %s\n",

1057 ()
	`gëpid
(),
rﬁe_ch¨
, 
buf
,
c
[
Àvñ
],
msg
);

1059 
	`fÊush
(
Â
);

1061 i‡(!
log_to_°dout
Ë
	`f˛o£
(
Â
);

1062 i‡(
£rvî
.
sy¶og_íabÀd
Ë
	`sy¶og
(
sy¶ogLevñM≠
[
Àvñ
], "%s", 
msg
);

1063 
	}
}

1068 
	$£rvîLog
(
Àvñ
, c⁄° *
fmt
, ...) {

1069 
va_li°
 
≠
;

1070 
msg
[
LOG_MAX_LEN
];

1072 i‡((
Àvñ
&0xffË< 
£rvî
.
vîbosôy
) ;

1074 
	`va_°¨t
(
≠
, 
fmt
);

1075 
	`v¢¥ötf
(
msg
, (msg), 
fmt
, 
≠
);

1076 
	`va_íd
(
≠
);

1078 
	`£rvîLogRaw
(
Àvñ
,
msg
);

1079 
	}
}

1087 
	$£rvîLogFromH™dÀr
(
Àvñ
, c⁄° *
msg
) {

1088 
fd
;

1089 
log_to_°dout
 = 
£rvî
.
logfûe
[0] == '\0';

1090 
buf
[64];

1092 i‡((
Àvñ
&0xffË< 
£rvî
.
vîbosôy
 || (
log_to_°dout
 && sîvî.
d´m⁄ize
))

1094 
fd
 = 
log_to_°dout
 ? 
STDOUT_FILENO
 :

1095 
	`›í
(
£rvî
.
logfûe
, 
O_APPEND
|
O_CREAT
|
O_WRONLY
, 0644);

1096 i‡(
fd
 == -1) ;

1097 
	`Œ2°rög
(
buf
,(buf),
	`gëpid
());

1098 i‡(
	`wrôe
(
fd
,
buf
,
	`°æí
(buf)Ë=-1Ë
îr
;

1099 i‡(
	`wrôe
(
fd
,":sig«l-h™dÀ∏(",17Ë=-1Ë
îr
;

1100 
	`Œ2°rög
(
buf
,(buf),
	`time
(
NULL
));

1101 i‡(
	`wrôe
(
fd
,
buf
,
	`°æí
(buf)Ë=-1Ë
îr
;

1102 i‡(
	`wrôe
(
fd
,"Ë",2Ë=-1Ë
îr
;

1103 i‡(
	`wrôe
(
fd
,
msg
,
	`°æí
(msg)Ë=-1Ë
îr
;

1104 i‡(
	`wrôe
(
fd
,"\n",1Ë=-1Ë
îr
;

1105 
îr
:

1106 i‡(!
log_to_°dout
Ë
	`˛o£
(
fd
);

1107 
	}
}

1110 
	$u°ime
() {

1111 
timevÆ
 
tv
;

1112 
u°
;

1114 
	`gëtimeofday
(&
tv
, 
NULL
);

1115 
u°
 = (()
tv
.
tv_£c
)*1000000;

1116 
u°
 +
tv
.
tv_u£c
;

1117  
u°
;

1118 
	}
}

1121 
m°ime_t
 
	$m°ime
() {

1122  
	`u°ime
()/1000;

1123 
	}
}

1129 
	$exôFromChûd
(
ªtcode
) {

1130 #ifde‡
COVERAGE_TEST


1131 
	`exô
(
ªtcode
);

1133 
	`_exô
(
ªtcode
);

1135 
	}
}

1143 
	$di˘V™ûœFªe
(*
¥ivd©a
, *
vÆ
)

1145 
	`DICT_NOTUSED
(
¥ivd©a
);

1146 
	`z‰ì
(
vÆ
);

1147 
	}
}

1149 
	$di˘Li°De°ru˘‹
(*
¥ivd©a
, *
vÆ
)

1151 
	`DICT_NOTUSED
(
¥ivd©a
);

1152 
	`li°Rñó£
((
li°
*)
vÆ
);

1153 
	}
}

1155 
	$di˘SdsKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
,

1156 c⁄° *
key2
)

1158 
l1
,
l2
;

1159 
	`DICT_NOTUSED
(
¥ivd©a
);

1161 
l1
 = 
	`sd¶í
((
sds
)
key1
);

1162 
l2
 = 
	`sd¶í
((
sds
)
key2
);

1163 i‡(
l1
 !
l2
)  0;

1164  
	`memcmp
(
key1
, 
key2
, 
l1
) == 0;

1165 
	}
}

1169 
	$di˘SdsKeyCa£Com∑ª
(*
¥ivd©a
, c⁄° *
key1
,

1170 c⁄° *
key2
)

1172 
	`DICT_NOTUSED
(
¥ivd©a
);

1174  
	`°rˇ£cmp
(
key1
, 
key2
) == 0;

1175 
	}
}

1177 
	$di˘Obje˘De°ru˘‹
(*
¥ivd©a
, *
vÆ
)

1179 
	`DICT_NOTUSED
(
¥ivd©a
);

1181 i‡(
vÆ
 =
NULL
) ;

1182 
	`de¸RefCou¡
(
vÆ
);

1183 
	}
}

1185 
	$di˘SdsDe°ru˘‹
(*
¥ivd©a
, *
vÆ
)

1187 
	`DICT_NOTUSED
(
¥ivd©a
);

1189 
	`sds‰ì
(
vÆ
);

1190 
	}
}

1192 
	$di˘ObjKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
,

1193 c⁄° *
key2
)

1195 c⁄° 
robj
 *
o1
 = 
key1
, *
o2
 = 
key2
;

1196  
	`di˘SdsKeyCom∑ª
(
¥ivd©a
,
o1
->
±r
,
o2
->ptr);

1197 
	}
}

1199 
uöt64_t
 
	$di˘ObjHash
(c⁄° *
key
) {

1200 c⁄° 
robj
 *
o
 = 
key
;

1201  
	`di˘GíHashFun˘i⁄
(
o
->
±r
, 
	`sd¶í
((
sds
)o->ptr));

1202 
	}
}

1204 
uöt64_t
 
	$di˘SdsHash
(c⁄° *
key
) {

1205  
	`di˘GíHashFun˘i⁄
((*)
key
, 
	`sd¶í
((*)key));

1206 
	}
}

1208 
uöt64_t
 
	$di˘SdsCa£Hash
(c⁄° *
key
) {

1209  
	`di˘GíCa£HashFun˘i⁄
((*)
key
, 
	`sd¶í
((*)key));

1210 
	}
}

1212 
	$di˘EncObjKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
,

1213 c⁄° *
key2
)

1215 
robj
 *
o1
 = (robj*Ë
key1
, *
o2
 = (robj*Ë
key2
;

1216 
cmp
;

1218 i‡(
o1
->
ícodög
 =
OBJ_ENCODING_INT
 &&

1219 
o2
->
ícodög
 =
OBJ_ENCODING_INT
)

1220  
o1
->
±r
 =
o2
->ptr;

1226 i‡(
o1
->
ªfcou¡
 !
OBJ_STATIC_REFCOUNT
Ëo1 = 
	`gëDecodedObje˘
(o1);

1227 i‡(
o2
->
ªfcou¡
 !
OBJ_STATIC_REFCOUNT
Ëo2 = 
	`gëDecodedObje˘
(o2);

1228 
cmp
 = 
	`di˘SdsKeyCom∑ª
(
¥ivd©a
,
o1
->
±r
,
o2
->ptr);

1229 i‡(
o1
->
ªfcou¡
 !
OBJ_STATIC_REFCOUNT
Ë
	`de¸RefCou¡
(o1);

1230 i‡(
o2
->
ªfcou¡
 !
OBJ_STATIC_REFCOUNT
Ë
	`de¸RefCou¡
(o2);

1231  
cmp
;

1232 
	}
}

1234 
uöt64_t
 
	$di˘EncObjHash
(c⁄° *
key
) {

1235 
robj
 *
o
 = (robj*Ë
key
;

1237 i‡(
	`sdsEncodedObje˘
(
o
)) {

1238  
	`di˘GíHashFun˘i⁄
(
o
->
±r
, 
	`sd¶í
((
sds
)o->ptr));

1240 i‡(
o
->
ícodög
 =
OBJ_ENCODING_INT
) {

1241 
buf
[32];

1242 
Àn
;

1244 
Àn
 = 
	`Œ2°rög
(
buf
,32,()
o
->
±r
);

1245  
	`di˘GíHashFun˘i⁄
((*)
buf
, 
Àn
);

1247 
uöt64_t
 
hash
;

1249 
o
 = 
	`gëDecodedObje˘
(o);

1250 
hash
 = 
	`di˘GíHashFun˘i⁄
(
o
->
±r
, 
	`sd¶í
((
sds
)o->ptr));

1251 
	`de¸RefCou¡
(
o
);

1252  
hash
;

1255 
	}
}

1259 
di˘Ty≥
 
	gobje˘KeyPoöãrVÆueDi˘Ty≥
 = {

1260 
di˘EncObjHash
,

1261 
NULL
,

1262 
NULL
,

1263 
di˘EncObjKeyCom∑ª
,

1264 
di˘Obje˘De°ru˘‹
,

1265 
NULL


1270 
di˘Ty≥
 
	gobje˘KeyHópPoöãrVÆueDi˘Ty≥
 = {

1271 
di˘EncObjHash
,

1272 
NULL
,

1273 
NULL
,

1274 
di˘EncObjKeyCom∑ª
,

1275 
di˘Obje˘De°ru˘‹
,

1276 
di˘V™ûœFªe


1280 
di˘Ty≥
 
	g£tDi˘Ty≥
 = {

1281 
di˘SdsHash
,

1282 
NULL
,

1283 
NULL
,

1284 
di˘SdsKeyCom∑ª
,

1285 
di˘SdsDe°ru˘‹
,

1286 
NULL


1290 
di˘Ty≥
 
	gz£tDi˘Ty≥
 = {

1291 
di˘SdsHash
,

1292 
NULL
,

1293 
NULL
,

1294 
di˘SdsKeyCom∑ª
,

1295 
NULL
,

1296 
NULL


1300 
di˘Ty≥
 
	gdbDi˘Ty≥
 = {

1301 
di˘SdsHash
,

1302 
NULL
,

1303 
NULL
,

1304 
di˘SdsKeyCom∑ª
,

1305 
di˘SdsDe°ru˘‹
,

1306 
di˘Obje˘De°ru˘‹


1310 
di˘Ty≥
 
	gshaS¸ùtObje˘Di˘Ty≥
 = {

1311 
di˘SdsCa£Hash
,

1312 
NULL
,

1313 
NULL
,

1314 
di˘SdsKeyCa£Com∑ª
,

1315 
di˘SdsDe°ru˘‹
,

1316 
di˘Obje˘De°ru˘‹


1320 
di˘Ty≥
 
	gkey±rDi˘Ty≥
 = {

1321 
di˘SdsHash
,

1322 
NULL
,

1323 
NULL
,

1324 
di˘SdsKeyCom∑ª
,

1325 
NULL
,

1326 
NULL


1330 
di˘Ty≥
 
	gcomm™dTabÀDi˘Ty≥
 = {

1331 
di˘SdsCa£Hash
,

1332 
NULL
,

1333 
NULL
,

1334 
di˘SdsKeyCa£Com∑ª
,

1335 
di˘SdsDe°ru˘‹
,

1336 
NULL


1340 
di˘Ty≥
 
	ghashDi˘Ty≥
 = {

1341 
di˘SdsHash
,

1342 
NULL
,

1343 
NULL
,

1344 
di˘SdsKeyCom∑ª
,

1345 
di˘SdsDe°ru˘‹
,

1346 
di˘SdsDe°ru˘‹


1352 
di˘Ty≥
 
	gkeyli°Di˘Ty≥
 = {

1353 
di˘ObjHash
,

1354 
NULL
,

1355 
NULL
,

1356 
di˘ObjKeyCom∑ª
,

1357 
di˘Obje˘De°ru˘‹
,

1358 
di˘Li°De°ru˘‹


1363 
di˘Ty≥
 
	g˛u°îNodesDi˘Ty≥
 = {

1364 
di˘SdsHash
,

1365 
NULL
,

1366 
NULL
,

1367 
di˘SdsKeyCom∑ª
,

1368 
di˘SdsDe°ru˘‹
,

1369 
NULL


1375 
di˘Ty≥
 
	g˛u°îNodesBœckLi°Di˘Ty≥
 = {

1376 
di˘SdsCa£Hash
,

1377 
NULL
,

1378 
NULL
,

1379 
di˘SdsKeyCa£Com∑ª
,

1380 
di˘SdsDe°ru˘‹
,

1381 
NULL


1387 
di˘Ty≥
 
	gmoduÀsDi˘Ty≥
 = {

1388 
di˘SdsCa£Hash
,

1389 
NULL
,

1390 
NULL
,

1391 
di˘SdsKeyCa£Com∑ª
,

1392 
di˘SdsDe°ru˘‹
,

1393 
NULL


1397 
di˘Ty≥
 
	gmigøãCacheDi˘Ty≥
 = {

1398 
di˘SdsHash
,

1399 
NULL
,

1400 
NULL
,

1401 
di˘SdsKeyCom∑ª
,

1402 
di˘SdsDe°ru˘‹
,

1403 
NULL


1409 
di˘Ty≥
 
	gª∂S¸ùtCacheDi˘Ty≥
 = {

1410 
di˘SdsCa£Hash
,

1411 
NULL
,

1412 
NULL
,

1413 
di˘SdsKeyCa£Com∑ª
,

1414 
di˘SdsDe°ru˘‹
,

1415 
NULL


1418 
	$htNìdsResize
(
di˘
 *dict) {

1419 
size
, 
u£d
;

1421 
size
 = 
	`di˘SlŸs
(
di˘
);

1422 
u£d
 = 
	`di˘Size
(
di˘
);

1423  (
size
 > 
DICT_HT_INITIAL_SIZE
 &&

1424 (
u£d
*100/
size
 < 
HASHTABLE_MIN_FILL
));

1425 
	}
}

1429 
	$åyResizeHashTabÀs
(
dbid
) {

1430 i‡(
	`htNìdsResize
(
£rvî
.
db
[
dbid
].
di˘
))

1431 
	`di˘Resize
(
£rvî
.
db
[
dbid
].
di˘
);

1432 i‡(
	`htNìdsResize
(
£rvî
.
db
[
dbid
].
expúes
))

1433 
	`di˘Resize
(
£rvî
.
db
[
dbid
].
expúes
);

1434 
	}
}

1443 
	$ö¸emíèŒyRehash
(
dbid
) {

1445 i‡(
	`di˘IsRehashög
(
£rvî
.
db
[
dbid
].
di˘
)) {

1446 
	`di˘RehashMûli£c⁄ds
(
£rvî
.
db
[
dbid
].
di˘
,1);

1450 i‡(
	`di˘IsRehashög
(
£rvî
.
db
[
dbid
].
expúes
)) {

1451 
	`di˘RehashMûli£c⁄ds
(
£rvî
.
db
[
dbid
].
expúes
,1);

1455 
	}
}

1463 
	$upd©eDi˘ResizePﬁicy
() {

1464 i‡(!
	`hasA˘iveChûdPro˚ss
())

1465 
	`di˘E«bÀResize
();

1467 
	`di˘DißbÀResize
();

1468 
	}
}

1472 
	$hasA˘iveChûdPro˚ss
() {

1473  
£rvî
.
rdb_chûd_pid
 != -1 ||

1474 
£rvî
.
aof_chûd_pid
 != -1 ||

1475 
£rvî
.
moduÀ_chûd_pid
 != -1;

1476 
	}
}

1480 
	$ÆlPîsi°í˚DißbÀd
() {

1481  
£rvî
.
ßvï¨am¶í
 =0 && sîvî.
aof_°©e
 =
AOF_OFF
;

1482 
	}
}

1487 
	$åackIn°™è√ousMëric
(
mëric
, 
cuºít_ªadög
) {

1488 
t
 = 
	`m°ime
(Ë- 
£rvî
.
ö°_mëric
[
mëric
].
œ°_ßm∂e_time
;

1489 
›s
 = 
cuºít_ªadög
 -

1490 
£rvî
.
ö°_mëric
[
mëric
].
œ°_ßm∂e_cou¡
;

1491 
›s_£c
;

1493 
›s_£c
 = 
t
 > 0 ? (
›s
*1000/t) : 0;

1495 
£rvî
.
ö°_mëric
[
mëric
].
ßm∂es
[£rvî.ö°_mëric[mëric].
idx
] =

1496 
›s_£c
;

1497 
£rvî
.
ö°_mëric
[
mëric
].
idx
++;

1498 
£rvî
.
ö°_mëric
[
mëric
].
idx
 %
STATS_METRIC_SAMPLES
;

1499 
£rvî
.
ö°_mëric
[
mëric
].
œ°_ßm∂e_time
 = 
	`m°ime
();

1500 
£rvî
.
ö°_mëric
[
mëric
].
œ°_ßm∂e_cou¡
 = 
cuºít_ªadög
;

1501 
	}
}

1504 
	$gëIn°™è√ousMëric
(
mëric
) {

1505 
j
;

1506 
sum
 = 0;

1508 
j
 = 0; j < 
STATS_METRIC_SAMPLES
; j++)

1509 
sum
 +
£rvî
.
ö°_mëric
[
mëric
].
ßm∂es
[
j
];

1510  
sum
 / 
STATS_METRIC_SAMPLES
;

1511 
	}
}

1517 
	$˛õ¡sCr⁄ResizeQuîyBuf„r
(
˛õ¡
 *
c
) {

1518 
size_t
 
quîybuf_size
 = 
	`sdsAŒocSize
(
c
->
quîybuf
);

1519 
time_t
 
idÀtime
 = 
£rvî
.
unixtime
 - 
c
->
œ°öãø˘i⁄
;

1524 i‡(
quîybuf_size
 > 
PROTO_MBULK_BIG_ARG
 &&

1525 ((
quîybuf_size
/(
c
->
quîybuf_≥ak
+1)) > 2 ||

1526 
idÀtime
 > 2))

1530 i‡(
	`sdßvaû
(
c
->
quîybuf
) > 1024*4) {

1531 
c
->
quîybuf
 = 
	`sdsRemoveFªeS∑˚
(c->querybuf);

1536 
c
->
quîybuf_≥ak
 = 0;

1543 i‡(
c
->
Êags
 & 
CLIENT_MASTER
) {

1547 
size_t
 
≥ndög_quîybuf_size
 = 
	`sdsAŒocSize
(
c
->
≥ndög_quîybuf
);

1548 if(
≥ndög_quîybuf_size
 > 
LIMIT_PENDING_QUERYBUF
 &&

1549 
	`sd¶í
(
c
->
≥ndög_quîybuf
Ë< (
≥ndög_quîybuf_size
/2))

1551 
c
->
≥ndög_quîybuf
 = 
	`sdsRemoveFªeS∑˚
(c->pending_querybuf);

1555 
	}
}

1569 
	#CLIENTS_PEAK_MEM_USAGE_SLOTS
 8

	)

1570 
size_t
 
	gClõ¡sPókMemI≈ut
[
CLIENTS_PEAK_MEM_USAGE_SLOTS
];

1571 
size_t
 
	gClõ¡sPókMemOuçut
[
CLIENTS_PEAK_MEM_USAGE_SLOTS
];

1573 
	$˛õ¡sCr⁄TøckEx∑nsiveClõ¡s
(
˛õ¡
 *
c
) {

1574 
size_t
 
ö_ußge
 = 
	`sdsAŒocSize
(
c
->
quîybuf
);

1575 
size_t
 
out_ußge
 = 
	`gëClõ¡OuçutBuf„rMem‹yUßge
(
c
);

1576 
i
 = 
£rvî
.
unixtime
 % 
CLIENTS_PEAK_MEM_USAGE_SLOTS
;

1577 
zîoidx
 = (
i
+1Ë% 
CLIENTS_PEAK_MEM_USAGE_SLOTS
;

1590 
Clõ¡sPókMemI≈ut
[
zîoidx
] = 0;

1591 
Clõ¡sPókMemOuçut
[
zîoidx
] = 0;

1594 i‡(
ö_ußge
 > 
Clõ¡sPókMemI≈ut
[
i
]) ClientsPeakMemInput[i] = in_usage;

1595 i‡(
out_ußge
 > 
Clõ¡sPókMemOuçut
[
i
]) ClientsPeakMemOutput[i] = out_usage;

1598 
	}
}

1605 
	$˛õ¡sCr⁄TøckClõ¡sMemUßge
(
˛õ¡
 *
c
) {

1606 
size_t
 
mem
 = 0;

1607 
ty≥
 = 
	`gëClõ¡Ty≥
(
c
);

1608 
mem
 +
	`gëClõ¡OuçutBuf„rMem‹yUßge
(
c
);

1609 
mem
 +
	`sdsAŒocSize
(
c
->
quîybuf
);

1610 
mem
 +(
˛õ¡
);

1613 
£rvî
.
°©_˛õ¡s_ty≥_mem‹y
[
c
->
˛õ¡_¸⁄_œ°_mem‹y_ty≥
] -=

1614 
c
->
˛õ¡_¸⁄_œ°_mem‹y_ußge
;

1615 
£rvî
.
°©_˛õ¡s_ty≥_mem‹y
[
ty≥
] +
mem
;

1617 
c
->
˛õ¡_¸⁄_œ°_mem‹y_ußge
 = 
mem
;

1618 
c
->
˛õ¡_¸⁄_œ°_mem‹y_ty≥
 = 
ty≥
;

1620 
	}
}

1624 
	$gëEx∑nsiveClõ¡sInfo
(
size_t
 *
ö_ußge
, size_à*
out_ußge
) {

1625 
size_t
 
i
 = 0, 
o
 = 0;

1626 
j
 = 0; j < 
CLIENTS_PEAK_MEM_USAGE_SLOTS
; j++) {

1627 i‡(
Clõ¡sPókMemI≈ut
[
j
] > 
i
) i = ClientsPeakMemInput[j];

1628 i‡(
Clõ¡sPókMemOuçut
[
j
] > 
o
) o = ClientsPeakMemOutput[j];

1630 *
ö_ußge
 = 
i
;

1631 *
out_ußge
 = 
o
;

1632 
	}
}

1649 
	#CLIENTS_CRON_MIN_ITERATIONS
 5

	)

1650 
	$˛õ¡sCr⁄
() {

1655 
num˛õ¡s
 = 
	`li°Lígth
(
£rvî
.
˛õ¡s
);

1656 
ôî©i⁄s
 = 
num˛õ¡s
/
£rvî
.
hz
;

1657 
m°ime_t
 
now
 = 
	`m°ime
();

1662 i‡(
ôî©i⁄s
 < 
CLIENTS_CRON_MIN_ITERATIONS
)

1663 
ôî©i⁄s
 = (
num˛õ¡s
 < 
CLIENTS_CRON_MIN_ITERATIONS
) ?

1664 
num˛õ¡s
 : 
CLIENTS_CRON_MIN_ITERATIONS
;

1666 
	`li°Lígth
(
£rvî
.
˛õ¡s
Ë&& 
ôî©i⁄s
--) {

1667 
˛õ¡
 *
c
;

1668 
li°Node
 *
hód
;

1673 
	`li°RŸ©eTaûToHód
(
£rvî
.
˛õ¡s
);

1674 
hód
 = 
	`li°Fú°
(
£rvî
.
˛õ¡s
);

1675 
c
 = 
	`li°NodeVÆue
(
hód
);

1679 i‡(
	`˛õ¡sCr⁄H™dÀTimeout
(
c
,
now
)) ;

1680 i‡(
	`˛õ¡sCr⁄ResizeQuîyBuf„r
(
c
)) ;

1681 i‡(
	`˛õ¡sCr⁄TøckEx∑nsiveClõ¡s
(
c
)) ;

1682 i‡(
	`˛õ¡sCr⁄TøckClõ¡sMemUßge
(
c
)) ;

1684 
	}
}

1689 
	$d©aba£sCr⁄
() {

1692 i‡(
£rvî
.
a˘ive_expúe_íabÀd
) {

1693 i‡(
	`iAmMa°î
()) {

1694 
	`a˘iveExpúeCy˛e
(
ACTIVE_EXPIRE_CYCLE_SLOW
);

1696 
	`expúeSœveKeys
();

1701 
	`a˘iveDe‰agCy˛e
();

1706 i‡(!
	`hasA˘iveChûdPro˚ss
()) {

1710 
ªsize_db
 = 0;

1711 
ªhash_db
 = 0;

1712 
dbs_≥r_ˇŒ
 = 
CRON_DBS_PER_CALL
;

1713 
j
;

1716 i‡(
dbs_≥r_ˇŒ
 > 
£rvî
.
dbnum
) dbs_per_call = server.dbnum;

1719 
j
 = 0; j < 
dbs_≥r_ˇŒ
; j++) {

1720 
	`åyResizeHashTabÀs
(
ªsize_db
 % 
£rvî
.
dbnum
);

1721 
ªsize_db
++;

1725 i‡(
£rvî
.
a˘ivîehashög
) {

1726 
j
 = 0; j < 
dbs_≥r_ˇŒ
; j++) {

1727 
w‹k_d⁄e
 = 
	`ö¸emíèŒyRehash
(
ªhash_db
);

1728 i‡(
w‹k_d⁄e
) {

1734 
ªhash_db
++;

1735 
ªhash_db
 %
£rvî
.
dbnum
;

1740 
	}
}

1752 
	$upd©eCachedTime
(
upd©e_daylight_öfo
) {

1753 
£rvî
.
u°ime
 = 
	`u°ime
();

1754 
£rvî
.
m°ime
 = sîvî.
u°ime
 / 1000;

1755 
£rvî
.
unixtime
 = sîvî.
m°ime
 / 1000;

1762 i‡(
upd©e_daylight_öfo
) {

1763 
tm
Åm;

1764 
time_t
 
ut
 = 
£rvî
.
unixtime
;

1765 
	`loˇ…ime_r
(&
ut
,&
tm
);

1766 
£rvî
.
daylight_a˘ive
 = 
tm
.
tm_isd°
;

1768 
	}
}

1770 
	$checkChûdªnD⁄e
() {

1771 
°©loc
;

1772 
pid_t
 
pid
;

1779 i‡(
£rvî
.
rdb_chûd_pid
 !-1 && sîvî.
rdb_pùe_c⁄ns
)

1782 i‡((
pid
 = 
	`waô3
(&
°©loc
,
WNOHANG
,
NULL
)) != 0) {

1783 
exôcode
 = 
	`WEXITSTATUS
(
°©loc
);

1784 
bysig«l
 = 0;

1786 i‡(
	`WIFSIGNALED
(
°©loc
)Ë
bysig«l
 = 
	`WTERMSIG
(statloc);

1793 i‡(
exôcode
 =
SERVER_CHILD_NOERROR_RETVAL
) {

1794 
bysig«l
 = 
SIGUSR1
;

1795 
exôcode
 = 1;

1798 i‡(
pid
 == -1) {

1799 
	`£rvîLog
(
LL_WARNING
,"wait3()ÑeturnedánÉrror: %s. "

1801 
	`°ªº‹
(
î∫o
),

1802 (Ë
£rvî
.
rdb_chûd_pid
,

1803 (Ë
£rvî
.
aof_chûd_pid
,

1804 (Ë
£rvî
.
moduÀ_chûd_pid
);

1805 } i‡(
pid
 =
£rvî
.
rdb_chûd_pid
) {

1806 
	`backgroundSaveD⁄eH™dÀr
(
exôcode
,
bysig«l
);

1807 i‡(!
bysig«l
 && 
exôcode
 =0Ë
	`ª˚iveChûdInfo
();

1808 } i‡(
pid
 =
£rvî
.
aof_chûd_pid
) {

1809 
	`backgroundRewrôeD⁄eH™dÀr
(
exôcode
,
bysig«l
);

1810 i‡(!
bysig«l
 && 
exôcode
 =0Ë
	`ª˚iveChûdInfo
();

1811 } i‡(
pid
 =
£rvî
.
moduÀ_chûd_pid
) {

1812 
	`ModuÀF‹kD⁄eH™dÀr
(
exôcode
,
bysig«l
);

1813 i‡(!
bysig«l
 && 
exôcode
 =0Ë
	`ª˚iveChûdInfo
();

1815 i‡(!
	`ldbRemoveChûd
(
pid
)) {

1816 
	`£rvîLog
(
LL_WARNING
,

1818 ()
pid
);

1821 
	`upd©eDi˘ResizePﬁicy
();

1822 
	`˛o£ChûdInfoPùe
();

1824 
	}
}

1845 
	$£rvîCr⁄
(
´EvítLo›
 *
evítLo›
, 
id
, *
˛õ¡D©a
) {

1846 
j
;

1847 
	`UNUSED
(
evítLo›
);

1848 
	`UNUSED
(
id
);

1849 
	`UNUSED
(
˛õ¡D©a
);

1853 i‡(
£rvî
.
w©chdog_≥riod
Ë
	`w©chdogScheduÀSig«l
(server.watchdog_period);

1856 
	`upd©eCachedTime
(1);

1858 
£rvî
.
hz
 = sîvî.
c⁄fig_hz
;

1861 i‡(
£rvî
.
dy«mic_hz
) {

1862 
	`li°Lígth
(
£rvî
.
˛õ¡s
Ë/ sîvî.
hz
 >

1863 
MAX_CLIENTS_PER_CLOCK_TICK
)

1865 
£rvî
.
hz
 *= 2;

1866 i‡(
£rvî
.
hz
 > 
CONFIG_MAX_HZ
) {

1867 
£rvî
.
hz
 = 
CONFIG_MAX_HZ
;

1873 
	`run_wôh_≥riod
(100) {

1874 
	`åackIn°™è√ousMëric
(
STATS_METRIC_COMMAND
,
£rvî
.
°©_numcomm™ds
);

1875 
	`åackIn°™è√ousMëric
(
STATS_METRIC_NET_INPUT
,

1876 
£rvî
.
°©_√t_öput_byãs
);

1877 
	`åackIn°™è√ousMëric
(
STATS_METRIC_NET_OUTPUT
,

1878 
£rvî
.
°©_√t_ouçut_byãs
);

1892 
£rvî
.
Ãu˛ock
 = 
	`gëLRUClock
();

1895 i‡(
	`zmÆloc_u£d_mem‹y
(Ë> 
£rvî
.
°©_≥ak_mem‹y
)

1896 
£rvî
.
°©_≥ak_mem‹y
 = 
	`zmÆloc_u£d_mem‹y
();

1898 
	`run_wôh_≥riod
(100) {

1902 
£rvî
.
¸⁄_mÆloc_°©s
.
¥o˚ss_rss
 = 
	`zmÆloc_gë_rss
();

1903 
£rvî
.
¸⁄_mÆloc_°©s
.
zmÆloc_u£d
 = 
	`zmÆloc_u£d_mem‹y
();

1908 
	`zmÆloc_gë_Æloˇt‹_öfo
(&
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_Æloˇãd
,

1909 &
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_a˘ive
,

1910 &
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_ªsidít
);

1913 i‡(!
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_ªsidít
) {

1917 
size_t
 
lua_mem‹y
 = 
	`lua_gc
(
£rvî
.
lua
,
LUA_GCCOUNT
,0)*1024LL;

1918 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_ªsidít
 = sîvî.¸⁄_mÆloc_°©s.
¥o˚ss_rss
 - 
lua_mem‹y
;

1920 i‡(!
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_a˘ive
)

1921 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_a˘ive
 = sîvî.¸⁄_mÆloc_°©s.
Æloˇt‹_ªsidít
;

1922 i‡(!
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_Æloˇãd
)

1923 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_Æloˇãd
 = sîvî.¸⁄_mÆloc_°©s.
zmÆloc_u£d
;

1928 i‡(
£rvî
.
shutdown_aßp
) {

1929 i‡(
	`¥ï¨eF‹Shutdown
(
SHUTDOWN_NOFLAGS
Ë=
C_OK
Ë
	`exô
(0);

1930 
	`£rvîLog
(
LL_WARNING
,"SIGTERMÑeceived butÉrrorsÅryingÅo shut downÅhe server, checkÅheÜogs for more information");

1931 
£rvî
.
shutdown_aßp
 = 0;

1935 
	`run_wôh_≥riod
(5000) {

1936 
j
 = 0; j < 
£rvî
.
dbnum
; j++) {

1937 
size
, 
u£d
, 
vkeys
;

1939 
size
 = 
	`di˘SlŸs
(
£rvî
.
db
[
j
].
di˘
);

1940 
u£d
 = 
	`di˘Size
(
£rvî
.
db
[
j
].
di˘
);

1941 
vkeys
 = 
	`di˘Size
(
£rvî
.
db
[
j
].
expúes
);

1942 i‡(
u£d
 || 
vkeys
) {

1943 
	`£rvîLog
(
LL_VERBOSE
,"DB %d: %Œd key†(%Œd vﬁ©ûeËö %Œd slŸ†HT.",
j
,
u£d
,
vkeys
,
size
);

1950 i‡(!
£rvî
.
£¡öñ_mode
) {

1951 
	`run_wôh_≥riod
(5000) {

1952 
	`£rvîLog
(
LL_DEBUG
,

1954 
	`li°Lígth
(
£rvî
.
˛õ¡s
)-li°Lígth(£rvî.
¶aves
),

1955 
	`li°Lígth
(
£rvî
.
¶aves
),

1956 
	`zmÆloc_u£d_mem‹y
());

1961 
	`˛õ¡sCr⁄
();

1964 
	`d©aba£sCr⁄
();

1968 i‡(!
	`hasA˘iveChûdPro˚ss
() &&

1969 
£rvî
.
aof_ªwrôe_scheduÀd
)

1971 
	`ªwrôeAµídO∆yFûeBackground
();

1975 i‡(
	`hasA˘iveChûdPro˚ss
(Ë|| 
	`ldbPídögChûdªn
())

1977 
	`checkChûdªnD⁄e
();

1981 
j
 = 0; j < 
£rvî
.
ßvï¨am¶í
; j++) {

1982 
ßvï¨am
 *
•
 = 
£rvî
.
ßvï¨ams
+
j
;

1988 i‡(
£rvî
.
dúty
 >
•
->
ch™ges
 &&

1989 
£rvî
.
unixtime
-£rvî.
œ°ßve
 > 
•
->
£c⁄ds
 &&

1990 (
£rvî
.
unixtime
-£rvî.
œ°bgßve_åy
 >

1991 
CONFIG_BGSAVE_RETRY_DELAY
 ||

1992 
£rvî
.
œ°bgßve_°©us
 =
C_OK
))

1994 
	`£rvîLog
(
LL_NOTICE
,"%d changes in %d seconds. Saving...",

1995 
•
->
ch™ges
, ()•->
£c⁄ds
);

1996 
rdbSaveInfo
 
rsi
, *
rsùå
;

1997 
rsùå
 = 
	`rdbP›uœãSaveInfo
(&
rsi
);

1998 
	`rdbSaveBackground
(
£rvî
.
rdb_fûíame
,
rsùå
);

2004 i‡(
£rvî
.
aof_°©e
 =
AOF_ON
 &&

2005 !
	`hasA˘iveChûdPro˚ss
() &&

2006 
£rvî
.
aof_ªwrôe_≥rc
 &&

2007 
£rvî
.
aof_cuºít_size
 > sîvî.
aof_ªwrôe_mö_size
)

2009 
ba£
 = 
£rvî
.
aof_ªwrôe_ba£_size
 ?

2010 
£rvî
.
aof_ªwrôe_ba£_size
 : 1;

2011 
growth
 = (
£rvî
.
aof_cuºít_size
*100/
ba£
) - 100;

2012 i‡(
growth
 >
£rvî
.
aof_ªwrôe_≥rc
) {

2013 
	`£rvîLog
(
LL_NOTICE
,"Sèπögáutom©i¯ªwrôög o‡AOF o¿%Œd%% growth",
growth
);

2014 
	`ªwrôeAµídO∆yFûeBackground
();

2022 i‡(
£rvî
.
aof_Êush_po°p⁄ed_°¨t
Ë
	`ÊushAµídO∆yFûe
(0);

2028 
	`run_wôh_≥riod
(1000) {

2029 i‡(
£rvî
.
aof_œ°_wrôe_°©us
 =
C_ERR
)

2030 
	`ÊushAµídO∆yFûe
(0);

2034 
	`˛õ¡sAªPau£d
();

2038 
	`run_wôh_≥riod
(1000Ë
	`ª∂iˇti⁄Cr⁄
();

2041 
	`run_wôh_≥riod
(100) {

2042 i‡(
£rvî
.
˛u°î_íabÀd
Ë
	`˛u°îCr⁄
();

2046 i‡(
£rvî
.
£¡öñ_mode
Ë
	`£¡öñTimî
();

2049 
	`run_wôh_≥riod
(1000) {

2050 
	`migøãClo£TimedoutSockës
();

2054 
	`°›ThªadedIOIfNìded
();

2060 i‡(
£rvî
.
åackög_˛õ¡s
Ë
	`åackögLimôU£dSlŸs
();

2069 i‡(!
	`hasA˘iveChûdPro˚ss
() &&

2070 
£rvî
.
rdb_bgßve_scheduÀd
 &&

2071 (
£rvî
.
unixtime
-£rvî.
œ°bgßve_åy
 > 
CONFIG_BGSAVE_RETRY_DELAY
 ||

2072 
£rvî
.
œ°bgßve_°©us
 =
C_OK
))

2074 
rdbSaveInfo
 
rsi
, *
rsùå
;

2075 
rsùå
 = 
	`rdbP›uœãSaveInfo
(&
rsi
);

2076 i‡(
	`rdbSaveBackground
(
£rvî
.
rdb_fûíame
,
rsùå
Ë=
C_OK
)

2077 
£rvî
.
rdb_bgßve_scheduÀd
 = 0;

2081 
RedisModuÀCr⁄Lo›V1
 
ei
 = {
REDISMODULE_CRON_LOOP_VERSION
,
£rvî
.
hz
};

2082 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_CRON_LOOP
,

2084 &
ei
);

2086 
£rvî
.
¸⁄lo›s
++;

2087  1000/
£rvî
.
hz
;

2088 
	}
}

2090 
Pro˚ssögEvítsWhûeBlocked
;

2106 
	$bef‹eSÀï
(
´EvítLo›
 *
evítLo›
) {

2107 
	`UNUSED
(
evítLo›
);

2114 i‡(
Pro˚ssögEvítsWhûeBlocked
) {

2115 
uöt64_t
 
¥o˚s£d
 = 0;

2116 
¥o˚s£d
 +
	`h™dÀClõ¡sWôhPídögRódsUsögThªads
();

2117 
¥o˚s£d
 +
	`ésPro˚ssPídögD©a
();

2118 
¥o˚s£d
 +
	`h™dÀClõ¡sWôhPídögWrôes
();

2119 
¥o˚s£d
 +
	`‰ìClõ¡sInAsyncFªeQueue
();

2120 
£rvî
.
evíts_¥o˚s£d_whûe_blocked
 +
¥o˚s£d
;

2125 
	`h™dÀBlockedClõ¡sTimeout
();

2128 
	`h™dÀClõ¡sWôhPídögRódsUsögThªads
();

2131 
	`ésPro˚ssPídögD©a
();

2134 
	`´SëD⁄tWaô
(
£rvî
.
ñ
, 
	`ésHasPídögD©a
());

2140 i‡(
£rvî
.
˛u°î_íabÀd
Ë
	`˛u°îBef‹eSÀï
();

2144 i‡(
£rvî
.
a˘ive_expúe_íabÀd
 && sîvî.
ma°îho°
 =
NULL
)

2145 
	`a˘iveExpúeCy˛e
(
ACTIVE_EXPIRE_CYCLE_FAST
);

2149 i‡(
	`li°Lígth
(
£rvî
.
˛õ¡s_waôög_acks
))

2150 
	`¥o˚ssClõ¡sWaôögRïliˇs
();

2154 i‡(
	`moduÀCou¡
()Ë
	`moduÀH™dÀBlockedClõ¡s
();

2157 i‡(
	`li°Lígth
(
£rvî
.
unblocked_˛õ¡s
))

2158 
	`¥o˚ssUnblockedClõ¡s
();

2165 i‡(
£rvî
.
gë_ack_‰om_¶aves
) {

2166 
robj
 *
¨gv
[3];

2168 
¨gv
[0] = 
	`¸óãSåögObje˘
("REPLCONF",8);

2169 
¨gv
[1] = 
	`¸óãSåögObje˘
("GETACK",6);

2170 
¨gv
[2] = 
	`¸óãSåögObje˘
("*",1);

2171 
	`ª∂iˇti⁄FìdSœves
(
£rvî
.
¶aves
, sîvî.
¶ave£ldb
, 
¨gv
, 3);

2172 
	`de¸RefCou¡
(
¨gv
[0]);

2173 
	`de¸RefCou¡
(
¨gv
[1]);

2174 
	`de¸RefCou¡
(
¨gv
[2]);

2175 
£rvî
.
gë_ack_‰om_¶aves
 = 0;

2180 
	`åackögBrﬂdˇ°InvÆid©i⁄Mesßges
();

2183 
	`ÊushAµídO∆yFûe
(0);

2186 
	`h™dÀClõ¡sWôhPídögWrôesUsögThªads
();

2189 
	`‰ìClõ¡sInAsyncFªeQueue
();

2194 i‡(
	`moduÀCou¡
()Ë
	`moduÀRñó£GIL
();

2195 
	}
}

2200 
	$a·îSÀï
(
´EvítLo›
 *
evítLo›
) {

2201 
	`UNUSED
(
evítLo›
);

2203 i‡(!
Pro˚ssögEvítsWhûeBlocked
) {

2204 i‡(
	`moduÀCou¡
()Ë
	`moduÀAcquúeGIL
();

2206 
	}
}

2210 
	$¸óãSh¨edObje˘s
() {

2211 
j
;

2213 
sh¨ed
.
¸lf
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("\r\n"));

2214 
sh¨ed
.
ok
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("+OK\r\n"));

2215 
sh¨ed
.
îr
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("-ERR\r\n"));

2216 
sh¨ed
.
em±ybulk
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("$0\r\n\r\n"));

2217 
sh¨ed
.
czîo
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(":0\r\n"));

2218 
sh¨ed
.
c⁄e
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(":1\r\n"));

2219 
sh¨ed
.
em±y¨øy
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("*0\r\n"));

2220 
sh¨ed
.
p⁄g
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("+PONG\r\n"));

2221 
sh¨ed
.
queued
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("+QUEUED\r\n"));

2222 
sh¨ed
.
em±ysˇn
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("*2\r\n$1\r\n0\r\n*0\r\n"));

2223 
sh¨ed
.
wr⁄gty≥îr
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2225 
sh¨ed
.
nokeyîr
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2227 
sh¨ed
.
sy¡axîr
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2229 
sh¨ed
.
ßmeobje˘îr
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2231 
sh¨ed
.
outo‰™gìº
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2233 
sh¨ed
.
nos¸ùãº
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2235 
sh¨ed
.
lﬂdögîr
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2237 
sh¨ed
.
¶ows¸ùãº
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2239 
sh¨ed
.
ma°îdow√º
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2241 
sh¨ed
.
bgßvìº
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2243 
sh¨ed
.
ro¶avìº
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2245 
sh¨ed
.
nﬂuthîr
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2247 
sh¨ed
.
oomîr
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2249 
sh¨ed
.
exeˇb‹ãº
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2251 
sh¨ed
.
n‹ïliˇ£º
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2253 
sh¨ed
.
busykeyîr
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(

2255 
sh¨ed
.
•a˚
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(" "));

2256 
sh¨ed
.
cﬁ⁄
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
(":"));

2257 
sh¨ed
.
∂us
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("+"));

2260 
sh¨ed
.
nuŒ
[0] = 
NULL
;

2261 
sh¨ed
.
nuŒ
[1] = 
NULL
;

2262 
sh¨ed
.
nuŒ
[2] = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("$-1\r\n"));

2263 
sh¨ed
.
nuŒ
[3] = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("_\r\n"));

2265 
sh¨ed
.
nuŒ¨øy
[0] = 
NULL
;

2266 
sh¨ed
.
nuŒ¨øy
[1] = 
NULL
;

2267 
sh¨ed
.
nuŒ¨øy
[2] = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("*-1\r\n"));

2268 
sh¨ed
.
nuŒ¨øy
[3] = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("_\r\n"));

2270 
sh¨ed
.
em±ym≠
[0] = 
NULL
;

2271 
sh¨ed
.
em±ym≠
[1] = 
NULL
;

2272 
sh¨ed
.
em±ym≠
[2] = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("*0\r\n"));

2273 
sh¨ed
.
em±ym≠
[3] = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("%0\r\n"));

2275 
sh¨ed
.
em±y£t
[0] = 
NULL
;

2276 
sh¨ed
.
em±y£t
[1] = 
NULL
;

2277 
sh¨ed
.
em±y£t
[2] = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("*0\r\n"));

2278 
sh¨ed
.
em±y£t
[3] = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ew
("~0\r\n"));

2280 
j
 = 0; j < 
PROTO_SHARED_SELECT_CMDS
; j++) {

2281 
di˘id_°r
[64];

2282 
di˘id_Àn
;

2284 
di˘id_Àn
 = 
	`Œ2°rög
(
di˘id_°r
,(di˘id_°r),
j
);

2285 
sh¨ed
.
£À˘
[
j
] = 
	`¸óãObje˘
(
OBJ_STRING
,

2286 
	`sdsˇçrötf
(
	`sd£m±y
(),

2288 
di˘id_Àn
, 
di˘id_°r
));

2290 
sh¨ed
.
mesßgebulk
 = 
	`¸óãSåögObje˘
("$7\r\nmessage\r\n",13);

2291 
sh¨ed
.
pmesßgebulk
 = 
	`¸óãSåögObje˘
("$8\r\npmessage\r\n",14);

2292 
sh¨ed
.
subs¸ibebulk
 = 
	`¸óãSåögObje˘
("$9\r\nsubscribe\r\n",15);

2293 
sh¨ed
.
unsubs¸ibebulk
 = 
	`¸óãSåögObje˘
("$11\r\nunsubscribe\r\n",18);

2294 
sh¨ed
.
psubs¸ibebulk
 = 
	`¸óãSåögObje˘
("$10\r\npsubscribe\r\n",17);

2295 
sh¨ed
.
punsubs¸ibebulk
 = 
	`¸óãSåögObje˘
("$12\r\npunsubscribe\r\n",19);

2296 
sh¨ed
.
dñ
 = 
	`¸óãSåögObje˘
("DEL",3);

2297 
sh¨ed
.
u∆ök
 = 
	`¸óãSåögObje˘
("UNLINK",6);

2298 
sh¨ed
.
Ω›
 = 
	`¸óãSåögObje˘
("RPOP",4);

2299 
sh¨ed
.
Õ›
 = 
	`¸óãSåögObje˘
("LPOP",4);

2300 
sh¨ed
.
Õush
 = 
	`¸óãSåögObje˘
("LPUSH",5);

2301 
sh¨ed
.
Ω›Õush
 = 
	`¸óãSåögObje˘
("RPOPLPUSH",9);

2302 
sh¨ed
.
zp›mö
 = 
	`¸óãSåögObje˘
("ZPOPMIN",7);

2303 
sh¨ed
.
zp›max
 = 
	`¸óãSåögObje˘
("ZPOPMAX",7);

2304 
sh¨ed
.
mu…i
 = 
	`¸óãSåögObje˘
("MULTI",5);

2305 
sh¨ed
.
exec
 = 
	`¸óãSåögObje˘
("EXEC",4);

2306 
j
 = 0; j < 
OBJ_SHARED_INTEGERS
; j++) {

2307 
sh¨ed
.
öãgîs
[
j
] =

2308 
	`makeObje˘Sh¨ed
(
	`¸óãObje˘
(
OBJ_STRING
,(*)()
j
));

2309 
sh¨ed
.
öãgîs
[
j
]->
ícodög
 = 
OBJ_ENCODING_INT
;

2311 
j
 = 0; j < 
OBJ_SHARED_BULKHDR_LEN
; j++) {

2312 
sh¨ed
.
mbulkhdr
[
j
] = 
	`¸óãObje˘
(
OBJ_STRING
,

2313 
	`sdsˇçrötf
(
	`sd£m±y
(),"*%d\r\n",
j
));

2314 
sh¨ed
.
bulkhdr
[
j
] = 
	`¸óãObje˘
(
OBJ_STRING
,

2315 
	`sdsˇçrötf
(
	`sd£m±y
(),"$%d\r\n",
j
));

2321 
sh¨ed
.
mö°rög
 = 
	`sd¢ew
("minstring");

2322 
sh¨ed
.
max°rög
 = 
	`sd¢ew
("maxstring");

2323 
	}
}

2325 
	$öôSîvîC⁄fig
() {

2326 
j
;

2328 
	`upd©eCachedTime
(1);

2329 
	`gëR™domHexCh¨s
(
£rvî
.
runid
,
CONFIG_RUN_ID_SIZE
);

2330 
£rvî
.
runid
[
CONFIG_RUN_ID_SIZE
] = '\0';

2331 
	`ch™geRïliˇti⁄Id
();

2332 
	`˛órRïliˇti⁄Id2
();

2333 
£rvî
.
hz
 = 
CONFIG_DEFAULT_HZ
;

2337 
£rvî
.
timez⁄e
 = 
	`gëTimeZ⁄e
();

2338 
£rvî
.
c⁄figfûe
 = 
NULL
;

2339 
£rvî
.
execuèbÀ
 = 
NULL
;

2340 
£rvî
.
¨ch_bôs
 = (() == 8) ? 64 : 32;

2341 
£rvî
.
bödaddr_cou¡
 = 0;

2342 
£rvî
.
unixsockë≥rm
 = 
CONFIG_DEFAULT_UNIX_SOCKET_PERM
;

2343 
£rvî
.
ùfd_cou¡
 = 0;

2344 
£rvî
.
ésfd_cou¡
 = 0;

2345 
£rvî
.
sofd
 = -1;

2346 
£rvî
.
a˘ive_expúe_íabÀd
 = 1;

2347 
£rvî
.
˛õ¡_max_quîybuf_Àn
 = 
PROTO_MAX_QUERYBUF_LEN
;

2348 
£rvî
.
ßvï¨ams
 = 
NULL
;

2349 
£rvî
.
lﬂdög
 = 0;

2350 
£rvî
.
logfûe
 = 
	`z°rdup
(
CONFIG_DEFAULT_LOGFILE
);

2351 
£rvî
.
aof_°©e
 = 
AOF_OFF
;

2352 
£rvî
.
aof_ªwrôe_ba£_size
 = 0;

2353 
£rvî
.
aof_ªwrôe_scheduÀd
 = 0;

2354 
£rvî
.
aof_Êush_¶ìp
 = 0;

2355 
£rvî
.
aof_œ°_fsync
 = 
	`time
(
NULL
);

2356 
£rvî
.
aof_ªwrôe_time_œ°
 = -1;

2357 
£rvî
.
aof_ªwrôe_time_°¨t
 = -1;

2358 
£rvî
.
aof_œ°bgªwrôe_°©us
 = 
C_OK
;

2359 
£rvî
.
aof_dñayed_fsync
 = 0;

2360 
£rvî
.
aof_fd
 = -1;

2361 
£rvî
.
aof_£À˘ed_db
 = -1;

2362 
£rvî
.
aof_Êush_po°p⁄ed_°¨t
 = 0;

2363 
£rvî
.
pidfûe
 = 
NULL
;

2364 
£rvî
.
a˘ive_de‰ag_ru¬ög
 = 0;

2365 
£rvî
.
nŸify_key•a˚_evíts
 = 0;

2366 
£rvî
.
blocked_˛õ¡s
 = 0;

2367 
	`mem£t
(
£rvî
.
blocked_˛õ¡s_by_ty≥
,0,

2368 (
£rvî
.
blocked_˛õ¡s_by_ty≥
));

2369 
£rvî
.
shutdown_aßp
 = 0;

2370 
£rvî
.
˛u°î_c⁄figfûe
 = 
	`z°rdup
(
CONFIG_DEFAULT_CLUSTER_CONFIG_FILE
);

2371 
£rvî
.
˛u°î_moduÀ_Êags
 = 
CLUSTER_MODULE_FLAG_NONE
;

2372 
£rvî
.
migøã_ˇched_sockës
 = 
	`di˘Cª©e
(&
migøãCacheDi˘Ty≥
,
NULL
);

2373 
£rvî
.
√xt_˛õ¡_id
 = 1;

2374 
£rvî
.
lﬂdög_¥o˚ss_evíts_öãrvÆ_byãs
 = (1024*1024*2);

2376 
£rvî
.
Ãu˛ock
 = 
	`gëLRUClock
();

2377 
	`ª£tSîvîSaveP¨ams
();

2379 
	`≠≥ndSîvîSaveP¨ams
(60*60,1);

2380 
	`≠≥ndSîvîSaveP¨ams
(300,100);

2381 
	`≠≥ndSîvîSaveP¨ams
(60,10000);

2384 
£rvî
.
ma°îauth
 = 
NULL
;

2385 
£rvî
.
ma°îho°
 = 
NULL
;

2386 
£rvî
.
ma°îp‹t
 = 6379;

2387 
£rvî
.
ma°î
 = 
NULL
;

2388 
£rvî
.
ˇched_ma°î
 = 
NULL
;

2389 
£rvî
.
ma°î_öôül_off£t
 = -1;

2390 
£rvî
.
ª∂_°©e
 = 
REPL_STATE_NONE
;

2391 
£rvî
.
ª∂_å™s„r_tmpfûe
 = 
NULL
;

2392 
£rvî
.
ª∂_å™s„r_fd
 = -1;

2393 
£rvî
.
ª∂_å™s„r_s
 = 
NULL
;

2394 
£rvî
.
ª∂_syncio_timeout
 = 
CONFIG_REPL_SYNCIO_TIMEOUT
;

2395 
£rvî
.
ª∂_down_sö˚
 = 0;

2396 
£rvî
.
ma°î_ª∂_off£t
 = 0;

2397 
£rvî
.
ma°î_ª∂_mónögful_off£t
 = 0;

2400 
£rvî
.
ª∂_backlog
 = 
NULL
;

2401 
£rvî
.
ª∂_backlog_hi°Àn
 = 0;

2402 
£rvî
.
ª∂_backlog_idx
 = 0;

2403 
£rvî
.
ª∂_backlog_off
 = 0;

2404 
£rvî
.
ª∂_no_¶aves_sö˚
 = 
	`time
(
NULL
);

2407 
j
 = 0; j < 
CLIENT_TYPE_OBUF_COUNT
; j++)

2408 
£rvî
.
˛õ¡_obuf_limôs
[
j
] = 
˛õ¡Buf„rLimôsDeÁu…s
[j];

2411 
R_Zîo
 = 0.0;

2412 
R_PosInf
 = 1.0/
R_Zîo
;

2413 
R_NegInf
 = -1.0/
R_Zîo
;

2414 
R_N™
 = 
R_Zîo
/R_Zero;

2419 
£rvî
.
comm™ds
 = 
	`di˘Cª©e
(&
comm™dTabÀDi˘Ty≥
,
NULL
);

2420 
£rvî
.
‹ig_comm™ds
 = 
	`di˘Cª©e
(&
comm™dTabÀDi˘Ty≥
,
NULL
);

2421 
	`p›uœãComm™dTabÀ
();

2422 
£rvî
.
dñComm™d
 = 
	`lookupComm™dByCSåög
("del");

2423 
£rvî
.
mu…iComm™d
 = 
	`lookupComm™dByCSåög
("multi");

2424 
£rvî
.
ÕushComm™d
 = 
	`lookupComm™dByCSåög
("lpush");

2425 
£rvî
.
Õ›Comm™d
 = 
	`lookupComm™dByCSåög
("lpop");

2426 
£rvî
.
Ω›Comm™d
 = 
	`lookupComm™dByCSåög
("rpop");

2427 
£rvî
.
zp›möComm™d
 = 
	`lookupComm™dByCSåög
("zpopmin");

2428 
£rvî
.
zp›maxComm™d
 = 
	`lookupComm™dByCSåög
("zpopmax");

2429 
£rvî
.
§emComm™d
 = 
	`lookupComm™dByCSåög
("srem");

2430 
£rvî
.
execComm™d
 = 
	`lookupComm™dByCSåög
("exec");

2431 
£rvî
.
expúeComm™d
 = 
	`lookupComm™dByCSåög
("expire");

2432 
£rvî
.
≥xpúeComm™d
 = 
	`lookupComm™dByCSåög
("pexpire");

2433 
£rvî
.
x˛aimComm™d
 = 
	`lookupComm™dByCSåög
("xclaim");

2434 
£rvî
.
xgroupComm™d
 = 
	`lookupComm™dByCSåög
("xgroup");

2435 
£rvî
.
Ω›ÕushComm™d
 = 
	`lookupComm™dByCSåög
("rpoplpush");

2438 
£rvî
.
as£π_Áûed
 = "<noássertion failed>";

2439 
£rvî
.
as£π_fûe
 = "<no file>";

2440 
£rvî
.
as£π_löe
 = 0;

2441 
£rvî
.
bug_ªp‹t_°¨t
 = 0;

2442 
£rvî
.
w©chdog_≥riod
 = 0;

2448 
£rvî
.
lua_Æways_ª∂iˇã_comm™ds
 = 1;

2450 
	`öôC⁄figVÆues
();

2451 
	}
}

2453 **
ívú⁄
;

2470 
	$ª°¨tSîvî
(
Êags
, 
m°ime_t
 
dñay
) {

2471 
j
;

2475 i‡(
	`ac˚ss
(
£rvî
.
execuèbÀ
,
X_OK
) == -1) {

2476 
	`£rvîLog
(
LL_WARNING
,"Can'tÑestart:ÅhisÖrocess hasÇo "

2477 "≥rmissi⁄†tÿexecuã %s", 
£rvî
.
execuèbÀ
);

2478  
C_ERR
;

2482 i‡(
Êags
 & 
RESTART_SERVER_CONFIG_REWRITE
 &&

2483 
£rvî
.
c⁄figfûe
 &&

2484 
	`ªwrôeC⁄fig
(
£rvî
.
c⁄figfûe
) == -1)

2486 
	`£rvîLog
(
LL_WARNING
,"Can'tÑestart: configurationÑewriteÖrocess "

2488  
C_ERR
;

2492 i‡(
Êags
 & 
RESTART_SERVER_GRACEFULLY
 &&

2493 
	`¥ï¨eF‹Shutdown
(
SHUTDOWN_NOFLAGS
Ë!
C_OK
)

2495 
	`£rvîLog
(
LL_WARNING
,"Can'tÑestart:ÉrrorÖreparing for shutdown");

2496  
C_ERR
;

2501 
j
 = 3; j < ()
£rvî
.
max˛õ¡s
 + 1024; j++) {

2504 i‡(
	`f˙é
(
j
,
F_GETFD
Ë!-1Ë
	`˛o£
(j);

2508 i‡(
dñay
Ë
	`u¶ìp
(delay*1000);

2509 
	`z‰ì
(
£rvî
.
exec_¨gv
[0]);

2510 
£rvî
.
exec_¨gv
[0] = 
	`z°rdup
(£rvî.
execuèbÀ
);

2511 
	`execve
(
£rvî
.
execuèbÀ
,£rvî.
exec_¨gv
,
ívú⁄
);

2514 
	`_exô
(1);

2516  
C_ERR
;

2517 
	}
}

2527 
	$adju°O≥nFûesLimô
() {

2528 
æim_t
 
maxfûes
 = 
£rvî
.
max˛õ¡s
+
CONFIG_MIN_RESERVED_FDS
;

2529 
æimô
 
limô
;

2531 i‡(
	`gëæimô
(
RLIMIT_NOFILE
,&
limô
) == -1) {

2532 
	`£rvîLog
(
LL_WARNING
,"UnableÅo obtainÅhe current NOFILEÜimit (%s),ássuming 1024ánd settingÅhe max clients configurationáccordingly.",

2533 
	`°ªº‹
(
î∫o
));

2534 
£rvî
.
max˛õ¡s
 = 1024-
CONFIG_MIN_RESERVED_FDS
;

2536 
æim_t
 
ﬁdlimô
 = 
limô
.
æim_cur
;

2540 i‡(
ﬁdlimô
 < 
maxfûes
) {

2541 
æim_t
 
be°limô
;

2542 
£ålimô_îr‹
 = 0;

2546 
be°limô
 = 
maxfûes
;

2547 
be°limô
 > 
ﬁdlimô
) {

2548 
æim_t
 
de¸_°ï
 = 16;

2550 
limô
.
æim_cur
 = 
be°limô
;

2551 
limô
.
æim_max
 = 
be°limô
;

2552 i‡(
	`£ålimô
(
RLIMIT_NOFILE
,&
limô
) != -1) ;

2553 
£ålimô_îr‹
 = 
î∫o
;

2557 i‡(
be°limô
 < 
de¸_°ï
) ;

2558 
be°limô
 -
de¸_°ï
;

2563 i‡(
be°limô
 < 
ﬁdlimô
) bestlimit = oldlimit;

2565 i‡(
be°limô
 < 
maxfûes
) {

2566 
ﬁd_max˛õ¡s
 = 
£rvî
.
max˛õ¡s
;

2567 
£rvî
.
max˛õ¡s
 = 
be°limô
-
CONFIG_MIN_RESERVED_FDS
;

2571 i‡(
be°limô
 <
CONFIG_MIN_RESERVED_FDS
) {

2572 
	`£rvîLog
(
LL_WARNING
,"Your current 'ulimit -n' "

2576 (Ë
ﬁdlimô
,

2577 (Ë
maxfûes
);

2578 
	`exô
(1);

2580 
	`£rvîLog
(
LL_WARNING
,"YouÑequested maxclients of %d "

2582 
ﬁd_max˛õ¡s
,

2583 (Ë
maxfûes
);

2584 
	`£rvîLog
(
LL_WARNING
,"Server can't set maximum open files "

2586 (Ë
maxfûes
, 
	`°ªº‹
(
£ålimô_îr‹
));

2587 
	`£rvîLog
(
LL_WARNING
,"Current maximum open files is %llu. "

2591 (Ë
be°limô
, 
£rvî
.
max˛õ¡s
);

2593 
	`£rvîLog
(
LL_NOTICE
,"Increased maximumÇumber of open files "

2595 (Ë
maxfûes
,

2596 (Ë
ﬁdlimô
);

2600 
	}
}

2604 
	$checkT˝BacklogSëtögs
() {

2605 #ifde‡
HAVE_PROC_SOMAXCONN


2606 
FILE
 *
Â
 = 
	`f›í
("/proc/sys/net/core/somaxconn","r");

2607 
buf
[1024];

2608 i‡(!
Â
) ;

2609 i‡(
	`fgës
(
buf
,(buf),
Â
Ë!
NULL
) {

2610 
somaxc⁄n
 = 
	`©oi
(
buf
);

2611 i‡(
somaxc⁄n
 > 0 && somaxc⁄¿< 
£rvî
.
t˝_backlog
) {

2612 
	`£rvîLog
(
LL_WARNING
,"WARNING: ThêTCP backlog sëtög o‡%d c™nŸ bêíf‹˚d beˇu£ /¥oc/sys/√t/c‹e/somaxc⁄¿i†£àtÿthêlowî vÆuêo‡%d.", 
£rvî
.
t˝_backlog
, 
somaxc⁄n
);

2615 
	`f˛o£
(
Â
);

2617 
	}
}

2637 
	$li°íToP‹t
(
p‹t
, *
fds
, *
cou¡
) {

2638 
j
;

2642 i‡(
£rvî
.
bödaddr_cou¡
 =0Ë£rvî.
bödaddr
[0] = 
NULL
;

2643 
j
 = 0; j < 
£rvî
.
bödaddr_cou¡
 || j == 0; j++) {

2644 i‡(
£rvî
.
bödaddr
[
j
] =
NULL
) {

2645 
unsuµ‹ãd
 = 0;

2648 
fds
[*
cou¡
] = 
	`™ëT˝6Sîvî
(
£rvî
.
√ãº
,
p‹t
,
NULL
,

2649 
£rvî
.
t˝_backlog
);

2650 i‡(
fds
[*
cou¡
] !
ANET_ERR
) {

2651 
	`™ëN⁄Block
(
NULL
,
fds
[*
cou¡
]);

2652 (*
cou¡
)++;

2653 } i‡(
î∫o
 =
EAFNOSUPPORT
) {

2654 
unsuµ‹ãd
++;

2655 
	`£rvîLog
(
LL_WARNING
,"NotÜisteningÅo IPv6: unsupported");

2658 i‡(*
cou¡
 =1 || 
unsuµ‹ãd
) {

2660 
fds
[*
cou¡
] = 
	`™ëT˝Sîvî
(
£rvî
.
√ãº
,
p‹t
,
NULL
,

2661 
£rvî
.
t˝_backlog
);

2662 i‡(
fds
[*
cou¡
] !
ANET_ERR
) {

2663 
	`™ëN⁄Block
(
NULL
,
fds
[*
cou¡
]);

2664 (*
cou¡
)++;

2665 } i‡(
î∫o
 =
EAFNOSUPPORT
) {

2666 
unsuµ‹ãd
++;

2667 
	`£rvîLog
(
LL_WARNING
,"NotÜisteningÅo IPv4: unsupported");

2673 i‡(*
cou¡
 + 
unsuµ‹ãd
 == 2) ;

2674 } i‡(
	`°rchr
(
£rvî
.
bödaddr
[
j
],':')) {

2676 
fds
[*
cou¡
] = 
	`™ëT˝6Sîvî
(
£rvî
.
√ãº
,
p‹t
,£rvî.
bödaddr
[
j
],

2677 
£rvî
.
t˝_backlog
);

2680 
fds
[*
cou¡
] = 
	`™ëT˝Sîvî
(
£rvî
.
√ãº
,
p‹t
,£rvî.
bödaddr
[
j
],

2681 
£rvî
.
t˝_backlog
);

2683 i‡(
fds
[*
cou¡
] =
ANET_ERR
) {

2684 
	`£rvîLog
(
LL_WARNING
,

2686 
£rvî
.
bödaddr
[
j
] ? server.bindaddr[j] : "*",

2687 
p‹t
, 
£rvî
.
√ãº
);

2688 i‡(
î∫o
 =
ENOPROTOOPT
 ||Éºnÿ=
EPROTONOSUPPORT
 ||

2689 
î∫o
 =
ESOCKTNOSUPPORT
 ||Éºnÿ=
EPFNOSUPPORT
 ||

2690 
î∫o
 =
EAFNOSUPPORT
 ||Éºnÿ=
EADDRNOTAVAIL
)

2692  
C_ERR
;

2694 
	`™ëN⁄Block
(
NULL
,
fds
[*
cou¡
]);

2695 (*
cou¡
)++;

2697  
C_OK
;

2698 
	}
}

2703 
	$ª£tSîvîSèts
() {

2704 
j
;

2706 
£rvî
.
°©_numcomm™ds
 = 0;

2707 
£rvî
.
°©_numc⁄√˘i⁄s
 = 0;

2708 
£rvî
.
°©_expúedkeys
 = 0;

2709 
£rvî
.
°©_expúed_°Æe_≥rc
 = 0;

2710 
£rvî
.
°©_expúed_time_ˇp_ªached_cou¡
 = 0;

2711 
£rvî
.
°©_expúe_cy˛e_time_u£d
 = 0;

2712 
£rvî
.
°©_evi˘edkeys
 = 0;

2713 
£rvî
.
°©_key•a˚_mis£s
 = 0;

2714 
£rvî
.
°©_key•a˚_hôs
 = 0;

2715 
£rvî
.
°©_a˘ive_de‰ag_hôs
 = 0;

2716 
£rvî
.
°©_a˘ive_de‰ag_mis£s
 = 0;

2717 
£rvî
.
°©_a˘ive_de‰ag_key_hôs
 = 0;

2718 
£rvî
.
°©_a˘ive_de‰ag_key_mis£s
 = 0;

2719 
£rvî
.
°©_a˘ive_de‰ag_sˇ¬ed
 = 0;

2720 
£rvî
.
°©_f‹k_time
 = 0;

2721 
£rvî
.
°©_f‹k_øã
 = 0;

2722 
£rvî
.
°©_ªje˘ed_c⁄n
 = 0;

2723 
£rvî
.
°©_sync_fuŒ
 = 0;

2724 
£rvî
.
°©_sync_∑πül_ok
 = 0;

2725 
£rvî
.
°©_sync_∑πül_îr
 = 0;

2726 
j
 = 0; j < 
STATS_METRIC_COUNT
; j++) {

2727 
£rvî
.
ö°_mëric
[
j
].
idx
 = 0;

2728 
£rvî
.
ö°_mëric
[
j
].
œ°_ßm∂e_time
 = 
	`m°ime
();

2729 
£rvî
.
ö°_mëric
[
j
].
œ°_ßm∂e_cou¡
 = 0;

2730 
	`mem£t
(
£rvî
.
ö°_mëric
[
j
].
ßm∂es
,0,

2731 (
£rvî
.
ö°_mëric
[
j
].
ßm∂es
));

2733 
£rvî
.
°©_√t_öput_byãs
 = 0;

2734 
£rvî
.
°©_√t_ouçut_byãs
 = 0;

2735 
£rvî
.
°©_u√x≥˘ed_îr‹_ª∂õs
 = 0;

2736 
£rvî
.
aof_dñayed_fsync
 = 0;

2737 
	}
}

2739 
	$öôSîvî
() {

2740 
j
;

2742 
	`sig«l
(
SIGHUP
, 
SIG_IGN
);

2743 
	`sig«l
(
SIGPIPE
, 
SIG_IGN
);

2744 
	`£tupSig«lH™dÀrs
();

2746 i‡(
£rvî
.
sy¶og_íabÀd
) {

2747 
	`›ílog
(
£rvî
.
sy¶og_idít
, 
LOG_PID
 | 
LOG_NDELAY
 | 
LOG_NOWAIT
,

2748 
£rvî
.
sy¶og_Ácûôy
);

2752 
£rvî
.
aof_°©e
 = sîvî.
aof_íabÀd
 ? 
AOF_ON
 : 
AOF_OFF
;

2753 
£rvî
.
hz
 = sîvî.
c⁄fig_hz
;

2754 
£rvî
.
pid
 = 
	`gëpid
();

2755 
£rvî
.
cuºít_˛õ¡
 = 
NULL
;

2756 
£rvî
.
fixed_time_expúe
 = 0;

2757 
£rvî
.
˛õ¡s
 = 
	`li°Cª©e
();

2758 
£rvî
.
˛õ¡s_ödex
 = 
	`øxNew
();

2759 
£rvî
.
˛õ¡s_to_˛o£
 = 
	`li°Cª©e
();

2760 
£rvî
.
¶aves
 = 
	`li°Cª©e
();

2761 
£rvî
.
m⁄ô‹s
 = 
	`li°Cª©e
();

2762 
£rvî
.
˛õ¡s_≥ndög_wrôe
 = 
	`li°Cª©e
();

2763 
£rvî
.
˛õ¡s_≥ndög_ªad
 = 
	`li°Cª©e
();

2764 
£rvî
.
˛õ¡s_timeout_èbÀ
 = 
	`øxNew
();

2765 
£rvî
.
¶ave£ldb
 = -1;

2766 
£rvî
.
unblocked_˛õ¡s
 = 
	`li°Cª©e
();

2767 
£rvî
.
ªady_keys
 = 
	`li°Cª©e
();

2768 
£rvî
.
˛õ¡s_waôög_acks
 = 
	`li°Cª©e
();

2769 
£rvî
.
gë_ack_‰om_¶aves
 = 0;

2770 
£rvî
.
˛õ¡s_∑u£d
 = 0;

2771 
£rvî
.
evíts_¥o˚s£d_whûe_blocked
 = 0;

2772 
£rvî
.
sy°em_mem‹y_size
 = 
	`zmÆloc_gë_mem‹y_size
();

2774 i‡(
£rvî
.
és_p‹t
 && 
	`ésC⁄figuª
(&£rvî.
és_˘x_c⁄fig
Ë=
C_ERR
) {

2775 
	`£rvîLog
(
LL_WARNING
, "FailedÅo configure TLS. CheckÜogs for more info.");

2776 
	`exô
(1);

2779 
	`¸óãSh¨edObje˘s
();

2780 
	`adju°O≥nFûesLimô
();

2781 
£rvî
.
ñ
 = 
	`´Cª©eEvítLo›
(£rvî.
max˛õ¡s
+
CONFIG_FDSET_INCR
);

2782 i‡(
£rvî
.
ñ
 =
NULL
) {

2783 
	`£rvîLog
(
LL_WARNING
,

2785 
	`°ªº‹
(
î∫o
));

2786 
	`exô
(1);

2788 
£rvî
.
db
 = 
	`zmÆloc
((
ªdisDb
)*£rvî.
dbnum
);

2791 i‡(
£rvî
.
p‹t
 != 0 &&

2792 
	`li°íToP‹t
(
£rvî
.
p‹t
,£rvî.
ùfd
,&£rvî.
ùfd_cou¡
Ë=
C_ERR
)

2793 
	`exô
(1);

2794 i‡(
£rvî
.
és_p‹t
 != 0 &&

2795 
	`li°íToP‹t
(
£rvî
.
és_p‹t
,£rvî.
ésfd
,&£rvî.
ésfd_cou¡
Ë=
C_ERR
)

2796 
	`exô
(1);

2799 i‡(
£rvî
.
unixsockë
 !
NULL
) {

2800 
	`u∆ök
(
£rvî
.
unixsockë
);

2801 
£rvî
.
sofd
 = 
	`™ëUnixSîvî
(£rvî.
√ãº
,£rvî.
unixsockë
,

2802 
£rvî
.
unixsockë≥rm
, sîvî.
t˝_backlog
);

2803 i‡(
£rvî
.
sofd
 =
ANET_ERR
) {

2804 
	`£rvîLog
(
LL_WARNING
, "O≥nög Unix sockë: %s", 
£rvî
.
√ãº
);

2805 
	`exô
(1);

2807 
	`™ëN⁄Block
(
NULL
,
£rvî
.
sofd
);

2811 i‡(
£rvî
.
ùfd_cou¡
 =0 && sîvî.
ésfd_cou¡
 =0 && sîvî.
sofd
 < 0) {

2812 
	`£rvîLog
(
LL_WARNING
, "ConfiguredÅoÇotÜistenánywhere,Éxiting.");

2813 
	`exô
(1);

2817 
j
 = 0; j < 
£rvî
.
dbnum
; j++) {

2818 
£rvî
.
db
[
j
].
di˘
 = 
	`di˘Cª©e
(&
dbDi˘Ty≥
,
NULL
);

2819 
£rvî
.
db
[
j
].
expúes
 = 
	`di˘Cª©e
(&
key±rDi˘Ty≥
,
NULL
);

2820 
£rvî
.
db
[
j
].
expúes_curs‹
 = 0;

2821 
£rvî
.
db
[
j
].
blockög_keys
 = 
	`di˘Cª©e
(&
keyli°Di˘Ty≥
,
NULL
);

2822 
£rvî
.
db
[
j
].
ªady_keys
 = 
	`di˘Cª©e
(&
obje˘KeyPoöãrVÆueDi˘Ty≥
,
NULL
);

2823 
£rvî
.
db
[
j
].
w©ched_keys
 = 
	`di˘Cª©e
(&
keyli°Di˘Ty≥
,
NULL
);

2824 
£rvî
.
db
[
j
].
id
 = j;

2825 
£rvî
.
db
[
j
].
avg_âl
 = 0;

2826 
£rvî
.
db
[
j
].
de‰ag_œãr
 = 
	`li°Cª©e
();

2827 
	`li°SëFªeMëhod
(
£rvî
.
db
[
j
].
de‰ag_œãr
,((*)(*))
sds‰ì
);

2829 
	`evi˘i⁄PoﬁAŒoc
();

2830 
£rvî
.
pubsub_ch™√ls
 = 
	`di˘Cª©e
(&
keyli°Di˘Ty≥
,
NULL
);

2831 
£rvî
.
pubsub_∑âîns
 = 
	`li°Cª©e
();

2832 
£rvî
.
pubsub_∑âîns_di˘
 = 
	`di˘Cª©e
(&
keyli°Di˘Ty≥
,
NULL
);

2833 
	`li°SëFªeMëhod
(
£rvî
.
pubsub_∑âîns
,
‰ìPubsubP©ã∫
);

2834 
	`li°SëM©chMëhod
(
£rvî
.
pubsub_∑âîns
,
li°M©chPubsubP©ã∫
);

2835 
£rvî
.
¸⁄lo›s
 = 0;

2836 
£rvî
.
rdb_chûd_pid
 = -1;

2837 
£rvî
.
aof_chûd_pid
 = -1;

2838 
£rvî
.
moduÀ_chûd_pid
 = -1;

2839 
£rvî
.
rdb_chûd_ty≥
 = 
RDB_CHILD_TYPE_NONE
;

2840 
£rvî
.
rdb_pùe_c⁄ns
 = 
NULL
;

2841 
£rvî
.
rdb_pùe_numc⁄ns
 = 0;

2842 
£rvî
.
rdb_pùe_numc⁄ns_wrôög
 = 0;

2843 
£rvî
.
rdb_pùe_buff
 = 
NULL
;

2844 
£rvî
.
rdb_pùe_bufÊí
 = 0;

2845 
£rvî
.
rdb_bgßve_scheduÀd
 = 0;

2846 
£rvî
.
chûd_öfo_pùe
[0] = -1;

2847 
£rvî
.
chûd_öfo_pùe
[1] = -1;

2848 
£rvî
.
chûd_öfo_d©a
.
magic
 = 0;

2849 
	`aofRewrôeBuf„rRe£t
();

2850 
£rvî
.
aof_buf
 = 
	`sd£m±y
();

2851 
£rvî
.
œ°ßve
 = 
	`time
(
NULL
);

2852 
£rvî
.
œ°bgßve_åy
 = 0;

2853 
£rvî
.
rdb_ßve_time_œ°
 = -1;

2854 
£rvî
.
rdb_ßve_time_°¨t
 = -1;

2855 
£rvî
.
dúty
 = 0;

2856 
	`ª£tSîvîSèts
();

2858 
£rvî
.
°©_°¨âime
 = 
	`time
(
NULL
);

2859 
£rvî
.
°©_≥ak_mem‹y
 = 0;

2860 
£rvî
.
°©_rdb_cow_byãs
 = 0;

2861 
£rvî
.
°©_aof_cow_byãs
 = 0;

2862 
£rvî
.
°©_moduÀ_cow_byãs
 = 0;

2863 
j
 = 0; j < 
CLIENT_TYPE_COUNT
; j++)

2864 
£rvî
.
°©_˛õ¡s_ty≥_mem‹y
[
j
] = 0;

2865 
£rvî
.
¸⁄_mÆloc_°©s
.
zmÆloc_u£d
 = 0;

2866 
£rvî
.
¸⁄_mÆloc_°©s
.
¥o˚ss_rss
 = 0;

2867 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_Æloˇãd
 = 0;

2868 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_a˘ive
 = 0;

2869 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_ªsidít
 = 0;

2870 
£rvî
.
œ°bgßve_°©us
 = 
C_OK
;

2871 
£rvî
.
aof_œ°_wrôe_°©us
 = 
C_OK
;

2872 
£rvî
.
aof_œ°_wrôe_î∫o
 = 0;

2873 
£rvî
.
ª∂_good_¶aves_cou¡
 = 0;

2878 i‡(
	`´Cª©eTimeEvít
(
£rvî
.
ñ
, 1, 
£rvîCr⁄
, 
NULL
, NULLË=
AE_ERR
) {

2879 
	`£rvîP™ic
("Can't createÉventÜoopÅimers.");

2880 
	`exô
(1);

2885 
j
 = 0; j < 
£rvî
.
ùfd_cou¡
; j++) {

2886 i‡(
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, sîvî.
ùfd
[
j
], 
AE_READABLE
,

2887 
ac˚±T˝H™dÀr
,
NULL
Ë=
AE_ERR
)

2889 
	`£rvîP™ic
(

2893 
j
 = 0; j < 
£rvî
.
ésfd_cou¡
; j++) {

2894 i‡(
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, sîvî.
ésfd
[
j
], 
AE_READABLE
,

2895 
ac˚±TLSH™dÀr
,
NULL
Ë=
AE_ERR
)

2897 
	`£rvîP™ic
(

2901 i‡(
£rvî
.
sofd
 > 0 && 
	`´Cª©eFûeEvít
(£rvî.
ñ
,£rvî.sofd,
AE_READABLE
,

2902 
ac˚±UnixH™dÀr
,
NULL
Ë=
AE_ERR
Ë
	`£rvîP™ic
("UnrecoverableÉrror creating server.sofd fileÉvent.");

2907 i‡(
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, sîvî.
moduÀ_blocked_pùe
[0], 
AE_READABLE
,

2908 
moduÀBlockedClõ¡PùeRódabÀ
,
NULL
Ë=
AE_ERR
) {

2909 
	`£rvîP™ic
(

2916 
	`´SëBef‹eSÀïProc
(
£rvî
.
ñ
,
bef‹eSÀï
);

2917 
	`´SëA·îSÀïProc
(
£rvî
.
ñ
,
a·îSÀï
);

2920 i‡(
£rvî
.
aof_°©e
 =
AOF_ON
) {

2921 
£rvî
.
aof_fd
 = 
	`›í
(£rvî.
aof_fûíame
,

2922 
O_WRONLY
|
O_APPEND
|
O_CREAT
,0644);

2923 i‡(
£rvî
.
aof_fd
 == -1) {

2924 
	`£rvîLog
(
LL_WARNING
, "Can't openÅheáppend-only file: %s",

2925 
	`°ªº‹
(
î∫o
));

2926 
	`exô
(1);

2934 i‡(
£rvî
.
¨ch_bôs
 =32 && sîvî.
maxmem‹y
 == 0) {

2935 
	`£rvîLog
(
LL_WARNING
,"Warning: 32 bit instance detected butÇo memoryÜimit set. Setting 3 GB maxmemoryÜimit with 'noeviction'ÖolicyÇow.");

2936 
£rvî
.
maxmem‹y
 = 3072LL*(1024*1024);

2937 
£rvî
.
maxmem‹y_pﬁicy
 = 
MAXMEMORY_NO_EVICTION
;

2940 i‡(
£rvî
.
˛u°î_íabÀd
Ë
	`˛u°îInô
();

2941 
	`ª∂iˇti⁄S¸ùtCacheInô
();

2942 
	`s¸ùtögInô
(1);

2943 
	`¶owlogInô
();

2944 
	`œãncyM⁄ô‹Inô
();

2945 
	}
}

2952 
	$InôSîvîLa°
() {

2953 
	`bioInô
();

2954 
	`öôThªadedIO
();

2955 
	`£t_jemÆloc_bg_thªad
(
£rvî
.
jemÆloc_bg_thªad
);

2956 
£rvî
.
öôül_mem‹y_ußge
 = 
	`zmÆloc_u£d_mem‹y
();

2957 
	}
}

2962 
	$p›uœãComm™dTabÀP¨£Fœgs
(
ªdisComm™d
 *
c
, *
°rÊags
) {

2963 
¨gc
;

2964 
sds
 *
¨gv
;

2967 
¨gv
 = 
	`sds•lô¨gs
(
°rÊags
,&
¨gc
);

2968 i‡(
¨gv
 =
NULL
Ë 
C_ERR
;

2970 
j
 = 0; j < 
¨gc
; j++) {

2971 *
Êag
 = 
¨gv
[
j
];

2972 i‡(!
	`°rˇ£cmp
(
Êag
,"write")) {

2973 
c
->
Êags
 |
CMD_WRITE
|
CMD_CATEGORY_WRITE
;

2974 } i‡(!
	`°rˇ£cmp
(
Êag
,"read-only")) {

2975 
c
->
Êags
 |
CMD_READONLY
|
CMD_CATEGORY_READ
;

2976 } i‡(!
	`°rˇ£cmp
(
Êag
,"use-memory")) {

2977 
c
->
Êags
 |
CMD_DENYOOM
;

2978 } i‡(!
	`°rˇ£cmp
(
Êag
,"admin")) {

2979 
c
->
Êags
 |
CMD_ADMIN
|
CMD_CATEGORY_ADMIN
|
CMD_CATEGORY_DANGEROUS
;

2980 } i‡(!
	`°rˇ£cmp
(
Êag
,"pub-sub")) {

2981 
c
->
Êags
 |
CMD_PUBSUB
|
CMD_CATEGORY_PUBSUB
;

2982 } i‡(!
	`°rˇ£cmp
(
Êag
,"no-script")) {

2983 
c
->
Êags
 |
CMD_NOSCRIPT
;

2984 } i‡(!
	`°rˇ£cmp
(
Êag
,"random")) {

2985 
c
->
Êags
 |
CMD_RANDOM
;

2986 } i‡(!
	`°rˇ£cmp
(
Êag
,"to-sort")) {

2987 
c
->
Êags
 |
CMD_SORT_FOR_SCRIPT
;

2988 } i‡(!
	`°rˇ£cmp
(
Êag
,"ok-loading")) {

2989 
c
->
Êags
 |
CMD_LOADING
;

2990 } i‡(!
	`°rˇ£cmp
(
Êag
,"ok-stale")) {

2991 
c
->
Êags
 |
CMD_STALE
;

2992 } i‡(!
	`°rˇ£cmp
(
Êag
,"no-monitor")) {

2993 
c
->
Êags
 |
CMD_SKIP_MONITOR
;

2994 } i‡(!
	`°rˇ£cmp
(
Êag
,"no-slowlog")) {

2995 
c
->
Êags
 |
CMD_SKIP_SLOWLOG
;

2996 } i‡(!
	`°rˇ£cmp
(
Êag
,"cluster-asking")) {

2997 
c
->
Êags
 |
CMD_ASKING
;

2998 } i‡(!
	`°rˇ£cmp
(
Êag
,"fast")) {

2999 
c
->
Êags
 |
CMD_FAST
 | 
CMD_CATEGORY_FAST
;

3000 } i‡(!
	`°rˇ£cmp
(
Êag
,"no-auth")) {

3001 
c
->
Êags
 |
CMD_NO_AUTH
;

3004 
uöt64_t
 
ˇtÊag
;

3005 i‡(
Êag
[0] == '@' &&

3006 (
ˇtÊag
 = 
	`ACLGëComm™dC©eg‹yFœgByName
(
Êag
+1)) != 0)

3008 
c
->
Êags
 |
ˇtÊag
;

3010 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

3011  
C_ERR
;

3016 i‡(!(
c
->
Êags
 & 
CMD_CATEGORY_FAST
)Ëc->Êag†|
CMD_CATEGORY_SLOW
;

3018 
	`sds‰ì•lôªs
(
¨gv
,
¨gc
);

3019  
C_OK
;

3020 
	}
}

3024 
	$p›uœãComm™dTabÀ
() {

3025 
j
;

3026 
numcomm™ds
 = (
ªdisComm™dTabÀ
)/(
ªdisComm™d
);

3028 
j
 = 0; j < 
numcomm™ds
; j++) {

3029 
ªdisComm™d
 *
c
 = 
ªdisComm™dTabÀ
+
j
;

3030 
ªtvÆ1
, 
ªtvÆ2
;

3034 i‡(
	`p›uœãComm™dTabÀP¨£Fœgs
(
c
,c->
sÊags
Ë=
C_ERR
)

3035 
	`£rvîP™ic
("Unsupported command flag");

3037 
c
->
id
 = 
	`ACLGëComm™dID
(c->
«me
);

3038 
ªtvÆ1
 = 
	`di˘Add
(
£rvî
.
comm™ds
, 
	`sd¢ew
(
c
->
«me
), c);

3041 
ªtvÆ2
 = 
	`di˘Add
(
£rvî
.
‹ig_comm™ds
, 
	`sd¢ew
(
c
->
«me
), c);

3042 
	`£rvîAs£π
(
ªtvÆ1
 =
DICT_OK
 && 
ªtvÆ2
 == DICT_OK);

3044 
	}
}

3046 
	$ª£tComm™dTabÀSèts
() {

3047 
ªdisComm™d
 *
c
;

3048 
di˘E¡ry
 *
de
;

3049 
di˘Iãøt‹
 *
di
;

3051 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
comm™ds
);

3052 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3053 
c
 = (
ªdisComm™d
 *Ë
	`di˘GëVÆ
(
de
);

3054 
c
->
mi¸o£c⁄ds
 = 0;

3055 
c
->
ˇŒs
 = 0;

3057 
	`di˘Rñó£Iãøt‹
(
di
);

3059 
	}
}

3063 
	$ªdisOpAºayInô
(
ªdisOpAºay
 *
ﬂ
) {

3064 
ﬂ
->
›s
 = 
NULL
;

3065 
ﬂ
->
num›s
 = 0;

3066 
	}
}

3068 
	$ªdisOpAºayAµíd
(
ªdisOpAºay
 *
ﬂ
, 
ªdisComm™d
 *
cmd
, 
dbid
,

3069 
robj
 **
¨gv
, 
¨gc
, 
èrgë
)

3071 
ªdisOp
 *
›
;

3073 
ﬂ
->
›s
 = 
	`zªÆloc
(ﬂ->›s,(
ªdisOp
)*(ﬂ->
num›s
+1));

3074 
›
 = 
ﬂ
->
›s
+ﬂ->
num›s
;

3075 
›
->
cmd
 = cmd;

3076 
›
->
dbid
 = dbid;

3077 
›
->
¨gv
 =árgv;

3078 
›
->
¨gc
 =árgc;

3079 
›
->
èrgë
 =Åarget;

3080 
ﬂ
->
num›s
++;

3081  
ﬂ
->
num›s
;

3082 
	}
}

3084 
	$ªdisOpAºayFªe
(
ªdisOpAºay
 *
ﬂ
) {

3085 
ﬂ
->
num›s
) {

3086 
j
;

3087 
ªdisOp
 *
›
;

3089 
ﬂ
->
num›s
--;

3090 
›
 = 
ﬂ
->
›s
+ﬂ->
num›s
;

3091 
j
 = 0; j < 
›
->
¨gc
; j++)

3092 
	`de¸RefCou¡
(
›
->
¨gv
[
j
]);

3093 
	`z‰ì
(
›
->
¨gv
);

3095 
	`z‰ì
(
ﬂ
->
›s
);

3096 
	}
}

3100 
ªdisComm™d
 *
	$lookupComm™d
(
sds
 
«me
) {

3101  
	`di˘FëchVÆue
(
£rvî
.
comm™ds
, 
«me
);

3102 
	}
}

3104 
ªdisComm™d
 *
	$lookupComm™dByCSåög
(*
s
) {

3105 
ªdisComm™d
 *
cmd
;

3106 
sds
 
«me
 = 
	`sd¢ew
(
s
);

3108 
cmd
 = 
	`di˘FëchVÆue
(
£rvî
.
comm™ds
, 
«me
);

3109 
	`sds‰ì
(
«me
);

3110  
cmd
;

3111 
	}
}

3120 
ªdisComm™d
 *
	$lookupComm™dOrOrigöÆ
(
sds
 
«me
) {

3121 
ªdisComm™d
 *
cmd
 = 
	`di˘FëchVÆue
(
£rvî
.
comm™ds
, 
«me
);

3123 i‡(!
cmd
Ëcmd = 
	`di˘FëchVÆue
(
£rvî
.
‹ig_comm™ds
,
«me
);

3124  
cmd
;

3125 
	}
}

3143 
	$¥›ag©e
(
ªdisComm™d
 *
cmd
, 
dbid
, 
robj
 **
¨gv
, 
¨gc
,

3144 
Êags
)

3146 i‡(
£rvî
.
aof_°©e
 !
AOF_OFF
 && 
Êags
 & 
PROPAGATE_AOF
)

3147 
	`„edAµídO∆yFûe
(
cmd
,
dbid
,
¨gv
,
¨gc
);

3148 i‡(
Êags
 & 
PROPAGATE_REPL
)

3149 
	`ª∂iˇti⁄FìdSœves
(
£rvî
.
¶aves
,
dbid
,
¨gv
,
¨gc
);

3150 
	}
}

3164 
	$ÆsoPr›ag©e
(
ªdisComm™d
 *
cmd
, 
dbid
, 
robj
 **
¨gv
, 
¨gc
,

3165 
èrgë
)

3167 
robj
 **
¨gvc›y
;

3168 
j
;

3170 i‡(
£rvî
.
lﬂdög
) ;

3172 
¨gvc›y
 = 
	`zmÆloc
((
robj
*)*
¨gc
);

3173 
j
 = 0; j < 
¨gc
; j++) {

3174 
¨gvc›y
[
j
] = 
¨gv
[j];

3175 
	`ö¸RefCou¡
(
¨gv
[
j
]);

3177 
	`ªdisOpAºayAµíd
(&
£rvî
.
Æso_¥›ag©e
,
cmd
,
dbid
,
¨gvc›y
,
¨gc
,
èrgë
);

3178 
	}
}

3183 
	$f‹˚Comm™dPr›ag©i⁄
(
˛õ¡
 *
c
, 
Êags
) {

3184 i‡(
Êags
 & 
PROPAGATE_REPL
Ë
c
->Êag†|
CLIENT_FORCE_REPL
;

3185 i‡(
Êags
 & 
PROPAGATE_AOF
Ë
c
->Êag†|
CLIENT_FORCE_AOF
;

3186 
	}
}

3191 
	$¥evítComm™dPr›ag©i⁄
(
˛õ¡
 *
c
) {

3192 
c
->
Êags
 |
CLIENT_PREVENT_PROP
;

3193 
	}
}

3196 
	$¥evítComm™dAOF
(
˛õ¡
 *
c
) {

3197 
c
->
Êags
 |
CLIENT_PREVENT_AOF_PROP
;

3198 
	}
}

3201 
	$¥evítComm™dRïliˇti⁄
(
˛õ¡
 *
c
) {

3202 
c
->
Êags
 |
CLIENT_PREVENT_REPL_PROP
;

3203 
	}
}

3242 
	$ˇŒ
(
˛õ¡
 *
c
, 
Êags
) {

3243 
dúty
;

3244 
u°ime_t
 
°¨t
, 
duøti⁄
;

3245 
˛õ¡_ﬁd_Êags
 = 
c
->
Êags
;

3246 
ªdisComm™d
 *
ªÆ_cmd
 = 
c
->
cmd
;

3248 
£rvî
.
fixed_time_expúe
++;

3252 i‡(
	`li°Lígth
(
£rvî
.
m⁄ô‹s
) &&

3253 !
£rvî
.
lﬂdög
 &&

3254 !(
c
->
cmd
->
Êags
 & (
CMD_SKIP_MONITOR
|
CMD_ADMIN
)))

3256 
	`ª∂iˇti⁄FìdM⁄ô‹s
(
c
,
£rvî
.
m⁄ô‹s
,c->
db
->
id
,c->
¨gv
,c->
¨gc
);

3261 
c
->
Êags
 &~(
CLIENT_FORCE_AOF
|
CLIENT_FORCE_REPL
|
CLIENT_PREVENT_PROP
);

3262 
ªdisOpAºay
 
¥ev_Æso_¥›ag©e
 = 
£rvî
.
Æso_¥›ag©e
;

3263 
	`ªdisOpAºayInô
(&
£rvî
.
Æso_¥›ag©e
);

3266 
dúty
 = 
£rvî
.dirty;

3267 
	`upd©eCachedTime
(0);

3268 
°¨t
 = 
£rvî
.
u°ime
;

3269 
c
->
cmd
->
	`¥oc
(c);

3270 
duøti⁄
 = 
	`u°ime
()-
°¨t
;

3271 
dúty
 = 
£rvî
.dirty-dirty;

3272 i‡(
dúty
 < 0) dirty = 0;

3276 i‡(
£rvî
.
lﬂdög
 && 
c
->
Êags
 & 
CLIENT_LUA
)

3277 
Êags
 &~(
CMD_CALL_SLOWLOG
 | 
CMD_CALL_STATS
);

3282 i‡(
c
->
Êags
 & 
CLIENT_LUA
 && 
£rvî
.
lua_ˇŒî
) {

3283 i‡(
c
->
Êags
 & 
CLIENT_FORCE_REPL
)

3284 
£rvî
.
lua_ˇŒî
->
Êags
 |
CLIENT_FORCE_REPL
;

3285 i‡(
c
->
Êags
 & 
CLIENT_FORCE_AOF
)

3286 
£rvî
.
lua_ˇŒî
->
Êags
 |
CLIENT_FORCE_AOF
;

3291 i‡(
Êags
 & 
CMD_CALL_SLOWLOG
 && !(
c
->
cmd
->Êag†& 
CMD_SKIP_SLOWLOG
)) {

3292 *
œãncy_evít
 = (
c
->
cmd
->
Êags
 & 
CMD_FAST
) ?

3294 
	`œãncyAddSam∂eIfNìded
(
œãncy_evít
,
duøti⁄
/1000);

3295 
	`¶owlogPushE¡ryIfNìded
(
c
,c->
¨gv
,c->
¨gc
,
duøti⁄
);

3298 i‡(
Êags
 & 
CMD_CALL_STATS
) {

3302 
ªÆ_cmd
->
mi¸o£c⁄ds
 +
duøti⁄
;

3303 
ªÆ_cmd
->
ˇŒs
++;

3307 i‡(
Êags
 & 
CMD_CALL_PROPAGATE
 &&

3308 (
c
->
Êags
 & 
CLIENT_PREVENT_PROP
) != CLIENT_PREVENT_PROP)

3310 
¥›ag©e_Êags
 = 
PROPAGATE_NONE
;

3314 i‡(
dúty
Ë
¥›ag©e_Êags
 |(
PROPAGATE_AOF
|
PROPAGATE_REPL
);

3318 i‡(
c
->
Êags
 & 
CLIENT_FORCE_REPL
Ë
¥›ag©e_Êags
 |
PROPAGATE_REPL
;

3319 i‡(
c
->
Êags
 & 
CLIENT_FORCE_AOF
Ë
¥›ag©e_Êags
 |
PROPAGATE_AOF
;

3324 i‡(
c
->
Êags
 & 
CLIENT_PREVENT_REPL_PROP
 ||

3325 !(
Êags
 & 
CMD_CALL_PROPAGATE_REPL
))

3326 
¥›ag©e_Êags
 &~
PROPAGATE_REPL
;

3327 i‡(
c
->
Êags
 & 
CLIENT_PREVENT_AOF_PROP
 ||

3328 !(
Êags
 & 
CMD_CALL_PROPAGATE_AOF
))

3329 
¥›ag©e_Êags
 &~
PROPAGATE_AOF
;

3334 i‡(
¥›ag©e_Êags
 !
PROPAGATE_NONE
 && !(
c
->
cmd
->
Êags
 & 
CMD_MODULE
))

3335 
	`¥›ag©e
(
c
->
cmd
,c->
db
->
id
,c->
¨gv
,c->
¨gc
,
¥›ag©e_Êags
);

3340 
c
->
Êags
 &~(
CLIENT_FORCE_AOF
|
CLIENT_FORCE_REPL
|
CLIENT_PREVENT_PROP
);

3341 
c
->
Êags
 |
˛õ¡_ﬁd_Êags
 &

3342 (
CLIENT_FORCE_AOF
|
CLIENT_FORCE_REPL
|
CLIENT_PREVENT_PROP
);

3347 i‡(
£rvî
.
Æso_¥›ag©e
.
num›s
) {

3348 
j
;

3349 
ªdisOp
 *
r›
;

3351 i‡(
Êags
 & 
CMD_CALL_PROPAGATE
) {

3352 
mu…i_emôãd
 = 0;

3359 i‡(
£rvî
.
Æso_¥›ag©e
.
num›s
 > 1 &&

3360 !(
c
->
cmd
->
Êags
 & 
CMD_MODULE
) &&

3361 !(
c
->
Êags
 & 
CLIENT_MULTI
) &&

3362 !(
Êags
 & 
CMD_CALL_NOWRAP
))

3364 
	`execComm™dPr›ag©eMu…i
(
c
);

3365 
mu…i_emôãd
 = 1;

3368 
j
 = 0; j < 
£rvî
.
Æso_¥›ag©e
.
num›s
; j++) {

3369 
r›
 = &
£rvî
.
Æso_¥›ag©e
.
›s
[
j
];

3370 
èrgë
 = 
r›
->target;

3372 i‡(!(
Êags
&
CMD_CALL_PROPAGATE_AOF
)Ë
èrgë
 &~
PROPAGATE_AOF
;

3373 i‡(!(
Êags
&
CMD_CALL_PROPAGATE_REPL
)Ë
èrgë
 &~
PROPAGATE_REPL
;

3374 i‡(
èrgë
)

3375 
	`¥›ag©e
(
r›
->
cmd
,r›->
dbid
,r›->
¨gv
,r›->
¨gc
,
èrgë
);

3378 i‡(
mu…i_emôãd
) {

3379 
	`execComm™dPr›ag©eExec
(
c
);

3382 
	`ªdisOpAºayFªe
(&
£rvî
.
Æso_¥›ag©e
);

3384 
£rvî
.
Æso_¥›ag©e
 = 
¥ev_Æso_¥›ag©e
;

3388 i‡(
c
->
cmd
->
Êags
 & 
CMD_READONLY
) {

3389 
˛õ¡
 *
ˇŒî
 = (
c
->
Êags
 & 
CLIENT_LUA
 && 
£rvî
.
lua_ˇŒî
) ?

3390 
£rvî
.
lua_ˇŒî
 : 
c
;

3391 i‡(
ˇŒî
->
Êags
 & 
CLIENT_TRACKING
 &&

3392 !(
ˇŒî
->
Êags
 & 
CLIENT_TRACKING_BCAST
))

3394 
	`åackögRemembîKeys
(
ˇŒî
);

3398 
£rvî
.
fixed_time_expúe
--;

3399 
£rvî
.
°©_numcomm™ds
++;

3400 
	}
}

3410 
	$¥o˚ssComm™d
(
˛õ¡
 *
c
) {

3411 
	`moduÀCÆlComm™dFûãrs
(
c
);

3417 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[0]->
±r
,"quit")) {

3418 
	`addRïly
(
c
,
sh¨ed
.
ok
);

3419 
c
->
Êags
 |
CLIENT_CLOSE_AFTER_REPLY
;

3420  
C_ERR
;

3425 
c
->
cmd
 = c->
œ°cmd
 = 
	`lookupComm™d
(c->
¨gv
[0]->
±r
);

3426 i‡(!
c
->
cmd
) {

3427 
	`ÊagTønß˘i⁄
(
c
);

3428 
sds
 
¨gs
 = 
	`sd£m±y
();

3429 
i
;

3430 
i
=1; i < 
c
->
¨gc
 && 
	`sd¶í
(
¨gs
) < 128; i++)

3431 
¨gs
 = 
	`sdsˇçrötf
◊rgs, "`%.*s`, ", 128-()
	`sd¶í
◊rgs), (*)
c
->
¨gv
[
i
]->
±r
);

3432 
	`addRïlyEº‹F‹m©
(
c
,"unknown command `%s`, withárgs beginning with: %s",

3433 (*)
c
->
¨gv
[0]->
±r
, 
¨gs
);

3434 
	`sds‰ì
(
¨gs
);

3435  
C_OK
;

3436 } i‡((
c
->
cmd
->
¨ôy
 > 0 && c->cmd->¨ôy !c->
¨gc
) ||

3437 (
c
->
¨gc
 < -c->
cmd
->
¨ôy
)) {

3438 
	`ÊagTønß˘i⁄
(
c
);

3439 
	`addRïlyEº‹F‹m©
(
c
,"wrongÇumber ofárguments for '%s' command",

3440 
c
->
cmd
->
«me
);

3441  
C_OK
;

3446 
auth_ªquúed
 = (!(
DeÁu…U£r
->
Êags
 & 
USER_FLAG_NOPASS
) ||

3447 (
DeÁu…U£r
->
Êags
 & 
USER_FLAG_DISABLED
)) &&

3448 !
c
->
authítiˇãd
;

3449 i‡(
auth_ªquúed
) {

3452 i‡(!(
c
->
cmd
->
Êags
 & 
CMD_NO_AUTH
)) {

3453 
	`ÊagTønß˘i⁄
(
c
);

3454 
	`addRïly
(
c
,
sh¨ed
.
nﬂuthîr
);

3455  
C_OK
;

3461 
a˛_keypos
;

3462 
a˛_ªtvÆ
 = 
	`ACLCheckComm™dPîm
(
c
,&
a˛_keypos
);

3463 i‡(
a˛_ªtvÆ
 !
ACL_OK
) {

3464 
	`addACLLogE¡ry
(
c
,
a˛_ªtvÆ
,
a˛_keypos
,
NULL
);

3465 
	`ÊagTønß˘i⁄
(
c
);

3466 i‡(
a˛_ªtvÆ
 =
ACL_DENIED_CMD
)

3467 
	`addRïlyEº‹F‹m©
(
c
,

3469 "thê'%s' comm™d o∏ô†subcomm™d", 
c
->
cmd
->
«me
);

3471 
	`addRïlyEº‹F‹m©
(
c
,

3474  
C_OK
;

3481 i‡(
£rvî
.
˛u°î_íabÀd
 &&

3482 !(
c
->
Êags
 & 
CLIENT_MASTER
) &&

3483 !(
c
->
Êags
 & 
CLIENT_LUA
 &&

3484 
£rvî
.
lua_ˇŒî
->
Êags
 & 
CLIENT_MASTER
) &&

3485 !(
c
->
cmd
->
gëkeys_¥oc
 =
NULL
 && c->cmd->
fú°key
 == 0 &&

3486 
c
->
cmd
->
¥oc
 !
execComm™d
))

3488 
hash¶Ÿ
;

3489 
îr‹_code
;

3490 
˛u°îNode
 *
n
 = 
	`gëNodeByQuîy
(
c
,c->
cmd
,c->
¨gv
,c->
¨gc
,

3491 &
hash¶Ÿ
,&
îr‹_code
);

3492 i‡(
n
 =
NULL
 ||Ç !
£rvî
.
˛u°î
->
my£lf
) {

3493 i‡(
c
->
cmd
->
¥oc
 =
execComm™d
) {

3494 
	`disˇrdTønß˘i⁄
(
c
);

3496 
	`ÊagTønß˘i⁄
(
c
);

3498 
	`˛u°îRedúe˘Clõ¡
(
c
,
n
,
hash¶Ÿ
,
îr‹_code
);

3499  
C_OK
;

3509 i‡(
£rvî
.
maxmem‹y
 && !£rvî.
lua_timedout
) {

3510 
out_of_mem‹y
 = 
	`‰ìMem‹yIfNìdedAndSa„
(Ë=
C_ERR
;

3513 i‡(
£rvî
.
cuºít_˛õ¡
 =
NULL
Ë 
C_ERR
;

3518 i‡(
out_of_mem‹y
 &&

3519 (
c
->
cmd
->
Êags
 & 
CMD_DENYOOM
 ||

3520 (
c
->
Êags
 & 
CLIENT_MULTI
 &&

3521 
c
->
cmd
->
¥oc
 !
execComm™d
 &&

3522 
c
->
cmd
->
¥oc
 !
disˇrdComm™d
)))

3524 
	`ÊagTønß˘i⁄
(
c
);

3525 
	`addRïly
(
c
, 
sh¨ed
.
oomîr
);

3526  
C_OK
;

3532 i‡(
c
->
cmd
->
¥oc
 =
evÆComm™d
 || c->cmd->¥o¯=
evÆShaComm™d
) {

3533 
£rvî
.
lua_oom
 = 
out_of_mem‹y
;

3539 i‡(
£rvî
.
åackög_˛õ¡s
Ë
	`åackögLimôU£dSlŸs
();

3543 
díy_wrôe_ty≥
 = 
	`wrôeComm™dsDíõdByDiskEº‹
();

3544 i‡(
díy_wrôe_ty≥
 !
DISK_ERROR_TYPE_NONE
 &&

3545 
£rvî
.
ma°îho°
 =
NULL
 &&

3546 (
c
->
cmd
->
Êags
 & 
CMD_WRITE
 ||

3547 
c
->
cmd
->
¥oc
 =
pögComm™d
))

3549 
	`ÊagTønß˘i⁄
(
c
);

3550 i‡(
díy_wrôe_ty≥
 =
DISK_ERROR_TYPE_RDB
)

3551 
	`addRïly
(
c
, 
sh¨ed
.
bgßvìº
);

3553 
	`addRïlySds
(
c
,

3554 
	`sdsˇçrötf
(
	`sd£m±y
(),

3556 
	`°ªº‹
(
£rvî
.
aof_œ°_wrôe_î∫o
)));

3557  
C_OK
;

3562 i‡(
£rvî
.
ma°îho°
 =
NULL
 &&

3563 
£rvî
.
ª∂_mö_¶aves_to_wrôe
 &&

3564 
£rvî
.
ª∂_mö_¶aves_max_œg
 &&

3565 
c
->
cmd
->
Êags
 & 
CMD_WRITE
 &&

3566 
£rvî
.
ª∂_good_¶aves_cou¡
 < sîvî.
ª∂_mö_¶aves_to_wrôe
)

3568 
	`ÊagTønß˘i⁄
(
c
);

3569 
	`addRïly
(
c
, 
sh¨ed
.
n‹ïliˇ£º
);

3570  
C_OK
;

3575 i‡(
£rvî
.
ma°îho°
 && sîvî.
ª∂_¶ave_ro
 &&

3576 !(
c
->
Êags
 & 
CLIENT_MASTER
) &&

3577 
c
->
cmd
->
Êags
 & 
CMD_WRITE
)

3579 
	`ÊagTønß˘i⁄
(
c
);

3580 
	`addRïly
(
c
, 
sh¨ed
.
ro¶avìº
);

3581  
C_OK
;

3586 i‡((
c
->
Êags
 & 
CLIENT_PUBSUB
 && c->
ª•
 == 2) &&

3587 
c
->
cmd
->
¥oc
 !
pögComm™d
 &&

3588 
c
->
cmd
->
¥oc
 !
subs¸ibeComm™d
 &&

3589 
c
->
cmd
->
¥oc
 !
unsubs¸ibeComm™d
 &&

3590 
c
->
cmd
->
¥oc
 !
psubs¸ibeComm™d
 &&

3591 
c
->
cmd
->
¥oc
 !
punsubs¸ibeComm™d
) {

3592 
	`addRïlyEº‹F‹m©
(
c
,

3595 
c
->
cmd
->
«me
);

3596  
C_OK
;

3602 i‡(
£rvî
.
ma°îho°
 && sîvî.
ª∂_°©e
 !
REPL_STATE_CONNECTED
 &&

3603 
£rvî
.
ª∂_£rve_°Æe_d©a
 == 0 &&

3604 !(
c
->
cmd
->
Êags
 & 
CMD_STALE
))

3606 
	`ÊagTønß˘i⁄
(
c
);

3607 
	`addRïly
(
c
, 
sh¨ed
.
ma°îdow√º
);

3608  
C_OK
;

3613 i‡(
£rvî
.
lﬂdög
 && !(
c
->
cmd
->
Êags
 & 
CMD_LOADING
)) {

3614 
	`addRïly
(
c
, 
sh¨ed
.
lﬂdögîr
);

3615  
C_OK
;

3624 i‡(
£rvî
.
lua_timedout
 &&

3625 
c
->
cmd
->
¥oc
 !
authComm™d
 &&

3626 
c
->
cmd
->
¥oc
 !
hñloComm™d
 &&

3627 
c
->
cmd
->
¥oc
 !
ª∂c⁄fComm™d
 &&

3628 
c
->
cmd
->
¥oc
 !
mu…iComm™d
 &&

3629 
c
->
cmd
->
¥oc
 !
execComm™d
 &&

3630 
c
->
cmd
->
¥oc
 !
disˇrdComm™d
 &&

3631 !(
c
->
cmd
->
¥oc
 =
shutdownComm™d
 &&

3632 
c
->
¨gc
 == 2 &&

3633 
	`tﬁowî
(((*)
c
->
¨gv
[1]->
±r
)[0]) == 'n') &&

3634 !(
c
->
cmd
->
¥oc
 =
s¸ùtComm™d
 &&

3635 
c
->
¨gc
 == 2 &&

3636 
	`tﬁowî
(((*)
c
->
¨gv
[1]->
±r
)[0]) == 'k'))

3638 
	`ÊagTønß˘i⁄
(
c
);

3639 
	`addRïly
(
c
, 
sh¨ed
.
¶ows¸ùãº
);

3640  
C_OK
;

3644 i‡(
c
->
Êags
 & 
CLIENT_MULTI
 &&

3645 
c
->
cmd
->
¥oc
 !
execComm™d
 && c->cmd->¥o¯!
disˇrdComm™d
 &&

3646 
c
->
cmd
->
¥oc
 !
mu…iComm™d
 && c->cmd->¥o¯!
w©chComm™d
)

3648 
	`queueMu…iComm™d
(
c
);

3649 
	`addRïly
(
c
,
sh¨ed
.
queued
);

3651 
	`ˇŒ
(
c
,
CMD_CALL_FULL
);

3652 
c
->
woff
 = 
£rvî
.
ma°î_ª∂_off£t
;

3653 i‡(
	`li°Lígth
(
£rvî
.
ªady_keys
))

3654 
	`h™dÀClõ¡sBlockedOnKeys
();

3656  
C_OK
;

3657 
	}
}

3663 
	$˛o£Li°íögSockës
(
u∆ök_unix_sockë
) {

3664 
j
;

3666 
j
 = 0; j < 
£rvî
.
ùfd_cou¡
; j++Ë
	`˛o£
(£rvî.
ùfd
[j]);

3667 
j
 = 0; j < 
£rvî
.
ésfd_cou¡
; j++Ë
	`˛o£
(£rvî.
ésfd
[j]);

3668 i‡(
£rvî
.
sofd
 !-1Ë
	`˛o£
(server.sofd);

3669 i‡(
£rvî
.
˛u°î_íabÀd
)

3670 
j
 = 0; j < 
£rvî
.
cfd_cou¡
; j++Ë
	`˛o£
(£rvî.
cfd
[j]);

3671 i‡(
u∆ök_unix_sockë
 && 
£rvî
.
unixsockë
) {

3672 
	`£rvîLog
(
LL_NOTICE
,"RemovingÅhe unix socket file.");

3673 
	`u∆ök
(
£rvî
.
unixsockë
);

3675 
	}
}

3677 
	$¥ï¨eF‹Shutdown
(
Êags
) {

3678 
ßve
 = 
Êags
 & 
SHUTDOWN_SAVE
;

3679 
noßve
 = 
Êags
 & 
SHUTDOWN_NOSAVE
;

3681 
	`£rvîLog
(
LL_WARNING
,"UserÑequested shutdown...");

3682 i‡(
£rvî
.
su≥rvi£d_mode
 =
SUPERVISED_SYSTEMD
)

3683 
	`ªdisCommuniˇãSy°emd
("STOPPING=1\n");

3686 
	`ldbKûlF‹kedSessi⁄s
();

3691 i‡(
£rvî
.
rdb_chûd_pid
 != -1) {

3692 
	`£rvîLog
(
LL_WARNING
,"There isá child savingán .rdb. Killing it!");

3693 
	`kûlRDBChûd
();

3697 i‡(
£rvî
.
moduÀ_chûd_pid
 != -1) {

3698 
	`£rvîLog
(
LL_WARNING
,"There isá module fork child. Killing it!");

3699 
	`Tîmö©eModuÀF‹kChûd
(
£rvî
.
moduÀ_chûd_pid
,0);

3702 i‡(
£rvî
.
aof_°©e
 !
AOF_OFF
) {

3705 i‡(
£rvî
.
aof_chûd_pid
 != -1) {

3708 i‡(
£rvî
.
aof_°©e
 =
AOF_WAIT_REWRITE
) {

3709 
	`£rvîLog
(
LL_WARNING
, "Writing initial AOF, can'tÉxit.");

3710  
C_ERR
;

3712 
	`£rvîLog
(
LL_WARNING
,

3714 
	`kûlAµídO∆yChûd
();

3717 
	`£rvîLog
(
LL_NOTICE
,"Calling fsync() onÅhe AOF file.");

3718 
	`ÊushAµídO∆yFûe
(1);

3719 
	`ªdis_fsync
(
£rvî
.
aof_fd
);

3723 i‡((
£rvî
.
ßvï¨am¶í
 > 0 && !
noßve
Ë|| 
ßve
) {

3724 
	`£rvîLog
(
LL_NOTICE
,"SavingÅhe final RDB snapshot beforeÉxiting.");

3725 i‡(
£rvî
.
su≥rvi£d_mode
 =
SUPERVISED_SYSTEMD
)

3726 
	`ªdisCommuniˇãSy°emd
("STATUS=SavingÅhe final RDB snapshot\n");

3728 
rdbSaveInfo
 
rsi
, *
rsùå
;

3729 
rsùå
 = 
	`rdbP›uœãSaveInfo
(&
rsi
);

3730 i‡(
	`rdbSave
(
£rvî
.
rdb_fûíame
,
rsùå
Ë!
C_OK
) {

3736 
	`£rvîLog
(
LL_WARNING
,"ErrorÅryingÅo saveÅhe DB, can'tÉxit.");

3737 i‡(
£rvî
.
su≥rvi£d_mode
 =
SUPERVISED_SYSTEMD
)

3738 
	`ªdisCommuniˇãSy°emd
("STATUS=ErrorÅryingÅo saveÅhe DB, can'tÉxit.\n");

3739  
C_ERR
;

3744 
	`moduÀFúeSîvîEvít
(
REDISMODULE_EVENT_SHUTDOWN
,0,
NULL
);

3747 i‡(
£rvî
.
d´m⁄ize
 || sîvî.
pidfûe
) {

3748 
	`£rvîLog
(
LL_NOTICE
,"RemovingÅheÖid file.");

3749 
	`u∆ök
(
£rvî
.
pidfûe
);

3754 
	`ÊushSœvesOuçutBuf„rs
();

3757 
	`˛o£Li°íögSockës
(1);

3758 
	`£rvîLog
(
LL_WARNING
,"%s isÇowÑeadyÅoÉxit, bye bye...",

3759 
£rvî
.
£¡öñ_mode
 ? "Sentinel" : "Redis");

3760  
C_OK
;

3761 
	}
}

3776 
	$wrôeComm™dsDíõdByDiskEº‹
() {

3777 i‡(
£rvî
.
°›_wrôes_⁄_bgßve_îr
 &&

3778 
£rvî
.
ßvï¨am¶í
 > 0 &&

3779 
£rvî
.
œ°bgßve_°©us
 =
C_ERR
)

3781  
DISK_ERROR_TYPE_RDB
;

3782 } i‡(
£rvî
.
aof_°©e
 !
AOF_OFF
 &&

3783 
£rvî
.
aof_œ°_wrôe_°©us
 =
C_ERR
)

3785  
DISK_ERROR_TYPE_AOF
;

3787  
DISK_ERROR_TYPE_NONE
;

3789 
	}
}

3793 
	$pögComm™d
(
˛õ¡
 *
c
) {

3795 i‡(
c
->
¨gc
 > 2) {

3796 
	`addRïlyEº‹F‹m©
(
c
,"wrongÇumber ofárguments for '%s' command",

3797 
c
->
cmd
->
«me
);

3801 i‡(
c
->
Êags
 & 
CLIENT_PUBSUB
 && c->
ª•
 == 2) {

3802 
	`addRïly
(
c
,
sh¨ed
.
mbulkhdr
[2]);

3803 
	`addRïlyBulkCBuf„r
(
c
,"pong",4);

3804 i‡(
c
->
¨gc
 == 1)

3805 
	`addRïlyBulkCBuf„r
(
c
,"",0);

3807 
	`addRïlyBulk
(
c
,c->
¨gv
[1]);

3809 i‡(
c
->
¨gc
 == 1)

3810 
	`addRïly
(
c
,
sh¨ed
.
p⁄g
);

3812 
	`addRïlyBulk
(
c
,c->
¨gv
[1]);

3814 
	}
}

3816 
	$echoComm™d
(
˛õ¡
 *
c
) {

3817 
	`addRïlyBulk
(
c
,c->
¨gv
[1]);

3818 
	}
}

3820 
	$timeComm™d
(
˛õ¡
 *
c
) {

3821 
timevÆ
 
tv
;

3825 
	`gëtimeofday
(&
tv
,
NULL
);

3826 
	`addRïlyAºayLí
(
c
,2);

3827 
	`addRïlyBulkL⁄gL⁄g
(
c
,
tv
.
tv_£c
);

3828 
	`addRïlyBulkL⁄gL⁄g
(
c
,
tv
.
tv_u£c
);

3829 
	}
}

3832 
	$addRïlyComm™dFœg
(
˛õ¡
 *
c
, 
ªdisComm™d
 *
cmd
, 
f
, *
ª∂y
) {

3833 i‡(
cmd
->
Êags
 & 
f
) {

3834 
	`addRïlySètus
(
c
, 
ª∂y
);

3838 
	}
}

3841 
	$addRïlyComm™d
(
˛õ¡
 *
c
, 
ªdisComm™d
 *
cmd
) {

3842 i‡(!
cmd
) {

3843 
	`addRïlyNuŒ
(
c
);

3846 
	`addRïlyAºayLí
(
c
, 7);

3847 
	`addRïlyBulkCSåög
(
c
, 
cmd
->
«me
);

3848 
	`addRïlyL⁄gL⁄g
(
c
, 
cmd
->
¨ôy
);

3850 
Êagcou¡
 = 0;

3851 *
ÊagÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

3852 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_WRITE
, "write");

3853 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_READONLY
, "readonly");

3854 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_DENYOOM
, "denyoom");

3855 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_ADMIN
, "admin");

3856 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_PUBSUB
, "pubsub");

3857 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_NOSCRIPT
, "noscript");

3858 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_RANDOM
, "random");

3859 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_SORT_FOR_SCRIPT
,"sort_for_script");

3860 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_LOADING
, "loading");

3861 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_STALE
, "stale");

3862 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_SKIP_MONITOR
, "skip_monitor");

3863 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_SKIP_SLOWLOG
, "skip_slowlog");

3864 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_ASKING
, "asking");

3865 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_FAST
, "fast");

3866 
Êagcou¡
 +
	`addRïlyComm™dFœg
(
c
,
cmd
,
CMD_NO_AUTH
, "no_auth");

3867 i‡((
cmd
->
gëkeys_¥oc
 && !(cmd->
Êags
 & 
CMD_MODULE
)) ||

3868 
cmd
->
Êags
 & 
CMD_MODULE_GETKEYS
)

3870 
	`addRïlySètus
(
c
, "movablekeys");

3871 
Êagcou¡
 += 1;

3873 
	`£tDe„ºedSëLí
(
c
, 
ÊagÀn
, 
Êagcou¡
);

3875 
	`addRïlyL⁄gL⁄g
(
c
, 
cmd
->
fú°key
);

3876 
	`addRïlyL⁄gL⁄g
(
c
, 
cmd
->
œ°key
);

3877 
	`addRïlyL⁄gL⁄g
(
c
, 
cmd
->
key°ï
);

3879 
	`addRïlyComm™dC©eg‹õs
(
c
,
cmd
);

3881 
	}
}

3884 
	$comm™dComm™d
(
˛õ¡
 *
c
) {

3885 
di˘Iãøt‹
 *
di
;

3886 
di˘E¡ry
 *
de
;

3888 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"help")) {

3889 c⁄° *
hñp
[] = {

3894 
NULL


3896 
	`addRïlyHñp
(
c
, 
hñp
);

3897 } i‡(
c
->
¨gc
 == 1) {

3898 
	`addRïlyAºayLí
(
c
, 
	`di˘Size
(
£rvî
.
comm™ds
));

3899 
di
 = 
	`di˘GëIãøt‹
(
£rvî
.
comm™ds
);

3900 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

3901 
	`addRïlyComm™d
(
c
, 
	`di˘GëVÆ
(
de
));

3903 
	`di˘Rñó£Iãøt‹
(
di
);

3904 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
, "info")) {

3905 
i
;

3906 
	`addRïlyAºayLí
(
c
, c->
¨gc
-2);

3907 
i
 = 2; i < 
c
->
¨gc
; i++) {

3908 
	`addRïlyComm™d
(
c
, 
	`di˘FëchVÆue
(
£rvî
.
comm™ds
, c->
¨gv
[
i
]->
±r
));

3910 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
, "cou¡"Ë&& c->
¨gc
 == 2) {

3911 
	`addRïlyL⁄gL⁄g
(
c
, 
	`di˘Size
(
£rvî
.
comm™ds
));

3912 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"gëkeys"Ë&& c->
¨gc
 >= 3) {

3913 
ªdisComm™d
 *
cmd
 = 
	`lookupComm™d
(
c
->
¨gv
[2]->
±r
);

3914 *
keys
, 
numkeys
, 
j
;

3916 i‡(!
cmd
) {

3917 
	`addRïlyEº‹
(
c
,"Invalid command specified");

3919 } i‡(
cmd
->
gëkeys_¥oc
 =
NULL
 && cmd->
fú°key
 == 0) {

3920 
	`addRïlyEº‹
(
c
,"The command hasÇo keyárguments");

3922 } i‡((
cmd
->
¨ôy
 > 0 && cmd->¨ôy !
c
->
¨gc
-2) ||

3923 ((
c
->
¨gc
-2Ë< -
cmd
->
¨ôy
))

3925 
	`addRïlyEº‹
(
c
,"InvalidÇumber ofárguments specified for command");

3929 
keys
 = 
	`gëKeysFromComm™d
(
cmd
,
c
->
¨gv
+2,c->
¨gc
-2,&
numkeys
);

3930 i‡(!
keys
) {

3931 
	`addRïlyEº‹
(
c
,"Invalidárguments specified for command");

3933 
	`addRïlyAºayLí
(
c
,
numkeys
);

3934 
j
 = 0; j < 
numkeys
; j++Ë
	`addRïlyBulk
(
c
,c->
¨gv
[
keys
[j]+2]);

3935 
	`gëKeysFªeResu…
(
keys
);

3938 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

3940 
	}
}

3944 
	$byãsToHum™
(*
s
, 
n
) {

3945 
d
;

3947 i‡(
n
 < 1024) {

3949 
	`•rötf
(
s
,"%ŒuB",
n
);

3950 } i‡(
n
 < (1024*1024)) {

3951 
d
 = ()
n
/(1024);

3952 
	`•rötf
(
s
,"%.2fK",
d
);

3953 } i‡(
n
 < (1024LL*1024*1024)) {

3954 
d
 = ()
n
/(1024*1024);

3955 
	`•rötf
(
s
,"%.2fM",
d
);

3956 } i‡(
n
 < (1024LL*1024*1024*1024)) {

3957 
d
 = ()
n
/(1024LL*1024*1024);

3958 
	`•rötf
(
s
,"%.2fG",
d
);

3959 } i‡(
n
 < (1024LL*1024*1024*1024*1024)) {

3960 
d
 = ()
n
/(1024LL*1024*1024*1024);

3961 
	`•rötf
(
s
,"%.2fT",
d
);

3962 } i‡(
n
 < (1024LL*1024*1024*1024*1024*1024)) {

3963 
d
 = ()
n
/(1024LL*1024*1024*1024*1024);

3964 
	`•rötf
(
s
,"%.2fP",
d
);

3967 
	`•rötf
(
s
,"%ŒuB",
n
);

3969 
	}
}

3974 
sds
 
	$gíRedisInfoSåög
(c⁄° *
£˘i⁄
) {

3975 
sds
 
öfo
 = 
	`sd£m±y
();

3976 
time_t
 
u±ime
 = 
£rvî
.
unixtime
-£rvî.
°©_°¨âime
;

3977 
j
;

3978 
rußge
 
£lf_ru
, 
c_ru
;

3979 
Æl£˘i⁄s
 = 0, 
def£˘i⁄s
 = 0, 
evîythög
 = 0, 
moduÀs
 = 0;

3980 
£˘i⁄s
 = 0;

3982 i‡(
£˘i⁄
 =
NULL
) section = "default";

3983 
Æl£˘i⁄s
 = 
	`°rˇ£cmp
(
£˘i⁄
,"all") == 0;

3984 
def£˘i⁄s
 = 
	`°rˇ£cmp
(
£˘i⁄
,"default") == 0;

3985 
evîythög
 = 
	`°rˇ£cmp
(
£˘i⁄
,"everything") == 0;

3986 
moduÀs
 = 
	`°rˇ£cmp
(
£˘i⁄
,"modules") == 0;

3987 i‡(
evîythög
Ë
Æl£˘i⁄s
 = 1;

3989 
	`gërußge
(
RUSAGE_SELF
, &
£lf_ru
);

3990 
	`gërußge
(
RUSAGE_CHILDREN
, &
c_ru
);

3993 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"server")) {

3994 
ˇŒ_u«me
 = 1;

3995 
ut¢ame
 
«me
;

3996 *
mode
;

3998 i‡(
£rvî
.
˛u°î_íabÀd
Ë
mode
 = "cluster";

3999 i‡(
£rvî
.
£¡öñ_mode
Ë
mode
 = "sentinel";

4000 
mode
 = "standalone";

4002 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4004 i‡(
ˇŒ_u«me
) {

4006 
	`u«me
(&
«me
);

4007 
ˇŒ_u«me
 = 0;

4010 
öfo
 = 
	`sdsˇtfmt
(info,

4032 
REDIS_VERSION
,

4033 
	`ªdisGôSHA1
(),

4034 
	`°πﬁ
(
	`ªdisGôDúty
(),
NULL
,10) > 0,

4035 
	`ªdisBuûdIdSåög
(),

4036 
mode
,

4037 
«me
.
sy¢ame
,Çame.
ªÀa£
,Çame.
machöe
,

4038 
£rvî
.
¨ch_bôs
,

4039 
	`´GëApiName
(),

4040 
REDIS_ATOMIC_API
,

4041 #ifde‡
__GNUC__


4042 
__GNUC__
,
__GNUC_MINOR__
,
__GNUC_PATCHLEVEL__
,

4046 (
öt64_t
Ë
	`gëpid
(),

4047 
£rvî
.
runid
,

4048 
£rvî
.
p‹t
 ? sîvî.p‹à: sîvî.
és_p‹t
,

4049 (
öt64_t
)
u±ime
,

4050 (
öt64_t
)(
u±ime
/(3600*24)),

4051 
£rvî
.
hz
,

4052 
£rvî
.
c⁄fig_hz
,

4053 
£rvî
.
Ãu˛ock
,

4054 
£rvî
.
execuèbÀ
 ? server.executable : "",

4055 
£rvî
.
c⁄figfûe
 ? server.configfile : "");

4059 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"clients")) {

4060 
size_t
 
maxö
, 
maxout
;

4061 
	`gëEx∑nsiveClõ¡sInfo
(&
maxö
,&
maxout
);

4062 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4063 
öfo
 = 
	`sdsˇçrötf
(info,

4071 
	`li°Lígth
(
£rvî
.
˛õ¡s
)-li°Lígth(£rvî.
¶aves
),

4072 
maxö
, 
maxout
,

4073 
£rvî
.
blocked_˛õ¡s
,

4074 
£rvî
.
åackög_˛õ¡s
,

4075 (Ë
	`øxSize
(
£rvî
.
˛õ¡s_timeout_èbÀ
));

4079 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"memory")) {

4080 
hmem
[64];

4081 
≥ak_hmem
[64];

4082 
tŸÆ_sy°em_hmem
[64];

4083 
u£d_mem‹y_lua_hmem
[64];

4084 
u£d_mem‹y_s¸ùts_hmem
[64];

4085 
u£d_mem‹y_rss_hmem
[64];

4086 
maxmem‹y_hmem
[64];

4087 
size_t
 
zmÆloc_u£d
 = 
	`zmÆloc_u£d_mem‹y
();

4088 
size_t
 
tŸÆ_sy°em_mem
 = 
£rvî
.
sy°em_mem‹y_size
;

4089 c⁄° *
evi˘_pﬁicy
 = 
	`evi˘PﬁicyToSåög
();

4090 
mem‹y_lua
 = 
£rvî
.
lua
 ? ()
	`lua_gc
(£rvî.lua,
LUA_GCCOUNT
,0)*1024 : 0;

4091 
ªdisMemOvîhód
 *
mh
 = 
	`gëMem‹yOvîhódD©a
();

4097 i‡(
zmÆloc_u£d
 > 
£rvî
.
°©_≥ak_mem‹y
)

4098 
£rvî
.
°©_≥ak_mem‹y
 = 
zmÆloc_u£d
;

4100 
	`byãsToHum™
(
hmem
,
zmÆloc_u£d
);

4101 
	`byãsToHum™
(
≥ak_hmem
,
£rvî
.
°©_≥ak_mem‹y
);

4102 
	`byãsToHum™
(
tŸÆ_sy°em_hmem
,
tŸÆ_sy°em_mem
);

4103 
	`byãsToHum™
(
u£d_mem‹y_lua_hmem
,
mem‹y_lua
);

4104 
	`byãsToHum™
(
u£d_mem‹y_s¸ùts_hmem
,
mh
->
lua_ˇches
);

4105 
	`byãsToHum™
(
u£d_mem‹y_rss_hmem
,
£rvî
.
¸⁄_mÆloc_°©s
.
¥o˚ss_rss
);

4106 
	`byãsToHum™
(
maxmem‹y_hmem
,
£rvî
.
maxmem‹y
);

4108 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4109 
öfo
 = 
	`sdsˇçrötf
(info,

4151 
zmÆloc_u£d
,

4152 
hmem
,

4153 
£rvî
.
¸⁄_mÆloc_°©s
.
¥o˚ss_rss
,

4154 
u£d_mem‹y_rss_hmem
,

4155 
£rvî
.
°©_≥ak_mem‹y
,

4156 
≥ak_hmem
,

4157 
mh
->
≥ak_≥rc
,

4158 
mh
->
ovîhód_tŸÆ
,

4159 
mh
->
°¨tup_Æloˇãd
,

4160 
mh
->
d©a£t
,

4161 
mh
->
d©a£t_≥rc
,

4162 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_Æloˇãd
,

4163 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_a˘ive
,

4164 
£rvî
.
¸⁄_mÆloc_°©s
.
Æloˇt‹_ªsidít
,

4165 ()
tŸÆ_sy°em_mem
,

4166 
tŸÆ_sy°em_hmem
,

4167 
mem‹y_lua
,

4168 
u£d_mem‹y_lua_hmem
,

4169 (Ë
mh
->
lua_ˇches
,

4170 
u£d_mem‹y_s¸ùts_hmem
,

4171 
	`di˘Size
(
£rvî
.
lua_s¸ùts
),

4172 
£rvî
.
maxmem‹y
,

4173 
maxmem‹y_hmem
,

4174 
evi˘_pﬁicy
,

4175 
mh
->
Æloˇt‹_‰ag
,

4176 
mh
->
Æloˇt‹_‰ag_byãs
,

4177 
mh
->
Æloˇt‹_rss
,

4178 
mh
->
Æloˇt‹_rss_byãs
,

4179 
mh
->
rss_exåa
,

4180 
mh
->
rss_exåa_byãs
,

4181 
mh
->
tŸÆ_‰ag
,

4185 
mh
->
tŸÆ_‰ag_byãs
,

4186 
	`‰ìMem‹yGëNŸCou¡edMem‹y
(),

4187 
mh
->
ª∂_backlog
,

4188 
mh
->
˛õ¡s_¶aves
,

4189 
mh
->
˛õ¡s_n‹mÆ
,

4190 
mh
->
aof_buf„r
,

4191 
ZMALLOC_LIB
,

4192 
£rvî
.
a˘ive_de‰ag_ru¬ög
,

4193 
	`œzy‰ìGëPídögObje˘sCou¡
()

4195 
	`‰ìMem‹yOvîhódD©a
(
mh
);

4199 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"persistence")) {

4200 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4201 
öfo
 = 
	`sdsˇçrötf
(info,

4221 
£rvî
.
lﬂdög
,

4222 
£rvî
.
dúty
,

4223 
£rvî
.
rdb_chûd_pid
 != -1,

4224 (
ötmax_t
)
£rvî
.
œ°ßve
,

4225 (
£rvî
.
œ°bgßve_°©us
 =
C_OK
) ? "ok" : "err",

4226 (
ötmax_t
)
£rvî
.
rdb_ßve_time_œ°
,

4227 (
ötmax_t
)((
£rvî
.
rdb_chûd_pid
 == -1) ?

4228 -1 : 
	`time
(
NULL
)-
£rvî
.
rdb_ßve_time_°¨t
),

4229 
£rvî
.
°©_rdb_cow_byãs
,

4230 
£rvî
.
aof_°©e
 !
AOF_OFF
,

4231 
£rvî
.
aof_chûd_pid
 != -1,

4232 
£rvî
.
aof_ªwrôe_scheduÀd
,

4233 (
ötmax_t
)
£rvî
.
aof_ªwrôe_time_œ°
,

4234 (
ötmax_t
)((
£rvî
.
aof_chûd_pid
 == -1) ?

4235 -1 : 
	`time
(
NULL
)-
£rvî
.
aof_ªwrôe_time_°¨t
),

4236 (
£rvî
.
aof_œ°bgªwrôe_°©us
 =
C_OK
) ? "ok" : "err",

4237 (
£rvî
.
aof_œ°_wrôe_°©us
 =
C_OK
) ? "ok" : "err",

4238 
£rvî
.
°©_aof_cow_byãs
,

4239 
£rvî
.
moduÀ_chûd_pid
 != -1,

4240 
£rvî
.
°©_moduÀ_cow_byãs
);

4242 i‡(
£rvî
.
aof_íabÀd
) {

4243 
öfo
 = 
	`sdsˇçrötf
(info,

4251 (Ë
£rvî
.
aof_cuºít_size
,

4252 (Ë
£rvî
.
aof_ªwrôe_ba£_size
,

4253 
£rvî
.
aof_ªwrôe_scheduÀd
,

4254 
	`sd¶í
(
£rvî
.
aof_buf
),

4255 
	`aofRewrôeBuf„rSize
(),

4256 
	`bioPídögJobsOfTy≥
(
BIO_AOF_FSYNC
),

4257 
£rvî
.
aof_dñayed_fsync
);

4260 i‡(
£rvî
.
lﬂdög
) {

4261 
≥rc
;

4262 
time_t
 
ëa
, 
ñ≠£d
;

4263 
off_t
 
ªmaöög_byãs
 = 
£rvî
.
lﬂdög_tŸÆ_byãs
-

4264 
£rvî
.
lﬂdög_lﬂded_byãs
;

4266 
≥rc
 = (()
£rvî
.
lﬂdög_lﬂded_byãs
 /

4267 (
£rvî
.
lﬂdög_tŸÆ_byãs
+1)) * 100;

4269 
ñ≠£d
 = 
	`time
(
NULL
)-
£rvî
.
lﬂdög_°¨t_time
;

4270 i‡(
ñ≠£d
 == 0) {

4271 
ëa
 = 1;

4274 
ëa
 = (
ñ≠£d
*
ªmaöög_byãs
)/(
£rvî
.
lﬂdög_lﬂded_byãs
+1);

4277 
öfo
 = 
	`sdsˇçrötf
(info,

4283 (
ötmax_t
Ë
£rvî
.
lﬂdög_°¨t_time
,

4284 (Ë
£rvî
.
lﬂdög_tŸÆ_byãs
,

4285 (Ë
£rvî
.
lﬂdög_lﬂded_byãs
,

4286 
≥rc
,

4287 (
ötmax_t
)
ëa


4293 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"stats")) {

4294 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4295 
öfo
 = 
	`sdsˇçrötf
(info,

4328 
£rvî
.
°©_numc⁄√˘i⁄s
,

4329 
£rvî
.
°©_numcomm™ds
,

4330 
	`gëIn°™è√ousMëric
(
STATS_METRIC_COMMAND
),

4331 
£rvî
.
°©_√t_öput_byãs
,

4332 
£rvî
.
°©_√t_ouçut_byãs
,

4333 ()
	`gëIn°™è√ousMëric
(
STATS_METRIC_NET_INPUT
)/1024,

4334 ()
	`gëIn°™è√ousMëric
(
STATS_METRIC_NET_OUTPUT
)/1024,

4335 
£rvî
.
°©_ªje˘ed_c⁄n
,

4336 
£rvî
.
°©_sync_fuŒ
,

4337 
£rvî
.
°©_sync_∑πül_ok
,

4338 
£rvî
.
°©_sync_∑πül_îr
,

4339 
£rvî
.
°©_expúedkeys
,

4340 
£rvî
.
°©_expúed_°Æe_≥rc
*100,

4341 
£rvî
.
°©_expúed_time_ˇp_ªached_cou¡
,

4342 
£rvî
.
°©_expúe_cy˛e_time_u£d
/1000,

4343 
£rvî
.
°©_evi˘edkeys
,

4344 
£rvî
.
°©_key•a˚_hôs
,

4345 
£rvî
.
°©_key•a˚_mis£s
,

4346 
	`di˘Size
(
£rvî
.
pubsub_ch™√ls
),

4347 
	`li°Lígth
(
£rvî
.
pubsub_∑âîns
),

4348 
£rvî
.
°©_f‹k_time
,

4349 
	`di˘Size
(
£rvî
.
migøã_ˇched_sockës
),

4350 
	`gëSœveKeyWôhExpúeCou¡
(),

4351 
£rvî
.
°©_a˘ive_de‰ag_hôs
,

4352 
£rvî
.
°©_a˘ive_de‰ag_mis£s
,

4353 
£rvî
.
°©_a˘ive_de‰ag_key_hôs
,

4354 
£rvî
.
°©_a˘ive_de‰ag_key_mis£s
,

4355 (Ë
	`åackögGëTŸÆKeys
(),

4356 (Ë
	`åackögGëTŸÆIãms
(),

4357 (Ë
	`åackögGëTŸÆPªfixes
(),

4358 
£rvî
.
°©_u√x≥˘ed_îr‹_ª∂õs
);

4362 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"replication")) {

4363 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4364 
öfo
 = 
	`sdsˇçrötf
(info,

4367 
£rvî
.
ma°îho°
 =
NULL
 ? "master" : "slave");

4368 i‡(
£rvî
.
ma°îho°
) {

4369 
¶ave_ª∂_off£t
 = 1;

4371 i‡(
£rvî
.
ma°î
)

4372 
¶ave_ª∂_off£t
 = 
£rvî
.
ma°î
->
ª∂off
;

4373 i‡(
£rvî
.
ˇched_ma°î
)

4374 
¶ave_ª∂_off£t
 = 
£rvî
.
ˇched_ma°î
->
ª∂off
;

4376 
öfo
 = 
	`sdsˇçrötf
(info,

4383 ,
£rvî
.
ma°îho°
,

4384 
£rvî
.
ma°îp‹t
,

4385 (
£rvî
.
ª∂_°©e
 =
REPL_STATE_CONNECTED
) ?

4387 
£rvî
.
ma°î
 ?

4388 (()(
£rvî
.
unixtime
-£rvî.
ma°î
->
œ°öãø˘i⁄
)) : -1,

4389 
£rvî
.
ª∂_°©e
 =
REPL_STATE_TRANSFER
,

4390 
¶ave_ª∂_off£t


4393 i‡(
£rvî
.
ª∂_°©e
 =
REPL_STATE_TRANSFER
) {

4394 
öfo
 = 
	`sdsˇçrötf
(info,

4398 (
£rvî
.
ª∂_å™s„r_size
 - sîvî.
ª∂_å™s„r_ªad
),

4399 ()(
£rvî
.
unixtime
-£rvî.
ª∂_å™s„r_œ°io
)

4403 i‡(
£rvî
.
ª∂_°©e
 !
REPL_STATE_CONNECTED
) {

4404 
öfo
 = 
	`sdsˇçrötf
(info,

4406 (
ötmax_t
)(
£rvî
.
unixtime
-£rvî.
ª∂_down_sö˚
));

4408 
öfo
 = 
	`sdsˇçrötf
(info,

4411 
£rvî
.
¶ave_¥i‹ôy
,

4412 
£rvî
.
ª∂_¶ave_ro
);

4415 
öfo
 = 
	`sdsˇçrötf
(info,

4417 
	`li°Lígth
(
£rvî
.
¶aves
));

4421 i‡(
£rvî
.
ª∂_mö_¶aves_to_wrôe
 &&

4422 
£rvî
.
ª∂_mö_¶aves_max_œg
) {

4423 
öfo
 = 
	`sdsˇçrötf
(info,

4425 
£rvî
.
ª∂_good_¶aves_cou¡
);

4428 i‡(
	`li°Lígth
(
£rvî
.
¶aves
)) {

4429 
¶aveid
 = 0;

4430 
li°Node
 *
 
;

4431 
li°Iãr
 
li
;

4433 
	`li°Rewöd
(
£rvî
.
¶aves
,&
li
);

4434 (
 
 = 
	`li°Next
(&
li
))) {

4435 
˛õ¡
 *
¶ave
 = 
	`li°NodeVÆue
(
 
);

4436 *
°©e
 = 
NULL
;

4437 
ù
[
NET_IP_STR_LEN
], *
¶aveù
 = 
¶ave
->
¶ave_ù
;

4438 
p‹t
;

4439 
œg
 = 0;

4441 i‡(
¶aveù
[0] == '\0') {

4442 i‡(
	`c⁄nPìrToSåög
(
¶ave
->
c⁄n
,
ù
,(ù),&
p‹t
) == -1)

4444 
¶aveù
 = 
ù
;

4446 
¶ave
->
ª∂°©e
) {

4447 
SLAVE_STATE_WAIT_BGSAVE_START
:

4448 
SLAVE_STATE_WAIT_BGSAVE_END
:

4449 
°©e
 = "wait_bgsave";

4451 
SLAVE_STATE_SEND_BULK
:

4452 
°©e
 = "send_bulk";

4454 
SLAVE_STATE_ONLINE
:

4455 
°©e
 = "online";

4458 i‡(
°©e
 =
NULL
) ;

4459 i‡(
¶ave
->
ª∂°©e
 =
SLAVE_STATE_ONLINE
)

4460 
œg
 = 
	`time
(
NULL
Ë- 
¶ave
->
ª∂_ack_time
;

4462 
öfo
 = 
	`sdsˇçrötf
(info,

4465 
¶aveid
,
¶aveù
,
¶ave
->
¶ave_li°íög_p‹t
,
°©e
,

4466 
¶ave
->
ª∂_ack_off
, 
œg
);

4467 
¶aveid
++;

4470 
öfo
 = 
	`sdsˇçrötf
(info,

4480 
£rvî
.
ª∂id
,

4481 
£rvî
.
ª∂id2
,

4482 
£rvî
.
ma°î_ª∂_off£t
,

4483 
£rvî
.
ma°î_ª∂_mónögful_off£t
,

4484 
£rvî
.
£c⁄d_ª∂id_off£t
,

4485 
£rvî
.
ª∂_backlog
 !
NULL
,

4486 
£rvî
.
ª∂_backlog_size
,

4487 
£rvî
.
ª∂_backlog_off
,

4488 
£rvî
.
ª∂_backlog_hi°Àn
);

4492 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"cpu")) {

4493 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4494 
öfo
 = 
	`sdsˇçrötf
(info,

4500 ()
£lf_ru
.
ru_°ime
.
tv_£c
, ()£lf_ru.ru_°ime.
tv_u£c
,

4501 ()
£lf_ru
.
ru_utime
.
tv_£c
, ()£lf_ru.ru_utime.
tv_u£c
,

4502 ()
c_ru
.
ru_°ime
.
tv_£c
, ()c_ru.ru_°ime.
tv_u£c
,

4503 ()
c_ru
.
ru_utime
.
tv_£c
, ()c_ru.ru_utime.
tv_u£c
);

4507 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"modules")) {

4508 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4509 
öfo
 = 
	`sdsˇçrötf
(info,"# Modules\r\n");

4510 
öfo
 = 
	`gíModuÀsInfoSåög
(info);

4514 i‡(
Æl£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"commandstats")) {

4515 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4516 
öfo
 = 
	`sdsˇçrötf
(info, "# Commandstats\r\n");

4518 
ªdisComm™d
 *
c
;

4519 
di˘E¡ry
 *
de
;

4520 
di˘Iãøt‹
 *
di
;

4521 
di
 = 
	`di˘GëSa„Iãøt‹
(
£rvî
.
comm™ds
);

4522 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

4523 
c
 = (
ªdisComm™d
 *Ë
	`di˘GëVÆ
(
de
);

4524 i‡(!
c
->
ˇŒs
) ;

4525 
öfo
 = 
	`sdsˇçrötf
(info,

4527 
c
->
«me
, c->
ˇŒs
, c->
mi¸o£c⁄ds
,

4528 (
c
->
ˇŒs
 =0Ë? 0 : (()c->
mi¸o£c⁄ds
/c->calls));

4530 
	`di˘Rñó£Iãøt‹
(
di
);

4534 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"cluster")) {

4535 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4536 
öfo
 = 
	`sdsˇçrötf
(info,

4539 
£rvî
.
˛u°î_íabÀd
);

4543 i‡(
Æl£˘i⁄s
 || 
def£˘i⁄s
 || !
	`°rˇ£cmp
(
£˘i⁄
,"keyspace")) {

4544 i‡(
£˘i⁄s
++Ë
öfo
 = 
	`sdsˇt
(info,"\r\n");

4545 
öfo
 = 
	`sdsˇçrötf
(info, "# Keyspace\r\n");

4546 
j
 = 0; j < 
£rvî
.
dbnum
; j++) {

4547 
keys
, 
vkeys
;

4549 
keys
 = 
	`di˘Size
(
£rvî
.
db
[
j
].
di˘
);

4550 
vkeys
 = 
	`di˘Size
(
£rvî
.
db
[
j
].
expúes
);

4551 i‡(
keys
 || 
vkeys
) {

4552 
öfo
 = 
	`sdsˇçrötf
(info,

4554 
j
, 
keys
, 
vkeys
, 
£rvî
.
db
[j].
avg_âl
);

4562 i‡(
evîythög
 || 
moduÀs
 ||

4563 (!
Æl£˘i⁄s
 && !
def£˘i⁄s
 && 
£˘i⁄s
==0)) {

4564 
öfo
 = 
	`moduÀsCﬁÀ˘Info
(info,

4565 
evîythög
 || 
moduÀs
 ? 
NULL
: 
£˘i⁄
,

4567 
£˘i⁄s
);

4569  
öfo
;

4570 
	}
}

4572 
	$öfoComm™d
(
˛õ¡
 *
c
) {

4573 *
£˘i⁄
 = 
c
->
¨gc
 =2 ? c->
¨gv
[1]->
±r
 : "default";

4575 i‡(
c
->
¨gc
 > 2) {

4576 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

4579 
sds
 
öfo
 = 
	`gíRedisInfoSåög
(
£˘i⁄
);

4580 
	`addRïlyVîb©im
(
c
,
öfo
,
	`sd¶í
(info),"txt");

4581 
	`sds‰ì
(
öfo
);

4582 
	}
}

4584 
	$m⁄ô‹Comm™d
(
˛õ¡
 *
c
) {

4586 i‡(
c
->
Êags
 & 
CLIENT_SLAVE
) ;

4588 
c
->
Êags
 |(
CLIENT_SLAVE
|
CLIENT_MONITOR
);

4589 
	`li°AddNodeTaû
(
£rvî
.
m⁄ô‹s
,
c
);

4590 
	`addRïly
(
c
,
sh¨ed
.
ok
);

4591 
	}
}

4595 #ifde‡
__löux__


4596 
	$löuxOvîcommôMem‹yVÆue
() {

4597 
FILE
 *
Â
 = 
	`f›í
("/proc/sys/vm/overcommit_memory","r");

4598 
buf
[64];

4600 i‡(!
Â
)  -1;

4601 i‡(
	`fgës
(
buf
,64,
Â
Ë=
NULL
) {

4602 
	`f˛o£
(
Â
);

4605 
	`f˛o£
(
Â
);

4607  
	`©oi
(
buf
);

4608 
	}
}

4610 
	$löuxMem‹yW¨nögs
() {

4611 i‡(
	`löuxOvîcommôMem‹yVÆue
() == 0) {

4612 
	`£rvîLog
(
LL_WARNING
,"WARNING overcommit_memory is setÅo 0! Background save may fail underÜow memory condition. To fixÅhis issueádd 'vm.overcommit_memory = 1'Åo /etc/sysctl.confándÅhenÑeboot orÑunÅhe command 'sysctl vm.overcommit_memory=1' forÅhisÅoÅakeÉffect.");

4614 i‡(
	`THPIsE«bÀd
()) {

4615 
	`£rvîLog
(
LL_WARNING
,"WARNING you have Transparent Huge Pages (THP) supportÉnabled in your kernel. This will createÜatencyánd memory usage issues with Redis. To fixÅhis issueÑunÅhe command 'echoÇever > /sys/kernel/mm/transparent_hugepage/enabled'ásÑoot,ándádd itÅo your /etc/rc.local in orderÅoÑetainÅhe settingáfteráÑeboot. Redis must beÑestartedáfter THP is disabled.");

4617 
	}
}

4620 
	$¸óãPidFûe
() {

4623 i‡(!
£rvî
.
pidfûe
Ë£rvî.pidfûê
	`z°rdup
(
CONFIG_DEFAULT_PID_FILE
);

4626 
FILE
 *
Â
 = 
	`f›í
(
£rvî
.
pidfûe
,"w");

4627 i‡(
Â
) {

4628 
	`Ârötf
(
Â
,"%d\n",()
	`gëpid
());

4629 
	`f˛o£
(
Â
);

4631 
	}
}

4633 
	$d´m⁄ize
() {

4634 
fd
;

4636 i‡(
	`f‹k
(Ë!0Ë
	`exô
(0);

4637 
	`£tsid
();

4642 i‡((
fd
 = 
	`›í
("/dev/nuŒ", 
O_RDWR
, 0)) != -1) {

4643 
	`dup2
(
fd
, 
STDIN_FILENO
);

4644 
	`dup2
(
fd
, 
STDOUT_FILENO
);

4645 
	`dup2
(
fd
, 
STDERR_FILENO
);

4646 i‡(
fd
 > 
STDERR_FILENO
Ë
	`˛o£
(fd);

4648 
	}
}

4650 
	$vîsi⁄
() {

4651 
	`¥ötf
("Redis server v=%s sha=%s:%d malloc=%s bits=%d build=%llx\n",

4652 
REDIS_VERSION
,

4653 
	`ªdisGôSHA1
(),

4654 
	`©oi
(
	`ªdisGôDúty
()) > 0,

4655 
ZMALLOC_LIB
,

4657 (Ë
	`ªdisBuûdId
());

4658 
	`exô
(0);

4659 
	}
}

4661 
	$ußge
() {

4662 
	`Ârötf
(
°dîr
,"Usage: ./redis-server [/path/to/redis.conf] [options]\n");

4663 
	`Ârötf
(
°dîr
," ./redis-server - (read config from stdin)\n");

4664 
	`Ârötf
(
°dîr
," ./redis-server -v or --version\n");

4665 
	`Ârötf
(
°dîr
," ./redis-server -h or --help\n");

4666 
	`Ârötf
(
°dîr
," ./redis-server --test-memory <megabytes>\n\n");

4667 
	`Ârötf
(
°dîr
,"Examples:\n");

4668 
	`Ârötf
(
°dîr
," ./redis-server (runÅhe server with default conf)\n");

4669 
	`Ârötf
(
°dîr
," ./redis-server /etc/redis/6379.conf\n");

4670 
	`Ârötf
(
°dîr
," ./redis-server --port 7777\n");

4671 
	`Ârötf
(
°dîr
," ./redis-server --port 7777 --replicaof 127.0.0.1 8888\n");

4672 
	`Ârötf
(
°dîr
," ./redis-server /etc/myredis.conf --loglevel verbose\n\n");

4673 
	`Ârötf
(
°dîr
,"Sentinel mode:\n");

4674 
	`Ârötf
(
°dîr
," ./redis-server /etc/sentinel.conf --sentinel\n");

4675 
	`exô
(1);

4676 
	}
}

4678 
	$ªdisAsciiAπ
() {

4679 
	~"asciûogo.h
"

4680 *
buf
 = 
	`zmÆloc
(1024*16);

4681 *
mode
;

4683 i‡(
£rvî
.
˛u°î_íabÀd
Ë
mode
 = "cluster";

4684 i‡(
£rvî
.
£¡öñ_mode
Ë
mode
 = "sentinel";

4685 
mode
 = "standalone";

4690 
show_logo
 = ((!
£rvî
.
sy¶og_íabÀd
 &&

4691 
£rvî
.
logfûe
[0] == '\0' &&

4692 
	`ißây
(
	`fûío
(
°dout
))) ||

4693 
£rvî
.
Æways_show_logo
);

4695 i‡(!
show_logo
) {

4696 
	`£rvîLog
(
LL_NOTICE
,

4698 
mode
, 
£rvî
.
p‹t
 ? sîvî.p‹à: sîvî.
és_p‹t


4701 
	`¢¥ötf
(
buf
,1024*16,
ascii_logo
,

4702 
REDIS_VERSION
,

4703 
	`ªdisGôSHA1
(),

4704 
	`°πﬁ
(
	`ªdisGôDúty
(),
NULL
,10) > 0,

4706 
mode
, 
£rvî
.
p‹t
 ? sîvî.p‹à: sîvî.
és_p‹t
,

4707 (Ë
	`gëpid
()

4709 
	`£rvîLogRaw
(
LL_NOTICE
|
LL_RAW
,
buf
);

4711 
	`z‰ì
(
buf
);

4712 
	}
}

4714 
	$sigShutdownH™dÀr
(
sig
) {

4715 *
msg
;

4717 
sig
) {

4718 
SIGINT
:

4719 
msg
 = "Received SIGINT scheduling shutdown...";

4721 
SIGTERM
:

4722 
msg
 = "Received SIGTERM scheduling shutdown...";

4725 
msg
 = "Received shutdown signal, scheduling shutdown...";

4732 i‡(
£rvî
.
shutdown_aßp
 && 
sig
 =
SIGINT
) {

4733 
	`£rvîLogFromH™dÀr
(
LL_WARNING
, "You insist...ÉxitingÇow.");

4734 
	`rdbRemoveTempFûe
(
	`gëpid
());

4735 
	`exô
(1);

4736 } i‡(
£rvî
.
lﬂdög
) {

4737 
	`£rvîLogFromH™dÀr
(
LL_WARNING
, "Received shutdown signal duringÜoading,ÉxitingÇow.");

4738 
	`exô
(0);

4741 
	`£rvîLogFromH™dÀr
(
LL_WARNING
, 
msg
);

4742 
£rvî
.
shutdown_aßp
 = 1;

4743 
	}
}

4745 
	$£tupSig«lH™dÀrs
() {

4746 
siga˘i⁄
 
a˘
;

4750 
	`sigem±y£t
(&
a˘
.
ß_mask
);

4751 
a˘
.
ß_Êags
 = 0;

4752 
a˘
.
ß_h™dÀr
 = 
sigShutdownH™dÀr
;

4753 
	`siga˘i⁄
(
SIGTERM
, &
a˘
, 
NULL
);

4754 
	`siga˘i⁄
(
SIGINT
, &
a˘
, 
NULL
);

4756 #ifde‡
HAVE_BACKTRACE


4757 
	`sigem±y£t
(&
a˘
.
ß_mask
);

4758 
a˘
.
ß_Êags
 = 
SA_NODEFER
 | 
SA_RESETHAND
 | 
SA_SIGINFO
;

4759 
a˘
.
ß_siga˘i⁄
 = 
sig£gvH™dÀr
;

4760 
	`siga˘i⁄
(
SIGSEGV
, &
a˘
, 
NULL
);

4761 
	`siga˘i⁄
(
SIGBUS
, &
a˘
, 
NULL
);

4762 
	`siga˘i⁄
(
SIGFPE
, &
a˘
, 
NULL
);

4763 
	`siga˘i⁄
(
SIGILL
, &
a˘
, 
NULL
);

4766 
	}
}

4772 
	$sigKûlChûdH™dÀr
(
sig
) {

4773 
	`UNUSED
(
sig
);

4774 
	`£rvîLogFromH™dÀr
(
LL_WARNING
, "Received SIGUSR1 in child,ÉxitingÇow.");

4775 
	`exôFromChûd
(
SERVER_CHILD_NOERROR_RETVAL
);

4776 
	}
}

4778 
	$£tupChûdSig«lH™dÀrs
() {

4779 
siga˘i⁄
 
a˘
;

4783 
	`sigem±y£t
(&
a˘
.
ß_mask
);

4784 
a˘
.
ß_Êags
 = 0;

4785 
a˘
.
ß_h™dÀr
 = 
sigKûlChûdH™dÀr
;

4786 
	`siga˘i⁄
(
SIGUSR1
, &
a˘
, 
NULL
);

4788 
	}
}

4790 
	$ªdisF‹k
() {

4791 
chûdpid
;

4792 
°¨t
 = 
	`u°ime
();

4793 i‡((
chûdpid
 = 
	`f‹k
()) == 0) {

4795 
	`˛o£Li°íögSockës
(0);

4796 
	`£tupChûdSig«lH™dÀrs
();

4799 
£rvî
.
°©_f‹k_time
 = 
	`u°ime
()-
°¨t
;

4800 
£rvî
.
°©_f‹k_øã
 = (Ë
	`zmÆloc_u£d_mem‹y
(Ë* 1000000 / sîvî.
°©_f‹k_time
 / (1024*1024*1024);

4801 
	`œãncyAddSam∂eIfNìded
("f‹k",
£rvî
.
°©_f‹k_time
/1000);

4802 i‡(
chûdpid
 == -1) {

4805 
	`upd©eDi˘ResizePﬁicy
();

4807  
chûdpid
;

4808 
	}
}

4810 
	$£ndChûdCOWInfo
(
±y≥
, *
≤ame
) {

4811 
size_t
 
¥iv©e_dúty
 = 
	`zmÆloc_gë_¥iv©e_dúty
(-1);

4813 i‡(
¥iv©e_dúty
) {

4814 
	`£rvîLog
(
LL_NOTICE
,

4816 
≤ame
, 
¥iv©e_dúty
/(1024*1024));

4819 
£rvî
.
chûd_öfo_d©a
.
cow_size
 = 
¥iv©e_dúty
;

4820 
	`£ndChûdInfo
(
±y≥
);

4821 
	}
}

4823 
memã°
(
size_t
 
megabyãs
, 
∑s£s
);

4827 
	$checkF‹SítöñMode
(
¨gc
, **
¨gv
) {

4828 
j
;

4830 i‡(
	`°r°r
(
¨gv
[0],"ªdis-£¡öñ"Ë!
NULL
)  1;

4831 
j
 = 1; j < 
¨gc
; j++)

4832 i‡(!
	`°rcmp
(
¨gv
[
j
],"--sentinel"))  1;

4834 
	}
}

4837 
	$lﬂdD©aFromDisk
() {

4838 
°¨t
 = 
	`u°ime
();

4839 i‡(
£rvî
.
aof_°©e
 =
AOF_ON
) {

4840 i‡(
	`lﬂdAµídO∆yFûe
(
£rvî
.
aof_fûíame
Ë=
C_OK
)

4841 
	`£rvîLog
(
LL_NOTICE
,"DBÜﬂded fromáµíd o∆y fûe: %.3‡£c⁄ds",()(
	`u°ime
()-
°¨t
)/1000000);

4843 
rdbSaveInfo
 
rsi
 = 
RDB_SAVE_INFO_INIT
;

4844 i‡(
	`rdbLﬂd
(
£rvî
.
rdb_fûíame
,&
rsi
,
RDBFLAGS_NONE
Ë=
C_OK
) {

4845 
	`£rvîLog
(
LL_NOTICE
,"DBÜoaded from disk: %.3f seconds",

4846 ()(
	`u°ime
()-
°¨t
)/1000000);

4849 i‡((
£rvî
.
ma°îho°
 ||

4850 (
£rvî
.
˛u°î_íabÀd
 &&

4851 
	`nodeIsSœve
(
£rvî
.
˛u°î
->
my£lf
))) &&

4852 
rsi
.
ª∂_id_is_£t
 &&

4853 
rsi
.
ª∂_off£t
 != -1 &&

4857 
rsi
.
ª∂_°ªam_db
 != -1)

4859 
	`mem˝y
(
£rvî
.
ª∂id
,
rsi
.
ª∂_id
,(server.replid));

4860 
£rvî
.
ma°î_ª∂_off£t
 = 
rsi
.
ª∂_off£t
;

4861 
£rvî
.
ma°î_ª∂_mónögful_off£t
 = 
rsi
.
ª∂_off£t
;

4865 
	`ª∂iˇti⁄CacheMa°îUsögMy£lf
();

4866 
	`£À˘Db
(
£rvî
.
ˇched_ma°î
,
rsi
.
ª∂_°ªam_db
);

4868 } i‡(
î∫o
 !
ENOENT
) {

4869 
	`£rvîLog
(
LL_WARNING
,"F©ÆÉº‹ÜﬂdögÅhêDB: %s. Exôög.",
	`°ªº‹
(
î∫o
));

4870 
	`exô
(1);

4873 
	}
}

4875 
	$ªdisOutOfMem‹yH™dÀr
(
size_t
 
Æloˇti⁄_size
) {

4876 
	`£rvîLog
(
LL_WARNING
,"Out Of Memoryállocating %zu bytes!",

4877 
Æloˇti⁄_size
);

4878 
	`£rvîP™ic
("Redisáborting for OUT OF MEMORY");

4879 
	}
}

4881 
	$ªdisSëProcTôÀ
(*
tôÀ
) {

4882 #ifde‡
USE_SETPROCTITLE


4883 *
£rvî_mode
 = "";

4884 i‡(
£rvî
.
˛u°î_íabÀd
Ë
£rvî_mode
 = " [cluster]";

4885 i‡(
£rvî
.
£¡öñ_mode
Ë
£rvî_mode
 = " [sentinel]";

4887 
	`£çro˘ôÀ
("%s %s:%d%s",

4888 
tôÀ
,

4889 
£rvî
.
bödaddr_cou¡
 ? sîvî.
bödaddr
[0] : "*",

4890 
£rvî
.
p‹t
 ? sîvî.p‹à: sîvî.
és_p‹t
,

4891 
£rvî_mode
);

4893 
	`UNUSED
(
tôÀ
);

4895 
	}
}

4897 
	$ªdisSëCpuAfföôy
(c⁄° *
˝uli°
) {

4898 #ifde‡
USE_SETCPUAFFINITY


4899 
	`£t˝uafföôy
(
˝uli°
);

4901 
	`UNUSED
(
˝uli°
);

4903 
	}
}

4909 
	$ªdisSu≥rvi£dUp°¨t
() {

4910 c⁄° *
up°¨t_job
 = 
	`gëív
("UPSTART_JOB");

4912 i‡(!
up°¨t_job
) {

4913 
	`£rvîLog
(
LL_WARNING
,

4918 
	`£rvîLog
(
LL_NOTICE
, "supervised by upstart, will stopÅo signalÑeadiness");

4919 
	`øi£
(
SIGSTOP
);

4920 
	`un£ãnv
("UPSTART_JOB");

4922 
	}
}

4924 
	$ªdisCommuniˇãSy°emd
(c⁄° *
sd_nŸify_msg
) {

4925 c⁄° *
nŸify_sockë
 = 
	`gëív
("NOTIFY_SOCKET");

4926 i‡(!
nŸify_sockë
) {

4927 
	`£rvîLog
(
LL_WARNING
,

4931 #ifde‡
HAVE_LIBSYSTEMD


4932 (Ë
	`sd_nŸify
(0, 
sd_nŸify_msg
);

4934 
	`UNUSED
(
sd_nŸify_msg
);

4937 
	}
}

4939 
	$ªdisIsSu≥rvi£d
(
mode
) {

4940 i‡(
mode
 =
SUPERVISED_AUTODETECT
) {

4941 c⁄° *
up°¨t_job
 = 
	`gëív
("UPSTART_JOB");

4942 c⁄° *
nŸify_sockë
 = 
	`gëív
("NOTIFY_SOCKET");

4944 i‡(
up°¨t_job
) {

4945 
	`ªdisSu≥rvi£dUp°¨t
();

4946 } i‡(
nŸify_sockë
) {

4947 
£rvî
.
su≥rvi£d_mode
 = 
SUPERVISED_SYSTEMD
;

4948 
	`£rvîLog
(
LL_WARNING
,

4950  
	`ªdisCommuniˇãSy°emd
("STATUS=Redis isÜoading...\n");

4952 } i‡(
mode
 =
SUPERVISED_UPSTART
) {

4953  
	`ªdisSu≥rvi£dUp°¨t
();

4954 } i‡(
mode
 =
SUPERVISED_SYSTEMD
) {

4955 
	`£rvîLog
(
LL_WARNING
,

4957  
	`ªdisCommuniˇãSy°emd
("STATUS=Redis isÜoading...\n");

4961 
	}
}

4963 
	$iAmMa°î
() {

4964  ((!
£rvî
.
˛u°î_íabÀd
 && sîvî.
ma°îho°
 =
NULL
) ||

4965 (
£rvî
.
˛u°î_íabÀd
 && 
	`nodeIsMa°î
(£rvî.
˛u°î
->
my£lf
)));

4966 
	}
}

4969 
	$maö
(
¨gc
, **
¨gv
) {

4970 
timevÆ
 
tv
;

4971 
j
;

4973 #ifde‡
REDIS_TEST


4974 i‡(
¨gc
 =3 && !
	`°rˇ£cmp
(
¨gv
[1], "test")) {

4975 i‡(!
	`°rˇ£cmp
(
¨gv
[2], "ziplist")) {

4976  
	`zùli°Te°
(
¨gc
, 
¨gv
);

4977 } i‡(!
	`°rˇ£cmp
(
¨gv
[2], "quicklist")) {

4978 
	`quickli°Te°
(
¨gc
, 
¨gv
);

4979 } i‡(!
	`°rˇ£cmp
(
¨gv
[2], "intset")) {

4980  
	`öt£tTe°
(
¨gc
, 
¨gv
);

4981 } i‡(!
	`°rˇ£cmp
(
¨gv
[2], "zipmap")) {

4982  
	`zùm≠Te°
(
¨gc
, 
¨gv
);

4983 } i‡(!
	`°rˇ£cmp
(
¨gv
[2], "sha1test")) {

4984  
	`sha1Te°
(
¨gc
, 
¨gv
);

4985 } i‡(!
	`°rˇ£cmp
(
¨gv
[2], "util")) {

4986  
	`utûTe°
(
¨gc
, 
¨gv
);

4987 } i‡(!
	`°rˇ£cmp
(
¨gv
[2], "endianconv")) {

4988  
	`ídünc⁄vTe°
(
¨gc
, 
¨gv
);

4989 } i‡(!
	`°rˇ£cmp
(
¨gv
[2], "crc64")) {

4990  
	`¸c64Te°
(
¨gc
, 
¨gv
);

4991 } i‡(!
	`°rˇ£cmp
(
¨gv
[2], "zmalloc")) {

4992  
	`zmÆloc_ã°
(
¨gc
, 
¨gv
);

5000 #ifde‡
INIT_SETPROCTITLE_REPLACEMENT


5001 
	`•t_öô
(
¨gc
, 
¨gv
);

5003 
	`£éoˇÀ
(
LC_COLLATE
,"");

5004 
	`tz£t
();

5005 
	`zmÆloc_£t_oom_h™dÀr
(
ªdisOutOfMem‹yH™dÀr
);

5006 
	`§™d
(
	`time
(
NULL
)^
	`gëpid
());

5007 
	`gëtimeofday
(&
tv
,
NULL
);

5008 
	`¸c64_öô
();

5010 
uöt8_t
 
hash£ed
[16];

5011 
	`gëR™domByãs
(
hash£ed
,(hashseed));

5012 
	`di˘SëHashFun˘i⁄Sìd
(
hash£ed
);

5013 
£rvî
.
£¡öñ_mode
 = 
	`checkF‹SítöñMode
(
¨gc
,
¨gv
);

5014 
	`öôSîvîC⁄fig
();

5015 
	`ACLInô
();

5017 
	`moduÀInôModuÀsSy°em
();

5018 
	`ésInô
();

5022 
£rvî
.
execuèbÀ
 = 
	`gëAbsﬁuãP©h
(
¨gv
[0]);

5023 
£rvî
.
exec_¨gv
 = 
	`zmÆloc
((*)*(
¨gc
+1));

5024 
£rvî
.
exec_¨gv
[
¨gc
] = 
NULL
;

5025 
j
 = 0; j < 
¨gc
; j++Ë
£rvî
.
exec_¨gv
[j] = 
	`z°rdup
(
¨gv
[j]);

5030 i‡(
£rvî
.
£¡öñ_mode
) {

5031 
	`öôSítöñC⁄fig
();

5032 
	`öôSítöñ
();

5038 i‡(
	`°r°r
(
¨gv
[0],"ªdis-check-rdb"Ë!
NULL
)

5039 
	`ªdis_check_rdb_maö
(
¨gc
,
¨gv
,
NULL
);

5040 i‡(
	`°r°r
(
¨gv
[0],"ªdis-check-aof"Ë!
NULL
)

5041 
	`ªdis_check_aof_maö
(
¨gc
,
¨gv
);

5043 i‡(
¨gc
 >= 2) {

5044 
j
 = 1;

5045 
sds
 
›ti⁄s
 = 
	`sd£m±y
();

5046 *
c⁄figfûe
 = 
NULL
;

5049 i‡(
	`°rcmp
(
¨gv
[1], "-v") == 0 ||

5050 
	`°rcmp
(
¨gv
[1], "--vîsi⁄"Ë=0Ë
	`vîsi⁄
();

5051 i‡(
	`°rcmp
(
¨gv
[1], "--help") == 0 ||

5052 
	`°rcmp
(
¨gv
[1], "-h"Ë=0Ë
	`ußge
();

5053 i‡(
	`°rcmp
(
¨gv
[1], "--test-memory") == 0) {

5054 i‡(
¨gc
 == 3) {

5055 
	`memã°
(
	`©oi
(
¨gv
[2]),50);

5056 
	`exô
(0);

5058 
	`Ârötf
(
°dîr
,"Please specifyÅheámount of memoryÅoÅest in megabytes.\n");

5059 
	`Ârötf
(
°dîr
,"Example: ./redis-server --test-memory 4096\n\n");

5060 
	`exô
(1);

5065 i‡(
¨gv
[
j
][0] != '-' ||árgv[j][1] != '-') {

5066 
c⁄figfûe
 = 
¨gv
[
j
];

5067 
£rvî
.
c⁄figfûe
 = 
	`gëAbsﬁuãP©h
(configfile);

5070 
	`z‰ì
(
£rvî
.
exec_¨gv
[
j
]);

5071 
£rvî
.
exec_¨gv
[
j
] = 
	`z°rdup
(£rvî.
c⁄figfûe
);

5072 
j
++;

5079 
j
 !
¨gc
) {

5080 i‡(
¨gv
[
j
][0] == '-' &&árgv[j][1] == '-') {

5082 i‡(!
	`°rcmp
(
¨gv
[
j
], "--check-rdb")) {

5084 
j
++;

5087 i‡(
	`sd¶í
(
›ti⁄s
)Ë›ti⁄†
	`sdsˇt
(options,"\n");

5088 
›ti⁄s
 = 
	`sdsˇt
(›ti⁄s,
¨gv
[
j
]+2);

5089 
›ti⁄s
 = 
	`sdsˇt
(options," ");

5092 
›ti⁄s
 = 
	`sdsˇåïr
(›ti⁄s,
¨gv
[
j
],
	`°æí
(argv[j]));

5093 
›ti⁄s
 = 
	`sdsˇt
(options," ");

5095 
j
++;

5097 i‡(
£rvî
.
£¡öñ_mode
 && 
c⁄figfûe
 && *configfile == '-') {

5098 
	`£rvîLog
(
LL_WARNING
,

5100 
	`£rvîLog
(
LL_WARNING
,

5102 
	`exô
(1);

5104 
	`ª£tSîvîSaveP¨ams
();

5105 
	`lﬂdSîvîC⁄fig
(
c⁄figfûe
,
›ti⁄s
);

5106 
	`sds‰ì
(
›ti⁄s
);

5109 
	`£rvîLog
(
LL_WARNING
, "oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo");

5110 
	`£rvîLog
(
LL_WARNING
,

5112 
REDIS_VERSION
,

5114 
	`ªdisGôSHA1
(),

5115 
	`°πﬁ
(
	`ªdisGôDúty
(),
NULL
,10) > 0,

5116 ()
	`gëpid
());

5118 i‡(
¨gc
 == 1) {

5119 
	`£rvîLog
(
LL_WARNING
, "W¨nög:Çÿc⁄fig fûê•ecifõd, usögÅhêdeÁu… c⁄fig. I¿‹dîÅÿ•ecifyá c⁄fig fûêu£ %†/∑th/to/%s.c⁄f", 
¨gv
[0], 
£rvî
.
£¡öñ_mode
 ? "sentinel" : "redis");

5121 
	`£rvîLog
(
LL_WARNING
, "ConfigurationÜoaded");

5124 
£rvî
.
su≥rvi£d
 = 
	`ªdisIsSu≥rvi£d
(£rvî.
su≥rvi£d_mode
);

5125 
background
 = 
£rvî
.
d´m⁄ize
 && !£rvî.
su≥rvi£d
;

5126 i‡(
background
Ë
	`d´m⁄ize
();

5128 
	`öôSîvî
();

5129 i‡(
background
 || 
£rvî
.
pidfûe
Ë
	`¸óãPidFûe
();

5130 
	`ªdisSëProcTôÀ
(
¨gv
[0]);

5131 
	`ªdisAsciiAπ
();

5132 
	`checkT˝BacklogSëtögs
();

5134 i‡(!
£rvî
.
£¡öñ_mode
) {

5136 
	`£rvîLog
(
LL_WARNING
,"Server initialized");

5137 #ifde‡
__löux__


5138 
	`löuxMem‹yW¨nögs
();

5140 
	`moduÀLﬂdFromQueue
();

5141 
	`ACLLﬂdU£rsAtSèπup
();

5142 
	`InôSîvîLa°
();

5143 
	`lﬂdD©aFromDisk
();

5144 i‡(
£rvî
.
˛u°î_íabÀd
) {

5145 i‡(
	`vîifyClu°îC⁄figWôhD©a
(Ë=
C_ERR
) {

5146 
	`£rvîLog
(
LL_WARNING
,

5149 
	`exô
(1);

5152 i‡(
£rvî
.
ùfd_cou¡
 > 0 || sîvî.
ésfd_cou¡
 > 0)

5153 
	`£rvîLog
(
LL_NOTICE
,"ReadyÅoáccept connections");

5154 i‡(
£rvî
.
sofd
 > 0)

5155 
	`£rvîLog
(
LL_NOTICE
,"Thê£rvî i†nowÑódyÅÿac˚± c⁄√˘i⁄†© %s", 
£rvî
.
unixsockë
);

5156 i‡(
£rvî
.
su≥rvi£d_mode
 =
SUPERVISED_SYSTEMD
) {

5157 i‡(!
£rvî
.
ma°îho°
) {

5158 
	`ªdisCommuniˇãSy°emd
("STATUS=ReadyÅoáccept connections\n");

5159 
	`ªdisCommuniˇãSy°emd
("READY=1\n");

5161 
	`ªdisCommuniˇãSy°emd
("STATUS=Waiting for MASTER <-> REPLICA sync\n");

5165 
	`InôSîvîLa°
();

5166 
	`£¡öñIsRu¬ög
();

5170 i‡(
£rvî
.
maxmem‹y
 > 0 && server.maxmemory < 1024*1024) {

5171 
	`£rvîLog
(
LL_WARNING
,"WARNING: You s≥cifõdá maxmem‹y vÆuêth© i†Às†th™ 1MB (cuºíàvÆuêi†%Œu byãs). Aª you suªÅhi†i†wh© youÑóŒy w™t?", 
£rvî
.
maxmem‹y
);

5174 
	`ªdisSëCpuAfföôy
(
£rvî
.
£rvî_˝uli°
);

5175 
	`´Maö
(
£rvî
.
ñ
);

5176 
	`´DñëeEvítLo›
(
£rvî
.
ñ
);

5178 
	}
}

	@server.h

30 #i‚de‡
__REDIS_H


31 
	#__REDIS_H


	)

33 
	~"fma¸os.h
"

34 
	~"c⁄fig.h
"

35 
	~"sﬁ¨isfixes.h
"

36 
	~"rio.h
"

38 
	~<°dio.h
>

39 
	~<°dlib.h
>

40 
	~<°rög.h
>

41 
	~<time.h
>

42 
	~<limôs.h
>

43 
	~<uni°d.h
>

44 
	~<î∫o.h
>

45 
	~<öây≥s.h
>

46 
	~<±hªad.h
>

47 
	~<sy¶og.h
>

48 
	~<√töë/ö.h
>

49 
	~<sys/sockë.h
>

50 
	~<lua.h
>

51 
	~<sig«l.h
>

53 #ifde‡
HAVE_LIBSYSTEMD


54 
	~<sy°emd/sd-d´m⁄.h
>

57 
	tm°ime_t
;

58 
	tu°ime_t
;

60 
	~"´.h
"

61 
	~"sds.h
"

62 
	~"di˘.h
"

63 
	~"adli°.h
"

64 
	~"zmÆloc.h
"

65 
	~"™ë.h
"

66 
	~"zùli°.h
"

67 
	~"öt£t.h
"

68 
	~"vîsi⁄.h
"

69 
	~"utû.h
"

70 
	~"œãncy.h
"

71 
	~"•¨klöe.h
"

72 
	~"quickli°.h
"

74 
	~"øx.h
"

75 
	~"c⁄√˘i⁄.h
"

77 
	#REDISMODULE_CORE
 1

	)

78 
	~"ªdismoduÀ.h
"

81 
	~"zùm≠.h
"

82 
	~"sha1.h
"

83 
	~"ídünc⁄v.h
"

84 
	~"¸c64.h
"

87 
	#C_OK
 0

	)

88 
	#C_ERR
 -1

	)

91 
	#CONFIG_DEFAULT_HZ
 10

	)

92 
	#CONFIG_MIN_HZ
 1

	)

93 
	#CONFIG_MAX_HZ
 500

	)

94 
	#MAX_CLIENTS_PER_CLOCK_TICK
 200

	)

95 
	#CONFIG_MAX_LINE
 1024

	)

96 
	#CRON_DBS_PER_CALL
 16

	)

97 
	#NET_MAX_WRITES_PER_EVENT
 (1024*64)

	)

98 
	#PROTO_SHARED_SELECT_CMDS
 10

	)

99 
	#OBJ_SHARED_INTEGERS
 10000

	)

100 
	#OBJ_SHARED_BULKHDR_LEN
 32

	)

101 
	#LOG_MAX_LEN
 1024

	)

102 
	#AOF_REWRITE_ITEMS_PER_CMD
 64

	)

103 
	#AOF_READ_DIFF_INTERVAL_BYTES
 (1024*10)

	)

104 
	#CONFIG_AUTHPASS_MAX_LEN
 512

	)

105 
	#CONFIG_RUN_ID_SIZE
 40

	)

106 
	#RDB_EOF_MARK_SIZE
 40

	)

107 
	#CONFIG_REPL_BACKLOG_MIN_SIZE
 (1024*16Ë

	)

108 
	#CONFIG_BGSAVE_RETRY_DELAY
 5

	)

109 
	#CONFIG_DEFAULT_PID_FILE
 "/v¨/run/ªdis.pid"

	)

110 
	#CONFIG_DEFAULT_CLUSTER_CONFIG_FILE
 "nodes.c⁄f"

	)

111 
	#CONFIG_DEFAULT_UNIX_SOCKET_PERM
 0

	)

112 
	#CONFIG_DEFAULT_LOGFILE
 ""

	)

113 
	#NET_IP_STR_LEN
 46

	)

114 
	#NET_PEER_ID_LEN
 (
NET_IP_STR_LEN
+32Ë

	)

115 
	#CONFIG_BINDADDR_MAX
 16

	)

116 
	#CONFIG_MIN_RESERVED_FDS
 32

	)

118 
	#ACTIVE_EXPIRE_CYCLE_SLOW
 0

	)

119 
	#ACTIVE_EXPIRE_CYCLE_FAST
 1

	)

127 
	#SERVER_CHILD_NOERROR_RETVAL
 255

	)

130 
	#STATS_METRIC_SAMPLES
 16

	)

131 
	#STATS_METRIC_COMMAND
 0

	)

132 
	#STATS_METRIC_NET_INPUT
 1

	)

133 
	#STATS_METRIC_NET_OUTPUT
 2

	)

134 
	#STATS_METRIC_COUNT
 3

	)

137 
	#PROTO_MAX_QUERYBUF_LEN
 (1024*1024*1024Ë

	)

138 
	#PROTO_IOBUF_LEN
 (1024*16Ë

	)

139 
	#PROTO_REPLY_CHUNK_BYTES
 (16*1024Ë

	)

140 
	#PROTO_INLINE_MAX_SIZE
 (1024*64Ë

	)

141 
	#PROTO_MBULK_BIG_ARG
 (1024*32)

	)

142 
	#LONG_STR_SIZE
 21

	)

143 
	#REDIS_AUTOSYNC_BYTES
 (1024*1024*32Ë

	)

145 
	#LIMIT_PENDING_QUERYBUF
 (4*1024*1024Ë

	)

151 
	#CONFIG_FDSET_INCR
 (
CONFIG_MIN_RESERVED_FDS
+96)

	)

154 
	#HASHTABLE_MIN_FILL
 10

	)

158 
	#CMD_WRITE
 (1ULL<<0Ë

	)

159 
	#CMD_READONLY
 (1ULL<<1Ë

	)

160 
	#CMD_DENYOOM
 (1ULL<<2Ë

	)

161 
	#CMD_MODULE
 (1ULL<<3Ë

	)

162 
	#CMD_ADMIN
 (1ULL<<4Ë

	)

163 
	#CMD_PUBSUB
 (1ULL<<5Ë

	)

164 
	#CMD_NOSCRIPT
 (1ULL<<6Ë

	)

165 
	#CMD_RANDOM
 (1ULL<<7Ë

	)

166 
	#CMD_SORT_FOR_SCRIPT
 (1ULL<<8Ë

	)

167 
	#CMD_LOADING
 (1ULL<<9Ë

	)

168 
	#CMD_STALE
 (1ULL<<10Ë

	)

169 
	#CMD_SKIP_MONITOR
 (1ULL<<11Ë

	)

170 
	#CMD_SKIP_SLOWLOG
 (1ULL<<12Ë

	)

171 
	#CMD_ASKING
 (1ULL<<13Ë

	)

172 
	#CMD_FAST
 (1ULL<<14Ë

	)

173 
	#CMD_NO_AUTH
 (1ULL<<15Ë

	)

176 
	#CMD_MODULE_GETKEYS
 (1ULL<<16Ë

	)

177 
	#CMD_MODULE_NO_CLUSTER
 (1ULL<<17Ë

	)

180 
	#CMD_CATEGORY_KEYSPACE
 (1ULL<<18)

	)

181 
	#CMD_CATEGORY_READ
 (1ULL<<19)

	)

182 
	#CMD_CATEGORY_WRITE
 (1ULL<<20)

	)

183 
	#CMD_CATEGORY_SET
 (1ULL<<21)

	)

184 
	#CMD_CATEGORY_SORTEDSET
 (1ULL<<22)

	)

185 
	#CMD_CATEGORY_LIST
 (1ULL<<23)

	)

186 
	#CMD_CATEGORY_HASH
 (1ULL<<24)

	)

187 
	#CMD_CATEGORY_STRING
 (1ULL<<25)

	)

188 
	#CMD_CATEGORY_BITMAP
 (1ULL<<26)

	)

189 
	#CMD_CATEGORY_HYPERLOGLOG
 (1ULL<<27)

	)

190 
	#CMD_CATEGORY_GEO
 (1ULL<<28)

	)

191 
	#CMD_CATEGORY_STREAM
 (1ULL<<29)

	)

192 
	#CMD_CATEGORY_PUBSUB
 (1ULL<<30)

	)

193 
	#CMD_CATEGORY_ADMIN
 (1ULL<<31)

	)

194 
	#CMD_CATEGORY_FAST
 (1ULL<<32)

	)

195 
	#CMD_CATEGORY_SLOW
 (1ULL<<33)

	)

196 
	#CMD_CATEGORY_BLOCKING
 (1ULL<<34)

	)

197 
	#CMD_CATEGORY_DANGEROUS
 (1ULL<<35)

	)

198 
	#CMD_CATEGORY_CONNECTION
 (1ULL<<36)

	)

199 
	#CMD_CATEGORY_TRANSACTION
 (1ULL<<37)

	)

200 
	#CMD_CATEGORY_SCRIPTING
 (1ULL<<38)

	)

203 
	#AOF_OFF
 0

	)

204 
	#AOF_ON
 1

	)

205 
	#AOF_WAIT_REWRITE
 2

	)

208 
	#CLIENT_SLAVE
 (1<<0Ë

	)

209 
	#CLIENT_MASTER
 (1<<1Ë

	)

210 
	#CLIENT_MONITOR
 (1<<2Ë

	)

211 
	#CLIENT_MULTI
 (1<<3Ë

	)

212 
	#CLIENT_BLOCKED
 (1<<4Ë

	)

213 
	#CLIENT_DIRTY_CAS
 (1<<5Ë

	)

214 
	#CLIENT_CLOSE_AFTER_REPLY
 (1<<6Ë

	)

215 
	#CLIENT_UNBLOCKED
 (1<<7Ë

	)

217 
	#CLIENT_LUA
 (1<<8Ë

	)

218 
	#CLIENT_ASKING
 (1<<9Ë

	)

219 
	#CLIENT_CLOSE_ASAP
 (1<<10)

	)

220 
	#CLIENT_UNIX_SOCKET
 (1<<11Ë

	)

221 
	#CLIENT_DIRTY_EXEC
 (1<<12Ë

	)

222 
	#CLIENT_MASTER_FORCE_REPLY
 (1<<13Ë

	)

223 
	#CLIENT_FORCE_AOF
 (1<<14Ë

	)

224 
	#CLIENT_FORCE_REPL
 (1<<15Ë

	)

225 
	#CLIENT_PRE_PSYNC
 (1<<16Ë

	)

226 
	#CLIENT_READONLY
 (1<<17Ë

	)

227 
	#CLIENT_PUBSUB
 (1<<18Ë

	)

228 
	#CLIENT_PREVENT_AOF_PROP
 (1<<19Ë

	)

229 
	#CLIENT_PREVENT_REPL_PROP
 (1<<20Ë

	)

230 
	#CLIENT_PREVENT_PROP
 (
CLIENT_PREVENT_AOF_PROP
|
CLIENT_PREVENT_REPL_PROP
)

	)

231 
	#CLIENT_PENDING_WRITE
 (1<<21Ë

	)

233 
	#CLIENT_REPLY_OFF
 (1<<22Ë

	)

234 
	#CLIENT_REPLY_SKIP_NEXT
 (1<<23Ë

	)

235 
	#CLIENT_REPLY_SKIP
 (1<<24Ë

	)

236 
	#CLIENT_LUA_DEBUG
 (1<<25Ë

	)

237 
	#CLIENT_LUA_DEBUG_SYNC
 (1<<26Ë

	)

238 
	#CLIENT_MODULE
 (1<<27Ë

	)

239 
	#CLIENT_PROTECTED
 (1<<28Ë

	)

240 
	#CLIENT_PENDING_READ
 (1<<29Ë

	)

243 
	#CLIENT_PENDING_COMMAND
 (1<<30Ë

	)

247 
	#CLIENT_TRACKING
 (1ULL<<31Ë

	)

249 
	#CLIENT_TRACKING_BROKEN_REDIR
 (1ULL<<32Ë

	)

250 
	#CLIENT_TRACKING_BCAST
 (1ULL<<33Ë

	)

251 
	#CLIENT_TRACKING_OPTIN
 (1ULL<<34Ë

	)

252 
	#CLIENT_TRACKING_OPTOUT
 (1ULL<<35Ë

	)

253 
	#CLIENT_TRACKING_CACHING
 (1ULL<<36Ë

	)

255 
	#CLIENT_TRACKING_NOLOOP
 (1ULL<<37Ë

	)

257 
	#CLIENT_IN_TO_TABLE
 (1ULL<<38Ë

	)

258 
	#CLIENT_PROTOCOL_ERROR
 (1ULL<<39Ë

	)

262 
	#BLOCKED_NONE
 0

	)

263 
	#BLOCKED_LIST
 1

	)

264 
	#BLOCKED_WAIT
 2

	)

265 
	#BLOCKED_MODULE
 3

	)

266 
	#BLOCKED_STREAM
 4

	)

267 
	#BLOCKED_ZSET
 5

	)

268 
	#BLOCKED_NUM
 6

	)

271 
	#PROTO_REQ_INLINE
 1

	)

272 
	#PROTO_REQ_MULTIBULK
 2

	)

276 
	#CLIENT_TYPE_NORMAL
 0

	)

277 
	#CLIENT_TYPE_SLAVE
 1

	)

278 
	#CLIENT_TYPE_PUBSUB
 2

	)

279 
	#CLIENT_TYPE_MASTER
 3

	)

280 
	#CLIENT_TYPE_COUNT
 4

	)

281 
	#CLIENT_TYPE_OBUF_COUNT
 3

	)

287 
	#REPL_STATE_NONE
 0

	)

288 
	#REPL_STATE_CONNECT
 1

	)

289 
	#REPL_STATE_CONNECTING
 2

	)

291 
	#REPL_STATE_RECEIVE_PONG
 3

	)

292 
	#REPL_STATE_SEND_AUTH
 4

	)

293 
	#REPL_STATE_RECEIVE_AUTH
 5

	)

294 
	#REPL_STATE_SEND_PORT
 6

	)

295 
	#REPL_STATE_RECEIVE_PORT
 7

	)

296 
	#REPL_STATE_SEND_IP
 8

	)

297 
	#REPL_STATE_RECEIVE_IP
 9

	)

298 
	#REPL_STATE_SEND_CAPA
 10

	)

299 
	#REPL_STATE_RECEIVE_CAPA
 11

	)

300 
	#REPL_STATE_SEND_PSYNC
 12

	)

301 
	#REPL_STATE_RECEIVE_PSYNC
 13

	)

303 
	#REPL_STATE_TRANSFER
 14

	)

304 
	#REPL_STATE_CONNECTED
 15

	)

310 
	#SLAVE_STATE_WAIT_BGSAVE_START
 6

	)

311 
	#SLAVE_STATE_WAIT_BGSAVE_END
 7

	)

312 
	#SLAVE_STATE_SEND_BULK
 8

	)

313 
	#SLAVE_STATE_ONLINE
 9

	)

316 
	#SLAVE_CAPA_NONE
 0

	)

317 
	#SLAVE_CAPA_EOF
 (1<<0Ë

	)

318 
	#SLAVE_CAPA_PSYNC2
 (1<<1Ë

	)

321 
	#CONFIG_REPL_SYNCIO_TIMEOUT
 5

	)

324 
	#LIST_HEAD
 0

	)

325 
	#LIST_TAIL
 1

	)

326 
	#ZSET_MIN
 0

	)

327 
	#ZSET_MAX
 1

	)

330 
	#SORT_OP_GET
 0

	)

333 
	#LL_DEBUG
 0

	)

334 
	#LL_VERBOSE
 1

	)

335 
	#LL_NOTICE
 2

	)

336 
	#LL_WARNING
 3

	)

337 
	#LL_RAW
 (1<<10Ë

	)

340 
	#SUPERVISED_NONE
 0

	)

341 
	#SUPERVISED_AUTODETECT
 1

	)

342 
	#SUPERVISED_SYSTEMD
 2

	)

343 
	#SUPERVISED_UPSTART
 3

	)

346 
	#UNUSED
(
V
Ë((ËV)

	)

348 
	#ZSKIPLIST_MAXLEVEL
 32

	)

349 
	#ZSKIPLIST_P
 0.25

	)

352 
	#AOF_FSYNC_NO
 0

	)

353 
	#AOF_FSYNC_ALWAYS
 1

	)

354 
	#AOF_FSYNC_EVERYSEC
 2

	)

357 
	#REPL_DISKLESS_LOAD_DISABLED
 0

	)

358 
	#REPL_DISKLESS_LOAD_WHEN_DB_EMPTY
 1

	)

359 
	#REPL_DISKLESS_LOAD_SWAPDB
 2

	)

362 
	#SET_OP_UNION
 0

	)

363 
	#SET_OP_DIFF
 1

	)

364 
	#SET_OP_INTER
 2

	)

369 
	#MAXMEMORY_FLAG_LRU
 (1<<0)

	)

370 
	#MAXMEMORY_FLAG_LFU
 (1<<1)

	)

371 
	#MAXMEMORY_FLAG_ALLKEYS
 (1<<2)

	)

372 
	#MAXMEMORY_FLAG_NO_SHARED_INTEGERS
 \

373 (
MAXMEMORY_FLAG_LRU
|
MAXMEMORY_FLAG_LFU
)

	)

375 
	#MAXMEMORY_VOLATILE_LRU
 ((0<<8)|
MAXMEMORY_FLAG_LRU
)

	)

376 
	#MAXMEMORY_VOLATILE_LFU
 ((1<<8)|
MAXMEMORY_FLAG_LFU
)

	)

377 
	#MAXMEMORY_VOLATILE_TTL
 (2<<8)

	)

378 
	#MAXMEMORY_VOLATILE_RANDOM
 (3<<8)

	)

379 
	#MAXMEMORY_ALLKEYS_LRU
 ((4<<8)|
MAXMEMORY_FLAG_LRU
|
MAXMEMORY_FLAG_ALLKEYS
)

	)

380 
	#MAXMEMORY_ALLKEYS_LFU
 ((5<<8)|
MAXMEMORY_FLAG_LFU
|
MAXMEMORY_FLAG_ALLKEYS
)

	)

381 
	#MAXMEMORY_ALLKEYS_RANDOM
 ((6<<8)|
MAXMEMORY_FLAG_ALLKEYS
)

	)

382 
	#MAXMEMORY_NO_EVICTION
 (7<<8)

	)

385 
	#UNIT_SECONDS
 0

	)

386 
	#UNIT_MILLISECONDS
 1

	)

389 
	#SHUTDOWN_NOFLAGS
 0

	)

390 
	#SHUTDOWN_SAVE
 1

	)

392 
	#SHUTDOWN_NOSAVE
 2

	)

395 
	#CMD_CALL_NONE
 0

	)

396 
	#CMD_CALL_SLOWLOG
 (1<<0)

	)

397 
	#CMD_CALL_STATS
 (1<<1)

	)

398 
	#CMD_CALL_PROPAGATE_AOF
 (1<<2)

	)

399 
	#CMD_CALL_PROPAGATE_REPL
 (1<<3)

	)

400 
	#CMD_CALL_PROPAGATE
 (
CMD_CALL_PROPAGATE_AOF
|
CMD_CALL_PROPAGATE_REPL
)

	)

401 
	#CMD_CALL_FULL
 (
CMD_CALL_SLOWLOG
 | 
CMD_CALL_STATS
 | 
CMD_CALL_PROPAGATE
)

	)

402 
	#CMD_CALL_NOWRAP
 (1<<4Ë

	)

406 
	#PROPAGATE_NONE
 0

	)

407 
	#PROPAGATE_AOF
 1

	)

408 
	#PROPAGATE_REPL
 2

	)

411 
	#RDB_CHILD_TYPE_NONE
 0

	)

412 
	#RDB_CHILD_TYPE_DISK
 1

	)

413 
	#RDB_CHILD_TYPE_SOCKET
 2

	)

417 
	#NOTIFY_KEYSPACE
 (1<<0Ë

	)

418 
	#NOTIFY_KEYEVENT
 (1<<1Ë

	)

419 
	#NOTIFY_GENERIC
 (1<<2Ë

	)

420 
	#NOTIFY_STRING
 (1<<3Ë

	)

421 
	#NOTIFY_LIST
 (1<<4Ë

	)

422 
	#NOTIFY_SET
 (1<<5Ë

	)

423 
	#NOTIFY_HASH
 (1<<6Ë

	)

424 
	#NOTIFY_ZSET
 (1<<7Ë

	)

425 
	#NOTIFY_EXPIRED
 (1<<8Ë

	)

426 
	#NOTIFY_EVICTED
 (1<<9Ë

	)

427 
	#NOTIFY_STREAM
 (1<<10Ë

	)

428 
	#NOTIFY_KEY_MISS
 (1<<11Ë

	)

429 
	#NOTIFY_ALL
 (
NOTIFY_GENERIC
 | 
NOTIFY_STRING
 | 
NOTIFY_LIST
 | 
NOTIFY_SET
 | 
NOTIFY_HASH
 | 
NOTIFY_ZSET
 | 
NOTIFY_EXPIRED
 | 
NOTIFY_EVICTED
 | 
NOTIFY_STREAM
Ë

	)

432 
	#NET_FIRST_BIND_ADDR
 (
£rvî
.
bödaddr_cou¡
 ? sîvî.
bödaddr
[0] : 
NULL
)

	)

437 
	#run_wôh_≥riod
(
_ms_
Ëi‡((_ms_ <1000/
£rvî
.
hz
Ë|| !(£rvî.
¸⁄lo›s
%((_ms_)/(1000/£rvî.hz))))

	)

440 
	#£rvîAs£πWôhInfo
(
_c
,
_o
,
_e
Ë((_e)?()0 : (
	`_£rvîAs£πWôhInfo
(_c,_o,#_e,
__FILE__
,
__LINE__
),
	`_exô
(1)))

	)

441 
	#£rvîAs£π
(
_e
Ë((_e)?()0 : (
	`_£rvîAs£π
(#_e,
__FILE__
,
__LINE__
),
	`_exô
(1)))

	)

442 
	#£rvîP™ic
(...Ë
	`_£rvîP™ic
(
__FILE__
,
__LINE__
,
__VA_ARGS__
),
	`_exô
(1)

	)

451 
	#OBJ_STRING
 0

	)

452 
	#OBJ_LIST
 1

	)

453 
	#OBJ_SET
 2

	)

454 
	#OBJ_ZSET
 3

	)

455 
	#OBJ_HASH
 4

	)

468 
	#OBJ_MODULE
 5

	)

469 
	#OBJ_STREAM
 6

	)

472 
	#REDISMODULE_TYPE_ENCVER_BITS
 10

	)

473 
	#REDISMODULE_TYPE_ENCVER_MASK
 ((1<<
REDISMODULE_TYPE_ENCVER_BITS
)-1)

	)

474 
	#REDISMODULE_TYPE_ENCVER
(
id
Ë(id & 
REDISMODULE_TYPE_ENCVER_MASK
)

	)

475 
	#REDISMODULE_TYPE_SIGN
(
id
Ë((id & ~((
uöt64_t
)
REDISMODULE_TYPE_ENCVER_MASK
)Ë>>
REDISMODULE_TYPE_ENCVER_BITS
)

	)

478 
	#REDISMODULE_AUX_BEFORE_RDB
 (1<<0)

	)

479 
	#REDISMODULE_AUX_AFTER_RDB
 (1<<1)

	)

481 
	gRedisModuÀ
;

482 
	gRedisModuÀIO
;

483 
	gRedisModuÀDige°
;

484 
	gRedisModuÀCtx
;

485 
	gªdisObje˘
;

491 *(*
	tmoduÀTy≥LﬂdFunc
)(
	tRedisModuÀIO
 *
	tio
, 
	tícvî
);

492 (*
	tmoduÀTy≥SaveFunc
)(
	tRedisModuÀIO
 *
	tio
, *
	tvÆue
);

493 (*
	tmoduÀTy≥AuxLﬂdFunc
)(
	tRedisModuÀIO
 *
	trdb
, 
	tícvî
, 
	twhí
);

494 (*
	tmoduÀTy≥AuxSaveFunc
)(
	tRedisModuÀIO
 *
	trdb
, 
	twhí
);

495 (*
	tmoduÀTy≥RewrôeFunc
)(
	tRedisModuÀIO
 *
	tio
, 
	tªdisObje˘
 *
	tkey
, *
	tvÆue
);

496 (*
	tmoduÀTy≥Dige°Func
)(
	tRedisModuÀDige°
 *
	tdige°
, *
	tvÆue
);

497 
	$size_t
 (*
	tmoduÀTy≥MemUßgeFunc
)(c⁄° *
	tvÆue
);

498 (*
	tmoduÀTy≥FªeFunc
)(*
	tvÆue
);

502 (*
	tRedisModuÀU£rCh™gedFunc
Ë(
	tuöt64_t
 
	t˛õ¡_id
, *
	t¥ivd©a
);

507 
	sRedisModuÀTy≥
 {

508 
uöt64_t
 
id
;

509 
RedisModuÀ
 *
moduÀ
;

510 
moduÀTy≥LﬂdFunc
 
rdb_lﬂd
;

511 
moduÀTy≥SaveFunc
 
rdb_ßve
;

512 
moduÀTy≥RewrôeFunc
 
aof_ªwrôe
;

513 
moduÀTy≥MemUßgeFunc
 
mem_ußge
;

514 
moduÀTy≥Dige°Func
 
dige°
;

515 
moduÀTy≥FªeFunc
 
‰ì
;

516 
moduÀTy≥AuxLﬂdFunc
 
aux_lﬂd
;

517 
moduÀTy≥AuxSaveFunc
 
aux_ßve
;

518 
aux_ßve_åiggîs
;

519 
«me
[10];

520 } 
	tmoduÀTy≥
;

537 
	smoduÀVÆue
 {

538 
moduÀTy≥
 *
ty≥
;

539 *
vÆue
;

540 } 
	tmoduÀVÆue
;

545 
	sRedisModuÀIO
 {

546 
size_t
 
byãs
;

547 
rio
 *rio;

548 
moduÀTy≥
 *
ty≥
;

549 
îr‹
;

550 
vî
;

552 
RedisModuÀCtx
 *
˘x
;

553 
ªdisObje˘
 *
key
;

554 } 
	tRedisModuÀIO
;

558 
	#moduÀInôIOC⁄ãxt
(
iov¨
,
mty≥
,
ri›å
,
key±r
) do { \

559 
iov¨
.
rio
 = 
ri›å
; \

560 
iov¨
.
ty≥
 = 
mty≥
; \

561 
iov¨
.
byãs
 = 0; \

562 
iov¨
.
îr‹
 = 0; \

563 
iov¨
.
vî
 = 0; \

564 
iov¨
.
key
 = 
key±r
; \

565 
iov¨
.
˘x
 = 
NULL
; \

566 
	}
} 0);

	)

573 
	sRedisModuÀDige°
 {

574 
	mo
[20];

575 
	mx
[20];

576 } 
	tRedisModuÀDige°
;

579 
	#moduÀInôDige°C⁄ãxt
(
mdv¨
) do { \

580 
	`mem£t
(
mdv¨
.
o
,0,(mdvar.o)); \

581 
	`mem£t
(
mdv¨
.
x
,0,(mdvar.x)); \

582 } 0);

	)

587 
	#OBJ_ENCODING_RAW
 0

	)

588 
	#OBJ_ENCODING_INT
 1

	)

589 
	#OBJ_ENCODING_HT
 2

	)

590 
	#OBJ_ENCODING_ZIPMAP
 3

	)

591 
	#OBJ_ENCODING_LINKEDLIST
 4

	)

592 
	#OBJ_ENCODING_ZIPLIST
 5

	)

593 
	#OBJ_ENCODING_INTSET
 6

	)

594 
	#OBJ_ENCODING_SKIPLIST
 7

	)

595 
	#OBJ_ENCODING_EMBSTR
 8

	)

596 
	#OBJ_ENCODING_QUICKLIST
 9

	)

597 
	#OBJ_ENCODING_STREAM
 10

	)

599 
	#LRU_BITS
 24

	)

600 
	#LRU_CLOCK_MAX
 ((1<<
LRU_BITS
)-1Ë

	)

601 
	#LRU_CLOCK_RESOLUTION
 1000

	)

603 
	#OBJ_SHARED_REFCOUNT
 
INT_MAX


	)

604 
	#OBJ_STATIC_REFCOUNT
 (
INT_MAX
-1Ë

	)

605 
	#OBJ_FIRST_SPECIAL_REFCOUNT
 
OBJ_STATIC_REFCOUNT


	)

606 
	sªdisObje˘
 {

607 
	mty≥
:4;

608 
	mícodög
:4;

609 
	mÃu
:
LRU_BITS
;

612 
	mªfcou¡
;

613 *
	m±r
;

614 } 
	trobj
;

619 *
gëObje˘Ty≥Name
(
robj
*);

625 
	#öôSèticSåögObje˘
(
_v¨
,
_±r
) do { \

626 
_v¨
.
ªfcou¡
 = 
OBJ_STATIC_REFCOUNT
; \

627 
_v¨
.
ty≥
 = 
OBJ_STRING
; \

628 
_v¨
.
ícodög
 = 
OBJ_ENCODING_RAW
; \

629 
_v¨
.
±r
 = 
_±r
; \

630 } 0)

	)

632 
	gevi˘i⁄PoﬁE¡ry
;

636 
	s˛õ¡RïlyBlock
 {

637 
size_t
 
	msize
, 
	mu£d
;

638 
	mbuf
[];

639 } 
	t˛õ¡RïlyBlock
;

644 
	sªdisDb
 {

645 
di˘
 *
	mdi˘
;

646 
di˘
 *
	mexpúes
;

647 
di˘
 *
	mblockög_keys
;

648 
di˘
 *
	mªady_keys
;

649 
di˘
 *
	mw©ched_keys
;

650 
	mid
;

651 
	mavg_âl
;

652 
	mexpúes_curs‹
;

653 
li°
 *
	mde‰ag_œãr
;

654 } 
	tªdisDb
;

657 
	smu…iCmd
 {

658 
robj
 **
	m¨gv
;

659 
	m¨gc
;

660 
ªdisComm™d
 *
	mcmd
;

661 } 
	tmu…iCmd
;

663 
	smu…iSèã
 {

664 
mu…iCmd
 *
	mcomm™ds
;

665 
	mcou¡
;

666 
	mcmd_Êags
;

669 
	mmöª∂iˇs
;

670 
time_t
 
	mmöª∂iˇs_timeout
;

671 } 
	tmu…iSèã
;

675 
	sblockögSèã
 {

677 
m°ime_t
 
	mtimeout
;

681 
di˘
 *
	mkeys
;

683 
robj
 *
	mèrgë
;

687 
size_t
 
	mxªad_cou¡
;

688 
robj
 *
	mxªad_group
;

689 
robj
 *
	mxªad_c⁄sumî
;

690 
m°ime_t
 
	mxªad_ªåy_time
, 
	mxªad_ªåy_âl
;

691 
	mxªad_group_nﬂck
;

694 
	mnumª∂iˇs
;

695 
	mª∂off£t
;

698 *
	mmoduÀ_blocked_h™dÀ
;

701 } 
	tblockögSèã
;

714 
	sªadyLi°
 {

715 
ªdisDb
 *
	mdb
;

716 
robj
 *
	mkey
;

717 } 
	tªadyLi°
;

722 
	#USER_COMMAND_BITS_COUNT
 1024

	)

726 
	#USER_FLAG_ENABLED
 (1<<0Ë

	)

727 
	#USER_FLAG_DISABLED
 (1<<1Ë

	)

728 
	#USER_FLAG_ALLKEYS
 (1<<2Ë

	)

729 
	#USER_FLAG_ALLCOMMANDS
 (1<<3Ë

	)

730 
	#USER_FLAG_NOPASS
 (1<<4Ë

	)

737 
sds
 
	m«me
;

738 
uöt64_t
 
	mÊags
;

747 
uöt64_t
 
	mÆlowed_comm™ds
[
USER_COMMAND_BITS_COUNT
/64];

754 
sds
 **
	mÆlowed_subcomm™ds
;

755 
li°
 *
	m∑ssw‹ds
;

756 
li°
 *
	m∑âîns
;

759 } 
	tu£r
;

764 
	#CLIENT_ID_AOF
 (
UINT64_MAX
Ë

	)

768 
	s˛õ¡
 {

769 
uöt64_t
 
	mid
;

770 
c⁄√˘i⁄
 *
	mc⁄n
;

771 
	mª•
;

772 
ªdisDb
 *
	mdb
;

773 
robj
 *
	m«me
;

774 
sds
 
	mquîybuf
;

775 
size_t
 
	mqb_pos
;

776 
sds
 
	m≥ndög_quîybuf
;

780 
size_t
 
	mquîybuf_≥ak
;

781 
	m¨gc
;

782 
robj
 **
	m¨gv
;

783 
ªdisComm™d
 *
	mcmd
, *
	mœ°cmd
;

784 
u£r
 *
	mu£r
;

787 
	mªqty≥
;

788 
	mmu…ibulkÀn
;

789 
	mbulkÀn
;

790 
li°
 *
	mª∂y
;

791 
	mª∂y_byãs
;

792 
size_t
 
	m£¡Àn
;

794 
time_t
 
	m˘ime
;

795 
time_t
 
	mœ°öãø˘i⁄
;

796 
time_t
 
	mobuf_so·_limô_ªached_time
;

797 
uöt64_t
 
	mÊags
;

798 
	mauthítiˇãd
;

799 
	mª∂°©e
;

800 
	mª∂_put_⁄löe_⁄_ack
;

801 
	mª∂dbfd
;

802 
off_t
 
	mª∂dboff
;

803 
off_t
 
	mª∂dbsize
;

804 
sds
 
	mª∂¥ómbÀ
;

805 
	mªad_ª∂off
;

806 
	mª∂off
;

807 
	mª∂_ack_off
;

808 
	mª∂_ack_time
;

809 
	mpsync_öôül_off£t
;

812 
	mª∂id
[
CONFIG_RUN_ID_SIZE
+1];

813 
	m¶ave_li°íög_p‹t
;

814 
	m¶ave_ù
[
NET_IP_STR_LEN
];

815 
	m¶ave_ˇ∑
;

816 
mu…iSèã
 
	mm°©e
;

817 
	mbty≥
;

818 
blockögSèã
 
	mbp›
;

819 
	mwoff
;

820 
li°
 *
	mw©ched_keys
;

821 
di˘
 *
	mpubsub_ch™√ls
;

822 
li°
 *
	mpubsub_∑âîns
;

823 
sds
 
	m≥îid
;

824 
li°Node
 *
	m˛õ¡_li°_node
;

825 
RedisModuÀU£rCh™gedFunc
 
	mauth_ˇŒback
;

828 *
	mauth_ˇŒback_¥ivd©a
;

831 *
	mauth_moduÀ
;

838 
uöt64_t
 
	m˛õ¡_åackög_ªdúe˘i⁄
;

839 
øx
 *
	m˛õ¡_åackög_¥efixes
;

847 
uöt64_t
 
	m˛õ¡_¸⁄_œ°_mem‹y_ußge
;

848 
	m˛õ¡_¸⁄_œ°_mem‹y_ty≥
;

850 
	mbuÂos
;

851 
	mbuf
[
PROTO_REPLY_CHUNK_BYTES
];

852 } 
	t˛õ¡
;

854 
	sßvï¨am
 {

855 
time_t
 
	m£c⁄ds
;

856 
	mch™ges
;

859 
	smoduÀLﬂdQueueE¡ry
 {

860 
sds
 
	m∑th
;

861 
	m¨gc
;

862 
robj
 **
	m¨gv
;

865 
	ssh¨edObje˘sSåu˘
 {

866 
robj
 *
	m¸lf
, *
	mok
, *
	mîr
, *
	mem±ybulk
, *
	mczîo
, *
	mc⁄e
, *
	mp⁄g
, *
	m•a˚
,

867 *
	mcﬁ⁄
, *
	mqueued
, *
	mnuŒ
[4], *
	mnuŒ¨øy
[4], *
	mem±ym≠
[4], *
	mem±y£t
[4],

868 *
	mem±y¨øy
, *
	mwr⁄gty≥îr
, *
	mnokeyîr
, *
	msy¡axîr
, *
	mßmeobje˘îr
,

869 *
	mouto‰™gìº
, *
	mnos¸ùãº
, *
	mlﬂdögîr
, *
	m¶ows¸ùãº
, *
	mbgßvìº
,

870 *
	mma°îdow√º
, *
	mro¶avìº
, *
	mexeˇb‹ãº
, *
	mnﬂuthîr
, *
	mn‹ïliˇ£º
,

871 *
	mbusykeyîr
, *
	moomîr
, *
	m∂us
, *
	mmesßgebulk
, *
	mpmesßgebulk
, *
	msubs¸ibebulk
,

872 *
	munsubs¸ibebulk
, *
	mpsubs¸ibebulk
, *
	mpunsubs¸ibebulk
, *
	mdñ
, *
	mu∆ök
,

873 *
	mΩ›
, *
	mÕ›
, *
	mÕush
, *
	mΩ›Õush
, *
	mzp›mö
, *
	mzp›max
, *
	mem±ysˇn
,

874 *
	mmu…i
, *
	mexec
,

875 *
	m£À˘
[
PROTO_SHARED_SELECT_CMDS
],

876 *
	möãgîs
[
OBJ_SHARED_INTEGERS
],

877 *
	mmbulkhdr
[
OBJ_SHARED_BULKHDR_LEN
],

878 *
	mbulkhdr
[
OBJ_SHARED_BULKHDR_LEN
];

879 
sds
 
	mmö°rög
, 
	mmax°rög
;

883 
	szskùli°Node
 {

884 
sds
 
	mñe
;

885 
	msc‹e
;

886 
zskùli°Node
 *
	mbackw¨d
;

887 
	szskùli°Levñ
 {

888 
zskùli°Node
 *
	mf‹w¨d
;

889 
	m•™
;

890 } 
	mÀvñ
[];

891 } 
	tzskùli°Node
;

893 
	szskùli°
 {

894 
zskùli°Node
 *
	mhódî
, *
	mèû
;

895 
	mÀngth
;

896 
	mÀvñ
;

897 } 
	tzskùli°
;

899 
	sz£t
 {

900 
di˘
 *
	mdi˘
;

901 
zskùli°
 *
	mz¶
;

902 } 
	tz£t
;

904 
	s˛õ¡Buf„rLimôsC⁄fig
 {

905 
	mh¨d_limô_byãs
;

906 
	mso·_limô_byãs
;

907 
time_t
 
	mso·_limô_£c⁄ds
;

908 } 
	t˛õ¡Buf„rLimôsC⁄fig
;

910 
˛õ¡Buf„rLimôsC⁄fig
 
˛õ¡Buf„rLimôsDeÁu…s
[
CLIENT_TYPE_OBUF_COUNT
];

918 
	sªdisOp
 {

919 
robj
 **
	m¨gv
;

920 
	m¨gc
, 
	mdbid
, 
	mèrgë
;

921 
ªdisComm™d
 *
	mcmd
;

922 } 
	tªdisOp
;

931 
	sªdisOpAºay
 {

932 
ªdisOp
 *
	m›s
;

933 
	mnum›s
;

934 } 
	tªdisOpAºay
;

938 
	sªdisMemOvîhód
 {

939 
size_t
 
	m≥ak_Æloˇãd
;

940 
size_t
 
	mtŸÆ_Æloˇãd
;

941 
size_t
 
	m°¨tup_Æloˇãd
;

942 
size_t
 
	mª∂_backlog
;

943 
size_t
 
	m˛õ¡s_¶aves
;

944 
size_t
 
	m˛õ¡s_n‹mÆ
;

945 
size_t
 
	maof_buf„r
;

946 
size_t
 
	mlua_ˇches
;

947 
size_t
 
	movîhód_tŸÆ
;

948 
size_t
 
	md©a£t
;

949 
size_t
 
	mtŸÆ_keys
;

950 
size_t
 
	mbyãs_≥r_key
;

951 
	md©a£t_≥rc
;

952 
	m≥ak_≥rc
;

953 
	mtŸÆ_‰ag
;

954 
ssize_t
 
	mtŸÆ_‰ag_byãs
;

955 
	mÆloˇt‹_‰ag
;

956 
ssize_t
 
	mÆloˇt‹_‰ag_byãs
;

957 
	mÆloˇt‹_rss
;

958 
ssize_t
 
	mÆloˇt‹_rss_byãs
;

959 
	mrss_exåa
;

960 
size_t
 
	mrss_exåa_byãs
;

961 
size_t
 
	mnum_dbs
;

963 
size_t
 
	mdbid
;

964 
size_t
 
	movîhód_ht_maö
;

965 
size_t
 
	movîhód_ht_expúes
;

966 } *
	mdb
;

977 
	srdbSaveInfo
 {

979 
	mª∂_°ªam_db
;

982 
	mª∂_id_is_£t
;

983 
	mª∂_id
[
CONFIG_RUN_ID_SIZE
+1];

984 
	mª∂_off£t
;

985 } 
	trdbSaveInfo
;

987 
	#RDB_SAVE_INFO_INIT
 {-1,0,"000000000000000000000000000000",-1}

	)

989 
	smÆloc_°©s
 {

990 
size_t
 
	mzmÆloc_u£d
;

991 
size_t
 
	m¥o˚ss_rss
;

992 
size_t
 
	mÆloˇt‹_Æloˇãd
;

993 
size_t
 
	mÆloˇt‹_a˘ive
;

994 
size_t
 
	mÆloˇt‹_ªsidít
;

1001 
	sªdisTLSC⁄ãxtC⁄fig
 {

1002 *
	m˚π_fûe
;

1003 *
	mkey_fûe
;

1004 *
	mdh_∑øms_fûe
;

1005 *
	mˇ_˚π_fûe
;

1006 *
	mˇ_˚π_dú
;

1007 *
	m¥Ÿocﬁs
;

1008 *
	mcùhîs
;

1009 *
	mcùhîsuôes
;

1010 
	m¥e„r_£rvî_cùhîs
;

1011 } 
	tªdisTLSC⁄ãxtC⁄fig
;

1017 
	g˛u°îSèã
;

1021 #ifde‡
_AIX


1022 #unde‡
hz


1025 
	#CHILD_INFO_MAGIC
 0xC17DDA7A12345678LL

	)

1026 
	#CHILD_INFO_TYPE_RDB
 0

	)

1027 
	#CHILD_INFO_TYPE_AOF
 1

	)

1028 
	#CHILD_INFO_TYPE_MODULE
 3

	)

1030 
	sªdisSîvî
 {

1032 
pid_t
 
	mpid
;

1033 *
	mc⁄figfûe
;

1034 *
	mexecuèbÀ
;

1035 **
	mexec_¨gv
;

1036 
	mdy«mic_hz
;

1037 
	mc⁄fig_hz
;

1040 
	mhz
;

1041 
ªdisDb
 *
	mdb
;

1042 
di˘
 *
	mcomm™ds
;

1043 
di˘
 *
	m‹ig_comm™ds
;

1044 
´EvítLo›
 *
	mñ
;

1045 
_Atomic
 
	mÃu˛ock
;

1046 
	mshutdown_aßp
;

1047 
	ma˘ivîehashög
;

1048 
	ma˘ive_de‰ag_ru¬ög
;

1049 *
	mpidfûe
;

1050 
	m¨ch_bôs
;

1051 
	m¸⁄lo›s
;

1052 
	mrunid
[
CONFIG_RUN_ID_SIZE
+1];

1053 
	m£¡öñ_mode
;

1054 
size_t
 
	möôül_mem‹y_ußge
;

1055 
	mÆways_show_logo
;

1057 
di˘
 *
	mmoduÀ≠i
;

1058 
di˘
 *
	msh¨ed≠i
;

1060 
li°
 *
	mlﬂdmoduÀ_queue
;

1061 
	mmoduÀ_blocked_pùe
[2];

1064 
pid_t
 
	mmoduÀ_chûd_pid
;

1066 
	mp‹t
;

1067 
	més_p‹t
;

1068 
	mt˝_backlog
;

1069 *
	mbödaddr
[
CONFIG_BINDADDR_MAX
];

1070 
	mbödaddr_cou¡
;

1071 *
	munixsockë
;

1072 
mode_t
 
	munixsockë≥rm
;

1073 
	mùfd
[
CONFIG_BINDADDR_MAX
];

1074 
	mùfd_cou¡
;

1075 
	mésfd
[
CONFIG_BINDADDR_MAX
];

1076 
	mésfd_cou¡
;

1077 
	msofd
;

1078 
	mcfd
[
CONFIG_BINDADDR_MAX
];

1079 
	mcfd_cou¡
;

1080 
li°
 *
	m˛õ¡s
;

1081 
li°
 *
	m˛õ¡s_to_˛o£
;

1082 
li°
 *
	m˛õ¡s_≥ndög_wrôe
;

1083 
li°
 *
	m˛õ¡s_≥ndög_ªad
;

1084 
li°
 *
	m¶aves
, *
	mm⁄ô‹s
;

1085 
˛õ¡
 *
	mcuºít_˛õ¡
;

1086 
øx
 *
	m˛õ¡s_timeout_èbÀ
;

1087 
	mfixed_time_expúe
;

1088 
øx
 *
	m˛õ¡s_ödex
;

1089 
	m˛õ¡s_∑u£d
;

1090 
m°ime_t
 
	m˛õ¡s_∑u£_íd_time
;

1091 
	m√ãº
[
ANET_ERR_LEN
];

1092 
di˘
 *
	mmigøã_ˇched_sockës
;

1093 
_Atomic
 
uöt64_t
 
	m√xt_˛õ¡_id
;

1094 
	m¥Ÿe˘ed_mode
;

1095 
	mg›hî_íabÀd
;

1097 
	mio_thªads_num
;

1098 
	mio_thªads_do_ªads
;

1099 
	mevíts_¥o˚s£d_whûe_blocked
;

1102 
	mlﬂdög
;

1103 
off_t
 
	mlﬂdög_tŸÆ_byãs
;

1104 
off_t
 
	mlﬂdög_lﬂded_byãs
;

1105 
time_t
 
	mlﬂdög_°¨t_time
;

1106 
off_t
 
	mlﬂdög_¥o˚ss_evíts_öãrvÆ_byãs
;

1108 
ªdisComm™d
 *
	mdñComm™d
, *
	mmu…iComm™d
, *
	mÕushComm™d
,

1109 *
	mÕ›Comm™d
, *
	mΩ›Comm™d
, *
	mzp›möComm™d
,

1110 *
	mzp›maxComm™d
, *
	m§emComm™d
, *
	mexecComm™d
,

1111 *
	mexpúeComm™d
, *
	m≥xpúeComm™d
, *
	mx˛aimComm™d
,

1112 *
	mxgroupComm™d
, *
	mΩ›ÕushComm™d
;

1114 
time_t
 
	m°©_°¨âime
;

1115 
	m°©_numcomm™ds
;

1116 
	m°©_numc⁄√˘i⁄s
;

1117 
	m°©_expúedkeys
;

1118 
	m°©_expúed_°Æe_≥rc
;

1119 
	m°©_expúed_time_ˇp_ªached_cou¡
;

1120 
	m°©_expúe_cy˛e_time_u£d
;

1121 
	m°©_evi˘edkeys
;

1122 
	m°©_key•a˚_hôs
;

1123 
	m°©_key•a˚_mis£s
;

1124 
	m°©_a˘ive_de‰ag_hôs
;

1125 
	m°©_a˘ive_de‰ag_mis£s
;

1126 
	m°©_a˘ive_de‰ag_key_hôs
;

1127 
	m°©_a˘ive_de‰ag_key_mis£s
;

1128 
	m°©_a˘ive_de‰ag_sˇ¬ed
;

1129 
size_t
 
	m°©_≥ak_mem‹y
;

1130 
	m°©_f‹k_time
;

1131 
	m°©_f‹k_øã
;

1132 
	m°©_ªje˘ed_c⁄n
;

1133 
	m°©_sync_fuŒ
;

1134 
	m°©_sync_∑πül_ok
;

1135 
	m°©_sync_∑πül_îr
;

1136 
li°
 *
	m¶owlog
;

1137 
	m¶owlog_íåy_id
;

1138 
	m¶owlog_log_¶owî_th™
;

1139 
	m¶owlog_max_Àn
;

1140 
mÆloc_°©s
 
	m¸⁄_mÆloc_°©s
;

1141 
_Atomic
 
	m°©_√t_öput_byãs
;

1142 
_Atomic
 
	m°©_√t_ouçut_byãs
;

1143 
size_t
 
	m°©_rdb_cow_byãs
;

1144 
size_t
 
	m°©_aof_cow_byãs
;

1145 
size_t
 
	m°©_moduÀ_cow_byãs
;

1146 
uöt64_t
 
	m°©_˛õ¡s_ty≥_mem‹y
[
CLIENT_TYPE_COUNT
];

1147 
	m°©_u√x≥˘ed_îr‹_ª∂õs
;

1151 
	mœ°_ßm∂e_time
;

1152 
	mœ°_ßm∂e_cou¡
;

1153 
	mßm∂es
[
STATS_METRIC_SAMPLES
];

1154 
	midx
;

1155 } 
	mö°_mëric
[
STATS_METRIC_COUNT
];

1157 
	mvîbosôy
;

1158 
	mmaxidÀtime
;

1159 
	mt˝kì∑live
;

1160 
	ma˘ive_expúe_íabÀd
;

1161 
	ma˘ive_expúe_eff‹t
;

1162 
	ma˘ive_de‰ag_íabÀd
;

1163 
	mjemÆloc_bg_thªad
;

1164 
size_t
 
	ma˘ive_de‰ag_ign‹e_byãs
;

1165 
	ma˘ive_de‰ag_thªshﬁd_lowî
;

1166 
	ma˘ive_de‰ag_thªshﬁd_uµî
;

1167 
	ma˘ive_de‰ag_cy˛e_mö
;

1168 
	ma˘ive_de‰ag_cy˛e_max
;

1169 
	ma˘ive_de‰ag_max_sˇn_fõlds
;

1170 
_Atomic
 
size_t
 
	m˛õ¡_max_quîybuf_Àn
;

1171 
	mdbnum
;

1172 
	msu≥rvi£d
;

1173 
	msu≥rvi£d_mode
;

1174 
	md´m⁄ize
;

1175 
˛õ¡Buf„rLimôsC⁄fig
 
	m˛õ¡_obuf_limôs
[
CLIENT_TYPE_OBUF_COUNT
];

1177 
	maof_íabÀd
;

1178 
	maof_°©e
;

1179 
	maof_fsync
;

1180 *
	maof_fûíame
;

1181 
	maof_no_fsync_⁄_ªwrôe
;

1182 
	maof_ªwrôe_≥rc
;

1183 
off_t
 
	maof_ªwrôe_mö_size
;

1184 
off_t
 
	maof_ªwrôe_ba£_size
;

1185 
off_t
 
	maof_cuºít_size
;

1186 
off_t
 
	maof_fsync_off£t
;

1187 
	maof_Êush_¶ìp
;

1188 
	maof_ªwrôe_scheduÀd
;

1189 
pid_t
 
	maof_chûd_pid
;

1190 
li°
 *
	maof_ªwrôe_buf_blocks
;

1191 
sds
 
	maof_buf
;

1192 
	maof_fd
;

1193 
	maof_£À˘ed_db
;

1194 
time_t
 
	maof_Êush_po°p⁄ed_°¨t
;

1195 
time_t
 
	maof_œ°_fsync
;

1196 
time_t
 
	maof_ªwrôe_time_œ°
;

1197 
time_t
 
	maof_ªwrôe_time_°¨t
;

1198 
	maof_œ°bgªwrôe_°©us
;

1199 
	maof_dñayed_fsync
;

1200 
	maof_ªwrôe_ö¸emíèl_fsync
;

1201 
	mrdb_ßve_ö¸emíèl_fsync
;

1202 
	maof_œ°_wrôe_°©us
;

1203 
	maof_œ°_wrôe_î∫o
;

1204 
	maof_lﬂd_åunˇãd
;

1205 
	maof_u£_rdb_¥ómbÀ
;

1207 
	maof_pùe_wrôe_d©a_to_chûd
;

1208 
	maof_pùe_ªad_d©a_‰om_∑ª¡
;

1209 
	maof_pùe_wrôe_ack_to_∑ª¡
;

1210 
	maof_pùe_ªad_ack_‰om_chûd
;

1211 
	maof_pùe_wrôe_ack_to_chûd
;

1212 
	maof_pùe_ªad_ack_‰om_∑ª¡
;

1213 
	maof_°›_£ndög_diff
;

1215 
sds
 
	maof_chûd_diff
;

1217 
	mdúty
;

1218 
	mdúty_bef‹e_bgßve
;

1219 
pid_t
 
	mrdb_chûd_pid
;

1220 
ßvï¨am
 *
	mßvï¨ams
;

1221 
	mßvï¨am¶í
;

1222 *
	mrdb_fûíame
;

1223 
	mrdb_com¥essi⁄
;

1224 
	mrdb_checksum
;

1225 
	mrdb_dñ_sync_fûes
;

1227 
time_t
 
	mœ°ßve
;

1228 
time_t
 
	mœ°bgßve_åy
;

1229 
time_t
 
	mrdb_ßve_time_œ°
;

1230 
time_t
 
	mrdb_ßve_time_°¨t
;

1231 
	mrdb_bgßve_scheduÀd
;

1232 
	mrdb_chûd_ty≥
;

1233 
	mœ°bgßve_°©us
;

1234 
	m°›_wrôes_⁄_bgßve_îr
;

1235 
	mrdb_pùe_wrôe
;

1236 
	mrdb_pùe_ªad
;

1237 
c⁄√˘i⁄
 **
	mrdb_pùe_c⁄ns
;

1238 
	mrdb_pùe_numc⁄ns
;

1239 
	mrdb_pùe_numc⁄ns_wrôög
;

1240 *
	mrdb_pùe_buff
;

1241 
	mrdb_pùe_bufÊí
;

1242 
	mrdb_key_ßve_dñay
;

1244 
	mkey_lﬂd_dñay
;

1247 
	mchûd_öfo_pùe
[2];

1249 
	m¥o˚ss_ty≥
;

1250 
size_t
 
	mcow_size
;

1251 
	mmagic
;

1252 } 
	mchûd_öfo_d©a
;

1254 
ªdisOpAºay
 
	mÆso_¥›ag©e
;

1256 *
	mlogfûe
;

1257 
	msy¶og_íabÀd
;

1258 *
	msy¶og_idít
;

1259 
	msy¶og_Ácûôy
;

1261 
	mª∂id
[
CONFIG_RUN_ID_SIZE
+1];

1262 
	mª∂id2
[
CONFIG_RUN_ID_SIZE
+1];

1263 
	mma°î_ª∂_off£t
;

1264 
	mma°î_ª∂_mónögful_off£t
;

1265 
	m£c⁄d_ª∂id_off£t
;

1266 
	m¶ave£ldb
;

1267 
	mª∂_pög_¶ave_≥riod
;

1268 *
	mª∂_backlog
;

1269 
	mª∂_backlog_size
;

1270 
	mª∂_backlog_hi°Àn
;

1271 
	mª∂_backlog_idx
;

1273 
	mª∂_backlog_off
;

1275 
time_t
 
	mª∂_backlog_time_limô
;

1277 
time_t
 
	mª∂_no_¶aves_sö˚
;

1279 
	mª∂_mö_¶aves_to_wrôe
;

1280 
	mª∂_mö_¶aves_max_œg
;

1281 
	mª∂_good_¶aves_cou¡
;

1282 
	mª∂_diskÀss_sync
;

1283 
	mª∂_diskÀss_lﬂd
;

1285 
	mª∂_diskÀss_sync_dñay
;

1287 *
	mma°îu£r
;

1288 *
	mma°îauth
;

1289 *
	mma°îho°
;

1290 
	mma°îp‹t
;

1291 
	mª∂_timeout
;

1292 
˛õ¡
 *
	mma°î
;

1293 
˛õ¡
 *
	mˇched_ma°î
;

1294 
	mª∂_syncio_timeout
;

1295 
	mª∂_°©e
;

1296 
off_t
 
	mª∂_å™s„r_size
;

1297 
off_t
 
	mª∂_å™s„r_ªad
;

1298 
off_t
 
	mª∂_å™s„r_œ°_fsync_off
;

1299 
c⁄√˘i⁄
 *
	mª∂_å™s„r_s
;

1300 
	mª∂_å™s„r_fd
;

1301 *
	mª∂_å™s„r_tmpfûe
;

1302 
time_t
 
	mª∂_å™s„r_œ°io
;

1303 
	mª∂_£rve_°Æe_d©a
;

1304 
	mª∂_¶ave_ro
;

1305 
	mª∂_¶ave_ign‹e_maxmem‹y
;

1306 
time_t
 
	mª∂_down_sö˚
;

1307 
	mª∂_dißbÀ_t˝_nodñay
;

1308 
	m¶ave_¥i‹ôy
;

1309 
	m¶ave_™noun˚_p‹t
;

1310 *
	m¶ave_™noun˚_ù
;

1314 
	mma°î_ª∂id
[
CONFIG_RUN_ID_SIZE
+1];

1315 
	mma°î_öôül_off£t
;

1316 
	mª∂_¶ave_œzy_Êush
;

1318 
di˘
 *
	mª∂_s¸ùtˇche_di˘
;

1319 
li°
 *
	mª∂_s¸ùtˇche_fifo
;

1320 
	mª∂_s¸ùtˇche_size
;

1322 
li°
 *
	m˛õ¡s_waôög_acks
;

1323 
	mgë_ack_‰om_¶aves
;

1325 
	mmax˛õ¡s
;

1326 
	mmaxmem‹y
;

1327 
	mmaxmem‹y_pﬁicy
;

1328 
	mmaxmem‹y_ßm∂es
;

1329 
	mlfu_log_Á˘‹
;

1330 
	mlfu_deˇy_time
;

1331 
	m¥Ÿo_max_bulk_Àn
;

1333 
	mblocked_˛õ¡s
;

1334 
	mblocked_˛õ¡s_by_ty≥
[
BLOCKED_NUM
];

1335 
li°
 *
	munblocked_˛õ¡s
;

1336 
li°
 *
	mªady_keys
;

1338 
	måackög_˛õ¡s
;

1339 
size_t
 
	måackög_èbÀ_max_keys
;

1342 
	ms‹t_desc
;

1343 
	ms‹t_Æpha
;

1344 
	ms‹t_by∑âîn
;

1345 
	ms‹t_°‹e
;

1347 
size_t
 
	mhash_max_zùli°_íåõs
;

1348 
size_t
 
	mhash_max_zùli°_vÆue
;

1349 
size_t
 
	m£t_max_öt£t_íåõs
;

1350 
size_t
 
	mz£t_max_zùli°_íåõs
;

1351 
size_t
 
	mz£t_max_zùli°_vÆue
;

1352 
size_t
 
	mhŒ_•¨£_max_byãs
;

1353 
size_t
 
	m°ªam_node_max_byãs
;

1354 
	m°ªam_node_max_íåõs
;

1356 
	mli°_max_zùli°_size
;

1357 
	mli°_com¥ess_dïth
;

1359 
_Atomic
 
time_t
 
	munixtime
;

1360 
time_t
 
	mtimez⁄e
;

1361 
	mdaylight_a˘ive
;

1362 
m°ime_t
 
	mm°ime
;

1363 
u°ime_t
 
	mu°ime
;

1365 
di˘
 *
	mpubsub_ch™√ls
;

1366 
li°
 *
	mpubsub_∑âîns
;

1367 
di˘
 *
	mpubsub_∑âîns_di˘
;

1368 
	mnŸify_key•a˚_evíts
;

1371 
	m˛u°î_íabÀd
;

1372 
m°ime_t
 
	m˛u°î_node_timeout
;

1373 *
	m˛u°î_c⁄figfûe
;

1374 
˛u°îSèã
 *
	m˛u°î
;

1375 
	m˛u°î_migøti⁄_b¨rõr
;

1376 
	m˛u°î_¶ave_vÆidôy_Á˘‹
;

1377 
	m˛u°î_ªquúe_fuŒ_covîage
;

1379 
	m˛u°î_¶ave_no_Áûovî
;

1381 *
	m˛u°î_™noun˚_ù
;

1382 
	m˛u°î_™noun˚_p‹t
;

1383 
	m˛u°î_™noun˚_bus_p‹t
;

1384 
	m˛u°î_moduÀ_Êags
;

1388 
	m˛u°î_Ælow_ªads_whí_down
;

1391 
lua_Sèã
 *
	mlua
;

1392 
˛õ¡
 *
	mlua_˛õ¡
;

1393 
˛õ¡
 *
	mlua_ˇŒî
;

1394 * 
	mlua_cur_s¸ùt
;

1395 
di˘
 *
	mlua_s¸ùts
;

1396 
	mlua_s¸ùts_mem
;

1397 
m°ime_t
 
	mlua_time_limô
;

1398 
m°ime_t
 
	mlua_time_°¨t
;

1399 
	mlua_wrôe_dúty
;

1401 
	mlua_øndom_dúty
;

1403 
	mlua_ª∂iˇã_comm™ds
;

1404 
	mlua_mu…i_emôãd
;

1405 
	mlua_ª∂
;

1406 
	mlua_timedout
;

1408 
	mlua_kûl
;

1409 
	mlua_Æways_ª∂iˇã_comm™ds
;

1410 
	mlua_oom
;

1412 
	mœzy‰ì_œzy_evi˘i⁄
;

1413 
	mœzy‰ì_œzy_expúe
;

1414 
	mœzy‰ì_œzy_£rvî_dñ
;

1415 
	mœzy‰ì_œzy_u£r_dñ
;

1417 
	mœãncy_m⁄ô‹_thªshﬁd
;

1418 
di˘
 *
	mœãncy_evíts
;

1420 *
	ma˛_fûíame
;

1421 
	ma˛log_max_Àn
;

1422 
sds
 
	mªquúïass
;

1426 c⁄° *
	mas£π_Áûed
;

1427 c⁄° *
	mas£π_fûe
;

1428 
	mas£π_löe
;

1429 
	mbug_ªp‹t_°¨t
;

1430 
	mw©chdog_≥riod
;

1432 
size_t
 
	msy°em_mem‹y_size
;

1434 
	més_˛u°î
;

1435 
	més_ª∂iˇti⁄
;

1436 
	més_auth_˛õ¡s
;

1437 
ªdisTLSC⁄ãxtC⁄fig
 
	més_˘x_c⁄fig
;

1439 *
	m£rvî_˝uli°
;

1440 *
	mbio_˝uli°
;

1441 *
	maof_ªwrôe_˝uli°
;

1442 *
	mbgßve_˝uli°
;

1445 
	spubsubP©ã∫
 {

1446 
˛õ¡
 *
	m˛õ¡
;

1447 
robj
 *
	m∑âîn
;

1448 } 
	tpubsubP©ã∫
;

1450 
	tªdisComm™dProc
(
	t˛õ¡
 *
	tc
);

1451 *
	tªdisGëKeysProc
(
	tªdisComm™d
 *
	tcmd
, 
	trobj
 **
	t¨gv
, 
	t¨gc
, *
	tnumkeys
);

1452 
	sªdisComm™d
 {

1453 *
	m«me
;

1454 
ªdisComm™dProc
 *
	m¥oc
;

1455 
	m¨ôy
;

1456 *
	msÊags
;

1457 
uöt64_t
 
	mÊags
;

1460 
ªdisGëKeysProc
 *
	mgëkeys_¥oc
;

1462 
	mfú°key
;

1463 
	mœ°key
;

1464 
	mkey°ï
;

1465 
	mmi¸o£c⁄ds
, 
	mˇŒs
;

1466 
	mid
;

1473 
	sªdisFun˘i⁄Sym
 {

1474 *
	m«me
;

1475 
	mpoöãr
;

1478 
	s_ªdisS‹tObje˘
 {

1479 
robj
 *
	mobj
;

1481 
	msc‹e
;

1482 
robj
 *
	mcmpobj
;

1483 } 
	mu
;

1484 } 
	tªdisS‹tObje˘
;

1486 
	s_ªdisS‹tO≥øti⁄
 {

1487 
	mty≥
;

1488 
robj
 *
	m∑âîn
;

1489 } 
	tªdisS‹tO≥øti⁄
;

1493 
robj
 *
	msubje˘
;

1494 
	mícodög
;

1495 
	mdúe˘i⁄
;

1496 
quickli°Iãr
 *
	môî
;

1497 } 
	tli°Ty≥Iãøt‹
;

1501 
li°Ty≥Iãøt‹
 *
	mli
;

1502 
quickli°E¡ry
 
	míåy
;

1503 } 
	tli°Ty≥E¡ry
;

1507 
robj
 *
	msubje˘
;

1508 
	mícodög
;

1509 
	mii
;

1510 
di˘Iãøt‹
 *
	mdi
;

1511 } 
	t£tTy≥Iãøt‹
;

1518 
robj
 *
	msubje˘
;

1519 
	mícodög
;

1521 *
	mÂå
, *
	mv±r
;

1523 
di˘Iãøt‹
 *
	mdi
;

1524 
di˘E¡ry
 *
	mde
;

1525 } 
	thashTy≥Iãøt‹
;

1527 
	~"°ªam.h
"

1529 
	#OBJ_HASH_KEY
 1

	)

1530 
	#OBJ_HASH_VALUE
 2

	)

1536 
ªdisSîvî
 
£rvî
;

1537 
sh¨edObje˘sSåu˘
 
sh¨ed
;

1538 
di˘Ty≥
 
obje˘KeyPoöãrVÆueDi˘Ty≥
;

1539 
di˘Ty≥
 
obje˘KeyHópPoöãrVÆueDi˘Ty≥
;

1540 
di˘Ty≥
 
£tDi˘Ty≥
;

1541 
di˘Ty≥
 
z£tDi˘Ty≥
;

1542 
di˘Ty≥
 
˛u°îNodesDi˘Ty≥
;

1543 
di˘Ty≥
 
˛u°îNodesBœckLi°Di˘Ty≥
;

1544 
di˘Ty≥
 
dbDi˘Ty≥
;

1545 
di˘Ty≥
 
shaS¸ùtObje˘Di˘Ty≥
;

1546 
R_Zîo
, 
R_PosInf
, 
R_NegInf
, 
R_N™
;

1547 
di˘Ty≥
 
hashDi˘Ty≥
;

1548 
di˘Ty≥
 
ª∂S¸ùtCacheDi˘Ty≥
;

1549 
di˘Ty≥
 
key±rDi˘Ty≥
;

1550 
di˘Ty≥
 
moduÀsDi˘Ty≥
;

1557 
moduÀInôModuÀsSy°em
();

1558 
moduÀLﬂd
(c⁄° *
∑th
, **
¨gv
, 
¨gc
);

1559 
moduÀLﬂdFromQueue
();

1560 *
moduÀGëComm™dKeysVüAPI
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

1561 
moduÀTy≥
 *
moduÀTy≥LookupModuÀByID
(
uöt64_t
 
id
);

1562 
moduÀTy≥NameByID
(*
«me
, 
uöt64_t
 
moduÀid
);

1563 
moduÀFªeC⁄ãxt
(
RedisModuÀCtx
 *
˘x
);

1564 
unblockClõ¡FromModuÀ
(
˛õ¡
 *
c
);

1565 
moduÀH™dÀBlockedClõ¡s
();

1566 
moduÀBlockedClõ¡TimedOut
(
˛õ¡
 *
c
);

1567 
moduÀBlockedClõ¡PùeRódabÀ
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
);

1568 
size_t
 
moduÀCou¡
();

1569 
moduÀAcquúeGIL
();

1570 
moduÀRñó£GIL
();

1571 
moduÀNŸifyKey•a˚Evít
(
ty≥
, c⁄° *
evít
, 
robj
 *
key
, 
dbid
);

1572 
moduÀCÆlComm™dFûãrs
(
˛õ¡
 *
c
);

1573 
ModuÀF‹kD⁄eH™dÀr
(
exôcode
, 
bysig«l
);

1574 
Tîmö©eModuÀF‹kChûd
(
chûd_pid
, 
waô
);

1575 
ssize_t
 
rdbSaveModuÀsAux
(
rio
 *
rdb
, 
whí
);

1576 
moduÀAŒD©©y≥sH™dÀEº‹s
();

1577 
sds
 
moduÀsCﬁÀ˘Info
(sd†
öfo
, c⁄° *
£˘i⁄
, 
f‹_¸ash_ªp‹t
, 
£˘i⁄s
);

1578 
moduÀFúeSîvîEvít
(
uöt64_t
 
eid
, 
subid
, *
d©a
);

1579 
¥o˚ssModuÀLﬂdögProgªssEvít
(
is_aof
);

1580 
moduÀTrySîveClõ¡BlockedOnKey
(
˛õ¡
 *
c
, 
robj
 *
key
);

1581 
moduÀUnblockClõ¡
(
˛õ¡
 *
c
);

1582 
moduÀClõ¡IsBlockedOnKeys
(
˛õ¡
 *
c
);

1583 
moduÀNŸifyU£rCh™ged
(
˛õ¡
 *
c
);

1586 
u°ime
();

1587 
m°ime
();

1588 
gëR™domHexCh¨s
(*
p
, 
size_t
 
Àn
);

1589 
gëR™domByãs
(*
p
, 
size_t
 
Àn
);

1590 
uöt64_t
 
¸c64
(uöt64_à
¸c
, c⁄° *
s
, uöt64_à
l
);

1591 
exôFromChûd
(
ªtcode
);

1592 
size_t
 
ªdisP›cou¡
(*
s
, 
cou¡
);

1593 
ªdisSëProcTôÀ
(*
tôÀ
);

1594 
ªdisCommuniˇãSy°emd
(c⁄° *
sd_nŸify_msg
);

1595 
ªdisSëCpuAfföôy
(c⁄° *
˝uli°
);

1598 
˛õ¡
 *
¸óãClõ¡
(
c⁄√˘i⁄
 *
c⁄n
);

1599 
˛o£TimedoutClõ¡s
();

1600 
‰ìClõ¡
(
˛õ¡
 *
c
);

1601 
‰ìClõ¡Async
(
˛õ¡
 *
c
);

1602 
ª£tClõ¡
(
˛õ¡
 *
c
);

1603 
£ndRïlyToClõ¡
(
c⁄√˘i⁄
 *
c⁄n
);

1604 *
addRïlyDe„ºedLí
(
˛õ¡
 *
c
);

1605 
£tDe„ºedAºayLí
(
˛õ¡
 *
c
, *
node
, 
Àngth
);

1606 
£tDe„ºedM≠Lí
(
˛õ¡
 *
c
, *
node
, 
Àngth
);

1607 
£tDe„ºedSëLí
(
˛õ¡
 *
c
, *
node
, 
Àngth
);

1608 
£tDe„ºedAâribuãLí
(
˛õ¡
 *
c
, *
node
, 
Àngth
);

1609 
£tDe„ºedPushLí
(
˛õ¡
 *
c
, *
node
, 
Àngth
);

1610 
¥o˚ssI≈utBuf„r
(
˛õ¡
 *
c
);

1611 
¥o˚ssG›hîReque°
(
˛õ¡
 *
c
);

1612 
ac˚±H™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
);

1613 
ac˚±T˝H™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
);

1614 
ac˚±TLSH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
);

1615 
ac˚±UnixH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
¥ivd©a
, 
mask
);

1616 
ªadQuîyFromClõ¡
(
c⁄√˘i⁄
 *
c⁄n
);

1617 
addRïlyNuŒ
(
˛õ¡
 *
c
);

1618 
addRïlyNuŒAºay
(
˛õ¡
 *
c
);

1619 
addRïlyBoﬁ
(
˛õ¡
 *
c
, 
b
);

1620 
addRïlyVîb©im
(
˛õ¡
 *
c
, c⁄° *
s
, 
size_t
 
Àn
, c⁄° *
ext
);

1621 
addRïlyPrŸo
(
˛õ¡
 *
c
, c⁄° *
s
, 
size_t
 
Àn
);

1622 
AddRïlyFromClõ¡
(
˛õ¡
 *
c
, clõ¡ *
§c
);

1623 
addRïlyBulk
(
˛õ¡
 *
c
, 
robj
 *
obj
);

1624 
addRïlyBulkCSåög
(
˛õ¡
 *
c
, c⁄° *
s
);

1625 
addRïlyBulkCBuf„r
(
˛õ¡
 *
c
, c⁄° *
p
, 
size_t
 
Àn
);

1626 
addRïlyBulkL⁄gL⁄g
(
˛õ¡
 *
c
, 
Œ
);

1627 
addRïly
(
˛õ¡
 *
c
, 
robj
 *
obj
);

1628 
addRïlySds
(
˛õ¡
 *
c
, 
sds
 
s
);

1629 
addRïlyBulkSds
(
˛õ¡
 *
c
, 
sds
 
s
);

1630 
addRïlyEº‹
(
˛õ¡
 *
c
, c⁄° *
îr
);

1631 
addRïlySètus
(
˛õ¡
 *
c
, c⁄° *
°©us
);

1632 
addRïlyDoubÀ
(
˛õ¡
 *
c
, 
d
);

1633 
addRïlyHum™L⁄gDoubÀ
(
˛õ¡
 *
c
, 
d
);

1634 
addRïlyL⁄gL⁄g
(
˛õ¡
 *
c
, 
Œ
);

1635 
addRïlyAºayLí
(
˛õ¡
 *
c
, 
Àngth
);

1636 
addRïlyM≠Lí
(
˛õ¡
 *
c
, 
Àngth
);

1637 
addRïlySëLí
(
˛õ¡
 *
c
, 
Àngth
);

1638 
addRïlyAâribuãLí
(
˛õ¡
 *
c
, 
Àngth
);

1639 
addRïlyPushLí
(
˛õ¡
 *
c
, 
Àngth
);

1640 
addRïlyHñp
(
˛õ¡
 *
c
, c⁄° **
hñp
);

1641 
addRïlySubcomm™dSy¡axEº‹
(
˛õ¡
 *
c
);

1642 
addRïlyLﬂdedModuÀs
(
˛õ¡
 *
c
);

1643 
c›yClõ¡OuçutBuf„r
(
˛õ¡
 *
d°
, clõ¡ *
§c
);

1644 
size_t
 
sdsZmÆlocSize
(
sds
 
s
);

1645 
size_t
 
gëSåögObje˘SdsU£dMem‹y
(
robj
 *
o
);

1646 
‰ìClõ¡RïlyVÆue
(*
o
);

1647 *
dupClõ¡RïlyVÆue
(*
o
);

1648 
gëClõ¡sMaxBuf„rs
(*
l⁄ge°_ouçut_li°
,

1649 *
bigge°_öput_buf„r
);

1650 *
gëClõ¡PìrId
(
˛õ¡
 *client);

1651 
sds
 
ˇtClõ¡InfoSåög
(sd†
s
, 
˛õ¡
 *client);

1652 
sds
 
gëAŒClõ¡sInfoSåög
(
ty≥
);

1653 
ªwrôeClõ¡Comm™dVe˘‹
(
˛õ¡
 *
c
, 
¨gc
, ...);

1654 
ªwrôeClõ¡Comm™dArgumít
(
˛õ¡
 *
c
, 
i
, 
robj
 *
√wvÆ
);

1655 
ª∂a˚Clõ¡Comm™dVe˘‹
(
˛õ¡
 *
c
, 
¨gc
, 
robj
 **
¨gv
);

1656 
gëClõ¡OuçutBuf„rMem‹yUßge
(
˛õ¡
 *
c
);

1657 
‰ìClõ¡sInAsyncFªeQueue
();

1658 
asyncClo£Clõ¡OnOuçutBuf„rLimôRóched
(
˛õ¡
 *
c
);

1659 
gëClõ¡Ty≥
(
˛õ¡
 *
c
);

1660 
gëClõ¡Ty≥ByName
(*
«me
);

1661 *
gëClõ¡Ty≥Name
(
˛ass
);

1662 
ÊushSœvesOuçutBuf„rs
();

1663 
disc⁄√˘Sœves
();

1664 
li°íToP‹t
(
p‹t
, *
fds
, *
cou¡
);

1665 
∑u£Clõ¡s
(
m°ime_t
 
duøti⁄
);

1666 
˛õ¡sAªPau£d
();

1667 
¥o˚ssEvítsWhûeBlocked
();

1668 
h™dÀClõ¡sWôhPídögWrôes
();

1669 
h™dÀClõ¡sWôhPídögWrôesUsögThªads
();

1670 
h™dÀClõ¡sWôhPídögRódsUsögThªads
();

1671 
°›ThªadedIOIfNìded
();

1672 
˛õ¡HasPídögRïlõs
(
˛õ¡
 *
c
);

1673 
u∆ökClõ¡
(
˛õ¡
 *
c
);

1674 
wrôeToClõ¡
(
˛õ¡
 *
c
, 
h™dÀr_ö°ÆÀd
);

1675 
lökClõ¡
(
˛õ¡
 *
c
);

1676 
¥Ÿe˘Clõ¡
(
˛õ¡
 *
c
);

1677 
u≈rŸe˘Clõ¡
(
˛õ¡
 *
c
);

1678 
öôThªadedIO
();

1679 
˛õ¡
 *
lookupClõ¡ByID
(
uöt64_t
 
id
);

1681 #ifde‡
__GNUC__


1682 
	$addRïlyEº‹F‹m©
(
˛õ¡
 *
c
, c⁄° *
fmt
, ...)

1683 
	`__©åibuã__
((
	`f‹m©
(
¥ötf
, 2, 3)));

1684 
	$addRïlySètusF‹m©
(
˛õ¡
 *
c
, c⁄° *
fmt
, ...)

1685 
	`__©åibuã__
((
	`f‹m©
(
¥ötf
, 2, 3)));

1687 
	`addRïlyEº‹F‹m©
(
˛õ¡
 *
c
, c⁄° *
fmt
, ...);

1688 
	`addRïlySètusF‹m©
(
˛õ¡
 *
c
, c⁄° *
fmt
, ...);

1692 
	`íabÀTøckög
(
˛õ¡
 *
c
, 
uöt64_t
 
ªdúe˘_to
, uöt64_à
›ti⁄s
, 
robj
 **
¥efix
, 
size_t
 
num¥efix
);

1693 
	`dißbÀTøckög
(
˛õ¡
 *
c
);

1694 
	`åackögRemembîKeys
(
˛õ¡
 *
c
);

1695 
	`åackögInvÆid©eKey
(
˛õ¡
 *
c
, 
robj
 *
keyobj
);

1696 
	`åackögInvÆid©eKeysOnFlush
(
dbid
);

1697 
	`åackögLimôU£dSlŸs
();

1698 
uöt64_t
 
	`åackögGëTŸÆIãms
();

1699 
uöt64_t
 
	`åackögGëTŸÆKeys
();

1700 
uöt64_t
 
	`åackögGëTŸÆPªfixes
();

1701 
	`åackögBrﬂdˇ°InvÆid©i⁄Mesßges
();

1704 
	`li°Ty≥TryC⁄vîsi⁄
(
robj
 *
subje˘
,Ñobj *
vÆue
);

1705 
	`li°Ty≥Push
(
robj
 *
subje˘
,Ñobj *
vÆue
, 
whîe
);

1706 
robj
 *
	`li°Ty≥P›
‘obj *
subje˘
, 
whîe
);

1707 
	`li°Ty≥Lígth
(c⁄° 
robj
 *
subje˘
);

1708 
li°Ty≥Iãøt‹
 *
	`li°Ty≥InôIãøt‹
(
robj
 *
subje˘
, 
ödex
, 
dúe˘i⁄
);

1709 
	`li°Ty≥Rñó£Iãøt‹
(
li°Ty≥Iãøt‹
 *
li
);

1710 
	`li°Ty≥Next
(
li°Ty≥Iãøt‹
 *
li
, 
li°Ty≥E¡ry
 *
íåy
);

1711 
robj
 *
	`li°Ty≥Gë
(
li°Ty≥E¡ry
 *
íåy
);

1712 
	`li°Ty≥In£π
(
li°Ty≥E¡ry
 *
íåy
, 
robj
 *
vÆue
, 
whîe
);

1713 
	`li°Ty≥EquÆ
(
li°Ty≥E¡ry
 *
íåy
, 
robj
 *
o
);

1714 
	`li°Ty≥Dñëe
(
li°Ty≥Iãøt‹
 *
ôî
, 
li°Ty≥E¡ry
 *
íåy
);

1715 
	`li°Ty≥C⁄vît
(
robj
 *
subje˘
, 
íc
);

1716 
	`unblockClõ¡WaôögD©a
(
˛õ¡
 *
c
);

1717 
	`p›GíîicComm™d
(
˛õ¡
 *
c
, 
whîe
);

1720 
	`unw©chAŒKeys
(
˛õ¡
 *
c
);

1721 
	`öôClõ¡Mu…iSèã
(
˛õ¡
 *
c
);

1722 
	`‰ìClõ¡Mu…iSèã
(
˛õ¡
 *
c
);

1723 
	`queueMu…iComm™d
(
˛õ¡
 *
c
);

1724 
	`touchW©chedKey
(
ªdisDb
 *
db
, 
robj
 *
key
);

1725 
	`touchW©chedKeysOnFlush
(
dbid
);

1726 
	`disˇrdTønß˘i⁄
(
˛õ¡
 *
c
);

1727 
	`ÊagTønß˘i⁄
(
˛õ¡
 *
c
);

1728 
	`execComm™dPr›ag©eMu…i
(
˛õ¡
 *
c
);

1729 
	`execComm™dPr›ag©eExec
(
˛õ¡
 *
c
);

1732 
	`de¸RefCou¡
(
robj
 *
o
);

1733 
	`de¸RefCou¡Void
(*
o
);

1734 
	`ö¸RefCou¡
(
robj
 *
o
);

1735 
robj
 *
	`makeObje˘Sh¨ed
‘obj *
o
);

1736 
robj
 *
	`ª£tRefCou¡
‘obj *
obj
);

1737 
	`‰ìSåögObje˘
(
robj
 *
o
);

1738 
	`‰ìLi°Obje˘
(
robj
 *
o
);

1739 
	`‰ìSëObje˘
(
robj
 *
o
);

1740 
	`‰ìZ£tObje˘
(
robj
 *
o
);

1741 
	`‰ìHashObje˘
(
robj
 *
o
);

1742 
robj
 *
	`¸óãObje˘
(
ty≥
, *
±r
);

1743 
robj
 *
	`¸óãSåögObje˘
(c⁄° *
±r
, 
size_t
 
Àn
);

1744 
robj
 *
	`¸óãRawSåögObje˘
(c⁄° *
±r
, 
size_t
 
Àn
);

1745 
robj
 *
	`¸óãEmbeddedSåögObje˘
(c⁄° *
±r
, 
size_t
 
Àn
);

1746 
robj
 *
	`dupSåögObje˘
(c⁄°Ñobj *
o
);

1747 
	`isSdsRïª£¡abÀAsL⁄gL⁄g
(
sds
 
s
, *
ŒvÆ
);

1748 
	`isObje˘Rïª£¡abÀAsL⁄gL⁄g
(
robj
 *
o
, *
Œ⁄gvÆ
);

1749 
robj
 *
	`åyObje˘Encodög
‘obj *
o
);

1750 
robj
 *
	`gëDecodedObje˘
‘obj *
o
);

1751 
size_t
 
	`°rögObje˘Lí
(
robj
 *
o
);

1752 
robj
 *
	`¸óãSåögObje˘FromL⁄gL⁄g
(
vÆue
);

1753 
robj
 *
	`¸óãSåögObje˘FromL⁄gL⁄gF‹VÆue
(
vÆue
);

1754 
robj
 *
	`¸óãSåögObje˘FromL⁄gDoubÀ
(
vÆue
, 
hum™‰õndly
);

1755 
robj
 *
	`¸óãQuickli°Obje˘
();

1756 
robj
 *
	`¸óãZùli°Obje˘
();

1757 
robj
 *
	`¸óãSëObje˘
();

1758 
robj
 *
	`¸óãI¡£tObje˘
();

1759 
robj
 *
	`¸óãHashObje˘
();

1760 
robj
 *
	`¸óãZ£tObje˘
();

1761 
robj
 *
	`¸óãZ£tZùli°Obje˘
();

1762 
robj
 *
	`¸óãSåómObje˘
();

1763 
robj
 *
	`¸óãModuÀObje˘
(
moduÀTy≥
 *
mt
, *
vÆue
);

1764 
	`gëL⁄gFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
èrgë
, c⁄° *
msg
);

1765 
	`checkTy≥
(
˛õ¡
 *
c
, 
robj
 *
o
, 
ty≥
);

1766 
	`gëL⁄gL⁄gFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
èrgë
, c⁄° *
msg
);

1767 
	`gëDoubÀFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
èrgë
, c⁄° *
msg
);

1768 
	`gëDoubÀFromObje˘
(c⁄° 
robj
 *
o
, *
èrgë
);

1769 
	`gëL⁄gL⁄gFromObje˘
(
robj
 *
o
, *
èrgë
);

1770 
	`gëL⁄gDoubÀFromObje˘
(
robj
 *
o
, *
èrgë
);

1771 
	`gëL⁄gDoubÀFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
èrgë
, c⁄° *
msg
);

1772 *
	`°rEncodög
(
ícodög
);

1773 
	`com∑ªSåögObje˘s
(
robj
 *
a
,Ñobj *
b
);

1774 
	`cﬁœãSåögObje˘s
(
robj
 *
a
,Ñobj *
b
);

1775 
	`equÆSåögObje˘s
(
robj
 *
a
,Ñobj *
b
);

1776 
	`e°im©eObje˘IdÀTime
(
robj
 *
o
);

1777 
	`åimSåögObje˘IfNìded
(
robj
 *
o
);

1778 
	#sdsEncodedObje˘
(
obj±r
Ë(obj±r->
ícodög
 =
OBJ_ENCODING_RAW
 || obj±r->ícodög =
OBJ_ENCODING_EMBSTR
)

	)

1781 
ssize_t
 
	`syncWrôe
(
fd
, *
±r
, ssize_à
size
, 
timeout
);

1782 
ssize_t
 
	`syncRód
(
fd
, *
±r
, ssize_à
size
, 
timeout
);

1783 
ssize_t
 
	`syncRódLöe
(
fd
, *
±r
, ssize_à
size
, 
timeout
);

1786 
	`ª∂iˇti⁄FìdSœves
(
li°
 *
¶aves
, 
di˘id
, 
robj
 **
¨gv
, 
¨gc
);

1787 
	`ª∂iˇti⁄FìdSœvesFromMa°îSåóm
(
li°
 *
¶aves
, *
buf
, 
size_t
 
buÊí
);

1788 
	`ª∂iˇti⁄FìdM⁄ô‹s
(
˛õ¡
 *
c
, 
li°
 *
m⁄ô‹s
, 
di˘id
, 
robj
 **
¨gv
, 
¨gc
);

1789 
	`upd©eSœvesWaôögBgßve
(
bgßvìº
, 
ty≥
);

1790 
	`ª∂iˇti⁄Cr⁄
();

1791 
	`ª∂iˇti⁄H™dÀMa°îDisc⁄√˘i⁄
();

1792 
	`ª∂iˇti⁄CacheMa°î
(
˛õ¡
 *
c
);

1793 
	`ªsizeRïliˇti⁄Backlog
(
√wsize
);

1794 
	`ª∂iˇti⁄SëMa°î
(*
ù
, 
p‹t
);

1795 
	`ª∂iˇti⁄Un£tMa°î
();

1796 
	`ª‰eshGoodSœvesCou¡
();

1797 
	`ª∂iˇti⁄S¸ùtCacheInô
();

1798 
	`ª∂iˇti⁄S¸ùtCacheFlush
();

1799 
	`ª∂iˇti⁄S¸ùtCacheAdd
(
sds
 
sha1
);

1800 
	`ª∂iˇti⁄S¸ùtCacheExi°s
(
sds
 
sha1
);

1801 
	`¥o˚ssClõ¡sWaôögRïliˇs
();

1802 
	`unblockClõ¡WaôögRïliˇs
(
˛õ¡
 *
c
);

1803 
	`ª∂iˇti⁄Cou¡AcksByOff£t
(
off£t
);

1804 
	`ª∂iˇti⁄SídNewlöeToMa°î
();

1805 
	`ª∂iˇti⁄GëSœveOff£t
();

1806 *
	`ª∂iˇti⁄GëSœveName
(
˛õ¡
 *
c
);

1807 
	`gëPsyncInôülOff£t
();

1808 
	`ª∂iˇti⁄SëupSœveF‹FuŒResync
(
˛õ¡
 *
¶ave
, 
off£t
);

1809 
	`ch™geRïliˇti⁄Id
();

1810 
	`˛órRïliˇti⁄Id2
();

1811 
	`ch›Rïliˇti⁄Backlog
();

1812 
	`ª∂iˇti⁄CacheMa°îUsögMy£lf
();

1813 
	`„edRïliˇti⁄Backlog
(*
±r
, 
size_t
 
Àn
);

1814 
	`rdbPùeRódH™dÀr
(
´EvítLo›
 *
evítLo›
, 
fd
, *
˛õ¡D©a
, 
mask
);

1815 
	`rdbPùeWrôeH™dÀrC⁄nRemoved
(
c⁄√˘i⁄
 *
c⁄n
);

1818 
	`°¨tLﬂdögFûe
(
FILE
* 
Â
, * 
fûíame
, 
rdbÊags
);

1819 
	`°¨tLﬂdög
(
size_t
 
size
, 
rdbÊags
);

1820 
	`lﬂdögProgªss
(
off_t
 
pos
);

1821 
	`°›Lﬂdög
(
suc˚ss
);

1822 
	`°¨tSavög
(
rdbÊags
);

1823 
	`°›Savög
(
suc˚ss
);

1824 
	`ÆlPîsi°í˚DißbÀd
();

1826 
	#DISK_ERROR_TYPE_AOF
 1

	)

1827 
	#DISK_ERROR_TYPE_RDB
 2

	)

1828 
	#DISK_ERROR_TYPE_NONE
 0

	)

1829 
	`wrôeComm™dsDíõdByDiskEº‹
();

1832 
	~"rdb.h
"

1833 
	`kûlRDBChûd
();

1836 
	`ÊushAµídO∆yFûe
(
f‹˚
);

1837 
	`„edAµídO∆yFûe
(
ªdisComm™d
 *
cmd
, 
di˘id
, 
robj
 **
¨gv
, 
¨gc
);

1838 
	`aofRemoveTempFûe
(
pid_t
 
chûdpid
);

1839 
	`ªwrôeAµídO∆yFûeBackground
();

1840 
	`lﬂdAµídO∆yFûe
(*
fûíame
);

1841 
	`°›AµídO∆y
();

1842 
	`°¨tAµídO∆y
();

1843 
	`backgroundRewrôeD⁄eH™dÀr
(
exôcode
, 
bysig«l
);

1844 
	`aofRewrôeBuf„rRe£t
();

1845 
	`aofRewrôeBuf„rSize
();

1846 
ssize_t
 
	`aofRódDiffFromP¨ít
();

1847 
	`kûlAµídO∆yChûd
();

1848 
	`ª°¨tAOFA·îSYNC
();

1851 
	`›íChûdInfoPùe
();

1852 
	`˛o£ChûdInfoPùe
();

1853 
	`£ndChûdInfo
(
¥o˚ss_ty≥
);

1854 
	`ª˚iveChûdInfo
();

1857 
	`ªdisF‹k
();

1858 
	`hasA˘iveChûdPro˚ss
();

1859 
	`£ndChûdCOWInfo
(
±y≥
, *
≤ame
);

1862 
øx
 *
U£rs
;

1863 
u£r
 *
DeÁu…U£r
;

1864 
	`ACLInô
();

1866 
	#ACL_OK
 0

	)

1867 
	#ACL_DENIED_CMD
 1

	)

1868 
	#ACL_DENIED_KEY
 2

	)

1869 
	#ACL_DENIED_AUTH
 3

	)

1870 
	`ACLCheckU£rCªdítüls
(
robj
 *
u£∫ame
,Ñobj *
∑ssw‹d
);

1871 
	`ACLAuthítiˇãU£r
(
˛õ¡
 *
c
, 
robj
 *
u£∫ame
,Ñobj *
∑ssw‹d
);

1872 
	`ACLGëComm™dID
(c⁄° *
cmd«me
);

1873 
u£r
 *
	`ACLGëU£rByName
(c⁄° *
«me
, 
size_t
 
«mñí
);

1874 
	`ACLCheckComm™dPîm
(
˛õ¡
 *
c
, *
keyidx±r
);

1875 
	`ACLSëU£r
(
u£r
 *
u
, c⁄° *
›
, 
ssize_t
 
›Àn
);

1876 
sds
 
	`ACLDeÁu…U£rFú°Passw‹d
();

1877 
uöt64_t
 
	`ACLGëComm™dC©eg‹yFœgByName
(c⁄° *
«me
);

1878 
	`ACLAµídU£rF‹Lﬂdög
(
sds
 *
¨gv
, 
¨gc
, *
¨gc_îr
);

1879 *
	`ACLSëU£rSåögEº‹
();

1880 
	`ACLLﬂdC⁄figuªdU£rs
();

1881 
sds
 
	`ACLDes¸ibeU£r
(
u£r
 *
u
);

1882 
	`ACLLﬂdU£rsAtSèπup
();

1883 
	`addRïlyComm™dC©eg‹õs
(
˛õ¡
 *
c
, 
ªdisComm™d
 *
cmd
);

1884 
u£r
 *
	`ACLCª©eU∆ökedU£r
();

1885 
	`ACLFªeU£rAndKûlClõ¡s
(
u£r
 *
u
);

1886 
	`addACLLogE¡ry
(
˛õ¡
 *
c
, 
ªas⁄
, 
keypos
, 
sds
 
u£∫ame
);

1891 
	#ZADD_NONE
 0

	)

1892 
	#ZADD_INCR
 (1<<0Ë

	)

1893 
	#ZADD_NX
 (1<<1Ë

	)

1894 
	#ZADD_XX
 (1<<2Ë

	)

1897 
	#ZADD_NOP
 (1<<3Ë

	)

1898 
	#ZADD_NAN
 (1<<4Ë

	)

1899 
	#ZADD_ADDED
 (1<<5Ë

	)

1900 
	#ZADD_UPDATED
 (1<<6Ë

	)

1903 
	#ZADD_CH
 (1<<16Ë

	)

1907 
mö
, 
max
;

1908 
möex
, 
maxex
;

1909 } 
	tzønge•ec
;

1913 
sds
 
mö
, 
max
;

1914 
möex
, 
maxex
;

1915 } 
	tzÀxønge•ec
;

1917 
zskùli°
 *
	`z¶Cª©e
();

1918 
	`z¶Fªe
(
zskùli°
 *
z¶
);

1919 
zskùli°Node
 *
	`z¶In£π
(
zskùli°
 *
z¶
, 
sc‹e
, 
sds
 
ñe
);

1920 *
	`zzlIn£π
(*
zl
, 
sds
 
ñe
, 
sc‹e
);

1921 
	`z¶Dñëe
(
zskùli°
 *
z¶
, 
sc‹e
, 
sds
 
ñe
, 
zskùli°Node
 **
node
);

1922 
zskùli°Node
 *
	`z¶Fú°InR™ge
(
zskùli°
 *
z¶
, 
zønge•ec
 *
ønge
);

1923 
zskùli°Node
 *
	`z¶La°InR™ge
(
zskùli°
 *
z¶
, 
zønge•ec
 *
ønge
);

1924 
	`zzlGëSc‹e
(*
•å
);

1925 
	`zzlNext
(*
zl
, **
ïå
, **
•å
);

1926 
	`zzlPªv
(*
zl
, **
ïå
, **
•å
);

1927 *
	`zzlFú°InR™ge
(*
zl
, 
zønge•ec
 *
ønge
);

1928 *
	`zzlLa°InR™ge
(*
zl
, 
zønge•ec
 *
ønge
);

1929 
	`z£tLígth
(c⁄° 
robj
 *
zobj
);

1930 
	`z£tC⁄vît
(
robj
 *
zobj
, 
ícodög
);

1931 
	`z£tC⁄vîtToZùli°IfNìded
(
robj
 *
zobj
, 
size_t
 
maxññí
);

1932 
	`z£tSc‹e
(
robj
 *
zobj
, 
sds
 
membî
, *
sc‹e
);

1933 
	`z¶GëR™k
(
zskùli°
 *
z¶
, 
sc‹e
, 
sds
 
o
);

1934 
	`z£tAdd
(
robj
 *
zobj
, 
sc‹e
, 
sds
 
ñe
, *
Êags
, *
√wsc‹e
);

1935 
	`z£tR™k
(
robj
 *
zobj
, 
sds
 
ñe
, 
ªvî£
);

1936 
	`z£tDñ
(
robj
 *
zobj
, 
sds
 
ñe
);

1937 
	`gíîicZp›Comm™d
(
˛õ¡
 *
c
, 
robj
 **
keyv
, 
keyc
, 
whîe
, 
emôkey
,Ñobj *
cou¡¨g
);

1938 
sds
 
	`zùli°GëObje˘
(*
•å
);

1939 
	`z¶VÆueGãMö
(
vÆue
, 
zønge•ec
 *
•ec
);

1940 
	`z¶VÆueLãMax
(
vÆue
, 
zønge•ec
 *
•ec
);

1941 
	`z¶FªeLexR™ge
(
zÀxønge•ec
 *
•ec
);

1942 
	`z¶P¨£LexR™ge
(
robj
 *
mö
,Ñobj *
max
, 
zÀxønge•ec
 *
•ec
);

1943 *
	`zzlFú°InLexR™ge
(*
zl
, 
zÀxønge•ec
 *
ønge
);

1944 *
	`zzlLa°InLexR™ge
(*
zl
, 
zÀxønge•ec
 *
ønge
);

1945 
zskùli°Node
 *
	`z¶Fú°InLexR™ge
(
zskùli°
 *
z¶
, 
zÀxønge•ec
 *
ønge
);

1946 
zskùli°Node
 *
	`z¶La°InLexR™ge
(
zskùli°
 *
z¶
, 
zÀxønge•ec
 *
ønge
);

1947 
	`zzlLexVÆueGãMö
(*
p
, 
zÀxønge•ec
 *
•ec
);

1948 
	`zzlLexVÆueLãMax
(*
p
, 
zÀxønge•ec
 *
•ec
);

1949 
	`z¶LexVÆueGãMö
(
sds
 
vÆue
, 
zÀxønge•ec
 *
•ec
);

1950 
	`z¶LexVÆueLãMax
(
sds
 
vÆue
, 
zÀxønge•ec
 *
•ec
);

1953 
	`gëMaxmem‹ySèã
(
size_t
 *
tŸÆ
, size_à*
logiˇl
, size_à*
to‰ì
, *
Àvñ
);

1954 
size_t
 
	`‰ìMem‹yGëNŸCou¡edMem‹y
();

1955 
	`‰ìMem‹yIfNìded
();

1956 
	`‰ìMem‹yIfNìdedAndSa„
();

1957 
	`¥o˚ssComm™d
(
˛õ¡
 *
c
);

1958 
	`£tupSig«lH™dÀrs
();

1959 
ªdisComm™d
 *
	`lookupComm™d
(
sds
 
«me
);

1960 
ªdisComm™d
 *
	`lookupComm™dByCSåög
(*
s
);

1961 
ªdisComm™d
 *
	`lookupComm™dOrOrigöÆ
(
sds
 
«me
);

1962 
	`ˇŒ
(
˛õ¡
 *
c
, 
Êags
);

1963 
	`¥›ag©e
(
ªdisComm™d
 *
cmd
, 
dbid
, 
robj
 **
¨gv
, 
¨gc
, 
Êags
);

1964 
	`ÆsoPr›ag©e
(
ªdisComm™d
 *
cmd
, 
dbid
, 
robj
 **
¨gv
, 
¨gc
, 
èrgë
);

1965 
	`ªdisOpAºayInô
(
ªdisOpAºay
 *
ﬂ
);

1966 
	`ªdisOpAºayFªe
(
ªdisOpAºay
 *
ﬂ
);

1967 
	`f‹˚Comm™dPr›ag©i⁄
(
˛õ¡
 *
c
, 
Êags
);

1968 
	`¥evítComm™dPr›ag©i⁄
(
˛õ¡
 *
c
);

1969 
	`¥evítComm™dAOF
(
˛õ¡
 *
c
);

1970 
	`¥evítComm™dRïliˇti⁄
(
˛õ¡
 *
c
);

1971 
	`¥ï¨eF‹Shutdown
();

1972 #ifde‡
__GNUC__


1973 
	$£rvîLog
(
Àvñ
, c⁄° *
fmt
, ...)

1974 
	`__©åibuã__
((
	`f‹m©
(
¥ötf
, 2, 3)));

1976 
	`£rvîLog
(
Àvñ
, c⁄° *
fmt
, ...);

1978 
	`£rvîLogRaw
(
Àvñ
, c⁄° *
msg
);

1979 
	`£rvîLogFromH™dÀr
(
Àvñ
, c⁄° *
msg
);

1980 
	`ußge
();

1981 
	`upd©eDi˘ResizePﬁicy
();

1982 
	`htNìdsResize
(
di˘
 *dict);

1983 
	`p›uœãComm™dTabÀ
();

1984 
	`ª£tComm™dTabÀSèts
();

1985 
	`adju°O≥nFûesLimô
();

1986 
	`˛o£Li°íögSockës
(
u∆ök_unix_sockë
);

1987 
	`upd©eCachedTime
(
upd©e_daylight_öfo
);

1988 
	`ª£tSîvîSèts
();

1989 
	`a˘iveDe‰agCy˛e
();

1990 
	`gëLRUClock
();

1991 
	`LRU_CLOCK
();

1992 c⁄° *
	`evi˘PﬁicyToSåög
();

1993 
ªdisMemOvîhód
 *
	`gëMem‹yOvîhódD©a
();

1994 
	`‰ìMem‹yOvîhódD©a
(
ªdisMemOvîhód
 *
mh
);

1995 
	`checkChûdªnD⁄e
();

1997 
	#RESTART_SERVER_NONE
 0

	)

1998 
	#RESTART_SERVER_GRACEFULLY
 (1<<0Ë

	)

1999 
	#RESTART_SERVER_CONFIG_REWRITE
 (1<<1Ë

	)

2000 
	`ª°¨tSîvî
(
Êags
, 
m°ime_t
 
dñay
);

2003 
robj
 *
	`£tTy≥Cª©e
(
sds
 
vÆue
);

2004 
	`£tTy≥Add
(
robj
 *
subje˘
, 
sds
 
vÆue
);

2005 
	`£tTy≥Remove
(
robj
 *
subje˘
, 
sds
 
vÆue
);

2006 
	`£tTy≥IsMembî
(
robj
 *
subje˘
, 
sds
 
vÆue
);

2007 
£tTy≥Iãøt‹
 *
	`£tTy≥InôIãøt‹
(
robj
 *
subje˘
);

2008 
	`£tTy≥Rñó£Iãøt‹
(
£tTy≥Iãøt‹
 *
si
);

2009 
	`£tTy≥Next
(
£tTy≥Iãøt‹
 *
si
, 
sds
 *
sd£À
, 
öt64_t
 *
Œñe
);

2010 
sds
 
	`£tTy≥NextObje˘
(
£tTy≥Iãøt‹
 *
si
);

2011 
	`£tTy≥R™domEÀmít
(
robj
 *
£tobj
, 
sds
 *
sd£À
, 
öt64_t
 *
Œñe
);

2012 
	`£tTy≥R™domEÀmíts
(
robj
 *
£t
, 
cou¡
,Ñobj *
aux_£t
);

2013 
	`£tTy≥Size
(c⁄° 
robj
 *
subje˘
);

2014 
	`£tTy≥C⁄vît
(
robj
 *
subje˘
, 
íc
);

2017 
	#HASH_SET_TAKE_FIELD
 (1<<0)

	)

2018 
	#HASH_SET_TAKE_VALUE
 (1<<1)

	)

2019 
	#HASH_SET_COPY
 0

	)

2021 
	`hashTy≥C⁄vît
(
robj
 *
o
, 
íc
);

2022 
	`hashTy≥TryC⁄vîsi⁄
(
robj
 *
subje˘
,Ñobj **
¨gv
, 
°¨t
, 
íd
);

2023 
	`hashTy≥Exi°s
(
robj
 *
o
, 
sds
 
key
);

2024 
	`hashTy≥Dñëe
(
robj
 *
o
, 
sds
 
key
);

2025 
	`hashTy≥Lígth
(c⁄° 
robj
 *
o
);

2026 
hashTy≥Iãøt‹
 *
	`hashTy≥InôIãøt‹
(
robj
 *
subje˘
);

2027 
	`hashTy≥Rñó£Iãøt‹
(
hashTy≥Iãøt‹
 *
hi
);

2028 
	`hashTy≥Next
(
hashTy≥Iãøt‹
 *
hi
);

2029 
	`hashTy≥CuºítFromZùli°
(
hashTy≥Iãøt‹
 *
hi
, 
wh©
,

2030 **
v°r
,

2031 *
vÀn
,

2032 *
vŒ
);

2033 
sds
 
	`hashTy≥CuºítFromHashTabÀ
(
hashTy≥Iãøt‹
 *
hi
, 
wh©
);

2034 
	`hashTy≥CuºítObje˘
(
hashTy≥Iãøt‹
 *
hi
, 
wh©
, **
v°r
, *
vÀn
, *
vŒ
);

2035 
sds
 
	`hashTy≥CuºítObje˘NewSds
(
hashTy≥Iãøt‹
 *
hi
, 
wh©
);

2036 
robj
 *
	`hashTy≥LookupWrôeOrCª©e
(
˛õ¡
 *
c
,Ñobj *
key
);

2037 
robj
 *
	`hashTy≥GëVÆueObje˘
‘obj *
o
, 
sds
 
fõld
);

2038 
	`hashTy≥Së
(
robj
 *
o
, 
sds
 
fõld
, sd†
vÆue
, 
Êags
);

2041 
	`pubsubUnsubs¸ibeAŒCh™√ls
(
˛õ¡
 *
c
, 
nŸify
);

2042 
	`pubsubUnsubs¸ibeAŒP©ã∫s
(
˛õ¡
 *
c
, 
nŸify
);

2043 
	`‰ìPubsubP©ã∫
(*
p
);

2044 
	`li°M©chPubsubP©ã∫
(*
a
, *
b
);

2045 
	`pubsubPublishMesßge
(
robj
 *
ch™√l
,Ñobj *
mesßge
);

2046 
	`addRïlyPubsubMesßge
(
˛õ¡
 *
c
, 
robj
 *
ch™√l
,Ñobj *
msg
);

2049 
	`nŸifyKey•a˚Evít
(
ty≥
, *
evít
, 
robj
 *
key
, 
dbid
);

2050 
	`key•a˚EvítsSåögToFœgs
(*
˛as£s
);

2051 
sds
 
	`key•a˚EvítsFœgsToSåög
(
Êags
);

2054 
	`lﬂdSîvîC⁄fig
(*
fûíame
, *
›ti⁄s
);

2055 
	`≠≥ndSîvîSaveP¨ams
(
time_t
 
£c⁄ds
, 
ch™ges
);

2056 
	`ª£tSîvîSaveP¨ams
();

2057 
ªwrôeC⁄figSèã
;

2058 
	`ªwrôeC⁄figRewrôeLöe
(
ªwrôeC⁄figSèã
 *
°©e
, c⁄° *
›ti⁄
, 
sds
 
löe
, 
f‹˚
);

2059 
	`ªwrôeC⁄fig
(*
∑th
);

2060 
	`öôC⁄figVÆues
();

2063 
	`ªmoveExpúe
(
ªdisDb
 *
db
, 
robj
 *
key
);

2064 
	`¥›ag©eExpúe
(
ªdisDb
 *
db
, 
robj
 *
key
, 
œzy
);

2065 
	`expúeIfNìded
(
ªdisDb
 *
db
, 
robj
 *
key
);

2066 
	`gëExpúe
(
ªdisDb
 *
db
, 
robj
 *
key
);

2067 
	`£tExpúe
(
˛õ¡
 *
c
, 
ªdisDb
 *
db
, 
robj
 *
key
, 
whí
);

2068 
robj
 *
	`lookupKey
(
ªdisDb
 *
db
,Ñobj *
key
, 
Êags
);

2069 
robj
 *
	`lookupKeyRód
(
ªdisDb
 *
db
,Ñobj *
key
);

2070 
robj
 *
	`lookupKeyWrôe
(
ªdisDb
 *
db
,Ñobj *
key
);

2071 
robj
 *
	`lookupKeyRódOrRïly
(
˛õ¡
 *
c
,Ñobj *
key
,Ñobj *
ª∂y
);

2072 
robj
 *
	`lookupKeyWrôeOrRïly
(
˛õ¡
 *
c
,Ñobj *
key
,Ñobj *
ª∂y
);

2073 
robj
 *
	`lookupKeyRódWôhFœgs
(
ªdisDb
 *
db
,Ñobj *
key
, 
Êags
);

2074 
robj
 *
	`lookupKeyWrôeWôhFœgs
(
ªdisDb
 *
db
,Ñobj *
key
, 
Êags
);

2075 
robj
 *
	`obje˘Comm™dLookup
(
˛õ¡
 *
c
,Ñobj *
key
);

2076 
robj
 *
	`obje˘Comm™dLookupOrRïly
(
˛õ¡
 *
c
,Ñobj *
key
,Ñobj *
ª∂y
);

2077 
	`obje˘SëLRUOrLFU
(
robj
 *
vÆ
, 
lfu_‰eq
, 
Ãu_idÀ
,

2078 
Ãu_˛ock
, 
Ãu_mu…ùlõr
);

2079 
	#LOOKUP_NONE
 0

	)

2080 
	#LOOKUP_NOTOUCH
 (1<<0)

	)

2081 
	`dbAdd
(
ªdisDb
 *
db
, 
robj
 *
key
,Ñobj *
vÆ
);

2082 
	`dbAddRDBLﬂd
(
ªdisDb
 *
db
, 
sds
 
key
, 
robj
 *
vÆ
);

2083 
	`dbOvîwrôe
(
ªdisDb
 *
db
, 
robj
 *
key
,Ñobj *
vÆ
);

2084 
	`gíîicSëKey
(
˛õ¡
 *
c
, 
ªdisDb
 *
db
, 
robj
 *
key
,Ñobj *
vÆ
, 
kì±é
, 
sig«l
);

2085 
	`£tKey
(
˛õ¡
 *
c
, 
ªdisDb
 *
db
, 
robj
 *
key
,Ñobj *
vÆ
);

2086 
	`dbExi°s
(
ªdisDb
 *
db
, 
robj
 *
key
);

2087 
robj
 *
	`dbR™domKey
(
ªdisDb
 *
db
);

2088 
	`dbSyncDñëe
(
ªdisDb
 *
db
, 
robj
 *
key
);

2089 
	`dbDñëe
(
ªdisDb
 *
db
, 
robj
 *
key
);

2090 
robj
 *
	`dbUnsh¨eSåögVÆue
(
ªdisDb
 *
db
,Ñobj *
key
,Ñobj *
o
);

2092 
	#EMPTYDB_NO_FLAGS
 0

	)

2093 
	#EMPTYDB_ASYNC
 (1<<0Ë

	)

2094 
	#EMPTYDB_BACKUP
 (1<<2Ë

	)

2095 
	`em±yDb
(
dbnum
, 
Êags
, (
ˇŒback
)(*));

2096 
	`em±yDbGíîic
(
ªdisDb
 *
db¨øy
, 
dbnum
, 
Êags
, (
ˇŒback
)(*));

2097 
	`ÊushAŒD©aAndRe£tRDB
(
Êags
);

2098 
	`dbTŸÆSîvîKeyCou¡
();

2100 
	`£À˘Db
(
˛õ¡
 *
c
, 
id
);

2101 
	`sig«lModifõdKey
(
˛õ¡
 *
c
, 
ªdisDb
 *
db
, 
robj
 *
key
);

2102 
	`sig«lFlushedDb
(
dbid
);

2103 
	`gëKeysInSlŸ
(
hash¶Ÿ
, 
robj
 **
keys
, 
cou¡
);

2104 
	`cou¡KeysInSlŸ
(
hash¶Ÿ
);

2105 
	`dñKeysInSlŸ
(
hash¶Ÿ
);

2106 
	`vîifyClu°îC⁄figWôhD©a
();

2107 
	`sˇnGíîicComm™d
(
˛õ¡
 *
c
, 
robj
 *
o
, 
curs‹
);

2108 
	`∑r£SˇnCurs‹OrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, *
curs‹
);

2109 
	`¶ŸToKeyAdd
(
sds
 
key
);

2110 
	`¶ŸToKeyDñ
(
sds
 
key
);

2111 
	`¶ŸToKeyFlush
();

2112 
	`dbAsyncDñëe
(
ªdisDb
 *
db
, 
robj
 *
key
);

2113 
	`em±yDbAsync
(
ªdisDb
 *
db
);

2114 
	`¶ŸToKeyFlushAsync
();

2115 
size_t
 
	`œzy‰ìGëPídögObje˘sCou¡
();

2116 
	`‰ìObjAsync
(
robj
 *
o
);

2119 *
	`gëKeysFromComm™d
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

2120 
	`gëKeysFªeResu…
(*
ªsu…
);

2121 *
	`zuni⁄I¡îGëKeys
(
ªdisComm™d
 *
cmd
,
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

2122 *
	`evÆGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

2123 *
	`s‹tGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

2124 *
	`migøãGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

2125 *
	`ge‹adiusGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

2126 *
	`xªadGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

2127 *
	`mem‹yGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

2128 *
	`lcsGëKeys
(
ªdisComm™d
 *
cmd
, 
robj
 **
¨gv
, 
¨gc
, *
numkeys
);

2131 
	`˛u°îInô
();

2132 
	`¸c16
(c⁄° *
buf
, 
Àn
);

2133 
	`keyHashSlŸ
(*
key
, 
keyÀn
);

2134 
	`˛u°îCr⁄
();

2135 
	`˛u°îPr›ag©ePublish
(
robj
 *
ch™√l
,Ñobj *
mesßge
);

2136 
	`migøãClo£TimedoutSockës
();

2137 
	`˛u°îBef‹eSÀï
();

2138 
	`˛u°îSídModuÀMesßgeToT¨gë
(c⁄° *
èrgë
, 
uöt64_t
 
moduÀ_id
, 
uöt8_t
 
ty≥
, *
∑ylﬂd
, 
uöt32_t
 
Àn
);

2141 
	`öôSítöñC⁄fig
();

2142 
	`öôSítöñ
();

2143 
	`£¡öñTimî
();

2144 *
	`£¡öñH™dÀC⁄figuøti⁄
(**
¨gv
, 
¨gc
);

2145 
	`£¡öñIsRu¬ög
();

2148 
	`ªdis_check_rdb
(*
rdbfûíame
, 
FILE
 *
Â
);

2149 
	`ªdis_check_rdb_maö
(
¨gc
, **
¨gv
, 
FILE
 *
Â
);

2150 
	`ªdis_check_aof_maö
(
¨gc
, **
¨gv
);

2153 
	`s¸ùtögInô
(
£tup
);

2154 
	`ldbRemoveChûd
(
pid_t
 
pid
);

2155 
	`ldbKûlF‹kedSessi⁄s
();

2156 
	`ldbPídögChûdªn
();

2157 
sds
 
	`luaCª©eFun˘i⁄
(
˛õ¡
 *
c
, 
lua_Sèã
 *
lua
, 
robj
 *
body
);

2160 
	`¥o˚ssUnblockedClõ¡s
();

2161 
	`blockClõ¡
(
˛õ¡
 *
c
, 
bty≥
);

2162 
	`unblockClõ¡
(
˛õ¡
 *
c
);

2163 
	`queueClõ¡F‹Rïro˚ssög
(
˛õ¡
 *
c
);

2164 
	`ª∂yToBlockedClõ¡TimedOut
(
˛õ¡
 *
c
);

2165 
	`gëTimeoutFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
obje˘
, 
m°ime_t
 *
timeout
, 
unô
);

2166 
	`disc⁄√˘AŒBlockedClõ¡s
();

2167 
	`h™dÀClõ¡sBlockedOnKeys
();

2168 
	`sig«lKeyAsRódy
(
ªdisDb
 *
db
, 
robj
 *
key
);

2169 
	`blockF‹Keys
(
˛õ¡
 *
c
, 
bty≥
, 
robj
 **
keys
, 
numkeys
, 
m°ime_t
 
timeout
,Ñobj *
èrgë
, 
°ªamID
 *
ids
);

2172 
	`addClõ¡ToTimeoutTabÀ
(
˛õ¡
 *
c
);

2173 
	`ªmoveClõ¡FromTimeoutTabÀ
(
˛õ¡
 *
c
);

2174 
	`h™dÀBlockedClõ¡sTimeout
();

2175 
	`˛õ¡sCr⁄H™dÀTimeout
(
˛õ¡
 *
c
, 
m°ime_t
 
now_ms
);

2178 
	`a˘iveExpúeCy˛e
(
ty≥
);

2179 
	`expúeSœveKeys
();

2180 
	`ªmembîSœveKeyWôhExpúe
(
ªdisDb
 *
db
, 
robj
 *
key
);

2181 
	`ÊushSœveKeysWôhExpúeLi°
();

2182 
size_t
 
	`gëSœveKeyWôhExpúeCou¡
();

2185 
	`evi˘i⁄PoﬁAŒoc
();

2186 
	#LFU_INIT_VAL
 5

	)

2187 
	`LFUGëTimeInMöuãs
();

2188 
uöt8_t
 
	`LFULogIn¸
(uöt8_à
vÆue
);

2189 
	`LFUDe¸AndRëu∫
(
robj
 *
o
);

2192 
uöt64_t
 
	`di˘SdsHash
(c⁄° *
key
);

2193 
	`di˘SdsKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
, c⁄° *
key2
);

2194 
	`di˘SdsDe°ru˘‹
(*
¥ivd©a
, *
vÆ
);

2197 *
	`ªdisGôSHA1
();

2198 *
	`ªdisGôDúty
();

2199 
uöt64_t
 
	`ªdisBuûdId
();

2200 *
	`ªdisBuûdIdSåög
();

2203 
	`authComm™d
(
˛õ¡
 *
c
);

2204 
	`pögComm™d
(
˛õ¡
 *
c
);

2205 
	`echoComm™d
(
˛õ¡
 *
c
);

2206 
	`comm™dComm™d
(
˛õ¡
 *
c
);

2207 
	`£tComm™d
(
˛õ¡
 *
c
);

2208 
	`£äxComm™d
(
˛õ¡
 *
c
);

2209 
	`£ãxComm™d
(
˛õ¡
 *
c
);

2210 
	`p£ãxComm™d
(
˛õ¡
 *
c
);

2211 
	`gëComm™d
(
˛õ¡
 *
c
);

2212 
	`dñComm™d
(
˛õ¡
 *
c
);

2213 
	`u∆ökComm™d
(
˛õ¡
 *
c
);

2214 
	`exi°sComm™d
(
˛õ¡
 *
c
);

2215 
	`£tbôComm™d
(
˛õ¡
 *
c
);

2216 
	`gëbôComm™d
(
˛õ¡
 *
c
);

2217 
	`bôfõldComm™d
(
˛õ¡
 *
c
);

2218 
	`bôfõldroComm™d
(
˛õ¡
 *
c
);

2219 
	`£å™geComm™d
(
˛õ¡
 *
c
);

2220 
	`gëøngeComm™d
(
˛õ¡
 *
c
);

2221 
	`ö¸Comm™d
(
˛õ¡
 *
c
);

2222 
	`de¸Comm™d
(
˛õ¡
 *
c
);

2223 
	`ö¸byComm™d
(
˛õ¡
 *
c
);

2224 
	`de¸byComm™d
(
˛õ¡
 *
c
);

2225 
	`ö¸byÊﬂtComm™d
(
˛õ¡
 *
c
);

2226 
	`£À˘Comm™d
(
˛õ¡
 *
c
);

2227 
	`sw≠dbComm™d
(
˛õ¡
 *
c
);

2228 
	`øndomkeyComm™d
(
˛õ¡
 *
c
);

2229 
	`keysComm™d
(
˛õ¡
 *
c
);

2230 
	`sˇnComm™d
(
˛õ¡
 *
c
);

2231 
	`dbsizeComm™d
(
˛õ¡
 *
c
);

2232 
	`œ°ßveComm™d
(
˛õ¡
 *
c
);

2233 
	`ßveComm™d
(
˛õ¡
 *
c
);

2234 
	`bgßveComm™d
(
˛õ¡
 *
c
);

2235 
	`bgªwrôóofComm™d
(
˛õ¡
 *
c
);

2236 
	`shutdownComm™d
(
˛õ¡
 *
c
);

2237 
	`moveComm™d
(
˛õ¡
 *
c
);

2238 
	`ª«meComm™d
(
˛õ¡
 *
c
);

2239 
	`ª«míxComm™d
(
˛õ¡
 *
c
);

2240 
	`ÕushComm™d
(
˛õ¡
 *
c
);

2241 
	`ΩushComm™d
(
˛õ¡
 *
c
);

2242 
	`ÕushxComm™d
(
˛õ¡
 *
c
);

2243 
	`ΩushxComm™d
(
˛õ¡
 *
c
);

2244 
	`lö£πComm™d
(
˛õ¡
 *
c
);

2245 
	`Õ›Comm™d
(
˛õ¡
 *
c
);

2246 
	`Ω›Comm™d
(
˛õ¡
 *
c
);

2247 
	`ŒíComm™d
(
˛õ¡
 *
c
);

2248 
	`lödexComm™d
(
˛õ¡
 *
c
);

2249 
	`Ã™geComm™d
(
˛õ¡
 *
c
);

2250 
	`…rimComm™d
(
˛õ¡
 *
c
);

2251 
	`ty≥Comm™d
(
˛õ¡
 *
c
);

2252 
	`l£tComm™d
(
˛õ¡
 *
c
);

2253 
	`ßddComm™d
(
˛õ¡
 *
c
);

2254 
	`§emComm™d
(
˛õ¡
 *
c
);

2255 
	`smoveComm™d
(
˛õ¡
 *
c
);

2256 
	`sismembîComm™d
(
˛õ¡
 *
c
);

2257 
	`sˇrdComm™d
(
˛õ¡
 *
c
);

2258 
	`•›Comm™d
(
˛õ¡
 *
c
);

2259 
	`§™dmembîComm™d
(
˛õ¡
 *
c
);

2260 
	`söãrComm™d
(
˛õ¡
 *
c
);

2261 
	`söãr°‹eComm™d
(
˛õ¡
 *
c
);

2262 
	`suni⁄Comm™d
(
˛õ¡
 *
c
);

2263 
	`suni⁄°‹eComm™d
(
˛õ¡
 *
c
);

2264 
	`sdiffComm™d
(
˛õ¡
 *
c
);

2265 
	`sdiff°‹eComm™d
(
˛õ¡
 *
c
);

2266 
	`ssˇnComm™d
(
˛õ¡
 *
c
);

2267 
	`syncComm™d
(
˛õ¡
 *
c
);

2268 
	`ÊushdbComm™d
(
˛õ¡
 *
c
);

2269 
	`ÊushÆlComm™d
(
˛õ¡
 *
c
);

2270 
	`s‹tComm™d
(
˛õ¡
 *
c
);

2271 
	`ÃemComm™d
(
˛õ¡
 *
c
);

2272 
	`Ω›ÕushComm™d
(
˛õ¡
 *
c
);

2273 
	`öfoComm™d
(
˛õ¡
 *
c
);

2274 
	`mgëComm™d
(
˛õ¡
 *
c
);

2275 
	`m⁄ô‹Comm™d
(
˛õ¡
 *
c
);

2276 
	`expúeComm™d
(
˛õ¡
 *
c
);

2277 
	`expúótComm™d
(
˛õ¡
 *
c
);

2278 
	`≥xpúeComm™d
(
˛õ¡
 *
c
);

2279 
	`≥xpúótComm™d
(
˛õ¡
 *
c
);

2280 
	`gë£tComm™d
(
˛õ¡
 *
c
);

2281 
	`âlComm™d
(
˛õ¡
 *
c
);

2282 
	`touchComm™d
(
˛õ¡
 *
c
);

2283 
	`±éComm™d
(
˛õ¡
 *
c
);

2284 
	`≥rsi°Comm™d
(
˛õ¡
 *
c
);

2285 
	`ª∂iˇofComm™d
(
˛õ¡
 *
c
);

2286 
	`rﬁeComm™d
(
˛õ¡
 *
c
);

2287 
	`debugComm™d
(
˛õ¡
 *
c
);

2288 
	`m£tComm™d
(
˛õ¡
 *
c
);

2289 
	`m£äxComm™d
(
˛õ¡
 *
c
);

2290 
	`zaddComm™d
(
˛õ¡
 *
c
);

2291 
	`zö¸byComm™d
(
˛õ¡
 *
c
);

2292 
	`zøngeComm™d
(
˛õ¡
 *
c
);

2293 
	`zøngebysc‹eComm™d
(
˛õ¡
 *
c
);

2294 
	`zªvøngebysc‹eComm™d
(
˛õ¡
 *
c
);

2295 
	`zøngebyÀxComm™d
(
˛õ¡
 *
c
);

2296 
	`zªvøngebyÀxComm™d
(
˛õ¡
 *
c
);

2297 
	`zcou¡Comm™d
(
˛õ¡
 *
c
);

2298 
	`zÀxcou¡Comm™d
(
˛õ¡
 *
c
);

2299 
	`zªvøngeComm™d
(
˛õ¡
 *
c
);

2300 
	`zˇrdComm™d
(
˛õ¡
 *
c
);

2301 
	`zªmComm™d
(
˛õ¡
 *
c
);

2302 
	`zsc‹eComm™d
(
˛õ¡
 *
c
);

2303 
	`zªmøngebysc‹eComm™d
(
˛õ¡
 *
c
);

2304 
	`zªmøngebyÀxComm™d
(
˛õ¡
 *
c
);

2305 
	`zp›möComm™d
(
˛õ¡
 *
c
);

2306 
	`zp›maxComm™d
(
˛õ¡
 *
c
);

2307 
	`bzp›möComm™d
(
˛õ¡
 *
c
);

2308 
	`bzp›maxComm™d
(
˛õ¡
 *
c
);

2309 
	`mu…iComm™d
(
˛õ¡
 *
c
);

2310 
	`execComm™d
(
˛õ¡
 *
c
);

2311 
	`disˇrdComm™d
(
˛õ¡
 *
c
);

2312 
	`bÕ›Comm™d
(
˛õ¡
 *
c
);

2313 
	`bΩ›Comm™d
(
˛õ¡
 *
c
);

2314 
	`bΩ›ÕushComm™d
(
˛õ¡
 *
c
);

2315 
	`≠≥ndComm™d
(
˛õ¡
 *
c
);

2316 
	`°æíComm™d
(
˛õ¡
 *
c
);

2317 
	`zønkComm™d
(
˛õ¡
 *
c
);

2318 
	`zªvønkComm™d
(
˛õ¡
 *
c
);

2319 
	`h£tComm™d
(
˛õ¡
 *
c
);

2320 
	`h£äxComm™d
(
˛õ¡
 *
c
);

2321 
	`hgëComm™d
(
˛õ¡
 *
c
);

2322 
	`hm£tComm™d
(
˛õ¡
 *
c
);

2323 
	`hmgëComm™d
(
˛õ¡
 *
c
);

2324 
	`hdñComm™d
(
˛õ¡
 *
c
);

2325 
	`hÀnComm™d
(
˛õ¡
 *
c
);

2326 
	`h°æíComm™d
(
˛õ¡
 *
c
);

2327 
	`zªmøngebyønkComm™d
(
˛õ¡
 *
c
);

2328 
	`zuni⁄°‹eComm™d
(
˛õ¡
 *
c
);

2329 
	`zöãr°‹eComm™d
(
˛õ¡
 *
c
);

2330 
	`zsˇnComm™d
(
˛õ¡
 *
c
);

2331 
	`hkeysComm™d
(
˛õ¡
 *
c
);

2332 
	`hvÆsComm™d
(
˛õ¡
 *
c
);

2333 
	`hgëÆlComm™d
(
˛õ¡
 *
c
);

2334 
	`hexi°sComm™d
(
˛õ¡
 *
c
);

2335 
	`hsˇnComm™d
(
˛õ¡
 *
c
);

2336 
	`c⁄figComm™d
(
˛õ¡
 *
c
);

2337 
	`hö¸byComm™d
(
˛õ¡
 *
c
);

2338 
	`hö¸byÊﬂtComm™d
(
˛õ¡
 *
c
);

2339 
	`subs¸ibeComm™d
(
˛õ¡
 *
c
);

2340 
	`unsubs¸ibeComm™d
(
˛õ¡
 *
c
);

2341 
	`psubs¸ibeComm™d
(
˛õ¡
 *
c
);

2342 
	`punsubs¸ibeComm™d
(
˛õ¡
 *
c
);

2343 
	`publishComm™d
(
˛õ¡
 *
c
);

2344 
	`pubsubComm™d
(
˛õ¡
 *
c
);

2345 
	`w©chComm™d
(
˛õ¡
 *
c
);

2346 
	`unw©chComm™d
(
˛õ¡
 *
c
);

2347 
	`˛u°îComm™d
(
˛õ¡
 *
c
);

2348 
	`ª°‹eComm™d
(
˛õ¡
 *
c
);

2349 
	`migøãComm™d
(
˛õ¡
 *
c
);

2350 
	`askögComm™d
(
˛õ¡
 *
c
);

2351 
	`ªad⁄lyComm™d
(
˛õ¡
 *
c
);

2352 
	`ªadwrôeComm™d
(
˛õ¡
 *
c
);

2353 
	`dumpComm™d
(
˛õ¡
 *
c
);

2354 
	`obje˘Comm™d
(
˛õ¡
 *
c
);

2355 
	`mem‹yComm™d
(
˛õ¡
 *
c
);

2356 
	`˛õ¡Comm™d
(
˛õ¡
 *
c
);

2357 
	`hñloComm™d
(
˛õ¡
 *
c
);

2358 
	`evÆComm™d
(
˛õ¡
 *
c
);

2359 
	`evÆShaComm™d
(
˛õ¡
 *
c
);

2360 
	`s¸ùtComm™d
(
˛õ¡
 *
c
);

2361 
	`timeComm™d
(
˛õ¡
 *
c
);

2362 
	`bô›Comm™d
(
˛õ¡
 *
c
);

2363 
	`bôcou¡Comm™d
(
˛õ¡
 *
c
);

2364 
	`bôposComm™d
(
˛õ¡
 *
c
);

2365 
	`ª∂c⁄fComm™d
(
˛õ¡
 *
c
);

2366 
	`waôComm™d
(
˛õ¡
 *
c
);

2367 
	`ge€ncodeComm™d
(
˛õ¡
 *
c
);

2368 
	`geodecodeComm™d
(
˛õ¡
 *
c
);

2369 
	`ge‹adiusbymembîComm™d
(
˛õ¡
 *
c
);

2370 
	`ge‹adiusbymembîroComm™d
(
˛õ¡
 *
c
);

2371 
	`ge‹adiusComm™d
(
˛õ¡
 *
c
);

2372 
	`ge‹adiu§oComm™d
(
˛õ¡
 *
c
);

2373 
	`geﬂddComm™d
(
˛õ¡
 *
c
);

2374 
	`geohashComm™d
(
˛õ¡
 *
c
);

2375 
	`ge›osComm™d
(
˛õ¡
 *
c
);

2376 
	`geodi°Comm™d
(
˛õ¡
 *
c
);

2377 
	`pf£l·e°Comm™d
(
˛õ¡
 *
c
);

2378 
	`pÁddComm™d
(
˛õ¡
 *
c
);

2379 
	`pfcou¡Comm™d
(
˛õ¡
 *
c
);

2380 
	`pfmîgeComm™d
(
˛õ¡
 *
c
);

2381 
	`pfdebugComm™d
(
˛õ¡
 *
c
);

2382 
	`œãncyComm™d
(
˛õ¡
 *
c
);

2383 
	`moduÀComm™d
(
˛õ¡
 *
c
);

2384 
	`£curôyW¨nögComm™d
(
˛õ¡
 *
c
);

2385 
	`xaddComm™d
(
˛õ¡
 *
c
);

2386 
	`xøngeComm™d
(
˛õ¡
 *
c
);

2387 
	`xªvøngeComm™d
(
˛õ¡
 *
c
);

2388 
	`xÀnComm™d
(
˛õ¡
 *
c
);

2389 
	`xªadComm™d
(
˛õ¡
 *
c
);

2390 
	`xgroupComm™d
(
˛õ¡
 *
c
);

2391 
	`x£tidComm™d
(
˛õ¡
 *
c
);

2392 
	`xackComm™d
(
˛õ¡
 *
c
);

2393 
	`x≥ndögComm™d
(
˛õ¡
 *
c
);

2394 
	`x˛aimComm™d
(
˛õ¡
 *
c
);

2395 
	`xöfoComm™d
(
˛õ¡
 *
c
);

2396 
	`xdñComm™d
(
˛õ¡
 *
c
);

2397 
	`xåimComm™d
(
˛õ¡
 *
c
);

2398 
	`lﬁwutComm™d
(
˛õ¡
 *
c
);

2399 
	`a˛Comm™d
(
˛õ¡
 *
c
);

2400 
	`°ølgoComm™d
(
˛õ¡
 *
c
);

2402 #i‡
	`deföed
(
__GNUC__
)

2403 *
	$ˇŒoc
(
size_t
 
cou¡
, size_à
size
Ë
	`__©åibuã__
 ((
dïªˇãd
));

2404 
	$‰ì
(*
±r
Ë
	`__©åibuã__
 ((
dïªˇãd
));

2405 *
	$mÆloc
(
size_t
 
size
Ë
	`__©åibuã__
 ((
dïªˇãd
));

2406 *
	$ªÆloc
(*
±r
, 
size_t
 
size
Ë
	`__©åibuã__
 ((
dïªˇãd
));

2410 
	`_£rvîAs£πWôhInfo
(c⁄° 
˛õ¡
 *
c
, c⁄° 
robj
 *
o
, c⁄° *
e°r
, c⁄° *
fûe
, 
löe
);

2411 
	`_£rvîAs£π
(c⁄° *
e°r
, c⁄° *
fûe
, 
löe
);

2412 
	`_£rvîP™ic
(c⁄° *
fûe
, 
löe
, c⁄° *
msg
, ...);

2413 
	`bugRï‹tSèπ
();

2414 
	`£rvîLogObje˘DebugInfo
(c⁄° 
robj
 *
o
);

2415 
	`sig£gvH™dÀr
(
sig
, 
sigöfo_t
 *
öfo
, *
£¸ë
);

2416 
sds
 
	`gíRedisInfoSåög
(c⁄° *
£˘i⁄
);

2417 
sds
 
	`gíModuÀsInfoSåög
(sd†
öfo
);

2418 
	`íabÀW©chdog
(
≥riod
);

2419 
	`dißbÀW©chdog
();

2420 
	`w©chdogScheduÀSig«l
(
≥riod
);

2421 
	`£rvîLogHexDump
(
Àvñ
, *
des¸
, *
vÆue
, 
size_t
 
Àn
);

2422 
	`memã°_¥e£rvög_ã°
(*
m
, 
size_t
 
byãs
, 
∑s£s
);

2423 
	`mixDige°
(*
dige°
, *
±r
, 
size_t
 
Àn
);

2424 
	`x‹Dige°
(*
dige°
, *
±r
, 
size_t
 
Àn
);

2425 
	`p›uœãComm™dTabÀP¨£Fœgs
(
ªdisComm™d
 *
c
, *
°rÊags
);

2428 
	`ésInô
();

2429 
	`ésC⁄figuª
(
ªdisTLSC⁄ãxtC⁄fig
 *
˘x_c⁄fig
);

2431 
	#ªdisDebug
(
fmt
, ...) \

2432 
	`¥ötf
("DEBUG %s:%d > " 
fmt
 "\n", 
__FILE__
, 
__LINE__
, 
__VA_ARGS__
)

	)

2433 
	#ªdisDebugM¨k
() \

2434 
	`¥ötf
("-- MARK %s:%d --\n", 
__FILE__
, 
__LINE__
)

	)

2436 
	`iAmMa°î
();

	@setcpuaffinity.c

26 #i‚de‡
_GNU_SOURCE


27 
	#_GNU_SOURCE


	)

29 
	~<°dlib.h
>

30 
	~<°rög.h
>

31 
	~<˘y≥.h
>

32 #ifde‡
__löux__


33 
	~<sched.h
>

35 #ifde‡
__FªeBSD__


36 
	~<sys/∑øm.h
>

37 
	~<sys/˝u£t.h
>

39 #ifde‡
__NëBSD__


40 
	~<±hªad.h
>

41 
	~<sched.h
>

43 
	~"c⁄fig.h
"

45 #ifde‡
USE_SETCPUAFFINITY


46 c⁄° *
	$√xt_tokí
(c⁄° *
q
, 
£p
) {

47 i‡(
q
)

48 
q
 = 
	`°rchr
(q, 
£p
);

49 i‡(
q
)

50 
q
++;

52  
q
;

53 
	}
}

55 
	$√xt_num
(c⁄° *
°r
, **
íd
, *
ªsu…
) {

56 i‡(!
°r
 || *°∏='\0' || !
	`isdigô
(*str))

59 *
ªsu…
 = 
	`°πoul
(
°r
, 
íd
, 10);

60 i‡(
°r
 =*
íd
)

64 
	}
}

69 
	$£t˝uafföôy
(c⁄° *
˝uli°
) {

70 c⁄° *
p
, *
q
;

71 *
íd
 = 
NULL
;

72 #ifde‡
__löux__


73 
˝u_£t_t
 
˝u£t
;

75 #ifde‡
__FªeBSD__


76 
˝u£t_t
 
˝u£t
;

78 #ifde‡
__NëBSD__


79 
˝u£t_t
 *
˝u£t
;

82 i‡(!
˝uli°
)

85 #i‚de‡
__NëBSD__


86 
	`CPU_ZERO
(&
˝u£t
);

88 
˝u£t
 = 
	`˝u£t_¸óã
();

91 
q
 = 
˝uli°
;

92 
p
 = 
q
, q = 
	`√xt_tokí
(q, ','),Ö) {

93 
a
, 
b
, 
s
;

94 c⁄° *
c1
, *
c2
;

96 i‡(
	`√xt_num
(
p
, &
íd
, &
a
) != 0)

99 
b
 = 
a
;

100 
s
 = 1;

101 
p
 = 
íd
;

103 
c1
 = 
	`√xt_tokí
(
p
, '-');

104 
c2
 = 
	`√xt_tokí
(
p
, ',');

106 i‡(
c1
 !
NULL
 && (
c2
 == NULL || c1 < c2)) {

107 i‡(
	`√xt_num
(
c1
, &
íd
, &
b
) != 0)

110 
c1
 = 
íd
 && *íd ? 
	`√xt_tokí
”nd, ':'Ë: 
NULL
;

111 i‡(
c1
 !
NULL
 && (
c2
 == NULL || c1 < c2)) {

112 i‡(
	`√xt_num
(
c1
, &
íd
, &
s
) != 0)

115 i‡(
s
 == 0)

120 i‡((
a
 > 
b
))

123 
a
 <
b
) {

124 #i‚de‡
__NëBSD__


125 
	`CPU_SET
(
a
, &
˝u£t
);

127 
	`˝u£t_£t
(
a
, 
˝u£t
);

129 
a
 +
s
;

133 i‡(
íd
 && *end)

136 #ifde‡
__löux__


137 
	`sched_£èfföôy
(0, (
˝u£t
), &cpuset);

139 #ifde‡
__FªeBSD__


140 
	`˝u£t_£èfföôy
(
CPU_LEVEL_WHICH
, 
CPU_WHICH_TID
, -1, (
˝u£t
), &cpuset);

142 #ifde‡
__NëBSD__


143 
	`±hªad_£èfföôy_≈
(
	`±hªad_£lf
(), 
	`˝u£t_size
(
˝u£t
), cpuset);

144 
	`˝u£t_de°roy
(
˝u£t
);

146 
	}
}

	@setproctitle.c

28 #i‚de‡
_GNU_SOURCE


29 
	#_GNU_SOURCE


	)

32 
	~<°ddef.h
>

33 
	~<°d¨g.h
>

34 
	~<°dlib.h
>

35 
	~<°dio.h
>

37 
	~<°rög.h
>

39 
	~<î∫o.h
>

41 #i‡!
deföed
(
HAVE_SETPROCTITLE
)

42 #i‡(
deföed
 
__NëBSD__
 || deföed 
__FªeBSD__
 || deföed 
__O≥nBSD__
 || deföed 
__Døg⁄Fly__
)

43 
	#HAVE_SETPROCTITLE
 1

	)

45 
	#HAVE_SETPROCTITLE
 0

	)

50 #i‡!
HAVE_SETPROCTITLE


51 #i‡(
deföed
 
__löux
 || deföed 
__APPLE__
)

53 **
ívú⁄
;

57 c⁄° *
	m¨g0
;

60 *
	mba£
, *
	míd
;

63 *
	mnul
;

65 
_Boﬁ
 
	mª£t
;

66 
	mîr‹
;

67 } 
	gSPT
;

70 #i‚de‡
SPT_MIN


71 
	#SPT_MIN
(
a
, 
b
Ë((◊Ë< (b))? (aË: (b))

	)

74 
ölöe
 
size_t
 
	$•t_mö
(
size_t
 
a
, size_à
b
) {

75  
	`SPT_MIN
(
a
, 
b
);

76 
	}
}

83 
	$•t_˛óªnv
() {

84 #i‡
__GLIBC__


85 
	`˛óªnv
();

89 **
ívú⁄
;

90 **
tmp
;

92 i‡(!(
tmp
 = 
	`mÆloc
( *tmp)))

93  
î∫o
;

95 
tmp
[0] = 
NULL
;

96 
ívú⁄
 = 
tmp
;

100 
	}
}

103 
	$•t_c›yív
(*
ﬁdív
[]) {

104 **
ívú⁄
;

105 *
eq
;

106 
i
, 
îr‹
;

108 i‡(
ívú⁄
 !
ﬁdív
)

111 i‡((
îr‹
 = 
	`•t_˛óªnv
()))

112 
îr‹
;

114 
i
 = 0; 
ﬁdív
[i]; i++) {

115 i‡(!(
eq
 = 
	`°rchr
(
ﬁdív
[
i
], '=')))

118 *
eq
 = '\0';

119 
îr‹
 = (0 !
	`£ãnv
(
ﬁdív
[
i
], 
eq
 + 1, 1))? 
î∫o
 : 0;

120 *
eq
 = '=';

122 i‡(
îr‹
)

123 
îr‹
;

127 
îr‹
:

128 
ívú⁄
 = 
ﬁdív
;

130  
îr‹
;

131 
	}
}

134 
	$•t_c›y¨gs
(
¨gc
, *
¨gv
[]) {

135 *
tmp
;

136 
i
;

138 
i
 = 1; i < 
¨gc
 || (ò>¨g¯&& 
¨gv
[i]); i++) {

139 i‡(!
¨gv
[
i
])

142 i‡(!(
tmp
 = 
	`°rdup
(
¨gv
[
i
])))

143  
î∫o
;

145 
¨gv
[
i
] = 
tmp
;

149 
	}
}

152 
	$•t_öô
(
¨gc
, *
¨gv
[]) {

153 **
ívp
 = 
ívú⁄
;

154 *
ba£
, *
íd
, *
nul
, *
tmp
;

155 
i
, 
îr‹
;

157 i‡(!(
ba£
 = 
¨gv
[0]))

160 
nul
 = &
ba£
[
	`°æí
(base)];

161 
íd
 = 
nul
 + 1;

163 
i
 = 0; i < 
¨gc
 || (ò>¨g¯&& 
¨gv
[i]); i++) {

164 i‡(!
¨gv
[
i
] ||árgv[i] < 
íd
)

167 
íd
 = 
¨gv
[
i
] + 
	`°æí
(argv[i]) + 1;

170 
i
 = 0; 
ívp
[i]; i++) {

171 i‡(
ívp
[
i
] < 
íd
)

174 
íd
 = 
ívp
[
i
] + 
	`°æí
(envp[i]) + 1;

177 i‡(!(
SPT
.
¨g0
 = 
	`°rdup
(
¨gv
[0])))

178 
syîr
;

180 #i‡
__GLIBC__


181 i‡(!(
tmp
 = 
	`°rdup
(
¥ogøm_övoˇti⁄_«me
)))

182 
syîr
;

184 
¥ogøm_övoˇti⁄_«me
 = 
tmp
;

186 i‡(!(
tmp
 = 
	`°rdup
(
¥ogøm_övoˇti⁄_sh‹t_«me
)))

187 
syîr
;

189 
¥ogøm_övoˇti⁄_sh‹t_«me
 = 
tmp
;

190 #ñi‡
__APPLE__


191 i‡(!(
tmp
 = 
	`°rdup
(
	`gë¥og«me
())))

192 
syîr
;

194 
	`£çrog«me
(
tmp
);

198 i‡((
îr‹
 = 
	`•t_c›yív
(
ívp
)))

199 
îr‹
;

201 i‡((
îr‹
 = 
	`•t_c›y¨gs
(
¨gc
, 
¨gv
)))

202 
îr‹
;

204 
SPT
.
nul
 =Çul;

205 
SPT
.
ba£
 = base;

206 
SPT
.
íd
 =Énd;

209 
syîr
:

210 
îr‹
 = 
î∫o
;

211 
îr‹
:

212 
SPT
.
îr‹
 =Érror;

213 
	}
}

216 #i‚de‡
SPT_MAXTITLE


217 
	#SPT_MAXTITLE
 255

	)

220 
	$£çro˘ôÀ
(c⁄° *
fmt
, ...) {

221 
buf
[
SPT_MAXTITLE
 + 1];

222 
va_li°
 
≠
;

223 *
nul
;

224 
Àn
, 
îr‹
;

226 i‡(!
SPT
.
ba£
)

229 i‡(
fmt
) {

230 
	`va_°¨t
(
≠
, 
fmt
);

231 
Àn
 = 
	`v¢¥ötf
(
buf
,  buf, 
fmt
, 
≠
);

232 
	`va_íd
(
≠
);

234 
Àn
 = 
	`¢¥ötf
(
buf
,  buf, "%s", 
SPT
.
¨g0
);

237 i‡(
Àn
 <= 0)

238 { 
îr‹
 = 
î∫o
; error; }

240 i‡(!
SPT
.
ª£t
) {

241 
	`mem£t
(
SPT
.
ba£
, 0, SPT.
íd
 - SPT.base);

242 
SPT
.
ª£t
 = 1;

244 
	`mem£t
(
SPT
.
ba£
, 0, 
	`•t_mö
( 
buf
, SPT.
íd
 - SPT.base));

247 
Àn
 = 
	`•t_mö
÷í, s±_mö( 
buf
, 
SPT
.
íd
 - SPT.
ba£
) - 1);

248 
	`mem˝y
(
SPT
.
ba£
, 
buf
, 
Àn
);

249 
nul
 = &
SPT
.
ba£
[
Àn
];

251 i‡(
nul
 < 
SPT
.nul) {

252 *
SPT
.
nul
 = '.';

253 } i‡(
nul
 =
SPT
.nu»&& &nul[1] < SPT.
íd
) {

254 *
SPT
.
nul
 = ' ';

255 *++
nul
 = '\0';

259 
îr‹
:

260 
SPT
.
îr‹
 =Érror;

261 
	}
}

	@sha1.c

22 
	#SHA1HANDSOFF


	)

24 
	~<°dio.h
>

25 
	~<°rög.h
>

26 
	~<°döt.h
>

27 
	~"sﬁ¨isfixes.h
"

28 
	~"sha1.h
"

29 
	~"c⁄fig.h
"

31 
	#rﬁ
(
vÆue
, 
bôs
Ë(((vÆueË<< (bôs)Ë| ((vÆueË>> (32 - (bôs))))

	)

35 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


36 
	#blk0
(
i
Ë(
block
->
l
[i] = (
	`rﬁ
(block->l[i],24)&0xFF00FF00) \

37 |(
	`rﬁ
(
block
->
l
[
i
],8)&0x00FF00FF))

	)

38 #ñi‡
BYTE_ORDER
 =
BIG_ENDIAN


39 
	#blk0
(
i
Ë
block
->
l
[i]

	)

43 
	#blk
(
i
Ë(
block
->
l
[i&15] = 
	`rﬁ
(block->l[(i+13)&15]^block->l[(i+8)&15] \

44 ^
block
->
l
[(
i
+2)&15]^block->l[i&15],1))

	)

47 
	#R0
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=((w&(x^y))^y)+
	`blk0
(i)+0x5A827999+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

48 
	#R1
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=((w&(x^y))^y)+
	`blk
(i)+0x5A827999+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

49 
	#R2
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=(w^x^y)+
	`blk
(i)+0x6ED9EBA1+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

50 
	#R3
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=(((w|x)&y)|(w&x))+
	`blk
(i)+0x8F1BBCDC+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

51 
	#R4
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=(w^x^y)+
	`blk
(i)+0xCA62C1D6+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

56 
	$SHA1Tønsf‹m
(
uöt32_t
 
°©e
[5], c⁄° 
buf„r
[64])

58 
uöt32_t
 
a
, 
b
, 
c
, 
d
, 
e
;

60 
c
[64];

61 
uöt32_t
 
l
[16];

62 } 
	tCHAR64LONG16
;

63 #ifde‡
SHA1HANDSOFF


64 
CHAR64LONG16
 
block
[1];

65 
	`mem˝y
(
block
, 
buf„r
, 64);

72 
CHAR64LONG16
* 
block
 = (c⁄° CHAR64LONG16*)
buf„r
;

75 
a
 = 
°©e
[0];

76 
b
 = 
°©e
[1];

77 
c
 = 
°©e
[2];

78 
d
 = 
°©e
[3];

79 
e
 = 
°©e
[4];

81 
	`R0
(
a
,
b
,
c
,
d
,
e
, 0); R0(e,a,b,c,d, 1); R0(d,e,a,b,c, 2); R0(c,d,e,a,b, 3);

82 
	`R0
(
b
,
c
,
d
,
e
,
a
, 4); R0(a,b,c,d,e, 5); R0(e,a,b,c,d, 6); R0(d,e,a,b,c, 7);

83 
	`R0
(
c
,
d
,
e
,
a
,
b
, 8); R0(b,c,d,e,a, 9); R0(a,b,c,d,e,10); R0(e,a,b,c,d,11);

84 
	`R0
(
d
,
e
,
a
,
b
,
c
,12); R0(c,d,e,a,b,13); R0(b,c,d,e,a,14); R0(a,b,c,d,e,15);

85 
	`R1
(
e
,
a
,
b
,
c
,
d
,16); R1(d,e,a,b,c,17); R1(c,d,e,a,b,18); R1(b,c,d,e,a,19);

86 
	`R2
(
a
,
b
,
c
,
d
,
e
,20); R2(e,a,b,c,d,21); R2(d,e,a,b,c,22); R2(c,d,e,a,b,23);

87 
	`R2
(
b
,
c
,
d
,
e
,
a
,24); R2(a,b,c,d,e,25); R2(e,a,b,c,d,26); R2(d,e,a,b,c,27);

88 
	`R2
(
c
,
d
,
e
,
a
,
b
,28); R2(b,c,d,e,a,29); R2(a,b,c,d,e,30); R2(e,a,b,c,d,31);

89 
	`R2
(
d
,
e
,
a
,
b
,
c
,32); R2(c,d,e,a,b,33); R2(b,c,d,e,a,34); R2(a,b,c,d,e,35);

90 
	`R2
(
e
,
a
,
b
,
c
,
d
,36); R2(d,e,a,b,c,37); R2(c,d,e,a,b,38); R2(b,c,d,e,a,39);

91 
	`R3
(
a
,
b
,
c
,
d
,
e
,40); R3(e,a,b,c,d,41); R3(d,e,a,b,c,42); R3(c,d,e,a,b,43);

92 
	`R3
(
b
,
c
,
d
,
e
,
a
,44); R3(a,b,c,d,e,45); R3(e,a,b,c,d,46); R3(d,e,a,b,c,47);

93 
	`R3
(
c
,
d
,
e
,
a
,
b
,48); R3(b,c,d,e,a,49); R3(a,b,c,d,e,50); R3(e,a,b,c,d,51);

94 
	`R3
(
d
,
e
,
a
,
b
,
c
,52); R3(c,d,e,a,b,53); R3(b,c,d,e,a,54); R3(a,b,c,d,e,55);

95 
	`R3
(
e
,
a
,
b
,
c
,
d
,56); R3(d,e,a,b,c,57); R3(c,d,e,a,b,58); R3(b,c,d,e,a,59);

96 
	`R4
(
a
,
b
,
c
,
d
,
e
,60); R4(e,a,b,c,d,61); R4(d,e,a,b,c,62); R4(c,d,e,a,b,63);

97 
	`R4
(
b
,
c
,
d
,
e
,
a
,64); R4(a,b,c,d,e,65); R4(e,a,b,c,d,66); R4(d,e,a,b,c,67);

98 
	`R4
(
c
,
d
,
e
,
a
,
b
,68); R4(b,c,d,e,a,69); R4(a,b,c,d,e,70); R4(e,a,b,c,d,71);

99 
	`R4
(
d
,
e
,
a
,
b
,
c
,72); R4(c,d,e,a,b,73); R4(b,c,d,e,a,74); R4(a,b,c,d,e,75);

100 
	`R4
(
e
,
a
,
b
,
c
,
d
,76); R4(d,e,a,b,c,77); R4(c,d,e,a,b,78); R4(b,c,d,e,a,79);

102 
°©e
[0] +
a
;

103 
°©e
[1] +
b
;

104 
°©e
[2] +
c
;

105 
°©e
[3] +
d
;

106 
°©e
[4] +
e
;

108 
a
 = 
b
 = 
c
 = 
d
 = 
e
 = 0;

109 #ifde‡
SHA1HANDSOFF


110 
	`mem£t
(
block
, '\0', (block));

112 
	}
}

117 
	$SHA1Inô
(
SHA1_CTX
* 
c⁄ãxt
)

120 
c⁄ãxt
->
°©e
[0] = 0x67452301;

121 
c⁄ãxt
->
°©e
[1] = 0xEFCDAB89;

122 
c⁄ãxt
->
°©e
[2] = 0x98BADCFE;

123 
c⁄ãxt
->
°©e
[3] = 0x10325476;

124 
c⁄ãxt
->
°©e
[4] = 0xC3D2E1F0;

125 
c⁄ãxt
->
cou¡
[0] = context->count[1] = 0;

126 
	}
}

131 
	$SHA1Upd©e
(
SHA1_CTX
* 
c⁄ãxt
, c⁄° * 
d©a
, 
uöt32_t
 
Àn
)

133 
uöt32_t
 
i
, 
j
;

135 
j
 = 
c⁄ãxt
->
cou¡
[0];

136 i‡((
c⁄ãxt
->
cou¡
[0] +
Àn
 << 3Ë< 
j
)

137 
c⁄ãxt
->
cou¡
[1]++;

138 
c⁄ãxt
->
cou¡
[1] +(
Àn
>>29);

139 
j
 = (j >> 3) & 63;

140 i‡((
j
 + 
Àn
) > 63) {

141 
	`mem˝y
(&
c⁄ãxt
->
buf„r
[
j
], 
d©a
, (
i
 = 64-j));

142 
	`SHA1Tønsf‹m
(
c⁄ãxt
->
°©e
, c⁄ãxt->
buf„r
);

143  ; 
i
 + 63 < 
Àn
; i += 64) {

144 
	`SHA1Tønsf‹m
(
c⁄ãxt
->
°©e
, &
d©a
[
i
]);

146 
j
 = 0;

148 
i
 = 0;

149 
	`mem˝y
(&
c⁄ãxt
->
buf„r
[
j
], &
d©a
[
i
], 
Àn
 - i);

150 
	}
}

155 
	$SHA1FöÆ
(
dige°
[20], 
SHA1_CTX
* 
c⁄ãxt
)

157 
i
;

158 
föÆcou¡
[8];

159 
c
;

167 *
f˝
 = &
föÆcou¡
[8];

169 
i
 = 0; i < 2; i++)

171 
uöt32_t
 
t
 = 
c⁄ãxt
->
cou¡
[
i
];

172 
j
;

174 
j
 = 0; j < 4; 
t
 >>= 8, j++)

175 *--
f˝
 = (Ë
t
;

178 
i
 = 0; i < 8; i++) {

179 
föÆcou¡
[
i
] = ()((
c⁄ãxt
->
cou¡
[(i >= 4 ? 0 : 1)]

180 >> ((3-(
i
 & 3)) * 8) ) & 255);

183 
c
 = 0200;

184 
	`SHA1Upd©e
(
c⁄ãxt
, &
c
, 1);

185 (
c⁄ãxt
->
cou¡
[0] & 504) != 448) {

186 
c
 = 0000;

187 
	`SHA1Upd©e
(
c⁄ãxt
, &
c
, 1);

189 
	`SHA1Upd©e
(
c⁄ãxt
, 
föÆcou¡
, 8);

190 
i
 = 0; i < 20; i++) {

191 
dige°
[
i
] = ()

192 ((
c⁄ãxt
->
°©e
[
i
>>2] >> ((3-(i & 3)) * 8) ) & 255);

195 
	`mem£t
(
c⁄ãxt
, '\0', (*context));

196 
	`mem£t
(&
föÆcou¡
, '\0', (finalcount));

197 
	}
}

200 #ifde‡
REDIS_TEST


201 
	#BUFSIZE
 4096

	)

203 
	#UNUSED
(
x
Ë()(x)

	)

204 
	$sha1Te°
(
¨gc
, **
¨gv
)

206 
SHA1_CTX
 
˘x
;

207 
hash
[20], 
buf
[
BUFSIZE
];

208 
i
;

210 
	`UNUSED
(
¨gc
);

211 
	`UNUSED
(
¨gv
);

213 
i
=0;i<
BUFSIZE
;i++)

214 
buf
[
i
] = i;

216 
	`SHA1Inô
(&
˘x
);

217 
i
=0;i<1000;i++)

218 
	`SHA1Upd©e
(&
˘x
, 
buf
, 
BUFSIZE
);

219 
	`SHA1FöÆ
(
hash
, &
˘x
);

221 
	`¥ötf
("SHA1=");

222 
i
=0;i<20;i++)

223 
	`¥ötf
("%02x", 
hash
[
i
]);

224 
	`¥ötf
("\n");

226 
	}
}

	@sha1.h

1 #i‚de‡
SHA1_H


2 
	#SHA1_H


	)

11 
uöt32_t
 
	m°©e
[5];

12 
uöt32_t
 
	mcou¡
[2];

13 
	mbuf„r
[64];

14 } 
	tSHA1_CTX
;

16 
SHA1Tønsf‹m
(
uöt32_t
 
°©e
[5], c⁄° 
buf„r
[64]);

17 
SHA1Inô
(
SHA1_CTX
* 
c⁄ãxt
);

18 
SHA1Upd©e
(
SHA1_CTX
* 
c⁄ãxt
, c⁄° * 
d©a
, 
uöt32_t
 
Àn
);

19 
SHA1FöÆ
(
dige°
[20], 
SHA1_CTX
* 
c⁄ãxt
);

21 #ifde‡
REDIS_TEST


22 
sha1Te°
(
¨gc
, **
¨gv
);

	@sha256.c

16 
	~<°dlib.h
>

17 
	~<°rög.h
>

18 
	~"sha256.h
"

21 
	#ROTLEFT
(
a
,
b
Ë((◊Ë<< (b)Ë| (◊Ë>> (32-(b))))

	)

22 
	#ROTRIGHT
(
a
,
b
Ë((◊Ë>> (b)Ë| (◊Ë<< (32-(b))))

	)

24 
	#CH
(
x
,
y
,
z
Ë(((xË& (y)Ë^ (~(xË& (z)))

	)

25 
	#MAJ
(
x
,
y
,
z
Ë(((xË& (y)Ë^ ((xË& (z)Ë^ ((yË& (z)))

	)

26 
	#EP0
(
x
Ë(
	`ROTRIGHT
(x,2Ë^ ROTRIGHT(x,13Ë^ ROTRIGHT(x,22))

	)

27 
	#EP1
(
x
Ë(
	`ROTRIGHT
(x,6Ë^ ROTRIGHT(x,11Ë^ ROTRIGHT(x,25))

	)

28 
	#SIG0
(
x
Ë(
	`ROTRIGHT
(x,7Ë^ ROTRIGHT(x,18Ë^ ((xË>> 3))

	)

29 
	#SIG1
(
x
Ë(
	`ROTRIGHT
(x,17Ë^ ROTRIGHT(x,19Ë^ ((xË>> 10))

	)

32 c⁄° 
WORD
 
	gk
[64] = {

44 
	$sha256_å™sf‹m
(
SHA256_CTX
 *
˘x
, c⁄° 
BYTE
 
d©a
[])

46 
WORD
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
i
, 
j
, 
t1
, 
t2
, 
m
[64];

48 
i
 = 0, 
j
 = 0; i < 16; ++i, j += 4)

49 
m
[
i
] = (
d©a
[
j
] << 24) | (data[j + 1] << 16) | (data[j + 2] << 8) | (data[j + 3]);

50  ; 
i
 < 64; ++i)

51 
m
[
i
] = 
	`SIG1
(m[ò- 2]Ë+ m[ò- 7] + 
	`SIG0
(m[i - 15]) + m[i - 16];

53 
a
 = 
˘x
->
°©e
[0];

54 
b
 = 
˘x
->
°©e
[1];

55 
c
 = 
˘x
->
°©e
[2];

56 
d
 = 
˘x
->
°©e
[3];

57 
e
 = 
˘x
->
°©e
[4];

58 
f
 = 
˘x
->
°©e
[5];

59 
g
 = 
˘x
->
°©e
[6];

60 
h
 = 
˘x
->
°©e
[7];

62 
i
 = 0; i < 64; ++i) {

63 
t1
 = 
h
 + 
	`EP1
(
e
Ë+ 
	`CH
”,
f
,
g
Ë+ 
k
[
i
] + 
m
[i];

64 
t2
 = 
	`EP0
(
a
Ë+ 
	`MAJ
◊,
b
,
c
);

65 
h
 = 
g
;

66 
g
 = 
f
;

67 
f
 = 
e
;

68 
e
 = 
d
 + 
t1
;

69 
d
 = 
c
;

70 
c
 = 
b
;

71 
b
 = 
a
;

72 
a
 = 
t1
 + 
t2
;

75 
˘x
->
°©e
[0] +
a
;

76 
˘x
->
°©e
[1] +
b
;

77 
˘x
->
°©e
[2] +
c
;

78 
˘x
->
°©e
[3] +
d
;

79 
˘x
->
°©e
[4] +
e
;

80 
˘x
->
°©e
[5] +
f
;

81 
˘x
->
°©e
[6] +
g
;

82 
˘x
->
°©e
[7] +
h
;

83 
	}
}

85 
	$sha256_öô
(
SHA256_CTX
 *
˘x
)

87 
˘x
->
d©Æí
 = 0;

88 
˘x
->
bôÀn
 = 0;

89 
˘x
->
°©e
[0] = 0x6a09e667;

90 
˘x
->
°©e
[1] = 0xbb67ae85;

91 
˘x
->
°©e
[2] = 0x3c6ef372;

92 
˘x
->
°©e
[3] = 0xa54ff53a;

93 
˘x
->
°©e
[4] = 0x510e527f;

94 
˘x
->
°©e
[5] = 0x9b05688c;

95 
˘x
->
°©e
[6] = 0x1f83d9ab;

96 
˘x
->
°©e
[7] = 0x5be0cd19;

97 
	}
}

99 
	$sha256_upd©e
(
SHA256_CTX
 *
˘x
, c⁄° 
BYTE
 
d©a
[], 
size_t
 
Àn
)

101 
WORD
 
i
;

103 
i
 = 0; i < 
Àn
; ++i) {

104 
˘x
->
d©a
[˘x->
d©Æí
] = d©a[
i
];

105 
˘x
->
d©Æí
++;

106 i‡(
˘x
->
d©Æí
 == 64) {

107 
	`sha256_å™sf‹m
(
˘x
, ctx->
d©a
);

108 
˘x
->
bôÀn
 += 512;

109 
˘x
->
d©Æí
 = 0;

112 
	}
}

114 
	$sha256_föÆ
(
SHA256_CTX
 *
˘x
, 
BYTE
 
hash
[])

116 
WORD
 
i
;

118 
i
 = 
˘x
->
d©Æí
;

121 i‡(
˘x
->
d©Æí
 < 56) {

122 
˘x
->
d©a
[
i
++] = 0x80;

123 
i
 < 56)

124 
˘x
->
d©a
[
i
++] = 0x00;

127 
˘x
->
d©a
[
i
++] = 0x80;

128 
i
 < 64)

129 
˘x
->
d©a
[
i
++] = 0x00;

130 
	`sha256_å™sf‹m
(
˘x
, ctx->
d©a
);

131 
	`mem£t
(
˘x
->
d©a
, 0, 56);

135 
˘x
->
bôÀn
 +˘x->
d©Æí
 * 8;

136 
˘x
->
d©a
[63] = ctx->
bôÀn
;

137 
˘x
->
d©a
[62] = ctx->
bôÀn
 >> 8;

138 
˘x
->
d©a
[61] = ctx->
bôÀn
 >> 16;

139 
˘x
->
d©a
[60] = ctx->
bôÀn
 >> 24;

140 
˘x
->
d©a
[59] = ctx->
bôÀn
 >> 32;

141 
˘x
->
d©a
[58] = ctx->
bôÀn
 >> 40;

142 
˘x
->
d©a
[57] = ctx->
bôÀn
 >> 48;

143 
˘x
->
d©a
[56] = ctx->
bôÀn
 >> 56;

144 
	`sha256_å™sf‹m
(
˘x
, ctx->
d©a
);

148 
i
 = 0; i < 4; ++i) {

149 
hash
[
i
] = (
˘x
->
°©e
[0] >> (24 - i * 8)) & 0x000000ff;

150 
hash
[
i
 + 4] = (
˘x
->
°©e
[1] >> (24 - i * 8)) & 0x000000ff;

151 
hash
[
i
 + 8] = (
˘x
->
°©e
[2] >> (24 - i * 8)) & 0x000000ff;

152 
hash
[
i
 + 12] = (
˘x
->
°©e
[3] >> (24 - i * 8)) & 0x000000ff;

153 
hash
[
i
 + 16] = (
˘x
->
°©e
[4] >> (24 - i * 8)) & 0x000000ff;

154 
hash
[
i
 + 20] = (
˘x
->
°©e
[5] >> (24 - i * 8)) & 0x000000ff;

155 
hash
[
i
 + 24] = (
˘x
->
°©e
[6] >> (24 - i * 8)) & 0x000000ff;

156 
hash
[
i
 + 28] = (
˘x
->
°©e
[7] >> (24 - i * 8)) & 0x000000ff;

158 
	}
}

	@sha256.h

9 #i‚de‡
SHA256_H


10 
	#SHA256_H


	)

13 
	~<°ddef.h
>

14 
	~<°döt.h
>

17 
	#SHA256_BLOCK_SIZE
 32

18 

	)

20 
uöt8_t
 
	tBYTE
;

21 
uöt32_t
 
	tWORD
;

24 
BYTE
 
	md©a
[64];

25 
WORD
 
	md©Æí
;

26 
	mbôÀn
;

27 
WORD
 
	m°©e
[8];

28 } 
	tSHA256_CTX
;

31 
sha256_öô
(
SHA256_CTX
 *
˘x
);

32 
sha256_upd©e
(
SHA256_CTX
 *
˘x
, c⁄° 
BYTE
 
d©a
[], 
size_t
 
Àn
);

33 
sha256_föÆ
(
SHA256_CTX
 *
˘x
, 
BYTE
 
hash
[]);

	@siphash.c

42 
	~<as£π.h
>

43 
	~<°döt.h
>

44 
	~<°dio.h
>

45 
	~<°rög.h
>

46 
	~<˘y≥.h
>

50 
	$sùéw
(
c
) {

51 i‡(
c
 >= 'A' && c <= 'Z') {

52  
c
+('a'-'A');

54  
c
;

56 
	}
}

61 #i‡
deföed
(
__X86_64__
Ë|| deföed(
__x86_64__
Ë|| deföed (
__i386__
) \

62 || 
deföed
 (
__Ørch64__
Ë|| 
	$deföed
 (
__¨m64__
)

63 
	#UNALIGNED_LE_CPU


	)

66 
	#ROTL
(
x
, 
b
Ë(
uöt64_t
)(((xË<< (b)Ë| ((xË>> (64 - (b))))

	)

68 
	#U32TO8_LE
(
p
, 
v
) \

69 (
p
)[0] = (
uöt8_t
)((
v
)); \

70 (
p
)[1] = (
uöt8_t
)((
v
) >> 8); \

71 (
p
)[2] = (
uöt8_t
)((
v
) >> 16); \

72 (
p
)[3] = (
uöt8_t
)((
v
Ë>> 24);

	)

74 
	#U64TO8_LE
(
p
, 
v
) \

75 
	`U32TO8_LE
((
p
), (
uöt32_t
)((
v
))); \

76 
	`U32TO8_LE
((
p
Ë+ 4, (
uöt32_t
)((
v
Ë>> 32));

	)

78 #ifde‡
UNALIGNED_LE_CPU


79 
	#U8TO64_LE
(
p
Ë(*((
uöt64_t
*)’)))

	)

81 
	#U8TO64_LE
(
p
) \

82 (((
uöt64_t
)((
p
)[0])) | ((uint64_t)((p)[1]) << 8) | \

83 ((
uöt64_t
)((
p
)[2]) << 16) | ((uint64_t)((p)[3]) << 24) | \

84 ((
uöt64_t
)((
p
)[4]) << 32) | ((uint64_t)((p)[5]) << 40) | \

85 ((
uöt64_t
)((
p
)[6]Ë<< 48Ë| ((uöt64_t)(’)[7]Ë<< 56))

	)

88 
	#U8TO64_LE_NOCASE
(
p
) \

89 (((
uöt64_t
)(
	`sùéw
((
p
)[0]))) | \

90 ((
uöt64_t
)(
	`sùéw
((
p
)[1])) << 8) | \

91 ((
uöt64_t
)(
	`sùéw
((
p
)[2])) << 16) | \

92 ((
uöt64_t
)(
	`sùéw
((
p
)[3])) << 24) | \

93 ((
uöt64_t
)(
	`sùéw
((
p
)[4])) << 32) | \

94 ((
uöt64_t
)(
	`sùéw
((
p
)[5])) << 40) | \

95 ((
uöt64_t
)(
	`sùéw
((
p
)[6])) << 48) | \

96 ((
uöt64_t
)(
	`sùéw
((
p
)[7])Ë<< 56))

	)

98 
	#SIPROUND
 \

100 
v0
 +
v1
; \

101 
v1
 = 
	`ROTL
(v1, 13); \

102 
v1
 ^
v0
; \

103 
v0
 = 
	`ROTL
(v0, 32); \

104 
v2
 +
v3
; \

105 
v3
 = 
	`ROTL
(v3, 16); \

106 
v3
 ^
v2
; \

107 
v0
 +
v3
; \

108 
v3
 = 
	`ROTL
(v3, 21); \

109 
v3
 ^
v0
; \

110 
v2
 +
v1
; \

111 
v1
 = 
	`ROTL
(v1, 17); \

112 
v1
 ^
v2
; \

113 
v2
 = 
	`ROTL
(v2, 32); \

114 
	}
} 0)

	)

116 
uöt64_t
 
	$sùhash
(c⁄° 
uöt8_t
 *
ö
, c⁄° 
size_t
 
öÀn
, c⁄° uöt8_à*
k
) {

117 #i‚de‡
UNALIGNED_LE_CPU


118 
uöt64_t
 
hash
;

119 
uöt8_t
 *
out
 = (uöt8_t*Ë&
hash
;

121 
uöt64_t
 
v0
 = 0x736f6d6570736575ULL;

122 
uöt64_t
 
v1
 = 0x646f72616e646f6dULL;

123 
uöt64_t
 
v2
 = 0x6c7967656e657261ULL;

124 
uöt64_t
 
v3
 = 0x7465646279746573ULL;

125 
uöt64_t
 
k0
 = 
	`U8TO64_LE
(
k
);

126 
uöt64_t
 
k1
 = 
	`U8TO64_LE
(
k
 + 8);

127 
uöt64_t
 
m
;

128 c⁄° 
uöt8_t
 *
íd
 = 
ö
 + 
öÀn
 - (öÀ¿% (
uöt64_t
));

129 c⁄° 
À·
 = 
öÀn
 & 7;

130 
uöt64_t
 
b
 = ((uöt64_t)
öÀn
) << 56;

131 
v3
 ^
k1
;

132 
v2
 ^
k0
;

133 
v1
 ^
k1
;

134 
v0
 ^
k0
;

136 ; 
ö
 !
íd
; in += 8) {

137 
m
 = 
	`U8TO64_LE
(
ö
);

138 
v3
 ^
m
;

140 
SIPROUND
;

142 
v0
 ^
m
;

145 
À·
) {

146 7: 
b
 |((
uöt64_t
)
ö
[6]) << 48;

147 6: 
b
 |((
uöt64_t
)
ö
[5]) << 40;

148 5: 
b
 |((
uöt64_t
)
ö
[4]) << 32;

149 4: 
b
 |((
uöt64_t
)
ö
[3]) << 24;

150 3: 
b
 |((
uöt64_t
)
ö
[2]) << 16;

151 2: 
b
 |((
uöt64_t
)
ö
[1]) << 8;

152 1: 
b
 |((
uöt64_t
)
ö
[0]); ;

156 
v3
 ^
b
;

158 
SIPROUND
;

160 
v0
 ^
b
;

161 
v2
 ^= 0xff;

163 
SIPROUND
;

164 
SIPROUND
;

166 
b
 = 
v0
 ^ 
v1
 ^ 
v2
 ^ 
v3
;

167 #i‚de‡
UNALIGNED_LE_CPU


168 
	`U64TO8_LE
(
out
, 
b
);

169  
hash
;

171  
b
;

173 
	}
}

175 
uöt64_t
 
	$sùhash_noˇ£
(c⁄° 
uöt8_t
 *
ö
, c⁄° 
size_t
 
öÀn
, c⁄° uöt8_à*
k
)

177 #i‚de‡
UNALIGNED_LE_CPU


178 
uöt64_t
 
hash
;

179 
uöt8_t
 *
out
 = (uöt8_t*Ë&
hash
;

181 
uöt64_t
 
v0
 = 0x736f6d6570736575ULL;

182 
uöt64_t
 
v1
 = 0x646f72616e646f6dULL;

183 
uöt64_t
 
v2
 = 0x6c7967656e657261ULL;

184 
uöt64_t
 
v3
 = 0x7465646279746573ULL;

185 
uöt64_t
 
k0
 = 
	`U8TO64_LE
(
k
);

186 
uöt64_t
 
k1
 = 
	`U8TO64_LE
(
k
 + 8);

187 
uöt64_t
 
m
;

188 c⁄° 
uöt8_t
 *
íd
 = 
ö
 + 
öÀn
 - (öÀ¿% (
uöt64_t
));

189 c⁄° 
À·
 = 
öÀn
 & 7;

190 
uöt64_t
 
b
 = ((uöt64_t)
öÀn
) << 56;

191 
v3
 ^
k1
;

192 
v2
 ^
k0
;

193 
v1
 ^
k1
;

194 
v0
 ^
k0
;

196 ; 
ö
 !
íd
; in += 8) {

197 
m
 = 
	`U8TO64_LE_NOCASE
(
ö
);

198 
v3
 ^
m
;

200 
SIPROUND
;

202 
v0
 ^
m
;

205 
À·
) {

206 7: 
b
 |((
uöt64_t
)
	`sùéw
(
ö
[6])) << 48;

207 6: 
b
 |((
uöt64_t
)
	`sùéw
(
ö
[5])) << 40;

208 5: 
b
 |((
uöt64_t
)
	`sùéw
(
ö
[4])) << 32;

209 4: 
b
 |((
uöt64_t
)
	`sùéw
(
ö
[3])) << 24;

210 3: 
b
 |((
uöt64_t
)
	`sùéw
(
ö
[2])) << 16;

211 2: 
b
 |((
uöt64_t
)
	`sùéw
(
ö
[1])) << 8;

212 1: 
b
 |((
uöt64_t
)
	`sùéw
(
ö
[0])); ;

216 
v3
 ^
b
;

218 
SIPROUND
;

220 
v0
 ^
b
;

221 
v2
 ^= 0xff;

223 
SIPROUND
;

224 
SIPROUND
;

226 
b
 = 
v0
 ^ 
v1
 ^ 
v2
 ^ 
v3
;

227 #i‚de‡
UNALIGNED_LE_CPU


228 
	`U64TO8_LE
(
out
, 
b
);

229  
hash
;

231  
b
;

233 
	}
}

238 #ifde‡
SIPHASH_TEST


240 c⁄° 
uöt8_t
 
	gve˘‹s_sù64
[64][8] = {

314 
	$sùhash_ã°
() {

315 
uöt8_t
 
ö
[64], 
k
[16];

316 
i
;

317 
Áûs
 = 0;

319 
i
 = 0; i < 16; ++i)

320 
k
[
i
] = i;

322 
i
 = 0; i < 64; ++i) {

323 
ö
[
i
] = i;

324 
uöt64_t
 
hash
 = 
	`sùhash
(
ö
, 
i
, 
k
);

325 c⁄° 
uöt8_t
 *
v
 = 
NULL
;

326 
v
 = (
uöt8_t
 *)
ve˘‹s_sù64
;

327 i‡(
	`memcmp
(&
hash
, 
v
 + (
i
 * 8), 8)) {

329 
Áûs
++;

334 
uöt64_t
 
h1
, 
h2
;

335 
h1
 = 
	`sùhash
((
uöt8_t
*)"hello world",11,(uint8_t*)"1234567812345678");

336 
h2
 = 
	`sùhash_noˇ£
((
uöt8_t
*)"hello world",11,(uint8_t*)"1234567812345678");

337 i‡(
h1
 !
h2
Ë
Áûs
++;

339 
h1
 = 
	`sùhash
((
uöt8_t
*)"hello world",11,(uint8_t*)"1234567812345678");

340 
h2
 = 
	`sùhash_noˇ£
((
uöt8_t
*)"HELLO world",11,(uint8_t*)"1234567812345678");

341 i‡(
h1
 !
h2
Ë
Áûs
++;

343 
h1
 = 
	`sùhash
((
uöt8_t
*)"HELLO world",11,(uint8_t*)"1234567812345678");

344 
h2
 = 
	`sùhash_noˇ£
((
uöt8_t
*)"HELLO world",11,(uint8_t*)"1234567812345678");

345 i‡(
h1
 =
h2
Ë
Áûs
++;

347 i‡(!
Áûs
)  0;

349 
	}
}

351 
	$maö
() {

352 i‡(
	`sùhash_ã°
() == 0) {

353 
	`¥ötf
("SipHashÅest: OK\n");

356 
	`¥ötf
("SipHashÅest: FAILED\n");

359 
	}
}

	@slowlog.c

42 
	~"£rvî.h
"

43 
	~"¶owlog.h
"

48 
¶owlogE¡ry
 *
	$¶owlogCª©eE¡ry
(
˛õ¡
 *
c
, 
robj
 **
¨gv
, 
¨gc
, 
duøti⁄
) {

49 
¶owlogE¡ry
 *
£
 = 
	`zmÆloc
((*se));

50 
j
, 
¶¨gc
 = 
¨gc
;

52 i‡(
¶¨gc
 > 
SLOWLOG_ENTRY_MAX_ARGC
) slargc = SLOWLOG_ENTRY_MAX_ARGC;

53 
£
->
¨gc
 = 
¶¨gc
;

54 
£
->
¨gv
 = 
	`zmÆloc
((
robj
*)*
¶¨gc
);

55 
j
 = 0; j < 
¶¨gc
; j++) {

59 i‡(
¶¨gc
 !
¨gc
 && 
j
 == slargc-1) {

60 
£
->
¨gv
[
j
] = 
	`¸óãObje˘
(
OBJ_STRING
,

61 
	`sdsˇçrötf
(
	`sd£m±y
(),"... (%d moreárguments)",

62 
¨gc
-
¶¨gc
+1));

65 i‡(
¨gv
[
j
]->
ty≥
 =
OBJ_STRING
 &&

66 
	`sdsEncodedObje˘
(
¨gv
[
j
]) &&

67 
	`sd¶í
(
¨gv
[
j
]->
±r
Ë> 
SLOWLOG_ENTRY_MAX_STRING
)

69 
sds
 
s
 = 
	`sd¢ewÀn
(
¨gv
[
j
]->
±r
, 
SLOWLOG_ENTRY_MAX_STRING
);

71 
s
 = 
	`sdsˇçrötf
(s,"... (%lu more bytes)",

73 
	`sd¶í
(
¨gv
[
j
]->
±r
Ë- 
SLOWLOG_ENTRY_MAX_STRING
);

74 
£
->
¨gv
[
j
] = 
	`¸óãObje˘
(
OBJ_STRING
,
s
);

75 } i‡(
¨gv
[
j
]->
ªfcou¡
 =
OBJ_SHARED_REFCOUNT
) {

76 
£
->
¨gv
[
j
] =árgv[j];

84 
£
->
¨gv
[
j
] = 
	`dupSåögObje˘
(argv[j]);

88 
£
->
time
 = 
	`time
(
NULL
);

89 
£
->
duøti⁄
 = duration;

90 
£
->
id
 = 
£rvî
.
¶owlog_íåy_id
++;

91 
£
->
≥îid
 = 
	`sd¢ew
(
	`gëClõ¡PìrId
(
c
));

92 
£
->
˙ame
 = 
c
->
«me
 ? 
	`sd¢ew
(c->«me->
±r
Ë: 
	`sd£m±y
();

93  
£
;

94 
	}
}

100 
	$¶owlogFªeE¡ry
(*
£±r
) {

101 
¶owlogE¡ry
 *
£
 = 
£±r
;

102 
j
;

104 
j
 = 0; j < 
£
->
¨gc
; j++)

105 
	`de¸RefCou¡
(
£
->
¨gv
[
j
]);

106 
	`z‰ì
(
£
->
¨gv
);

107 
	`sds‰ì
(
£
->
≥îid
);

108 
	`sds‰ì
(
£
->
˙ame
);

109 
	`z‰ì
(
£
);

110 
	}
}

114 
	$¶owlogInô
() {

115 
£rvî
.
¶owlog
 = 
	`li°Cª©e
();

116 
£rvî
.
¶owlog_íåy_id
 = 0;

117 
	`li°SëFªeMëhod
(
£rvî
.
¶owlog
,
¶owlogFªeE¡ry
);

118 
	}
}

123 
	$¶owlogPushE¡ryIfNìded
(
˛õ¡
 *
c
, 
robj
 **
¨gv
, 
¨gc
, 
duøti⁄
) {

124 i‡(
£rvî
.
¶owlog_log_¶owî_th™
 < 0) ;

125 i‡(
duøti⁄
 >
£rvî
.
¶owlog_log_¶owî_th™
)

126 
	`li°AddNodeHód
(
£rvî
.
¶owlog
,

127 
	`¶owlogCª©eE¡ry
(
c
,
¨gv
,
¨gc
,
duøti⁄
));

130 
	`li°Lígth
(
£rvî
.
¶owlog
Ë> sîvî.
¶owlog_max_Àn
)

131 
	`li°DñNode
(
£rvî
.
¶owlog
,
	`li°La°
(server.slowlog));

132 
	}
}

135 
	$¶owlogRe£t
() {

136 
	`li°Lígth
(
£rvî
.
¶owlog
) > 0)

137 
	`li°DñNode
(
£rvî
.
¶owlog
,
	`li°La°
(server.slowlog));

138 
	}
}

142 
	$¶owlogComm™d
(
˛õ¡
 *
c
) {

143 i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"help")) {

144 c⁄° *
hñp
[] = {

150 
NULL


152 
	`addRïlyHñp
(
c
, 
hñp
);

153 } i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"reset")) {

154 
	`¶owlogRe£t
();

155 
	`addRïly
(
c
,
sh¨ed
.
ok
);

156 } i‡(
c
->
¨gc
 =2 && !
	`°rˇ£cmp
(c->
¨gv
[1]->
±r
,"len")) {

157 
	`addRïlyL⁄gL⁄g
(
c
,
	`li°Lígth
(
£rvî
.
¶owlog
));

158 } i‡((
c
->
¨gc
 == 2 || c->argc == 3) &&

159 !
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"get"))

161 
cou¡
 = 10, 
£¡
 = 0;

162 
li°Iãr
 
li
;

163 *
tŸíåõs
;

164 
li°Node
 *
 
;

165 
¶owlogE¡ry
 *
£
;

167 i‡(
c
->
¨gc
 == 3 &&

168 
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
cou¡
,
NULL
Ë!
C_OK
)

171 
	`li°Rewöd
(
£rvî
.
¶owlog
,&
li
);

172 
tŸíåõs
 = 
	`addRïlyDe„ºedLí
(
c
);

173 
cou¡
-- && (
 
 = 
	`li°Next
(&
li
))) {

174 
j
;

176 
£
 = 
 
->
vÆue
;

177 
	`addRïlyAºayLí
(
c
,6);

178 
	`addRïlyL⁄gL⁄g
(
c
,
£
->
id
);

179 
	`addRïlyL⁄gL⁄g
(
c
,
£
->
time
);

180 
	`addRïlyL⁄gL⁄g
(
c
,
£
->
duøti⁄
);

181 
	`addRïlyAºayLí
(
c
,
£
->
¨gc
);

182 
j
 = 0; j < 
£
->
¨gc
; j++)

183 
	`addRïlyBulk
(
c
,
£
->
¨gv
[
j
]);

184 
	`addRïlyBulkCBuf„r
(
c
,
£
->
≥îid
,
	`sd¶í
(se->peerid));

185 
	`addRïlyBulkCBuf„r
(
c
,
£
->
˙ame
,
	`sd¶í
(se->cname));

186 
£¡
++;

188 
	`£tDe„ºedAºayLí
(
c
,
tŸíåõs
,
£¡
);

190 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

192 
	}
}

	@slowlog.h

30 #i‚de‡
__SLOWLOG_H__


31 
	#__SLOWLOG_H__


	)

33 
	#SLOWLOG_ENTRY_MAX_ARGC
 32

	)

34 
	#SLOWLOG_ENTRY_MAX_STRING
 128

	)

37 
	s¶owlogE¡ry
 {

38 
robj
 **
	m¨gv
;

39 
	m¨gc
;

40 
	mid
;

41 
	mduøti⁄
;

42 
time_t
 
	mtime
;

43 
sds
 
	m˙ame
;

44 
sds
 
	m≥îid
;

45 } 
	t¶owlogE¡ry
;

48 
¶owlogInô
();

49 
¶owlogPushE¡ryIfNìded
(
˛õ¡
 *
c
, 
robj
 **
¨gv
, 
¨gc
, 
duøti⁄
);

52 
¶owlogComm™d
(
˛õ¡
 *
c
);

	@solarisfixes.h

31 #i‡
deföed
(
__sun
)

33 #i‡
deföed
(
__GNUC__
)

34 
	~<m©h.h
>

35 #unde‡
i¢™


36 
	#i¢™
(
x
) \

37 
	`__exãnsi⁄__
({ 
	`__ty≥of
 (
x
Ë
__x_a
 = (x); \

38 
	`__buûtö_ex≥˘
(
__x_a
 !__x_a, 0); })

	)

40 #unde‡
isföôe


41 
	#isföôe
(
x
) \

42 
	`__exãnsi⁄__
 ({ 
	`__ty≥of
 (
x
Ë
__x_f
 = (x); \

43 
	`__buûtö_ex≥˘
(!
	`i¢™
(
__x_f
 - __x_f), 1); })

	)

45 #unde‡
isöf


46 
	#isöf
(
x
) \

47 
	`__exãnsi⁄__
 ({ 
	`__ty≥of
 (
x
Ë
__x_i
 = (x); \

48 
	`__buûtö_ex≥˘
(!
	`i¢™
(
__x_i
Ë&& !
	`isföôe
(__x_i), 0); })

	)

50 
	#u_öt
 
uöt


	)

51 
	#u_öt32_t
 
uöt32_t


	)

	@sort.c

32 
	~"£rvî.h
"

33 
	~"pqs‹t.h
"

34 
	~<m©h.h
>

36 
zskùli°Node
* 
z¶GëEÀmítByR™k
(
zskùli°
 *
z¶
, 
ønk
);

38 
ªdisS‹tO≥øti⁄
 *
	$¸óãS‹tO≥øti⁄
(
ty≥
, 
robj
 *
∑âîn
) {

39 
ªdisS‹tO≥øti⁄
 *
so
 = 
	`zmÆloc
((*so));

40 
so
->
ty≥
 =Åype;

41 
so
->
∑âîn
 =Öattern;

42  
so
;

43 
	}
}

61 
robj
 *
	$lookupKeyByP©ã∫
(
ªdisDb
 *
db
, 
robj
 *
∑âîn
,Ñobj *
sub°
, 
wrôeÊag
) {

62 *
p
, *
f
, *
k
;

63 
sds
 
•©
, 
ssub
;

64 
robj
 *
keyobj
, *
fõldobj
 = 
NULL
, *
o
;

65 
¥efixÀn
, 
subÀn
, 
po°fixÀn
, 
fõldÀn
;

69 
•©
 = 
∑âîn
->
±r
;

70 i‡(
•©
[0] == '#' && spat[1] == '\0') {

71 
	`ö¸RefCou¡
(
sub°
);

72  
sub°
;

78 
sub°
 = 
	`gëDecodedObje˘
(subst);

79 
ssub
 = 
sub°
->
±r
;

83 
p
 = 
	`°rchr
(
•©
,'*');

84 i‡(!
p
) {

85 
	`de¸RefCou¡
(
sub°
);

86  
NULL
;

90 i‡((
f
 = 
	`°r°r
(
p
+1, "->")Ë!
NULL
 && *(f+2) != '\0') {

91 
fõldÀn
 = 
	`sd¶í
(
•©
)-(
f
-spat)-2;

92 
fõldobj
 = 
	`¸óãSåögObje˘
(
f
+2,
fõldÀn
);

94 
fõldÀn
 = 0;

98 
¥efixÀn
 = 
p
-
•©
;

99 
subÀn
 = 
	`sd¶í
(
ssub
);

100 
po°fixÀn
 = 
	`sd¶í
(
•©
)-(
¥efixÀn
+1)-(
fõldÀn
 ? fieldlen+2 : 0);

101 
keyobj
 = 
	`¸óãSåögObje˘
(
NULL
,
¥efixÀn
+
subÀn
+
po°fixÀn
);

102 
k
 = 
keyobj
->
±r
;

103 
	`mem˝y
(
k
,
•©
,
¥efixÀn
);

104 
	`mem˝y
(
k
+
¥efixÀn
,
ssub
,
subÀn
);

105 
	`mem˝y
(
k
+
¥efixÀn
+
subÀn
,
p
+1,
po°fixÀn
);

106 
	`de¸RefCou¡
(
sub°
);

109 i‡(!
wrôeÊag
)

110 
o
 = 
	`lookupKeyRód
(
db
,
keyobj
);

112 
o
 = 
	`lookupKeyWrôe
(
db
,
keyobj
);

113 i‡(
o
 =
NULL
Ë
noobj
;

115 i‡(
fõldobj
) {

116 i‡(
o
->
ty≥
 !
OBJ_HASH
Ë
noobj
;

120 
o
 = 
	`hashTy≥GëVÆueObje˘
(o, 
fõldobj
->
±r
);

122 i‡(
o
->
ty≥
 !
OBJ_STRING
Ë
noobj
;

126 
	`ö¸RefCou¡
(
o
);

128 
	`de¸RefCou¡
(
keyobj
);

129 i‡(
fõldobj
Ë
	`de¸RefCou¡
(fieldobj);

130  
o
;

132 
noobj
:

133 
	`de¸RefCou¡
(
keyobj
);

134 i‡(
fõldÀn
Ë
	`de¸RefCou¡
(
fõldobj
);

135  
NULL
;

136 
	}
}

141 
	$s‹tCom∑ª
(c⁄° *
s1
, c⁄° *
s2
) {

142 c⁄° 
ªdisS‹tObje˘
 *
so1
 = 
s1
, *
so2
 = 
s2
;

143 
cmp
;

145 i‡(!
£rvî
.
s‹t_Æpha
) {

147 i‡(
so1
->
u
.
sc‹e
 > 
so2
->u.score) {

148 
cmp
 = 1;

149 } i‡(
so1
->
u
.
sc‹e
 < 
so2
->u.score) {

150 
cmp
 = -1;

155 
cmp
 = 
	`com∑ªSåögObje˘s
(
so1
->
obj
,
so2
->obj);

159 i‡(
£rvî
.
s‹t_by∑âîn
) {

160 i‡(!
so1
->
u
.
cmpobj
 || !
so2
->u.cmpobj) {

162 i‡(
so1
->
u
.
cmpobj
 =
so2
->u.cmpobj)

163 
cmp
 = 0;

164 i‡(
so1
->
u
.
cmpobj
 =
NULL
)

165 
cmp
 = -1;

167 
cmp
 = 1;

170 i‡(
£rvî
.
s‹t_°‹e
) {

171 
cmp
 = 
	`com∑ªSåögObje˘s
(
so1
->
u
.
cmpobj
,
so2
->u.cmpobj);

175 
cmp
 = 
	`°rcﬁl
(
so1
->
u
.
cmpobj
->
±r
,
so2
->u.cmpobj->ptr);

180 i‡(
£rvî
.
s‹t_°‹e
) {

181 
cmp
 = 
	`com∑ªSåögObje˘s
(
so1
->
obj
,
so2
->obj);

183 
cmp
 = 
	`cﬁœãSåögObje˘s
(
so1
->
obj
,
so2
->obj);

187  
£rvî
.
s‹t_desc
 ? -
cmp
 : cmp;

188 
	}
}

192 
	$s‹tComm™d
(
˛õ¡
 *
c
) {

193 
li°
 *
›î©i⁄s
;

194 
ouçuéí
 = 0;

195 
desc
 = 0, 
Æpha
 = 0;

196 
limô_°¨t
 = 0, 
limô_cou¡
 = -1, 
°¨t
, 
íd
;

197 
j
, 
d⁄ts‹t
 = 0, 
ve˘‹Àn
;

198 
gë›
 = 0;

199 
öt_c⁄vîsi⁄_îr‹
 = 0;

200 
sy¡ax_îr‹
 = 0;

201 
robj
 *
s‹tvÆ
, *
s‹tby
 = 
NULL
, *
°‹ekey
 = NULL;

202 
ªdisS‹tObje˘
 *
ve˘‹
;

206 
›î©i⁄s
 = 
	`li°Cª©e
();

207 
	`li°SëFªeMëhod
(
›î©i⁄s
,
z‰ì
);

208 
j
 = 2;

211 
j
 < 
c
->
¨gc
) {

212 
À·¨gs
 = 
c
->
¨gc
-
j
-1;

213 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"asc")) {

214 
desc
 = 0;

215 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"desc")) {

216 
desc
 = 1;

217 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"alpha")) {

218 
Æpha
 = 1;

219 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"limô"Ë&& 
À·¨gs
 >= 2) {

220 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[
j
+1], &
limô_°¨t
, 
NULL
)

221 !
C_OK
) ||

222 (
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[
j
+2], &
limô_cou¡
, 
NULL
)

223 !
C_OK
))

225 
sy¡ax_îr‹
++;

228 
j
+=2;

229 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"°‹e"Ë&& 
À·¨gs
 >= 1) {

230 
°‹ekey
 = 
c
->
¨gv
[
j
+1];

231 
j
++;

232 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"by"Ë&& 
À·¨gs
 >= 1) {

233 
s‹tby
 = 
c
->
¨gv
[
j
+1];

236 i‡(
	`°rchr
(
c
->
¨gv
[
j
+1]->
±r
,'*'Ë=
NULL
) {

237 
d⁄ts‹t
 = 1;

241 i‡(
£rvî
.
˛u°î_íabÀd
) {

242 
	`addRïlyEº‹
(
c
,"BY option of SORT denied in Cluster mode.");

243 
sy¡ax_îr‹
++;

247 
j
++;

248 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"gë"Ë&& 
À·¨gs
 >= 1) {

249 i‡(
£rvî
.
˛u°î_íabÀd
) {

250 
	`addRïlyEº‹
(
c
,"GET option of SORT denied in Cluster mode.");

251 
sy¡ax_îr‹
++;

254 
	`li°AddNodeTaû
(
›î©i⁄s
,
	`¸óãS‹tO≥øti⁄
(

255 
SORT_OP_GET
,
c
->
¨gv
[
j
+1]));

256 
gë›
++;

257 
j
++;

259 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

260 
sy¡ax_îr‹
++;

263 
j
++;

267 i‡(
sy¡ax_îr‹
) {

268 
	`li°Rñó£
(
›î©i⁄s
);

273 i‡(
°‹ekey
)

274 
s‹tvÆ
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[1]);

276 
s‹tvÆ
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

277 i‡(
s‹tvÆ
 && s‹tvÆ->
ty≥
 !
OBJ_SET
 &&

278 
s‹tvÆ
->
ty≥
 !
OBJ_LIST
 &&

279 
s‹tvÆ
->
ty≥
 !
OBJ_ZSET
)

281 
	`li°Rñó£
(
›î©i⁄s
);

282 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

289 i‡(
s‹tvÆ
)

290 
	`ö¸RefCou¡
(
s‹tvÆ
);

292 
s‹tvÆ
 = 
	`¸óãQuickli°Obje˘
();

301 i‡(
d⁄ts‹t
 &&

302 
s‹tvÆ
->
ty≥
 =
OBJ_SET
 &&

303 (
°‹ekey
 || 
c
->
Êags
 & 
CLIENT_LUA
))

306 
d⁄ts‹t
 = 0;

307 
Æpha
 = 1;

308 
s‹tby
 = 
NULL
;

312 i‡(
s‹tvÆ
->
ty≥
 =
OBJ_ZSET
)

313 
	`z£tC⁄vît
(
s‹tvÆ
, 
OBJ_ENCODING_SKIPLIST
);

316 
s‹tvÆ
->
ty≥
) {

317 
OBJ_LIST
: 
ve˘‹Àn
 = 
	`li°Ty≥Lígth
(
s‹tvÆ
); ;

318 
OBJ_SET
: 
ve˘‹Àn
 = 
	`£tTy≥Size
(
s‹tvÆ
); ;

319 
OBJ_ZSET
: 
ve˘‹Àn
 = 
	`di˘Size
(((
z£t
*)
s‹tvÆ
->
±r
)->
di˘
); ;

320 : 
ve˘‹Àn
 = 0; 
	`£rvîP™ic
("Bad SORTÅype");

324 
°¨t
 = (
limô_°¨t
 < 0) ? 0 :Üimit_start;

325 
íd
 = (
limô_cou¡
 < 0Ë? 
ve˘‹Àn
-1 : 
°¨t
+limit_count-1;

326 i‡(
°¨t
 >
ve˘‹Àn
) {

327 
°¨t
 = 
ve˘‹Àn
-1;

328 
íd
 = 
ve˘‹Àn
-2;

330 i‡(
íd
 >
ve˘‹Àn
)Énd = vectorlen-1;

342 i‡((
s‹tvÆ
->
ty≥
 =
OBJ_ZSET
 || s‹tvÆ->ty≥ =
OBJ_LIST
) &&

343 
d⁄ts‹t
 &&

344 (
°¨t
 !0 || 
íd
 !
ve˘‹Àn
-1))

346 
ve˘‹Àn
 = 
íd
-
°¨t
+1;

350 
ve˘‹
 = 
	`zmÆloc
((
ªdisS‹tObje˘
)*
ve˘‹Àn
);

351 
j
 = 0;

353 i‡(
s‹tvÆ
->
ty≥
 =
OBJ_LIST
 && 
d⁄ts‹t
) {

360 i‡(
íd
 >
°¨t
) {

361 
li°Ty≥Iãøt‹
 *
li
;

362 
li°Ty≥E¡ry
 
íåy
;

363 
li
 = 
	`li°Ty≥InôIãøt‹
(
s‹tvÆ
,

364 
desc
 ? ()(
	`li°Ty≥Lígth
(
s‹tvÆ
Ë- 
°¨t
 - 1) : start,

365 
desc
 ? 
LIST_HEAD
 : 
LIST_TAIL
);

367 
j
 < 
ve˘‹Àn
 && 
	`li°Ty≥Next
(
li
,&
íåy
)) {

368 
ve˘‹
[
j
].
obj
 = 
	`li°Ty≥Gë
(&
íåy
);

369 
ve˘‹
[
j
].
u
.
sc‹e
 = 0;

370 
ve˘‹
[
j
].
u
.
cmpobj
 = 
NULL
;

371 
j
++;

373 
	`li°Ty≥Rñó£Iãøt‹
(
li
);

375 
íd
 -
°¨t
;

376 
°¨t
 = 0;

378 } i‡(
s‹tvÆ
->
ty≥
 =
OBJ_LIST
) {

379 
li°Ty≥Iãøt‹
 *
li
 = 
	`li°Ty≥InôIãøt‹
(
s‹tvÆ
,0,
LIST_TAIL
);

380 
li°Ty≥E¡ry
 
íåy
;

381 
	`li°Ty≥Next
(
li
,&
íåy
)) {

382 
ve˘‹
[
j
].
obj
 = 
	`li°Ty≥Gë
(&
íåy
);

383 
ve˘‹
[
j
].
u
.
sc‹e
 = 0;

384 
ve˘‹
[
j
].
u
.
cmpobj
 = 
NULL
;

385 
j
++;

387 
	`li°Ty≥Rñó£Iãøt‹
(
li
);

388 } i‡(
s‹tvÆ
->
ty≥
 =
OBJ_SET
) {

389 
£tTy≥Iãøt‹
 *
si
 = 
	`£tTy≥InôIãøt‹
(
s‹tvÆ
);

390 
sds
 
sd£À
;

391 (
sd£À
 = 
	`£tTy≥NextObje˘
(
si
)Ë!
NULL
) {

392 
ve˘‹
[
j
].
obj
 = 
	`¸óãObje˘
(
OBJ_STRING
,
sd£À
);

393 
ve˘‹
[
j
].
u
.
sc‹e
 = 0;

394 
ve˘‹
[
j
].
u
.
cmpobj
 = 
NULL
;

395 
j
++;

397 
	`£tTy≥Rñó£Iãøt‹
(
si
);

398 } i‡(
s‹tvÆ
->
ty≥
 =
OBJ_ZSET
 && 
d⁄ts‹t
) {

406 
z£t
 *
zs
 = 
s‹tvÆ
->
±r
;

407 
zskùli°
 *
z¶
 = 
zs
->zsl;

408 
zskùli°Node
 *
 
;

409 
sds
 
sd£À
;

410 
øngñí
 = 
ve˘‹Àn
;

413 i‡(
desc
) {

414 
z£éí
 = 
	`di˘Size
(((
z£t
*)
s‹tvÆ
->
±r
)->
di˘
);

416 
 
 = 
z¶
->
èû
;

417 i‡(
°¨t
 > 0)

418 
 
 = 
	`z¶GëEÀmítByR™k
(
z¶
,
z£éí
-
°¨t
);

420 
 
 = 
z¶
->
hódî
->
Àvñ
[0].
f‹w¨d
;

421 i‡(
°¨t
 > 0)

422 
 
 = 
	`z¶GëEÀmítByR™k
(
z¶
,
°¨t
+1);

425 
øngñí
--) {

426 
	`£rvîAs£πWôhInfo
(
c
,
s‹tvÆ
,
 
 !
NULL
);

427 
sd£À
 = 
 
->
ñe
;

428 
ve˘‹
[
j
].
obj
 = 
	`¸óãSåögObje˘
(
sd£À
,
	`sd¶í
(sdsele));

429 
ve˘‹
[
j
].
u
.
sc‹e
 = 0;

430 
ve˘‹
[
j
].
u
.
cmpobj
 = 
NULL
;

431 
j
++;

432 
 
 = 
desc
 ?Ün->
backw¨d
 :Ün->
Àvñ
[0].
f‹w¨d
;

435 
íd
 -
°¨t
;

436 
°¨t
 = 0;

437 } i‡(
s‹tvÆ
->
ty≥
 =
OBJ_ZSET
) {

438 
di˘
 *
£t
 = ((
z£t
*)
s‹tvÆ
->
±r
)->dict;

439 
di˘Iãøt‹
 *
di
;

440 
di˘E¡ry
 *
£ãÀ
;

441 
sds
 
sd£À
;

442 
di
 = 
	`di˘GëIãøt‹
(
£t
);

443 (
£ãÀ
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

444 
sd£À
 = 
	`di˘GëKey
(
£ãÀ
);

445 
ve˘‹
[
j
].
obj
 = 
	`¸óãSåögObje˘
(
sd£À
,
	`sd¶í
(sdsele));

446 
ve˘‹
[
j
].
u
.
sc‹e
 = 0;

447 
ve˘‹
[
j
].
u
.
cmpobj
 = 
NULL
;

448 
j
++;

450 
	`di˘Rñó£Iãøt‹
(
di
);

452 
	`£rvîP™ic
("UnknownÅype");

454 
	`£rvîAs£πWôhInfo
(
c
,
s‹tvÆ
,
j
 =
ve˘‹Àn
);

457 i‡(!
d⁄ts‹t
) {

458 
j
 = 0; j < 
ve˘‹Àn
; j++) {

459 
robj
 *
byvÆ
;

460 i‡(
s‹tby
) {

462 
byvÆ
 = 
	`lookupKeyByP©ã∫
(
c
->
db
,
s‹tby
,
ve˘‹
[
j
].
obj
,
°‹ekey
!=
NULL
);

463 i‡(!
byvÆ
) ;

466 
byvÆ
 = 
ve˘‹
[
j
].
obj
;

469 i‡(
Æpha
) {

470 i‡(
s‹tby
Ë
ve˘‹
[
j
].
u
.
cmpobj
 = 
	`gëDecodedObje˘
(
byvÆ
);

472 i‡(
	`sdsEncodedObje˘
(
byvÆ
)) {

473 *
ïå
;

475 
ve˘‹
[
j
].
u
.
sc‹e
 = 
	`°πod
(
byvÆ
->
±r
,&
ïå
);

476 i‡(
ïå
[0] !'\0' || 
î∫o
 =
ERANGE
 ||

477 
	`i¢™
(
ve˘‹
[
j
].
u
.
sc‹e
))

479 
öt_c⁄vîsi⁄_îr‹
 = 1;

481 } i‡(
byvÆ
->
ícodög
 =
OBJ_ENCODING_INT
) {

485 
ve˘‹
[
j
].
u
.
sc‹e
 = ()
byvÆ
->
±r
;

487 
	`£rvîAs£πWôhInfo
(
c
,
s‹tvÆ
,1 != 1);

493 i‡(
s‹tby
) {

494 
	`de¸RefCou¡
(
byvÆ
);

498 
£rvî
.
s‹t_desc
 = 
desc
;

499 
£rvî
.
s‹t_Æpha
 = 
Æpha
;

500 
£rvî
.
s‹t_by∑âîn
 = 
s‹tby
 ? 1 : 0;

501 
£rvî
.
s‹t_°‹e
 = 
°‹ekey
 ? 1 : 0;

502 i‡(
s‹tby
 && (
°¨t
 !0 || 
íd
 !
ve˘‹Àn
-1))

503 
	`pqs‹t
(
ve˘‹
,
ve˘‹Àn
,(
ªdisS‹tObje˘
),
s‹tCom∑ª
, 
°¨t
,
íd
);

505 
	`qs‹t
(
ve˘‹
,
ve˘‹Àn
,(
ªdisS‹tObje˘
),
s‹tCom∑ª
);

510 
ouçuéí
 = 
gë›
 ? gë›*(
íd
-
°¨t
+1) :Énd-start+1;

511 i‡(
öt_c⁄vîsi⁄_îr‹
) {

512 
	`addRïlyEº‹
(
c
,"One or more scores can't be converted into double");

513 } i‡(
°‹ekey
 =
NULL
) {

515 
	`addRïlyAºayLí
(
c
,
ouçuéí
);

516 
j
 = 
°¨t
; j <
íd
; j++) {

517 
li°Node
 *
 
;

518 
li°Iãr
 
li
;

520 i‡(!
gë›
Ë
	`addRïlyBulk
(
c
,
ve˘‹
[
j
].
obj
);

521 
	`li°Rewöd
(
›î©i⁄s
,&
li
);

522 (
 
 = 
	`li°Next
(&
li
))) {

523 
ªdisS‹tO≥øti⁄
 *
s›
 = 
 
->
vÆue
;

524 
robj
 *
vÆ
 = 
	`lookupKeyByP©ã∫
(
c
->
db
,
s›
->
∑âîn
,

525 
ve˘‹
[
j
].
obj
,
°‹ekey
!=
NULL
);

527 i‡(
s›
->
ty≥
 =
SORT_OP_GET
) {

528 i‡(!
vÆ
) {

529 
	`addRïlyNuŒ
(
c
);

531 
	`addRïlyBulk
(
c
,
vÆ
);

532 
	`de¸RefCou¡
(
vÆ
);

536 
	`£rvîAs£πWôhInfo
(
c
,
s‹tvÆ
,
s›
->
ty≥
 =
SORT_OP_GET
);

541 
robj
 *
sobj
 = 
	`¸óãQuickli°Obje˘
();

544 
j
 = 
°¨t
; j <
íd
; j++) {

545 
li°Node
 *
 
;

546 
li°Iãr
 
li
;

548 i‡(!
gë›
) {

549 
	`li°Ty≥Push
(
sobj
,
ve˘‹
[
j
].
obj
,
LIST_TAIL
);

551 
	`li°Rewöd
(
›î©i⁄s
,&
li
);

552 (
 
 = 
	`li°Next
(&
li
))) {

553 
ªdisS‹tO≥øti⁄
 *
s›
 = 
 
->
vÆue
;

554 
robj
 *
vÆ
 = 
	`lookupKeyByP©ã∫
(
c
->
db
,
s›
->
∑âîn
,

555 
ve˘‹
[
j
].
obj
,
°‹ekey
!=
NULL
);

557 i‡(
s›
->
ty≥
 =
SORT_OP_GET
) {

558 i‡(!
vÆ
ËvÆ = 
	`¸óãSåögObje˘
("",0);

563 
	`li°Ty≥Push
(
sobj
,
vÆ
,
LIST_TAIL
);

564 
	`de¸RefCou¡
(
vÆ
);

567 
	`£rvîAs£πWôhInfo
(
c
,
s‹tvÆ
,
s›
->
ty≥
 =
SORT_OP_GET
);

572 i‡(
ouçuéí
) {

573 
	`£tKey
(
c
,c->
db
,
°‹ekey
,
sobj
);

574 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,"s‹t°‹e",
°‹ekey
,

575 
c
->
db
->
id
);

576 
£rvî
.
dúty
 +
ouçuéí
;

577 } i‡(
	`dbDñëe
(
c
->
db
,
°‹ekey
)) {

578 
	`sig«lModifõdKey
(
c
,c->
db
,
°‹ekey
);

579 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
°‹ekey
,
c
->
db
->
id
);

580 
£rvî
.
dúty
++;

582 
	`de¸RefCou¡
(
sobj
);

583 
	`addRïlyL⁄gL⁄g
(
c
,
ouçuéí
);

587 
j
 = 0; j < 
ve˘‹Àn
; j++)

588 
	`de¸RefCou¡
(
ve˘‹
[
j
].
obj
);

590 
	`de¸RefCou¡
(
s‹tvÆ
);

591 
	`li°Rñó£
(
›î©i⁄s
);

592 
j
 = 0; j < 
ve˘‹Àn
; j++) {

593 i‡(
Æpha
 && 
ve˘‹
[
j
].
u
.
cmpobj
)

594 
	`de¸RefCou¡
(
ve˘‹
[
j
].
u
.
cmpobj
);

596 
	`z‰ì
(
ve˘‹
);

597 
	}
}

	@sparkline.c

33 
	~"£rvî.h
"

35 
	~<m©h.h
>

39 
	gch¨£t
[] = "_-`";

40 
	gch¨£t_fûl
[] = "_o#";

41 
	gch¨£t_Àn
 = (
ch¨£t
)-1;

42 
	gœbñ_m¨gö_t›
 = 1;

57 
£quí˚
 *
	$¸óãS∑rklöeSequí˚
() {

58 
£quí˚
 *
£q
 = 
	`zmÆloc
((*seq));

59 
£q
->
Àngth
 = 0;

60 
£q
->
ßm∂es
 = 
NULL
;

61  
£q
;

62 
	}
}

65 
	$•¨klöeSequí˚AddSam∂e
(
£quí˚
 *
£q
, 
vÆue
, *
œbñ
) {

66 
œbñ
 = (œbñ =
NULL
 ||Üabñ[0] ='\0'Ë? NULL : 
	`z°rdup
(label);

67 i‡(
£q
->
Àngth
 == 0) {

68 
£q
->
mö
 = seq->
max
 = 
vÆue
;

70 i‡(
vÆue
 < 
£q
->
mö
) seq->min = value;

71 i‡(
vÆue
 > 
£q
->
max
) seq->max = value;

73 
£q
->
ßm∂es
 = 
	`zªÆloc
(£q->ßm∂es,(
ßm∂e
)*(£q->
Àngth
+1));

74 
£q
->
ßm∂es
[£q->
Àngth
].
vÆue
 = value;

75 
£q
->
ßm∂es
[£q->
Àngth
].
œbñ
 =Üabel;

76 
£q
->
Àngth
++;

77 i‡(
œbñ
Ë
£q
->
œbñs
++;

78 
	}
}

81 
	$‰ìS∑rklöeSequí˚
(
£quí˚
 *
£q
) {

82 
j
;

84 
j
 = 0; j < 
£q
->
Àngth
; j++)

85 
	`z‰ì
(
£q
->
ßm∂es
[
j
].
œbñ
);

86 
	`z‰ì
(
£q
->
ßm∂es
);

87 
	`z‰ì
(
£q
);

88 
	}
}

97 
sds
 
	$•¨klöeRídîR™ge
(
sds
 
ouçut
, 
£quí˚
 *
£q
, 
rows
, 
off£t
, 
Àn
, 
Êags
) {

98 
j
;

99 
ªlmax
 = 
£q
->
max
 - seq->
mö
;

100 
°ïs
 = 
ch¨£t_Àn
*
rows
;

101 
row
 = 0;

102 *
ch¨s
 = 
	`zmÆloc
(
Àn
);

103 
lo›
 = 1;

104 
›t_fûl
 = 
Êags
 & 
SPARKLINE_FILL
;

105 
›t_log
 = 
Êags
 & 
SPARKLINE_LOG_SCALE
;

107 i‡(
›t_log
) {

108 
ªlmax
 = 
	`log
(relmax+1);

109 } i‡(
ªlmax
 == 0) {

110 
ªlmax
 = 1;

113 
lo›
) {

114 
lo›
 = 0;

115 
	`mem£t
(
ch¨s
,' ',
Àn
);

116 
j
 = 0; j < 
Àn
; j++) {

117 
ßm∂e
 *
s
 = &
£q
->
ßm∂es
[
j
+
off£t
];

118 
ªlvÆ
 = 
s
->
vÆue
 - 
£q
->
mö
;

119 
°ï
;

121 i‡(
›t_log
Ë
ªlvÆ
 = 
	`log
(relval+1);

122 
°ï
 = (Ë(
ªlvÆ
*
°ïs
)/
ªlmax
;

123 i‡(
°ï
 < 0) step = 0;

124 i‡(
°ï
 >
°ïs
) step = steps-1;

126 i‡(
row
 < 
rows
) {

128 
ch¨idx
 = 
°ï
-((
rows
-
row
-1)*
ch¨£t_Àn
);

129 
lo›
 = 1;

130 i‡(
ch¨idx
 >0 && ch¨idx < 
ch¨£t_Àn
) {

131 
ch¨s
[
j
] = 
›t_fûl
 ? 
ch¨£t_fûl
[
ch¨idx
] :

132 
ch¨£t
[
ch¨idx
];

133 } if(
›t_fûl
 && 
ch¨idx
 >
ch¨£t_Àn
) {

134 
ch¨s
[
j
] = '|';

138 i‡(
£q
->
œbñs
 && 
row
-
rows
 < 
œbñ_m¨gö_t›
) {

139 
lo›
 = 1;

143 i‡(
s
->
œbñ
) {

144 
œbñ_Àn
 = 
	`°æí
(
s
->
œbñ
);

145 
œbñ_ch¨
 = 
row
 - 
rows
 - 
œbñ_m¨gö_t›
;

147 i‡(
œbñ_Àn
 > 
œbñ_ch¨
) {

148 
lo›
 = 1;

149 
ch¨s
[
j
] = 
s
->
œbñ
[
œbñ_ch¨
];

154 i‡(
lo›
) {

155 
row
++;

156 
ouçut
 = 
	`sdsˇéí
(ouçut,
ch¨s
,
Àn
);

157 
ouçut
 = 
	`sdsˇéí
(output,"\n",1);

160 
	`z‰ì
(
ch¨s
);

161  
ouçut
;

162 
	}
}

165 
sds
 
	$•¨klöeRídî
(
sds
 
ouçut
, 
£quí˚
 *
£q
, 
cﬁumns
, 
rows
, 
Êags
) {

166 
j
;

168 
j
 = 0; j < 
£q
->
Àngth
; j +
cﬁumns
) {

169 
subÀn
 = (
£q
->
Àngth
-
j
Ë< 
cﬁumns
 ? (seq->length-j) : columns;

171 i‡(
j
 !0Ë
ouçut
 = 
	`sdsˇéí
(output,"\n",1);

172 
ouçut
 = 
	`•¨klöeRídîR™ge
(ouçut, 
£q
, 
rows
, 
j
, 
subÀn
, 
Êags
);

174  
ouçut
;

175 
	}
}

	@sparkline.h

30 #i‚de‡
__SPARKLINE_H


31 
	#__SPARKLINE_H


	)

34 
	sßm∂e
 {

35 
	mvÆue
;

36 *
	mœbñ
;

39 
	s£quí˚
 {

40 
	mÀngth
;

41 
	mœbñs
;

42 
ßm∂e
 *
	mßm∂es
;

43 
	mmö
, 
	mmax
;

46 
	#SPARKLINE_NO_FLAGS
 0

	)

47 
	#SPARKLINE_FILL
 1

	)

48 
	#SPARKLINE_LOG_SCALE
 2

	)

50 
£quí˚
 *
¸óãS∑rklöeSequí˚
();

51 
•¨klöeSequí˚AddSam∂e
(
£quí˚
 *
£q
, 
vÆue
, *
œbñ
);

52 
‰ìS∑rklöeSequí˚
(
£quí˚
 *
£q
);

53 
sds
 
•¨klöeRídîR™ge
(sd†
ouçut
, 
£quí˚
 *
£q
, 
rows
, 
off£t
, 
Àn
, 
Êags
);

54 
sds
 
•¨klöeRídî
(sd†
ouçut
, 
£quí˚
 *
£q
, 
cﬁumns
, 
rows
, 
Êags
);

	@stream.h

1 #i‚de‡
STREAM_H


2 
	#STREAM_H


	)

4 
	~"øx.h
"

5 
	~"li°∑ck.h
"

11 
	s°ªamID
 {

12 
uöt64_t
 
	mms
;

13 
uöt64_t
 
	m£q
;

14 } 
	t°ªamID
;

16 
	s°ªam
 {

17 
øx
 *
	møx
;

18 
uöt64_t
 
	mÀngth
;

19 
°ªamID
 
	mœ°_id
;

20 
øx
 *
	mcgroups
;

21 } 
	t°ªam
;

29 
	s°ªamIãøt‹
 {

30 
°ªam
 *
	m°ªam
;

31 
°ªamID
 
	mma°î_id
;

32 
uöt64_t
 
	mma°î_fõlds_cou¡
;

33 *
	mma°î_fõlds_°¨t
;

34 *
	mma°î_fõlds_±r
;

35 
	míåy_Êags
;

36 
	mªv
;

37 
uöt64_t
 
	m°¨t_key
[2];

38 
uöt64_t
 
	míd_key
[2];

39 
øxIãøt‹
 
	mri
;

40 *
	mÕ
;

41 *
	mÕ_ñe
;

42 *
	mÕ_Êags
;

46 
	mfõld_buf
[
LP_INTBUF_SIZE
];

47 
	mvÆue_buf
[
LP_INTBUF_SIZE
];

48 } 
	t°ªamIãøt‹
;

51 
	s°ªamCG
 {

52 
°ªamID
 
	mœ°_id
;

55 
øx
 *
	m≥l
;

61 
øx
 *
	mc⁄sumîs
;

64 } 
	t°ªamCG
;

67 
	s°ªamC⁄sumî
 {

68 
m°ime_t
 
	m£í_time
;

69 
sds
 
	m«me
;

72 
øx
 *
	m≥l
;

79 } 
	t°ªamC⁄sumî
;

82 
	s°ªamNACK
 {

83 
m°ime_t
 
	mdñivîy_time
;

84 
uöt64_t
 
	mdñivîy_cou¡
;

85 
°ªamC⁄sumî
 *
	mc⁄sumî
;

87 } 
	t°ªamNACK
;

91 
	s°ªamPr›Info
 {

92 
robj
 *
	mkey«me
;

93 
robj
 *
	mgrou≤ame
;

94 } 
	t°ªamPr›Info
;

97 
	g˛õ¡
;

100 
	#SLC_NONE
 0

	)

101 
	#SLC_NOCREAT
 (1<<0Ë

	)

102 
	#SLC_NOREFRESH
 (1<<1Ë

	)

104 
°ªam
 *
°ªamNew
();

105 
‰ìSåóm
(
°ªam
 *
s
);

106 
°ªamLígth
(c⁄° 
robj
 *
subje˘
);

107 
size_t
 
°ªamRïlyWôhR™ge
(
˛õ¡
 *
c
, 
°ªam
 *
s
, 
°ªamID
 *
°¨t
, såómID *
íd
, size_à
cou¡
, 
ªv
, 
°ªamCG
 *
group
, 
°ªamC⁄sumî
 *
c⁄sumî
, 
Êags
, 
°ªamPr›Info
 *
•i
);

108 
°ªamIãøt‹Sèπ
(
°ªamIãøt‹
 *
si
, 
°ªam
 *
s
, 
°ªamID
 *
°¨t
, såómID *
íd
, 
ªv
);

109 
°ªamIãøt‹GëID
(
°ªamIãøt‹
 *
si
, 
°ªamID
 *
id
, 
öt64_t
 *
numfõlds
);

110 
°ªamIãøt‹GëFõld
(
°ªamIãøt‹
 *
si
, **
fõld±r
, **
vÆuïå
, 
öt64_t
 *
fõldÀn
, i¡64_à*
vÆuñí
);

111 
°ªamIãøt‹St›
(
°ªamIãøt‹
 *
si
);

112 
°ªamCG
 *
°ªamLookupCG
(
°ªam
 *
s
, 
sds
 
grou≤ame
);

113 
°ªamC⁄sumî
 *
°ªamLookupC⁄sumî
(
°ªamCG
 *
cg
, 
sds
 
«me
, 
Êags
);

114 
°ªamCG
 *
°ªamCª©eCG
(
°ªam
 *
s
, *
«me
, 
size_t
 
«mñí
, 
°ªamID
 *
id
);

115 
°ªamNACK
 *
°ªamCª©eNACK
(
°ªamC⁄sumî
 *
c⁄sumî
);

116 
°ªamDecodeID
(*
buf
, 
°ªamID
 *
id
);

117 
°ªamCom∑ªID
(
°ªamID
 *
a
, såómID *
b
);

118 
°ªamFªeNACK
(
°ªamNACK
 *
«
);

119 
°ªamIn¸ID
(
°ªamID
 *
id
);

	@syncio.c

31 
	~"£rvî.h
"

43 
	#SYNCIO__RESOLUTION
 10

	)

49 
ssize_t
 
	$syncWrôe
(
fd
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

50 
ssize_t
 
nwrôãn
, 
ªt
 = 
size
;

51 
°¨t
 = 
	`m°ime
();

52 
ªmaöög
 = 
timeout
;

55 
waô
 = (
ªmaöög
 > 
SYNCIO__RESOLUTION
) ?

56 
ªmaöög
 : 
SYNCIO__RESOLUTION
;

57 
ñ≠£d
;

61 
nwrôãn
 = 
	`wrôe
(
fd
,
±r
,
size
);

62 i‡(
nwrôãn
 == -1) {

63 i‡(
î∫o
 !
EAGAIN
)  -1;

65 
±r
 +
nwrôãn
;

66 
size
 -
nwrôãn
;

68 i‡(
size
 =0Ë 
ªt
;

71 
	`´Waô
(
fd
,
AE_WRITABLE
,
waô
);

72 
ñ≠£d
 = 
	`m°ime
(Ë- 
°¨t
;

73 i‡(
ñ≠£d
 >
timeout
) {

74 
î∫o
 = 
ETIMEDOUT
;

77 
ªmaöög
 = 
timeout
 - 
ñ≠£d
;

79 
	}
}

85 
ssize_t
 
	$syncRód
(
fd
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

86 
ssize_t
 
ƒód
, 
tŸªad
 = 0;

87 
°¨t
 = 
	`m°ime
();

88 
ªmaöög
 = 
timeout
;

90 i‡(
size
 == 0)  0;

92 
waô
 = (
ªmaöög
 > 
SYNCIO__RESOLUTION
) ?

93 
ªmaöög
 : 
SYNCIO__RESOLUTION
;

94 
ñ≠£d
;

98 
ƒód
 = 
	`ªad
(
fd
,
±r
,
size
);

99 i‡(
ƒód
 == 0)  -1;

100 i‡(
ƒód
 == -1) {

101 i‡(
î∫o
 !
EAGAIN
)  -1;

103 
±r
 +
ƒód
;

104 
size
 -
ƒód
;

105 
tŸªad
 +
ƒód
;

107 i‡(
size
 =0Ë 
tŸªad
;

110 
	`´Waô
(
fd
,
AE_READABLE
,
waô
);

111 
ñ≠£d
 = 
	`m°ime
(Ë- 
°¨t
;

112 i‡(
ñ≠£d
 >
timeout
) {

113 
î∫o
 = 
ETIMEDOUT
;

116 
ªmaöög
 = 
timeout
 - 
ñ≠£d
;

118 
	}
}

125 
ssize_t
 
	$syncRódLöe
(
fd
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

126 
ssize_t
 
ƒód
 = 0;

128 
size
--;

129 
size
) {

130 
c
;

132 i‡(
	`syncRód
(
fd
,&
c
,1,
timeout
) == -1)  -1;

133 i‡(
c
 == '\n') {

134 *
±r
 = '\0';

135 i‡(
ƒód
 && *(
±r
-1) == '\r') *(ptr-1) = '\0';

136  
ƒód
;

138 *
±r
++ = 
c
;

139 *
±r
 = '\0';

140 
ƒód
++;

142 
size
--;

144  
ƒód
;

145 
	}
}

	@t_hash.c

30 
	~"£rvî.h
"

31 
	~<m©h.h
>

40 
	$hashTy≥TryC⁄vîsi⁄
(
robj
 *
o
,Ñobj **
¨gv
, 
°¨t
, 
íd
) {

41 
i
;

43 i‡(
o
->
ícodög
 !
OBJ_ENCODING_ZIPLIST
) ;

45 
i
 = 
°¨t
; i <
íd
; i++) {

46 i‡(
	`sdsEncodedObje˘
(
¨gv
[
i
]) &&

47 
	`sd¶í
(
¨gv
[
i
]->
±r
Ë> 
£rvî
.
hash_max_zùli°_vÆue
)

49 
	`hashTy≥C⁄vît
(
o
, 
OBJ_ENCODING_HT
);

53 
	}
}

57 
	$hashTy≥GëFromZùli°
(
robj
 *
o
, 
sds
 
fõld
,

58 **
v°r
,

59 *
vÀn
,

60 *
vŒ
)

62 *
zl
, *
Âå
 = 
NULL
, *
v±r
 = NULL;

63 
ªt
;

65 
	`£rvîAs£π
(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
);

67 
zl
 = 
o
->
±r
;

68 
Âå
 = 
	`zùli°Index
(
zl
, 
ZIPLIST_HEAD
);

69 i‡(
Âå
 !
NULL
) {

70 
Âå
 = 
	`zùli°Föd
(Âå, (*)
fõld
, 
	`sd¶í
(field), 1);

71 i‡(
Âå
 !
NULL
) {

73 
v±r
 = 
	`zùli°Next
(
zl
, 
Âå
);

74 
	`£rvîAs£π
(
v±r
 !
NULL
);

78 i‡(
v±r
 !
NULL
) {

79 
ªt
 = 
	`zùli°Gë
(
v±r
, 
v°r
, 
vÀn
, 
vŒ
);

80 
	`£rvîAs£π
(
ªt
);

85 
	}
}

90 
sds
 
	$hashTy≥GëFromHashTabÀ
(
robj
 *
o
, 
sds
 
fõld
) {

91 
di˘E¡ry
 *
de
;

93 
	`£rvîAs£π
(
o
->
ícodög
 =
OBJ_ENCODING_HT
);

95 
de
 = 
	`di˘Föd
(
o
->
±r
, 
fõld
);

96 i‡(
de
 =
NULL
)  NULL;

97  
	`di˘GëVÆ
(
de
);

98 
	}
}

109 
	$hashTy≥GëVÆue
(
robj
 *
o
, 
sds
 
fõld
, **
v°r
, *
vÀn
, *
vŒ
) {

110 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

111 *
v°r
 = 
NULL
;

112 i‡(
	`hashTy≥GëFromZùli°
(
o
, 
fõld
, 
v°r
, 
vÀn
, 
vŒ
) == 0)

113  
C_OK
;

114 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

115 
sds
 
vÆue
;

116 i‡((
vÆue
 = 
	`hashTy≥GëFromHashTabÀ
(
o
, 
fõld
)Ë!
NULL
) {

117 *
v°r
 = (*Ë
vÆue
;

118 *
vÀn
 = 
	`sd¶í
(
vÆue
);

119  
C_OK
;

122 
	`£rvîP™ic
("Unknown hashÉncoding");

124  
C_ERR
;

125 
	}
}

131 
robj
 *
	$hashTy≥GëVÆueObje˘
(
robj
 *
o
, 
sds
 
fõld
) {

132 *
v°r
;

133 
vÀn
;

134 
vŒ
;

136 i‡(
	`hashTy≥GëVÆue
(
o
,
fõld
,&
v°r
,&
vÀn
,&
vŒ
Ë=
C_ERR
Ë 
NULL
;

137 i‡(
v°r
Ë 
	`¸óãSåögObje˘
((*)v°r,
vÀn
);

138  
	`¸óãSåögObje˘FromL⁄gL⁄g
(
vŒ
);

139 
	}
}

144 
size_t
 
	$hashTy≥GëVÆueLígth
(
robj
 *
o
, 
sds
 
fõld
) {

145 
size_t
 
Àn
 = 0;

146 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

147 *
v°r
 = 
NULL
;

148 
vÀn
 = 
UINT_MAX
;

149 
vŒ
 = 
LLONG_MAX
;

151 i‡(
	`hashTy≥GëFromZùli°
(
o
, 
fõld
, &
v°r
, &
vÀn
, &
vŒ
) == 0)

152 
Àn
 = 
v°r
 ? 
vÀn
 : 
	`sdigôs10
(
vŒ
);

153 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

154 
sds
 
aux
;

156 i‡((
aux
 = 
	`hashTy≥GëFromHashTabÀ
(
o
, 
fõld
)Ë!
NULL
)

157 
Àn
 = 
	`sd¶í
(
aux
);

159 
	`£rvîP™ic
("Unknown hashÉncoding");

161  
Àn
;

162 
	}
}

166 
	$hashTy≥Exi°s
(
robj
 *
o
, 
sds
 
fõld
) {

167 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

168 *
v°r
 = 
NULL
;

169 
vÀn
 = 
UINT_MAX
;

170 
vŒ
 = 
LLONG_MAX
;

172 i‡(
	`hashTy≥GëFromZùli°
(
o
, 
fõld
, &
v°r
, &
vÀn
, &
vŒ
) == 0)  1;

173 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

174 i‡(
	`hashTy≥GëFromHashTabÀ
(
o
, 
fõld
Ë!
NULL
)  1;

176 
	`£rvîP™ic
("Unknown hashÉncoding");

179 
	}
}

199 
	#HASH_SET_TAKE_FIELD
 (1<<0)

	)

200 
	#HASH_SET_TAKE_VALUE
 (1<<1)

	)

201 
	#HASH_SET_COPY
 0

	)

202 
	$hashTy≥Së
(
robj
 *
o
, 
sds
 
fõld
, sd†
vÆue
, 
Êags
) {

203 
upd©e
 = 0;

205 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

206 *
zl
, *
Âå
, *
v±r
;

208 
zl
 = 
o
->
±r
;

209 
Âå
 = 
	`zùli°Index
(
zl
, 
ZIPLIST_HEAD
);

210 i‡(
Âå
 !
NULL
) {

211 
Âå
 = 
	`zùli°Föd
(Âå, (*)
fõld
, 
	`sd¶í
(field), 1);

212 i‡(
Âå
 !
NULL
) {

214 
v±r
 = 
	`zùli°Next
(
zl
, 
Âå
);

215 
	`£rvîAs£π
(
v±r
 !
NULL
);

216 
upd©e
 = 1;

219 
zl
 = 
	`zùli°Dñëe
(zl, &
v±r
);

222 
zl
 = 
	`zùli°In£π
(zl, 
v±r
, (*)
vÆue
,

223 
	`sd¶í
(
vÆue
));

227 i‡(!
upd©e
) {

229 
zl
 = 
	`zùli°Push
(zl, (*)
fõld
, 
	`sd¶í
(field),

230 
ZIPLIST_TAIL
);

231 
zl
 = 
	`zùli°Push
(zl, (*)
vÆue
, 
	`sd¶í
(value),

232 
ZIPLIST_TAIL
);

234 
o
->
±r
 = 
zl
;

237 i‡(
	`hashTy≥Lígth
(
o
Ë> 
£rvî
.
hash_max_zùli°_íåõs
)

238 
	`hashTy≥C⁄vît
(
o
, 
OBJ_ENCODING_HT
);

239 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

240 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
o
->
±r
,
fõld
);

241 i‡(
de
) {

242 
	`sds‰ì
(
	`di˘GëVÆ
(
de
));

243 i‡(
Êags
 & 
HASH_SET_TAKE_VALUE
) {

244 
	`di˘GëVÆ
(
de
Ë
vÆue
;

245 
vÆue
 = 
NULL
;

247 
	`di˘GëVÆ
(
de
Ë
	`sdsdup
(
vÆue
);

249 
upd©e
 = 1;

251 
sds
 
f
,
v
;

252 i‡(
Êags
 & 
HASH_SET_TAKE_FIELD
) {

253 
f
 = 
fõld
;

254 
fõld
 = 
NULL
;

256 
f
 = 
	`sdsdup
(
fõld
);

258 i‡(
Êags
 & 
HASH_SET_TAKE_VALUE
) {

259 
v
 = 
vÆue
;

260 
vÆue
 = 
NULL
;

262 
v
 = 
	`sdsdup
(
vÆue
);

264 
	`di˘Add
(
o
->
±r
,
f
,
v
);

267 
	`£rvîP™ic
("Unknown hashÉncoding");

272 i‡(
Êags
 & 
HASH_SET_TAKE_FIELD
 && 
fõld
Ë
	`sds‰ì
(field);

273 i‡(
Êags
 & 
HASH_SET_TAKE_VALUE
 && 
vÆue
Ë
	`sds‰ì
(value);

274  
upd©e
;

275 
	}
}

279 
	$hashTy≥Dñëe
(
robj
 *
o
, 
sds
 
fõld
) {

280 
dñëed
 = 0;

282 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

283 *
zl
, *
Âå
;

285 
zl
 = 
o
->
±r
;

286 
Âå
 = 
	`zùli°Index
(
zl
, 
ZIPLIST_HEAD
);

287 i‡(
Âå
 !
NULL
) {

288 
Âå
 = 
	`zùli°Föd
(Âå, (*)
fõld
, 
	`sd¶í
(field), 1);

289 i‡(
Âå
 !
NULL
) {

290 
zl
 = 
	`zùli°Dñëe
(zl,&
Âå
);

291 
zl
 = 
	`zùli°Dñëe
(zl,&
Âå
);

292 
o
->
±r
 = 
zl
;

293 
dñëed
 = 1;

296 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

297 i‡(
	`di˘Dñëe
((
di˘
*)
o
->
±r
, 
fõld
Ë=
C_OK
) {

298 
dñëed
 = 1;

301 i‡(
	`htNìdsResize
(
o
->
±r
)Ë
	`di˘Resize
(o->ptr);

305 
	`£rvîP™ic
("Unknown hashÉncoding");

307  
dñëed
;

308 
	}
}

311 
	$hashTy≥Lígth
(c⁄° 
robj
 *
o
) {

312 
Àngth
 = 
ULONG_MAX
;

314 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

315 
Àngth
 = 
	`zùli°Lí
(
o
->
±r
) / 2;

316 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

317 
Àngth
 = 
	`di˘Size
((c⁄° 
di˘
*)
o
->
±r
);

319 
	`£rvîP™ic
("Unknown hashÉncoding");

321  
Àngth
;

322 
	}
}

324 
hashTy≥Iãøt‹
 *
	$hashTy≥InôIãøt‹
(
robj
 *
subje˘
) {

325 
hashTy≥Iãøt‹
 *
hi
 = 
	`zmÆloc
((hashTypeIterator));

326 
hi
->
subje˘
 = subject;

327 
hi
->
ícodög
 = 
subje˘
->encoding;

329 i‡(
hi
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

330 
hi
->
Âå
 = 
NULL
;

331 
hi
->
v±r
 = 
NULL
;

332 } i‡(
hi
->
ícodög
 =
OBJ_ENCODING_HT
) {

333 
hi
->
di
 = 
	`di˘GëIãøt‹
(
subje˘
->
±r
);

335 
	`£rvîP™ic
("Unknown hashÉncoding");

337  
hi
;

338 
	}
}

340 
	$hashTy≥Rñó£Iãøt‹
(
hashTy≥Iãøt‹
 *
hi
) {

341 i‡(
hi
->
ícodög
 =
OBJ_ENCODING_HT
)

342 
	`di˘Rñó£Iãøt‹
(
hi
->
di
);

343 
	`z‰ì
(
hi
);

344 
	}
}

348 
	$hashTy≥Next
(
hashTy≥Iãøt‹
 *
hi
) {

349 i‡(
hi
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

350 *
zl
;

351 *
Âå
, *
v±r
;

353 
zl
 = 
hi
->
subje˘
->
±r
;

354 
Âå
 = 
hi
->fptr;

355 
v±r
 = 
hi
->vptr;

357 i‡(
Âå
 =
NULL
) {

359 
	`£rvîAs£π
(
v±r
 =
NULL
);

360 
Âå
 = 
	`zùli°Index
(
zl
, 0);

363 
	`£rvîAs£π
(
v±r
 !
NULL
);

364 
Âå
 = 
	`zùli°Next
(
zl
, 
v±r
);

366 i‡(
Âå
 =
NULL
Ë 
C_ERR
;

369 
v±r
 = 
	`zùli°Next
(
zl
, 
Âå
);

370 
	`£rvîAs£π
(
v±r
 !
NULL
);

373 
hi
->
Âå
 = fptr;

374 
hi
->
v±r
 = vptr;

375 } i‡(
hi
->
ícodög
 =
OBJ_ENCODING_HT
) {

376 i‡((
hi
->
de
 = 
	`di˘Next
(hi->
di
)Ë=
NULL
Ë 
C_ERR
;

378 
	`£rvîP™ic
("Unknown hashÉncoding");

380  
C_OK
;

381 
	}
}

385 
	$hashTy≥CuºítFromZùli°
(
hashTy≥Iãøt‹
 *
hi
, 
wh©
,

386 **
v°r
,

387 *
vÀn
,

388 *
vŒ
)

390 
ªt
;

392 
	`£rvîAs£π
(
hi
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
);

394 i‡(
wh©
 & 
OBJ_HASH_KEY
) {

395 
ªt
 = 
	`zùli°Gë
(
hi
->
Âå
, 
v°r
, 
vÀn
, 
vŒ
);

396 
	`£rvîAs£π
(
ªt
);

398 
ªt
 = 
	`zùli°Gë
(
hi
->
v±r
, 
v°r
, 
vÀn
, 
vŒ
);

399 
	`£rvîAs£π
(
ªt
);

401 
	}
}

406 
sds
 
	$hashTy≥CuºítFromHashTabÀ
(
hashTy≥Iãøt‹
 *
hi
, 
wh©
) {

407 
	`£rvîAs£π
(
hi
->
ícodög
 =
OBJ_ENCODING_HT
);

409 i‡(
wh©
 & 
OBJ_HASH_KEY
) {

410  
	`di˘GëKey
(
hi
->
de
);

412  
	`di˘GëVÆ
(
hi
->
de
);

414 
	}
}

426 
	$hashTy≥CuºítObje˘
(
hashTy≥Iãøt‹
 *
hi
, 
wh©
, **
v°r
, *
vÀn
, *
vŒ
) {

427 i‡(
hi
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

428 *
v°r
 = 
NULL
;

429 
	`hashTy≥CuºítFromZùli°
(
hi
, 
wh©
, 
v°r
, 
vÀn
, 
vŒ
);

430 } i‡(
hi
->
ícodög
 =
OBJ_ENCODING_HT
) {

431 
sds
 
ñe
 = 
	`hashTy≥CuºítFromHashTabÀ
(
hi
, 
wh©
);

432 *
v°r
 = (*Ë
ñe
;

433 *
vÀn
 = 
	`sd¶í
(
ñe
);

435 
	`£rvîP™ic
("Unknown hashÉncoding");

437 
	}
}

441 
sds
 
	$hashTy≥CuºítObje˘NewSds
(
hashTy≥Iãøt‹
 *
hi
, 
wh©
) {

442 *
v°r
;

443 
vÀn
;

444 
vŒ
;

446 
	`hashTy≥CuºítObje˘
(
hi
,
wh©
,&
v°r
,&
vÀn
,&
vŒ
);

447 i‡(
v°r
Ë 
	`sd¢ewÀn
(v°r,
vÀn
);

448  
	`sds‰oml⁄gl⁄g
(
vŒ
);

449 
	}
}

451 
robj
 *
	$hashTy≥LookupWrôeOrCª©e
(
˛õ¡
 *
c
, 
robj
 *
key
) {

452 
robj
 *
o
 = 
	`lookupKeyWrôe
(
c
->
db
,
key
);

453 i‡(
o
 =
NULL
) {

454 
o
 = 
	`¸óãHashObje˘
();

455 
	`dbAdd
(
c
->
db
,
key
,
o
);

457 i‡(
o
->
ty≥
 !
OBJ_HASH
) {

458 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

459  
NULL
;

462  
o
;

463 
	}
}

465 
	$hashTy≥C⁄vîtZùli°
(
robj
 *
o
, 
íc
) {

466 
	`£rvîAs£π
(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
);

468 i‡(
íc
 =
OBJ_ENCODING_ZIPLIST
) {

471 } i‡(
íc
 =
OBJ_ENCODING_HT
) {

472 
hashTy≥Iãøt‹
 *
hi
;

473 
di˘
 *dict;

474 
ªt
;

476 
hi
 = 
	`hashTy≥InôIãøt‹
(
o
);

477 
di˘
 = 
	`di˘Cª©e
(&
hashDi˘Ty≥
, 
NULL
);

479 
	`hashTy≥Next
(
hi
Ë!
C_ERR
) {

480 
sds
 
key
, 
vÆue
;

482 
key
 = 
	`hashTy≥CuºítObje˘NewSds
(
hi
,
OBJ_HASH_KEY
);

483 
vÆue
 = 
	`hashTy≥CuºítObje˘NewSds
(
hi
,
OBJ_HASH_VALUE
);

484 
ªt
 = 
	`di˘Add
(
di˘
, 
key
, 
vÆue
);

485 i‡(
ªt
 !
DICT_OK
) {

486 
	`£rvîLogHexDump
(
LL_WARNING
,"ziplist with dupÉlements dump",

487 
o
->
±r
,
	`zùli°BlobLí
(o->ptr));

488 
	`£rvîP™ic
("Ziplist corruption detected");

491 
	`hashTy≥Rñó£Iãøt‹
(
hi
);

492 
	`z‰ì
(
o
->
±r
);

493 
o
->
ícodög
 = 
OBJ_ENCODING_HT
;

494 
o
->
±r
 = 
di˘
;

496 
	`£rvîP™ic
("Unknown hashÉncoding");

498 
	}
}

500 
	$hashTy≥C⁄vît
(
robj
 *
o
, 
íc
) {

501 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

502 
	`hashTy≥C⁄vîtZùli°
(
o
, 
íc
);

503 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

504 
	`£rvîP™ic
("Not implemented");

506 
	`£rvîP™ic
("Unknown hashÉncoding");

508 
	}
}

514 
	$h£äxComm™d
(
˛õ¡
 *
c
) {

515 
robj
 *
o
;

516 i‡((
o
 = 
	`hashTy≥LookupWrôeOrCª©e
(
c
,c->
¨gv
[1])Ë=
NULL
) ;

517 
	`hashTy≥TryC⁄vîsi⁄
(
o
,
c
->
¨gv
,2,3);

519 i‡(
	`hashTy≥Exi°s
(
o
, 
c
->
¨gv
[2]->
±r
)) {

520 
	`addRïly
(
c
, 
sh¨ed
.
czîo
);

522 
	`hashTy≥Së
(
o
,
c
->
¨gv
[2]->
±r
,c->¨gv[3]->±r,
HASH_SET_COPY
);

523 
	`addRïly
(
c
, 
sh¨ed
.
c⁄e
);

524 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

525 
	`nŸifyKey•a˚Evít
(
NOTIFY_HASH
,"h£t",
c
->
¨gv
[1],c->
db
->
id
);

526 
£rvî
.
dúty
++;

528 
	}
}

530 
	$h£tComm™d
(
˛õ¡
 *
c
) {

531 
i
, 
¸óãd
 = 0;

532 
robj
 *
o
;

534 i‡((
c
->
¨gc
 % 2) == 1) {

535 
	`addRïlyEº‹
(
c
,"wrongÇumber ofárguments for HMSET");

539 i‡((
o
 = 
	`hashTy≥LookupWrôeOrCª©e
(
c
,c->
¨gv
[1])Ë=
NULL
) ;

540 
	`hashTy≥TryC⁄vîsi⁄
(
o
,
c
->
¨gv
,2,c->
¨gc
-1);

542 
i
 = 2; i < 
c
->
¨gc
; i += 2)

543 
¸óãd
 +!
	`hashTy≥Së
(
o
,
c
->
¨gv
[
i
]->
±r
,c->¨gv[i+1]->±r,
HASH_SET_COPY
);

546 *
cmd«me
 = 
c
->
¨gv
[0]->
±r
;

547 i‡(
cmd«me
[1] == 's' || cmdname[1] == 'S') {

549 
	`addRïlyL⁄gL⁄g
(
c
, 
¸óãd
);

552 
	`addRïly
(
c
, 
sh¨ed
.
ok
);

554 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

555 
	`nŸifyKey•a˚Evít
(
NOTIFY_HASH
,"h£t",
c
->
¨gv
[1],c->
db
->
id
);

556 
£rvî
.
dúty
++;

557 
	}
}

559 
	$hö¸byComm™d
(
˛õ¡
 *
c
) {

560 
vÆue
, 
ö¸
, 
ﬁdvÆue
;

561 
robj
 *
o
;

562 
sds
 
√w
;

563 *
v°r
;

564 
vÀn
;

566 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
ö¸
,
NULL
Ë!
C_OK
) ;

567 i‡((
o
 = 
	`hashTy≥LookupWrôeOrCª©e
(
c
,c->
¨gv
[1])Ë=
NULL
) ;

568 i‡(
	`hashTy≥GëVÆue
(
o
,
c
->
¨gv
[2]->
±r
,&
v°r
,&
vÀn
,&
vÆue
Ë=
C_OK
) {

569 i‡(
v°r
) {

570 i‡(
	`°rög2Œ
((*)
v°r
,
vÀn
,&
vÆue
) == 0) {

571 
	`addRïlyEº‹
(
c
,"hash value isÇotán integer");

576 
vÆue
 = 0;

579 
ﬁdvÆue
 = 
vÆue
;

580 i‡((
ö¸
 < 0 && 
ﬁdvÆue
 < 0 && in¸ < (
LLONG_MIN
-oldvalue)) ||

581 (
ö¸
 > 0 && 
ﬁdvÆue
 > 0 && in¸ > (
LLONG_MAX
-oldvalue))) {

582 
	`addRïlyEº‹
(
c
,"increment or decrement would overflow");

585 
vÆue
 +
ö¸
;

586 
√w
 = 
	`sds‰oml⁄gl⁄g
(
vÆue
);

587 
	`hashTy≥Së
(
o
,
c
->
¨gv
[2]->
±r
,
√w
,
HASH_SET_TAKE_VALUE
);

588 
	`addRïlyL⁄gL⁄g
(
c
,
vÆue
);

589 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

590 
	`nŸifyKey•a˚Evít
(
NOTIFY_HASH
,"hö¸by",
c
->
¨gv
[1],c->
db
->
id
);

591 
£rvî
.
dúty
++;

592 
	}
}

594 
	$hö¸byÊﬂtComm™d
(
˛õ¡
 *
c
) {

595 
vÆue
, 
ö¸
;

596 
Œ
;

597 
robj
 *
o
;

598 
sds
 
√w
;

599 *
v°r
;

600 
vÀn
;

602 i‡(
	`gëL⁄gDoubÀFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
ö¸
,
NULL
Ë!
C_OK
) ;

603 i‡((
o
 = 
	`hashTy≥LookupWrôeOrCª©e
(
c
,c->
¨gv
[1])Ë=
NULL
) ;

604 i‡(
	`hashTy≥GëVÆue
(
o
,
c
->
¨gv
[2]->
±r
,&
v°r
,&
vÀn
,&
Œ
Ë=
C_OK
) {

605 i‡(
v°r
) {

606 i‡(
	`°rög2ld
((*)
v°r
,
vÀn
,&
vÆue
) == 0) {

607 
	`addRïlyEº‹
(
c
,"hash value isÇotá float");

611 
vÆue
 = ()
Œ
;

614 
vÆue
 = 0;

617 
vÆue
 +
ö¸
;

618 i‡(
	`i¢™
(
vÆue
Ë|| 
	`isöf
(value)) {

619 
	`addRïlyEº‹
(
c
,"increment wouldÖroduce NaN or Infinity");

623 
buf
[
MAX_LONG_DOUBLE_CHARS
];

624 
Àn
 = 
	`ld2°rög
(
buf
,(buf),
vÆue
,
LD_STR_HUMAN
);

625 
√w
 = 
	`sd¢ewÀn
(
buf
,
Àn
);

626 
	`hashTy≥Së
(
o
,
c
->
¨gv
[2]->
±r
,
√w
,
HASH_SET_TAKE_VALUE
);

627 
	`addRïlyBulkCBuf„r
(
c
,
buf
,
Àn
);

628 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

629 
	`nŸifyKey•a˚Evít
(
NOTIFY_HASH
,"hö¸byÊﬂt",
c
->
¨gv
[1],c->
db
->
id
);

630 
£rvî
.
dúty
++;

635 
robj
 *
aux
, *
√wobj
;

636 
aux
 = 
	`¸óãSåögObje˘
("HSET",4);

637 
√wobj
 = 
	`¸óãRawSåögObje˘
(
buf
,
Àn
);

638 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,0,
aux
);

639 
	`de¸RefCou¡
(
aux
);

640 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,3,
√wobj
);

641 
	`de¸RefCou¡
(
√wobj
);

642 
	}
}

644 
	$addHashFõldToRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, 
sds
 
fõld
) {

645 
ªt
;

647 i‡(
o
 =
NULL
) {

648 
	`addRïlyNuŒ
(
c
);

652 i‡(
o
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

653 *
v°r
 = 
NULL
;

654 
vÀn
 = 
UINT_MAX
;

655 
vŒ
 = 
LLONG_MAX
;

657 
ªt
 = 
	`hashTy≥GëFromZùli°
(
o
, 
fõld
, &
v°r
, &
vÀn
, &
vŒ
);

658 i‡(
ªt
 < 0) {

659 
	`addRïlyNuŒ
(
c
);

661 i‡(
v°r
) {

662 
	`addRïlyBulkCBuf„r
(
c
, 
v°r
, 
vÀn
);

664 
	`addRïlyBulkL⁄gL⁄g
(
c
, 
vŒ
);

668 } i‡(
o
->
ícodög
 =
OBJ_ENCODING_HT
) {

669 
sds
 
vÆue
 = 
	`hashTy≥GëFromHashTabÀ
(
o
, 
fõld
);

670 i‡(
vÆue
 =
NULL
)

671 
	`addRïlyNuŒ
(
c
);

673 
	`addRïlyBulkCBuf„r
(
c
, 
vÆue
, 
	`sd¶í
(value));

675 
	`£rvîP™ic
("Unknown hashÉncoding");

677 
	}
}

679 
	$hgëComm™d
(
˛õ¡
 *
c
) {

680 
robj
 *
o
;

682 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nuŒ
[c->
ª•
])Ë=
NULL
 ||

683 
	`checkTy≥
(
c
,
o
,
OBJ_HASH
)) ;

685 
	`addHashFõldToRïly
(
c
, 
o
, c->
¨gv
[2]->
±r
);

686 
	}
}

688 
	$hmgëComm™d
(
˛õ¡
 *
c
) {

689 
robj
 *
o
;

690 
i
;

694 
o
 = 
	`lookupKeyRód
(
c
->
db
, c->
¨gv
[1]);

695 i‡(
o
 !
NULL
 && o->
ty≥
 !
OBJ_HASH
) {

696 
	`addRïly
(
c
, 
sh¨ed
.
wr⁄gty≥îr
);

700 
	`addRïlyAºayLí
(
c
, c->
¨gc
-2);

701 
i
 = 2; i < 
c
->
¨gc
; i++) {

702 
	`addHashFõldToRïly
(
c
, 
o
, c->
¨gv
[
i
]->
±r
);

704 
	}
}

706 
	$hdñComm™d
(
˛õ¡
 *
c
) {

707 
robj
 *
o
;

708 
j
, 
dñëed
 = 0, 
keyªmoved
 = 0;

710 i‡((
o
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

711 
	`checkTy≥
(
c
,
o
,
OBJ_HASH
)) ;

713 
j
 = 2; j < 
c
->
¨gc
; j++) {

714 i‡(
	`hashTy≥Dñëe
(
o
,
c
->
¨gv
[
j
]->
±r
)) {

715 
dñëed
++;

716 i‡(
	`hashTy≥Lígth
(
o
) == 0) {

717 
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

718 
keyªmoved
 = 1;

723 i‡(
dñëed
) {

724 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

725 
	`nŸifyKey•a˚Evít
(
NOTIFY_HASH
,"hdñ",
c
->
¨gv
[1],c->
db
->
id
);

726 i‡(
keyªmoved
)

727 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
c
->
¨gv
[1],

728 
c
->
db
->
id
);

729 
£rvî
.
dúty
 +
dñëed
;

731 
	`addRïlyL⁄gL⁄g
(
c
,
dñëed
);

732 
	}
}

734 
	$hÀnComm™d
(
˛õ¡
 *
c
) {

735 
robj
 *
o
;

737 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

738 
	`checkTy≥
(
c
,
o
,
OBJ_HASH
)) ;

740 
	`addRïlyL⁄gL⁄g
(
c
,
	`hashTy≥Lígth
(
o
));

741 
	}
}

743 
	$h°æíComm™d
(
˛õ¡
 *
c
) {

744 
robj
 *
o
;

746 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

747 
	`checkTy≥
(
c
,
o
,
OBJ_HASH
)) ;

748 
	`addRïlyL⁄gL⁄g
(
c
,
	`hashTy≥GëVÆueLígth
(
o
,c->
¨gv
[2]->
±r
));

749 
	}
}

751 
	$addHashIãøt‹Curs‹ToRïly
(
˛õ¡
 *
c
, 
hashTy≥Iãøt‹
 *
hi
, 
wh©
) {

752 i‡(
hi
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

753 *
v°r
 = 
NULL
;

754 
vÀn
 = 
UINT_MAX
;

755 
vŒ
 = 
LLONG_MAX
;

757 
	`hashTy≥CuºítFromZùli°
(
hi
, 
wh©
, &
v°r
, &
vÀn
, &
vŒ
);

758 i‡(
v°r
)

759 
	`addRïlyBulkCBuf„r
(
c
, 
v°r
, 
vÀn
);

761 
	`addRïlyBulkL⁄gL⁄g
(
c
, 
vŒ
);

762 } i‡(
hi
->
ícodög
 =
OBJ_ENCODING_HT
) {

763 
sds
 
vÆue
 = 
	`hashTy≥CuºítFromHashTabÀ
(
hi
, 
wh©
);

764 
	`addRïlyBulkCBuf„r
(
c
, 
vÆue
, 
	`sd¶í
(value));

766 
	`£rvîP™ic
("Unknown hashÉncoding");

768 
	}
}

770 
	$gíîicHgëÆlComm™d
(
˛õ¡
 *
c
, 
Êags
) {

771 
robj
 *
o
;

772 
hashTy≥Iãøt‹
 *
hi
;

773 
Àngth
, 
cou¡
 = 0;

775 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
em±ym≠
[c->
ª•
]))

776 =
NULL
 || 
	`checkTy≥
(
c
,
o
,
OBJ_HASH
)) ;

780 
Àngth
 = 
	`hashTy≥Lígth
(
o
);

781 i‡(
Êags
 & 
OBJ_HASH_KEY
 && fœg†& 
OBJ_HASH_VALUE
) {

782 
	`addRïlyM≠Lí
(
c
, 
Àngth
);

784 
	`addRïlyAºayLí
(
c
, 
Àngth
);

787 
hi
 = 
	`hashTy≥InôIãøt‹
(
o
);

788 
	`hashTy≥Next
(
hi
Ë!
C_ERR
) {

789 i‡(
Êags
 & 
OBJ_HASH_KEY
) {

790 
	`addHashIãøt‹Curs‹ToRïly
(
c
, 
hi
, 
OBJ_HASH_KEY
);

791 
cou¡
++;

793 i‡(
Êags
 & 
OBJ_HASH_VALUE
) {

794 
	`addHashIãøt‹Curs‹ToRïly
(
c
, 
hi
, 
OBJ_HASH_VALUE
);

795 
cou¡
++;

799 
	`hashTy≥Rñó£Iãøt‹
(
hi
);

802 i‡(
Êags
 & 
OBJ_HASH_KEY
 && fœg†& 
OBJ_HASH_VALUE
Ë
cou¡
 /= 2;

803 
	`£rvîAs£π
(
cou¡
 =
Àngth
);

804 
	}
}

806 
	$hkeysComm™d
(
˛õ¡
 *
c
) {

807 
	`gíîicHgëÆlComm™d
(
c
,
OBJ_HASH_KEY
);

808 
	}
}

810 
	$hvÆsComm™d
(
˛õ¡
 *
c
) {

811 
	`gíîicHgëÆlComm™d
(
c
,
OBJ_HASH_VALUE
);

812 
	}
}

814 
	$hgëÆlComm™d
(
˛õ¡
 *
c
) {

815 
	`gíîicHgëÆlComm™d
(
c
,
OBJ_HASH_KEY
|
OBJ_HASH_VALUE
);

816 
	}
}

818 
	$hexi°sComm™d
(
˛õ¡
 *
c
) {

819 
robj
 *
o
;

820 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

821 
	`checkTy≥
(
c
,
o
,
OBJ_HASH
)) ;

823 
	`addRïly
(
c
, 
	`hashTy≥Exi°s
(
o
,c->
¨gv
[2]->
±r
Ë? 
sh¨ed
.
c⁄e
 : sh¨ed.
czîo
);

824 
	}
}

826 
	$hsˇnComm™d
(
˛õ¡
 *
c
) {

827 
robj
 *
o
;

828 
curs‹
;

830 i‡(
	`∑r£SˇnCurs‹OrRïly
(
c
,c->
¨gv
[2],&
curs‹
Ë=
C_ERR
) ;

831 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
em±ysˇn
)Ë=
NULL
 ||

832 
	`checkTy≥
(
c
,
o
,
OBJ_HASH
)) ;

833 
	`sˇnGíîicComm™d
(
c
,
o
,
curs‹
);

834 
	}
}

	@t_list.c

30 
	~"£rvî.h
"

41 
	$li°Ty≥Push
(
robj
 *
subje˘
,Ñobj *
vÆue
, 
whîe
) {

42 i‡(
subje˘
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

43 
pos
 = (
whîe
 =
LIST_HEAD
Ë? 
QUICKLIST_HEAD
 : 
QUICKLIST_TAIL
;

44 
vÆue
 = 
	`gëDecodedObje˘
(value);

45 
size_t
 
Àn
 = 
	`sd¶í
(
vÆue
->
±r
);

46 
	`quickli°Push
(
subje˘
->
±r
, 
vÆue
->±r, 
Àn
, 
pos
);

47 
	`de¸RefCou¡
(
vÆue
);

49 
	`£rvîP™ic
("UnknownÜistÉncoding");

51 
	}
}

53 *
	$li°P›Savî
(*
d©a
, 
sz
) {

54  
	`¸óãSåögObje˘
((*)
d©a
,
sz
);

55 
	}
}

57 
robj
 *
	$li°Ty≥P›
(
robj
 *
subje˘
, 
whîe
) {

58 
vl⁄g
;

59 
robj
 *
vÆue
 = 
NULL
;

61 
ql_whîe
 = 
whîe
 =
LIST_HEAD
 ? 
QUICKLIST_HEAD
 : 
QUICKLIST_TAIL
;

62 i‡(
subje˘
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

63 i‡(
	`quickli°P›Cu°om
(
subje˘
->
±r
, 
ql_whîe
, (**)&
vÆue
,

64 
NULL
, &
vl⁄g
, 
li°P›Savî
)) {

65 i‡(!
vÆue
)

66 
vÆue
 = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
vl⁄g
);

69 
	`£rvîP™ic
("UnknownÜistÉncoding");

71  
vÆue
;

72 
	}
}

74 
	$li°Ty≥Lígth
(c⁄° 
robj
 *
subje˘
) {

75 i‡(
subje˘
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

76  
	`quickli°Cou¡
(
subje˘
->
±r
);

78 
	`£rvîP™ic
("UnknownÜistÉncoding");

80 
	}
}

83 
li°Ty≥Iãøt‹
 *
	$li°Ty≥InôIãøt‹
(
robj
 *
subje˘
, 
ödex
,

84 
dúe˘i⁄
) {

85 
li°Ty≥Iãøt‹
 *
li
 = 
	`zmÆloc
((listTypeIterator));

86 
li
->
subje˘
 = subject;

87 
li
->
ícodög
 = 
subje˘
->encoding;

88 
li
->
dúe˘i⁄
 = direction;

89 
li
->
ôî
 = 
NULL
;

92 
ôî_dúe˘i⁄
 =

93 
dúe˘i⁄
 =
LIST_HEAD
 ? 
AL_START_TAIL
 : 
AL_START_HEAD
;

94 i‡(
li
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

95 
li
->
ôî
 = 
	`quickli°GëIãøt‹AtIdx
÷i->
subje˘
->
±r
,

96 
ôî_dúe˘i⁄
, 
ödex
);

98 
	`£rvîP™ic
("UnknownÜistÉncoding");

100  
li
;

101 
	}
}

104 
	$li°Ty≥Rñó£Iãøt‹
(
li°Ty≥Iãøt‹
 *
li
) {

105 
	`z‰ì
(
li
->
ôî
);

106 
	`z‰ì
(
li
);

107 
	}
}

112 
	$li°Ty≥Next
(
li°Ty≥Iãøt‹
 *
li
, 
li°Ty≥E¡ry
 *
íåy
) {

114 
	`£rvîAs£π
(
li
->
subje˘
->
ícodög
 ==Üi->encoding);

116 
íåy
->
li
 =Üi;

117 i‡(
li
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

118  
	`quickli°Next
(
li
->
ôî
, &
íåy
->entry);

120 
	`£rvîP™ic
("UnknownÜistÉncoding");

123 
	}
}

126 
robj
 *
	$li°Ty≥Gë
(
li°Ty≥E¡ry
 *
íåy
) {

127 
robj
 *
vÆue
 = 
NULL
;

128 i‡(
íåy
->
li
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

129 i‡(
íåy
->íåy.
vÆue
) {

130 
vÆue
 = 
	`¸óãSåögObje˘
((*)
íåy
->entry.value,

131 
íåy
->íåy.
sz
);

133 
vÆue
 = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
íåy
->íåy.
l⁄gvÆ
);

136 
	`£rvîP™ic
("UnknownÜistÉncoding");

138  
vÆue
;

139 
	}
}

141 
	$li°Ty≥In£π
(
li°Ty≥E¡ry
 *
íåy
, 
robj
 *
vÆue
, 
whîe
) {

142 i‡(
íåy
->
li
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

143 
vÆue
 = 
	`gëDecodedObje˘
(value);

144 
sds
 
°r
 = 
vÆue
->
±r
;

145 
size_t
 
Àn
 = 
	`sd¶í
(
°r
);

146 i‡(
whîe
 =
LIST_TAIL
) {

147 
	`quickli°In£πA·î
((
quickli°
 *)
íåy
->entry.quicklist,

148 &
íåy
->íåy, 
°r
, 
Àn
);

149 } i‡(
whîe
 =
LIST_HEAD
) {

150 
	`quickli°In£πBef‹e
((
quickli°
 *)
íåy
->entry.quicklist,

151 &
íåy
->íåy, 
°r
, 
Àn
);

153 
	`de¸RefCou¡
(
vÆue
);

155 
	`£rvîP™ic
("UnknownÜistÉncoding");

157 
	}
}

160 
	$li°Ty≥EquÆ
(
li°Ty≥E¡ry
 *
íåy
, 
robj
 *
o
) {

161 i‡(
íåy
->
li
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

162 
	`£rvîAs£πWôhInfo
(
NULL
,
o
,
	`sdsEncodedObje˘
(o));

163  
	`quickli°Com∑ª
(
íåy
->íåy.
zi
,
o
->
±r
,
	`sd¶í
(o->ptr));

165 
	`£rvîP™ic
("UnknownÜistÉncoding");

167 
	}
}

170 
	$li°Ty≥Dñëe
(
li°Ty≥Iãøt‹
 *
ôî
, 
li°Ty≥E¡ry
 *
íåy
) {

171 i‡(
íåy
->
li
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

172 
	`quickli°DñE¡ry
(
ôî
->ôî, &
íåy
->entry);

174 
	`£rvîP™ic
("UnknownÜistÉncoding");

176 
	}
}

179 
	$li°Ty≥C⁄vît
(
robj
 *
subje˘
, 
íc
) {

180 
	`£rvîAs£πWôhInfo
(
NULL
,
subje˘
,subje˘->
ty≥
==
OBJ_LIST
);

181 
	`£rvîAs£πWôhInfo
(
NULL
,
subje˘
,subje˘->
ícodög
==
OBJ_ENCODING_ZIPLIST
);

183 i‡(
íc
 =
OBJ_ENCODING_QUICKLIST
) {

184 
size_t
 
zÀn
 = 
£rvî
.
li°_max_zùli°_size
;

185 
dïth
 = 
£rvî
.
li°_com¥ess_dïth
;

186 
subje˘
->
±r
 = 
	`quickli°Cª©eFromZùli°
(
zÀn
, 
dïth
, subject->ptr);

187 
subje˘
->
ícodög
 = 
OBJ_ENCODING_QUICKLIST
;

189 
	`£rvîP™ic
("UnsupportedÜist conversion");

191 
	}
}

197 
	$pushGíîicComm™d
(
˛õ¡
 *
c
, 
whîe
) {

198 
j
, 
pushed
 = 0;

199 
robj
 *
lobj
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

201 i‡(
lobj
 &&Üobj->
ty≥
 !
OBJ_LIST
) {

202 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

206 
j
 = 2; j < 
c
->
¨gc
; j++) {

207 i‡(!
lobj
) {

208 
lobj
 = 
	`¸óãQuickli°Obje˘
();

209 
	`quickli°SëO±i⁄s
(
lobj
->
±r
, 
£rvî
.
li°_max_zùli°_size
,

210 
£rvî
.
li°_com¥ess_dïth
);

211 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],
lobj
);

213 
	`li°Ty≥Push
(
lobj
,
c
->
¨gv
[
j
],
whîe
);

214 
pushed
++;

216 
	`addRïlyL⁄gL⁄g
(
c
, (
lobj
 ? 
	`li°Ty≥Lígth
(lobj) : 0));

217 i‡(
pushed
) {

218 *
evít
 = (
whîe
 =
LIST_HEAD
) ? "lpush" : "rpush";

220 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

221 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,
evít
,
c
->
¨gv
[1],c->
db
->
id
);

223 
£rvî
.
dúty
 +
pushed
;

224 
	}
}

226 
	$ÕushComm™d
(
˛õ¡
 *
c
) {

227 
	`pushGíîicComm™d
(
c
,
LIST_HEAD
);

228 
	}
}

230 
	$ΩushComm™d
(
˛õ¡
 *
c
) {

231 
	`pushGíîicComm™d
(
c
,
LIST_TAIL
);

232 
	}
}

234 
	$pushxGíîicComm™d
(
˛õ¡
 *
c
, 
whîe
) {

235 
j
, 
pushed
 = 0;

236 
robj
 *
subje˘
;

238 i‡((
subje˘
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

239 
	`checkTy≥
(
c
,
subje˘
,
OBJ_LIST
)) ;

241 
j
 = 2; j < 
c
->
¨gc
; j++) {

242 
	`li°Ty≥Push
(
subje˘
,
c
->
¨gv
[
j
],
whîe
);

243 
pushed
++;

246 
	`addRïlyL⁄gL⁄g
(
c
,
	`li°Ty≥Lígth
(
subje˘
));

248 i‡(
pushed
) {

249 *
evít
 = (
whîe
 =
LIST_HEAD
) ? "lpush" : "rpush";

250 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

251 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,
evít
,
c
->
¨gv
[1],c->
db
->
id
);

253 
£rvî
.
dúty
 +
pushed
;

254 
	}
}

256 
	$ÕushxComm™d
(
˛õ¡
 *
c
) {

257 
	`pushxGíîicComm™d
(
c
,
LIST_HEAD
);

258 
	}
}

260 
	$ΩushxComm™d
(
˛õ¡
 *
c
) {

261 
	`pushxGíîicComm™d
(
c
,
LIST_TAIL
);

262 
	}
}

264 
	$lö£πComm™d
(
˛õ¡
 *
c
) {

265 
whîe
;

266 
robj
 *
subje˘
;

267 
li°Ty≥Iãøt‹
 *
ôî
;

268 
li°Ty≥E¡ry
 
íåy
;

269 
ö£πed
 = 0;

271 i‡(
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"after") == 0) {

272 
whîe
 = 
LIST_TAIL
;

273 } i‡(
	`°rˇ£cmp
(
c
->
¨gv
[2]->
±r
,"before") == 0) {

274 
whîe
 = 
LIST_HEAD
;

276 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

280 i‡((
subje˘
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

281 
	`checkTy≥
(
c
,
subje˘
,
OBJ_LIST
)) ;

284 
ôî
 = 
	`li°Ty≥InôIãøt‹
(
subje˘
,0,
LIST_TAIL
);

285 
	`li°Ty≥Next
(
ôî
,&
íåy
)) {

286 i‡(
	`li°Ty≥EquÆ
(&
íåy
,
c
->
¨gv
[3])) {

287 
	`li°Ty≥In£π
(&
íåy
,
c
->
¨gv
[4],
whîe
);

288 
ö£πed
 = 1;

292 
	`li°Ty≥Rñó£Iãøt‹
(
ôî
);

294 i‡(
ö£πed
) {

295 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

296 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,"linsert",

297 
c
->
¨gv
[1],c->
db
->
id
);

298 
£rvî
.
dúty
++;

301 
	`addRïlyL⁄gL⁄g
(
c
,-1);

305 
	`addRïlyL⁄gL⁄g
(
c
,
	`li°Ty≥Lígth
(
subje˘
));

306 
	}
}

308 
	$ŒíComm™d
(
˛õ¡
 *
c
) {

309 
robj
 *
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
);

310 i‡(
o
 =
NULL
 || 
	`checkTy≥
(
c
,o,
OBJ_LIST
)) ;

311 
	`addRïlyL⁄gL⁄g
(
c
,
	`li°Ty≥Lígth
(
o
));

312 
	}
}

314 
	$lödexComm™d
(
˛õ¡
 *
c
) {

315 
robj
 *
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nuŒ
[c->
ª•
]);

316 i‡(
o
 =
NULL
 || 
	`checkTy≥
(
c
,o,
OBJ_LIST
)) ;

317 
ödex
;

318 
robj
 *
vÆue
 = 
NULL
;

320 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
ödex
, 
NULL
Ë!
C_OK
))

323 i‡(
o
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

324 
quickli°E¡ry
 
íåy
;

325 i‡(
	`quickli°Index
(
o
->
±r
, 
ödex
, &
íåy
)) {

326 i‡(
íåy
.
vÆue
) {

327 
vÆue
 = 
	`¸óãSåögObje˘
((*)
íåy
.vÆue,íåy.
sz
);

329 
vÆue
 = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
íåy
.
l⁄gvÆ
);

331 
	`addRïlyBulk
(
c
,
vÆue
);

332 
	`de¸RefCou¡
(
vÆue
);

334 
	`addRïlyNuŒ
(
c
);

337 
	`£rvîP™ic
("UnknownÜistÉncoding");

339 
	}
}

341 
	$l£tComm™d
(
˛õ¡
 *
c
) {

342 
robj
 *
o
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nokeyîr
);

343 i‡(
o
 =
NULL
 || 
	`checkTy≥
(
c
,o,
OBJ_LIST
)) ;

344 
ödex
;

345 
robj
 *
vÆue
 = 
c
->
¨gv
[3];

347 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
ödex
, 
NULL
Ë!
C_OK
))

350 i‡(
o
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

351 
quickli°
 *
ql
 = 
o
->
±r
;

352 
ª∂a˚d
 = 
	`quickli°Rïœ˚AtIndex
(
ql
, 
ödex
,

353 
vÆue
->
±r
, 
	`sd¶í
(value->ptr));

354 i‡(!
ª∂a˚d
) {

355 
	`addRïly
(
c
,
sh¨ed
.
outo‰™gìº
);

357 
	`addRïly
(
c
,
sh¨ed
.
ok
);

358 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

359 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,"l£t",
c
->
¨gv
[1],c->
db
->
id
);

360 
£rvî
.
dúty
++;

363 
	`£rvîP™ic
("UnknownÜistÉncoding");

365 
	}
}

367 
	$p›GíîicComm™d
(
˛õ¡
 *
c
, 
whîe
) {

368 
robj
 *
o
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nuŒ
[c->
ª•
]);

369 i‡(
o
 =
NULL
 || 
	`checkTy≥
(
c
,o,
OBJ_LIST
)) ;

371 
robj
 *
vÆue
 = 
	`li°Ty≥P›
(
o
,
whîe
);

372 i‡(
vÆue
 =
NULL
) {

373 
	`addRïlyNuŒ
(
c
);

375 *
evít
 = (
whîe
 =
LIST_HEAD
) ? "lpop" : "rpop";

377 
	`addRïlyBulk
(
c
,
vÆue
);

378 
	`de¸RefCou¡
(
vÆue
);

379 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,
evít
,
c
->
¨gv
[1],c->
db
->
id
);

380 i‡(
	`li°Ty≥Lígth
(
o
) == 0) {

381 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"del",

382 
c
->
¨gv
[1],c->
db
->
id
);

383 
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

385 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

386 
£rvî
.
dúty
++;

388 
	}
}

390 
	$Õ›Comm™d
(
˛õ¡
 *
c
) {

391 
	`p›GíîicComm™d
(
c
,
LIST_HEAD
);

392 
	}
}

394 
	$Ω›Comm™d
(
˛õ¡
 *
c
) {

395 
	`p›GíîicComm™d
(
c
,
LIST_TAIL
);

396 
	}
}

398 
	$Ã™geComm™d
(
˛õ¡
 *
c
) {

399 
robj
 *
o
;

400 
°¨t
, 
íd
, 
Œí
, 
øngñí
;

402 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
°¨t
, 
NULL
Ë!
C_OK
) ||

403 (
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[3], &
íd
, 
NULL
Ë!
C_OK
)) ;

405 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
em±y¨øy
)Ë=
NULL


406 || 
	`checkTy≥
(
c
,
o
,
OBJ_LIST
)) ;

407 
Œí
 = 
	`li°Ty≥Lígth
(
o
);

410 i‡(
°¨t
 < 0Ë°¨à
Œí
+start;

411 i‡(
íd
 < 0Ëíd = 
Œí
+end;

412 i‡(
°¨t
 < 0) start = 0;

416 i‡(
°¨t
 > 
íd
 || sèπ >
Œí
) {

417 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

420 i‡(
íd
 >
Œí
)Énd =Ülen-1;

421 
øngñí
 = (
íd
-
°¨t
)+1;

424 
	`addRïlyAºayLí
(
c
,
øngñí
);

425 i‡(
o
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

426 
li°Ty≥Iãøt‹
 *
ôî
 = 
	`li°Ty≥InôIãøt‹
(
o
, 
°¨t
, 
LIST_TAIL
);

428 
øngñí
--) {

429 
li°Ty≥E¡ry
 
íåy
;

430 
	`li°Ty≥Next
(
ôî
, &
íåy
);

431 
quickli°E¡ry
 *
qe
 = &
íåy
.entry;

432 i‡(
qe
->
vÆue
) {

433 
	`addRïlyBulkCBuf„r
(
c
,
qe
->
vÆue
,qe->
sz
);

435 
	`addRïlyBulkL⁄gL⁄g
(
c
,
qe
->
l⁄gvÆ
);

438 
	`li°Ty≥Rñó£Iãøt‹
(
ôî
);

440 
	`£rvîP™ic
("ListÉncoding isÇot QUICKLIST!");

442 
	}
}

444 
	$…rimComm™d
(
˛õ¡
 *
c
) {

445 
robj
 *
o
;

446 
°¨t
, 
íd
, 
Œí
, 
…rim
, 
πrim
;

448 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
°¨t
, 
NULL
Ë!
C_OK
) ||

449 (
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[3], &
íd
, 
NULL
Ë!
C_OK
)) ;

451 i‡((
o
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
ok
)Ë=
NULL
 ||

452 
	`checkTy≥
(
c
,
o
,
OBJ_LIST
)) ;

453 
Œí
 = 
	`li°Ty≥Lígth
(
o
);

456 i‡(
°¨t
 < 0Ë°¨à
Œí
+start;

457 i‡(
íd
 < 0Ëíd = 
Œí
+end;

458 i‡(
°¨t
 < 0) start = 0;

462 i‡(
°¨t
 > 
íd
 || sèπ >
Œí
) {

464 
…rim
 = 
Œí
;

465 
πrim
 = 0;

467 i‡(
íd
 >
Œí
)Énd =Ülen-1;

468 
…rim
 = 
°¨t
;

469 
πrim
 = 
Œí
-
íd
-1;

473 i‡(
o
->
ícodög
 =
OBJ_ENCODING_QUICKLIST
) {

474 
	`quickli°DñR™ge
(
o
->
±r
,0,
…rim
);

475 
	`quickli°DñR™ge
(
o
->
±r
,-
πrim
,rtrim);

477 
	`£rvîP™ic
("UnknownÜistÉncoding");

480 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,"…rim",
c
->
¨gv
[1],c->
db
->
id
);

481 i‡(
	`li°Ty≥Lígth
(
o
) == 0) {

482 
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

483 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
c
->
¨gv
[1],c->
db
->
id
);

485 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

486 
£rvî
.
dúty
++;

487 
	`addRïly
(
c
,
sh¨ed
.
ok
);

488 
	}
}

490 
	$ÃemComm™d
(
˛õ¡
 *
c
) {

491 
robj
 *
subje˘
, *
obj
;

492 
obj
 = 
c
->
¨gv
[3];

493 
t‹emove
;

494 
ªmoved
 = 0;

496 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
t‹emove
, 
NULL
Ë!
C_OK
))

499 
subje˘
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
);

500 i‡(
subje˘
 =
NULL
 || 
	`checkTy≥
(
c
,subje˘,
OBJ_LIST
)) ;

502 
li°Ty≥Iãøt‹
 *
li
;

503 i‡(
t‹emove
 < 0) {

504 
t‹emove
 = -toremove;

505 
li
 = 
	`li°Ty≥InôIãøt‹
(
subje˘
,-1,
LIST_HEAD
);

507 
li
 = 
	`li°Ty≥InôIãøt‹
(
subje˘
,0,
LIST_TAIL
);

510 
li°Ty≥E¡ry
 
íåy
;

511 
	`li°Ty≥Next
(
li
,&
íåy
)) {

512 i‡(
	`li°Ty≥EquÆ
(&
íåy
,
obj
)) {

513 
	`li°Ty≥Dñëe
(
li
, &
íåy
);

514 
£rvî
.
dúty
++;

515 
ªmoved
++;

516 i‡(
t‹emove
 && 
ªmoved
 ==Åoremove) ;

519 
	`li°Ty≥Rñó£Iãøt‹
(
li
);

521 i‡(
ªmoved
) {

522 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

523 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,"Ãem",
c
->
¨gv
[1],c->
db
->
id
);

526 i‡(
	`li°Ty≥Lígth
(
subje˘
) == 0) {

527 
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

528 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
c
->
¨gv
[1],c->
db
->
id
);

531 
	`addRïlyL⁄gL⁄g
(
c
,
ªmoved
);

532 
	}
}

550 
	$Ω›ÕushH™dÀPush
(
˛õ¡
 *
c
, 
robj
 *
d°key
,Ñobj *
d°obj
,Ñobj *
vÆue
) {

552 i‡(!
d°obj
) {

553 
d°obj
 = 
	`¸óãQuickli°Obje˘
();

554 
	`quickli°SëO±i⁄s
(
d°obj
->
±r
, 
£rvî
.
li°_max_zùli°_size
,

555 
£rvî
.
li°_com¥ess_dïth
);

556 
	`dbAdd
(
c
->
db
,
d°key
,
d°obj
);

558 
	`sig«lModifõdKey
(
c
,c->
db
,
d°key
);

559 
	`li°Ty≥Push
(
d°obj
,
vÆue
,
LIST_HEAD
);

560 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,"Õush",
d°key
,
c
->
db
->
id
);

562 
	`addRïlyBulk
(
c
,
vÆue
);

563 
	}
}

565 
	$Ω›ÕushComm™d
(
˛õ¡
 *
c
) {

566 
robj
 *
sobj
, *
vÆue
;

567 i‡((
sobj
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nuŒ
[c->
ª•
]))

568 =
NULL
 || 
	`checkTy≥
(
c
,
sobj
,
OBJ_LIST
)) ;

570 i‡(
	`li°Ty≥Lígth
(
sobj
) == 0) {

573 
	`addRïlyNuŒ
(
c
);

575 
robj
 *
dobj
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[2]);

576 
robj
 *
touchedkey
 = 
c
->
¨gv
[1];

578 i‡(
dobj
 && 
	`checkTy≥
(
c
,dobj,
OBJ_LIST
)) ;

579 
vÆue
 = 
	`li°Ty≥P›
(
sobj
,
LIST_TAIL
);

583 
	`ö¸RefCou¡
(
touchedkey
);

584 
	`Ω›ÕushH™dÀPush
(
c
,c->
¨gv
[2],
dobj
,
vÆue
);

587 
	`de¸RefCou¡
(
vÆue
);

590 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,"Ω›",
touchedkey
,
c
->
db
->
id
);

591 i‡(
	`li°Ty≥Lígth
(
sobj
) == 0) {

592 
	`dbDñëe
(
c
->
db
,
touchedkey
);

593 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"del",

594 
touchedkey
,
c
->
db
->
id
);

596 
	`sig«lModifõdKey
(
c
,c->
db
,
touchedkey
);

597 
	`de¸RefCou¡
(
touchedkey
);

598 
£rvî
.
dúty
++;

599 i‡(
c
->
cmd
->
¥oc
 =
bΩ›ÕushComm™d
) {

600 
	`ªwrôeClõ¡Comm™dVe˘‹
(
c
,3,
sh¨ed
.
Ω›Õush
,c->
¨gv
[1],c->argv[2]);

603 
	}
}

628 
	$£rveClõ¡BlockedOnLi°
(
˛õ¡
 *
ª˚ivî
, 
robj
 *
key
,Ñobj *
d°key
, 
ªdisDb
 *
db
,Ñobj *
vÆue
, 
whîe
)

630 
robj
 *
¨gv
[3];

632 i‡(
d°key
 =
NULL
) {

634 
¨gv
[0] = (
whîe
 =
LIST_HEAD
Ë? 
sh¨ed
.
Õ›
 :

635 
sh¨ed
.
Ω›
;

636 
¨gv
[1] = 
key
;

637 
	`¥›ag©e
((
whîe
 =
LIST_HEAD
) ?

638 
£rvî
.
Õ›Comm™d
 : sîvî.
Ω›Comm™d
,

639 
db
->
id
,
¨gv
,2,
PROPAGATE_AOF
|
PROPAGATE_REPL
);

642 
	`addRïlyAºayLí
(
ª˚ivî
,2);

643 
	`addRïlyBulk
(
ª˚ivî
,
key
);

644 
	`addRïlyBulk
(
ª˚ivî
,
vÆue
);

647 *
evít
 = (
whîe
 =
LIST_HEAD
) ? "lpop" : "rpop";

648 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,
evít
,
key
,
ª˚ivî
->
db
->
id
);

651 
robj
 *
d°obj
 =

652 
	`lookupKeyWrôe
(
ª˚ivî
->
db
,
d°key
);

653 i‡(!(
d°obj
 &&

654 
	`checkTy≥
(
ª˚ivî
,
d°obj
,
OBJ_LIST
)))

656 
	`Ω›ÕushH™dÀPush
(
ª˚ivî
,
d°key
,
d°obj
,

657 
vÆue
);

659 
¨gv
[0] = 
sh¨ed
.
Ω›Õush
;

660 
¨gv
[1] = 
key
;

661 
¨gv
[2] = 
d°key
;

662 
	`¥›ag©e
(
£rvî
.
Ω›ÕushComm™d
,

663 
db
->
id
,
¨gv
,3,

664 
PROPAGATE_AOF
|

665 
PROPAGATE_REPL
);

668 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,"Ω›",
key
,
ª˚ivî
->
db
->
id
);

672  
C_ERR
;

675  
C_OK
;

676 
	}
}

679 
	$blockögP›GíîicComm™d
(
˛õ¡
 *
c
, 
whîe
) {

680 
robj
 *
o
;

681 
m°ime_t
 
timeout
;

682 
j
;

684 i‡(
	`gëTimeoutFromObje˘OrRïly
(
c
,c->
¨gv
[c->
¨gc
-1],&
timeout
,
UNIT_SECONDS
)

685 !
C_OK
) ;

687 
j
 = 1; j < 
c
->
¨gc
-1; j++) {

688 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[
j
]);

689 i‡(
o
 !
NULL
) {

690 i‡(
o
->
ty≥
 !
OBJ_LIST
) {

691 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

694 i‡(
	`li°Ty≥Lígth
(
o
) != 0) {

696 *
evít
 = (
whîe
 =
LIST_HEAD
) ? "lpop" : "rpop";

697 
robj
 *
vÆue
 = 
	`li°Ty≥P›
(
o
,
whîe
);

698 
	`£rvîAs£π
(
vÆue
 !
NULL
);

700 
	`addRïlyAºayLí
(
c
,2);

701 
	`addRïlyBulk
(
c
,c->
¨gv
[
j
]);

702 
	`addRïlyBulk
(
c
,
vÆue
);

703 
	`de¸RefCou¡
(
vÆue
);

704 
	`nŸifyKey•a˚Evít
(
NOTIFY_LIST
,
evít
,

705 
c
->
¨gv
[
j
],c->
db
->
id
);

706 i‡(
	`li°Ty≥Lígth
(
o
) == 0) {

707 
	`dbDñëe
(
c
->
db
,c->
¨gv
[
j
]);

708 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"del",

709 
c
->
¨gv
[
j
],c->
db
->
id
);

711 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[
j
]);

712 
£rvî
.
dúty
++;

715 
	`ªwrôeClõ¡Comm™dVe˘‹
(
c
,2,

716 (
whîe
 =
LIST_HEAD
Ë? 
sh¨ed
.
Õ›
 : sh¨ed.
Ω›
,

717 
c
->
¨gv
[
j
]);

726 i‡(
c
->
Êags
 & 
CLIENT_MULTI
) {

727 
	`addRïlyNuŒAºay
(
c
);

732 
	`blockF‹Keys
(
c
,
BLOCKED_LIST
,c->
¨gv
 + 1,c->
¨gc
 - 2,
timeout
,
NULL
,NULL);

733 
	}
}

735 
	$bÕ›Comm™d
(
˛õ¡
 *
c
) {

736 
	`blockögP›GíîicComm™d
(
c
,
LIST_HEAD
);

737 
	}
}

739 
	$bΩ›Comm™d
(
˛õ¡
 *
c
) {

740 
	`blockögP›GíîicComm™d
(
c
,
LIST_TAIL
);

741 
	}
}

743 
	$bΩ›ÕushComm™d
(
˛õ¡
 *
c
) {

744 
m°ime_t
 
timeout
;

746 i‡(
	`gëTimeoutFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
timeout
,
UNIT_SECONDS
)

747 !
C_OK
) ;

749 
robj
 *
key
 = 
	`lookupKeyWrôe
(
c
->
db
, c->
¨gv
[1]);

751 i‡(
key
 =
NULL
) {

752 i‡(
c
->
Êags
 & 
CLIENT_MULTI
) {

755 
	`addRïlyNuŒ
(
c
);

758 
	`blockF‹Keys
(
c
,
BLOCKED_LIST
,c->
¨gv
 + 1,1,
timeout
,c->¨gv[2],
NULL
);

761 i‡(
key
->
ty≥
 !
OBJ_LIST
) {

762 
	`addRïly
(
c
, 
sh¨ed
.
wr⁄gty≥îr
);

766 
	`£rvîAs£πWôhInfo
(
c
,
key
,
	`li°Ty≥Lígth
(key) > 0);

767 
	`Ω›ÕushComm™d
(
c
);

770 
	}
}

	@t_set.c

30 
	~"£rvî.h
"

36 
suni⁄DiffGíîicComm™d
(
˛õ¡
 *
c
, 
robj
 **
£tkeys
, 
£äum
,

37 
robj
 *
d°key
, 
›
);

42 
robj
 *
	$£tTy≥Cª©e
(
sds
 
vÆue
) {

43 i‡(
	`isSdsRïª£¡abÀAsL⁄gL⁄g
(
vÆue
,
NULL
Ë=
C_OK
)

44  
	`¸óãI¡£tObje˘
();

45  
	`¸óãSëObje˘
();

46 
	}
}

52 
	$£tTy≥Add
(
robj
 *
subje˘
, 
sds
 
vÆue
) {

53 
ŒvÆ
;

54 i‡(
subje˘
->
ícodög
 =
OBJ_ENCODING_HT
) {

55 
di˘
 *
ht
 = 
subje˘
->
±r
;

56 
di˘E¡ry
 *
de
 = 
	`di˘AddRaw
(
ht
,
vÆue
,
NULL
);

57 i‡(
de
) {

58 
	`di˘SëKey
(
ht
,
de
,
	`sdsdup
(
vÆue
));

59 
	`di˘SëVÆ
(
ht
,
de
,
NULL
);

62 } i‡(
subje˘
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

63 i‡(
	`isSdsRïª£¡abÀAsL⁄gL⁄g
(
vÆue
,&
ŒvÆ
Ë=
C_OK
) {

64 
uöt8_t
 
suc˚ss
 = 0;

65 
subje˘
->
±r
 = 
	`öt£tAdd
(subje˘->±r,
ŒvÆ
,&
suc˚ss
);

66 i‡(
suc˚ss
) {

69 i‡(
	`öt£tLí
(
subje˘
->
±r
Ë> 
£rvî
.
£t_max_öt£t_íåõs
)

70 
	`£tTy≥C⁄vît
(
subje˘
,
OBJ_ENCODING_HT
);

75 
	`£tTy≥C⁄vît
(
subje˘
,
OBJ_ENCODING_HT
);

79 
	`£rvîAs£π
(
	`di˘Add
(
subje˘
->
±r
,
	`sdsdup
(
vÆue
),
NULL
Ë=
DICT_OK
);

83 
	`£rvîP™ic
("Unknown setÉncoding");

86 
	}
}

88 
	$£tTy≥Remove
(
robj
 *
£tobj
, 
sds
 
vÆue
) {

89 
ŒvÆ
;

90 i‡(
£tobj
->
ícodög
 =
OBJ_ENCODING_HT
) {

91 i‡(
	`di˘Dñëe
(
£tobj
->
±r
,
vÆue
Ë=
DICT_OK
) {

92 i‡(
	`htNìdsResize
(
£tobj
->
±r
)Ë
	`di˘Resize
(setobj->ptr);

95 } i‡(
£tobj
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

96 i‡(
	`isSdsRïª£¡abÀAsL⁄gL⁄g
(
vÆue
,&
ŒvÆ
Ë=
C_OK
) {

97 
suc˚ss
;

98 
£tobj
->
±r
 = 
	`öt£tRemove
(£tobj->±r,
ŒvÆ
,&
suc˚ss
);

99 i‡(
suc˚ss
)  1;

102 
	`£rvîP™ic
("Unknown setÉncoding");

105 
	}
}

107 
	$£tTy≥IsMembî
(
robj
 *
subje˘
, 
sds
 
vÆue
) {

108 
ŒvÆ
;

109 i‡(
subje˘
->
ícodög
 =
OBJ_ENCODING_HT
) {

110  
	`di˘Föd
((
di˘
*)
subje˘
->
±r
,
vÆue
Ë!
NULL
;

111 } i‡(
subje˘
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

112 i‡(
	`isSdsRïª£¡abÀAsL⁄gL⁄g
(
vÆue
,&
ŒvÆ
Ë=
C_OK
) {

113  
	`öt£tFöd
((
öt£t
*)
subje˘
->
±r
,
ŒvÆ
);

116 
	`£rvîP™ic
("Unknown setÉncoding");

119 
	}
}

121 
£tTy≥Iãøt‹
 *
	$£tTy≥InôIãøt‹
(
robj
 *
subje˘
) {

122 
£tTy≥Iãøt‹
 *
si
 = 
	`zmÆloc
((setTypeIterator));

123 
si
->
subje˘
 = subject;

124 
si
->
ícodög
 = 
subje˘
->encoding;

125 i‡(
si
->
ícodög
 =
OBJ_ENCODING_HT
) {

126 
si
->
di
 = 
	`di˘GëIãøt‹
(
subje˘
->
±r
);

127 } i‡(
si
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

128 
si
->
ii
 = 0;

130 
	`£rvîP™ic
("Unknown setÉncoding");

132  
si
;

133 
	}
}

135 
	$£tTy≥Rñó£Iãøt‹
(
£tTy≥Iãøt‹
 *
si
) {

136 i‡(
si
->
ícodög
 =
OBJ_ENCODING_HT
)

137 
	`di˘Rñó£Iãøt‹
(
si
->
di
);

138 
	`z‰ì
(
si
);

139 
	}
}

154 
	$£tTy≥Next
(
£tTy≥Iãøt‹
 *
si
, 
sds
 *
sd£À
, 
öt64_t
 *
Œñe
) {

155 i‡(
si
->
ícodög
 =
OBJ_ENCODING_HT
) {

156 
di˘E¡ry
 *
de
 = 
	`di˘Next
(
si
->
di
);

157 i‡(
de
 =
NULL
)  -1;

158 *
sd£À
 = 
	`di˘GëKey
(
de
);

159 *
Œñe
 = -123456789;

160 } i‡(
si
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

161 i‡(!
	`öt£tGë
(
si
->
subje˘
->
±r
,si->
ii
++,
Œñe
))

163 *
sd£À
 = 
NULL
;

165 
	`£rvîP™ic
("Wrong setÉncoding in setTypeNext");

167  
si
->
ícodög
;

168 
	}
}

177 
sds
 
	$£tTy≥NextObje˘
(
£tTy≥Iãøt‹
 *
si
) {

178 
öt64_t
 
öãÀ
;

179 
sds
 
sd£À
;

180 
ícodög
;

182 
ícodög
 = 
	`£tTy≥Next
(
si
,&
sd£À
,&
öãÀ
);

183 
ícodög
) {

184 -1:  
NULL
;

185 
OBJ_ENCODING_INTSET
:

186  
	`sds‰oml⁄gl⁄g
(
öãÀ
);

187 
OBJ_ENCODING_HT
:

188  
	`sdsdup
(
sd£À
);

190 
	`£rvîP™ic
("UnsupportedÉncoding");

192  
NULL
;

193 
	}
}

208 
	$£tTy≥R™domEÀmít
(
robj
 *
£tobj
, 
sds
 *
sd£À
, 
öt64_t
 *
Œñe
) {

209 i‡(
£tobj
->
ícodög
 =
OBJ_ENCODING_HT
) {

210 
di˘E¡ry
 *
de
 = 
	`di˘GëFaúR™domKey
(
£tobj
->
±r
);

211 *
sd£À
 = 
	`di˘GëKey
(
de
);

212 *
Œñe
 = -123456789;

213 } i‡(
£tobj
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

214 *
Œñe
 = 
	`öt£tR™dom
(
£tobj
->
±r
);

215 *
sd£À
 = 
NULL
;

217 
	`£rvîP™ic
("Unknown setÉncoding");

219  
£tobj
->
ícodög
;

220 
	}
}

222 
	$£tTy≥Size
(c⁄° 
robj
 *
subje˘
) {

223 i‡(
subje˘
->
ícodög
 =
OBJ_ENCODING_HT
) {

224  
	`di˘Size
((c⁄° 
di˘
*)
subje˘
->
±r
);

225 } i‡(
subje˘
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

226  
	`öt£tLí
((c⁄° 
öt£t
*)
subje˘
->
±r
);

228 
	`£rvîP™ic
("Unknown setÉncoding");

230 
	}
}

235 
	$£tTy≥C⁄vît
(
robj
 *
£tobj
, 
íc
) {

236 
£tTy≥Iãøt‹
 *
si
;

237 
	`£rvîAs£πWôhInfo
(
NULL
,
£tobj
,£tobj->
ty≥
 =
OBJ_SET
 &&

238 
£tobj
->
ícodög
 =
OBJ_ENCODING_INTSET
);

240 i‡(
íc
 =
OBJ_ENCODING_HT
) {

241 
öt64_t
 
öãÀ
;

242 
di˘
 *
d
 = 
	`di˘Cª©e
(&
£tDi˘Ty≥
,
NULL
);

243 
sds
 
ñemít
;

246 
	`di˘Ex∑nd
(
d
,
	`öt£tLí
(
£tobj
->
±r
));

249 
si
 = 
	`£tTy≥InôIãøt‹
(
£tobj
);

250 
	`£tTy≥Next
(
si
,&
ñemít
,&
öãÀ
) != -1) {

251 
ñemít
 = 
	`sds‰oml⁄gl⁄g
(
öãÀ
);

252 
	`£rvîAs£π
(
	`di˘Add
(
d
,
ñemít
,
NULL
Ë=
DICT_OK
);

254 
	`£tTy≥Rñó£Iãøt‹
(
si
);

256 
£tobj
->
ícodög
 = 
OBJ_ENCODING_HT
;

257 
	`z‰ì
(
£tobj
->
±r
);

258 
£tobj
->
±r
 = 
d
;

260 
	`£rvîP™ic
("Unsupported set conversion");

262 
	}
}

264 
	$ßddComm™d
(
˛õ¡
 *
c
) {

265 
robj
 *
£t
;

266 
j
, 
added
 = 0;

268 
£t
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

269 i‡(
£t
 =
NULL
) {

270 
£t
 = 
	`£tTy≥Cª©e
(
c
->
¨gv
[2]->
±r
);

271 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],
£t
);

273 i‡(
£t
->
ty≥
 !
OBJ_SET
) {

274 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

279 
j
 = 2; j < 
c
->
¨gc
; j++) {

280 i‡(
	`£tTy≥Add
(
£t
,
c
->
¨gv
[
j
]->
±r
)Ë
added
++;

282 i‡(
added
) {

283 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

284 
	`nŸifyKey•a˚Evít
(
NOTIFY_SET
,"ßdd",
c
->
¨gv
[1],c->
db
->
id
);

286 
£rvî
.
dúty
 +
added
;

287 
	`addRïlyL⁄gL⁄g
(
c
,
added
);

288 
	}
}

290 
	$§emComm™d
(
˛õ¡
 *
c
) {

291 
robj
 *
£t
;

292 
j
, 
dñëed
 = 0, 
keyªmoved
 = 0;

294 i‡((
£t
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

295 
	`checkTy≥
(
c
,
£t
,
OBJ_SET
)) ;

297 
j
 = 2; j < 
c
->
¨gc
; j++) {

298 i‡(
	`£tTy≥Remove
(
£t
,
c
->
¨gv
[
j
]->
±r
)) {

299 
dñëed
++;

300 i‡(
	`£tTy≥Size
(
£t
) == 0) {

301 
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

302 
keyªmoved
 = 1;

307 i‡(
dñëed
) {

308 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

309 
	`nŸifyKey•a˚Evít
(
NOTIFY_SET
,"§em",
c
->
¨gv
[1],c->
db
->
id
);

310 i‡(
keyªmoved
)

311 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
c
->
¨gv
[1],

312 
c
->
db
->
id
);

313 
£rvî
.
dúty
 +
dñëed
;

315 
	`addRïlyL⁄gL⁄g
(
c
,
dñëed
);

316 
	}
}

318 
	$smoveComm™d
(
˛õ¡
 *
c
) {

319 
robj
 *
§c£t
, *
d°£t
, *
ñe
;

320 
§c£t
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

321 
d°£t
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[2]);

322 
ñe
 = 
c
->
¨gv
[3];

325 i‡(
§c£t
 =
NULL
) {

326 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

332 i‡(
	`checkTy≥
(
c
,
§c£t
,
OBJ_SET
) ||

333 (
d°£t
 && 
	`checkTy≥
(
c
,d°£t,
OBJ_SET
))) ;

336 i‡(
§c£t
 =
d°£t
) {

337 
	`addRïly
(
c
,
	`£tTy≥IsMembî
(
§c£t
,
ñe
->
±r
) ?

338 
sh¨ed
.
c⁄e
 : sh¨ed.
czîo
);

343 i‡(!
	`£tTy≥Remove
(
§c£t
,
ñe
->
±r
)) {

344 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

347 
	`nŸifyKey•a˚Evít
(
NOTIFY_SET
,"§em",
c
->
¨gv
[1],c->
db
->
id
);

350 i‡(
	`£tTy≥Size
(
§c£t
) == 0) {

351 
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

352 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
c
->
¨gv
[1],c->
db
->
id
);

356 i‡(!
d°£t
) {

357 
d°£t
 = 
	`£tTy≥Cª©e
(
ñe
->
±r
);

358 
	`dbAdd
(
c
->
db
,c->
¨gv
[2],
d°£t
);

361 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

362 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[2]);

363 
£rvî
.
dúty
++;

366 i‡(
	`£tTy≥Add
(
d°£t
,
ñe
->
±r
)) {

367 
£rvî
.
dúty
++;

368 
	`nŸifyKey•a˚Evít
(
NOTIFY_SET
,"ßdd",
c
->
¨gv
[2],c->
db
->
id
);

370 
	`addRïly
(
c
,
sh¨ed
.
c⁄e
);

371 
	}
}

373 
	$sismembîComm™d
(
˛õ¡
 *
c
) {

374 
robj
 *
£t
;

376 i‡((
£t
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

377 
	`checkTy≥
(
c
,
£t
,
OBJ_SET
)) ;

379 i‡(
	`£tTy≥IsMembî
(
£t
,
c
->
¨gv
[2]->
±r
))

380 
	`addRïly
(
c
,
sh¨ed
.
c⁄e
);

382 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

383 
	}
}

385 
	$sˇrdComm™d
(
˛õ¡
 *
c
) {

386 
robj
 *
o
;

388 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

389 
	`checkTy≥
(
c
,
o
,
OBJ_SET
)) ;

391 
	`addRïlyL⁄gL⁄g
(
c
,
	`£tTy≥Size
(
o
));

392 
	}
}

400 
	#SPOP_MOVE_STRATEGY_MUL
 5

	)

402 
	$•›WôhCou¡Comm™d
(
˛õ¡
 *
c
) {

403 
l
;

404 
cou¡
, 
size
;

405 
robj
 *
£t
;

408 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
l
,
NULL
Ë!
C_OK
) ;

409 i‡(
l
 >= 0) {

410 
cou¡
 = (Ë
l
;

412 
	`addRïly
(
c
,
sh¨ed
.
outo‰™gìº
);

418 i‡((
£t
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
em±y£t
[c->
ª•
]))

419 =
NULL
 || 
	`checkTy≥
(
c
,
£t
,
OBJ_SET
)) ;

423 i‡(
cou¡
 == 0) {

424 
	`addRïly
(
c
,
sh¨ed
.
em±y£t
[c->
ª•
]);

428 
size
 = 
	`£tTy≥Size
(
£t
);

431 
	`nŸifyKey•a˚Evít
(
NOTIFY_SET
,"•›",
c
->
¨gv
[1],c->
db
->
id
);

432 
£rvî
.
dúty
 +
cou¡
;

437 i‡(
cou¡
 >
size
) {

439 
	`suni⁄DiffGíîicComm™d
(
c
,c->
¨gv
+1,1,
NULL
,
SET_OP_UNION
);

442 
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

443 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
c
->
¨gv
[1],c->
db
->
id
);

446 
	`ªwrôeClõ¡Comm™dVe˘‹
(
c
,2,
sh¨ed
.
dñ
,c->
¨gv
[1]);

447 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

448 
£rvî
.
dúty
++;

455 
robj
 *
¥›¨gv
[3];

456 
¥›¨gv
[0] = 
	`¸óãSåögObje˘
("SREM",4);

457 
¥›¨gv
[1] = 
c
->
¨gv
[1];

458 
	`addRïlySëLí
(
c
,
cou¡
);

461 
sds
 
sd£À
;

462 
robj
 *
objñe
;

463 
ícodög
;

464 
öt64_t
 
Œñe
;

465 
ªmaöög
 = 
size
-
cou¡
;

474 i‡(
ªmaöög
*
SPOP_MOVE_STRATEGY_MUL
 > 
cou¡
) {

475 
cou¡
--) {

477 
ícodög
 = 
	`£tTy≥R™domEÀmít
(
£t
,&
sd£À
,&
Œñe
);

478 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

479 
	`addRïlyBulkL⁄gL⁄g
(
c
,
Œñe
);

480 
objñe
 = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
Œñe
);

481 
£t
->
±r
 = 
	`öt£tRemove
(£t->±r,
Œñe
,
NULL
);

483 
	`addRïlyBulkCBuf„r
(
c
,
sd£À
,
	`sd¶í
(sdsele));

484 
objñe
 = 
	`¸óãSåögObje˘
(
sd£À
,
	`sd¶í
(sdsele));

485 
	`£tTy≥Remove
(
£t
,
sd£À
);

489 
¥›¨gv
[2] = 
objñe
;

490 
	`ÆsoPr›ag©e
(
£rvî
.
§emComm™d
,
c
->
db
->
id
,
¥›¨gv
,3,

491 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

492 
	`de¸RefCou¡
(
objñe
);

503 
robj
 *
√w£t
 = 
NULL
;

506 
ªmaöög
--) {

507 
ícodög
 = 
	`£tTy≥R™domEÀmít
(
£t
,&
sd£À
,&
Œñe
);

508 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

509 
sd£À
 = 
	`sds‰oml⁄gl⁄g
(
Œñe
);

511 
sd£À
 = 
	`sdsdup
(sdsele);

513 i‡(!
√w£t
Ë√w£à
	`£tTy≥Cª©e
(
sd£À
);

514 
	`£tTy≥Add
(
√w£t
,
sd£À
);

515 
	`£tTy≥Remove
(
£t
,
sd£À
);

516 
	`sds‰ì
(
sd£À
);

520 
£tTy≥Iãøt‹
 *
si
;

521 
si
 = 
	`£tTy≥InôIãøt‹
(
£t
);

522 (
ícodög
 = 
	`£tTy≥Next
(
si
,&
sd£À
,&
Œñe
)) != -1) {

523 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

524 
	`addRïlyBulkL⁄gL⁄g
(
c
,
Œñe
);

525 
objñe
 = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
Œñe
);

527 
	`addRïlyBulkCBuf„r
(
c
,
sd£À
,
	`sd¶í
(sdsele));

528 
objñe
 = 
	`¸óãSåögObje˘
(
sd£À
,
	`sd¶í
(sdsele));

532 
¥›¨gv
[2] = 
objñe
;

533 
	`ÆsoPr›ag©e
(
£rvî
.
§emComm™d
,
c
->
db
->
id
,
¥›¨gv
,3,

534 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

535 
	`de¸RefCou¡
(
objñe
);

537 
	`£tTy≥Rñó£Iãøt‹
(
si
);

540 
	`dbOvîwrôe
(
c
->
db
,c->
¨gv
[1],
√w£t
);

547 
	`de¸RefCou¡
(
¥›¨gv
[0]);

548 
	`¥evítComm™dPr›ag©i⁄
(
c
);

549 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

550 
£rvî
.
dúty
++;

551 
	}
}

553 
	$•›Comm™d
(
˛õ¡
 *
c
) {

554 
robj
 *
£t
, *
ñe
, *
aux
;

555 
sds
 
sd£À
;

556 
öt64_t
 
Œñe
;

557 
ícodög
;

559 i‡(
c
->
¨gc
 == 3) {

560 
	`•›WôhCou¡Comm™d
(
c
);

562 } i‡(
c
->
¨gc
 > 3) {

563 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

569 i‡((
£t
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nuŒ
[c->
ª•
]))

570 =
NULL
 || 
	`checkTy≥
(
c
,
£t
,
OBJ_SET
)) ;

573 
ícodög
 = 
	`£tTy≥R™domEÀmít
(
£t
,&
sd£À
,&
Œñe
);

576 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

577 
ñe
 = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
Œñe
);

578 
£t
->
±r
 = 
	`öt£tRemove
(£t->±r,
Œñe
,
NULL
);

580 
ñe
 = 
	`¸óãSåögObje˘
(
sd£À
,
	`sd¶í
(sdsele));

581 
	`£tTy≥Remove
(
£t
,
ñe
->
±r
);

584 
	`nŸifyKey•a˚Evít
(
NOTIFY_SET
,"•›",
c
->
¨gv
[1],c->
db
->
id
);

587 
aux
 = 
	`¸óãSåögObje˘
("SREM",4);

588 
	`ªwrôeClõ¡Comm™dVe˘‹
(
c
,3,
aux
,c->
¨gv
[1],
ñe
);

589 
	`de¸RefCou¡
(
aux
);

592 
	`addRïlyBulk
(
c
,
ñe
);

593 
	`de¸RefCou¡
(
ñe
);

596 i‡(
	`£tTy≥Size
(
£t
) == 0) {

597 
	`dbDñëe
(
c
->
db
,c->
¨gv
[1]);

598 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
c
->
¨gv
[1],c->
db
->
id
);

602 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

603 
£rvî
.
dúty
++;

604 
	}
}

612 
	#SRANDMEMBER_SUB_STRATEGY_MUL
 3

	)

614 
	$§™dmembîWôhCou¡Comm™d
(
˛õ¡
 *
c
) {

615 
l
;

616 
cou¡
, 
size
;

617 
uniq
 = 1;

618 
robj
 *
£t
;

619 
sds
 
ñe
;

620 
öt64_t
 
Œñe
;

621 
ícodög
;

623 
di˘
 *
d
;

625 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
l
,
NULL
Ë!
C_OK
) ;

626 i‡(
l
 >= 0) {

627 
cou¡
 = (Ë
l
;

631 
cou¡
 = -
l
;

632 
uniq
 = 0;

635 i‡((
£t
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
em±y£t
[c->
ª•
]))

636 =
NULL
 || 
	`checkTy≥
(
c
,
£t
,
OBJ_SET
)) ;

637 
size
 = 
	`£tTy≥Size
(
£t
);

640 i‡(
cou¡
 == 0) {

641 
	`addRïly
(
c
,
sh¨ed
.
em±y£t
[c->
ª•
]);

649 i‡(!
uniq
) {

650 
	`addRïlySëLí
(
c
,
cou¡
);

651 
cou¡
--) {

652 
ícodög
 = 
	`£tTy≥R™domEÀmít
(
£t
,&
ñe
,&
Œñe
);

653 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

654 
	`addRïlyBulkL⁄gL⁄g
(
c
,
Œñe
);

656 
	`addRïlyBulkCBuf„r
(
c
,
ñe
,
	`sd¶í
(ele));

665 i‡(
cou¡
 >
size
) {

666 
	`suni⁄DiffGíîicComm™d
(
c
,c->
¨gv
+1,1,
NULL
,
SET_OP_UNION
);

671 
d
 = 
	`di˘Cª©e
(&
obje˘KeyPoöãrVÆueDi˘Ty≥
,
NULL
);

682 i‡(
cou¡
*
SRANDMEMBER_SUB_STRATEGY_MUL
 > 
size
) {

683 
£tTy≥Iãøt‹
 *
si
;

686 
si
 = 
	`£tTy≥InôIãøt‹
(
£t
);

687 (
ícodög
 = 
	`£tTy≥Next
(
si
,&
ñe
,&
Œñe
)) != -1) {

688 
ªtvÆ
 = 
DICT_ERR
;

690 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

691 
ªtvÆ
 = 
	`di˘Add
(
d
,
	`¸óãSåögObje˘FromL⁄gL⁄g
(
Œñe
),
NULL
);

693 
ªtvÆ
 = 
	`di˘Add
(
d
,
	`¸óãSåögObje˘
(
ñe
,
	`sd¶í
”À)),
NULL
);

695 
	`£rvîAs£π
(
ªtvÆ
 =
DICT_OK
);

697 
	`£tTy≥Rñó£Iãøt‹
(
si
);

698 
	`£rvîAs£π
(
	`di˘Size
(
d
Ë=
size
);

701 
size
 > 
cou¡
) {

702 
di˘E¡ry
 *
de
;

704 
de
 = 
	`di˘GëR™domKey
(
d
);

705 
	`di˘Dñëe
(
d
,
	`di˘GëKey
(
de
));

706 
size
--;

715 
added
 = 0;

716 
robj
 *
objñe
;

718 
added
 < 
cou¡
) {

719 
ícodög
 = 
	`£tTy≥R™domEÀmít
(
£t
,&
ñe
,&
Œñe
);

720 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

721 
objñe
 = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
Œñe
);

723 
objñe
 = 
	`¸óãSåögObje˘
(
ñe
,
	`sd¶í
(ele));

728 i‡(
	`di˘Add
(
d
,
objñe
,
NULL
Ë=
DICT_OK
)

729 
added
++;

731 
	`de¸RefCou¡
(
objñe
);

737 
di˘Iãøt‹
 *
di
;

738 
di˘E¡ry
 *
de
;

740 
	`addRïlySëLí
(
c
,
cou¡
);

741 
di
 = 
	`di˘GëIãøt‹
(
d
);

742 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
)

743 
	`addRïlyBulk
(
c
,
	`di˘GëKey
(
de
));

744 
	`di˘Rñó£Iãøt‹
(
di
);

745 
	`di˘Rñó£
(
d
);

747 
	}
}

749 
	$§™dmembîComm™d
(
˛õ¡
 *
c
) {

750 
robj
 *
£t
;

751 
sds
 
ñe
;

752 
öt64_t
 
Œñe
;

753 
ícodög
;

755 i‡(
c
->
¨gc
 == 3) {

756 
	`§™dmembîWôhCou¡Comm™d
(
c
);

758 } i‡(
c
->
¨gc
 > 3) {

759 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

763 i‡((
£t
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nuŒ
[c->
ª•
]))

764 =
NULL
 || 
	`checkTy≥
(
c
,
£t
,
OBJ_SET
)) ;

766 
ícodög
 = 
	`£tTy≥R™domEÀmít
(
£t
,&
ñe
,&
Œñe
);

767 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

768 
	`addRïlyBulkL⁄gL⁄g
(
c
,
Œñe
);

770 
	`addRïlyBulkCBuf„r
(
c
,
ñe
,
	`sd¶í
(ele));

772 
	}
}

774 
	$qs‹tCom∑ªSësByC¨döÆôy
(c⁄° *
s1
, c⁄° *
s2
) {

775 i‡(
	`£tTy≥Size
(*(
robj
**)
s1
Ë> sëTy≥Size(*‘obj**)
s2
))  1;

776 i‡(
	`£tTy≥Size
(*(
robj
**)
s1
Ë< sëTy≥Size(*‘obj**)
s2
))  -1;

778 
	}
}

782 
	$qs‹tCom∑ªSësByRevC¨döÆôy
(c⁄° *
s1
, c⁄° *
s2
) {

783 
robj
 *
o1
 = *‘obj**)
s1
, *
o2
 = *‘obj**)
s2
;

784 
fú°
 = 
o1
 ? 
	`£tTy≥Size
(o1) : 0;

785 
£c⁄d
 = 
o2
 ? 
	`£tTy≥Size
(o2) : 0;

787 i‡(
fú°
 < 
£c⁄d
)  1;

788 i‡(
fú°
 > 
£c⁄d
)  -1;

790 
	}
}

792 
	$söãrGíîicComm™d
(
˛õ¡
 *
c
, 
robj
 **
£tkeys
,

793 
£äum
, 
robj
 *
d°key
) {

794 
robj
 **
£ts
 = 
	`zmÆloc
(‘obj*)*
£äum
);

795 
£tTy≥Iãøt‹
 *
si
;

796 
robj
 *
d°£t
 = 
NULL
;

797 
sds
 
ñesds
;

798 
öt64_t
 
ötobj
;

799 *
ª∂yÀn
 = 
NULL
;

800 
j
, 
ˇrdöÆôy
 = 0;

801 
ícodög
;

803 
j
 = 0; j < 
£äum
; j++) {

804 
robj
 *
£tobj
 = 
d°key
 ?

805 
	`lookupKeyWrôe
(
c
->
db
,
£tkeys
[
j
]) :

806 
	`lookupKeyRód
(
c
->
db
,
£tkeys
[
j
]);

807 i‡(!
£tobj
) {

808 
	`z‰ì
(
£ts
);

809 i‡(
d°key
) {

810 i‡(
	`dbDñëe
(
c
->
db
,
d°key
)) {

811 
	`sig«lModifõdKey
(
c
,c->
db
,
d°key
);

812 
£rvî
.
dúty
++;

814 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

816 
	`addRïly
(
c
,
sh¨ed
.
em±y£t
[c->
ª•
]);

820 i‡(
	`checkTy≥
(
c
,
£tobj
,
OBJ_SET
)) {

821 
	`z‰ì
(
£ts
);

824 
£ts
[
j
] = 
£tobj
;

828 
	`qs‹t
(
£ts
,
£äum
,(
robj
*),
qs‹tCom∑ªSësByC¨döÆôy
);

835 i‡(!
d°key
) {

836 
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

840 
d°£t
 = 
	`¸óãI¡£tObje˘
();

846 
si
 = 
	`£tTy≥InôIãøt‹
(
£ts
[0]);

847 (
ícodög
 = 
	`£tTy≥Next
(
si
,&
ñesds
,&
ötobj
)) != -1) {

848 
j
 = 1; j < 
£äum
; j++) {

849 i‡(
£ts
[
j
] == sets[0]) ;

850 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

852 i‡(
£ts
[
j
]->
ícodög
 =
OBJ_ENCODING_INTSET
 &&

853 !
	`öt£tFöd
((
öt£t
*)
£ts
[
j
]->
±r
,
ötobj
))

859 } i‡(
£ts
[
j
]->
ícodög
 =
OBJ_ENCODING_HT
) {

860 
ñesds
 = 
	`sds‰oml⁄gl⁄g
(
ötobj
);

861 i‡(!
	`£tTy≥IsMembî
(
£ts
[
j
],
ñesds
)) {

862 
	`sds‰ì
(
ñesds
);

865 
	`sds‰ì
(
ñesds
);

867 } i‡(
ícodög
 =
OBJ_ENCODING_HT
) {

868 i‡(!
	`£tTy≥IsMembî
(
£ts
[
j
],
ñesds
)) {

875 i‡(
j
 =
£äum
) {

876 i‡(!
d°key
) {

877 i‡(
ícodög
 =
OBJ_ENCODING_HT
)

878 
	`addRïlyBulkCBuf„r
(
c
,
ñesds
,
	`sd¶í
(elesds));

880 
	`addRïlyBulkL⁄gL⁄g
(
c
,
ötobj
);

881 
ˇrdöÆôy
++;

883 i‡(
ícodög
 =
OBJ_ENCODING_INTSET
) {

884 
ñesds
 = 
	`sds‰oml⁄gl⁄g
(
ötobj
);

885 
	`£tTy≥Add
(
d°£t
,
ñesds
);

886 
	`sds‰ì
(
ñesds
);

888 
	`£tTy≥Add
(
d°£t
,
ñesds
);

893 
	`£tTy≥Rñó£Iãøt‹
(
si
);

895 i‡(
d°key
) {

898 
dñëed
 = 
	`dbDñëe
(
c
->
db
,
d°key
);

899 i‡(
	`£tTy≥Size
(
d°£t
) > 0) {

900 
	`dbAdd
(
c
->
db
,
d°key
,
d°£t
);

901 
	`addRïlyL⁄gL⁄g
(
c
,
	`£tTy≥Size
(
d°£t
));

902 
	`nŸifyKey•a˚Evít
(
NOTIFY_SET
,"sinterstore",

903 
d°key
,
c
->
db
->
id
);

905 
	`de¸RefCou¡
(
d°£t
);

906 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

907 i‡(
dñëed
)

908 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"del",

909 
d°key
,
c
->
db
->
id
);

911 
	`sig«lModifõdKey
(
c
,c->
db
,
d°key
);

912 
£rvî
.
dúty
++;

914 
	`£tDe„ºedSëLí
(
c
,
ª∂yÀn
,
ˇrdöÆôy
);

916 
	`z‰ì
(
£ts
);

917 
	}
}

919 
	$söãrComm™d
(
˛õ¡
 *
c
) {

920 
	`söãrGíîicComm™d
(
c
,c->
¨gv
+1,c->
¨gc
-1,
NULL
);

921 
	}
}

923 
	$söãr°‹eComm™d
(
˛õ¡
 *
c
) {

924 
	`söãrGíîicComm™d
(
c
,c->
¨gv
+2,c->
¨gc
-2,c->argv[1]);

925 
	}
}

927 
	#SET_OP_UNION
 0

	)

928 
	#SET_OP_DIFF
 1

	)

929 
	#SET_OP_INTER
 2

	)

931 
	$suni⁄DiffGíîicComm™d
(
˛õ¡
 *
c
, 
robj
 **
£tkeys
, 
£äum
,

932 
robj
 *
d°key
, 
›
) {

933 
robj
 **
£ts
 = 
	`zmÆloc
(‘obj*)*
£äum
);

934 
£tTy≥Iãøt‹
 *
si
;

935 
robj
 *
d°£t
 = 
NULL
;

936 
sds
 
ñe
;

937 
j
, 
ˇrdöÆôy
 = 0;

938 
diff_Ægo
 = 1;

940 
j
 = 0; j < 
£äum
; j++) {

941 
robj
 *
£tobj
 = 
d°key
 ?

942 
	`lookupKeyWrôe
(
c
->
db
,
£tkeys
[
j
]) :

943 
	`lookupKeyRód
(
c
->
db
,
£tkeys
[
j
]);

944 i‡(!
£tobj
) {

945 
£ts
[
j
] = 
NULL
;

948 i‡(
	`checkTy≥
(
c
,
£tobj
,
OBJ_SET
)) {

949 
	`z‰ì
(
£ts
);

952 
£ts
[
j
] = 
£tobj
;

964 i‡(
›
 =
SET_OP_DIFF
 && 
£ts
[0]) {

965 
Ægo_⁄e_w‹k
 = 0, 
Ægo_two_w‹k
 = 0;

967 
j
 = 0; j < 
£äum
; j++) {

968 i‡(
£ts
[
j
] =
NULL
) ;

970 
Ægo_⁄e_w‹k
 +
	`£tTy≥Size
(
£ts
[0]);

971 
Ægo_two_w‹k
 +
	`£tTy≥Size
(
£ts
[
j
]);

976 
Ægo_⁄e_w‹k
 /= 2;

977 
diff_Ægo
 = (
Ægo_⁄e_w‹k
 <
Ægo_two_w‹k
) ? 1 : 2;

979 i‡(
diff_Ægo
 =1 && 
£äum
 > 1) {

983 
	`qs‹t
(
£ts
+1,
£äum
-1,(
robj
*),

984 
qs‹tCom∑ªSësByRevC¨döÆôy
);

991 
d°£t
 = 
	`¸óãI¡£tObje˘
();

993 i‡(
›
 =
SET_OP_UNION
) {

996 
j
 = 0; j < 
£äum
; j++) {

997 i‡(!
£ts
[
j
]) ;

999 
si
 = 
	`£tTy≥InôIãøt‹
(
£ts
[
j
]);

1000 (
ñe
 = 
	`£tTy≥NextObje˘
(
si
)Ë!
NULL
) {

1001 i‡(
	`£tTy≥Add
(
d°£t
,
ñe
)Ë
ˇrdöÆôy
++;

1002 
	`sds‰ì
(
ñe
);

1004 
	`£tTy≥Rñó£Iãøt‹
(
si
);

1006 } i‡(
›
 =
SET_OP_DIFF
 && 
£ts
[0] && 
diff_Ægo
 == 1) {

1015 
si
 = 
	`£tTy≥InôIãøt‹
(
£ts
[0]);

1016 (
ñe
 = 
	`£tTy≥NextObje˘
(
si
)Ë!
NULL
) {

1017 
j
 = 1; j < 
£äum
; j++) {

1018 i‡(!
£ts
[
j
]) ;

1019 i‡(
£ts
[
j
] == sets[0]) ;

1020 i‡(
	`£tTy≥IsMembî
(
£ts
[
j
],
ñe
)) ;

1022 i‡(
j
 =
£äum
) {

1024 
	`£tTy≥Add
(
d°£t
,
ñe
);

1025 
ˇrdöÆôy
++;

1027 
	`sds‰ì
(
ñe
);

1029 
	`£tTy≥Rñó£Iãøt‹
(
si
);

1030 } i‡(
›
 =
SET_OP_DIFF
 && 
£ts
[0] && 
diff_Ægo
 == 2) {

1038 
j
 = 0; j < 
£äum
; j++) {

1039 i‡(!
£ts
[
j
]) ;

1041 
si
 = 
	`£tTy≥InôIãøt‹
(
£ts
[
j
]);

1042 (
ñe
 = 
	`£tTy≥NextObje˘
(
si
)Ë!
NULL
) {

1043 i‡(
j
 == 0) {

1044 i‡(
	`£tTy≥Add
(
d°£t
,
ñe
)Ë
ˇrdöÆôy
++;

1046 i‡(
	`£tTy≥Remove
(
d°£t
,
ñe
)Ë
ˇrdöÆôy
--;

1048 
	`sds‰ì
(
ñe
);

1050 
	`£tTy≥Rñó£Iãøt‹
(
si
);

1054 i‡(
ˇrdöÆôy
 == 0) ;

1059 i‡(!
d°key
) {

1060 
	`addRïlySëLí
(
c
,
ˇrdöÆôy
);

1061 
si
 = 
	`£tTy≥InôIãøt‹
(
d°£t
);

1062 (
ñe
 = 
	`£tTy≥NextObje˘
(
si
)Ë!
NULL
) {

1063 
	`addRïlyBulkCBuf„r
(
c
,
ñe
,
	`sd¶í
(ele));

1064 
	`sds‰ì
(
ñe
);

1066 
	`£tTy≥Rñó£Iãøt‹
(
si
);

1067 
£rvî
.
œzy‰ì_œzy_£rvî_dñ
 ? 
	`‰ìObjAsync
(
d°£t
) :

1068 
	`de¸RefCou¡
(
d°£t
);

1072 
dñëed
 = 
	`dbDñëe
(
c
->
db
,
d°key
);

1073 i‡(
	`£tTy≥Size
(
d°£t
) > 0) {

1074 
	`dbAdd
(
c
->
db
,
d°key
,
d°£t
);

1075 
	`addRïlyL⁄gL⁄g
(
c
,
	`£tTy≥Size
(
d°£t
));

1076 
	`nŸifyKey•a˚Evít
(
NOTIFY_SET
,

1077 
›
 =
SET_OP_UNION
 ? "sunionstore" : "sdiffstore",

1078 
d°key
,
c
->
db
->
id
);

1080 
	`de¸RefCou¡
(
d°£t
);

1081 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

1082 i‡(
dñëed
)

1083 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"del",

1084 
d°key
,
c
->
db
->
id
);

1086 
	`sig«lModifõdKey
(
c
,c->
db
,
d°key
);

1087 
£rvî
.
dúty
++;

1089 
	`z‰ì
(
£ts
);

1090 
	}
}

1092 
	$suni⁄Comm™d
(
˛õ¡
 *
c
) {

1093 
	`suni⁄DiffGíîicComm™d
(
c
,c->
¨gv
+1,c->
¨gc
-1,
NULL
,
SET_OP_UNION
);

1094 
	}
}

1096 
	$suni⁄°‹eComm™d
(
˛õ¡
 *
c
) {

1097 
	`suni⁄DiffGíîicComm™d
(
c
,c->
¨gv
+2,c->
¨gc
-2,c->¨gv[1],
SET_OP_UNION
);

1098 
	}
}

1100 
	$sdiffComm™d
(
˛õ¡
 *
c
) {

1101 
	`suni⁄DiffGíîicComm™d
(
c
,c->
¨gv
+1,c->
¨gc
-1,
NULL
,
SET_OP_DIFF
);

1102 
	}
}

1104 
	$sdiff°‹eComm™d
(
˛õ¡
 *
c
) {

1105 
	`suni⁄DiffGíîicComm™d
(
c
,c->
¨gv
+2,c->
¨gc
-2,c->¨gv[1],
SET_OP_DIFF
);

1106 
	}
}

1108 
	$ssˇnComm™d
(
˛õ¡
 *
c
) {

1109 
robj
 *
£t
;

1110 
curs‹
;

1112 i‡(
	`∑r£SˇnCurs‹OrRïly
(
c
,c->
¨gv
[2],&
curs‹
Ë=
C_ERR
) ;

1113 i‡((
£t
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
em±ysˇn
)Ë=
NULL
 ||

1114 
	`checkTy≥
(
c
,
£t
,
OBJ_SET
)) ;

1115 
	`sˇnGíîicComm™d
(
c
,
£t
,
curs‹
);

1116 
	}
}

	@t_stream.c

30 
	~"£rvî.h
"

31 
	~"ídünc⁄v.h
"

32 
	~"°ªam.h
"

34 
	#STREAM_BYTES_PER_LISTPACK
 2048

	)

39 
	#STREAM_ITEM_FLAG_NONE
 0

	)

40 
	#STREAM_ITEM_FLAG_DELETED
 (1<<0Ë

	)

41 
	#STREAM_ITEM_FLAG_SAMEFIELDS
 (1<<1Ë

	)

43 
°ªamFªeCG
(
°ªamCG
 *
cg
);

44 
°ªamFªeNACK
(
°ªamNACK
 *
«
);

45 
size_t
 
°ªamRïlyWôhR™geFromC⁄sumîPEL
(
˛õ¡
 *
c
, 
°ªam
 *
s
, 
°ªamID
 *
°¨t
, såómID *
íd
, size_à
cou¡
, 
°ªamC⁄sumî
 *
c⁄sumî
);

52 
°ªam
 *
	$°ªamNew
() {

53 
°ªam
 *
s
 = 
	`zmÆloc
((*s));

54 
s
->
øx
 = 
	`øxNew
();

55 
s
->
Àngth
 = 0;

56 
s
->
œ°_id
.
ms
 = 0;

57 
s
->
œ°_id
.
£q
 = 0;

58 
s
->
cgroups
 = 
NULL
;

59  
s
;

60 
	}
}

63 
	$‰ìSåóm
(
°ªam
 *
s
) {

64 
	`øxFªeWôhCÆlback
(
s
->
øx
,((*)(*))
ÕFªe
);

65 i‡(
s
->
cgroups
)

66 
	`øxFªeWôhCÆlback
(
s
->
cgroups
,((*)(*))
°ªamFªeCG
);

67 
	`z‰ì
(
s
);

68 
	}
}

71 
	$°ªamLígth
(c⁄° 
robj
 *
subje˘
) {

72 
°ªam
 *
s
 = 
subje˘
->
±r
;

73  
s
->
Àngth
;

74 
	}
}

77 
	$°ªamIn¸ID
(
°ªamID
 *
id
) {

78 i‡(
id
->
£q
 =
UINT64_MAX
) {

79 i‡(
id
->
ms
 =
UINT64_MAX
) {

81 
id
->
ms
 = id->
£q
 = 0;

83 
id
->
ms
++;

84 
id
->
£q
 = 0;

87 
id
->
£q
++;

89 
	}
}

95 
	$°ªamNextID
(
°ªamID
 *
œ°_id
, såómID *
√w_id
) {

96 
uöt64_t
 
ms
 = 
	`m°ime
();

97 i‡(
ms
 > 
œ°_id
->ms) {

98 
√w_id
->
ms
 = ms;

99 
√w_id
->
£q
 = 0;

101 *
√w_id
 = *
œ°_id
;

102 
	`°ªamIn¸ID
(
√w_id
);

104 
	}
}

108 *
	$ÕAµídI¡egî
(*
Õ
, 
öt64_t
 
vÆue
) {

109 
buf
[
LONG_STR_SIZE
];

110 
¶í
 = 
	`Œ2°rög
(
buf
,(buf),
vÆue
);

111  
	`ÕAµíd
(
Õ
,(*)
buf
,
¶í
);

112 
	}
}

118 *
	$ÕRïœ˚I¡egî
(*
Õ
, **
pos
, 
öt64_t
 
vÆue
) {

119 
buf
[
LONG_STR_SIZE
];

120 
¶í
 = 
	`Œ2°rög
(
buf
,(buf),
vÆue
);

121  
	`ÕIn£π
(
Õ
, (*)
buf
, 
¶í
, *
pos
, 
LP_REPLACE
,Öos);

122 
	}
}

127 
öt64_t
 
	$ÕGëI¡egî
(*
ñe
) {

128 
öt64_t
 
v
;

129 *
e
 = 
	`ÕGë
(
ñe
,&
v
,
NULL
);

130 i‡(
e
 =
NULL
Ë 
v
;

134 
Œ
;

135 
ªtvÆ
 = 
	`°rög2Œ
((*)
e
,
v
,&
Œ
);

136 
	`£rvîAs£π
(
ªtvÆ
 != 0);

137 
v
 = 
Œ
;

138  
v
;

139 
	}
}

143 
	$°ªamLogLi°∑ckC⁄ã¡
(*
Õ
) {

144 *
p
 = 
	`ÕFú°
(
Õ
);

145 
p
) {

146 
buf
[
LP_INTBUF_SIZE
];

147 
öt64_t
 
v
;

148 *
ñe
 = 
	`ÕGë
(
p
,&
v
,
buf
);

149 
	`£rvîLog
(
LL_WARNING
,"- [%d] '%.*s'", ()
v
, ()v, 
ñe
);

150 
p
 = 
	`ÕNext
(
Õ
,p);

152 
	}
}

156 
	$°ªamEncodeID
(*
buf
, 
°ªamID
 *
id
) {

157 
uöt64_t
 
e
[2];

158 
e
[0] = 
	`ht⁄u64
(
id
->
ms
);

159 
e
[1] = 
	`ht⁄u64
(
id
->
£q
);

160 
	`mem˝y
(
buf
,
e
,(e));

161 
	}
}

166 
	$°ªamDecodeID
(*
buf
, 
°ªamID
 *
id
) {

167 
uöt64_t
 
e
[2];

168 
	`mem˝y
(
e
,
buf
,(e));

169 
id
->
ms
 = 
	`¡ohu64
(
e
[0]);

170 
id
->
£q
 = 
	`¡ohu64
(
e
[1]);

171 
	}
}

174 
	$°ªamCom∑ªID
(
°ªamID
 *
a
, såómID *
b
) {

175 i‡(
a
->
ms
 > 
b
->ms)  1;

176 i‡(
a
->
ms
 < 
b
->ms)  -1;

178 i‡(
a
->
£q
 > 
b
->seq)  1;

179 i‡(
a
->
£q
 < 
b
->seq)  -1;

182 
	}
}

196 
	$°ªamAµídIãm
(
°ªam
 *
s
, 
robj
 **
¨gv
, 
öt64_t
 
numfõlds
, 
°ªamID
 *
added_id
, såómID *
u£_id
) {

199 
°ªamID
 
id
;

200 i‡(
u£_id
)

201 
id
 = *
u£_id
;

203 
	`°ªamNextID
(&
s
->
œ°_id
,&
id
);

209 i‡(
	`°ªamCom∑ªID
(&
id
,&
s
->
œ°_id
Ë<0Ë 
C_ERR
;

212 
øxIãøt‹
 
ri
;

213 
	`øxSèπ
(&
ri
,
s
->
øx
);

214 
	`øxSìk
(&
ri
,"$",
NULL
,0);

216 
size_t
 
Õ_byãs
 = 0;

217 *
Õ
 = 
NULL
;

220 i‡(
	`øxNext
(&
ri
)) {

221 
Õ
 = 
ri
.
d©a
;

222 
Õ_byãs
 = 
	`ÕByãs
(
Õ
);

224 
	`øxSt›
(&
ri
);

229 
uöt64_t
 
øx_key
[2];

230 
°ªamID
 
ma°î_id
;

267 i‡(
Õ
 !
NULL
) {

268 i‡(
£rvî
.
°ªam_node_max_byãs
 &&

269 
Õ_byãs
 >
£rvî
.
°ªam_node_max_byãs
)

271 
Õ
 = 
NULL
;

272 } i‡(
£rvî
.
°ªam_node_max_íåõs
) {

273 
öt64_t
 
cou¡
 = 
	`ÕGëI¡egî
(
	`ÕFú°
(
Õ
));

274 i‡(
cou¡
 >
£rvî
.
°ªam_node_max_íåõs
Ë
Õ
 = 
NULL
;

278 
Êags
 = 
STREAM_ITEM_FLAG_NONE
;

279 i‡(
Õ
 =
NULL
 || 
Õ_byãs
 >
£rvî
.
°ªam_node_max_byãs
) {

280 
ma°î_id
 = 
id
;

281 
	`°ªamEncodeID
(
øx_key
,&
id
);

283 
Õ
 = 
	`ÕNew
();

284 
Õ
 = 
	`ÕAµídI¡egî
(lp,1);

285 
Õ
 = 
	`ÕAµídI¡egî
(lp,0);

286 
Õ
 = 
	`ÕAµídI¡egî
÷p,
numfõlds
);

287 
öt64_t
 
i
 = 0; i < 
numfõlds
; i++) {

288 
sds
 
fõld
 = 
¨gv
[
i
*2]->
±r
;

289 
Õ
 = 
	`ÕAµíd
÷p,(*)
fõld
,
	`sd¶í
(field));

291 
Õ
 = 
	`ÕAµídI¡egî
(lp,0);

292 
	`øxIn£π
(
s
->
øx
,(*)&
øx_key
,‘ax_key),
Õ
,
NULL
);

295 
Êags
 |
STREAM_ITEM_FLAG_SAMEFIELDS
;

297 
	`£rvîAs£π
(
ri
.
key_Àn
 =(
øx_key
));

298 
	`mem˝y
(
øx_key
,
ri
.
key
,(rax_key));

301 
	`°ªamDecodeID
(
øx_key
,&
ma°î_id
);

302 *
Õ_ñe
 = 
	`ÕFú°
(
Õ
);

305 
öt64_t
 
cou¡
 = 
	`ÕGëI¡egî
(
Õ_ñe
);

306 
Õ
 = 
	`ÕRïœ˚I¡egî
÷p,&
Õ_ñe
,
cou¡
+1);

307 
Õ_ñe
 = 
	`ÕNext
(
Õ
,lp_ele);

308 
Õ_ñe
 = 
	`ÕNext
(
Õ
,lp_ele);

312 
öt64_t
 
ma°î_fõlds_cou¡
 = 
	`ÕGëI¡egî
(
Õ_ñe
);

313 
Õ_ñe
 = 
	`ÕNext
(
Õ
,lp_ele);

314 i‡(
numfõlds
 =
ma°î_fõlds_cou¡
) {

315 
öt64_t
 
i
;

316 
i
 = 0; i < 
ma°î_fõlds_cou¡
; i++) {

317 
sds
 
fõld
 = 
¨gv
[
i
*2]->
±r
;

318 
öt64_t
 
e_Àn
;

319 
buf
[
LP_INTBUF_SIZE
];

320 *
e
 = 
	`ÕGë
(
Õ_ñe
,&
e_Àn
,
buf
);

322 i‡(
	`sd¶í
(
fõld
Ë!(
size_t
)
e_Àn
 ||

323 
	`memcmp
(
e
,
fõld
,
e_Àn
) != 0) ;

324 
Õ_ñe
 = 
	`ÕNext
(
Õ
,lp_ele);

328 i‡(
i
 =
ma°î_fõlds_cou¡
Ë
Êags
 |
STREAM_ITEM_FLAG_SAMEFIELDS
;

354 
Õ
 = 
	`ÕAµídI¡egî
÷p,
Êags
);

355 
Õ
 = 
	`ÕAµídI¡egî
÷p,
id
.
ms
 - 
ma°î_id
.ms);

356 
Õ
 = 
	`ÕAµídI¡egî
÷p,
id
.
£q
 - 
ma°î_id
.seq);

357 i‡(!(
Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
))

358 
Õ
 = 
	`ÕAµídI¡egî
÷p,
numfõlds
);

359 
öt64_t
 
i
 = 0; i < 
numfõlds
; i++) {

360 
sds
 
fõld
 = 
¨gv
[
i
*2]->
±r
, 
vÆue
 =árgv[i*2+1]->ptr;

361 i‡(!(
Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
))

362 
Õ
 = 
	`ÕAµíd
÷p,(*)
fõld
,
	`sd¶í
(field));

363 
Õ
 = 
	`ÕAµíd
÷p,(*)
vÆue
,
	`sd¶í
(value));

366 
öt64_t
 
Õ_cou¡
 = 
numfõlds
;

367 
Õ_cou¡
 += 3;

368 i‡(!(
Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
)) {

371 
Õ_cou¡
 +
numfõlds
+1;

373 
Õ
 = 
	`ÕAµídI¡egî
÷p,
Õ_cou¡
);

376 i‡(
ri
.
d©a
 !
Õ
)

377 
	`øxIn£π
(
s
->
øx
,(*)&
øx_key
,‘ax_key),
Õ
,
NULL
);

378 
s
->
Àngth
++;

379 
s
->
œ°_id
 = 
id
;

380 i‡(
added_id
Ë*added_id = 
id
;

381  
C_OK
;

382 
	}
}

398 
öt64_t
 
	$°ªamTrimByLígth
(
°ªam
 *
s
, 
size_t
 
maxÀn
, 
≠¥ox
) {

399 i‡(
s
->
Àngth
 <
maxÀn
)  0;

401 
øxIãøt‹
 
ri
;

402 
	`øxSèπ
(&
ri
,
s
->
øx
);

403 
	`øxSìk
(&
ri
,"^",
NULL
,0);

405 
öt64_t
 
dñëed
 = 0;

406 
s
->
Àngth
 > 
maxÀn
 && 
	`øxNext
(&
ri
)) {

407 *
Õ
 = 
ri
.
d©a
, *
p
 = 
	`ÕFú°
(lp);

408 
öt64_t
 
íåõs
 = 
	`ÕGëI¡egî
(
p
);

412 i‡(
s
->
Àngth
 - 
íåõs
 >
maxÀn
) {

413 
	`ÕFªe
(
Õ
);

414 
	`øxRemove
(
s
->
øx
,
ri
.
key
,ri.
key_Àn
,
NULL
);

415 
	`øxSìk
(&
ri
,">=",ri.
key
,ri.
key_Àn
);

416 
s
->
Àngth
 -
íåõs
;

417 
dñëed
 +
íåõs
;

423 i‡(
≠¥ox
) ;

427 
öt64_t
 
to_dñëe
 = 
s
->
Àngth
 - 
maxÀn
;

428 
	`£rvîAs£π
(
to_dñëe
 < 
íåõs
);

429 
Õ
 = 
	`ÕRïœ˚I¡egî
÷p,&
p
,
íåõs
-
to_dñëe
);

430 
p
 = 
	`ÕNext
(
Õ
,p);

431 
öt64_t
 
m¨ked_dñëed
 = 
	`ÕGëI¡egî
(
p
);

432 
Õ
 = 
	`ÕRïœ˚I¡egî
÷p,&
p
,
m¨ked_dñëed
+
to_dñëe
);

433 
p
 = 
	`ÕNext
(
Õ
,p);

436 
öt64_t
 
ma°î_fõlds_cou¡
 = 
	`ÕGëI¡egî
(
p
);

437 
p
 = 
	`ÕNext
(
Õ
,p);

438 
öt64_t
 
j
 = 0; j < 
ma°î_fõlds_cou¡
; j++)

439 
p
 = 
	`ÕNext
(
Õ
,p);

440 
p
 = 
	`ÕNext
(
Õ
,p);

445 
p
) {

446 
Êags
 = 
	`ÕGëI¡egî
(
p
);

447 
to_skù
;

450 i‡(!(
Êags
 & 
STREAM_ITEM_FLAG_DELETED
)) {

451 
Êags
 |
STREAM_ITEM_FLAG_DELETED
;

452 
Õ
 = 
	`ÕRïœ˚I¡egî
÷p,&
p
,
Êags
);

453 
dñëed
++;

454 
s
->
Àngth
--;

455 i‡(
s
->
Àngth
 <
maxÀn
) ;

458 
p
 = 
	`ÕNext
(
Õ
,p);

459 
p
 = 
	`ÕNext
(
Õ
,p);

460 
p
 = 
	`ÕNext
(
Õ
,p);

461 i‡(
Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
) {

462 
to_skù
 = 
ma°î_fõlds_cou¡
;

464 
to_skù
 = 
	`ÕGëI¡egî
(
p
);

465 
to_skù
 = 1+(to_skip*2);

468 
to_skù
--Ë
p
 = 
	`ÕNext
(
Õ
,p);

469 
p
 = 
	`ÕNext
(
Õ
,p);

474 
íåõs
 -
to_dñëe
;

475 
m¨ked_dñëed
 +
to_dñëe
;

476 i‡(
íåõs
 + 
m¨ked_dñëed
 > 10 && marked_deleted >Éntries/2) {

481 
	`øxIn£π
(
s
->
øx
,
ri
.
key
,ri.
key_Àn
,
Õ
,
NULL
);

487 
	`øxSt›
(&
ri
);

488  
dñëed
;

489 
	}
}

512 
	$°ªamIãøt‹Sèπ
(
°ªamIãøt‹
 *
si
, 
°ªam
 *
s
, 
°ªamID
 *
°¨t
, såómID *
íd
, 
ªv
) {

515 i‡(
°¨t
) {

516 
	`°ªamEncodeID
(
si
->
°¨t_key
,
°¨t
);

518 
si
->
°¨t_key
[0] = 0;

519 
si
->
°¨t_key
[1] = 0;

522 i‡(
íd
) {

523 
	`°ªamEncodeID
(
si
->
íd_key
,
íd
);

525 
si
->
íd_key
[0] = 
UINT64_MAX
;

526 
si
->
íd_key
[1] = 
UINT64_MAX
;

530 
	`øxSèπ
(&
si
->
ri
,
s
->
øx
);

531 i‡(!
ªv
) {

532 i‡(
°¨t
 && (°¨t->
ms
 || sèπ->
£q
)) {

533 
	`øxSìk
(&
si
->
ri
,"<=",(*)si->
°¨t_key
,

534 (
si
->
°¨t_key
));

535 i‡(
	`øxEOF
(&
si
->
ri
)Ë
	`øxSìk
(&si->ri,"^",
NULL
,0);

537 
	`øxSìk
(&
si
->
ri
,"^",
NULL
,0);

540 i‡(
íd
 && (íd->
ms
 ||Énd->
£q
)) {

541 
	`øxSìk
(&
si
->
ri
,"<=",(*)si->
íd_key
,

542 (
si
->
íd_key
));

543 i‡(
	`øxEOF
(&
si
->
ri
)Ë
	`øxSìk
(&si->ri,"$",
NULL
,0);

545 
	`øxSìk
(&
si
->
ri
,"$",
NULL
,0);

548 
si
->
°ªam
 = 
s
;

549 
si
->
Õ
 = 
NULL
;

550 
si
->
Õ_ñe
 = 
NULL
;

551 
si
->
ªv
 =Ñev;

552 
	}
}

557 
	$°ªamIãøt‹GëID
(
°ªamIãøt‹
 *
si
, 
°ªamID
 *
id
, 
öt64_t
 *
numfõlds
) {

562 i‡(
si
->
Õ
 =
NULL
 || si->
Õ_ñe
 == NULL) {

563 i‡(!
si
->
ªv
 && !
	`øxNext
(&si->
ri
))  0;

564 i‡(
si
->
ªv
 && !
	`øxPªv
(&si->
ri
))  0;

565 
	`£rvîAs£π
(
si
->
ri
.
key_Àn
 =(
°ªamID
));

567 
	`°ªamDecodeID
(
si
->
ri
.
key
,&si->
ma°î_id
);

569 
si
->
Õ
 = si->
ri
.
d©a
;

570 
si
->
Õ_ñe
 = 
	`ÕFú°
(si->
Õ
);

571 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

572 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

573 
si
->
ma°î_fõlds_cou¡
 = 
	`ÕGëI¡egî
(si->
Õ_ñe
);

574 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

575 
si
->
ma°î_fõlds_°¨t
 = si->
Õ_ñe
;

579 i‡(!
si
->
ªv
) {

582 
uöt64_t
 
i
 = 0; i < 
si
->
ma°î_fõlds_cou¡
; i++)

583 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

588 
si
->
Õ_ñe
 = 
	`ÕLa°
(si->
Õ
);

590 } i‡(
si
->
ªv
) {

595 
Õ_cou¡
 = 
	`ÕGëI¡egî
(
si
->
Õ_ñe
);

596 
Õ_cou¡
--Ë
si
->
Õ_ñe
 = 
	`ÕPªv
(si->
Õ
,si->lp_ele);

598 
si
->
Õ_ñe
 = 
	`ÕPªv
(si->
Õ
,si->lp_ele);

604 i‡(!
si
->
ªv
) {

608 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

609 i‡(
si
->
Õ_ñe
 =
NULL
) ;

614 
öt64_t
 
Õ_cou¡
 = 
	`ÕGëI¡egî
(
si
->
Õ_ñe
);

615 i‡(
Õ_cou¡
 == 0) {

616 
si
->
Õ
 = 
NULL
;

617 
si
->
Õ_ñe
 = 
NULL
;

620 
Õ_cou¡
--Ë
si
->
Õ_ñe
 = 
	`ÕPªv
(si->
Õ
,si->lp_ele);

624 
si
->
Õ_Êags
 = si->
Õ_ñe
;

625 
Êags
 = 
	`ÕGëI¡egî
(
si
->
Õ_ñe
);

626 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

630 *
id
 = 
si
->
ma°î_id
;

631 
id
->
ms
 +
	`ÕGëI¡egî
(
si
->
Õ_ñe
);

632 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

633 
id
->
£q
 +
	`ÕGëI¡egî
(
si
->
Õ_ñe
);

634 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

635 
buf
[(
°ªamID
)];

636 
	`°ªamEncodeID
(
buf
,
id
);

640 i‡(
Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
) {

641 *
numfõlds
 = 
si
->
ma°î_fõlds_cou¡
;

643 *
numfõlds
 = 
	`ÕGëI¡egî
(
si
->
Õ_ñe
);

644 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

649 i‡(!
si
->
ªv
) {

650 i‡(
	`memcmp
(
buf
,
si
->
°¨t_key
,(
°ªamID
)) >= 0 &&

651 !(
Êags
 & 
STREAM_ITEM_FLAG_DELETED
))

653 i‡(
	`memcmp
(
buf
,
si
->
íd_key
,(
°ªamID
)) > 0)

655 
si
->
íåy_Êags
 = 
Êags
;

656 i‡(
Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
)

657 
si
->
ma°î_fõlds_±r
 = si->
ma°î_fõlds_°¨t
;

661 i‡(
	`memcmp
(
buf
,
si
->
íd_key
,(
°ªamID
)) <= 0 &&

662 !(
Êags
 & 
STREAM_ITEM_FLAG_DELETED
))

664 i‡(
	`memcmp
(
buf
,
si
->
°¨t_key
,(
°ªamID
)) < 0)

666 
si
->
íåy_Êags
 = 
Êags
;

667 i‡(
Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
)

668 
si
->
ma°î_fõlds_±r
 = si->
ma°î_fõlds_°¨t
;

676 i‡(!
si
->
ªv
) {

677 
öt64_t
 
to_disˇrd
 = (
Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
) ?

678 *
numfõlds
 : *numfields*2;

679 
öt64_t
 
i
 = 0; i < 
to_disˇrd
; i++)

680 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

682 
öt64_t
 
¥ev_times
 = 4;

687 i‡(!(
Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
)Ë
¥ev_times
++;

688 
¥ev_times
--Ë
si
->
Õ_ñe
 = 
	`ÕPªv
(si->
Õ
,si->lp_ele);

694 
	}
}

702 
	$°ªamIãøt‹GëFõld
(
°ªamIãøt‹
 *
si
, **
fõld±r
, **
vÆuïå
, 
öt64_t
 *
fõldÀn
, i¡64_à*
vÆuñí
) {

703 i‡(
si
->
íåy_Êags
 & 
STREAM_ITEM_FLAG_SAMEFIELDS
) {

704 *
fõld±r
 = 
	`ÕGë
(
si
->
ma°î_fõlds_±r
,
fõldÀn
,si->
fõld_buf
);

705 
si
->
ma°î_fõlds_±r
 = 
	`ÕNext
(si->
Õ
,si->master_fields_ptr);

707 *
fõld±r
 = 
	`ÕGë
(
si
->
Õ_ñe
,
fõldÀn
,si->
fõld_buf
);

708 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

710 *
vÆuïå
 = 
	`ÕGë
(
si
->
Õ_ñe
,
vÆuñí
,si->
vÆue_buf
);

711 
si
->
Õ_ñe
 = 
	`ÕNext
(si->
Õ
,si->lp_ele);

712 
	}
}

724 
	$°ªamIãøt‹RemoveE¡ry
(
°ªamIãøt‹
 *
si
, 
°ªamID
 *
cuºít
) {

725 *
Õ
 = 
si
->lp;

726 
öt64_t
 
aux
;

733 
Êags
 = 
	`ÕGëI¡egî
(
si
->
Õ_Êags
);

734 
Êags
 |
STREAM_ITEM_FLAG_DELETED
;

735 
Õ
 = 
	`ÕRïœ˚I¡egî
÷p,&
si
->
Õ_Êags
,
Êags
);

738 *
p
 = 
	`ÕFú°
(
Õ
);

739 
aux
 = 
	`ÕGëI¡egî
(
p
);

741 i‡(
aux
 == 1) {

744 
	`ÕFªe
(
Õ
);

745 
	`øxRemove
(
si
->
°ªam
->
øx
,si->
ri
.
key
,si->ri.
key_Àn
,
NULL
);

748 
Õ
 = 
	`ÕRïœ˚I¡egî
÷p,&
p
,
aux
-1);

749 
p
 = 
	`ÕNext
(
Õ
,p);

750 
aux
 = 
	`ÕGëI¡egî
(
p
);

751 
Õ
 = 
	`ÕRïœ˚I¡egî
÷p,&
p
,
aux
+1);

754 i‡(
si
->
Õ
 !=Üp)

755 
	`øxIn£π
(
si
->
°ªam
->
øx
,si->
ri
.
key
,si->ri.
key_Àn
,
Õ
,
NULL
);

759 
si
->
°ªam
->
Àngth
--;

762 
°ªamID
 
°¨t
, 
íd
;

763 i‡(
si
->
ªv
) {

764 
	`°ªamDecodeID
(
si
->
°¨t_key
,&
°¨t
);

765 
íd
 = *
cuºít
;

767 
°¨t
 = *
cuºít
;

768 
	`°ªamDecodeID
(
si
->
íd_key
,&
íd
);

770 
	`°ªamIãøt‹St›
(
si
);

771 
	`°ªamIãøt‹Sèπ
(
si
,si->
°ªam
,&
°¨t
,&
íd
,si->
ªv
);

775 
	}
}

780 
	$°ªamIãøt‹St›
(
°ªamIãøt‹
 *
si
) {

781 
	`øxSt›
(&
si
->
ri
);

782 
	}
}

786 
	$°ªamDñëeIãm
(
°ªam
 *
s
, 
°ªamID
 *
id
) {

787 
dñëed
 = 0;

788 
°ªamIãøt‹
 
si
;

789 
	`°ªamIãøt‹Sèπ
(&
si
,
s
,
id
,id,0);

790 
°ªamID
 
myid
;

791 
öt64_t
 
numfõlds
;

792 i‡(
	`°ªamIãøt‹GëID
(&
si
,&
myid
,&
numfõlds
)) {

793 
	`°ªamIãøt‹RemoveE¡ry
(&
si
,&
myid
);

794 
dñëed
 = 1;

796 
	`°ªamIãøt‹St›
(&
si
);

797  
dñëed
;

798 
	}
}

801 
	$°ªamLa°VÆidID
(
°ªam
 *
s
, 
°ªamID
 *
maxid
)

803 
°ªamIãøt‹
 
si
;

804 
	`°ªamIãøt‹Sèπ
(&
si
,
s
,
NULL
,NULL,1);

805 
öt64_t
 
numfõlds
;

806 
	`°ªamIãøt‹GëID
(&
si
,
maxid
,&
numfõlds
);

807 
	`°ªamIãøt‹St›
(&
si
);

808 
	}
}

813 
	$addRïlySåómID
(
˛õ¡
 *
c
, 
°ªamID
 *
id
) {

814 
sds
 
ª∂yid
 = 
	`sdsˇtfmt
(
	`sd£m±y
(),"%U-%U",
id
->
ms
,id->
£q
);

815 
	`addRïlyBulkSds
(
c
,
ª∂yid
);

816 
	}
}

820 
robj
 *
	$¸óãObje˘FromSåómID
(
°ªamID
 *
id
) {

821  
	`¸óãObje˘
(
OBJ_STRING
, 
	`sdsˇtfmt
(
	`sd£m±y
(),"%U-%U",

822 
id
->
ms
,id->
£q
));

823 
	}
}

828 
	$°ªamPr›ag©eXCLAIM
(
˛õ¡
 *
c
, 
robj
 *
key
, 
°ªamCG
 *
group
,Ñobj *
grou≤ame
,Ñobj *
id
, 
°ªamNACK
 *
«ck
) {

836 
robj
 *
¨gv
[14];

837 
¨gv
[0] = 
	`¸óãSåögObje˘
("XCLAIM",6);

838 
¨gv
[1] = 
key
;

839 
¨gv
[2] = 
grou≤ame
;

840 
¨gv
[3] = 
	`¸óãSåögObje˘
(
«ck
->
c⁄sumî
->
«me
,
	`sd¶í
(nack->consumer->name));

841 
¨gv
[4] = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(0);

842 
¨gv
[5] = 
id
;

843 
¨gv
[6] = 
	`¸óãSåögObje˘
("TIME",4);

844 
¨gv
[7] = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
«ck
->
dñivîy_time
);

845 
¨gv
[8] = 
	`¸óãSåögObje˘
("RETRYCOUNT",10);

846 
¨gv
[9] = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
«ck
->
dñivîy_cou¡
);

847 
¨gv
[10] = 
	`¸óãSåögObje˘
("FORCE",5);

848 
¨gv
[11] = 
	`¸óãSåögObje˘
("JUSTID",6);

849 
¨gv
[12] = 
	`¸óãSåögObje˘
("LASTID",6);

850 
¨gv
[13] = 
	`¸óãObje˘FromSåómID
(&
group
->
œ°_id
);

856 
	`¥›ag©e
(
£rvî
.
x˛aimComm™d
,
c
->
db
->
id
,
¨gv
,14,
PROPAGATE_AOF
|
PROPAGATE_REPL
);

857 
	`de¸RefCou¡
(
¨gv
[0]);

858 
	`de¸RefCou¡
(
¨gv
[3]);

859 
	`de¸RefCou¡
(
¨gv
[4]);

860 
	`de¸RefCou¡
(
¨gv
[6]);

861 
	`de¸RefCou¡
(
¨gv
[7]);

862 
	`de¸RefCou¡
(
¨gv
[8]);

863 
	`de¸RefCou¡
(
¨gv
[9]);

864 
	`de¸RefCou¡
(
¨gv
[10]);

865 
	`de¸RefCou¡
(
¨gv
[11]);

866 
	`de¸RefCou¡
(
¨gv
[12]);

867 
	`de¸RefCou¡
(
¨gv
[13]);

868 
	}
}

876 
	$°ªamPr›ag©eGroupID
(
˛õ¡
 *
c
, 
robj
 *
key
, 
°ªamCG
 *
group
,Ñobj *
grou≤ame
) {

877 
robj
 *
¨gv
[5];

878 
¨gv
[0] = 
	`¸óãSåögObje˘
("XGROUP",6);

879 
¨gv
[1] = 
	`¸óãSåögObje˘
("SETID",5);

880 
¨gv
[2] = 
key
;

881 
¨gv
[3] = 
grou≤ame
;

882 
¨gv
[4] = 
	`¸óãObje˘FromSåómID
(&
group
->
œ°_id
);

888 
	`¥›ag©e
(
£rvî
.
xgroupComm™d
,
c
->
db
->
id
,
¨gv
,5,
PROPAGATE_AOF
|
PROPAGATE_REPL
);

889 
	`de¸RefCou¡
(
¨gv
[0]);

890 
	`de¸RefCou¡
(
¨gv
[1]);

891 
	`de¸RefCou¡
(
¨gv
[4]);

892 
	}
}

938 
	#STREAM_RWR_NOACK
 (1<<0Ë

	)

939 
	#STREAM_RWR_RAWENTRIES
 (1<<1Ë

	)

941 
	#STREAM_RWR_HISTORY
 (1<<2Ë

	)

942 
size_t
 
	$°ªamRïlyWôhR™ge
(
˛õ¡
 *
c
, 
°ªam
 *
s
, 
°ªamID
 *
°¨t
, såómID *
íd
, 
size_t
 
cou¡
, 
ªv
, 
°ªamCG
 *
group
, 
°ªamC⁄sumî
 *
c⁄sumî
, 
Êags
, 
°ªamPr›Info
 *
•i
) {

943 *
¨øyÀn_±r
 = 
NULL
;

944 
size_t
 
¨øyÀn
 = 0;

945 
°ªamIãøt‹
 
si
;

946 
öt64_t
 
numfõlds
;

947 
°ªamID
 
id
;

948 
¥›ag©e_œ°_id
 = 0;

949 
nﬂck
 = 
Êags
 & 
STREAM_RWR_NOACK
;

956 i‡(
group
 && (
Êags
 & 
STREAM_RWR_HISTORY
)) {

957  
	`°ªamRïlyWôhR™geFromC⁄sumîPEL
(
c
,
s
,
°¨t
,
íd
,
cou¡
,

958 
c⁄sumî
);

961 i‡(!(
Êags
 & 
STREAM_RWR_RAWENTRIES
))

962 
¨øyÀn_±r
 = 
	`addRïlyDe„ºedLí
(
c
);

963 
	`°ªamIãøt‹Sèπ
(&
si
,
s
,
°¨t
,
íd
,
ªv
);

964 
	`°ªamIãøt‹GëID
(&
si
,&
id
,&
numfõlds
)) {

966 i‡(
group
 && 
	`°ªamCom∑ªID
(&
id
,&group->
œ°_id
) > 0) {

967 
group
->
œ°_id
 = 
id
;

971 i‡(
nﬂck
Ë
¥›ag©e_œ°_id
 = 1;

976 
	`addRïlyAºayLí
(
c
,2);

977 
	`addRïlySåómID
(
c
,&
id
);

979 
	`addRïlyAºayLí
(
c
,
numfõlds
*2);

982 
numfõlds
--) {

983 *
key
, *
vÆue
;

984 
öt64_t
 
key_Àn
, 
vÆue_Àn
;

985 
	`°ªamIãøt‹GëFõld
(&
si
,&
key
,&
vÆue
,&
key_Àn
,&
vÆue_Àn
);

986 
	`addRïlyBulkCBuf„r
(
c
,
key
,
key_Àn
);

987 
	`addRïlyBulkCBuf„r
(
c
,
vÆue
,
vÆue_Àn
);

999 i‡(
group
 && !
nﬂck
) {

1000 
buf
[(
°ªamID
)];

1001 
	`°ªamEncodeID
(
buf
,&
id
);

1006 
°ªamNACK
 *
«ck
 = 
	`°ªamCª©eNACK
(
c⁄sumî
);

1007 
group_ö£πed
 =

1008 
	`øxTryIn£π
(
group
->
≥l
,
buf
,(buf),
«ck
,
NULL
);

1009 
c⁄sumî_ö£πed
 =

1010 
	`øxTryIn£π
(
c⁄sumî
->
≥l
,
buf
,(buf),
«ck
,
NULL
);

1015 i‡(
group_ö£πed
 == 0) {

1016 
	`°ªamFªeNACK
(
«ck
);

1017 
«ck
 = 
	`øxFöd
(
group
->
≥l
,
buf
,(buf));

1018 
	`£rvîAs£π
(
«ck
 !
øxNŸFound
);

1019 
	`øxRemove
(
«ck
->
c⁄sumî
->
≥l
,
buf
,(buf),
NULL
);

1021 
«ck
->
c⁄sumî
 = consumer;

1022 
«ck
->
dñivîy_time
 = 
	`m°ime
();

1023 
«ck
->
dñivîy_cou¡
 = 1;

1025 
	`øxIn£π
(
c⁄sumî
->
≥l
,
buf
,(buf),
«ck
,
NULL
);

1026 } i‡(
group_ö£πed
 =1 && 
c⁄sumî_ö£πed
 == 0) {

1027 
	`£rvîP™ic
("NACK half-created. ShouldÇot beÖossible.");

1031 i‡(
•i
) {

1032 
robj
 *
id¨g
 = 
	`¸óãObje˘FromSåómID
(&
id
);

1033 
	`°ªamPr›ag©eXCLAIM
(
c
,
•i
->
key«me
,
group
,•i->
grou≤ame
,
id¨g
,
«ck
);

1034 
	`de¸RefCou¡
(
id¨g
);

1038 
¨øyÀn
++;

1039 i‡(
cou¡
 && cou¡ =
¨øyÀn
) ;

1042 i‡(
•i
 && 
¥›ag©e_œ°_id
)

1043 
	`°ªamPr›ag©eGroupID
(
c
,
•i
->
key«me
,
group
,•i->
grou≤ame
);

1045 
	`°ªamIãøt‹St›
(&
si
);

1046 i‡(
¨øyÀn_±r
Ë
	`£tDe„ºedAºayLí
(
c
,¨øyÀn_±r,
¨øyÀn
);

1047  
¨øyÀn
;

1048 
	}
}

1063 
size_t
 
	$°ªamRïlyWôhR™geFromC⁄sumîPEL
(
˛õ¡
 *
c
, 
°ªam
 *
s
, 
°ªamID
 *
°¨t
, såómID *
íd
, 
size_t
 
cou¡
, 
°ªamC⁄sumî
 *
c⁄sumî
) {

1064 
øxIãøt‹
 
ri
;

1065 
°¨tkey
[(
°ªamID
)];

1066 
ídkey
[(
°ªamID
)];

1067 
	`°ªamEncodeID
(
°¨tkey
,
°¨t
);

1068 i‡(
íd
Ë
	`°ªamEncodeID
(
ídkey
,end);

1070 
size_t
 
¨øyÀn
 = 0;

1071 *
¨øyÀn_±r
 = 
	`addRïlyDe„ºedLí
(
c
);

1072 
	`øxSèπ
(&
ri
,
c⁄sumî
->
≥l
);

1073 
	`øxSìk
(&
ri
,">=",
°¨tkey
,(startkey));

1074 
	`øxNext
(&
ri
Ë&& (!
cou¡
 || 
¨øyÀn
 < count)) {

1075 i‡(
íd
 && 
	`memcmp
(
ri
.
key
,íd,ri.
key_Àn
) > 0) ;

1076 
°ªamID
 
thisid
;

1077 
	`°ªamDecodeID
(
ri
.
key
,&
thisid
);

1078 i‡(
	`°ªamRïlyWôhR™ge
(
c
,
s
,&
thisid
,&thisid,1,0,
NULL
,NULL,

1079 
STREAM_RWR_RAWENTRIES
,
NULL
) == 0)

1085 
	`addRïlyAºayLí
(
c
,2);

1086 
	`addRïlySåómID
(
c
,&
thisid
);

1087 
	`addRïlyNuŒAºay
(
c
);

1089 
°ªamNACK
 *
«ck
 = 
ri
.
d©a
;

1090 
«ck
->
dñivîy_time
 = 
	`m°ime
();

1091 
«ck
->
dñivîy_cou¡
++;

1093 
¨øyÀn
++;

1095 
	`øxSt›
(&
ri
);

1096 
	`£tDe„ºedAºayLí
(
c
,
¨øyÀn_±r
,
¨øyÀn
);

1097  
¨øyÀn
;

1098 
	}
}

1106 
robj
 *
	$°ªamTy≥LookupWrôeOrCª©e
(
˛õ¡
 *
c
, 
robj
 *
key
) {

1107 
robj
 *
o
 = 
	`lookupKeyWrôe
(
c
->
db
,
key
);

1108 i‡(
o
 =
NULL
) {

1109 
o
 = 
	`¸óãSåómObje˘
();

1110 
	`dbAdd
(
c
->
db
,
key
,
o
);

1112 i‡(
o
->
ty≥
 !
OBJ_STREAM
) {

1113 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

1114  
NULL
;

1117  
o
;

1118 
	}
}

1132 
	$°ªamGíîicP¨£IDOrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, 
°ªamID
 *
id
, 
uöt64_t
 
missög_£q
, 
°ri˘
) {

1133 
buf
[128];

1134 i‡(
	`sd¶í
(
o
->
±r
Ë> (
buf
)-1Ë
övÆid
;

1135 
	`mem˝y
(
buf
,
o
->
±r
,
	`sd¶í
(o->ptr)+1);

1137 i‡(
°ri˘
 && (
buf
[0] == '-' || buf[0] == '+') && buf[1] == '\0')

1138 
övÆid
;

1141 i‡(
buf
[0] == '-' && buf[1] == '\0') {

1142 
id
->
ms
 = 0;

1143 
id
->
£q
 = 0;

1144  
C_OK
;

1145 } i‡(
buf
[0] == '+' && buf[1] == '\0') {

1146 
id
->
ms
 = 
UINT64_MAX
;

1147 
id
->
£q
 = 
UINT64_MAX
;

1148  
C_OK
;

1152 *
dŸ
 = 
	`°rchr
(
buf
,'-');

1153 i‡(
dŸ
) *dot = '\0';

1154 
ms
, 
£q
;

1155 i‡(
	`°rög2uŒ
(
buf
,&
ms
Ë=0Ë
övÆid
;

1156 i‡(
dŸ
 && 
	`°rög2uŒ
(dŸ+1,&
£q
Ë=0Ë
övÆid
;

1157 i‡(!
dŸ
Ë
£q
 = 
missög_£q
;

1158 
id
->
ms
 = ms;

1159 
id
->
£q
 = seq;

1160  
C_OK
;

1162 
övÆid
:

1163 i‡(
c
Ë
	`addRïlyEº‹
(c,"Invalid stream ID specifiedás stream "

1165  
C_ERR
;

1166 
	}
}

1170 
	$°ªamP¨£IDOrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, 
°ªamID
 *
id
, 
uöt64_t
 
missög_£q
) {

1171  
	`°ªamGíîicP¨£IDOrRïly
(
c
,
o
,
id
,
missög_£q
,0);

1172 
	}
}

1177 
	$°ªamP¨£Såi˘IDOrRïly
(
˛õ¡
 *
c
, 
robj
 *
o
, 
°ªamID
 *
id
, 
uöt64_t
 
missög_£q
) {

1178  
	`°ªamGíîicP¨£IDOrRïly
(
c
,
o
,
id
,
missög_£q
,1);

1179 
	}
}

1183 
	$°ªamRewrôeAµroxMaxÀn
(
˛õ¡
 *
c
, 
°ªam
 *
s
, 
maxÀn_¨g_idx
) {

1184 
robj
 *
maxÀn_obj
 = 
	`¸óãSåögObje˘FromL⁄gL⁄g
(
s
->
Àngth
);

1185 
robj
 *
equÆ_obj
 = 
	`¸óãSåögObje˘
("=",1);

1187 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,
maxÀn_¨g_idx
,
maxÀn_obj
);

1188 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,
maxÀn_¨g_idx
-1,
equÆ_obj
);

1190 
	`de¸RefCou¡
(
equÆ_obj
);

1191 
	`de¸RefCou¡
(
maxÀn_obj
);

1192 
	}
}

1195 
	$xaddComm™d
(
˛õ¡
 *
c
) {

1196 
°ªamID
 
id
;

1197 
id_giví
 = 0;

1198 
maxÀn
 = -1;

1199 
≠¥ox_maxÀn
 = 0;

1201 
maxÀn_¨g_idx
 = 0;

1204 
i
 = 2;

1206 ; 
i
 < 
c
->
¨gc
; i++) {

1207 
m‹órgs
 = (
c
->
¨gc
-1Ë- 
i
;

1208 *
›t
 = 
c
->
¨gv
[
i
]->
±r
;

1209 i‡(
›t
[0] == '*' && opt[1] == '\0') {

1213 } i‡(!
	`°rˇ£cmp
(
›t
,"maxÀn"Ë&& 
m‹órgs
) {

1214 
≠¥ox_maxÀn
 = 0;

1215 *
√xt
 = 
c
->
¨gv
[
i
+1]->
±r
;

1217 i‡(
m‹órgs
 >2 && 
√xt
[0] == '~' &&Çext[1] == '\0') {

1218 
≠¥ox_maxÀn
 = 1;

1219 
i
++;

1220 } i‡(
m‹órgs
 >2 && 
√xt
[0] == '=' &&Çext[1] == '\0') {

1221 
i
++;

1223 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
i
+1],&
maxÀn
,
NULL
)

1224 !
C_OK
) ;

1226 i‡(
maxÀn
 < 0) {

1227 
	`addRïlyEº‹
(
c
,"The MAXLENárgument must be >= 0.");

1230 
i
++;

1231 
maxÀn_¨g_idx
 = 
i
;

1234 i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[
i
],&
id
,0Ë!
C_OK
) ;

1235 
id_giví
 = 1;

1239 
fõld_pos
 = 
i
+1;

1242 i‡((
c
->
¨gc
 - 
fõld_pos
) < 2 || ((c->argc-field_pos) % 2) == 1) {

1243 
	`addRïlyEº‹
(
c
,"wrongÇumber ofárguments for XADD");

1250 i‡(
id_giví
 && 
id
.
ms
 =0 && id.
£q
 == 0) {

1251 
	`addRïlyEº‹
(
c
,"The ID specified in XADD must be greaterÅhan 0-0");

1256 
robj
 *
o
;

1257 
°ªam
 *
s
;

1258 i‡((
o
 = 
	`°ªamTy≥LookupWrôeOrCª©e
(
c
,c->
¨gv
[1])Ë=
NULL
) ;

1259 
s
 = 
o
->
±r
;

1262 i‡(
s
->
œ°_id
.
ms
 =
UINT64_MAX
 && s->œ°_id.
£q
 == UINT64_MAX) {

1263 
	`addRïlyEº‹
(
c
,"The stream hasÉxhaustedÅheÜastÖossible ID, "

1269 i‡(
	`°ªamAµídIãm
(
s
,
c
->
¨gv
+
fõld_pos
,(c->
¨gc
-field_pos)/2,

1270 &
id
, 
id_giví
 ? &id : 
NULL
)

1271 =
C_ERR
)

1273 
	`addRïlyEº‹
(
c
,"The ID specified in XADD isÉqual or smallerÅhanÅhe "

1277 
	`addRïlySåómID
(
c
,&
id
);

1279 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

1280 
	`nŸifyKey•a˚Evít
(
NOTIFY_STREAM
,"xadd",
c
->
¨gv
[1],c->
db
->
id
);

1281 
£rvî
.
dúty
++;

1283 i‡(
maxÀn
 >= 0) {

1285 i‡(
	`°ªamTrimByLígth
(
s
,
maxÀn
,
≠¥ox_maxÀn
)) {

1286 
	`nŸifyKey•a˚Evít
(
NOTIFY_STREAM
,"xåim",
c
->
¨gv
[1],c->
db
->
id
);

1288 i‡(
≠¥ox_maxÀn
Ë
	`°ªamRewrôeAµroxMaxÀn
(
c
,
s
,
maxÀn_¨g_idx
);

1293 
robj
 *
id¨g
 = 
	`¸óãObje˘FromSåómID
(&
id
);

1294 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,
i
,
id¨g
);

1295 
	`de¸RefCou¡
(
id¨g
);

1299 i‡(
£rvî
.
blocked_˛õ¡s_by_ty≥
[
BLOCKED_STREAM
])

1300 
	`sig«lKeyAsRódy
(
c
->
db
, c->
¨gv
[1]);

1301 
	}
}

1304 
	$xøngeGíîicComm™d
(
˛õ¡
 *
c
, 
ªv
) {

1305 
robj
 *
o
;

1306 
°ªam
 *
s
;

1307 
°ªamID
 
°¨tid
, 
ídid
;

1308 
cou¡
 = -1;

1309 
robj
 *
°¨èrg
 = 
ªv
 ? 
c
->
¨gv
[3] : c->argv[2];

1310 
robj
 *
íd¨g
 = 
ªv
 ? 
c
->
¨gv
[2] : c->argv[3];

1312 i‡(
	`°ªamP¨£IDOrRïly
(
c
,
°¨èrg
,&
°¨tid
,0Ë=
C_ERR
) ;

1313 i‡(
	`°ªamP¨£IDOrRïly
(
c
,
íd¨g
,&
ídid
,
UINT64_MAX
Ë=
C_ERR
) ;

1316 i‡(
c
->
¨gc
 > 4) {

1317 
j
 = 4; j < 
c
->
¨gc
; j++) {

1318 
addôi⁄Æ
 = 
c
->
¨gc
-
j
-1;

1319 i‡(
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"COUNT"Ë=0 && 
addôi⁄Æ
 >= 1) {

1320 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
+1],&
cou¡
,
NULL
)

1321 !
C_OK
) ;

1322 i‡(
cou¡
 < 0) count = 0;

1323 
j
++;

1325 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

1332 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
em±y¨øy
)Ë=
NULL
 ||

1333 
	`checkTy≥
(
c
,
o
,
OBJ_STREAM
)) ;

1335 
s
 = 
o
->
±r
;

1337 i‡(
cou¡
 == 0) {

1338 
	`addRïlyNuŒAºay
(
c
);

1340 i‡(
cou¡
 == -1) count = 0;

1341 
	`°ªamRïlyWôhR™ge
(
c
,
s
,&
°¨tid
,&
ídid
,
cou¡
,
ªv
,
NULL
,NULL,0,NULL);

1343 
	}
}

1346 
	$xøngeComm™d
(
˛õ¡
 *
c
) {

1347 
	`xøngeGíîicComm™d
(
c
,0);

1348 
	}
}

1351 
	$xªvøngeComm™d
(
˛õ¡
 *
c
) {

1352 
	`xøngeGíîicComm™d
(
c
,1);

1353 
	}
}

1356 
	$xÀnComm™d
(
˛õ¡
 *
c
) {

1357 
robj
 *
o
;

1358 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL


1359 || 
	`checkTy≥
(
c
,
o
,
OBJ_STREAM
)) ;

1360 
°ªam
 *
s
 = 
o
->
±r
;

1361 
	`addRïlyL⁄gL⁄g
(
c
,
s
->
Àngth
);

1362 
	}
}

1371 
	#XREAD_BLOCKED_DEFAULT_COUNT
 1000

	)

1372 
	$xªadComm™d
(
˛õ¡
 *
c
) {

1373 
timeout
 = -1;

1374 
cou¡
 = 0;

1375 
°ªams_cou¡
 = 0;

1376 
°ªams_¨g
 = 0;

1377 
nﬂck
 = 0;

1378 
	#STREAMID_STATIC_VECTOR_LEN
 8

	)

1379 
°ªamID
 
°©ic_ids
[
STREAMID_STATIC_VECTOR_LEN
];

1380 
°ªamID
 *
ids
 = 
°©ic_ids
;

1381 
°ªamCG
 **
groups
 = 
NULL
;

1382 
xªadgroup
 = 
	`sd¶í
(
c
->
¨gv
[0]->
±r
) == 10;

1383 
robj
 *
grou≤ame
 = 
NULL
;

1384 
robj
 *
c⁄sumî«me
 = 
NULL
;

1387 
i
 = 1; i < 
c
->
¨gc
; i++) {

1388 
m‹órgs
 = 
c
->
¨gc
-
i
-1;

1389 *
o
 = 
c
->
¨gv
[
i
]->
±r
;

1390 i‡(!
	`°rˇ£cmp
(
o
,"BLOCK"Ë&& 
m‹órgs
) {

1391 i‡(
c
->
Êags
 & 
CLIENT_LUA
) {

1393 
	`addRïlyEº‹F‹m©
(
c
, "%†comm™d i†nŸáŒowed wôh BLOCK o±i⁄ from s¸ùts", (*)c->
¨gv
[0]->
±r
);

1396 
i
++;

1397 i‡(
	`gëTimeoutFromObje˘OrRïly
(
c
,c->
¨gv
[
i
],&
timeout
,

1398 
UNIT_MILLISECONDS
Ë!
C_OK
) ;

1399 } i‡(!
	`°rˇ£cmp
(
o
,"COUNT"Ë&& 
m‹órgs
) {

1400 
i
++;

1401 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
i
],&
cou¡
,
NULL
Ë!
C_OK
)

1403 i‡(
cou¡
 < 0) count = 0;

1404 } i‡(!
	`°rˇ£cmp
(
o
,"STREAMS"Ë&& 
m‹órgs
) {

1405 
°ªams_¨g
 = 
i
+1;

1406 
°ªams_cou¡
 = (
c
->
¨gc
-
°ªams_¨g
);

1407 i‡((
°ªams_cou¡
 % 2) != 0) {

1408 
	`addRïlyEº‹
(
c
,"Unbalanced XREADÜist of streams: "

1413 
°ªams_cou¡
 /= 2;

1415 } i‡(!
	`°rˇ£cmp
(
o
,"GROUP"Ë&& 
m‹órgs
 >= 2) {

1416 i‡(!
xªadgroup
) {

1417 
	`addRïlyEº‹
(
c
,"The GROUP option is only supported by "

1421 
grou≤ame
 = 
c
->
¨gv
[
i
+1];

1422 
c⁄sumî«me
 = 
c
->
¨gv
[
i
+2];

1423 
i
 += 2;

1424 } i‡(!
	`°rˇ£cmp
(
o
,"NOACK")) {

1425 i‡(!
xªadgroup
) {

1426 
	`addRïlyEº‹
(
c
,"The NOACK option is only supported by "

1430 
nﬂck
 = 1;

1432 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

1438 i‡(
°ªams_¨g
 == 0) {

1439 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

1445 i‡(
xªadgroup
 && 
grou≤ame
 =
NULL
) {

1446 
	`addRïlyEº‹
(
c
,"Missing GROUP option for XREADGROUP");

1451 i‡(
°ªams_cou¡
 > 
STREAMID_STATIC_VECTOR_LEN
)

1452 
ids
 = 
	`zmÆloc
((
°ªamID
)*
°ªams_cou¡
);

1453 i‡(
grou≤ame
Ë
groups
 = 
	`zmÆloc
((
°ªamCG
*)*
°ªams_cou¡
);

1455 
i
 = 
°ªams_¨g
 + 
°ªams_cou¡
; i < 
c
->
¨gc
; i++) {

1459 
id_idx
 = 
i
 - 
°ªams_¨g
 - 
°ªams_cou¡
;

1460 
robj
 *
key
 = 
c
->
¨gv
[
i
-
°ªams_cou¡
];

1461 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
,
key
);

1462 i‡(
o
 && 
	`checkTy≥
(
c
,o,
OBJ_STREAM
)Ë
˛ónup
;

1463 
°ªamCG
 *
group
 = 
NULL
;

1467 i‡(
grou≤ame
) {

1468 i‡(
o
 =
NULL
 ||

1469 (
group
 = 
	`°ªamLookupCG
(
o
->
±r
,
grou≤ame
->±r)Ë=
NULL
)

1471 
	`addRïlyEº‹F‹m©
(
c
, "-NOGROUP No such key '%s' or consumer "

1474 (*)
key
->
±r
,(*)
grou≤ame
->ptr);

1475 
˛ónup
;

1477 
groups
[
id_idx
] = 
group
;

1480 i‡(
	`°rcmp
(
c
->
¨gv
[
i
]->
±r
,"$") == 0) {

1481 i‡(
xªadgroup
) {

1482 
	`addRïlyEº‹
(
c
,"The $ ID is meaningless inÅhe context of "

1487 
˛ónup
;

1489 i‡(
o
) {

1490 
°ªam
 *
s
 = 
o
->
±r
;

1491 
ids
[
id_idx
] = 
s
->
œ°_id
;

1493 
ids
[
id_idx
].
ms
 = 0;

1494 
ids
[
id_idx
].
£q
 = 0;

1497 } i‡(
	`°rcmp
(
c
->
¨gv
[
i
]->
±r
,">") == 0) {

1498 i‡(!
xªadgroup
) {

1499 
	`addRïlyEº‹
(
c
,"The > ID can be specified only when calling "

1502 
˛ónup
;

1507 
ids
[
id_idx
].
ms
 = 
UINT64_MAX
;

1508 
ids
[
id_idx
].
£q
 = 
UINT64_MAX
;

1511 i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[
i
],
ids
+
id_idx
,0Ë!
C_OK
)

1512 
˛ónup
;

1516 
size_t
 
¨øyÀn
 = 0;

1517 *
¨øyÀn_±r
 = 
NULL
;

1518 
i
 = 0; i < 
°ªams_cou¡
; i++) {

1519 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
°ªams_¨g
+
i
]);

1520 i‡(
o
 =
NULL
) ;

1521 
°ªam
 *
s
 = 
o
->
±r
;

1522 
°ªamID
 *
gt
 = 
ids
+
i
;

1523 
£rve_synchr⁄ou¶y
 = 0;

1524 
£rve_hi°‹y
 = 0;

1528 i‡(
groups
) {

1532 i‡(
gt
->
ms
 !
UINT64_MAX
 ||

1533 
gt
->
£q
 !
UINT64_MAX
)

1535 
£rve_synchr⁄ou¶y
 = 1;

1536 
£rve_hi°‹y
 = 1;

1537 } i‡(
s
->
Àngth
) {

1541 
°ªamID
 
maxid
, *
œ°
 = &
groups
[
i
]->
œ°_id
;

1542 
	`°ªamLa°VÆidID
(
s
, &
maxid
);

1543 i‡(
	`°ªamCom∑ªID
(&
maxid
, 
œ°
) > 0) {

1544 
£rve_synchr⁄ou¶y
 = 1;

1545 *
gt
 = *
œ°
;

1548 } i‡(
s
->
Àngth
) {

1551 
°ªamID
 
maxid
;

1552 
	`°ªamLa°VÆidID
(
s
, &
maxid
);

1553 i‡(
	`°ªamCom∑ªID
(&
maxid
, 
gt
) > 0) {

1554 
£rve_synchr⁄ou¶y
 = 1;

1558 i‡(
£rve_synchr⁄ou¶y
) {

1559 
¨øyÀn
++;

1560 i‡(
¨øyÀn
 =1Ë
¨øyÀn_±r
 = 
	`addRïlyDe„ºedLí
(
c
);

1564 
°ªamID
 
°¨t
 = *
gt
;

1565 
	`°ªamIn¸ID
(&
°¨t
);

1569 i‡(
c
->
ª•
 =2Ë
	`addRïlyAºayLí
(c,2);

1570 
	`addRïlyBulk
(
c
,c->
¨gv
[
°ªams_¨g
+
i
]);

1571 
°ªamC⁄sumî
 *
c⁄sumî
 = 
NULL
;

1572 i‡(
groups
Ë
c⁄sumî
 = 
	`°ªamLookupC⁄sumî
(groups[
i
],

1573 
c⁄sumî«me
->
±r
,

1574 
SLC_NONE
);

1575 
°ªamPr›Info
 
•i
 = {
c
->
¨gv
[
i
+
°ªams_¨g
],
grou≤ame
};

1576 
Êags
 = 0;

1577 i‡(
nﬂck
Ë
Êags
 |
STREAM_RWR_NOACK
;

1578 i‡(
£rve_hi°‹y
Ë
Êags
 |
STREAM_RWR_HISTORY
;

1579 
	`°ªamRïlyWôhR™ge
(
c
,
s
,&
°¨t
,
NULL
,
cou¡
,0,

1580 
groups
 ? groups[
i
] : 
NULL
,

1581 
c⁄sumî
, 
Êags
, &
•i
);

1582 i‡(
groups
Ë
£rvî
.
dúty
++;

1587 i‡(
¨øyÀn
) {

1588 i‡(
c
->
ª•
 == 2)

1589 
	`£tDe„ºedAºayLí
(
c
,
¨øyÀn_±r
,
¨øyÀn
);

1591 
	`£tDe„ºedM≠Lí
(
c
,
¨øyÀn_±r
,
¨øyÀn
);

1592 
˛ónup
;

1596 i‡(
timeout
 != -1) {

1599 i‡(
c
->
Êags
 & 
CLIENT_MULTI
) {

1600 
	`addRïlyNuŒAºay
(
c
);

1601 
˛ónup
;

1603 
	`blockF‹Keys
(
c
, 
BLOCKED_STREAM
, c->
¨gv
+
°ªams_¨g
, 
°ªams_cou¡
,

1604 
timeout
, 
NULL
, 
ids
);

1608 
c
->
bp›
.
xªad_cou¡
 = 
cou¡
 ? cou¡ : 
XREAD_BLOCKED_DEFAULT_COUNT
;

1614 i‡(
grou≤ame
) {

1615 
	`ö¸RefCou¡
(
grou≤ame
);

1616 
	`ö¸RefCou¡
(
c⁄sumî«me
);

1617 
c
->
bp›
.
xªad_group
 = 
grou≤ame
;

1618 
c
->
bp›
.
xªad_c⁄sumî
 = 
c⁄sumî«me
;

1619 
c
->
bp›
.
xªad_group_nﬂck
 = 
nﬂck
;

1621 
c
->
bp›
.
xªad_group
 = 
NULL
;

1622 
c
->
bp›
.
xªad_c⁄sumî
 = 
NULL
;

1624 
˛ónup
;

1629 
	`addRïlyNuŒAºay
(
c
);

1632 
˛ónup
:

1636 
	`¥evítComm™dPr›ag©i⁄
(
c
);

1637 i‡(
ids
 !
°©ic_ids
Ë
	`z‰ì
(ids);

1638 
	`z‰ì
(
groups
);

1639 
	}
}

1648 
°ªamNACK
 *
	$°ªamCª©eNACK
(
°ªamC⁄sumî
 *
c⁄sumî
) {

1649 
°ªamNACK
 *
«ck
 = 
	`zmÆloc
((*nack));

1650 
«ck
->
dñivîy_time
 = 
	`m°ime
();

1651 
«ck
->
dñivîy_cou¡
 = 1;

1652 
«ck
->
c⁄sumî
 = consumer;

1653  
«ck
;

1654 
	}
}

1657 
	$°ªamFªeNACK
(
°ªamNACK
 *
«
) {

1658 
	`z‰ì
(
«
);

1659 
	}
}

1666 
	$°ªamFªeC⁄sumî
(
°ªamC⁄sumî
 *
sc
) {

1667 
	`øxFªe
(
sc
->
≥l
);

1669 
	`sds‰ì
(
sc
->
«me
);

1670 
	`z‰ì
(
sc
);

1671 
	}
}

1677 
°ªamCG
 *
	$°ªamCª©eCG
(
°ªam
 *
s
, *
«me
, 
size_t
 
«mñí
, 
°ªamID
 *
id
) {

1678 i‡(
s
->
cgroups
 =
NULL
Ës->cgroup†
	`øxNew
();

1679 i‡(
	`øxFöd
(
s
->
cgroups
,(*)
«me
,
«mñí
Ë!
øxNŸFound
)

1680  
NULL
;

1682 
°ªamCG
 *
cg
 = 
	`zmÆloc
((*cg));

1683 
cg
->
≥l
 = 
	`øxNew
();

1684 
cg
->
c⁄sumîs
 = 
	`øxNew
();

1685 
cg
->
œ°_id
 = *
id
;

1686 
	`øxIn£π
(
s
->
cgroups
,(*)
«me
,
«mñí
,
cg
,
NULL
);

1687  
cg
;

1688 
	}
}

1691 
	$°ªamFªeCG
(
°ªamCG
 *
cg
) {

1692 
	`øxFªeWôhCÆlback
(
cg
->
≥l
,((*)(*))
°ªamFªeNACK
);

1693 
	`øxFªeWôhCÆlback
(
cg
->
c⁄sumîs
,((*)(*))
°ªamFªeC⁄sumî
);

1694 
	`z‰ì
(
cg
);

1695 
	}
}

1699 
°ªamCG
 *
	$°ªamLookupCG
(
°ªam
 *
s
, 
sds
 
grou≤ame
) {

1700 i‡(
s
->
cgroups
 =
NULL
)  NULL;

1701 
°ªamCG
 *
cg
 = 
	`øxFöd
(
s
->
cgroups
,(*)
grou≤ame
,

1702 
	`sd¶í
(
grou≤ame
));

1703  (
cg
 =
øxNŸFound
Ë? 
NULL
 : cg;

1704 
	}
}

1710 
°ªamC⁄sumî
 *
	$°ªamLookupC⁄sumî
(
°ªamCG
 *
cg
, 
sds
 
«me
, 
Êags
) {

1711 
¸óã
 = !(
Êags
 & 
SLC_NOCREAT
);

1712 
ª‰esh
 = !(
Êags
 & 
SLC_NOREFRESH
);

1713 
°ªamC⁄sumî
 *
c⁄sumî
 = 
	`øxFöd
(
cg
->
c⁄sumîs
,(*)
«me
,

1714 
	`sd¶í
(
«me
));

1715 i‡(
c⁄sumî
 =
øxNŸFound
) {

1716 i‡(!
¸óã
Ë 
NULL
;

1717 
c⁄sumî
 = 
	`zmÆloc
((*consumer));

1718 
c⁄sumî
->
«me
 = 
	`sdsdup
(name);

1719 
c⁄sumî
->
≥l
 = 
	`øxNew
();

1720 
	`øxIn£π
(
cg
->
c⁄sumîs
,(*)
«me
,
	`sd¶í
(name),

1721 
c⁄sumî
,
NULL
);

1723 i‡(
ª‰esh
Ë
c⁄sumî
->
£í_time
 = 
	`m°ime
();

1724  
c⁄sumî
;

1725 
	}
}

1730 
uöt64_t
 
	$°ªamDñC⁄sumî
(
°ªamCG
 *
cg
, 
sds
 
«me
) {

1731 
°ªamC⁄sumî
 *
c⁄sumî
 =

1732 
	`°ªamLookupC⁄sumî
(
cg
,
«me
,
SLC_NOCREAT
|
SLC_NOREFRESH
);

1733 i‡(
c⁄sumî
 =
NULL
)  0;

1735 
uöt64_t
 
ªtvÆ
 = 
	`øxSize
(
c⁄sumî
->
≥l
);

1739 
øxIãøt‹
 
ri
;

1740 
	`øxSèπ
(&
ri
,
c⁄sumî
->
≥l
);

1741 
	`øxSìk
(&
ri
,"^",
NULL
,0);

1742 
	`øxNext
(&
ri
)) {

1743 
°ªamNACK
 *
«ck
 = 
ri
.
d©a
;

1744 
	`øxRemove
(
cg
->
≥l
,
ri
.
key
,ri.
key_Àn
,
NULL
);

1745 
	`°ªamFªeNACK
(
«ck
);

1747 
	`øxSt›
(&
ri
);

1750 
	`øxRemove
(
cg
->
c⁄sumîs
,(*)
«me
,
	`sd¶í
“ame),
NULL
);

1751 
	`°ªamFªeC⁄sumî
(
c⁄sumî
);

1752  
ªtvÆ
;

1753 
	}
}

1763 
	$xgroupComm™d
(
˛õ¡
 *
c
) {

1764 c⁄° *
hñp
[] = {

1771 
NULL


1773 
°ªam
 *
s
 = 
NULL
;

1774 
sds
 
gΩ«me
 = 
NULL
;

1775 
°ªamCG
 *
cg
 = 
NULL
;

1776 *
›t
 = 
c
->
¨gv
[1]->
±r
;

1777 
mk°ªam
 = 0;

1778 
robj
 *
o
;

1782 i‡(
c
->
¨gc
 =6 && !
	`°rˇ£cmp
(
›t
,"CREATE")) {

1783 i‡(
	`°rˇ£cmp
(
c
->
¨gv
[5]->
±r
,"MKSTREAM")) {

1784 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

1787 
mk°ªam
 = 1;

1788 
gΩ«me
 = 
c
->
¨gv
[3]->
±r
;

1792 i‡(
c
->
¨gc
 >= 4) {

1793 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[2]);

1794 i‡(
o
) {

1795 i‡(
	`checkTy≥
(
c
,
o
,
OBJ_STREAM
)) ;

1796 
s
 = 
o
->
±r
;

1798 
gΩ«me
 = 
c
->
¨gv
[3]->
±r
;

1802 i‡(
c
->
¨gc
 >4 && !
mk°ªam
) {

1804 i‡(
s
 =
NULL
) {

1805 
	`addRïlyEº‹
(
c
,

1813 i‡((
cg
 = 
	`°ªamLookupCG
(
s
,
gΩ«me
)Ë=
NULL
 &&

1814 (!
	`°rˇ£cmp
(
›t
,"SETID") ||

1815 !
	`°rˇ£cmp
(
›t
,"DELCONSUMER")))

1817 
	`addRïlyEº‹F‹m©
(
c
, "-NOGROUP No such consumer group '%s' "

1819 (*)
gΩ«me
, (*)
c
->
¨gv
[2]->
±r
);

1825 i‡(!
	`°rˇ£cmp
(
›t
,"CREATE"Ë&& (
c
->
¨gc
 == 5 || c->argc == 6)) {

1826 
°ªamID
 
id
;

1827 i‡(!
	`°rcmp
(
c
->
¨gv
[4]->
±r
,"$")) {

1828 i‡(
s
) {

1829 
id
 = 
s
->
œ°_id
;

1831 
id
.
ms
 = 0;

1832 
id
.
£q
 = 0;

1834 } i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[4],&
id
,0Ë!
C_OK
) {

1839 i‡(
s
 =
NULL
) {

1840 
	`£rvîAs£π
(
mk°ªam
);

1841 
o
 = 
	`¸óãSåómObje˘
();

1842 
	`dbAdd
(
c
->
db
,c->
¨gv
[2],
o
);

1843 
s
 = 
o
->
±r
;

1846 
°ªamCG
 *
cg
 = 
	`°ªamCª©eCG
(
s
,
gΩ«me
,
	`sd¶í
(gΩ«me),&
id
);

1847 i‡(
cg
) {

1848 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1849 
£rvî
.
dúty
++;

1850 
	`nŸifyKey•a˚Evít
(
NOTIFY_STREAM
,"xgroup-create",

1851 
c
->
¨gv
[2],c->
db
->
id
);

1853 
	`addRïlySds
(
c
,

1854 
	`sd¢ew
("-BUSYGROUP Consumer GroupÇameálreadyÉxists\r\n"));

1856 } i‡(!
	`°rˇ£cmp
(
›t
,"SETID"Ë&& 
c
->
¨gc
 == 5) {

1857 
°ªamID
 
id
;

1858 i‡(!
	`°rcmp
(
c
->
¨gv
[4]->
±r
,"$")) {

1859 
id
 = 
s
->
œ°_id
;

1860 } i‡(
	`°ªamP¨£IDOrRïly
(
c
,c->
¨gv
[4],&
id
,0Ë!
C_OK
) {

1863 
cg
->
œ°_id
 = 
id
;

1864 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1865 
£rvî
.
dúty
++;

1866 
	`nŸifyKey•a˚Evít
(
NOTIFY_STREAM
,"xgroup-£tid",
c
->
¨gv
[2],c->
db
->
id
);

1867 } i‡(!
	`°rˇ£cmp
(
›t
,"DESTROY"Ë&& 
c
->
¨gc
 == 4) {

1868 i‡(
cg
) {

1869 
	`øxRemove
(
s
->
cgroups
,(*)
gΩ«me
,
	`sd¶í
(gΩ«me),
NULL
);

1870 
	`°ªamFªeCG
(
cg
);

1871 
	`addRïly
(
c
,
sh¨ed
.
c⁄e
);

1872 
£rvî
.
dúty
++;

1873 
	`nŸifyKey•a˚Evít
(
NOTIFY_STREAM
,"xgroup-destroy",

1874 
c
->
¨gv
[2],c->
db
->
id
);

1876 
	`sig«lKeyAsRódy
(
c
->
db
,c->
¨gv
[2]);

1878 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

1880 } i‡(!
	`°rˇ£cmp
(
›t
,"DELCONSUMER"Ë&& 
c
->
¨gc
 == 5) {

1883 
≥ndög
 = 
	`°ªamDñC⁄sumî
(
cg
,
c
->
¨gv
[4]->
±r
);

1884 
	`addRïlyL⁄gL⁄g
(
c
,
≥ndög
);

1885 
£rvî
.
dúty
++;

1886 
	`nŸifyKey•a˚Evít
(
NOTIFY_STREAM
,"xgroup-delconsumer",

1887 
c
->
¨gv
[2],c->
db
->
id
);

1888 } i‡(!
	`°rˇ£cmp
(
›t
,"HELP")) {

1889 
	`addRïlyHñp
(
c
, 
hñp
);

1891 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

1893 
	}
}

1898 
	$x£tidComm™d
(
˛õ¡
 *
c
) {

1899 
robj
 *
o
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nokeyîr
);

1900 i‡(
o
 =
NULL
 || 
	`checkTy≥
(
c
,o,
OBJ_STREAM
)) ;

1902 
°ªam
 *
s
 = 
o
->
±r
;

1903 
°ªamID
 
id
;

1904 i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[2],&
id
,0Ë!
C_OK
) ;

1909 i‡(
s
->
Àngth
 > 0) {

1910 
°ªamID
 
maxid
;

1911 
	`°ªamLa°VÆidID
(
s
,&
maxid
);

1913 i‡(
	`°ªamCom∑ªID
(&
id
,&
maxid
) < 0) {

1914 
	`addRïlyEº‹
(
c
,"The ID specified in XSETID is smallerÅhanÅhe "

1919 
s
->
œ°_id
 = 
id
;

1920 
	`addRïly
(
c
,
sh¨ed
.
ok
);

1921 
£rvî
.
dúty
++;

1922 
	`nŸifyKey•a˚Evít
(
NOTIFY_STREAM
,"x£tid",
c
->
¨gv
[1],c->
db
->
id
);

1923 
	}
}

1934 
	$xackComm™d
(
˛õ¡
 *
c
) {

1935 
°ªamCG
 *
group
 = 
NULL
;

1936 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[1]);

1937 i‡(
o
) {

1938 i‡(
	`checkTy≥
(
c
,
o
,
OBJ_STREAM
)) ;

1939 
group
 = 
	`°ªamLookupCG
(
o
->
±r
,
c
->
¨gv
[2]->ptr);

1943 i‡(
o
 =
NULL
 || 
group
 == NULL) {

1944 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

1952 
j
 = 3; j < 
c
->
¨gc
; j++) {

1953 
°ªamID
 
id
;

1954 i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[
j
],&
id
,0Ë!
C_OK
) ;

1957 
acknowÀdged
 = 0;

1958 
j
 = 3; j < 
c
->
¨gc
; j++) {

1959 
°ªamID
 
id
;

1960 
buf
[(
°ªamID
)];

1961 i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[
j
],&
id
,0Ë!
C_OK
)

1962 
	`£rvîP™ic
("StreamID invalidáfter check. ShouldÇot beÖossible.");

1963 
	`°ªamEncodeID
(
buf
,&
id
);

1968 
°ªamNACK
 *
«ck
 = 
	`øxFöd
(
group
->
≥l
,
buf
,(buf));

1969 i‡(
«ck
 !
øxNŸFound
) {

1970 
	`øxRemove
(
group
->
≥l
,
buf
,(buf),
NULL
);

1971 
	`øxRemove
(
«ck
->
c⁄sumî
->
≥l
,
buf
,(buf),
NULL
);

1972 
	`°ªamFªeNACK
(
«ck
);

1973 
acknowÀdged
++;

1974 
£rvî
.
dúty
++;

1977 
	`addRïlyL⁄gL⁄g
(
c
,
acknowÀdged
);

1978 
	}
}

1989 
	$x≥ndögComm™d
(
˛õ¡
 *
c
) {

1990 
ju°öfo
 = 
c
->
¨gc
 == 3;

1992 
robj
 *
key
 = 
c
->
¨gv
[1];

1993 
robj
 *
grou≤ame
 = 
c
->
¨gv
[2];

1994 
robj
 *
c⁄sumî«me
 = (
c
->
¨gc
 =7Ë? c->
¨gv
[6] : 
NULL
;

1995 
°ªamID
 
°¨tid
, 
ídid
;

1996 
cou¡
;

1999 i‡(
c
->
¨gc
 != 3 && c->argc != 6 && c->argc != 7) {

2000 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2006 i‡(
c
->
¨gc
 >= 6) {

2007 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[5],&
cou¡
,
NULL
Ë=
C_ERR
)

2009 i‡(
cou¡
 < 0) count = 0;

2010 i‡(
	`°ªamP¨£IDOrRïly
(
c
,c->
¨gv
[3],&
°¨tid
,0Ë=
C_ERR
)

2012 i‡(
	`°ªamP¨£IDOrRïly
(
c
,c->
¨gv
[4],&
ídid
,
UINT64_MAX
Ë=
C_ERR
)

2017 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[1]);

2018 
°ªamCG
 *
group
;

2020 i‡(
o
 && 
	`checkTy≥
(
c
,o,
OBJ_STREAM
)) ;

2021 i‡(
o
 =
NULL
 ||

2022 (
group
 = 
	`°ªamLookupCG
(
o
->
±r
,
grou≤ame
->±r)Ë=
NULL
)

2024 
	`addRïlyEº‹F‹m©
(
c
, "-NOGROUP No such key '%s' or consumer "

2026 (*)
key
->
±r
,(*)
grou≤ame
->ptr);

2031 i‡(
ju°öfo
) {

2032 
	`addRïlyAºayLí
(
c
,4);

2034 
	`addRïlyL⁄gL⁄g
(
c
,
	`øxSize
(
group
->
≥l
));

2036 i‡(
	`øxSize
(
group
->
≥l
) == 0) {

2037 
	`addRïlyNuŒ
(
c
);

2038 
	`addRïlyNuŒ
(
c
);

2039 
	`addRïlyNuŒAºay
(
c
);

2042 
øxIãøt‹
 
ri
;

2043 
	`øxSèπ
(&
ri
,
group
->
≥l
);

2044 
	`øxSìk
(&
ri
,"^",
NULL
,0);

2045 
	`øxNext
(&
ri
);

2046 
	`°ªamDecodeID
(
ri
.
key
,&
°¨tid
);

2047 
	`addRïlySåómID
(
c
,&
°¨tid
);

2050 
	`øxSìk
(&
ri
,"$",
NULL
,0);

2051 
	`øxNext
(&
ri
);

2052 
	`°ªamDecodeID
(
ri
.
key
,&
ídid
);

2053 
	`addRïlySåómID
(
c
,&
ídid
);

2054 
	`øxSt›
(&
ri
);

2057 
	`øxSèπ
(&
ri
,
group
->
c⁄sumîs
);

2058 
	`øxSìk
(&
ri
,"^",
NULL
,0);

2059 *
¨øyÀn_±r
 = 
	`addRïlyDe„ºedLí
(
c
);

2060 
size_t
 
¨øyÀn
 = 0;

2061 
	`øxNext
(&
ri
)) {

2062 
°ªamC⁄sumî
 *
c⁄sumî
 = 
ri
.
d©a
;

2063 i‡(
	`øxSize
(
c⁄sumî
->
≥l
) == 0) ;

2064 
	`addRïlyAºayLí
(
c
,2);

2065 
	`addRïlyBulkCBuf„r
(
c
,
ri
.
key
,ri.
key_Àn
);

2066 
	`addRïlyBulkL⁄gL⁄g
(
c
,
	`øxSize
(
c⁄sumî
->
≥l
));

2067 
¨øyÀn
++;

2069 
	`£tDe„ºedAºayLí
(
c
,
¨øyÀn_±r
,
¨øyÀn
);

2070 
	`øxSt›
(&
ri
);

2075 
°ªamC⁄sumî
 *
c⁄sumî
 = 
NULL
;

2076 i‡(
c⁄sumî«me
) {

2077 
c⁄sumî
 = 
	`°ªamLookupC⁄sumî
(
group
,

2078 
c⁄sumî«me
->
±r
,

2079 
SLC_NOCREAT
|
SLC_NOREFRESH
);

2083 i‡(
c⁄sumî
 =
NULL
) {

2084 
	`addRïlyAºayLí
(
c
,0);

2089 
øx
 *
≥l
 = 
c⁄sumî
 ? c⁄sumî->≥»: 
group
->pel;

2090 
°¨tkey
[(
°ªamID
)];

2091 
ídkey
[(
°ªamID
)];

2092 
øxIãøt‹
 
ri
;

2093 
m°ime_t
 
now
 = 
	`m°ime
();

2095 
	`°ªamEncodeID
(
°¨tkey
,&
°¨tid
);

2096 
	`°ªamEncodeID
(
ídkey
,&
ídid
);

2097 
	`øxSèπ
(&
ri
,
≥l
);

2098 
	`øxSìk
(&
ri
,">=",
°¨tkey
,(startkey));

2099 *
¨øyÀn_±r
 = 
	`addRïlyDe„ºedLí
(
c
);

2100 
size_t
 
¨øyÀn
 = 0;

2102 
cou¡
 && 
	`øxNext
(&
ri
Ë&& 
	`memcmp
‘i.
key
,
ídkey
,ri.
key_Àn
) <= 0) {

2103 
°ªamNACK
 *
«ck
 = 
ri
.
d©a
;

2105 
¨øyÀn
++;

2106 
cou¡
--;

2107 
	`addRïlyAºayLí
(
c
,4);

2110 
°ªamID
 
id
;

2111 
	`°ªamDecodeID
(
ri
.
key
,&
id
);

2112 
	`addRïlySåómID
(
c
,&
id
);

2115 
	`addRïlyBulkCBuf„r
(
c
,
«ck
->
c⁄sumî
->
«me
,

2116 
	`sd¶í
(
«ck
->
c⁄sumî
->
«me
));

2119 
m°ime_t
 
ñ≠£d
 = 
now
 - 
«ck
->
dñivîy_time
;

2120 i‡(
ñ≠£d
 < 0)Élapsed = 0;

2121 
	`addRïlyL⁄gL⁄g
(
c
,
ñ≠£d
);

2124 
	`addRïlyL⁄gL⁄g
(
c
,
«ck
->
dñivîy_cou¡
);

2126 
	`øxSt›
(&
ri
);

2127 
	`£tDe„ºedAºayLí
(
c
,
¨øyÀn_±r
,
¨øyÀn
);

2129 
	}
}

2197 
	$x˛aimComm™d
(
˛õ¡
 *
c
) {

2198 
°ªamCG
 *
group
 = 
NULL
;

2199 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[1]);

2200 
möidÀ
;

2201 
ªåycou¡
 = -1;

2202 
m°ime_t
 
dñivîytime
 = -1;

2203 
f‹˚
 = 0;

2204 
ju°id
 = 0;

2206 i‡(
o
) {

2207 i‡(
	`checkTy≥
(
c
,
o
,
OBJ_STREAM
)) ;

2208 
group
 = 
	`°ªamLookupCG
(
o
->
±r
,
c
->
¨gv
[2]->ptr);

2213 i‡(
o
 =
NULL
 || 
group
 == NULL) {

2214 
	`addRïlyEº‹F‹m©
(
c
,"-NOGROUP No such key '%s' or "

2215 "c⁄sumî grou∞'%s'", (*)
c
->
¨gv
[1]->
±r
,

2216 (*)
c
->
¨gv
[2]->
±r
);

2220 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[4],&
möidÀ
,

2222 !
C_OK
) ;

2223 i‡(
möidÀ
 < 0) minidle = 0;

2229 
j
;

2230 
j
 = 5; j < 
c
->
¨gc
; j++) {

2231 
°ªamID
 
id
;

2232 i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
NULL
,
c
->
¨gv
[
j
],&
id
,0Ë!
C_OK
) ;

2234 
œ°_id_¨g
 = 
j
-1;

2238 
m°ime_t
 
now
 = 
	`m°ime
();

2239 
°ªamID
 
œ°_id
 = {0,0};

2240 
¥›ag©e_œ°_id
 = 0;

2241 ; 
j
 < 
c
->
¨gc
; j++) {

2242 
m‹órgs
 = (
c
->
¨gc
-1Ë- 
j
;

2243 *
›t
 = 
c
->
¨gv
[
j
]->
±r
;

2244 i‡(!
	`°rˇ£cmp
(
›t
,"FORCE")) {

2245 
f‹˚
 = 1;

2246 } i‡(!
	`°rˇ£cmp
(
›t
,"JUSTID")) {

2247 
ju°id
 = 1;

2248 } i‡(!
	`°rˇ£cmp
(
›t
,"IDLE"Ë&& 
m‹órgs
) {

2249 
j
++;

2250 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
],&
dñivîytime
,

2252 !
C_OK
) ;

2253 
dñivîytime
 = 
now
 - deliverytime;

2254 } i‡(!
	`°rˇ£cmp
(
›t
,"TIME"Ë&& 
m‹órgs
) {

2255 
j
++;

2256 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
],&
dñivîytime
,

2258 !
C_OK
) ;

2259 } i‡(!
	`°rˇ£cmp
(
›t
,"RETRYCOUNT"Ë&& 
m‹órgs
) {

2260 
j
++;

2261 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
],&
ªåycou¡
,

2263 !
C_OK
) ;

2264 } i‡(!
	`°rˇ£cmp
(
›t
,"LASTID"Ë&& 
m‹órgs
) {

2265 
j
++;

2266 i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[
j
],&
œ°_id
,0Ë!
C_OK
) ;

2268 
	`addRïlyEº‹F‹m©
(
c
,"Uƒecognized XCLAIM o±i⁄ '%s'",
›t
);

2273 i‡(
	`°ªamCom∑ªID
(&
œ°_id
,&
group
->last_id) > 0) {

2274 
group
->
œ°_id
 =Üast_id;

2275 
¥›ag©e_œ°_id
 = 1;

2278 i‡(
dñivîytime
 != -1) {

2286 i‡(
dñivîytime
 < 0 || dñivîytimê> 
now
) deliverytime =Çow;

2291 
dñivîytime
 = 
now
;

2295 
°ªamC⁄sumî
 *
c⁄sumî
 = 
NULL
;

2296 *
¨øyÀ≈å
 = 
	`addRïlyDe„ºedLí
(
c
);

2297 
size_t
 
¨øyÀn
 = 0;

2298 
j
 = 5; j <
œ°_id_¨g
; j++) {

2299 
°ªamID
 
id
;

2300 
buf
[(
°ªamID
)];

2301 i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[
j
],&
id
,0Ë!
C_OK
)

2302 
	`£rvîP™ic
("StreamID invalidáfter check. ShouldÇot beÖossible.");

2303 
	`°ªamEncodeID
(
buf
,&
id
);

2306 
°ªamNACK
 *
«ck
 = 
	`øxFöd
(
group
->
≥l
,
buf
,(buf));

2313 i‡(
f‹˚
 && 
«ck
 =
øxNŸFound
) {

2314 
°ªamIãøt‹
 
myôî©‹
;

2315 
	`°ªamIãøt‹Sèπ
(&
myôî©‹
,
o
->
±r
,&
id
,&id,0);

2316 
öt64_t
 
numfõlds
;

2317 
found
 = 0;

2318 
°ªamID
 
ôem_id
;

2319 i‡(
	`°ªamIãøt‹GëID
(&
myôî©‹
,&
ôem_id
,&
numfõlds
)Ë
found
 = 1;

2320 
	`°ªamIãøt‹St›
(&
myôî©‹
);

2323 i‡(!
found
) ;

2326 
«ck
 = 
	`°ªamCª©eNACK
(
NULL
);

2327 
	`øxIn£π
(
group
->
≥l
,
buf
,(buf),
«ck
,
NULL
);

2330 i‡(
«ck
 !
øxNŸFound
) {

2337 i‡(
«ck
->
c⁄sumî
 && 
möidÀ
) {

2338 
m°ime_t
 
this_idÀ
 = 
now
 - 
«ck
->
dñivîy_time
;

2339 i‡(
this_idÀ
 < 
möidÀ
) ;

2344 i‡(
«ck
->
c⁄sumî
)

2345 
	`øxRemove
(
«ck
->
c⁄sumî
->
≥l
,
buf
,(buf),
NULL
);

2347 i‡(
c⁄sumî
 =
NULL
)

2348 
c⁄sumî
 = 
	`°ªamLookupC⁄sumî
(
group
,
c
->
¨gv
[3]->
±r
,
SLC_NONE
);

2349 
«ck
->
c⁄sumî
 = consumer;

2350 
«ck
->
dñivîy_time
 = 
dñivîytime
;

2353 i‡(
ªåycou¡
 >= 0) {

2354 
«ck
->
dñivîy_cou¡
 = 
ªåycou¡
;

2355 } i‡(!
ju°id
) {

2356 
«ck
->
dñivîy_cou¡
++;

2359 
	`øxIn£π
(
c⁄sumî
->
≥l
,
buf
,(buf),
«ck
,
NULL
);

2361 i‡(
ju°id
) {

2362 
	`addRïlySåómID
(
c
,&
id
);

2364 
size_t
 
emôãd
 = 
	`°ªamRïlyWôhR™ge
(
c
,
o
->
±r
,&
id
,&id,1,0,

2365 
NULL
,NULL,
STREAM_RWR_RAWENTRIES
,NULL);

2366 i‡(!
emôãd
Ë
	`addRïlyNuŒ
(
c
);

2368 
¨øyÀn
++;

2371 
	`°ªamPr›ag©eXCLAIM
(
c
,c->
¨gv
[1],
group
,c->¨gv[2],c->¨gv[
j
],
«ck
);

2372 
¥›ag©e_œ°_id
 = 0;

2373 
£rvî
.
dúty
++;

2376 i‡(
¥›ag©e_œ°_id
) {

2377 
	`°ªamPr›ag©eGroupID
(
c
,c->
¨gv
[1],
group
,c->argv[2]);

2378 
£rvî
.
dúty
++;

2380 
	`£tDe„ºedAºayLí
(
c
,
¨øyÀ≈å
,
¨øyÀn
);

2381 
	`¥evítComm™dPr›ag©i⁄
(
c
);

2382 
	}
}

2390 
	$xdñComm™d
(
˛õ¡
 *
c
) {

2391 
robj
 *
o
;

2393 i‡((
o
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL


2394 || 
	`checkTy≥
(
c
,
o
,
OBJ_STREAM
)) ;

2395 
°ªam
 *
s
 = 
o
->
±r
;

2400 
°ªamID
 
id
;

2401 
j
 = 2; j < 
c
->
¨gc
; j++) {

2402 i‡(
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[
j
],&
id
,0Ë!
C_OK
) ;

2406 
dñëed
 = 0;

2407 
j
 = 2; j < 
c
->
¨gc
; j++) {

2408 
	`°ªamP¨£Såi˘IDOrRïly
(
c
,c->
¨gv
[
j
],&
id
,0);

2409 
dñëed
 +
	`°ªamDñëeIãm
(
s
,&
id
);

2413 i‡(
dñëed
) {

2414 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

2415 
	`nŸifyKey•a˚Evít
(
NOTIFY_STREAM
,"xdñ",
c
->
¨gv
[1],c->
db
->
id
);

2416 
£rvî
.
dúty
 +
dñëed
;

2418 
	`addRïlyL⁄gL⁄g
(
c
,
dñëed
);

2419 
	}
}

2431 
	#TRIM_STRATEGY_NONE
 0

	)

2432 
	#TRIM_STRATEGY_MAXLEN
 1

	)

2433 
	$xåimComm™d
(
˛õ¡
 *
c
) {

2434 
robj
 *
o
;

2438 i‡((
o
 = 
	`lookupKeyWrôeOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL


2439 || 
	`checkTy≥
(
c
,
o
,
OBJ_STREAM
)) ;

2440 
°ªam
 *
s
 = 
o
->
±r
;

2443 
åim_°øãgy
 = 
TRIM_STRATEGY_NONE
;

2444 
maxÀn
 = -1;

2445 
≠¥ox_maxÀn
 = 0;

2447 
maxÀn_¨g_idx
 = 0;

2450 
i
 = 2;

2451 ; 
i
 < 
c
->
¨gc
; i++) {

2452 
m‹órgs
 = (
c
->
¨gc
-1Ë- 
i
;

2453 *
›t
 = 
c
->
¨gv
[
i
]->
±r
;

2454 i‡(!
	`°rˇ£cmp
(
›t
,"maxÀn"Ë&& 
m‹órgs
) {

2455 
≠¥ox_maxÀn
 = 0;

2456 
åim_°øãgy
 = 
TRIM_STRATEGY_MAXLEN
;

2457 *
√xt
 = 
c
->
¨gv
[
i
+1]->
±r
;

2459 i‡(
m‹órgs
 >2 && 
√xt
[0] == '~' &&Çext[1] == '\0') {

2460 
≠¥ox_maxÀn
 = 1;

2461 
i
++;

2462 } i‡(
m‹órgs
 >2 && 
√xt
[0] == '=' &&Çext[1] == '\0') {

2463 
i
++;

2465 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
i
+1],&
maxÀn
,
NULL
)

2466 !
C_OK
) ;

2468 i‡(
maxÀn
 < 0) {

2469 
	`addRïlyEº‹
(
c
,"The MAXLENárgument must be >= 0.");

2472 
i
++;

2473 
maxÀn_¨g_idx
 = 
i
;

2475 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2481 
öt64_t
 
dñëed
 = 0;

2482 i‡(
åim_°øãgy
 =
TRIM_STRATEGY_MAXLEN
) {

2483 
dñëed
 = 
	`°ªamTrimByLígth
(
s
,
maxÀn
,
≠¥ox_maxÀn
);

2485 
	`addRïlyEº‹
(
c
,"XTRIM called withoután optionÅoÅrimÅhe stream");

2490 i‡(
dñëed
) {

2491 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

2492 
	`nŸifyKey•a˚Evít
(
NOTIFY_STREAM
,"xåim",
c
->
¨gv
[1],c->
db
->
id
);

2493 
£rvî
.
dúty
 +
dñëed
;

2494 i‡(
≠¥ox_maxÀn
Ë
	`°ªamRewrôeAµroxMaxÀn
(
c
,
s
,
maxÀn_¨g_idx
);

2496 
	`addRïlyL⁄gL⁄g
(
c
,
dñëed
);

2497 
	}
}

2501 
	$xöfoRïlyWôhSåómInfo
(
˛õ¡
 *
c
, 
°ªam
 *
s
) {

2502 
fuŒ
 = 1;

2503 
cou¡
 = 10;

2504 
robj
 **
›tv
 = 
c
->
¨gv
 + 3;

2505 
›tc
 = 
c
->
¨gc
 - 3;

2508 i‡(
›tc
 == 0) {

2509 
fuŒ
 = 0;

2512 i‡(
›tc
 != 1 && optc != 3) {

2513 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

2518 i‡(
	`°rˇ£cmp
(
›tv
[0]->
±r
,"full")) {

2519 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

2523 i‡(
›tc
 == 3) {

2525 i‡(
	`°rˇ£cmp
(
›tv
[1]->
±r
,"count")) {

2526 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

2529 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,
›tv
[2],&
cou¡
,
NULL
Ë=
C_ERR
)

2531 i‡(
cou¡
 < 0) count = 10;

2535 
	`addRïlyM≠Lí
(
c
,
fuŒ
 ? 6 : 7);

2536 
	`addRïlyBulkCSåög
(
c
,"length");

2537 
	`addRïlyL⁄gL⁄g
(
c
,
s
->
Àngth
);

2538 
	`addRïlyBulkCSåög
(
c
,"radix-tree-keys");

2539 
	`addRïlyL⁄gL⁄g
(
c
,
	`øxSize
(
s
->
øx
));

2540 
	`addRïlyBulkCSåög
(
c
,"radix-tree-nodes");

2541 
	`addRïlyL⁄gL⁄g
(
c
,
s
->
øx
->
numnodes
);

2542 
	`addRïlyBulkCSåög
(
c
,"last-generated-id");

2543 
	`addRïlySåómID
(
c
,&
s
->
œ°_id
);

2545 i‡(!
fuŒ
) {

2548 
	`addRïlyBulkCSåög
(
c
,"groups");

2549 
	`addRïlyL⁄gL⁄g
(
c
,
s
->
cgroups
 ? 
	`øxSize
(s->cgroups) : 0);

2552 
emôãd
;

2553 
°ªamID
 
°¨t
, 
íd
;

2554 
°¨t
.
ms
 = sèπ.
£q
 = 0;

2555 
íd
.
ms
 =Énd.
£q
 = 
UINT64_MAX
;

2556 
	`addRïlyBulkCSåög
(
c
,"first-entry");

2557 
emôãd
 = 
	`°ªamRïlyWôhR™ge
(
c
,
s
,&
°¨t
,&
íd
,1,0,
NULL
,NULL,

2558 
STREAM_RWR_RAWENTRIES
,
NULL
);

2559 i‡(!
emôãd
Ë
	`addRïlyNuŒ
(
c
);

2560 
	`addRïlyBulkCSåög
(
c
,"last-entry");

2561 
emôãd
 = 
	`°ªamRïlyWôhR™ge
(
c
,
s
,&
°¨t
,&
íd
,1,1,
NULL
,NULL,

2562 
STREAM_RWR_RAWENTRIES
,
NULL
);

2563 i‡(!
emôãd
Ë
	`addRïlyNuŒ
(
c
);

2568 
	`addRïlyBulkCSåög
(
c
,"entries");

2569 
	`°ªamRïlyWôhR™ge
(
c
,
s
,
NULL
,NULL,
cou¡
,0,NULL,NULL,0,NULL);

2572 
	`addRïlyBulkCSåög
(
c
,"groups");

2573 i‡(
s
->
cgroups
 =
NULL
) {

2574 
	`addRïlyAºayLí
(
c
,0);

2576 
	`addRïlyAºayLí
(
c
,
	`øxSize
(
s
->
cgroups
));

2577 
øxIãøt‹
 
ri_cgroups
;

2578 
	`øxSèπ
(&
ri_cgroups
,
s
->
cgroups
);

2579 
	`øxSìk
(&
ri_cgroups
,"^",
NULL
,0);

2580 
	`øxNext
(&
ri_cgroups
)) {

2581 
°ªamCG
 *
cg
 = 
ri_cgroups
.
d©a
;

2582 
	`addRïlyM≠Lí
(
c
,5);

2585 
	`addRïlyBulkCSåög
(
c
,"name");

2586 
	`addRïlyBulkCBuf„r
(
c
,
ri_cgroups
.
key
,ri_cgroups.
key_Àn
);

2589 
	`addRïlyBulkCSåög
(
c
,"last-delivered-id");

2590 
	`addRïlySåómID
(
c
,&
cg
->
œ°_id
);

2593 
	`addRïlyBulkCSåög
(
c
,"pel-count");

2594 
	`addRïlyL⁄gL⁄g
(
c
,
	`øxSize
(
cg
->
≥l
));

2597 
	`addRïlyBulkCSåög
(
c
,"pending");

2598 
¨øyÀn_cg_≥l
 = 0;

2599 *
¨øy±r_cg_≥l
 = 
	`addRïlyDe„ºedLí
(
c
);

2600 
øxIãøt‹
 
ri_cg_≥l
;

2601 
	`øxSèπ
(&
ri_cg_≥l
,
cg
->
≥l
);

2602 
	`øxSìk
(&
ri_cg_≥l
,"^",
NULL
,0);

2603 
	`øxNext
(&
ri_cg_≥l
Ë&& (!
cou¡
 || 
¨øyÀn_cg_≥l
 < count)) {

2604 
°ªamNACK
 *
«ck
 = 
ri_cg_≥l
.
d©a
;

2605 
	`addRïlyAºayLí
(
c
,4);

2608 
°ªamID
 
id
;

2609 
	`°ªamDecodeID
(
ri_cg_≥l
.
key
,&
id
);

2610 
	`addRïlySåómID
(
c
,&
id
);

2613 
	`addRïlyBulkCBuf„r
(
c
,
«ck
->
c⁄sumî
->
«me
,

2614 
	`sd¶í
(
«ck
->
c⁄sumî
->
«me
));

2617 
	`addRïlyL⁄gL⁄g
(
c
,
«ck
->
dñivîy_time
);

2620 
	`addRïlyL⁄gL⁄g
(
c
,
«ck
->
dñivîy_cou¡
);

2622 
¨øyÀn_cg_≥l
++;

2624 
	`£tDe„ºedAºayLí
(
c
,
¨øy±r_cg_≥l
,
¨øyÀn_cg_≥l
);

2625 
	`øxSt›
(&
ri_cg_≥l
);

2628 
	`addRïlyBulkCSåög
(
c
,"consumers");

2629 
	`addRïlyAºayLí
(
c
,
	`øxSize
(
cg
->
c⁄sumîs
));

2630 
øxIãøt‹
 
ri_c⁄sumîs
;

2631 
	`øxSèπ
(&
ri_c⁄sumîs
,
cg
->
c⁄sumîs
);

2632 
	`øxSìk
(&
ri_c⁄sumîs
,"^",
NULL
,0);

2633 
	`øxNext
(&
ri_c⁄sumîs
)) {

2634 
°ªamC⁄sumî
 *
c⁄sumî
 = 
ri_c⁄sumîs
.
d©a
;

2635 
	`addRïlyM≠Lí
(
c
,4);

2638 
	`addRïlyBulkCSåög
(
c
,"name");

2639 
	`addRïlyBulkCBuf„r
(
c
,
c⁄sumî
->
«me
,
	`sd¶í
(consumer->name));

2642 
	`addRïlyBulkCSåög
(
c
,"seen-time");

2643 
	`addRïlyL⁄gL⁄g
(
c
,
c⁄sumî
->
£í_time
);

2646 
	`addRïlyBulkCSåög
(
c
,"pel-count");

2647 
	`addRïlyL⁄gL⁄g
(
c
,
	`øxSize
(
c⁄sumî
->
≥l
));

2650 
	`addRïlyBulkCSåög
(
c
,"pending");

2651 
¨øyÀn_˝ñ
 = 0;

2652 *
¨øy±r_˝ñ
 = 
	`addRïlyDe„ºedLí
(
c
);

2653 
øxIãøt‹
 
ri_˝ñ
;

2654 
	`øxSèπ
(&
ri_˝ñ
,
c⁄sumî
->
≥l
);

2655 
	`øxSìk
(&
ri_˝ñ
,"^",
NULL
,0);

2656 
	`øxNext
(&
ri_˝ñ
Ë&& (!
cou¡
 || 
¨øyÀn_˝ñ
 < count)) {

2657 
°ªamNACK
 *
«ck
 = 
ri_˝ñ
.
d©a
;

2658 
	`addRïlyAºayLí
(
c
,3);

2661 
°ªamID
 
id
;

2662 
	`°ªamDecodeID
(
ri_˝ñ
.
key
,&
id
);

2663 
	`addRïlySåómID
(
c
,&
id
);

2666 
	`addRïlyL⁄gL⁄g
(
c
,
«ck
->
dñivîy_time
);

2669 
	`addRïlyL⁄gL⁄g
(
c
,
«ck
->
dñivîy_cou¡
);

2671 
¨øyÀn_˝ñ
++;

2673 
	`£tDe„ºedAºayLí
(
c
,
¨øy±r_˝ñ
,
¨øyÀn_˝ñ
);

2674 
	`øxSt›
(&
ri_˝ñ
);

2676 
	`øxSt›
(&
ri_c⁄sumîs
);

2678 
	`øxSt›
(&
ri_cgroups
);

2681 
	}
}

2687 
	$xöfoComm™d
(
˛õ¡
 *
c
) {

2688 c⁄° *
hñp
[] = {

2697 
NULL


2699 
°ªam
 *
s
 = 
NULL
;

2700 *
›t
;

2701 
robj
 *
key
;

2704 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"HELP")) {

2705 
	`addRïlyHñp
(
c
, 
hñp
);

2707 } i‡(
c
->
¨gc
 < 3) {

2708 
	`addRïlyEº‹
(
c
,"syntaxÉrror,Åry 'XINFO HELP'");

2714 
›t
 = 
c
->
¨gv
[1]->
±r
;

2715 
key
 = 
c
->
¨gv
[2];

2718 
robj
 *
o
 = 
	`lookupKeyWrôeOrRïly
(
c
,
key
,
sh¨ed
.
nokeyîr
);

2719 i‡(
o
 =
NULL
 || 
	`checkTy≥
(
c
,o,
OBJ_STREAM
)) ;

2720 
s
 = 
o
->
±r
;

2723 i‡(!
	`°rˇ£cmp
(
›t
,"CONSUMERS"Ë&& 
c
->
¨gc
 == 4) {

2725 
°ªamCG
 *
cg
 = 
	`°ªamLookupCG
(
s
,
c
->
¨gv
[3]->
±r
);

2726 i‡(
cg
 =
NULL
) {

2727 
	`addRïlyEº‹F‹m©
(
c
, "-NOGROUP No such consumer group '%s' "

2729 (*)
c
->
¨gv
[3]->
±r
, (*)
key
->ptr);

2733 
	`addRïlyAºayLí
(
c
,
	`øxSize
(
cg
->
c⁄sumîs
));

2734 
øxIãøt‹
 
ri
;

2735 
	`øxSèπ
(&
ri
,
cg
->
c⁄sumîs
);

2736 
	`øxSìk
(&
ri
,"^",
NULL
,0);

2737 
m°ime_t
 
now
 = 
	`m°ime
();

2738 
	`øxNext
(&
ri
)) {

2739 
°ªamC⁄sumî
 *
c⁄sumî
 = 
ri
.
d©a
;

2740 
m°ime_t
 
idÀ
 = 
now
 - 
c⁄sumî
->
£í_time
;

2741 i‡(
idÀ
 < 0) idle = 0;

2743 
	`addRïlyM≠Lí
(
c
,3);

2744 
	`addRïlyBulkCSåög
(
c
,"name");

2745 
	`addRïlyBulkCBuf„r
(
c
,
c⁄sumî
->
«me
,
	`sd¶í
(consumer->name));

2746 
	`addRïlyBulkCSåög
(
c
,"pending");

2747 
	`addRïlyL⁄gL⁄g
(
c
,
	`øxSize
(
c⁄sumî
->
≥l
));

2748 
	`addRïlyBulkCSåög
(
c
,"idle");

2749 
	`addRïlyL⁄gL⁄g
(
c
,
idÀ
);

2751 
	`øxSt›
(&
ri
);

2752 } i‡(!
	`°rˇ£cmp
(
›t
,"GROUPS"Ë&& 
c
->
¨gc
 == 3) {

2754 i‡(
s
->
cgroups
 =
NULL
) {

2755 
	`addRïlyAºayLí
(
c
,0);

2759 
	`addRïlyAºayLí
(
c
,
	`øxSize
(
s
->
cgroups
));

2760 
øxIãøt‹
 
ri
;

2761 
	`øxSèπ
(&
ri
,
s
->
cgroups
);

2762 
	`øxSìk
(&
ri
,"^",
NULL
,0);

2763 
	`øxNext
(&
ri
)) {

2764 
°ªamCG
 *
cg
 = 
ri
.
d©a
;

2765 
	`addRïlyM≠Lí
(
c
,4);

2766 
	`addRïlyBulkCSåög
(
c
,"name");

2767 
	`addRïlyBulkCBuf„r
(
c
,
ri
.
key
,ri.
key_Àn
);

2768 
	`addRïlyBulkCSåög
(
c
,"consumers");

2769 
	`addRïlyL⁄gL⁄g
(
c
,
	`øxSize
(
cg
->
c⁄sumîs
));

2770 
	`addRïlyBulkCSåög
(
c
,"pending");

2771 
	`addRïlyL⁄gL⁄g
(
c
,
	`øxSize
(
cg
->
≥l
));

2772 
	`addRïlyBulkCSåög
(
c
,"last-delivered-id");

2773 
	`addRïlySåómID
(
c
,&
cg
->
œ°_id
);

2775 
	`øxSt›
(&
ri
);

2776 } i‡(!
	`°rˇ£cmp
(
›t
,"STREAM")) {

2778 
	`xöfoRïlyWôhSåómInfo
(
c
,
s
);

2780 
	`addRïlySubcomm™dSy¡axEº‹
(
c
);

2782 
	}
}

	@t_string.c

30 
	~"£rvî.h
"

31 
	~<m©h.h
>

37 
	$checkSåögLígth
(
˛õ¡
 *
c
, 
size
) {

38 i‡(
size
 > 512*1024*1024) {

39 
	`addRïlyEº‹
(
c
,"stringÉxceeds maximumállowed size (512MB)");

40  
C_ERR
;

42  
C_OK
;

43 
	}
}

61 
	#OBJ_SET_NO_FLAGS
 0

	)

62 
	#OBJ_SET_NX
 (1<<0Ë

	)

63 
	#OBJ_SET_XX
 (1<<1Ë

	)

64 
	#OBJ_SET_EX
 (1<<2Ë

	)

65 
	#OBJ_SET_PX
 (1<<3Ë

	)

66 
	#OBJ_SET_KEEPTTL
 (1<<4Ë

	)

68 
	$£tGíîicComm™d
(
˛õ¡
 *
c
, 
Êags
, 
robj
 *
key
,Ñobj *
vÆ
,Ñobj *
expúe
, 
unô
,Ñobj *
ok_ª∂y
,Ñobj *
ab‹t_ª∂y
) {

69 
mûli£c⁄ds
 = 0;

71 i‡(
expúe
) {

72 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
, 
expúe
, &
mûli£c⁄ds
, 
NULL
Ë!
C_OK
)

74 i‡(
mûli£c⁄ds
 <= 0) {

75 
	`addRïlyEº‹F‹m©
(
c
,"övÆidÉxpúêtimêö %s",c->
cmd
->
«me
);

78 i‡(
unô
 =
UNIT_SECONDS
Ë
mûli£c⁄ds
 *= 1000;

81 i‡((
Êags
 & 
OBJ_SET_NX
 && 
	`lookupKeyWrôe
(
c
->
db
,
key
Ë!
NULL
) ||

82 (
Êags
 & 
OBJ_SET_XX
 && 
	`lookupKeyWrôe
(
c
->
db
,
key
Ë=
NULL
))

84 
	`addRïly
(
c
, 
ab‹t_ª∂y
 ?áb‹t_ª∂y : 
sh¨ed
.
nuŒ
[c->
ª•
]);

87 
	`Ârötf
(
°dout
, "hello\n");

88 
	`Ârötf
(
°dout
, "sizeof(°ru˘ sdshdr5):%ld\n", (
sdshdr5
));

89 
	`gíîicSëKey
(
c
,c->
db
,
key
,
vÆ
,
Êags
 & 
OBJ_SET_KEEPTTL
,1);

128 
£rvî
.
dúty
++;

129 i‡(
expúe
Ë
	`£tExpúe
(
c
,c->
db
,
key
,
	`m°ime
()+
mûli£c⁄ds
);

130 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"£t",
key
,
c
->
db
->
id
);

131 i‡(
expúe
Ë
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,

132 "expúe",
key
,
c
->
db
->
id
);

133 
	`addRïly
(
c
, 
ok_ª∂y
 ? ok_ª∂y : 
sh¨ed
.
ok
);

134 
	}
}

137 
	$£tComm™d
(
˛õ¡
 *
c
) {

138 
j
;

139 
robj
 *
expúe
 = 
NULL
;

140 
unô
 = 
UNIT_SECONDS
;

141 
Êags
 = 
OBJ_SET_NO_FLAGS
;

143 
j
 = 3; j < 
c
->
¨gc
; j++) {

144 *
a
 = 
c
->
¨gv
[
j
]->
±r
;

145 
robj
 *
√xt
 = (
j
 =
c
->
¨gc
-1Ë? 
NULL
 : c->
¨gv
[j+1];

147 i‡((
a
[0] == 'n' ||á[0] == 'N') &&

148 (
a
[1] == 'x' ||á[1] == 'X') &&á[2] == '\0' &&

149 !(
Êags
 & 
OBJ_SET_XX
))

151 
Êags
 |
OBJ_SET_NX
;

152 } i‡((
a
[0] == 'x' ||á[0] == 'X') &&

153 (
a
[1] == 'x' ||á[1] == 'X') &&á[2] == '\0' &&

154 !(
Êags
 & 
OBJ_SET_NX
))

156 
Êags
 |
OBJ_SET_XX
;

157 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"KEEPTTL") &&

158 !(
Êags
 & 
OBJ_SET_EX
Ë&& !(Êag†& 
OBJ_SET_PX
))

160 
Êags
 |
OBJ_SET_KEEPTTL
;

161 } i‡((
a
[0] == 'e' ||á[0] == 'E') &&

162 (
a
[1] == 'x' ||á[1] == 'X') &&á[2] == '\0' &&

163 !(
Êags
 & 
OBJ_SET_KEEPTTL
) &&

164 !(
Êags
 & 
OBJ_SET_PX
Ë&& 
√xt
)

166 
Êags
 |
OBJ_SET_EX
;

167 
unô
 = 
UNIT_SECONDS
;

168 
expúe
 = 
√xt
;

169 
j
++;

170 } i‡((
a
[0] == 'p' ||á[0] == 'P') &&

171 (
a
[1] == 'x' ||á[1] == 'X') &&á[2] == '\0' &&

172 !(
Êags
 & 
OBJ_SET_KEEPTTL
) &&

173 !(
Êags
 & 
OBJ_SET_EX
Ë&& 
√xt
)

175 
Êags
 |
OBJ_SET_PX
;

176 
unô
 = 
UNIT_MILLISECONDS
;

177 
expúe
 = 
√xt
;

178 
j
++;

180 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

185 
c
->
¨gv
[2] = 
	`åyObje˘Encodög
(c->argv[2]);

186 
	`£tGíîicComm™d
(
c
,
Êags
,c->
¨gv
[1],c->¨gv[2],
expúe
,
unô
,
NULL
,NULL);

187 
	}
}

189 
	$£äxComm™d
(
˛õ¡
 *
c
) {

190 
c
->
¨gv
[2] = 
	`åyObje˘Encodög
(c->argv[2]);

191 
	`£tGíîicComm™d
(
c
,
OBJ_SET_NX
,c->
¨gv
[1],c->¨gv[2],
NULL
,0,
sh¨ed
.
c⁄e
,sh¨ed.
czîo
);

192 
	}
}

194 
	$£ãxComm™d
(
˛õ¡
 *
c
) {

195 
c
->
¨gv
[3] = 
	`åyObje˘Encodög
(c->argv[3]);

196 
	`£tGíîicComm™d
(
c
,
OBJ_SET_NO_FLAGS
,c->
¨gv
[1],c->¨gv[3],c->¨gv[2],
UNIT_SECONDS
,
NULL
,NULL);

197 
	}
}

199 
	$p£ãxComm™d
(
˛õ¡
 *
c
) {

200 
c
->
¨gv
[3] = 
	`åyObje˘Encodög
(c->argv[3]);

201 
	`£tGíîicComm™d
(
c
,
OBJ_SET_NO_FLAGS
,c->
¨gv
[1],c->¨gv[3],c->¨gv[2],
UNIT_MILLISECONDS
,
NULL
,NULL);

202 
	}
}

204 
	$gëGíîicComm™d
(
˛õ¡
 *
c
) {

205 
robj
 *
o
;

207 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
nuŒ
[c->
ª•
])Ë=
NULL
)

208  
C_OK
;

210 i‡(
o
->
ty≥
 !
OBJ_STRING
) {

211 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

212  
C_ERR
;

214 
	`addRïlyBulk
(
c
,
o
);

215  
C_OK
;

217 
	}
}

219 
	$gëComm™d
(
˛õ¡
 *
c
) {

220 
	`gëGíîicComm™d
(
c
);

221 
	}
}

223 
	$gë£tComm™d
(
˛õ¡
 *
c
) {

224 i‡(
	`gëGíîicComm™d
(
c
Ë=
C_ERR
) ;

225 
c
->
¨gv
[2] = 
	`åyObje˘Encodög
(c->argv[2]);

226 
	`£tKey
(
c
,c->
db
,c->
¨gv
[1],c->argv[2]);

227 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"£t",
c
->
¨gv
[1],c->
db
->
id
);

228 
£rvî
.
dúty
++;

229 
	}
}

231 
	$£å™geComm™d
(
˛õ¡
 *
c
) {

232 
robj
 *
o
;

233 
off£t
;

234 
sds
 
vÆue
 = 
c
->
¨gv
[3]->
±r
;

236 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
off£t
,
NULL
Ë!
C_OK
)

239 i‡(
off£t
 < 0) {

240 
	`addRïlyEº‹
(
c
,"offset is out ofÑange");

244 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

245 i‡(
o
 =
NULL
) {

247 i‡(
	`sd¶í
(
vÆue
) == 0) {

248 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

253 i‡(
	`checkSåögLígth
(
c
,
off£t
+
	`sd¶í
(
vÆue
)Ë!
C_OK
)

256 
o
 = 
	`¸óãObje˘
(
OBJ_STRING
,
	`sd¢ewÀn
(
NULL
, 
off£t
+
	`sd¶í
(
vÆue
)));

257 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],
o
);

259 
size_t
 
ﬁí
;

262 i‡(
	`checkTy≥
(
c
,
o
,
OBJ_STRING
))

266 
ﬁí
 = 
	`°rögObje˘Lí
(
o
);

267 i‡(
	`sd¶í
(
vÆue
) == 0) {

268 
	`addRïlyL⁄gL⁄g
(
c
,
ﬁí
);

273 i‡(
	`checkSåögLígth
(
c
,
off£t
+
	`sd¶í
(
vÆue
)Ë!
C_OK
)

277 
o
 = 
	`dbUnsh¨eSåögVÆue
(
c
->
db
,c->
¨gv
[1],o);

280 i‡(
	`sd¶í
(
vÆue
) > 0) {

281 
o
->
±r
 = 
	`sdsgrowzîo
(o->±r,
off£t
+
	`sd¶í
(
vÆue
));

282 
	`mem˝y
((*)
o
->
±r
+
off£t
,
vÆue
,
	`sd¶í
(value));

283 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

284 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,

285 "£å™ge",
c
->
¨gv
[1],c->
db
->
id
);

286 
£rvî
.
dúty
++;

288 
	`addRïlyL⁄gL⁄g
(
c
,
	`sd¶í
(
o
->
±r
));

289 
	}
}

291 
	$gëøngeComm™d
(
˛õ¡
 *
c
) {

292 
robj
 *
o
;

293 
°¨t
, 
íd
;

294 *
°r
, 
Œbuf
[32];

295 
size_t
 
°æí
;

297 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
°¨t
,
NULL
Ë!
C_OK
)

299 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
íd
,
NULL
Ë!
C_OK
)

301 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
em±ybulk
)Ë=
NULL
 ||

302 
	`checkTy≥
(
c
,
o
,
OBJ_STRING
)) ;

304 i‡(
o
->
ícodög
 =
OBJ_ENCODING_INT
) {

305 
°r
 = 
Œbuf
;

306 
°æí
 = 
	`Œ2°rög
(
Œbuf
,÷lbuf),()
o
->
±r
);

308 
°r
 = 
o
->
±r
;

309 
°æí
 = 
	`sd¶í
(
°r
);

313 i‡(
°¨t
 < 0 && 
íd
 < 0 && start >Énd) {

314 
	`addRïly
(
c
,
sh¨ed
.
em±ybulk
);

317 i‡(
°¨t
 < 0Ë°¨à
°æí
+start;

318 i‡(
íd
 < 0Ëíd = 
°æí
+end;

319 i‡(
°¨t
 < 0) start = 0;

320 i‡(
íd
 < 0)Énd = 0;

321 i‡(()
íd
 >
°æí
)Énd = strlen-1;

325 i‡(
°¨t
 > 
íd
 || 
°æí
 == 0) {

326 
	`addRïly
(
c
,
sh¨ed
.
em±ybulk
);

328 
	`addRïlyBulkCBuf„r
(
c
,(*)
°r
+
°¨t
,
íd
-start+1);

330 
	}
}

332 
	$mgëComm™d
(
˛õ¡
 *
c
) {

333 
j
;

335 
	`addRïlyAºayLí
(
c
,c->
¨gc
-1);

336 
j
 = 1; j < 
c
->
¨gc
; j++) {

337 
robj
 *
o
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
j
]);

338 i‡(
o
 =
NULL
) {

339 
	`addRïlyNuŒ
(
c
);

341 i‡(
o
->
ty≥
 !
OBJ_STRING
) {

342 
	`addRïlyNuŒ
(
c
);

344 
	`addRïlyBulk
(
c
,
o
);

348 
	}
}

350 
	$m£tGíîicComm™d
(
˛õ¡
 *
c
, 
nx
) {

351 
j
;

353 i‡((
c
->
¨gc
 % 2) == 0) {

354 
	`addRïlyEº‹
(
c
,"wrongÇumber ofárguments for MSET");

360 i‡(
nx
) {

361 
j
 = 1; j < 
c
->
¨gc
; j += 2) {

362 i‡(
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[
j
]Ë!
NULL
) {

363 
	`addRïly
(
c
, 
sh¨ed
.
czîo
);

369 
j
 = 1; j < 
c
->
¨gc
; j += 2) {

370 
c
->
¨gv
[
j
+1] = 
	`åyObje˘Encodög
(c->argv[j+1]);

371 
	`£tKey
(
c
,c->
db
,c->
¨gv
[
j
],c->argv[j+1]);

372 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"£t",
c
->
¨gv
[
j
],c->
db
->
id
);

374 
£rvî
.
dúty
 +(
c
->
¨gc
-1)/2;

375 
	`addRïly
(
c
, 
nx
 ? 
sh¨ed
.
c⁄e
 : sh¨ed.
ok
);

376 
	}
}

378 
	$m£tComm™d
(
˛õ¡
 *
c
) {

379 
	`m£tGíîicComm™d
(
c
,0);

380 
	}
}

382 
	$m£äxComm™d
(
˛õ¡
 *
c
) {

383 
	`m£tGíîicComm™d
(
c
,1);

384 
	}
}

386 
	$ö¸De¸Comm™d
(
˛õ¡
 *
c
, 
ö¸
) {

387 
vÆue
, 
ﬁdvÆue
;

388 
robj
 *
o
, *
√w
;

390 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

391 i‡(
o
 !
NULL
 && 
	`checkTy≥
(
c
,o,
OBJ_STRING
)) ;

392 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,
o
,&
vÆue
,
NULL
Ë!
C_OK
) ;

394 
ﬁdvÆue
 = 
vÆue
;

395 i‡((
ö¸
 < 0 && 
ﬁdvÆue
 < 0 && in¸ < (
LLONG_MIN
-oldvalue)) ||

396 (
ö¸
 > 0 && 
ﬁdvÆue
 > 0 && in¸ > (
LLONG_MAX
-oldvalue))) {

397 
	`addRïlyEº‹
(
c
,"increment or decrement would overflow");

400 
vÆue
 +
ö¸
;

402 i‡(
o
 && o->
ªfcou¡
 =1 && o->
ícodög
 =
OBJ_ENCODING_INT
 &&

403 (
vÆue
 < 0 || vÆuê>
OBJ_SHARED_INTEGERS
) &&

404 
vÆue
 >
LONG_MIN
 && vÆuê<
LONG_MAX
)

406 
√w
 = 
o
;

407 
o
->
±r
 = (*)(()
vÆue
);

409 
√w
 = 
	`¸óãSåögObje˘FromL⁄gL⁄gF‹VÆue
(
vÆue
);

410 i‡(
o
) {

411 
	`dbOvîwrôe
(
c
->
db
,c->
¨gv
[1],
√w
);

413 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],
√w
);

416 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

417 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"ö¸by",
c
->
¨gv
[1],c->
db
->
id
);

418 
£rvî
.
dúty
++;

419 
	`addRïly
(
c
,
sh¨ed
.
cﬁ⁄
);

420 
	`addRïly
(
c
,
√w
);

421 
	`addRïly
(
c
,
sh¨ed
.
¸lf
);

422 
	}
}

424 
	$ö¸Comm™d
(
˛õ¡
 *
c
) {

425 
	`ö¸De¸Comm™d
(
c
,1);

426 
	}
}

428 
	$de¸Comm™d
(
˛õ¡
 *
c
) {

429 
	`ö¸De¸Comm™d
(
c
,-1);

430 
	}
}

432 
	$ö¸byComm™d
(
˛õ¡
 *
c
) {

433 
ö¸
;

435 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
ö¸
, 
NULL
Ë!
C_OK
) ;

436 
	`ö¸De¸Comm™d
(
c
,
ö¸
);

437 
	}
}

439 
	$de¸byComm™d
(
˛õ¡
 *
c
) {

440 
ö¸
;

442 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
ö¸
, 
NULL
Ë!
C_OK
) ;

443 
	`ö¸De¸Comm™d
(
c
,-
ö¸
);

444 
	}
}

446 
	$ö¸byÊﬂtComm™d
(
˛õ¡
 *
c
) {

447 
ö¸
, 
vÆue
;

448 
robj
 *
o
, *
√w
, *
aux1
, *
aux2
;

450 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

451 i‡(
o
 !
NULL
 && 
	`checkTy≥
(
c
,o,
OBJ_STRING
)) ;

452 i‡(
	`gëL⁄gDoubÀFromObje˘OrRïly
(
c
,
o
,&
vÆue
,
NULL
Ë!
C_OK
 ||

453 
	`gëL⁄gDoubÀFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
ö¸
,
NULL
Ë!
C_OK
)

456 
vÆue
 +
ö¸
;

457 i‡(
	`i¢™
(
vÆue
Ë|| 
	`isöf
(value)) {

458 
	`addRïlyEº‹
(
c
,"increment wouldÖroduce NaN or Infinity");

461 
√w
 = 
	`¸óãSåögObje˘FromL⁄gDoubÀ
(
vÆue
,1);

462 i‡(
o
)

463 
	`dbOvîwrôe
(
c
->
db
,c->
¨gv
[1],
√w
);

465 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],
√w
);

466 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

467 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"ö¸byÊﬂt",
c
->
¨gv
[1],c->
db
->
id
);

468 
£rvî
.
dúty
++;

469 
	`addRïlyBulk
(
c
,
√w
);

474 
aux1
 = 
	`¸óãSåögObje˘
("SET",3);

475 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,0,
aux1
);

476 
	`de¸RefCou¡
(
aux1
);

477 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,2,
√w
);

478 
aux2
 = 
	`¸óãSåögObje˘
("KEEPTTL",7);

479 
	`ªwrôeClõ¡Comm™dArgumít
(
c
,3,
aux2
);

480 
	`de¸RefCou¡
(
aux2
);

481 
	}
}

483 
	$≠≥ndComm™d
(
˛õ¡
 *
c
) {

484 
size_t
 
tŸÀn
;

485 
robj
 *
o
, *
≠≥nd
;

487 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[1]);

488 i‡(
o
 =
NULL
) {

490 
c
->
¨gv
[2] = 
	`åyObje˘Encodög
(c->argv[2]);

491 
	`dbAdd
(
c
->
db
,c->
¨gv
[1],c->argv[2]);

492 
	`ö¸RefCou¡
(
c
->
¨gv
[2]);

493 
tŸÀn
 = 
	`°rögObje˘Lí
(
c
->
¨gv
[2]);

496 i‡(
	`checkTy≥
(
c
,
o
,
OBJ_STRING
))

500 
≠≥nd
 = 
c
->
¨gv
[2];

501 
tŸÀn
 = 
	`°rögObje˘Lí
(
o
)+
	`sd¶í
(
≠≥nd
->
±r
);

502 i‡(
	`checkSåögLígth
(
c
,
tŸÀn
Ë!
C_OK
)

506 
o
 = 
	`dbUnsh¨eSåögVÆue
(
c
->
db
,c->
¨gv
[1],o);

507 
o
->
±r
 = 
	`sdsˇéí
(o->±r,
≠≥nd
->±r,
	`sd¶í
(append->ptr));

508 
tŸÀn
 = 
	`sd¶í
(
o
->
±r
);

510 
	`sig«lModifõdKey
(
c
,c->
db
,c->
¨gv
[1]);

511 
	`nŸifyKey•a˚Evít
(
NOTIFY_STRING
,"≠≥nd",
c
->
¨gv
[1],c->
db
->
id
);

512 
£rvî
.
dúty
++;

513 
	`addRïlyL⁄gL⁄g
(
c
,
tŸÀn
);

514 
	}
}

516 
	$°æíComm™d
(
˛õ¡
 *
c
) {

517 
robj
 *
o
;

518 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
czîo
)Ë=
NULL
 ||

519 
	`checkTy≥
(
c
,
o
,
OBJ_STRING
)) ;

520 
	`addRïlyL⁄gL⁄g
(
c
,
	`°rögObje˘Lí
(
o
));

521 
	}
}

527 
°ølgoLCS
(
˛õ¡
 *
c
);

528 
	$°ølgoComm™d
(
˛õ¡
 *
c
) {

530 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[1]->
±r
,"lcs")) {

531 
	`°ølgoLCS
(
c
);

533 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

535 
	}
}

540 
	$°ølgoLCS
(
˛õ¡
 *
c
) {

541 
uöt32_t
 
i
, 
j
;

542 
möm©chÀn
 = 0;

543 
sds
 
a
 = 
NULL
, 
b
 = NULL;

544 
gëÀn
 = 0, 
gëidx
 = 0, 
wôhm©chÀn
 = 0;

545 
robj
 *
obja
 = 
NULL
, *
objb
 = NULL;

547 
j
 = 2; j < (
uöt32_t
)
c
->
¨gc
; j++) {

548 *
›t
 = 
c
->
¨gv
[
j
]->
±r
;

549 
m‹órgs
 = (
c
->
¨gc
-1Ë- 
j
;

551 i‡(!
	`°rˇ£cmp
(
›t
,"IDX")) {

552 
gëidx
 = 1;

553 } i‡(!
	`°rˇ£cmp
(
›t
,"LEN")) {

554 
gëÀn
 = 1;

555 } i‡(!
	`°rˇ£cmp
(
›t
,"WITHMATCHLEN")) {

556 
wôhm©chÀn
 = 1;

557 } i‡(!
	`°rˇ£cmp
(
›t
,"MINMATCHLEN"Ë&& 
m‹órgs
) {

558 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[
j
+1],&
möm©chÀn
,
NULL
)

559 !
C_OK
) ;

560 i‡(
möm©chÀn
 < 0) minmatchlen = 0;

561 
j
++;

562 } i‡(!
	`°rˇ£cmp
(
›t
,"STRINGS")) {

563 i‡(
a
 !
NULL
) {

564 
	`addRïlyEº‹
(
c
,"Either use STRINGS or KEYS");

567 
a
 = 
c
->
¨gv
[
j
+1]->
±r
;

568 
b
 = 
c
->
¨gv
[
j
+2]->
±r
;

569 
j
 += 2;

570 } i‡(!
	`°rˇ£cmp
(
›t
,"KEYS")) {

571 i‡(
a
 !
NULL
) {

572 
	`addRïlyEº‹
(
c
,"Either use STRINGS or KEYS");

575 
obja
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
j
+1]);

576 
objb
 = 
	`lookupKeyRód
(
c
->
db
,c->
¨gv
[
j
+2]);

577 
obja
 = obj®? 
	`gëDecodedObje˘
(objaË: 
	`¸óãSåögObje˘
("",0);

578 
objb
 = objb ? 
	`gëDecodedObje˘
(objbË: 
	`¸óãSåögObje˘
("",0);

579 
a
 = 
obja
->
±r
;

580 
b
 = 
objb
->
±r
;

581 
j
 += 2;

583 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

589 i‡(
a
 =
NULL
) {

590 
	`addRïlyEº‹
(
c
,"Please specifyÅwo strings: "

593 } i‡(
gëÀn
 && 
gëidx
) {

594 
	`addRïlyEº‹
(
c
,

602 
uöt32_t
 
Æí
 = 
	`sd¶í
(
a
);

603 
uöt32_t
 
bÀn
 = 
	`sd¶í
(
b
);

608 
uöt32_t
 *
lcs
 = 
	`zmÆloc
((
Æí
+1)*(
bÀn
+1)*(uint32_t));

609 
	#LCS
(
A
,
B
Ë
lcs
[(B)+((A)*(
bÀn
+1))]

	)

612 
uöt32_t
 
i
 = 0; i <
Æí
; i++) {

613 
uöt32_t
 
j
 = 0; j <
bÀn
; j++) {

614 i‡(
i
 =0 || 
j
 == 0) {

617 
	`LCS
(
i
,
j
) = 0;

618 } i‡(
a
[
i
-1] =
b
[
j
-1]) {

623 
	`LCS
(
i
,
j
) = LCS(i-1,j-1)+1;

628 
uöt32_t
 
lcs1
 = 
	`LCS
(
i
-1,
j
);

629 
uöt32_t
 
lcs2
 = 
	`LCS
(
i
,
j
-1);

630 
	`LCS
(
i
,
j
Ë
lcs1
 > 
lcs2
 ?Ücs1 :Ücs2;

637 
uöt32_t
 
idx
 = 
	`LCS
(
Æí
,
bÀn
);

638 
sds
 
ªsu…
 = 
NULL
;

639 *
¨øyÀ≈å
 = 
NULL
;

640 
uöt32_t
 
¨™ge_°¨t
 = 
Æí
,

641 
¨™ge_íd
 = 0,

642 
bønge_°¨t
 = 0,

643 
bønge_íd
 = 0;

646 
compuãlcs
 = 
gëidx
 || !
gëÀn
;

647 i‡(
compuãlcs
Ë
ªsu…
 = 
	`sd¢ewÀn
(
SDS_NOINIT
,
idx
);

650 
uöt32_t
 
¨øyÀn
 = 0;

651 i‡(
gëidx
) {

652 
	`addRïlyM≠Lí
(
c
,2);

653 
	`addRïlyBulkCSåög
(
c
,"matches");

654 
¨øyÀ≈å
 = 
	`addRïlyDe„ºedLí
(
c
);

657 
i
 = 
Æí
, 
j
 = 
bÀn
;

658 
compuãlcs
 && 
i
 > 0 && 
j
 > 0) {

659 
emô_ønge
 = 0;

660 i‡(
a
[
i
-1] =
b
[
j
-1]) {

663 
ªsu…
[
idx
-1] = 
a
[
i
-1];

666 i‡(
¨™ge_°¨t
 =
Æí
) {

667 
¨™ge_°¨t
 = 
i
-1;

668 
¨™ge_íd
 = 
i
-1;

669 
bønge_°¨t
 = 
j
-1;

670 
bønge_íd
 = 
j
-1;

674 i‡(
¨™ge_°¨t
 =
i
 && 
bønge_°¨t
 =
j
) {

675 
¨™ge_°¨t
--;

676 
bønge_°¨t
--;

678 
emô_ønge
 = 1;

683 i‡(
¨™ge_°¨t
 =0 || 
bønge_°¨t
 =0Ë
emô_ønge
 = 1;

684 
idx
--; 
i
--; 
j
--;

688 
uöt32_t
 
lcs1
 = 
	`LCS
(
i
-1,
j
);

689 
uöt32_t
 
lcs2
 = 
	`LCS
(
i
,
j
-1);

690 i‡(
lcs1
 > 
lcs2
)

691 
i
--;

693 
j
--;

694 i‡(
¨™ge_°¨t
 !
Æí
Ë
emô_ønge
 = 1;

698 
uöt32_t
 
m©ch_Àn
 = 
¨™ge_íd
 - 
¨™ge_°¨t
 + 1;

699 i‡(
emô_ønge
) {

700 i‡(
möm©chÀn
 =0 || 
m©ch_Àn
 >= minmatchlen) {

701 i‡(
¨øyÀ≈å
) {

702 
	`addRïlyAºayLí
(
c
,2+
wôhm©chÀn
);

703 
	`addRïlyAºayLí
(
c
,2);

704 
	`addRïlyL⁄gL⁄g
(
c
,
¨™ge_°¨t
);

705 
	`addRïlyL⁄gL⁄g
(
c
,
¨™ge_íd
);

706 
	`addRïlyAºayLí
(
c
,2);

707 
	`addRïlyL⁄gL⁄g
(
c
,
bønge_°¨t
);

708 
	`addRïlyL⁄gL⁄g
(
c
,
bønge_íd
);

709 i‡(
wôhm©chÀn
Ë
	`addRïlyL⁄gL⁄g
(
c
,
m©ch_Àn
);

710 
¨øyÀn
++;

713 
¨™ge_°¨t
 = 
Æí
;

720 i‡(
¨øyÀ≈å
) {

721 
	`addRïlyBulkCSåög
(
c
,"len");

722 
	`addRïlyL⁄gL⁄g
(
c
,
	`LCS
(
Æí
,
bÀn
));

723 
	`£tDe„ºedAºayLí
(
c
,
¨øyÀ≈å
,
¨øyÀn
);

724 } i‡(
gëÀn
) {

725 
	`addRïlyL⁄gL⁄g
(
c
,
	`LCS
(
Æí
,
bÀn
));

727 
	`addRïlyBulkSds
(
c
,
ªsu…
);

728 
ªsu…
 = 
NULL
;

732 i‡(
obja
Ë
	`de¸RefCou¡
(obja);

733 i‡(
objb
Ë
	`de¸RefCou¡
(objb);

734 
	`sds‰ì
(
ªsu…
);

735 
	`z‰ì
(
lcs
);

737 
	}
}

	@t_zset.c

59 
	~"£rvî.h
"

60 
	~<m©h.h
>

66 
z¶LexVÆueGãMö
(
sds
 
vÆue
, 
zÀxønge•ec
 *
•ec
);

67 
z¶LexVÆueLãMax
(
sds
 
vÆue
, 
zÀxønge•ec
 *
•ec
);

71 
zskùli°Node
 *
	$z¶Cª©eNode
(
Àvñ
, 
sc‹e
, 
sds
 
ñe
) {

72 
zskùli°Node
 *
zn
 =

73 
	`zmÆloc
((*
zn
)+
Àvñ
*(
zskùli°Levñ
));

74 
zn
->
sc‹e
 = score;

75 
zn
->
ñe
 =Éle;

76  
zn
;

77 
	}
}

80 
zskùli°
 *
	$z¶Cª©e
() {

81 
j
;

82 
zskùli°
 *
z¶
;

84 
z¶
 = 
	`zmÆloc
((*zsl));

85 
z¶
->
Àvñ
 = 1;

86 
z¶
->
Àngth
 = 0;

87 
z¶
->
hódî
 = 
	`z¶Cª©eNode
(
ZSKIPLIST_MAXLEVEL
,0,
NULL
);

88 
j
 = 0; j < 
ZSKIPLIST_MAXLEVEL
; j++) {

89 
z¶
->
hódî
->
Àvñ
[
j
].
f‹w¨d
 = 
NULL
;

90 
z¶
->
hódî
->
Àvñ
[
j
].
•™
 = 0;

92 
z¶
->
hódî
->
backw¨d
 = 
NULL
;

93 
z¶
->
èû
 = 
NULL
;

94  
z¶
;

95 
	}
}

100 
	$z¶FªeNode
(
zskùli°Node
 *
node
) {

101 
	`sds‰ì
(
node
->
ñe
);

102 
	`z‰ì
(
node
);

103 
	}
}

106 
	$z¶Fªe
(
zskùli°
 *
z¶
) {

107 
zskùli°Node
 *
node
 = 
z¶
->
hódî
->
Àvñ
[0].
f‹w¨d
, *
√xt
;

109 
	`z‰ì
(
z¶
->
hódî
);

110 
node
) {

111 
√xt
 = 
node
->
Àvñ
[0].
f‹w¨d
;

112 
	`z¶FªeNode
(
node
);

113 
node
 = 
√xt
;

115 
	`z‰ì
(
z¶
);

116 
	}
}

122 
	$z¶R™domLevñ
() {

123 
Àvñ
 = 1;

124 (
	`øndom
()&0xFFFFË< (
ZSKIPLIST_P
 * 0xFFFF))

125 
Àvñ
 += 1;

126  (
Àvñ
<
ZSKIPLIST_MAXLEVEL
) ?Üevel : ZSKIPLIST_MAXLEVEL;

127 
	}
}

132 
zskùli°Node
 *
	$z¶In£π
(
zskùli°
 *
z¶
, 
sc‹e
, 
sds
 
ñe
) {

133 
zskùli°Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

134 
ønk
[
ZSKIPLIST_MAXLEVEL
];

135 
i
, 
Àvñ
;

137 
	`£rvîAs£π
(!
	`i¢™
(
sc‹e
));

138 
x
 = 
z¶
->
hódî
;

139 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

141 
ønk
[
i
] = i =(
z¶
->
Àvñ
-1) ? 0 :Ñank[i+1];

142 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

143 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 < score ||

144 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 == score &&

145 
	`sdscmp
(
x
->
Àvñ
[
i
].
f‹w¨d
->
ñe
,ele) < 0)))

147 
ønk
[
i
] +
x
->
Àvñ
[i].
•™
;

148 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

150 
upd©e
[
i
] = 
x
;

156 
Àvñ
 = 
	`z¶R™domLevñ
();

157 i‡(
Àvñ
 > 
z¶
->level) {

158 
i
 = 
z¶
->
Àvñ
; i <Üevel; i++) {

159 
ønk
[
i
] = 0;

160 
upd©e
[
i
] = 
z¶
->
hódî
;

161 
upd©e
[
i
]->
Àvñ
[i].
•™
 = 
z¶
->
Àngth
;

163 
z¶
->
Àvñ
 =Üevel;

165 
x
 = 
	`z¶Cª©eNode
(
Àvñ
,
sc‹e
,
ñe
);

166 
i
 = 0; i < 
Àvñ
; i++) {

167 
x
->
Àvñ
[
i
].
f‹w¨d
 = 
upd©e
[i]->level[i].forward;

168 
upd©e
[
i
]->
Àvñ
[i].
f‹w¨d
 = 
x
;

171 
x
->
Àvñ
[
i
].
•™
 = 
upd©e
[i]->Àvñ[i].•™ - (
ønk
[0] -Ñank[i]);

172 
upd©e
[
i
]->
Àvñ
[i].
•™
 = (
ønk
[0] -Ñank[i]) + 1;

176 
i
 = 
Àvñ
; i < 
z¶
->level; i++) {

177 
upd©e
[
i
]->
Àvñ
[i].
•™
++;

180 
x
->
backw¨d
 = (
upd©e
[0] =
z¶
->
hódî
Ë? 
NULL
 : update[0];

181 i‡(
x
->
Àvñ
[0].
f‹w¨d
)

182 
x
->
Àvñ
[0].
f‹w¨d
->
backw¨d
 = x;

184 
z¶
->
èû
 = 
x
;

185 
z¶
->
Àngth
++;

186  
x
;

187 
	}
}

191 
	$z¶DñëeNode
(
zskùli°
 *
z¶
, 
zskùli°Node
 *
x
, zskùli°Nodê**
upd©e
) {

192 
i
;

193 
i
 = 0; i < 
z¶
->
Àvñ
; i++) {

194 i‡(
upd©e
[
i
]->
Àvñ
[i].
f‹w¨d
 =
x
) {

195 
upd©e
[
i
]->
Àvñ
[i].
•™
 +
x
->level[i].span - 1;

196 
upd©e
[
i
]->
Àvñ
[i].
f‹w¨d
 = 
x
->level[i].forward;

198 
upd©e
[
i
]->
Àvñ
[i].
•™
 -= 1;

201 i‡(
x
->
Àvñ
[0].
f‹w¨d
) {

202 
x
->
Àvñ
[0].
f‹w¨d
->
backw¨d
 = x->backward;

204 
z¶
->
èû
 = 
x
->
backw¨d
;

206 
z¶
->
Àvñ
 > 1 && z¶->
hódî
->Àvñ[z¶->Àvñ-1].
f‹w¨d
 =
NULL
)

207 
z¶
->
Àvñ
--;

208 
z¶
->
Àngth
--;

209 
	}
}

219 
	$z¶Dñëe
(
zskùli°
 *
z¶
, 
sc‹e
, 
sds
 
ñe
, 
zskùli°Node
 **
node
) {

220 
zskùli°Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

221 
i
;

223 
x
 = 
z¶
->
hódî
;

224 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

225 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

226 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 < score ||

227 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 == score &&

228 
	`sdscmp
(
x
->
Àvñ
[
i
].
f‹w¨d
->
ñe
,ele) < 0)))

230 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

232 
upd©e
[
i
] = 
x
;

236 
x
 = x->
Àvñ
[0].
f‹w¨d
;

237 i‡(
x
 && 
sc‹e
 =x->sc‹ê&& 
	`sdscmp
(x->
ñe
,ele) == 0) {

238 
	`z¶DñëeNode
(
z¶
, 
x
, 
upd©e
);

239 i‡(!
node
)

240 
	`z¶FªeNode
(
x
);

242 *
node
 = 
x
;

246 
	}
}

259 
zskùli°Node
 *
	$z¶Upd©eSc‹e
(
zskùli°
 *
z¶
, 
cursc‹e
, 
sds
 
ñe
, 
√wsc‹e
) {

260 
zskùli°Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

261 
i
;

265 
x
 = 
z¶
->
hódî
;

266 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

267 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

268 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 < 
cursc‹e
 ||

269 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 =
cursc‹e
 &&

270 
	`sdscmp
(
x
->
Àvñ
[
i
].
f‹w¨d
->
ñe
,ele) < 0)))

272 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

274 
upd©e
[
i
] = 
x
;

279 
x
 = x->
Àvñ
[0].
f‹w¨d
;

280 
	`£rvîAs£π
(
x
 && 
cursc‹e
 =x->
sc‹e
 && 
	`sdscmp
(x->
ñe
,ele) == 0);

285 i‡((
x
->
backw¨d
 =
NULL
 || x->backw¨d->
sc‹e
 < 
√wsc‹e
) &&

286 (
x
->
Àvñ
[0].
f‹w¨d
 =
NULL
 || x->Àvñ[0].f‹w¨d->
sc‹e
 > 
√wsc‹e
))

288 
x
->
sc‹e
 = 
√wsc‹e
;

289  
x
;

294 
	`z¶DñëeNode
(
z¶
, 
x
, 
upd©e
);

295 
zskùli°Node
 *
√wnode
 = 
	`z¶In£π
(
z¶
,
√wsc‹e
,
x
->
ñe
);

298 
x
->
ñe
 = 
NULL
;

299 
	`z¶FªeNode
(
x
);

300  
√wnode
;

301 
	}
}

303 
	$z¶VÆueGãMö
(
vÆue
, 
zønge•ec
 *
•ec
) {

304  
•ec
->
möex
 ? (
vÆue
 > s≥c->
mö
) : (value >= spec->min);

305 
	}
}

307 
	$z¶VÆueLãMax
(
vÆue
, 
zønge•ec
 *
•ec
) {

308  
•ec
->
maxex
 ? (
vÆue
 < s≥c->
max
) : (value <= spec->max);

309 
	}
}

312 
	$z¶IsInR™ge
(
zskùli°
 *
z¶
, 
zønge•ec
 *
ønge
) {

313 
zskùli°Node
 *
x
;

316 i‡(
ønge
->
mö
 >Ñ™ge->
max
 ||

317 (
ønge
->
mö
 =ønge->
max
 && (ønge->
möex
 ||Ñ™ge->
maxex
)))

319 
x
 = 
z¶
->
èû
;

320 i‡(
x
 =
NULL
 || !
	`z¶VÆueGãMö
(x->
sc‹e
,
ønge
))

322 
x
 = 
z¶
->
hódî
->
Àvñ
[0].
f‹w¨d
;

323 i‡(
x
 =
NULL
 || !
	`z¶VÆueLãMax
(x->
sc‹e
,
ønge
))

326 
	}
}

330 
zskùli°Node
 *
	$z¶Fú°InR™ge
(
zskùli°
 *
z¶
, 
zønge•ec
 *
ønge
) {

331 
zskùli°Node
 *
x
;

332 
i
;

335 i‡(!
	`z¶IsInR™ge
(
z¶
,
ønge
)Ë 
NULL
;

337 
x
 = 
z¶
->
hódî
;

338 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

340 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

341 !
	`z¶VÆueGãMö
(
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
,
ønge
))

342 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

346 
x
 = x->
Àvñ
[0].
f‹w¨d
;

347 
	`£rvîAs£π
(
x
 !
NULL
);

350 i‡(!
	`z¶VÆueLãMax
(
x
->
sc‹e
,
ønge
)Ë 
NULL
;

351  
x
;

352 
	}
}

356 
zskùli°Node
 *
	$z¶La°InR™ge
(
zskùli°
 *
z¶
, 
zønge•ec
 *
ønge
) {

357 
zskùli°Node
 *
x
;

358 
i
;

361 i‡(!
	`z¶IsInR™ge
(
z¶
,
ønge
)Ë 
NULL
;

363 
x
 = 
z¶
->
hódî
;

364 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

366 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

367 
	`z¶VÆueLãMax
(
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
,
ønge
))

368 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

372 
	`£rvîAs£π
(
x
 !
NULL
);

375 i‡(!
	`z¶VÆueGãMö
(
x
->
sc‹e
,
ønge
)Ë 
NULL
;

376  
x
;

377 
	}
}

383 
	$z¶DñëeR™geBySc‹e
(
zskùli°
 *
z¶
, 
zønge•ec
 *
ønge
, 
di˘
 *dict) {

384 
zskùli°Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

385 
ªmoved
 = 0;

386 
i
;

388 
x
 = 
z¶
->
hódî
;

389 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

390 
x
->
Àvñ
[
i
].
f‹w¨d
 && (
ønge
->
möex
 ?

391 
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 <
ønge
->
mö
 :

392 
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 < 
ønge
->
mö
))

393 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

394 
upd©e
[
i
] = 
x
;

398 
x
 = x->
Àvñ
[0].
f‹w¨d
;

401 
x
 &&

402 (
ønge
->
maxex
 ? 
x
->
sc‹e
 <Ñ™ge->
max
 : x->score <=Ñange->max))

404 
zskùli°Node
 *
√xt
 = 
x
->
Àvñ
[0].
f‹w¨d
;

405 
	`z¶DñëeNode
(
z¶
,
x
,
upd©e
);

406 
	`di˘Dñëe
(
di˘
,
x
->
ñe
);

407 
	`z¶FªeNode
(
x
);

408 
ªmoved
++;

409 
x
 = 
√xt
;

411  
ªmoved
;

412 
	}
}

414 
	$z¶DñëeR™geByLex
(
zskùli°
 *
z¶
, 
zÀxønge•ec
 *
ønge
, 
di˘
 *dict) {

415 
zskùli°Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

416 
ªmoved
 = 0;

417 
i
;

420 
x
 = 
z¶
->
hódî
;

421 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

422 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

423 !
	`z¶LexVÆueGãMö
(
x
->
Àvñ
[
i
].
f‹w¨d
->
ñe
,
ønge
))

424 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

425 
upd©e
[
i
] = 
x
;

429 
x
 = x->
Àvñ
[0].
f‹w¨d
;

432 
x
 && 
	`z¶LexVÆueLãMax
(x->
ñe
,
ønge
)) {

433 
zskùli°Node
 *
√xt
 = 
x
->
Àvñ
[0].
f‹w¨d
;

434 
	`z¶DñëeNode
(
z¶
,
x
,
upd©e
);

435 
	`di˘Dñëe
(
di˘
,
x
->
ñe
);

436 
	`z¶FªeNode
(
x
);

437 
ªmoved
++;

438 
x
 = 
√xt
;

440  
ªmoved
;

441 
	}
}

445 
	$z¶DñëeR™geByR™k
(
zskùli°
 *
z¶
, 
°¨t
, 
íd
, 
di˘
 *dict) {

446 
zskùli°Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

447 
åavî£d
 = 0, 
ªmoved
 = 0;

448 
i
;

450 
x
 = 
z¶
->
hódî
;

451 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

452 
x
->
Àvñ
[
i
].
f‹w¨d
 && (
åavî£d
 + x->Àvñ[i].
•™
Ë< 
°¨t
) {

453 
åavî£d
 +
x
->
Àvñ
[
i
].
•™
;

454 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

456 
upd©e
[
i
] = 
x
;

459 
åavî£d
++;

460 
x
 = x->
Àvñ
[0].
f‹w¨d
;

461 
x
 && 
åavî£d
 <
íd
) {

462 
zskùli°Node
 *
√xt
 = 
x
->
Àvñ
[0].
f‹w¨d
;

463 
	`z¶DñëeNode
(
z¶
,
x
,
upd©e
);

464 
	`di˘Dñëe
(
di˘
,
x
->
ñe
);

465 
	`z¶FªeNode
(
x
);

466 
ªmoved
++;

467 
åavî£d
++;

468 
x
 = 
√xt
;

470  
ªmoved
;

471 
	}
}

477 
	$z¶GëR™k
(
zskùli°
 *
z¶
, 
sc‹e
, 
sds
 
ñe
) {

478 
zskùli°Node
 *
x
;

479 
ønk
 = 0;

480 
i
;

482 
x
 = 
z¶
->
hódî
;

483 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

484 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

485 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 < score ||

486 (
x
->
Àvñ
[
i
].
f‹w¨d
->
sc‹e
 == score &&

487 
	`sdscmp
(
x
->
Àvñ
[
i
].
f‹w¨d
->
ñe
,ele) <= 0))) {

488 
ønk
 +
x
->
Àvñ
[
i
].
•™
;

489 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

493 i‡(
x
->
ñe
 && 
	`sdscmp
(x->ele,ele) == 0) {

494  
ønk
;

498 
	}
}

501 
zskùli°Node
* 
	$z¶GëEÀmítByR™k
(
zskùli°
 *
z¶
, 
ønk
) {

502 
zskùli°Node
 *
x
;

503 
åavî£d
 = 0;

504 
i
;

506 
x
 = 
z¶
->
hódî
;

507 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

508 
x
->
Àvñ
[
i
].
f‹w¨d
 && (
åavî£d
 + x->Àvñ[i].
•™
Ë<
ønk
)

510 
åavî£d
 +
x
->
Àvñ
[
i
].
•™
;

511 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

513 i‡(
åavî£d
 =
ønk
) {

514  
x
;

517  
NULL
;

518 
	}
}

521 
	$z¶P¨£R™ge
(
robj
 *
mö
,Ñobj *
max
, 
zønge•ec
 *
•ec
) {

522 *
ïå
;

523 
•ec
->
möex
 = s≥c->
maxex
 = 0;

529 i‡(
mö
->
ícodög
 =
OBJ_ENCODING_INT
) {

530 
•ec
->
mö
 = ()mö->
±r
;

532 i‡(((*)
mö
->
±r
)[0] == '(') {

533 
•ec
->
mö
 = 
	`°πod
((*)mö->
±r
+1,&
ïå
);

534 i‡(
ïå
[0] !'\0' || 
	`i¢™
(
•ec
->
mö
)Ë 
C_ERR
;

535 
•ec
->
möex
 = 1;

537 
•ec
->
mö
 = 
	`°πod
((*)mö->
±r
,&
ïå
);

538 i‡(
ïå
[0] !'\0' || 
	`i¢™
(
•ec
->
mö
)Ë 
C_ERR
;

541 i‡(
max
->
ícodög
 =
OBJ_ENCODING_INT
) {

542 
•ec
->
max
 = ()max->
±r
;

544 i‡(((*)
max
->
±r
)[0] == '(') {

545 
•ec
->
max
 = 
	`°πod
((*)max->
±r
+1,&
ïå
);

546 i‡(
ïå
[0] !'\0' || 
	`i¢™
(
•ec
->
max
)Ë 
C_ERR
;

547 
•ec
->
maxex
 = 1;

549 
•ec
->
max
 = 
	`°πod
((*)max->
±r
,&
ïå
);

550 i‡(
ïå
[0] !'\0' || 
	`i¢™
(
•ec
->
max
)Ë 
C_ERR
;

554  
C_OK
;

555 
	}
}

572 
	$z¶P¨£LexR™geIãm
(
robj
 *
ôem
, 
sds
 *
de°
, *
ex
) {

573 *
c
 = 
ôem
->
±r
;

575 
c
[0]) {

577 i‡(
c
[1] !'\0'Ë 
C_ERR
;

578 *
ex
 = 1;

579 *
de°
 = 
sh¨ed
.
max°rög
;

580  
C_OK
;

582 i‡(
c
[1] !'\0'Ë 
C_ERR
;

583 *
ex
 = 1;

584 *
de°
 = 
sh¨ed
.
mö°rög
;

585  
C_OK
;

587 *
ex
 = 1;

588 *
de°
 = 
	`sd¢ewÀn
(
c
+1,
	`sd¶í
(c)-1);

589  
C_OK
;

591 *
ex
 = 0;

592 *
de°
 = 
	`sd¢ewÀn
(
c
+1,
	`sd¶í
(c)-1);

593  
C_OK
;

595  
C_ERR
;

597 
	}
}

601 
	$z¶FªeLexR™ge
(
zÀxønge•ec
 *
•ec
) {

602 i‡(
•ec
->
mö
 !
sh¨ed
.
mö°rög
 &&

603 
•ec
->
mö
 !
sh¨ed
.
max°rög
Ë
	`sds‰ì
(spec->min);

604 i‡(
•ec
->
max
 !
sh¨ed
.
mö°rög
 &&

605 
•ec
->
max
 !
sh¨ed
.
max°rög
Ë
	`sds‰ì
(spec->max);

606 
	}
}

613 
	$z¶P¨£LexR™ge
(
robj
 *
mö
,Ñobj *
max
, 
zÀxønge•ec
 *
•ec
) {

616 i‡(
mö
->
ícodög
 =
OBJ_ENCODING_INT
 ||

617 
max
->
ícodög
 =
OBJ_ENCODING_INT
Ë 
C_ERR
;

619 
•ec
->
mö
 = s≥c->
max
 = 
NULL
;

620 i‡(
	`z¶P¨£LexR™geIãm
(
mö
, &
•ec
->mö, &•ec->
möex
Ë=
C_ERR
 ||

621 
	`z¶P¨£LexR™geIãm
(
max
, &
•ec
->max, &•ec->
maxex
Ë=
C_ERR
) {

622 
	`z¶FªeLexR™ge
(
•ec
);

623  
C_ERR
;

625  
C_OK
;

627 
	}
}

632 
	$sdscm∂ex
(
sds
 
a
, sd†
b
) {

633 i‡(
a
 =
b
)  0;

634 i‡(
a
 =
sh¨ed
.
mö°rög
 || 
b
 =sh¨ed.
max°rög
)  -1;

635 i‡(
a
 =
sh¨ed
.
max°rög
 || 
b
 =sh¨ed.
mö°rög
)  1;

636  
	`sdscmp
(
a
,
b
);

637 
	}
}

639 
	$z¶LexVÆueGãMö
(
sds
 
vÆue
, 
zÀxønge•ec
 *
•ec
) {

640  
•ec
->
möex
 ?

641 (
	`sdscm∂ex
(
vÆue
,
•ec
->
mö
) > 0) :

642 (
	`sdscm∂ex
(
vÆue
,
•ec
->
mö
) >= 0);

643 
	}
}

645 
	$z¶LexVÆueLãMax
(
sds
 
vÆue
, 
zÀxønge•ec
 *
•ec
) {

646  
•ec
->
maxex
 ?

647 (
	`sdscm∂ex
(
vÆue
,
•ec
->
max
) < 0) :

648 (
	`sdscm∂ex
(
vÆue
,
•ec
->
max
) <= 0);

649 
	}
}

652 
	$z¶IsInLexR™ge
(
zskùli°
 *
z¶
, 
zÀxønge•ec
 *
ønge
) {

653 
zskùli°Node
 *
x
;

656 
cmp
 = 
	`sdscm∂ex
(
ønge
->
mö
,ønge->
max
);

657 i‡(
cmp
 > 0 || (cm∞=0 && (
ønge
->
möex
 ||Ñ™ge->
maxex
)))

659 
x
 = 
z¶
->
èû
;

660 i‡(
x
 =
NULL
 || !
	`z¶LexVÆueGãMö
(x->
ñe
,
ønge
))

662 
x
 = 
z¶
->
hódî
->
Àvñ
[0].
f‹w¨d
;

663 i‡(
x
 =
NULL
 || !
	`z¶LexVÆueLãMax
(x->
ñe
,
ønge
))

666 
	}
}

670 
zskùli°Node
 *
	$z¶Fú°InLexR™ge
(
zskùli°
 *
z¶
, 
zÀxønge•ec
 *
ønge
) {

671 
zskùli°Node
 *
x
;

672 
i
;

675 i‡(!
	`z¶IsInLexR™ge
(
z¶
,
ønge
)Ë 
NULL
;

677 
x
 = 
z¶
->
hódî
;

678 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

680 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

681 !
	`z¶LexVÆueGãMö
(
x
->
Àvñ
[
i
].
f‹w¨d
->
ñe
,
ønge
))

682 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

686 
x
 = x->
Àvñ
[0].
f‹w¨d
;

687 
	`£rvîAs£π
(
x
 !
NULL
);

690 i‡(!
	`z¶LexVÆueLãMax
(
x
->
ñe
,
ønge
)Ë 
NULL
;

691  
x
;

692 
	}
}

696 
zskùli°Node
 *
	$z¶La°InLexR™ge
(
zskùli°
 *
z¶
, 
zÀxønge•ec
 *
ønge
) {

697 
zskùli°Node
 *
x
;

698 
i
;

701 i‡(!
	`z¶IsInLexR™ge
(
z¶
,
ønge
)Ë 
NULL
;

703 
x
 = 
z¶
->
hódî
;

704 
i
 = 
z¶
->
Àvñ
-1; i >= 0; i--) {

706 
x
->
Àvñ
[
i
].
f‹w¨d
 &&

707 
	`z¶LexVÆueLãMax
(
x
->
Àvñ
[
i
].
f‹w¨d
->
ñe
,
ønge
))

708 
x
 = x->
Àvñ
[
i
].
f‹w¨d
;

712 
	`£rvîAs£π
(
x
 !
NULL
);

715 i‡(!
	`z¶LexVÆueGãMö
(
x
->
ñe
,
ønge
)Ë 
NULL
;

716  
x
;

717 
	}
}

723 
	$zzlGëSc‹e
(*
•å
) {

724 *
v°r
;

725 
vÀn
;

726 
vl⁄g
;

727 
buf
[128];

728 
sc‹e
;

730 
	`£rvîAs£π
(
•å
 !
NULL
);

731 
	`£rvîAs£π
(
	`zùli°Gë
(
•å
,&
v°r
,&
vÀn
,&
vl⁄g
));

733 i‡(
v°r
) {

734 
	`mem˝y
(
buf
,
v°r
,
vÀn
);

735 
buf
[
vÀn
] = '\0';

736 
sc‹e
 = 
	`°πod
(
buf
,
NULL
);

738 
sc‹e
 = 
vl⁄g
;

741  
sc‹e
;

742 
	}
}

745 
sds
 
	$zùli°GëObje˘
(*
•å
) {

746 *
v°r
;

747 
vÀn
;

748 
vl⁄g
;

750 
	`£rvîAs£π
(
•å
 !
NULL
);

751 
	`£rvîAs£π
(
	`zùli°Gë
(
•å
,&
v°r
,&
vÀn
,&
vl⁄g
));

753 i‡(
v°r
) {

754  
	`sd¢ewÀn
((*)
v°r
,
vÀn
);

756  
	`sds‰oml⁄gl⁄g
(
vl⁄g
);

758 
	}
}

761 
	$zzlCom∑ªEÀmíts
(*
ïå
, *
c°r
, 
˛í
) {

762 *
v°r
;

763 
vÀn
;

764 
vl⁄g
;

765 
vbuf
[32];

766 
möÀn
, 
cmp
;

768 
	`£rvîAs£π
(
	`zùli°Gë
(
ïå
,&
v°r
,&
vÀn
,&
vl⁄g
));

769 i‡(
v°r
 =
NULL
) {

771 
vÀn
 = 
	`Œ2°rög
((*)
vbuf
,(vbuf),
vl⁄g
);

772 
v°r
 = 
vbuf
;

775 
möÀn
 = (
vÀn
 < 
˛í
) ? vlen : clen;

776 
cmp
 = 
	`memcmp
(
v°r
,
c°r
,
möÀn
);

777 i‡(
cmp
 =0Ë 
vÀn
-
˛í
;

778  
cmp
;

779 
	}
}

781 
	$zzlLígth
(*
zl
) {

782  
	`zùli°Lí
(
zl
)/2;

783 
	}
}

787 
	$zzlNext
(*
zl
, **
ïå
, **
•å
) {

788 *
_ïå
, *
_•å
;

789 
	`£rvîAs£π
(*
ïå
 !
NULL
 && *
•å
 != NULL);

791 
_ïå
 = 
	`zùli°Next
(
zl
,*
•å
);

792 i‡(
_ïå
 !
NULL
) {

793 
_•å
 = 
	`zùli°Next
(
zl
,
_ïå
);

794 
	`£rvîAs£π
(
_•å
 !
NULL
);

797 
_•å
 = 
NULL
;

800 *
ïå
 = 
_ïå
;

801 *
•å
 = 
_•å
;

802 
	}
}

806 
	$zzlPªv
(*
zl
, **
ïå
, **
•å
) {

807 *
_ïå
, *
_•å
;

808 
	`£rvîAs£π
(*
ïå
 !
NULL
 && *
•å
 != NULL);

810 
_•å
 = 
	`zùli°Pªv
(
zl
,*
ïå
);

811 i‡(
_•å
 !
NULL
) {

812 
_ïå
 = 
	`zùli°Pªv
(
zl
,
_•å
);

813 
	`£rvîAs£π
(
_ïå
 !
NULL
);

816 
_ïå
 = 
NULL
;

819 *
ïå
 = 
_ïå
;

820 *
•å
 = 
_•å
;

821 
	}
}

825 
	$zzlIsInR™ge
(*
zl
, 
zønge•ec
 *
ønge
) {

826 *
p
;

827 
sc‹e
;

830 i‡(
ønge
->
mö
 >Ñ™ge->
max
 ||

831 (
ønge
->
mö
 =ønge->
max
 && (ønge->
möex
 ||Ñ™ge->
maxex
)))

834 
p
 = 
	`zùli°Index
(
zl
,-1);

835 i‡(
p
 =
NULL
)  0;

836 
sc‹e
 = 
	`zzlGëSc‹e
(
p
);

837 i‡(!
	`z¶VÆueGãMö
(
sc‹e
,
ønge
))

840 
p
 = 
	`zùli°Index
(
zl
,1);

841 
	`£rvîAs£π
(
p
 !
NULL
);

842 
sc‹e
 = 
	`zzlGëSc‹e
(
p
);

843 i‡(!
	`z¶VÆueLãMax
(
sc‹e
,
ønge
))

847 
	}
}

851 *
	$zzlFú°InR™ge
(*
zl
, 
zønge•ec
 *
ønge
) {

852 *
ïå
 = 
	`zùli°Index
(
zl
,0), *
•å
;

853 
sc‹e
;

856 i‡(!
	`zzlIsInR™ge
(
zl
,
ønge
)Ë 
NULL
;

858 
ïå
 !
NULL
) {

859 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

860 
	`£rvîAs£π
(
•å
 !
NULL
);

862 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

863 i‡(
	`z¶VÆueGãMö
(
sc‹e
,
ønge
)) {

865 i‡(
	`z¶VÆueLãMax
(
sc‹e
,
ønge
))

866  
ïå
;

867  
NULL
;

871 
ïå
 = 
	`zùli°Next
(
zl
,
•å
);

874  
NULL
;

875 
	}
}

879 *
	$zzlLa°InR™ge
(*
zl
, 
zønge•ec
 *
ønge
) {

880 *
ïå
 = 
	`zùli°Index
(
zl
,-2), *
•å
;

881 
sc‹e
;

884 i‡(!
	`zzlIsInR™ge
(
zl
,
ønge
)Ë 
NULL
;

886 
ïå
 !
NULL
) {

887 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

888 
	`£rvîAs£π
(
•å
 !
NULL
);

890 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

891 i‡(
	`z¶VÆueLãMax
(
sc‹e
,
ønge
)) {

893 i‡(
	`z¶VÆueGãMö
(
sc‹e
,
ønge
))

894  
ïå
;

895  
NULL
;

900 
•å
 = 
	`zùli°Pªv
(
zl
,
ïå
);

901 i‡(
•å
 !
NULL
)

902 
	`£rvîAs£π
((
ïå
 = 
	`zùli°Pªv
(
zl
,
•å
)Ë!
NULL
);

904 
ïå
 = 
NULL
;

907  
NULL
;

908 
	}
}

910 
	$zzlLexVÆueGãMö
(*
p
, 
zÀxønge•ec
 *
•ec
) {

911 
sds
 
vÆue
 = 
	`zùli°GëObje˘
(
p
);

912 
ªs
 = 
	`z¶LexVÆueGãMö
(
vÆue
,
•ec
);

913 
	`sds‰ì
(
vÆue
);

914  
ªs
;

915 
	}
}

917 
	$zzlLexVÆueLãMax
(*
p
, 
zÀxønge•ec
 *
•ec
) {

918 
sds
 
vÆue
 = 
	`zùli°GëObje˘
(
p
);

919 
ªs
 = 
	`z¶LexVÆueLãMax
(
vÆue
,
•ec
);

920 
	`sds‰ì
(
vÆue
);

921  
ªs
;

922 
	}
}

926 
	$zzlIsInLexR™ge
(*
zl
, 
zÀxønge•ec
 *
ønge
) {

927 *
p
;

930 
cmp
 = 
	`sdscm∂ex
(
ønge
->
mö
,ønge->
max
);

931 i‡(
cmp
 > 0 || (cm∞=0 && (
ønge
->
möex
 ||Ñ™ge->
maxex
)))

934 
p
 = 
	`zùli°Index
(
zl
,-2);

935 i‡(
p
 =
NULL
)  0;

936 i‡(!
	`zzlLexVÆueGãMö
(
p
,
ønge
))

939 
p
 = 
	`zùli°Index
(
zl
,0);

940 
	`£rvîAs£π
(
p
 !
NULL
);

941 i‡(!
	`zzlLexVÆueLãMax
(
p
,
ønge
))

945 
	}
}

949 *
	$zzlFú°InLexR™ge
(*
zl
, 
zÀxønge•ec
 *
ønge
) {

950 *
ïå
 = 
	`zùli°Index
(
zl
,0), *
•å
;

953 i‡(!
	`zzlIsInLexR™ge
(
zl
,
ønge
)Ë 
NULL
;

955 
ïå
 !
NULL
) {

956 i‡(
	`zzlLexVÆueGãMö
(
ïå
,
ønge
)) {

958 i‡(
	`zzlLexVÆueLãMax
(
ïå
,
ønge
))

959  
ïå
;

960  
NULL
;

964 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

965 
	`£rvîAs£π
(
•å
 !
NULL
);

966 
ïå
 = 
	`zùli°Next
(
zl
,
•å
);

969  
NULL
;

970 
	}
}

974 *
	$zzlLa°InLexR™ge
(*
zl
, 
zÀxønge•ec
 *
ønge
) {

975 *
ïå
 = 
	`zùli°Index
(
zl
,-2), *
•å
;

978 i‡(!
	`zzlIsInLexR™ge
(
zl
,
ønge
)Ë 
NULL
;

980 
ïå
 !
NULL
) {

981 i‡(
	`zzlLexVÆueLãMax
(
ïå
,
ønge
)) {

983 i‡(
	`zzlLexVÆueGãMö
(
ïå
,
ønge
))

984  
ïå
;

985  
NULL
;

990 
•å
 = 
	`zùli°Pªv
(
zl
,
ïå
);

991 i‡(
•å
 !
NULL
)

992 
	`£rvîAs£π
((
ïå
 = 
	`zùli°Pªv
(
zl
,
•å
)Ë!
NULL
);

994 
ïå
 = 
NULL
;

997  
NULL
;

998 
	}
}

1000 *
	$zzlFöd
(*
zl
, 
sds
 
ñe
, *
sc‹e
) {

1001 *
ïå
 = 
	`zùli°Index
(
zl
,0), *
•å
;

1003 
ïå
 !
NULL
) {

1004 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

1005 
	`£rvîAs£π
(
•å
 !
NULL
);

1007 i‡(
	`zùli°Com∑ª
(
ïå
,(*)
ñe
,
	`sd¶í
(ele))) {

1009 i‡(
sc‹e
 !
NULL
Ë*sc‹ê
	`zzlGëSc‹e
(
•å
);

1010  
ïå
;

1014 
ïå
 = 
	`zùli°Next
(
zl
,
•å
);

1016  
NULL
;

1017 
	}
}

1021 *
	$zzlDñëe
(*
zl
, *
ïå
) {

1022 *
p
 = 
ïå
;

1025 
zl
 = 
	`zùli°Dñëe
(zl,&
p
);

1026 
zl
 = 
	`zùli°Dñëe
(zl,&
p
);

1027  
zl
;

1028 
	}
}

1030 *
	$zzlIn£πAt
(*
zl
, *
ïå
, 
sds
 
ñe
, 
sc‹e
) {

1031 *
•å
;

1032 
sc‹ebuf
[128];

1033 
sc‹ñí
;

1034 
size_t
 
off£t
;

1036 
sc‹ñí
 = 
	`d2°rög
(
sc‹ebuf
,(sc‹ebuf),
sc‹e
);

1037 i‡(
ïå
 =
NULL
) {

1038 
zl
 = 
	`zùli°Push
(zl,(*)
ñe
,
	`sd¶í
”À),
ZIPLIST_TAIL
);

1039 
zl
 = 
	`zùli°Push
(zl,(*)
sc‹ebuf
,
sc‹ñí
,
ZIPLIST_TAIL
);

1042 
off£t
 = 
ïå
-
zl
;

1043 
zl
 = 
	`zùli°In£π
(zl,
ïå
,(*)
ñe
,
	`sd¶í
(ele));

1044 
ïå
 = 
zl
+
off£t
;

1047 
	`£rvîAs£π
((
•å
 = 
	`zùli°Next
(
zl
,
ïå
)Ë!
NULL
);

1048 
zl
 = 
	`zùli°In£π
(zl,
•å
,(*)
sc‹ebuf
,
sc‹ñí
);

1050  
zl
;

1051 
	}
}

1055 *
	$zzlIn£π
(*
zl
, 
sds
 
ñe
, 
sc‹e
) {

1056 *
ïå
 = 
	`zùli°Index
(
zl
,0), *
•å
;

1057 
s
;

1059 
ïå
 !
NULL
) {

1060 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

1061 
	`£rvîAs£π
(
•å
 !
NULL
);

1062 
s
 = 
	`zzlGëSc‹e
(
•å
);

1064 i‡(
s
 > 
sc‹e
) {

1068 
zl
 = 
	`zzlIn£πAt
(zl,
ïå
,
ñe
,
sc‹e
);

1070 } i‡(
s
 =
sc‹e
) {

1072 i‡(
	`zzlCom∑ªEÀmíts
(
ïå
,(*)
ñe
,
	`sd¶í
(ele)) > 0) {

1073 
zl
 = 
	`zzlIn£πAt
(zl,
ïå
,
ñe
,
sc‹e
);

1079 
ïå
 = 
	`zùli°Next
(
zl
,
•å
);

1083 i‡(
ïå
 =
NULL
)

1084 
zl
 = 
	`zzlIn£πAt
(zl,
NULL
,
ñe
,
sc‹e
);

1085  
zl
;

1086 
	}
}

1088 *
	$zzlDñëeR™geBySc‹e
(*
zl
, 
zønge•ec
 *
ønge
, *
dñëed
) {

1089 *
ïå
, *
•å
;

1090 
sc‹e
;

1091 
num
 = 0;

1093 i‡(
dñëed
 !
NULL
) *deleted = 0;

1095 
ïå
 = 
	`zzlFú°InR™ge
(
zl
,
ønge
);

1096 i‡(
ïå
 =
NULL
Ë 
zl
;

1100 (
•å
 = 
	`zùli°Next
(
zl
,
ïå
)Ë!
NULL
) {

1101 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

1102 i‡(
	`z¶VÆueLãMax
(
sc‹e
,
ønge
)) {

1104 
zl
 = 
	`zùli°Dñëe
(zl,&
ïå
);

1105 
zl
 = 
	`zùli°Dñëe
(zl,&
ïå
);

1106 
num
++;

1113 i‡(
dñëed
 !
NULL
Ë*dñëed = 
num
;

1114  
zl
;

1115 
	}
}

1117 *
	$zzlDñëeR™geByLex
(*
zl
, 
zÀxønge•ec
 *
ønge
, *
dñëed
) {

1118 *
ïå
, *
•å
;

1119 
num
 = 0;

1121 i‡(
dñëed
 !
NULL
) *deleted = 0;

1123 
ïå
 = 
	`zzlFú°InLexR™ge
(
zl
,
ønge
);

1124 i‡(
ïå
 =
NULL
Ë 
zl
;

1128 (
•å
 = 
	`zùli°Next
(
zl
,
ïå
)Ë!
NULL
) {

1129 i‡(
	`zzlLexVÆueLãMax
(
ïå
,
ønge
)) {

1131 
zl
 = 
	`zùli°Dñëe
(zl,&
ïå
);

1132 
zl
 = 
	`zùli°Dñëe
(zl,&
ïå
);

1133 
num
++;

1140 i‡(
dñëed
 !
NULL
Ë*dñëed = 
num
;

1141  
zl
;

1142 
	}
}

1146 *
	$zzlDñëeR™geByR™k
(*
zl
, 
°¨t
, 
íd
, *
dñëed
) {

1147 
num
 = (
íd
-
°¨t
)+1;

1148 i‡(
dñëed
Ë*dñëed = 
num
;

1149 
zl
 = 
	`zùli°DñëeR™ge
(zl,2*(
°¨t
-1),2*
num
);

1150  
zl
;

1151 
	}
}

1157 
	$z£tLígth
(c⁄° 
robj
 *
zobj
) {

1158 
Àngth
 = 0;

1159 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1160 
Àngth
 = 
	`zzlLígth
(
zobj
->
±r
);

1161 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1162 
Àngth
 = ((c⁄° 
z£t
*)
zobj
->
±r
)->
z¶
->length;

1164 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1166  
Àngth
;

1167 
	}
}

1169 
	$z£tC⁄vît
(
robj
 *
zobj
, 
ícodög
) {

1170 
z£t
 *
zs
;

1171 
zskùli°Node
 *
node
, *
√xt
;

1172 
sds
 
ñe
;

1173 
sc‹e
;

1175 i‡(
zobj
->
ícodög
 ==Éncoding) ;

1176 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1177 *
zl
 = 
zobj
->
±r
;

1178 *
ïå
, *
•å
;

1179 *
v°r
;

1180 
vÀn
;

1181 
vl⁄g
;

1183 i‡(
ícodög
 !
OBJ_ENCODING_SKIPLIST
)

1184 
	`£rvîP™ic
("UnknownÅargetÉncoding");

1186 
zs
 = 
	`zmÆloc
((*zs));

1187 
zs
->
di˘
 = 
	`di˘Cª©e
(&
z£tDi˘Ty≥
,
NULL
);

1188 
zs
->
z¶
 = 
	`z¶Cª©e
();

1190 
ïå
 = 
	`zùli°Index
(
zl
,0);

1191 
	`£rvîAs£πWôhInfo
(
NULL
,
zobj
,
ïå
 != NULL);

1192 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

1193 
	`£rvîAs£πWôhInfo
(
NULL
,
zobj
,
•å
 != NULL);

1195 
ïå
 !
NULL
) {

1196 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

1197 
	`£rvîAs£πWôhInfo
(
NULL
,
zobj
,
	`zùli°Gë
(
ïå
,&
v°r
,&
vÀn
,&
vl⁄g
));

1198 i‡(
v°r
 =
NULL
)

1199 
ñe
 = 
	`sds‰oml⁄gl⁄g
(
vl⁄g
);

1201 
ñe
 = 
	`sd¢ewÀn
((*)
v°r
,
vÀn
);

1203 
node
 = 
	`z¶In£π
(
zs
->
z¶
,
sc‹e
,
ñe
);

1204 
	`£rvîAs£π
(
	`di˘Add
(
zs
->
di˘
,
ñe
,&
node
->
sc‹e
Ë=
DICT_OK
);

1205 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

1208 
	`z‰ì
(
zobj
->
±r
);

1209 
zobj
->
±r
 = 
zs
;

1210 
zobj
->
ícodög
 = 
OBJ_ENCODING_SKIPLIST
;

1211 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1212 *
zl
 = 
	`zùli°New
();

1214 i‡(
ícodög
 !
OBJ_ENCODING_ZIPLIST
)

1215 
	`£rvîP™ic
("UnknownÅargetÉncoding");

1219 
zs
 = 
zobj
->
±r
;

1220 
	`di˘Rñó£
(
zs
->
di˘
);

1221 
node
 = 
zs
->
z¶
->
hódî
->
Àvñ
[0].
f‹w¨d
;

1222 
	`z‰ì
(
zs
->
z¶
->
hódî
);

1223 
	`z‰ì
(
zs
->
z¶
);

1225 
node
) {

1226 
zl
 = 
	`zzlIn£πAt
(zl,
NULL
,
node
->
ñe
,node->
sc‹e
);

1227 
√xt
 = 
node
->
Àvñ
[0].
f‹w¨d
;

1228 
	`z¶FªeNode
(
node
);

1229 
node
 = 
√xt
;

1232 
	`z‰ì
(
zs
);

1233 
zobj
->
±r
 = 
zl
;

1234 
zobj
->
ícodög
 = 
OBJ_ENCODING_ZIPLIST
;

1236 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1238 
	}
}

1243 
	$z£tC⁄vîtToZùli°IfNìded
(
robj
 *
zobj
, 
size_t
 
maxññí
) {

1244 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) ;

1245 
z£t
 *z£à
zobj
->
±r
;

1247 i‡(
z£t
->
z¶
->
Àngth
 <
£rvî
.
z£t_max_zùli°_íåõs
 &&

1248 
maxññí
 <
£rvî
.
z£t_max_zùli°_vÆue
)

1249 
	`z£tC⁄vît
(
zobj
,
OBJ_ENCODING_ZIPLIST
);

1250 
	}
}

1256 
	$z£tSc‹e
(
robj
 *
zobj
, 
sds
 
membî
, *
sc‹e
) {

1257 i‡(!
zobj
 || !
membî
Ë 
C_ERR
;

1259 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1260 i‡(
	`zzlFöd
(
zobj
->
±r
, 
membî
, 
sc‹e
Ë=
NULL
Ë 
C_ERR
;

1261 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1262 
z£t
 *
zs
 = 
zobj
->
±r
;

1263 
di˘E¡ry
 *
de
 = 
	`di˘Föd
(
zs
->
di˘
, 
membî
);

1264 i‡(
de
 =
NULL
Ë 
C_ERR
;

1265 *
sc‹e
 = *(*)
	`di˘GëVÆ
(
de
);

1267 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1269  
C_OK
;

1270 
	}
}

1315 
	$z£tAdd
(
robj
 *
zobj
, 
sc‹e
, 
sds
 
ñe
, *
Êags
, *
√wsc‹e
) {

1317 
ö¸
 = (*
Êags
 & 
ZADD_INCR
) != 0;

1318 
nx
 = (*
Êags
 & 
ZADD_NX
) != 0;

1319 
xx
 = (*
Êags
 & 
ZADD_XX
) != 0;

1320 *
Êags
 = 0;

1321 
cursc‹e
;

1324 i‡(
	`i¢™
(
sc‹e
)) {

1325 *
Êags
 = 
ZADD_NAN
;

1330 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1331 *
ïå
;

1333 i‡((
ïå
 = 
	`zzlFöd
(
zobj
->
±r
,
ñe
,&
cursc‹e
)Ë!
NULL
) {

1335 i‡(
nx
) {

1336 *
Êags
 |
ZADD_NOP
;

1341 i‡(
ö¸
) {

1342 
sc‹e
 +
cursc‹e
;

1343 i‡(
	`i¢™
(
sc‹e
)) {

1344 *
Êags
 |
ZADD_NAN
;

1347 i‡(
√wsc‹e
Ë*√wsc‹ê
sc‹e
;

1351 i‡(
sc‹e
 !
cursc‹e
) {

1352 
zobj
->
±r
 = 
	`zzlDñëe
(zobj->±r,
ïå
);

1353 
zobj
->
±r
 = 
	`zzlIn£π
(zobj->±r,
ñe
,
sc‹e
);

1354 *
Êags
 |
ZADD_UPDATED
;

1357 } i‡(!
xx
) {

1360 
zobj
->
±r
 = 
	`zzlIn£π
(zobj->±r,
ñe
,
sc‹e
);

1361 i‡(
	`zzlLígth
(
zobj
->
±r
Ë> 
£rvî
.
z£t_max_zùli°_íåõs
 ||

1362 
	`sd¶í
(
ñe
Ë> 
£rvî
.
z£t_max_zùli°_vÆue
)

1363 
	`z£tC⁄vît
(
zobj
,
OBJ_ENCODING_SKIPLIST
);

1364 i‡(
√wsc‹e
Ë*√wsc‹ê
sc‹e
;

1365 *
Êags
 |
ZADD_ADDED
;

1368 *
Êags
 |
ZADD_NOP
;

1371 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1372 
z£t
 *
zs
 = 
zobj
->
±r
;

1373 
zskùli°Node
 *
znode
;

1374 
di˘E¡ry
 *
de
;

1376 
de
 = 
	`di˘Föd
(
zs
->
di˘
,
ñe
);

1377 i‡(
de
 !
NULL
) {

1379 i‡(
nx
) {

1380 *
Êags
 |
ZADD_NOP
;

1383 
cursc‹e
 = *(*)
	`di˘GëVÆ
(
de
);

1386 i‡(
ö¸
) {

1387 
sc‹e
 +
cursc‹e
;

1388 i‡(
	`i¢™
(
sc‹e
)) {

1389 *
Êags
 |
ZADD_NAN
;

1392 i‡(
√wsc‹e
Ë*√wsc‹ê
sc‹e
;

1396 i‡(
sc‹e
 !
cursc‹e
) {

1397 
znode
 = 
	`z¶Upd©eSc‹e
(
zs
->
z¶
,
cursc‹e
,
ñe
,
sc‹e
);

1401 
	`di˘GëVÆ
(
de
Ë&
znode
->
sc‹e
;

1402 *
Êags
 |
ZADD_UPDATED
;

1405 } i‡(!
xx
) {

1406 
ñe
 = 
	`sdsdup
(ele);

1407 
znode
 = 
	`z¶In£π
(
zs
->
z¶
,
sc‹e
,
ñe
);

1408 
	`£rvîAs£π
(
	`di˘Add
(
zs
->
di˘
,
ñe
,&
znode
->
sc‹e
Ë=
DICT_OK
);

1409 *
Êags
 |
ZADD_ADDED
;

1410 i‡(
√wsc‹e
Ë*√wsc‹ê
sc‹e
;

1413 *
Êags
 |
ZADD_NOP
;

1417 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1420 
	}
}

1424 
	$z£tDñ
(
robj
 *
zobj
, 
sds
 
ñe
) {

1425 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1426 *
ïå
;

1428 i‡((
ïå
 = 
	`zzlFöd
(
zobj
->
±r
,
ñe
,
NULL
)) != NULL) {

1429 
zobj
->
±r
 = 
	`zzlDñëe
(zobj->±r,
ïå
);

1432 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1433 
z£t
 *
zs
 = 
zobj
->
±r
;

1434 
di˘E¡ry
 *
de
;

1435 
sc‹e
;

1437 
de
 = 
	`di˘U∆ök
(
zs
->
di˘
,
ñe
);

1438 i‡(
de
 !
NULL
) {

1440 
sc‹e
 = *(*)
	`di˘GëVÆ
(
de
);

1447 
	`di˘FªeU∆ökedE¡ry
(
zs
->
di˘
,
de
);

1450 
ªtvÆ
 = 
	`z¶Dñëe
(
zs
->
z¶
,
sc‹e
,
ñe
,
NULL
);

1451 
	`£rvîAs£π
(
ªtvÆ
);

1453 i‡(
	`htNìdsResize
(
zs
->
di˘
)Ë
	`di˘Resize
(zs->dict);

1457 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1460 
	}
}

1473 
	$z£tR™k
(
robj
 *
zobj
, 
sds
 
ñe
, 
ªvî£
) {

1474 
Œí
;

1475 
ønk
;

1477 
Œí
 = 
	`z£tLígth
(
zobj
);

1479 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1480 *
zl
 = 
zobj
->
±r
;

1481 *
ïå
, *
•å
;

1483 
ïå
 = 
	`zùli°Index
(
zl
,0);

1484 
	`£rvîAs£π
(
ïå
 !
NULL
);

1485 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

1486 
	`£rvîAs£π
(
•å
 !
NULL
);

1488 
ønk
 = 1;

1489 
ïå
 !
NULL
) {

1490 i‡(
	`zùli°Com∑ª
(
ïå
,(*)
ñe
,
	`sd¶í
(ele)))

1492 
ønk
++;

1493 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

1496 i‡(
ïå
 !
NULL
) {

1497 i‡(
ªvî£
)

1498  
Œí
-
ønk
;

1500  
ønk
-1;

1504 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1505 
z£t
 *
zs
 = 
zobj
->
±r
;

1506 
zskùli°
 *
z¶
 = 
zs
->zsl;

1507 
di˘E¡ry
 *
de
;

1508 
sc‹e
;

1510 
de
 = 
	`di˘Föd
(
zs
->
di˘
,
ñe
);

1511 i‡(
de
 !
NULL
) {

1512 
sc‹e
 = *(*)
	`di˘GëVÆ
(
de
);

1513 
ønk
 = 
	`z¶GëR™k
(
z¶
,
sc‹e
,
ñe
);

1515 
	`£rvîAs£π
(
ønk
 != 0);

1516 i‡(
ªvî£
)

1517  
Œí
-
ønk
;

1519  
ønk
-1;

1524 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1526 
	}
}

1533 
	$zaddGíîicComm™d
(
˛õ¡
 *
c
, 
Êags
) {

1534 *
«√º
 = "resulting score isÇotáÇumber (NaN)";

1535 
robj
 *
key
 = 
c
->
¨gv
[1];

1536 
robj
 *
zobj
;

1537 
sds
 
ñe
;

1538 
sc‹e
 = 0, *
sc‹es
 = 
NULL
;

1539 
j
, 
ñemíts
;

1540 
sc‹eidx
 = 0;

1544 
added
 = 0;

1545 
upd©ed
 = 0;

1546 
¥o˚s£d
 = 0;

1551 
sc‹eidx
 = 2;

1552 
sc‹eidx
 < 
c
->
¨gc
) {

1553 *
›t
 = 
c
->
¨gv
[
sc‹eidx
]->
±r
;

1554 i‡(!
	`°rˇ£cmp
(
›t
,"nx")Ë
Êags
 |
ZADD_NX
;

1555 i‡(!
	`°rˇ£cmp
(
›t
,"xx")Ë
Êags
 |
ZADD_XX
;

1556 i‡(!
	`°rˇ£cmp
(
›t
,"ch")Ë
Êags
 |
ZADD_CH
;

1557 i‡(!
	`°rˇ£cmp
(
›t
,"ö¸")Ë
Êags
 |
ZADD_INCR
;

1559 
sc‹eidx
++;

1563 
ö¸
 = (
Êags
 & 
ZADD_INCR
) != 0;

1564 
nx
 = (
Êags
 & 
ZADD_NX
) != 0;

1565 
xx
 = (
Êags
 & 
ZADD_XX
) != 0;

1566 
ch
 = (
Êags
 & 
ZADD_CH
) != 0;

1570 
ñemíts
 = 
c
->
¨gc
-
sc‹eidx
;

1571 i‡(
ñemíts
 % 2 || !elements) {

1572 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

1575 
ñemíts
 /= 2;

1578 i‡(
nx
 && 
xx
) {

1579 
	`addRïlyEº‹
(
c
,

1584 i‡(
ö¸
 && 
ñemíts
 > 1) {

1585 
	`addRïlyEº‹
(
c
,

1593 
sc‹es
 = 
	`zmÆloc
(()*
ñemíts
);

1594 
j
 = 0; j < 
ñemíts
; j++) {

1595 i‡(
	`gëDoubÀFromObje˘OrRïly
(
c
,c->
¨gv
[
sc‹eidx
+
j
*2],&
sc‹es
[j],
NULL
)

1596 !
C_OK
Ë
˛ónup
;

1600 
zobj
 = 
	`lookupKeyWrôe
(
c
->
db
,
key
);

1601 i‡(
zobj
 =
NULL
) {

1602 i‡(
xx
Ë
ª∂y_to_˛õ¡
;

1603 i‡(
£rvî
.
z£t_max_zùli°_íåõs
 == 0 ||

1604 
£rvî
.
z£t_max_zùli°_vÆue
 < 
	`sd¶í
(
c
->
¨gv
[
sc‹eidx
+1]->
±r
))

1606 
zobj
 = 
	`¸óãZ£tObje˘
();

1608 
zobj
 = 
	`¸óãZ£tZùli°Obje˘
();

1610 
	`dbAdd
(
c
->
db
,
key
,
zobj
);

1612 i‡(
zobj
->
ty≥
 !
OBJ_ZSET
) {

1613 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

1614 
˛ónup
;

1618 
j
 = 0; j < 
ñemíts
; j++) {

1619 
√wsc‹e
;

1620 
sc‹e
 = 
sc‹es
[
j
];

1621 
ªtÊags
 = 
Êags
;

1623 
ñe
 = 
c
->
¨gv
[
sc‹eidx
+1+
j
*2]->
±r
;

1624 
ªtvÆ
 = 
	`z£tAdd
(
zobj
, 
sc‹e
, 
ñe
, &
ªtÊags
, &
√wsc‹e
);

1625 i‡(
ªtvÆ
 == 0) {

1626 
	`addRïlyEº‹
(
c
,
«√º
);

1627 
˛ónup
;

1629 i‡(
ªtÊags
 & 
ZADD_ADDED
Ë
added
++;

1630 i‡(
ªtÊags
 & 
ZADD_UPDATED
Ë
upd©ed
++;

1631 i‡(!(
ªtÊags
 & 
ZADD_NOP
)Ë
¥o˚s£d
++;

1632 
sc‹e
 = 
√wsc‹e
;

1634 
£rvî
.
dúty
 +(
added
+
upd©ed
);

1636 
ª∂y_to_˛õ¡
:

1637 i‡(
ö¸
) {

1638 i‡(
¥o˚s£d
)

1639 
	`addRïlyDoubÀ
(
c
,
sc‹e
);

1641 
	`addRïlyNuŒ
(
c
);

1643 
	`addRïlyL⁄gL⁄g
(
c
,
ch
 ? 
added
+
upd©ed
 :ádded);

1646 
˛ónup
:

1647 
	`z‰ì
(
sc‹es
);

1648 i‡(
added
 || 
upd©ed
) {

1649 
	`sig«lModifõdKey
(
c
,c->
db
,
key
);

1650 
	`nŸifyKey•a˚Evít
(
NOTIFY_ZSET
,

1651 
ö¸
 ? "zö¸" : "zadd", 
key
, 
c
->
db
->
id
);

1653 
	}
}

1655 
	$zaddComm™d
(
˛õ¡
 *
c
) {

1656 
	`zaddGíîicComm™d
(
c
,
ZADD_NONE
);

1657 
	}
}

1659 
	$zö¸byComm™d
(
˛õ¡
 *
c
) {

1660 
	`zaddGíîicComm™d
(
c
,
ZADD_INCR
);

1661 
	}
}

1663 
	$zªmComm™d
(
˛õ¡
 *
c
) {

1664 
robj
 *
key
 = 
c
->
¨gv
[1];

1665 
robj
 *
zobj
;

1666 
dñëed
 = 0, 
keyªmoved
 = 0, 
j
;

1668 i‡((
zobj
 = 
	`lookupKeyWrôeOrRïly
(
c
,
key
,
sh¨ed
.
czîo
)Ë=
NULL
 ||

1669 
	`checkTy≥
(
c
,
zobj
,
OBJ_ZSET
)) ;

1671 
j
 = 2; j < 
c
->
¨gc
; j++) {

1672 i‡(
	`z£tDñ
(
zobj
,
c
->
¨gv
[
j
]->
±r
)Ë
dñëed
++;

1673 i‡(
	`z£tLígth
(
zobj
) == 0) {

1674 
	`dbDñëe
(
c
->
db
,
key
);

1675 
keyªmoved
 = 1;

1680 i‡(
dñëed
) {

1681 
	`nŸifyKey•a˚Evít
(
NOTIFY_ZSET
,"zªm",
key
,
c
->
db
->
id
);

1682 i‡(
keyªmoved
)

1683 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
key
,
c
->
db
->
id
);

1684 
	`sig«lModifõdKey
(
c
,c->
db
,
key
);

1685 
£rvî
.
dúty
 +
dñëed
;

1687 
	`addRïlyL⁄gL⁄g
(
c
,
dñëed
);

1688 
	}
}

1691 
	#ZRANGE_RANK
 0

	)

1692 
	#ZRANGE_SCORE
 1

	)

1693 
	#ZRANGE_LEX
 2

	)

1694 
	$zªmøngeGíîicComm™d
(
˛õ¡
 *
c
, 
øngëy≥
) {

1695 
robj
 *
key
 = 
c
->
¨gv
[1];

1696 
robj
 *
zobj
;

1697 
keyªmoved
 = 0;

1698 
dñëed
 = 0;

1699 
zønge•ec
 
ønge
;

1700 
zÀxønge•ec
 
Àxønge
;

1701 
°¨t
, 
íd
, 
Œí
;

1704 i‡(
øngëy≥
 =
ZRANGE_RANK
) {

1705 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[2],&
°¨t
,
NULL
Ë!
C_OK
) ||

1706 (
	`gëL⁄gFromObje˘OrRïly
(
c
,c->
¨gv
[3],&
íd
,
NULL
Ë!
C_OK
))

1708 } i‡(
øngëy≥
 =
ZRANGE_SCORE
) {

1709 i‡(
	`z¶P¨£R™ge
(
c
->
¨gv
[2],c->¨gv[3],&
ønge
Ë!
C_OK
) {

1710 
	`addRïlyEº‹
(
c
,"min or max isÇotá float");

1713 } i‡(
øngëy≥
 =
ZRANGE_LEX
) {

1714 i‡(
	`z¶P¨£LexR™ge
(
c
->
¨gv
[2],c->¨gv[3],&
Àxønge
Ë!
C_OK
) {

1715 
	`addRïlyEº‹
(
c
,"min or maxÇot valid stringÑange item");

1721 i‡((
zobj
 = 
	`lookupKeyWrôeOrRïly
(
c
,
key
,
sh¨ed
.
czîo
)Ë=
NULL
 ||

1722 
	`checkTy≥
(
c
,
zobj
,
OBJ_ZSET
)Ë
˛ónup
;

1724 i‡(
øngëy≥
 =
ZRANGE_RANK
) {

1726 
Œí
 = 
	`z£tLígth
(
zobj
);

1727 i‡(
°¨t
 < 0Ë°¨à
Œí
+start;

1728 i‡(
íd
 < 0Ëíd = 
Œí
+end;

1729 i‡(
°¨t
 < 0) start = 0;

1733 i‡(
°¨t
 > 
íd
 || sèπ >
Œí
) {

1734 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

1735 
˛ónup
;

1737 i‡(
íd
 >
Œí
)Énd =Ülen-1;

1741 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1742 
øngëy≥
) {

1743 
ZRANGE_RANK
:

1744 
zobj
->
±r
 = 
	`zzlDñëeR™geByR™k
(zobj->±r,
°¨t
+1,
íd
+1,&
dñëed
);

1746 
ZRANGE_SCORE
:

1747 
zobj
->
±r
 = 
	`zzlDñëeR™geBySc‹e
(zobj->±r,&
ønge
,&
dñëed
);

1749 
ZRANGE_LEX
:

1750 
zobj
->
±r
 = 
	`zzlDñëeR™geByLex
(zobj->±r,&
Àxønge
,&
dñëed
);

1753 i‡(
	`zzlLígth
(
zobj
->
±r
) == 0) {

1754 
	`dbDñëe
(
c
->
db
,
key
);

1755 
keyªmoved
 = 1;

1757 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1758 
z£t
 *
zs
 = 
zobj
->
±r
;

1759 
øngëy≥
) {

1760 
ZRANGE_RANK
:

1761 
dñëed
 = 
	`z¶DñëeR™geByR™k
(
zs
->
z¶
,
°¨t
+1,
íd
+1,zs->
di˘
);

1763 
ZRANGE_SCORE
:

1764 
dñëed
 = 
	`z¶DñëeR™geBySc‹e
(
zs
->
z¶
,&
ønge
,zs->
di˘
);

1766 
ZRANGE_LEX
:

1767 
dñëed
 = 
	`z¶DñëeR™geByLex
(
zs
->
z¶
,&
Àxønge
,zs->
di˘
);

1770 i‡(
	`htNìdsResize
(
zs
->
di˘
)Ë
	`di˘Resize
(zs->dict);

1771 i‡(
	`di˘Size
(
zs
->
di˘
) == 0) {

1772 
	`dbDñëe
(
c
->
db
,
key
);

1773 
keyªmoved
 = 1;

1776 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1780 i‡(
dñëed
) {

1781 *
evít
[3] = {"zremrangebyrank","zremrangebyscore","zremrangebylex"};

1782 
	`sig«lModifõdKey
(
c
,c->
db
,
key
);

1783 
	`nŸifyKey•a˚Evít
(
NOTIFY_ZSET
,
evít
[
øngëy≥
],
key
,
c
->
db
->
id
);

1784 i‡(
keyªmoved
)

1785 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
key
,
c
->
db
->
id
);

1787 
£rvî
.
dúty
 +
dñëed
;

1788 
	`addRïlyL⁄gL⁄g
(
c
,
dñëed
);

1790 
˛ónup
:

1791 i‡(
øngëy≥
 =
ZRANGE_LEX
Ë
	`z¶FªeLexR™ge
(&
Àxønge
);

1792 
	}
}

1794 
	$zªmøngebyønkComm™d
(
˛õ¡
 *
c
) {

1795 
	`zªmøngeGíîicComm™d
(
c
,
ZRANGE_RANK
);

1796 
	}
}

1798 
	$zªmøngebysc‹eComm™d
(
˛õ¡
 *
c
) {

1799 
	`zªmøngeGíîicComm™d
(
c
,
ZRANGE_SCORE
);

1800 
	}
}

1802 
	$zªmøngebyÀxComm™d
(
˛õ¡
 *
c
) {

1803 
	`zªmøngeGíîicComm™d
(
c
,
ZRANGE_LEX
);

1804 
	}
}

1807 
robj
 *
	msubje˘
;

1808 
	mty≥
;

1809 
	mícodög
;

1810 
	mweight
;

1814 
	u_ôî£t
 {

1816 
öt£t
 *
	mis
;

1817 
	mii
;

1818 } 
	mis
;

1820 
di˘
 *
	mdi˘
;

1821 
di˘Iãøt‹
 *
	mdi
;

1822 
di˘E¡ry
 *
	mde
;

1823 } 
	mht
;

1824 } 
	m£t
;

1827 
	u_ôîz£t
 {

1829 *
	mzl
;

1830 *
	mïå
, *
	m•å
;

1831 } 
	mzl
;

1833 
z£t
 *
	mzs
;

1834 
zskùli°Node
 *
	mnode
;

1835 } 
	m¶
;

1836 } 
	mz£t
;

1837 } 
	môî
;

1838 } 
	tz£t›§c
;

1847 
	#OPVAL_DIRTY_SDS
 1

	)

1848 
	#OPVAL_DIRTY_LL
 2

	)

1849 
	#OPVAL_VALID_LL
 4

	)

1853 
	mÊags
;

1854 
	m_buf
[32];

1855 
sds
 
	mñe
;

1856 *
	me°r
;

1857 
	mñí
;

1858 
	mñl
;

1859 
	msc‹e
;

1860 } 
	tz£t›vÆ
;

1862 
_ôî£t
 
	tôî£t
;

1863 
_ôîz£t
 
	tôîz£t
;

1865 
	$zuiInôIãøt‹
(
z£t›§c
 *
›
) {

1866 i‡(
›
->
subje˘
 =
NULL
)

1869 i‡(
›
->
ty≥
 =
OBJ_SET
) {

1870 
ôî£t
 *
ô
 = &
›
->
ôî
.
£t
;

1871 i‡(
›
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

1872 
ô
->
is
.i†
›
->
subje˘
->
±r
;

1873 
ô
->
is
.
ii
 = 0;

1874 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_HT
) {

1875 
ô
->
ht
.
di˘
 = 
›
->
subje˘
->
±r
;

1876 
ô
->
ht
.
di
 = 
	`di˘GëIãøt‹
(
›
->
subje˘
->
±r
);

1877 
ô
->
ht
.
de
 = 
	`di˘Next
(ô->ht.
di
);

1879 
	`£rvîP™ic
("Unknown setÉncoding");

1881 } i‡(
›
->
ty≥
 =
OBJ_ZSET
) {

1882 
ôîz£t
 *
ô
 = &
›
->
ôî
.
z£t
;

1883 i‡(
›
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1884 
ô
->
zl
.z»
›
->
subje˘
->
±r
;

1885 
ô
->
zl
.
ïå
 = 
	`zùli°Index
(it->zl.zl,0);

1886 i‡(
ô
->
zl
.
ïå
 !
NULL
) {

1887 
ô
->
zl
.
•å
 = 
	`zùli°Next
(ô->zl.zl,ô->zl.
ïå
);

1888 
	`£rvîAs£π
(
ô
->
zl
.
•å
 !
NULL
);

1890 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1891 
ô
->
¶
.
zs
 = 
›
->
subje˘
->
±r
;

1892 
ô
->
¶
.
node
 = it->¶.
zs
->
z¶
->
hódî
->
Àvñ
[0].
f‹w¨d
;

1894 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1897 
	`£rvîP™ic
("UnsupportedÅype");

1899 
	}
}

1901 
	$zuiCÀ¨Iãøt‹
(
z£t›§c
 *
›
) {

1902 i‡(
›
->
subje˘
 =
NULL
)

1905 i‡(
›
->
ty≥
 =
OBJ_SET
) {

1906 
ôî£t
 *
ô
 = &
›
->
ôî
.
£t
;

1907 i‡(
›
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

1908 
	`UNUSED
(
ô
);

1909 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_HT
) {

1910 
	`di˘Rñó£Iãøt‹
(
ô
->
ht
.
di
);

1912 
	`£rvîP™ic
("Unknown setÉncoding");

1914 } i‡(
›
->
ty≥
 =
OBJ_ZSET
) {

1915 
ôîz£t
 *
ô
 = &
›
->
ôî
.
z£t
;

1916 i‡(
›
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1917 
	`UNUSED
(
ô
);

1918 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1919 
	`UNUSED
(
ô
);

1921 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1924 
	`£rvîP™ic
("UnsupportedÅype");

1926 
	}
}

1928 
	$zuiLígth
(
z£t›§c
 *
›
) {

1929 i‡(
›
->
subje˘
 =
NULL
)

1932 i‡(
›
->
ty≥
 =
OBJ_SET
) {

1933 i‡(
›
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

1934  
	`öt£tLí
(
›
->
subje˘
->
±r
);

1935 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_HT
) {

1936 
di˘
 *
ht
 = 
›
->
subje˘
->
±r
;

1937  
	`di˘Size
(
ht
);

1939 
	`£rvîP™ic
("Unknown setÉncoding");

1941 } i‡(
›
->
ty≥
 =
OBJ_ZSET
) {

1942 i‡(
›
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1943  
	`zzlLígth
(
›
->
subje˘
->
±r
);

1944 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

1945 
z£t
 *
zs
 = 
›
->
subje˘
->
±r
;

1946  
zs
->
z¶
->
Àngth
;

1948 
	`£rvîP™ic
("Unknown sorted setÉncoding");

1951 
	`£rvîP™ic
("UnsupportedÅype");

1953 
	}
}

1958 
	$zuiNext
(
z£t›§c
 *
›
, 
z£t›vÆ
 *
vÆ
) {

1959 i‡(
›
->
subje˘
 =
NULL
)

1962 i‡(
vÆ
->
Êags
 & 
OPVAL_DIRTY_SDS
)

1963 
	`sds‰ì
(
vÆ
->
ñe
);

1965 
	`mem£t
(
vÆ
,0,(
z£t›vÆ
));

1967 i‡(
›
->
ty≥
 =
OBJ_SET
) {

1968 
ôî£t
 *
ô
 = &
›
->
ôî
.
£t
;

1969 i‡(
›
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

1970 
öt64_t
 
ñl
;

1972 i‡(!
	`öt£tGë
(
ô
->
is
.is,ô->is.
ii
,&
ñl
))

1974 
vÆ
->
ñl
 =Éll;

1975 
vÆ
->
sc‹e
 = 1.0;

1978 
ô
->
is
.
ii
++;

1979 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_HT
) {

1980 i‡(
ô
->
ht
.
de
 =
NULL
)

1982 
vÆ
->
ñe
 = 
	`di˘GëKey
(
ô
->
ht
.
de
);

1983 
vÆ
->
sc‹e
 = 1.0;

1986 
ô
->
ht
.
de
 = 
	`di˘Next
(ô->ht.
di
);

1988 
	`£rvîP™ic
("Unknown setÉncoding");

1990 } i‡(
›
->
ty≥
 =
OBJ_ZSET
) {

1991 
ôîz£t
 *
ô
 = &
›
->
ôî
.
z£t
;

1992 i‡(
›
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

1994 i‡(
ô
->
zl
.
ïå
 =
NULL
 || it->zl.
•å
 == NULL)

1996 
	`£rvîAs£π
(
	`zùli°Gë
(
ô
->
zl
.
ïå
,&
vÆ
->
e°r
,&vÆ->
ñí
,&vÆ->
ñl
));

1997 
vÆ
->
sc‹e
 = 
	`zzlGëSc‹e
(
ô
->
zl
.
•å
);

2000 
	`zzlNext
(
ô
->
zl
.zl,&ô->zl.
ïå
,&ô->zl.
•å
);

2001 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2002 i‡(
ô
->
¶
.
node
 =
NULL
)

2004 
vÆ
->
ñe
 = 
ô
->
¶
.
node
->ele;

2005 
vÆ
->
sc‹e
 = 
ô
->
¶
.
node
->score;

2008 
ô
->
¶
.
node
 = it->¶.node->
Àvñ
[0].
f‹w¨d
;

2010 
	`£rvîP™ic
("Unknown sorted setÉncoding");

2013 
	`£rvîP™ic
("UnsupportedÅype");

2016 
	}
}

2018 
	$zuiL⁄gL⁄gFromVÆue
(
z£t›vÆ
 *
vÆ
) {

2019 i‡(!(
vÆ
->
Êags
 & 
OPVAL_DIRTY_LL
)) {

2020 
vÆ
->
Êags
 |
OPVAL_DIRTY_LL
;

2022 i‡(
vÆ
->
ñe
 !
NULL
) {

2023 i‡(
	`°rög2Œ
(
vÆ
->
ñe
,
	`sd¶í
(vÆ->ñe),&vÆ->
ñl
))

2024 
vÆ
->
Êags
 |
OPVAL_VALID_LL
;

2025 } i‡(
vÆ
->
e°r
 !
NULL
) {

2026 i‡(
	`°rög2Œ
((*)
vÆ
->
e°r
,vÆ->
ñí
,&vÆ->
ñl
))

2027 
vÆ
->
Êags
 |
OPVAL_VALID_LL
;

2030 
vÆ
->
Êags
 |
OPVAL_VALID_LL
;

2033  
vÆ
->
Êags
 & 
OPVAL_VALID_LL
;

2034 
	}
}

2036 
sds
 
	$zuiSdsFromVÆue
(
z£t›vÆ
 *
vÆ
) {

2037 i‡(
vÆ
->
ñe
 =
NULL
) {

2038 i‡(
vÆ
->
e°r
 !
NULL
) {

2039 
vÆ
->
ñe
 = 
	`sd¢ewÀn
((*)vÆ->
e°r
,vÆ->
ñí
);

2041 
vÆ
->
ñe
 = 
	`sds‰oml⁄gl⁄g
(vÆ->
ñl
);

2043 
vÆ
->
Êags
 |
OPVAL_DIRTY_SDS
;

2045  
vÆ
->
ñe
;

2046 
	}
}

2050 
sds
 
	$zuiNewSdsFromVÆue
(
z£t›vÆ
 *
vÆ
) {

2051 i‡(
vÆ
->
Êags
 & 
OPVAL_DIRTY_SDS
) {

2053 
sds
 
ñe
 = 
vÆ
->ele;

2054 
vÆ
->
Êags
 &~
OPVAL_DIRTY_SDS
;

2055 
vÆ
->
ñe
 = 
NULL
;

2056  
ñe
;

2057 } i‡(
vÆ
->
ñe
) {

2058  
	`sdsdup
(
vÆ
->
ñe
);

2059 } i‡(
vÆ
->
e°r
) {

2060  
	`sd¢ewÀn
((*)
vÆ
->
e°r
,vÆ->
ñí
);

2062  
	`sds‰oml⁄gl⁄g
(
vÆ
->
ñl
);

2064 
	}
}

2066 
	$zuiBuf„rFromVÆue
(
z£t›vÆ
 *
vÆ
) {

2067 i‡(
vÆ
->
e°r
 =
NULL
) {

2068 i‡(
vÆ
->
ñe
 !
NULL
) {

2069 
vÆ
->
ñí
 = 
	`sd¶í
(vÆ->
ñe
);

2070 
vÆ
->
e°r
 = (*)vÆ->
ñe
;

2072 
vÆ
->
ñí
 = 
	`Œ2°rög
((*)vÆ->
_buf
,(vÆ->_buf),vÆ->
ñl
);

2073 
vÆ
->
e°r
 = vÆ->
_buf
;

2077 
	}
}

2081 
	$zuiFöd
(
z£t›§c
 *
›
, 
z£t›vÆ
 *
vÆ
, *
sc‹e
) {

2082 i‡(
›
->
subje˘
 =
NULL
)

2085 i‡(
›
->
ty≥
 =
OBJ_SET
) {

2086 i‡(
›
->
ícodög
 =
OBJ_ENCODING_INTSET
) {

2087 i‡(
	`zuiL⁄gL⁄gFromVÆue
(
vÆ
) &&

2088 
	`öt£tFöd
(
›
->
subje˘
->
±r
,
vÆ
->
ñl
))

2090 *
sc‹e
 = 1.0;

2095 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_HT
) {

2096 
di˘
 *
ht
 = 
›
->
subje˘
->
±r
;

2097 
	`zuiSdsFromVÆue
(
vÆ
);

2098 i‡(
	`di˘Föd
(
ht
,
vÆ
->
ñe
Ë!
NULL
) {

2099 *
sc‹e
 = 1.0;

2105 
	`£rvîP™ic
("Unknown setÉncoding");

2107 } i‡(
›
->
ty≥
 =
OBJ_ZSET
) {

2108 
	`zuiSdsFromVÆue
(
vÆ
);

2110 i‡(
›
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2111 i‡(
	`zzlFöd
(
›
->
subje˘
->
±r
,
vÆ
->
ñe
,
sc‹e
Ë!
NULL
) {

2117 } i‡(
›
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2118 
z£t
 *
zs
 = 
›
->
subje˘
->
±r
;

2119 
di˘E¡ry
 *
de
;

2120 i‡((
de
 = 
	`di˘Föd
(
zs
->
di˘
,
vÆ
->
ñe
)Ë!
NULL
) {

2121 *
sc‹e
 = *(*)
	`di˘GëVÆ
(
de
);

2127 
	`£rvîP™ic
("Unknown sorted setÉncoding");

2130 
	`£rvîP™ic
("UnsupportedÅype");

2132 
	}
}

2134 
	$zuiCom∑ªByC¨döÆôy
(c⁄° *
s1
, c⁄° *
s2
) {

2135 
fú°
 = 
	`zuiLígth
((
z£t›§c
*)
s1
);

2136 
£c⁄d
 = 
	`zuiLígth
((
z£t›§c
*)
s2
);

2137 i‡(
fú°
 > 
£c⁄d
)  1;

2138 i‡(
fú°
 < 
£c⁄d
)  -1;

2140 
	}
}

2142 
	#REDIS_AGGR_SUM
 1

	)

2143 
	#REDIS_AGGR_MIN
 2

	)

2144 
	#REDIS_AGGR_MAX
 3

	)

2145 
	#zuni⁄I¡îDi˘VÆue
(
_e
Ë(
	`di˘GëVÆ
(_eË=
NULL
 ? 1.0 : *(*)di˘GëVÆ(_e))

	)

2147 
ölöe
 
	$zuni⁄I¡îAggªg©e
(*
èrgë
, 
vÆ
, 
aggªg©e
) {

2148 i‡(
aggªg©e
 =
REDIS_AGGR_SUM
) {

2149 *
èrgë
 = *èrgë + 
vÆ
;

2153 i‡(
	`i¢™
(*
èrgë
)) *target = 0.0;

2154 } i‡(
aggªg©e
 =
REDIS_AGGR_MIN
) {

2155 *
èrgë
 = 
vÆ
 < *target ? val : *target;

2156 } i‡(
aggªg©e
 =
REDIS_AGGR_MAX
) {

2157 *
èrgë
 = 
vÆ
 > *target ? val : *target;

2160 
	`£rvîP™ic
("Unknown ZUNION/INTERággregateÅype");

2162 
	}
}

2164 
uöt64_t
 
di˘SdsHash
(c⁄° *
key
);

2165 
di˘SdsKeyCom∑ª
(*
¥ivd©a
, c⁄° *
key1
, c⁄° *
key2
);

2167 
di˘Ty≥
 
	g£tAccumuœt‹Di˘Ty≥
 = {

2168 
di˘SdsHash
,

2169 
NULL
,

2170 
NULL
,

2171 
di˘SdsKeyCom∑ª
,

2172 
NULL
,

2173 
NULL


2176 
	$zuni⁄I¡îGíîicComm™d
(
˛õ¡
 *
c
, 
robj
 *
d°key
, 
›
) {

2177 
i
, 
j
;

2178 
£äum
;

2179 
aggªg©e
 = 
REDIS_AGGR_SUM
;

2180 
z£t›§c
 *
§c
;

2181 
z£t›vÆ
 
zvÆ
;

2182 
sds
 
tmp
;

2183 
size_t
 
maxññí
 = 0;

2184 
robj
 *
d°obj
;

2185 
z£t
 *
d°z£t
;

2186 
zskùli°Node
 *
znode
;

2187 
touched
 = 0;

2190 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
£äum
, 
NULL
Ë!
C_OK
))

2193 i‡(
£äum
 < 1) {

2194 
	`addRïlyEº‹
(
c
,

2200 i‡(
£äum
 > 
c
->
¨gc
-3) {

2201 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2206 
§c
 = 
	`zˇŒoc
((
z£t›§c
Ë* 
£äum
);

2207 
i
 = 0, 
j
 = 3; i < 
£äum
; i++, j++) {

2208 
robj
 *
obj
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[
j
]);

2209 i‡(
obj
 !
NULL
) {

2210 i‡(
obj
->
ty≥
 !
OBJ_ZSET
 && obj->ty≥ !
OBJ_SET
) {

2211 
	`z‰ì
(
§c
);

2212 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

2216 
§c
[
i
].
subje˘
 = 
obj
;

2217 
§c
[
i
].
ty≥
 = 
obj
->type;

2218 
§c
[
i
].
ícodög
 = 
obj
->encoding;

2220 
§c
[
i
].
subje˘
 = 
NULL
;

2224 
§c
[
i
].
weight
 = 1.0;

2228 i‡(
j
 < 
c
->
¨gc
) {

2229 
ªmaöög
 = 
c
->
¨gc
 - 
j
;

2231 
ªmaöög
) {

2232 i‡(
ªmaöög
 >(
£äum
 + 1) &&

2233 !
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"weights"))

2235 
j
++; 
ªmaöög
--;

2236 
i
 = 0; i < 
£äum
; i++, 
j
++, 
ªmaöög
--) {

2237 i‡(
	`gëDoubÀFromObje˘OrRïly
(
c
,c->
¨gv
[
j
],&
§c
[
i
].
weight
,

2238 "weighàvÆuêi†nŸá flﬂt"Ë!
C_OK
)

2240 
	`z‰ì
(
§c
);

2244 } i‡(
ªmaöög
 >= 2 &&

2245 !
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"aggregate"))

2247 
j
++; 
ªmaöög
--;

2248 i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"sum")) {

2249 
aggªg©e
 = 
REDIS_AGGR_SUM
;

2250 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"min")) {

2251 
aggªg©e
 = 
REDIS_AGGR_MIN
;

2252 } i‡(!
	`°rˇ£cmp
(
c
->
¨gv
[
j
]->
±r
,"max")) {

2253 
aggªg©e
 = 
REDIS_AGGR_MAX
;

2255 
	`z‰ì
(
§c
);

2256 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2259 
j
++; 
ªmaöög
--;

2261 
	`z‰ì
(
§c
);

2262 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2270 
	`qs‹t
(
§c
,
£äum
,(
z£t›§c
),
zuiCom∑ªByC¨döÆôy
);

2272 
d°obj
 = 
	`¸óãZ£tObje˘
();

2273 
d°z£t
 = 
d°obj
->
±r
;

2274 
	`mem£t
(&
zvÆ
, 0, (zval));

2276 i‡(
›
 =
SET_OP_INTER
) {

2278 i‡(
	`zuiLígth
(&
§c
[0]) > 0) {

2281 
	`zuiInôIãøt‹
(&
§c
[0]);

2282 
	`zuiNext
(&
§c
[0],&
zvÆ
)) {

2283 
sc‹e
, 
vÆue
;

2285 
sc‹e
 = 
§c
[0].
weight
 * 
zvÆ
.score;

2286 i‡(
	`i¢™
(
sc‹e
)) score = 0;

2288 
j
 = 1; j < 
£äum
; j++) {

2291 i‡(
§c
[
j
].
subje˘
 == src[0].subject) {

2292 
vÆue
 = 
zvÆ
.
sc‹e
*
§c
[
j
].
weight
;

2293 
	`zuni⁄I¡îAggªg©e
(&
sc‹e
,
vÆue
,
aggªg©e
);

2294 } i‡(
	`zuiFöd
(&
§c
[
j
],&
zvÆ
,&
vÆue
)) {

2295 
vÆue
 *
§c
[
j
].
weight
;

2296 
	`zuni⁄I¡îAggªg©e
(&
sc‹e
,
vÆue
,
aggªg©e
);

2303 i‡(
j
 =
£äum
) {

2304 
tmp
 = 
	`zuiNewSdsFromVÆue
(&
zvÆ
);

2305 
znode
 = 
	`z¶In£π
(
d°z£t
->
z¶
,
sc‹e
,
tmp
);

2306 
	`di˘Add
(
d°z£t
->
di˘
,
tmp
,&
znode
->
sc‹e
);

2307 i‡(
	`sd¶í
(
tmp
Ë> 
maxññí
) maxelelen = sdslen(tmp);

2310 
	`zuiCÀ¨Iãøt‹
(&
§c
[0]);

2312 } i‡(
›
 =
SET_OP_UNION
) {

2313 
di˘
 *
accumuœt‹
 = 
	`di˘Cª©e
(&
£tAccumuœt‹Di˘Ty≥
,
NULL
);

2314 
di˘Iãøt‹
 *
di
;

2315 
di˘E¡ry
 *
de
, *
exi°ög
;

2316 
sc‹e
;

2318 i‡(
£äum
) {

2321 
	`di˘Ex∑nd
(
accumuœt‹
,
	`zuiLígth
(&
§c
[
£äum
-1]));

2326 
i
 = 0; i < 
£äum
; i++) {

2327 i‡(
	`zuiLígth
(&
§c
[
i
]) == 0) ;

2329 
	`zuiInôIãøt‹
(&
§c
[
i
]);

2330 
	`zuiNext
(&
§c
[
i
],&
zvÆ
)) {

2332 
sc‹e
 = 
§c
[
i
].
weight
 * 
zvÆ
.score;

2333 i‡(
	`i¢™
(
sc‹e
)) score = 0;

2336 
de
 = 
	`di˘AddRaw
(
accumuœt‹
,
	`zuiSdsFromVÆue
(&
zvÆ
),&
exi°ög
);

2338 i‡(!
exi°ög
) {

2339 
tmp
 = 
	`zuiNewSdsFromVÆue
(&
zvÆ
);

2343 i‡(
	`sd¶í
(
tmp
Ë> 
maxññí
) maxelelen = sdslen(tmp);

2345 
	`di˘SëKey
(
accumuœt‹
, 
de
, 
tmp
);

2346 
	`di˘SëDoubÀVÆ
(
de
,
sc‹e
);

2354 
	`zuni⁄I¡îAggªg©e
(&
exi°ög
->
v
.
d
,
sc‹e
,
aggªg©e
);

2357 
	`zuiCÀ¨Iãøt‹
(&
§c
[
i
]);

2361 
di
 = 
	`di˘GëIãøt‹
(
accumuœt‹
);

2366 
	`di˘Ex∑nd
(
d°z£t
->
di˘
,
	`di˘Size
(
accumuœt‹
));

2368 (
de
 = 
	`di˘Next
(
di
)Ë!
NULL
) {

2369 
sds
 
ñe
 = 
	`di˘GëKey
(
de
);

2370 
sc‹e
 = 
	`di˘GëDoubÀVÆ
(
de
);

2371 
znode
 = 
	`z¶In£π
(
d°z£t
->
z¶
,
sc‹e
,
ñe
);

2372 
	`di˘Add
(
d°z£t
->
di˘
,
ñe
,&
znode
->
sc‹e
);

2374 
	`di˘Rñó£Iãøt‹
(
di
);

2375 
	`di˘Rñó£
(
accumuœt‹
);

2377 
	`£rvîP™ic
("Unknown operator");

2380 i‡(
	`dbDñëe
(
c
->
db
,
d°key
))

2381 
touched
 = 1;

2382 i‡(
d°z£t
->
z¶
->
Àngth
) {

2383 
	`z£tC⁄vîtToZùli°IfNìded
(
d°obj
,
maxññí
);

2384 
	`dbAdd
(
c
->
db
,
d°key
,
d°obj
);

2385 
	`addRïlyL⁄gL⁄g
(
c
,
	`z£tLígth
(
d°obj
));

2386 
	`sig«lModifõdKey
(
c
,c->
db
,
d°key
);

2387 
	`nŸifyKey•a˚Evít
(
NOTIFY_ZSET
,

2388 (
›
 =
SET_OP_UNION
) ? "zunionstore" : "zinterstore",

2389 
d°key
,
c
->
db
->
id
);

2390 
£rvî
.
dúty
++;

2392 
	`de¸RefCou¡
(
d°obj
);

2393 
	`addRïly
(
c
,
sh¨ed
.
czîo
);

2394 i‡(
touched
) {

2395 
	`sig«lModifõdKey
(
c
,c->
db
,
d°key
);

2396 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
d°key
,
c
->
db
->
id
);

2397 
£rvî
.
dúty
++;

2400 
	`z‰ì
(
§c
);

2401 
	}
}

2403 
	$zuni⁄°‹eComm™d
(
˛õ¡
 *
c
) {

2404 
	`zuni⁄I¡îGíîicComm™d
(
c
,c->
¨gv
[1], 
SET_OP_UNION
);

2405 
	}
}

2407 
	$zöãr°‹eComm™d
(
˛õ¡
 *
c
) {

2408 
	`zuni⁄I¡îGíîicComm™d
(
c
,c->
¨gv
[1], 
SET_OP_INTER
);

2409 
	}
}

2411 
	$zøngeGíîicComm™d
(
˛õ¡
 *
c
, 
ªvî£
) {

2412 
robj
 *
key
 = 
c
->
¨gv
[1];

2413 
robj
 *
zobj
;

2414 
wôhsc‹es
 = 0;

2415 
°¨t
;

2416 
íd
;

2417 
Œí
;

2418 
øngñí
;

2420 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[2], &
°¨t
, 
NULL
Ë!
C_OK
) ||

2421 (
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[3], &
íd
, 
NULL
Ë!
C_OK
)) ;

2423 i‡(
c
->
¨gc
 =5 && !
	`°rˇ£cmp
(c->
¨gv
[4]->
±r
,"withscores")) {

2424 
wôhsc‹es
 = 1;

2425 } i‡(
c
->
¨gc
 >= 5) {

2426 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2430 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
,
key
,
sh¨ed
.
em±y¨øy
)Ë=
NULL


2431 || 
	`checkTy≥
(
c
,
zobj
,
OBJ_ZSET
)) ;

2434 
Œí
 = 
	`z£tLígth
(
zobj
);

2435 i‡(
°¨t
 < 0Ë°¨à
Œí
+start;

2436 i‡(
íd
 < 0Ëíd = 
Œí
+end;

2437 i‡(
°¨t
 < 0) start = 0;

2441 i‡(
°¨t
 > 
íd
 || sèπ >
Œí
) {

2442 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

2445 i‡(
íd
 >
Œí
)Énd =Ülen-1;

2446 
øngñí
 = (
íd
-
°¨t
)+1;

2451 i‡(
wôhsc‹es
 && 
c
->
ª•
 == 2)

2452 
	`addRïlyAºayLí
(
c
, 
øngñí
*2);

2454 
	`addRïlyAºayLí
(
c
, 
øngñí
);

2456 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2457 *
zl
 = 
zobj
->
±r
;

2458 *
ïå
, *
•å
;

2459 *
v°r
;

2460 
vÀn
;

2461 
vl⁄g
;

2463 i‡(
ªvî£
)

2464 
ïå
 = 
	`zùli°Index
(
zl
,-2-(2*
°¨t
));

2466 
ïå
 = 
	`zùli°Index
(
zl
,2*
°¨t
);

2468 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
ïå
 !
NULL
);

2469 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

2471 
øngñí
--) {

2472 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
ïå
 !
NULL
 && 
•å
 != NULL);

2473 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
	`zùli°Gë
(
ïå
,&
v°r
,&
vÀn
,&
vl⁄g
));

2475 i‡(
wôhsc‹es
 && 
c
->
ª•
 > 2Ë
	`addRïlyAºayLí
(c,2);

2476 i‡(
v°r
 =
NULL
)

2477 
	`addRïlyBulkL⁄gL⁄g
(
c
,
vl⁄g
);

2479 
	`addRïlyBulkCBuf„r
(
c
,
v°r
,
vÀn
);

2480 i‡(
wôhsc‹es
Ë
	`addRïlyDoubÀ
(
c
,
	`zzlGëSc‹e
(
•å
));

2482 i‡(
ªvî£
)

2483 
	`zzlPªv
(
zl
,&
ïå
,&
•å
);

2485 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

2488 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2489 
z£t
 *
zs
 = 
zobj
->
±r
;

2490 
zskùli°
 *
z¶
 = 
zs
->zsl;

2491 
zskùli°Node
 *
 
;

2492 
sds
 
ñe
;

2495 i‡(
ªvî£
) {

2496 
 
 = 
z¶
->
èû
;

2497 i‡(
°¨t
 > 0)

2498 
 
 = 
	`z¶GëEÀmítByR™k
(
z¶
,
Œí
-
°¨t
);

2500 
 
 = 
z¶
->
hódî
->
Àvñ
[0].
f‹w¨d
;

2501 i‡(
°¨t
 > 0)

2502 
 
 = 
	`z¶GëEÀmítByR™k
(
z¶
,
°¨t
+1);

2505 
øngñí
--) {

2506 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
 
 !
NULL
);

2507 
ñe
 = 
 
->ele;

2508 i‡(
wôhsc‹es
 && 
c
->
ª•
 > 2Ë
	`addRïlyAºayLí
(c,2);

2509 
	`addRïlyBulkCBuf„r
(
c
,
ñe
,
	`sd¶í
(ele));

2510 i‡(
wôhsc‹es
Ë
	`addRïlyDoubÀ
(
c
,
 
->
sc‹e
);

2511 
 
 = 
ªvî£
 ?Ün->
backw¨d
 :Ün->
Àvñ
[0].
f‹w¨d
;

2514 
	`£rvîP™ic
("Unknown sorted setÉncoding");

2516 
	}
}

2518 
	$zøngeComm™d
(
˛õ¡
 *
c
) {

2519 
	`zøngeGíîicComm™d
(
c
,0);

2520 
	}
}

2522 
	$zªvøngeComm™d
(
˛õ¡
 *
c
) {

2523 
	`zøngeGíîicComm™d
(
c
,1);

2524 
	}
}

2527 
	$gíîicZøngebysc‹eComm™d
(
˛õ¡
 *
c
, 
ªvî£
) {

2528 
zønge•ec
 
ønge
;

2529 
robj
 *
key
 = 
c
->
¨gv
[1];

2530 
robj
 *
zobj
;

2531 
off£t
 = 0, 
limô
 = -1;

2532 
wôhsc‹es
 = 0;

2533 
øngñí
 = 0;

2534 *
ª∂yÀn
 = 
NULL
;

2535 
möidx
, 
maxidx
;

2538 i‡(
ªvî£
) {

2540 
maxidx
 = 2; 
möidx
 = 3;

2543 
möidx
 = 2; 
maxidx
 = 3;

2546 i‡(
	`z¶P¨£R™ge
(
c
->
¨gv
[
möidx
],c->¨gv[
maxidx
],&
ønge
Ë!
C_OK
) {

2547 
	`addRïlyEº‹
(
c
,"min or max isÇotá float");

2553 i‡(
c
->
¨gc
 > 4) {

2554 
ªmaöög
 = 
c
->
¨gc
 - 4;

2555 
pos
 = 4;

2557 
ªmaöög
) {

2558 i‡(
ªmaöög
 >1 && !
	`°rˇ£cmp
(
c
->
¨gv
[
pos
]->
±r
,"withscores")) {

2559 
pos
++; 
ªmaöög
--;

2560 
wôhsc‹es
 = 1;

2561 } i‡(
ªmaöög
 >3 && !
	`°rˇ£cmp
(
c
->
¨gv
[
pos
]->
±r
,"limit")) {

2562 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[
pos
+1], &
off£t
, 
NULL
)

2563 !
C_OK
) ||

2564 (
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[
pos
+2], &
limô
, 
NULL
)

2565 !
C_OK
))

2569 
pos
 +3; 
ªmaöög
 -= 3;

2571 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2578 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
,
key
,
sh¨ed
.
em±y¨øy
)Ë=
NULL
 ||

2579 
	`checkTy≥
(
c
,
zobj
,
OBJ_ZSET
)) ;

2581 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2582 *
zl
 = 
zobj
->
±r
;

2583 *
ïå
, *
•å
;

2584 *
v°r
;

2585 
vÀn
;

2586 
vl⁄g
;

2587 
sc‹e
;

2590 i‡(
ªvî£
) {

2591 
ïå
 = 
	`zzlLa°InR™ge
(
zl
,&
ønge
);

2593 
ïå
 = 
	`zzlFú°InR™ge
(
zl
,&
ønge
);

2597 i‡(
ïå
 =
NULL
) {

2598 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

2603 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
ïå
 !
NULL
);

2604 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

2609 
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

2613 
ïå
 && 
off£t
--) {

2614 i‡(
ªvî£
) {

2615 
	`zzlPªv
(
zl
,&
ïå
,&
•å
);

2617 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

2621 
ïå
 && 
limô
--) {

2622 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

2625 i‡(
ªvî£
) {

2626 i‡(!
	`z¶VÆueGãMö
(
sc‹e
,&
ønge
)) ;

2628 i‡(!
	`z¶VÆueLãMax
(
sc‹e
,&
ønge
)) ;

2633 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
	`zùli°Gë
(
ïå
,&
v°r
,&
vÀn
,&
vl⁄g
));

2635 
øngñí
++;

2636 i‡(
wôhsc‹es
 && 
c
->
ª•
 > 2Ë
	`addRïlyAºayLí
(c,2);

2637 i‡(
v°r
 =
NULL
) {

2638 
	`addRïlyBulkL⁄gL⁄g
(
c
,
vl⁄g
);

2640 
	`addRïlyBulkCBuf„r
(
c
,
v°r
,
vÀn
);

2642 i‡(
wôhsc‹es
Ë
	`addRïlyDoubÀ
(
c
,
sc‹e
);

2645 i‡(
ªvî£
) {

2646 
	`zzlPªv
(
zl
,&
ïå
,&
•å
);

2648 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

2651 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2652 
z£t
 *
zs
 = 
zobj
->
±r
;

2653 
zskùli°
 *
z¶
 = 
zs
->zsl;

2654 
zskùli°Node
 *
 
;

2657 i‡(
ªvî£
) {

2658 
 
 = 
	`z¶La°InR™ge
(
z¶
,&
ønge
);

2660 
 
 = 
	`z¶Fú°InR™ge
(
z¶
,&
ønge
);

2664 i‡(
 
 =
NULL
) {

2665 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

2672 
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

2676 
 
 && 
off£t
--) {

2677 i‡(
ªvî£
) {

2678 
 
 =Ün->
backw¨d
;

2680 
 
 =Ün->
Àvñ
[0].
f‹w¨d
;

2684 
 
 && 
limô
--) {

2686 i‡(
ªvî£
) {

2687 i‡(!
	`z¶VÆueGãMö
(
 
->
sc‹e
,&
ønge
)) ;

2689 i‡(!
	`z¶VÆueLãMax
(
 
->
sc‹e
,&
ønge
)) ;

2692 
øngñí
++;

2693 i‡(
wôhsc‹es
 && 
c
->
ª•
 > 2Ë
	`addRïlyAºayLí
(c,2);

2694 
	`addRïlyBulkCBuf„r
(
c
,
 
->
ñe
,
	`sd¶í
(ln->ele));

2695 i‡(
wôhsc‹es
Ë
	`addRïlyDoubÀ
(
c
,
 
->
sc‹e
);

2698 i‡(
ªvî£
) {

2699 
 
 =Ün->
backw¨d
;

2701 
 
 =Ün->
Àvñ
[0].
f‹w¨d
;

2705 
	`£rvîP™ic
("Unknown sorted setÉncoding");

2708 i‡(
wôhsc‹es
 && 
c
->
ª•
 =2Ë
øngñí
 *= 2;

2709 
	`£tDe„ºedAºayLí
(
c
, 
ª∂yÀn
, 
øngñí
);

2710 
	}
}

2712 
	$zøngebysc‹eComm™d
(
˛õ¡
 *
c
) {

2713 
	`gíîicZøngebysc‹eComm™d
(
c
,0);

2714 
	}
}

2716 
	$zªvøngebysc‹eComm™d
(
˛õ¡
 *
c
) {

2717 
	`gíîicZøngebysc‹eComm™d
(
c
,1);

2718 
	}
}

2720 
	$zcou¡Comm™d
(
˛õ¡
 *
c
) {

2721 
robj
 *
key
 = 
c
->
¨gv
[1];

2722 
robj
 *
zobj
;

2723 
zønge•ec
 
ønge
;

2724 
cou¡
 = 0;

2727 i‡(
	`z¶P¨£R™ge
(
c
->
¨gv
[2],c->¨gv[3],&
ønge
Ë!
C_OK
) {

2728 
	`addRïlyEº‹
(
c
,"min or max isÇotá float");

2733 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
, 
key
, 
sh¨ed
.
czîo
)Ë=
NULL
 ||

2734 
	`checkTy≥
(
c
, 
zobj
, 
OBJ_ZSET
)) ;

2736 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2737 *
zl
 = 
zobj
->
±r
;

2738 *
ïå
, *
•å
;

2739 
sc‹e
;

2742 
ïå
 = 
	`zzlFú°InR™ge
(
zl
,&
ønge
);

2745 i‡(
ïå
 =
NULL
) {

2746 
	`addRïly
(
c
, 
sh¨ed
.
czîo
);

2751 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

2752 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

2753 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
	`z¶VÆueLãMax
(
sc‹e
,&
ønge
));

2756 
ïå
) {

2757 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

2760 i‡(!
	`z¶VÆueLãMax
(
sc‹e
,&
ønge
)) {

2763 
cou¡
++;

2764 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

2767 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2768 
z£t
 *
zs
 = 
zobj
->
±r
;

2769 
zskùli°
 *
z¶
 = 
zs
->zsl;

2770 
zskùli°Node
 *
zn
;

2771 
ønk
;

2774 
zn
 = 
	`z¶Fú°InR™ge
(
z¶
, &
ønge
);

2777 i‡(
zn
 !
NULL
) {

2778 
ønk
 = 
	`z¶GëR™k
(
z¶
, 
zn
->
sc‹e
, zn->
ñe
);

2779 
cou¡
 = (
z¶
->
Àngth
 - (
ønk
 - 1));

2782 
zn
 = 
	`z¶La°InR™ge
(
z¶
, &
ønge
);

2785 i‡(
zn
 !
NULL
) {

2786 
ønk
 = 
	`z¶GëR™k
(
z¶
, 
zn
->
sc‹e
, zn->
ñe
);

2787 
cou¡
 -(
z¶
->
Àngth
 - 
ønk
);

2791 
	`£rvîP™ic
("Unknown sorted setÉncoding");

2794 
	`addRïlyL⁄gL⁄g
(
c
, 
cou¡
);

2795 
	}
}

2797 
	$zÀxcou¡Comm™d
(
˛õ¡
 *
c
) {

2798 
robj
 *
key
 = 
c
->
¨gv
[1];

2799 
robj
 *
zobj
;

2800 
zÀxønge•ec
 
ønge
;

2801 
cou¡
 = 0;

2804 i‡(
	`z¶P¨£LexR™ge
(
c
->
¨gv
[2],c->¨gv[3],&
ønge
Ë!
C_OK
) {

2805 
	`addRïlyEº‹
(
c
,"min or maxÇot valid stringÑange item");

2810 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
, 
key
, 
sh¨ed
.
czîo
)Ë=
NULL
 ||

2811 
	`checkTy≥
(
c
, 
zobj
, 
OBJ_ZSET
))

2813 
	`z¶FªeLexR™ge
(&
ønge
);

2817 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2818 *
zl
 = 
zobj
->
±r
;

2819 *
ïå
, *
•å
;

2822 
ïå
 = 
	`zzlFú°InLexR™ge
(
zl
,&
ønge
);

2825 i‡(
ïå
 =
NULL
) {

2826 
	`z¶FªeLexR™ge
(&
ønge
);

2827 
	`addRïly
(
c
, 
sh¨ed
.
czîo
);

2832 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

2833 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
	`zzlLexVÆueLãMax
(
ïå
,&
ønge
));

2836 
ïå
) {

2838 i‡(!
	`zzlLexVÆueLãMax
(
ïå
,&
ønge
)) {

2841 
cou¡
++;

2842 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

2845 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2846 
z£t
 *
zs
 = 
zobj
->
±r
;

2847 
zskùli°
 *
z¶
 = 
zs
->zsl;

2848 
zskùli°Node
 *
zn
;

2849 
ønk
;

2852 
zn
 = 
	`z¶Fú°InLexR™ge
(
z¶
, &
ønge
);

2855 i‡(
zn
 !
NULL
) {

2856 
ønk
 = 
	`z¶GëR™k
(
z¶
, 
zn
->
sc‹e
, zn->
ñe
);

2857 
cou¡
 = (
z¶
->
Àngth
 - (
ønk
 - 1));

2860 
zn
 = 
	`z¶La°InLexR™ge
(
z¶
, &
ønge
);

2863 i‡(
zn
 !
NULL
) {

2864 
ønk
 = 
	`z¶GëR™k
(
z¶
, 
zn
->
sc‹e
, zn->
ñe
);

2865 
cou¡
 -(
z¶
->
Àngth
 - 
ønk
);

2869 
	`£rvîP™ic
("Unknown sorted setÉncoding");

2872 
	`z¶FªeLexR™ge
(&
ønge
);

2873 
	`addRïlyL⁄gL⁄g
(
c
, 
cou¡
);

2874 
	}
}

2877 
	$gíîicZøngebyÀxComm™d
(
˛õ¡
 *
c
, 
ªvî£
) {

2878 
zÀxønge•ec
 
ønge
;

2879 
robj
 *
key
 = 
c
->
¨gv
[1];

2880 
robj
 *
zobj
;

2881 
off£t
 = 0, 
limô
 = -1;

2882 
øngñí
 = 0;

2883 *
ª∂yÀn
 = 
NULL
;

2884 
möidx
, 
maxidx
;

2887 i‡(
ªvî£
) {

2889 
maxidx
 = 2; 
möidx
 = 3;

2892 
möidx
 = 2; 
maxidx
 = 3;

2895 i‡(
	`z¶P¨£LexR™ge
(
c
->
¨gv
[
möidx
],c->¨gv[
maxidx
],&
ønge
Ë!
C_OK
) {

2896 
	`addRïlyEº‹
(
c
,"min or maxÇot valid stringÑange item");

2902 i‡(
c
->
¨gc
 > 4) {

2903 
ªmaöög
 = 
c
->
¨gc
 - 4;

2904 
pos
 = 4;

2906 
ªmaöög
) {

2907 i‡(
ªmaöög
 >3 && !
	`°rˇ£cmp
(
c
->
¨gv
[
pos
]->
±r
,"limit")) {

2908 i‡((
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[
pos
+1], &
off£t
, 
NULL
Ë!
C_OK
) ||

2909 (
	`gëL⁄gFromObje˘OrRïly
(
c
, c->
¨gv
[
pos
+2], &
limô
, 
NULL
Ë!
C_OK
)) {

2910 
	`z¶FªeLexR™ge
(&
ønge
);

2913 
pos
 +3; 
ªmaöög
 -= 3;

2915 
	`z¶FªeLexR™ge
(&
ønge
);

2916 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

2923 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
,
key
,
sh¨ed
.
em±y¨øy
)Ë=
NULL
 ||

2924 
	`checkTy≥
(
c
,
zobj
,
OBJ_ZSET
))

2926 
	`z¶FªeLexR™ge
(&
ønge
);

2930 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

2931 *
zl
 = 
zobj
->
±r
;

2932 *
ïå
, *
•å
;

2933 *
v°r
;

2934 
vÀn
;

2935 
vl⁄g
;

2938 i‡(
ªvî£
) {

2939 
ïå
 = 
	`zzlLa°InLexR™ge
(
zl
,&
ønge
);

2941 
ïå
 = 
	`zzlFú°InLexR™ge
(
zl
,&
ønge
);

2945 i‡(
ïå
 =
NULL
) {

2946 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

2947 
	`z¶FªeLexR™ge
(&
ønge
);

2952 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
ïå
 !
NULL
);

2953 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

2958 
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

2962 
ïå
 && 
off£t
--) {

2963 i‡(
ªvî£
) {

2964 
	`zzlPªv
(
zl
,&
ïå
,&
•å
);

2966 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

2970 
ïå
 && 
limô
--) {

2972 i‡(
ªvî£
) {

2973 i‡(!
	`zzlLexVÆueGãMö
(
ïå
,&
ønge
)) ;

2975 i‡(!
	`zzlLexVÆueLãMax
(
ïå
,&
ønge
)) ;

2980 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
	`zùli°Gë
(
ïå
,&
v°r
,&
vÀn
,&
vl⁄g
));

2982 
øngñí
++;

2983 i‡(
v°r
 =
NULL
) {

2984 
	`addRïlyBulkL⁄gL⁄g
(
c
,
vl⁄g
);

2986 
	`addRïlyBulkCBuf„r
(
c
,
v°r
,
vÀn
);

2990 i‡(
ªvî£
) {

2991 
	`zzlPªv
(
zl
,&
ïå
,&
•å
);

2993 
	`zzlNext
(
zl
,&
ïå
,&
•å
);

2996 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

2997 
z£t
 *
zs
 = 
zobj
->
±r
;

2998 
zskùli°
 *
z¶
 = 
zs
->zsl;

2999 
zskùli°Node
 *
 
;

3002 i‡(
ªvî£
) {

3003 
 
 = 
	`z¶La°InLexR™ge
(
z¶
,&
ønge
);

3005 
 
 = 
	`z¶Fú°InLexR™ge
(
z¶
,&
ønge
);

3009 i‡(
 
 =
NULL
) {

3010 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

3011 
	`z¶FªeLexR™ge
(&
ønge
);

3018 
ª∂yÀn
 = 
	`addRïlyDe„ºedLí
(
c
);

3022 
 
 && 
off£t
--) {

3023 i‡(
ªvî£
) {

3024 
 
 =Ün->
backw¨d
;

3026 
 
 =Ün->
Àvñ
[0].
f‹w¨d
;

3030 
 
 && 
limô
--) {

3032 i‡(
ªvî£
) {

3033 i‡(!
	`z¶LexVÆueGãMö
(
 
->
ñe
,&
ønge
)) ;

3035 i‡(!
	`z¶LexVÆueLãMax
(
 
->
ñe
,&
ønge
)) ;

3038 
øngñí
++;

3039 
	`addRïlyBulkCBuf„r
(
c
,
 
->
ñe
,
	`sd¶í
(ln->ele));

3042 i‡(
ªvî£
) {

3043 
 
 =Ün->
backw¨d
;

3045 
 
 =Ün->
Àvñ
[0].
f‹w¨d
;

3049 
	`£rvîP™ic
("Unknown sorted setÉncoding");

3052 
	`z¶FªeLexR™ge
(&
ønge
);

3053 
	`£tDe„ºedAºayLí
(
c
, 
ª∂yÀn
, 
øngñí
);

3054 
	}
}

3056 
	$zøngebyÀxComm™d
(
˛õ¡
 *
c
) {

3057 
	`gíîicZøngebyÀxComm™d
(
c
,0);

3058 
	}
}

3060 
	$zªvøngebyÀxComm™d
(
˛õ¡
 *
c
) {

3061 
	`gíîicZøngebyÀxComm™d
(
c
,1);

3062 
	}
}

3064 
	$zˇrdComm™d
(
˛õ¡
 *
c
) {

3065 
robj
 *
key
 = 
c
->
¨gv
[1];

3066 
robj
 *
zobj
;

3068 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
,
key
,
sh¨ed
.
czîo
)Ë=
NULL
 ||

3069 
	`checkTy≥
(
c
,
zobj
,
OBJ_ZSET
)) ;

3071 
	`addRïlyL⁄gL⁄g
(
c
,
	`z£tLígth
(
zobj
));

3072 
	}
}

3074 
	$zsc‹eComm™d
(
˛õ¡
 *
c
) {

3075 
robj
 *
key
 = 
c
->
¨gv
[1];

3076 
robj
 *
zobj
;

3077 
sc‹e
;

3079 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
,
key
,
sh¨ed
.
nuŒ
[c->
ª•
])Ë=
NULL
 ||

3080 
	`checkTy≥
(
c
,
zobj
,
OBJ_ZSET
)) ;

3082 i‡(
	`z£tSc‹e
(
zobj
,
c
->
¨gv
[2]->
±r
,&
sc‹e
Ë=
C_ERR
) {

3083 
	`addRïlyNuŒ
(
c
);

3085 
	`addRïlyDoubÀ
(
c
,
sc‹e
);

3087 
	}
}

3089 
	$zønkGíîicComm™d
(
˛õ¡
 *
c
, 
ªvî£
) {

3090 
robj
 *
key
 = 
c
->
¨gv
[1];

3091 
robj
 *
ñe
 = 
c
->
¨gv
[2];

3092 
robj
 *
zobj
;

3093 
ønk
;

3095 i‡((
zobj
 = 
	`lookupKeyRódOrRïly
(
c
,
key
,
sh¨ed
.
nuŒ
[c->
ª•
])Ë=
NULL
 ||

3096 
	`checkTy≥
(
c
,
zobj
,
OBJ_ZSET
)) ;

3098 
	`£rvîAs£πWôhInfo
(
c
,
ñe
,
	`sdsEncodedObje˘
(ele));

3099 
ønk
 = 
	`z£tR™k
(
zobj
,
ñe
->
±r
,
ªvî£
);

3100 i‡(
ønk
 >= 0) {

3101 
	`addRïlyL⁄gL⁄g
(
c
,
ønk
);

3103 
	`addRïlyNuŒ
(
c
);

3105 
	}
}

3107 
	$zønkComm™d
(
˛õ¡
 *
c
) {

3108 
	`zønkGíîicComm™d
(
c
, 0);

3109 
	}
}

3111 
	$zªvønkComm™d
(
˛õ¡
 *
c
) {

3112 
	`zønkGíîicComm™d
(
c
, 1);

3113 
	}
}

3115 
	$zsˇnComm™d
(
˛õ¡
 *
c
) {

3116 
robj
 *
o
;

3117 
curs‹
;

3119 i‡(
	`∑r£SˇnCurs‹OrRïly
(
c
,c->
¨gv
[2],&
curs‹
Ë=
C_ERR
) ;

3120 i‡((
o
 = 
	`lookupKeyRódOrRïly
(
c
,c->
¨gv
[1],
sh¨ed
.
em±ysˇn
)Ë=
NULL
 ||

3121 
	`checkTy≥
(
c
,
o
,
OBJ_ZSET
)) ;

3122 
	`sˇnGíîicComm™d
(
c
,
o
,
curs‹
);

3123 
	}
}

3134 
	$gíîicZp›Comm™d
(
˛õ¡
 *
c
, 
robj
 **
keyv
, 
keyc
, 
whîe
, 
emôkey
,Ñobj *
cou¡¨g
) {

3135 
idx
;

3136 
robj
 *
key
 = 
NULL
;

3137 
robj
 *
zobj
 = 
NULL
;

3138 
sds
 
ñe
;

3139 
sc‹e
;

3140 
cou¡
 = 1;

3143 i‡(
cou¡¨g
) {

3144 i‡(
	`gëL⁄gFromObje˘OrRïly
(
c
,
cou¡¨g
,&
cou¡
,
NULL
Ë!
C_OK
)

3146 i‡(
cou¡
 <= 0) {

3147 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

3153 
idx
 = 0;

3154 
idx
 < 
keyc
) {

3155 
key
 = 
keyv
[
idx
++];

3156 
zobj
 = 
	`lookupKeyWrôe
(
c
->
db
,
key
);

3157 i‡(!
zobj
) ;

3158 i‡(
	`checkTy≥
(
c
,
zobj
,
OBJ_ZSET
)) ;

3163 i‡(!
zobj
) {

3164 
	`addRïly
(
c
,
sh¨ed
.
em±y¨øy
);

3168 *
¨øyÀn_±r
 = 
	`addRïlyDe„ºedLí
(
c
);

3169 
¨øyÀn
 = 0;

3172 i‡(
emôkey
Ë
	`addRïlyBulk
(
c
,
key
);

3176 i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_ZIPLIST
) {

3177 *
zl
 = 
zobj
->
±r
;

3178 *
ïå
, *
•å
;

3179 *
v°r
;

3180 
vÀn
;

3181 
vl⁄g
;

3184 
ïå
 = 
	`zùli°Index
(
zl
,
whîe
 =
ZSET_MAX
 ? -2 : 0);

3185 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
ïå
 !
NULL
);

3186 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
	`zùli°Gë
(
ïå
,&
v°r
,&
vÀn
,&
vl⁄g
));

3187 i‡(
v°r
 =
NULL
)

3188 
ñe
 = 
	`sds‰oml⁄gl⁄g
(
vl⁄g
);

3190 
ñe
 = 
	`sd¢ewÀn
(
v°r
,
vÀn
);

3193 
•å
 = 
	`zùli°Next
(
zl
,
ïå
);

3194 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
•å
 !
NULL
);

3195 
sc‹e
 = 
	`zzlGëSc‹e
(
•å
);

3196 } i‡(
zobj
->
ícodög
 =
OBJ_ENCODING_SKIPLIST
) {

3197 
z£t
 *
zs
 = 
zobj
->
±r
;

3198 
zskùli°
 *
z¶
 = 
zs
->zsl;

3199 
zskùli°Node
 *
z 
;

3202 
z 
 = (
whîe
 =
ZSET_MAX
 ? 
z¶
->
èû
 :

3203 
z¶
->
hódî
->
Àvñ
[0].
f‹w¨d
);

3206 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
z 
 !
NULL
);

3207 
ñe
 = 
	`sdsdup
(
z 
->ele);

3208 
sc‹e
 = 
z 
->score;

3210 
	`£rvîP™ic
("Unknown sorted setÉncoding");

3213 
	`£rvîAs£πWôhInfo
(
c
,
zobj
,
	`z£tDñ
(zobj,
ñe
));

3214 
£rvî
.
dúty
++;

3216 i‡(
¨øyÀn
 == 0) {

3217 *
evíts
[2] = {"zpopmin","zpopmax"};

3218 
	`nŸifyKey•a˚Evít
(
NOTIFY_ZSET
,
evíts
[
whîe
],
key
,
c
->
db
->
id
);

3219 
	`sig«lModifõdKey
(
c
,c->
db
,
key
);

3222 
	`addRïlyBulkCBuf„r
(
c
,
ñe
,
	`sd¶í
(ele));

3223 
	`addRïlyDoubÀ
(
c
,
sc‹e
);

3224 
	`sds‰ì
(
ñe
);

3225 
¨øyÀn
 += 2;

3228 i‡(
	`z£tLígth
(
zobj
) == 0) {

3229 
	`dbDñëe
(
c
->
db
,
key
);

3230 
	`nŸifyKey•a˚Evít
(
NOTIFY_GENERIC
,"dñ",
key
,
c
->
db
->
id
);

3233 } --
cou¡
);

3235 
	`£tDe„ºedAºayLí
(
c
,
¨øyÀn_±r
,
¨øyÀn
 + (
emôkey
 != 0));

3236 
	}
}

3239 
	$zp›möComm™d
(
˛õ¡
 *
c
) {

3240 i‡(
c
->
¨gc
 > 3) {

3241 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

3244 
	`gíîicZp›Comm™d
(
c
,&c->
¨gv
[1],1,
ZSET_MIN
,0,

3245 
c
->
¨gc
 =3 ? c->
¨gv
[2] : 
NULL
);

3246 
	}
}

3249 
	$zp›maxComm™d
(
˛õ¡
 *
c
) {

3250 i‡(
c
->
¨gc
 > 3) {

3251 
	`addRïly
(
c
,
sh¨ed
.
sy¡axîr
);

3254 
	`gíîicZp›Comm™d
(
c
,&c->
¨gv
[1],1,
ZSET_MAX
,0,

3255 
c
->
¨gc
 =3 ? c->
¨gv
[2] : 
NULL
);

3256 
	}
}

3259 
	$blockögGíîicZp›Comm™d
(
˛õ¡
 *
c
, 
whîe
) {

3260 
robj
 *
o
;

3261 
m°ime_t
 
timeout
;

3262 
j
;

3264 i‡(
	`gëTimeoutFromObje˘OrRïly
(
c
,c->
¨gv
[c->
¨gc
-1],&
timeout
,
UNIT_SECONDS
)

3265 !
C_OK
) ;

3267 
j
 = 1; j < 
c
->
¨gc
-1; j++) {

3268 
o
 = 
	`lookupKeyWrôe
(
c
->
db
,c->
¨gv
[
j
]);

3269 i‡(
o
 !
NULL
) {

3270 i‡(
o
->
ty≥
 !
OBJ_ZSET
) {

3271 
	`addRïly
(
c
,
sh¨ed
.
wr⁄gty≥îr
);

3274 i‡(
	`z£tLígth
(
o
) != 0) {

3276 
	`gíîicZp›Comm™d
(
c
,&c->
¨gv
[
j
],1,
whîe
,1,
NULL
);

3278 
	`ªwrôeClõ¡Comm™dVe˘‹
(
c
,2,

3279 
whîe
 =
ZSET_MAX
 ? 
sh¨ed
.
zp›max
 : sh¨ed.
zp›mö
,

3280 
c
->
¨gv
[
j
]);

3289 i‡(
c
->
Êags
 & 
CLIENT_MULTI
) {

3290 
	`addRïlyNuŒAºay
(
c
);

3295 
	`blockF‹Keys
(
c
,
BLOCKED_ZSET
,c->
¨gv
 + 1,c->
¨gc
 - 2,
timeout
,
NULL
,NULL);

3296 
	}
}

3299 
	$bzp›möComm™d
(
˛õ¡
 *
c
) {

3300 
	`blockögGíîicZp›Comm™d
(
c
,
ZSET_MIN
);

3301 
	}
}

3304 
	$bzp›maxComm™d
(
˛õ¡
 *
c
) {

3305 
	`blockögGíîicZp›Comm™d
(
c
,
ZSET_MAX
);

3306 
	}
}

	@testhelp.h

39 #i‚de‡
__TESTHELP_H


40 
	#__TESTHELP_H


	)

42 
	g__Áûed_ã°s
 = 0;

43 
	g__ã°_num
 = 0;

44 
	#ã°_c⁄d
(
des¸
,
_c
) do { \

45 
__ã°_num
++; 
	`¥ötf
("%d - %s: ", __ã°_num, 
des¸
); \

46 if(
_c
Ë
	`¥ötf
("PASSED\n"); {¥ötf("FAILED\n"); 
__Áûed_ã°s
++;} \

47 } 0);

	)

48 
	#ã°_ªp‹t
() do { \

49 
	`¥ötf
("%dÅe°s, %dÖas£d, %d faûed\n", 
__ã°_num
, \

50 
__ã°_num
-
__Áûed_ã°s
, __failed_tests); \

51 i‡(
__Áûed_ã°s
) { \

52 
	`¥ötf
("=== WARNING === We have failedÅests here...\n"); \

53 
	`exô
(1); \

55 } 0);

	)

	@timeout.c

29 
	~"£rvî.h
"

30 
	~"˛u°î.h
"

37 
	$checkBlockedClõ¡Timeout
(
˛õ¡
 *
c
, 
m°ime_t
 
now
) {

38 i‡(
c
->
Êags
 & 
CLIENT_BLOCKED
 &&

39 
c
->
bp›
.
timeout
 != 0

40 && 
c
->
bp›
.
timeout
 < 
now
)

43 
	`ª∂yToBlockedClõ¡TimedOut
(
c
);

44 
	`unblockClõ¡
(
c
);

49 
	}
}

55 
	$˛õ¡sCr⁄H™dÀTimeout
(
˛õ¡
 *
c
, 
m°ime_t
 
now_ms
) {

56 
time_t
 
now
 = 
now_ms
/1000;

58 i‡(
£rvî
.
maxidÀtime
 &&

60 !(
c
->
Êags
 & 
CLIENT_SLAVE
) &&

61 !(
c
->
Êags
 & 
CLIENT_MASTER
) &&

62 !(
c
->
Êags
 & 
CLIENT_BLOCKED
) &&

63 !(
c
->
Êags
 & 
CLIENT_PUBSUB
) &&

64 (
now
 - 
c
->
œ°öãø˘i⁄
 > 
£rvî
.
maxidÀtime
))

66 
	`£rvîLog
(
LL_VERBOSE
,"Closing idle client");

67 
	`‰ìClõ¡
(
c
);

69 } i‡(
c
->
Êags
 & 
CLIENT_BLOCKED
) {

72 i‡(
£rvî
.
˛u°î_íabÀd
) {

73 i‡(
	`˛u°îRedúe˘BlockedClõ¡IfNìded
(
c
))

74 
	`unblockClõ¡
(
c
);

78 
	}
}

93 
	#CLIENT_ST_KEYLEN
 16

	)

96 
	$ícodeTimeoutKey
(*
buf
, 
uöt64_t
 
timeout
, 
˛õ¡
 *
c
) {

97 
timeout
 = 
	`ht⁄u64
(timeout);

98 
	`mem˝y
(
buf
,&
timeout
,(timeout));

99 
	`mem˝y
(
buf
+8,&
c
,(c));

100 i‡((
c
Ë=4Ë
	`mem£t
(
buf
+12,0,4);

101 
	}
}

105 
	$decodeTimeoutKey
(*
buf
, 
uöt64_t
 *
t›å
, 
˛õ¡
 **
˝å
) {

106 
	`mem˝y
(
t›å
,
buf
,(*toptr));

107 *
t›å
 = 
	`¡ohu64
(*toptr);

108 
	`mem˝y
(
˝å
,
buf
+8,(*cptr));

109 
	}
}

114 
	$addClõ¡ToTimeoutTabÀ
(
˛õ¡
 *
c
) {

115 i‡(
c
->
bp›
.
timeout
 == 0) ;

116 
uöt64_t
 
timeout
 = 
c
->
bp›
.timeout;

117 
buf
[
CLIENT_ST_KEYLEN
];

118 
	`ícodeTimeoutKey
(
buf
,
timeout
,
c
);

119 i‡(
	`øxTryIn£π
(
£rvî
.
˛õ¡s_timeout_èbÀ
,
buf
,(buf),
NULL
,NULL))

120 
c
->
Êags
 |
CLIENT_IN_TO_TABLE
;

121 
	}
}

125 
	$ªmoveClõ¡FromTimeoutTabÀ
(
˛õ¡
 *
c
) {

126 i‡(!(
c
->
Êags
 & 
CLIENT_IN_TO_TABLE
)) ;

127 
c
->
Êags
 &~
CLIENT_IN_TO_TABLE
;

128 
uöt64_t
 
timeout
 = 
c
->
bp›
.timeout;

129 
buf
[
CLIENT_ST_KEYLEN
];

130 
	`ícodeTimeoutKey
(
buf
,
timeout
,
c
);

131 
	`øxRemove
(
£rvî
.
˛õ¡s_timeout_èbÀ
,
buf
,(buf),
NULL
);

132 
	}
}

136 
	$h™dÀBlockedClõ¡sTimeout
() {

137 i‡(
	`øxSize
(
£rvî
.
˛õ¡s_timeout_èbÀ
) == 0) ;

138 
uöt64_t
 
now
 = 
	`m°ime
();

139 
øxIãøt‹
 
ri
;

140 
	`øxSèπ
(&
ri
,
£rvî
.
˛õ¡s_timeout_èbÀ
);

141 
	`øxSìk
(&
ri
,"^",
NULL
,0);

143 
	`øxNext
(&
ri
)) {

144 
uöt64_t
 
timeout
;

145 
˛õ¡
 *
c
;

146 
	`decodeTimeoutKey
(
ri
.
key
,&
timeout
,&
c
);

147 i‡(
timeout
 >
now
) ;

148 
c
->
Êags
 &~
CLIENT_IN_TO_TABLE
;

149 
	`checkBlockedClõ¡Timeout
(
c
,
now
);

150 
	`øxRemove
(
£rvî
.
˛õ¡s_timeout_èbÀ
,
ri
.
key
,ri.
key_Àn
,
NULL
);

151 
	`øxSìk
(&
ri
,"^",
NULL
,0);

153 
	}
}

163 
	$gëTimeoutFromObje˘OrRïly
(
˛õ¡
 *
c
, 
robj
 *
obje˘
, 
m°ime_t
 *
timeout
, 
unô
) {

164 
tvÆ
;

165 
·vÆ
;

167 i‡(
unô
 =
UNIT_SECONDS
) {

168 i‡(
	`gëL⁄gDoubÀFromObje˘OrRïly
(
c
,
obje˘
,&
·vÆ
,

169 "timeouài†nŸá flﬂà‹ ouào‡ønge"Ë!
C_OK
)

170  
C_ERR
;

171 
tvÆ
 = (Ë(
·vÆ
 * 1000.0);

173 i‡(
	`gëL⁄gL⁄gFromObje˘OrRïly
(
c
,
obje˘
,&
tvÆ
,

174 "timeouài†nŸá¿öãgî o∏ouào‡ønge"Ë!
C_OK
)

175  
C_ERR
;

178 i‡(
tvÆ
 < 0) {

179 
	`addRïlyEº‹
(
c
,"timeout isÇegative");

180  
C_ERR
;

183 i‡(
tvÆ
 > 0) {

184 
tvÆ
 +
	`m°ime
();

186 *
timeout
 = 
tvÆ
;

188  
C_OK
;

189 
	}
}

	@tls.c

31 
	~"£rvî.h
"

32 
	~"c⁄nhñ≥rs.h
"

33 
	~"adli°.h
"

35 #ifde‡
USE_OPENSSL


37 
	~<›ís¶/s¶.h
>

38 
	~<›ís¶/îr.h
>

39 
	~<›ís¶/ønd.h
>

41 
	#REDIS_TLS_PROTO_TLSv1
 (1<<0)

	)

42 
	#REDIS_TLS_PROTO_TLSv1_1
 (1<<1)

	)

43 
	#REDIS_TLS_PROTO_TLSv1_2
 (1<<2)

	)

44 
	#REDIS_TLS_PROTO_TLSv1_3
 (1<<3)

	)

47 #ifde‡
TLS1_3_VERSION


48 
	#REDIS_TLS_PROTO_DEFAULT
 (
REDIS_TLS_PROTO_TLSv1_2
|
REDIS_TLS_PROTO_TLSv1_3
)

	)

50 
	#REDIS_TLS_PROTO_DEFAULT
 (
REDIS_TLS_PROTO_TLSv1_2
)

	)

53 
C⁄√˘i⁄Ty≥
 
CT_Sockë
;

55 
SSL_CTX
 *
	gªdis_és_˘x
;

57 
	$∑r£PrŸocﬁsC⁄fig
(c⁄° *
°r
) {

58 
i
, 
cou¡
 = 0;

59 
¥Ÿocﬁs
 = 0;

61 i‡(!
°r
Ë 
REDIS_TLS_PROTO_DEFAULT
;

62 
sds
 *
tokís
 = 
	`sds•lôÀn
(
°r
, 
	`°æí
(°r), " ", 1, &
cou¡
);

64 i‡(!
tokís
) {

65 
	`£rvîLog
(
LL_WARNING
, "InvalidÅls-protocols configuration string");

68 
i
 = 0; i < 
cou¡
; i++) {

69 i‡(!
	`°rˇ£cmp
(
tokís
[
i
], "ésv1")Ë
¥Ÿocﬁs
 |
REDIS_TLS_PROTO_TLSv1
;

70 i‡(!
	`°rˇ£cmp
(
tokís
[
i
], "ésv1.1")Ë
¥Ÿocﬁs
 |
REDIS_TLS_PROTO_TLSv1_1
;

71 i‡(!
	`°rˇ£cmp
(
tokís
[
i
], "ésv1.2")Ë
¥Ÿocﬁs
 |
REDIS_TLS_PROTO_TLSv1_2
;

72 i‡(!
	`°rˇ£cmp
(
tokís
[
i
], "tlsv1.3")) {

73 #ifde‡
TLS1_3_VERSION


74 
¥Ÿocﬁs
 |
REDIS_TLS_PROTO_TLSv1_3
;

76 
	`£rvîLog
(
LL_WARNING
, "TLSv1.3 is specified inÅls-protocols butÇot supported by OpenSSL.");

77 
¥Ÿocﬁs
 = -1;

81 
	`£rvîLog
(
LL_WARNING
, "InvalidÅls-protocols specified. "

83 
¥Ÿocﬁs
 = -1;

87 
	`sds‰ì•lôªs
(
tokís
, 
cou¡
);

89  
¥Ÿocﬁs
;

90 
	}
}

94 
li°
 *
	g≥ndög_li°
 = 
NULL
;

101 #i‡
OPENSSL_VERSION_NUMBER
 < 0x10100000L

102 
	#USE_CRYPTO_LOCKS


	)

105 #ifde‡
USE_CRYPTO_LOCKS


107 
±hªad_muãx_t
 *
	g›ís¶_locks
;

109 
	$s¶LockögCÆlback
(
mode
, 
lock_id
, c⁄° *
f
, 
löe
) {

110 
±hªad_muãx_t
 *
mt
 = 
›ís¶_locks
 + 
lock_id
;

112 i‡(
mode
 & 
CRYPTO_LOCK
) {

113 
	`±hªad_muãx_lock
(
mt
);

115 
	`±hªad_muãx_u∆ock
(
mt
);

118 ()
f
;

119 ()
löe
;

120 
	}
}

122 
	$öôCry±oLocks
() {

123 
i
, 
∆ocks
;

124 i‡(
	`CRYPTO_gë_lockög_ˇŒback
(Ë!
NULL
) {

128 
∆ocks
 = 
	`CRYPTO_num_locks
();

129 
›ís¶_locks
 = 
	`zmÆloc
((*›ís¶_locksË* 
∆ocks
);

130 
i
 = 0; i < 
∆ocks
; i++) {

131 
	`±hªad_muãx_öô
(
›ís¶_locks
 + 
i
, 
NULL
);

133 
	`CRYPTO_£t_lockög_ˇŒback
(
s¶LockögCÆlback
);

134 
	}
}

137 
	$ésInô
() {

138 
	`ERR_lﬂd_¸y±o_°rögs
();

139 
	`SSL_lﬂd_îr‹_°rögs
();

140 
	`SSL_libøry_öô
();

142 #ifde‡
USE_CRYPTO_LOCKS


143 
	`öôCry±oLocks
();

146 i‡(!
	`RAND_pﬁl
()) {

147 
	`£rvîLog
(
LL_WARNING
, "OpenSSL: FailedÅo seedÑandomÇumber generator.");

150 
≥ndög_li°
 = 
	`li°Cª©e
();

153 
£rvî
.
és_auth_˛õ¡s
 = 1;

154 
	}
}

159 
	$ésC⁄figuª
(
ªdisTLSC⁄ãxtC⁄fig
 *
˘x_c⁄fig
) {

160 
îrbuf
[256];

161 
SSL_CTX
 *
˘x
 = 
NULL
;

163 i‡(!
˘x_c⁄fig
->
˚π_fûe
) {

164 
	`£rvîLog
(
LL_WARNING
, "NoÅls-cert-file configured!");

165 
îr‹
;

168 i‡(!
˘x_c⁄fig
->
key_fûe
) {

169 
	`£rvîLog
(
LL_WARNING
, "NoÅls-key-file configured!");

170 
îr‹
;

173 i‡(!
˘x_c⁄fig
->
ˇ_˚π_fûe
 && !˘x_c⁄fig->
ˇ_˚π_dú
) {

174 
	`£rvîLog
(
LL_WARNING
, "EitherÅls-ca-cert-file orÅls-ca-cert-dir must be configured!");

175 
îr‹
;

178 
˘x
 = 
	`SSL_CTX_√w
(
	`SSLv23_mëhod
());

180 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_NO_SSLv2
|
SSL_OP_NO_SSLv3
);

181 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_SINGLE_DH_USE
);

183 #ifde‡
SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS


184 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS
);

187 
¥Ÿocﬁs
 = 
	`∑r£PrŸocﬁsC⁄fig
(
˘x_c⁄fig
->protocols);

188 i‡(
¥Ÿocﬁs
 =-1Ë
îr‹
;

190 i‡(!(
¥Ÿocﬁs
 & 
REDIS_TLS_PROTO_TLSv1
))

191 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_NO_TLSv1
);

192 i‡(!(
¥Ÿocﬁs
 & 
REDIS_TLS_PROTO_TLSv1_1
))

193 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_NO_TLSv1_1
);

194 #ifde‡
SSL_OP_NO_TLSv1_2


195 i‡(!(
¥Ÿocﬁs
 & 
REDIS_TLS_PROTO_TLSv1_2
))

196 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_NO_TLSv1_2
);

198 #ifde‡
SSL_OP_NO_TLSv1_3


199 i‡(!(
¥Ÿocﬁs
 & 
REDIS_TLS_PROTO_TLSv1_3
))

200 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_NO_TLSv1_3
);

203 #ifde‡
SSL_OP_NO_COMPRESSION


204 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_NO_COMPRESSION
);

207 #ifde‡
SSL_OP_NO_CLIENT_RENEGOTIATION


208 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_NO_CLIENT_RENEGOTIATION
);

211 i‡(
˘x_c⁄fig
->
¥e„r_£rvî_cùhîs
)

212 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_CIPHER_SERVER_PREFERENCE
);

214 
	`SSL_CTX_£t_mode
(
˘x
, 
SSL_MODE_ENABLE_PARTIAL_WRITE
|
SSL_MODE_ACCEPT_MOVING_WRITE_BUFFER
);

215 
	`SSL_CTX_£t_vîify
(
˘x
, 
SSL_VERIFY_PEER
|
SSL_VERIFY_FAIL_IF_NO_PEER_CERT
, 
NULL
);

216 #i‡
	`deföed
(
SSL_CTX_£t_ecdh_auto
)

217 
	`SSL_CTX_£t_ecdh_auto
(
˘x
, 1);

220 i‡(
	`SSL_CTX_u£_˚πifiˇã_fûe
(
˘x
, 
˘x_c⁄fig
->
˚π_fûe
, 
SSL_FILETYPE_PEM
) <= 0) {

221 
	`ERR_îr‹_°rög_n
(
	`ERR_gë_îr‹
(), 
îrbuf
, (errbuf));

222 
	`£rvîLog
(
LL_WARNING
, "FaûedÅÿlﬂd cîtifiˇã: %s: %s", 
˘x_c⁄fig
->
˚π_fûe
, 
îrbuf
);

223 
îr‹
;

226 i‡(
	`SSL_CTX_u£_Priv©eKey_fûe
(
˘x
, 
˘x_c⁄fig
->
key_fûe
, 
SSL_FILETYPE_PEM
) <= 0) {

227 
	`ERR_îr‹_°rög_n
(
	`ERR_gë_îr‹
(), 
îrbuf
, (errbuf));

228 
	`£rvîLog
(
LL_WARNING
, "FaûedÅÿlﬂdÖriv©êkey: %s: %s", 
˘x_c⁄fig
->
key_fûe
, 
îrbuf
);

229 
îr‹
;

232 i‡(
	`SSL_CTX_lﬂd_vîify_loˇti⁄s
(
˘x
, 
˘x_c⁄fig
->
ˇ_˚π_fûe
, ctx_c⁄fig->
ˇ_˚π_dú
) <= 0) {

233 
	`ERR_îr‹_°rög_n
(
	`ERR_gë_îr‹
(), 
îrbuf
, (errbuf));

234 
	`£rvîLog
(
LL_WARNING
, "FaûedÅÿc⁄figuª CA cîtifiˇã(sËfûe/dúe˘‹y: %s", 
îrbuf
);

235 
îr‹
;

238 i‡(
˘x_c⁄fig
->
dh_∑øms_fûe
) {

239 
FILE
 *
dhfûe
 = 
	`f›í
(
˘x_c⁄fig
->
dh_∑øms_fûe
, "r");

240 
DH
 *
dh
 = 
NULL
;

241 i‡(!
dhfûe
) {

242 
	`£rvîLog
(
LL_WARNING
, "FaûedÅÿlﬂd %s: %s", 
˘x_c⁄fig
->
dh_∑øms_fûe
, 
	`°ªº‹
(
î∫o
));

243 
îr‹
;

246 
dh
 = 
	`PEM_ªad_DH∑øms
(
dhfûe
, 
NULL
, NULL, NULL);

247 
	`f˛o£
(
dhfûe
);

248 i‡(!
dh
) {

249 
	`£rvîLog
(
LL_WARNING
, "%s: faûedÅÿªad DHÖ¨ams.", 
˘x_c⁄fig
->
dh_∑øms_fûe
);

250 
îr‹
;

253 i‡(
	`SSL_CTX_£t_tmp_dh
(
˘x
, 
dh
) <= 0) {

254 
	`ERR_îr‹_°rög_n
(
	`ERR_gë_îr‹
(), 
îrbuf
, (errbuf));

255 
	`£rvîLog
(
LL_WARNING
, "FaûedÅÿlﬂd DHÖ¨am†fûe: %s: %s", 
˘x_c⁄fig
->
dh_∑øms_fûe
, 
îrbuf
);

256 
	`DH_‰ì
(
dh
);

257 
îr‹
;

260 
	`DH_‰ì
(
dh
);

263 i‡(
˘x_c⁄fig
->
cùhîs
 && !
	`SSL_CTX_£t_cùhî_li°
(
˘x
, ctx_config->ciphers)) {

264 
	`£rvîLog
(
LL_WARNING
, "FaûedÅÿc⁄figuª cùhîs: %s", 
˘x_c⁄fig
->
cùhîs
);

265 
îr‹
;

268 #ifde‡
TLS1_3_VERSION


269 i‡(
˘x_c⁄fig
->
cùhîsuôes
 && !
	`SSL_CTX_£t_cùhîsuôes
(
˘x
, ctx_config->ciphersuites)) {

270 
	`£rvîLog
(
LL_WARNING
, "FaûedÅÿc⁄figuª cùhîsuôes: %s", 
˘x_c⁄fig
->
cùhîsuôes
);

271 
îr‹
;

275 
	`SSL_CTX_‰ì
(
ªdis_és_˘x
);

276 
ªdis_és_˘x
 = 
˘x
;

278  
C_OK
;

280 
îr‹
:

281 i‡(
˘x
Ë
	`SSL_CTX_‰ì
(ctx);

282  
C_ERR
;

283 
	}
}

285 #ifde‡
TLS_DEBUGGING


286 
	#TLSCONN_DEBUG
(
fmt
, ...) \

287 
	`£rvîLog
(
LL_DEBUG
, "TLSCONN: " 
fmt
, 
__VA_ARGS__
)

	)

289 
	#TLSCONN_DEBUG
(
fmt
, ...)

	)

292 
C⁄√˘i⁄Ty≥
 
	gCT_TLS
;

310 
	mWANT_READ
 = 1,

311 
	mWANT_WRITE


312 } 
	tW™tIOTy≥
;

314 
	#TLS_CONN_FLAG_READ_WANT_WRITE
 (1<<0)

	)

315 
	#TLS_CONN_FLAG_WRITE_WANT_READ
 (1<<1)

	)

316 
	#TLS_CONN_FLAG_FD_SET
 (1<<2)

	)

318 
	sés_c⁄√˘i⁄
 {

319 
c⁄√˘i⁄
 
	mc
;

320 
	mÊags
;

321 
SSL
 *
	ms¶
;

322 *
	ms¶_îr‹
;

323 
li°Node
 *
	m≥ndög_li°_node
;

324 } 
	tés_c⁄√˘i⁄
;

326 
c⁄√˘i⁄
 *
	$c⁄nCª©eTLS
() {

327 
és_c⁄√˘i⁄
 *
c⁄n
 = 
	`zˇŒoc
((tls_connection));

328 
c⁄n
->
c
.
ty≥
 = &
CT_TLS
;

329 
c⁄n
->
c
.
fd
 = -1;

330 
c⁄n
->
s¶
 = 
	`SSL_√w
(
ªdis_és_˘x
);

331  (
c⁄√˘i⁄
 *Ë
c⁄n
;

332 
	}
}

334 
c⁄√˘i⁄
 *
	$c⁄nCª©eAc˚±edTLS
(
fd
, 
ªquúe_auth
) {

335 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
	`c⁄nCª©eTLS
();

336 
c⁄n
->
c
.
fd
 = fd;

337 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_ACCEPTING
;

339 i‡(!
ªquúe_auth
) {

342 
	`SSL_£t_vîify
(
c⁄n
->
s¶
, 
SSL_VERIFY_PEER
, 
NULL
);

345 
	`SSL_£t_fd
(
c⁄n
->
s¶
, c⁄n->
c
.
fd
);

346 
	`SSL_£t_ac˚±_°©e
(
c⁄n
->
s¶
);

348  (
c⁄√˘i⁄
 *Ë
c⁄n
;

349 
	}
}

351 
ésEvítH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
˛õ¡D©a
, 
mask
);

358 
	$h™dÀSSLRëu∫Code
(
és_c⁄√˘i⁄
 *
c⁄n
, 
ªt_vÆue
, 
W™tIOTy≥
 *
w™t
) {

359 i‡(
ªt_vÆue
 <= 0) {

360 
s¶_îr
 = 
	`SSL_gë_îr‹
(
c⁄n
->
s¶
, 
ªt_vÆue
);

361 
s¶_îr
) {

362 
SSL_ERROR_WANT_WRITE
:

363 *
w™t
 = 
WANT_WRITE
;

365 
SSL_ERROR_WANT_READ
:

366 *
w™t
 = 
WANT_READ
;

368 
SSL_ERROR_SYSCALL
:

369 
c⁄n
->
c
.
œ°_î∫o
 = 
î∫o
;

370 i‡(
c⁄n
->
s¶_îr‹
Ë
	`z‰ì
(conn->ssl_error);

371 
c⁄n
->
s¶_îr‹
 = 
î∫o
 ? 
	`z°rdup
(
	`°ªº‹
”ºno)Ë: 
NULL
;

375 
c⁄n
->
c
.
œ°_î∫o
 = 0;

376 i‡(
c⁄n
->
s¶_îr‹
Ë
	`z‰ì
(conn->ssl_error);

377 
c⁄n
->
s¶_îr‹
 = 
	`zmÆloc
(512);

378 
	`ERR_îr‹_°rög_n
(
	`ERR_gë_îr‹
(), 
c⁄n
->
s¶_îr‹
, 512);

382  
s¶_îr
;

386 
	}
}

388 
	$ªgi°îSSLEvít
(
és_c⁄√˘i⁄
 *
c⁄n
, 
W™tIOTy≥
 
w™t
) {

389 
mask
 = 
	`´GëFûeEvíts
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
);

391 
w™t
) {

392 
WANT_READ
:

393 i‡(
mask
 & 
AE_WRITABLE
Ë
	`´DñëeFûeEvít
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
, AE_WRITABLE);

394 i‡(!(
mask
 & 
AE_READABLE
)Ë
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
, AE_READABLE,

395 
ésEvítH™dÀr
, 
c⁄n
);

397 
WANT_WRITE
:

398 i‡(
mask
 & 
AE_READABLE
Ë
	`´DñëeFûeEvít
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
, AE_READABLE);

399 i‡(!(
mask
 & 
AE_WRITABLE
)Ë
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
, AE_WRITABLE,

400 
ésEvítH™dÀr
, 
c⁄n
);

403 
	`£rvîAs£π
(0);

406 
	}
}

408 
	$upd©eSSLEvít
(
és_c⁄√˘i⁄
 *
c⁄n
) {

409 
mask
 = 
	`´GëFûeEvíts
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
);

410 
√ed_ªad
 = 
c⁄n
->
c
.
ªad_h™dÀr
 || (c⁄n->
Êags
 & 
TLS_CONN_FLAG_WRITE_WANT_READ
);

411 
√ed_wrôe
 = 
c⁄n
->
c
.
wrôe_h™dÀr
 || (c⁄n->
Êags
 & 
TLS_CONN_FLAG_READ_WANT_WRITE
);

413 i‡(
√ed_ªad
 && !(
mask
 & 
AE_READABLE
))

414 
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
, 
AE_READABLE
, 
ésEvítH™dÀr
, conn);

415 i‡(!
√ed_ªad
 && (
mask
 & 
AE_READABLE
))

416 
	`´DñëeFûeEvít
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
, 
AE_READABLE
);

418 i‡(
√ed_wrôe
 && !(
mask
 & 
AE_WRITABLE
))

419 
	`´Cª©eFûeEvít
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
, 
AE_WRITABLE
, 
ésEvítH™dÀr
, conn);

420 i‡(!
√ed_wrôe
 && (
mask
 & 
AE_WRITABLE
))

421 
	`´DñëeFûeEvít
(
£rvî
.
ñ
, 
c⁄n
->
c
.
fd
, 
AE_WRITABLE
);

422 
	}
}

424 
	$ésH™dÀEvít
(
és_c⁄√˘i⁄
 *
c⁄n
, 
mask
) {

425 
ªt
;

427 
	`TLSCONN_DEBUG
("tlsEventHandler(): fd=%d, state=%d, mask=%d,Ñ=%d, w=%d, flags=%d",

428 
fd
, 
c⁄n
->
c
.
°©e
, 
mask
, c⁄n->c.
ªad_h™dÀr
 !
NULL
, c⁄n->c.
wrôe_h™dÀr
 != NULL,

429 
c⁄n
->
Êags
);

431 
	`ERR_˛ór_îr‹
();

433 
c⁄n
->
c
.
°©e
) {

434 
CONN_STATE_CONNECTING
:

435 i‡(
	`c⁄nGëSockëEº‹
((
c⁄√˘i⁄
 *Ë
c⁄n
)) {

436 
c⁄n
->
c
.
œ°_î∫o
 = 
î∫o
;

437 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_ERROR
;

439 i‡(!(
c⁄n
->
Êags
 & 
TLS_CONN_FLAG_FD_SET
)) {

440 
	`SSL_£t_fd
(
c⁄n
->
s¶
, c⁄n->
c
.
fd
);

441 
c⁄n
->
Êags
 |
TLS_CONN_FLAG_FD_SET
;

443 
ªt
 = 
	`SSL_c⁄√˘
(
c⁄n
->
s¶
);

444 i‡(
ªt
 <= 0) {

445 
W™tIOTy≥
 
w™t
 = 0;

446 i‡(!
	`h™dÀSSLRëu∫Code
(
c⁄n
, 
ªt
, &
w™t
)) {

447 
	`ªgi°îSSLEvít
(
c⁄n
, 
w™t
);

457 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_ERROR
;

459 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_CONNECTED
;

463 i‡(!
	`ˇŒH™dÀr
((
c⁄√˘i⁄
 *Ë
c⁄n
, c⁄n->
c
.
c⁄n_h™dÀr
)) ;

464 
c⁄n
->
c
.
c⁄n_h™dÀr
 = 
NULL
;

466 
CONN_STATE_ACCEPTING
:

467 
ªt
 = 
	`SSL_ac˚±
(
c⁄n
->
s¶
);

468 i‡(
ªt
 <= 0) {

469 
W™tIOTy≥
 
w™t
 = 0;

470 i‡(!
	`h™dÀSSLRëu∫Code
(
c⁄n
, 
ªt
, &
w™t
)) {

475 
	`ªgi°îSSLEvít
(
c⁄n
, 
w™t
);

480 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_ERROR
;

482 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_CONNECTED
;

485 i‡(!
	`ˇŒH™dÀr
((
c⁄√˘i⁄
 *Ë
c⁄n
, c⁄n->
c
.
c⁄n_h™dÀr
)) ;

486 
c⁄n
->
c
.
c⁄n_h™dÀr
 = 
NULL
;

488 
CONN_STATE_CONNECTED
:

490 
ˇŒ_ªad
 = ((
mask
 & 
AE_READABLE
Ë&& 
c⁄n
->
c
.
ªad_h™dÀr
) ||

491 ((
mask
 & 
AE_WRITABLE
Ë&& (
c⁄n
->
Êags
 & 
TLS_CONN_FLAG_READ_WANT_WRITE
));

492 
ˇŒ_wrôe
 = ((
mask
 & 
AE_WRITABLE
Ë&& 
c⁄n
->
c
.
wrôe_h™dÀr
) ||

493 ((
mask
 & 
AE_READABLE
Ë&& (
c⁄n
->
Êags
 & 
TLS_CONN_FLAG_WRITE_WANT_READ
));

506 
övît
 = 
c⁄n
->
c
.
Êags
 & 
CONN_FLAG_WRITE_BARRIER
;

508 i‡(!
övît
 && 
ˇŒ_ªad
) {

509 
c⁄n
->
Êags
 &~
TLS_CONN_FLAG_READ_WANT_WRITE
;

510 i‡(!
	`ˇŒH™dÀr
((
c⁄√˘i⁄
 *Ë
c⁄n
, c⁄n->
c
.
ªad_h™dÀr
)) ;

514 i‡(
ˇŒ_wrôe
) {

515 
c⁄n
->
Êags
 &~
TLS_CONN_FLAG_WRITE_WANT_READ
;

516 i‡(!
	`ˇŒH™dÀr
((
c⁄√˘i⁄
 *Ë
c⁄n
, c⁄n->
c
.
wrôe_h™dÀr
)) ;

521 i‡(
övît
 && 
ˇŒ_ªad
) {

522 
c⁄n
->
Êags
 &~
TLS_CONN_FLAG_READ_WANT_WRITE
;

523 i‡(!
	`ˇŒH™dÀr
((
c⁄√˘i⁄
 *Ë
c⁄n
, c⁄n->
c
.
ªad_h™dÀr
)) ;

529 i‡((
mask
 & 
AE_READABLE
)) {

530 i‡(
	`SSL_≥ndög
(
c⁄n
->
s¶
) > 0) {

531 i‡(!
c⁄n
->
≥ndög_li°_node
) {

532 
	`li°AddNodeTaû
(
≥ndög_li°
, 
c⁄n
);

533 
c⁄n
->
≥ndög_li°_node
 = 
	`li°La°
(
≥ndög_li°
);

535 } i‡(
c⁄n
->
≥ndög_li°_node
) {

536 
	`li°DñNode
(
≥ndög_li°
, 
c⁄n
->
≥ndög_li°_node
);

537 
c⁄n
->
≥ndög_li°_node
 = 
NULL
;

547 
	`upd©eSSLEvít
(
c⁄n
);

548 
	}
}

550 
	$ésEvítH™dÀr
(
´EvítLo›
 *
ñ
, 
fd
, *
˛õ¡D©a
, 
mask
) {

551 
	`UNUSED
(
ñ
);

552 
	`UNUSED
(
fd
);

553 
és_c⁄√˘i⁄
 *
c⁄n
 = 
˛õ¡D©a
;

554 
	`ésH™dÀEvít
(
c⁄n
, 
mask
);

555 
	}
}

557 
	$c⁄nTLSClo£
(
c⁄√˘i⁄
 *
c⁄n_
) {

558 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
c⁄n_
;

560 i‡(
c⁄n
->
s¶
) {

561 
	`SSL_‰ì
(
c⁄n
->
s¶
);

562 
c⁄n
->
s¶
 = 
NULL
;

565 i‡(
c⁄n
->
s¶_îr‹
) {

566 
	`z‰ì
(
c⁄n
->
s¶_îr‹
);

567 
c⁄n
->
s¶_îr‹
 = 
NULL
;

570 i‡(
c⁄n
->
≥ndög_li°_node
) {

571 
	`li°DñNode
(
≥ndög_li°
, 
c⁄n
->
≥ndög_li°_node
);

572 
c⁄n
->
≥ndög_li°_node
 = 
NULL
;

575 
CT_Sockë
.
	`˛o£
(
c⁄n_
);

576 
	}
}

578 
	$c⁄nTLSAc˚±
(
c⁄√˘i⁄
 *
_c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
ac˚±_h™dÀr
) {

579 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
_c⁄n
;

580 
ªt
;

582 i‡(
c⁄n
->
c
.
°©e
 !
CONN_STATE_ACCEPTING
Ë 
C_ERR
;

583 
	`ERR_˛ór_îr‹
();

586 
c⁄n
->
c
.
c⁄n_h™dÀr
 = 
ac˚±_h™dÀr
;

587 
ªt
 = 
	`SSL_ac˚±
(
c⁄n
->
s¶
);

589 i‡(
ªt
 <= 0) {

590 
W™tIOTy≥
 
w™t
 = 0;

591 i‡(!
	`h™dÀSSLRëu∫Code
(
c⁄n
, 
ªt
, &
w™t
)) {

592 
	`ªgi°îSSLEvít
(
c⁄n
, 
w™t
);

593  
C_OK
;

595 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_ERROR
;

596  
C_ERR
;

600 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_CONNECTED
;

601 i‡(!
	`ˇŒH™dÀr
((
c⁄√˘i⁄
 *Ë
c⁄n
, c⁄n->
c
.
c⁄n_h™dÀr
)Ë 
C_OK
;

602 
c⁄n
->
c
.
c⁄n_h™dÀr
 = 
NULL
;

604  
C_OK
;

605 
	}
}

607 
	$c⁄nTLSC⁄√˘
(
c⁄√˘i⁄
 *
c⁄n_
, c⁄° *
addr
, 
p‹t
, c⁄° *
§c_addr
, 
C⁄√˘i⁄CÆlbackFunc
 
c⁄√˘_h™dÀr
) {

608 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
c⁄n_
;

610 i‡(
c⁄n
->
c
.
°©e
 !
CONN_STATE_NONE
Ë 
C_ERR
;

611 
	`ERR_˛ór_îr‹
();

614 i‡(
CT_Sockë
.
	`c⁄√˘
(
c⁄n_
, 
addr
, 
p‹t
, 
§c_addr
, 
c⁄√˘_h™dÀr
Ë=
C_ERR
)  C_ERR;

619  
C_OK
;

620 
	}
}

622 
	$c⁄nTLSWrôe
(
c⁄√˘i⁄
 *
c⁄n_
, c⁄° *
d©a
, 
size_t
 
d©a_Àn
) {

623 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
c⁄n_
;

624 
ªt
, 
s¶_îr
;

626 i‡(
c⁄n
->
c
.
°©e
 !
CONN_STATE_CONNECTED
)  -1;

627 
	`ERR_˛ór_îr‹
();

628 
ªt
 = 
	`SSL_wrôe
(
c⁄n
->
s¶
, 
d©a
, 
d©a_Àn
);

630 i‡(
ªt
 <= 0) {

631 
W™tIOTy≥
 
w™t
 = 0;

632 i‡(!(
s¶_îr
 = 
	`h™dÀSSLRëu∫Code
(
c⁄n
, 
ªt
, &
w™t
))) {

633 i‡(
w™t
 =
WANT_READ
Ë
c⁄n
->
Êags
 |
TLS_CONN_FLAG_WRITE_WANT_READ
;

634 
	`upd©eSSLEvít
(
c⁄n
);

635 
î∫o
 = 
EAGAIN
;

638 i‡(
s¶_îr
 =
SSL_ERROR_ZERO_RETURN
 ||

639 ((
s¶_îr
 =
SSL_ERROR_SYSCALL
 && !
î∫o
))) {

640 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_CLOSED
;

643 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_ERROR
;

649  
ªt
;

650 
	}
}

652 
	$c⁄nTLSRód
(
c⁄√˘i⁄
 *
c⁄n_
, *
buf
, 
size_t
 
buf_Àn
) {

653 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
c⁄n_
;

654 
ªt
;

655 
s¶_îr
;

657 i‡(
c⁄n
->
c
.
°©e
 !
CONN_STATE_CONNECTED
)  -1;

658 
	`ERR_˛ór_îr‹
();

659 
ªt
 = 
	`SSL_ªad
(
c⁄n
->
s¶
, 
buf
, 
buf_Àn
);

660 i‡(
ªt
 <= 0) {

661 
W™tIOTy≥
 
w™t
 = 0;

662 i‡(!(
s¶_îr
 = 
	`h™dÀSSLRëu∫Code
(
c⁄n
, 
ªt
, &
w™t
))) {

663 i‡(
w™t
 =
WANT_WRITE
Ë
c⁄n
->
Êags
 |
TLS_CONN_FLAG_READ_WANT_WRITE
;

664 
	`upd©eSSLEvít
(
c⁄n
);

666 
î∫o
 = 
EAGAIN
;

669 i‡(
s¶_îr
 =
SSL_ERROR_ZERO_RETURN
 ||

670 ((
s¶_îr
 =
SSL_ERROR_SYSCALL
Ë&& !
î∫o
)) {

671 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_CLOSED
;

674 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_ERROR
;

680  
ªt
;

681 
	}
}

683 c⁄° *
	$c⁄nTLSGëLa°Eº‹
(
c⁄√˘i⁄
 *
c⁄n_
) {

684 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
c⁄n_
;

686 i‡(
c⁄n
->
s¶_îr‹
)  conn->ssl_error;

687  
NULL
;

688 
	}
}

690 
	$c⁄nTLSSëWrôeH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
func
, 
b¨rõr
) {

691 
c⁄n
->
wrôe_h™dÀr
 = 
func
;

692 i‡(
b¨rõr
)

693 
c⁄n
->
Êags
 |
CONN_FLAG_WRITE_BARRIER
;

695 
c⁄n
->
Êags
 &~
CONN_FLAG_WRITE_BARRIER
;

696 
	`upd©eSSLEvít
((
és_c⁄√˘i⁄
 *Ë
c⁄n
);

697  
C_OK
;

698 
	}
}

700 
	$c⁄nTLSSëRódH™dÀr
(
c⁄√˘i⁄
 *
c⁄n
, 
C⁄√˘i⁄CÆlbackFunc
 
func
) {

701 
c⁄n
->
ªad_h™dÀr
 = 
func
;

702 
	`upd©eSSLEvít
((
és_c⁄√˘i⁄
 *Ë
c⁄n
);

703  
C_OK
;

704 
	}
}

706 
	$£tBlockögTimeout
(
és_c⁄√˘i⁄
 *
c⁄n
, 
timeout
) {

707 
	`™ëBlock
(
NULL
, 
c⁄n
->
c
.
fd
);

708 
	`™ëSídTimeout
(
NULL
, 
c⁄n
->
c
.
fd
, 
timeout
);

709 
	`™ëRecvTimeout
(
NULL
, 
c⁄n
->
c
.
fd
, 
timeout
);

710 
	}
}

712 
	$un£tBlockögTimeout
(
és_c⁄√˘i⁄
 *
c⁄n
) {

713 
	`™ëN⁄Block
(
NULL
, 
c⁄n
->
c
.
fd
);

714 
	`™ëSídTimeout
(
NULL
, 
c⁄n
->
c
.
fd
, 0);

715 
	`™ëRecvTimeout
(
NULL
, 
c⁄n
->
c
.
fd
, 0);

716 
	}
}

718 
	$c⁄nTLSBlockögC⁄√˘
(
c⁄√˘i⁄
 *
c⁄n_
, c⁄° *
addr
, 
p‹t
, 
timeout
) {

719 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
c⁄n_
;

720 
ªt
;

722 i‡(
c⁄n
->
c
.
°©e
 !
CONN_STATE_NONE
Ë 
C_ERR
;

725 i‡(
CT_Sockë
.
	`blockög_c⁄√˘
(
c⁄n_
, 
addr
, 
p‹t
, 
timeout
Ë=
C_ERR
)  C_ERR;

729 
	`SSL_£t_fd
(
c⁄n
->
s¶
, c⁄n->
c
.
fd
);

730 
	`£tBlockögTimeout
(
c⁄n
, 
timeout
);

732 i‡((
ªt
 = 
	`SSL_c⁄√˘
(
c⁄n
->
s¶
)) <= 0) {

733 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_ERROR
;

734  
C_ERR
;

736 
	`un£tBlockögTimeout
(
c⁄n
);

738 
c⁄n
->
c
.
°©e
 = 
CONN_STATE_CONNECTED
;

739  
C_OK
;

740 
	}
}

742 
ssize_t
 
	$c⁄nTLSSyncWrôe
(
c⁄√˘i⁄
 *
c⁄n_
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

743 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
c⁄n_
;

745 
	`£tBlockögTimeout
(
c⁄n
, 
timeout
);

746 
	`SSL_˛ór_mode
(
c⁄n
->
s¶
, 
SSL_MODE_ENABLE_PARTIAL_WRITE
);

747 
ªt
 = 
	`SSL_wrôe
(
c⁄n
->
s¶
, 
±r
, 
size
);

748 
	`SSL_£t_mode
(
c⁄n
->
s¶
, 
SSL_MODE_ENABLE_PARTIAL_WRITE
);

749 
	`un£tBlockögTimeout
(
c⁄n
);

751  
ªt
;

752 
	}
}

754 
ssize_t
 
	$c⁄nTLSSyncRód
(
c⁄√˘i⁄
 *
c⁄n_
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

755 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
c⁄n_
;

757 
	`£tBlockögTimeout
(
c⁄n
, 
timeout
);

758 
ªt
 = 
	`SSL_ªad
(
c⁄n
->
s¶
, 
±r
, 
size
);

759 
	`un£tBlockögTimeout
(
c⁄n
);

761  
ªt
;

762 
	}
}

764 
ssize_t
 
	$c⁄nTLSSyncRódLöe
(
c⁄√˘i⁄
 *
c⁄n_
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

765 
és_c⁄√˘i⁄
 *
c⁄n
 = (és_c⁄√˘i⁄ *Ë
c⁄n_
;

766 
ssize_t
 
ƒód
 = 0;

768 
	`£tBlockögTimeout
(
c⁄n
, 
timeout
);

770 
size
--;

771 
size
) {

772 
c
;

774 i‡(
	`SSL_ªad
(
c⁄n
->
s¶
,&
c
,1) <= 0) {

775 
ƒód
 = -1;

776 
exô
;

778 i‡(
c
 == '\n') {

779 *
±r
 = '\0';

780 i‡(
ƒód
 && *(
±r
-1) == '\r') *(ptr-1) = '\0';

781 
exô
;

783 *
±r
++ = 
c
;

784 *
±r
 = '\0';

785 
ƒód
++;

787 
size
--;

789 
exô
:

790 
	`un£tBlockögTimeout
(
c⁄n
);

791  
ƒód
;

792 
	}
}

794 
C⁄√˘i⁄Ty≥
 
	gCT_TLS
 = {

795 .
´_h™dÀr
 = 
ésEvítH™dÀr
,

796 .
	gac˚±
 = 
c⁄nTLSAc˚±
,

797 .
	gc⁄√˘
 = 
c⁄nTLSC⁄√˘
,

798 .
	gblockög_c⁄√˘
 = 
c⁄nTLSBlockögC⁄√˘
,

799 .
	gªad
 = 
c⁄nTLSRód
,

800 .
	gwrôe
 = 
c⁄nTLSWrôe
,

801 .
	g˛o£
 = 
c⁄nTLSClo£
,

802 .
	g£t_wrôe_h™dÀr
 = 
c⁄nTLSSëWrôeH™dÀr
,

803 .
	g£t_ªad_h™dÀr
 = 
c⁄nTLSSëRódH™dÀr
,

804 .
	ggë_œ°_îr‹
 = 
c⁄nTLSGëLa°Eº‹
,

805 .
	gsync_wrôe
 = 
c⁄nTLSSyncWrôe
,

806 .
	gsync_ªad
 = 
c⁄nTLSSyncRód
,

807 .
	gsync_ªadlöe
 = 
c⁄nTLSSyncRódLöe
,

810 
	$ésHasPídögD©a
() {

811 i‡(!
≥ndög_li°
)

813  
	`li°Lígth
(
≥ndög_li°
) > 0;

814 
	}
}

816 
	$ésPro˚ssPídögD©a
() {

817 
li°Iãr
 
li
;

818 
li°Node
 *
 
;

820 
¥o˚s£d
 = 
	`li°Lígth
(
≥ndög_li°
);

821 
	`li°Rewöd
(
≥ndög_li°
,&
li
);

822 (
 
 = 
	`li°Next
(&
li
))) {

823 
és_c⁄√˘i⁄
 *
c⁄n
 = 
	`li°NodeVÆue
(
 
);

824 
	`ésH™dÀEvít
(
c⁄n
, 
AE_READABLE
);

826  
¥o˚s£d
;

827 
	}
}

831 
	$ésInô
() {

832 
	}
}

834 
	$ésC⁄figuª
(
ªdisTLSC⁄ãxtC⁄fig
 *
˘x_c⁄fig
) {

835 
	`UNUSED
(
˘x_c⁄fig
);

836  
C_OK
;

837 
	}
}

839 
c⁄√˘i⁄
 *
	$c⁄nCª©eTLS
() {

840  
NULL
;

841 
	}
}

843 
c⁄√˘i⁄
 *
	$c⁄nCª©eAc˚±edTLS
(
fd
, 
ªquúe_auth
) {

844 
	`UNUSED
(
fd
);

845 
	`UNUSED
(
ªquúe_auth
);

847  
NULL
;

848 
	}
}

850 
	$ésHasPídögD©a
() {

852 
	}
}

854 
	$ésPro˚ssPídögD©a
() {

856 
	}
}

	@tracking.c

31 
	~"£rvî.h
"

44 
øx
 *
	gTøckögTabÀ
 = 
NULL
;

45 
øx
 *
	gPªfixTabÀ
 = 
NULL
;

46 
uöt64_t
 
	gTøckögTabÀTŸÆIãms
 = 0;

50 
robj
 *
	gTøckögCh™√lName
;

55 
	sbˇ°Sèã
 {

56 
øx
 *
	mkeys
;

57 
øx
 *
	m˛õ¡s
;

59 } 
	tbˇ°Sèã
;

67 
	$dißbÀTøckög
(
˛õ¡
 *
c
) {

70 i‡(
c
->
Êags
 & 
CLIENT_TRACKING_BCAST
) {

71 
øxIãøt‹
 
ri
;

72 
	`øxSèπ
(&
ri
,
c
->
˛õ¡_åackög_¥efixes
);

73 
	`øxSìk
(&
ri
,"^",
NULL
,0);

74 
	`øxNext
(&
ri
)) {

75 
bˇ°Sèã
 *
bs
 = 
	`øxFöd
(
PªfixTabÀ
,
ri
.
key
,ri.
key_Àn
);

76 
	`£rvîAs£π
(
bs
 !
øxNŸFound
);

77 
	`øxRemove
(
bs
->
˛õ¡s
,(*)&
c
,(c),
NULL
);

80 i‡(
	`øxSize
(
bs
->
˛õ¡s
) == 0) {

81 
	`øxFªe
(
bs
->
˛õ¡s
);

82 
	`øxFªe
(
bs
->
keys
);

83 
	`z‰ì
(
bs
);

84 
	`øxRemove
(
PªfixTabÀ
,
ri
.
key
,ri.
key_Àn
,
NULL
);

87 
	`øxSt›
(&
ri
);

88 
	`øxFªe
(
c
->
˛õ¡_åackög_¥efixes
);

89 
c
->
˛õ¡_åackög_¥efixes
 = 
NULL
;

93 i‡(
c
->
Êags
 & 
CLIENT_TRACKING
) {

94 
£rvî
.
åackög_˛õ¡s
--;

95 
c
->
Êags
 &~(
CLIENT_TRACKING
|
CLIENT_TRACKING_BROKEN_REDIR
|

96 
CLIENT_TRACKING_BCAST
|
CLIENT_TRACKING_OPTIN
|

97 
CLIENT_TRACKING_OPTOUT
|
CLIENT_TRACKING_CACHING
|

98 
CLIENT_TRACKING_NOLOOP
);

100 
	}
}

104 
	$íabÀBˇ°TøckögF‹Pªfix
(
˛õ¡
 *
c
, *
¥efix
, 
size_t
 
∂í
) {

105 
bˇ°Sèã
 *
bs
 = 
	`øxFöd
(
PªfixTabÀ
,(*)
¥efix
,
	`sd¶í
(prefix));

108 i‡(
bs
 =
øxNŸFound
) {

109 
bs
 = 
	`zmÆloc
((*bs));

110 
bs
->
keys
 = 
	`øxNew
();

111 
bs
->
˛õ¡s
 = 
	`øxNew
();

112 
	`øxIn£π
(
PªfixTabÀ
,(*)
¥efix
,
∂í
,
bs
,
NULL
);

114 i‡(
	`øxTryIn£π
(
bs
->
˛õ¡s
,(*)&
c
,(c),
NULL
,NULL)) {

115 i‡(
c
->
˛õ¡_åackög_¥efixes
 =
NULL
)

116 
c
->
˛õ¡_åackög_¥efixes
 = 
	`øxNew
();

117 
	`øxIn£π
(
c
->
˛õ¡_åackög_¥efixes
,

118 (*)
¥efix
,
∂í
,
NULL
,NULL);

120 
	}
}

129 
	$íabÀTøckög
(
˛õ¡
 *
c
, 
uöt64_t
 
ªdúe˘_to
, uöt64_à
›ti⁄s
, 
robj
 **
¥efix
, 
size_t
 
num¥efix
) {

130 i‡(!(
c
->
Êags
 & 
CLIENT_TRACKING
)Ë
£rvî
.
åackög_˛õ¡s
++;

131 
c
->
Êags
 |
CLIENT_TRACKING
;

132 
c
->
Êags
 &~(
CLIENT_TRACKING_BROKEN_REDIR
|
CLIENT_TRACKING_BCAST
|

133 
CLIENT_TRACKING_OPTIN
|
CLIENT_TRACKING_OPTOUT
|

134 
CLIENT_TRACKING_NOLOOP
);

135 
c
->
˛õ¡_åackög_ªdúe˘i⁄
 = 
ªdúe˘_to
;

139 i‡(
TøckögTabÀ
 =
NULL
) {

140 
TøckögTabÀ
 = 
	`øxNew
();

141 
PªfixTabÀ
 = 
	`øxNew
();

142 
TøckögCh™√lName
 = 
	`¸óãSåögObje˘
("__redis__:invalidate",20);

146 i‡(
›ti⁄s
 & 
CLIENT_TRACKING_BCAST
) {

147 
c
->
Êags
 |
CLIENT_TRACKING_BCAST
;

148 i‡(
num¥efix
 =0Ë
	`íabÀBˇ°TøckögF‹Pªfix
(
c
,"",0);

149 
size_t
 
j
 = 0; j < 
num¥efix
; j++) {

150 
sds
 
sd•ªfix
 = 
¥efix
[
j
]->
±r
;

151 
	`íabÀBˇ°TøckögF‹Pªfix
(
c
,
sd•ªfix
,
	`sd¶í
(sdsprefix));

156 
c
->
Êags
 |
›ti⁄s
 & (
CLIENT_TRACKING_OPTIN
|
CLIENT_TRACKING_OPTOUT
|

157 
CLIENT_TRACKING_NOLOOP
);

158 
	}
}

166 
	$åackögRemembîKeys
(
˛õ¡
 *
c
) {

169 
uöt64_t
 
›tö
 = 
c
->
Êags
 & 
CLIENT_TRACKING_OPTIN
;

170 
uöt64_t
 
›tout
 = 
c
->
Êags
 & 
CLIENT_TRACKING_OPTOUT
;

171 
uöt64_t
 
ˇchög_giví
 = 
c
->
Êags
 & 
CLIENT_TRACKING_CACHING
;

172 i‡((
›tö
 && !
ˇchög_giví
Ë|| (
›tout
 && caching_given)) ;

174 
numkeys
;

175 *
keys
 = 
	`gëKeysFromComm™d
(
c
->
cmd
,c->
¨gv
,c->
¨gc
,&
numkeys
);

176 i‡(
keys
 =
NULL
) ;

178 
j
 = 0; j < 
numkeys
; j++) {

179 
idx
 = 
keys
[
j
];

180 
sds
 
sdskey
 = 
c
->
¨gv
[
idx
]->
±r
;

181 
øx
 *
ids
 = 
	`øxFöd
(
TøckögTabÀ
,(*)
sdskey
,
	`sd¶í
(sdskey));

182 i‡(
ids
 =
øxNŸFound
) {

183 
ids
 = 
	`øxNew
();

184 
ö£πed
 = 
	`øxTryIn£π
(
TøckögTabÀ
,(*)
sdskey
,

185 
	`sd¶í
(
sdskey
),
ids
, 
NULL
);

186 
	`£rvîAs£π
(
ö£πed
 == 1);

188 i‡(
	`øxTryIn£π
(
ids
,(*)&
c
->
id
,(c->id),
NULL
,NULL))

189 
TøckögTabÀTŸÆIãms
++;

191 
	`gëKeysFªeResu…
(
keys
);

192 
	}
}

204 
	$£ndTøckögMesßge
(
˛õ¡
 *
c
, *
key«me
, 
size_t
 
keyÀn
, 
¥Ÿo
) {

205 
usög_ªdúe˘i⁄
 = 0;

206 i‡(
c
->
˛õ¡_åackög_ªdúe˘i⁄
) {

207 
˛õ¡
 *
ªdú
 = 
	`lookupClõ¡ByID
(
c
->
˛õ¡_åackög_ªdúe˘i⁄
);

208 i‡(!
ªdú
) {

212 i‡(
c
->
ª•
 > 2) {

213 
	`addRïlyPushLí
(
c
,3);

214 
	`addRïlyBulkCBuf„r
(
c
,"tracking-redir-broken",21);

215 
	`addRïlyL⁄gL⁄g
(
c
,c->
˛õ¡_åackög_ªdúe˘i⁄
);

219 
c
 = 
ªdú
;

220 
usög_ªdúe˘i⁄
 = 1;

227 i‡(
c
->
ª•
 > 2) {

228 
	`addRïlyPushLí
(
c
,2);

229 
	`addRïlyBulkCBuf„r
(
c
,"invalidate",10);

230 } i‡(
usög_ªdúe˘i⁄
 && 
c
->
Êags
 & 
CLIENT_PUBSUB
) {

233 
	`addRïlyPubsubMesßge
(
c
,
TøckögCh™√lName
,
NULL
);

243 i‡(
¥Ÿo
) {

244 
	`addRïlyPrŸo
(
c
,
key«me
,
keyÀn
);

246 
	`addRïlyAºayLí
(
c
,1);

247 
	`addRïlyBulkCBuf„r
(
c
,
key«me
,
keyÀn
);

249 
	}
}

257 
	$åackögRemembîKeyToBrﬂdˇ°
(
˛õ¡
 *
c
, *
key«me
, 
size_t
 
keyÀn
) {

258 
øxIãøt‹
 
ri
;

259 
	`øxSèπ
(&
ri
,
PªfixTabÀ
);

260 
	`øxSìk
(&
ri
,"^",
NULL
,0);

261 
	`øxNext
(&
ri
)) {

262 i‡(
ri
.
key_Àn
 > 
keyÀn
) ;

263 i‡(
ri
.
key_Àn
 !0 && 
	`memcmp
‘i.
key
,
key«me
,ri.key_len) != 0)

265 
bˇ°Sèã
 *
bs
 = 
ri
.
d©a
;

270 
	`øxTryIn£π
(
bs
->
keys
,(*)
key«me
,
keyÀn
,
c
,
NULL
);

272 
	`øxSt›
(&
ri
);

273 
	}
}

291 
	$åackögInvÆid©eKeyRaw
(
˛õ¡
 *
c
, *
key
, 
size_t
 
keyÀn
, 
bˇ°
) {

292 i‡(
TøckögTabÀ
 =
NULL
) ;

294 i‡(
bˇ°
 && 
	`øxSize
(
PªfixTabÀ
) > 0)

295 
	`åackögRemembîKeyToBrﬂdˇ°
(
c
,
key
,
keyÀn
);

297 
øx
 *
ids
 = 
	`øxFöd
(
TøckögTabÀ
,(*)
key
,
keyÀn
);

298 i‡(
ids
 =
øxNŸFound
) ;

300 
øxIãøt‹
 
ri
;

301 
	`øxSèπ
(&
ri
,
ids
);

302 
	`øxSìk
(&
ri
,"^",
NULL
,0);

303 
	`øxNext
(&
ri
)) {

304 
uöt64_t
 
id
;

305 
	`mem˝y
(&
id
,
ri
.
key
,(id));

306 
˛õ¡
 *
èrgë
 = 
	`lookupClõ¡ByID
(
id
);

312 i‡(
èrgë
 =
NULL
 ||

313 !(
èrgë
->
Êags
 & 
CLIENT_TRACKING
)||

314 
èrgë
->
Êags
 & 
CLIENT_TRACKING_BCAST
)

321 i‡(
èrgë
->
Êags
 & 
CLIENT_TRACKING_NOLOOP
 &&

322 
èrgë
 =
c
)

327 
	`£ndTøckögMesßge
(
èrgë
,
key
,
keyÀn
,0);

329 
	`øxSt›
(&
ri
);

333 
TøckögTabÀTŸÆIãms
 -
	`øxSize
(
ids
);

334 
	`øxFªe
(
ids
);

335 
	`øxRemove
(
TøckögTabÀ
,(*)
key
,
keyÀn
,
NULL
);

336 
	}
}

340 
	$åackögInvÆid©eKey
(
˛õ¡
 *
c
, 
robj
 *
keyobj
) {

341 
	`åackögInvÆid©eKeyRaw
(
c
,
keyobj
->
±r
,
	`sd¶í
(keyobj->ptr),1);

342 
	}
}

351 
	$‰ìTøckögRadixTªe
(*
π
) {

352 
	`øxFªe
(
π
);

353 
	}
}

355 
	$åackögInvÆid©eKeysOnFlush
(
dbid
) {

356 i‡(
£rvî
.
åackög_˛õ¡s
) {

357 
li°Node
 *
 
;

358 
li°Iãr
 
li
;

359 
	`li°Rewöd
(
£rvî
.
˛õ¡s
,&
li
);

360 (
 
 = 
	`li°Next
(&
li
)Ë!
NULL
) {

361 
˛õ¡
 *
c
 = 
	`li°NodeVÆue
(
 
);

362 i‡(
c
->
Êags
 & 
CLIENT_TRACKING
) {

363 
	`£ndTøckögMesßge
(
c
,"",1,0);

369 i‡(
dbid
 =-1 && 
TøckögTabÀ
) {

370 
	`øxFªeWôhCÆlback
(
TøckögTabÀ
,
‰ìTøckögRadixTªe
);

371 
TøckögTabÀ
 = 
	`øxNew
();

372 
TøckögTabÀTŸÆIãms
 = 0;

374 
	}
}

386 
	$åackögLimôU£dSlŸs
() {

387 
timeout_cou¡î
 = 0;

388 i‡(
TøckögTabÀ
 =
NULL
) ;

389 i‡(
£rvî
.
åackög_èbÀ_max_keys
 == 0) ;

390 
size_t
 
max_keys
 = 
£rvî
.
åackög_èbÀ_max_keys
;

391 i‡(
	`øxSize
(
TøckögTabÀ
Ë<
max_keys
) {

392 
timeout_cou¡î
 = 0;

399 
eff‹t
 = 100 * (
timeout_cou¡î
+1);

402 
øxIãøt‹
 
ri
;

403 
	`øxSèπ
(&
ri
,
TøckögTabÀ
);

404 
eff‹t
 > 0) {

405 
eff‹t
--;

406 
	`øxSìk
(&
ri
,"^",
NULL
,0);

407 
	`øxR™domWÆk
(&
ri
,0);

408 i‡(
	`øxEOF
(&
ri
)) ;

409 
	`åackögInvÆid©eKeyRaw
(
NULL
,(*)
ri
.
key
,ri.
key_Àn
,0);

410 i‡(
	`øxSize
(
TøckögTabÀ
Ë<
max_keys
) {

411 
timeout_cou¡î
 = 0;

412 
	`øxSt›
(&
ri
);

419 
	`øxSt›
(&
ri
);

420 
timeout_cou¡î
++;

421 
	}
}

429 
sds
 
	$åackögBuûdBrﬂdˇ°Rïly
(
˛õ¡
 *
c
, 
øx
 *
keys
) {

430 
øxIãøt‹
 
ri
;

431 
uöt64_t
 
cou¡
;

433 i‡(
c
 =
NULL
) {

434 
cou¡
 = 
	`øxSize
(
keys
);

436 
cou¡
 = 0;

437 
	`øxSèπ
(&
ri
,
keys
);

438 
	`øxSìk
(&
ri
,"^",
NULL
,0);

439 
	`øxNext
(&
ri
)) {

440 i‡(
ri
.
d©a
 !
c
Ë
cou¡
++;

442 
	`øxSt›
(&
ri
);

444 i‡(
cou¡
 =0Ë 
NULL
;

449 
buf
[32];

450 
size_t
 
Àn
 = 
	`Œ2°rög
(
buf
,(buf),
cou¡
);

451 
sds
 
¥Ÿo
 = 
	`sd£m±y
();

452 
¥Ÿo
 = 
	`sdsMakeRoomF‹
’rŸo,
cou¡
*15);

453 
¥Ÿo
 = 
	`sdsˇéí
(proto,"*",1);

454 
¥Ÿo
 = 
	`sdsˇéí
’rŸo,
buf
,
Àn
);

455 
¥Ÿo
 = 
	`sdsˇéí
(proto,"\r\n",2);

456 
	`øxSèπ
(&
ri
,
keys
);

457 
	`øxSìk
(&
ri
,"^",
NULL
,0);

458 
	`øxNext
(&
ri
)) {

459 i‡(
c
 && 
ri
.
d©a
 == c) ;

460 
Àn
 = 
	`Œ2°rög
(
buf
,(buf),
ri
.
key_Àn
);

461 
¥Ÿo
 = 
	`sdsˇéí
(proto,"$",1);

462 
¥Ÿo
 = 
	`sdsˇéí
’rŸo,
buf
,
Àn
);

463 
¥Ÿo
 = 
	`sdsˇéí
(proto,"\r\n",2);

464 
¥Ÿo
 = 
	`sdsˇéí
’rŸo,
ri
.
key
,ri.
key_Àn
);

465 
¥Ÿo
 = 
	`sdsˇéí
(proto,"\r\n",2);

467 
	`øxSt›
(&
ri
);

468  
¥Ÿo
;

469 
	}
}

474 
	$åackögBrﬂdˇ°InvÆid©i⁄Mesßges
() {

475 
øxIãøt‹
 
ri
, 
ri2
;

478 i‡(
TøckögTabÀ
 =
NULL
 || !
£rvî
.
åackög_˛õ¡s
) ;

480 
	`øxSèπ
(&
ri
,
PªfixTabÀ
);

481 
	`øxSìk
(&
ri
,"^",
NULL
,0);

484 
	`øxNext
(&
ri
)) {

485 
bˇ°Sèã
 *
bs
 = 
ri
.
d©a
;

487 i‡(
	`øxSize
(
bs
->
keys
)) {

490 
sds
 
¥Ÿo
 = 
	`åackögBuûdBrﬂdˇ°Rïly
(
NULL
,
bs
->
keys
);

493 
	`øxSèπ
(&
ri2
,
bs
->
˛õ¡s
);

494 
	`øxSìk
(&
ri2
,"^",
NULL
,0);

495 
	`øxNext
(&
ri2
)) {

496 
˛õ¡
 *
c
;

497 
	`mem˝y
(&
c
,
ri2
.
key
,(c));

498 i‡(
c
->
Êags
 & 
CLIENT_TRACKING_NOLOOP
) {

500 
sds
 
adhoc
 = 
	`åackögBuûdBrﬂdˇ°Rïly
(
c
,
bs
->
keys
);

501 i‡(
adhoc
) {

502 
	`£ndTøckögMesßge
(
c
,
adhoc
,
	`sd¶í
(adhoc),1);

503 
	`sds‰ì
(
adhoc
);

506 
	`£ndTøckögMesßge
(
c
,
¥Ÿo
,
	`sd¶í
(proto),1);

509 
	`øxSt›
(&
ri2
);

514 
	`sds‰ì
(
¥Ÿo
);

516 
	`øxFªe
(
bs
->
keys
);

517 
bs
->
keys
 = 
	`øxNew
();

519 
	`øxSt›
(&
ri
);

520 
	}
}

524 
uöt64_t
 
	$åackögGëTŸÆIãms
() {

525  
TøckögTabÀTŸÆIãms
;

526 
	}
}

528 
uöt64_t
 
	$åackögGëTŸÆKeys
() {

529 i‡(
TøckögTabÀ
 =
NULL
)  0;

530  
	`øxSize
(
TøckögTabÀ
);

531 
	}
}

533 
uöt64_t
 
	$åackögGëTŸÆPªfixes
() {

534 i‡(
PªfixTabÀ
 =
NULL
)  0;

535  
	`øxSize
(
PªfixTabÀ
);

536 
	}
}

	@util.c

30 
	~"fma¸os.h
"

31 
	~<°dlib.h
>

32 
	~<°dio.h
>

33 
	~<°rög.h
>

34 
	~<˘y≥.h
>

35 
	~<limôs.h
>

36 
	~<m©h.h
>

37 
	~<uni°d.h
>

38 
	~<sys/time.h
>

39 
	~<Êﬂt.h
>

40 
	~<°döt.h
>

41 
	~<î∫o.h
>

42 
	~<time.h
>

44 
	~"utû.h
"

45 
	~"sha256.h
"

48 
	$°rögm©chÀn
(c⁄° *
∑âîn
, 
∑âînLí
,

49 c⁄° *
°rög
, 
°rögLí
, 
noˇ£
)

51 
∑âînLí
 && 
°rögLí
) {

52 
∑âîn
[0]) {

54 
∑âînLí
 && 
∑âîn
[1] == '*') {

55 
∑âîn
++;

56 
∑âînLí
--;

58 i‡(
∑âînLí
 == 1)

60 
°rögLí
) {

61 i‡(
	`°rögm©chÀn
(
∑âîn
+1, 
∑âînLí
-1,

62 
°rög
, 
°rögLí
, 
noˇ£
))

64 
°rög
++;

65 
°rögLí
--;

70 
°rög
++;

71 
°rögLí
--;

75 
nŸ
, 
m©ch
;

77 
∑âîn
++;

78 
∑âînLí
--;

79 
nŸ
 = 
∑âîn
[0] == '^';

80 i‡(
nŸ
) {

81 
∑âîn
++;

82 
∑âînLí
--;

84 
m©ch
 = 0;

86 i‡(
∑âîn
[0] ='\\' && 
∑âînLí
 >= 2) {

87 
∑âîn
++;

88 
∑âînLí
--;

89 i‡(
∑âîn
[0] =
°rög
[0])

90 
m©ch
 = 1;

91 } i‡(
∑âîn
[0] == ']') {

93 } i‡(
∑âînLí
 == 0) {

94 
∑âîn
--;

95 
∑âînLí
++;

97 } i‡(
∑âînLí
 >3 && 
∑âîn
[1] == '-') {

98 
°¨t
 = 
∑âîn
[0];

99 
íd
 = 
∑âîn
[2];

100 
c
 = 
°rög
[0];

101 i‡(
°¨t
 > 
íd
) {

102 
t
 = 
°¨t
;

103 
°¨t
 = 
íd
;

104 
íd
 = 
t
;

106 i‡(
noˇ£
) {

107 
°¨t
 = 
	`tﬁowî
(start);

108 
íd
 = 
	`tﬁowî
(end);

109 
c
 = 
	`tﬁowî
(c);

111 
∑âîn
 += 2;

112 
∑âînLí
 -= 2;

113 i‡(
c
 >
°¨t
 && c <
íd
)

114 
m©ch
 = 1;

116 i‡(!
noˇ£
) {

117 i‡(
∑âîn
[0] =
°rög
[0])

118 
m©ch
 = 1;

120 i‡(
	`tﬁowî
(()
∑âîn
[0]Ë=tﬁowî(()
°rög
[0]))

121 
m©ch
 = 1;

124 
∑âîn
++;

125 
∑âînLí
--;

127 i‡(
nŸ
)

128 
m©ch
 = !match;

129 i‡(!
m©ch
)

131 
°rög
++;

132 
°rögLí
--;

136 i‡(
∑âînLí
 >= 2) {

137 
∑âîn
++;

138 
∑âînLí
--;

142 i‡(!
noˇ£
) {

143 i‡(
∑âîn
[0] !
°rög
[0])

146 i‡(
	`tﬁowî
(()
∑âîn
[0]Ë!tﬁowî(()
°rög
[0]))

149 
°rög
++;

150 
°rögLí
--;

153 
∑âîn
++;

154 
∑âînLí
--;

155 i‡(
°rögLí
 == 0) {

156 *
∑âîn
 == '*') {

157 
∑âîn
++;

158 
∑âînLí
--;

163 i‡(
∑âînLí
 =0 && 
°rögLí
 == 0)

166 
	}
}

168 
	$°rögm©ch
(c⁄° *
∑âîn
, c⁄° *
°rög
, 
noˇ£
) {

169  
	`°rögm©chÀn
(
∑âîn
,
	`°æí
’©ã∫),
°rög
,°æí(°rög),
noˇ£
);

170 
	}
}

173 
	$°rögm©chÀn_fuzz_ã°
() {

174 
°r
[32];

175 
∑t
[32];

176 
cy˛es
 = 10000000;

177 
tŸÆ_m©ches
 = 0;

178 
cy˛es
--) {

179 
°æí
 = 
	`ønd
(Ë% (
°r
);

180 
∑éí
 = 
	`ønd
(Ë% (
∑t
);

181 
j
 = 0; j < 
°æí
; j++Ë
°r
[j] = 
	`ønd
() % 128;

182 
j
 = 0; j < 
∑éí
; j++Ë
∑t
[j] = 
	`ønd
() % 128;

183 
tŸÆ_m©ches
 +
	`°rögm©chÀn
(
∑t
, 
∑éí
, 
°r
, 
°æí
, 0);

185  
tŸÆ_m©ches
;

186 
	}
}

195 
	$memtﬁl
(c⁄° *
p
, *
îr
) {

196 c⁄° *
u
;

197 
buf
[128];

198 
mul
;

199 
vÆ
;

200 
digôs
;

202 i‡(
îr
) *err = 0;

205 
u
 = 
p
;

206 i‡(*
u
 == '-') u++;

207 *
u
 && 
	`isdigô
(*u)) u++;

208 i‡(*
u
 ='\0' || !
	`°rˇ£cmp
(u,"b")) {

209 
mul
 = 1;

210 } i‡(!
	`°rˇ£cmp
(
u
,"k")) {

211 
mul
 = 1000;

212 } i‡(!
	`°rˇ£cmp
(
u
,"kb")) {

213 
mul
 = 1024;

214 } i‡(!
	`°rˇ£cmp
(
u
,"m")) {

215 
mul
 = 1000*1000;

216 } i‡(!
	`°rˇ£cmp
(
u
,"mb")) {

217 
mul
 = 1024*1024;

218 } i‡(!
	`°rˇ£cmp
(
u
,"g")) {

219 
mul
 = 1000L*1000*1000;

220 } i‡(!
	`°rˇ£cmp
(
u
,"gb")) {

221 
mul
 = 1024L*1024*1024;

223 i‡(
îr
) *err = 1;

229 
digôs
 = 
u
-
p
;

230 i‡(
digôs
 >(
buf
)) {

231 i‡(
îr
) *err = 1;

234 
	`mem˝y
(
buf
,
p
,
digôs
);

235 
buf
[
digôs
] = '\0';

237 *
íd±r
;

238 
î∫o
 = 0;

239 
vÆ
 = 
	`°πﬁl
(
buf
,&
íd±r
,10);

240 i‡((
vÆ
 =0 && 
î∫o
 =
EINVAL
Ë|| *
íd±r
 != '\0') {

241 i‡(
îr
) *err = 1;

244  
vÆ
*
mul
;

245 
	}
}

249 
uöt32_t
 
	$digôs10
(
uöt64_t
 
v
) {

250 i‡(
v
 < 10)  1;

251 i‡(
v
 < 100)  2;

252 i‡(
v
 < 1000)  3;

253 i‡(
v
 < 1000000000000UL) {

254 i‡(
v
 < 100000000UL) {

255 i‡(
v
 < 1000000) {

256 i‡(
v
 < 10000)  4;

257  5 + (
v
 >= 100000);

259  7 + (
v
 >= 10000000UL);

261 i‡(
v
 < 10000000000UL) {

262  9 + (
v
 >= 1000000000UL);

264  11 + (
v
 >= 100000000000UL);

266  12 + 
	`digôs10
(
v
 / 1000000000000UL);

267 
	}
}

270 
uöt32_t
 
	$sdigôs10
(
öt64_t
 
v
) {

271 i‡(
v
 < 0) {

273 
uöt64_t
 
uv
 = (
v
 !
LLONG_MIN
) ?

274 (
uöt64_t
)-
v
 : ((uöt64_tË
LLONG_MAX
)+1;

275  
	`digôs10
(
uv
)+1;

277  
	`digôs10
(
v
);

279 
	}
}

292 
	$Œ2°rög
(*
d°
, 
size_t
 
d°Àn
, 
svÆue
) {

293 c⁄° 
digôs
[201] =

299 
√g©ive
;

300 
vÆue
;

304 i‡(
svÆue
 < 0) {

305 i‡(
svÆue
 !
LLONG_MIN
) {

306 
vÆue
 = -
svÆue
;

308 
vÆue
 = ((Ë
LLONG_MAX
)+1;

310 
√g©ive
 = 1;

312 
vÆue
 = 
svÆue
;

313 
√g©ive
 = 0;

317 
uöt32_t
 c⁄° 
Àngth
 = 
	`digôs10
(
vÆue
)+
√g©ive
;

318 i‡(
Àngth
 >
d°Àn
)  0;

321 
uöt32_t
 
√xt
 = 
Àngth
;

322 
d°
[
√xt
] = '\0';

323 
√xt
--;

324 
vÆue
 >= 100) {

325 c⁄° 
i
 = (
vÆue
 % 100) * 2;

326 
vÆue
 /= 100;

327 
d°
[
√xt
] = 
digôs
[
i
 + 1];

328 
d°
[
√xt
 - 1] = 
digôs
[
i
];

329 
√xt
 -= 2;

333 i‡(
vÆue
 < 10) {

334 
d°
[
√xt
] = '0' + (
uöt32_t
Ë
vÆue
;

336 
i
 = (
uöt32_t
Ë
vÆue
 * 2;

337 
d°
[
√xt
] = 
digôs
[
i
 + 1];

338 
d°
[
√xt
 - 1] = 
digôs
[
i
];

342 i‡(
√g©ive
Ë
d°
[0] = '-';

343  
Àngth
;

344 
	}
}

358 
	$°rög2Œ
(c⁄° *
s
, 
size_t
 
¶í
, *
vÆue
) {

359 c⁄° *
p
 = 
s
;

360 
size_t
 
∂í
 = 0;

361 
√g©ive
 = 0;

362 
v
;

365 i‡(
∂í
 =
¶í
)

369 i‡(
¶í
 =1 && 
p
[0] == '0') {

370 i‡(
vÆue
 !
NULL
) *value = 0;

376 i‡(
p
[0] == '-') {

377 
√g©ive
 = 1;

378 
p
++; 
∂í
++;

381 i‡(
∂í
 =
¶í
)

386 i‡(
p
[0] >= '1' &&Ö[0] <= '9') {

387 
v
 = 
p
[0]-'0';

388 
p
++; 
∂í
++;

394 
∂í
 < 
¶í
 && 
p
[0] >= '0' &&Ö[0] <= '9') {

395 i‡(
v
 > (
ULLONG_MAX
 / 10))

397 
v
 *= 10;

399 i‡(
v
 > (
ULLONG_MAX
 - (
p
[0]-'0')))

401 
v
 +
p
[0]-'0';

403 
p
++; 
∂í
++;

407 i‡(
∂í
 < 
¶í
)

412 i‡(
√g©ive
) {

413 i‡(
v
 > (()(-(
LLONG_MIN
+1))+1))

415 i‡(
vÆue
 !
NULL
Ë*vÆuê-
v
;

417 i‡(
v
 > 
LLONG_MAX
)

419 i‡(
vÆue
 !
NULL
Ë*vÆuê
v
;

422 
	}
}

429 
	$°rög2uŒ
(c⁄° *
s
, *
vÆue
) {

430 
Œ
;

431 i‡(
	`°rög2Œ
(
s
,
	`°æí
(s),&
Œ
)) {

432 i‡(
Œ
 < 0)  0;

433 *
vÆue
 = 
Œ
;

436 
î∫o
 = 0;

437 *
íd±r
 = 
NULL
;

438 *
vÆue
 = 
	`°πouŒ
(
s
,&
íd±r
,10);

439 i‡(
î∫o
 =
EINVAL
 ||Éºnÿ=
ERANGE
 || !(*
s
 !'\0' && *
íd±r
 == '\0'))

442 
	}
}

447 
	$°rög2l
(c⁄° *
s
, 
size_t
 
¶í
, *
lvÆ
) {

448 
ŒvÆ
;

450 i‡(!
	`°rög2Œ
(
s
,
¶í
,&
ŒvÆ
))

453 i‡(
ŒvÆ
 < 
LONG_MIN
 ||ÜlvÆ > 
LONG_MAX
)

456 *
lvÆ
 = ()
ŒvÆ
;

458 
	}
}

467 
	$°rög2ld
(c⁄° *
s
, 
size_t
 
¶í
, *
dp
) {

468 
buf
[
MAX_LONG_DOUBLE_CHARS
];

469 
vÆue
;

470 *
ïå
;

472 i‡(
¶í
 =0 || sÀ¿>(
buf
))  0;

473 
	`mem˝y
(
buf
,
s
,
¶í
);

474 
buf
[
¶í
] = '\0';

476 
î∫o
 = 0;

477 
vÆue
 = 
	`°πﬁd
(
buf
, &
ïå
);

478 i‡(
	`is•a˚
(
buf
[0]Ë|| 
ïå
[0] != '\0' ||

479 (
size_t
)(
ïå
-
buf
Ë!
¶í
 ||

480 (
î∫o
 =
ERANGE
 &&

481 (
vÆue
 =
HUGE_VAL
 || value == -HUGE_VAL || value == 0)) ||

482 
î∫o
 =
EINVAL
 ||

483 
	`i¢™
(
vÆue
))

486 i‡(
dp
Ë*d∞
vÆue
;

488 
	}
}

497 
	$°rög2d
(c⁄° *
s
, 
size_t
 
¶í
, *
dp
) {

498 
î∫o
 = 0;

499 *
ïå
;

500 *
dp
 = 
	`°πod
(
s
, &
ïå
);

501 i‡(
¶í
 == 0 ||

502 
	`is•a˚
(((c⁄° *)
s
)[0]) ||

503 (
size_t
)(
ïå
-(*)
s
Ë!
¶í
 ||

504 (
î∫o
 =
ERANGE
 &&

505 (*
dp
 =
HUGE_VAL
 || *dp == -HUGE_VAL || *dp == 0)) ||

506 
	`i¢™
(*
dp
))

509 
	}
}

516 
	$d2°rög
(*
buf
, 
size_t
 
Àn
, 
vÆue
) {

517 i‡(
	`i¢™
(
vÆue
)) {

518 
Àn
 = 
	`¢¥ötf
(
buf
,len,"nan");

519 } i‡(
	`isöf
(
vÆue
)) {

520 i‡(
vÆue
 < 0)

521 
Àn
 = 
	`¢¥ötf
(
buf
,len,"-inf");

523 
Àn
 = 
	`¢¥ötf
(
buf
,len,"inf");

524 } i‡(
vÆue
 == 0) {

526 i‡(1.0/
vÆue
 < 0)

527 
Àn
 = 
	`¢¥ötf
(
buf
,len,"-0");

529 
Àn
 = 
	`¢¥ötf
(
buf
,len,"0");

531 #i‡(
DBL_MANT_DIG
 >52Ë&& (
LLONG_MAX
 == 0x7fffffffffffffffLL)

541 
mö
 = -4503599627370495;

542 
max
 = 4503599627370496;

543 i‡(
vÆue
 > 
mö
 && vÆuê< 
max
 && value == (()(()value)))

544 
Àn
 = 
	`Œ2°rög
(
buf
,Àn,()
vÆue
);

547 
Àn
 = 
	`¢¥ötf
(
buf
,Àn,"%.17g",
vÆue
);

550  
Àn
;

551 
	}
}

562 
	$ld2°rög
(*
buf
, 
size_t
 
Àn
, 
vÆue
, 
ld2°rög_mode
 
mode
) {

563 
size_t
 
l
 = 0;

565 i‡(
	`isöf
(
vÆue
)) {

568 i‡(
Àn
 < 5)  0;

569 i‡(
vÆue
 > 0) {

570 
	`mem˝y
(
buf
,"inf",3);

571 
l
 = 3;

573 
	`mem˝y
(
buf
,"-inf",4);

574 
l
 = 4;

577 
mode
) {

578 
LD_STR_AUTO
:

579 
l
 = 
	`¢¥ötf
(
buf
,
Àn
,"%.17Lg",
vÆue
);

580 i‡(
l
+1 > 
Àn
)  0;

582 
LD_STR_HEX
:

583 
l
 = 
	`¢¥ötf
(
buf
,
Àn
,"%La",
vÆue
);

584 i‡(
l
+1 > 
Àn
)  0;

586 
LD_STR_HUMAN
:

592 
l
 = 
	`¢¥ötf
(
buf
,
Àn
,"%.17Lf",
vÆue
);

593 i‡(
l
+1 > 
Àn
)  0;

595 i‡(
	`°rchr
(
buf
,'.'Ë!
NULL
) {

596 *
p
 = 
buf
+
l
-1;

597 *
p
 == '0') {

598 
p
--;

599 
l
--;

601 i‡(*
p
 ='.'Ë
l
--;

603 i‡(
l
 =2 && 
buf
[0] == '-' && buf[1] == '0') {

604 
buf
[0] = '0';

605 
l
 = 1;

611 
buf
[
l
] = '\0';

612  
l
;

613 
	}
}

620 
	$gëR™domByãs
(*
p
, 
size_t
 
Àn
) {

622 
£ed_öôülized
 = 0;

623 
£ed
[64];

624 
uöt64_t
 
cou¡î
 = 0;

626 i‡(!
£ed_öôülized
) {

631 
FILE
 *
Â
 = 
	`f›í
("/dev/urandom","r");

632 i‡(
Â
 =
NULL
 || 
	`‰ód
(
£ed
,(seed),1,fp) != 1) {

635 
j
 = 0; j < (
£ed
); j++) {

636 
timevÆ
 
tv
;

637 
	`gëtimeofday
(&
tv
,
NULL
);

638 
pid_t
 
pid
 = 
	`gëpid
();

639 
£ed
[
j
] = 
tv
.
tv_£c
 ^Åv.
tv_u£c
 ^ 
pid
 ^ ()
Â
;

642 
£ed_öôülized
 = 1;

644 i‡(
Â
Ë
	`f˛o£
(fp);

647 
Àn
) {

649 
dige°
[
SHA256_BLOCK_SIZE
];

650 
kx‹
[64];

651 
c›yÀn
 =

652 
Àn
 > 
SHA256_BLOCK_SIZE
 ? SHA256_BLOCK_SIZE :Üen;

655 
	`mem˝y
(
kx‹
,
£ed
,(kxor));

656 
i
 = 0; i < (
kx‹
); i++) kxor[i] ^= 0x36;

659 
SHA256_CTX
 
˘x
;

660 
	`sha256_öô
(&
˘x
);

661 
	`sha256_upd©e
(&
˘x
,
kx‹
,(kxor));

662 
	`sha256_upd©e
(&
˘x
,(*)&
cou¡î
,(counter));

663 
	`sha256_föÆ
(&
˘x
,
dige°
);

666 
	`mem˝y
(
kx‹
,
£ed
,(kxor));

667 
i
 = 0; i < (
kx‹
); i++) kxor[i] ^= 0x5C;

670 
	`sha256_öô
(&
˘x
);

671 
	`sha256_upd©e
(&
˘x
,
kx‹
,(kxor));

672 
	`sha256_upd©e
(&
˘x
,
dige°
,
SHA256_BLOCK_SIZE
);

673 
	`sha256_föÆ
(&
˘x
,
dige°
);

676 
cou¡î
++;

678 
	`mem˝y
(
p
,
dige°
,
c›yÀn
);

679 
Àn
 -
c›yÀn
;

680 
p
 +
c›yÀn
;

682 
	}
}

688 
	$gëR™domHexCh¨s
(*
p
, 
size_t
 
Àn
) {

689 *
ch¨£t
 = "0123456789abcdef";

690 
size_t
 
j
;

692 
	`gëR™domByãs
((*)
p
,
Àn
);

693 
j
 = 0; j < 
Àn
; j++Ë
p
[j] = 
ch¨£t
[p[j] & 0x0F];

694 
	}
}

703 
sds
 
	$gëAbsﬁuãP©h
(*
fûíame
) {

704 
cwd
[1024];

705 
sds
 
ab•©h
;

706 
sds
 
ªÕ©h
 = 
	`sd¢ew
(
fûíame
);

708 
ªÕ©h
 = 
	`sd°rim
(relpath," \r\n\t");

709 i‡(
ªÕ©h
[0] == '/') Ñelpath;

712 i‡(
	`gëcwd
(
cwd
,(cwd)Ë=
NULL
) {

713 
	`sds‰ì
(
ªÕ©h
);

714  
NULL
;

716 
ab•©h
 = 
	`sd¢ew
(
cwd
);

717 i‡(
	`sd¶í
(
ab•©h
) &&ábspath[sdslen(abspath)-1] != '/')

718 
ab•©h
 = 
	`sdsˇt
(abspath,"/");

726 
	`sd¶í
(
ªÕ©h
) >= 3 &&

727 
ªÕ©h
[0] == '.' &&Ñelpath[1] == '.' &&Ñelpath[2] == '/')

729 
	`sd§™ge
(
ªÕ©h
,3,-1);

730 i‡(
	`sd¶í
(
ab•©h
) > 1) {

731 *
p
 = 
ab•©h
 + 
	`sd¶í
(abspath)-2;

732 
åimÀn
 = 1;

734 *
p
 != '/') {

735 
p
--;

736 
åimÀn
++;

738 
	`sd§™ge
(
ab•©h
,0,-(
åimÀn
+1));

743 
ab•©h
 = 
	`sdsˇtsds
◊b•©h,
ªÕ©h
);

744 
	`sds‰ì
(
ªÕ©h
);

745  
ab•©h
;

746 
	}
}

753 
	$gëTimeZ⁄e
() {

754 #ifde‡
__löux__


755  
timez⁄e
;

757 
timevÆ
 
tv
;

758 
timez⁄e
 
tz
;

760 
	`gëtimeofday
(&
tv
, &
tz
);

762  
tz
.
tz_möuãswe°
 * 60UL;

764 
	}
}

770 
	$∑thIsBa£Name
(*
∑th
) {

771  
	`°rchr
(
∑th
,'/'Ë=
NULL
 && strchr(path,'\\') == NULL;

772 
	}
}

774 #ifde‡
REDIS_TEST


775 
	~<as£π.h
>

777 
	$ã°_°rög2Œ
() {

778 
buf
[32];

779 
v
;

782 
	`°r˝y
(
buf
,"+1");

783 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 0);

786 
	`°r˝y
(
buf
," 1");

787 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 0);

790 
	`°r˝y
(
buf
,"1 ");

791 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 0);

794 
	`°r˝y
(
buf
,"01");

795 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 0);

797 
	`°r˝y
(
buf
,"-1");

798 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 1);

799 
	`as£π
(
v
 == -1);

801 
	`°r˝y
(
buf
,"0");

802 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 1);

803 
	`as£π
(
v
 == 0);

805 
	`°r˝y
(
buf
,"1");

806 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 1);

807 
	`as£π
(
v
 == 1);

809 
	`°r˝y
(
buf
,"99");

810 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 1);

811 
	`as£π
(
v
 == 99);

813 
	`°r˝y
(
buf
,"-99");

814 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 1);

815 
	`as£π
(
v
 == -99);

817 
	`°r˝y
(
buf
,"-9223372036854775808");

818 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 1);

819 
	`as£π
(
v
 =
LLONG_MIN
);

821 
	`°r˝y
(
buf
,"-9223372036854775809");

822 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 0);

824 
	`°r˝y
(
buf
,"9223372036854775807");

825 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 1);

826 
	`as£π
(
v
 =
LLONG_MAX
);

828 
	`°r˝y
(
buf
,"9223372036854775808");

829 
	`as£π
(
	`°rög2Œ
(
buf
,
	`°æí
(buf),&
v
) == 0);

830 
	}
}

832 
	$ã°_°rög2l
() {

833 
buf
[32];

834 
v
;

837 
	`°r˝y
(
buf
,"+1");

838 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 0);

841 
	`°r˝y
(
buf
,"01");

842 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 0);

844 
	`°r˝y
(
buf
,"-1");

845 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 1);

846 
	`as£π
(
v
 == -1);

848 
	`°r˝y
(
buf
,"0");

849 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 1);

850 
	`as£π
(
v
 == 0);

852 
	`°r˝y
(
buf
,"1");

853 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 1);

854 
	`as£π
(
v
 == 1);

856 
	`°r˝y
(
buf
,"99");

857 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 1);

858 
	`as£π
(
v
 == 99);

860 
	`°r˝y
(
buf
,"-99");

861 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 1);

862 
	`as£π
(
v
 == -99);

864 #i‡
LONG_MAX
 !
LLONG_MAX


865 
	`°r˝y
(
buf
,"-2147483648");

866 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 1);

867 
	`as£π
(
v
 =
LONG_MIN
);

869 
	`°r˝y
(
buf
,"-2147483649");

870 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 0);

872 
	`°r˝y
(
buf
,"2147483647");

873 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 1);

874 
	`as£π
(
v
 =
LONG_MAX
);

876 
	`°r˝y
(
buf
,"2147483648");

877 
	`as£π
(
	`°rög2l
(
buf
,
	`°æí
(buf),&
v
) == 0);

879 
	}
}

881 
	$ã°_Œ2°rög
() {

882 
buf
[32];

883 
v
;

884 
sz
;

886 
v
 = 0;

887 
sz
 = 
	`Œ2°rög
(
buf
,  buf, 
v
);

888 
	`as£π
(
sz
 == 1);

889 
	`as£π
(!
	`°rcmp
(
buf
, "0"));

891 
v
 = -1;

892 
sz
 = 
	`Œ2°rög
(
buf
,  buf, 
v
);

893 
	`as£π
(
sz
 == 2);

894 
	`as£π
(!
	`°rcmp
(
buf
, "-1"));

896 
v
 = 99;

897 
sz
 = 
	`Œ2°rög
(
buf
,  buf, 
v
);

898 
	`as£π
(
sz
 == 2);

899 
	`as£π
(!
	`°rcmp
(
buf
, "99"));

901 
v
 = -99;

902 
sz
 = 
	`Œ2°rög
(
buf
,  buf, 
v
);

903 
	`as£π
(
sz
 == 3);

904 
	`as£π
(!
	`°rcmp
(
buf
, "-99"));

906 
v
 = -2147483648;

907 
sz
 = 
	`Œ2°rög
(
buf
,  buf, 
v
);

908 
	`as£π
(
sz
 == 11);

909 
	`as£π
(!
	`°rcmp
(
buf
, "-2147483648"));

911 
v
 = 
LLONG_MIN
;

912 
sz
 = 
	`Œ2°rög
(
buf
,  buf, 
v
);

913 
	`as£π
(
sz
 == 20);

914 
	`as£π
(!
	`°rcmp
(
buf
, "-9223372036854775808"));

916 
v
 = 
LLONG_MAX
;

917 
sz
 = 
	`Œ2°rög
(
buf
,  buf, 
v
);

918 
	`as£π
(
sz
 == 19);

919 
	`as£π
(!
	`°rcmp
(
buf
, "9223372036854775807"));

920 
	}
}

922 
	#UNUSED
(
x
Ë()(x)

	)

923 
	$utûTe°
(
¨gc
, **
¨gv
) {

924 
	`UNUSED
(
¨gc
);

925 
	`UNUSED
(
¨gv
);

927 
	`ã°_°rög2Œ
();

928 
	`ã°_°rög2l
();

929 
	`ã°_Œ2°rög
();

931 
	}
}

	@util.h

30 #i‚de‡
__REDIS_UTIL_H


31 
	#__REDIS_UTIL_H


	)

33 
	~<°döt.h
>

34 
	~"sds.h
"

39 
	#MAX_LONG_DOUBLE_CHARS
 5*1024

	)

43 
	mLD_STR_AUTO
,

44 
	mLD_STR_HUMAN
,

45 
	mLD_STR_HEX


46 } 
	tld2°rög_mode
;

48 
°rögm©chÀn
(c⁄° *
p
, 
∂í
, c⁄° *
s
, 
¶í
, 
noˇ£
);

49 
°rögm©ch
(c⁄° *
p
, c⁄° *
s
, 
noˇ£
);

50 
°rögm©chÀn_fuzz_ã°
();

51 
memtﬁl
(c⁄° *
p
, *
îr
);

52 
uöt32_t
 
digôs10
(
uöt64_t
 
v
);

53 
uöt32_t
 
sdigôs10
(
öt64_t
 
v
);

54 
Œ2°rög
(*
s
, 
size_t
 
Àn
, 
vÆue
);

55 
°rög2Œ
(c⁄° *
s
, 
size_t
 
¶í
, *
vÆue
);

56 
°rög2uŒ
(c⁄° *
s
, *
vÆue
);

57 
°rög2l
(c⁄° *
s
, 
size_t
 
¶í
, *
vÆue
);

58 
°rög2ld
(c⁄° *
s
, 
size_t
 
¶í
, *
dp
);

59 
°rög2d
(c⁄° *
s
, 
size_t
 
¶í
, *
dp
);

60 
d2°rög
(*
buf
, 
size_t
 
Àn
, 
vÆue
);

61 
ld2°rög
(*
buf
, 
size_t
 
Àn
, 
vÆue
, 
ld2°rög_mode
 
mode
);

62 
sds
 
gëAbsﬁuãP©h
(*
fûíame
);

63 
gëTimeZ⁄e
();

64 
∑thIsBa£Name
(*
∑th
);

66 #ifde‡
REDIS_TEST


67 
utûTe°
(
¨gc
, **
¨gv
);

	@version.h

1 
	#REDIS_VERSION
 "6.0.3"

	)

	@ziplist.c

182 
	~<°dio.h
>

183 
	~<°dlib.h
>

184 
	~<°rög.h
>

185 
	~<°döt.h
>

186 
	~<limôs.h
>

187 
	~"zmÆloc.h
"

188 
	~"utû.h
"

189 
	~"zùli°.h
"

190 
	~"ídünc⁄v.h
"

191 
	~"ªdißs£π.h
"

193 
	#ZIP_END
 255

	)

194 
	#ZIP_BIG_PREVLEN
 254

	)

202 
	#ZIP_STR_MASK
 0xc0

	)

203 
	#ZIP_INT_MASK
 0x30

	)

204 
	#ZIP_STR_06B
 (0 << 6)

	)

205 
	#ZIP_STR_14B
 (1 << 6)

	)

206 
	#ZIP_STR_32B
 (2 << 6)

	)

207 
	#ZIP_INT_16B
 (0xc0 | 0<<4)

	)

208 
	#ZIP_INT_32B
 (0xc0 | 1<<4)

	)

209 
	#ZIP_INT_64B
 (0xc0 | 2<<4)

	)

210 
	#ZIP_INT_24B
 (0xc0 | 3<<4)

	)

211 
	#ZIP_INT_8B
 0x„

	)

215 
	#ZIP_INT_IMM_MASK
 0x0‡

	)

217 
	#ZIP_INT_IMM_MIN
 0xf1

	)

218 
	#ZIP_INT_IMM_MAX
 0xfd

	)

220 
	#INT24_MAX
 0x7fffff

	)

221 
	#INT24_MIN
 (-
INT24_MAX
 - 1)

	)

225 
	#ZIP_IS_STR
(
íc
Ë((”ncË& 
ZIP_STR_MASK
Ë< ZIP_STR_MASK)

	)

230 
	#ZIPLIST_BYTES
(
zl
Ë(*((
uöt32_t
*)(zl)))

	)

233 
	#ZIPLIST_TAIL_OFFSET
(
zl
Ë(*((
uöt32_t
*)((zl)+(uöt32_t))))

	)

237 
	#ZIPLIST_LENGTH
(
zl
Ë(*((
uöt16_t
*)((zl)+(
uöt32_t
)*2)))

	)

242 
	#ZIPLIST_HEADER_SIZE
 ((
uöt32_t
)*2+(
uöt16_t
))

	)

245 
	#ZIPLIST_END_SIZE
 ((
uöt8_t
))

	)

248 
	#ZIPLIST_ENTRY_HEAD
(
zl
Ë((zl)+
ZIPLIST_HEADER_SIZE
)

	)

252 
	#ZIPLIST_ENTRY_TAIL
(
zl
Ë((zl)+
	`öåev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(zl)))

	)

256 
	#ZIPLIST_ENTRY_END
(
zl
Ë((zl)+
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(zl))-1)

	)

263 
	#ZIPLIST_INCR_LENGTH
(
zl
,
ö¸
) { \

264 i‡(
	`ZIPLIST_LENGTH
(
zl
Ë< 
UINT16_MAX
) \

265 
	`ZIPLIST_LENGTH
(
zl
Ë
	`öåev16ifbe
(öåev16ifbe(ZIPLIST_LENGTH(zl))+
ö¸
); \

266 }

	)

271 
	szÀ¡ry
 {

272 
	m¥evøwÀnsize
;

273 
	m¥evøwÀn
;

274 
	mÀnsize
;

277 
	mÀn
;

282 
	mhódîsize
;

283 
	mícodög
;

287 *
	mp
;

289 } 
	tzÀ¡ry
;

291 
	#ZIPLIST_ENTRY_ZERO
(
zÀ
) { \

292 (
zÀ
)->
¥evøwÀnsize
 = (zÀ)->
¥evøwÀn
 = 0; \

293 (
zÀ
)->
Ànsize
 = (zÀ)->
Àn
 = (zÀ)->
hódîsize
 = 0; \

294 (
zÀ
)->
ícodög
 = 0; \

295 (
zÀ
)->
p
 = 
NULL
; \

296 }

	)

300 
	#ZIP_ENTRY_ENCODING
(
±r
, 
ícodög
) do { \

301 (
ícodög
Ë(
±r
[0]); \

302 i‡((
ícodög
Ë< 
ZIP_STR_MASK
) (encoding) &= ZIP_STR_MASK; \

303 } 0)

	)

306 
	$zùI¡Size
(
ícodög
) {

307 
ícodög
) {

308 
ZIP_INT_8B
:  1;

309 
ZIP_INT_16B
:  2;

310 
ZIP_INT_24B
:  3;

311 
ZIP_INT_32B
:  4;

312 
ZIP_INT_64B
:  8;

314 i‡(
ícodög
 >
ZIP_INT_IMM_MIN
 &&Éncodög <
ZIP_INT_IMM_MAX
)

316 
	`∑nic
("InvÆid i¡egîÉncodög 0x%02X", 
ícodög
);

318 
	}
}

332 
	$zùSt‹eE¡ryEncodög
(*
p
, 
ícodög
, 
øwÀn
) {

333 
Àn
 = 1, 
buf
[5];

335 i‡(
	`ZIP_IS_STR
(
ícodög
)) {

338 i‡(
øwÀn
 <= 0x3f) {

339 i‡(!
p
Ë 
Àn
;

340 
buf
[0] = 
ZIP_STR_06B
 | 
øwÀn
;

341 } i‡(
øwÀn
 <= 0x3fff) {

342 
Àn
 += 1;

343 i‡(!
p
Ë 
Àn
;

344 
buf
[0] = 
ZIP_STR_14B
 | ((
øwÀn
 >> 8) & 0x3f);

345 
buf
[1] = 
øwÀn
 & 0xff;

347 
Àn
 += 4;

348 i‡(!
p
Ë 
Àn
;

349 
buf
[0] = 
ZIP_STR_32B
;

350 
buf
[1] = (
øwÀn
 >> 24) & 0xff;

351 
buf
[2] = (
øwÀn
 >> 16) & 0xff;

352 
buf
[3] = (
øwÀn
 >> 8) & 0xff;

353 
buf
[4] = 
øwÀn
 & 0xff;

357 i‡(!
p
Ë 
Àn
;

358 
buf
[0] = 
ícodög
;

362 
	`mem˝y
(
p
,
buf
,
Àn
);

363  
Àn
;

364 
	}
}

371 
	#ZIP_DECODE_LENGTH
(
±r
, 
ícodög
, 
Ànsize
, 
Àn
) do { \

372 
	`ZIP_ENTRY_ENCODING
((
±r
), (
ícodög
)); \

373 i‡((
ícodög
Ë< 
ZIP_STR_MASK
) { \

374 i‡((
ícodög
Ë=
ZIP_STR_06B
) { \

375 (
Ànsize
) = 1; \

376 (
Àn
Ë(
±r
)[0] & 0x3f; \

377 } i‡((
ícodög
Ë=
ZIP_STR_14B
) { \

378 (
Ànsize
) = 2; \

379 (
Àn
Ë(((
±r
)[0] & 0x3f) << 8) | (ptr)[1]; \

380 } i‡((
ícodög
Ë=
ZIP_STR_32B
) { \

381 (
Ànsize
) = 5; \

382 (
Àn
Ë((
±r
)[1] << 24) | \

383 ((
±r
)[2] << 16) | \

384 ((
±r
)[3] << 8) | \

385 ((
±r
)[4]); \

387 
	`∑nic
("InvÆid såögÉncodög 0x%02X", (
ícodög
)); \

390 (
Ànsize
) = 1; \

391 (
Àn
Ë
	`zùI¡Size
(
ícodög
); \

393 } 0);

	)

397 
	$zùSt‹ePªvE¡ryLígthL¨ge
(*
p
, 
Àn
) {

398 i‡(
p
 !
NULL
) {

399 
p
[0] = 
ZIP_BIG_PREVLEN
;

400 
	`mem˝y
(
p
+1,&
Àn
,(len));

401 
	`memªv32ifbe
(
p
+1);

403  1+(
Àn
);

404 
	}
}

408 
	$zùSt‹ePªvE¡ryLígth
(*
p
, 
Àn
) {

409 i‡(
p
 =
NULL
) {

410  (
Àn
 < 
ZIP_BIG_PREVLEN
) ? 1 : (len)+1;

412 i‡(
Àn
 < 
ZIP_BIG_PREVLEN
) {

413 
p
[0] = 
Àn
;

416  
	`zùSt‹ePªvE¡ryLígthL¨ge
(
p
,
Àn
);

419 
	}
}

423 
	#ZIP_DECODE_PREVLENSIZE
(
±r
, 
¥evÀnsize
) do { \

424 i‡((
±r
)[0] < 
ZIP_BIG_PREVLEN
) { \

425 (
¥evÀnsize
) = 1; \

427 (
¥evÀnsize
) = 5; \

429 } 0);

	)

438 
	#ZIP_DECODE_PREVLEN
(
±r
, 
¥evÀnsize
, 
¥evÀn
) do { \

439 
	`ZIP_DECODE_PREVLENSIZE
(
±r
, 
¥evÀnsize
); \

440 i‡((
¥evÀnsize
) == 1) { \

441 (
¥evÀn
Ë(
±r
)[0]; \

442 } i‡((
¥evÀnsize
) == 5) { \

443 
	`as£π
(((
¥evÀn
)) == 4); \

444 
	`mem˝y
(&(
¥evÀn
), ((*)(
±r
)) + 1, 4); \

445 
	`memªv32ifbe
(&
¥evÀn
); \

447 } 0);

	)

464 
	$zùPªvLíByãDiff
(*
p
, 
Àn
) {

465 
¥evÀnsize
;

466 
	`ZIP_DECODE_PREVLENSIZE
(
p
, 
¥evÀnsize
);

467  
	`zùSt‹ePªvE¡ryLígth
(
NULL
, 
Àn
Ë- 
¥evÀnsize
;

468 
	}
}

471 
	$zùRawE¡ryLígth
(*
p
) {

472 
¥evÀnsize
, 
ícodög
, 
Ànsize
, 
Àn
;

473 
	`ZIP_DECODE_PREVLENSIZE
(
p
, 
¥evÀnsize
);

474 
	`ZIP_DECODE_LENGTH
(
p
 + 
¥evÀnsize
, 
ícodög
, 
Ànsize
, 
Àn
);

475  
¥evÀnsize
 + 
Ànsize
 + 
Àn
;

476 
	}
}

480 
	$zùTryEncodög
(*
íåy
, 
íåyÀn
, *
v
, *
ícodög
) {

481 
vÆue
;

483 i‡(
íåyÀn
 >= 32 ||Éntrylen == 0)  0;

484 i‡(
	`°rög2Œ
((*)
íåy
,
íåyÀn
,&
vÆue
)) {

487 i‡(
vÆue
 >= 0 && value <= 12) {

488 *
ícodög
 = 
ZIP_INT_IMM_MIN
+
vÆue
;

489 } i‡(
vÆue
 >
INT8_MIN
 && vÆuê<
INT8_MAX
) {

490 *
ícodög
 = 
ZIP_INT_8B
;

491 } i‡(
vÆue
 >
INT16_MIN
 && vÆuê<
INT16_MAX
) {

492 *
ícodög
 = 
ZIP_INT_16B
;

493 } i‡(
vÆue
 >
INT24_MIN
 && vÆuê<
INT24_MAX
) {

494 *
ícodög
 = 
ZIP_INT_24B
;

495 } i‡(
vÆue
 >
INT32_MIN
 && vÆuê<
INT32_MAX
) {

496 *
ícodög
 = 
ZIP_INT_32B
;

498 *
ícodög
 = 
ZIP_INT_64B
;

500 *
v
 = 
vÆue
;

504 
	}
}

507 
	$zùSaveI¡egî
(*
p
, 
öt64_t
 
vÆue
, 
ícodög
) {

508 
öt16_t
 
i16
;

509 
öt32_t
 
i32
;

510 
öt64_t
 
i64
;

511 i‡(
ícodög
 =
ZIP_INT_8B
) {

512 ((
öt8_t
*)
p
)[0] = (öt8_t)
vÆue
;

513 } i‡(
ícodög
 =
ZIP_INT_16B
) {

514 
i16
 = 
vÆue
;

515 
	`mem˝y
(
p
,&
i16
,(i16));

516 
	`memªv16ifbe
(
p
);

517 } i‡(
ícodög
 =
ZIP_INT_24B
) {

518 
i32
 = 
vÆue
<<8;

519 
	`memªv32ifbe
(&
i32
);

520 
	`mem˝y
(
p
,((
uöt8_t
*)&
i32
)+1,(i32)-(uint8_t));

521 } i‡(
ícodög
 =
ZIP_INT_32B
) {

522 
i32
 = 
vÆue
;

523 
	`mem˝y
(
p
,&
i32
,(i32));

524 
	`memªv32ifbe
(
p
);

525 } i‡(
ícodög
 =
ZIP_INT_64B
) {

526 
i64
 = 
vÆue
;

527 
	`mem˝y
(
p
,&
i64
,(i64));

528 
	`memªv64ifbe
(
p
);

529 } i‡(
ícodög
 >
ZIP_INT_IMM_MIN
 &&Éncodög <
ZIP_INT_IMM_MAX
) {

532 
	`as£π
(
NULL
);

534 
	}
}

537 
öt64_t
 
	$zùLﬂdI¡egî
(*
p
, 
ícodög
) {

538 
öt16_t
 
i16
;

539 
öt32_t
 
i32
;

540 
öt64_t
 
i64
, 
ªt
 = 0;

541 i‡(
ícodög
 =
ZIP_INT_8B
) {

542 
ªt
 = ((
öt8_t
*)
p
)[0];

543 } i‡(
ícodög
 =
ZIP_INT_16B
) {

544 
	`mem˝y
(&
i16
,
p
,(i16));

545 
	`memªv16ifbe
(&
i16
);

546 
ªt
 = 
i16
;

547 } i‡(
ícodög
 =
ZIP_INT_32B
) {

548 
	`mem˝y
(&
i32
,
p
,(i32));

549 
	`memªv32ifbe
(&
i32
);

550 
ªt
 = 
i32
;

551 } i‡(
ícodög
 =
ZIP_INT_24B
) {

552 
i32
 = 0;

553 
	`mem˝y
(((
uöt8_t
*)&
i32
)+1,
p
,(i32)-(uint8_t));

554 
	`memªv32ifbe
(&
i32
);

555 
ªt
 = 
i32
>>8;

556 } i‡(
ícodög
 =
ZIP_INT_64B
) {

557 
	`mem˝y
(&
i64
,
p
,(i64));

558 
	`memªv64ifbe
(&
i64
);

559 
ªt
 = 
i64
;

560 } i‡(
ícodög
 >
ZIP_INT_IMM_MIN
 &&Éncodög <
ZIP_INT_IMM_MAX
) {

561 
ªt
 = (
ícodög
 & 
ZIP_INT_IMM_MASK
)-1;

563 
	`as£π
(
NULL
);

565  
ªt
;

566 
	}
}

569 
	$zùE¡ry
(*
p
, 
zÀ¡ry
 *
e
) {

571 
	`ZIP_DECODE_PREVLEN
(
p
, 
e
->
¥evøwÀnsize
,É->
¥evøwÀn
);

572 
	`ZIP_DECODE_LENGTH
(
p
 + 
e
->
¥evøwÀnsize
,É->
ícodög
,É->
Ànsize
,É->
Àn
);

573 
e
->
hódîsize
 =É->
¥evøwÀnsize
 +É->
Ànsize
;

574 
e
->
p
 =Ö;

575 
	}
}

578 *
	$zùli°New
() {

579 
byãs
 = 
ZIPLIST_HEADER_SIZE
+
ZIPLIST_END_SIZE
;

580 *
zl
 = 
	`zmÆloc
(
byãs
);

581 
	`ZIPLIST_BYTES
(
zl
Ë
	`öåev32ifbe
(
byãs
);

582 
	`ZIPLIST_TAIL_OFFSET
(
zl
Ë
	`öåev32ifbe
(
ZIPLIST_HEADER_SIZE
);

583 
	`ZIPLIST_LENGTH
(
zl
) = 0;

584 
zl
[
byãs
-1] = 
ZIP_END
;

585  
zl
;

586 
	}
}

589 *
	$zùli°Resize
(*
zl
, 
Àn
) {

590 
zl
 = 
	`zªÆloc
(zl,
Àn
);

591 
	`ZIPLIST_BYTES
(
zl
Ë
	`öåev32ifbe
(
Àn
);

592 
zl
[
Àn
-1] = 
ZIP_END
;

593  
zl
;

594 
	}
}

616 *
	$__zùli°CasˇdeUpd©e
(*
zl
, *
p
) {

617 
size_t
 
cuæí
 = 
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(
zl
)), 
øwÀn
, 
øwÀnsize
;

618 
size_t
 
off£t
, 
noff£t
, 
exåa
;

619 *
≈
;

620 
zÀ¡ry
 
cur
, 
√xt
;

622 
p
[0] !
ZIP_END
) {

623 
	`zùE¡ry
(
p
, &
cur
);

624 
øwÀn
 = 
cur
.
hódîsize
 + cur.
Àn
;

625 
øwÀnsize
 = 
	`zùSt‹ePªvE¡ryLígth
(
NULL
,
øwÀn
);

628 i‡(
p
[
øwÀn
] =
ZIP_END
) ;

629 
	`zùE¡ry
(
p
+
øwÀn
, &
√xt
);

632 i‡(
√xt
.
¥evøwÀn
 =
øwÀn
) ;

634 i‡(
√xt
.
¥evøwÀnsize
 < 
øwÀnsize
) {

637 
off£t
 = 
p
-
zl
;

638 
exåa
 = 
øwÀnsize
-
√xt
.
¥evøwÀnsize
;

639 
zl
 = 
	`zùli°Resize
(zl,
cuæí
+
exåa
);

640 
p
 = 
zl
+
off£t
;

643 
≈
 = 
p
+
øwÀn
;

644 
noff£t
 = 
≈
-
zl
;

647 i‡((
zl
+
	`öåev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(zl))Ë!
≈
) {

648 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

649 
	`öåev32ifbe
(öåev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))+
exåa
);

653 
	`memmove
(
≈
+
øwÀnsize
,

654 
≈
+
√xt
.
¥evøwÀnsize
,

655 
cuæí
-
noff£t
-
√xt
.
¥evøwÀnsize
-1);

656 
	`zùSt‹ePªvE¡ryLígth
(
≈
,
øwÀn
);

659 
p
 +
øwÀn
;

660 
cuæí
 +
exåa
;

662 i‡(
√xt
.
¥evøwÀnsize
 > 
øwÀnsize
) {

665 
	`zùSt‹ePªvE¡ryLígthL¨ge
(
p
+
øwÀn
,rawlen);

667 
	`zùSt‹ePªvE¡ryLígth
(
p
+
øwÀn
,rawlen);

674  
zl
;

675 
	}
}

678 *
	$__zùli°Dñëe
(*
zl
, *
p
, 
num
) {

679 
i
, 
tŸÀn
, 
dñëed
 = 0;

680 
size_t
 
off£t
;

681 
√xtdiff
 = 0;

682 
zÀ¡ry
 
fú°
, 
èû
;

684 
	`zùE¡ry
(
p
, &
fú°
);

685 
i
 = 0; 
p
[0] !
ZIP_END
 && i < 
num
; i++) {

686 
p
 +
	`zùRawE¡ryLígth
(p);

687 
dñëed
++;

690 
tŸÀn
 = 
p
-
fú°
.p;

691 i‡(
tŸÀn
 > 0) {

692 i‡(
p
[0] !
ZIP_END
) {

697 
√xtdiff
 = 
	`zùPªvLíByãDiff
(
p
,
fú°
.
¥evøwÀn
);

703 
p
 -
√xtdiff
;

704 
	`zùSt‹ePªvE¡ryLígth
(
p
,
fú°
.
¥evøwÀn
);

707 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

708 
	`öåev32ifbe
(öåev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))-
tŸÀn
);

713 
	`zùE¡ry
(
p
, &
èû
);

714 i‡(
p
[
èû
.
hódîsize
+èû.
Àn
] !
ZIP_END
) {

715 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

716 
	`öåev32ifbe
(öåev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))+
√xtdiff
);

720 
	`memmove
(
fú°
.
p
,p,

721 
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(
zl
))-(
p
-zl)-1);

724 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

725 
	`öåev32ifbe
((
fú°
.
p
-
zl
)-fú°.
¥evøwÀn
);

729 
off£t
 = 
fú°
.
p
-
zl
;

730 
zl
 = 
	`zùli°Resize
(zl, 
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(zl))-
tŸÀn
+
√xtdiff
);

731 
	`ZIPLIST_INCR_LENGTH
(
zl
,-
dñëed
);

732 
p
 = 
zl
+
off£t
;

736 i‡(
√xtdiff
 != 0)

737 
zl
 = 
	`__zùli°CasˇdeUpd©e
(zl,
p
);

739  
zl
;

740 
	}
}

743 *
	$__zùli°In£π
(*
zl
, *
p
, *
s
, 
¶í
) {

744 
size_t
 
cuæí
 = 
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(
zl
)), 
ªqÀn
;

745 
¥evÀnsize
, 
¥evÀn
 = 0;

746 
size_t
 
off£t
;

747 
√xtdiff
 = 0;

748 
ícodög
 = 0;

749 
vÆue
 = 123456789;

752 
zÀ¡ry
 
èû
;

755 i‡(
p
[0] !
ZIP_END
) {

756 
	`ZIP_DECODE_PREVLEN
(
p
, 
¥evÀnsize
, 
¥evÀn
);

758 *
±aû
 = 
	`ZIPLIST_ENTRY_TAIL
(
zl
);

759 i‡(
±aû
[0] !
ZIP_END
) {

760 
¥evÀn
 = 
	`zùRawE¡ryLígth
(
±aû
);

765 i‡(
	`zùTryEncodög
(
s
,
¶í
,&
vÆue
,&
ícodög
)) {

767 
ªqÀn
 = 
	`zùI¡Size
(
ícodög
);

771 
ªqÀn
 = 
¶í
;

775 
ªqÀn
 +
	`zùSt‹ePªvE¡ryLígth
(
NULL
,
¥evÀn
);

776 
ªqÀn
 +
	`zùSt‹eE¡ryEncodög
(
NULL
,
ícodög
,
¶í
);

781 
f‹˚œrge
 = 0;

782 
√xtdiff
 = (
p
[0] !
ZIP_END
Ë? 
	`zùPªvLíByãDiff
’,
ªqÀn
) : 0;

783 i‡(
√xtdiff
 =-4 && 
ªqÀn
 < 4) {

784 
√xtdiff
 = 0;

785 
f‹˚œrge
 = 1;

789 
off£t
 = 
p
-
zl
;

790 
zl
 = 
	`zùli°Resize
(zl,
cuæí
+
ªqÀn
+
√xtdiff
);

791 
p
 = 
zl
+
off£t
;

794 i‡(
p
[0] !
ZIP_END
) {

796 
	`memmove
(
p
+
ªqÀn
,p-
√xtdiff
,
cuæí
-
off£t
-1+nextdiff);

799 i‡(
f‹˚œrge
)

800 
	`zùSt‹ePªvE¡ryLígthL¨ge
(
p
+
ªqÀn
,reqlen);

802 
	`zùSt‹ePªvE¡ryLígth
(
p
+
ªqÀn
,reqlen);

805 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

806 
	`öåev32ifbe
(öåev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))+
ªqÀn
);

811 
	`zùE¡ry
(
p
+
ªqÀn
, &
èû
);

812 i‡(
p
[
ªqÀn
+
èû
.
hódîsize
+èû.
Àn
] !
ZIP_END
) {

813 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

814 
	`öåev32ifbe
(öåev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))+
√xtdiff
);

818 
	`ZIPLIST_TAIL_OFFSET
(
zl
Ë
	`öåev32ifbe
(
p
-zl);

823 i‡(
√xtdiff
 != 0) {

824 
off£t
 = 
p
-
zl
;

825 
zl
 = 
	`__zùli°CasˇdeUpd©e
(zl,
p
+
ªqÀn
);

826 
p
 = 
zl
+
off£t
;

830 
p
 +
	`zùSt‹ePªvE¡ryLígth
’,
¥evÀn
);

831 
p
 +
	`zùSt‹eE¡ryEncodög
’,
ícodög
,
¶í
);

832 i‡(
	`ZIP_IS_STR
(
ícodög
)) {

833 
	`mem˝y
(
p
,
s
,
¶í
);

835 
	`zùSaveI¡egî
(
p
,
vÆue
,
ícodög
);

837 
	`ZIPLIST_INCR_LENGTH
(
zl
,1);

838  
zl
;

839 
	}
}

856 *
	$zùli°Mîge
(**
fú°
, **
£c⁄d
) {

858 i‡(
fú°
 =
NULL
 || *fú° =NULL || 
£c⁄d
 == NULL || *second == NULL)

859  
NULL
;

862 i‡(*
fú°
 =*
£c⁄d
)

863  
NULL
;

865 
size_t
 
fú°_byãs
 = 
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(*
fú°
));

866 
size_t
 
fú°_Àn
 = 
	`öåev16ifbe
(
	`ZIPLIST_LENGTH
(*
fú°
));

868 
size_t
 
£c⁄d_byãs
 = 
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(*
£c⁄d
));

869 
size_t
 
£c⁄d_Àn
 = 
	`öåev16ifbe
(
	`ZIPLIST_LENGTH
(*
£c⁄d
));

871 
≠≥nd
;

872 *
sour˚
, *
èrgë
;

873 
size_t
 
èrgë_byãs
, 
sour˚_byãs
;

877 i‡(
fú°_Àn
 >
£c⁄d_Àn
) {

879 
èrgë
 = *
fú°
;

880 
èrgë_byãs
 = 
fú°_byãs
;

881 
sour˚
 = *
£c⁄d
;

882 
sour˚_byãs
 = 
£c⁄d_byãs
;

883 
≠≥nd
 = 1;

886 
èrgë
 = *
£c⁄d
;

887 
èrgë_byãs
 = 
£c⁄d_byãs
;

888 
sour˚
 = *
fú°
;

889 
sour˚_byãs
 = 
fú°_byãs
;

890 
≠≥nd
 = 0;

894 
size_t
 
zlbyãs
 = 
fú°_byãs
 + 
£c⁄d_byãs
 -

895 
ZIPLIST_HEADER_SIZE
 - 
ZIPLIST_END_SIZE
;

896 
size_t
 
zŒígth
 = 
fú°_Àn
 + 
£c⁄d_Àn
;

899 
zŒígth
 = zŒígth < 
UINT16_MAX
 ? zllength : UINT16_MAX;

902 
size_t
 
fú°_off£t
 = 
	`öåev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(*
fú°
));

903 
size_t
 
£c⁄d_off£t
 = 
	`öåev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(*
£c⁄d
));

906 
èrgë
 = 
	`zªÆloc
—¨gë, 
zlbyãs
);

907 i‡(
≠≥nd
) {

911 
	`mem˝y
(
èrgë
 + 
èrgë_byãs
 - 
ZIPLIST_END_SIZE
,

912 
sour˚
 + 
ZIPLIST_HEADER_SIZE
,

913 
sour˚_byãs
 - 
ZIPLIST_HEADER_SIZE
);

919 
	`memmove
(
èrgë
 + 
sour˚_byãs
 - 
ZIPLIST_END_SIZE
,

920 
èrgë
 + 
ZIPLIST_HEADER_SIZE
,

921 
èrgë_byãs
 - 
ZIPLIST_HEADER_SIZE
);

922 
	`mem˝y
(
èrgë
, 
sour˚
, 
sour˚_byãs
 - 
ZIPLIST_END_SIZE
);

926 
	`ZIPLIST_BYTES
(
èrgë
Ë
	`öåev32ifbe
(
zlbyãs
);

927 
	`ZIPLIST_LENGTH
(
èrgë
Ë
	`öåev16ifbe
(
zŒígth
);

933 
	`ZIPLIST_TAIL_OFFSET
(
èrgë
Ë
	`öåev32ifbe
(

934 (
fú°_byãs
 - 
ZIPLIST_END_SIZE
) +

935 (
£c⁄d_off£t
 - 
ZIPLIST_HEADER_SIZE
));

941 
èrgë
 = 
	`__zùli°CasˇdeUpd©e
—¨gë,Å¨gë+
fú°_off£t
);

944 i‡(
≠≥nd
) {

945 
	`z‰ì
(*
£c⁄d
);

946 *
£c⁄d
 = 
NULL
;

947 *
fú°
 = 
èrgë
;

949 
	`z‰ì
(*
fú°
);

950 *
fú°
 = 
NULL
;

951 *
£c⁄d
 = 
èrgë
;

953  
èrgë
;

954 
	}
}

956 *
	$zùli°Push
(*
zl
, *
s
, 
¶í
, 
whîe
) {

957 *
p
;

958 
p
 = (
whîe
 =
ZIPLIST_HEAD
Ë? 
	`ZIPLIST_ENTRY_HEAD
(
zl
Ë: 
	`ZIPLIST_ENTRY_END
(zl);

959  
	`__zùli°In£π
(
zl
,
p
,
s
,
¶í
);

960 
	}
}

965 *
	$zùli°Index
(*
zl
, 
ödex
) {

966 *
p
;

967 
¥evÀnsize
, 
¥evÀn
 = 0;

968 i‡(
ödex
 < 0) {

969 
ödex
 = (-index)-1;

970 
p
 = 
	`ZIPLIST_ENTRY_TAIL
(
zl
);

971 i‡(
p
[0] !
ZIP_END
) {

972 
	`ZIP_DECODE_PREVLEN
(
p
, 
¥evÀnsize
, 
¥evÀn
);

973 
¥evÀn
 > 0 && 
ödex
--) {

974 
p
 -
¥evÀn
;

975 
	`ZIP_DECODE_PREVLEN
(
p
, 
¥evÀnsize
, 
¥evÀn
);

979 
p
 = 
	`ZIPLIST_ENTRY_HEAD
(
zl
);

980 
p
[0] !
ZIP_END
 && 
ödex
--) {

981 
p
 +
	`zùRawE¡ryLígth
(p);

984  (
p
[0] =
ZIP_END
 || 
ödex
 > 0Ë? 
NULL
 :Ö;

985 
	}
}

993 *
	$zùli°Next
(*
zl
, *
p
) {

994 ((Ë
zl
);

999 i‡(
p
[0] =
ZIP_END
) {

1000  
NULL
;

1003 
p
 +
	`zùRawE¡ryLígth
(p);

1004 i‡(
p
[0] =
ZIP_END
) {

1005  
NULL
;

1008  
p
;

1009 
	}
}

1012 *
	$zùli°Pªv
(*
zl
, *
p
) {

1013 
¥evÀnsize
, 
¥evÀn
 = 0;

1018 i‡(
p
[0] =
ZIP_END
) {

1019 
p
 = 
	`ZIPLIST_ENTRY_TAIL
(
zl
);

1020  (
p
[0] =
ZIP_END
Ë? 
NULL
 :Ö;

1021 } i‡(
p
 =
	`ZIPLIST_ENTRY_HEAD
(
zl
)) {

1022  
NULL
;

1024 
	`ZIP_DECODE_PREVLEN
(
p
, 
¥evÀnsize
, 
¥evÀn
);

1025 
	`as£π
(
¥evÀn
 > 0);

1026  
p
-
¥evÀn
;

1028 
	}
}

1034 
	$zùli°Gë
(*
p
, **
s°r
, *
¶í
, *
svÆ
) {

1035 
zÀ¡ry
 
íåy
;

1036 i‡(
p
 =
NULL
 ||Ö[0] =
ZIP_END
)  0;

1037 i‡(
s°r
Ë*s°∏
NULL
;

1039 
	`zùE¡ry
(
p
, &
íåy
);

1040 i‡(
	`ZIP_IS_STR
(
íåy
.
ícodög
)) {

1041 i‡(
s°r
) {

1042 *
¶í
 = 
íåy
.
Àn
;

1043 *
s°r
 = 
p
+
íåy
.
hódîsize
;

1046 i‡(
svÆ
) {

1047 *
svÆ
 = 
	`zùLﬂdI¡egî
(
p
+
íåy
.
hódîsize
,íåy.
ícodög
);

1051 
	}
}

1054 *
	$zùli°In£π
(*
zl
, *
p
, *
s
, 
¶í
) {

1055  
	`__zùli°In£π
(
zl
,
p
,
s
,
¶í
);

1056 
	}
}

1061 *
	$zùli°Dñëe
(*
zl
, **
p
) {

1062 
size_t
 
off£t
 = *
p
-
zl
;

1063 
zl
 = 
	`__zùli°Dñëe
(zl,*
p
,1);

1069 *
p
 = 
zl
+
off£t
;

1070  
zl
;

1071 
	}
}

1074 *
	$zùli°DñëeR™ge
(*
zl
, 
ödex
, 
num
) {

1075 *
p
 = 
	`zùli°Index
(
zl
,
ödex
);

1076  (
p
 =
NULL
Ë? 
zl
 : 
	`__zùli°Dñëe
(zl,p,
num
);

1077 
	}
}

1081 
	$zùli°Com∑ª
(*
p
, *
s°r
, 
¶í
) {

1082 
zÀ¡ry
 
íåy
;

1083 
£ncodög
;

1084 
zvÆ
, 
svÆ
;

1085 i‡(
p
[0] =
ZIP_END
)  0;

1087 
	`zùE¡ry
(
p
, &
íåy
);

1088 i‡(
	`ZIP_IS_STR
(
íåy
.
ícodög
)) {

1090 i‡(
íåy
.
Àn
 =
¶í
) {

1091  
	`memcmp
(
p
+
íåy
.
hódîsize
,
s°r
,
¶í
) == 0;

1098 i‡(
	`zùTryEncodög
(
s°r
,
¶í
,&
svÆ
,&
£ncodög
)) {

1099 
zvÆ
 = 
	`zùLﬂdI¡egî
(
p
+
íåy
.
hódîsize
,íåy.
ícodög
);

1100  
zvÆ
 =
svÆ
;

1104 
	}
}

1108 *
	$zùli°Föd
(*
p
, *
v°r
, 
vÀn
, 
skù
) {

1109 
skù˙t
 = 0;

1110 
vícodög
 = 0;

1111 
vŒ
 = 0;

1113 
p
[0] !
ZIP_END
) {

1114 
¥evÀnsize
, 
ícodög
, 
Ànsize
, 
Àn
;

1115 *
q
;

1117 
	`ZIP_DECODE_PREVLENSIZE
(
p
, 
¥evÀnsize
);

1118 
	`ZIP_DECODE_LENGTH
(
p
 + 
¥evÀnsize
, 
ícodög
, 
Ànsize
, 
Àn
);

1119 
q
 = 
p
 + 
¥evÀnsize
 + 
Ànsize
;

1121 i‡(
skù˙t
 == 0) {

1123 i‡(
	`ZIP_IS_STR
(
ícodög
)) {

1124 i‡(
Àn
 =
vÀn
 && 
	`memcmp
(
q
, 
v°r
, vlen) == 0) {

1125  
p
;

1131 i‡(
vícodög
 == 0) {

1132 i‡(!
	`zùTryEncodög
(
v°r
, 
vÀn
, &
vŒ
, &
vícodög
)) {

1136 
vícodög
 = 
UCHAR_MAX
;

1139 
	`as£π
(
vícodög
);

1145 i‡(
vícodög
 !
UCHAR_MAX
) {

1146 
Œ
 = 
	`zùLﬂdI¡egî
(
q
, 
ícodög
);

1147 i‡(
Œ
 =
vŒ
) {

1148  
p
;

1154 
skù˙t
 = 
skù
;

1157 
skù˙t
--;

1161 
p
 = 
q
 + 
Àn
;

1164  
NULL
;

1165 
	}
}

1168 
	$zùli°Lí
(*
zl
) {

1169 
Àn
 = 0;

1170 i‡(
	`öåev16ifbe
(
	`ZIPLIST_LENGTH
(
zl
)Ë< 
UINT16_MAX
) {

1171 
Àn
 = 
	`öåev16ifbe
(
	`ZIPLIST_LENGTH
(
zl
));

1173 *
p
 = 
zl
+
ZIPLIST_HEADER_SIZE
;

1174 *
p
 !
ZIP_END
) {

1175 
p
 +
	`zùRawE¡ryLígth
(p);

1176 
Àn
++;

1180 i‡(
Àn
 < 
UINT16_MAX
Ë
	`ZIPLIST_LENGTH
(
zl
Ë
	`öåev16ifbe
(len);

1182  
Àn
;

1183 
	}
}

1186 
size_t
 
	$zùli°BlobLí
(*
zl
) {

1187  
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(
zl
));

1188 
	}
}

1190 
	$zùli°Rïr
(*
zl
) {

1191 *
p
;

1192 
ödex
 = 0;

1193 
zÀ¡ry
 
íåy
;

1195 
	`¥ötf
(

1199 
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(
zl
)),

1200 
	`öåev16ifbe
(
	`ZIPLIST_LENGTH
(
zl
)),

1201 
	`öåev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(
zl
)));

1202 
p
 = 
	`ZIPLIST_ENTRY_HEAD
(
zl
);

1203 *
p
 !
ZIP_END
) {

1204 
	`zùE¡ry
(
p
, &
íåy
);

1205 
	`¥ötf
(

1215 ()
p
,

1216 
ödex
,

1217 (Ë(
p
-
zl
),

1218 
íåy
.
hódîsize
+íåy.
Àn
,

1219 
íåy
.
hódîsize
,

1220 
íåy
.
¥evøwÀn
,

1221 
íåy
.
¥evøwÀnsize
,

1222 
íåy
.
Àn
);

1223 
	`¥ötf
("\tbytes: ");

1224 
i
 = 0; i < 
íåy
.
hódîsize
+íåy.
Àn
; i++) {

1225 
	`¥ötf
("%02x|",
p
[
i
]);

1227 
	`¥ötf
("\n");

1228 
p
 +
íåy
.
hódîsize
;

1229 i‡(
	`ZIP_IS_STR
(
íåy
.
ícodög
)) {

1230 
	`¥ötf
("\t[str]");

1231 i‡(
íåy
.
Àn
 > 40) {

1232 i‡(
	`fwrôe
(
p
,40,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1233 
	`¥ötf
("...");

1235 i‡(
íåy
.
Àn
 &&

1236 
	`fwrôe
(
p
,
íåy
.
Àn
,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1239 
	`¥ötf
("\t[öt]%Œd", (Ë
	`zùLﬂdI¡egî
(
p
,
íåy
.
ícodög
));

1241 
	`¥ötf
("\n}\n");

1242 
p
 +
íåy
.
Àn
;

1243 
ödex
++;

1245 
	`¥ötf
("{end}\n\n");

1246 
	}
}

1248 #ifde‡
REDIS_TEST


1249 
	~<sys/time.h
>

1250 
	~"adli°.h
"

1251 
	~"sds.h
"

1253 
	#debug
(
f
, ...Ë{ i‡(
DEBUG
Ë
	`¥ötf
(f, 
__VA_ARGS__
); }

	)

1255 *
	$¸óãLi°
() {

1256 *
zl
 = 
	`zùli°New
();

1257 
zl
 = 
	`zùli°Push
(zl, (*)"foo", 3, 
ZIPLIST_TAIL
);

1258 
zl
 = 
	`zùli°Push
(zl, (*)"quux", 4, 
ZIPLIST_TAIL
);

1259 
zl
 = 
	`zùli°Push
(zl, (*)"hñlo", 5, 
ZIPLIST_HEAD
);

1260 
zl
 = 
	`zùli°Push
(zl, (*)"1024", 4, 
ZIPLIST_TAIL
);

1261  
zl
;

1262 
	}
}

1264 *
	$¸óãI¡Li°
() {

1265 *
zl
 = 
	`zùli°New
();

1266 
buf
[32];

1268 
	`•rötf
(
buf
, "100");

1269 
zl
 = 
	`zùli°Push
(zl, (*)
buf
, 
	`°æí
(buf), 
ZIPLIST_TAIL
);

1270 
	`•rötf
(
buf
, "128000");

1271 
zl
 = 
	`zùli°Push
(zl, (*)
buf
, 
	`°æí
(buf), 
ZIPLIST_TAIL
);

1272 
	`•rötf
(
buf
, "-100");

1273 
zl
 = 
	`zùli°Push
(zl, (*)
buf
, 
	`°æí
(buf), 
ZIPLIST_HEAD
);

1274 
	`•rötf
(
buf
, "4294967296");

1275 
zl
 = 
	`zùli°Push
(zl, (*)
buf
, 
	`°æí
(buf), 
ZIPLIST_HEAD
);

1276 
	`•rötf
(
buf
, "non integer");

1277 
zl
 = 
	`zùli°Push
(zl, (*)
buf
, 
	`°æí
(buf), 
ZIPLIST_TAIL
);

1278 
	`•rötf
(
buf
, "much muchÜongerÇon integer");

1279 
zl
 = 
	`zùli°Push
(zl, (*)
buf
, 
	`°æí
(buf), 
ZIPLIST_TAIL
);

1280  
zl
;

1281 
	}
}

1283 
	$u£c
() {

1284 
timevÆ
 
tv
;

1285 
	`gëtimeofday
(&
tv
,
NULL
);

1286  ((()
tv
.
tv_£c
)*1000000)+tv.
tv_u£c
;

1287 
	}
}

1289 
	$°ªss
(
pos
, 
num
, 
maxsize
, 
dnum
) {

1290 
i
,
j
,
k
;

1291 *
zl
;

1292 
pos°r
[2][5] = { "HEAD", "TAIL" };

1293 
°¨t
;

1294 
i
 = 0; i < 
maxsize
; i+=
dnum
) {

1295 
zl
 = 
	`zùli°New
();

1296 
j
 = 0; j < 
i
; j++) {

1297 
zl
 = 
	`zùli°Push
(zl,(*)"quux",4,
ZIPLIST_TAIL
);

1301 
°¨t
 = 
	`u£c
();

1302 
k
 = 0; k < 
num
; k++) {

1303 
zl
 = 
	`zùli°Push
(zl,(*)"quux",4,
pos
);

1304 
zl
 = 
	`zùli°DñëeR™ge
(zl,0,1);

1306 
	`¥ötf
("List size: %8d, bytes: %8d, %dxÖush+pop (%s): %6lld usec\n",

1307 
i
,
	`öåev32ifbe
(
	`ZIPLIST_BYTES
(
zl
)),
num
,
pos°r
[
pos
],
	`u£c
()-
°¨t
);

1308 
	`z‰ì
(
zl
);

1310 
	}
}

1312 *
	$p›
(*
zl
, 
whîe
) {

1313 *
p
, *
v°r
;

1314 
vÀn
;

1315 
vl⁄g
;

1317 
p
 = 
	`zùli°Index
(
zl
,
whîe
 =
ZIPLIST_HEAD
 ? 0 : -1);

1318 i‡(
	`zùli°Gë
(
p
,&
v°r
,&
vÀn
,&
vl⁄g
)) {

1319 i‡(
whîe
 =
ZIPLIST_HEAD
)

1320 
	`¥ötf
("Pop head: ");

1322 
	`¥ötf
("PopÅail: ");

1324 i‡(
v°r
) {

1325 i‡(
vÀn
 && 
	`fwrôe
(
v°r
,vÀn,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1328 
	`¥ötf
("%Œd", 
vl⁄g
);

1331 
	`¥ötf
("\n");

1332  
	`zùli°Dñëe
(
zl
,&
p
);

1334 
	`¥ötf
("ERROR: CouldÇotÖop\n");

1335 
	`exô
(1);

1337 
	}
}

1339 
	$ønd°rög
(*
èrgë
, 
mö
, 
max
) {

1340 
p
 = 0;

1341 
Àn
 = 
mö
+
	`ønd
()%(
max
-min+1);

1342 
mövÆ
, 
maxvÆ
;

1343 
	`ønd
() % 3) {

1345 
mövÆ
 = 0;

1346 
maxvÆ
 = 255;

1349 
mövÆ
 = 48;

1350 
maxvÆ
 = 122;

1353 
mövÆ
 = 48;

1354 
maxvÆ
 = 52;

1357 
	`as£π
(
NULL
);

1360 
p
 < 
Àn
)

1361 
èrgë
[
p
++] = 
mövÆ
+
	`ønd
()%(
maxvÆ
-minval+1);

1362  
Àn
;

1363 
	}
}

1365 
	$vîify
(*
zl
, 
zÀ¡ry
 *
e
) {

1366 
Àn
 = 
	`zùli°Lí
(
zl
);

1367 
zÀ¡ry
 
_e
;

1369 
	`ZIPLIST_ENTRY_ZERO
(&
_e
);

1371 
i
 = 0; i < 
Àn
; i++) {

1372 
	`mem£t
(&
e
[
i
], 0, (
zÀ¡ry
));

1373 
	`zùE¡ry
(
	`zùli°Index
(
zl
, 
i
), &
e
[i]);

1375 
	`mem£t
(&
_e
, 0, (
zÀ¡ry
));

1376 
	`zùE¡ry
(
	`zùli°Index
(
zl
, -
Àn
+
i
), &
_e
);

1378 
	`as£π
(
	`memcmp
(&
e
[
i
], &
_e
, (
zÀ¡ry
)) == 0);

1380 
	}
}

1382 
	$zùli°Te°
(
¨gc
, **
¨gv
) {

1383 *
zl
, *
p
;

1384 *
íåy
;

1385 
ñí
;

1386 
vÆue
;

1389 i‡(
¨gc
 == 2)

1390 
	`§™d
(
	`©oi
(
¨gv
[1]));

1392 
zl
 = 
	`¸óãI¡Li°
();

1393 
	`zùli°Rïr
(
zl
);

1395 
	`z‰ì
(
zl
);

1397 
zl
 = 
	`¸óãLi°
();

1398 
	`zùli°Rïr
(
zl
);

1400 
zl
 = 
	`p›
(zl,
ZIPLIST_TAIL
);

1401 
	`zùli°Rïr
(
zl
);

1403 
zl
 = 
	`p›
(zl,
ZIPLIST_HEAD
);

1404 
	`zùli°Rïr
(
zl
);

1406 
zl
 = 
	`p›
(zl,
ZIPLIST_TAIL
);

1407 
	`zùli°Rïr
(
zl
);

1409 
zl
 = 
	`p›
(zl,
ZIPLIST_TAIL
);

1410 
	`zùli°Rïr
(
zl
);

1412 
	`z‰ì
(
zl
);

1414 
	`¥ötf
("GetÉlementát index 3:\n");

1416 
zl
 = 
	`¸óãLi°
();

1417 
p
 = 
	`zùli°Index
(
zl
, 3);

1418 i‡(!
	`zùli°Gë
(
p
, &
íåy
, &
ñí
, &
vÆue
)) {

1419 
	`¥ötf
("ERROR: CouldÇotáccess index 3\n");

1422 i‡(
íåy
) {

1423 i‡(
ñí
 && 
	`fwrôe
(
íåy
,ñí,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1424 
	`¥ötf
("\n");

1426 
	`¥ötf
("%Œd\n", 
vÆue
);

1428 
	`¥ötf
("\n");

1429 
	`z‰ì
(
zl
);

1432 
	`¥ötf
("GetÉlementát index 4 (out ofÑange):\n");

1434 
zl
 = 
	`¸óãLi°
();

1435 
p
 = 
	`zùli°Index
(
zl
, 4);

1436 i‡(
p
 =
NULL
) {

1437 
	`¥ötf
("NoÉntry\n");

1439 
	`¥ötf
("ERROR: Ouào‡øngêödex shouldÑëu∫ NULL,Ñëu∫ed off£t: %ld\n", 
p
-
zl
);

1442 
	`¥ötf
("\n");

1443 
	`z‰ì
(
zl
);

1446 
	`¥ötf
("GetÉlementát index -1 (lastÉlement):\n");

1448 
zl
 = 
	`¸óãLi°
();

1449 
p
 = 
	`zùli°Index
(
zl
, -1);

1450 i‡(!
	`zùli°Gë
(
p
, &
íåy
, &
ñí
, &
vÆue
)) {

1451 
	`¥ötf
("ERROR: CouldÇotáccess index -1\n");

1454 i‡(
íåy
) {

1455 i‡(
ñí
 && 
	`fwrôe
(
íåy
,ñí,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1456 
	`¥ötf
("\n");

1458 
	`¥ötf
("%Œd\n", 
vÆue
);

1460 
	`¥ötf
("\n");

1461 
	`z‰ì
(
zl
);

1464 
	`¥ötf
("GetÉlementát index -4 (firstÉlement):\n");

1466 
zl
 = 
	`¸óãLi°
();

1467 
p
 = 
	`zùli°Index
(
zl
, -4);

1468 i‡(!
	`zùli°Gë
(
p
, &
íåy
, &
ñí
, &
vÆue
)) {

1469 
	`¥ötf
("ERROR: CouldÇotáccess index -4\n");

1472 i‡(
íåy
) {

1473 i‡(
ñí
 && 
	`fwrôe
(
íåy
,ñí,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1474 
	`¥ötf
("\n");

1476 
	`¥ötf
("%Œd\n", 
vÆue
);

1478 
	`¥ötf
("\n");

1479 
	`z‰ì
(
zl
);

1482 
	`¥ötf
("GetÉlementát index -5 (reverse out ofÑange):\n");

1484 
zl
 = 
	`¸óãLi°
();

1485 
p
 = 
	`zùli°Index
(
zl
, -5);

1486 i‡(
p
 =
NULL
) {

1487 
	`¥ötf
("NoÉntry\n");

1489 
	`¥ötf
("ERROR: Ouào‡øngêödex shouldÑëu∫ NULL,Ñëu∫ed off£t: %ld\n", 
p
-
zl
);

1492 
	`¥ötf
("\n");

1493 
	`z‰ì
(
zl
);

1496 
	`¥ötf
("IterateÜist from 0ÅoÉnd:\n");

1498 
zl
 = 
	`¸óãLi°
();

1499 
p
 = 
	`zùli°Index
(
zl
, 0);

1500 
	`zùli°Gë
(
p
, &
íåy
, &
ñí
, &
vÆue
)) {

1501 
	`¥ötf
("Entry: ");

1502 i‡(
íåy
) {

1503 i‡(
ñí
 && 
	`fwrôe
(
íåy
,ñí,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1505 
	`¥ötf
("%Œd", 
vÆue
);

1507 
p
 = 
	`zùli°Next
(
zl
,p);

1508 
	`¥ötf
("\n");

1510 
	`¥ötf
("\n");

1511 
	`z‰ì
(
zl
);

1514 
	`¥ötf
("IterateÜist from 1ÅoÉnd:\n");

1516 
zl
 = 
	`¸óãLi°
();

1517 
p
 = 
	`zùli°Index
(
zl
, 1);

1518 
	`zùli°Gë
(
p
, &
íåy
, &
ñí
, &
vÆue
)) {

1519 
	`¥ötf
("Entry: ");

1520 i‡(
íåy
) {

1521 i‡(
ñí
 && 
	`fwrôe
(
íåy
,ñí,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1523 
	`¥ötf
("%Œd", 
vÆue
);

1525 
p
 = 
	`zùli°Next
(
zl
,p);

1526 
	`¥ötf
("\n");

1528 
	`¥ötf
("\n");

1529 
	`z‰ì
(
zl
);

1532 
	`¥ötf
("IterateÜist from 2ÅoÉnd:\n");

1534 
zl
 = 
	`¸óãLi°
();

1535 
p
 = 
	`zùli°Index
(
zl
, 2);

1536 
	`zùli°Gë
(
p
, &
íåy
, &
ñí
, &
vÆue
)) {

1537 
	`¥ötf
("Entry: ");

1538 i‡(
íåy
) {

1539 i‡(
ñí
 && 
	`fwrôe
(
íåy
,ñí,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1541 
	`¥ötf
("%Œd", 
vÆue
);

1543 
p
 = 
	`zùli°Next
(
zl
,p);

1544 
	`¥ötf
("\n");

1546 
	`¥ötf
("\n");

1547 
	`z‰ì
(
zl
);

1550 
	`¥ötf
("Iterate starting out ofÑange:\n");

1552 
zl
 = 
	`¸óãLi°
();

1553 
p
 = 
	`zùli°Index
(
zl
, 4);

1554 i‡(!
	`zùli°Gë
(
p
, &
íåy
, &
ñí
, &
vÆue
)) {

1555 
	`¥ötf
("NoÉntry\n");

1557 
	`¥ötf
("ERROR\n");

1559 
	`¥ötf
("\n");

1560 
	`z‰ì
(
zl
);

1563 
	`¥ötf
("Iterate from backÅo front:\n");

1565 
zl
 = 
	`¸óãLi°
();

1566 
p
 = 
	`zùli°Index
(
zl
, -1);

1567 
	`zùli°Gë
(
p
, &
íåy
, &
ñí
, &
vÆue
)) {

1568 
	`¥ötf
("Entry: ");

1569 i‡(
íåy
) {

1570 i‡(
ñí
 && 
	`fwrôe
(
íåy
,ñí,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1572 
	`¥ötf
("%Œd", 
vÆue
);

1574 
p
 = 
	`zùli°Pªv
(
zl
,p);

1575 
	`¥ötf
("\n");

1577 
	`¥ötf
("\n");

1578 
	`z‰ì
(
zl
);

1581 
	`¥ötf
("Iterate from backÅo front, deletingáll items:\n");

1583 
zl
 = 
	`¸óãLi°
();

1584 
p
 = 
	`zùli°Index
(
zl
, -1);

1585 
	`zùli°Gë
(
p
, &
íåy
, &
ñí
, &
vÆue
)) {

1586 
	`¥ötf
("Entry: ");

1587 i‡(
íåy
) {

1588 i‡(
ñí
 && 
	`fwrôe
(
íåy
,ñí,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

1590 
	`¥ötf
("%Œd", 
vÆue
);

1592 
zl
 = 
	`zùli°Dñëe
(zl,&
p
);

1593 
p
 = 
	`zùli°Pªv
(
zl
,p);

1594 
	`¥ötf
("\n");

1596 
	`¥ötf
("\n");

1597 
	`z‰ì
(
zl
);

1600 
	`¥ötf
("Delete inclusiveÑange 0,0:\n");

1602 
zl
 = 
	`¸óãLi°
();

1603 
zl
 = 
	`zùli°DñëeR™ge
(zl, 0, 1);

1604 
	`zùli°Rïr
(
zl
);

1605 
	`z‰ì
(
zl
);

1608 
	`¥ötf
("Delete inclusiveÑange 0,1:\n");

1610 
zl
 = 
	`¸óãLi°
();

1611 
zl
 = 
	`zùli°DñëeR™ge
(zl, 0, 2);

1612 
	`zùli°Rïr
(
zl
);

1613 
	`z‰ì
(
zl
);

1616 
	`¥ötf
("Delete inclusiveÑange 1,2:\n");

1618 
zl
 = 
	`¸óãLi°
();

1619 
zl
 = 
	`zùli°DñëeR™ge
(zl, 1, 2);

1620 
	`zùli°Rïr
(
zl
);

1621 
	`z‰ì
(
zl
);

1624 
	`¥ötf
("Delete with start index out ofÑange:\n");

1626 
zl
 = 
	`¸óãLi°
();

1627 
zl
 = 
	`zùli°DñëeR™ge
(zl, 5, 1);

1628 
	`zùli°Rïr
(
zl
);

1629 
	`z‰ì
(
zl
);

1632 
	`¥ötf
("Delete withÇum overflow:\n");

1634 
zl
 = 
	`¸óãLi°
();

1635 
zl
 = 
	`zùli°DñëeR™ge
(zl, 1, 5);

1636 
	`zùli°Rïr
(
zl
);

1637 
	`z‰ì
(
zl
);

1640 
	`¥ötf
("Delete foo while iterating:\n");

1642 
zl
 = 
	`¸óãLi°
();

1643 
p
 = 
	`zùli°Index
(
zl
,0);

1644 
	`zùli°Gë
(
p
,&
íåy
,&
ñí
,&
vÆue
)) {

1645 i‡(
íåy
 && 
	`°∫cmp
("foo",(*Î¡ry,
ñí
) == 0) {

1646 
	`¥ötf
("Delete foo\n");

1647 
zl
 = 
	`zùli°Dñëe
(zl,&
p
);

1649 
	`¥ötf
("Entry: ");

1650 i‡(
íåy
) {

1651 i‡(
ñí
 && 
	`fwrôe
(
íåy
,ñí,1,
°dout
) == 0)

1652 
	`≥º‹
("fwrite");

1654 
	`¥ötf
("%Œd",
vÆue
);

1656 
p
 = 
	`zùli°Next
(
zl
,p);

1657 
	`¥ötf
("\n");

1660 
	`¥ötf
("\n");

1661 
	`zùli°Rïr
(
zl
);

1662 
	`z‰ì
(
zl
);

1665 
	`¥ötf
("RegressionÅest for >255 byte strings:\n");

1667 
v1
[257] = {0}, 
v2
[257] = {0};

1668 
	`mem£t
(
v1
,'x',256);

1669 
	`mem£t
(
v2
,'y',256);

1670 
zl
 = 
	`zùli°New
();

1671 
zl
 = 
	`zùli°Push
(zl,(*)
v1
,
	`°æí
(v1),
ZIPLIST_TAIL
);

1672 
zl
 = 
	`zùli°Push
(zl,(*)
v2
,
	`°æí
(v2),
ZIPLIST_TAIL
);

1675 
p
 = 
	`zùli°Index
(
zl
,0);

1676 
	`as£π
(
	`zùli°Gë
(
p
,&
íåy
,&
ñí
,&
vÆue
));

1677 
	`as£π
(
	`°∫cmp
(
v1
,(*)
íåy
,
ñí
) == 0);

1678 
p
 = 
	`zùli°Index
(
zl
,1);

1679 
	`as£π
(
	`zùli°Gë
(
p
,&
íåy
,&
ñí
,&
vÆue
));

1680 
	`as£π
(
	`°∫cmp
(
v2
,(*)
íåy
,
ñí
) == 0);

1681 
	`¥ötf
("SUCCESS\n\n");

1682 
	`z‰ì
(
zl
);

1685 
	`¥ötf
("RegressionÅest deletingÇextÅoÜastÉntries:\n");

1687 
v
[3][257] = {{0}};

1688 
zÀ¡ry
 
e
[3] = {{.
¥evøwÀnsize
 = 0, .
¥evøwÀn
 = 0, .
Ànsize
 = 0,

1689 .
Àn
 = 0, .
hódîsize
 = 0, .
ícodög
 = 0, .
p
 = 
NULL
}};

1690 
size_t
 
i
;

1692 
i
 = 0; i < ((
v
)/(v[0])); i++) {

1693 
	`mem£t
(
v
[
i
], 'a' + i, (v[0]));

1696 
v
[0][256] = '\0';

1697 
v
[1][ 1] = '\0';

1698 
v
[2][256] = '\0';

1700 
zl
 = 
	`zùli°New
();

1701 
i
 = 0; i < ((
v
)/(v[0])); i++) {

1702 
zl
 = 
	`zùli°Push
(zl, (*Ë
v
[
i
], 
	`°æí
(v[i]), 
ZIPLIST_TAIL
);

1705 
	`vîify
(
zl
, 
e
);

1707 
	`as£π
(
e
[0].
¥evøwÀnsize
 == 1);

1708 
	`as£π
(
e
[1].
¥evøwÀnsize
 == 5);

1709 
	`as£π
(
e
[2].
¥evøwÀnsize
 == 1);

1712 *
p
 = 
e
[1].p;

1713 
zl
 = 
	`zùli°Dñëe
(zl, &
p
);

1715 
	`vîify
(
zl
, 
e
);

1717 
	`as£π
(
e
[0].
¥evøwÀnsize
 == 1);

1718 
	`as£π
(
e
[1].
¥evøwÀnsize
 == 5);

1720 
	`¥ötf
("SUCCESS\n\n");

1721 
	`z‰ì
(
zl
);

1724 
	`¥ötf
("CreateÜongÜistánd check indices:\n");

1726 
zl
 = 
	`zùli°New
();

1727 
buf
[32];

1728 
i
,
Àn
;

1729 
i
 = 0; i < 1000; i++) {

1730 
Àn
 = 
	`•rötf
(
buf
,"%d",
i
);

1731 
zl
 = 
	`zùli°Push
(zl,(*)
buf
,
Àn
,
ZIPLIST_TAIL
);

1733 
i
 = 0; i < 1000; i++) {

1734 
p
 = 
	`zùli°Index
(
zl
,
i
);

1735 
	`as£π
(
	`zùli°Gë
(
p
,
NULL
,NULL,&
vÆue
));

1736 
	`as£π
(
i
 =
vÆue
);

1738 
p
 = 
	`zùli°Index
(
zl
,-
i
-1);

1739 
	`as£π
(
	`zùli°Gë
(
p
,
NULL
,NULL,&
vÆue
));

1740 
	`as£π
(999-
i
 =
vÆue
);

1742 
	`¥ötf
("SUCCESS\n\n");

1743 
	`z‰ì
(
zl
);

1746 
	`¥ötf
("Compare strings with ziplistÉntries:\n");

1748 
zl
 = 
	`¸óãLi°
();

1749 
p
 = 
	`zùli°Index
(
zl
,0);

1750 i‡(!
	`zùli°Com∑ª
(
p
,(*)"hello",5)) {

1751 
	`¥ötf
("ERROR:Çot \"hello\"\n");

1754 i‡(
	`zùli°Com∑ª
(
p
,(*)"hella",5)) {

1755 
	`¥ötf
("ERROR: \"hella\"\n");

1759 
p
 = 
	`zùli°Index
(
zl
,3);

1760 i‡(!
	`zùli°Com∑ª
(
p
,(*)"1024",4)) {

1761 
	`¥ötf
("ERROR:Çot \"1024\"\n");

1764 i‡(
	`zùli°Com∑ª
(
p
,(*)"1025",4)) {

1765 
	`¥ötf
("ERROR: \"1025\"\n");

1768 
	`¥ötf
("SUCCESS\n\n");

1769 
	`z‰ì
(
zl
);

1772 
	`¥ötf
("MergeÅest:\n");

1775 
zl
 = 
	`¸óãLi°
();

1776 *
zl2
 = 
	`¸óãLi°
();

1778 *
zl3
 = 
	`zùli°New
();

1779 *
zl4
 = 
	`zùli°New
();

1781 i‡(
	`zùli°Mîge
(&
zl4
, &zl4)) {

1782 
	`¥ötf
("ERROR: Allowed merging of one ziplist into itself.\n");

1787 
zl4
 = 
	`zùli°Mîge
(&
zl3
, &zl4);

1788 
	`zùli°Rïr
(
zl4
);

1789 i‡(
	`zùli°Lí
(
zl4
)) {

1790 
	`¥ötf
("ERROR: MergingÅwoÉmpty ziplists createdÉntries.\n");

1793 
	`z‰ì
(
zl4
);

1795 
zl2
 = 
	`zùli°Mîge
(&
zl
, &zl2);

1797 
	`zùli°Rïr
(
zl2
);

1799 i‡(
	`zùli°Lí
(
zl2
) != 8) {

1800 
	`¥ötf
("ERROR: MîgedÜígthÇŸ 8, but: %u\n", 
	`zùli°Lí
(
zl2
));

1804 
p
 = 
	`zùli°Index
(
zl2
,0);

1805 i‡(!
	`zùli°Com∑ª
(
p
,(*)"hello",5)) {

1806 
	`¥ötf
("ERROR:Çot \"hello\"\n");

1809 i‡(
	`zùli°Com∑ª
(
p
,(*)"hella",5)) {

1810 
	`¥ötf
("ERROR: \"hella\"\n");

1814 
p
 = 
	`zùli°Index
(
zl2
,3);

1815 i‡(!
	`zùli°Com∑ª
(
p
,(*)"1024",4)) {

1816 
	`¥ötf
("ERROR:Çot \"1024\"\n");

1819 i‡(
	`zùli°Com∑ª
(
p
,(*)"1025",4)) {

1820 
	`¥ötf
("ERROR: \"1025\"\n");

1824 
p
 = 
	`zùli°Index
(
zl2
,4);

1825 i‡(!
	`zùli°Com∑ª
(
p
,(*)"hello",5)) {

1826 
	`¥ötf
("ERROR:Çot \"hello\"\n");

1829 i‡(
	`zùli°Com∑ª
(
p
,(*)"hella",5)) {

1830 
	`¥ötf
("ERROR: \"hella\"\n");

1834 
p
 = 
	`zùli°Index
(
zl2
,7);

1835 i‡(!
	`zùli°Com∑ª
(
p
,(*)"1024",4)) {

1836 
	`¥ötf
("ERROR:Çot \"1024\"\n");

1839 i‡(
	`zùli°Com∑ª
(
p
,(*)"1025",4)) {

1840 
	`¥ötf
("ERROR: \"1025\"\n");

1843 
	`¥ötf
("SUCCESS\n\n");

1844 
	`z‰ì
(
zl
);

1847 
	`¥ötf
("Stress withÑandomÖayloads of differentÉncoding:\n");

1849 
i
,
j
,
Àn
,
whîe
;

1850 *
p
;

1851 
buf
[1024];

1852 
buÊí
;

1853 
li°
 *
ªf
;

1854 
li°Node
 *
ª‚ode
;

1857 *
s°r
;

1858 
¶í
;

1859 
svÆ
;

1861 
i
 = 0; i < 20000; i++) {

1862 
zl
 = 
	`zùli°New
();

1863 
ªf
 = 
	`li°Cª©e
();

1864 
	`li°SëFªeMëhod
(
ªf
,((*)(*))
sds‰ì
);

1865 
Àn
 = 
	`ønd
() % 256;

1868 
j
 = 0; j < 
Àn
; j++) {

1869 
whîe
 = (
	`ønd
(Ë& 1Ë? 
ZIPLIST_HEAD
 : 
ZIPLIST_TAIL
;

1870 i‡(
	`ønd
() % 2) {

1871 
buÊí
 = 
	`ønd°rög
(
buf
,1,(buf)-1);

1873 
	`ønd
() % 3) {

1875 
buÊí
 = 
	`•rötf
(
buf
,"%Œd",(0LL + 
	`ønd
()) >> 20);

1878 
buÊí
 = 
	`•rötf
(
buf
,"%Œd",(0LL + 
	`ønd
()));

1881 
buÊí
 = 
	`•rötf
(
buf
,"%Œd",(0LL + 
	`ønd
()) << 20);

1884 
	`as£π
(
NULL
);

1889 
zl
 = 
	`zùli°Push
(zl, (*)
buf
, 
buÊí
, 
whîe
);

1892 i‡(
whîe
 =
ZIPLIST_HEAD
) {

1893 
	`li°AddNodeHód
(
ªf
,
	`sd¢ewÀn
(
buf
, 
buÊí
));

1894 } i‡(
whîe
 =
ZIPLIST_TAIL
) {

1895 
	`li°AddNodeTaû
(
ªf
,
	`sd¢ewÀn
(
buf
, 
buÊí
));

1897 
	`as£π
(
NULL
);

1901 
	`as£π
(
	`li°Lígth
(
ªf
Ë=
	`zùli°Lí
(
zl
));

1902 
j
 = 0; j < 
Àn
; j++) {

1905 
p
 = 
	`zùli°Index
(
zl
,
j
);

1906 
ª‚ode
 = 
	`li°Index
(
ªf
,
j
);

1908 
	`as£π
(
	`zùli°Gë
(
p
,&
s°r
,&
¶í
,&
svÆ
));

1909 i‡(
s°r
 =
NULL
) {

1910 
buÊí
 = 
	`•rötf
(
buf
,"%Œd",
svÆ
);

1912 
buÊí
 = 
¶í
;

1913 
	`mem˝y
(
buf
,
s°r
,
buÊí
);

1914 
buf
[
buÊí
] = '\0';

1916 
	`as£π
(
	`memcmp
(
buf
,
	`li°NodeVÆue
(
ª‚ode
),
buÊí
) == 0);

1918 
	`z‰ì
(
zl
);

1919 
	`li°Rñó£
(
ªf
);

1921 
	`¥ötf
("SUCCESS\n\n");

1924 
	`¥ötf
("Stress with variable ziplist size:\n");

1926 
	`°ªss
(
ZIPLIST_HEAD
,100000,16384,256);

1927 
	`°ªss
(
ZIPLIST_TAIL
,100000,16384,256);

1931 
	}
}

	@ziplist.h

31 #i‚de‡
_ZIPLIST_H


32 
	#_ZIPLIST_H


	)

34 
	#ZIPLIST_HEAD
 0

	)

35 
	#ZIPLIST_TAIL
 1

	)

37 *
zùli°New
();

38 *
zùli°Mîge
(**
fú°
, **
£c⁄d
);

39 *
zùli°Push
(*
zl
, *
s
, 
¶í
, 
whîe
);

40 *
zùli°Index
(*
zl
, 
ödex
);

41 *
zùli°Next
(*
zl
, *
p
);

42 *
zùli°Pªv
(*
zl
, *
p
);

43 
zùli°Gë
(*
p
, **
svÆ
, *
¶í
, *
lvÆ
);

44 *
zùli°In£π
(*
zl
, *
p
, *
s
, 
¶í
);

45 *
zùli°Dñëe
(*
zl
, **
p
);

46 *
zùli°DñëeR™ge
(*
zl
, 
ödex
, 
num
);

47 
zùli°Com∑ª
(*
p
, *
s
, 
¶í
);

48 *
zùli°Föd
(*
p
, *
v°r
, 
vÀn
, 
skù
);

49 
zùli°Lí
(*
zl
);

50 
size_t
 
zùli°BlobLí
(*
zl
);

51 
zùli°Rïr
(*
zl
);

53 #ifde‡
REDIS_TEST


54 
zùli°Te°
(
¨gc
, *
¨gv
[]);

	@zipmap.c

78 
	~<°dio.h
>

79 
	~<°rög.h
>

80 
	~"zmÆloc.h
"

81 
	~"ídünc⁄v.h
"

83 
	#ZIPMAP_BIGLEN
 254

	)

84 
	#ZIPMAP_END
 255

	)

88 
	#ZIPMAP_VALUE_MAX_FREE
 4

	)

93 
	#ZIPMAP_LEN_BYTES
(
_l
Ë(((_lË< 
ZIPMAP_BIGLEN
Ë? 1 : ()+1)

	)

96 *
	$zùm≠New
() {

97 *
zm
 = 
	`zmÆloc
(2);

99 
zm
[0] = 0;

100 
zm
[1] = 
ZIPMAP_END
;

101  
zm
;

102 
	}
}

105 
	$zùm≠DecodeLígth
(*
p
) {

106 
Àn
 = *
p
;

108 i‡(
Àn
 < 
ZIPMAP_BIGLEN
) Üen;

109 
	`mem˝y
(&
Àn
,
p
+1,());

110 
	`memªv32ifbe
(&
Àn
);

111  
Àn
;

112 
	}
}

116 
	$zùm≠EncodeLígth
(*
p
, 
Àn
) {

117 i‡(
p
 =
NULL
) {

118  
	`ZIPMAP_LEN_BYTES
(
Àn
);

120 i‡(
Àn
 < 
ZIPMAP_BIGLEN
) {

121 
p
[0] = 
Àn
;

124 
p
[0] = 
ZIPMAP_BIGLEN
;

125 
	`mem˝y
(
p
+1,&
Àn
,(len));

126 
	`memªv32ifbe
(
p
+1);

127  1+(
Àn
);

130 
	}
}

138 *
	$zùm≠LookupRaw
(*
zm
, *
key
, 
kÀn
, *
tŸÀn
) {

139 *
p
 = 
zm
+1, *
k
 = 
NULL
;

140 
l
,
Œí
;

142 *
p
 !
ZIPMAP_END
) {

143 
‰ì
;

146 
l
 = 
	`zùm≠DecodeLígth
(
p
);

147 
Œí
 = 
	`zùm≠EncodeLígth
(
NULL
,
l
);

148 i‡(
key
 !
NULL
 && 
k
 =NULL && 
l
 =
kÀn
 && !
	`memcmp
(
p
+
Œí
,key,l)) {

151 i‡(
tŸÀn
 !
NULL
) {

152 
k
 = 
p
;

154  
p
;

157 
p
 +
Œí
+
l
;

159 
l
 = 
	`zùm≠DecodeLígth
(
p
);

160 
p
 +
	`zùm≠EncodeLígth
(
NULL
,
l
);

161 
‰ì
 = 
p
[0];

162 
p
 +
l
+1+
‰ì
;

164 i‡(
tŸÀn
 !
NULL
Ë*tŸÀ¿()(
p
-
zm
)+1;

165  
k
;

166 
	}
}

168 
	$zùm≠RequúedLígth
(
kÀn
, 
vÀn
) {

169 
l
;

171 
l
 = 
kÀn
+
vÀn
+3;

172 i‡(
kÀn
 >
ZIPMAP_BIGLEN
Ë
l
 += 4;

173 i‡(
vÀn
 >
ZIPMAP_BIGLEN
Ë
l
 += 4;

174  
l
;

175 
	}
}

178 
	$zùm≠RawKeyLígth
(*
p
) {

179 
l
 = 
	`zùm≠DecodeLígth
(
p
);

180  
	`zùm≠EncodeLígth
(
NULL
,
l
) +Ü;

181 
	}
}

185 
	$zùm≠RawVÆueLígth
(*
p
) {

186 
l
 = 
	`zùm≠DecodeLígth
(
p
);

187 
u£d
;

189 
u£d
 = 
	`zùm≠EncodeLígth
(
NULL
,
l
);

190 
u£d
 +
p
[u£d] + 1 + 
l
;

191  
u£d
;

192 
	}
}

197 
	$zùm≠RawE¡ryLígth
(*
p
) {

198 
l
 = 
	`zùm≠RawKeyLígth
(
p
);

199  
l
 + 
	`zùm≠RawVÆueLígth
(
p
+l);

200 
	}
}

202 
ölöe
 *
	$zùm≠Resize
(*
zm
, 
Àn
) {

203 
zm
 = 
	`zªÆloc
(zm, 
Àn
);

204 
zm
[
Àn
-1] = 
ZIPMAP_END
;

205  
zm
;

206 
	}
}

211 *
	$zùm≠Së
(*
zm
, *
key
, 
kÀn
, *
vÆ
, 
vÀn
, *
upd©e
) {

212 
zmÀn
, 
off£t
;

213 
‰ìÀn
, 
ªqÀn
 = 
	`zùm≠RequúedLígth
(
kÀn
,
vÀn
);

214 
em±y
, 
vem±y
;

215 *
p
;

217 
‰ìÀn
 = 
ªqÀn
;

218 i‡(
upd©e
) *update = 0;

219 
p
 = 
	`zùm≠LookupRaw
(
zm
,
key
,
kÀn
,&
zmÀn
);

220 i‡(
p
 =
NULL
) {

222 
zm
 = 
	`zùm≠Resize
(zm, 
zmÀn
+
ªqÀn
);

223 
p
 = 
zm
+
zmÀn
-1;

224 
zmÀn
 = zmÀn+
ªqÀn
;

227 i‡(
zm
[0] < 
ZIPMAP_BIGLEN
) zm[0]++;

231 i‡(
upd©e
) *update = 1;

232 
‰ìÀn
 = 
	`zùm≠RawE¡ryLígth
(
p
);

233 i‡(
‰ìÀn
 < 
ªqÀn
) {

237 
off£t
 = 
p
-
zm
;

238 
zm
 = 
	`zùm≠Resize
(zm, 
zmÀn
-
‰ìÀn
+
ªqÀn
);

239 
p
 = 
zm
+
off£t
;

243 
	`memmove
(
p
+
ªqÀn
,Ö+
‰ìÀn
, 
zmÀn
-(
off£t
+freelen+1));

244 
zmÀn
 = zmÀn-
‰ìÀn
+
ªqÀn
;

245 
‰ìÀn
 = 
ªqÀn
;

253 
em±y
 = 
‰ìÀn
-
ªqÀn
;

254 i‡(
em±y
 >
ZIPMAP_VALUE_MAX_FREE
) {

257 
off£t
 = 
p
-
zm
;

258 
	`memmove
(
p
+
ªqÀn
,Ö+
‰ìÀn
, 
zmÀn
-(
off£t
+freelen+1));

259 
zmÀn
 -
em±y
;

260 
zm
 = 
	`zùm≠Resize
(zm, 
zmÀn
);

261 
p
 = 
zm
+
off£t
;

262 
vem±y
 = 0;

264 
vem±y
 = 
em±y
;

269 
p
 +
	`zùm≠EncodeLígth
’,
kÀn
);

270 
	`mem˝y
(
p
,
key
,
kÀn
);

271 
p
 +
kÀn
;

273 
p
 +
	`zùm≠EncodeLígth
’,
vÀn
);

274 *
p
++ = 
vem±y
;

275 
	`mem˝y
(
p
,
vÆ
,
vÀn
);

276  
zm
;

277 
	}
}

281 *
	$zùm≠Dñ
(*
zm
, *
key
, 
kÀn
, *
dñëed
) {

282 
zmÀn
, 
‰ìÀn
;

283 *
p
 = 
	`zùm≠LookupRaw
(
zm
,
key
,
kÀn
,&
zmÀn
);

284 i‡(
p
) {

285 
‰ìÀn
 = 
	`zùm≠RawE¡ryLígth
(
p
);

286 
	`memmove
(
p
,Ö+
‰ìÀn
, 
zmÀn
-(’-
zm
)+freelen+1));

287 
zm
 = 
	`zùm≠Resize
(zm, 
zmÀn
-
‰ìÀn
);

290 i‡(
zm
[0] < 
ZIPMAP_BIGLEN
) zm[0]--;

292 i‡(
dñëed
) *deleted = 1;

294 i‡(
dñëed
) *deleted = 0;

296  
zm
;

297 
	}
}

300 *
	$zùm≠Rewöd
(*
zm
) {

301  
zm
+1;

302 
	}
}

315 *
	$zùm≠Next
(*
zm
, **
key
, *
kÀn
, **
vÆue
, *
vÀn
) {

316 i‡(
zm
[0] =
ZIPMAP_END
Ë 
NULL
;

317 i‡(
key
) {

318 *
key
 = 
zm
;

319 *
kÀn
 = 
	`zùm≠DecodeLígth
(
zm
);

320 *
key
 +
	`ZIPMAP_LEN_BYTES
(*
kÀn
);

322 
zm
 +
	`zùm≠RawKeyLígth
(zm);

323 i‡(
vÆue
) {

324 *
vÆue
 = 
zm
+1;

325 *
vÀn
 = 
	`zùm≠DecodeLígth
(
zm
);

326 *
vÆue
 +
	`ZIPMAP_LEN_BYTES
(*
vÀn
);

328 
zm
 +
	`zùm≠RawVÆueLígth
(zm);

329  
zm
;

330 
	}
}

334 
	$zùm≠Gë
(*
zm
, *
key
, 
kÀn
, **
vÆue
, *
vÀn
) {

335 *
p
;

337 i‡((
p
 = 
	`zùm≠LookupRaw
(
zm
,
key
,
kÀn
,
NULL
)) == NULL)  0;

338 
p
 +
	`zùm≠RawKeyLígth
(p);

339 *
vÀn
 = 
	`zùm≠DecodeLígth
(
p
);

340 *
vÆue
 = 
p
 + 
	`ZIPMAP_LEN_BYTES
(*
vÀn
) + 1;

342 
	}
}

345 
	$zùm≠Exi°s
(*
zm
, *
key
, 
kÀn
) {

346  
	`zùm≠LookupRaw
(
zm
,
key
,
kÀn
,
NULL
) != NULL;

347 
	}
}

350 
	$zùm≠Lí
(*
zm
) {

351 
Àn
 = 0;

352 i‡(
zm
[0] < 
ZIPMAP_BIGLEN
) {

353 
Àn
 = 
zm
[0];

355 *
p
 = 
	`zùm≠Rewöd
(
zm
);

356 (
p
 = 
	`zùm≠Next
’,
NULL
,NULL,NULL,NULL)Ë!NULLË
Àn
++;

359 i‡(
Àn
 < 
ZIPMAP_BIGLEN
Ë
zm
[0] =Üen;

361  
Àn
;

362 
	}
}

367 
size_t
 
	$zùm≠BlobLí
(*
zm
) {

368 
tŸÀn
;

369 
	`zùm≠LookupRaw
(
zm
,
NULL
,0,&
tŸÀn
);

370  
tŸÀn
;

371 
	}
}

373 #ifde‡
REDIS_TEST


374 
	$zùm≠Rïr
(*
p
) {

375 
l
;

377 
	`¥ötf
("{°©u†%u}",*
p
++);

379 i‡(
p
[0] =
ZIPMAP_END
) {

380 
	`¥ötf
("{end}");

383 
e
;

385 
l
 = 
	`zùm≠DecodeLígth
(
p
);

386 
	`¥ötf
("{key %u}",
l
);

387 
p
 +
	`zùm≠EncodeLígth
(
NULL
,
l
);

388 i‡(
l
 !0 && 
	`fwrôe
(
p
,l,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

389 
p
 +
l
;

391 
l
 = 
	`zùm≠DecodeLígth
(
p
);

392 
	`¥ötf
("{vÆuê%u}",
l
);

393 
p
 +
	`zùm≠EncodeLígth
(
NULL
,
l
);

394 
e
 = *
p
++;

395 i‡(
l
 !0 && 
	`fwrôe
(
p
,l,1,
°dout
Ë=0Ë
	`≥º‹
("fwrite");

396 
p
 +
l
+
e
;

397 i‡(
e
) {

398 
	`¥ötf
("[");

399 
e
--Ë
	`¥ötf
(".");

400 
	`¥ötf
("]");

404 
	`¥ötf
("\n");

405 
	}
}

407 
	#UNUSED
(
x
Ë()(x)

	)

408 
	$zùm≠Te°
(
¨gc
, *
¨gv
[]) {

409 *
zm
;

411 
	`UNUSED
(
¨gc
);

412 
	`UNUSED
(
¨gv
);

414 
zm
 = 
	`zùm≠New
();

416 
zm
 = 
	`zùm≠Së
(zm,(*Ë"«me",4, (*Ë"foo",3,
NULL
);

417 
zm
 = 
	`zùm≠Së
(zm,(*Ë"su∫ame",7, (*Ë"foo",3,
NULL
);

418 
zm
 = 
	`zùm≠Së
(zm,(*Ë"age",3, (*Ë"foo",3,
NULL
);

419 
	`zùm≠Rïr
(
zm
);

421 
zm
 = 
	`zùm≠Së
(zm,(*Ë"hñlo",5, (*Ë"w‹ld!",6,
NULL
);

422 
zm
 = 
	`zùm≠Së
(zm,(*Ë"foo",3, (*Ë"b¨",3,
NULL
);

423 
zm
 = 
	`zùm≠Së
(zm,(*Ë"foo",3, (*Ë"!",1,
NULL
);

424 
	`zùm≠Rïr
(
zm
);

425 
zm
 = 
	`zùm≠Së
(zm,(*Ë"foo",3, (*Ë"12345",5,
NULL
);

426 
	`zùm≠Rïr
(
zm
);

427 
zm
 = 
	`zùm≠Së
(zm,(*Ë"√w",3, (*Ë"xx",2,
NULL
);

428 
zm
 = 
	`zùm≠Së
(zm,(*Ë"novÆ",5, (*Ë"",0,
NULL
);

429 
	`zùm≠Rïr
(
zm
);

430 
zm
 = 
	`zùm≠Dñ
(zm,(*Ë"√w",3,
NULL
);

431 
	`zùm≠Rïr
(
zm
);

433 
	`¥ötf
("\nLook upÜarge key:\n");

435 
buf
[512];

436 *
vÆue
;

437 
vÀn
, 
i
;

438 
i
 = 0; i < 512; i++Ë
buf
[i] = 'a';

440 
zm
 = 
	`zùm≠Së
(zm,
buf
,512,(*Ë"l⁄g",4,
NULL
);

441 i‡(
	`zùm≠Gë
(
zm
,
buf
,512,&
vÆue
,&
vÀn
)) {

442 
	`¥ötf
(" <long key> isássociatedÅoÅhe %d bytes value: %.*s\n",

443 
vÀn
, vÀn, 
vÆue
);

447 
	`¥ötf
("\nPerformá directÜookup:\n");

449 *
vÆue
;

450 
vÀn
;

452 i‡(
	`zùm≠Gë
(
zm
,(*Ë"foo",3,&
vÆue
,&
vÀn
)) {

453 
	`¥ötf
(" foo isássociatedÅoÅhe %d bytes value: %.*s\n",

454 
vÀn
, vÀn, 
vÆue
);

457 
	`¥ötf
("\nIterateÅhroughÉlements:\n");

459 *
i
 = 
	`zùm≠Rewöd
(
zm
);

460 *
key
, *
vÆue
;

461 
kÀn
, 
vÀn
;

463 (
i
 = 
	`zùm≠Next
(i,&
key
,&
kÀn
,&
vÆue
,&
vÀn
)Ë!
NULL
) {

464 
	`¥ötf
(" %d:%.*†=> %d:%.*s\n", 
kÀn
, kÀn, 
key
, 
vÀn
, vÀn, 
vÆue
);

468 
	}
}

	@zipmap.h

35 #i‚de‡
_ZIPMAP_H


36 
	#_ZIPMAP_H


	)

38 *
zùm≠New
();

39 *
zùm≠Së
(*
zm
, *
key
, 
kÀn
, *
vÆ
, 
vÀn
, *
upd©e
);

40 *
zùm≠Dñ
(*
zm
, *
key
, 
kÀn
, *
dñëed
);

41 *
zùm≠Rewöd
(*
zm
);

42 *
zùm≠Next
(*
zm
, **
key
, *
kÀn
, **
vÆue
, *
vÀn
);

43 
zùm≠Gë
(*
zm
, *
key
, 
kÀn
, **
vÆue
, *
vÀn
);

44 
zùm≠Exi°s
(*
zm
, *
key
, 
kÀn
);

45 
zùm≠Lí
(*
zm
);

46 
size_t
 
zùm≠BlobLí
(*
zm
);

47 
zùm≠Rïr
(*
p
);

49 #ifde‡
REDIS_TEST


50 
zùm≠Te°
(
¨gc
, *
¨gv
[]);

	@zmalloc.c

31 
	~<°dio.h
>

32 
	~<°dlib.h
>

33 
	~<°döt.h
>

39 
	$zlibc_‰ì
(*
±r
) {

40 
	`‰ì
(
±r
);

41 
	}
}

43 
	~<°rög.h
>

44 
	~<±hªad.h
>

45 
	~"c⁄fig.h
"

46 
	~"zmÆloc.h
"

47 
	~"©omicv¨.h
"

49 #ifde‡
HAVE_MALLOC_SIZE


50 
	#PREFIX_SIZE
 (0)

	)

52 #i‡
deföed
(
__sun
Ë|| deföed(
__•¨c
Ë|| deföed(
__•¨c__
)

53 
	#PREFIX_SIZE
 (())

	)

55 
	#PREFIX_SIZE
 ((
size_t
))

	)

60 #i‡
deföed
(
USE_TCMALLOC
)

61 
	#mÆloc
(
size
Ë
	`tc_mÆloc
(size)

	)

62 
	#ˇŒoc
(
cou¡
,
size
Ë
	`tc_ˇŒoc
(cou¡,size)

	)

63 
	#ªÆloc
(
±r
,
size
Ë
	`tc_ªÆloc
’å,size)

	)

64 
	#‰ì
(
±r
Ë
	`tc_‰ì
’å)

	)

65 #ñi‡
deföed
(
USE_JEMALLOC
)

66 
	#mÆloc
(
size
Ë
	`je_mÆloc
(size)

	)

67 
	#ˇŒoc
(
cou¡
,
size
Ë
	`je_ˇŒoc
(cou¡,size)

	)

68 
	#ªÆloc
(
±r
,
size
Ë
	`je_ªÆloc
’å,size)

	)

69 
	#‰ì
(
±r
Ë
	`je_‰ì
’å)

	)

70 
	#mÆlocx
(
size
,
Êags
Ë
	`je_mÆlocx
(size,Êags)

	)

71 
	#dÆlocx
(
±r
,
Êags
Ë
	`je_dÆlocx
’å,Êags)

	)

74 
	#upd©e_zmÆloc_°©_Æloc
(
__n
) do { \

75 
size_t
 
_n
 = (
__n
); \

76 i‡(
_n
&(()-1)) _n += ()-(_n&(()-1)); \

77 
	`©omicIn¸
(
u£d_mem‹y
,
__n
); \

78 } 0)

	)

80 
	#upd©e_zmÆloc_°©_‰ì
(
__n
) do { \

81 
size_t
 
_n
 = (
__n
); \

82 i‡(
_n
&(()-1)) _n += ()-(_n&(()-1)); \

83 
	`©omicDe¸
(
u£d_mem‹y
,
__n
); \

84 } 0)

	)

86 
size_t
 
	gu£d_mem‹y
 = 0;

87 
±hªad_muãx_t
 
	gu£d_mem‹y_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

89 
	$zmÆloc_deÁu…_oom
(
size_t
 
size
) {

90 
	`Ârötf
(
°dîr
, "zmalloc: Out of memoryÅryingÅoállocate %zu bytes\n",

91 
size
);

92 
	`fÊush
(
°dîr
);

93 
	`ab‹t
();

94 
	}
}

96 (*
zmÆloc_oom_h™dÀr
)(
size_t
Ë
zmÆloc_deÁu…_oom
;

98 *
	$zmÆloc
(
size_t
 
size
) {

99 *
±r
 = 
	`mÆloc
(
size
+
PREFIX_SIZE
);

101 i‡(!
±r
Ë
	`zmÆloc_oom_h™dÀr
(
size
);

102 #ifde‡
HAVE_MALLOC_SIZE


103 
	`upd©e_zmÆloc_°©_Æloc
(
	`zmÆloc_size
(
±r
));

104  
±r
;

106 *((
size_t
*)
±r
Ë
size
;

107 
	`upd©e_zmÆloc_°©_Æloc
(
size
+
PREFIX_SIZE
);

108  (*)
±r
+
PREFIX_SIZE
;

110 
	}
}

115 #ifde‡
HAVE_DEFRAG


116 *
	$zmÆloc_no_tˇche
(
size_t
 
size
) {

117 *
±r
 = 
	`mÆlocx
(
size
+
PREFIX_SIZE
, 
MALLOCX_TCACHE_NONE
);

118 i‡(!
±r
Ë
	`zmÆloc_oom_h™dÀr
(
size
);

119 
	`upd©e_zmÆloc_°©_Æloc
(
	`zmÆloc_size
(
±r
));

120  
±r
;

121 
	}
}

123 
	$z‰ì_no_tˇche
(*
±r
) {

124 i‡(
±r
 =
NULL
) ;

125 
	`upd©e_zmÆloc_°©_‰ì
(
	`zmÆloc_size
(
±r
));

126 
	`dÆlocx
(
±r
, 
MALLOCX_TCACHE_NONE
);

127 
	}
}

130 *
	$zˇŒoc
(
size_t
 
size
) {

131 *
±r
 = 
	`ˇŒoc
(1, 
size
+
PREFIX_SIZE
);

133 i‡(!
±r
Ë
	`zmÆloc_oom_h™dÀr
(
size
);

134 #ifde‡
HAVE_MALLOC_SIZE


135 
	`upd©e_zmÆloc_°©_Æloc
(
	`zmÆloc_size
(
±r
));

136  
±r
;

138 *((
size_t
*)
±r
Ë
size
;

139 
	`upd©e_zmÆloc_°©_Æloc
(
size
+
PREFIX_SIZE
);

140  (*)
±r
+
PREFIX_SIZE
;

142 
	}
}

144 *
	$zªÆloc
(*
±r
, 
size_t
 
size
) {

145 #i‚de‡
HAVE_MALLOC_SIZE


146 *
ªÆ±r
;

148 
size_t
 
ﬁdsize
;

149 *
√w±r
;

151 i‡(
size
 =0 && 
±r
 !
NULL
) {

152 
	`z‰ì
(
±r
);

153  
NULL
;

155 i‡(
±r
 =
NULL
Ë 
	`zmÆloc
(
size
);

156 #ifde‡
HAVE_MALLOC_SIZE


157 
ﬁdsize
 = 
	`zmÆloc_size
(
±r
);

158 
√w±r
 = 
	`ªÆloc
(
±r
,
size
);

159 i‡(!
√w±r
Ë
	`zmÆloc_oom_h™dÀr
(
size
);

161 
	`upd©e_zmÆloc_°©_‰ì
(
ﬁdsize
);

162 
	`upd©e_zmÆloc_°©_Æloc
(
	`zmÆloc_size
(
√w±r
));

163  
√w±r
;

165 
ªÆ±r
 = (*)
±r
-
PREFIX_SIZE
;

166 
ﬁdsize
 = *((
size_t
*)
ªÆ±r
);

167 
√w±r
 = 
	`ªÆloc
(
ªÆ±r
,
size
+
PREFIX_SIZE
);

168 i‡(!
√w±r
Ë
	`zmÆloc_oom_h™dÀr
(
size
);

170 *((
size_t
*)
√w±r
Ë
size
;

171 
	`upd©e_zmÆloc_°©_‰ì
(
ﬁdsize
+
PREFIX_SIZE
);

172 
	`upd©e_zmÆloc_°©_Æloc
(
size
+
PREFIX_SIZE
);

173  (*)
√w±r
+
PREFIX_SIZE
;

175 
	}
}

180 #i‚de‡
HAVE_MALLOC_SIZE


181 
size_t
 
	$zmÆloc_size
(*
±r
) {

182 *
ªÆ±r
 = (*)
±r
-
PREFIX_SIZE
;

183 
size_t
 
size
 = *((size_t*)
ªÆ±r
);

186 i‡(
size
&(()-1)) size += ()-(size&(()-1));

187  
size
+
PREFIX_SIZE
;

188 
	}
}

189 
size_t
 
	$zmÆloc_ußbÀ
(*
±r
) {

190  
	`zmÆloc_size
(
±r
)-
PREFIX_SIZE
;

191 
	}
}

194 
	$z‰ì
(*
±r
) {

195 #i‚de‡
HAVE_MALLOC_SIZE


196 *
ªÆ±r
;

197 
size_t
 
ﬁdsize
;

200 i‡(
±r
 =
NULL
) ;

201 #ifde‡
HAVE_MALLOC_SIZE


202 
	`upd©e_zmÆloc_°©_‰ì
(
	`zmÆloc_size
(
±r
));

203 
	`‰ì
(
±r
);

205 
ªÆ±r
 = (*)
±r
-
PREFIX_SIZE
;

206 
ﬁdsize
 = *((
size_t
*)
ªÆ±r
);

207 
	`upd©e_zmÆloc_°©_‰ì
(
ﬁdsize
+
PREFIX_SIZE
);

208 
	`‰ì
(
ªÆ±r
);

210 
	}
}

212 *
	$z°rdup
(c⁄° *
s
) {

213 
size_t
 
l
 = 
	`°æí
(
s
)+1;

214 *
p
 = 
	`zmÆloc
(
l
);

216 
	`mem˝y
(
p
,
s
,
l
);

217  
p
;

218 
	}
}

220 
size_t
 
	$zmÆloc_u£d_mem‹y
() {

221 
size_t
 
um
;

222 
	`©omicGë
(
u£d_mem‹y
,
um
);

223  
um
;

224 
	}
}

226 
	$zmÆloc_£t_oom_h™dÀr
((*
oom_h™dÀr
)(
size_t
)) {

227 
zmÆloc_oom_h™dÀr
 = 
oom_h™dÀr
;

228 
	}
}

240 #i‡
deföed
(
HAVE_PROC_STAT
)

241 
	~<uni°d.h
>

242 
	~<sys/ty≥s.h
>

243 
	~<sys/°©.h
>

244 
	~<f˙é.h
>

246 
size_t
 
	$zmÆloc_gë_rss
() {

247 
∑ge
 = 
	`sysc⁄f
(
_SC_PAGESIZE
);

248 
size_t
 
rss
;

249 
buf
[4096];

250 
fûíame
[256];

251 
fd
, 
cou¡
;

252 *
p
, *
x
;

254 
	`¢¥ötf
(
fûíame
,256,"/¥oc/%d/°©",
	`gëpid
());

255 i‡((
fd
 = 
	`›í
(
fûíame
,
O_RDONLY
)) == -1)  0;

256 i‡(
	`ªad
(
fd
,
buf
,4096) <= 0) {

257 
	`˛o£
(
fd
);

260 
	`˛o£
(
fd
);

262 
p
 = 
buf
;

263 
cou¡
 = 23;

264 
p
 && 
cou¡
--) {

265 
p
 = 
	`°rchr
(p,' ');

266 i‡(
p
)Ö++;

268 i‡(!
p
)  0;

269 
x
 = 
	`°rchr
(
p
,' ');

270 i‡(!
x
)  0;

271 *
x
 = '\0';

273 
rss
 = 
	`°πﬁl
(
p
,
NULL
,10);

274 
rss
 *
∑ge
;

275  
rss
;

276 
	}
}

277 #ñi‡
deföed
(
HAVE_TASKINFO
)

278 
	~<uni°d.h
>

279 
	~<°dio.h
>

280 
	~<°dlib.h
>

281 
	~<sys/ty≥s.h
>

282 
	~<sys/sys˘l.h
>

283 
	~<mach/èsk.h
>

284 
	~<mach/mach_öô.h
>

286 
size_t
 
	$zmÆloc_gë_rss
() {

287 
èsk_t
 
èsk
 = 
MACH_PORT_NULL
;

288 
èsk_basic_öfo
 
t_öfo
;

289 
mach_msg_ty≥_numbî_t
 
t_öfo_cou¡
 = 
TASK_BASIC_INFO_COUNT
;

291 i‡(
	`èsk_f‹_pid
(
	`cuºít_èsk
(), 
	`gëpid
(), &
èsk
Ë!
KERN_SUCCESS
)

293 
	`èsk_öfo
(
èsk
, 
TASK_BASIC_INFO
, (
èsk_öfo_t
)&
t_öfo
, &
t_öfo_cou¡
);

295  
t_öfo
.
ªsidít_size
;

296 
	}
}

297 #ñi‡
deföed
(
__FªeBSD__
)

298 
	~<sys/ty≥s.h
>

299 
	~<sys/sys˘l.h
>

300 
	~<sys/u£r.h
>

301 
	~<uni°d.h
>

303 
size_t
 
	$zmÆloc_gë_rss
() {

304 
köfo_¥oc
 
öfo
;

305 
size_t
 
öfﬁí
 = (
öfo
);

306 
mib
[4];

307 
mib
[0] = 
CTL_KERN
;

308 
mib
[1] = 
KERN_PROC
;

309 
mib
[2] = 
KERN_PROC_PID
;

310 
mib
[3] = 
	`gëpid
();

312 i‡(
	`sys˘l
(
mib
, 4, &
öfo
, &
öfﬁí
, 
NULL
, 0) == 0)

313  (
size_t
)
öfo
.
ki_rssize
;

316 
	}
}

318 
size_t
 
	$zmÆloc_gë_rss
() {

324  
	`zmÆloc_u£d_mem‹y
();

325 
	}
}

328 #i‡
deföed
(
USE_JEMALLOC
)

330 
	$zmÆloc_gë_Æloˇt‹_öfo
(
size_t
 *
Æloˇãd
,

331 
size_t
 *
a˘ive
,

332 
size_t
 *
ªsidít
) {

333 
uöt64_t
 
ïoch
 = 1;

334 
size_t
 
sz
;

335 *
Æloˇãd
 = *
ªsidít
 = *
a˘ive
 = 0;

337 
sz
 = (
ïoch
);

338 
	`je_mÆl˘l
("ïoch", &
ïoch
, &
sz
, &epoch, sz);

339 
sz
 = (
size_t
);

342 
	`je_mÆl˘l
("°©s.ªsidít", 
ªsidít
, &
sz
, 
NULL
, 0);

345 
	`je_mÆl˘l
("°©s.a˘ive", 
a˘ive
, &
sz
, 
NULL
, 0);

348 
	`je_mÆl˘l
("°©s.Æloˇãd", 
Æloˇãd
, &
sz
, 
NULL
, 0);

350 
	}
}

352 
	$£t_jemÆloc_bg_thªad
(
íabÀ
) {

355 
vÆ
 = !!
íabÀ
;

356 
	`je_mÆl˘l
("background_thªad", 
NULL
, 0, &
vÆ
, 1);

357 
	}
}

359 
	$jemÆloc_purge
() {

361 
tmp
[32];

362 
«ª«s
 = 0;

363 
size_t
 
sz
 = ();

364 i‡(!
	`je_mÆl˘l
("¨ías.«ª«s", &
«ª«s
, &
sz
, 
NULL
, 0)) {

365 
	`•rötf
(
tmp
, "¨ía.%d.purge", 
«ª«s
);

366 i‡(!
	`je_mÆl˘l
(
tmp
, 
NULL
, 0, NULL, 0))

370 
	}
}

374 
	$zmÆloc_gë_Æloˇt‹_öfo
(
size_t
 *
Æloˇãd
,

375 
size_t
 *
a˘ive
,

376 
size_t
 *
ªsidít
) {

377 *
Æloˇãd
 = *
ªsidít
 = *
a˘ive
 = 0;

379 
	}
}

381 
	$£t_jemÆloc_bg_thªad
(
íabÀ
) {

382 (()(
íabÀ
));

383 
	}
}

385 
	$jemÆloc_purge
() {

387 
	}
}

391 #i‡
deföed
(
__APPLE__
)

396 
	~<lib¥oc.h
>

409 #i‡
deföed
(
HAVE_PROC_SMAPS
)

410 
size_t
 
	$zmÆloc_gë_sm≠_byãs_by_fõld
(*
fõld
, 
pid
) {

411 
löe
[1024];

412 
size_t
 
byãs
 = 0;

413 
Êí
 = 
	`°æí
(
fõld
);

414 
FILE
 *
Â
;

416 i‡(
pid
 == -1) {

417 
Â
 = 
	`f›í
("/proc/self/smaps","r");

419 
fûíame
[128];

420 
	`¢¥ötf
(
fûíame
,(fûíame),"/¥oc/%ld/sm≠s",
pid
);

421 
Â
 = 
	`f›í
(
fûíame
,"r");

424 i‡(!
Â
)  0;

425 
	`fgës
(
löe
,÷öe),
Â
Ë!
NULL
) {

426 i‡(
	`°∫cmp
(
löe
,
fõld
,
Êí
) == 0) {

427 *
p
 = 
	`°rchr
(
löe
,'k');

428 i‡(
p
) {

429 *
p
 = '\0';

430 
byãs
 +
	`°πﬁ
(
löe
+
Êí
,
NULL
,10) * 1024;

434 
	`f˛o£
(
Â
);

435  
byãs
;

436 
	}
}

445 
size_t
 
	$zmÆloc_gë_sm≠_byãs_by_fõld
(*
fõld
, 
pid
) {

446 #i‡
	`deföed
(
__APPLE__
)

447 
¥oc_ªgi⁄öfo
 
¥i
;

448 i‡(
	`¥oc_pidöfo
(
pid
, 
PROC_PIDREGIONINFO
, 0, &
¥i
, 
PROC_PIDREGIONINFO_SIZE
) ==

449 
PROC_PIDREGIONINFO_SIZE
) {

450 i‡(!
	`°rcmp
(
fõld
, "Private_Dirty:")) {

451  (
size_t
)
¥i
.
¥i_∑ges_dútõd
 * 4096;

452 } i‡(!
	`°rcmp
(
fõld
, "Rss:")) {

453  (
size_t
)
¥i
.
¥i_∑ges_ªsidít
 * 4096;

454 } i‡(!
	`°rcmp
(
fõld
, "AnonHugePages:")) {

460 ((Ë
fõld
);

461 ((Ë
pid
);

463 
	}
}

466 
size_t
 
	$zmÆloc_gë_¥iv©e_dúty
(
pid
) {

467  
	`zmÆloc_gë_sm≠_byãs_by_fõld
("Priv©e_Dúty:",
pid
);

468 
	}
}

483 
size_t
 
	$zmÆloc_gë_mem‹y_size
() {

484 #i‡
	`deföed
(
__unix__
Ë|| deföed(
__unix
Ë|| deföed(
unix
) || \

485 (
	`deföed
(
__APPLE__
Ë&& deföed(
__MACH__
))

486 #i‡
	`deföed
(
CTL_HW
Ë&& (deföed(
HW_MEMSIZE
Ë|| deföed(
HW_PHYSMEM64
))

487 
mib
[2];

488 
mib
[0] = 
CTL_HW
;

489 #i‡
	`deföed
(
HW_MEMSIZE
)

490 
mib
[1] = 
HW_MEMSIZE
;

491 #ñi‡
	`deföed
(
HW_PHYSMEM64
)

492 
mib
[1] = 
HW_PHYSMEM64
;

494 
öt64_t
 
size
 = 0;

495 
size_t
 
Àn
 = (
size
);

496 i‡(
	`sys˘l
–
mib
, 2, &
size
, &
Àn
, 
NULL
, 0) == 0)

497  (
size_t
)
size
;

500 #ñi‡
	`deföed
(
_SC_PHYS_PAGES
Ë&& deföed(
_SC_PAGESIZE
)

502  (
size_t
)
	`sysc⁄f
(
_SC_PHYS_PAGES
Ë* (size_t)sysc⁄f(
_SC_PAGESIZE
);

504 #ñi‡
	`deföed
(
CTL_HW
Ë&& (deföed(
HW_PHYSMEM
Ë|| deföed(
HW_REALMEM
))

506 
mib
[2];

507 
mib
[0] = 
CTL_HW
;

508 #i‡
	`deföed
(
HW_REALMEM
)

509 
mib
[1] = 
HW_REALMEM
;

510 #ñi‡
	`deföed
(
HW_PHYSMEM
)

511 
mib
[1] = 
HW_PHYSMEM
;

513 
size
 = 0;

514 
size_t
 
Àn
 = (
size
);

515 i‡(
	`sys˘l
(
mib
, 2, &
size
, &
Àn
, 
NULL
, 0) == 0)

516  (
size_t
)
size
;

524 
	}
}

526 #ifde‡
REDIS_TEST


527 
	#UNUSED
(
x
Ë(()(x))

	)

528 
	$zmÆloc_ã°
(
¨gc
, **
¨gv
) {

529 *
±r
;

531 
	`UNUSED
(
¨gc
);

532 
	`UNUSED
(
¨gv
);

533 
	`¥ötf
("Inôü»u£d mem‹y: %zu\n", 
	`zmÆloc_u£d_mem‹y
());

534 
±r
 = 
	`zmÆloc
(123);

535 
	`¥ötf
("AŒoˇãd 123 byãs; u£d: %zu\n", 
	`zmÆloc_u£d_mem‹y
());

536 
±r
 = 
	`zªÆloc
(ptr, 456);

537 
	`¥ötf
("RóŒoˇãdÅÿ456 byãs; u£d: %zu\n", 
	`zmÆloc_u£d_mem‹y
());

538 
	`z‰ì
(
±r
);

539 
	`¥ötf
("FªedÖoöãr; u£d: %zu\n", 
	`zmÆloc_u£d_mem‹y
());

541 
	}
}

	@zmalloc.h

31 #i‚de‡
__ZMALLOC_H


32 
	#__ZMALLOC_H


	)

35 
	#__x°r
(
s
Ë
	`__°r
(s)

	)

36 
	#__°r
(
s
Ë#s

	)

38 #i‡
deföed
(
USE_TCMALLOC
)

39 
	#ZMALLOC_LIB
 ("tcmÆloc-" 
	`__x°r
(
TC_VERSION_MAJOR
Ë"." __x°r(
TC_VERSION_MINOR
))

	)

40 
	~<googÀ/tcmÆloc.h
>

41 #i‡(
TC_VERSION_MAJOR
 =1 && 
TC_VERSION_MINOR
 >= 6) || (TC_VERSION_MAJOR > 1)

42 
	#HAVE_MALLOC_SIZE
 1

	)

43 
	#zmÆloc_size
(
p
Ë
	`tc_mÆloc_size
’)

	)

48 #ñi‡
deföed
(
USE_JEMALLOC
)

49 
	#ZMALLOC_LIB
 ("jemÆloc-" 
	`__x°r
(
JEMALLOC_VERSION_MAJOR
Ë"." __x°r(
JEMALLOC_VERSION_MINOR
Ë"." __x°r(
JEMALLOC_VERSION_BUGFIX
))

	)

50 
	~<jemÆloc/jemÆloc.h
>

51 #i‡(
JEMALLOC_VERSION_MAJOR
 =2 && 
JEMALLOC_VERSION_MINOR
 >= 1) || (JEMALLOC_VERSION_MAJOR > 2)

52 
	#HAVE_MALLOC_SIZE
 1

	)

53 
	#zmÆloc_size
(
p
Ë
	`je_mÆloc_ußbÀ_size
’)

	)

58 #ñi‡
deföed
(
__APPLE__
)

59 
	~<mÆloc/mÆloc.h
>

60 
	#HAVE_MALLOC_SIZE
 1

	)

61 
	#zmÆloc_size
(
p
Ë
	`mÆloc_size
’)

	)

64 #i‚de‡
ZMALLOC_LIB


65 
	#ZMALLOC_LIB
 "libc"

	)

66 #ifde‡
__GLIBC__


67 
	~<mÆloc.h
>

68 
	#HAVE_MALLOC_SIZE
 1

	)

69 
	#zmÆloc_size
(
p
Ë
	`mÆloc_ußbÀ_size
’)

	)

76 #i‡
deföed
(
USE_JEMALLOC
Ë&& deföed(
JEMALLOC_FRAG_HINT
)

77 
	#HAVE_DEFRAG


	)

80 *
zmÆloc
(
size_t
 
size
);

81 *
zˇŒoc
(
size_t
 
size
);

82 *
zªÆloc
(*
±r
, 
size_t
 
size
);

83 
z‰ì
(*
±r
);

84 *
z°rdup
(c⁄° *
s
);

85 
size_t
 
zmÆloc_u£d_mem‹y
();

86 
zmÆloc_£t_oom_h™dÀr
((*
oom_h™dÀr
)(
size_t
));

87 
size_t
 
	`zmÆloc_gë_rss
();

88 
	`zmÆloc_gë_Æloˇt‹_öfo
(
size_t
 *
Æloˇãd
, size_à*
a˘ive
, size_à*
ªsidít
);

89 
	`£t_jemÆloc_bg_thªad
(
íabÀ
);

90 
	`jemÆloc_purge
();

91 
size_t
 
	`zmÆloc_gë_¥iv©e_dúty
(
pid
);

92 
size_t
 
	`zmÆloc_gë_sm≠_byãs_by_fõld
(*
fõld
, 
pid
);

93 
size_t
 
	`zmÆloc_gë_mem‹y_size
();

94 
	`zlibc_‰ì
(*
±r
);

96 #ifde‡
HAVE_DEFRAG


97 
	`z‰ì_no_tˇche
(*
±r
);

98 *
	`zmÆloc_no_tˇche
(
size_t
 
size
);

101 #i‚de‡
HAVE_MALLOC_SIZE


102 
size_t
 
	`zmÆloc_size
(*
±r
);

103 
size_t
 
	`zmÆloc_ußbÀ
(*
±r
);

105 
	#zmÆloc_ußbÀ
(
p
Ë
	`zmÆloc_size
’)

	)

108 #ifde‡
REDIS_TEST


109 
	`zmÆloc_ã°
(
¨gc
, **
¨gv
);

	@/usr/include/arpa/inet.h

18 #i‚de‡
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<√töë/ö.h
>

25 #i‚de‡
__sockÀn_t_deföed


26 
__sockÀn_t
 
	tsockÀn_t
;

27 
	#__sockÀn_t_deföed


	)

30 
__BEGIN_DECLS


34 
ö_addr_t
 
	$öë_addr
 (c⁄° *
__˝
Ë
__THROW
;

37 
ö_addr_t
 
	$öë_ aof
 (
ö_addr
 
__ö
Ë
__THROW
;

41 
ö_addr
 
	$öë_makóddr
 (
ö_addr_t
 
__√t
, in_addr_à
__ho°
)

42 
__THROW
;

45 
ö_addr_t
 
	$öë_√tof
 (
ö_addr
 
__ö
Ë
__THROW
;

49 
ö_addr_t
 
	$öë_√tw‹k
 (c⁄° *
__˝
Ë
__THROW
;

53 *
	$öë_¡ﬂ
 (
ö_addr
 
__ö
Ë
__THROW
;

58 
	$öë_±⁄
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

59 *
__ª°ri˘
 
__buf
Ë
__THROW
;

64 c⁄° *
	$öë_¡›
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

65 *
__ª°ri˘
 
__buf
, 
sockÀn_t
 
__Àn
)

66 
__THROW
;

70 #ifde‡
__USE_MISC


73 
	$öë_©⁄
 (c⁄° *
__˝
, 
ö_addr
 *
__öp
Ë
__THROW
;

77 *
	$öë_√è
 (
ö_addr_t
 
__√t
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

82 *
	$öë_√t_¡›
 (
__af
, c⁄° *
__˝
, 
__bôs
,

83 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

88 
	$öë_√t_±⁄
 (
__af
, c⁄° *
__˝
,

89 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

94 
	$öë_nßp_addr
 (c⁄° *
__˝
,

95 *
__buf
, 
__Àn
Ë
__THROW
;

99 *
	$öë_nßp_¡ﬂ
 (
__Àn
, c⁄° *
__˝
,

100 *
__buf
Ë
__THROW
;

103 
__END_DECLS


	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #unde‡
_ASSERT_H


25 #unde‡
as£π


26 #unde‡
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #unde‡
as£π_≥º‹


34 
	#_ASSERT_H
 1

	)

35 
	~<„©uªs.h
>

37 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #i‚de‡
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£π_Áû
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
,

70 
__löe
, c⁄° *
__fun˘i⁄
)

71 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

74 
	$__as£π_≥º‹_Áû
 (
__î∫um
, c⁄° *
__fûe
,

75 
__löe
, c⁄° *
__fun˘i⁄
)

76 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

81 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

82 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

85 
__END_DECLS


91 #i‡
deföed
 
__˝lu•lus


92 
	#as£π
(
ex¥
) \

93 (
°©ic_ˇ°
 <
boﬁ
> (
ex¥
) \

95 : 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #ñi‡!
deföed
 
__GNUC__
 || deföed 
__STRICT_ANSI__


97 
	#as£π
(
ex¥
) \

98 ((
ex¥
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

107 
	#as£π
(
ex¥
) \

108 ((Ë ((
ex¥
Ë? 1 : 0), 
	`__exãnsi⁄__
 ({ \

109 i‡(
ex¥
) \

112 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
); \

113 
	}
}))

	)

116 #ifdef 
__USE_GNU


117 
	#as£π_≥º‹
(
î∫um
) \

118 (!(
î∫um
) \

119 ? 
	`__ASSERT_VOID_CAST
 (0) \

120 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

128 #i‡
deföed
 
__˝lu•lus
 ? 
__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

129 
	#__ASSERT_FUNCTION
 
__exãnsi⁄__
 
__PRETTY_FUNCTION__


	)

131 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

132 
	#__ASSERT_FUNCTION
 
__func__


	)

134 
	#__ASSERT_FUNCTION
 ((c⁄° *Ë0)

	)

141 #i‡
deföed
 
__USE_ISOC11
 && !deföed 
__˝lu•lus


142 #unde‡
°©ic_as£π


143 
	#°©ic_as£π
 
_Sètic_as£π


	)

	@/usr/include/ctype.h

22 #i‚def 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	g__BEGIN_DECLS


30 #i‚de‡
_ISbô


39 
	~<ídün.h
>

40 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


41 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

43 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

48 
	m_ISuµî
 = 
_ISbô
 (0),

49 
	m_ISlowî
 = 
_ISbô
 (1),

50 
	m_ISÆpha
 = 
_ISbô
 (2),

51 
	m_ISdigô
 = 
_ISbô
 (3),

52 
	m_ISxdigô
 = 
_ISbô
 (4),

53 
	m_IS•a˚
 = 
_ISbô
 (5),

54 
	m_IS¥öt
 = 
_ISbô
 (6),

55 
	m_ISgøph
 = 
_ISbô
 (7),

56 
	m_ISbœnk
 = 
_ISbô
 (8),

57 
	m_IS˙ål
 = 
_ISbô
 (9),

58 
	m_ISpun˘
 = 
_ISbô
 (10),

59 
	m_ISÆnum
 = 
_ISbô
 (11)

79 c⁄° **
	$__˘y≥_b_loc
 ()

80 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

81 c⁄° 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

82 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

83 c⁄° 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

84 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

87 #i‚de‡
__˝lu•lus


88 
	#__is˘y≥
(
c
, 
ty≥
) \

89 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

90 #ñi‡
deföed
 
__USE_EXTERN_INLINES


91 
	#__is˘y≥_f
(
ty≥
) \

92 
__exã∫_ölöe
 \

93 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

95  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

96 
	}

	)
}

99 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

100 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

102 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

108 
__ex˘y≥
 (
iß um
);

109 
__ex˘y≥
 (
ißÕha
);

110 
__ex˘y≥
 (
is˙ål
);

111 
__ex˘y≥
 (
isdigô
);

112 
__ex˘y≥
 (
i¶owî
);

113 
__ex˘y≥
 (
isgøph
);

114 
__ex˘y≥
 (
i•röt
);

115 
__ex˘y≥
 (
i•un˘
);

116 
__ex˘y≥
 (
is•a˚
);

117 
__ex˘y≥
 (
isuµî
);

118 
__ex˘y≥
 (
isxdigô
);

122 
	$tﬁowî
 (
__c
Ë
__THROW
;

125 
	$touµî
 (
__c
Ë
__THROW
;

129 #ifdef 
__USE_ISOC99


130 
	`__ex˘y≥
 (
isbœnk
);

133 #ifde‡
__USE_GNU


135 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

138 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


142 
	$ißscii
 (
__c
Ë
__THROW
;

146 
	$tﬂscii
 (
__c
Ë
__THROW
;

150 
	`__ex˘y≥
 (
_touµî
);

151 
	`__ex˘y≥
 (
_tﬁowî
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

156 (
__exãnsi⁄__
 \

157 ({ 
__ªs
; \

158 i‡( (
c
) > 1) \

160 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

166 
__ªs
 = 
f
 
¨gs
; \

169 
__ªs
 = (
a
)[(Ë(
c
)]; \

170 
__ªs
; 
	}
}))

	)

172 #i‡!
deföed
 
__NO_CTYPE


173 #ifde‡
__is˘y≥_f


174 
	$__is˘y≥_f
 (
Ænum
)

175 
	$__is˘y≥_f
 (
Æpha
)

176 
	$__is˘y≥_f
 (
˙ål
)

177 
	$__is˘y≥_f
 (
digô
)

178 
	$__is˘y≥_f
 (
lowî
)

179 
	$__is˘y≥_f
 (
gøph
)

180 
	$__is˘y≥_f
 (
¥öt
)

181 
	$__is˘y≥_f
 (
pun˘
)

182 
	$__is˘y≥_f
 (
•a˚
)

183 
	$__is˘y≥_f
 (
uµî
)

184 
	$__is˘y≥_f
 (
xdigô
)

185 #ifde‡
__USE_ISOC99


186 
	$__is˘y≥_f
 (
bœnk
)

188 #ñi‡
deföed
 
__is˘y≥


189 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

190 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

191 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

192 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

193 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

194 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

195 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

196 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

197 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

198 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

199 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

200 #ifde‡
__USE_ISOC99


201 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

205 #ifde‡
__USE_EXTERN_INLINES


206 
__exã∫_ölöe
 

207 
	`__NTH
 (
	$tﬁowî
 (
__c
))

209  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

210 
	}
}

212 
__exã∫_ölöe
 

213 
__NTH
 (
	$touµî
 (
__c
))

215  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

216 
	}
}

219 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


220 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

221 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

224 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


225 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

226 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

228 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

229 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

235 #ifde‡
__USE_XOPEN2K8


237 
	~<bôs/ty≥s/loˇÀ_t.h
>

241 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

242 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

244 
	#__ex˘y≥_l
(
«me
) \

245 
	`«me
 (, 
loˇÀ_t
Ë
__THROW


	)

251 
__ex˘y≥_l
 (
iß um_l
);

252 
__ex˘y≥_l
 (
ißÕha_l
);

253 
__ex˘y≥_l
 (
is˙ål_l
);

254 
__ex˘y≥_l
 (
isdigô_l
);

255 
__ex˘y≥_l
 (
i¶owî_l
);

256 
__ex˘y≥_l
 (
isgøph_l
);

257 
__ex˘y≥_l
 (
i•röt_l
);

258 
__ex˘y≥_l
 (
i•un˘_l
);

259 
__ex˘y≥_l
 (
is•a˚_l
);

260 
__ex˘y≥_l
 (
isuµî_l
);

261 
__ex˘y≥_l
 (
isxdigô_l
);

263 
__ex˘y≥_l
 (
isbœnk_l
);

267 
	$__tﬁowî_l
 (
__c
, 
loˇÀ_t
 
__l
Ë
__THROW
;

268 
	$tﬁowî_l
 (
__c
, 
loˇÀ_t
 
__l
Ë
__THROW
;

271 
	$__touµî_l
 (
__c
, 
loˇÀ_t
 
__l
Ë
__THROW
;

272 
	$touµî_l
 (
__c
, 
loˇÀ_t
 
__l
Ë
__THROW
;

274 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


275 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

276 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

277 
	#__touµî_l
(
c
, 
loˇÀ
) \

278 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

279 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

280 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

284 #i‚de‡
__NO_CTYPE


285 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

286 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

287 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

288 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

289 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

290 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

291 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

292 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

293 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

294 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

295 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

297 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

299 #ifde‡
__USE_MISC


300 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

301 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

304 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

305 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

306 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

307 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

308 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

309 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

310 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

311 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

312 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

313 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

314 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

316 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

318 #ifde‡
__USE_MISC


319 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

320 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

327 
__END_DECLS


	@/usr/include/dlfcn.h

19 #i‚def 
_DLFCN_H


20 
	#_DLFCN_H
 1

	)

22 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

27 
	~<bôs/dlf˙.h
>

30 #ifde‡
__USE_GNU


35 
	#RTLD_NEXT
 ((*Ë-1l)

	)

40 
	#RTLD_DEFAULT
 ((*Ë0)

	)

44 
	tLmid_t
;

47 
	#LM_ID_BASE
 0

	)

48 
	#LM_ID_NEWLM
 -1

	)

52 
__BEGIN_DECLS


56 *
	$dl›í
 (c⁄° *
__fûe
, 
__mode
Ë
__THROWNL
;

60 
	$dl˛o£
 (*
__h™dÀ
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1));

64 *
	$dlsym
 (*
__ª°ri˘
 
__h™dÀ
,

65 c⁄° *
__ª°ri˘
 
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

67 #ifde‡
__USE_GNU


69 *
	$dlm›í
 (
Lmid_t
 
__nsid
, c⁄° *
__fûe
, 
__mode
Ë
__THROWNL
;

73 *
	$dlvsym
 (*
__ª°ri˘
 
__h™dÀ
,

74 c⁄° *
__ª°ri˘
 
__«me
,

75 c⁄° *
__ª°ri˘
 
__vîsi⁄
)

76 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

82 *
	$dÀº‹
 (Ë
__THROW
;

85 #ifde‡
__USE_GNU


90 c⁄° *
dli_‚ame
;

91 *
dli_fba£
;

92 c⁄° *
dli_¢ame
;

93 *
dli_ßddr
;

94 } 
	tDl_öfo
;

98 
	$dœddr
 (c⁄° *
__addªss
, 
Dl_öfo
 *
__öfo
)

99 
__THROW
 
	`__n⁄nuŒ
 ((2));

102 
	$dœddr1
 (c⁄° *
__addªss
, 
Dl_öfo
 *
__öfo
,

103 **
__exåa_öfo
, 
__Êags
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

111 
RTLD_DL_SYMENT
 = 1,

114 
RTLD_DL_LINKMAP
 = 2

123 
	$dlöfo
 (*
__ª°ri˘
 
__h™dÀ
,

124 
__ªque°
, *
__ª°ri˘
 
__¨g
)

125 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

131 
RTLD_DI_LMID
 = 1,

135 
RTLD_DI_LINKMAP
 = 2,

137 
RTLD_DI_CONFIGADDR
 = 3,

144 
RTLD_DI_SERINFO
 = 4,

145 
RTLD_DI_SERINFOSIZE
 = 5,

149 
RTLD_DI_ORIGIN
 = 6,

151 
RTLD_DI_PROFILENAME
 = 7,

152 
RTLD_DI_PROFILEOUT
 = 8,

157 
RTLD_DI_TLS_MODID
 = 9,

163 
RTLD_DI_TLS_DATA
 = 10,

165 
RTLD_DI_MAX
 = 10

173 *
dls_«me
;

174 
dls_Êags
;

175 } 
	tDl_£Ω©h
;

181 
size_t
 
dls_size
;

182 
dls_˙t
;

183 
Dl_£Ω©h
 
dls_£Ω©h
[1];

184 } 
	tDl_£röfo
;

188 
__END_DECLS


	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_MISC


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_MISC
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

61 
	~<bôs/uöä-idítôy.h
>

63 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


64 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

65 
	#htﬁe16
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

66 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

67 
	#À16toh
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

69 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

70 
	#htﬁe32
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

71 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

72 
	#À32toh
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

74 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

75 
	#htﬁe64
(
x
Ë
	`__uöt64_idítôy
 (x)

	)

76 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

77 
	#À64toh
(
x
Ë
	`__uöt64_idítôy
 (x)

	)

80 
	#htobe16
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

81 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

82 
	#be16toh
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

83 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

85 
	#htobe32
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

86 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

87 
	#be32toh
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

88 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

90 
	#htobe64
(
x
Ë
	`__uöt64_idítôy
 (x)

	)

91 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

92 
	#be64toh
(
x
Ë
	`__uöt64_idítôy
 (x)

	)

93 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/errno.h

22 #i‚def 
_ERRNO_H


23 
	#_ERRNO_H
 1

	)

25 
	~<„©uªs.h
>

28 
	~<bôs/î∫o.h
>

32 #i‚de‡
__ASSEMBLER__


34 
__BEGIN_DECLS


37 *
	$__î∫o_loˇti⁄
 (Ë
__THROW
 
__©åibuã_c⁄°__
;

38 
	#î∫o
 (*
	`__î∫o_loˇti⁄
 ())

	)

40 #ifde‡
__USE_GNU


45 *
¥ogøm_övoˇti⁄_«me
;

46 *
¥ogøm_övoˇti⁄_sh‹t_«me
;

48 
	~<bôs/ty≥s/îr‹_t.h
>

52 
__END_DECLS


	@/usr/include/execinfo.h

18 #i‚de‡
_EXECINFO_H


19 
	#_EXECINFO_H
 1

	)

21 
	~<„©uªs.h
>

23 
__BEGIN_DECLS


27 
	$backåa˚
 (**
__¨øy
, 
__size
Ë
	`__n⁄nuŒ
 ((1));

32 **
	$backåa˚_symbﬁs
 (*c⁄° *
__¨øy
, 
__size
)

33 
__THROW
 
	`__n⁄nuŒ
 ((1));

38 
	$backåa˚_symbﬁs_fd
 (*c⁄° *
__¨øy
, 
__size
, 
__fd
)

39 
__THROW
 
	`__n⁄nuŒ
 ((1));

41 
__END_DECLS


	@/usr/include/fcntl.h

22 #i‚def 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


31 
	~<bôs/ty≥s.h
>

35 
	~<bôs/f˙é.h
>

39 #ifde‡
__O_TMPFILE


40 
	#__OPEN_NEEDS_MODE
(
oÊag
) \

41 (((
oÊag
Ë& 
O_CREAT
Ë!0 || ((oÊagË& 
__O_TMPFILE
Ë=__O_TMPFILE)

	)

43 
	#__OPEN_NEEDS_MODE
(
oÊag
Ë(((oÊagË& 
O_CREAT
Ë!0)

	)

49 #i‚de‡
__mode_t_deföed


50 
__mode_t
 
	tmode_t
;

51 
	#__mode_t_deföed


	)

54 #i‚de‡
__off_t_deföed


55 #i‚de‡
__USE_FILE_OFFSET64


56 
__off_t
 
	toff_t
;

58 
__off64_t
 
	toff_t
;

60 
	#__off_t_deföed


	)

63 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_deföed


	)

68 #i‚de‡
__pid_t_deföed


69 
__pid_t
 
	tpid_t
;

70 
	#__pid_t_deföed


	)

74 #ifde‡
__USE_XOPEN2K8


75 
	~<bôs/ty≥s/°ru˘_time•ec.h
>

77 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


78 
	~<bôs/°©.h
>

80 
	#S_IFMT
 
__S_IFMT


	)

81 
	#S_IFDIR
 
__S_IFDIR


	)

82 
	#S_IFCHR
 
__S_IFCHR


	)

83 
	#S_IFBLK
 
__S_IFBLK


	)

84 
	#S_IFREG
 
__S_IFREG


	)

85 #ifde‡
__S_IFIFO


86 
	#S_IFIFO
 
__S_IFIFO


	)

88 #ifde‡
__S_IFLNK


89 
	#S_IFLNK
 
__S_IFLNK


	)

91 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
Ë&& deföed 
__S_IFSOCK


92 
	#S_IFSOCK
 
__S_IFSOCK


	)

97 
	#S_ISUID
 
__S_ISUID


	)

98 
	#S_ISGID
 
__S_ISGID


	)

100 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


102 
	#S_ISVTX
 
__S_ISVTX


	)

105 
	#S_IRUSR
 
__S_IREAD


	)

106 
	#S_IWUSR
 
__S_IWRITE


	)

107 
	#S_IXUSR
 
__S_IEXEC


	)

109 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

111 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

112 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

113 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

115 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

117 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

118 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

119 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

121 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

124 #ifdef 
__USE_MISC


125 #i‚de‡
R_OK


128 
	#R_OK
 4

	)

129 
	#W_OK
 2

	)

130 
	#X_OK
 1

	)

131 
	#F_OK
 0

	)

136 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


137 
	#SEEK_SET
 0

	)

138 
	#SEEK_CUR
 1

	)

139 
	#SEEK_END
 2

	)

147 #i‚de‡
__USE_FILE_OFFSET64


148 
f˙é
 (
__fd
, 
__cmd
, ...);

150 #ifde‡
__REDIRECT


151 
__REDIRECT
 (
f˙é
, (
__fd
, 
__cmd
, ...), 
f˙é64
);

153 
	#f˙é
 
f˙é64


	)

156 #ifde‡
__USE_LARGEFILE64


157 
f˙é64
 (
__fd
, 
__cmd
, ...);

167 #i‚de‡
__USE_FILE_OFFSET64


168 
	$›í
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

170 #ifde‡
__REDIRECT


171 
	`__REDIRECT
 (
›í
, (c⁄° *
__fûe
, 
__oÊag
, ...), 
›í64
)

172 
	`__n⁄nuŒ
 ((1));

174 
	#›í
 
›í64


	)

177 #ifde‡
__USE_LARGEFILE64


178 
	$›í64
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

181 #ifde‡
__USE_ATFILE


191 #i‚de‡
__USE_FILE_OFFSET64


192 
	$›í©
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

193 
	`__n⁄nuŒ
 ((2));

195 #ifde‡
__REDIRECT


196 
	`__REDIRECT
 (
›í©
, (
__fd
, c⁄° *
__fûe
, 
__oÊag
,

197 ...), 
›í©64
Ë
	`__n⁄nuŒ
 ((2));

199 
	#›í©
 
›í©64


	)

202 #ifde‡
__USE_LARGEFILE64


203 
	$›í©64
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

204 
	`__n⁄nuŒ
 ((2));

213 #i‚de‡
__USE_FILE_OFFSET64


214 
	$¸ót
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

216 #ifde‡
__REDIRECT


217 
	`__REDIRECT
 (
¸ót
, (c⁄° *
__fûe
, 
mode_t
 
__mode
),

218 
¸ót64
Ë
	`__n⁄nuŒ
 ((1));

220 
	#¸ót
 
¸ót64


	)

223 #ifde‡
__USE_LARGEFILE64


224 
	$¸ót64
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

227 #i‡!
deföed
 
F_LOCK
 && (deföed 
__USE_MISC
 || (deföed 
__USE_XOPEN_EXTENDED
 \

228 && !
deföed
 
__USE_POSIX
))

237 
	#F_ULOCK
 0

	)

238 
	#F_LOCK
 1

	)

239 
	#F_TLOCK
 2

	)

240 
	#F_TEST
 3

	)

242 #i‚de‡
__USE_FILE_OFFSET64


243 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Àn
);

245 #ifde‡
__REDIRECT


246 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
), 
lockf64
);

248 
	#lockf
 
lockf64


	)

251 #ifde‡
__USE_LARGEFILE64


252 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Àn
);

256 #ifde‡
__USE_XOPEN2K


259 #i‚de‡
__USE_FILE_OFFSET64


260 
	$posix_Ádvi£
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
,

261 
__advi£
Ë
__THROW
;

263 #ifde‡
__REDIRECT_NTH


264 
	`__REDIRECT_NTH
 (
posix_Ádvi£
, (
__fd
, 
__off64_t
 
__off£t
,

265 
__off64_t
 
__Àn
, 
__advi£
),

266 
posix_Ádvi£64
);

268 
	#posix_Ádvi£
 
posix_Ádvi£64


	)

271 #ifde‡
__USE_LARGEFILE64


272 
	$posix_Ádvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
,

273 
__advi£
Ë
__THROW
;

281 #i‚de‡
__USE_FILE_OFFSET64


282 
	`posix_ÁŒoˇã
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
);

284 #ifde‡
__REDIRECT


285 
	`__REDIRECT
 (
posix_ÁŒoˇã
, (
__fd
, 
__off64_t
 
__off£t
,

286 
__off64_t
 
__Àn
),

287 
posix_ÁŒoˇã64
);

289 
	#posix_ÁŒoˇã
 
posix_ÁŒoˇã64


	)

292 #ifde‡
__USE_LARGEFILE64


293 
	`posix_ÁŒoˇã64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
);

299 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄
 \

300 && 
deföed
 
__va_¨g_∑ck_Àn


301 
	~<bôs/f˙é2.h
>

304 
__END_DECLS


	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

119 #unde‡
__USE_ISOC11


120 #unde‡
__USE_ISOC99


121 #unde‡
__USE_ISOC95


122 #unde‡
__USE_ISOCXX11


123 #unde‡
__USE_POSIX


124 #unde‡
__USE_POSIX2


125 #unde‡
__USE_POSIX199309


126 #unde‡
__USE_POSIX199506


127 #unde‡
__USE_XOPEN


128 #unde‡
__USE_XOPEN_EXTENDED


129 #unde‡
__USE_UNIX98


130 #unde‡
__USE_XOPEN2K


131 #unde‡
__USE_XOPEN2KXSI


132 #unde‡
__USE_XOPEN2K8


133 #unde‡
__USE_XOPEN2K8XSI


134 #unde‡
__USE_LARGEFILE


135 #unde‡
__USE_LARGEFILE64


136 #unde‡
__USE_FILE_OFFSET64


137 #unde‡
__USE_MISC


138 #unde‡
__USE_ATFILE


139 #unde‡
__USE_GNU


140 #unde‡
__USE_FORTIFY_LEVEL


141 #unde‡
__KERNEL_STRICT_NAMES


142 #unde‡
__GLIBC_USE_DEPRECATED_GETS


146 #i‚de‡
_LOOSE_KERNEL_NAMES


147 
	#__KERNEL_STRICT_NAMES


	)

157 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


158 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

159 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

161 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

168 #i‡
deföed
 
__˛™g_maj‹__
 && deföed 
__˛™g_mö‹__


169 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
) \

170 ((
__˛™g_maj‹__
 << 16Ë+ 
__˛™g_mö‹__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

172 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
Ë0

	)

176 
	#__GLIBC_USE
(
F
Ë
__GLIBC_USE_
 ## 
	)
F

182 #i‡(
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE
) \

183 && !
deföed
 
	g_DEFAULT_SOURCE


185 #unde‡
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

190 #ifde‡
_GNU_SOURCE


191 #unde‡
_ISOC95_SOURCE


192 
	#_ISOC95_SOURCE
 1

	)

193 #unde‡
_ISOC99_SOURCE


194 
	#_ISOC99_SOURCE
 1

	)

195 #unde‡
_ISOC11_SOURCE


196 
	#_ISOC11_SOURCE
 1

	)

197 #unde‡
_POSIX_SOURCE


198 
	#_POSIX_SOURCE
 1

	)

199 #unde‡
_POSIX_C_SOURCE


200 
	#_POSIX_C_SOURCE
 200809L

	)

201 #unde‡
_XOPEN_SOURCE


202 
	#_XOPEN_SOURCE
 700

	)

203 #unde‡
_XOPEN_SOURCE_EXTENDED


204 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

205 #unde‡
_LARGEFILE64_SOURCE


206 
	#_LARGEFILE64_SOURCE
 1

	)

207 #unde‡
_DEFAULT_SOURCE


208 
	#_DEFAULT_SOURCE
 1

	)

209 #unde‡
_ATFILE_SOURCE


210 
	#_ATFILE_SOURCE
 1

	)

215 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

216 || (!
deföed
 
	g__STRICT_ANSI__
 \

217 && !
deföed
 
	g_ISOC99_SOURCE
 && !deföed 
	g_ISOC11_SOURCE
 \

218 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

219 && !
deföed
 
	g_XOPEN_SOURCE
))

220 #unde‡
_DEFAULT_SOURCE


221 
	#_DEFAULT_SOURCE
 1

	)

225 #i‡(
deföed
 
_ISOC11_SOURCE
 \

226 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

227 
	#__USE_ISOC11
 1

	)

231 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

232 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

233 
	#__USE_ISOC99
 1

	)

237 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

238 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

239 
	#__USE_ISOC95
 1

	)

242 #ifde‡
__˝lu•lus


244 #i‡
__˝lu•lus
 >= 201703L

245 
	#__USE_ISOC11
 1

	)

249 #i‡
__˝lu•lus
 >201103L || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__


250 
	#__USE_ISOCXX11
 1

	)

251 
	#__USE_ISOC99
 1

	)

258 #ifde‡
_DEFAULT_SOURCE


259 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


260 
	#__USE_POSIX_IMPLICITLY
 1

	)

262 #unde‡
_POSIX_SOURCE


263 
	#_POSIX_SOURCE
 1

	)

264 #unde‡
_POSIX_C_SOURCE


265 
	#_POSIX_C_SOURCE
 200809L

	)

268 #i‡((!
deföed
 
__STRICT_ANSI__
 \

269 || (
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

270 && !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

271 
	#_POSIX_SOURCE
 1

	)

272 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

273 
	#_POSIX_C_SOURCE
 2

	)

274 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

275 
	#_POSIX_C_SOURCE
 199506L

	)

276 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

277 
	#_POSIX_C_SOURCE
 200112L

	)

279 
	#_POSIX_C_SOURCE
 200809L

	)

281 
	#__USE_POSIX_IMPLICITLY
 1

	)

290 #i‡((!
deföed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

291 && (
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE
))

292 
	#_POSIX_SOURCE
 1

	)

293 #unde‡
_POSIX_C_SOURCE


294 
	#_POSIX_C_SOURCE
 199506L

	)

297 #i‡(
deföed
 
_POSIX_SOURCE
 \

298 || (
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

299 || 
deföed
 
_XOPEN_SOURCE
)

300 
	#__USE_POSIX
 1

	)

303 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


304 
	#__USE_POSIX2
 1

	)

307 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

308 
	#__USE_POSIX199309
 1

	)

311 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

312 
	#__USE_POSIX199506
 1

	)

315 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

316 
	#__USE_XOPEN2K
 1

	)

317 #unde‡
__USE_ISOC95


318 
	#__USE_ISOC95
 1

	)

319 #unde‡
__USE_ISOC99


320 
	#__USE_ISOC99
 1

	)

323 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

324 
	#__USE_XOPEN2K8
 1

	)

325 #unde‡
_ATFILE_SOURCE


326 
	#_ATFILE_SOURCE
 1

	)

329 #ifdef 
_XOPEN_SOURCE


330 
	#__USE_XOPEN
 1

	)

331 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

332 
	#__USE_XOPEN_EXTENDED
 1

	)

333 
	#__USE_UNIX98
 1

	)

334 #unde‡
_LARGEFILE_SOURCE


335 
	#_LARGEFILE_SOURCE
 1

	)

336 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

337 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

338 
	#__USE_XOPEN2K8
 1

	)

339 
	#__USE_XOPEN2K8XSI
 1

	)

341 
	#__USE_XOPEN2K
 1

	)

342 
	#__USE_XOPEN2KXSI
 1

	)

343 #unde‡
__USE_ISOC95


344 
	#__USE_ISOC95
 1

	)

345 #unde‡
__USE_ISOC99


346 
	#__USE_ISOC99
 1

	)

349 #ifde‡
_XOPEN_SOURCE_EXTENDED


350 
	#__USE_XOPEN_EXTENDED
 1

	)

355 #ifde‡
_LARGEFILE_SOURCE


356 
	#__USE_LARGEFILE
 1

	)

359 #ifde‡
_LARGEFILE64_SOURCE


360 
	#__USE_LARGEFILE64
 1

	)

363 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

364 
	#__USE_FILE_OFFSET64
 1

	)

367 #i‡
deföed
 
_DEFAULT_SOURCE


368 
	#__USE_MISC
 1

	)

371 #ifdef 
_ATFILE_SOURCE


372 
	#__USE_ATFILE
 1

	)

375 #ifdef 
_GNU_SOURCE


376 
	#__USE_GNU
 1

	)

379 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

380 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

381 #i‡
_FORTIFY_SOURCE
 > 1

382 
	#__USE_FORTIFY_LEVEL
 2

	)

384 
	#__USE_FORTIFY_LEVEL
 1

	)

387 
	#__USE_FORTIFY_LEVEL
 0

	)

394 #i‡
deföed
 
__˝lu•lus
 ? __˝lu•lu†>201402L : deföed 
__USE_ISOC11


395 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

397 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

402 
	~<°dc-¥edef.h
>

410 #unde‡
__GNU_LIBRARY__


411 
	#__GNU_LIBRARY__
 6

	)

415 
	#__GLIBC__
 2

	)

416 
	#__GLIBC_MINOR__
 28

	)

418 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

419 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

422 #i‚de‡
__ASSEMBLER__


423 #i‚de‡
_SYS_CDEFS_H


424 
	~<sys/cdefs.h
>

429 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


430 
	#__USE_LARGEFILE
 1

	)

431 
	#__USE_LARGEFILE64
 1

	)

437 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

438 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

439 && 
deföed
 
	g__exã∫_ölöe


440 
	#__USE_EXTERN_INLINES
 1

	)

448 
	~<gnu/°ubs.h
>

	@/usr/include/inttypes.h

22 #i‚de‡
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<°döt.h
>

30 #i‚de‡
____gwch¨_t_deföed


31 #ifde‡
__˝lu•lus


32 
	#__gwch¨_t
 
wch¨_t


	)

33 #ñi‡
deföed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¨_t
;

36 
	#__√ed_wch¨_t


	)

37 
	~<°ddef.h
>

38 
wch¨_t
 
	t__gwch¨_t
;

40 
	#____gwch¨_t_deföed
 1

	)

43 #i‡
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Œ"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #i‡
__WORDSIZE
 == 64

273 
	mquŸ
;

274 
	mªm
;

275 } 
	timaxdiv_t
;

282 
__exãnsi⁄__
 
	mquŸ
;

283 
__exãnsi⁄__
 
	mªm
;

284 } 
	timaxdiv_t
;

290 
ötmax_t
 
	$imaxabs
 (
ötmax_t
 
__n
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
ötmax_t
 
__numî
, i¡max_à
__díom
)

294 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

297 
ötmax_t
 
	$°πoimax
 (c⁄° *
__ª°ri˘
 
__≈å
,

298 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

301 
uötmax_t
 
	$°πoumax
 (c⁄° *
__ª°ri˘
 
__≈å
,

302 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

305 
ötmax_t
 
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

306 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

307 
__THROW
;

310 
uötmax_t
 
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

311 
__gwch¨_t
 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
)

312 
__THROW
;

314 #ifde‡
__USE_EXTERN_INLINES


316 #i‡
__WORDSIZE
 == 64

318 
	$__°πﬁ_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

319 **
__ª°ri˘
 
__íd±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

323 
__exã∫_ölöe
 
ötmax_t


324 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

325 
ba£
))

327  
	`__°πﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

328 
	}
}

330 
	$__°πoul_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

331 ** 
__ª°ri˘
 
__íd±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

335 
__exã∫_ölöe
 
uötmax_t


336 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

337 
ba£
))

339  
	`__°πoul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc°ﬁ_öã∫Æ
 (c⁄° 
__gwch¨_t
 * 
__ª°ri˘
 
__≈å
,

343 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

347 
__exã∫_ölöe
 
ötmax_t


348 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

349 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

351  
	`__wc°ﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc°oul_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

355 
__ª°ri˘
 
__≈å
,

356 
__gwch¨_t
 **

357 
__ª°ri˘
 
__íd±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

361 
__exã∫_ölöe
 
uötmax_t


362 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

363 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

365  
	`__wc°oul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

366 
	}
}

370 
__exãnsi⁄__


371 
	$__°πﬁl_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

372 **
__ª°ri˘
 
__íd±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

376 
__exã∫_ölöe
 
ötmax_t


377 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

378 
ba£
))

380  
	`__°πﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

381 
	}
}

383 
__exãnsi⁄__


384 
	$__°πouŒ_öã∫Æ
 (const *

385 
__ª°ri˘
 
__≈å
,

387 
__ª°ri˘
 
__íd±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

392 
__exã∫_ölöe
 
uötmax_t


393 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

394 
ba£
))

396  
	`__°πouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

397 
	}
}

399 
__exãnsi⁄__


400 
	$__wc°ﬁl_öã∫Æ
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

401 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

405 
__exã∫_ölöe
 
ötmax_t


406 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

407 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

409  
	`__wc°ﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

410 
	}
}

413 
__exãnsi⁄__


414 
	$__wc°ouŒ_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

415 
__ª°ri˘
 
__≈å
,

416 
__gwch¨_t
 **

417 
__ª°ri˘
 
__íd±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

422 
__exã∫_ölöe
 
uötmax_t


423 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

424 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

426  
	`__wc°ouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/limits.h

22 #i‚de‡
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<bôs/libc-hódî-°¨t.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

42 #i‚de‡
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<bôs/w‹dsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifde‡
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #i‡
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #i‡
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifde‡
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #i‡
deföed
 
__GNUC__
 && !deföed 
_GCC_LIMITS_H_


124 #ö˛ude_√xà<
limôs
.
h
>

130 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__


131 #i‚de‡
LLONG_MIN


132 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

134 #i‚de‡
LLONG_MAX


135 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

137 #i‚de‡
ULLONG_MAX


138 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

145 #i‡
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

146 #i‚de‡
CHAR_WIDTH


147 
	#CHAR_WIDTH
 8

	)

149 #i‚de‡
SCHAR_WIDTH


150 
	#SCHAR_WIDTH
 8

	)

152 #i‚de‡
UCHAR_WIDTH


153 
	#UCHAR_WIDTH
 8

	)

155 #i‚de‡
SHRT_WIDTH


156 
	#SHRT_WIDTH
 16

	)

158 #i‚de‡
USHRT_WIDTH


159 
	#USHRT_WIDTH
 16

	)

161 #i‚de‡
INT_WIDTH


162 
	#INT_WIDTH
 32

	)

164 #i‚de‡
UINT_WIDTH


165 
	#UINT_WIDTH
 32

	)

167 #i‚de‡
LONG_WIDTH


168 
	#LONG_WIDTH
 
__WORDSIZE


	)

170 #i‚de‡
ULONG_WIDTH


171 
	#ULONG_WIDTH
 
__WORDSIZE


	)

173 #i‚de‡
LLONG_WIDTH


174 
	#LLONG_WIDTH
 64

	)

176 #i‚de‡
ULLONG_WIDTH


177 
	#ULLONG_WIDTH
 64

	)

181 #ifdef 
__USE_POSIX


183 
	~<bôs/posix1_lim.h
>

186 #ifdef 
__USE_POSIX2


187 
	~<bôs/posix2_lim.h
>

190 #ifdef 
__USE_XOPEN


191 
	~<bôs/x›í_lim.h
>

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 267126

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
Ë((◊Ë<< 16Ë+ ((bË<< 8Ë+ (c))

	)

	@/usr/include/locale.h

22 #i‚def 
_LOCALE_H


23 
	#_LOCALE_H
 1

	)

25 
	~<„©uªs.h
>

27 
	#__√ed_NULL


	)

28 
	~<°ddef.h
>

29 
	~<bôs/loˇÀ.h
>

31 
	g__BEGIN_DECLS


35 
	#LC_CTYPE
 
__LC_CTYPE


	)

36 
	#LC_NUMERIC
 
__LC_NUMERIC


	)

37 
	#LC_TIME
 
__LC_TIME


	)

38 
	#LC_COLLATE
 
__LC_COLLATE


	)

39 
	#LC_MONETARY
 
__LC_MONETARY


	)

40 
	#LC_MESSAGES
 
__LC_MESSAGES


	)

41 
	#LC_ALL
 
__LC_ALL


	)

42 
	#LC_PAPER
 
__LC_PAPER


	)

43 
	#LC_NAME
 
__LC_NAME


	)

44 
	#LC_ADDRESS
 
__LC_ADDRESS


	)

45 
	#LC_TELEPHONE
 
__LC_TELEPHONE


	)

46 
	#LC_MEASUREMENT
 
__LC_MEASUREMENT


	)

47 
	#LC_IDENTIFICATION
 
__LC_IDENTIFICATION


	)

51 
	slc⁄v


55 *
	mdecimÆ_poöt
;

56 *
	mthoußnds_£p
;

62 *
	mgroupög
;

68 *
	möt_cuº_symbﬁ
;

69 *
	mcuºícy_symbﬁ
;

70 *
	mm⁄_decimÆ_poöt
;

71 *
	mm⁄_thoußnds_£p
;

72 *
	mm⁄_groupög
;

73 *
	mposôive_sign
;

74 *
	m√g©ive_sign
;

75 
	möt_‰ac_digôs
;

76 
	m‰ac_digôs
;

78 
	mp_cs_¥e˚des
;

80 
	mp_£p_by_•a˚
;

82 
	mn_cs_¥e˚des
;

84 
	mn_£p_by_•a˚
;

91 
	mp_sign_po¢
;

92 
	mn_sign_po¢
;

93 #ifde‡
__USE_ISOC99


95 
	möt_p_cs_¥e˚des
;

97 
	möt_p_£p_by_•a˚
;

99 
	möt_n_cs_¥e˚des
;

101 
	möt_n_£p_by_•a˚
;

108 
	möt_p_sign_po¢
;

109 
	möt_n_sign_po¢
;

111 
	m__öt_p_cs_¥e˚des
;

112 
	m__öt_p_£p_by_•a˚
;

113 
	m__öt_n_cs_¥e˚des
;

114 
	m__öt_n_£p_by_•a˚
;

115 
	m__öt_p_sign_po¢
;

116 
	m__öt_n_sign_po¢
;

122 *
	$£éoˇÀ
 (
__ˇãg‹y
, c⁄° *
__loˇÀ
Ë
__THROW
;

125 
lc⁄v
 *
	$loˇÀc⁄v
 (Ë
__THROW
;

128 #ifdef 
__USE_XOPEN2K8


135 
	~<bôs/ty≥s/loˇÀ_t.h
>

141 
loˇÀ_t
 
	$√wloˇÀ
 (
__ˇãg‹y_mask
, c⁄° *
__loˇÀ
,

142 
loˇÀ_t
 
__ba£
Ë
__THROW
;

148 
	#LC_CTYPE_MASK
 (1 << 
__LC_CTYPE
)

	)

149 
	#LC_NUMERIC_MASK
 (1 << 
__LC_NUMERIC
)

	)

150 
	#LC_TIME_MASK
 (1 << 
__LC_TIME
)

	)

151 
	#LC_COLLATE_MASK
 (1 << 
__LC_COLLATE
)

	)

152 
	#LC_MONETARY_MASK
 (1 << 
__LC_MONETARY
)

	)

153 
	#LC_MESSAGES_MASK
 (1 << 
__LC_MESSAGES
)

	)

154 
	#LC_PAPER_MASK
 (1 << 
__LC_PAPER
)

	)

155 
	#LC_NAME_MASK
 (1 << 
__LC_NAME
)

	)

156 
	#LC_ADDRESS_MASK
 (1 << 
__LC_ADDRESS
)

	)

157 
	#LC_TELEPHONE_MASK
 (1 << 
__LC_TELEPHONE
)

	)

158 
	#LC_MEASUREMENT_MASK
 (1 << 
__LC_MEASUREMENT
)

	)

159 
	#LC_IDENTIFICATION_MASK
 (1 << 
__LC_IDENTIFICATION
)

	)

160 
	#LC_ALL_MASK
 (
LC_CTYPE_MASK
 \

161 | 
LC_NUMERIC_MASK
 \

162 | 
LC_TIME_MASK
 \

163 | 
LC_COLLATE_MASK
 \

164 | 
LC_MONETARY_MASK
 \

165 | 
LC_MESSAGES_MASK
 \

166 | 
LC_PAPER_MASK
 \

167 | 
LC_NAME_MASK
 \

168 | 
LC_ADDRESS_MASK
 \

169 | 
LC_TELEPHONE_MASK
 \

170 | 
LC_MEASUREMENT_MASK
 \

171 | 
LC_IDENTIFICATION_MASK
 \

172 )

	)

176 
loˇÀ_t
 
	$du∂oˇÀ
 (
loˇÀ_t
 
__d©a£t
Ë
__THROW
;

180 
	$‰ìloˇÀ
 (
loˇÀ_t
 
__d©a£t
Ë
__THROW
;

187 
loˇÀ_t
 
	$u£loˇÀ
 (
loˇÀ_t
 
__d©a£t
Ë
__THROW
;

191 
	#LC_GLOBAL_LOCALE
 ((
loˇÀ_t
Ë-1L)

	)

195 
__END_DECLS


	@/usr/include/malloc.h

19 #i‚de‡
_MALLOC_H


20 
	#_MALLOC_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<°ddef.h
>

24 
	~<°dio.h
>

26 #ifde‡
_LIBC


27 
	#__MALLOC_HOOK_VOLATILE


	)

28 
	#__MALLOC_DEPRECATED


	)

30 
	#__MALLOC_HOOK_VOLATILE
 vﬁ©ûe

	)

31 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

35 
__BEGIN_DECLS


38 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

41 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

42 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

49 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

50 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

57 *
	$ªÆloˇºay
 (*
__±r
, 
size_t
 
__nmemb
, size_à
__size
)

58 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

61 
	$‰ì
 (*
__±r
Ë
__THROW
;

64 *
	$memÆign
 (
size_t
 
__Æignmít
, size_à
__size
)

65 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

68 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

72 *
	$pvÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

76 *(*
__m‹ec‹e
Ë(
±rdiff_t
 
__size
);

79 *
	$__deÁu…_m‹ec‹e
 (
±rdiff_t
 
__size
)

80 
__THROW
 
__©åibuã_mÆloc__
;

84 
	smÆlöfo


86 
¨ía
;

87 
‹dblks
;

88 
smblks
;

89 
hblks
;

90 
hblkhd
;

91 
usmblks
;

92 
fsmblks
;

93 
u‹dblks
;

94 
f‹dblks
;

95 
kìpco°
;

99 
mÆlöfo
 
	$mÆlöfo
 (Ë
__THROW
;

102 #i‚de‡
M_MXFAST


103 
	#M_MXFAST
 1

	)

105 #i‚de‡
M_NLBLKS


106 
	#M_NLBLKS
 2

	)

108 #i‚de‡
M_GRAIN


109 
	#M_GRAIN
 3

	)

111 #i‚de‡
M_KEEP


112 
	#M_KEEP
 4

	)

116 
	#M_TRIM_THRESHOLD
 -1

	)

117 
	#M_TOP_PAD
 -2

	)

118 
	#M_MMAP_THRESHOLD
 -3

	)

119 
	#M_MMAP_MAX
 -4

	)

120 
	#M_CHECK_ACTION
 -5

	)

121 
	#M_PERTURB
 -6

	)

122 
	#M_ARENA_TEST
 -7

	)

123 
	#M_ARENA_MAX
 -8

	)

126 
	$mÆl›t
 (
__∑øm
, 
__vÆ
Ë
__THROW
;

130 
	$mÆloc_åim
 (
size_t
 
__∑d
Ë
__THROW
;

134 
size_t
 
	$mÆloc_ußbÀ_size
 (*
__±r
Ë
__THROW
;

137 
	$mÆloc_°©s
 (Ë
__THROW
;

140 
	$mÆloc_öfo
 (
__›ti⁄s
, 
FILE
 *
__Â
Ë
__THROW
;

143 (*
__MALLOC_HOOK_VOLATILE
 
__‰ì_hook
Ë(*
__±r
,

145 
__MALLOC_DEPRECATED
;

146 *(*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_hook
)(
size_t
 
__size
,

148 
__MALLOC_DEPRECATED
;

149 *(*
__MALLOC_HOOK_VOLATILE
 
__ªÆloc_hook
)(*
__±r
,

150 
size_t
 
__size
,

152 
__MALLOC_DEPRECATED
;

153 *(*
__MALLOC_HOOK_VOLATILE
 
__memÆign_hook
)(
size_t
 
__Æignmít
,

154 
size_t
 
__size
,

156 
__MALLOC_DEPRECATED
;

157 (*
__MALLOC_HOOK_VOLATILE
 
__a·î_m‹ec‹e_hook
) ();

160 
	$__mÆloc_check_öô
 (Ë
__THROW
 
__MALLOC_DEPRECATED
;

163 
__END_DECLS


	@/usr/include/math.h

23 #i‚def 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<bôs/libc-hódî-°¨t.h
>

29 #i‡
deföed
 
log
 && deföed 
__GNUC__


30 #w¨nög 
A
 
ma¸o
 
ˇŒed
 
log
 
was
 
Æªady
 
deföed
 
whí
 <
m©h
.
h
> wa†
ö˛uded
.

31 #w¨nög 
This
 
wûl
 
ˇu£
 
compû©i⁄
 
¥obÀms
.

34 
	g__BEGIN_DECLS


37 
	~<bôs/ty≥s.h
>

40 
	~<bôs/m©h-ve˘‹.h
>

43 
	~<bôs/Êﬂä.h
>

47 #i‡
__GNUC_PREREQ
 (3, 3)

48 
	#HUGE_VAL
 (
	`__buûtö_huge_vÆ
 ())

	)

55 
	#HUGE_VAL
 1e10000

	)

57 #ifde‡
__USE_ISOC99


58 #i‡
__GNUC_PREREQ
 (3, 3)

59 
	#HUGE_VALF
 (
	`__buûtö_huge_vÆf
 ())

	)

60 
	#HUGE_VALL
 (
	`__buûtö_huge_vÆl
 ())

	)

62 
	#HUGE_VALF
 1e10000f

	)

63 
	#HUGE_VALL
 1e10000L

	)

66 #i‡
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

67 
	#HUGE_VAL_F16
 (
	`__buûtö_huge_vÆf16
 ())

	)

69 #i‡
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

70 
	#HUGE_VAL_F32
 (
	`__buûtö_huge_vÆf32
 ())

	)

72 #i‡
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

73 
	#HUGE_VAL_F64
 (
	`__buûtö_huge_vÆf64
 ())

	)

75 #i‡
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

76 
	#HUGE_VAL_F128
 (
	`__buûtö_huge_vÆf128
 ())

	)

78 #i‡
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

79 
	#HUGE_VAL_F32X
 (
	`__buûtö_huge_vÆf32x
 ())

	)

81 #i‡
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

82 
	#HUGE_VAL_F64X
 (
	`__buûtö_huge_vÆf64x
 ())

	)

84 #i‡
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

85 
	#HUGE_VAL_F128X
 (
	`__buûtö_huge_vÆf128x
 ())

	)

88 #ifde‡
__USE_ISOC99


90 #i‡
__GNUC_PREREQ
 (3, 3)

91 
	#INFINITY
 (
	`__buûtö_öff
 ())

	)

93 
	#INFINITY
 
HUGE_VALF


	)

97 #i‡
__GNUC_PREREQ
 (3, 3)

98 
	#NAN
 (
	`__buûtö_«nf
 (""))

	)

103 
	#NAN
 (0.0‡/ 0.0f)

	)

107 #i‡
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

109 #i‡
__GNUC_PREREQ
 (3, 3)

110 
	#SNANF
 (
	`__buûtö_«nsf
 (""))

	)

111 
	#SNAN
 (
	`__buûtö_«ns
 (""))

	)

112 
	#SNANL
 (
	`__buûtö_«n¶
 (""))

	)

115 #i‡
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

116 
	#SNANF16
 (
	`__buûtö_«nsf16
 (""))

	)

118 #i‡
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

119 
	#SNANF32
 (
	`__buûtö_«nsf32
 (""))

	)

121 #i‡
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

122 
	#SNANF64
 (
	`__buûtö_«nsf64
 (""))

	)

124 #i‡
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

125 
	#SNANF128
 (
	`__buûtö_«nsf128
 (""))

	)

127 #i‡
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

128 
	#SNANF32X
 (
	`__buûtö_«nsf32x
 (""))

	)

130 #i‡
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

131 
	#SNANF64X
 (
	`__buûtö_«nsf64x
 (""))

	)

133 #i‡
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
	#SNANF128X
 (
	`__buûtö_«nsf128x
 (""))

	)

138 
	~<bôs/Êt-evÆ-mëhod.h
>

140 #ifde‡
__USE_ISOC99


148 #i‡
__GLIBC_FLT_EVAL_METHOD
 == 0 || __GLIBC_FLT_EVAL_METHOD == 16

149 
	tÊﬂt_t
;

150 
	tdoubÀ_t
;

151 #ñi‡
__GLIBC_FLT_EVAL_METHOD
 == 1

152 
	tÊﬂt_t
;

153 
	tdoubÀ_t
;

154 #ñi‡
__GLIBC_FLT_EVAL_METHOD
 == 2

155 
	tÊﬂt_t
;

156 
	tdoubÀ_t
;

157 #ñi‡
__GLIBC_FLT_EVAL_METHOD
 == 32

158 
_Flﬂt32
 
	tÊﬂt_t
;

159 
	tdoubÀ_t
;

160 #ñi‡
__GLIBC_FLT_EVAL_METHOD
 == 33

161 
_Flﬂt32x
 
	tÊﬂt_t
;

162 
_Flﬂt32x
 
	tdoubÀ_t
;

163 #ñi‡
__GLIBC_FLT_EVAL_METHOD
 == 64

164 
_Flﬂt64
 
	tÊﬂt_t
;

165 
_Flﬂt64
 
	tdoubÀ_t
;

166 #ñi‡
__GLIBC_FLT_EVAL_METHOD
 == 65

167 
_Flﬂt64x
 
	tÊﬂt_t
;

168 
_Flﬂt64x
 
	tdoubÀ_t
;

169 #ñi‡
__GLIBC_FLT_EVAL_METHOD
 == 128

170 
_Flﬂt128
 
	tÊﬂt_t
;

171 
_Flﬂt128
 
	tdoubÀ_t
;

172 #ñi‡
__GLIBC_FLT_EVAL_METHOD
 == 129

173 
_Flﬂt128x
 
	tÊﬂt_t
;

174 
_Flﬂt128x
 
	tdoubÀ_t
;

190 
	~<bôs/Â-logb.h
>

191 #ifde‡
__USE_ISOC99


192 #i‡
__FP_LOGB0_IS_MIN


193 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

195 
	#FP_ILOGB0
 (-2147483647)

	)

197 #i‡
__FP_LOGBNAN_IS_MIN


198 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

200 
	#FP_ILOGBNAN
 2147483647

	)

203 #i‡
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

204 #i‡
__WORDSIZE
 == 32

205 
	#__FP_LONG_MAX
 0x7fffffffL

	)

207 
	#__FP_LONG_MAX
 0x7fffffffffffffffL

	)

209 #i‡
__FP_LOGB0_IS_MIN


210 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
 - 1)

	)

212 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
)

	)

214 #i‡
__FP_LOGBNAN_IS_MIN


215 
	#FP_LLOGBNAN
 (-
__FP_LONG_MAX
 - 1)

	)

217 
	#FP_LLOGBNAN
 
__FP_LONG_MAX


	)

233 
	~<bôs/Â-Á°.h
>

235 #i‡
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

239 
	mFP_INT_UPWARD
 =

240 
	#FP_INT_UPWARD
 0

	)

241 
FP_INT_UPWARD
,

242 
	mFP_INT_DOWNWARD
 =

243 
	#FP_INT_DOWNWARD
 1

	)

244 
FP_INT_DOWNWARD
,

245 
	mFP_INT_TOWARDZERO
 =

246 
	#FP_INT_TOWARDZERO
 2

	)

247 
FP_INT_TOWARDZERO
,

248 
	mFP_INT_TONEARESTFROMZERO
 =

249 
	#FP_INT_TONEARESTFROMZERO
 3

	)

250 
FP_INT_TONEARESTFROMZERO
,

251 
	mFP_INT_TONEAREST
 =

252 
	#FP_INT_TONEAREST
 4

	)

253 
FP_INT_TONEAREST
,

262 
	#__SIMD_DECL
(
fun˘i⁄
Ë
	`__CONCAT
 (
__DECL_SIMD_
, fun˘i⁄)

	)

264 
	#__MATHCALL_VEC
(
fun˘i⁄
, 
suffix
, 
¨gs
) \

265 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
fun˘i⁄
, 
suffix
)) \

266 
	`__MATHCALL
 (
fun˘i⁄
, 
suffix
, 
¨gs
)

	)

268 
	#__MATHDECL_VEC
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

269 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
fun˘i⁄
, 
suffix
)) \

270 
	`__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
)

	)

272 
	#__MATHCALL
(
fun˘i⁄
,
suffix
, 
¨gs
) \

273 
	`__MATHDECL
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
)

	)

274 
	#__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

275 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
); \

276 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
)

	)

277 
	#__MATHCALLX
(
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

278 
	`__MATHDECLX
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
)

	)

279 
	#__MATHDECLX
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

280 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
); \

281 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
)

	)

282 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

283 
ty≥
 
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
Ë
¨gs
 
__THROW


	)

285 
	#_MdoubÀ_
 

	)

286 
	#__MATH_PRECNAME
(
«me
,
r
Ë
	`__CONCAT
“ame,r)

	)

287 
	#__MATH_DECLARING_DOUBLE
 1

	)

288 
	#__MATH_DECLARING_FLOATN
 0

	)

289 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

290 
	~<bôs/m©hˇŒs.h
>

291 #unde‡
_MdoubÀ_


292 #unde‡
__MATH_PRECNAME


293 #unde‡
__MATH_DECLARING_DOUBLE


294 #unde‡
__MATH_DECLARING_FLOATN


296 #ifde‡
__USE_ISOC99


302 
	#_MdoubÀ_
 

	)

303 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f
##
	)
r

304 
	#__MATH_DECLARING_DOUBLE
 0

	)

305 
	#__MATH_DECLARING_FLOATN
 0

	)

306 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

307 
	~<bôs/m©hˇŒs.h
>

308 #unde‡
_MdoubÀ_


309 #unde‡
__MATH_PRECNAME


310 #unde‡
__MATH_DECLARING_DOUBLE


311 #unde‡
__MATH_DECLARING_FLOATN


313 #i‡!(
deföed
 
__NO_LONG_DOUBLE_MATH
 && deföed 
_LIBC
) \

314 || 
deföed
 
__LDBL_COMPAT
 \

315 || 
deföed
 
_LIBC_TEST


316 #ifde‡
__LDBL_COMPAT


318 #ifde‡
__USE_ISOC99


319 
	$__∆dbl_√xâow¨df
 (
__x
, 
__y
)

320 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

321 #ifde‡
__REDIRECT_NTH


322 
	`__REDIRECT_NTH
 (
√xâow¨df
, (
__x
, 
__y
),

323 
__∆dbl_√xâow¨df
)

324 
	`__©åibuã__
 ((
__c⁄°__
));

325 
	`__REDIRECT_NTH
 (
√xâow¨d
, (
__x
, 
__y
),

326 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

327 
	`__REDIRECT_NTH
 (
√xâow¨dl
,

328 (
__x
, 
__y
),

329 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

333 #unde‡
__MATHDECL_1


334 
	#__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
Æüs
) \

335 
ty≥
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
), \

336 
¨gs
, 
Æüs
)

	)

337 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

338 
	`__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
	`__CONCAT
(fun˘i⁄,suffix))

	)

344 
	#_MdoubÀ_
 

	)

345 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
l
##
	)
r

346 
	#__MATH_DECLARING_DOUBLE
 0

	)

347 
	#__MATH_DECLARING_FLOATN
 0

	)

348 
	#__MATH_DECLARE_LDOUBLE
 1

	)

349 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

350 
	~<bôs/m©hˇŒs.h
>

351 #unde‡
_MdoubÀ_


352 #unde‡
__MATH_PRECNAME


353 #unde‡
__MATH_DECLARING_DOUBLE


354 #unde‡
__MATH_DECLARING_FLOATN


363 #i‡
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
deföed
 
_LIBC
)

364 
	#_MdoubÀ_
 
_Flﬂt16


	)

365 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f16
##
	)
r

366 
	#__MATH_DECLARING_DOUBLE
 0

	)

367 
	#__MATH_DECLARING_FLOATN
 1

	)

368 #i‡
__HAVE_DISTINCT_FLOAT16


369 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

371 #i‡
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

372 
	~<bôs/m©hˇŒs.h
>

374 #unde‡
_MdoubÀ_


375 #unde‡
__MATH_PRECNAME


376 #unde‡
__MATH_DECLARING_DOUBLE


377 #unde‡
__MATH_DECLARING_FLOATN


380 #i‡
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
deföed
 
_LIBC
)

381 
	#_MdoubÀ_
 
_Flﬂt32


	)

382 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f32
##
	)
r

383 
	#__MATH_DECLARING_DOUBLE
 0

	)

384 
	#__MATH_DECLARING_FLOATN
 1

	)

385 #i‡
__HAVE_DISTINCT_FLOAT32


386 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

388 #i‡
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

389 
	~<bôs/m©hˇŒs.h
>

391 #unde‡
_MdoubÀ_


392 #unde‡
__MATH_PRECNAME


393 #unde‡
__MATH_DECLARING_DOUBLE


394 #unde‡
__MATH_DECLARING_FLOATN


397 #i‡
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
deföed
 
_LIBC
)

398 
	#_MdoubÀ_
 
_Flﬂt64


	)

399 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f64
##
	)
r

400 
	#__MATH_DECLARING_DOUBLE
 0

	)

401 
	#__MATH_DECLARING_FLOATN
 1

	)

402 #i‡
__HAVE_DISTINCT_FLOAT64


403 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

405 #i‡
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

406 
	~<bôs/m©hˇŒs.h
>

408 #unde‡
_MdoubÀ_


409 #unde‡
__MATH_PRECNAME


410 #unde‡
__MATH_DECLARING_DOUBLE


411 #unde‡
__MATH_DECLARING_FLOATN


414 #i‡
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
deföed
 
_LIBC
)

415 
	#_MdoubÀ_
 
_Flﬂt128


	)

416 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f128
##
	)
r

417 
	#__MATH_DECLARING_DOUBLE
 0

	)

418 
	#__MATH_DECLARING_FLOATN
 1

	)

419 #i‡
__HAVE_DISTINCT_FLOAT128


420 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

422 #i‡
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

423 
	~<bôs/m©hˇŒs.h
>

425 #unde‡
_MdoubÀ_


426 #unde‡
__MATH_PRECNAME


427 #unde‡
__MATH_DECLARING_DOUBLE


428 #unde‡
__MATH_DECLARING_FLOATN


431 #i‡
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
deföed
 
_LIBC
)

432 
	#_MdoubÀ_
 
_Flﬂt32x


	)

433 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f32x
##
	)
r

434 
	#__MATH_DECLARING_DOUBLE
 0

	)

435 
	#__MATH_DECLARING_FLOATN
 1

	)

436 #i‡
__HAVE_DISTINCT_FLOAT32X


437 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

439 #i‡
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

440 
	~<bôs/m©hˇŒs.h
>

442 #unde‡
_MdoubÀ_


443 #unde‡
__MATH_PRECNAME


444 #unde‡
__MATH_DECLARING_DOUBLE


445 #unde‡
__MATH_DECLARING_FLOATN


448 #i‡
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
deföed
 
_LIBC
)

449 
	#_MdoubÀ_
 
_Flﬂt64x


	)

450 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f64x
##
	)
r

451 
	#__MATH_DECLARING_DOUBLE
 0

	)

452 
	#__MATH_DECLARING_FLOATN
 1

	)

453 #i‡
__HAVE_DISTINCT_FLOAT64X


454 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

456 #i‡
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

457 
	~<bôs/m©hˇŒs.h
>

459 #unde‡
_MdoubÀ_


460 #unde‡
__MATH_PRECNAME


461 #unde‡
__MATH_DECLARING_DOUBLE


462 #unde‡
__MATH_DECLARING_FLOATN


465 #i‡
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
deföed
 
_LIBC
)

466 
	#_MdoubÀ_
 
_Flﬂt128x


	)

467 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f128x
##
	)
r

468 
	#__MATH_DECLARING_DOUBLE
 0

	)

469 
	#__MATH_DECLARING_FLOATN
 1

	)

470 #i‡
__HAVE_DISTINCT_FLOAT128X


471 
	~<bôs/m©hˇŒs-hñ≥r-fun˘i⁄s.h
>

473 #i‡
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

474 
	~<bôs/m©hˇŒs.h
>

476 #unde‡
_MdoubÀ_


477 #unde‡
__MATH_PRECNAME


478 #unde‡
__MATH_DECLARING_DOUBLE


479 #unde‡
__MATH_DECLARING_FLOATN


482 #unde‡
__MATHDECL_1


483 #unde‡
__MATHDECL


484 #unde‡
__MATHCALL


487 
	#__MATHCALL_NARROW_ARGS_1
 (
_M¨g_
 
__x
)

	)

488 
	#__MATHCALL_NARROW_ARGS_2
 (
_M¨g_
 
__x
, _M¨g_ 
__y
)

	)

489 
	#__MATHCALL_NARROW_ARGS_3
 (
_M¨g_
 
__x
, _M¨g_ 
__y
, _M¨g_ 
__z
)

	)

490 
	#__MATHCALL_NARROW_NORMAL
(
func
, 
«rgs
) \

491 
_Mªt_
 
func
 
__MATHCALL_NARROW_ARGS_
 ## 
«rgs
 
__THROW


	)

492 
	#__MATHCALL_NARROW_REDIR
(
func
, 
ªdú
, 
«rgs
) \

493 
_Mªt_
 
	`__REDIRECT_NTH
 (
func
, 
__MATHCALL_NARROW_ARGS_
 ## 
«rgs
, \

494 
ªdú
)

	)

495 
	#__MATHCALL_NARROW
(
func
, 
ªdú
, 
«rgs
) \

496 
	`__MATHCALL_NARROW_NORMAL
 (
func
, 
«rgs
)

	)

498 #i‡
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

500 
	#_Mªt_
 

	)

501 
	#_M¨g_
 

	)

502 
	#__MATHCALL_NAME
(
«me
Ë
f
 ## 
	)
name

503 
	~<bôs/m©hˇŒs-«ºow.h
>

504 #unde‡
_Mªt_


505 #unde‡
_M¨g_


506 #unde‡
__MATHCALL_NAME


508 
	#_Mªt_
 

	)

509 
	#_M¨g_
 

	)

510 
	#__MATHCALL_NAME
(
«me
Ë
f
 ##Çamê## 
l


	)

511 #ifde‡
__LDBL_COMPAT


512 
	#__MATHCALL_REDIR_NAME
(
«me
Ë
f
 ## 
	)
name

513 #unde‡
__MATHCALL_NARROW


514 
	#__MATHCALL_NARROW
(
func
, 
ªdú
, 
«rgs
) \

515 
	`__MATHCALL_NARROW_REDIR
 (
func
, 
ªdú
, 
«rgs
)

	)

517 
	~<bôs/m©hˇŒs-«ºow.h
>

518 #unde‡
_Mªt_


519 #unde‡
_M¨g_


520 #unde‡
__MATHCALL_NAME


521 #ifde‡
__LDBL_COMPAT


522 #unde‡
__MATHCALL_REDIR_NAME


523 #unde‡
__MATHCALL_NARROW


524 
	#__MATHCALL_NARROW
(
func
, 
ªdú
, 
«rgs
) \

525 
	`__MATHCALL_NARROW_NORMAL
 (
func
, 
«rgs
)

	)

528 
	#_Mªt_
 

	)

529 
	#_M¨g_
 

	)

530 
	#__MATHCALL_NAME
(
«me
Ë
d
 ##Çamê## 
l


	)

531 #ifde‡
__LDBL_COMPAT


532 
	#__MATHCALL_REDIR_NAME
(
«me
Ë
__∆dbl_d
 ##Çamê## 
l


	)

533 #unde‡
__MATHCALL_NARROW


534 
	#__MATHCALL_NARROW
(
func
, 
ªdú
, 
«rgs
) \

535 
	`__MATHCALL_NARROW_REDIR
 (
func
, 
ªdú
, 
«rgs
)

	)

537 
	~<bôs/m©hˇŒs-«ºow.h
>

538 #unde‡
_Mªt_


539 #unde‡
_M¨g_


540 #unde‡
__MATHCALL_NAME


541 #ifde‡
__LDBL_COMPAT


542 #unde‡
__MATHCALL_REDIR_NAME


543 #unde‡
__MATHCALL_NARROW


544 
	#__MATHCALL_NARROW
(
func
, 
ªdú
, 
«rgs
) \

545 
	`__MATHCALL_NARROW_NORMAL
 (
func
, 
«rgs
)

	)

550 #i‡
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

552 #i‡
__HAVE_FLOAT16
 && 
__HAVE_FLOAT32


553 
	#_Mªt_
 
_Flﬂt16


	)

554 
	#_M¨g_
 
_Flﬂt32


	)

555 
	#__MATHCALL_NAME
(
«me
Ë
f16
 ##Çamê## 
f32


	)

556 
	~<bôs/m©hˇŒs-«ºow.h
>

557 #unde‡
_Mªt_


558 #unde‡
_M¨g_


559 #unde‡
__MATHCALL_NAME


562 #i‡
__HAVE_FLOAT16
 && 
__HAVE_FLOAT32X


563 
	#_Mªt_
 
_Flﬂt16


	)

564 
	#_M¨g_
 
_Flﬂt32x


	)

565 
	#__MATHCALL_NAME
(
«me
Ë
f16
 ##Çamê## 
f32x


	)

566 
	~<bôs/m©hˇŒs-«ºow.h
>

567 #unde‡
_Mªt_


568 #unde‡
_M¨g_


569 #unde‡
__MATHCALL_NAME


572 #i‡
__HAVE_FLOAT16
 && 
__HAVE_FLOAT64


573 
	#_Mªt_
 
_Flﬂt16


	)

574 
	#_M¨g_
 
_Flﬂt64


	)

575 
	#__MATHCALL_NAME
(
«me
Ë
f16
 ##Çamê## 
f64


	)

576 
	~<bôs/m©hˇŒs-«ºow.h
>

577 #unde‡
_Mªt_


578 #unde‡
_M¨g_


579 #unde‡
__MATHCALL_NAME


582 #i‡
__HAVE_FLOAT16
 && 
__HAVE_FLOAT64X


583 
	#_Mªt_
 
_Flﬂt16


	)

584 
	#_M¨g_
 
_Flﬂt64x


	)

585 
	#__MATHCALL_NAME
(
«me
Ë
f16
 ##Çamê## 
f64x


	)

586 
	~<bôs/m©hˇŒs-«ºow.h
>

587 #unde‡
_Mªt_


588 #unde‡
_M¨g_


589 #unde‡
__MATHCALL_NAME


592 #i‡
__HAVE_FLOAT16
 && 
__HAVE_FLOAT128


593 
	#_Mªt_
 
_Flﬂt16


	)

594 
	#_M¨g_
 
_Flﬂt128


	)

595 
	#__MATHCALL_NAME
(
«me
Ë
f16
 ##Çamê## 
f128


	)

596 
	~<bôs/m©hˇŒs-«ºow.h
>

597 #unde‡
_Mªt_


598 #unde‡
_M¨g_


599 #unde‡
__MATHCALL_NAME


602 #i‡
__HAVE_FLOAT16
 && 
__HAVE_FLOAT128X


603 
	#_Mªt_
 
_Flﬂt16


	)

604 
	#_M¨g_
 
_Flﬂt128x


	)

605 
	#__MATHCALL_NAME
(
«me
Ë
f16
 ##Çamê## 
f128x


	)

606 
	~<bôs/m©hˇŒs-«ºow.h
>

607 #unde‡
_Mªt_


608 #unde‡
_M¨g_


609 #unde‡
__MATHCALL_NAME


612 #i‡
__HAVE_FLOAT32
 && 
__HAVE_FLOAT32X


613 
	#_Mªt_
 
_Flﬂt32


	)

614 
	#_M¨g_
 
_Flﬂt32x


	)

615 
	#__MATHCALL_NAME
(
«me
Ë
f32
 ##Çamê## 
f32x


	)

616 
	~<bôs/m©hˇŒs-«ºow.h
>

617 #unde‡
_Mªt_


618 #unde‡
_M¨g_


619 #unde‡
__MATHCALL_NAME


622 #i‡
__HAVE_FLOAT32
 && 
__HAVE_FLOAT64


623 
	#_Mªt_
 
_Flﬂt32


	)

624 
	#_M¨g_
 
_Flﬂt64


	)

625 
	#__MATHCALL_NAME
(
«me
Ë
f32
 ##Çamê## 
f64


	)

626 
	~<bôs/m©hˇŒs-«ºow.h
>

627 #unde‡
_Mªt_


628 #unde‡
_M¨g_


629 #unde‡
__MATHCALL_NAME


632 #i‡
__HAVE_FLOAT32
 && 
__HAVE_FLOAT64X


633 
	#_Mªt_
 
_Flﬂt32


	)

634 
	#_M¨g_
 
_Flﬂt64x


	)

635 
	#__MATHCALL_NAME
(
«me
Ë
f32
 ##Çamê## 
f64x


	)

636 
	~<bôs/m©hˇŒs-«ºow.h
>

637 #unde‡
_Mªt_


638 #unde‡
_M¨g_


639 #unde‡
__MATHCALL_NAME


642 #i‡
__HAVE_FLOAT32
 && 
__HAVE_FLOAT128


643 
	#_Mªt_
 
_Flﬂt32


	)

644 
	#_M¨g_
 
_Flﬂt128


	)

645 
	#__MATHCALL_NAME
(
«me
Ë
f32
 ##Çamê## 
f128


	)

646 
	~<bôs/m©hˇŒs-«ºow.h
>

647 #unde‡
_Mªt_


648 #unde‡
_M¨g_


649 #unde‡
__MATHCALL_NAME


652 #i‡
__HAVE_FLOAT32
 && 
__HAVE_FLOAT128X


653 
	#_Mªt_
 
_Flﬂt32


	)

654 
	#_M¨g_
 
_Flﬂt128x


	)

655 
	#__MATHCALL_NAME
(
«me
Ë
f32
 ##Çamê## 
f128x


	)

656 
	~<bôs/m©hˇŒs-«ºow.h
>

657 #unde‡
_Mªt_


658 #unde‡
_M¨g_


659 #unde‡
__MATHCALL_NAME


662 #i‡
__HAVE_FLOAT32X
 && 
__HAVE_FLOAT64


663 
	#_Mªt_
 
_Flﬂt32x


	)

664 
	#_M¨g_
 
_Flﬂt64


	)

665 
	#__MATHCALL_NAME
(
«me
Ë
f32x
 ##Çamê## 
f64


	)

666 
	~<bôs/m©hˇŒs-«ºow.h
>

667 #unde‡
_Mªt_


668 #unde‡
_M¨g_


669 #unde‡
__MATHCALL_NAME


672 #i‡
__HAVE_FLOAT32X
 && 
__HAVE_FLOAT64X


673 
	#_Mªt_
 
_Flﬂt32x


	)

674 
	#_M¨g_
 
_Flﬂt64x


	)

675 
	#__MATHCALL_NAME
(
«me
Ë
f32x
 ##Çamê## 
f64x


	)

676 
	~<bôs/m©hˇŒs-«ºow.h
>

677 #unde‡
_Mªt_


678 #unde‡
_M¨g_


679 #unde‡
__MATHCALL_NAME


682 #i‡
__HAVE_FLOAT32X
 && 
__HAVE_FLOAT128


683 
	#_Mªt_
 
_Flﬂt32x


	)

684 
	#_M¨g_
 
_Flﬂt128


	)

685 
	#__MATHCALL_NAME
(
«me
Ë
f32x
 ##Çamê## 
f128


	)

686 
	~<bôs/m©hˇŒs-«ºow.h
>

687 #unde‡
_Mªt_


688 #unde‡
_M¨g_


689 #unde‡
__MATHCALL_NAME


692 #i‡
__HAVE_FLOAT32X
 && 
__HAVE_FLOAT128X


693 
	#_Mªt_
 
_Flﬂt32x


	)

694 
	#_M¨g_
 
_Flﬂt128x


	)

695 
	#__MATHCALL_NAME
(
«me
Ë
f32x
 ##Çamê## 
f128x


	)

696 
	~<bôs/m©hˇŒs-«ºow.h
>

697 #unde‡
_Mªt_


698 #unde‡
_M¨g_


699 #unde‡
__MATHCALL_NAME


702 #i‡
__HAVE_FLOAT64
 && 
__HAVE_FLOAT64X


703 
	#_Mªt_
 
_Flﬂt64


	)

704 
	#_M¨g_
 
_Flﬂt64x


	)

705 
	#__MATHCALL_NAME
(
«me
Ë
f64
 ##Çamê## 
f64x


	)

706 
	~<bôs/m©hˇŒs-«ºow.h
>

707 #unde‡
_Mªt_


708 #unde‡
_M¨g_


709 #unde‡
__MATHCALL_NAME


712 #i‡
__HAVE_FLOAT64
 && 
__HAVE_FLOAT128


713 
	#_Mªt_
 
_Flﬂt64


	)

714 
	#_M¨g_
 
_Flﬂt128


	)

715 
	#__MATHCALL_NAME
(
«me
Ë
f64
 ##Çamê## 
f128


	)

716 
	~<bôs/m©hˇŒs-«ºow.h
>

717 #unde‡
_Mªt_


718 #unde‡
_M¨g_


719 #unde‡
__MATHCALL_NAME


722 #i‡
__HAVE_FLOAT64
 && 
__HAVE_FLOAT128X


723 
	#_Mªt_
 
_Flﬂt64


	)

724 
	#_M¨g_
 
_Flﬂt128x


	)

725 
	#__MATHCALL_NAME
(
«me
Ë
f64
 ##Çamê## 
f128x


	)

726 
	~<bôs/m©hˇŒs-«ºow.h
>

727 #unde‡
_Mªt_


728 #unde‡
_M¨g_


729 #unde‡
__MATHCALL_NAME


732 #i‡
__HAVE_FLOAT64X
 && 
__HAVE_FLOAT128


733 
	#_Mªt_
 
_Flﬂt64x


	)

734 
	#_M¨g_
 
_Flﬂt128


	)

735 
	#__MATHCALL_NAME
(
«me
Ë
f64x
 ##Çamê## 
f128


	)

736 
	~<bôs/m©hˇŒs-«ºow.h
>

737 #unde‡
_Mªt_


738 #unde‡
_M¨g_


739 #unde‡
__MATHCALL_NAME


742 #i‡
__HAVE_FLOAT64X
 && 
__HAVE_FLOAT128X


743 
	#_Mªt_
 
_Flﬂt64x


	)

744 
	#_M¨g_
 
_Flﬂt128x


	)

745 
	#__MATHCALL_NAME
(
«me
Ë
f64x
 ##Çamê## 
f128x


	)

746 
	~<bôs/m©hˇŒs-«ºow.h
>

747 #unde‡
_Mªt_


748 #unde‡
_M¨g_


749 #unde‡
__MATHCALL_NAME


752 #i‡
__HAVE_FLOAT128
 && 
__HAVE_FLOAT128X


753 
	#_Mªt_
 
_Flﬂt128


	)

754 
	#_M¨g_
 
_Flﬂt128x


	)

755 
	#__MATHCALL_NAME
(
«me
Ë
f128
 ##Çamê## 
f128x


	)

756 
	~<bôs/m©hˇŒs-«ºow.h
>

757 #unde‡
_Mªt_


758 #unde‡
_M¨g_


759 #unde‡
__MATHCALL_NAME


764 #unde‡
__MATHCALL_NARROW_ARGS_1


765 #unde‡
__MATHCALL_NARROW_ARGS_2


766 #unde‡
__MATHCALL_NARROW_ARGS_3


767 #unde‡
__MATHCALL_NARROW_NORMAL


768 #unde‡
__MATHCALL_NARROW_REDIR


769 #unde‡
__MATHCALL_NARROW


771 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


773 
signgam
;

776 #i‡(
__HAVE_DISTINCT_FLOAT16
 \

777 || 
__HAVE_DISTINCT_FLOAT32
 \

778 || 
__HAVE_DISTINCT_FLOAT64
 \

779 || 
__HAVE_DISTINCT_FLOAT32X
 \

780 || 
__HAVE_DISTINCT_FLOAT64X
 \

781 || 
__HAVE_DISTINCT_FLOAT128X
)

794 #ifde‡
__NO_LONG_DOUBLE_MATH


795 #i‡
__HAVE_DISTINCT_FLOAT128


798 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

799 ( (
TG_ARG
Ë= (Ë? 
FUNC
 ## 
f
 
ARGS
 : FUNC ARGS)

	)

800 #ñi‡
__HAVE_DISTINCT_FLOAT128


801 #i‡
__HAVE_GENERIC_SELECTION


802 #i‡
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT32


803 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
Ë
_Flﬂt32
: FUNC ## 
f
 ARGS,

	)

805 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
)

	)

807 #i‡
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT64X


808 #i‡
__HAVE_FLOAT64X_LONG_DOUBLE


809 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
Ë
_Flﬂt64x
: FUNC ## 
l
 ARGS,

	)

811 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
Ë
_Flﬂt64x
: FUNC ## 
f128
 ARGS,

	)

814 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
)

	)

816 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

817 
	`_Gíîic
 ((
TG_ARG
), \

818 : 
FUNC
 ## 
f
 
ARGS
, \

819 
	`__MATH_TG_F32
 (
FUNC
, 
ARGS
) \

820 : 
FUNC
 
ARGS
, \

821 : 
FUNC
 ## 
l
 
ARGS
, \

822 
	`__MATH_TG_F64X
 (
FUNC
, 
ARGS
) \

823 
_Flﬂt128
: 
FUNC
 ## 
f128
 
ARGS
)

	)

825 #i‡
__HAVE_FLOATN_NOT_TYPEDEF


828 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

829 
__buûtö_choo£_ex¥
 \

830 (
	`__buûtö_ty≥s_com∑tibÀ_p
 (
	`__ty≥of
 (
TG_ARG
), ), \

831 
FUNC
 ## 
f
 
ARGS
, \

832 
__buûtö_choo£_ex¥
 \

833 (
	`__buûtö_ty≥s_com∑tibÀ_p
 (
	`__ty≥of
 (
TG_ARG
), ), \

834 
FUNC
 
ARGS
, \

835 
__buûtö_choo£_ex¥
 \

836 (
	`__buûtö_ty≥s_com∑tibÀ_p
 (
	`__ty≥of
 (
TG_ARG
), ), \

837 
FUNC
 ## 
l
 
ARGS
, \

838 
FUNC
 ## 
f128
 
ARGS
)))

	)

841 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

842 ( (
TG_ARG
) ==  () \

843 ? 
FUNC
 ## 
f
 
ARGS
 \

844 :  (
TG_ARG
) ==  () \

845 ? 
FUNC
 
ARGS
 \

846 : 
FUNC
 ## 
l
 
ARGS
)

	)

850 #ifde‡
__USE_ISOC99


855 
FP_NAN
 =

856 
	#FP_NAN
 0

	)

857 
FP_NAN
,

858 
FP_INFINITE
 =

859 
	#FP_INFINITE
 1

	)

860 
FP_INFINITE
,

861 
FP_ZERO
 =

862 
	#FP_ZERO
 2

	)

863 
FP_ZERO
,

864 
FP_SUBNORMAL
 =

865 
	#FP_SUBNORMAL
 3

	)

866 
FP_SUBNORMAL
,

867 
FP_NORMAL
 =

868 
	#FP_NORMAL
 4

	)

869 
FP_NORMAL


877 #i‡
	`__GNUC_PREREQ
 (4,4Ë&& !
deföed
 
__SUPPORT_SNAN__
 \

878 && (!
deföed
 
__OPTIMIZE_SIZE__
 || deföed 
__˝lu•lus
)

885 
	#Â˛assify
(
x
Ë
	`__buûtö_Â˛assify
 (
FP_NAN
, 
FP_INFINITE
, \

886 
FP_NORMAL
, 
FP_SUBNORMAL
, 
FP_ZERO
, 
x
)

	)

888 
	#Â˛assify
(
x
Ë
	`__MATH_TG
 ((x), 
__Â˛assify
, (x))

	)

892 #i‡
	`__GNUC_PREREQ
 (6,0)

893 
	#signbô
(
x
Ë
	`__buûtö_signbô
 (x)

	)

894 #ñi‡
deföed
 
__˝lu•lus


902 
	#signbô
(
x
Ë
	`__buûtö_signbôl
 (x)

	)

903 #ñi‡
	`__GNUC_PREREQ
 (4,0)

904 
	#signbô
(
x
Ë
	`__MATH_TG
 ((x), 
__buûtö_signbô
, (x))

	)

906 
	#signbô
(
x
Ë
	`__MATH_TG
 ((x), 
__signbô
, (x))

	)

910 #i‡
	`__GNUC_PREREQ
 (4,4Ë&& !
deföed
 
__SUPPORT_SNAN__


911 
	#isföôe
(
x
Ë
	`__buûtö_isföôe
 (x)

	)

913 
	#isföôe
(
x
Ë
	`__MATH_TG
 ((x), 
__föôe
, (x))

	)

917 #i‡
	`__GNUC_PREREQ
 (4,4Ë&& !
deföed
 
__SUPPORT_SNAN__


918 
	#i¢‹mÆ
(
x
Ë
	`__buûtö_i¢‹mÆ
 (x)

	)

920 
	#i¢‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_NORMAL
)

	)

925 #i‡
	`__GNUC_PREREQ
 (4,4Ë&& !
deföed
 
__SUPPORT_SNAN__


926 
	#i¢™
(
x
Ë
	`__buûtö_i¢™
 (x)

	)

928 
	#i¢™
(
x
Ë
	`__MATH_TG
 ((x), 
__i¢™
, (x))

	)

932 #i‡
__HAVE_DISTINCT_FLOAT128
 && !
	`__GNUC_PREREQ
 (7,0) \

933 && !
deföed
 
__SUPPORT_SNAN__
 && !deföed 
__˝lu•lus


939 
	#isöf
(
x
) \

940 (
	`__buûtö_ty≥s_com∑tibÀ_p
 (
	`__ty≥of
 (
x
), 
_Flﬂt128
) \

941 ? 
	`__isöff128
 (
x
Ë: 
	`__buûtö_isöf_sign
 (x))

	)

942 #ñi‡
	`__GNUC_PREREQ
 (4,4Ë&& !
deföed
 
__SUPPORT_SNAN__


943 
	#isöf
(
x
Ë
	`__buûtö_isöf_sign
 (x)

	)

945 
	#isöf
(
x
Ë
	`__MATH_TG
 ((x), 
__isöf
, (x))

	)

949 
	#MATH_ERRNO
 1

	)

950 
	#MATH_ERREXCEPT
 2

	)

957 #ifde‡
__FAST_MATH__


958 
	#m©h_îrh™dlög
 0

	)

959 #ñi‡
deföed
 
__NO_MATH_ERRNO__


960 
	#m©h_îrh™dlög
 (
MATH_ERREXCEPT
)

	)

962 
	#m©h_îrh™dlög
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

967 #i‡
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

968 
	~<bôs/isˇn⁄iˇl.h
>

971 #i‚de‡
__˝lu•lus


972 
	#issig«lög
(
x
Ë
	`__MATH_TG
 ((x), 
__issig«lög
, (x))

	)

981 
ölöe
 
	`issig«lög
 (
__vÆ
Ë{  
	`__issig«lögf
 (__val); }

982 
ölöe
 
	`issig«lög
 (
__vÆ
Ë{  
	`__issig«lög
 (__val); }

983 
ölöe
 

984 
	`issig«lög
 (
__vÆ
)

986 #ifde‡
__NO_LONG_DOUBLE_MATH


987  
	`__issig«lög
 (
__vÆ
);

989  
	`__issig«lögl
 (
__vÆ
);

992 #i‡
__HAVE_FLOAT128_UNLIKE_LDBL


995 
ölöe
 
	`issig«lög
 (
_Flﬂt128
 
__vÆ
Ë{  
	`__issig«lögf128
 (__val); }

997 
	}
}

1001 
	#issubn‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_SUBNORMAL
)

	)

1004 #i‚de‡
__˝lu•lus


1005 #ifde‡
__SUPPORT_SNAN__


1006 
	#iszîo
(
x
Ë(
	`Â˛assify
 (xË=
FP_ZERO
)

	)

1008 
	#iszîo
(
x
Ë(((
	`__ty≥of
 (x)Ë(x)Ë=0)

	)

1012 #ifde‡
__SUPPORT_SNAN__


1013 
ölöe
 

1014 
iszîo
 (
__vÆ
)

1016  
__Â˛assifyf
 (
__vÆ
Ë=
FP_ZERO
;

1018 
ölöe
 

1019 
iszîo
 (
__vÆ
)

1021  
__Â˛assify
 (
__vÆ
Ë=
FP_ZERO
;

1023 
ölöe
 

1024 
iszîo
 (
__vÆ
)

1026 #ifde‡
__NO_LONG_DOUBLE_MATH


1027  
__Â˛assify
 (
__vÆ
Ë=
FP_ZERO
;

1029  
__Â˛assifyl
 (
__vÆ
Ë=
FP_ZERO
;

1032 #i‡
__HAVE_FLOAT128_UNLIKE_LDBL


1035 
ölöe
 

1036 
iszîo
 (
_Flﬂt128
 
__vÆ
)

1038  
__Â˛assifyf128
 (
__vÆ
Ë=
FP_ZERO
;

1042 
ãm∂©e
 <
˛ass
 
__T
> 
ölöe
 
boﬁ


1043 
iszîo
 (
__T
 
__vÆ
)

1045  
__vÆ
 == 0;

1052 #ifde‡
__USE_XOPEN


1054 
	#MAXFLOAT
 3.40282347e+38F

	)

1059 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


1060 
	#M_E
 2.7182818284590452354

	)

1061 
	#M_LOG2E
 1.4426950408889634074

	)

1062 
	#M_LOG10E
 0.43429448190325182765

	)

1063 
	#M_LN2
 0.69314718055994530942

	)

1064 
	#M_LN10
 2.30258509299404568402

	)

1065 
	#M_PI
 3.14159265358979323846

	)

1066 
	#M_PI_2
 1.57079632679489661923

	)

1067 
	#M_PI_4
 0.78539816339744830962

	)

1068 
	#M_1_PI
 0.31830988618379067154

	)

1069 
	#M_2_PI
 0.63661977236758134308

	)

1070 
	#M_2_SQRTPI
 1.12837916709551257390

	)

1071 
	#M_SQRT2
 1.41421356237309504880

	)

1072 
	#M_SQRT1_2
 0.70710678118654752440

	)

1078 #ifde‡
__USE_GNU


1079 
	#M_El
 2.718281828459045235360287471352662498L

	)

1080 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

1081 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

1082 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

1083 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

1084 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

1085 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

1086 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

1087 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

1088 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

1089 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

1090 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

1091 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

1094 #i‡
__HAVE_FLOAT16
 && 
deföed
 
__USE_GNU


1095 
	#M_Ef16
 
	`__f16
 (2.718281828459045235360287471352662498Ë

	)

1096 
	#M_LOG2Ef16
 
	`__f16
 (1.442695040888963407359924681001892137Ë

	)

1097 
	#M_LOG10Ef16
 
	`__f16
 (0.434294481903251827651128918916605082Ë

	)

1098 
	#M_LN2f16
 
	`__f16
 (0.693147180559945309417232121458176568Ë

	)

1099 
	#M_LN10f16
 
	`__f16
 (2.302585092994045684017991454684364208Ë

	)

1100 
	#M_PIf16
 
	`__f16
 (3.141592653589793238462643383279502884Ë

	)

1101 
	#M_PI_2f16
 
	`__f16
 (1.570796326794896619231321691639751442Ë

	)

1102 
	#M_PI_4f16
 
	`__f16
 (0.785398163397448309615660845819875721Ë

	)

1103 
	#M_1_PIf16
 
	`__f16
 (0.318309886183790671537767526745028724Ë

	)

1104 
	#M_2_PIf16
 
	`__f16
 (0.636619772367581343075535053490057448Ë

	)

1105 
	#M_2_SQRTPIf16
 
	`__f16
 (1.128379167095512573896158903121545172Ë

	)

1106 
	#M_SQRT2f16
 
	`__f16
 (1.414213562373095048801688724209698079Ë

	)

1107 
	#M_SQRT1_2f16
 
	`__f16
 (0.707106781186547524400844362104849039Ë

	)

1110 #i‡
__HAVE_FLOAT32
 && 
deföed
 
__USE_GNU


1111 
	#M_Ef32
 
	`__f32
 (2.718281828459045235360287471352662498Ë

	)

1112 
	#M_LOG2Ef32
 
	`__f32
 (1.442695040888963407359924681001892137Ë

	)

1113 
	#M_LOG10Ef32
 
	`__f32
 (0.434294481903251827651128918916605082Ë

	)

1114 
	#M_LN2f32
 
	`__f32
 (0.693147180559945309417232121458176568Ë

	)

1115 
	#M_LN10f32
 
	`__f32
 (2.302585092994045684017991454684364208Ë

	)

1116 
	#M_PIf32
 
	`__f32
 (3.141592653589793238462643383279502884Ë

	)

1117 
	#M_PI_2f32
 
	`__f32
 (1.570796326794896619231321691639751442Ë

	)

1118 
	#M_PI_4f32
 
	`__f32
 (0.785398163397448309615660845819875721Ë

	)

1119 
	#M_1_PIf32
 
	`__f32
 (0.318309886183790671537767526745028724Ë

	)

1120 
	#M_2_PIf32
 
	`__f32
 (0.636619772367581343075535053490057448Ë

	)

1121 
	#M_2_SQRTPIf32
 
	`__f32
 (1.128379167095512573896158903121545172Ë

	)

1122 
	#M_SQRT2f32
 
	`__f32
 (1.414213562373095048801688724209698079Ë

	)

1123 
	#M_SQRT1_2f32
 
	`__f32
 (0.707106781186547524400844362104849039Ë

	)

1126 #i‡
__HAVE_FLOAT64
 && 
deföed
 
__USE_GNU


1127 
	#M_Ef64
 
	`__f64
 (2.718281828459045235360287471352662498Ë

	)

1128 
	#M_LOG2Ef64
 
	`__f64
 (1.442695040888963407359924681001892137Ë

	)

1129 
	#M_LOG10Ef64
 
	`__f64
 (0.434294481903251827651128918916605082Ë

	)

1130 
	#M_LN2f64
 
	`__f64
 (0.693147180559945309417232121458176568Ë

	)

1131 
	#M_LN10f64
 
	`__f64
 (2.302585092994045684017991454684364208Ë

	)

1132 
	#M_PIf64
 
	`__f64
 (3.141592653589793238462643383279502884Ë

	)

1133 
	#M_PI_2f64
 
	`__f64
 (1.570796326794896619231321691639751442Ë

	)

1134 
	#M_PI_4f64
 
	`__f64
 (0.785398163397448309615660845819875721Ë

	)

1135 
	#M_1_PIf64
 
	`__f64
 (0.318309886183790671537767526745028724Ë

	)

1136 
	#M_2_PIf64
 
	`__f64
 (0.636619772367581343075535053490057448Ë

	)

1137 
	#M_2_SQRTPIf64
 
	`__f64
 (1.128379167095512573896158903121545172Ë

	)

1138 
	#M_SQRT2f64
 
	`__f64
 (1.414213562373095048801688724209698079Ë

	)

1139 
	#M_SQRT1_2f64
 
	`__f64
 (0.707106781186547524400844362104849039Ë

	)

1142 #i‡
__HAVE_FLOAT128
 && 
deföed
 
__USE_GNU


1143 
	#M_Ef128
 
	`__f128
 (2.718281828459045235360287471352662498Ë

	)

1144 
	#M_LOG2Ef128
 
	`__f128
 (1.442695040888963407359924681001892137Ë

	)

1145 
	#M_LOG10Ef128
 
	`__f128
 (0.434294481903251827651128918916605082Ë

	)

1146 
	#M_LN2f128
 
	`__f128
 (0.693147180559945309417232121458176568Ë

	)

1147 
	#M_LN10f128
 
	`__f128
 (2.302585092994045684017991454684364208Ë

	)

1148 
	#M_PIf128
 
	`__f128
 (3.141592653589793238462643383279502884Ë

	)

1149 
	#M_PI_2f128
 
	`__f128
 (1.570796326794896619231321691639751442Ë

	)

1150 
	#M_PI_4f128
 
	`__f128
 (0.785398163397448309615660845819875721Ë

	)

1151 
	#M_1_PIf128
 
	`__f128
 (0.318309886183790671537767526745028724Ë

	)

1152 
	#M_2_PIf128
 
	`__f128
 (0.636619772367581343075535053490057448Ë

	)

1153 
	#M_2_SQRTPIf128
 
	`__f128
 (1.128379167095512573896158903121545172Ë

	)

1154 
	#M_SQRT2f128
 
	`__f128
 (1.414213562373095048801688724209698079Ë

	)

1155 
	#M_SQRT1_2f128
 
	`__f128
 (0.707106781186547524400844362104849039Ë

	)

1158 #i‡
__HAVE_FLOAT32X
 && 
deföed
 
__USE_GNU


1159 
	#M_Ef32x
 
	`__f32x
 (2.718281828459045235360287471352662498Ë

	)

1160 
	#M_LOG2Ef32x
 
	`__f32x
 (1.442695040888963407359924681001892137Ë

	)

1161 
	#M_LOG10Ef32x
 
	`__f32x
 (0.434294481903251827651128918916605082Ë

	)

1162 
	#M_LN2f32x
 
	`__f32x
 (0.693147180559945309417232121458176568Ë

	)

1163 
	#M_LN10f32x
 
	`__f32x
 (2.302585092994045684017991454684364208Ë

	)

1164 
	#M_PIf32x
 
	`__f32x
 (3.141592653589793238462643383279502884Ë

	)

1165 
	#M_PI_2f32x
 
	`__f32x
 (1.570796326794896619231321691639751442Ë

	)

1166 
	#M_PI_4f32x
 
	`__f32x
 (0.785398163397448309615660845819875721Ë

	)

1167 
	#M_1_PIf32x
 
	`__f32x
 (0.318309886183790671537767526745028724Ë

	)

1168 
	#M_2_PIf32x
 
	`__f32x
 (0.636619772367581343075535053490057448Ë

	)

1169 
	#M_2_SQRTPIf32x
 
	`__f32x
 (1.128379167095512573896158903121545172Ë

	)

1170 
	#M_SQRT2f32x
 
	`__f32x
 (1.414213562373095048801688724209698079Ë

	)

1171 
	#M_SQRT1_2f32x
 
	`__f32x
 (0.707106781186547524400844362104849039Ë

	)

1174 #i‡
__HAVE_FLOAT64X
 && 
deföed
 
__USE_GNU


1175 
	#M_Ef64x
 
	`__f64x
 (2.718281828459045235360287471352662498Ë

	)

1176 
	#M_LOG2Ef64x
 
	`__f64x
 (1.442695040888963407359924681001892137Ë

	)

1177 
	#M_LOG10Ef64x
 
	`__f64x
 (0.434294481903251827651128918916605082Ë

	)

1178 
	#M_LN2f64x
 
	`__f64x
 (0.693147180559945309417232121458176568Ë

	)

1179 
	#M_LN10f64x
 
	`__f64x
 (2.302585092994045684017991454684364208Ë

	)

1180 
	#M_PIf64x
 
	`__f64x
 (3.141592653589793238462643383279502884Ë

	)

1181 
	#M_PI_2f64x
 
	`__f64x
 (1.570796326794896619231321691639751442Ë

	)

1182 
	#M_PI_4f64x
 
	`__f64x
 (0.785398163397448309615660845819875721Ë

	)

1183 
	#M_1_PIf64x
 
	`__f64x
 (0.318309886183790671537767526745028724Ë

	)

1184 
	#M_2_PIf64x
 
	`__f64x
 (0.636619772367581343075535053490057448Ë

	)

1185 
	#M_2_SQRTPIf64x
 
	`__f64x
 (1.128379167095512573896158903121545172Ë

	)

1186 
	#M_SQRT2f64x
 
	`__f64x
 (1.414213562373095048801688724209698079Ë

	)

1187 
	#M_SQRT1_2f64x
 
	`__f64x
 (0.707106781186547524400844362104849039Ë

	)

1190 #i‡
__HAVE_FLOAT128X
 && 
deföed
 
__USE_GNU


1197 #i‡
deföed
 
__STRICT_ANSI__
 && !deföed 
__NO_MATH_INLINES


1198 
	#__NO_MATH_INLINES
 1

	)

1201 #ifde‡
__USE_ISOC99


1202 #i‡
__GNUC_PREREQ
 (3, 1)

1209 
	#isgª©î
(
x
, 
y
Ë
	`__buûtö_isgª©î
(x, y)

	)

1210 
	#isgª©îequÆ
(
x
, 
y
Ë
	`__buûtö_isgª©îequÆ
(x, y)

	)

1211 
	#i¶ess
(
x
, 
y
Ë
	`__buûtö_i¶ess
(x, y)

	)

1212 
	#i¶es£quÆ
(
x
, 
y
Ë
	`__buûtö_i¶es£quÆ
(x, y)

	)

1213 
	#i¶essgª©î
(
x
, 
y
Ë
	`__buûtö_i¶essgª©î
(x, y)

	)

1214 
	#isun‹dîed
(
x
, 
y
Ë
	`__buûtö_isun‹dîed
(x, y)

	)

1216 
	#isgª©î
(
x
, 
y
) \

1217 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of__
 (
x
Ë
__x
 = (x); __ty≥of__ (
y
Ë
__y
 = (y); \

1218 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x > __y; }))

	)

1219 
	#isgª©îequÆ
(
x
, 
y
) \

1220 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of__
 (
x
Ë
__x
 = (x); __ty≥of__ (
y
Ë
__y
 = (y); \

1221 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x >__y; }))

	)

1222 
	#i¶ess
(
x
, 
y
) \

1223 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of__
 (
x
Ë
__x
 = (x); __ty≥of__ (
y
Ë
__y
 = (y); \

1224 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x < __y; }))

	)

1225 
	#i¶es£quÆ
(
x
, 
y
) \

1226 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of__
 (
x
Ë
__x
 = (x); __ty≥of__ (
y
Ë
__y
 = (y); \

1227 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x <__y; }))

	)

1228 
	#i¶essgª©î
(
x
, 
y
) \

1229 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of__
 (
x
Ë
__x
 = (x); __ty≥of__ (
y
Ë
__y
 = (y); \

1230 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x !__y; }))

	)

1232 
	#isun‹dîed
(
x
, 
y
) \

1233 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of__
 (
x
Ë
__u
 = (x); __ty≥of__ (
y
Ë
__v
 = (y); \

1234 
__u
 !
__v
 && (__u !__u || __v !__v); }))

	)

1239 #ifde‡
__USE_EXTERN_INLINES


1240 
	~<bôs/m©hölöe.h
>

1245 #i‡
deföed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

1248 
	#_MdoubÀ_
 

	)

1249 
	#__MATH_DECLARING_DOUBLE
 1

	)

1250 
	#__MATH_DECLARING_FLOATN
 0

	)

1251 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1252 
fun˘i⁄
 ## 
ªíå™t


	)

1253 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1254 
__
 ## 
fun˘i⁄
 ## 
ªíå™t
 ## 
_föôe


	)

1255 
	~<bôs/m©h-föôe.h
>

1256 #unde‡
_MdoubÀ_


1257 #unde‡
__MATH_DECLARING_DOUBLE


1258 #unde‡
__MATH_DECLARING_FLOATN


1259 #unde‡
__REDIRFROM_X


1260 #unde‡
__REDIRTO_X


1264 #ifde‡
__USE_ISOC99


1267 
	#_MdoubÀ_
 

	)

1268 
	#__MATH_DECLARING_DOUBLE
 0

	)

1269 
	#__MATH_DECLARING_FLOATN
 0

	)

1270 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1271 
fun˘i⁄
 ## 
f
 ## 
ªíå™t


	)

1272 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1273 
__
 ## 
fun˘i⁄
 ## 
f
 ## 
ªíå™t
 ## 
_föôe


	)

1274 
	~<bôs/m©h-föôe.h
>

1275 #unde‡
_MdoubÀ_


1276 #unde‡
__MATH_DECLARING_DOUBLE


1277 #unde‡
__MATH_DECLARING_FLOATN


1278 #unde‡
__REDIRFROM_X


1279 #unde‡
__REDIRTO_X


1282 #ifde‡
__MATH_DECLARE_LDOUBLE


1283 
	#_MdoubÀ_
 

	)

1284 
	#__MATH_DECLARING_DOUBLE
 0

	)

1285 
	#__MATH_DECLARING_FLOATN
 0

	)

1286 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1287 
fun˘i⁄
 ## 
l
 ## 
ªíå™t


	)

1288 #ifde‡
__NO_LONG_DOUBLE_MATH


1289 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1290 
__
 ## 
fun˘i⁄
 ## 
ªíå™t
 ## 
_föôe


	)

1292 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1293 
__
 ## 
fun˘i⁄
 ## 
l
 ## 
ªíå™t
 ## 
_föôe


	)

1295 
	~<bôs/m©h-föôe.h
>

1296 #unde‡
_MdoubÀ_


1297 #unde‡
__MATH_DECLARING_DOUBLE


1298 #unde‡
__MATH_DECLARING_FLOATN


1299 #unde‡
__REDIRFROM_X


1300 #unde‡
__REDIRTO_X


1307 #i‡(
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
deföed
 
_LIBC
)) \

1308 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1309 
	#_MdoubÀ_
 
_Flﬂt16


	)

1310 
	#__MATH_DECLARING_DOUBLE
 0

	)

1311 
	#__MATH_DECLARING_FLOATN
 1

	)

1312 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1313 
fun˘i⁄
 ## 
f16
 ## 
ªíå™t


	)

1314 #i‡
__HAVE_DISTINCT_FLOAT16


1315 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1316 
__
 ## 
fun˘i⁄
 ## 
f16
 ## 
ªíå™t
 ## 
_föôe


	)

1320 
	~<bôs/m©h-föôe.h
>

1321 #unde‡
_MdoubÀ_


1322 #unde‡
__MATH_DECLARING_DOUBLE


1323 #unde‡
__MATH_DECLARING_FLOATN


1324 #unde‡
__REDIRFROM_X


1325 #unde‡
__REDIRTO_X


1328 #i‡(
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
deföed
 
_LIBC
)) \

1329 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1330 
	#_MdoubÀ_
 
_Flﬂt32


	)

1331 
	#__MATH_DECLARING_DOUBLE
 0

	)

1332 
	#__MATH_DECLARING_FLOATN
 1

	)

1333 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1334 
fun˘i⁄
 ## 
f32
 ## 
ªíå™t


	)

1335 #i‡
__HAVE_DISTINCT_FLOAT32


1336 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1337 
__
 ## 
fun˘i⁄
 ## 
f32
 ## 
ªíå™t
 ## 
_föôe


	)

1339 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1340 
__
 ## 
fun˘i⁄
 ## 
f
 ## 
ªíå™t
 ## 
_föôe


	)

1342 
	~<bôs/m©h-föôe.h
>

1343 #unde‡
_MdoubÀ_


1344 #unde‡
__MATH_DECLARING_DOUBLE


1345 #unde‡
__MATH_DECLARING_FLOATN


1346 #unde‡
__REDIRFROM_X


1347 #unde‡
__REDIRTO_X


1350 #i‡(
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
deföed
 
_LIBC
)) \

1351 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1352 
	#_MdoubÀ_
 
_Flﬂt64


	)

1353 
	#__MATH_DECLARING_DOUBLE
 0

	)

1354 
	#__MATH_DECLARING_FLOATN
 1

	)

1355 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1356 
fun˘i⁄
 ## 
f64
 ## 
ªíå™t


	)

1357 #i‡
__HAVE_DISTINCT_FLOAT64


1358 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1359 
__
 ## 
fun˘i⁄
 ## 
f64
 ## 
ªíå™t
 ## 
_föôe


	)

1361 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1362 
__
 ## 
fun˘i⁄
 ## 
ªíå™t
 ## 
_föôe


	)

1364 
	~<bôs/m©h-föôe.h
>

1365 #unde‡
_MdoubÀ_


1366 #unde‡
__MATH_DECLARING_DOUBLE


1367 #unde‡
__MATH_DECLARING_FLOATN


1368 #unde‡
__REDIRFROM_X


1369 #unde‡
__REDIRTO_X


1372 #i‡(
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
deföed
 
_LIBC
)) \

1373 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1374 
	#_MdoubÀ_
 
_Flﬂt128


	)

1375 
	#__MATH_DECLARING_DOUBLE
 0

	)

1376 
	#__MATH_DECLARING_FLOATN
 1

	)

1377 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1378 
fun˘i⁄
 ## 
f128
 ## 
ªíå™t


	)

1379 #i‡
__HAVE_DISTINCT_FLOAT128


1380 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1381 
__
 ## 
fun˘i⁄
 ## 
f128
 ## 
ªíå™t
 ## 
_föôe


	)

1383 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1384 
__
 ## 
fun˘i⁄
 ## 
l
 ## 
ªíå™t
 ## 
_föôe


	)

1386 
	~<bôs/m©h-föôe.h
>

1387 #unde‡
_MdoubÀ_


1388 #unde‡
__MATH_DECLARING_DOUBLE


1389 #unde‡
__MATH_DECLARING_FLOATN


1390 #unde‡
__REDIRFROM_X


1391 #unde‡
__REDIRTO_X


1394 #i‡(
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
deföed
 
_LIBC
)) \

1395 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1396 
	#_MdoubÀ_
 
_Flﬂt32x


	)

1397 
	#__MATH_DECLARING_DOUBLE
 0

	)

1398 
	#__MATH_DECLARING_FLOATN
 1

	)

1399 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1400 
fun˘i⁄
 ## 
f32x
 ## 
ªíå™t


	)

1401 #i‡
__HAVE_DISTINCT_FLOAT32X


1402 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1403 
__
 ## 
fun˘i⁄
 ## 
f32x
 ## 
ªíå™t
 ## 
_föôe


	)

1405 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1406 
__
 ## 
fun˘i⁄
 ## 
ªíå™t
 ## 
_föôe


	)

1408 
	~<bôs/m©h-föôe.h
>

1409 #unde‡
_MdoubÀ_


1410 #unde‡
__MATH_DECLARING_DOUBLE


1411 #unde‡
__MATH_DECLARING_FLOATN


1412 #unde‡
__REDIRFROM_X


1413 #unde‡
__REDIRTO_X


1416 #i‡(
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
deföed
 
_LIBC
)) \

1417 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1418 
	#_MdoubÀ_
 
_Flﬂt64x


	)

1419 
	#__MATH_DECLARING_DOUBLE
 0

	)

1420 
	#__MATH_DECLARING_FLOATN
 1

	)

1421 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1422 
fun˘i⁄
 ## 
f64x
 ## 
ªíå™t


	)

1423 #i‡
__HAVE_DISTINCT_FLOAT64X


1424 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1425 
__
 ## 
fun˘i⁄
 ## 
f64x
 ## 
ªíå™t
 ## 
_föôe


	)

1426 #ñi‡
__HAVE_FLOAT64X_LONG_DOUBLE


1427 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1428 
__
 ## 
fun˘i⁄
 ## 
l
 ## 
ªíå™t
 ## 
_föôe


	)

1430 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1431 
__
 ## 
fun˘i⁄
 ## 
f128
 ## 
ªíå™t
 ## 
_föôe


	)

1433 
	~<bôs/m©h-föôe.h
>

1434 #unde‡
_MdoubÀ_


1435 #unde‡
__MATH_DECLARING_DOUBLE


1436 #unde‡
__MATH_DECLARING_FLOATN


1437 #unde‡
__REDIRFROM_X


1438 #unde‡
__REDIRTO_X


1441 #i‡(
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
deföed
 
_LIBC
)) \

1442 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1443 
	#_MdoubÀ_
 
_Flﬂt128x


	)

1444 
	#__MATH_DECLARING_DOUBLE
 0

	)

1445 
	#__MATH_DECLARING_FLOATN
 1

	)

1446 
	#__REDIRFROM_X
(
fun˘i⁄
, 
ªíå™t
) \

1447 
fun˘i⁄
 ## 
f128x
 ## 
ªíå™t


	)

1448 #i‡
__HAVE_DISTINCT_FLOAT128X


1449 
	#__REDIRTO_X
(
fun˘i⁄
, 
ªíå™t
) \

1450 
__
 ## 
fun˘i⁄
 ## 
f128x
 ## 
ªíå™t
 ## 
_föôe


	)

1454 
	~<bôs/m©h-föôe.h
>

1455 #unde‡
_MdoubÀ_


1456 #unde‡
__MATH_DECLARING_DOUBLE


1457 #unde‡
__MATH_DECLARING_FLOATN


1458 #unde‡
__REDIRFROM_X


1459 #unde‡
__REDIRTO_X


1464 #i‡
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

1467 #i‡
__FLT_EVAL_METHOD__
 == 2 || __FLT_EVAL_METHOD__ > 64

1468 
	#__MATH_EVAL_FMT2
(
x
, 
y
Ë((xË+ (yË+ 0.0L)

	)

1469 #ñi‡
__FLT_EVAL_METHOD__
 == 1 || __FLT_EVAL_METHOD__ > 32

1470 
	#__MATH_EVAL_FMT2
(
x
, 
y
Ë((xË+ (yË+ 0.0)

	)

1471 #ñi‡
__FLT_EVAL_METHOD__
 == 0 || __FLT_EVAL_METHOD__ == 32

1472 
	#__MATH_EVAL_FMT2
(
x
, 
y
Ë((xË+ (yË+ 0.0f)

	)

1474 
	#__MATH_EVAL_FMT2
(
x
, 
y
Ë((xË+ (y))

	)

1479 #i‡!
deföed
 
__˝lu•lus
 || (__˝lu•lu†< 201103L && !deföed 
__GNUC__
)

1480 
	#i£qsig
(
x
, 
y
) \

1481 
	`__MATH_TG
 (
	`__MATH_EVAL_FMT2
 (
x
, 
y
), 
__i£qsig
, ((x), (y)))

	)

1494 
ãm∂©e
<
ty≥«me
> 
__i£qsig_ty≥
;

1496 
ãm∂©e
<> 
__i£qsig_ty≥
<>

1498 
	`__ˇŒ
 (
__x
, 
__y
Ë
	`throw
 ()

1500  
	`__i£qsigf
 (
__x
, 
__y
);

1504 
ãm∂©e
<> 
__i£qsig_ty≥
<>

1506 
	`__ˇŒ
 (
__x
, 
__y
Ë
	`throw
 ()

1508  
	`__i£qsig
 (
__x
, 
__y
);

1512 
ãm∂©e
<> 
__i£qsig_ty≥
<>

1514 
	`__ˇŒ
 (
__x
, 
__y
Ë
	`throw
 ()

1516 #i‚de‡
__NO_LONG_DOUBLE_MATH


1517  
	`__i£qsigl
 (
__x
, 
__y
);

1519  
	`__i£qsig
 (
__x
, 
__y
);

1524 #i‡
__HAVE_FLOAT128_UNLIKE_LDBL


1527 
ãm∂©e
<> 
__i£qsig_ty≥
<
_Flﬂt128
>

1529 
	`__ˇŒ
 (
_Flﬂt128
 
__x
, _Flﬂt128 
__y
Ë
	`throw
 ()

1531  
	`__i£qsigf128
 (
__x
, 
__y
);

1536 
ãm∂©e
<
ty≥«me
 
_T1
,Åy≥«mê
_T2
>

1537 
ölöe
 

1538 
	`i£qsig
 (
_T1
 
__x
, 
_T2
 
__y
Ë
	`throw
 ()

1540 #i‡
__˝lu•lus
 >= 201103L

1541 
	`de˛ty≥
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)Ë
	t_T3
;

1543 
	`__ty≥of
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)Ë
	t_T3
;

1545  
__i£qsig_ty≥
<
_T3
>::
	`__ˇŒ
 (
__x
, 
__y
);

1548 
	}
}

1553 
__END_DECLS


	@/usr/include/netdb.h

22 #i‚def 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<√töë/ö.h
>

28 
	~<bôs/°döt-uöä.h
>

29 #ifde‡
__USE_MISC


32 
	~<Ωc/√tdb.h
>

35 #ifde‡
__USE_GNU


36 
	~<bôs/ty≥s/sigevít_t.h
>

37 
	~<bôs/ty≥s/°ru˘_time•ec.h
>

40 
	~<bôs/√tdb.h
>

43 
	#_PATH_HEQUIV
 "/ëc/ho°s.equiv"

	)

44 
	#_PATH_HOSTS
 "/ëc/ho°s"

	)

45 
	#_PATH_NETWORKS
 "/ëc/√tw‹ks"

	)

46 
	#_PATH_NSSWITCH_CONF
 "/ëc/nsswôch.c⁄f"

	)

47 
	#_PATH_PROTOCOLS
 "/ëc/¥Ÿocﬁs"

	)

48 
	#_PATH_SERVICES
 "/ëc/£rvi˚s"

	)

51 
	g__BEGIN_DECLS


53 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


56 
	#h_î∫o
 (*
	`__h_î∫o_loˇti⁄
 ())

	)

59 *
	$__h_î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

63 
	#HOST_NOT_FOUND
 1

	)

64 
	#TRY_AGAIN
 2

	)

66 
	#NO_RECOVERY
 3

	)

68 
	#NO_DATA
 4

	)

71 #ifde‡
__USE_MISC


72 
	#NETDB_INTERNAL
 -1

	)

73 
	#NETDB_SUCCESS
 0

	)

74 
	#NO_ADDRESS
 
NO_DATA


	)

77 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_XOPEN_EXTENDED


79 
	#IPPORT_RESERVED
 1024

	)

82 #ifde‡
__USE_GNU


84 
	#SCOPE_DELIMITER
 '%'

	)

87 #ifde‡
__USE_MISC


90 
	$hîr‹
 (c⁄° *
__°r
Ë
__THROW
;

93 c⁄° *
	$h°ªº‹
 (
__îr_num
Ë
__THROW
;

98 
	sho°ít


100 *
h_«me
;

101 **
h_Æü£s
;

102 
h_addπy≥
;

103 
h_Àngth
;

104 **
h_addr_li°
;

105 #ifde‡
__USE_MISC


106 
	#h_addr
 
h_addr_li°
[0]

	)

115 
	`£tho°ít
 (
__°ay_›í
);

121 
	`ídho°ít
 ();

128 
ho°ít
 *
	`gëho°ít
 ();

135 
ho°ít
 *
	`gëho°byaddr
 (c⁄° *
__addr
, 
__sockÀn_t
 
__Àn
,

136 
__ty≥
);

142 
ho°ít
 *
	`gëho°by«me
 (c⁄° *
__«me
);

144 #ifde‡
__USE_MISC


153 
ho°ít
 *
	`gëho°by«me2
 (c⁄° *
__«me
, 
__af
);

165 
	`gëho°ít_r
 (
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

166 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

167 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

168 *
__ª°ri˘
 
__h_î∫›
);

170 
	`gëho°byaddr_r
 (c⁄° *
__ª°ri˘
 
__addr
, 
__sockÀn_t
 
__Àn
,

171 
__ty≥
,

172 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

173 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

174 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

175 *
__ª°ri˘
 
__h_î∫›
);

177 
	`gëho°by«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

178 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

179 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

180 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

181 *
__ª°ri˘
 
__h_î∫›
);

183 
	`gëho°by«me2_r
 (c⁄° *
__ª°ri˘
 
__«me
, 
__af
,

184 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

185 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

186 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

187 *
__ª°ri˘
 
__h_î∫›
);

196 
	`£äëít
 (
__°ay_›í
);

202 
	`íd√ã¡
 ();

209 
√ã¡
 *
	`gë√ã¡
 ();

216 
√ã¡
 *
	`gë√tbyaddr
 (
uöt32_t
 
__√t
, 
__ty≥
);

222 
√ã¡
 *
	`gë√tby«me
 (c⁄° *
__«me
);

224 #ifdef 
__USE_MISC


235 
	`gë√ã¡_r
 (
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

236 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

237 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

238 *
__ª°ri˘
 
__h_î∫›
);

240 
	`gë√tbyaddr_r
 (
uöt32_t
 
__√t
, 
__ty≥
,

241 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

242 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

243 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

244 *
__ª°ri˘
 
__h_î∫›
);

246 
	`gë√tby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

247 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

248 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

249 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

250 *
__ª°ri˘
 
__h_î∫›
);

255 
	s£rvít


257 *
s_«me
;

258 **
s_Æü£s
;

259 
s_p‹t
;

260 *
s_¥Ÿo
;

268 
	`£t£rvít
 (
__°ay_›í
);

274 
	`íd£rvít
 ();

281 
£rvít
 *
	`gë£rvít
 ();

288 
£rvít
 *
	`gë£rvby«me
 (c⁄° *
__«me
, c⁄° *
__¥Ÿo
);

295 
£rvít
 *
	`gë£rvbyp‹t
 (
__p‹t
, c⁄° *
__¥Ÿo
);

298 #ifdef 
__USE_MISC


306 
	`gë£rvít_r
 (
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

307 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

308 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

310 
	`gë£rvby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

311 c⁄° *
__ª°ri˘
 
__¥Ÿo
,

312 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

313 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

314 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

316 
	`gë£rvbyp‹t_r
 (
__p‹t
, c⁄° *
__ª°ri˘
 
__¥Ÿo
,

317 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

318 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

319 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

324 
	s¥Ÿ€¡


326 *
p_«me
;

327 **
p_Æü£s
;

328 
p_¥Ÿo
;

336 
	`£çrŸ€¡
 (
__°ay_›í
);

342 
	`íd¥Ÿ€¡
 ();

349 
¥Ÿ€¡
 *
	`gë¥Ÿ€¡
 ();

355 
¥Ÿ€¡
 *
	`gë¥Ÿoby«me
 (c⁄° *
__«me
);

361 
¥Ÿ€¡
 *
	`gë¥Ÿobynumbî
 (
__¥Ÿo
);

364 #ifdef 
__USE_MISC


372 
	`gë¥Ÿ€¡_r
 (
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

373 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

374 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

376 
	`gë¥Ÿoby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

377 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

378 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

379 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

381 
	`gë¥Ÿobynumbî_r
 (
__¥Ÿo
,

382 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

383 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

384 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

393 
	`£äëgª¡
 (c⁄° *
__√tgroup
);

401 
	`íd√tgª¡
 ();

410 
	`gë√tgª¡
 (**
__ª°ri˘
 
__ho°p
,

411 **
__ª°ri˘
 
__u£Ω
,

412 **
__ª°ri˘
 
__domaöp
);

421 
	`ö√tgr
 (c⁄° *
__√tgroup
, c⁄° *
__ho°
,

422 c⁄° *
__u£r
, c⁄° *
__domaö
);

430 
	`gë√tgª¡_r
 (**
__ª°ri˘
 
__ho°p
,

431 **
__ª°ri˘
 
__u£Ω
,

432 **
__ª°ri˘
 
__domaöp
,

433 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
);

437 #ifde‡
__USE_MISC


449 
	`rcmd
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

450 c⁄° *
__ª°ri˘
 
__locu£r
,

451 c⁄° *
__ª°ri˘
 
__ªmu£r
,

452 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

461 
	`rcmd_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

462 c⁄° *
__ª°ri˘
 
__locu£r
,

463 c⁄° *
__ª°ri˘
 
__ªmu£r
,

464 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

465 
ß_Ámûy_t
 
__af
);

477 
	`ªxec
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

478 c⁄° *
__ª°ri˘
 
__«me
,

479 c⁄° *
__ª°ri˘
 
__∑ss
,

480 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

489 
	`ªxec_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

490 c⁄° *
__ª°ri˘
 
__«me
,

491 c⁄° *
__ª°ri˘
 
__∑ss
,

492 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

493 
ß_Ámûy_t
 
__af
);

503 
	`ru£rok
 (c⁄° *
__rho°
, 
__su£r
,

504 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

513 
	`ru£rok_af
 (c⁄° *
__rho°
, 
__su£r
,

514 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

515 
ß_Ámûy_t
 
__af
);

526 
	`úu£rok
 (
uöt32_t
 
__øddr
, 
__su£r
,

527 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

537 
	`úu£rok_af
 (c⁄° *
__øddr
, 
__su£r
,

538 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

539 
ß_Ámûy_t
 
__af
);

549 
	`ºesvp‹t
 (*
__Æp‹t
);

558 
	`ºesvp‹t_af
 (*
__Æp‹t
, 
ß_Ámûy_t
 
__af
);

563 #ifde‡
__USE_XOPEN2K


565 
	saddröfo


567 
ai_Êags
;

568 
ai_Ámûy
;

569 
ai_sockty≥
;

570 
ai_¥Ÿocﬁ
;

571 
sockÀn_t
 
ai_addæí
;

572 
sockaddr
 *
ai_addr
;

573 *
ai_ˇn⁄«me
;

574 
addröfo
 *
ai_√xt
;

577 #ifde‡
__USE_GNU


579 
	sgaicb


581 c⁄° *
¨_«me
;

582 c⁄° *
¨_£rvi˚
;

583 c⁄° 
addröfo
 *
¨_ªque°
;

584 
addröfo
 *
¨_ªsu…
;

586 
__ªtu∫
;

587 
__glibc_ª£rved
[5];

591 
	#GAI_WAIT
 0

	)

592 
	#GAI_NOWAIT
 1

	)

596 
	#AI_PASSIVE
 0x0001

	)

597 
	#AI_CANONNAME
 0x0002

	)

598 
	#AI_NUMERICHOST
 0x0004

	)

599 
	#AI_V4MAPPED
 0x0008

	)

600 
	#AI_ALL
 0x0010

	)

601 
	#AI_ADDRCONFIG
 0x0020

	)

603 #ifde‡
__USE_GNU


604 
	#AI_IDN
 0x0040

	)

607 
	#AI_CANONIDN
 0x0080

	)

608 
	#AI_IDN_ALLOW_UNASSIGNED
 \

609 
	`__glibc_ma¸o_w¨nög
 ("AI_IDN_ALLOW_UNASSIGNED i†dïªˇãd"Ë0x0100

	)

610 
	#AI_IDN_USE_STD3_ASCII_RULES
 \

611 
	`__glibc_ma¸o_w¨nög
 ("AI_IDN_USE_STD3_ASCII_RULES i†dïªˇãd"Ë0x0200

	)

613 
	#AI_NUMERICSERV
 0x0400

	)

616 
	#EAI_BADFLAGS
 -1

	)

617 
	#EAI_NONAME
 -2

	)

618 
	#EAI_AGAIN
 -3

	)

619 
	#EAI_FAIL
 -4

	)

620 
	#EAI_FAMILY
 -6

	)

621 
	#EAI_SOCKTYPE
 -7

	)

622 
	#EAI_SERVICE
 -8

	)

623 
	#EAI_MEMORY
 -10

	)

624 
	#EAI_SYSTEM
 -11

	)

625 
	#EAI_OVERFLOW
 -12

	)

626 #ifde‡
__USE_GNU


627 
	#EAI_NODATA
 -5

	)

628 
	#EAI_ADDRFAMILY
 -9

	)

629 
	#EAI_INPROGRESS
 -100

	)

630 
	#EAI_CANCELED
 -101

	)

631 
	#EAI_NOTCANCELED
 -102

	)

632 
	#EAI_ALLDONE
 -103

	)

633 
	#EAI_INTR
 -104

	)

634 
	#EAI_IDN_ENCODE
 -105

	)

637 #ifde‡
__USE_MISC


638 
	#NI_MAXHOST
 1025

	)

639 
	#NI_MAXSERV
 32

	)

642 
	#NI_NUMERICHOST
 1

	)

643 
	#NI_NUMERICSERV
 2

	)

644 
	#NI_NOFQDN
 4

	)

645 
	#NI_NAMEREQD
 8

	)

646 
	#NI_DGRAM
 16

	)

647 #ifde‡
__USE_GNU


648 
	#NI_IDN
 32

	)

649 
	#NI_IDN_ALLOW_UNASSIGNED
 \

650 
	`__glibc_ma¸o_w¨nög
 ("NI_IDN_ALLOW_UNASSIGNED i†dïªˇãd"Ë64

	)

651 
	#NI_IDN_USE_STD3_ASCII_RULES
 \

652 
	`__glibc_ma¸o_w¨nög
 ("NI_IDN_USE_STD3_ASCII_RULES i†dïªˇãd"Ë128

	)

660 
	`gëaddröfo
 (c⁄° *
__ª°ri˘
 
__«me
,

661 c⁄° *
__ª°ri˘
 
__£rvi˚
,

662 c⁄° 
addröfo
 *
__ª°ri˘
 
__ªq
,

663 
addröfo
 **
__ª°ri˘
 
__∑i
);

666 
	$‰ìaddröfo
 (
addröfo
 *
__ai
Ë
__THROW
;

669 c⁄° *
	$gai_°ªº‹
 (
__ecode
Ë
__THROW
;

675 
	`gë«meöfo
 (c⁄° 
sockaddr
 *
__ª°ri˘
 
__ß
,

676 
sockÀn_t
 
__ßÀn
, *
__ª°ri˘
 
__ho°
,

677 
sockÀn_t
 
__ho°Àn
, *
__ª°ri˘
 
__£rv
,

678 
sockÀn_t
 
__£rvÀn
, 
__Êags
);

681 #ifde‡
__USE_GNU


690 
	`gëaddröfo_a
 (
__mode
, 
gaicb
 *
__li°
[
__ª°ri˘_¨r
],

691 
__ít
, 
sigevít
 *
__ª°ri˘
 
__sig
);

701 
	`gai_su•íd
 (c⁄° 
gaicb
 *c⁄° 
__li°
[], 
__ít
,

702 c⁄° 
time•ec
 *
__timeout
);

705 
	$gai_îr‹
 (
gaicb
 *
__ªq
Ë
__THROW
;

708 
	$gai_ˇn˚l
 (
gaicb
 *
__gaicbp
Ë
__THROW
;

711 
__END_DECLS


	@/usr/include/netinet/in.h

18 #i‚def 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<bôs/°döt-uöä.h
>

23 
	~<sys/sockë.h
>

24 
	~<bôs/ty≥s.h
>

27 
__BEGIN_DECLS


30 
uöt32_t
 
	tö_addr_t
;

31 
	sö_addr


33 
ö_addr_t
 
	ms_addr
;

37 
	~<bôs/ö.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_MPLS
 = 137,

89 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


98 #i‡!
__USE_KERNEL_IPV6_DEFS


101 
	mIPPROTO_HOPOPTS
 = 0,

102 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

103 
	mIPPROTO_ROUTING
 = 43,

104 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

105 
	mIPPROTO_FRAGMENT
 = 44,

106 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

107 
	mIPPROTO_ICMPV6
 = 58,

108 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

109 
	mIPPROTO_NONE
 = 59,

110 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

111 
	mIPPROTO_DSTOPTS
 = 60,

112 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

113 
	mIPPROTO_MH
 = 135

114 
	#IPPROTO_MH
 
IPPROTO_MH


	)

119 
uöt16_t
 
	tö_p‹t_t
;

124 
	mIPPORT_ECHO
 = 7,

125 
	mIPPORT_DISCARD
 = 9,

126 
	mIPPORT_SYSTAT
 = 11,

127 
	mIPPORT_DAYTIME
 = 13,

128 
	mIPPORT_NETSTAT
 = 15,

129 
	mIPPORT_FTP
 = 21,

130 
	mIPPORT_TELNET
 = 23,

131 
	mIPPORT_SMTP
 = 25,

132 
	mIPPORT_TIMESERVER
 = 37,

133 
	mIPPORT_NAMESERVER
 = 42,

134 
	mIPPORT_WHOIS
 = 43,

135 
	mIPPORT_MTP
 = 57,

137 
	mIPPORT_TFTP
 = 69,

138 
	mIPPORT_RJE
 = 77,

139 
	mIPPORT_FINGER
 = 79,

140 
	mIPPORT_TTYLINK
 = 87,

141 
	mIPPORT_SUPDUP
 = 95,

144 
	mIPPORT_EXECSERVER
 = 512,

145 
	mIPPORT_LOGINSERVER
 = 513,

146 
	mIPPORT_CMDSERVER
 = 514,

147 
	mIPPORT_EFSSERVER
 = 520,

150 
	mIPPORT_BIFFUDP
 = 512,

151 
	mIPPORT_WHOSERVER
 = 513,

152 
	mIPPORT_ROUTESERVER
 = 520,

155 
	mIPPORT_RESERVED
 = 1024,

158 
	mIPPORT_USERRESERVED
 = 5000

166 
	#IN_CLASSA
(
a
Ë((((
ö_addr_t
)◊)Ë& 0x80000000Ë=0)

	)

167 
	#IN_CLASSA_NET
 0xff000000

	)

168 
	#IN_CLASSA_NSHIFT
 24

	)

169 
	#IN_CLASSA_HOST
 (0xfffffff‡& ~
IN_CLASSA_NET
)

	)

170 
	#IN_CLASSA_MAX
 128

	)

172 
	#IN_CLASSB
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xc0000000Ë=0x80000000)

	)

173 
	#IN_CLASSB_NET
 0xffff0000

	)

174 
	#IN_CLASSB_NSHIFT
 16

	)

175 
	#IN_CLASSB_HOST
 (0xfffffff‡& ~
IN_CLASSB_NET
)

	)

176 
	#IN_CLASSB_MAX
 65536

	)

178 
	#IN_CLASSC
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xc0000000)

	)

179 
	#IN_CLASSC_NET
 0xffffff00

	)

180 
	#IN_CLASSC_NSHIFT
 8

	)

181 
	#IN_CLASSC_HOST
 (0xfffffff‡& ~
IN_CLASSC_NET
)

	)

183 
	#IN_CLASSD
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xe0000000)

	)

184 
	#IN_MULTICAST
(
a
Ë
	`IN_CLASSD
◊)

	)

186 
	#IN_EXPERIMENTAL
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xe0000000)

	)

187 
	#IN_BADCLASS
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xf0000000)

	)

190 
	#INADDR_ANY
 ((
ö_addr_t
Ë0x00000000)

	)

192 
	#INADDR_BROADCAST
 ((
ö_addr_t
Ë0xffffffff)

	)

194 
	#INADDR_NONE
 ((
ö_addr_t
Ë0xffffffff)

	)

197 
	#IN_LOOPBACKNET
 127

	)

199 #i‚de‡
INADDR_LOOPBACK


200 
	#INADDR_LOOPBACK
 ((
ö_addr_t
Ë0x7f000001Ë

	)

204 
	#INADDR_UNSPEC_GROUP
 ((
ö_addr_t
Ë0xe0000000Ë

	)

205 
	#INADDR_ALLHOSTS_GROUP
 ((
ö_addr_t
Ë0xe0000001Ë

	)

206 
	#INADDR_ALLRTRS_GROUP
 ((
ö_addr_t
Ë0xe0000002Ë

	)

207 
	#INADDR_MAX_LOCAL_GROUP
 ((
ö_addr_t
Ë0xe00000ffË

	)

209 #i‡!
__USE_KERNEL_IPV6_DEFS


211 
	sö6_addr


215 
uöt8_t
 
	m__u6_addr8
[16];

216 
uöt16_t
 
	m__u6_addr16
[8];

217 
uöt32_t
 
	m__u6_addr32
[4];

218 } 
	m__ö6_u
;

219 
	#s6_addr
 
__ö6_u
.
__u6_addr8


	)

220 #ifde‡
__USE_MISC


221 
	#s6_addr16
 
__ö6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__ö6_u
.
__u6_addr32


	)

227 c⁄° 
ö6_addr
 
ö6addr_™y
;

228 c⁄° 
ö6_addr
 
ö6addr_lo›back
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_ö


239 
__SOCKADDR_COMMON
 (
sö_
);

240 
ö_p‹t_t
 
	msö_p‹t
;

241 
ö_addr
 
	msö_addr
;

244 
	msö_zîo
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
ö_p‹t_t
) -

247  (
ö_addr
)];

250 #i‡!
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_ö6


254 
__SOCKADDR_COMMON
 (
sö6_
);

255 
ö_p‹t_t
 
	msö6_p‹t
;

256 
uöt32_t
 
	msö6_Êowöfo
;

257 
ö6_addr
 
	msö6_addr
;

258 
uöt32_t
 
	msö6_sc›e_id
;

262 #ifde‡
__USE_MISC


264 
	sù_mªq


267 
ö_addr
 
	mimr_mu…üddr
;

270 
ö_addr
 
	mimr_öãrÁ˚
;

273 
	sù_mªq_sour˚


276 
ö_addr
 
	mimr_mu…üddr
;

279 
ö_addr
 
	mimr_öãrÁ˚
;

282 
ö_addr
 
	mimr_sour˚addr
;

286 #i‡!
__USE_KERNEL_IPV6_DEFS


288 
	sùv6_mªq


291 
ö6_addr
 
	mùv6mr_mu…üddr
;

294 
	mùv6mr_öãrÁ˚
;

298 #ifde‡
__USE_MISC


300 
	sgroup_ªq


303 
uöt32_t
 
	mgr_öãrÁ˚
;

306 
sockaddr_°‹age
 
	mgr_group
;

309 
	sgroup_sour˚_ªq


312 
uöt32_t
 
	mg§_öãrÁ˚
;

315 
sockaddr_°‹age
 
	mg§_group
;

318 
sockaddr_°‹age
 
	mg§_sour˚
;

323 
	sù_msfûãr


326 
ö_addr
 
	mimsf_mu…üddr
;

329 
ö_addr
 
	mimsf_öãrÁ˚
;

332 
uöt32_t
 
	mimsf_fmode
;

335 
uöt32_t
 
	mimsf_num§c
;

337 
ö_addr
 
	mimsf_¶i°
[1];

340 
	#IP_MSFILTER_SIZE
(
num§c
Ë( (
ù_msfûãr
) \

341 -  (
ö_addr
) \

342 + (
num§c
Ë*  (
ö_addr
))

	)

344 
	sgroup_fûãr


347 
uöt32_t
 
	mgf_öãrÁ˚
;

350 
sockaddr_°‹age
 
	mgf_group
;

353 
uöt32_t
 
	mgf_fmode
;

356 
uöt32_t
 
	mgf_num§c
;

358 
sockaddr_°‹age
 
	mgf_¶i°
[1];

361 
	#GROUP_FILTER_SIZE
(
num§c
Ë( (
group_fûãr
) \

362 -  (
sockaddr_°‹age
) \

363 + ((
num§c
) \

364 *  (
sockaddr_°‹age
)))

	)

374 
uöt32_t
 
	$¡ohl
 (
uöt32_t
 
__√é⁄g
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

375 
uöt16_t
 
	$¡ohs
 (
uöt16_t
 
__√tsh‹t
)

376 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

377 
uöt32_t
 
	$ht⁄l
 (
uöt32_t
 
__ho°l⁄g
)

378 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

379 
uöt16_t
 
	$ht⁄s
 (
uöt16_t
 
__ho°sh‹t
)

380 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

382 
	~<ídün.h
>

385 
	~<bôs/byãsw≠.h
>

386 
	~<bôs/uöä-idítôy.h
>

388 #ifde‡
__OPTIMIZE__


392 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


395 
	#¡ohl
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

396 
	#¡ohs
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

397 
	#ht⁄l
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

398 
	#ht⁄s
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

400 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


401 
	#¡ohl
(
x
Ë
	`__bsw≠_32
 (x)

	)

402 
	#¡ohs
(
x
Ë
	`__bsw≠_16
 (x)

	)

403 
	#ht⁄l
(
x
Ë
	`__bsw≠_32
 (x)

	)

404 
	#ht⁄s
(
x
Ë
	`__bsw≠_16
 (x)

	)

409 #ifde‡
__GNUC__


410 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

411 (
__exãnsi⁄__
 \

412 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

413 
__a
->
__ö6_u
.
__u6_addr32
[0] == 0 \

414 && 
__a
->
__ö6_u
.
__u6_addr32
[1] == 0 \

415 && 
__a
->
__ö6_u
.
__u6_addr32
[2] == 0 \

416 && 
__a
->
__ö6_u
.
__u6_addr32
[3] =0; 
	}
}))

	)

418 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

419 (
__exãnsi⁄__
 \

420 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

421 
__a
->
__ö6_u
.
__u6_addr32
[0] == 0 \

422 && 
__a
->
__ö6_u
.
__u6_addr32
[1] == 0 \

423 && 
__a
->
__ö6_u
.
__u6_addr32
[2] == 0 \

424 && 
__a
->
__ö6_u
.
__u6_addr32
[3] =
	`ht⁄l
 (1); }))

	)

426 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

427 (
__exãnsi⁄__
 \

428 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

429 (
__a
->
__ö6_u
.
__u6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„800000); }))

	)

431 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

432 (
__exãnsi⁄__
 \

433 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

434 (
__a
->
__ö6_u
.
__u6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„c00000); }))

	)

436 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

437 (
__exãnsi⁄__
 \

438 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

439 
__a
->
__ö6_u
.
__u6_addr32
[0] == 0 \

440 && 
__a
->
__ö6_u
.
__u6_addr32
[1] == 0 \

441 && 
__a
->
__ö6_u
.
__u6_addr32
[2] =
	`ht⁄l
 (0xffff); }))

	)

443 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

444 (
__exãnsi⁄__
 \

445 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

446 
__a
->
__ö6_u
.
__u6_addr32
[0] == 0 \

447 && 
__a
->
__ö6_u
.
__u6_addr32
[1] == 0 \

448 && 
__a
->
__ö6_u
.
__u6_addr32
[2] == 0 \

449 && 
	`¡ohl
 (
__a
->
__ö6_u
.
__u6_addr32
[3]Ë> 1; }))

	)

451 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

452 (
__exãnsi⁄__
 \

453 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

454 c⁄° 
ö6_addr
 *
__b
 = (c⁄° ö6_add∏*Ë(
b
); \

455 
__a
->
__ö6_u
.
__u6_addr32
[0] =
__b
->__in6_u.__u6_addr32[0] \

456 && 
__a
->
__ö6_u
.
__u6_addr32
[1] =
__b
->__in6_u.__u6_addr32[1] \

457 && 
__a
->
__ö6_u
.
__u6_addr32
[2] =
__b
->__in6_u.__u6_addr32[2] \

458 && 
__a
->
__ö6_u
.
__u6_addr32
[3] =
__b
->__ö6_u.__u6_addr32[3]; }))

	)

460 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

461 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

462 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

463 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

464 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =0)

	)

466 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

467 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

468 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

469 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

470 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =
	`ht⁄l
 (1))

	)

472 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

473 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

474 =
	`ht⁄l
 (0x„800000))

	)

476 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

477 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

478 =
	`ht⁄l
 (0x„c00000))

	)

480 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

481 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

482 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

483 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =
	`ht⁄l
 (0xffff)))

	)

485 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

486 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

487 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

488 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0) \

489 && (
	`¡ohl
 (((c⁄° 
uöt32_t
 *Ë(
a
))[3]Ë> 1))

	)

491 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

492 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] =((c⁄° uöt32_à*Ë(
b
))[0]) \

493 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] =((c⁄° uöt32_à*Ë(
b
))[1]) \

494 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =((c⁄° uöt32_à*Ë(
b
))[2]) \

495 && (((c⁄° 
uöt32_t
 *Ë(
a
))[3] =((c⁄° uöt32_à*Ë(
b
))[3]))

	)

498 
	#IN6_IS_ADDR_MULTICAST
(
a
Ë(((c⁄° 
uöt8_t
 *Ë◊))[0] =0xff)

	)

500 #ifde‡
__USE_MISC


502 
	$bödªsvp‹t
 (
__sockfd
, 
sockaddr_ö
 *
__sock_ö
Ë
__THROW
;

505 
	$bödªsvp‹t6
 (
__sockfd
, 
sockaddr_ö6
 *
__sock_ö
)

506 
__THROW
;

510 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

511 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

512 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x1))

	)

514 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

515 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

516 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x2))

	)

518 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

519 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

520 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x5))

	)

522 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

523 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

524 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x8))

	)

526 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

527 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

528 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0xe))

	)

531 #ifde‡
__USE_GNU


532 
cmsghdr
;

534 #i‡!
__USE_KERNEL_IPV6_DEFS


536 
	sö6_pktöfo


538 
ö6_addr
 
ùi6_addr
;

539 
ùi6_ifödex
;

543 
	sù6_mtuöfo


545 
sockaddr_ö6
 
ù6m_addr
;

546 
uöt32_t
 
ù6m_mtu
;

551 
	$öë6_›ti⁄_•a˚
 (
__nbyãs
)

552 
__THROW
 
__©åibuã_dïªˇãd__
;

553 
	$öë6_›ti⁄_öô
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

554 
__ty≥
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

555 
	$öë6_›ti⁄_≠≥nd
 (
cmsghdr
 *
__cmsg
,

556 c⁄° 
uöt8_t
 *
__ty≥p
, 
__mu…x
,

557 
__∂usy
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

558 
uöt8_t
 *
	$öë6_›ti⁄_Æloc
 (
cmsghdr
 *
__cmsg
, 
__d©Æí
,

559 
__mu…x
, 
__∂usy
)

560 
__THROW
 
__©åibuã_dïªˇãd__
;

561 
	$öë6_›ti⁄_√xt
 (c⁄° 
cmsghdr
 *
__cmsg
,

562 
uöt8_t
 **
__çåp
)

563 
__THROW
 
__©åibuã_dïªˇãd__
;

564 
	$öë6_›ti⁄_föd
 (c⁄° 
cmsghdr
 *
__cmsg
,

565 
uöt8_t
 **
__çåp
, 
__ty≥
)

566 
__THROW
 
__©åibuã_dïªˇãd__
;

570 
	$öë6_›t_öô
 (*
__extbuf
, 
sockÀn_t
 
__exéí
Ë
__THROW
;

571 
	$öë6_›t_≠≥nd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

572 
uöt8_t
 
__ty≥
, 
sockÀn_t
 
__Àn
, uöt8_à
__Æign
,

573 **
__d©abuÂ
Ë
__THROW
;

574 
	$öë6_›t_föish
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
)

575 
__THROW
;

576 
	$öë6_›t_£t_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

577 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

578 
	$öë6_›t_√xt
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

579 
uöt8_t
 *
__ty≥p
, 
sockÀn_t
 *
__À≈
,

580 **
__d©abuÂ
Ë
__THROW
;

581 
	$öë6_›t_föd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

582 
uöt8_t
 
__ty≥
, 
sockÀn_t
 *
__À≈
,

583 **
__d©abuÂ
Ë
__THROW
;

584 
	$öë6_›t_gë_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

585 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

589 
sockÀn_t
 
	$öë6_πh_•a˚
 (
__ty≥
, 
__£gmíts
Ë
__THROW
;

590 *
	$öë6_πh_öô
 (*
__bp
, 
sockÀn_t
 
__bp_Àn
, 
__ty≥
,

591 
__£gmíts
Ë
__THROW
;

592 
	$öë6_πh_add
 (*
__bp
, c⁄° 
ö6_addr
 *
__addr
Ë
__THROW
;

593 
	$öë6_πh_ªvî£
 (c⁄° *
__ö
, *
__out
Ë
__THROW
;

594 
	$öë6_πh_£gmíts
 (c⁄° *
__bp
Ë
__THROW
;

595 
ö6_addr
 *
	$öë6_πh_gëaddr
 (c⁄° *
__bp
, 
__ödex
)

596 
__THROW
;

602 
	$gëùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

603 
ö_addr
 
__group
, 
uöt32_t
 *
__fmode
,

604 
uöt32_t
 *
__num§c
, 
ö_addr
 *
__¶i°
)

605 
__THROW
;

608 
	$£tùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

609 
ö_addr
 
__group
, 
uöt32_t
 
__fmode
,

610 
uöt32_t
 
__num§c
,

611 c⁄° 
ö_addr
 *
__¶i°
)

612 
__THROW
;

616 
	$gësour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

617 c⁄° 
sockaddr
 *
__group
,

618 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 *
__fmode
,

619 
uöt32_t
 *
__num§c
,

620 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

623 
	$£tsour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

624 c⁄° 
sockaddr
 *
__group
,

625 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 
__fmode
,

626 
uöt32_t
 
__num§c
,

627 c⁄° 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

630 
__END_DECLS


	@/usr/include/netinet/tcp.h

32 #i‚de‡
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<„©uªs.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

54 
	#TCP_COOKIE_TRANSACTIONS
 15

	)

55 
	#TCP_THIN_LINEAR_TIMEOUTS
 16

	)

56 
	#TCP_THIN_DUPACK
 17

	)

57 
	#TCP_USER_TIMEOUT
 18

	)

58 
	#TCP_REPAIR
 19

	)

59 
	#TCP_REPAIR_QUEUE
 20

	)

60 
	#TCP_QUEUE_SEQ
 21

	)

61 
	#TCP_REPAIR_OPTIONS
 22

	)

62 
	#TCP_FASTOPEN
 23

	)

63 
	#TCP_TIMESTAMP
 24

	)

64 
	#TCP_NOTSENT_LOWAT
 25

	)

66 
	#TCP_CC_INFO
 26

	)

68 
	#TCP_SAVE_SYN
 27

	)

70 
	#TCP_SAVED_SYN
 28

	)

72 
	#TCP_REPAIR_WINDOW
 29

	)

73 
	#TCP_FASTOPEN_CONNECT
 30

	)

74 
	#TCP_ULP
 31

	)

75 
	#TCP_MD5SIG_EXT
 32

	)

76 
	#TCP_FASTOPEN_KEY
 33

	)

77 
	#TCP_FASTOPEN_NO_COOKIE
 34

	)

79 #ifde‡
__USE_MISC


80 
	~<sys/ty≥s.h
>

81 
	~<sys/sockë.h
>

82 
	~<°döt.h
>

84 
uöt32_t
 
	tt˝_£q
;

89 
	st˝hdr


91 
__exãnsi⁄__
 union

95 
uöt16_t
 
	mth_•‹t
;

96 
uöt16_t
 
	mth_dp‹t
;

97 
t˝_£q
 
	mth_£q
;

98 
t˝_£q
 
	mth_ack
;

99 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


100 
uöt8_t
 
	mth_x2
:4;

101 
uöt8_t
 
	mth_off
:4;

103 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


104 
uöt8_t
 
	mth_off
:4;

105 
uöt8_t
 
	mth_x2
:4;

107 
uöt8_t
 
	mth_Êags
;

108 
	#TH_FIN
 0x01

	)

109 
	#TH_SYN
 0x02

	)

110 
	#TH_RST
 0x04

	)

111 
	#TH_PUSH
 0x08

	)

112 
	#TH_ACK
 0x10

	)

113 
	#TH_URG
 0x20

	)

114 
uöt16_t
 
	mth_wö
;

115 
uöt16_t
 
	mth_sum
;

116 
uöt16_t
 
	mth_uΩ
;

120 
uöt16_t
 
	msour˚
;

121 
uöt16_t
 
	mde°
;

122 
uöt32_t
 
	m£q
;

123 
uöt32_t
 
	mack_£q
;

124 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


125 
uöt16_t
 
	mªs1
:4;

126 
uöt16_t
 
	mdoff
:4;

127 
uöt16_t
 
	mfö
:1;

128 
uöt16_t
 
	msyn
:1;

129 
uöt16_t
 
	mr°
:1;

130 
uöt16_t
 
	mpsh
:1;

131 
uöt16_t
 
	mack
:1;

132 
uöt16_t
 
	murg
:1;

133 
uöt16_t
 
	mªs2
:2;

134 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


135 
uöt16_t
 
	mdoff
:4;

136 
uöt16_t
 
	mªs1
:4;

137 
uöt16_t
 
	mªs2
:2;

138 
uöt16_t
 
	murg
:1;

139 
uöt16_t
 
	mack
:1;

140 
uöt16_t
 
	mpsh
:1;

141 
uöt16_t
 
	mr°
:1;

142 
uöt16_t
 
	msyn
:1;

143 
uöt16_t
 
	mfö
:1;

147 
uöt16_t
 
	mwödow
;

148 
uöt16_t
 
	mcheck
;

149 
uöt16_t
 
	murg_±r
;

156 
	mTCP_ESTABLISHED
 = 1,

157 
	mTCP_SYN_SENT
,

158 
	mTCP_SYN_RECV
,

159 
	mTCP_FIN_WAIT1
,

160 
	mTCP_FIN_WAIT2
,

161 
	mTCP_TIME_WAIT
,

162 
	mTCP_CLOSE
,

163 
	mTCP_CLOSE_WAIT
,

164 
	mTCP_LAST_ACK
,

165 
	mTCP_LISTEN
,

166 
	mTCP_CLOSING


169 
	#TCPOPT_EOL
 0

	)

170 
	#TCPOPT_NOP
 1

	)

171 
	#TCPOPT_MAXSEG
 2

	)

172 
	#TCPOLEN_MAXSEG
 4

	)

173 
	#TCPOPT_WINDOW
 3

	)

174 
	#TCPOLEN_WINDOW
 3

	)

175 
	#TCPOPT_SACK_PERMITTED
 4

	)

176 
	#TCPOLEN_SACK_PERMITTED
 2

	)

177 
	#TCPOPT_SACK
 5

	)

178 
	#TCPOPT_TIMESTAMP
 8

	)

179 
	#TCPOLEN_TIMESTAMP
 10

	)

180 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2Ë

	)

182 
	#TCPOPT_TSTAMP_HDR
 \

183 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

191 
	#TCP_MSS
 512

	)

193 
	#TCP_MAXWIN
 65535

	)

195 
	#TCP_MAX_WINSHIFT
 14

	)

197 
	#SOL_TCP
 6

	)

200 
	#TCPI_OPT_TIMESTAMPS
 1

	)

201 
	#TCPI_OPT_SACK
 2

	)

202 
	#TCPI_OPT_WSCALE
 4

	)

203 
	#TCPI_OPT_ECN
 8

	)

204 
	#TCPI_OPT_ECN_SEEN
 16

	)

205 
	#TCPI_OPT_SYN_DATA
 32

	)

208 
	et˝_ˇ_°©e


210 
	mTCP_CA_O≥n
 = 0,

211 
	mTCP_CA_Dis‹dî
 = 1,

212 
	mTCP_CA_CWR
 = 2,

213 
	mTCP_CA_Recovîy
 = 3,

214 
	mTCP_CA_Loss
 = 4

217 
	st˝_öfo


219 
uöt8_t
 
	mt˝i_°©e
;

220 
uöt8_t
 
	mt˝i_ˇ_°©e
;

221 
uöt8_t
 
	mt˝i_ªå™smôs
;

222 
uöt8_t
 
	mt˝i_¥obes
;

223 
uöt8_t
 
	mt˝i_backoff
;

224 
uöt8_t
 
	mt˝i_›ti⁄s
;

225 
uöt8_t
 
	mt˝i_¢d_wsˇÀ
 : 4, 
	mt˝i_rcv_wsˇÀ
 : 4;

227 
uöt32_t
 
	mt˝i_πo
;

228 
uöt32_t
 
	mt˝i_©o
;

229 
uöt32_t
 
	mt˝i_¢d_mss
;

230 
uöt32_t
 
	mt˝i_rcv_mss
;

232 
uöt32_t
 
	mt˝i_u«cked
;

233 
uöt32_t
 
	mt˝i_ßcked
;

234 
uöt32_t
 
	mt˝i_lo°
;

235 
uöt32_t
 
	mt˝i_ªå™s
;

236 
uöt32_t
 
	mt˝i_Áckës
;

239 
uöt32_t
 
	mt˝i_œ°_d©a_£¡
;

240 
uöt32_t
 
	mt˝i_œ°_ack_£¡
;

241 
uöt32_t
 
	mt˝i_œ°_d©a_ªcv
;

242 
uöt32_t
 
	mt˝i_œ°_ack_ªcv
;

245 
uöt32_t
 
	mt˝i_pmtu
;

246 
uöt32_t
 
	mt˝i_rcv_s°hªsh
;

247 
uöt32_t
 
	mt˝i_πt
;

248 
uöt32_t
 
	mt˝i_πtv¨
;

249 
uöt32_t
 
	mt˝i_¢d_s°hªsh
;

250 
uöt32_t
 
	mt˝i_¢d_cwnd
;

251 
uöt32_t
 
	mt˝i_advmss
;

252 
uöt32_t
 
	mt˝i_ª‹dîög
;

254 
uöt32_t
 
	mt˝i_rcv_πt
;

255 
uöt32_t
 
	mt˝i_rcv_•a˚
;

257 
uöt32_t
 
	mt˝i_tŸÆ_ªå™s
;

262 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

265 
	#TCP_MD5SIG_FLAG_PREFIX
 1

	)

267 
	st˝_md5sig


269 
sockaddr_°‹age
 
	mt˝m_addr
;

270 
uöt8_t
 
	mt˝m_Êags
;

271 
uöt8_t
 
	mt˝m_¥efixÀn
;

272 
uöt16_t
 
	mt˝m_keyÀn
;

273 
uöt32_t
 
	m__t˝m_∑d
;

274 
uöt8_t
 
	mt˝m_key
[
TCP_MD5SIG_MAXKEYLEN
];

278 
	st˝_ª∑ú_›t


280 
uöt32_t
 
	m›t_code
;

281 
uöt32_t
 
	m›t_vÆ
;

287 
	mTCP_NO_QUEUE
,

288 
	mTCP_RECV_QUEUE
,

289 
	mTCP_SEND_QUEUE
,

290 
	mTCP_QUEUES_NR
,

294 
	#TCP_COOKIE_MIN
 8

	)

295 
	#TCP_COOKIE_MAX
 16

	)

296 
	#TCP_COOKIE_PAIR_SIZE
 (2*
TCP_COOKIE_MAX
)

	)

299 
	#TCP_COOKIE_IN_ALWAYS
 (1 << 0Ë

	)

300 
	#TCP_COOKIE_OUT_NEVER
 (1 << 1Ë

	)

304 
	#TCP_S_DATA_IN
 (1 << 2Ë

	)

305 
	#TCP_S_DATA_OUT
 (1 << 3Ë

	)

307 
	#TCP_MSS_DEFAULT
 536U

	)

308 
	#TCP_MSS_DESIRED
 1220U

	)

310 
	st˝_cookõ_å™ß˘i⁄s


312 
uöt16_t
 
	mt˝˘_Êags
;

313 
uöt8_t
 
	m__t˝˘_∑d1
;

314 
uöt8_t
 
	mt˝˘_cookõ_desúed
;

315 
uöt16_t
 
	mt˝˘_s_d©a_desúed
;

316 
uöt16_t
 
	mt˝˘_u£d
;

317 
uöt8_t
 
	mt˝˘_vÆue
[
TCP_MSS_DEFAULT
];

321 
	st˝_ª∑ú_wödow


323 
uöt32_t
 
	m¢d_wl1
;

324 
uöt32_t
 
	m¢d_wnd
;

325 
uöt32_t
 
	mmax_wödow
;

326 
uöt32_t
 
	mrcv_wnd
;

327 
uöt32_t
 
	mrcv_wup
;

	@/usr/include/openssl/err.h

10 #i‚de‡
HEADER_ERR_H


11 
	#HEADER_ERR_H


	)

13 
	~<›ís¶/e_os2.h
>

15 #i‚de‡
OPENSSL_NO_STDIO


16 
	~<°dio.h
>

17 
	~<°dlib.h
>

20 
	~<›ís¶/os¶_typ.h
>

21 
	~<›ís¶/bio.h
>

22 
	~<›ís¶/lhash.h
>

24 #ifde‡ 
__˝lu•lus


28 #i‚de‡
OPENSSL_NO_ERR


29 
	#ERR_PUT_îr‹
(
a
,
b
,
c
,
d
,
e
Ë
	`ERR_put_îr‹
◊,b,c,d,e)

	)

31 
	#ERR_PUT_îr‹
(
a
,
b
,
c
,
d
,
e
Ë
	`ERR_put_îr‹
◊,b,c,
NULL
,0)

	)

34 
	~<î∫o.h
>

36 
	#ERR_TXT_MALLOCED
 0x01

	)

37 
	#ERR_TXT_STRING
 0x02

	)

39 
	#ERR_FLAG_MARK
 0x01

	)

40 
	#ERR_FLAG_CLEAR
 0x02

	)

42 
	#ERR_NUM_ERRORS
 16

	)

43 
	sîr_°©e_°
 {

44 
îr_Êags
[
ERR_NUM_ERRORS
];

45 
îr_buf„r
[
ERR_NUM_ERRORS
];

46 *
îr_d©a
[
ERR_NUM_ERRORS
];

47 
îr_d©a_Êags
[
ERR_NUM_ERRORS
];

48 c⁄° *
îr_fûe
[
ERR_NUM_ERRORS
];

49 
îr_löe
[
ERR_NUM_ERRORS
];

50 
t›
, 
bŸtom
;

51 } 
	tERR_STATE
;

54 
	#ERR_LIB_NONE
 1

	)

55 
	#ERR_LIB_SYS
 2

	)

56 
	#ERR_LIB_BN
 3

	)

57 
	#ERR_LIB_RSA
 4

	)

58 
	#ERR_LIB_DH
 5

	)

59 
	#ERR_LIB_EVP
 6

	)

60 
	#ERR_LIB_BUF
 7

	)

61 
	#ERR_LIB_OBJ
 8

	)

62 
	#ERR_LIB_PEM
 9

	)

63 
	#ERR_LIB_DSA
 10

	)

64 
	#ERR_LIB_X509
 11

	)

66 
	#ERR_LIB_ASN1
 13

	)

67 
	#ERR_LIB_CONF
 14

	)

68 
	#ERR_LIB_CRYPTO
 15

	)

69 
	#ERR_LIB_EC
 16

	)

70 
	#ERR_LIB_SSL
 20

	)

76 
	#ERR_LIB_BIO
 32

	)

77 
	#ERR_LIB_PKCS7
 33

	)

78 
	#ERR_LIB_X509V3
 34

	)

79 
	#ERR_LIB_PKCS12
 35

	)

80 
	#ERR_LIB_RAND
 36

	)

81 
	#ERR_LIB_DSO
 37

	)

82 
	#ERR_LIB_ENGINE
 38

	)

83 
	#ERR_LIB_OCSP
 39

	)

84 
	#ERR_LIB_UI
 40

	)

85 
	#ERR_LIB_COMP
 41

	)

86 
	#ERR_LIB_ECDSA
 42

	)

87 
	#ERR_LIB_ECDH
 43

	)

88 
	#ERR_LIB_OSSL_STORE
 44

	)

89 
	#ERR_LIB_FIPS
 45

	)

90 
	#ERR_LIB_CMS
 46

	)

91 
	#ERR_LIB_TS
 47

	)

92 
	#ERR_LIB_HMAC
 48

	)

94 
	#ERR_LIB_CT
 50

	)

95 
	#ERR_LIB_ASYNC
 51

	)

96 
	#ERR_LIB_KDF
 52

	)

97 
	#ERR_LIB_SM2
 53

	)

99 
	#ERR_LIB_USER
 128

	)

101 
	#SYSîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_SYS
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

102 
	#BNîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_BN
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

103 
	#RSAîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_RSA
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

104 
	#DHîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_DH
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

105 
	#EVPîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_EVP
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

106 
	#BUFîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_BUF
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

107 
	#OBJîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_OBJ
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

108 
	#PEMîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_PEM
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

109 
	#DSAîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_DSA
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

110 
	#X509îr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_X509
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

111 
	#ASN1îr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_ASN1
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

112 
	#CONFîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_CONF
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

113 
	#CRYPTOîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_CRYPTO
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

114 
	#ECîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_EC
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

115 
	#SSLîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_SSL
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

116 
	#BIOîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_BIO
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

117 
	#PKCS7îr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_PKCS7
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

118 
	#X509V3îr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_X509V3
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

119 
	#PKCS12îr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_PKCS12
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

120 
	#RANDîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_RAND
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

121 
	#DSOîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_DSO
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

122 
	#ENGINEîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_ENGINE
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

123 
	#OCSPîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_OCSP
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

124 
	#UIîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_UI
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

125 
	#COMPîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_COMP
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

126 
	#ECDSAîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_ECDSA
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

127 
	#ECDHîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_ECDH
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

128 
	#OSSL_STOREîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_OSSL_STORE
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

129 
	#FIPSîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_FIPS
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

130 
	#CMSîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_CMS
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

131 
	#TSîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_TS
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

132 
	#HMACîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_HMAC
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

133 
	#CTîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_CT
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

134 
	#ASYNCîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_ASYNC
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

135 
	#KDFîr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_KDF
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

136 
	#SM2îr
(
f
,
r
Ë
	`ERR_PUT_îr‹
(
ERR_LIB_SM2
,(f),‘),
OPENSSL_FILE
,
OPENSSL_LINE
)

	)

138 
	#ERR_PACK
(
l
,
f
,
r
) ( \

139 ((()(
l
) & 0x0FF) << 24L) | \

140 ((()(
f
) & 0xFFF) << 12L) | \

141 ((()(
r
Ë& 0xFFFËË)

	)

142 
	#ERR_GET_LIB
(
l
Ë()((÷Ë>> 24LË& 0x0FFL)

	)

143 
	#ERR_GET_FUNC
(
l
Ë()((÷Ë>> 12LË& 0xFFFL)

	)

144 
	#ERR_GET_REASON
(
l
Ë()–÷Ë& 0xFFFL)

	)

145 
	#ERR_FATAL_ERROR
(
l
Ë()–÷Ë& 
ERR_R_FATAL
)

	)

148 
	#SYS_F_FOPEN
 1

	)

149 
	#SYS_F_CONNECT
 2

	)

150 
	#SYS_F_GETSERVBYNAME
 3

	)

151 
	#SYS_F_SOCKET
 4

	)

152 
	#SYS_F_IOCTLSOCKET
 5

	)

153 
	#SYS_F_BIND
 6

	)

154 
	#SYS_F_LISTEN
 7

	)

155 
	#SYS_F_ACCEPT
 8

	)

156 
	#SYS_F_WSASTARTUP
 9

	)

157 
	#SYS_F_OPENDIR
 10

	)

158 
	#SYS_F_FREAD
 11

	)

159 
	#SYS_F_GETADDRINFO
 12

	)

160 
	#SYS_F_GETNAMEINFO
 13

	)

161 
	#SYS_F_SETSOCKOPT
 14

	)

162 
	#SYS_F_GETSOCKOPT
 15

	)

163 
	#SYS_F_GETSOCKNAME
 16

	)

164 
	#SYS_F_GETHOSTBYNAME
 17

	)

165 
	#SYS_F_FFLUSH
 18

	)

166 
	#SYS_F_OPEN
 19

	)

167 
	#SYS_F_CLOSE
 20

	)

168 
	#SYS_F_IOCTL
 21

	)

169 
	#SYS_F_STAT
 22

	)

170 
	#SYS_F_FCNTL
 23

	)

171 
	#SYS_F_FSTAT
 24

	)

174 
	#ERR_R_SYS_LIB
 
ERR_LIB_SYS


	)

175 
	#ERR_R_BN_LIB
 
ERR_LIB_BN


	)

176 
	#ERR_R_RSA_LIB
 
ERR_LIB_RSA


	)

177 
	#ERR_R_DH_LIB
 
ERR_LIB_DH


	)

178 
	#ERR_R_EVP_LIB
 
ERR_LIB_EVP


	)

179 
	#ERR_R_BUF_LIB
 
ERR_LIB_BUF


	)

180 
	#ERR_R_OBJ_LIB
 
ERR_LIB_OBJ


	)

181 
	#ERR_R_PEM_LIB
 
ERR_LIB_PEM


	)

182 
	#ERR_R_DSA_LIB
 
ERR_LIB_DSA


	)

183 
	#ERR_R_X509_LIB
 
ERR_LIB_X509


	)

184 
	#ERR_R_ASN1_LIB
 
ERR_LIB_ASN1


	)

185 
	#ERR_R_EC_LIB
 
ERR_LIB_EC


	)

186 
	#ERR_R_BIO_LIB
 
ERR_LIB_BIO


	)

187 
	#ERR_R_PKCS7_LIB
 
ERR_LIB_PKCS7


	)

188 
	#ERR_R_X509V3_LIB
 
ERR_LIB_X509V3


	)

189 
	#ERR_R_ENGINE_LIB
 
ERR_LIB_ENGINE


	)

190 
	#ERR_R_UI_LIB
 
ERR_LIB_UI


	)

191 
	#ERR_R_ECDSA_LIB
 
ERR_LIB_ECDSA


	)

192 
	#ERR_R_OSSL_STORE_LIB
 
ERR_LIB_OSSL_STORE


	)

194 
	#ERR_R_NESTED_ASN1_ERROR
 58

	)

195 
	#ERR_R_MISSING_ASN1_EOS
 63

	)

198 
	#ERR_R_FATAL
 64

	)

199 
	#ERR_R_MALLOC_FAILURE
 (1|
ERR_R_FATAL
)

	)

200 
	#ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED
 (2|
ERR_R_FATAL
)

	)

201 
	#ERR_R_PASSED_NULL_PARAMETER
 (3|
ERR_R_FATAL
)

	)

202 
	#ERR_R_INTERNAL_ERROR
 (4|
ERR_R_FATAL
)

	)

203 
	#ERR_R_DISABLED
 (5|
ERR_R_FATAL
)

	)

204 
	#ERR_R_INIT_FAIL
 (6|
ERR_R_FATAL
)

	)

205 
	#ERR_R_PASSED_INVALID_ARGUMENT
 (7)

	)

206 
	#ERR_R_OPERATION_FAIL
 (8|
ERR_R_FATAL
)

	)

213 
	sERR_°rög_d©a_°
 {

214 
îr‹
;

215 c⁄° *
°rög
;

216 } 
	tERR_STRING_DATA
;

218 
DEFINE_LHASH_OF
(
ERR_STRING_DATA
);

220 
ERR_put_îr‹
(
lib
, 
func
, 
ªas⁄
, c⁄° *
fûe
, 
löe
);

221 
ERR_£t_îr‹_d©a
(*
d©a
, 
Êags
);

223 
ERR_gë_îr‹
();

224 
ERR_gë_îr‹_löe
(c⁄° **
fûe
, *
löe
);

225 
ERR_gë_îr‹_löe_d©a
(c⁄° **
fûe
, *
löe
,

226 c⁄° **
d©a
, *
Êags
);

227 
ERR_≥ek_îr‹
();

228 
ERR_≥ek_îr‹_löe
(c⁄° **
fûe
, *
löe
);

229 
ERR_≥ek_îr‹_löe_d©a
(c⁄° **
fûe
, *
löe
,

230 c⁄° **
d©a
, *
Êags
);

231 
ERR_≥ek_œ°_îr‹
();

232 
ERR_≥ek_œ°_îr‹_löe
(c⁄° **
fûe
, *
löe
);

233 
ERR_≥ek_œ°_îr‹_löe_d©a
(c⁄° **
fûe
, *
löe
,

234 c⁄° **
d©a
, *
Êags
);

235 
ERR_˛ór_îr‹
();

236 *
ERR_îr‹_°rög
(
e
, *
buf
);

237 
ERR_îr‹_°rög_n
(
e
, *
buf
, 
size_t
 
Àn
);

238 c⁄° *
ERR_lib_îr‹_°rög
(
e
);

239 c⁄° *
ERR_func_îr‹_°rög
(
e
);

240 c⁄° *
ERR_ªas⁄_îr‹_°rög
(
e
);

241 
ERR_¥öt_îr‹s_cb
((*
cb
Ë(c⁄° *
°r
, 
size_t
 
Àn
, *
u
),

242 *
u
);

243 #i‚de‡
OPENSSL_NO_STDIO


244 
ERR_¥öt_îr‹s_Â
(
FILE
 *
Â
);

246 
ERR_¥öt_îr‹s
(
BIO
 *
bp
);

247 
ERR_add_îr‹_d©a
(
num
, ...);

248 
ERR_add_îr‹_vd©a
(
num
, 
va_li°
 
¨gs
);

249 
ERR_lﬂd_°rögs
(
lib
, 
ERR_STRING_DATA
 *
°r
);

250 
ERR_lﬂd_°rögs_c⁄°
(c⁄° 
ERR_STRING_DATA
 *
°r
);

251 
ERR_u∆ﬂd_°rögs
(
lib
, 
ERR_STRING_DATA
 *
°r
);

252 
ERR_lﬂd_ERR_°rögs
();

254 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

255 
	#ERR_lﬂd_¸y±o_°rögs
() \

256 
	`OPENSSL_öô_¸y±o
(
OPENSSL_INIT_LOAD_CRYPTO_STRINGS
, 
NULL
)

	)

257 
	#ERR_‰ì_°rögs
(Ë0Ë

	)

260 
DEPRECATEDIN_1_1_0
(
ERR_ªmove_thªad_°©e
(*))

261 
DEPRECATEDIN_1_0_0
(
ERR_ªmove_°©e
(
pid
))

262 
ERR_STATE
 *
ERR_gë_°©e
();

264 
ERR_gë_√xt_îr‹_libøry
();

266 
ERR_£t_m¨k
();

267 
ERR_p›_to_m¨k
();

268 
ERR_˛ór_œ°_m¨k
();

270 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/rand.h

10 #i‚de‡
HEADER_RAND_H


11 
	#HEADER_RAND_H


	)

13 
	~<°dlib.h
>

14 
	~<›ís¶/os¶_typ.h
>

15 
	~<›ís¶/e_os2.h
>

16 
	~<›ís¶/øndîr.h
>

18 #ifde‡ 
__˝lu•lus


22 
	sønd_mëh_°
 {

23 (*
£ed
Ë(c⁄° *
buf
, 
num
);

24 (*
byãs
Ë(*
buf
, 
num
);

25 (*
˛ónup
) ();

26 (*
add
Ë(c⁄° *
buf
, 
num
, 
øndom√ss
);

27 (*
p£ud‹™d
Ë(*
buf
, 
num
);

28 (*
°©us
) ();

31 
RAND_£t_ønd_mëhod
(c⁄° 
RAND_METHOD
 *
mëh
);

32 c⁄° 
RAND_METHOD
 *
RAND_gë_ønd_mëhod
();

33 #i‚de‡
OPENSSL_NO_ENGINE


34 
RAND_£t_ønd_ígöe
(
ENGINE
 *
ígöe
);

37 
RAND_METHOD
 *
RAND_O≥nSSL
();

39 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

40 
	#RAND_˛ónup
(Ë0Ë

	)

42 
RAND_byãs
(*
buf
, 
num
);

43 
RAND_¥iv_byãs
(*
buf
, 
num
);

44 
DEPRECATEDIN_1_1_0
(
RAND_p£udo_byãs
(*
buf
, 
num
))

46 
RAND_£ed
(c⁄° *
buf
, 
num
);

47 
RAND_kìp_øndom_devi˚s_›í
(
kìp
);

49 #i‡
deföed
(
__ANDROID__
Ë&& deföed(
__NDK_FPABI__
)

50 
__NDK_FPABI__


52 
RAND_add
(c⁄° *
buf
, 
num
, 
øndom√ss
);

53 
RAND_lﬂd_fûe
(c⁄° *
fûe
, 
max_byãs
);

54 
RAND_wrôe_fûe
(c⁄° *
fûe
);

55 c⁄° *
RAND_fûe_«me
(*
fûe
, 
size_t
 
num
);

56 
RAND_°©us
();

58 #i‚de‡
OPENSSL_NO_EGD


59 
RAND_quîy_egd_byãs
(c⁄° *
∑th
, *
buf
, 
byãs
);

60 
RAND_egd
(c⁄° *
∑th
);

61 
RAND_egd_byãs
(c⁄° *
∑th
, 
byãs
);

64 
RAND_pﬁl
();

66 #i‡
deföed
(
_WIN32
Ë&& (deföed(
BASETYPES
Ë|| deföed(
_WINDEF_H
))

68 
DEPRECATEDIN_1_1_0
(
RAND_s¸ìn
())

69 
DEPRECATEDIN_1_1_0
(
RAND_evít
(
UINT
, 
WPARAM
, 
LPARAM
))

73 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/ssl.h

12 #i‚de‡
HEADER_SSL_H


13 
	#HEADER_SSL_H


	)

15 
	~<›ís¶/e_os2.h
>

16 
	~<›ís¶/›ís¶c⁄f.h
>

17 
	~<›ís¶/comp.h
>

18 
	~<›ís¶/bio.h
>

19 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

20 
	~<›ís¶/x509.h
>

21 
	~<›ís¶/¸y±o.h
>

22 
	~<›ís¶/buf„r.h
>

24 
	~<›ís¶/lhash.h
>

25 
	~<›ís¶/≥m.h
>

26 
	~<›ís¶/hmac.h
>

27 
	~<›ís¶/async.h
>

29 
	~<›ís¶/ß„°ack.h
>

30 
	~<›ís¶/symhacks.h
>

31 
	~<›ís¶/˘.h
>

32 
	~<›ís¶/s¶îr.h
>

34 #ifde‡ 
__˝lu•lus


43 
	#SSL_SESSION_ASN1_VERSION
 0x0001

	)

45 
	#SSL_MAX_SSL_SESSION_ID_LENGTH
 32

	)

46 
	#SSL_MAX_SID_CTX_LENGTH
 32

	)

48 
	#SSL_MIN_RSA_MODULUS_LENGTH_IN_BYTES
 (512/8)

	)

49 
	#SSL_MAX_KEY_ARG_LENGTH
 8

	)

50 
	#SSL_MAX_MASTER_KEY_LENGTH
 48

	)

53 
	#SSL_MAX_PIPELINES
 32

	)

59 
	#SSL_TXT_LOW
 "LOW"

	)

60 
	#SSL_TXT_MEDIUM
 "MEDIUM"

	)

61 
	#SSL_TXT_HIGH
 "HIGH"

	)

62 
	#SSL_TXT_FIPS
 "FIPS"

	)

64 
	#SSL_TXT_aNULL
 "aNULL"

	)

65 
	#SSL_TXT_eNULL
 "eNULL"

	)

66 
	#SSL_TXT_NULL
 "NULL"

	)

68 
	#SSL_TXT_kRSA
 "kRSA"

	)

69 
	#SSL_TXT_kDHr
 "kDHr"

	)

70 
	#SSL_TXT_kDHd
 "kDHd"

	)

71 
	#SSL_TXT_kDH
 "kDH"

	)

72 
	#SSL_TXT_kEDH
 "kEDH"

	)

73 
	#SSL_TXT_kDHE
 "kDHE"

	)

74 
	#SSL_TXT_kECDHr
 "kECDHr"

	)

75 
	#SSL_TXT_kECDHe
 "kECDHe"

	)

76 
	#SSL_TXT_kECDH
 "kECDH"

	)

77 
	#SSL_TXT_kEECDH
 "kEECDH"

	)

78 
	#SSL_TXT_kECDHE
 "kECDHE"

	)

79 
	#SSL_TXT_kPSK
 "kPSK"

	)

80 
	#SSL_TXT_kRSAPSK
 "kRSAPSK"

	)

81 
	#SSL_TXT_kECDHEPSK
 "kECDHEPSK"

	)

82 
	#SSL_TXT_kDHEPSK
 "kDHEPSK"

	)

83 
	#SSL_TXT_kGOST
 "kGOST"

	)

84 
	#SSL_TXT_kSRP
 "kSRP"

	)

86 
	#SSL_TXT_aRSA
 "aRSA"

	)

87 
	#SSL_TXT_aDSS
 "aDSS"

	)

88 
	#SSL_TXT_aDH
 "aDH"

	)

89 
	#SSL_TXT_aECDH
 "aECDH"

	)

90 
	#SSL_TXT_aECDSA
 "aECDSA"

	)

91 
	#SSL_TXT_aPSK
 "aPSK"

	)

92 
	#SSL_TXT_aGOST94
 "aGOST94"

	)

93 
	#SSL_TXT_aGOST01
 "aGOST01"

	)

94 
	#SSL_TXT_aGOST12
 "aGOST12"

	)

95 
	#SSL_TXT_aGOST
 "aGOST"

	)

96 
	#SSL_TXT_aSRP
 "aSRP"

	)

98 
	#SSL_TXT_DSS
 "DSS"

	)

99 
	#SSL_TXT_DH
 "DH"

	)

100 
	#SSL_TXT_DHE
 "DHE"

	)

101 
	#SSL_TXT_EDH
 "EDH"

	)

102 
	#SSL_TXT_ADH
 "ADH"

	)

103 
	#SSL_TXT_RSA
 "RSA"

	)

104 
	#SSL_TXT_ECDH
 "ECDH"

	)

105 
	#SSL_TXT_EECDH
 "EECDH"

	)

106 
	#SSL_TXT_ECDHE
 "ECDHE"

	)

107 
	#SSL_TXT_AECDH
 "AECDH"

	)

108 
	#SSL_TXT_ECDSA
 "ECDSA"

	)

109 
	#SSL_TXT_PSK
 "PSK"

	)

110 
	#SSL_TXT_SRP
 "SRP"

	)

112 
	#SSL_TXT_DES
 "DES"

	)

113 
	#SSL_TXT_3DES
 "3DES"

	)

114 
	#SSL_TXT_RC4
 "RC4"

	)

115 
	#SSL_TXT_RC2
 "RC2"

	)

116 
	#SSL_TXT_IDEA
 "IDEA"

	)

117 
	#SSL_TXT_SEED
 "SEED"

	)

118 
	#SSL_TXT_AES128
 "AES128"

	)

119 
	#SSL_TXT_AES256
 "AES256"

	)

120 
	#SSL_TXT_AES
 "AES"

	)

121 
	#SSL_TXT_AES_GCM
 "AESGCM"

	)

122 
	#SSL_TXT_AES_CCM
 "AESCCM"

	)

123 
	#SSL_TXT_AES_CCM_8
 "AESCCM8"

	)

124 
	#SSL_TXT_CAMELLIA128
 "CAMELLIA128"

	)

125 
	#SSL_TXT_CAMELLIA256
 "CAMELLIA256"

	)

126 
	#SSL_TXT_CAMELLIA
 "CAMELLIA"

	)

127 
	#SSL_TXT_CHACHA20
 "CHACHA20"

	)

128 
	#SSL_TXT_GOST
 "GOST89"

	)

129 
	#SSL_TXT_ARIA
 "ARIA"

	)

130 
	#SSL_TXT_ARIA_GCM
 "ARIAGCM"

	)

131 
	#SSL_TXT_ARIA128
 "ARIA128"

	)

132 
	#SSL_TXT_ARIA256
 "ARIA256"

	)

134 
	#SSL_TXT_MD5
 "MD5"

	)

135 
	#SSL_TXT_SHA1
 "SHA1"

	)

136 
	#SSL_TXT_SHA
 "SHA"

	)

137 
	#SSL_TXT_GOST94
 "GOST94"

	)

138 
	#SSL_TXT_GOST89MAC
 "GOST89MAC"

	)

139 
	#SSL_TXT_GOST12
 "GOST12"

	)

140 
	#SSL_TXT_GOST89MAC12
 "GOST89MAC12"

	)

141 
	#SSL_TXT_SHA256
 "SHA256"

	)

142 
	#SSL_TXT_SHA384
 "SHA384"

	)

144 
	#SSL_TXT_SSLV3
 "SSLv3"

	)

145 
	#SSL_TXT_TLSV1
 "TLSv1"

	)

146 
	#SSL_TXT_TLSV1_1
 "TLSv1.1"

	)

147 
	#SSL_TXT_TLSV1_2
 "TLSv1.2"

	)

149 
	#SSL_TXT_ALL
 "ALL"

	)

165 
	#SSL_TXT_CMPALL
 "COMPLEMENTOFALL"

	)

166 
	#SSL_TXT_CMPDEF
 "COMPLEMENTOFDEFAULT"

	)

173 
	#SSL_DEFAULT_CIPHER_LIST
 "ALL:!COMPLEMENTOFDEFAULT:!eNULL"

	)

175 #i‡!
deföed
(
OPENSSL_NO_CHACHA
Ë&& !deföed(
OPENSSL_NO_POLY1305
)

176 
	#TLS_DEFAULT_CIPHERSUITES
 "TLS_AES_256_GCM_SHA384:" \

178 "TLS_AES_128_GCM_SHA256"

	)

180 
	#TLS_DEFAULT_CIPHERSUITES
 "TLS_AES_256_GCM_SHA384:" \

181 "TLS_AES_128_GCM_SHA256"

	)

191 
	#SSL_SENT_SHUTDOWN
 1

	)

192 
	#SSL_RECEIVED_SHUTDOWN
 2

	)

194 #ifde‡
__˝lu•lus


198 #ifde‡ 
__˝lu•lus


202 
	#SSL_FILETYPE_ASN1
 
X509_FILETYPE_ASN1


	)

203 
	#SSL_FILETYPE_PEM
 
X509_FILETYPE_PEM


	)

209 
s¶_°
 *
	ts¶_¸ock_°
;

210 
és_£ssi⁄_tickë_ext_°
 
	tTLS_SESSION_TICKET_EXT
;

211 
s¶_mëhod_°
 
	tSSL_METHOD
;

212 
s¶_cùhî_°
 
	tSSL_CIPHER
;

213 
s¶_£ssi⁄_°
 
	tSSL_SESSION
;

214 
és_sigÆgs_°
 
	tTLS_SIGALGS
;

215 
s¶_c⁄f_˘x_°
 
	tSSL_CONF_CTX
;

216 
s¶_comp_°
 
	tSSL_COMP
;

218 
STACK_OF
(
SSL_CIPHER
);

219 
STACK_OF
(
SSL_COMP
);

222 
	s§ç_¥Ÿe˘i⁄_¥ofûe_°
 {

223 c⁄° *
«me
;

224 
id
;

225 } 
	tSRTP_PROTECTION_PROFILE
;

227 
DEFINE_STACK_OF
(
SRTP_PROTECTION_PROFILE
)

229 (*
és_£ssi⁄_tickë_ext_cb_‚
)(
	tSSL
 *
	ts
, c⁄° *
	td©a
,

230 
	tÀn
, *
	t¨g
);

231 (*
és_£ssi⁄_£¸ë_cb_‚
)(
	tSSL
 *
	ts
, *
	t£¸ë
, *
	t£¸ë_Àn
,

232 
	tSTACK_OF
(
	tSSL_CIPHER
Ë*
	t≥î_cùhîs
,

233 c⁄° 
	tSSL_CIPHER
 **
	tcùhî
, *
	t¨g
);

237 
	#SSL_EXT_TLS_ONLY
 0x0001

	)

239 
	#SSL_EXT_DTLS_ONLY
 0x0002

	)

241 
	#SSL_EXT_TLS_IMPLEMENTATION_ONLY
 0x0004

	)

243 
	#SSL_EXT_SSL3_ALLOWED
 0x0008

	)

245 
	#SSL_EXT_TLS1_2_AND_BELOW_ONLY
 0x0010

	)

247 
	#SSL_EXT_TLS1_3_ONLY
 0x0020

	)

249 
	#SSL_EXT_IGNORE_ON_RESUMPTION
 0x0040

	)

250 
	#SSL_EXT_CLIENT_HELLO
 0x0080

	)

252 
	#SSL_EXT_TLS1_2_SERVER_HELLO
 0x0100

	)

253 
	#SSL_EXT_TLS1_3_SERVER_HELLO
 0x0200

	)

254 
	#SSL_EXT_TLS1_3_ENCRYPTED_EXTENSIONS
 0x0400

	)

255 
	#SSL_EXT_TLS1_3_HELLO_RETRY_REQUEST
 0x0800

	)

256 
	#SSL_EXT_TLS1_3_CERTIFICATE
 0x1000

	)

257 
	#SSL_EXT_TLS1_3_NEW_SESSION_TICKET
 0x2000

	)

258 
	#SSL_EXT_TLS1_3_CERTIFICATE_REQUEST
 0x4000

	)

262 (*
cu°om_ext_add_cb
)(
	tSSL
 *
	ts
, 
	text_ty≥
,

263 c⁄° **
	tout
, 
	tsize_t
 *
	touéí
,

264 *
	tÆ
, *
	tadd_¨g
);

266 (*
cu°om_ext_‰ì_cb
)(
	tSSL
 *
	ts
, 
	text_ty≥
,

267 c⁄° *
	tout
, *
	tadd_¨g
);

269 (*
cu°om_ext_∑r£_cb
)(
	tSSL
 *
	ts
, 
	text_ty≥
,

270 c⁄° *
	tö
, 
	tsize_t
 
	töÀn
,

271 *
	tÆ
, *
	t∑r£_¨g
);

274 (*
SSL_cu°om_ext_add_cb_ex
)(
	tSSL
 *
	ts
, 
	text_ty≥
,

275 
	tc⁄ãxt
,

276 c⁄° **
	tout
,

277 
	tsize_t
 *
	touéí
, 
	tX509
 *
	tx
,

278 
	tsize_t
 
	tchaöidx
,

279 *
	tÆ
, *
	tadd_¨g
);

281 (*
SSL_cu°om_ext_‰ì_cb_ex
)(
	tSSL
 *
	ts
, 
	text_ty≥
,

282 
	tc⁄ãxt
,

283 c⁄° *
	tout
,

284 *
	tadd_¨g
);

286 (*
SSL_cu°om_ext_∑r£_cb_ex
)(
	tSSL
 *
	ts
, 
	text_ty≥
,

287 
	tc⁄ãxt
,

288 c⁄° *
	tö
,

289 
	tsize_t
 
	töÀn
, 
	tX509
 *
	tx
,

290 
	tsize_t
 
	tchaöidx
,

291 *
	tÆ
, *
	t∑r£_¨g
);

294 (*
SSL_vîify_cb
)(
	t¥evîify_ok
, 
	tX509_STORE_CTX
 *
	tx509_˘x
);

304 
	#SSL_OP_LEGACY_SERVER_CONNECT
 0x00000004U

	)

307 
	#SSL_OP_TLSEXT_PADDING
 0x00000010U

	)

309 
	#SSL_OP_SAFARI_ECDHE_ECDSA_BUG
 0x00000040U

	)

317 
	#SSL_OP_ALLOW_NO_DHE_KEX
 0x00000400U

	)

326 
	#SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS
 0x00000800U

	)

329 
	#SSL_OP_NO_QUERY_MTU
 0x00001000U

	)

331 
	#SSL_OP_COOKIE_EXCHANGE
 0x00002000U

	)

333 
	#SSL_OP_NO_TICKET
 0x00004000U

	)

334 #i‚de‡
OPENSSL_NO_DTLS1_METHOD


337 
	#SSL_OP_CISCO_ANYCONNECT
 0x00008000U

	)

341 
	#SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION
 0x00010000U

	)

343 
	#SSL_OP_NO_COMPRESSION
 0x00020000U

	)

345 
	#SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION
 0x00040000U

	)

347 
	#SSL_OP_NO_ENCRYPT_THEN_MAC
 0x00080000U

	)

353 
	#SSL_OP_ENABLE_MIDDLEBOX_COMPAT
 0x00100000U

	)

357 
	#SSL_OP_PRIORITIZE_CHACHA
 0x00200000U

	)

362 
	#SSL_OP_CIPHER_SERVER_PREFERENCE
 0x00400000U

	)

369 
	#SSL_OP_TLS_ROLLBACK_BUG
 0x00800000U

	)

375 
	#SSL_OP_NO_ANTI_REPLAY
 0x01000000U

	)

377 
	#SSL_OP_NO_SSLv3
 0x02000000U

	)

378 
	#SSL_OP_NO_TLSv1
 0x04000000U

	)

379 
	#SSL_OP_NO_TLSv1_2
 0x08000000U

	)

380 
	#SSL_OP_NO_TLSv1_1
 0x10000000U

	)

381 
	#SSL_OP_NO_TLSv1_3
 0x20000000U

	)

383 
	#SSL_OP_NO_DTLSv1
 0x04000000U

	)

384 
	#SSL_OP_NO_DTLSv1_2
 0x08000000U

	)

386 
	#SSL_OP_NO_SSL_MASK
 (
SSL_OP_NO_SSLv3
|\

387 
SSL_OP_NO_TLSv1
|
SSL_OP_NO_TLSv1_1
|
SSL_OP_NO_TLSv1_2
|
SSL_OP_NO_TLSv1_3
)

	)

388 
	#SSL_OP_NO_DTLS_MASK
 (
SSL_OP_NO_DTLSv1
|
SSL_OP_NO_DTLSv1_2
)

	)

391 
	#SSL_OP_NO_RENEGOTIATION
 0x40000000U

	)

398 
	#SSL_OP_CRYPTOPRO_TLSEXT_BUG
 0x80000000U

	)

405 
	#SSL_OP_ALL
 (
SSL_OP_CRYPTOPRO_TLSEXT_BUG
|\

406 
SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS
|\

407 
SSL_OP_LEGACY_SERVER_CONNECT
|\

408 
SSL_OP_TLSEXT_PADDING
|\

409 
SSL_OP_SAFARI_ECDHE_ECDSA_BUG
)

	)

415 
	#SSL_OP_MICROSOFT_SESS_ID_BUG
 0x0

	)

418 
	#SSL_OP_NETSCAPE_CHALLENGE_BUG
 0x0

	)

421 
	#SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG
 0x0

	)

424 
	#SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG
 0x0

	)

426 
	#SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER
 0x0

	)

428 
	#SSL_OP_MSIE_SSLV2_RSA_PADDING
 0x0

	)

431 
	#SSL_OP_SSLEAY_080_CLIENT_DH_BUG
 0x0

	)

433 
	#SSL_OP_TLS_D5_BUG
 0x0

	)

435 
	#SSL_OP_TLS_BLOCK_PADDING_BUG
 0x0

	)

437 
	#SSL_OP_SINGLE_ECDH_USE
 0x0

	)

439 
	#SSL_OP_SINGLE_DH_USE
 0x0

	)

441 
	#SSL_OP_EPHEMERAL_RSA
 0x0

	)

443 
	#SSL_OP_NO_SSLv2
 0x0

	)

445 
	#SSL_OP_PKCS1_CHECK_1
 0x0

	)

447 
	#SSL_OP_PKCS1_CHECK_2
 0x0

	)

449 
	#SSL_OP_NETSCAPE_CA_DN_BUG
 0x0

	)

451 
	#SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG
 0x0

	)

457 
	#SSL_MODE_ENABLE_PARTIAL_WRITE
 0x00000001U

	)

464 
	#SSL_MODE_ACCEPT_MOVING_WRITE_BUFFER
 0x00000002U

	)

468 
	#SSL_MODE_AUTO_RETRY
 0x00000004U

	)

470 
	#SSL_MODE_NO_AUTO_CHAIN
 0x00000008U

	)

475 
	#SSL_MODE_RELEASE_BUFFERS
 0x00000010U

	)

481 
	#SSL_MODE_SEND_CLIENTHELLO_TIME
 0x00000020U

	)

482 
	#SSL_MODE_SEND_SERVERHELLO_TIME
 0x00000040U

	)

491 
	#SSL_MODE_SEND_FALLBACK_SCSV
 0x00000080U

	)

495 
	#SSL_MODE_ASYNC
 0x00000100U

	)

508 
	#SSL_MODE_DTLS_SCTP_LABEL_LENGTH_BUG
 0x00000400U

	)

515 
	#SSL_CERT_FLAG_TLS_STRICT
 0x00000001U

	)

518 
	#SSL_CERT_FLAG_SUITEB_128_LOS_ONLY
 0x10000

	)

520 
	#SSL_CERT_FLAG_SUITEB_192_LOS
 0x20000

	)

522 
	#SSL_CERT_FLAG_SUITEB_128_LOS
 0x30000

	)

525 
	#SSL_CERT_FLAG_BROKEN_PROTOCOL
 0x10000000

	)

529 
	#SSL_BUILD_CHAIN_FLAG_UNTRUSTED
 0x1

	)

531 
	#SSL_BUILD_CHAIN_FLAG_NO_ROOT
 0x2

	)

533 
	#SSL_BUILD_CHAIN_FLAG_CHECK
 0x4

	)

535 
	#SSL_BUILD_CHAIN_FLAG_IGNORE_ERROR
 0x8

	)

537 
	#SSL_BUILD_CHAIN_FLAG_CLEAR_ERROR
 0x10

	)

541 
	#CERT_PKEY_VALID
 0x1

	)

543 
	#CERT_PKEY_SIGN
 0x2

	)

545 
	#CERT_PKEY_EE_SIGNATURE
 0x10

	)

547 
	#CERT_PKEY_CA_SIGNATURE
 0x20

	)

549 
	#CERT_PKEY_EE_PARAM
 0x40

	)

551 
	#CERT_PKEY_CA_PARAM
 0x80

	)

553 
	#CERT_PKEY_EXPLICIT_SIGN
 0x100

	)

555 
	#CERT_PKEY_ISSUER_NAME
 0x200

	)

557 
	#CERT_PKEY_CERT_TYPE
 0x400

	)

559 
	#CERT_PKEY_SUITEB
 0x800

	)

561 
	#SSL_CONF_FLAG_CMDLINE
 0x1

	)

562 
	#SSL_CONF_FLAG_FILE
 0x2

	)

563 
	#SSL_CONF_FLAG_CLIENT
 0x4

	)

564 
	#SSL_CONF_FLAG_SERVER
 0x8

	)

565 
	#SSL_CONF_FLAG_SHOW_ERRORS
 0x10

	)

566 
	#SSL_CONF_FLAG_CERTIFICATE
 0x20

	)

567 
	#SSL_CONF_FLAG_REQUIRE_PRIVATE
 0x40

	)

569 
	#SSL_CONF_TYPE_UNKNOWN
 0x0

	)

570 
	#SSL_CONF_TYPE_STRING
 0x1

	)

571 
	#SSL_CONF_TYPE_FILE
 0x2

	)

572 
	#SSL_CONF_TYPE_DIR
 0x3

	)

573 
	#SSL_CONF_TYPE_NONE
 0x4

	)

576 
	#SSL_COOKIE_LENGTH
 4096

	)

583 
SSL_CTX_gë_›ti⁄s
(c⁄° 
SSL_CTX
 *
˘x
);

584 
SSL_gë_›ti⁄s
(c⁄° 
SSL
 *
s
);

585 
SSL_CTX_˛ór_›ti⁄s
(
SSL_CTX
 *
˘x
, 
›
);

586 
SSL_˛ór_›ti⁄s
(
SSL
 *
s
, 
›
);

587 
SSL_CTX_£t_›ti⁄s
(
SSL_CTX
 *
˘x
, 
›
);

588 
SSL_£t_›ti⁄s
(
SSL
 *
s
, 
›
);

590 
	#SSL_CTX_£t_mode
(
˘x
,
›
) \

591 
	`SSL_CTX_˘æ
((
˘x
),
SSL_CTRL_MODE
,(
›
),
NULL
)

	)

592 
	#SSL_CTX_˛ór_mode
(
˘x
,
›
) \

593 
	`SSL_CTX_˘æ
((
˘x
),
SSL_CTRL_CLEAR_MODE
,(
›
),
NULL
)

	)

594 
	#SSL_CTX_gë_mode
(
˘x
) \

595 
	`SSL_CTX_˘æ
((
˘x
),
SSL_CTRL_MODE
,0,
NULL
)

	)

596 
	#SSL_˛ór_mode
(
s¶
,
›
) \

597 
	`SSL_˘æ
((
s¶
),
SSL_CTRL_CLEAR_MODE
,(
›
),
NULL
)

	)

598 
	#SSL_£t_mode
(
s¶
,
›
) \

599 
	`SSL_˘æ
((
s¶
),
SSL_CTRL_MODE
,(
›
),
NULL
)

	)

600 
	#SSL_gë_mode
(
s¶
) \

601 
	`SSL_˘æ
((
s¶
),
SSL_CTRL_MODE
,0,
NULL
)

	)

602 
	#SSL_£t_mtu
(
s¶
, 
mtu
) \

603 
	`SSL_˘æ
((
s¶
),
SSL_CTRL_SET_MTU
,(
mtu
),
NULL
)

	)

604 
	#DTLS_£t_lök_mtu
(
s¶
, 
mtu
) \

605 
	`SSL_˘æ
((
s¶
),
DTLS_CTRL_SET_LINK_MTU
,(
mtu
),
NULL
)

	)

606 
	#DTLS_gë_lök_mö_mtu
(
s¶
) \

607 
	`SSL_˘æ
((
s¶
),
DTLS_CTRL_GET_LINK_MIN_MTU
,0,
NULL
)

	)

609 
	#SSL_gë_£cuª_ª√gŸüti⁄_suµ‹t
(
s¶
) \

610 
	`SSL_˘æ
((
s¶
), 
SSL_CTRL_GET_RI_SUPPORT
, 0, 
NULL
)

	)

612 #i‚de‡
OPENSSL_NO_HEARTBEATS


613 
	#SSL_hóπbót
(
s¶
) \

614 
	`SSL_˘æ
((
s¶
),
SSL_CTRL_DTLS_EXT_SEND_HEARTBEAT
,0,
NULL
)

	)

617 
	#SSL_CTX_£t_˚π_Êags
(
˘x
,
›
) \

618 
	`SSL_CTX_˘æ
((
˘x
),
SSL_CTRL_CERT_FLAGS
,(
›
),
NULL
)

	)

619 
	#SSL_£t_˚π_Êags
(
s
,
›
) \

620 
	`SSL_˘æ
((
s
),
SSL_CTRL_CERT_FLAGS
,(
›
),
NULL
)

	)

621 
	#SSL_CTX_˛ór_˚π_Êags
(
˘x
,
›
) \

622 
	`SSL_CTX_˘æ
((
˘x
),
SSL_CTRL_CLEAR_CERT_FLAGS
,(
›
),
NULL
)

	)

623 
	#SSL_˛ór_˚π_Êags
(
s
,
›
) \

624 
	`SSL_˘æ
((
s
),
SSL_CTRL_CLEAR_CERT_FLAGS
,(
›
),
NULL
)

	)

626 
SSL_CTX_£t_msg_ˇŒback
(
SSL_CTX
 *
˘x
,

627 (*
cb
Ë(
wrôe_p
, 
vîsi⁄
,

628 
c⁄ã¡_ty≥
, c⁄° *
buf
,

629 
size_t
 
Àn
, 
SSL
 *
s¶
, *
¨g
));

630 
SSL_£t_msg_ˇŒback
(
SSL
 *
s¶
,

631 (*
cb
Ë(
wrôe_p
, 
vîsi⁄
,

632 
c⁄ã¡_ty≥
, c⁄° *
buf
,

633 
size_t
 
Àn
, 
SSL
 *
s¶
, *
¨g
));

634 
	#SSL_CTX_£t_msg_ˇŒback_¨g
(
˘x
, 
¨g
Ë
	`SSL_CTX_˘æ
((˘x), 
SSL_CTRL_SET_MSG_CALLBACK_ARG
, 0, (¨g))

	)

635 
	#SSL_£t_msg_ˇŒback_¨g
(
s¶
, 
¨g
Ë
	`SSL_˘æ
((s¶), 
SSL_CTRL_SET_MSG_CALLBACK_ARG
, 0, (¨g))

	)

637 
	#SSL_gë_extms_suµ‹t
(
s
) \

638 
	`SSL_˘æ
((
s
),
SSL_CTRL_GET_EXTMS_SUPPORT
,0,
NULL
)

	)

640 #i‚de‡
OPENSSL_NO_SRP


643 
__owur
 
SSL_SRP_CTX_öô
(
SSL
 *
s
);

644 
__owur
 
SSL_CTX_SRP_CTX_öô
(
SSL_CTX
 *
˘x
);

645 
SSL_SRP_CTX_‰ì
(
SSL
 *
˘x
);

646 
SSL_CTX_SRP_CTX_‰ì
(
SSL_CTX
 *
˘x
);

647 
__owur
 
SSL_§p_£rvî_∑øm_wôh_u£∫ame
(
SSL
 *
s
, *
ad
);

648 
__owur
 
SRP_CÆc_A_∑øm
(
SSL
 *
s
);

653 
	#SSL_MAX_CERT_LIST_DEFAULT
 1024*100

	)

655 
	#SSL_SESSION_CACHE_MAX_SIZE_DEFAULT
 (1024*20)

	)

669 (*
GEN_SESSION_CB
Ë(
	tSSL
 *
	ts¶
, *
	tid
,

670 *
	tid_Àn
);

672 
	#SSL_SESS_CACHE_OFF
 0x0000

	)

673 
	#SSL_SESS_CACHE_CLIENT
 0x0001

	)

674 
	#SSL_SESS_CACHE_SERVER
 0x0002

	)

675 
	#SSL_SESS_CACHE_BOTH
 (
SSL_SESS_CACHE_CLIENT
|
SSL_SESS_CACHE_SERVER
)

	)

676 
	#SSL_SESS_CACHE_NO_AUTO_CLEAR
 0x0080

	)

678 
	#SSL_SESS_CACHE_NO_INTERNAL_LOOKUP
 0x0100

	)

679 
	#SSL_SESS_CACHE_NO_INTERNAL_STORE
 0x0200

	)

680 
	#SSL_SESS_CACHE_NO_INTERNAL
 \

681 (
SSL_SESS_CACHE_NO_INTERNAL_LOOKUP
|
SSL_SESS_CACHE_NO_INTERNAL_STORE
)

	)

683 
LHASH_OF
(
SSL_SESSION
Ë*
SSL_CTX_£ssi⁄s
(
SSL_CTX
 *
˘x
);

684 
	#SSL_CTX_£ss_numbî
(
˘x
) \

685 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_NUMBER
,0,
NULL
)

	)

686 
	#SSL_CTX_£ss_c⁄√˘
(
˘x
) \

687 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_CONNECT
,0,
NULL
)

	)

688 
	#SSL_CTX_£ss_c⁄√˘_good
(
˘x
) \

689 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_CONNECT_GOOD
,0,
NULL
)

	)

690 
	#SSL_CTX_£ss_c⁄√˘_ª√gŸüã
(
˘x
) \

691 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_CONNECT_RENEGOTIATE
,0,
NULL
)

	)

692 
	#SSL_CTX_£ss_ac˚±
(
˘x
) \

693 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_ACCEPT
,0,
NULL
)

	)

694 
	#SSL_CTX_£ss_ac˚±_ª√gŸüã
(
˘x
) \

695 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_ACCEPT_RENEGOTIATE
,0,
NULL
)

	)

696 
	#SSL_CTX_£ss_ac˚±_good
(
˘x
) \

697 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_ACCEPT_GOOD
,0,
NULL
)

	)

698 
	#SSL_CTX_£ss_hôs
(
˘x
) \

699 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_HIT
,0,
NULL
)

	)

700 
	#SSL_CTX_£ss_cb_hôs
(
˘x
) \

701 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_CB_HIT
,0,
NULL
)

	)

702 
	#SSL_CTX_£ss_mis£s
(
˘x
) \

703 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_MISSES
,0,
NULL
)

	)

704 
	#SSL_CTX_£ss_timeouts
(
˘x
) \

705 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_TIMEOUTS
,0,
NULL
)

	)

706 
	#SSL_CTX_£ss_ˇche_fuŒ
(
˘x
) \

707 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SESS_CACHE_FULL
,0,
NULL
)

	)

709 
SSL_CTX_£ss_£t_√w_cb
(
SSL_CTX
 *
˘x
,

710 (*
√w_£ssi⁄_cb
Ë(
s¶_°
 *
s¶
,

711 
SSL_SESSION
 *
£ss
));

712 (*
SSL_CTX_£ss_gë_√w_cb
(
SSL_CTX
 *
˘x
)Ë(
s¶_°
 *
s¶
,

713 
SSL_SESSION
 *
£ss
);

714 
SSL_CTX_£ss_£t_ªmove_cb
(
SSL_CTX
 *
˘x
,

715 (*
ªmove_£ssi⁄_cb
Ë(
s¶_˘x_°


716 *
˘x
,

717 
SSL_SESSION
 *
£ss
));

718 (*
SSL_CTX_£ss_gë_ªmove_cb
(
SSL_CTX
 *
˘x
)Ë(
s¶_˘x_°
 *ctx,

719 
SSL_SESSION
 *
£ss
);

720 
SSL_CTX_£ss_£t_gë_cb
(
SSL_CTX
 *
˘x
,

721 
SSL_SESSION
 *(*
gë_£ssi⁄_cb
Ë(
s¶_°


722 *
s¶
,

724 *
d©a
, 
Àn
,

725 *
c›y
));

726 
SSL_SESSION
 *(*
SSL_CTX_£ss_gë_gë_cb
(
SSL_CTX
 *
˘x
)Ë(
s¶_°
 *
s¶
,

727 c⁄° *
d©a
,

728 
Àn
, *
c›y
);

729 
SSL_CTX_£t_öfo_ˇŒback
(
SSL_CTX
 *
˘x
,

730 (*
cb
Ë(c⁄° 
SSL
 *
s¶
, 
ty≥
, 
vÆ
));

731 (*
SSL_CTX_gë_öfo_ˇŒback
(
SSL_CTX
 *
˘x
)Ë(c⁄° 
SSL
 *
s¶
, 
ty≥
,

732 
vÆ
);

733 
SSL_CTX_£t_˛õ¡_˚π_cb
(
SSL_CTX
 *
˘x
,

734 (*
˛õ¡_˚π_cb
Ë(
SSL
 *
s¶
, 
X509
 **
x509
,

735 
EVP_PKEY
 **
pkey
));

736 (*
SSL_CTX_gë_˛õ¡_˚π_cb
(
SSL_CTX
 *
˘x
)Ë(
SSL
 *
s¶
, 
X509
 **
x509
,

737 
EVP_PKEY
 **
pkey
);

738 #i‚de‡
OPENSSL_NO_ENGINE


739 
__owur
 
SSL_CTX_£t_˛õ¡_˚π_ígöe
(
SSL_CTX
 *
˘x
, 
ENGINE
 *
e
);

741 
SSL_CTX_£t_cookõ_gíî©e_cb
(
SSL_CTX
 *
˘x
,

742 (*
≠p_gí_cookõ_cb
Ë(
SSL
 *
s¶
,

744 *
cookõ
,

746 *
cookõ_Àn
));

747 
SSL_CTX_£t_cookõ_vîify_cb
(
SSL_CTX
 *
˘x
,

748 (*
≠p_vîify_cookõ_cb
Ë(
SSL
 *
s¶
,

750 *
cookõ
,

752 
cookõ_Àn
));

754 
SSL_CTX_£t_°©ñess_cookõ_gíî©e_cb
(

755 
SSL_CTX
 *
˘x
,

756 (*
gí_°©ñess_cookõ_cb
Ë(
SSL
 *
s¶
,

757 *
cookõ
,

758 
size_t
 *
cookõ_Àn
));

759 
SSL_CTX_£t_°©ñess_cookõ_vîify_cb
(

760 
SSL_CTX
 *
˘x
,

761 (*
vîify_°©ñess_cookõ_cb
Ë(
SSL
 *
s¶
,

762 c⁄° *
cookõ
,

763 
size_t
 
cookõ_Àn
));

764 #i‚de‡
OPENSSL_NO_NEXTPROTONEG


766 (*
SSL_CTX_≈n_advîti£d_cb_func
)(
	tSSL
 *
	ts¶
,

767 c⁄° **
	tout
,

768 *
	touéí
,

769 *
	t¨g
);

770 
SSL_CTX_£t_√xt_¥Ÿos_advîti£d_cb
(
SSL_CTX
 *
s
,

771 
SSL_CTX_≈n_advîti£d_cb_func
 
cb
,

772 *
¨g
);

773 
	#SSL_CTX_£t_≈n_advîti£d_cb
 
SSL_CTX_£t_√xt_¥Ÿos_advîti£d_cb


	)

775 (*
SSL_CTX_≈n_£À˘_cb_func
)(
	tSSL
 *
	ts
,

776 **
	tout
,

777 *
	touéí
,

778 c⁄° *
	tö
,

779 
	töÀn
,

780 *
	t¨g
);

781 
SSL_CTX_£t_√xt_¥Ÿo_£À˘_cb
(
SSL_CTX
 *
s
,

782 
SSL_CTX_≈n_£À˘_cb_func
 
cb
,

783 *
¨g
);

784 
	#SSL_CTX_£t_≈n_£À˘_cb
 
SSL_CTX_£t_√xt_¥Ÿo_£À˘_cb


	)

786 
SSL_gë0_√xt_¥Ÿo_√gŸüãd
(c⁄° 
SSL
 *
s
, c⁄° **
d©a
,

787 *
Àn
);

788 
	#SSL_gë0_≈n_√gŸüãd
 
SSL_gë0_√xt_¥Ÿo_√gŸüãd


	)

791 
__owur
 
SSL_£À˘_√xt_¥Ÿo
(**
out
, *
ouéí
,

792 c⁄° *
ö
, 
öÀn
,

793 c⁄° *
˛õ¡
,

794 
˛õ¡_Àn
);

796 
	#OPENSSL_NPN_UNSUPPORTED
 0

	)

797 
	#OPENSSL_NPN_NEGOTIATED
 1

	)

798 
	#OPENSSL_NPN_NO_OVERLAP
 2

	)

800 
__owur
 
SSL_CTX_£t_Æ≤_¥Ÿos
(
SSL_CTX
 *
˘x
, c⁄° *
¥Ÿos
,

801 
¥Ÿos_Àn
);

802 
__owur
 
SSL_£t_Æ≤_¥Ÿos
(
SSL
 *
s¶
, c⁄° *
¥Ÿos
,

803 
¥Ÿos_Àn
);

804 (*
SSL_CTX_Æ≤_£À˘_cb_func
)(
	tSSL
 *
	ts¶
,

805 c⁄° **
	tout
,

806 *
	touéí
,

807 c⁄° *
	tö
,

808 
	töÀn
,

809 *
	t¨g
);

810 
SSL_CTX_£t_Æ≤_£À˘_cb
(
SSL_CTX
 *
˘x
,

811 
SSL_CTX_Æ≤_£À˘_cb_func
 
cb
,

812 *
¨g
);

813 
SSL_gë0_Æ≤_£À˘ed
(c⁄° 
SSL
 *
s¶
, c⁄° **
d©a
,

814 *
Àn
);

816 #i‚de‡
OPENSSL_NO_PSK


821 
	#PSK_MAX_IDENTITY_LEN
 128

	)

822 
	#PSK_MAX_PSK_LEN
 256

	)

823 (*
	tSSL_psk_˛õ¡_cb_func
)(
	tSSL
 *
	ts¶
,

824 c⁄° *
	thöt
,

825 *
	tidítôy
,

826 
	tmax_idítôy_Àn
,

827 *
	tpsk
,

828 
	tmax_psk_Àn
);

829 
SSL_CTX_£t_psk_˛õ¡_ˇŒback
(
SSL_CTX
 *
˘x
, 
SSL_psk_˛õ¡_cb_func
 
cb
);

830 
SSL_£t_psk_˛õ¡_ˇŒback
(
SSL
 *
s¶
, 
SSL_psk_˛õ¡_cb_func
 
cb
);

832 (*
	tSSL_psk_£rvî_cb_func
)(
	tSSL
 *
	ts¶
,

833 c⁄° *
	tidítôy
,

834 *
	tpsk
,

835 
	tmax_psk_Àn
);

836 
SSL_CTX_£t_psk_£rvî_ˇŒback
(
SSL_CTX
 *
˘x
, 
SSL_psk_£rvî_cb_func
 
cb
);

837 
SSL_£t_psk_£rvî_ˇŒback
(
SSL
 *
s¶
, 
SSL_psk_£rvî_cb_func
 
cb
);

839 
__owur
 
SSL_CTX_u£_psk_idítôy_höt
(
SSL_CTX
 *
˘x
, c⁄° *
idítôy_höt
);

840 
__owur
 
SSL_u£_psk_idítôy_höt
(
SSL
 *
s
, c⁄° *
idítôy_höt
);

841 c⁄° *
SSL_gë_psk_idítôy_höt
(c⁄° 
SSL
 *
s
);

842 c⁄° *
SSL_gë_psk_idítôy
(c⁄° 
SSL
 *
s
);

845 (*
SSL_psk_föd_£ssi⁄_cb_func
)(
	tSSL
 *
	ts¶
,

846 c⁄° *
	tidítôy
,

847 
	tsize_t
 
	tidítôy_Àn
,

848 
	tSSL_SESSION
 **
	t£ss
);

849 (*
SSL_psk_u£_£ssi⁄_cb_func
)(
	tSSL
 *
	ts¶
, c⁄° 
	tEVP_MD
 *
	tmd
,

850 c⁄° **
	tid
,

851 
	tsize_t
 *
	tidÀn
,

852 
	tSSL_SESSION
 **
	t£ss
);

854 
SSL_£t_psk_föd_£ssi⁄_ˇŒback
(
SSL
 *
s
, 
SSL_psk_föd_£ssi⁄_cb_func
 
cb
);

855 
SSL_CTX_£t_psk_föd_£ssi⁄_ˇŒback
(
SSL_CTX
 *
˘x
,

856 
SSL_psk_föd_£ssi⁄_cb_func
 
cb
);

857 
SSL_£t_psk_u£_£ssi⁄_ˇŒback
(
SSL
 *
s
, 
SSL_psk_u£_£ssi⁄_cb_func
 
cb
);

858 
SSL_CTX_£t_psk_u£_£ssi⁄_ˇŒback
(
SSL_CTX
 *
˘x
,

859 
SSL_psk_u£_£ssi⁄_cb_func
 
cb
);

863 
__owur
 
SSL_CTX_has_˛õ¡_cu°om_ext
(c⁄° 
SSL_CTX
 *
˘x
,

864 
ext_ty≥
);

866 
__owur
 
SSL_CTX_add_˛õ¡_cu°om_ext
(
SSL_CTX
 *
˘x
,

867 
ext_ty≥
,

868 
cu°om_ext_add_cb
 
add_cb
,

869 
cu°om_ext_‰ì_cb
 
‰ì_cb
,

870 *
add_¨g
,

871 
cu°om_ext_∑r£_cb
 
∑r£_cb
,

872 *
∑r£_¨g
);

874 
__owur
 
SSL_CTX_add_£rvî_cu°om_ext
(
SSL_CTX
 *
˘x
,

875 
ext_ty≥
,

876 
cu°om_ext_add_cb
 
add_cb
,

877 
cu°om_ext_‰ì_cb
 
‰ì_cb
,

878 *
add_¨g
,

879 
cu°om_ext_∑r£_cb
 
∑r£_cb
,

880 *
∑r£_¨g
);

882 
__owur
 
SSL_CTX_add_cu°om_ext
(
SSL_CTX
 *
˘x
, 
ext_ty≥
,

883 
c⁄ãxt
,

884 
SSL_cu°om_ext_add_cb_ex
 
add_cb
,

885 
SSL_cu°om_ext_‰ì_cb_ex
 
‰ì_cb
,

886 *
add_¨g
,

887 
SSL_cu°om_ext_∑r£_cb_ex
 
∑r£_cb
,

888 *
∑r£_¨g
);

890 
__owur
 
SSL_exãnsi⁄_suµ‹ãd
(
ext_ty≥
);

892 
	#SSL_NOTHING
 1

	)

893 
	#SSL_WRITING
 2

	)

894 
	#SSL_READING
 3

	)

895 
	#SSL_X509_LOOKUP
 4

	)

896 
	#SSL_ASYNC_PAUSED
 5

	)

897 
	#SSL_ASYNC_NO_JOBS
 6

	)

898 
	#SSL_CLIENT_HELLO_CB
 7

	)

901 
	#SSL_w™t_nŸhög
(
s
Ë(
	`SSL_w™t
(sË=
SSL_NOTHING
)

	)

902 
	#SSL_w™t_ªad
(
s
Ë(
	`SSL_w™t
(sË=
SSL_READING
)

	)

903 
	#SSL_w™t_wrôe
(
s
Ë(
	`SSL_w™t
(sË=
SSL_WRITING
)

	)

904 
	#SSL_w™t_x509_lookup
(
s
Ë(
	`SSL_w™t
(sË=
SSL_X509_LOOKUP
)

	)

905 
	#SSL_w™t_async
(
s
Ë(
	`SSL_w™t
(sË=
SSL_ASYNC_PAUSED
)

	)

906 
	#SSL_w™t_async_job
(
s
Ë(
	`SSL_w™t
(sË=
SSL_ASYNC_NO_JOBS
)

	)

907 
	#SSL_w™t_˛õ¡_hñlo_cb
(
s
Ë(
	`SSL_w™t
(sË=
SSL_CLIENT_HELLO_CB
)

	)

909 
	#SSL_MAC_FLAG_READ_MAC_STREAM
 1

	)

910 
	#SSL_MAC_FLAG_WRITE_MAC_STREAM
 2

	)

916 (*
SSL_CTX_keylog_cb_func
)(c⁄° 
	tSSL
 *
	ts¶
, c⁄° *
	tlöe
);

923 
SSL_CTX_£t_keylog_ˇŒback
(
SSL_CTX
 *
˘x
, 
SSL_CTX_keylog_cb_func
 
cb
);

929 
SSL_CTX_keylog_cb_func
 
SSL_CTX_gë_keylog_ˇŒback
(c⁄° 
SSL_CTX
 *
˘x
);

931 
SSL_CTX_£t_max_óæy_d©a
(
SSL_CTX
 *
˘x
, 
uöt32_t
 
max_óæy_d©a
);

932 
uöt32_t
 
SSL_CTX_gë_max_óæy_d©a
(c⁄° 
SSL_CTX
 *
˘x
);

933 
SSL_£t_max_óæy_d©a
(
SSL
 *
s
, 
uöt32_t
 
max_óæy_d©a
);

934 
uöt32_t
 
SSL_gë_max_óæy_d©a
(c⁄° 
SSL
 *
s
);

935 
SSL_CTX_£t_ªcv_max_óæy_d©a
(
SSL_CTX
 *
˘x
, 
uöt32_t
 
ªcv_max_óæy_d©a
);

936 
uöt32_t
 
SSL_CTX_gë_ªcv_max_óæy_d©a
(c⁄° 
SSL_CTX
 *
˘x
);

937 
SSL_£t_ªcv_max_óæy_d©a
(
SSL
 *
s
, 
uöt32_t
 
ªcv_max_óæy_d©a
);

938 
uöt32_t
 
SSL_gë_ªcv_max_óæy_d©a
(c⁄° 
SSL
 *
s
);

940 #ifde‡
__˝lu•lus


944 
	~<›ís¶/s¶2.h
>

945 
	~<›ís¶/s¶3.h
>

946 
	~<›ís¶/és1.h
>

947 
	~<›ís¶/dés1.h
>

948 
	~<›ís¶/§ç.h
>

950 #ifde‡ 
__˝lu•lus


958 
DEFINE_STACK_OF_CONST
(
SSL_CIPHER
)

959 
DEFINE_STACK_OF
(
SSL_COMP
)

962 
	#SSL_£t_≠p_d©a
(
s
,
¨g
Ë(
	`SSL_£t_ex_d©a
(s,0,(*)◊rg)))

	)

963 
	#SSL_gë_≠p_d©a
(
s
Ë(
	`SSL_gë_ex_d©a
(s,0))

	)

964 
	#SSL_SESSION_£t_≠p_d©a
(
s
,
a
Ë(
	`SSL_SESSION_£t_ex_d©a
(s,0, \

965 (*)(
a
)))

	)

966 
	#SSL_SESSION_gë_≠p_d©a
(
s
Ë(
	`SSL_SESSION_gë_ex_d©a
(s,0))

	)

967 
	#SSL_CTX_gë_≠p_d©a
(
˘x
Ë(
	`SSL_CTX_gë_ex_d©a
(˘x,0))

	)

968 
	#SSL_CTX_£t_≠p_d©a
(
˘x
,
¨g
Ë(
	`SSL_CTX_£t_ex_d©a
(ctx,0, \

969 (*)(
¨g
)))

	)

970 
DEPRECATEDIN_1_1_0
(
SSL_£t_debug
(
SSL
 *
s
, 
debug
))

974 
	#SSL_KEY_UPDATE_NONE
 -1

	)

976 
	#SSL_KEY_UPDATE_NOT_REQUESTED
 0

	)

977 
	#SSL_KEY_UPDATE_REQUESTED
 1

	)

992 
TLS_ST_BEFORE
,

993 
TLS_ST_OK
,

994 
DTLS_ST_CR_HELLO_VERIFY_REQUEST
,

995 
TLS_ST_CR_SRVR_HELLO
,

996 
TLS_ST_CR_CERT
,

997 
TLS_ST_CR_CERT_STATUS
,

998 
TLS_ST_CR_KEY_EXCH
,

999 
TLS_ST_CR_CERT_REQ
,

1000 
TLS_ST_CR_SRVR_DONE
,

1001 
TLS_ST_CR_SESSION_TICKET
,

1002 
TLS_ST_CR_CHANGE
,

1003 
TLS_ST_CR_FINISHED
,

1004 
TLS_ST_CW_CLNT_HELLO
,

1005 
TLS_ST_CW_CERT
,

1006 
TLS_ST_CW_KEY_EXCH
,

1007 
TLS_ST_CW_CERT_VRFY
,

1008 
TLS_ST_CW_CHANGE
,

1009 
TLS_ST_CW_NEXT_PROTO
,

1010 
TLS_ST_CW_FINISHED
,

1011 
TLS_ST_SW_HELLO_REQ
,

1012 
TLS_ST_SR_CLNT_HELLO
,

1013 
DTLS_ST_SW_HELLO_VERIFY_REQUEST
,

1014 
TLS_ST_SW_SRVR_HELLO
,

1015 
TLS_ST_SW_CERT
,

1016 
TLS_ST_SW_KEY_EXCH
,

1017 
TLS_ST_SW_CERT_REQ
,

1018 
TLS_ST_SW_SRVR_DONE
,

1019 
TLS_ST_SR_CERT
,

1020 
TLS_ST_SR_KEY_EXCH
,

1021 
TLS_ST_SR_CERT_VRFY
,

1022 
TLS_ST_SR_NEXT_PROTO
,

1023 
TLS_ST_SR_CHANGE
,

1024 
TLS_ST_SR_FINISHED
,

1025 
TLS_ST_SW_SESSION_TICKET
,

1026 
TLS_ST_SW_CERT_STATUS
,

1027 
TLS_ST_SW_CHANGE
,

1028 
TLS_ST_SW_FINISHED
,

1029 
TLS_ST_SW_ENCRYPTED_EXTENSIONS
,

1030 
TLS_ST_CR_ENCRYPTED_EXTENSIONS
,

1031 
TLS_ST_CR_CERT_VRFY
,

1032 
TLS_ST_SW_CERT_VRFY
,

1033 
TLS_ST_CR_HELLO_REQ
,

1034 
TLS_ST_SW_KEY_UPDATE
,

1035 
TLS_ST_CW_KEY_UPDATE
,

1036 
TLS_ST_SR_KEY_UPDATE
,

1037 
TLS_ST_CR_KEY_UPDATE
,

1038 
TLS_ST_EARLY_DATA
,

1039 
TLS_ST_PENDING_EARLY_DATA_END
,

1040 
TLS_ST_CW_END_OF_EARLY_DATA
,

1041 
TLS_ST_SR_END_OF_EARLY_DATA


1042 } 
	tOSSL_HANDSHAKE_STATE
;

1052 
	#SSL_ST_CONNECT
 0x1000

	)

1053 
	#SSL_ST_ACCEPT
 0x2000

	)

1055 
	#SSL_ST_MASK
 0x0FFF

	)

1057 
	#SSL_CB_LOOP
 0x01

	)

1058 
	#SSL_CB_EXIT
 0x02

	)

1059 
	#SSL_CB_READ
 0x04

	)

1060 
	#SSL_CB_WRITE
 0x08

	)

1061 
	#SSL_CB_ALERT
 0x4000

	)

1062 
	#SSL_CB_READ_ALERT
 (
SSL_CB_ALERT
|
SSL_CB_READ
)

	)

1063 
	#SSL_CB_WRITE_ALERT
 (
SSL_CB_ALERT
|
SSL_CB_WRITE
)

	)

1064 
	#SSL_CB_ACCEPT_LOOP
 (
SSL_ST_ACCEPT
|
SSL_CB_LOOP
)

	)

1065 
	#SSL_CB_ACCEPT_EXIT
 (
SSL_ST_ACCEPT
|
SSL_CB_EXIT
)

	)

1066 
	#SSL_CB_CONNECT_LOOP
 (
SSL_ST_CONNECT
|
SSL_CB_LOOP
)

	)

1067 
	#SSL_CB_CONNECT_EXIT
 (
SSL_ST_CONNECT
|
SSL_CB_EXIT
)

	)

1068 
	#SSL_CB_HANDSHAKE_START
 0x10

	)

1069 
	#SSL_CB_HANDSHAKE_DONE
 0x20

	)

1072 
	#SSL_ö_c⁄√˘_öô
(
a
Ë(
	`SSL_ö_öô
◊Ë&& !
	`SSL_is_£rvî
◊))

	)

1073 
	#SSL_ö_ac˚±_öô
(
a
Ë(
	`SSL_ö_öô
◊Ë&& 
	`SSL_is_£rvî
◊))

	)

1074 
SSL_ö_öô
(c⁄° 
SSL
 *
s
);

1075 
SSL_ö_bef‹e
(c⁄° 
SSL
 *
s
);

1076 
SSL_is_öô_föished
(c⁄° 
SSL
 *
s
);

1082 
	#SSL_ST_READ_HEADER
 0xF0

	)

1083 
	#SSL_ST_READ_BODY
 0xF1

	)

1084 
	#SSL_ST_READ_DONE
 0xF2

	)

1092 
size_t
 
SSL_gë_föished
(c⁄° 
SSL
 *
s
, *
buf
, size_à
cou¡
);

1093 
size_t
 
SSL_gë_≥î_föished
(c⁄° 
SSL
 *
s
, *
buf
, size_à
cou¡
);

1099 
	#SSL_VERIFY_NONE
 0x00

	)

1100 
	#SSL_VERIFY_PEER
 0x01

	)

1101 
	#SSL_VERIFY_FAIL_IF_NO_PEER_CERT
 0x02

	)

1102 
	#SSL_VERIFY_CLIENT_ONCE
 0x04

	)

1103 
	#SSL_VERIFY_POST_HANDSHAKE
 0x08

	)

1105 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

1106 
	#O≥nSSL_add_s¶_Æg‹ôhms
(Ë
	`SSL_libøry_öô
()

	)

1107 
	#SSLóy_add_s¶_Æg‹ôhms
(Ë
	`SSL_libøry_öô
()

	)

1111 
	#SSL_gë_cùhî
(
s
) \

1112 
	`SSL_CIPHER_gë_«me
(
	`SSL_gë_cuºít_cùhî
(
s
))

	)

1113 
	#SSL_gë_cùhî_bôs
(
s
,
≈
) \

1114 
	`SSL_CIPHER_gë_bôs
(
	`SSL_gë_cuºít_cùhî
(
s
),
≈
)

	)

1115 
	#SSL_gë_cùhî_vîsi⁄
(
s
) \

1116 
	`SSL_CIPHER_gë_vîsi⁄
(
	`SSL_gë_cuºít_cùhî
(
s
))

	)

1117 
	#SSL_gë_cùhî_«me
(
s
) \

1118 
	`SSL_CIPHER_gë_«me
(
	`SSL_gë_cuºít_cùhî
(
s
))

	)

1119 
	#SSL_gë_time
(
a
Ë
	`SSL_SESSION_gë_time
◊)

	)

1120 
	#SSL_£t_time
(
a
,
b
Ë
	`SSL_SESSION_£t_time
(◊),(b))

	)

1121 
	#SSL_gë_timeout
(
a
Ë
	`SSL_SESSION_gë_timeout
◊)

	)

1122 
	#SSL_£t_timeout
(
a
,
b
Ë
	`SSL_SESSION_£t_timeout
(◊),(b))

	)

1124 
	#d2i_SSL_SESSION_bio
(
bp
,
s_id
Ë
	`ASN1_d2i_bio_of
(
SSL_SESSION
,
SSL_SESSION_√w
,
d2i_SSL_SESSION
,bp,s_id)

	)

1125 
	#i2d_SSL_SESSION_bio
(
bp
,
s_id
Ë
	`ASN1_i2d_bio_of
(
SSL_SESSION
,
i2d_SSL_SESSION
,bp,s_id)

	)

1127 
DECLARE_PEM_rw
(
SSL_SESSION
, SSL_SESSION)

1128 
	#SSL_AD_REASON_OFFSET
 1000

	)

1131 
	#SSL_AD_CLOSE_NOTIFY
 
SSL3_AD_CLOSE_NOTIFY


	)

1133 
	#SSL_AD_UNEXPECTED_MESSAGE
 
SSL3_AD_UNEXPECTED_MESSAGE


	)

1135 
	#SSL_AD_BAD_RECORD_MAC
 
SSL3_AD_BAD_RECORD_MAC


	)

1136 
	#SSL_AD_DECRYPTION_FAILED
 
TLS1_AD_DECRYPTION_FAILED


	)

1137 
	#SSL_AD_RECORD_OVERFLOW
 
TLS1_AD_RECORD_OVERFLOW


	)

1139 
	#SSL_AD_DECOMPRESSION_FAILURE
 
SSL3_AD_DECOMPRESSION_FAILURE


	)

1141 
	#SSL_AD_HANDSHAKE_FAILURE
 
SSL3_AD_HANDSHAKE_FAILURE


	)

1143 
	#SSL_AD_NO_CERTIFICATE
 
SSL3_AD_NO_CERTIFICATE


	)

1144 
	#SSL_AD_BAD_CERTIFICATE
 
SSL3_AD_BAD_CERTIFICATE


	)

1145 
	#SSL_AD_UNSUPPORTED_CERTIFICATE
 
SSL3_AD_UNSUPPORTED_CERTIFICATE


	)

1146 
	#SSL_AD_CERTIFICATE_REVOKED
 
SSL3_AD_CERTIFICATE_REVOKED


	)

1147 
	#SSL_AD_CERTIFICATE_EXPIRED
 
SSL3_AD_CERTIFICATE_EXPIRED


	)

1148 
	#SSL_AD_CERTIFICATE_UNKNOWN
 
SSL3_AD_CERTIFICATE_UNKNOWN


	)

1150 
	#SSL_AD_ILLEGAL_PARAMETER
 
SSL3_AD_ILLEGAL_PARAMETER


	)

1152 
	#SSL_AD_UNKNOWN_CA
 
TLS1_AD_UNKNOWN_CA


	)

1154 
	#SSL_AD_ACCESS_DENIED
 
TLS1_AD_ACCESS_DENIED


	)

1156 
	#SSL_AD_DECODE_ERROR
 
TLS1_AD_DECODE_ERROR


	)

1157 
	#SSL_AD_DECRYPT_ERROR
 
TLS1_AD_DECRYPT_ERROR


	)

1159 
	#SSL_AD_EXPORT_RESTRICTION
 
TLS1_AD_EXPORT_RESTRICTION


	)

1161 
	#SSL_AD_PROTOCOL_VERSION
 
TLS1_AD_PROTOCOL_VERSION


	)

1163 
	#SSL_AD_INSUFFICIENT_SECURITY
 
TLS1_AD_INSUFFICIENT_SECURITY


	)

1165 
	#SSL_AD_INTERNAL_ERROR
 
TLS1_AD_INTERNAL_ERROR


	)

1166 
	#SSL_AD_USER_CANCELLED
 
TLS1_AD_USER_CANCELLED


	)

1167 
	#SSL_AD_NO_RENEGOTIATION
 
TLS1_AD_NO_RENEGOTIATION


	)

1168 
	#SSL_AD_MISSING_EXTENSION
 
TLS13_AD_MISSING_EXTENSION


	)

1169 
	#SSL_AD_CERTIFICATE_REQUIRED
 
TLS13_AD_CERTIFICATE_REQUIRED


	)

1170 
	#SSL_AD_UNSUPPORTED_EXTENSION
 
TLS1_AD_UNSUPPORTED_EXTENSION


	)

1171 
	#SSL_AD_CERTIFICATE_UNOBTAINABLE
 
TLS1_AD_CERTIFICATE_UNOBTAINABLE


	)

1172 
	#SSL_AD_UNRECOGNIZED_NAME
 
TLS1_AD_UNRECOGNIZED_NAME


	)

1173 
	#SSL_AD_BAD_CERTIFICATE_STATUS_RESPONSE
 
TLS1_AD_BAD_CERTIFICATE_STATUS_RESPONSE


	)

1174 
	#SSL_AD_BAD_CERTIFICATE_HASH_VALUE
 
TLS1_AD_BAD_CERTIFICATE_HASH_VALUE


	)

1176 
	#SSL_AD_UNKNOWN_PSK_IDENTITY
 
TLS1_AD_UNKNOWN_PSK_IDENTITY


	)

1178 
	#SSL_AD_INAPPROPRIATE_FALLBACK
 
TLS1_AD_INAPPROPRIATE_FALLBACK


	)

1179 
	#SSL_AD_NO_APPLICATION_PROTOCOL
 
TLS1_AD_NO_APPLICATION_PROTOCOL


	)

1180 
	#SSL_ERROR_NONE
 0

	)

1181 
	#SSL_ERROR_SSL
 1

	)

1182 
	#SSL_ERROR_WANT_READ
 2

	)

1183 
	#SSL_ERROR_WANT_WRITE
 3

	)

1184 
	#SSL_ERROR_WANT_X509_LOOKUP
 4

	)

1185 
	#SSL_ERROR_SYSCALL
 5

	)

1187 
	#SSL_ERROR_ZERO_RETURN
 6

	)

1188 
	#SSL_ERROR_WANT_CONNECT
 7

	)

1189 
	#SSL_ERROR_WANT_ACCEPT
 8

	)

1190 
	#SSL_ERROR_WANT_ASYNC
 9

	)

1191 
	#SSL_ERROR_WANT_ASYNC_JOB
 10

	)

1192 
	#SSL_ERROR_WANT_CLIENT_HELLO_CB
 11

	)

1193 
	#SSL_CTRL_SET_TMP_DH
 3

	)

1194 
	#SSL_CTRL_SET_TMP_ECDH
 4

	)

1195 
	#SSL_CTRL_SET_TMP_DH_CB
 6

	)

1196 
	#SSL_CTRL_GET_CLIENT_CERT_REQUEST
 9

	)

1197 
	#SSL_CTRL_GET_NUM_RENEGOTIATIONS
 10

	)

1198 
	#SSL_CTRL_CLEAR_NUM_RENEGOTIATIONS
 11

	)

1199 
	#SSL_CTRL_GET_TOTAL_RENEGOTIATIONS
 12

	)

1200 
	#SSL_CTRL_GET_FLAGS
 13

	)

1201 
	#SSL_CTRL_EXTRA_CHAIN_CERT
 14

	)

1202 
	#SSL_CTRL_SET_MSG_CALLBACK
 15

	)

1203 
	#SSL_CTRL_SET_MSG_CALLBACK_ARG
 16

	)

1205 
	#SSL_CTRL_SET_MTU
 17

	)

1207 
	#SSL_CTRL_SESS_NUMBER
 20

	)

1208 
	#SSL_CTRL_SESS_CONNECT
 21

	)

1209 
	#SSL_CTRL_SESS_CONNECT_GOOD
 22

	)

1210 
	#SSL_CTRL_SESS_CONNECT_RENEGOTIATE
 23

	)

1211 
	#SSL_CTRL_SESS_ACCEPT
 24

	)

1212 
	#SSL_CTRL_SESS_ACCEPT_GOOD
 25

	)

1213 
	#SSL_CTRL_SESS_ACCEPT_RENEGOTIATE
 26

	)

1214 
	#SSL_CTRL_SESS_HIT
 27

	)

1215 
	#SSL_CTRL_SESS_CB_HIT
 28

	)

1216 
	#SSL_CTRL_SESS_MISSES
 29

	)

1217 
	#SSL_CTRL_SESS_TIMEOUTS
 30

	)

1218 
	#SSL_CTRL_SESS_CACHE_FULL
 31

	)

1219 
	#SSL_CTRL_MODE
 33

	)

1220 
	#SSL_CTRL_GET_READ_AHEAD
 40

	)

1221 
	#SSL_CTRL_SET_READ_AHEAD
 41

	)

1222 
	#SSL_CTRL_SET_SESS_CACHE_SIZE
 42

	)

1223 
	#SSL_CTRL_GET_SESS_CACHE_SIZE
 43

	)

1224 
	#SSL_CTRL_SET_SESS_CACHE_MODE
 44

	)

1225 
	#SSL_CTRL_GET_SESS_CACHE_MODE
 45

	)

1226 
	#SSL_CTRL_GET_MAX_CERT_LIST
 50

	)

1227 
	#SSL_CTRL_SET_MAX_CERT_LIST
 51

	)

1228 
	#SSL_CTRL_SET_MAX_SEND_FRAGMENT
 52

	)

1230 
	#SSL_CTRL_SET_TLSEXT_SERVERNAME_CB
 53

	)

1231 
	#SSL_CTRL_SET_TLSEXT_SERVERNAME_ARG
 54

	)

1232 
	#SSL_CTRL_SET_TLSEXT_HOSTNAME
 55

	)

1233 
	#SSL_CTRL_SET_TLSEXT_DEBUG_CB
 56

	)

1234 
	#SSL_CTRL_SET_TLSEXT_DEBUG_ARG
 57

	)

1235 
	#SSL_CTRL_GET_TLSEXT_TICKET_KEYS
 58

	)

1236 
	#SSL_CTRL_SET_TLSEXT_TICKET_KEYS
 59

	)

1240 
	#SSL_CTRL_SET_TLSEXT_STATUS_REQ_CB
 63

	)

1241 
	#SSL_CTRL_SET_TLSEXT_STATUS_REQ_CB_ARG
 64

	)

1242 
	#SSL_CTRL_SET_TLSEXT_STATUS_REQ_TYPE
 65

	)

1243 
	#SSL_CTRL_GET_TLSEXT_STATUS_REQ_EXTS
 66

	)

1244 
	#SSL_CTRL_SET_TLSEXT_STATUS_REQ_EXTS
 67

	)

1245 
	#SSL_CTRL_GET_TLSEXT_STATUS_REQ_IDS
 68

	)

1246 
	#SSL_CTRL_SET_TLSEXT_STATUS_REQ_IDS
 69

	)

1247 
	#SSL_CTRL_GET_TLSEXT_STATUS_REQ_OCSP_RESP
 70

	)

1248 
	#SSL_CTRL_SET_TLSEXT_STATUS_REQ_OCSP_RESP
 71

	)

1249 
	#SSL_CTRL_SET_TLSEXT_TICKET_KEY_CB
 72

	)

1250 
	#SSL_CTRL_SET_TLS_EXT_SRP_USERNAME_CB
 75

	)

1251 
	#SSL_CTRL_SET_SRP_VERIFY_PARAM_CB
 76

	)

1252 
	#SSL_CTRL_SET_SRP_GIVE_CLIENT_PWD_CB
 77

	)

1253 
	#SSL_CTRL_SET_SRP_ARG
 78

	)

1254 
	#SSL_CTRL_SET_TLS_EXT_SRP_USERNAME
 79

	)

1255 
	#SSL_CTRL_SET_TLS_EXT_SRP_STRENGTH
 80

	)

1256 
	#SSL_CTRL_SET_TLS_EXT_SRP_PASSWORD
 81

	)

1257 #i‚de‡
OPENSSL_NO_HEARTBEATS


1258 
	#SSL_CTRL_DTLS_EXT_SEND_HEARTBEAT
 85

	)

1259 
	#SSL_CTRL_GET_DTLS_EXT_HEARTBEAT_PENDING
 86

	)

1260 
	#SSL_CTRL_SET_DTLS_EXT_HEARTBEAT_NO_REQUESTS
 87

	)

1262 
	#DTLS_CTRL_GET_TIMEOUT
 73

	)

1263 
	#DTLS_CTRL_HANDLE_TIMEOUT
 74

	)

1264 
	#SSL_CTRL_GET_RI_SUPPORT
 76

	)

1265 
	#SSL_CTRL_CLEAR_MODE
 78

	)

1266 
	#SSL_CTRL_SET_NOT_RESUMABLE_SESS_CB
 79

	)

1267 
	#SSL_CTRL_GET_EXTRA_CHAIN_CERTS
 82

	)

1268 
	#SSL_CTRL_CLEAR_EXTRA_CHAIN_CERTS
 83

	)

1269 
	#SSL_CTRL_CHAIN
 88

	)

1270 
	#SSL_CTRL_CHAIN_CERT
 89

	)

1271 
	#SSL_CTRL_GET_GROUPS
 90

	)

1272 
	#SSL_CTRL_SET_GROUPS
 91

	)

1273 
	#SSL_CTRL_SET_GROUPS_LIST
 92

	)

1274 
	#SSL_CTRL_GET_SHARED_GROUP
 93

	)

1275 
	#SSL_CTRL_SET_SIGALGS
 97

	)

1276 
	#SSL_CTRL_SET_SIGALGS_LIST
 98

	)

1277 
	#SSL_CTRL_CERT_FLAGS
 99

	)

1278 
	#SSL_CTRL_CLEAR_CERT_FLAGS
 100

	)

1279 
	#SSL_CTRL_SET_CLIENT_SIGALGS
 101

	)

1280 
	#SSL_CTRL_SET_CLIENT_SIGALGS_LIST
 102

	)

1281 
	#SSL_CTRL_GET_CLIENT_CERT_TYPES
 103

	)

1282 
	#SSL_CTRL_SET_CLIENT_CERT_TYPES
 104

	)

1283 
	#SSL_CTRL_BUILD_CERT_CHAIN
 105

	)

1284 
	#SSL_CTRL_SET_VERIFY_CERT_STORE
 106

	)

1285 
	#SSL_CTRL_SET_CHAIN_CERT_STORE
 107

	)

1286 
	#SSL_CTRL_GET_PEER_SIGNATURE_NID
 108

	)

1287 
	#SSL_CTRL_GET_PEER_TMP_KEY
 109

	)

1288 
	#SSL_CTRL_GET_RAW_CIPHERLIST
 110

	)

1289 
	#SSL_CTRL_GET_EC_POINT_FORMATS
 111

	)

1290 
	#SSL_CTRL_GET_CHAIN_CERTS
 115

	)

1291 
	#SSL_CTRL_SELECT_CURRENT_CERT
 116

	)

1292 
	#SSL_CTRL_SET_CURRENT_CERT
 117

	)

1293 
	#SSL_CTRL_SET_DH_AUTO
 118

	)

1294 
	#DTLS_CTRL_SET_LINK_MTU
 120

	)

1295 
	#DTLS_CTRL_GET_LINK_MIN_MTU
 121

	)

1296 
	#SSL_CTRL_GET_EXTMS_SUPPORT
 122

	)

1297 
	#SSL_CTRL_SET_MIN_PROTO_VERSION
 123

	)

1298 
	#SSL_CTRL_SET_MAX_PROTO_VERSION
 124

	)

1299 
	#SSL_CTRL_SET_SPLIT_SEND_FRAGMENT
 125

	)

1300 
	#SSL_CTRL_SET_MAX_PIPELINES
 126

	)

1301 
	#SSL_CTRL_GET_TLSEXT_STATUS_REQ_TYPE
 127

	)

1302 
	#SSL_CTRL_GET_TLSEXT_STATUS_REQ_CB
 128

	)

1303 
	#SSL_CTRL_GET_TLSEXT_STATUS_REQ_CB_ARG
 129

	)

1304 
	#SSL_CTRL_GET_MIN_PROTO_VERSION
 130

	)

1305 
	#SSL_CTRL_GET_MAX_PROTO_VERSION
 131

	)

1306 
	#SSL_CTRL_GET_SIGNATURE_NID
 132

	)

1307 
	#SSL_CTRL_GET_TMP_KEY
 133

	)

1308 
	#SSL_CERT_SET_FIRST
 1

	)

1309 
	#SSL_CERT_SET_NEXT
 2

	)

1310 
	#SSL_CERT_SET_SERVER
 3

	)

1311 
	#DTLSv1_gë_timeout
(
s¶
, 
¨g
) \

1312 
	`SSL_˘æ
(
s¶
,
DTLS_CTRL_GET_TIMEOUT
,0, (*)(
¨g
))

	)

1313 
	#DTLSv1_h™dÀ_timeout
(
s¶
) \

1314 
	`SSL_˘æ
(
s¶
,
DTLS_CTRL_HANDLE_TIMEOUT
,0, 
NULL
)

	)

1315 
	#SSL_num_ª√gŸüti⁄s
(
s¶
) \

1316 
	`SSL_˘æ
((
s¶
),
SSL_CTRL_GET_NUM_RENEGOTIATIONS
,0,
NULL
)

	)

1317 
	#SSL_˛ór_num_ª√gŸüti⁄s
(
s¶
) \

1318 
	`SSL_˘æ
((
s¶
),
SSL_CTRL_CLEAR_NUM_RENEGOTIATIONS
,0,
NULL
)

	)

1319 
	#SSL_tŸÆ_ª√gŸüti⁄s
(
s¶
) \

1320 
	`SSL_˘æ
((
s¶
),
SSL_CTRL_GET_TOTAL_RENEGOTIATIONS
,0,
NULL
)

	)

1321 
	#SSL_CTX_£t_tmp_dh
(
˘x
,
dh
) \

1322 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_TMP_DH
,0,(*)(
dh
))

	)

1323 
	#SSL_CTX_£t_tmp_ecdh
(
˘x
,
ecdh
) \

1324 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_TMP_ECDH
,0,(*)(
ecdh
))

	)

1325 
	#SSL_CTX_£t_dh_auto
(
˘x
, 
⁄off
) \

1326 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_DH_AUTO
,
⁄off
,
NULL
)

	)

1327 
	#SSL_£t_dh_auto
(
s
, 
⁄off
) \

1328 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_DH_AUTO
,
⁄off
,
NULL
)

	)

1329 
	#SSL_£t_tmp_dh
(
s¶
,
dh
) \

1330 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_TMP_DH
,0,(*)(
dh
))

	)

1331 
	#SSL_£t_tmp_ecdh
(
s¶
,
ecdh
) \

1332 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_TMP_ECDH
,0,(*)(
ecdh
))

	)

1333 
	#SSL_CTX_add_exåa_chaö_˚π
(
˘x
,
x509
) \

1334 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_EXTRA_CHAIN_CERT
,0,(*)(
x509
))

	)

1335 
	#SSL_CTX_gë_exåa_chaö_˚πs
(
˘x
,
px509
) \

1336 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_GET_EXTRA_CHAIN_CERTS
,0,
px509
)

	)

1337 
	#SSL_CTX_gë_exåa_chaö_˚πs_⁄ly
(
˘x
,
px509
) \

1338 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_GET_EXTRA_CHAIN_CERTS
,1,
px509
)

	)

1339 
	#SSL_CTX_˛ór_exåa_chaö_˚πs
(
˘x
) \

1340 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_CLEAR_EXTRA_CHAIN_CERTS
,0,
NULL
)

	)

1341 
	#SSL_CTX_£t0_chaö
(
˘x
,
sk
) \

1342 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_CHAIN
,0,(*)(
sk
))

	)

1343 
	#SSL_CTX_£t1_chaö
(
˘x
,
sk
) \

1344 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_CHAIN
,1,(*)(
sk
))

	)

1345 
	#SSL_CTX_add0_chaö_˚π
(
˘x
,
x509
) \

1346 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_CHAIN_CERT
,0,(*)(
x509
))

	)

1347 
	#SSL_CTX_add1_chaö_˚π
(
˘x
,
x509
) \

1348 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_CHAIN_CERT
,1,(*)(
x509
))

	)

1349 
	#SSL_CTX_gë0_chaö_˚πs
(
˘x
,
px509
) \

1350 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_GET_CHAIN_CERTS
,0,
px509
)

	)

1351 
	#SSL_CTX_˛ór_chaö_˚πs
(
˘x
) \

1352 
	`SSL_CTX_£t0_chaö
(
˘x
,
NULL
)

	)

1353 
	#SSL_CTX_buûd_˚π_chaö
(
˘x
, 
Êags
) \

1354 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_BUILD_CERT_CHAIN
, 
Êags
, 
NULL
)

	)

1355 
	#SSL_CTX_£À˘_cuºít_˚π
(
˘x
,
x509
) \

1356 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SELECT_CURRENT_CERT
,0,(*)(
x509
))

	)

1357 
	#SSL_CTX_£t_cuºít_˚π
(
˘x
, 
›
) \

1358 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_CURRENT_CERT
, 
›
, 
NULL
)

	)

1359 
	#SSL_CTX_£t0_vîify_˚π_°‹e
(
˘x
,
°
) \

1360 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_VERIFY_CERT_STORE
,0,(*)(
°
))

	)

1361 
	#SSL_CTX_£t1_vîify_˚π_°‹e
(
˘x
,
°
) \

1362 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_VERIFY_CERT_STORE
,1,(*)(
°
))

	)

1363 
	#SSL_CTX_£t0_chaö_˚π_°‹e
(
˘x
,
°
) \

1364 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_CHAIN_CERT_STORE
,0,(*)(
°
))

	)

1365 
	#SSL_CTX_£t1_chaö_˚π_°‹e
(
˘x
,
°
) \

1366 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_CHAIN_CERT_STORE
,1,(*)(
°
))

	)

1367 
	#SSL_£t0_chaö
(
s
,
sk
) \

1368 
	`SSL_˘æ
(
s
,
SSL_CTRL_CHAIN
,0,(*)(
sk
))

	)

1369 
	#SSL_£t1_chaö
(
s
,
sk
) \

1370 
	`SSL_˘æ
(
s
,
SSL_CTRL_CHAIN
,1,(*)(
sk
))

	)

1371 
	#SSL_add0_chaö_˚π
(
s
,
x509
) \

1372 
	`SSL_˘æ
(
s
,
SSL_CTRL_CHAIN_CERT
,0,(*)(
x509
))

	)

1373 
	#SSL_add1_chaö_˚π
(
s
,
x509
) \

1374 
	`SSL_˘æ
(
s
,
SSL_CTRL_CHAIN_CERT
,1,(*)(
x509
))

	)

1375 
	#SSL_gë0_chaö_˚πs
(
s
,
px509
) \

1376 
	`SSL_˘æ
(
s
,
SSL_CTRL_GET_CHAIN_CERTS
,0,
px509
)

	)

1377 
	#SSL_˛ór_chaö_˚πs
(
s
) \

1378 
	`SSL_£t0_chaö
(
s
,
NULL
)

	)

1379 
	#SSL_buûd_˚π_chaö
(
s
, 
Êags
) \

1380 
	`SSL_˘æ
(
s
,
SSL_CTRL_BUILD_CERT_CHAIN
, 
Êags
, 
NULL
)

	)

1381 
	#SSL_£À˘_cuºít_˚π
(
s
,
x509
) \

1382 
	`SSL_˘æ
(
s
,
SSL_CTRL_SELECT_CURRENT_CERT
,0,(*)(
x509
))

	)

1383 
	#SSL_£t_cuºít_˚π
(
s
,
›
) \

1384 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_CURRENT_CERT
, 
›
, 
NULL
)

	)

1385 
	#SSL_£t0_vîify_˚π_°‹e
(
s
,
°
) \

1386 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_VERIFY_CERT_STORE
,0,(*)(
°
))

	)

1387 
	#SSL_£t1_vîify_˚π_°‹e
(
s
,
°
) \

1388 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_VERIFY_CERT_STORE
,1,(*)(
°
))

	)

1389 
	#SSL_£t0_chaö_˚π_°‹e
(
s
,
°
) \

1390 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_CHAIN_CERT_STORE
,0,(*)(
°
))

	)

1391 
	#SSL_£t1_chaö_˚π_°‹e
(
s
,
°
) \

1392 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_CHAIN_CERT_STORE
,1,(*)(
°
))

	)

1393 
	#SSL_gë1_groups
(
s
, 
gli°
) \

1394 
	`SSL_˘æ
(
s
,
SSL_CTRL_GET_GROUPS
,0,(*)(
gli°
))

	)

1395 
	#SSL_CTX_£t1_groups
(
˘x
, 
gli°
, 
gli°Àn
) \

1396 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_GROUPS
,
gli°Àn
,(*)(
gli°
))

	)

1397 
	#SSL_CTX_£t1_groups_li°
(
˘x
, 
s
) \

1398 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_GROUPS_LIST
,0,(*)(
s
))

	)

1399 
	#SSL_£t1_groups
(
s
, 
gli°
, 
gli°Àn
) \

1400 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_GROUPS
,
gli°Àn
,(*)(
gli°
))

	)

1401 
	#SSL_£t1_groups_li°
(
s
, 
°r
) \

1402 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_GROUPS_LIST
,0,(*)(
°r
))

	)

1403 
	#SSL_gë_sh¨ed_group
(
s
, 
n
) \

1404 
	`SSL_˘æ
(
s
,
SSL_CTRL_GET_SHARED_GROUP
,
n
,
NULL
)

	)

1405 
	#SSL_CTX_£t1_sigÆgs
(
˘x
, 
¶i°
, 
¶i°Àn
) \

1406 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_SIGALGS
,
¶i°Àn
,(*)(
¶i°
))

	)

1407 
	#SSL_CTX_£t1_sigÆgs_li°
(
˘x
, 
s
) \

1408 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_SIGALGS_LIST
,0,(*)(
s
))

	)

1409 
	#SSL_£t1_sigÆgs
(
s
, 
¶i°
, 
¶i°Àn
) \

1410 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_SIGALGS
,
¶i°Àn
,(*)(
¶i°
))

	)

1411 
	#SSL_£t1_sigÆgs_li°
(
s
, 
°r
) \

1412 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_SIGALGS_LIST
,0,(*)(
°r
))

	)

1413 
	#SSL_CTX_£t1_˛õ¡_sigÆgs
(
˘x
, 
¶i°
, 
¶i°Àn
) \

1414 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_CLIENT_SIGALGS
,
¶i°Àn
,(*)(
¶i°
))

	)

1415 
	#SSL_CTX_£t1_˛õ¡_sigÆgs_li°
(
˘x
, 
s
) \

1416 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_CLIENT_SIGALGS_LIST
,0,(*)(
s
))

	)

1417 
	#SSL_£t1_˛õ¡_sigÆgs
(
s
, 
¶i°
, 
¶i°Àn
) \

1418 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_CLIENT_SIGALGS
,
¶i°Àn
,(*)(
¶i°
))

	)

1419 
	#SSL_£t1_˛õ¡_sigÆgs_li°
(
s
, 
°r
) \

1420 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_CLIENT_SIGALGS_LIST
,0,(*)(
°r
))

	)

1421 
	#SSL_gë0_˚πifiˇã_ty≥s
(
s
, 
˛i°
) \

1422 
	`SSL_˘æ
(
s
, 
SSL_CTRL_GET_CLIENT_CERT_TYPES
, 0, (*)(
˛i°
))

	)

1423 
	#SSL_CTX_£t1_˛õ¡_˚πifiˇã_ty≥s
(
˘x
, 
˛i°
, 
˛i°Àn
) \

1424 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_CLIENT_CERT_TYPES
,
˛i°Àn
, \

1425 (*)(
˛i°
))

	)

1426 
	#SSL_£t1_˛õ¡_˚πifiˇã_ty≥s
(
s
, 
˛i°
, 
˛i°Àn
) \

1427 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_CLIENT_CERT_TYPES
,
˛i°Àn
,(*)(
˛i°
))

	)

1428 
	#SSL_gë_sig«tuª_nid
(
s
, 
≤
) \

1429 
	`SSL_˘æ
(
s
,
SSL_CTRL_GET_SIGNATURE_NID
,0,
≤
)

	)

1430 
	#SSL_gë_≥î_sig«tuª_nid
(
s
, 
≤
) \

1431 
	`SSL_˘æ
(
s
,
SSL_CTRL_GET_PEER_SIGNATURE_NID
,0,
≤
)

	)

1432 
	#SSL_gë_≥î_tmp_key
(
s
, 
pk
) \

1433 
	`SSL_˘æ
(
s
,
SSL_CTRL_GET_PEER_TMP_KEY
,0,
pk
)

	)

1434 
	#SSL_gë_tmp_key
(
s
, 
pk
) \

1435 
	`SSL_˘æ
(
s
,
SSL_CTRL_GET_TMP_KEY
,0,
pk
)

	)

1436 
	#SSL_gë0_øw_cùhîli°
(
s
, 
∂°
) \

1437 
	`SSL_˘æ
(
s
,
SSL_CTRL_GET_RAW_CIPHERLIST
,0,
∂°
)

	)

1438 
	#SSL_gë0_ec_poöt_f‹m©s
(
s
, 
∂°
) \

1439 
	`SSL_˘æ
(
s
,
SSL_CTRL_GET_EC_POINT_FORMATS
,0,
∂°
)

	)

1440 
	#SSL_CTX_£t_mö_¥Ÿo_vîsi⁄
(
˘x
, 
vîsi⁄
) \

1441 
	`SSL_CTX_˘æ
(
˘x
, 
SSL_CTRL_SET_MIN_PROTO_VERSION
, 
vîsi⁄
, 
NULL
)

	)

1442 
	#SSL_CTX_£t_max_¥Ÿo_vîsi⁄
(
˘x
, 
vîsi⁄
) \

1443 
	`SSL_CTX_˘æ
(
˘x
, 
SSL_CTRL_SET_MAX_PROTO_VERSION
, 
vîsi⁄
, 
NULL
)

	)

1444 
	#SSL_CTX_gë_mö_¥Ÿo_vîsi⁄
(
˘x
) \

1445 
	`SSL_CTX_˘æ
(
˘x
, 
SSL_CTRL_GET_MIN_PROTO_VERSION
, 0, 
NULL
)

	)

1446 
	#SSL_CTX_gë_max_¥Ÿo_vîsi⁄
(
˘x
) \

1447 
	`SSL_CTX_˘æ
(
˘x
, 
SSL_CTRL_GET_MAX_PROTO_VERSION
, 0, 
NULL
)

	)

1448 
	#SSL_£t_mö_¥Ÿo_vîsi⁄
(
s
, 
vîsi⁄
) \

1449 
	`SSL_˘æ
(
s
, 
SSL_CTRL_SET_MIN_PROTO_VERSION
, 
vîsi⁄
, 
NULL
)

	)

1450 
	#SSL_£t_max_¥Ÿo_vîsi⁄
(
s
, 
vîsi⁄
) \

1451 
	`SSL_˘æ
(
s
, 
SSL_CTRL_SET_MAX_PROTO_VERSION
, 
vîsi⁄
, 
NULL
)

	)

1452 
	#SSL_gë_mö_¥Ÿo_vîsi⁄
(
s
) \

1453 
	`SSL_˘æ
(
s
, 
SSL_CTRL_GET_MIN_PROTO_VERSION
, 0, 
NULL
)

	)

1454 
	#SSL_gë_max_¥Ÿo_vîsi⁄
(
s
) \

1455 
	`SSL_˘æ
(
s
, 
SSL_CTRL_GET_MAX_PROTO_VERSION
, 0, 
NULL
)

	)

1458 
	#SSL_CTRL_GET_SERVER_TMP_KEY
 \

1459 
SSL_CTRL_GET_PEER_TMP_KEY


	)

1460 
	#SSL_gë_£rvî_tmp_key
(
s
, 
pk
) \

1461 
	`SSL_gë_≥î_tmp_key
(
s
, 
pk
)

	)

1467 
	#SSL_CTRL_GET_CURVES
 
SSL_CTRL_GET_GROUPS


	)

1468 
	#SSL_CTRL_SET_CURVES
 
SSL_CTRL_SET_GROUPS


	)

1469 
	#SSL_CTRL_SET_CURVES_LIST
 
SSL_CTRL_SET_GROUPS_LIST


	)

1470 
	#SSL_CTRL_GET_SHARED_CURVE
 
SSL_CTRL_GET_SHARED_GROUP


	)

1472 
	#SSL_gë1_curves
 
SSL_gë1_groups


	)

1473 
	#SSL_CTX_£t1_curves
 
SSL_CTX_£t1_groups


	)

1474 
	#SSL_CTX_£t1_curves_li°
 
SSL_CTX_£t1_groups_li°


	)

1475 
	#SSL_£t1_curves
 
SSL_£t1_groups


	)

1476 
	#SSL_£t1_curves_li°
 
SSL_£t1_groups_li°


	)

1477 
	#SSL_gë_sh¨ed_curve
 
SSL_gë_sh¨ed_group


	)

1480 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

1482 
	#SSL_CTX_√ed_tmp_RSA
(
˘x
Ë0

	)

1483 
	#SSL_CTX_£t_tmp_rß
(
˘x
,
rß
Ë1

	)

1484 
	#SSL_√ed_tmp_RSA
(
s¶
Ë0

	)

1485 
	#SSL_£t_tmp_rß
(
s¶
,
rß
Ë1

	)

1486 
	#SSL_CTX_£t_ecdh_auto
(
dummy
, 
⁄off
Ë((⁄offË!0)

	)

1487 
	#SSL_£t_ecdh_auto
(
dummy
, 
⁄off
Ë((⁄offË!0)

	)

1492 
	#SSL_CTX_£t_tmp_rß_ˇŒback
(
˘x
, 
cb
Ë0Ë(cb)(
NULL
, 0, 0)

	)

1493 
	#SSL_£t_tmp_rß_ˇŒback
(
s¶
, 
cb
Ë0Ë(cb)(
NULL
, 0, 0)

	)

1495 
__owur
 c⁄° 
BIO_METHOD
 *
BIO_f_s¶
();

1496 
__owur
 
BIO
 *
BIO_√w_s¶
(
SSL_CTX
 *
˘x
, 
˛õ¡
);

1497 
__owur
 
BIO
 *
BIO_√w_s¶_c⁄√˘
(
SSL_CTX
 *
˘x
);

1498 
__owur
 
BIO
 *
BIO_√w_buf„r_s¶_c⁄√˘
(
SSL_CTX
 *
˘x
);

1499 
__owur
 
BIO_s¶_c›y_£ssi⁄_id
(
BIO
 *
to
, BIO *
‰om
);

1500 
BIO_s¶_shutdown
(
BIO
 *
s¶_bio
);

1502 
__owur
 
SSL_CTX_£t_cùhî_li°
(
SSL_CTX
 *, c⁄° *
°r
);

1503 
__owur
 
SSL_CTX
 *
SSL_CTX_√w
(c⁄° 
SSL_METHOD
 *
mëh
);

1504 
SSL_CTX_up_ªf
(
SSL_CTX
 *
˘x
);

1505 
SSL_CTX_‰ì
(
SSL_CTX
 *);

1506 
__owur
 
SSL_CTX_£t_timeout
(
SSL_CTX
 *
˘x
, 
t
);

1507 
__owur
 
SSL_CTX_gë_timeout
(c⁄° 
SSL_CTX
 *
˘x
);

1508 
__owur
 
X509_STORE
 *
SSL_CTX_gë_˚π_°‹e
(c⁄° 
SSL_CTX
 *);

1509 
SSL_CTX_£t_˚π_°‹e
(
SSL_CTX
 *, 
X509_STORE
 *);

1510 
SSL_CTX_£t1_˚π_°‹e
(
SSL_CTX
 *, 
X509_STORE
 *);

1511 
__owur
 
SSL_w™t
(c⁄° 
SSL
 *
s
);

1512 
__owur
 
SSL_˛ór
(
SSL
 *
s
);

1514 
SSL_CTX_Êush_£ssi⁄s
(
SSL_CTX
 *
˘x
, 
tm
);

1516 
__owur
 c⁄° 
SSL_CIPHER
 *
SSL_gë_cuºít_cùhî
(c⁄° 
SSL
 *
s
);

1517 
__owur
 c⁄° 
SSL_CIPHER
 *
SSL_gë_≥ndög_cùhî
(c⁄° 
SSL
 *
s
);

1518 
__owur
 
SSL_CIPHER_gë_bôs
(c⁄° 
SSL_CIPHER
 *
c
, *
Æg_bôs
);

1519 
__owur
 c⁄° *
SSL_CIPHER_gë_vîsi⁄
(c⁄° 
SSL_CIPHER
 *
c
);

1520 
__owur
 c⁄° *
SSL_CIPHER_gë_«me
(c⁄° 
SSL_CIPHER
 *
c
);

1521 
__owur
 c⁄° *
SSL_CIPHER_°™d¨d_«me
(c⁄° 
SSL_CIPHER
 *
c
);

1522 
__owur
 c⁄° *
OPENSSL_cùhî_«me
(c⁄° *
rfc_«me
);

1523 
__owur
 
uöt32_t
 
SSL_CIPHER_gë_id
(c⁄° 
SSL_CIPHER
 *
c
);

1524 
__owur
 
uöt16_t
 
SSL_CIPHER_gë_¥Ÿocﬁ_id
(c⁄° 
SSL_CIPHER
 *
c
);

1525 
__owur
 
SSL_CIPHER_gë_kx_nid
(c⁄° 
SSL_CIPHER
 *
c
);

1526 
__owur
 
SSL_CIPHER_gë_auth_nid
(c⁄° 
SSL_CIPHER
 *
c
);

1527 
__owur
 c⁄° 
EVP_MD
 *
SSL_CIPHER_gë_h™dshake_dige°
(c⁄° 
SSL_CIPHER
 *
c
);

1528 
__owur
 
SSL_CIPHER_is_´ad
(c⁄° 
SSL_CIPHER
 *
c
);

1530 
__owur
 
SSL_gë_fd
(c⁄° 
SSL
 *
s
);

1531 
__owur
 
SSL_gë_rfd
(c⁄° 
SSL
 *
s
);

1532 
__owur
 
SSL_gë_wfd
(c⁄° 
SSL
 *
s
);

1533 
__owur
 c⁄° *
SSL_gë_cùhî_li°
(c⁄° 
SSL
 *
s
, 
n
);

1534 
__owur
 *
SSL_gë_sh¨ed_cùhîs
(c⁄° 
SSL
 *
s
, *
buf
, 
size
);

1535 
__owur
 
SSL_gë_ªad_ahód
(c⁄° 
SSL
 *
s
);

1536 
__owur
 
SSL_≥ndög
(c⁄° 
SSL
 *
s
);

1537 
__owur
 
SSL_has_≥ndög
(c⁄° 
SSL
 *
s
);

1538 #i‚de‡
OPENSSL_NO_SOCK


1539 
__owur
 
SSL_£t_fd
(
SSL
 *
s
, 
fd
);

1540 
__owur
 
SSL_£t_rfd
(
SSL
 *
s
, 
fd
);

1541 
__owur
 
SSL_£t_wfd
(
SSL
 *
s
, 
fd
);

1543 
SSL_£t0_rbio
(
SSL
 *
s
, 
BIO
 *
rbio
);

1544 
SSL_£t0_wbio
(
SSL
 *
s
, 
BIO
 *
wbio
);

1545 
SSL_£t_bio
(
SSL
 *
s
, 
BIO
 *
rbio
, BIO *
wbio
);

1546 
__owur
 
BIO
 *
SSL_gë_rbio
(c⁄° 
SSL
 *
s
);

1547 
__owur
 
BIO
 *
SSL_gë_wbio
(c⁄° 
SSL
 *
s
);

1548 
__owur
 
SSL_£t_cùhî_li°
(
SSL
 *
s
, c⁄° *
°r
);

1549 
__owur
 
SSL_CTX_£t_cùhîsuôes
(
SSL_CTX
 *
˘x
, c⁄° *
°r
);

1550 
__owur
 
SSL_£t_cùhîsuôes
(
SSL
 *
s
, c⁄° *
°r
);

1551 
SSL_£t_ªad_ahód
(
SSL
 *
s
, 
yes
);

1552 
__owur
 
SSL_gë_vîify_mode
(c⁄° 
SSL
 *
s
);

1553 
__owur
 
SSL_gë_vîify_dïth
(c⁄° 
SSL
 *
s
);

1554 
__owur
 
SSL_vîify_cb
 
SSL_gë_vîify_ˇŒback
(c⁄° 
SSL
 *
s
);

1555 
SSL_£t_vîify
(
SSL
 *
s
, 
mode
, 
SSL_vîify_cb
 
ˇŒback
);

1556 
SSL_£t_vîify_dïth
(
SSL
 *
s
, 
dïth
);

1557 
SSL_£t_˚π_cb
(
SSL
 *
s
, (*
cb
Ë(SSL *
s¶
, *
¨g
), *arg);

1558 #i‚de‡
OPENSSL_NO_RSA


1559 
__owur
 
SSL_u£_RSAPriv©eKey
(
SSL
 *
s¶
, 
RSA
 *
rß
);

1560 
__owur
 
SSL_u£_RSAPriv©eKey_ASN1
(
SSL
 *
s¶
, c⁄° *
d
,

1561 
Àn
);

1563 
__owur
 
SSL_u£_Priv©eKey
(
SSL
 *
s¶
, 
EVP_PKEY
 *
pkey
);

1564 
__owur
 
SSL_u£_Priv©eKey_ASN1
(
pk
, 
SSL
 *
s¶
, c⁄° *
d
,

1565 
Àn
);

1566 
__owur
 
SSL_u£_˚πifiˇã
(
SSL
 *
s¶
, 
X509
 *
x
);

1567 
__owur
 
SSL_u£_˚πifiˇã_ASN1
(
SSL
 *
s¶
, c⁄° *
d
, 
Àn
);

1568 
__owur
 
SSL_u£_˚π_™d_key
(
SSL
 *
s¶
, 
X509
 *
x509
, 
EVP_PKEY
 *
¥iv©ekey
,

1569 
STACK_OF
(
X509
Ë*
chaö
, 
ovîride
);

1573 
	#SSL_SERVERINFOV1
 1

	)

1574 
	#SSL_SERVERINFOV2
 2

	)

1577 
__owur
 
SSL_CTX_u£_£rvîöfo
(
SSL_CTX
 *
˘x
, c⁄° *
£rvîöfo
,

1578 
size_t
 
£rvîöfo_Àngth
);

1579 
__owur
 
SSL_CTX_u£_£rvîöfo_ex
(
SSL_CTX
 *
˘x
, 
vîsi⁄
,

1580 c⁄° *
£rvîöfo
,

1581 
size_t
 
£rvîöfo_Àngth
);

1582 
__owur
 
SSL_CTX_u£_£rvîöfo_fûe
(
SSL_CTX
 *
˘x
, c⁄° *
fûe
);

1584 #i‚de‡
OPENSSL_NO_RSA


1585 
__owur
 
SSL_u£_RSAPriv©eKey_fûe
(
SSL
 *
s¶
, c⁄° *
fûe
, 
ty≥
);

1588 
__owur
 
SSL_u£_Priv©eKey_fûe
(
SSL
 *
s¶
, c⁄° *
fûe
, 
ty≥
);

1589 
__owur
 
SSL_u£_˚πifiˇã_fûe
(
SSL
 *
s¶
, c⁄° *
fûe
, 
ty≥
);

1591 #i‚de‡
OPENSSL_NO_RSA


1592 
__owur
 
SSL_CTX_u£_RSAPriv©eKey_fûe
(
SSL_CTX
 *
˘x
, c⁄° *
fûe
,

1593 
ty≥
);

1595 
__owur
 
SSL_CTX_u£_Priv©eKey_fûe
(
SSL_CTX
 *
˘x
, c⁄° *
fûe
,

1596 
ty≥
);

1597 
__owur
 
SSL_CTX_u£_˚πifiˇã_fûe
(
SSL_CTX
 *
˘x
, c⁄° *
fûe
,

1598 
ty≥
);

1600 
__owur
 
SSL_CTX_u£_˚πifiˇã_chaö_fûe
(
SSL_CTX
 *
˘x
, c⁄° *
fûe
);

1601 
__owur
 
SSL_u£_˚πifiˇã_chaö_fûe
(
SSL
 *
s¶
, c⁄° *
fûe
);

1602 
__owur
 
STACK_OF
(
X509_NAME
Ë*
SSL_lﬂd_˛õ¡_CA_fûe
(c⁄° *
fûe
);

1603 
__owur
 
SSL_add_fûe_˚π_subje˘s_to_°ack
(
STACK_OF
(
X509_NAME
Ë*
°ackCAs
,

1604 c⁄° *
fûe
);

1605 
SSL_add_dú_˚π_subje˘s_to_°ack
(
STACK_OF
(
X509_NAME
Ë*
°ackCAs
,

1606 c⁄° *
dú
);

1608 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

1609 
	#SSL_lﬂd_îr‹_°rögs
() \

1610 
	`OPENSSL_öô_s¶
(
OPENSSL_INIT_LOAD_SSL_STRINGS
 \

1611 | 
OPENSSL_INIT_LOAD_CRYPTO_STRINGS
, 
NULL
)

	)

1614 
__owur
 c⁄° *
SSL_°©e_°rög
(c⁄° 
SSL
 *
s
);

1615 
__owur
 c⁄° *
SSL_r°©e_°rög
(c⁄° 
SSL
 *
s
);

1616 
__owur
 c⁄° *
SSL_°©e_°rög_l⁄g
(c⁄° 
SSL
 *
s
);

1617 
__owur
 c⁄° *
SSL_r°©e_°rög_l⁄g
(c⁄° 
SSL
 *
s
);

1618 
__owur
 
SSL_SESSION_gë_time
(c⁄° 
SSL_SESSION
 *
s
);

1619 
__owur
 
SSL_SESSION_£t_time
(
SSL_SESSION
 *
s
, 
t
);

1620 
__owur
 
SSL_SESSION_gë_timeout
(c⁄° 
SSL_SESSION
 *
s
);

1621 
__owur
 
SSL_SESSION_£t_timeout
(
SSL_SESSION
 *
s
, 
t
);

1622 
__owur
 
SSL_SESSION_gë_¥Ÿocﬁ_vîsi⁄
(c⁄° 
SSL_SESSION
 *
s
);

1623 
__owur
 
SSL_SESSION_£t_¥Ÿocﬁ_vîsi⁄
(
SSL_SESSION
 *
s
, 
vîsi⁄
);

1625 
__owur
 c⁄° *
SSL_SESSION_gë0_ho°«me
(c⁄° 
SSL_SESSION
 *
s
);

1626 
__owur
 
SSL_SESSION_£t1_ho°«me
(
SSL_SESSION
 *
s
, c⁄° *
ho°«me
);

1627 
SSL_SESSION_gë0_Æ≤_£À˘ed
(c⁄° 
SSL_SESSION
 *
s
,

1628 c⁄° **
Æ≤
,

1629 
size_t
 *
Àn
);

1630 
__owur
 
SSL_SESSION_£t1_Æ≤_£À˘ed
(
SSL_SESSION
 *
s
,

1631 c⁄° *
Æ≤
,

1632 
size_t
 
Àn
);

1633 
__owur
 c⁄° 
SSL_CIPHER
 *
SSL_SESSION_gë0_cùhî
(c⁄° 
SSL_SESSION
 *
s
);

1634 
__owur
 
SSL_SESSION_£t_cùhî
(
SSL_SESSION
 *
s
, c⁄° 
SSL_CIPHER
 *
cùhî
);

1635 
__owur
 
SSL_SESSION_has_tickë
(c⁄° 
SSL_SESSION
 *
s
);

1636 
__owur
 
SSL_SESSION_gë_tickë_li„time_höt
(c⁄° 
SSL_SESSION
 *
s
);

1637 
SSL_SESSION_gë0_tickë
(c⁄° 
SSL_SESSION
 *
s
, c⁄° **
tick
,

1638 
size_t
 *
Àn
);

1639 
__owur
 
uöt32_t
 
SSL_SESSION_gë_max_óæy_d©a
(c⁄° 
SSL_SESSION
 *
s
);

1640 
__owur
 
SSL_SESSION_£t_max_óæy_d©a
(
SSL_SESSION
 *
s
,

1641 
uöt32_t
 
max_óæy_d©a
);

1642 
__owur
 
SSL_c›y_£ssi⁄_id
(
SSL
 *
to
, c⁄° SSL *
‰om
);

1643 
__owur
 
X509
 *
SSL_SESSION_gë0_≥î
(
SSL_SESSION
 *
s
);

1644 
__owur
 
SSL_SESSION_£t1_id_c⁄ãxt
(
SSL_SESSION
 *
s
,

1645 c⁄° *
sid_˘x
,

1646 
sid_˘x_Àn
);

1647 
__owur
 
SSL_SESSION_£t1_id
(
SSL_SESSION
 *
s
, c⁄° *
sid
,

1648 
sid_Àn
);

1649 
__owur
 
SSL_SESSION_is_ªsumabÀ
(c⁄° 
SSL_SESSION
 *
s
);

1651 
__owur
 
SSL_SESSION
 *
SSL_SESSION_√w
();

1652 
__owur
 
SSL_SESSION
 *
SSL_SESSION_dup
(SSL_SESSION *
§c
);

1653 c⁄° *
SSL_SESSION_gë_id
(c⁄° 
SSL_SESSION
 *
s
,

1654 *
Àn
);

1655 c⁄° *
SSL_SESSION_gë0_id_c⁄ãxt
(c⁄° 
SSL_SESSION
 *
s
,

1656 *
Àn
);

1657 
__owur
 
SSL_SESSION_gë_com¥ess_id
(c⁄° 
SSL_SESSION
 *
s
);

1658 #i‚de‡
OPENSSL_NO_STDIO


1659 
SSL_SESSION_¥öt_Â
(
FILE
 *
Â
, c⁄° 
SSL_SESSION
 *
£s
);

1661 
SSL_SESSION_¥öt
(
BIO
 *
Â
, c⁄° 
SSL_SESSION
 *
£s
);

1662 
SSL_SESSION_¥öt_keylog
(
BIO
 *
bp
, c⁄° 
SSL_SESSION
 *
x
);

1663 
SSL_SESSION_up_ªf
(
SSL_SESSION
 *
£s
);

1664 
SSL_SESSION_‰ì
(
SSL_SESSION
 *
£s
);

1665 
__owur
 
i2d_SSL_SESSION
(
SSL_SESSION
 *
ö
, **
µ
);

1666 
__owur
 
SSL_£t_£ssi⁄
(
SSL
 *
to
, 
SSL_SESSION
 *
£ssi⁄
);

1667 
SSL_CTX_add_£ssi⁄
(
SSL_CTX
 *
˘x
, 
SSL_SESSION
 *
£ssi⁄
);

1668 
SSL_CTX_ªmove_£ssi⁄
(
SSL_CTX
 *
˘x
, 
SSL_SESSION
 *
£ssi⁄
);

1669 
__owur
 
SSL_CTX_£t_gíî©e_£ssi⁄_id
(
SSL_CTX
 *
˘x
, 
GEN_SESSION_CB
 
cb
);

1670 
__owur
 
SSL_£t_gíî©e_£ssi⁄_id
(
SSL
 *
s
, 
GEN_SESSION_CB
 
cb
);

1671 
__owur
 
SSL_has_m©chög_£ssi⁄_id
(c⁄° 
SSL
 *
s
,

1672 c⁄° *
id
,

1673 
id_Àn
);

1674 
SSL_SESSION
 *
d2i_SSL_SESSION
(SSL_SESSION **
a
, c⁄° **
µ
,

1675 
Àngth
);

1677 #ifde‡
HEADER_X509_H


1678 
__owur
 
X509
 *
SSL_gë_≥î_˚πifiˇã
(c⁄° 
SSL
 *
s
);

1681 
__owur
 
STACK_OF
(
X509
Ë*
SSL_gë_≥î_˚π_chaö
(c⁄° 
SSL
 *
s
);

1683 
__owur
 
SSL_CTX_gë_vîify_mode
(c⁄° 
SSL_CTX
 *
˘x
);

1684 
__owur
 
SSL_CTX_gë_vîify_dïth
(c⁄° 
SSL_CTX
 *
˘x
);

1685 
__owur
 
SSL_vîify_cb
 
SSL_CTX_gë_vîify_ˇŒback
(c⁄° 
SSL_CTX
 *
˘x
);

1686 
SSL_CTX_£t_vîify
(
SSL_CTX
 *
˘x
, 
mode
, 
SSL_vîify_cb
 
ˇŒback
);

1687 
SSL_CTX_£t_vîify_dïth
(
SSL_CTX
 *
˘x
, 
dïth
);

1688 
SSL_CTX_£t_˚π_vîify_ˇŒback
(
SSL_CTX
 *
˘x
,

1689 (*
cb
Ë(
X509_STORE_CTX
 *, *),

1690 *
¨g
);

1691 
SSL_CTX_£t_˚π_cb
(
SSL_CTX
 *
c
, (*
cb
Ë(
SSL
 *
s¶
, *
¨g
),

1692 *
¨g
);

1693 #i‚de‡
OPENSSL_NO_RSA


1694 
__owur
 
SSL_CTX_u£_RSAPriv©eKey
(
SSL_CTX
 *
˘x
, 
RSA
 *
rß
);

1695 
__owur
 
SSL_CTX_u£_RSAPriv©eKey_ASN1
(
SSL_CTX
 *
˘x
, c⁄° *
d
,

1696 
Àn
);

1698 
__owur
 
SSL_CTX_u£_Priv©eKey
(
SSL_CTX
 *
˘x
, 
EVP_PKEY
 *
pkey
);

1699 
__owur
 
SSL_CTX_u£_Priv©eKey_ASN1
(
pk
, 
SSL_CTX
 *
˘x
,

1700 c⁄° *
d
, 
Àn
);

1701 
__owur
 
SSL_CTX_u£_˚πifiˇã
(
SSL_CTX
 *
˘x
, 
X509
 *
x
);

1702 
__owur
 
SSL_CTX_u£_˚πifiˇã_ASN1
(
SSL_CTX
 *
˘x
, 
Àn
,

1703 c⁄° *
d
);

1704 
__owur
 
SSL_CTX_u£_˚π_™d_key
(
SSL_CTX
 *
˘x
, 
X509
 *
x509
, 
EVP_PKEY
 *
¥iv©ekey
,

1705 
STACK_OF
(
X509
Ë*
chaö
, 
ovîride
);

1707 
SSL_CTX_£t_deÁu…_∑sswd_cb
(
SSL_CTX
 *
˘x
, 
≥m_∑ssw‹d_cb
 *
cb
);

1708 
SSL_CTX_£t_deÁu…_∑sswd_cb_u£rd©a
(
SSL_CTX
 *
˘x
, *
u
);

1709 
≥m_∑ssw‹d_cb
 *
SSL_CTX_gë_deÁu…_∑sswd_cb
(
SSL_CTX
 *
˘x
);

1710 *
SSL_CTX_gë_deÁu…_∑sswd_cb_u£rd©a
(
SSL_CTX
 *
˘x
);

1711 
SSL_£t_deÁu…_∑sswd_cb
(
SSL
 *
s
, 
≥m_∑ssw‹d_cb
 *
cb
);

1712 
SSL_£t_deÁu…_∑sswd_cb_u£rd©a
(
SSL
 *
s
, *
u
);

1713 
≥m_∑ssw‹d_cb
 *
SSL_gë_deÁu…_∑sswd_cb
(
SSL
 *
s
);

1714 *
SSL_gë_deÁu…_∑sswd_cb_u£rd©a
(
SSL
 *
s
);

1716 
__owur
 
SSL_CTX_check_¥iv©e_key
(c⁄° 
SSL_CTX
 *
˘x
);

1717 
__owur
 
SSL_check_¥iv©e_key
(c⁄° 
SSL
 *
˘x
);

1719 
__owur
 
SSL_CTX_£t_£ssi⁄_id_c⁄ãxt
(
SSL_CTX
 *
˘x
,

1720 c⁄° *
sid_˘x
,

1721 
sid_˘x_Àn
);

1723 
SSL
 *
SSL_√w
(
SSL_CTX
 *
˘x
);

1724 
SSL_up_ªf
(
SSL
 *
s
);

1725 
SSL_is_dés
(c⁄° 
SSL
 *
s
);

1726 
__owur
 
SSL_£t_£ssi⁄_id_c⁄ãxt
(
SSL
 *
s¶
, c⁄° *
sid_˘x
,

1727 
sid_˘x_Àn
);

1729 
__owur
 
SSL_CTX_£t_puΩo£
(
SSL_CTX
 *
˘x
, 
puΩo£
);

1730 
__owur
 
SSL_£t_puΩo£
(
SSL
 *
s¶
, 
puΩo£
);

1731 
__owur
 
SSL_CTX_£t_åu°
(
SSL_CTX
 *
˘x
, 
åu°
);

1732 
__owur
 
SSL_£t_åu°
(
SSL
 *
s¶
, 
åu°
);

1734 
__owur
 
SSL_£t1_ho°
(
SSL
 *
s
, c⁄° *
ho°«me
);

1735 
__owur
 
SSL_add1_ho°
(
SSL
 *
s
, c⁄° *
ho°«me
);

1736 
__owur
 c⁄° *
SSL_gë0_≥î«me
(
SSL
 *
s
);

1737 
SSL_£t_ho°Êags
(
SSL
 *
s
, 
Êags
);

1739 
__owur
 
SSL_CTX_d™e_íabÀ
(
SSL_CTX
 *
˘x
);

1740 
__owur
 
SSL_CTX_d™e_mty≥_£t
(
SSL_CTX
 *
˘x
, c⁄° 
EVP_MD
 *
md
,

1741 
uöt8_t
 
mty≥
, uöt8_à
‹d
);

1742 
__owur
 
SSL_d™e_íabÀ
(
SSL
 *
s
, c⁄° *
ba£domaö
);

1743 
__owur
 
SSL_d™e_éß_add
(
SSL
 *
s
, 
uöt8_t
 
ußge
, uöt8_à
£À˘‹
,

1744 
uöt8_t
 
mty≥
, c⁄° *
d©a
, 
size_t
 
dÀn
);

1745 
__owur
 
SSL_gë0_d™e_auth‹ôy
(
SSL
 *
s
, 
X509
 **
m˚π
, 
EVP_PKEY
 **
m•ki
);

1746 
__owur
 
SSL_gë0_d™e_éß
(
SSL
 *
s
, 
uöt8_t
 *
ußge
, uöt8_à*
£À˘‹
,

1747 
uöt8_t
 *
mty≥
, c⁄° **
d©a
,

1748 
size_t
 *
dÀn
);

1753 
SSL_DANE
 *
SSL_gë0_d™e
(
SSL
 *
s¶
);

1757 
SSL_CTX_d™e_£t_Êags
(
SSL_CTX
 *
˘x
, 
Êags
);

1758 
SSL_CTX_d™e_˛ór_Êags
(
SSL_CTX
 *
˘x
, 
Êags
);

1759 
SSL_d™e_£t_Êags
(
SSL
 *
s¶
, 
Êags
);

1760 
SSL_d™e_˛ór_Êags
(
SSL
 *
s¶
, 
Êags
);

1762 
__owur
 
SSL_CTX_£t1_∑øm
(
SSL_CTX
 *
˘x
, 
X509_VERIFY_PARAM
 *
vpm
);

1763 
__owur
 
SSL_£t1_∑øm
(
SSL
 *
s¶
, 
X509_VERIFY_PARAM
 *
vpm
);

1765 
__owur
 
X509_VERIFY_PARAM
 *
SSL_CTX_gë0_∑øm
(
SSL_CTX
 *
˘x
);

1766 
__owur
 
X509_VERIFY_PARAM
 *
SSL_gë0_∑øm
(
SSL
 *
s¶
);

1768 #i‚de‡
OPENSSL_NO_SRP


1769 
SSL_CTX_£t_§p_u£∫ame
(
SSL_CTX
 *
˘x
, *
«me
);

1770 
SSL_CTX_£t_§p_∑ssw‹d
(
SSL_CTX
 *
˘x
, *
∑ssw‹d
);

1771 
SSL_CTX_£t_§p_°ªngth
(
SSL_CTX
 *
˘x
, 
°ªngth
);

1772 
SSL_CTX_£t_§p_˛õ¡_pwd_ˇŒback
(
SSL_CTX
 *
˘x
,

1773 *(*
cb
Ë(
SSL
 *, *));

1774 
SSL_CTX_£t_§p_vîify_∑øm_ˇŒback
(
SSL_CTX
 *
˘x
,

1775 (*
cb
Ë(
SSL
 *, *));

1776 
SSL_CTX_£t_§p_u£∫ame_ˇŒback
(
SSL_CTX
 *
˘x
,

1777 (*
cb
Ë(
SSL
 *, *, *));

1778 
SSL_CTX_£t_§p_cb_¨g
(
SSL_CTX
 *
˘x
, *
¨g
);

1780 
SSL_£t_§p_£rvî_∑øm
(
SSL
 *
s
, c⁄° 
BIGNUM
 *
N
, c⁄° BIGNUM *
g
,

1781 
BIGNUM
 *
ß
, BIGNUM *
v
, *
öfo
);

1782 
SSL_£t_§p_£rvî_∑øm_pw
(
SSL
 *
s
, c⁄° *
u£r
, c⁄° *
∑ss
,

1783 c⁄° *
gΩ
);

1785 
__owur
 
BIGNUM
 *
SSL_gë_§p_g
(
SSL
 *
s
);

1786 
__owur
 
BIGNUM
 *
SSL_gë_§p_N
(
SSL
 *
s
);

1788 
__owur
 *
SSL_gë_§p_u£∫ame
(
SSL
 *
s
);

1789 
__owur
 *
SSL_gë_§p_u£röfo
(
SSL
 *
s
);

1796 
	#SSL_CLIENT_HELLO_SUCCESS
 1

	)

1797 
	#SSL_CLIENT_HELLO_ERROR
 0

	)

1798 
	#SSL_CLIENT_HELLO_RETRY
 (-1)

	)

1800 (*
SSL_˛õ¡_hñlo_cb_‚
Ë(
	tSSL
 *
	ts
, *
	tÆ
, *
	t¨g
);

1801 
SSL_CTX_£t_˛õ¡_hñlo_cb
(
SSL_CTX
 *
c
, 
SSL_˛õ¡_hñlo_cb_‚
 
cb
,

1802 *
¨g
);

1803 
SSL_˛õ¡_hñlo_isv2
(
SSL
 *
s
);

1804 
SSL_˛õ¡_hñlo_gë0_Àgacy_vîsi⁄
(
SSL
 *
s
);

1805 
size_t
 
SSL_˛õ¡_hñlo_gë0_øndom
(
SSL
 *
s
, c⁄° **
out
);

1806 
size_t
 
SSL_˛õ¡_hñlo_gë0_£ssi⁄_id
(
SSL
 *
s
, c⁄° **
out
);

1807 
size_t
 
SSL_˛õ¡_hñlo_gë0_cùhîs
(
SSL
 *
s
, c⁄° **
out
);

1808 
size_t
 
SSL_˛õ¡_hñlo_gë0_com¥essi⁄_mëhods
(
SSL
 *
s
,

1809 c⁄° **
out
);

1810 
SSL_˛õ¡_hñlo_gë1_exãnsi⁄s_¥e£¡
(
SSL
 *
s
, **
out
, 
size_t
 *
ouéí
);

1811 
SSL_˛õ¡_hñlo_gë0_ext
(
SSL
 *
s
, 
ty≥
,

1812 c⁄° **
out
, 
size_t
 *
ouéí
);

1814 
SSL_˚πs_˛ór
(
SSL
 *
s
);

1815 
SSL_‰ì
(
SSL
 *
s¶
);

1816 #ifde‡
OSSL_ASYNC_FD


1820 
__owur
 
SSL_waôög_f‹_async
(
SSL
 *
s
);

1821 
__owur
 
SSL_gë_Æl_async_fds
(
SSL
 *
s
, 
OSSL_ASYNC_FD
 *
fds
, 
size_t
 *
numfds
);

1822 
__owur
 
SSL_gë_ch™ged_async_fds
(
SSL
 *
s
, 
OSSL_ASYNC_FD
 *
addfd
,

1823 
size_t
 *
numaddfds
, 
OSSL_ASYNC_FD
 *
dñfd
,

1824 
size_t
 *
numdñfds
);

1826 
__owur
 
SSL_ac˚±
(
SSL
 *
s¶
);

1827 
__owur
 
SSL_°©ñess
(
SSL
 *
s
);

1828 
__owur
 
SSL_c⁄√˘
(
SSL
 *
s¶
);

1829 
__owur
 
SSL_ªad
(
SSL
 *
s¶
, *
buf
, 
num
);

1830 
__owur
 
SSL_ªad_ex
(
SSL
 *
s¶
, *
buf
, 
size_t
 
num
, size_à*
ªadbyãs
);

1832 
	#SSL_READ_EARLY_DATA_ERROR
 0

	)

1833 
	#SSL_READ_EARLY_DATA_SUCCESS
 1

	)

1834 
	#SSL_READ_EARLY_DATA_FINISH
 2

	)

1836 
__owur
 
SSL_ªad_óæy_d©a
(
SSL
 *
s
, *
buf
, 
size_t
 
num
,

1837 
size_t
 *
ªadbyãs
);

1838 
__owur
 
SSL_≥ek
(
SSL
 *
s¶
, *
buf
, 
num
);

1839 
__owur
 
SSL_≥ek_ex
(
SSL
 *
s¶
, *
buf
, 
size_t
 
num
, size_à*
ªadbyãs
);

1840 
__owur
 
SSL_wrôe
(
SSL
 *
s¶
, c⁄° *
buf
, 
num
);

1841 
__owur
 
SSL_wrôe_ex
(
SSL
 *
s
, c⁄° *
buf
, 
size_t
 
num
, size_à*
wrôãn
);

1842 
__owur
 
SSL_wrôe_óæy_d©a
(
SSL
 *
s
, c⁄° *
buf
, 
size_t
 
num
,

1843 
size_t
 *
wrôãn
);

1844 
SSL_˘æ
(
SSL
 *
s¶
, 
cmd
, 
œrg
, *
∑rg
);

1845 
SSL_ˇŒback_˘æ
(
SSL
 *, , (*)());

1846 
SSL_CTX_˘æ
(
SSL_CTX
 *
˘x
, 
cmd
, 
œrg
, *
∑rg
);

1847 
SSL_CTX_ˇŒback_˘æ
(
SSL_CTX
 *, , (*)());

1849 
	#SSL_EARLY_DATA_NOT_SENT
 0

	)

1850 
	#SSL_EARLY_DATA_REJECTED
 1

	)

1851 
	#SSL_EARLY_DATA_ACCEPTED
 2

	)

1853 
__owur
 
SSL_gë_óæy_d©a_°©us
(c⁄° 
SSL
 *
s
);

1855 
__owur
 
SSL_gë_îr‹
(c⁄° 
SSL
 *
s
, 
ªt_code
);

1856 
__owur
 c⁄° *
SSL_gë_vîsi⁄
(c⁄° 
SSL
 *
s
);

1859 
__owur
 
SSL_CTX_£t_s¶_vîsi⁄
(
SSL_CTX
 *
˘x
, c⁄° 
SSL_METHOD
 *
mëh
);

1861 #i‚de‡
OPENSSL_NO_SSL3_METHOD


1862 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
SSLv3_mëhod
())

1863 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
SSLv3_£rvî_mëhod
())

1864 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
SSLv3_˛õ¡_mëhod
())

1867 
	#SSLv23_mëhod
 
TLS_mëhod


	)

1868 
	#SSLv23_£rvî_mëhod
 
TLS_£rvî_mëhod


	)

1869 
	#SSLv23_˛õ¡_mëhod
 
TLS_˛õ¡_mëhod


	)

1872 
__owur
 c⁄° 
SSL_METHOD
 *
TLS_mëhod
();

1873 
__owur
 c⁄° 
SSL_METHOD
 *
TLS_£rvî_mëhod
();

1874 
__owur
 c⁄° 
SSL_METHOD
 *
TLS_˛õ¡_mëhod
();

1876 #i‚de‡
OPENSSL_NO_TLS1_METHOD


1877 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
TLSv1_mëhod
())

1878 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
TLSv1_£rvî_mëhod
())

1879 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
TLSv1_˛õ¡_mëhod
())

1882 #i‚de‡
OPENSSL_NO_TLS1_1_METHOD


1883 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
TLSv1_1_mëhod
())

1884 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
TLSv1_1_£rvî_mëhod
())

1885 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
TLSv1_1_˛õ¡_mëhod
())

1888 #i‚de‡
OPENSSL_NO_TLS1_2_METHOD


1889 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
TLSv1_2_mëhod
())

1890 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
TLSv1_2_£rvî_mëhod
())

1891 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
TLSv1_2_˛õ¡_mëhod
())

1894 #i‚de‡
OPENSSL_NO_DTLS1_METHOD


1895 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
DTLSv1_mëhod
())

1896 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
DTLSv1_£rvî_mëhod
())

1897 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
DTLSv1_˛õ¡_mëhod
())

1900 #i‚de‡
OPENSSL_NO_DTLS1_2_METHOD


1902 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
DTLSv1_2_mëhod
())

1903 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
DTLSv1_2_£rvî_mëhod
())

1904 
DEPRECATEDIN_1_1_0
(
__owur
 c⁄° 
SSL_METHOD
 *
DTLSv1_2_˛õ¡_mëhod
())

1907 
__owur
 c⁄° 
SSL_METHOD
 *
DTLS_mëhod
();

1908 
__owur
 c⁄° 
SSL_METHOD
 *
DTLS_£rvî_mëhod
();

1909 
__owur
 c⁄° 
SSL_METHOD
 *
DTLS_˛õ¡_mëhod
();

1911 
__owur
 
size_t
 
DTLS_gë_d©a_mtu
(c⁄° 
SSL
 *
s
);

1913 
__owur
 
STACK_OF
(
SSL_CIPHER
Ë*
SSL_gë_cùhîs
(c⁄° 
SSL
 *
s
);

1914 
__owur
 
STACK_OF
(
SSL_CIPHER
Ë*
SSL_CTX_gë_cùhîs
(c⁄° 
SSL_CTX
 *
˘x
);

1915 
__owur
 
STACK_OF
(
SSL_CIPHER
Ë*
SSL_gë_˛õ¡_cùhîs
(c⁄° 
SSL
 *
s
);

1916 
__owur
 
STACK_OF
(
SSL_CIPHER
Ë*
SSL_gë1_suµ‹ãd_cùhîs
(
SSL
 *
s
);

1918 
__owur
 
SSL_do_h™dshake
(
SSL
 *
s
);

1919 
SSL_key_upd©e
(
SSL
 *
s
, 
upd©ëy≥
);

1920 
SSL_gë_key_upd©e_ty≥
(c⁄° 
SSL
 *
s
);

1921 
SSL_ª√gŸüã
(
SSL
 *
s
);

1922 
SSL_ª√gŸüã_abbªvüãd
(
SSL
 *
s
);

1923 
__owur
 
SSL_ª√gŸüã_≥ndög
(c⁄° 
SSL
 *
s
);

1924 
SSL_shutdown
(
SSL
 *
s
);

1925 
__owur
 
SSL_vîify_˛õ¡_po°_h™dshake
(
SSL
 *
s
);

1926 
SSL_CTX_£t_po°_h™dshake_auth
(
SSL_CTX
 *
˘x
, 
vÆ
);

1927 
SSL_£t_po°_h™dshake_auth
(
SSL
 *
s
, 
vÆ
);

1929 
__owur
 c⁄° 
SSL_METHOD
 *
SSL_CTX_gë_s¶_mëhod
(c⁄° 
SSL_CTX
 *
˘x
);

1930 
__owur
 c⁄° 
SSL_METHOD
 *
SSL_gë_s¶_mëhod
(c⁄° 
SSL
 *
s
);

1931 
__owur
 
SSL_£t_s¶_mëhod
(
SSL
 *
s
, c⁄° 
SSL_METHOD
 *
mëhod
);

1932 
__owur
 c⁄° *
SSL_Æît_ty≥_°rög_l⁄g
(
vÆue
);

1933 
__owur
 c⁄° *
SSL_Æît_ty≥_°rög
(
vÆue
);

1934 
__owur
 c⁄° *
SSL_Æît_desc_°rög_l⁄g
(
vÆue
);

1935 
__owur
 c⁄° *
SSL_Æît_desc_°rög
(
vÆue
);

1937 
SSL_£t0_CA_li°
(
SSL
 *
s
, 
STACK_OF
(
X509_NAME
Ë*
«me_li°
);

1938 
SSL_CTX_£t0_CA_li°
(
SSL_CTX
 *
˘x
, 
STACK_OF
(
X509_NAME
Ë*
«me_li°
);

1939 
__owur
 c⁄° 
STACK_OF
(
X509_NAME
Ë*
SSL_gë0_CA_li°
(c⁄° 
SSL
 *
s
);

1940 
__owur
 c⁄° 
STACK_OF
(
X509_NAME
Ë*
SSL_CTX_gë0_CA_li°
(c⁄° 
SSL_CTX
 *
˘x
);

1941 
__owur
 
SSL_add1_to_CA_li°
(
SSL
 *
s¶
, c⁄° 
X509
 *
x
);

1942 
__owur
 
SSL_CTX_add1_to_CA_li°
(
SSL_CTX
 *
˘x
, c⁄° 
X509
 *
x
);

1943 
__owur
 c⁄° 
STACK_OF
(
X509_NAME
Ë*
SSL_gë0_≥î_CA_li°
(c⁄° 
SSL
 *
s
);

1945 
SSL_£t_˛õ¡_CA_li°
(
SSL
 *
s
, 
STACK_OF
(
X509_NAME
Ë*
«me_li°
);

1946 
SSL_CTX_£t_˛õ¡_CA_li°
(
SSL_CTX
 *
˘x
, 
STACK_OF
(
X509_NAME
Ë*
«me_li°
);

1947 
__owur
 
STACK_OF
(
X509_NAME
Ë*
SSL_gë_˛õ¡_CA_li°
(c⁄° 
SSL
 *
s
);

1948 
__owur
 
STACK_OF
(
X509_NAME
Ë*
SSL_CTX_gë_˛õ¡_CA_li°
(c⁄° 
SSL_CTX
 *
s
);

1949 
__owur
 
SSL_add_˛õ¡_CA
(
SSL
 *
s¶
, 
X509
 *
x
);

1950 
__owur
 
SSL_CTX_add_˛õ¡_CA
(
SSL_CTX
 *
˘x
, 
X509
 *
x
);

1952 
SSL_£t_c⁄√˘_°©e
(
SSL
 *
s
);

1953 
SSL_£t_ac˚±_°©e
(
SSL
 *
s
);

1955 
__owur
 
SSL_gë_deÁu…_timeout
(c⁄° 
SSL
 *
s
);

1957 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

1958 
	#SSL_libøry_öô
(Ë
	`OPENSSL_öô_s¶
(0, 
NULL
)

	)

1961 
__owur
 *
SSL_CIPHER_des¸ùti⁄
(c⁄° 
SSL_CIPHER
 *, *
buf
, 
size
);

1962 
__owur
 
STACK_OF
(
X509_NAME
Ë*
SSL_dup_CA_li°
(c⁄° STACK_OF(X509_NAMEË*
sk
);

1964 
__owur
 
SSL
 *
SSL_dup
(SSL *
s¶
);

1966 
__owur
 
X509
 *
SSL_gë_˚πifiˇã
(c⁄° 
SSL
 *
s¶
);

1970 
evp_pkey_°
 *
SSL_gë_¥iv©ekey
(c⁄° 
SSL
 *
s¶
);

1972 
__owur
 
X509
 *
SSL_CTX_gë0_˚πifiˇã
(c⁄° 
SSL_CTX
 *
˘x
);

1973 
__owur
 
EVP_PKEY
 *
SSL_CTX_gë0_¥iv©ekey
(c⁄° 
SSL_CTX
 *
˘x
);

1975 
SSL_CTX_£t_quõt_shutdown
(
SSL_CTX
 *
˘x
, 
mode
);

1976 
__owur
 
SSL_CTX_gë_quõt_shutdown
(c⁄° 
SSL_CTX
 *
˘x
);

1977 
SSL_£t_quõt_shutdown
(
SSL
 *
s¶
, 
mode
);

1978 
__owur
 
SSL_gë_quõt_shutdown
(c⁄° 
SSL
 *
s¶
);

1979 
SSL_£t_shutdown
(
SSL
 *
s¶
, 
mode
);

1980 
__owur
 
SSL_gë_shutdown
(c⁄° 
SSL
 *
s¶
);

1981 
__owur
 
SSL_vîsi⁄
(c⁄° 
SSL
 *
s¶
);

1982 
__owur
 
SSL_˛õ¡_vîsi⁄
(c⁄° 
SSL
 *
s
);

1983 
__owur
 
SSL_CTX_£t_deÁu…_vîify_∑ths
(
SSL_CTX
 *
˘x
);

1984 
__owur
 
SSL_CTX_£t_deÁu…_vîify_dú
(
SSL_CTX
 *
˘x
);

1985 
__owur
 
SSL_CTX_£t_deÁu…_vîify_fûe
(
SSL_CTX
 *
˘x
);

1986 
__owur
 
SSL_CTX_lﬂd_vîify_loˇti⁄s
(
SSL_CTX
 *
˘x
, c⁄° *
CAfûe
,

1987 c⁄° *
CA∑th
);

1988 
	#SSL_gë0_£ssi⁄
 
SSL_gë_£ssi⁄


	)

1989 
__owur
 
SSL_SESSION
 *
SSL_gë_£ssi⁄
(c⁄° 
SSL
 *
s¶
);

1990 
__owur
 
SSL_SESSION
 *
SSL_gë1_£ssi⁄
(
SSL
 *
s¶
);

1991 
__owur
 
SSL_CTX
 *
SSL_gë_SSL_CTX
(c⁄° 
SSL
 *
s¶
);

1992 
SSL_CTX
 *
SSL_£t_SSL_CTX
(
SSL
 *
s¶
, SSL_CTX *
˘x
);

1993 
SSL_£t_öfo_ˇŒback
(
SSL
 *
s¶
,

1994 (*
cb
Ë(c⁄° 
SSL
 *
s¶
, 
ty≥
, 
vÆ
));

1995 (*
SSL_gë_öfo_ˇŒback
(c⁄° 
SSL
 *
s¶
)Ë(c⁄° SSL *s¶, 
ty≥
,

1996 
vÆ
);

1997 
__owur
 
OSSL_HANDSHAKE_STATE
 
SSL_gë_°©e
(c⁄° 
SSL
 *
s¶
);

1999 
SSL_£t_vîify_ªsu…
(
SSL
 *
s¶
, 
v
);

2000 
__owur
 
SSL_gë_vîify_ªsu…
(c⁄° 
SSL
 *
s¶
);

2001 
__owur
 
STACK_OF
(
X509
Ë*
SSL_gë0_vîifõd_chaö
(c⁄° 
SSL
 *
s
);

2003 
__owur
 
size_t
 
SSL_gë_˛õ¡_øndom
(c⁄° 
SSL
 *
s¶
, *
out
,

2004 
size_t
 
ouéí
);

2005 
__owur
 
size_t
 
SSL_gë_£rvî_øndom
(c⁄° 
SSL
 *
s¶
, *
out
,

2006 
size_t
 
ouéí
);

2007 
__owur
 
size_t
 
SSL_SESSION_gë_ma°î_key
(c⁄° 
SSL_SESSION
 *
£ss
,

2008 *
out
, 
size_t
 
ouéí
);

2009 
__owur
 
SSL_SESSION_£t1_ma°î_key
(
SSL_SESSION
 *
£ss
,

2010 c⁄° *
ö
, 
size_t
 
Àn
);

2011 
uöt8_t
 
SSL_SESSION_gë_max_‰agmít_Àngth
(c⁄° 
SSL_SESSION
 *
£ss
);

2013 
	#SSL_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

2014 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_SSL
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

2015 
__owur
 
SSL_£t_ex_d©a
(
SSL
 *
s¶
, 
idx
, *
d©a
);

2016 *
SSL_gë_ex_d©a
(c⁄° 
SSL
 *
s¶
, 
idx
);

2017 
	#SSL_SESSION_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

2018 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_SSL_SESSION
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

2019 
__owur
 
SSL_SESSION_£t_ex_d©a
(
SSL_SESSION
 *
ss
, 
idx
, *
d©a
);

2020 *
SSL_SESSION_gë_ex_d©a
(c⁄° 
SSL_SESSION
 *
ss
, 
idx
);

2021 
	#SSL_CTX_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

2022 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_SSL_CTX
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

2023 
__owur
 
SSL_CTX_£t_ex_d©a
(
SSL_CTX
 *
s¶
, 
idx
, *
d©a
);

2024 *
SSL_CTX_gë_ex_d©a
(c⁄° 
SSL_CTX
 *
s¶
, 
idx
);

2026 
__owur
 
SSL_gë_ex_d©a_X509_STORE_CTX_idx
();

2028 
	#SSL_CTX_£ss_£t_ˇche_size
(
˘x
,
t
) \

2029 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_SESS_CACHE_SIZE
,
t
,
NULL
)

	)

2030 
	#SSL_CTX_£ss_gë_ˇche_size
(
˘x
) \

2031 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_GET_SESS_CACHE_SIZE
,0,
NULL
)

	)

2032 
	#SSL_CTX_£t_£ssi⁄_ˇche_mode
(
˘x
,
m
) \

2033 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_SESS_CACHE_MODE
,
m
,
NULL
)

	)

2034 
	#SSL_CTX_gë_£ssi⁄_ˇche_mode
(
˘x
) \

2035 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_GET_SESS_CACHE_MODE
,0,
NULL
)

	)

2037 
	#SSL_CTX_gë_deÁu…_ªad_ahód
(
˘x
Ë
	`SSL_CTX_gë_ªad_ahód
(˘x)

	)

2038 
	#SSL_CTX_£t_deÁu…_ªad_ahód
(
˘x
,
m
Ë
	`SSL_CTX_£t_ªad_ahód
(˘x,m)

	)

2039 
	#SSL_CTX_gë_ªad_ahód
(
˘x
) \

2040 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_GET_READ_AHEAD
,0,
NULL
)

	)

2041 
	#SSL_CTX_£t_ªad_ahód
(
˘x
,
m
) \

2042 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_READ_AHEAD
,
m
,
NULL
)

	)

2043 
	#SSL_CTX_gë_max_˚π_li°
(
˘x
) \

2044 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_GET_MAX_CERT_LIST
,0,
NULL
)

	)

2045 
	#SSL_CTX_£t_max_˚π_li°
(
˘x
,
m
) \

2046 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_MAX_CERT_LIST
,
m
,
NULL
)

	)

2047 
	#SSL_gë_max_˚π_li°
(
s¶
) \

2048 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_GET_MAX_CERT_LIST
,0,
NULL
)

	)

2049 
	#SSL_£t_max_˚π_li°
(
s¶
,
m
) \

2050 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_MAX_CERT_LIST
,
m
,
NULL
)

	)

2052 
	#SSL_CTX_£t_max_£nd_‰agmít
(
˘x
,
m
) \

2053 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_MAX_SEND_FRAGMENT
,
m
,
NULL
)

	)

2054 
	#SSL_£t_max_£nd_‰agmít
(
s¶
,
m
) \

2055 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_MAX_SEND_FRAGMENT
,
m
,
NULL
)

	)

2056 
	#SSL_CTX_£t_•lô_£nd_‰agmít
(
˘x
,
m
) \

2057 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_SPLIT_SEND_FRAGMENT
,
m
,
NULL
)

	)

2058 
	#SSL_£t_•lô_£nd_‰agmít
(
s¶
,
m
) \

2059 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_SPLIT_SEND_FRAGMENT
,
m
,
NULL
)

	)

2060 
	#SSL_CTX_£t_max_pùñöes
(
˘x
,
m
) \

2061 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_MAX_PIPELINES
,
m
,
NULL
)

	)

2062 
	#SSL_£t_max_pùñöes
(
s¶
,
m
) \

2063 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_MAX_PIPELINES
,
m
,
NULL
)

	)

2065 
SSL_CTX_£t_deÁu…_ªad_buf„r_Àn
(
SSL_CTX
 *
˘x
, 
size_t
 
Àn
);

2066 
SSL_£t_deÁu…_ªad_buf„r_Àn
(
SSL
 *
s
, 
size_t
 
Àn
);

2068 #i‚de‡
OPENSSL_NO_DH


2070 
SSL_CTX_£t_tmp_dh_ˇŒback
(
SSL_CTX
 *
˘x
,

2071 
DH
 *(*
dh
Ë(
SSL
 *
s¶
, 
is_exp‹t
,

2072 
keyÀngth
));

2073 
SSL_£t_tmp_dh_ˇŒback
(
SSL
 *
s¶
,

2074 
DH
 *(*
dh
Ë(
SSL
 *
s¶
, 
is_exp‹t
,

2075 
keyÀngth
));

2078 
__owur
 c⁄° 
COMP_METHOD
 *
SSL_gë_cuºít_com¥essi⁄
(c⁄° 
SSL
 *
s
);

2079 
__owur
 c⁄° 
COMP_METHOD
 *
SSL_gë_cuºít_ex∑nsi⁄
(c⁄° 
SSL
 *
s
);

2080 
__owur
 c⁄° *
SSL_COMP_gë_«me
(c⁄° 
COMP_METHOD
 *
comp
);

2081 
__owur
 c⁄° *
SSL_COMP_gë0_«me
(c⁄° 
SSL_COMP
 *
comp
);

2082 
__owur
 
SSL_COMP_gë_id
(c⁄° 
SSL_COMP
 *
comp
);

2083 
STACK_OF
(
SSL_COMP
Ë*
SSL_COMP_gë_com¥essi⁄_mëhods
();

2084 
__owur
 
STACK_OF
(
SSL_COMP
Ë*
SSL_COMP_£t0_com¥essi⁄_mëhods
(STACK_OF(SSL_COMP)

2085 *
mëhs
);

2086 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

2087 
	#SSL_COMP_‰ì_com¥essi⁄_mëhods
(Ë0Ë

	)

2089 
__owur
 
SSL_COMP_add_com¥essi⁄_mëhod
(
id
, 
COMP_METHOD
 *
cm
);

2091 c⁄° 
SSL_CIPHER
 *
SSL_CIPHER_föd
(
SSL
 *
s¶
, c⁄° *
±r
);

2092 
SSL_CIPHER_gë_cùhî_nid
(c⁄° 
SSL_CIPHER
 *
c
);

2093 
SSL_CIPHER_gë_dige°_nid
(c⁄° 
SSL_CIPHER
 *
c
);

2094 
SSL_byãs_to_cùhî_li°
(
SSL
 *
s
, c⁄° *
byãs
, 
size_t
 
Àn
,

2095 
isv2f‹m©
, 
STACK_OF
(
SSL_CIPHER
Ë**
sk
,

2096 
STACK_OF
(
SSL_CIPHER
Ë**
scsvs
);

2099 
__owur
 
SSL_£t_£ssi⁄_tickë_ext
(
SSL
 *
s
, *
ext_d©a
, 
ext_Àn
);

2101 
__owur
 
SSL_£t_£ssi⁄_tickë_ext_cb
(
SSL
 *
s
,

2102 
és_£ssi⁄_tickë_ext_cb_‚
 
cb
,

2103 *
¨g
);

2106 
__owur
 
SSL_£t_£ssi⁄_£¸ë_cb
(
SSL
 *
s
,

2107 
és_£ssi⁄_£¸ë_cb_‚
 
£ssi⁄_£¸ë_cb
,

2108 *
¨g
);

2110 
SSL_CTX_£t_nŸ_ªsumabÀ_£ssi⁄_ˇŒback
(
SSL_CTX
 *
˘x
,

2111 (*
cb
Ë(
SSL
 *
s¶
,

2113 
is_f‹w¨d_£cuª
));

2115 
SSL_£t_nŸ_ªsumabÀ_£ssi⁄_ˇŒback
(
SSL
 *
s¶
,

2116 (*
cb
Ë(
SSL
 *
s¶
,

2117 
is_f‹w¨d_£cuª
));

2119 
SSL_CTX_£t_ªc‹d_∑ddög_ˇŒback
(
SSL_CTX
 *
˘x
,

2120 
size_t
 (*
cb
Ë(
SSL
 *
s¶
, 
ty≥
,

2121 
size_t
 
Àn
, *
¨g
));

2122 
SSL_CTX_£t_ªc‹d_∑ddög_ˇŒback_¨g
(
SSL_CTX
 *
˘x
, *
¨g
);

2123 *
SSL_CTX_gë_ªc‹d_∑ddög_ˇŒback_¨g
(c⁄° 
SSL_CTX
 *
˘x
);

2124 
SSL_CTX_£t_block_∑ddög
(
SSL_CTX
 *
˘x
, 
size_t
 
block_size
);

2126 
SSL_£t_ªc‹d_∑ddög_ˇŒback
(
SSL
 *
s¶
,

2127 
size_t
 (*
cb
Ë(
SSL
 *
s¶
, 
ty≥
,

2128 
size_t
 
Àn
, *
¨g
));

2129 
SSL_£t_ªc‹d_∑ddög_ˇŒback_¨g
(
SSL
 *
s¶
, *
¨g
);

2130 *
SSL_gë_ªc‹d_∑ddög_ˇŒback_¨g
(c⁄° 
SSL
 *
s¶
);

2131 
SSL_£t_block_∑ddög
(
SSL
 *
s¶
, 
size_t
 
block_size
);

2133 
SSL_£t_num_tickës
(
SSL
 *
s
, 
size_t
 
num_tickës
);

2134 
size_t
 
SSL_gë_num_tickës
(c⁄° 
SSL
 *
s
);

2135 
SSL_CTX_£t_num_tickës
(
SSL_CTX
 *
˘x
, 
size_t
 
num_tickës
);

2136 
size_t
 
SSL_CTX_gë_num_tickës
(c⁄° 
SSL_CTX
 *
˘x
);

2138 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

2139 
	#SSL_ˇche_hô
(
s
Ë
	`SSL_£ssi⁄_ªu£d
(s)

	)

2142 
__owur
 
SSL_£ssi⁄_ªu£d
(c⁄° 
SSL
 *
s
);

2143 
__owur
 
SSL_is_£rvî
(c⁄° 
SSL
 *
s
);

2145 
__owur
 __owu∏
SSL_CONF_CTX
 *
SSL_CONF_CTX_√w
();

2146 
SSL_CONF_CTX_föish
(
SSL_CONF_CTX
 *
c˘x
);

2147 
SSL_CONF_CTX_‰ì
(
SSL_CONF_CTX
 *
c˘x
);

2148 
SSL_CONF_CTX_£t_Êags
(
SSL_CONF_CTX
 *
c˘x
, 
Êags
);

2149 
__owur
 
SSL_CONF_CTX_˛ór_Êags
(
SSL_CONF_CTX
 *
c˘x
,

2150 
Êags
);

2151 
__owur
 
SSL_CONF_CTX_£t1_¥efix
(
SSL_CONF_CTX
 *
c˘x
, c⁄° *
¥e
);

2153 
SSL_CONF_CTX_£t_s¶
(
SSL_CONF_CTX
 *
c˘x
, 
SSL
 *
s¶
);

2154 
SSL_CONF_CTX_£t_s¶_˘x
(
SSL_CONF_CTX
 *
c˘x
, 
SSL_CTX
 *
˘x
);

2156 
__owur
 
SSL_CONF_cmd
(
SSL_CONF_CTX
 *
c˘x
, c⁄° *
cmd
, c⁄° *
vÆue
);

2157 
__owur
 
SSL_CONF_cmd_¨gv
(
SSL_CONF_CTX
 *
c˘x
, *
∑rgc
, ***
∑rgv
);

2158 
__owur
 
SSL_CONF_cmd_vÆue_ty≥
(
SSL_CONF_CTX
 *
c˘x
, c⁄° *
cmd
);

2160 
SSL_add_s¶_moduÀ
();

2161 
SSL_c⁄fig
(
SSL
 *
s
, c⁄° *
«me
);

2162 
SSL_CTX_c⁄fig
(
SSL_CTX
 *
˘x
, c⁄° *
«me
);

2164 #i‚de‡
OPENSSL_NO_SSL_TRACE


2165 
SSL_åa˚
(
wrôe_p
, 
vîsi⁄
, 
c⁄ã¡_ty≥
,

2166 c⁄° *
buf
, 
size_t
 
Àn
, 
SSL
 *
s¶
, *
¨g
);

2169 #i‚de‡
OPENSSL_NO_SOCK


2170 
DTLSv1_li°í
(
SSL
 *
s
, 
BIO_ADDR
 *
˛õ¡
);

2173 #i‚de‡
OPENSSL_NO_CT


2181 (*
s¶_˘_vÆid©i⁄_cb
)(c⁄° 
	tCT_POLICY_EVAL_CTX
 *
	t˘x
,

2182 c⁄° 
	tSTACK_OF
(
	tSCT
Ë*
	ts˘s
, *
	t¨g
);

2196 
SSL_£t_˘_vÆid©i⁄_ˇŒback
(
SSL
 *
s
, 
s¶_˘_vÆid©i⁄_cb
 
ˇŒback
,

2197 *
¨g
);

2198 
SSL_CTX_£t_˘_vÆid©i⁄_ˇŒback
(
SSL_CTX
 *
˘x
,

2199 
s¶_˘_vÆid©i⁄_cb
 
ˇŒback
,

2200 *
¨g
);

2201 
	#SSL_dißbÀ_˘
(
s
) \

2202 ((Ë
	`SSL_£t_vÆid©i⁄_ˇŒback
((
s
), 
NULL
, NULL))

	)

2203 
	#SSL_CTX_dißbÀ_˘
(
˘x
) \

2204 ((Ë
	`SSL_CTX_£t_vÆid©i⁄_ˇŒback
((
˘x
), 
NULL
, NULL))

	)

2212 
SSL_CT_VALIDATION_PERMISSIVE
 = 0,

2213 
SSL_CT_VALIDATION_STRICT


2224 
SSL_íabÀ_˘
(
SSL
 *
s
, 
vÆid©i⁄_mode
);

2225 
SSL_CTX_íabÀ_˘
(
SSL_CTX
 *
˘x
, 
vÆid©i⁄_mode
);

2230 
SSL_˘_is_íabÀd
(c⁄° 
SSL
 *
s
);

2231 
SSL_CTX_˘_is_íabÀd
(c⁄° 
SSL_CTX
 *
˘x
);

2234 c⁄° 
STACK_OF
(
SCT
Ë*
SSL_gë0_≥î_s˘s
(
SSL
 *
s
);

2243 
SSL_CTX_£t_deÁu…_˘log_li°_fûe
(
SSL_CTX
 *
˘x
);

2252 
SSL_CTX_£t_˘log_li°_fûe
(
SSL_CTX
 *
˘x
, c⁄° *
∑th
);

2258 
SSL_CTX_£t0_˘log_°‹e
(
SSL_CTX
 *
˘x
, 
CTLOG_STORE
 *
logs
);

2267 c⁄° 
CTLOG_STORE
 *
SSL_CTX_gë0_˘log_°‹e
(c⁄° 
SSL_CTX
 *
˘x
);

2273 
	#SSL_SECOP_OTHER_TYPE
 0xffff0000

	)

2274 
	#SSL_SECOP_OTHER_NONE
 0

	)

2275 
	#SSL_SECOP_OTHER_CIPHER
 (1 << 16)

	)

2276 
	#SSL_SECOP_OTHER_CURVE
 (2 << 16)

	)

2277 
	#SSL_SECOP_OTHER_DH
 (3 << 16)

	)

2278 
	#SSL_SECOP_OTHER_PKEY
 (4 << 16)

	)

2279 
	#SSL_SECOP_OTHER_SIGALG
 (5 << 16)

	)

2280 
	#SSL_SECOP_OTHER_CERT
 (6 << 16)

	)

2283 
	#SSL_SECOP_PEER
 0x1000

	)

2289 
	#SSL_SECOP_CIPHER_SUPPORTED
 (1 | 
SSL_SECOP_OTHER_CIPHER
)

	)

2291 
	#SSL_SECOP_CIPHER_SHARED
 (2 | 
SSL_SECOP_OTHER_CIPHER
)

	)

2293 
	#SSL_SECOP_CIPHER_CHECK
 (3 | 
SSL_SECOP_OTHER_CIPHER
)

	)

2295 
	#SSL_SECOP_CURVE_SUPPORTED
 (4 | 
SSL_SECOP_OTHER_CURVE
)

	)

2297 
	#SSL_SECOP_CURVE_SHARED
 (5 | 
SSL_SECOP_OTHER_CURVE
)

	)

2299 
	#SSL_SECOP_CURVE_CHECK
 (6 | 
SSL_SECOP_OTHER_CURVE
)

	)

2301 
	#SSL_SECOP_TMP_DH
 (7 | 
SSL_SECOP_OTHER_PKEY
)

	)

2303 
	#SSL_SECOP_VERSION
 (9 | 
SSL_SECOP_OTHER_NONE
)

	)

2305 
	#SSL_SECOP_TICKET
 (10 | 
SSL_SECOP_OTHER_NONE
)

	)

2307 
	#SSL_SECOP_SIGALG_SUPPORTED
 (11 | 
SSL_SECOP_OTHER_SIGALG
)

	)

2309 
	#SSL_SECOP_SIGALG_SHARED
 (12 | 
SSL_SECOP_OTHER_SIGALG
)

	)

2311 
	#SSL_SECOP_SIGALG_CHECK
 (13 | 
SSL_SECOP_OTHER_SIGALG
)

	)

2313 
	#SSL_SECOP_SIGALG_MASK
 (14 | 
SSL_SECOP_OTHER_SIGALG
)

	)

2315 
	#SSL_SECOP_COMPRESSION
 (15 | 
SSL_SECOP_OTHER_NONE
)

	)

2317 
	#SSL_SECOP_EE_KEY
 (16 | 
SSL_SECOP_OTHER_CERT
)

	)

2319 
	#SSL_SECOP_CA_KEY
 (17 | 
SSL_SECOP_OTHER_CERT
)

	)

2321 
	#SSL_SECOP_CA_MD
 (18 | 
SSL_SECOP_OTHER_CERT
)

	)

2323 
	#SSL_SECOP_PEER_EE_KEY
 (
SSL_SECOP_EE_KEY
 | 
SSL_SECOP_PEER
)

	)

2325 
	#SSL_SECOP_PEER_CA_KEY
 (
SSL_SECOP_CA_KEY
 | 
SSL_SECOP_PEER
)

	)

2327 
	#SSL_SECOP_PEER_CA_MD
 (
SSL_SECOP_CA_MD
 | 
SSL_SECOP_PEER
)

	)

2329 
SSL_£t_£curôy_Àvñ
(
SSL
 *
s
, 
Àvñ
);

2330 
__owur
 
SSL_gë_£curôy_Àvñ
(c⁄° 
SSL
 *
s
);

2331 
SSL_£t_£curôy_ˇŒback
(
SSL
 *
s
,

2332 (*
cb
Ë(c⁄° 
SSL
 *
s
, c⁄° 
SSL_CTX
 *
˘x
,

2333 
›
, 
bôs
, 
nid
,

2334 *
Ÿhî
, *
ex
));

2335 (*
SSL_gë_£curôy_ˇŒback
(c⁄° 
SSL
 *
s
)) (const SSL *s,

2336 c⁄° 
SSL_CTX
 *
˘x
, 
›
,

2337 
bôs
, 
nid
, *
Ÿhî
,

2338 *
ex
);

2339 
SSL_£t0_£curôy_ex_d©a
(
SSL
 *
s
, *
ex
);

2340 
__owur
 *
SSL_gë0_£curôy_ex_d©a
(c⁄° 
SSL
 *
s
);

2342 
SSL_CTX_£t_£curôy_Àvñ
(
SSL_CTX
 *
˘x
, 
Àvñ
);

2343 
__owur
 
SSL_CTX_gë_£curôy_Àvñ
(c⁄° 
SSL_CTX
 *
˘x
);

2344 
SSL_CTX_£t_£curôy_ˇŒback
(
SSL_CTX
 *
˘x
,

2345 (*
cb
Ë(c⁄° 
SSL
 *
s
, c⁄° 
SSL_CTX
 *
˘x
,

2346 
›
, 
bôs
, 
nid
,

2347 *
Ÿhî
, *
ex
));

2348 (*
SSL_CTX_gë_£curôy_ˇŒback
(c⁄° 
SSL_CTX
 *
˘x
)Ë(c⁄° 
SSL
 *
s
,

2349 c⁄° 
SSL_CTX
 *
˘x
,

2350 
›
, 
bôs
,

2351 
nid
,

2352 *
Ÿhî
,

2353 *
ex
);

2354 
SSL_CTX_£t0_£curôy_ex_d©a
(
SSL_CTX
 *
˘x
, *
ex
);

2355 
__owur
 *
SSL_CTX_gë0_£curôy_ex_d©a
(c⁄° 
SSL_CTX
 *
˘x
);

2358 
	#OPENSSL_INIT_NO_LOAD_SSL_STRINGS
 0x00100000L

	)

2359 
	#OPENSSL_INIT_LOAD_SSL_STRINGS
 0x00200000L

	)

2361 
	#OPENSSL_INIT_SSL_DEFAULT
 \

2362 (
OPENSSL_INIT_LOAD_SSL_STRINGS
 | 
OPENSSL_INIT_LOAD_CRYPTO_STRINGS
)

	)

2364 
OPENSSL_öô_s¶
(
uöt64_t
 
›ts
, c⁄° 
OPENSSL_INIT_SETTINGS
 *
£âögs
);

2366 #i‚de‡
OPENSSL_NO_UNIT_TEST


2367 
__owur
 c⁄° 
›ís¶_s¶_ã°_fun˘i⁄s
 *
SSL_ã°_fun˘i⁄s
();

2370 
__owur
 
SSL_‰ì_buf„rs
(
SSL
 *
s¶
);

2371 
__owur
 
SSL_Æloc_buf„rs
(
SSL
 *
s¶
);

2375 
	tSSL_TICKET_STATUS
;

2379 
	#SSL_TICKET_FATAL_ERR_MALLOC
 0

	)

2381 
	#SSL_TICKET_FATAL_ERR_OTHER
 1

	)

2383 
	#SSL_TICKET_NONE
 2

	)

2385 
	#SSL_TICKET_EMPTY
 3

	)

2387 
	#SSL_TICKET_NO_DECRYPT
 4

	)

2389 
	#SSL_TICKET_SUCCESS
 5

	)

2391 
	#SSL_TICKET_SUCCESS_RENEW
 6

	)

2394 
	tSSL_TICKET_RETURN
;

2397 
	#SSL_TICKET_RETURN_ABORT
 0

	)

2399 
	#SSL_TICKET_RETURN_IGNORE
 1

	)

2401 
	#SSL_TICKET_RETURN_IGNORE_RENEW
 2

	)

2403 
	#SSL_TICKET_RETURN_USE
 3

	)

2405 
	#SSL_TICKET_RETURN_USE_RENEW
 4

	)

2407 (*
SSL_CTX_gíî©e_£ssi⁄_tickë_‚
)(
	tSSL
 *
	ts
, *
	t¨g
);

2408 
SSL_TICKET_RETURN
 (*
	tSSL_CTX_de¸y±_£ssi⁄_tickë_‚
)(
	tSSL
 *
	ts
, 
	tSSL_SESSION
 *
	tss
,

2409 c⁄° *
	tkey«me
,

2410 
	tsize_t
 
	tkey«me_Àngth
,

2411 
	tSSL_TICKET_STATUS
 
	t°©us
,

2412 *
	t¨g
);

2413 
SSL_CTX_£t_£ssi⁄_tickë_cb
(
SSL_CTX
 *
˘x
,

2414 
SSL_CTX_gíî©e_£ssi⁄_tickë_‚
 
gí_cb
,

2415 
SSL_CTX_de¸y±_£ssi⁄_tickë_‚
 
dec_cb
,

2416 *
¨g
);

2417 
SSL_SESSION_£t1_tickë_≠pd©a
(
SSL_SESSION
 *
ss
, c⁄° *
d©a
, 
size_t
 
Àn
);

2418 
SSL_SESSION_gë0_tickë_≠pd©a
(
SSL_SESSION
 *
ss
, **
d©a
, 
size_t
 *
Àn
);

2420 c⁄° 
SSL_vîsi⁄_°r
[];

2422 (*
	tDTLS_timî_cb
)(
	tSSL
 *
	ts
, 
	ttimî_us
);

2424 
DTLS_£t_timî_cb
(
SSL
 *
s
, 
DTLS_timî_cb
 
cb
);

2427 (*
	gSSL_Ælow_óæy_d©a_cb_‚
)(
	tSSL
 *
	ts
, *
	t¨g
);

2428 
SSL_CTX_£t_Ælow_óæy_d©a_cb
(
SSL_CTX
 *
˘x
,

2429 
SSL_Ælow_óæy_d©a_cb_‚
 
cb
,

2430 *
¨g
);

2431 
SSL_£t_Ælow_óæy_d©a_cb
(
SSL
 *
s
,

2432 
SSL_Ælow_óæy_d©a_cb_‚
 
cb
,

2433 *
¨g
);

2435 #ifde‡ 
__˝lu•lus


	@/usr/include/poll.h

1 
	~<sys/pﬁl.h
>

	@/usr/include/pthread.h

18 #i‚de‡
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<ídün.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<bôs/±hªadty≥s.h
>

27 
	~<bôs/£tjmp.h
>

28 
	~<bôs/w‹dsize.h
>

29 
	~<bôs/ty≥s/°ru˘_time•ec.h
>

35 
	mPTHREAD_CREATE_JOINABLE
,

36 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

37 
	mPTHREAD_CREATE_DETACHED


38 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

45 
	mPTHREAD_MUTEX_TIMED_NP
,

46 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

47 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

48 
	mPTHREAD_MUTEX_ADAPTIVE_NP


49 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


51 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

52 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

53 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

54 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


56 #ifde‡
__USE_GNU


58 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


63 #ifde‡
__USE_XOPEN2K


67 
	mPTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

69 
	mPTHREAD_MUTEX_ROBUST
,

70 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


75 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


79 
	mPTHREAD_PRIO_NONE
,

80 
	mPTHREAD_PRIO_INHERIT
,

81 
	mPTHREAD_PRIO_PROTECT


86 #i‡
__PTHREAD_MUTEX_HAVE_PREV


87 
	#PTHREAD_MUTEX_INITIALIZER
 \

88 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

89 #ifde‡
__USE_GNU


90 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

91 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

92 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

93 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

94 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

99 
	#PTHREAD_MUTEX_INITIALIZER
 \

100 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

101 #ifde‡
__USE_GNU


102 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

104 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

106 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

107 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


117 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

119 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

120 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


126 #i‚de‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


127 #i‡
__WORDSIZE
 == 64

128 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

133 
	#PTHREAD_RWLOCK_INITIALIZER
 \

134 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

135 #ifde‡
__USE_GNU


136 #ifde‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

138 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, \

139 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

141 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


142 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

143 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

144 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

146 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

147 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

148 0 } }

	)

158 
	mPTHREAD_INHERIT_SCHED
,

159 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

160 
	mPTHREAD_EXPLICIT_SCHED


161 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

168 
	mPTHREAD_SCOPE_SYSTEM
,

169 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

170 
	mPTHREAD_SCOPE_PROCESS


171 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

178 
	mPTHREAD_PROCESS_PRIVATE
,

179 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

180 
	mPTHREAD_PROCESS_SHARED


181 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

187 
	#PTHREAD_COND_INITIALIZER
 { { {0}, {0}, {0, 0}, {0, 0}, 0, 0, {0, 0} } }

	)

191 
	s_±hªad_˛ónup_buf„r


193 (*
	m__routöe
) (*);

194 *
	m__¨g
;

195 
	m__ˇn˚…y≥
;

196 
_±hªad_˛ónup_buf„r
 *
	m__¥ev
;

202 
	mPTHREAD_CANCEL_ENABLE
,

203 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

204 
	mPTHREAD_CANCEL_DISABLE


205 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

209 
	mPTHREAD_CANCEL_DEFERRED
,

210 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

211 
	mPTHREAD_CANCEL_ASYNCHRONOUS


212 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

214 
	#PTHREAD_CANCELED
 ((*Ë-1)

	)

218 
	#PTHREAD_ONCE_INIT
 0

	)

221 #ifde‡
__USE_XOPEN2K


225 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

229 
__BEGIN_DECLS


234 
	$±hªad_¸óã
 (
±hªad_t
 *
__ª°ri˘
 
__√wthªad
,

235 c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

236 *(*
__°¨t_routöe
) (*),

237 *
__ª°ri˘
 
__¨g
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 3));

243 
	$±hªad_exô
 (*
__ªtvÆ
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

251 
	`±hªad_joö
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
);

253 #ifde‡
__USE_GNU


256 
	$±hªad_åyjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
Ë
__THROW
;

264 
	`±hªad_timedjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
,

265 c⁄° 
time•ec
 *
__ab°ime
);

272 
	$±hªad_dëach
 (
±hªad_t
 
__th
Ë
__THROW
;

276 
±hªad_t
 
	$±hªad_£lf
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

279 
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
)

280 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

288 
	$±hªad_©å_öô
 (
±hªad_©å_t
 *
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

291 
	$±hªad_©å_de°roy
 (
±hªad_©å_t
 *
__©å
)

292 
__THROW
 
	`__n⁄nuŒ
 ((1));

295 
	$±hªad_©å_gëdëach°©e
 (c⁄° 
±hªad_©å_t
 *
__©å
,

296 *
__dëach°©e
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

300 
	$±hªad_©å_£tdëach°©e
 (
±hªad_©å_t
 *
__©å
,

301 
__dëach°©e
)

302 
__THROW
 
	`__n⁄nuŒ
 ((1));

306 
	$±hªad_©å_gëgu¨dsize
 (c⁄° 
±hªad_©å_t
 *
__©å
,

307 
size_t
 *
__gu¨dsize
)

308 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

311 
	$±hªad_©å_£tgu¨dsize
 (
±hªad_©å_t
 *
__©å
,

312 
size_t
 
__gu¨dsize
)

313 
__THROW
 
	`__n⁄nuŒ
 ((1));

317 
	$±hªad_©å_gësched∑øm
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

318 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

319 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

322 
	$±hªad_©å_£tsched∑øm
 (
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

323 c⁄° 
sched_∑øm
 *
__ª°ri˘


324 
__∑øm
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

327 
	$±hªad_©å_gëschedpﬁicy
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


328 
__©å
, *
__ª°ri˘
 
__pﬁicy
)

329 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

332 
	$±hªad_©å_£tschedpﬁicy
 (
±hªad_©å_t
 *
__©å
, 
__pﬁicy
)

333 
__THROW
 
	`__n⁄nuŒ
 ((1));

336 
	$±hªad_©å_gëöhîôsched
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


337 
__©å
, *
__ª°ri˘
 
__öhîô
)

338 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

341 
	$±hªad_©å_£töhîôsched
 (
±hªad_©å_t
 *
__©å
,

342 
__öhîô
)

343 
__THROW
 
	`__n⁄nuŒ
 ((1));

347 
	$±hªad_©å_gësc›e
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

348 *
__ª°ri˘
 
__sc›e
)

349 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

352 
	$±hªad_©å_£tsc›e
 (
±hªad_©å_t
 *
__©å
, 
__sc›e
)

353 
__THROW
 
	`__n⁄nuŒ
 ((1));

356 
	$±hªad_©å_gë°ackaddr
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


357 
__©å
, **
__ª°ri˘
 
__°ackaddr
)

358 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__©åibuã_dïªˇãd__
;

364 
	$±hªad_©å_£t°ackaddr
 (
±hªad_©å_t
 *
__©å
,

365 *
__°ackaddr
)

366 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
;

369 
	$±hªad_©å_gë°acksize
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


370 
__©å
, 
size_t
 *
__ª°ri˘
 
__°acksize
)

371 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

376 
	$±hªad_©å_£t°acksize
 (
±hªad_©å_t
 *
__©å
,

377 
size_t
 
__°acksize
)

378 
__THROW
 
	`__n⁄nuŒ
 ((1));

380 #ifde‡
__USE_XOPEN2K


382 
	$±hªad_©å_gë°ack
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

383 **
__ª°ri˘
 
__°ackaddr
,

384 
size_t
 *
__ª°ri˘
 
__°acksize
)

385 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

390 
	$±hªad_©å_£t°ack
 (
±hªad_©å_t
 *
__©å
, *
__°ackaddr
,

391 
size_t
 
__°acksize
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

394 #ifde‡
__USE_GNU


397 
	$±hªad_©å_£èfföôy_≈
 (
±hªad_©å_t
 *
__©å
,

398 
size_t
 
__˝u£tsize
,

399 c⁄° 
˝u_£t_t
 *
__˝u£t
)

400 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

404 
	$±hªad_©å_gëafföôy_≈
 (c⁄° 
±hªad_©å_t
 *
__©å
,

405 
size_t
 
__˝u£tsize
,

406 
˝u_£t_t
 *
__˝u£t
)

407 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

410 
	$±hªad_gë©å_deÁu…_≈
 (
±hªad_©å_t
 *
__©å
)

411 
__THROW
 
	`__n⁄nuŒ
 ((1));

415 
	$±hªad_£èâr_deÁu…_≈
 (c⁄° 
±hªad_©å_t
 *
__©å
)

416 
__THROW
 
	`__n⁄nuŒ
 ((1));

421 
	$±hªad_gë©å_≈
 (
±hªad_t
 
__th
, 
±hªad_©å_t
 *
__©å
)

422 
__THROW
 
	`__n⁄nuŒ
 ((2));

430 
	$±hªad_£tsched∑øm
 (
±hªad_t
 
__èrgë_thªad
, 
__pﬁicy
,

431 c⁄° 
sched_∑øm
 *
__∑øm
)

432 
__THROW
 
	`__n⁄nuŒ
 ((3));

435 
	$±hªad_gësched∑øm
 (
±hªad_t
 
__èrgë_thªad
,

436 *
__ª°ri˘
 
__pﬁicy
,

437 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

438 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

441 
	$±hªad_£tsched¥io
 (
±hªad_t
 
__èrgë_thªad
, 
__¥io
)

442 
__THROW
;

445 #ifde‡
__USE_GNU


447 
	$±hªad_gë«me_≈
 (
±hªad_t
 
__èrgë_thªad
, *
__buf
,

448 
size_t
 
__buÊí
)

449 
__THROW
 
	`__n⁄nuŒ
 ((2));

452 
	$±hªad_£äame_≈
 (
±hªad_t
 
__èrgë_thªad
, c⁄° *
__«me
)

453 
__THROW
 
	`__n⁄nuŒ
 ((2));

457 #ifde‡
__USE_UNIX98


459 
	$±hªad_gëc⁄cuºícy
 (Ë
__THROW
;

462 
	$±hªad_£tc⁄cuºícy
 (
__Àvñ
Ë
__THROW
;

465 #ifde‡
__USE_GNU


470 
	$±hªad_yõld
 (Ë
__THROW
;

475 
	$±hªad_£èfföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

476 c⁄° 
˝u_£t_t
 *
__˝u£t
)

477 
__THROW
 
	`__n⁄nuŒ
 ((3));

480 
	$±hªad_gëafföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

481 
˝u_£t_t
 *
__˝u£t
)

482 
__THROW
 
	`__n⁄nuŒ
 ((3));

495 
	$±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

496 (*
__öô_routöe
Ë()Ë
	`__n⁄nuŒ
 ((1, 2));

507 
	`±hªad_£tˇn˚l°©e
 (
__°©e
, *
__ﬁd°©e
);

511 
	`±hªad_£tˇn˚…y≥
 (
__ty≥
, *
__ﬁdty≥
);

514 
	`±hªad_ˇn˚l
 (
±hªad_t
 
__th
);

519 
	`±hªad_ã°ˇn˚l
 ();

528 
__jmp_buf
 
__ˇn˚l_jmp_buf
;

529 
__mask_was_ßved
;

530 } 
__ˇn˚l_jmp_buf
[1];

531 *
__∑d
[4];

532 } 
	t__±hªad_unwöd_buf_t
 
	t__©åibuã__
 ((
	t__Æig√d__
));

535 #i‚de‡
__˛ónup_f˘_©åibuã


536 
	#__˛ónup_f˘_©åibuã


	)

541 
	s__±hªad_˛ónup_‰ame


543 (*
__ˇn˚l_routöe
) (*);

544 *
__ˇn˚l_¨g
;

545 
__do_ô
;

546 
__ˇn˚l_ty≥
;

549 #i‡
deföed
 
__GNUC__
 && deföed 
__EXCEPTIONS


550 #ifde‡
__˝lu•lus


552 ˛as†
	c__±hªad_˛ónup_˛ass


554 (*
__ˇn˚l_routöe
) (*);

555 *
__ˇn˚l_¨g
;

556 
__do_ô
;

557 
__ˇn˚l_ty≥
;

559 
public
:

560 
	$__±hªad_˛ónup_˛ass
 ((*
__f˘
Ë(*), *
__¨g
)

561 : 
	`__ˇn˚l_routöe
 (
__f˘
), 
	`__ˇn˚l_¨g
 (
__¨g
), 
	$__do_ô
 (1) { }

562 ~
	$__±hªad_˛ónup_˛ass
 (Ë{ i‡(
__do_ô
Ë
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); 
	}
}

563 
	$__£tdoô
 (
__√wvÆ
Ë{ 
__do_ô
 = __√wvÆ; 
	}
}

564 
	$__de„r
 (Ë{ 
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
,

565 &
__ˇn˚l_ty≥
); 
	}
}

566 
	$__ª°‹e
 (Ëc⁄° { 
	`±hªad_£tˇn˚…y≥
 (
__ˇn˚l_ty≥
, 0); 
	}
}

576 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

578 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
)

	)

582 
	#±hªad_˛ónup_p›
(
execuã
) \

583 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

584 } 0)

	)

586 #ifde‡
__USE_GNU


590 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

592 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
); \

593 
__˛‰ame
.
	`__de„r
 ()

	)

598 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

599 
__˛‰ame
.
	`__ª°‹e
 (); \

600 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

601 } 0)

	)

608 
__exã∫_ölöe
 

609 
	$__±hªad_˛ónup_routöe
 (
__±hªad_˛ónup_‰ame
 *
__‰ame
)

611 i‡(
__‰ame
->
__do_ô
)

612 
__‰ame
->
	`__ˇn˚l_routöe
 (__‰ame->
__ˇn˚l_¨g
);

613 
	}
}

622 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

624 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

625 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

626 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

627 .
__do_ô
 = 1 };

	)

631 
	#±hªad_˛ónup_p›
(
execuã
) \

632 
__˛‰ame
.
__do_ô
 = (
execuã
); \

633 } 0)

	)

635 #ifde‡
__USE_GNU


639 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

641 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

642 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

643 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

644 .
__do_ô
 = 1 }; \

645 (Ë
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
, \

646 &
__˛‰ame
.
__ˇn˚l_ty≥
)

	)

651 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

652 (Ë
	`±hªad_£tˇn˚…y≥
 (
__˛‰ame
.
__ˇn˚l_ty≥
, 
NULL
); \

653 
__˛‰ame
.
__do_ô
 = (
execuã
); \

654 } 0)

	)

665 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

667 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

668 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

669 *
__ˇn˚l_¨g
 = (
¨g
); \

670 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

671 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

672 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

674 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

675 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

679 
	`__±hªad_ªgi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

680 dÿ{

	)

681 
__±hªad_ªgi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

682 
__˛ónup_f˘_©åibuã
;

686 
	#±hªad_˛ónup_p›
(
execuã
) \

689 
	`__±hªad_uƒegi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

690 i‡(
execuã
) \

691 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

692 } 0)

	)

693 
	$__±hªad_uƒegi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

694 
__˛ónup_f˘_©åibuã
;

696 #ifde‡
__USE_GNU


700 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

702 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

703 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

704 *
__ˇn˚l_¨g
 = (
¨g
); \

705 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

706 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

707 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

709 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

710 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

714 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (&
__ˇn˚l_buf
); \

715 dÿ{

	)

716 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (
__±hªad_unwöd_buf_t
 *
__buf
)

717 
__˛ónup_f˘_©åibuã
;

722 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

725 
	`__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (&
__ˇn˚l_buf
); \

726 i‡(
execuã
) \

727 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

728 
	}
} 0)

	)

729 
	$__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (
__±hªad_unwöd_buf_t
 *
__buf
)

730 
__˛ónup_f˘_©åibuã
;

734 
	$__±hªad_unwöd_√xt
 (
__±hªad_unwöd_buf_t
 *
__buf
)

735 
__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
__n‹ëu∫__
))

736 #i‚de‡
SHARED


737 
	`__©åibuã__
 ((
__wók__
))

743 
__jmp_buf_èg
;

744 
	$__sig£tjmp
 (
__jmp_buf_èg
 *
__ív
, 
__ßvemask
Ë
__THROWNL
;

750 
	$±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

751 c⁄° 
±hªad_muãx©å_t
 *
__muãx©å
)

752 
__THROW
 
	`__n⁄nuŒ
 ((1));

755 
	$±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
)

756 
__THROW
 
	`__n⁄nuŒ
 ((1));

759 
	$±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
)

760 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

763 
	$±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
)

764 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

766 #ifde‡
__USE_XOPEN2K


768 
	$±hªad_muãx_timedlock
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

769 c⁄° 
time•ec
 *
__ª°ri˘


770 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

774 
	$±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
)

775 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

779 
	$±hªad_muãx_gë¥io˚ûög
 (c⁄° 
±hªad_muãx_t
 *

780 
__ª°ri˘
 
__muãx
,

781 *
__ª°ri˘
 
__¥io˚ûög
)

782 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

786 
	$±hªad_muãx_£çrio˚ûög
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

787 
__¥io˚ûög
,

788 *
__ª°ri˘
 
__ﬁd_˚ûög
)

789 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

792 #ifde‡
__USE_XOPEN2K8


794 
	$±hªad_muãx_c⁄si°ít
 (
±hªad_muãx_t
 *
__muãx
)

795 
__THROW
 
	`__n⁄nuŒ
 ((1));

796 #ifde‡
__USE_GNU


797 
	$±hªad_muãx_c⁄si°ít_≈
 (
±hªad_muãx_t
 *
__muãx
)

798 
__THROW
 
	`__n⁄nuŒ
 ((1));

807 
	$±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
)

808 
__THROW
 
	`__n⁄nuŒ
 ((1));

811 
	$±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
)

812 
__THROW
 
	`__n⁄nuŒ
 ((1));

815 
	$±hªad_muãx©å_gëpsh¨ed
 (c⁄° 
±hªad_muãx©å_t
 *

816 
__ª°ri˘
 
__©å
,

817 *
__ª°ri˘
 
__psh¨ed
)

818 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

821 
	$±hªad_muãx©å_£çsh¨ed
 (
±hªad_muãx©å_t
 *
__©å
,

822 
__psh¨ed
)

823 
__THROW
 
	`__n⁄nuŒ
 ((1));

825 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


827 
	$±hªad_muãx©å_gëty≥
 (c⁄° 
±hªad_muãx©å_t
 *
__ª°ri˘


828 
__©å
, *
__ª°ri˘
 
__köd
)

829 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

834 
	$±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
, 
__köd
)

835 
__THROW
 
	`__n⁄nuŒ
 ((1));

839 
	$±hªad_muãx©å_gë¥Ÿocﬁ
 (c⁄° 
±hªad_muãx©å_t
 *

840 
__ª°ri˘
 
__©å
,

841 *
__ª°ri˘
 
__¥Ÿocﬁ
)

842 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

846 
	$±hªad_muãx©å_£çrŸocﬁ
 (
±hªad_muãx©å_t
 *
__©å
,

847 
__¥Ÿocﬁ
)

848 
__THROW
 
	`__n⁄nuŒ
 ((1));

851 
	$±hªad_muãx©å_gë¥io˚ûög
 (c⁄° 
±hªad_muãx©å_t
 *

852 
__ª°ri˘
 
__©å
,

853 *
__ª°ri˘
 
__¥io˚ûög
)

854 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

857 
	$±hªad_muãx©å_£çrio˚ûög
 (
±hªad_muãx©å_t
 *
__©å
,

858 
__¥io˚ûög
)

859 
__THROW
 
	`__n⁄nuŒ
 ((1));

861 #ifde‡
__USE_XOPEN2K


863 
	$±hªad_muãx©å_gërobu°
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

864 *
__robu°√ss
)

865 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

866 #ifde‡
__USE_GNU


867 
	$±hªad_muãx©å_gërobu°_≈
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

868 *
__robu°√ss
)

869 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

873 
	$±hªad_muãx©å_£åobu°
 (
±hªad_muãx©å_t
 *
__©å
,

874 
__robu°√ss
)

875 
__THROW
 
	`__n⁄nuŒ
 ((1));

876 #ifde‡
__USE_GNU


877 
	$±hªad_muãx©å_£åobu°_≈
 (
±hªad_muãx©å_t
 *
__©å
,

878 
__robu°√ss
)

879 
__THROW
 
	`__n⁄nuŒ
 ((1));

884 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


889 
	$±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

890 c⁄° 
±hªad_rwlock©å_t
 *
__ª°ri˘


891 
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

894 
	$±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
)

895 
__THROW
 
	`__n⁄nuŒ
 ((1));

898 
	$±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

899 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

902 
	$±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

903 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

905 #ifde‡
__USE_XOPEN2K


907 
	$±hªad_rwlock_timedrdlock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

908 c⁄° 
time•ec
 *
__ª°ri˘


909 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

913 
	$±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
)

914 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

917 
	$±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
)

918 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

920 #ifde‡
__USE_XOPEN2K


922 
	$±hªad_rwlock_timedwæock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

923 c⁄° 
time•ec
 *
__ª°ri˘


924 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

928 
	$±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
)

929 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

935 
	$±hªad_rwlock©å_öô
 (
±hªad_rwlock©å_t
 *
__©å
)

936 
__THROW
 
	`__n⁄nuŒ
 ((1));

939 
	$±hªad_rwlock©å_de°roy
 (
±hªad_rwlock©å_t
 *
__©å
)

940 
__THROW
 
	`__n⁄nuŒ
 ((1));

943 
	$±hªad_rwlock©å_gëpsh¨ed
 (c⁄° 
±hªad_rwlock©å_t
 *

944 
__ª°ri˘
 
__©å
,

945 *
__ª°ri˘
 
__psh¨ed
)

946 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

949 
	$±hªad_rwlock©å_£çsh¨ed
 (
±hªad_rwlock©å_t
 *
__©å
,

950 
__psh¨ed
)

951 
__THROW
 
	`__n⁄nuŒ
 ((1));

954 
	$±hªad_rwlock©å_gëköd_≈
 (c⁄° 
±hªad_rwlock©å_t
 *

955 
__ª°ri˘
 
__©å
,

956 *
__ª°ri˘
 
__¥ef
)

957 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

960 
	$±hªad_rwlock©å_£tköd_≈
 (
±hªad_rwlock©å_t
 *
__©å
,

961 
__¥ef
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

969 
	$±hªad_c⁄d_öô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

970 c⁄° 
±hªad_c⁄d©å_t
 *
__ª°ri˘
 
__c⁄d_©å
)

971 
__THROW
 
	`__n⁄nuŒ
 ((1));

974 
	$±hªad_c⁄d_de°roy
 (
±hªad_c⁄d_t
 *
__c⁄d
)

975 
__THROW
 
	`__n⁄nuŒ
 ((1));

978 
	$±hªad_c⁄d_sig«l
 (
±hªad_c⁄d_t
 *
__c⁄d
)

979 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

982 
	$±hªad_c⁄d_brﬂdˇ°
 (
±hªad_c⁄d_t
 *
__c⁄d
)

983 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

990 
	$±hªad_c⁄d_waô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

991 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
)

992 
	`__n⁄nuŒ
 ((1, 2));

1001 
	$±hªad_c⁄d_timedwaô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

1002 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

1003 c⁄° 
time•ec
 *
__ª°ri˘
 
__ab°ime
)

1004 
	`__n⁄nuŒ
 ((1, 2, 3));

1009 
	$±hªad_c⁄d©å_öô
 (
±hªad_c⁄d©å_t
 *
__©å
)

1010 
__THROW
 
	`__n⁄nuŒ
 ((1));

1013 
	$±hªad_c⁄d©å_de°roy
 (
±hªad_c⁄d©å_t
 *
__©å
)

1014 
__THROW
 
	`__n⁄nuŒ
 ((1));

1017 
	$±hªad_c⁄d©å_gëpsh¨ed
 (c⁄° 
±hªad_c⁄d©å_t
 *

1018 
__ª°ri˘
 
__©å
,

1019 *
__ª°ri˘
 
__psh¨ed
)

1020 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1023 
	$±hªad_c⁄d©å_£çsh¨ed
 (
±hªad_c⁄d©å_t
 *
__©å
,

1024 
__psh¨ed
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1026 #ifde‡
__USE_XOPEN2K


1028 
	$±hªad_c⁄d©å_gë˛ock
 (c⁄° 
±hªad_c⁄d©å_t
 *

1029 
__ª°ri˘
 
__©å
,

1030 
__˛ockid_t
 *
__ª°ri˘
 
__˛ock_id
)

1031 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1034 
	$±hªad_c⁄d©å_£t˛ock
 (
±hªad_c⁄d©å_t
 *
__©å
,

1035 
__˛ockid_t
 
__˛ock_id
)

1036 
__THROW
 
	`__n⁄nuŒ
 ((1));

1040 #ifde‡
__USE_XOPEN2K


1045 
	$±hªad_•ö_öô
 (
±hªad_•ölock_t
 *
__lock
, 
__psh¨ed
)

1046 
__THROW
 
	`__n⁄nuŒ
 ((1));

1049 
	$±hªad_•ö_de°roy
 (
±hªad_•ölock_t
 *
__lock
)

1050 
__THROW
 
	`__n⁄nuŒ
 ((1));

1053 
	$±hªad_•ö_lock
 (
±hªad_•ölock_t
 *
__lock
)

1054 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1057 
	$±hªad_•ö_åylock
 (
±hªad_•ölock_t
 *
__lock
)

1058 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1061 
	$±hªad_•ö_u∆ock
 (
±hªad_•ölock_t
 *
__lock
)

1062 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1069 
	$±hªad_b¨rõr_öô
 (
±hªad_b¨rõr_t
 *
__ª°ri˘
 
__b¨rõr
,

1070 c⁄° 
±hªad_b¨rõøâr_t
 *
__ª°ri˘


1071 
__©å
, 
__cou¡
)

1072 
__THROW
 
	`__n⁄nuŒ
 ((1));

1075 
	$±hªad_b¨rõr_de°roy
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1076 
__THROW
 
	`__n⁄nuŒ
 ((1));

1079 
	$±hªad_b¨rõr_waô
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1080 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1084 
	$±hªad_b¨rõøâr_öô
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1085 
__THROW
 
	`__n⁄nuŒ
 ((1));

1088 
	$±hªad_b¨rõøâr_de°roy
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1089 
__THROW
 
	`__n⁄nuŒ
 ((1));

1092 
	$±hªad_b¨rõøâr_gëpsh¨ed
 (c⁄° 
±hªad_b¨rõøâr_t
 *

1093 
__ª°ri˘
 
__©å
,

1094 *
__ª°ri˘
 
__psh¨ed
)

1095 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1098 
	$±hªad_b¨rõøâr_£çsh¨ed
 (
±hªad_b¨rõøâr_t
 *
__©å
,

1099 
__psh¨ed
)

1100 
__THROW
 
	`__n⁄nuŒ
 ((1));

1112 
	$±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

1113 (*
__de°r_fun˘i⁄
) (*))

1114 
__THROW
 
	`__n⁄nuŒ
 ((1));

1117 
	$±hªad_key_dñëe
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1120 *
	$±hªad_gë•ecific
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1123 
	$±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

1124 c⁄° *
__poöãr
Ë
__THROW
 ;

1127 #ifde‡
__USE_XOPEN2K


1129 
	$±hªad_gë˝u˛ockid
 (
±hªad_t
 
__thªad_id
,

1130 
__˛ockid_t
 *
__˛ock_id
)

1131 
__THROW
 
	`__n⁄nuŒ
 ((2));

1146 
	$±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1147 (*
__∑ª¡
) (),

1148 (*
__chûd
Ë()Ë
__THROW
;

1151 #ifde‡
__USE_EXTERN_INLINES


1153 
__exã∫_ölöe
 

1154 
	`__NTH
 (
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
))

1156  
__thªad1
 =
__thªad2
;

1157 
	}
}

1160 
	g__END_DECLS


	@/usr/include/sched.h

19 #i‚def 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<„©uªs.h
>

25 
	~<bôs/ty≥s.h
>

27 
	#__√ed_size_t


	)

28 
	#__√ed_NULL


	)

29 
	~<°ddef.h
>

31 
	~<bôs/ty≥s/time_t.h
>

32 
	~<bôs/ty≥s/°ru˘_time•ec.h
>

33 #i‚de‡
__USE_XOPEN2K


34 
	~<time.h
>

37 #i‚de‡
__pid_t_deföed


38 
__pid_t
 
	tpid_t
;

39 
	#__pid_t_deföed


	)

43 
	~<bôs/sched.h
>

44 
	~<bôs/˝u-£t.h
>

47 
	#sched_¥i‹ôy
 
sched_¥i‹ôy


	)

48 
	#__sched_¥i‹ôy
 
sched_¥i‹ôy


	)

51 
__BEGIN_DECLS


54 
	$sched_£ç¨am
 (
__pid_t
 
__pid
, c⁄° 
sched_∑øm
 *
__∑øm
)

55 
__THROW
;

58 
	$sched_gë∑øm
 (
__pid_t
 
__pid
, 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

61 
	$sched_£tscheduÀr
 (
__pid_t
 
__pid
, 
__pﬁicy
,

62 c⁄° 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

65 
	$sched_gëscheduÀr
 (
__pid_t
 
__pid
Ë
__THROW
;

68 
	$sched_yõld
 (Ë
__THROW
;

71 
	$sched_gë_¥i‹ôy_max
 (
__Æg‹ôhm
Ë
__THROW
;

74 
	$sched_gë_¥i‹ôy_mö
 (
__Æg‹ôhm
Ë
__THROW
;

77 
	$sched_º_gë_öãrvÆ
 (
__pid_t
 
__pid
, 
time•ec
 *
__t
Ë
__THROW
;

80 #ifde‡
__USE_GNU


82 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

83 
	#CPU_SET
(
˝u
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

84 
	#CPU_CLR
(
˝u
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

85 
	#CPU_ISSET
(
˝u
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (˝u,  (
˝u_£t_t
), \

86 
˝u£ç
)

	)

87 
	#CPU_ZERO
(
˝u£ç
Ë
	`__CPU_ZERO_S
 ( (
˝u_£t_t
), cpu£ç)

	)

88 
	#CPU_COUNT
(
˝u£ç
Ë
	`__CPU_COUNT_S
 ( (
˝u_£t_t
), cpu£ç)

	)

90 
	#CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u, sësize, cpu£ç)

	)

91 
	#CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u, sësize, cpu£ç)

	)

92 
	#CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (cpu, setsize, \

93 
˝u£ç
)

	)

94 
	#CPU_ZERO_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_ZERO_S
 (£tsize, cpu£ç)

	)

95 
	#CPU_COUNT_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_COUNT_S
 (£tsize, cpu£ç)

	)

97 
	#CPU_EQUAL
(
˝u£ç1
, 
˝u£ç2
) \

98 
	`__CPU_EQUAL_S
 ( (
˝u_£t_t
), 
˝u£ç1
, 
˝u£ç2
)

	)

99 
	#CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

100 
	`__CPU_EQUAL_S
 (
£tsize
, 
˝u£ç1
, 
˝u£ç2
)

	)

102 
	#CPU_AND
(
de°£t
, 
§c£t1
, 
§c£t2
) \

103 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

104 
	#CPU_OR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

105 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

106 
	#CPU_XOR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

107 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

108 
	#CPU_AND_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

109 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

110 
	#CPU_OR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

111 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

112 
	#CPU_XOR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

113 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

115 
	#CPU_ALLOC_SIZE
(
cou¡
Ë
	`__CPU_ALLOC_SIZE
 (cou¡)

	)

116 
	#CPU_ALLOC
(
cou¡
Ë
	`__CPU_ALLOC
 (cou¡)

	)

117 
	#CPU_FREE
(
˝u£t
Ë
	`__CPU_FREE
 (˝u£t)

	)

121 
	$sched_£èfföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

122 c⁄° 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

125 
	$sched_gëafföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

126 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

129 
__END_DECLS


	@/usr/include/signal.h

22 #i‚def 
_SIGNAL_H


23 
	#_SIGNAL_H


	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ty≥s.h
>

30 
	~<bôs/signum.h
>

32 
	~<bôs/ty≥s/sig_©omic_t.h
>

34 #i‡
deföed
 
__USE_POSIX


35 
	~<bôs/ty≥s/sig£t_t.h
>

38 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


39 #i‚de‡
__pid_t_deföed


40 
__pid_t
 
	tpid_t
;

41 
	#__pid_t_deföed


	)

43 #ifde‡
__USE_XOPEN


45 #i‚de‡
__uid_t_deföed


46 
__uid_t
 
	tuid_t
;

47 
	#__uid_t_deföed


	)

51 #ifde‡
__USE_POSIX199309


53 
	~<bôs/ty≥s/°ru˘_time•ec.h
>

56 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_XOPEN_EXTENDED


57 
	~<bôs/ty≥s/sigöfo_t.h
>

58 
	~<bôs/sigöfo-c⁄°s.h
>

61 #ifde‡
__USE_MISC


62 
	~<bôs/ty≥s/sigvÆ_t.h
>

65 #ifde‡
__USE_POSIX199309


66 
	~<bôs/ty≥s/sigevít_t.h
>

67 
	~<bôs/sigevít-c⁄°s.h
>

72 (*
	t__sigh™dÀr_t
) ();

77 
__sigh™dÀr_t
 
	$__sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

78 
__THROW
;

79 #ifde‡
__USE_GNU


80 
__sigh™dÀr_t
 
	$sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

81 
__THROW
;

87 #ifde‡
__USE_MISC


88 
__sigh™dÀr_t
 
	$sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

89 
__THROW
;

92 #ifde‡
__REDIRECT_NTH


93 
__sigh™dÀr_t
 
	`__REDIRECT_NTH
 (
sig«l
,

94 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
),

95 
__sysv_sig«l
);

97 
	#sig«l
 
__sysv_sig«l


	)

101 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8


104 
__sigh™dÀr_t
 
	$bsd_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

105 
__THROW
;

111 #ifde‡
__USE_POSIX


112 
	$kûl
 (
__pid_t
 
__pid
, 
__sig
Ë
__THROW
;

115 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


119 
	$kûÕg
 (
__pid_t
 
__pgΩ
, 
__sig
Ë
__THROW
;

123 
	$øi£
 (
__sig
Ë
__THROW
;

125 #ifde‡
__USE_MISC


127 
__sigh™dÀr_t
 
	$ssig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

128 
__THROW
;

129 
	$gsig«l
 (
__sig
Ë
__THROW
;

132 #ifde‡
__USE_XOPEN2K8


134 
	`psig«l
 (
__sig
, c⁄° *
__s
);

137 
	`psigöfo
 (c⁄° 
sigöfo_t
 *
__pöfo
, c⁄° *
__s
);

149 #ifde‡
__USE_XOPEN_EXTENDED


150 #ifde‡
__GNUC__


151 
	$sig∑u£
 (
__sig
Ë
	`__asm__
 ("__xpg_sigpause");

153 
	`__sig∑u£
 (
__sig_‹_mask
, 
__is_sig
);

155 
	#sig∑u£
(
sig
Ë
	`__sig∑u£
 ((sig), 1)

	)

160 #ifde‡
__USE_MISC


167 
	#sigmask
(
sig
Ë(()(1u << ((sigË- 1)))

	)

170 
	$sigblock
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

173 
	$sig£tmask
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

176 
	$siggëmask
 (Ë
__THROW
 
__©åibuã_dïªˇãd__
;

180 #ifde‡
__USE_MISC


181 
	#NSIG
 
_NSIG


	)

184 #ifde‡
__USE_GNU


185 
__sigh™dÀr_t
 
	tsigh™dÀr_t
;

189 #ifde‡
__USE_MISC


190 
__sigh™dÀr_t
 
	tsig_t
;

193 #ifde‡
__USE_POSIX


196 
	$sigem±y£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
	$sigfûl£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

202 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

205 
	$sigdñ£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

208 
	$sigismembî
 (c⁄° 
sig£t_t
 *
__£t
, 
__signo
)

209 
__THROW
 
	`__n⁄nuŒ
 ((1));

211 #ifde‡
__USE_GNU


213 
	$sigi£m±y£t
 (c⁄° 
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

216 
	$sig™d£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

217 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

220 
	$sig‹£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

221 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

226 
	~<bôs/siga˘i⁄.h
>

229 
	$sig¥ocmask
 (
__how
, c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

230 
sig£t_t
 *
__ª°ri˘
 
__o£t
Ë
__THROW
;

237 
	$sigsu•íd
 (c⁄° 
sig£t_t
 *
__£t
Ë
	`__n⁄nuŒ
 ((1));

240 
	$siga˘i⁄
 (
__sig
, c⁄° 
siga˘i⁄
 *
__ª°ri˘
 
__a˘
,

241 
siga˘i⁄
 *
__ª°ri˘
 
__ﬂ˘
Ë
__THROW
;

244 
	$sig≥ndög
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

247 #ifde‡
__USE_POSIX199506


252 
	$sigwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
, *__ª°ri˘ 
__sig
)

253 
	`__n⁄nuŒ
 ((1, 2));

256 #ifde‡
__USE_POSIX199309


261 
	$sigwaôöfo
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

262 
sigöfo_t
 *
__ª°ri˘
 
__öfo
Ë
	`__n⁄nuŒ
 ((1));

269 
	$sigtimedwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

270 
sigöfo_t
 *
__ª°ri˘
 
__öfo
,

271 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
)

272 
	`__n⁄nuŒ
 ((1));

276 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, c⁄° 
sigvÆ
 
__vÆ
)

277 
__THROW
;

282 #ifde‡
__USE_MISC


286 c⁄° *c⁄° 
_sys_sigli°
[
_NSIG
];

287 c⁄° *c⁄° 
sys_sigli°
[
_NSIG
];

291 
	~<bôs/sigc⁄ãxt.h
>

294 
	$sigªtu∫
 (
sigc⁄ãxt
 *
__s˝
Ë
__THROW
;

299 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


300 
	#__√ed_size_t


	)

301 
	~<°ddef.h
>

303 
	~<bôs/ty≥s/°ack_t.h
>

304 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


306 
	~<sys/uc⁄ãxt.h
>

310 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_MISC


314 
	$sigöãºu±
 (
__sig
, 
__öãºu±
Ë
__THROW
;

316 
	~<bôs/sig°ack.h
>

317 
	~<bôs/ss_Êags.h
>

321 
	$sigÆt°ack
 (c⁄° 
°ack_t
 *
__ª°ri˘
 
__ss
,

322 
°ack_t
 *
__ª°ri˘
 
__oss
Ë
__THROW
;

325 #i‡((
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

326 || 
deföed
 
__USE_MISC
)

327 
	~<bôs/ty≥s/°ru˘_sig°ack.h
>

330 #i‡((
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

331 || 
deföed
 
__USE_MISC
)

335 
	$sig°ack
 (
sig°ack
 *
__ss
, sig°ack *
__oss
)

336 
__THROW
 
__©åibuã_dïªˇãd__
;

339 #ifde‡
__USE_XOPEN_EXTENDED


343 
	$sighﬁd
 (
__sig
Ë
__THROW
;

346 
	$sigªl£
 (
__sig
Ë
__THROW
;

349 
	$sigign‹e
 (
__sig
Ë
__THROW
;

352 
__sigh™dÀr_t
 
	$sig£t
 (
__sig
, 
__sigh™dÀr_t
 
__di•
Ë
__THROW
;

355 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


358 
	~<bôs/±hªadty≥s.h
>

359 
	~<bôs/sigthªad.h
>

366 
	$__libc_cuºít_sigπmö
 (Ë
__THROW
;

368 
	$__libc_cuºít_sigπmax
 (Ë
__THROW
;

370 
	#SIGRTMIN
 (
	`__libc_cuºít_sigπmö
 ())

	)

371 
	#SIGRTMAX
 (
	`__libc_cuºít_sigπmax
 ())

	)

373 
__END_DECLS


	@/usr/include/stdint.h

22 #i‚de‡
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<bôs/libc-hódî-°¨t.h
>

27 
	~<bôs/ty≥s.h
>

28 
	~<bôs/wch¨.h
>

29 
	~<bôs/w‹dsize.h
>

34 
	~<bôs/°döt-öä.h
>

37 
	~<bôs/°döt-uöä.h
>

43 
__öt_Àa°8_t
 
	töt_Àa°8_t
;

44 
__öt_Àa°16_t
 
	töt_Àa°16_t
;

45 
__öt_Àa°32_t
 
	töt_Àa°32_t
;

46 
__öt_Àa°64_t
 
	töt_Àa°64_t
;

49 
__uöt_Àa°8_t
 
	tuöt_Àa°8_t
;

50 
__uöt_Àa°16_t
 
	tuöt_Àa°16_t
;

51 
__uöt_Àa°32_t
 
	tuöt_Àa°32_t
;

52 
__uöt_Àa°64_t
 
	tuöt_Àa°64_t
;

58 sig√d 
	töt_Á°8_t
;

59 #i‡
__WORDSIZE
 == 64

60 
	töt_Á°16_t
;

61 
	töt_Á°32_t
;

62 
	töt_Á°64_t
;

64 
	töt_Á°16_t
;

65 
	töt_Á°32_t
;

66 
__exãnsi⁄__


67 
	töt_Á°64_t
;

71 
	tuöt_Á°8_t
;

72 #i‡
__WORDSIZE
 == 64

73 
	tuöt_Á°16_t
;

74 
	tuöt_Á°32_t
;

75 
	tuöt_Á°64_t
;

77 
	tuöt_Á°16_t
;

78 
	tuöt_Á°32_t
;

79 
__exãnsi⁄__


80 
	tuöt_Á°64_t
;

85 #i‡
__WORDSIZE
 == 64

86 #i‚de‡
__öçå_t_deföed


87 
	töçå_t
;

88 
	#__öçå_t_deföed


	)

90 
	tuöçå_t
;

92 #i‚de‡
__öçå_t_deföed


93 
	töçå_t
;

94 
	#__öçå_t_deföed


	)

96 
	tuöçå_t
;

101 
__ötmax_t
 
	tötmax_t
;

102 
__uötmax_t
 
	tuötmax_t
;

105 #i‡
__WORDSIZE
 == 64

106 
	#__INT64_C
(
c
Ë¯## 
L


	)

107 
	#__UINT64_C
(
c
Ë¯## 
UL


	)

109 
	#__INT64_C
(
c
Ë¯## 
LL


	)

110 
	#__UINT64_C
(
c
Ë¯## 
ULL


	)

116 
	#INT8_MIN
 (-128)

	)

117 
	#INT16_MIN
 (-32767-1)

	)

118 
	#INT32_MIN
 (-2147483647-1)

	)

119 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

121 
	#INT8_MAX
 (127)

	)

122 
	#INT16_MAX
 (32767)

	)

123 
	#INT32_MAX
 (2147483647)

	)

124 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

127 
	#UINT8_MAX
 (255)

	)

128 
	#UINT16_MAX
 (65535)

	)

129 
	#UINT32_MAX
 (4294967295U)

	)

130 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

134 
	#INT_LEAST8_MIN
 (-128)

	)

135 
	#INT_LEAST16_MIN
 (-32767-1)

	)

136 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

137 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

139 
	#INT_LEAST8_MAX
 (127)

	)

140 
	#INT_LEAST16_MAX
 (32767)

	)

141 
	#INT_LEAST32_MAX
 (2147483647)

	)

142 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

145 
	#UINT_LEAST8_MAX
 (255)

	)

146 
	#UINT_LEAST16_MAX
 (65535)

	)

147 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

148 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

152 
	#INT_FAST8_MIN
 (-128)

	)

153 #i‡
__WORDSIZE
 == 64

154 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

155 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

157 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

158 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

160 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

162 
	#INT_FAST8_MAX
 (127)

	)

163 #i‡
__WORDSIZE
 == 64

164 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

165 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

167 
	#INT_FAST16_MAX
 (2147483647)

	)

168 
	#INT_FAST32_MAX
 (2147483647)

	)

170 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

173 
	#UINT_FAST8_MAX
 (255)

	)

174 #i‡
__WORDSIZE
 == 64

175 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

176 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

178 
	#UINT_FAST16_MAX
 (4294967295U)

	)

179 
	#UINT_FAST32_MAX
 (4294967295U)

	)

181 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

185 #i‡
__WORDSIZE
 == 64

186 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

187 
	#INTPTR_MAX
 (9223372036854775807L)

	)

188 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

190 
	#INTPTR_MIN
 (-2147483647-1)

	)

191 
	#INTPTR_MAX
 (2147483647)

	)

192 
	#UINTPTR_MAX
 (4294967295U)

	)

197 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

199 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

202 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

208 #i‡
__WORDSIZE
 == 64

209 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

210 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

212 #i‡
__WORDSIZE32_PTRDIFF_LONG


213 
	#PTRDIFF_MIN
 (-2147483647L-1)

	)

214 
	#PTRDIFF_MAX
 (2147483647L)

	)

216 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

217 
	#PTRDIFF_MAX
 (2147483647)

	)

222 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

223 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

226 #i‡
__WORDSIZE
 == 64

227 
	#SIZE_MAX
 (18446744073709551615UL)

	)

229 #i‡
__WORDSIZE32_SIZE_ULONG


230 
	#SIZE_MAX
 (4294967295UL)

	)

232 
	#SIZE_MAX
 (4294967295U)

	)

237 #i‚de‡
WCHAR_MIN


239 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

240 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

244 
	#WINT_MIN
 (0u)

	)

245 
	#WINT_MAX
 (4294967295u)

	)

248 
	#INT8_C
(
c
Ë
	)
c

249 
	#INT16_C
(
c
Ë
	)
c

250 
	#INT32_C
(
c
Ë
	)
c

251 #i‡
__WORDSIZE
 == 64

252 
	#INT64_C
(
c
Ë¯## 
L


	)

254 
	#INT64_C
(
c
Ë¯## 
LL


	)

258 
	#UINT8_C
(
c
Ë
	)
c

259 
	#UINT16_C
(
c
Ë
	)
c

260 
	#UINT32_C
(
c
Ë¯## 
U


	)

261 #i‡
__WORDSIZE
 == 64

262 
	#UINT64_C
(
c
Ë¯## 
UL


	)

264 
	#UINT64_C
(
c
Ë¯## 
ULL


	)

268 #i‡
__WORDSIZE
 == 64

269 
	#INTMAX_C
(
c
Ë¯## 
L


	)

270 
	#UINTMAX_C
(
c
Ë¯## 
UL


	)

272 
	#INTMAX_C
(
c
Ë¯## 
LL


	)

273 
	#UINTMAX_C
(
c
Ë¯## 
ULL


	)

276 #i‡
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

278 
	#INT8_WIDTH
 8

	)

279 
	#UINT8_WIDTH
 8

	)

280 
	#INT16_WIDTH
 16

	)

281 
	#UINT16_WIDTH
 16

	)

282 
	#INT32_WIDTH
 32

	)

283 
	#UINT32_WIDTH
 32

	)

284 
	#INT64_WIDTH
 64

	)

285 
	#UINT64_WIDTH
 64

	)

287 
	#INT_LEAST8_WIDTH
 8

	)

288 
	#UINT_LEAST8_WIDTH
 8

	)

289 
	#INT_LEAST16_WIDTH
 16

	)

290 
	#UINT_LEAST16_WIDTH
 16

	)

291 
	#INT_LEAST32_WIDTH
 32

	)

292 
	#UINT_LEAST32_WIDTH
 32

	)

293 
	#INT_LEAST64_WIDTH
 64

	)

294 
	#UINT_LEAST64_WIDTH
 64

	)

296 
	#INT_FAST8_WIDTH
 8

	)

297 
	#UINT_FAST8_WIDTH
 8

	)

298 
	#INT_FAST16_WIDTH
 
__WORDSIZE


	)

299 
	#UINT_FAST16_WIDTH
 
__WORDSIZE


	)

300 
	#INT_FAST32_WIDTH
 
__WORDSIZE


	)

301 
	#UINT_FAST32_WIDTH
 
__WORDSIZE


	)

302 
	#INT_FAST64_WIDTH
 64

	)

303 
	#UINT_FAST64_WIDTH
 64

	)

305 
	#INTPTR_WIDTH
 
__WORDSIZE


	)

306 
	#UINTPTR_WIDTH
 
__WORDSIZE


	)

308 
	#INTMAX_WIDTH
 64

	)

309 
	#UINTMAX_WIDTH
 64

	)

311 
	#PTRDIFF_WIDTH
 
__WORDSIZE


	)

312 
	#SIG_ATOMIC_WIDTH
 32

	)

313 
	#SIZE_WIDTH
 
__WORDSIZE


	)

314 
	#WCHAR_WIDTH
 32

	)

315 
	#WINT_WIDTH
 32

	)

	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<bôs/libc-hódî-°¨t.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	#__√ed___va_li°


	)

36 
	~<°d¨g.h
>

38 
	~<bôs/ty≥s.h
>

39 
	~<bôs/ty≥s/__Âos_t.h
>

40 
	~<bôs/ty≥s/__Âos64_t.h
>

41 
	~<bôs/ty≥s/__FILE.h
>

42 
	~<bôs/ty≥s/FILE.h
>

43 
	~<bôs/ty≥s/°ru˘_FILE.h
>

45 #ifde‡
__USE_GNU


46 
	~<bôs/ty≥s/cookõ_io_fun˘i⁄s_t.h
>

49 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


50 #ifde‡
__GNUC__


51 #i‚de‡
_VA_LIST_DEFINED


52 
__gnuc_va_li°
 
	tva_li°
;

53 
	#_VA_LIST_DEFINED


	)

56 
	~<°d¨g.h
>

60 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


61 #i‚de‡
__off_t_deföed


62 #i‚de‡
__USE_FILE_OFFSET64


63 
__off_t
 
	toff_t
;

65 
__off64_t
 
	toff_t
;

67 
	#__off_t_deföed


	)

69 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


70 
__off64_t
 
	toff64_t
;

71 
	#__off64_t_deföed


	)

75 #ifde‡
__USE_XOPEN2K8


76 #i‚de‡
__ssize_t_deföed


77 
__ssize_t
 
	tssize_t
;

78 
	#__ssize_t_deföed


	)

83 #i‚de‡
__USE_FILE_OFFSET64


84 
__Âos_t
 
	tÂos_t
;

86 
__Âos64_t
 
	tÂos_t
;

88 #ifde‡
__USE_LARGEFILE64


89 
__Âos64_t
 
	tÂos64_t
;

93 
	#_IOFBF
 0

	)

94 
	#_IOLBF
 1

	)

95 
	#_IONBF
 2

	)

99 
	#BUFSIZ
 8192

	)

104 
	#EOF
 (-1)

	)

109 
	#SEEK_SET
 0

	)

110 
	#SEEK_CUR
 1

	)

111 
	#SEEK_END
 2

	)

112 #ifde‡
__USE_GNU


113 
	#SEEK_DATA
 3

	)

114 
	#SEEK_HOLE
 4

	)

118 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


120 
	#P_tmpdú
 "/tmp"

	)

133 
	~<bôs/°dio_lim.h
>

137 
FILE
 *
°dö
;

138 
FILE
 *
°dout
;

139 
FILE
 *
°dîr
;

141 
	#°dö
 
°dö


	)

142 
	#°dout
 
°dout


	)

143 
	#°dîr
 
°dîr


	)

146 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

148 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

150 #ifde‡
__USE_ATFILE


152 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

153 c⁄° *
__√w
Ë
__THROW
;

156 #ifde‡
__USE_GNU


158 
	#RENAME_NOREPLACE
 (1 << 0)

	)

159 
	#RENAME_EXCHANGE
 (1 << 1)

	)

160 
	#RENAME_WHITEOUT
 (1 << 2)

	)

164 
	$ª«mót2
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

165 c⁄° *
__√w
, 
__Êags
Ë
__THROW
;

172 #i‚de‡
__USE_FILE_OFFSET64


173 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

175 #ifde‡
__REDIRECT


176 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

178 
	#tmpfûe
 
tmpfûe64


	)

182 #ifde‡
__USE_LARGEFILE64


183 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

187 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

189 #ifde‡
__USE_MISC


192 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

196 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


204 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

205 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

213 
	`f˛o£
 (
FILE
 *
__°ªam
);

218 
	`fÊush
 (
FILE
 *
__°ªam
);

220 #ifde‡
__USE_MISC


227 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

230 #ifde‡
__USE_GNU


237 
	`f˛o£Æl
 ();

241 #i‚de‡
__USE_FILE_OFFSET64


246 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

247 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

252 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

253 c⁄° *
__ª°ri˘
 
__modes
,

254 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

256 #ifde‡
__REDIRECT


257 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

258 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

259 
__wur
;

260 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

261 c⁄° *
__ª°ri˘
 
__modes
,

262 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

263 
__wur
;

265 
	#f›í
 
f›í64


	)

266 
	#‰e›í
 
‰e›í64


	)

269 #ifde‡
__USE_LARGEFILE64


270 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

271 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

272 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

273 c⁄° *
__ª°ri˘
 
__modes
,

274 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

277 #ifdef 
__USE_POSIX


279 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

282 #ifdef 
__USE_GNU


285 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

286 c⁄° *
__ª°ri˘
 
__modes
,

287 
cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

290 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

292 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

293 
__THROW
 
__wur
;

298 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

304 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

308 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

309 
__modes
, 
size_t
 
__n
Ë
__THROW
;

311 #ifdef 
__USE_MISC


314 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

315 
size_t
 
__size
Ë
__THROW
;

318 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

326 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

327 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

332 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

334 
	$•rötf
 (*
__ª°ri˘
 
__s
,

335 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

341 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

342 
__gnuc_va_li°
 
__¨g
);

347 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
__gnuc_va_li°
 
__¨g
);

349 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

350 
__gnuc_va_li°
 
__¨g
Ë
__THROWNL
;

352 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_UNIX98


354 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

355 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

356 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

358 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

359 c⁄° *
__ª°ri˘
 
__f‹m©
, 
__gnuc_va_li°
 
__¨g
)

360 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

363 #i‡
	`__GLIBC_USE
 (
LIB_EXT2
)

366 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

367 
__gnuc_va_li°
 
__¨g
)

368 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

369 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

370 c⁄° *
__ª°ri˘
 
__fmt
, ...)

371 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

372 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

373 c⁄° *
__ª°ri˘
 
__fmt
, ...)

374 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

377 #ifde‡
__USE_XOPEN2K8


379 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

380 
__gnuc_va_li°
 
__¨g
)

381 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

382 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

383 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

391 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

392 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

397 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

399 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

400 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

402 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

403 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

404 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

405 #ifde‡
__REDIRECT


409 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

410 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

411 
__isoc99_fsˇnf
Ë
__wur
;

412 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

413 
__isoc99_sˇnf
Ë
__wur
;

414 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

415 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

416 
__isoc99_ssˇnf
);

418 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

419 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

420 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

421 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

422 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

423 
	#fsˇnf
 
__isoc99_fsˇnf


	)

424 
	#sˇnf
 
__isoc99_sˇnf


	)

425 
	#ssˇnf
 
__isoc99_ssˇnf


	)

429 #ifdef 
__USE_ISOC99


434 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

435 
__gnuc_va_li°
 
__¨g
)

436 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

442 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
__gnuc_va_li°
 
__¨g
)

443 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

446 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

447 c⁄° *
__ª°ri˘
 
__f‹m©
, 
__gnuc_va_li°
 
__¨g
)

448 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

450 #i‡!
deföed
 
__USE_GNU
 \

451 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

452 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

453 #ifde‡
__REDIRECT


457 
	`__REDIRECT
 (
vfsˇnf
,

458 (
FILE
 *
__ª°ri˘
 
__s
,

459 c⁄° *
__ª°ri˘
 
__f‹m©
, 
__gnuc_va_li°
 
__¨g
),

460 
__isoc99_vfsˇnf
)

461 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

462 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

463 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

464 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

465 
	`__REDIRECT_NTH
 (
vssˇnf
,

466 (c⁄° *
__ª°ri˘
 
__s
,

467 c⁄° *
__ª°ri˘
 
__f‹m©
,

468 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

469 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

471 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

472 c⁄° *
__ª°ri˘
 
__f‹m©
,

473 
__gnuc_va_li°
 
__¨g
Ë
__wur
;

474 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

475 
__gnuc_va_li°
 
__¨g
Ë
__wur
;

476 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

477 c⁄° *
__ª°ri˘
 
__f‹m©
,

478 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

479 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

480 
	#vsˇnf
 
__isoc99_vsˇnf


	)

481 
	#vssˇnf
 
__isoc99_vssˇnf


	)

491 
	`fgëc
 (
FILE
 *
__°ªam
);

492 
	`gëc
 (
FILE
 *
__°ªam
);

498 
	`gëch¨
 ();

500 #ifde‡
__USE_POSIX199506


505 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

506 
	`gëch¨_u∆ocked
 ();

509 #ifde‡
__USE_MISC


516 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

527 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

528 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

534 
	`putch¨
 (
__c
);

536 #ifde‡
__USE_MISC


543 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

546 #ifde‡
__USE_POSIX199506


551 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

552 
	`putch¨_u∆ocked
 (
__c
);

556 #i‡
deföed
 
__USE_MISC
 \

557 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

559 
	`gëw
 (
FILE
 *
__°ªam
);

562 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

570 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

571 
__wur
;

573 #i‡
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

583 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

586 #ifde‡
__USE_GNU


593 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

594 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

598 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

609 
__ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

610 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

611 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

612 
__ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

613 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

614 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

622 
__ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

623 
size_t
 *
__ª°ri˘
 
__n
,

624 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

632 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

638 
	`puts
 (c⁄° *
__s
);

645 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

652 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

653 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

658 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

659 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

661 #ifde‡
__USE_GNU


668 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

669 
FILE
 *
__ª°ri˘
 
__°ªam
);

672 #ifde‡
__USE_MISC


679 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

680 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

681 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

682 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

690 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

695 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

700 
	`ªwöd
 (
FILE
 *
__°ªam
);

707 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


708 #i‚de‡
__USE_FILE_OFFSET64


713 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

718 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

720 #ifde‡
__REDIRECT


721 
	`__REDIRECT
 (
f£eko
,

722 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

723 
f£eko64
);

724 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

726 
	#f£eko
 
f£eko64


	)

727 
	#·ñlo
 
·ñlo64


	)

732 #i‚de‡
__USE_FILE_OFFSET64


737 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

742 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

744 #ifde‡
__REDIRECT


745 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

746 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

747 
	`__REDIRECT
 (
f£ços
,

748 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

750 
	#fgëpos
 
fgëpos64


	)

751 
	#f£ços
 
f£ços64


	)

755 #ifde‡
__USE_LARGEFILE64


756 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

757 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

758 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

759 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

763 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

765 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

767 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

769 #ifde‡
__USE_MISC


771 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

772 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

773 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

781 
	`≥º‹
 (c⁄° *
__s
);

787 
	~<bôs/sys_îæi°.h
>

790 #ifdef 
__USE_POSIX


792 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

795 #ifde‡
__USE_MISC


797 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

801 #ifde‡
__USE_POSIX2


806 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

812 
	`p˛o£
 (
FILE
 *
__°ªam
);

816 #ifdef 
__USE_POSIX


818 *
	$˘îmid
 (*
__s
Ë
__THROW
;

822 #i‡(
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
Ë|| deföed 
__USE_GNU


824 *
	`cu£rid
 (*
__s
);

828 #ifdef 
__USE_GNU


829 
ob°ack
;

832 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

833 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

834 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

835 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

836 c⁄° *
__ª°ri˘
 
__f‹m©
,

837 
__gnuc_va_li°
 
__¨gs
)

838 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

842 #ifde‡
__USE_POSIX199506


846 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

850 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

853 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

856 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


859 
	~<bôs/gë›t_posix.h
>

864 
	`__uÊow
 (
FILE
 *);

865 
	`__ovîÊow
 (
FILE
 *, );

869 #ifde‡
__USE_EXTERN_INLINES


870 
	~<bôs/°dio.h
>

872 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


873 
	~<bôs/°dio2.h
>

875 #ifde‡
__LDBL_COMPAT


876 
	~<bôs/°dio-ldbl.h
>

879 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

25 
	~<bôs/libc-hódî-°¨t.h
>

28 
	#__√ed_size_t


	)

29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

31 
	~<°ddef.h
>

33 
	g__BEGIN_DECLS


35 
	#_STDLIB_H
 1

	)

37 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


39 
	~<bôs/waôÊags.h
>

40 
	~<bôs/waô°©us.h
>

43 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (°©us)

	)

44 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (°©us)

	)

45 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (°©us)

	)

46 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (°©us)

	)

47 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (°©us)

	)

48 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (°©us)

	)

49 #ifde‡
__WIFCONTINUED


50 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (°©us)

	)

55 
	~<bôs/Êﬂä.h
>

60 
	mquŸ
;

61 
	mªm
;

62 } 
	tdiv_t
;

65 #i‚de‡
__ldiv_t_deföed


68 
	mquŸ
;

69 
	mªm
;

70 } 
	tldiv_t
;

71 
	#__ldiv_t_deföed
 1

	)

74 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


76 
__exãnsi⁄__
 struct

78 
	mquŸ
;

79 
	mªm
;

80 } 
	tŒdiv_t
;

81 
	#__Œdiv_t_deföed
 1

	)

86 
	#RAND_MAX
 2147483647

	)

91 
	#EXIT_FAILURE
 1

	)

92 
	#EXIT_SUCCESS
 0

	)

96 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

97 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

101 
	$©of
 (c⁄° *
__≈å
)

102 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

104 
	$©oi
 (c⁄° *
__≈å
)

105 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

107 
	$©ﬁ
 (c⁄° *
__≈å
)

108 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

110 #ifde‡
__USE_ISOC99


112 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

113 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

117 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

118 **
__ª°ri˘
 
__íd±r
)

119 
__THROW
 
	`__n⁄nuŒ
 ((1));

121 #ifdef 
__USE_ISOC99


123 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

124 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

126 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

127 **
__ª°ri˘
 
__íd±r
)

128 
__THROW
 
	`__n⁄nuŒ
 ((1));

133 #i‡
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
_Flﬂt16
 
	$°πof16
 (c⁄° *
__ª°ri˘
 
__≈å
,

135 **
__ª°ri˘
 
__íd±r
)

136 
__THROW
 
	`__n⁄nuŒ
 ((1));

139 #i‡
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

140 
_Flﬂt32
 
	$°πof32
 (c⁄° *
__ª°ri˘
 
__≈å
,

141 **
__ª°ri˘
 
__íd±r
)

142 
__THROW
 
	`__n⁄nuŒ
 ((1));

145 #i‡
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

146 
_Flﬂt64
 
	$°πof64
 (c⁄° *
__ª°ri˘
 
__≈å
,

147 **
__ª°ri˘
 
__íd±r
)

148 
__THROW
 
	`__n⁄nuŒ
 ((1));

151 #i‡
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

152 
_Flﬂt128
 
	$°πof128
 (c⁄° *
__ª°ri˘
 
__≈å
,

153 **
__ª°ri˘
 
__íd±r
)

154 
__THROW
 
	`__n⁄nuŒ
 ((1));

157 #i‡
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

158 
_Flﬂt32x
 
	$°πof32x
 (c⁄° *
__ª°ri˘
 
__≈å
,

159 **
__ª°ri˘
 
__íd±r
)

160 
__THROW
 
	`__n⁄nuŒ
 ((1));

163 #i‡
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

164 
_Flﬂt64x
 
	$°πof64x
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

169 #i‡
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

170 
_Flﬂt128x
 
	$°πof128x
 (c⁄° *
__ª°ri˘
 
__≈å
,

171 **
__ª°ri˘
 
__íd±r
)

172 
__THROW
 
	`__n⁄nuŒ
 ((1));

176 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

177 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

178 
__THROW
 
	`__n⁄nuŒ
 ((1));

180 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

181 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

182 
__THROW
 
	`__n⁄nuŒ
 ((1));

184 #ifde‡
__USE_MISC


186 
__exãnsi⁄__


187 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

191 
__exãnsi⁄__


192 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

193 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

194 
__THROW
 
	`__n⁄nuŒ
 ((1));

197 #ifde‡
__USE_ISOC99


199 
__exãnsi⁄__


200 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

204 
__exãnsi⁄__


205 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

206 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

207 
__THROW
 
	`__n⁄nuŒ
 ((1));

211 #i‡
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

212 
	$°r‰omd
 (*
__de°
, 
size_t
 
__size
, c⁄° *
__f‹m©
,

213 
__f
)

214 
__THROW
 
	`__n⁄nuŒ
 ((3));

216 
	$°r‰omf
 (*
__de°
, 
size_t
 
__size
, c⁄° *
__f‹m©
,

217 
__f
)

218 
__THROW
 
	`__n⁄nuŒ
 ((3));

220 
	$°r‰oml
 (*
__de°
, 
size_t
 
__size
, c⁄° *
__f‹m©
,

221 
__f
)

222 
__THROW
 
	`__n⁄nuŒ
 ((3));

225 #i‡
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

226 
	$°r‰omf16
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

227 
_Flﬂt16
 
__f
)

228 
__THROW
 
	`__n⁄nuŒ
 ((3));

231 #i‡
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

232 
	$°r‰omf32
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

233 
_Flﬂt32
 
__f
)

234 
__THROW
 
	`__n⁄nuŒ
 ((3));

237 #i‡
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

238 
	$°r‰omf64
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

239 
_Flﬂt64
 
__f
)

240 
__THROW
 
	`__n⁄nuŒ
 ((3));

243 #i‡
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

244 
	$°r‰omf128
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

245 
_Flﬂt128
 
__f
)

246 
__THROW
 
	`__n⁄nuŒ
 ((3));

249 #i‡
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

250 
	$°r‰omf32x
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

251 
_Flﬂt32x
 
__f
)

252 
__THROW
 
	`__n⁄nuŒ
 ((3));

255 #i‡
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

256 
	$°r‰omf64x
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

257 
_Flﬂt64x
 
__f
)

258 
__THROW
 
	`__n⁄nuŒ
 ((3));

261 #i‡
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

262 
	$°r‰omf128x
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

263 
_Flﬂt128x
 
__f
)

264 
__THROW
 
	`__n⁄nuŒ
 ((3));

268 #ifde‡
__USE_GNU


272 
	~<bôs/ty≥s/loˇÀ_t.h
>

274 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

275 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

276 
loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

278 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

279 **
__ª°ri˘
 
__íd±r
,

280 
__ba£
, 
loˇÀ_t
 
__loc
)

281 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

283 
__exãnsi⁄__


284 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

285 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

286 
loˇÀ_t
 
__loc
)

287 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

289 
__exãnsi⁄__


290 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

291 **
__ª°ri˘
 
__íd±r
,

292 
__ba£
, 
loˇÀ_t
 
__loc
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

295 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

296 **
__ª°ri˘
 
__íd±r
, 
loˇÀ_t
 
__loc
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

299 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

300 **
__ª°ri˘
 
__íd±r
, 
loˇÀ_t
 
__loc
)

301 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

303 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

304 **
__ª°ri˘
 
__íd±r
,

305 
loˇÀ_t
 
__loc
)

306 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

308 #i‡
__HAVE_FLOAT16


309 
_Flﬂt16
 
	$°πof16_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

310 **
__ª°ri˘
 
__íd±r
,

311 
loˇÀ_t
 
__loc
)

312 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

315 #i‡
__HAVE_FLOAT32


316 
_Flﬂt32
 
	$°πof32_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

317 **
__ª°ri˘
 
__íd±r
,

318 
loˇÀ_t
 
__loc
)

319 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

322 #i‡
__HAVE_FLOAT64


323 
_Flﬂt64
 
	$°πof64_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

324 **
__ª°ri˘
 
__íd±r
,

325 
loˇÀ_t
 
__loc
)

326 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

329 #i‡
__HAVE_FLOAT128


330 
_Flﬂt128
 
	$°πof128_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

331 **
__ª°ri˘
 
__íd±r
,

332 
loˇÀ_t
 
__loc
)

333 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

336 #i‡
__HAVE_FLOAT32X


337 
_Flﬂt32x
 
	$°πof32x_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

338 **
__ª°ri˘
 
__íd±r
,

339 
loˇÀ_t
 
__loc
)

340 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

343 #i‡
__HAVE_FLOAT64X


344 
_Flﬂt64x
 
	$°πof64x_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

345 **
__ª°ri˘
 
__íd±r
,

346 
loˇÀ_t
 
__loc
)

347 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

350 #i‡
__HAVE_FLOAT128X


351 
_Flﬂt128x
 
	$°πof128x_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

352 **
__ª°ri˘
 
__íd±r
,

353 
loˇÀ_t
 
__loc
)

354 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

359 #ifde‡
__USE_EXTERN_INLINES


360 
__exã∫_ölöe
 

361 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

363  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

364 
	}
}

365 
__exã∫_ölöe
 

366 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

368  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

369 
	}
}

371 #ifde‡
__USE_ISOC99


372 
__exãnsi⁄__
 
__exã∫_ölöe
 

373 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

375  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

376 
	}
}

381 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


385 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

388 
	$a64l
 (c⁄° *
__s
)

389 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

393 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


394 
	~<sys/ty≥s.h
>

401 
	$øndom
 (Ë
__THROW
;

404 
	$§™dom
 (
__£ed
Ë
__THROW
;

410 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

411 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

415 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

418 #ifde‡
__USE_MISC


423 
	søndom_d©a


425 
öt32_t
 *
Âå
;

426 
öt32_t
 *
Ωå
;

427 
öt32_t
 *
°©e
;

428 
ønd_ty≥
;

429 
ønd_deg
;

430 
ønd_£p
;

431 
öt32_t
 *
íd_±r
;

434 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

435 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

437 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

438 
__THROW
 
	`__n⁄nuŒ
 ((2));

440 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

441 
size_t
 
__°©ñí
,

442 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

443 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

445 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

446 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

447 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$ønd
 (Ë
__THROW
;

455 
	$§™d
 (
__£ed
Ë
__THROW
;

457 #ifde‡
__USE_POSIX199506


459 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

463 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


467 
	$dønd48
 (Ë
__THROW
;

468 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

471 
	$Ã™d48
 (Ë
__THROW
;

472 
	$ƒ™d48
 (
__xsubi
[3])

473 
__THROW
 
	`__n⁄nuŒ
 ((1));

476 
	$mønd48
 (Ë
__THROW
;

477 
	$jønd48
 (
__xsubi
[3])

478 
__THROW
 
	`__n⁄nuŒ
 ((1));

481 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

482 *
	$£ed48
 (
__£ed16v
[3])

483 
__THROW
 
	`__n⁄nuŒ
 ((1));

484 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

486 #ifde‡
__USE_MISC


490 
	sdønd48_d©a


492 
__x
[3];

493 
__ﬁd_x
[3];

494 
__c
;

495 
__öô
;

496 
__exãnsi⁄__
 
__a
;

501 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

502 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

503 
	$î™d48_r
 (
__xsubi
[3],

504 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

505 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

508 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

509 *
__ª°ri˘
 
__ªsu…
)

510 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

511 
	$ƒ™d48_r
 (
__xsubi
[3],

512 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

513 *
__ª°ri˘
 
__ªsu…
)

514 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

517 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

518 *
__ª°ri˘
 
__ªsu…
)

519 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

520 
	$jønd48_r
 (
__xsubi
[3],

521 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

522 *
__ª°ri˘
 
__ªsu…
)

523 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

526 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

527 
__THROW
 
	`__n⁄nuŒ
 ((2));

529 
	$£ed48_r
 (
__£ed16v
[3],

530 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

532 
	$lc⁄g48_r
 (
__∑øm
[7],

533 
dønd48_d©a
 *
__buf„r
)

534 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

539 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

541 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

542 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

549 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

550 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

552 #ifde‡
__USE_GNU


558 *
	$ªÆloˇºay
 (*
__±r
, 
size_t
 
__nmemb
, size_à
__size
)

559 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

563 
	$‰ì
 (*
__±r
Ë
__THROW
;

565 #ifde‡
__USE_MISC


566 
	~<Æloˇ.h
>

569 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

570 || 
deföed
 
__USE_MISC


572 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

575 #ifde‡
__USE_XOPEN2K


577 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

578 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

581 #ifde‡
__USE_ISOC11


583 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

584 
__THROW
 
__©åibuã_mÆloc__
 
	`__©åibuã_Æloc_size__
 ((2)Ë
__wur
;

588 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

592 
	$©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

594 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


596 #ifde‡
__˝lu•lus


597 "C++" 
	$©_quick_exô
 ((*
__func
) ())

598 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

600 
	$©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

604 #ifdef 
__USE_MISC


607 
	$⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

608 
__THROW
 
	`__n⁄nuŒ
 ((1));

614 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

616 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


620 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

623 #ifde‡
__USE_ISOC99


626 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

631 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

633 #ifde‡
__USE_GNU


636 *
	$£cuª_gëív
 (c⁄° *
__«me
)

637 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

640 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


644 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

647 #ifde‡
__USE_XOPEN2K


650 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

651 
__THROW
 
	`__n⁄nuŒ
 ((2));

654 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

657 #ifdef 
__USE_MISC


661 
	$˛óªnv
 (Ë
__THROW
;

665 #i‡
deföed
 
__USE_MISC
 \

666 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

672 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

675 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


684 #i‚de‡
__USE_FILE_OFFSET64


685 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

687 #ifde‡
__REDIRECT


688 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

689 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

691 
	#mk°emp
 
mk°emp64


	)

694 #ifde‡
__USE_LARGEFILE64


695 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

699 #ifde‡
__USE_MISC


706 #i‚de‡
__USE_FILE_OFFSET64


707 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

711 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

713 
	#mk°emps
 
mk°emps64


	)

716 #ifde‡
__USE_LARGEFILE64


717 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

718 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

722 #ifde‡
__USE_XOPEN2K8


728 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

731 #ifde‡
__USE_GNU


738 #i‚de‡
__USE_FILE_OFFSET64


739 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

741 #ifde‡
__REDIRECT


742 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

743 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

745 
	#mko°emp
 
mko°emp64


	)

748 #ifde‡
__USE_LARGEFILE64


749 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

758 #i‚de‡
__USE_FILE_OFFSET64


759 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

760 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

762 #ifde‡
__REDIRECT


763 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

764 
__Êags
), 
mko°emps64
)

765 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

767 
	#mko°emps
 
mko°emps64


	)

770 #ifde‡
__USE_LARGEFILE64


771 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

772 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

781 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

784 #ifdef 
__USE_GNU


787 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

788 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

791 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


797 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

798 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

803 #i‚de‡
__COMPAR_FN_T


804 
	#__COMPAR_FN_T


	)

805 (*
	t__com∑r_‚_t
) (const *, const *);

807 #ifdef 
__USE_GNU


808 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

811 #ifde‡
__USE_GNU


812 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

817 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

818 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

819 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

821 #ifde‡
__USE_EXTERN_INLINES


822 
	~<bôs/°dlib-b£¨ch.h
>

827 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

828 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

829 #ifde‡
__USE_GNU


830 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

831 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

832 
	`__n⁄nuŒ
 ((1, 4));

837 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

838 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

840 #ifde‡
__USE_ISOC99


841 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

842 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

849 
div_t
 
	$div
 (
__numî
, 
__díom
)

850 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

851 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

852 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

854 #ifde‡
__USE_ISOC99


855 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

856 
__díom
)

857 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

861 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

862 || 
deföed
 
__USE_MISC


869 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

870 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

875 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

876 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

881 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

882 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

885 #ifde‡
__USE_MISC


887 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

888 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

889 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

890 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

891 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

892 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

893 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

894 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

899 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

900 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

901 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

902 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

903 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

904 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

906 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

907 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

908 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

909 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

910 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

911 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

912 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

913 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

919 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
;

922 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

923 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

926 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
;

930 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

931 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

933 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

934 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

935 
__THROW
;

938 #ifde‡
__USE_MISC


943 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

947 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


954 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

955 *c⁄° *
__ª°ri˘
 
__tokís
,

956 **
__ª°ri˘
 
__vÆuï
)

957 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

963 #ifde‡
__USE_XOPEN2KXSI


965 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

968 #ifde‡
__USE_XOPEN_EXTENDED


973 
	$gø¡±
 (
__fd
Ë
__THROW
;

977 
	$u∆ock±
 (
__fd
Ë
__THROW
;

982 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

985 #ifde‡
__USE_GNU


989 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

990 
__THROW
 
	`__n⁄nuŒ
 ((2));

993 
	`gë±
 ();

996 #ifde‡
__USE_MISC


1000 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

1001 
__THROW
 
	`__n⁄nuŒ
 ((1));

1004 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K


1007 
	$ây¶Ÿ
 (Ë
__THROW
;

1010 
	~<bôs/°dlib-Êﬂt.h
>

1013 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1014 
	~<bôs/°dlib.h
>

1016 #ifde‡
__LDBL_COMPAT


1017 
	~<bôs/°dlib-ldbl.h
>

1020 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<bôs/libc-hódî-°¨t.h
>

28 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

36 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

37 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

43 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

46 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

47 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

52 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


53 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

54 
__c
, 
size_t
 
__n
)

55 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

60 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

63 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

64 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

67 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


70 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

71 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

72 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

75 #ifde‡
__OPTIMIZE__


76 
__exã∫_Æways_ölöe
 *

77 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


79  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

82 
__exã∫_Æways_ölöe
 const *

83 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


85  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

88 
	}
}

90 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

91 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

94 #ifde‡
__USE_GNU


97 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


98 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

99 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

100 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

101 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

103 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

104 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

108 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


109 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

110 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

112 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

121 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

122 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

124 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

125 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

129 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

132 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

133 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

137 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

139 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

140 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

146 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

147 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

148 
__THROW
 
	`__n⁄nuŒ
 ((2));

150 #ifde‡
__USE_XOPEN2K8


152 
	~<bôs/ty≥s/loˇÀ_t.h
>

155 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
loˇÀ_t
 
__l
)

156 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

159 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

160 
loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

163 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8
 \

164 || 
	$__GLIBC_USE
 (
LIB_EXT2
))

166 *
	$°rdup
 (c⁄° *
__s
)

167 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

173 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

174 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

175 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

178 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


180 
	#°rdu∑
(
s
) \

181 (
__exãnsi⁄__
 \

183 c⁄° *
__ﬁd
 = (
s
); \

184 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

185 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

186 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

187 
	}
}))

	)

190 
	#°∫du∑
(
s
, 
n
) \

191 (
__exãnsi⁄__
 \

193 c⁄° *
__ﬁd
 = (
s
); \

194 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

195 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

196 
__√w
[
__Àn
] = '\0'; \

197 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

198 }))

	)

202 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


205 *
°rchr
 (*
__s
, 
__c
)

206 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

207 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

208 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

210 #ifde‡
__OPTIMIZE__


211 
__exã∫_Æways_ölöe
 *

212 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


214  
__buûtö_°rchr
 (
__s
, 
__c
);

217 
__exã∫_Æways_ölöe
 const *

218 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


220  
__buûtö_°rchr
 (
__s
, 
__c
);

225 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

226 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

229 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


232 *
	`°ºchr
 (*
__s
, 
__c
)

233 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

234 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

235 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

237 #ifde‡
__OPTIMIZE__


238 
__exã∫_Æways_ölöe
 *

239 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


241  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

244 
__exã∫_Æways_ölöe
 const *

245 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


247  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

250 
	}
}

252 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

253 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

256 #ifde‡
__USE_GNU


259 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


260 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

261 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

262 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

263 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

265 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

266 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

272 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

273 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

276 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

277 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

279 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


282 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

283 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

284 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

285 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

287 #ifde‡
__OPTIMIZE__


288 
__exã∫_Æways_ölöe
 *

289 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


291  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

294 
__exã∫_Æways_ölöe
 const *

295 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


297  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

300 
	}
}

302 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

303 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

306 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


309 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

310 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

311 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

312 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

314 #ifde‡
__OPTIMIZE__


315 
__exã∫_Æways_ölöe
 *

316 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


318  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

321 
__exã∫_Æways_ölöe
 const *

322 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


324  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

327 
	}
}

329 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

330 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

335 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

336 
__THROW
 
	`__n⁄nuŒ
 ((2));

340 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

341 c⁄° *
__ª°ri˘
 
__dñim
,

342 **
__ª°ri˘
 
__ßve_±r
)

343 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

344 #ifde‡
__USE_POSIX


345 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

346 **
__ª°ri˘
 
__ßve_±r
)

347 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

350 #ifde‡
__USE_GNU


352 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


353 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

354 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

355 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

356 c⁄° *
__√edÀ
)

357 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

359 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

360 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

364 #ifde‡
__USE_GNU


368 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

369 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

370 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

374 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

375 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

376 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

377 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

378 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

379 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

384 
size_t
 
	$°æí
 (c⁄° *
__s
)

385 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

387 #ifdef 
__USE_XOPEN2K8


390 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

391 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

396 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

397 #ifde‡
__USE_XOPEN2K


405 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


408 #ifde‡
__REDIRECT_NTH


409 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

410 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

411 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

413 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

414 
__THROW
 
	`__n⁄nuŒ
 ((2));

415 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

420 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

421 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

425 #ifde‡
__USE_XOPEN2K8


427 *
	$°ªº‹_l
 (
__î∫um
, 
loˇÀ_t
 
__l
Ë
__THROW
;

430 #ifde‡
__USE_MISC


431 
	~<°rögs.h
>

435 
	$ex∂icô_bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

439 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

440 c⁄° *
__ª°ri˘
 
__dñim
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

444 #ifdef 
__USE_XOPEN2K8


446 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

449 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

450 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

451 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

452 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

456 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

457 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

458 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

460 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

461 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

464 #ifdef 
__USE_GNU


466 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

467 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

470 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

473 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

475 #i‚de‡
ba£«me


480 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


481 "C++" *
	$ba£«me
 (*
__fûíame
)

482 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

483 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

484 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

486 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

491 #i‡
	`__GNUC_PREREQ
 (3,4)

492 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


494 
	~<bôs/°rög_f‹tifõd.h
>

498 
__END_DECLS


	@/usr/include/stropts.h

18 #i‚de‡
_STROPTS_H


19 
	#_STROPTS_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<bôs/ty≥s.h
>

23 
	~<bôs/xtôy≥s.h
>

25 #i‚de‡
__gid_t_deföed


26 
__gid_t
 
	tgid_t
;

27 
	#__gid_t_deföed


	)

30 #i‚de‡
__uid_t_deföed


31 
__uid_t
 
	tuid_t
;

32 
	#__uid_t_deföed


	)

35 
__t_sˇœr_t
 
	tt_sˇœr_t
;

36 
__t_usˇœr_t
 
	tt_usˇœr_t
;

39 
	~<bôs/°r›ts.h
>

42 
__BEGIN_DECLS


45 
	$iß°ªam
 (
__fûdes
Ë
__THROW
;

51 
	`gëmsg
 (
__fûdes
, 
°rbuf
 *
__ª°ri˘
 
__˘Õå
,

52 
°rbuf
 *
__ª°ri˘
 
__d©≠å
,

53 *
__ª°ri˘
 
__Êag•
);

60 
	`gëpmsg
 (
__fûdes
, 
°rbuf
 *
__ª°ri˘
 
__˘Õå
,

61 
°rbuf
 *
__ª°ri˘
 
__d©≠å
,

62 *
__ª°ri˘
 
__b™dp
, *__ª°ri˘ 
__Êag•
);

67 
	$io˘l
 (
__fd
, 
__ªque°
, ...Ë
__THROW
;

73 
	`putmsg
 (
__fûdes
, c⁄° 
°rbuf
 *
__˘Õå
,

74 c⁄° 
°rbuf
 *
__d©≠å
, 
__Êags
);

80 
	`puçmsg
 (
__fûdes
, c⁄° 
°rbuf
 *
__˘Õå
,

81 c⁄° 
°rbuf
 *
__d©≠å
, 
__b™d
, 
__Êags
);

85 
	$Áâach
 (
__fûdes
, c⁄° *
__∑th
Ë
__THROW
;

88 
	$fdëach
 (c⁄° *
__∑th
Ë
__THROW
;

90 
__END_DECLS


	@/usr/include/syslog.h

1 
	~<sys/sy¶og.h
>

	@/usr/include/termios.h

22 #i‚def 
_TERMIOS_H


23 
	#_TERMIOS_H
 1

	)

25 
	~<„©uªs.h
>

26 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


28 
	~<bôs/ty≥s.h
>

29 #i‚de‡
__pid_t_deföed


30 
__pid_t
 
	tpid_t
;

31 
	#__pid_t_deföed


	)

35 
	g__BEGIN_DECLS


39 
	~<bôs/ãrmios.h
>

41 #ifde‡
__USE_MISC


44 
	#CCEQ
(
vÆ
, 
c
Ë((cË=(vÆË&& (vÆË!
_POSIX_VDISABLE
)

	)

48 
•ìd_t
 
	$cfgëo•ìd
 (c⁄° 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

51 
•ìd_t
 
	$cfgëi•ìd
 (c⁄° 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

54 
	$cf£to•ìd
 (
ãrmios
 *
__ãrmios_p
, 
•ìd_t
 
__•ìd
Ë
__THROW
;

57 
	$cf£ti•ìd
 (
ãrmios
 *
__ãrmios_p
, 
•ìd_t
 
__•ìd
Ë
__THROW
;

59 #ifdef 
__USE_MISC


61 
	$cf£t•ìd
 (
ãrmios
 *
__ãrmios_p
, 
•ìd_t
 
__•ìd
Ë
__THROW
;

66 
	$tcgë©å
 (
__fd
, 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

70 
	$tc£èâr
 (
__fd
, 
__›ti⁄Æ_a˘i⁄s
,

71 c⁄° 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

74 #ifdef 
__USE_MISC


76 
	$cfmakîaw
 (
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

80 
	$tc£ndbªak
 (
__fd
, 
__duøti⁄
Ë
__THROW
;

86 
	`tcdøö
 (
__fd
);

90 
	$tcÊush
 (
__fd
, 
__queue_£À˘‹
Ë
__THROW
;

94 
	$tcÊow
 (
__fd
, 
__a˘i⁄
Ë
__THROW
;

97 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


99 
__pid_t
 
	$tcgësid
 (
__fd
Ë
__THROW
;

103 #ifde‡
__USE_MISC


104 
	~<sys/âydeÁu…s.h
>

107 
__END_DECLS


	@/usr/include/time.h

22 #i‚def 
_TIME_H


23 
	#_TIME_H
 1

	)

25 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 
	#__√ed_NULL


	)

29 
	~<°ddef.h
>

33 
	~<bôs/time.h
>

37 
	~<bôs/ty≥s/˛ock_t.h
>

38 
	~<bôs/ty≥s/time_t.h
>

39 
	~<bôs/ty≥s/°ru˘_tm.h
>

41 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_ISOC11


42 
	~<bôs/ty≥s/°ru˘_time•ec.h
>

45 #ifde‡
__USE_POSIX199309


46 
	~<bôs/ty≥s/˛ockid_t.h
>

47 
	~<bôs/ty≥s/timî_t.h
>

48 
	~<bôs/ty≥s/°ru˘_ôimî•ec.h
>

49 
	gsigevít
;

52 #ifde‡
__USE_XOPEN2K


53 #i‚de‡
__pid_t_deföed


54 
__pid_t
 
	tpid_t
;

55 
	#__pid_t_deföed


	)

59 #ifde‡
__USE_XOPEN2K8


60 
	~<bôs/ty≥s/loˇÀ_t.h
>

63 #ifde‡
__USE_ISOC11


65 
	#TIME_UTC
 1

	)

68 
__BEGIN_DECLS


72 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

75 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

78 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

79 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

82 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

88 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

89 c⁄° *
__ª°ri˘
 
__f‹m©
,

90 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

92 #ifde‡
__USE_XOPEN


95 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

96 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

97 
__THROW
;

100 #ifde‡
__USE_XOPEN2K8


104 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

105 c⁄° *
__ª°ri˘
 
__f‹m©
,

106 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

107 
loˇÀ_t
 
__loc
Ë
__THROW
;

110 #ifde‡
__USE_GNU


111 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

112 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

113 
loˇÀ_t
 
__loc
Ë
__THROW
;

119 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

123 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

125 #ifde‡
__USE_POSIX


128 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

129 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

133 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

134 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

139 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

142 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

144 #ifde‡
__USE_POSIX


149 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

150 *
__ª°ri˘
 
__buf
Ë
__THROW
;

153 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

154 *
__ª°ri˘
 
__buf
Ë
__THROW
;

159 *
__tz«me
[2];

160 
__daylight
;

161 
__timez⁄e
;

164 #ifdef 
__USE_POSIX


166 *
tz«me
[2];

170 
	$tz£t
 (Ë
__THROW
;

173 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


174 
daylight
;

175 
timez⁄e
;

178 #ifde‡
__USE_MISC


181 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

187 
	#__i¶óp
(
yór
) \

188 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

191 #ifde‡
__USE_MISC


196 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

199 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

202 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

206 #ifde‡
__USE_POSIX199309


211 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

212 
time•ec
 *
__ªmaöög
);

216 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

219 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

222 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

223 
__THROW
;

225 #ifde‡
__USE_XOPEN2K


230 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

231 c⁄° 
time•ec
 *
__ªq
,

232 
time•ec
 *
__ªm
);

235 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

240 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

241 
sigevít
 *
__ª°ri˘
 
__evp
,

242 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

245 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

248 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

249 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

250 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

253 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

254 
__THROW
;

257 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

261 #ifde‡
__USE_ISOC11


263 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

264 
__THROW
 
	`__n⁄nuŒ
 ((1));

268 #ifde‡
__USE_XOPEN_EXTENDED


280 
gëd©e_îr
;

289 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

292 #ifde‡
__USE_GNU


303 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

304 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

307 
__END_DECLS


	@/usr/include/ucontext.h

20 #i‚de‡
_UCONTEXT_H


21 
	#_UCONTEXT_H
 1

	)

23 
	~<„©uªs.h
>

26 
	~<bôs/ödúe˘-ªtu∫.h
>

29 
	~<sys/uc⁄ãxt.h
>

31 
__BEGIN_DECLS


34 
	$gëc⁄ãxt
 (
uc⁄ãxt_t
 *
__u˝
Ë
__THROWNL
;

37 
	$£tc⁄ãxt
 (c⁄° 
uc⁄ãxt_t
 *
__u˝
Ë
__THROWNL
;

41 
	$sw≠c⁄ãxt
 (
uc⁄ãxt_t
 *
__ª°ri˘
 
__ou˝
,

42 c⁄° 
uc⁄ãxt_t
 *
__ª°ri˘
 
__u˝
)

43 
__THROWNL
 
__INDIRECT_RETURN
;

51 
	$makec⁄ãxt
 (
uc⁄ãxt_t
 *
__u˝
, (*
__func
) (),

52 
__¨gc
, ...Ë
__THROW
;

54 
__END_DECLS


	@/usr/include/unistd.h

22 #i‚def 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


32 #ifde‡
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #ñi‡
deföed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #ñi‡
deföed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #ñi‡
deföed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifde‡
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #ñi‡
deföed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #ñi‡
deföed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifde‡
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #ñi‡
deföed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #ñi‡
deföed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<bôs/posix_›t.h
>

205 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


206 
	~<bôs/ívú⁄míts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<bôs/ty≥s.h
>

219 #i‚def 
__ssize_t_deföed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_deföed


	)

224 
	#__√ed_size_t


	)

225 
	#__√ed_NULL


	)

226 
	~<°ddef.h
>

228 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


231 #i‚de‡
__gid_t_deföed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_deföed


	)

236 #i‚de‡
__uid_t_deföed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_deföed


	)

241 #i‚de‡
__off_t_deföed


242 #i‚de‡
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_deföed


	)

249 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_deföed


	)

254 #i‚de‡
__u£c⁄ds_t_deföed


255 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

256 
	#__u£c⁄ds_t_deföed


	)

259 #i‚de‡
__pid_t_deföed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_deföed


	)

265 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


266 #i‚de‡
__öçå_t_deföed


267 
__öçå_t
 
	töçå_t
;

268 
	#__öçå_t_deföed


	)

272 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


273 #i‚de‡
__sockÀn_t_deföed


274 
__sockÀn_t
 
	tsockÀn_t
;

275 
	#__sockÀn_t_deföed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$ac˚ss
 (c⁄° *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

289 #ifde‡
__USE_GNU


292 
	$euidac˚ss
 (c⁄° *
__«me
, 
__ty≥
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

296 
	$óc˚ss
 (c⁄° *
__«me
, 
__ty≥
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1));

300 #ifde‡
__USE_ATFILE


304 
	$Ác˚sßt
 (
__fd
, c⁄° *
__fûe
, 
__ty≥
, 
__Êag
)

305 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

310 #i‚def 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifde‡
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #i‡
deföed
 
__USE_MISC
 && !deföed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #i‚de‡
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

336 #ifde‡
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifde‡
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

346 
__THROW
;

353 
	`˛o£
 (
__fd
);

360 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

366 
ssize_t
 
	$wrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
Ë
__wur
;

368 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


369 #i‚de‡
__USE_FILE_OFFSET64


376 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

377 
__off_t
 
__off£t
Ë
__wur
;

384 
ssize_t
 
	$pwrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
Ë
__wur
;

387 #ifde‡
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

389 
__off64_t
 
__off£t
),

390 
¥ód64
Ë
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, c⁄° *
__buf
,

392 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

393 
pwrôe64
Ë
__wur
;

395 
	#¥ód
 
¥ód64


	)

396 
	#pwrôe
 
pwrôe64


	)

400 #ifde‡
__USE_LARGEFILE64


404 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

405 
__off64_t
 
__off£t
Ë
__wur
;

408 
ssize_t
 
	$pwrôe64
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
Ë
__wur
;

417 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

419 #ifde‡
__USE_GNU


422 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

432 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

444 
	`¶ìp
 (
__£c⁄ds
);

446 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

447 || 
deföed
 
__USE_MISC


452 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

453 
__THROW
;

460 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

469 
	`∑u£
 ();

473 
	$chown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

476 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

483 
	$lchown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

488 #ifde‡
__USE_ATFILE


491 
	$fchow«t
 (
__fd
, c⁄° *
__fûe
, 
__uid_t
 
__ow√r
,

492 
__gid_t
 
__group
, 
__Êag
)

493 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

497 
	$chdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

499 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


501 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

511 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

520 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

521 || 
deföed
 
__USE_MISC


525 *
	$gëwd
 (*
__buf
)

526 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

531 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

536 #ifde‡
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

543 **
__ívú⁄
;

544 #ifde‡
__USE_GNU


545 **
ívú⁄
;

551 
	$execve
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[],

552 *c⁄° 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

554 #ifde‡
__USE_XOPEN2K8


557 
	$„xecve
 (
__fd
, *c⁄° 
__¨gv
[], *c⁄° 
__ívp
[])

558 
__THROW
 
	`__n⁄nuŒ
 ((2));

563 
	$execv
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[])

564 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

568 
	$exe˛e
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

569 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

573 
	$exe˛
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

578 
	$execvp
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[])

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

584 
	$exe˛p
 (c⁄° *
__fûe
, c⁄° *
__¨g
, ...)

585 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

587 #ifde‡
__USE_GNU


590 
	$execv≥
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[],

591 *c⁄° 
__ívp
[])

592 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

596 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


598 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

603 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

609 
	~<bôs/c⁄‚ame.h
>

612 
	$∑thc⁄f
 (c⁄° *
__∑th
, 
__«me
)

613 
__THROW
 
	`__n⁄nuŒ
 ((1));

616 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

619 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

628 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

631 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

634 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

637 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

638 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


639 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

646 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

648 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


660 
	$£çgΩ
 (Ë
__THROW
;

667 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

669 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


671 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

675 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

678 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

681 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

684 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

689 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

702 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


705 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
 
__wur
;

708 #ifde‡
__USE_XOPEN2K


710 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

719 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


722 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
 
__wur
;

725 #ifde‡
__USE_XOPEN2K


727 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

730 #ifde‡
__USE_GNU


733 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

734 
__THROW
;

738 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

739 
__THROW
;

743 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

744 
__THROW
 
__wur
;

748 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$f‹k
 (Ë
__THROWNL
;

758 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

759 || 
deföed
 
__USE_MISC


764 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

770 *
	$ây«me
 (
__fd
Ë
__THROW
;

774 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

775 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

779 
	$ißây
 (
__fd
Ë
__THROW
;

781 #ifde‡
__USE_MISC


784 
	$ây¶Ÿ
 (Ë
__THROW
;

789 
	$lök
 (c⁄° *
__‰om
, c⁄° *
__to
)

790 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

792 #ifde‡
__USE_ATFILE


795 
	$lök©
 (
__‰omfd
, c⁄° *
__‰om
, 
__tofd
,

796 c⁄° *
__to
, 
__Êags
)

797 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

800 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


802 
	$symlök
 (c⁄° *
__‰om
, c⁄° *
__to
)

803 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

808 
ssize_t
 
	$ªadlök
 (c⁄° *
__ª°ri˘
 
__∑th
,

809 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

810 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

813 #ifde‡
__USE_ATFILE


815 
	$symlök©
 (c⁄° *
__‰om
, 
__tofd
,

816 c⁄° *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

819 
ssize_t
 
	$ªadlök©
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

820 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

821 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

825 
	$u∆ök
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

827 #ifde‡
__USE_ATFILE


829 
	$u∆ök©
 (
__fd
, c⁄° *
__«me
, 
__Êag
)

830 
__THROW
 
	`__n⁄nuŒ
 ((2));

834 
	$rmdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

838 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

841 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

848 *
	`gëlogö
 ();

849 #ifde‡
__USE_POSIX199506


856 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

859 #ifdef 
__USE_MISC


861 
	$£éogö
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

865 #ifdef 
__USE_POSIX2


869 
	~<bôs/gë›t_posix.h
>

873 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


877 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

881 #i‡
deföed
 
__USE_MISC


884 
	$£tho°«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

885 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

889 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

895 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

896 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

897 
	$£tdomaö«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

898 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

904 
	$vh™gup
 (Ë
__THROW
;

907 
	$ªvoke
 (c⁄° *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

915 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

916 
size_t
 
__off£t
, 
__sˇÀ
)

917 
__THROW
 
	`__n⁄nuŒ
 ((1));

923 
	$ac˘
 (c⁄° *
__«me
Ë
__THROW
;

927 *
	$gëu£rshñl
 (Ë
__THROW
;

928 
	$ídu£rshñl
 (Ë
__THROW
;

929 
	$£tu£rshñl
 (Ë
__THROW
;

935 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

939 #i‡
deföed
 
__USE_MISC
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

942 
	$chroŸ
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

946 *
	$gë∑ss
 (c⁄° *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

954 
	`fsync
 (
__fd
);

957 #ifde‡
__USE_GNU


960 
	$syncfs
 (
__fd
Ë
__THROW
;

964 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


967 
	`gëho°id
 ();

970 
	$sync
 (Ë
__THROW
;

973 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K


976 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

981 
	$gëdèbÀsize
 (Ë
__THROW
;

987 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


990 #i‚de‡
__USE_FILE_OFFSET64


991 
	$åunˇã
 (c⁄° *
__fûe
, 
__off_t
 
__Àngth
)

992 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

994 #ifde‡
__REDIRECT_NTH


995 
	`__REDIRECT_NTH
 (
åunˇã
,

996 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
),

997 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

999 
	#åunˇã
 
åunˇã64


	)

1002 #ifde‡
__USE_LARGEFILE64


1003 
	$åunˇã64
 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
)

1004 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1009 #i‡
deföed
 
__USE_POSIX199309
 \

1010 || 
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1013 #i‚de‡
__USE_FILE_OFFSET64


1014 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1016 #ifde‡
__REDIRECT_NTH


1017 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1018 
·runˇã64
Ë
__wur
;

1020 
	#·runˇã
 
·runˇã64


	)

1023 #ifde‡
__USE_LARGEFILE64


1024 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1030 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

1031 || 
deföed
 
__USE_MISC


1035 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1041 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1045 #ifde‡
__USE_MISC


1056 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1061 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1073 
	#F_ULOCK
 0

	)

1074 
	#F_LOCK
 1

	)

1075 
	#F_TLOCK
 2

	)

1076 
	#F_TEST
 3

	)

1078 #i‚de‡
__USE_FILE_OFFSET64


1079 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1081 #ifde‡
__REDIRECT


1082 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1083 
lockf64
Ë
__wur
;

1085 
	#lockf
 
lockf64


	)

1088 #ifde‡
__USE_LARGEFILE64


1089 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1094 #ifde‡
__USE_GNU


1099 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1100 (
__exãnsi⁄__
 \

1101 ({ 
__ªsu…
; \

1102 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1103 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1104 
__ªsu…
; 
	}
}))

	)

1107 
ssize_t
 
c›y_fûe_ønge
 (
__öfd
, 
__off64_t
 *
__pöoff
,

1108 
__outfd
, 
__off64_t
 *
__poutoff
,

1109 
size_t
 
__Àngth
, 
__Êags
);

1112 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1115 
fd©async
 (
__fûdes
);

1118 #ifde‡
__USE_MISC


1124 *
	$¸y±
 (c⁄° *
__key
, c⁄° *
__ß…
)

1125 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1128 #ifdef 
__USE_XOPEN


1133 
	$swab
 (c⁄° *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1134 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1141 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K


1143 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1146 *
	`cu£rid
 (*
__s
);

1152 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_XOPEN2K


1153 
	$±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1154 (*
__∑ª¡
) (),

1155 (*
__chûd
Ë()Ë
__THROW
;

1158 #ifde‡
__USE_MISC


1161 
	$gëíå›y
 (*
__buf„r
, 
size_t
 
__Àngth
Ë
__wur
;

1165 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1166 
	~<bôs/uni°d.h
>

1169 
__END_DECLS


	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/openssl/async.h

10 
	~<°dlib.h
>

12 #i‚de‡
HEADER_ASYNC_H


13 
	#HEADER_ASYNC_H


	)

15 #i‡
deföed
(
_WIN32
)

16 #i‡
deföed
(
BASETYPES
Ë|| deföed(
_WINDEF_H
)

18 
	#OSSL_ASYNC_FD
 
HANDLE


	)

19 
	#OSSL_BAD_ASYNC_FD
 
INVALID_HANDLE_VALUE


	)

22 
	#OSSL_ASYNC_FD
 

	)

23 
	#OSSL_BAD_ASYNC_FD
 -1

	)

25 
	~<›ís¶/asyn˚º.h
>

28 #ifde‡ 
__˝lu•lus


32 
async_job_°
 
	tASYNC_JOB
;

33 
async_waô_˘x_°
 
	tASYNC_WAIT_CTX
;

35 
	#ASYNC_ERR
 0

	)

36 
	#ASYNC_NO_JOBS
 1

	)

37 
	#ASYNC_PAUSE
 2

	)

38 
	#ASYNC_FINISH
 3

	)

40 
ASYNC_öô_thªad
(
size_t
 
max_size
, size_à
öô_size
);

41 
ASYNC_˛ónup_thªad
();

43 #ifde‡
OSSL_ASYNC_FD


44 
ASYNC_WAIT_CTX
 *
ASYNC_WAIT_CTX_√w
();

45 
ASYNC_WAIT_CTX_‰ì
(
ASYNC_WAIT_CTX
 *
˘x
);

46 
ASYNC_WAIT_CTX_£t_waô_fd
(
ASYNC_WAIT_CTX
 *
˘x
, c⁄° *
key
,

47 
OSSL_ASYNC_FD
 
fd
,

48 *
cu°om_d©a
,

49 (*
˛ónup
)(
ASYNC_WAIT_CTX
 *, const *,

50 
OSSL_ASYNC_FD
, *));

51 
ASYNC_WAIT_CTX_gë_fd
(
ASYNC_WAIT_CTX
 *
˘x
, c⁄° *
key
,

52 
OSSL_ASYNC_FD
 *
fd
, **
cu°om_d©a
);

53 
ASYNC_WAIT_CTX_gë_Æl_fds
(
ASYNC_WAIT_CTX
 *
˘x
, 
OSSL_ASYNC_FD
 *
fd
,

54 
size_t
 *
numfds
);

55 
ASYNC_WAIT_CTX_gë_ch™ged_fds
(
ASYNC_WAIT_CTX
 *
˘x
, 
OSSL_ASYNC_FD
 *
addfd
,

56 
size_t
 *
numaddfds
, 
OSSL_ASYNC_FD
 *
dñfd
,

57 
size_t
 *
numdñfds
);

58 
ASYNC_WAIT_CTX_˛ór_fd
(
ASYNC_WAIT_CTX
 *
˘x
, c⁄° *
key
);

61 
ASYNC_is_ˇ∑bÀ
();

63 
ASYNC_°¨t_job
(
ASYNC_JOB
 **
job
, 
ASYNC_WAIT_CTX
 *
˘x
, *
ªt
,

64 (*
func
)(*), *
¨gs
, 
size_t
 
size
);

65 
ASYNC_∑u£_job
();

67 
ASYNC_JOB
 *
ASYNC_gë_cuºít_job
();

68 
ASYNC_WAIT_CTX
 *
ASYNC_gë_waô_˘x
(
ASYNC_JOB
 *
job
);

69 
ASYNC_block_∑u£
();

70 
ASYNC_unblock_∑u£
();

73 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/bio.h

10 #i‚de‡
HEADER_BIO_H


11 
	#HEADER_BIO_H


	)

13 
	~<›ís¶/e_os2.h
>

15 #i‚de‡
OPENSSL_NO_STDIO


16 
	~<°dio.h
>

18 
	~<°d¨g.h
>

20 
	~<›ís¶/¸y±o.h
>

21 
	~<›ís¶/bi€º.h
>

23 #ifde‡ 
__˝lu•lus


28 
	#BIO_TYPE_DESCRIPTOR
 0x0100

	)

29 
	#BIO_TYPE_FILTER
 0x0200

	)

30 
	#BIO_TYPE_SOURCE_SINK
 0x0400

	)

33 
	#BIO_TYPE_NONE
 0

	)

34 
	#BIO_TYPE_MEM
 ( 1|
BIO_TYPE_SOURCE_SINK
)

	)

35 
	#BIO_TYPE_FILE
 ( 2|
BIO_TYPE_SOURCE_SINK
)

	)

37 
	#BIO_TYPE_FD
 ( 4|
BIO_TYPE_SOURCE_SINK
|
BIO_TYPE_DESCRIPTOR
)

	)

38 
	#BIO_TYPE_SOCKET
 ( 5|
BIO_TYPE_SOURCE_SINK
|
BIO_TYPE_DESCRIPTOR
)

	)

39 
	#BIO_TYPE_NULL
 ( 6|
BIO_TYPE_SOURCE_SINK
)

	)

40 
	#BIO_TYPE_SSL
 ( 7|
BIO_TYPE_FILTER
)

	)

41 
	#BIO_TYPE_MD
 ( 8|
BIO_TYPE_FILTER
)

	)

42 
	#BIO_TYPE_BUFFER
 ( 9|
BIO_TYPE_FILTER
)

	)

43 
	#BIO_TYPE_CIPHER
 (10|
BIO_TYPE_FILTER
)

	)

44 
	#BIO_TYPE_BASE64
 (11|
BIO_TYPE_FILTER
)

	)

45 
	#BIO_TYPE_CONNECT
 (12|
BIO_TYPE_SOURCE_SINK
|
BIO_TYPE_DESCRIPTOR
)

	)

46 
	#BIO_TYPE_ACCEPT
 (13|
BIO_TYPE_SOURCE_SINK
|
BIO_TYPE_DESCRIPTOR
)

	)

48 
	#BIO_TYPE_NBIO_TEST
 (16|
BIO_TYPE_FILTER
)

	)

49 
	#BIO_TYPE_NULL_FILTER
 (17|
BIO_TYPE_FILTER
)

	)

50 
	#BIO_TYPE_BIO
 (19|
BIO_TYPE_SOURCE_SINK
)

	)

51 
	#BIO_TYPE_LINEBUFFER
 (20|
BIO_TYPE_FILTER
)

	)

52 
	#BIO_TYPE_DGRAM
 (21|
BIO_TYPE_SOURCE_SINK
|
BIO_TYPE_DESCRIPTOR
)

	)

53 
	#BIO_TYPE_ASN1
 (22|
BIO_TYPE_FILTER
)

	)

54 
	#BIO_TYPE_COMP
 (23|
BIO_TYPE_FILTER
)

	)

55 #i‚de‡
OPENSSL_NO_SCTP


56 
	#BIO_TYPE_DGRAM_SCTP
 (24|
BIO_TYPE_SOURCE_SINK
|
BIO_TYPE_DESCRIPTOR
)

	)

59 
	#BIO_TYPE_START
 128

	)

65 
	#BIO_NOCLOSE
 0x00

	)

66 
	#BIO_CLOSE
 0x01

	)

71 
	#BIO_CTRL_RESET
 1

	)

72 
	#BIO_CTRL_EOF
 2

	)

73 
	#BIO_CTRL_INFO
 3

	)

74 
	#BIO_CTRL_SET
 4

	)

75 
	#BIO_CTRL_GET
 5

	)

76 
	#BIO_CTRL_PUSH
 6

	)

77 
	#BIO_CTRL_POP
 7

	)

78 
	#BIO_CTRL_GET_CLOSE
 8

	)

79 
	#BIO_CTRL_SET_CLOSE
 9

	)

80 
	#BIO_CTRL_PENDING
 10

	)

81 
	#BIO_CTRL_FLUSH
 11

	)

82 
	#BIO_CTRL_DUP
 12

	)

83 
	#BIO_CTRL_WPENDING
 13

	)

84 
	#BIO_CTRL_SET_CALLBACK
 14

	)

85 
	#BIO_CTRL_GET_CALLBACK
 15

	)

87 
	#BIO_CTRL_PEEK
 29

	)

88 
	#BIO_CTRL_SET_FILENAME
 30

	)

91 
	#BIO_CTRL_DGRAM_CONNECT
 31

	)

92 
	#BIO_CTRL_DGRAM_SET_CONNECTED
 32

	)

94 
	#BIO_CTRL_DGRAM_SET_RECV_TIMEOUT
 33

	)

95 
	#BIO_CTRL_DGRAM_GET_RECV_TIMEOUT
 34

	)

96 
	#BIO_CTRL_DGRAM_SET_SEND_TIMEOUT
 35

	)

97 
	#BIO_CTRL_DGRAM_GET_SEND_TIMEOUT
 36

	)

99 
	#BIO_CTRL_DGRAM_GET_RECV_TIMER_EXP
 37

	)

100 
	#BIO_CTRL_DGRAM_GET_SEND_TIMER_EXP
 38

	)

103 
	#BIO_CTRL_DGRAM_MTU_DISCOVER
 39

	)

106 
	#BIO_CTRL_DGRAM_QUERY_MTU
 40

	)

107 
	#BIO_CTRL_DGRAM_GET_FALLBACK_MTU
 47

	)

108 
	#BIO_CTRL_DGRAM_GET_MTU
 41

	)

109 
	#BIO_CTRL_DGRAM_SET_MTU
 42

	)

113 
	#BIO_CTRL_DGRAM_MTU_EXCEEDED
 43

	)

117 
	#BIO_CTRL_DGRAM_GET_PEER
 46

	)

118 
	#BIO_CTRL_DGRAM_SET_PEER
 44

	)

120 
	#BIO_CTRL_DGRAM_SET_NEXT_TIMEOUT
 45

	)

122 
	#BIO_CTRL_DGRAM_SET_DONT_FRAG
 48

	)

124 
	#BIO_CTRL_DGRAM_GET_MTU_OVERHEAD
 49

	)

127 
	#BIO_CTRL_DGRAM_SCTP_SET_IN_HANDSHAKE
 50

	)

128 #i‚de‡
OPENSSL_NO_SCTP


130 
	#BIO_CTRL_DGRAM_SCTP_ADD_AUTH_KEY
 51

	)

131 
	#BIO_CTRL_DGRAM_SCTP_NEXT_AUTH_KEY
 52

	)

132 
	#BIO_CTRL_DGRAM_SCTP_AUTH_CCS_RCVD
 53

	)

133 
	#BIO_CTRL_DGRAM_SCTP_GET_SNDINFO
 60

	)

134 
	#BIO_CTRL_DGRAM_SCTP_SET_SNDINFO
 61

	)

135 
	#BIO_CTRL_DGRAM_SCTP_GET_RCVINFO
 62

	)

136 
	#BIO_CTRL_DGRAM_SCTP_SET_RCVINFO
 63

	)

137 
	#BIO_CTRL_DGRAM_SCTP_GET_PRINFO
 64

	)

138 
	#BIO_CTRL_DGRAM_SCTP_SET_PRINFO
 65

	)

139 
	#BIO_CTRL_DGRAM_SCTP_SAVE_SHUTDOWN
 70

	)

142 
	#BIO_CTRL_DGRAM_SET_PEEK_MODE
 71

	)

145 
	#BIO_FP_READ
 0x02

	)

146 
	#BIO_FP_WRITE
 0x04

	)

147 
	#BIO_FP_APPEND
 0x08

	)

148 
	#BIO_FP_TEXT
 0x10

	)

150 
	#BIO_FLAGS_READ
 0x01

	)

151 
	#BIO_FLAGS_WRITE
 0x02

	)

152 
	#BIO_FLAGS_IO_SPECIAL
 0x04

	)

153 
	#BIO_FLAGS_RWS
 (
BIO_FLAGS_READ
|
BIO_FLAGS_WRITE
|
BIO_FLAGS_IO_SPECIAL
)

	)

154 
	#BIO_FLAGS_SHOULD_RETRY
 0x08

	)

155 #i‚de‡
BIO_FLAGS_UPLINK


160 
	#BIO_FLAGS_UPLINK
 0

	)

163 
	#BIO_FLAGS_BASE64_NO_NL
 0x100

	)

170 
	#BIO_FLAGS_MEM_RDONLY
 0x200

	)

171 
	#BIO_FLAGS_NONCLEAR_RST
 0x400

	)

173 
bio_addr_°
 
	tBIO_ADDR
;

174 
bio_addröfo_°
 
	tBIO_ADDRINFO
;

176 
BIO_gë_√w_ödex
();

177 
BIO_£t_Êags
(
BIO
 *
b
, 
Êags
);

178 
BIO_ã°_Êags
(c⁄° 
BIO
 *
b
, 
Êags
);

179 
BIO_˛ór_Êags
(
BIO
 *
b
, 
Êags
);

181 
	#BIO_gë_Êags
(
b
Ë
	`BIO_ã°_Êags
(b, ~(0x0))

	)

182 
	#BIO_£t_ªåy_•ecül
(
b
) \

183 
	`BIO_£t_Êags
(
b
, (
BIO_FLAGS_IO_SPECIAL
|
BIO_FLAGS_SHOULD_RETRY
))

	)

184 
	#BIO_£t_ªåy_ªad
(
b
) \

185 
	`BIO_£t_Êags
(
b
, (
BIO_FLAGS_READ
|
BIO_FLAGS_SHOULD_RETRY
))

	)

186 
	#BIO_£t_ªåy_wrôe
(
b
) \

187 
	`BIO_£t_Êags
(
b
, (
BIO_FLAGS_WRITE
|
BIO_FLAGS_SHOULD_RETRY
))

	)

190 
	#BIO_˛ór_ªåy_Êags
(
b
) \

191 
	`BIO_˛ór_Êags
(
b
, (
BIO_FLAGS_RWS
|
BIO_FLAGS_SHOULD_RETRY
))

	)

192 
	#BIO_gë_ªåy_Êags
(
b
) \

193 
	`BIO_ã°_Êags
(
b
, (
BIO_FLAGS_RWS
|
BIO_FLAGS_SHOULD_RETRY
))

	)

196 
	#BIO_should_ªad
(
a
Ë
	`BIO_ã°_Êags
◊, 
BIO_FLAGS_READ
)

	)

197 
	#BIO_should_wrôe
(
a
Ë
	`BIO_ã°_Êags
◊, 
BIO_FLAGS_WRITE
)

	)

198 
	#BIO_should_io_•ecül
(
a
Ë
	`BIO_ã°_Êags
◊, 
BIO_FLAGS_IO_SPECIAL
)

	)

199 
	#BIO_ªåy_ty≥
(
a
Ë
	`BIO_ã°_Êags
◊, 
BIO_FLAGS_RWS
)

	)

200 
	#BIO_should_ªåy
(
a
Ë
	`BIO_ã°_Êags
◊, 
BIO_FLAGS_SHOULD_RETRY
)

	)

212 
	#BIO_RR_SSL_X509_LOOKUP
 0x01

	)

214 
	#BIO_RR_CONNECT
 0x02

	)

216 
	#BIO_RR_ACCEPT
 0x03

	)

219 
	#BIO_CB_FREE
 0x01

	)

220 
	#BIO_CB_READ
 0x02

	)

221 
	#BIO_CB_WRITE
 0x03

	)

222 
	#BIO_CB_PUTS
 0x04

	)

223 
	#BIO_CB_GETS
 0x05

	)

224 
	#BIO_CB_CTRL
 0x06

	)

230 
	#BIO_CB_RETURN
 0x80

	)

231 
	#BIO_CB_ªtu∫
(
a
Ë(◊)|
BIO_CB_RETURN
)

	)

232 
	#BIO_cb_¥e
(
a
Ë(!(◊)&
BIO_CB_RETURN
))

	)

233 
	#BIO_cb_po°
(
a
Ë(◊)&
BIO_CB_RETURN
)

	)

235 (*
BIO_ˇŒback_‚
)(
	tBIO
 *
	tb
, 
	t›î
, c⁄° *
	t¨gp
, 
	t¨gi
,

236 
	t¨gl
, 
	tªt
);

237 (*
BIO_ˇŒback_‚_ex
)(
	tBIO
 *
	tb
, 
	t›î
, c⁄° *
	t¨gp
,

238 
	tsize_t
 
	tÀn
, 
	t¨gi
,

239 
	t¨gl
, 
	tªt
, 
	tsize_t
 *
	t¥o˚s£d
);

240 
BIO_ˇŒback_‚
 
BIO_gë_ˇŒback
(c⁄° 
BIO
 *
b
);

241 
BIO_£t_ˇŒback
(
BIO
 *
b
, 
BIO_ˇŒback_‚
 
ˇŒback
);

243 
BIO_ˇŒback_‚_ex
 
BIO_gë_ˇŒback_ex
(c⁄° 
BIO
 *
b
);

244 
BIO_£t_ˇŒback_ex
(
BIO
 *
b
, 
BIO_ˇŒback_‚_ex
 
ˇŒback
);

246 *
BIO_gë_ˇŒback_¨g
(c⁄° 
BIO
 *
b
);

247 
BIO_£t_ˇŒback_¨g
(
BIO
 *
b
, *
¨g
);

249 
bio_mëhod_°
 
	tBIO_METHOD
;

251 c⁄° *
BIO_mëhod_«me
(c⁄° 
BIO
 *
b
);

252 
BIO_mëhod_ty≥
(c⁄° 
BIO
 *
b
);

254 
	tBIO_öfo_cb
(
	tBIO
 *, , );

255 
BIO_öfo_cb
 
	tbio_öfo_cb
;

257 
DEFINE_STACK_OF
(
BIO
)

260 
	ta¢1_ps_func
 (
	tBIO
 *
	tb
, **
	tpbuf
, *
	t∂í
,

261 *
	t∑rg
);

263 #i‚de‡
OPENSSL_NO_SCTP


265 
	sbio_dgøm_s˘p_¢döfo
 {

266 
uöt16_t
 
¢d_sid
;

267 
uöt16_t
 
¢d_Êags
;

268 
uöt32_t
 
¢d_µid
;

269 
uöt32_t
 
¢d_c⁄ãxt
;

272 
	sbio_dgøm_s˘p_rcvöfo
 {

273 
uöt16_t
 
rcv_sid
;

274 
uöt16_t
 
rcv_s¢
;

275 
uöt16_t
 
rcv_Êags
;

276 
uöt32_t
 
rcv_µid
;

277 
uöt32_t
 
rcv_t¢
;

278 
uöt32_t
 
rcv_cumt¢
;

279 
uöt32_t
 
rcv_c⁄ãxt
;

282 
	sbio_dgøm_s˘p_¥öfo
 {

283 
uöt16_t
 
¥_pﬁicy
;

284 
uöt32_t
 
¥_vÆue
;

292 
	#BIO_C_SET_CONNECT
 100

	)

293 
	#BIO_C_DO_STATE_MACHINE
 101

	)

294 
	#BIO_C_SET_NBIO
 102

	)

296 
	#BIO_C_SET_FD
 104

	)

297 
	#BIO_C_GET_FD
 105

	)

298 
	#BIO_C_SET_FILE_PTR
 106

	)

299 
	#BIO_C_GET_FILE_PTR
 107

	)

300 
	#BIO_C_SET_FILENAME
 108

	)

301 
	#BIO_C_SET_SSL
 109

	)

302 
	#BIO_C_GET_SSL
 110

	)

303 
	#BIO_C_SET_MD
 111

	)

304 
	#BIO_C_GET_MD
 112

	)

305 
	#BIO_C_GET_CIPHER_STATUS
 113

	)

306 
	#BIO_C_SET_BUF_MEM
 114

	)

307 
	#BIO_C_GET_BUF_MEM_PTR
 115

	)

308 
	#BIO_C_GET_BUFF_NUM_LINES
 116

	)

309 
	#BIO_C_SET_BUFF_SIZE
 117

	)

310 
	#BIO_C_SET_ACCEPT
 118

	)

311 
	#BIO_C_SSL_MODE
 119

	)

312 
	#BIO_C_GET_MD_CTX
 120

	)

314 
	#BIO_C_SET_BUFF_READ_DATA
 122

	)

315 
	#BIO_C_GET_CONNECT
 123

	)

316 
	#BIO_C_GET_ACCEPT
 124

	)

317 
	#BIO_C_SET_SSL_RENEGOTIATE_BYTES
 125

	)

318 
	#BIO_C_GET_SSL_NUM_RENEGOTIATES
 126

	)

319 
	#BIO_C_SET_SSL_RENEGOTIATE_TIMEOUT
 127

	)

320 
	#BIO_C_FILE_SEEK
 128

	)

321 
	#BIO_C_GET_CIPHER_CTX
 129

	)

322 
	#BIO_C_SET_BUF_MEM_EOF_RETURN
 130

	)

324 
	#BIO_C_SET_BIND_MODE
 131

	)

325 
	#BIO_C_GET_BIND_MODE
 132

	)

326 
	#BIO_C_FILE_TELL
 133

	)

327 
	#BIO_C_GET_SOCKS
 134

	)

328 
	#BIO_C_SET_SOCKS
 135

	)

330 
	#BIO_C_SET_WRITE_BUF_SIZE
 136

	)

331 
	#BIO_C_GET_WRITE_BUF_SIZE
 137

	)

332 
	#BIO_C_MAKE_BIO_PAIR
 138

	)

333 
	#BIO_C_DESTROY_BIO_PAIR
 139

	)

334 
	#BIO_C_GET_WRITE_GUARANTEE
 140

	)

335 
	#BIO_C_GET_READ_REQUEST
 141

	)

336 
	#BIO_C_SHUTDOWN_WR
 142

	)

337 
	#BIO_C_NREAD0
 143

	)

338 
	#BIO_C_NREAD
 144

	)

339 
	#BIO_C_NWRITE0
 145

	)

340 
	#BIO_C_NWRITE
 146

	)

341 
	#BIO_C_RESET_READ_REQUEST
 147

	)

342 
	#BIO_C_SET_MD_CTX
 148

	)

344 
	#BIO_C_SET_PREFIX
 149

	)

345 
	#BIO_C_GET_PREFIX
 150

	)

346 
	#BIO_C_SET_SUFFIX
 151

	)

347 
	#BIO_C_GET_SUFFIX
 152

	)

349 
	#BIO_C_SET_EX_ARG
 153

	)

350 
	#BIO_C_GET_EX_ARG
 154

	)

352 
	#BIO_C_SET_CONNECT_MODE
 155

	)

354 
	#BIO_£t_≠p_d©a
(
s
,
¨g
Ë
	`BIO_£t_ex_d©a
(s,0,¨g)

	)

355 
	#BIO_gë_≠p_d©a
(
s
Ë
	`BIO_gë_ex_d©a
(s,0)

	)

357 
	#BIO_£t_nbio
(
b
,
n
Ë
	`BIO_˘æ
(b,
BIO_C_SET_NBIO
,“),
NULL
)

	)

359 #i‚de‡
OPENSSL_NO_SOCK


362 
	#BIO_FAMILY_IPV4
 4

	)

363 
	#BIO_FAMILY_IPV6
 6

	)

364 
	#BIO_FAMILY_IPANY
 256

	)

367 
	#BIO_£t_c⁄n_ho°«me
(
b
,
«me
Ë
	`BIO_˘æ
(b,
BIO_C_SET_CONNECT
,0, \

368 (*)(
«me
))

	)

369 
	#BIO_£t_c⁄n_p‹t
(
b
,
p‹t
Ë
	`BIO_˘æ
(b,
BIO_C_SET_CONNECT
,1, \

370 (*)(
p‹t
))

	)

371 
	#BIO_£t_c⁄n_addªss
(
b
,
addr
Ë
	`BIO_˘æ
(b,
BIO_C_SET_CONNECT
,2, \

372 (*)(
addr
))

	)

373 
	#BIO_£t_c⁄n_ù_Ámûy
(
b
,
f
Ë
	`BIO_öt_˘æ
(b,
BIO_C_SET_CONNECT
,3,f)

	)

374 
	#BIO_gë_c⁄n_ho°«me
(
b
Ë((c⁄° *)
	`BIO_±r_˘æ
(b,
BIO_C_GET_CONNECT
,0))

	)

375 
	#BIO_gë_c⁄n_p‹t
(
b
Ë((c⁄° *)
	`BIO_±r_˘æ
(b,
BIO_C_GET_CONNECT
,1))

	)

376 
	#BIO_gë_c⁄n_addªss
(
b
Ë((c⁄° 
BIO_ADDR
 *)
	`BIO_±r_˘æ
(b,
BIO_C_GET_CONNECT
,2))

	)

377 
	#BIO_gë_c⁄n_ù_Ámûy
(
b
Ë
	`BIO_˘æ
(b,
BIO_C_GET_CONNECT
,3,
NULL
)

	)

378 
	#BIO_£t_c⁄n_mode
(
b
,
n
Ë
	`BIO_˘æ
(b,
BIO_C_SET_CONNECT_MODE
,“),
NULL
)

	)

381 
	#BIO_£t_ac˚±_«me
(
b
,
«me
Ë
	`BIO_˘æ
(b,
BIO_C_SET_ACCEPT
,0, \

382 (*)(
«me
))

	)

383 
	#BIO_£t_ac˚±_p‹t
(
b
,
p‹t
Ë
	`BIO_˘æ
(b,
BIO_C_SET_ACCEPT
,1, \

384 (*)(
p‹t
))

	)

385 
	#BIO_gë_ac˚±_«me
(
b
Ë((c⁄° *)
	`BIO_±r_˘æ
(b,
BIO_C_GET_ACCEPT
,0))

	)

386 
	#BIO_gë_ac˚±_p‹t
(
b
Ë((c⁄° *)
	`BIO_±r_˘æ
(b,
BIO_C_GET_ACCEPT
,1))

	)

387 
	#BIO_gë_≥î_«me
(
b
Ë((c⁄° *)
	`BIO_±r_˘æ
(b,
BIO_C_GET_ACCEPT
,2))

	)

388 
	#BIO_gë_≥î_p‹t
(
b
Ë((c⁄° *)
	`BIO_±r_˘æ
(b,
BIO_C_GET_ACCEPT
,3))

	)

390 
	#BIO_£t_nbio_ac˚±
(
b
,
n
Ë
	`BIO_˘æ
(b,
BIO_C_SET_ACCEPT
,2,“)?(*)"a":
NULL
)

	)

391 
	#BIO_£t_ac˚±_bios
(
b
,
bio
Ë
	`BIO_˘æ
(b,
BIO_C_SET_ACCEPT
,3, \

392 (*)(
bio
))

	)

393 
	#BIO_£t_ac˚±_ù_Ámûy
(
b
,
f
Ë
	`BIO_öt_˘æ
(b,
BIO_C_SET_ACCEPT
,4,f)

	)

394 
	#BIO_gë_ac˚±_ù_Ámûy
(
b
Ë
	`BIO_˘æ
(b,
BIO_C_GET_ACCEPT
,4,
NULL
)

	)

397 
	#BIO_BIND_NORMAL
 0

	)

398 
	#BIO_BIND_REUSEADDR
 
BIO_SOCK_REUSEADDR


	)

399 
	#BIO_BIND_REUSEADDR_IF_UNUSED
 
BIO_SOCK_REUSEADDR


	)

400 
	#BIO_£t_böd_mode
(
b
,
mode
Ë
	`BIO_˘æ
(b,
BIO_C_SET_BIND_MODE
,mode,
NULL
)

	)

401 
	#BIO_gë_böd_mode
(
b
Ë
	`BIO_˘æ
(b,
BIO_C_GET_BIND_MODE
,0,
NULL
)

	)

404 
	#BIO_do_c⁄√˘
(
b
Ë
	`BIO_do_h™dshake
(b)

	)

405 
	#BIO_do_ac˚±
(
b
Ë
	`BIO_do_h™dshake
(b)

	)

408 
	#BIO_do_h™dshake
(
b
Ë
	`BIO_˘æ
(b,
BIO_C_DO_STATE_MACHINE
,0,
NULL
)

	)

411 
	#BIO_£t_fd
(
b
,
fd
,
c
Ë
	`BIO_öt_˘æ
(b,
BIO_C_SET_FD
,c,fd)

	)

412 
	#BIO_gë_fd
(
b
,
c
Ë
	`BIO_˘æ
(b,
BIO_C_GET_FD
,0,(*)(c))

	)

415 
	#BIO_£t_Â
(
b
,
Â
,
c
Ë
	`BIO_˘æ
(b,
BIO_C_SET_FILE_PTR
,c,(*)(Â))

	)

416 
	#BIO_gë_Â
(
b
,
Âp
Ë
	`BIO_˘æ
(b,
BIO_C_GET_FILE_PTR
,0,(*)(Âp))

	)

419 
	#BIO_£ek
(
b
,
ofs
Ë()
	`BIO_˘æ
(b,
BIO_C_FILE_SEEK
,ofs,
NULL
)

	)

420 
	#BIO_ãŒ
(
b
Ë()
	`BIO_˘æ
(b,
BIO_C_FILE_TELL
,0,
NULL
)

	)

426 #ifde‡
CONST_STRICT


431 
BIO_ªad_fûíame
(
BIO
 *
b
, c⁄° *
«me
);

433 
	#BIO_ªad_fûíame
(
b
,
«me
Ë()
	`BIO_˘æ
(b,
BIO_C_SET_FILENAME
, \

434 
BIO_CLOSE
|
BIO_FP_READ
,(*)(
«me
))

	)

436 
	#BIO_wrôe_fûíame
(
b
,
«me
Ë()
	`BIO_˘æ
(b,
BIO_C_SET_FILENAME
, \

437 
BIO_CLOSE
|
BIO_FP_WRITE
,
«me
)

	)

438 
	#BIO_≠≥nd_fûíame
(
b
,
«me
Ë()
	`BIO_˘æ
(b,
BIO_C_SET_FILENAME
, \

439 
BIO_CLOSE
|
BIO_FP_APPEND
,
«me
)

	)

440 
	#BIO_rw_fûíame
(
b
,
«me
Ë()
	`BIO_˘æ
(b,
BIO_C_SET_FILENAME
, \

441 
BIO_CLOSE
|
BIO_FP_READ
|
BIO_FP_WRITE
,
«me
)

	)

449 
	#BIO_£t_s¶
(
b
,
s¶
,
c
Ë
	`BIO_˘æ
(b,
BIO_C_SET_SSL
,c,(*)(s¶))

	)

450 
	#BIO_gë_s¶
(
b
,
s¶p
Ë
	`BIO_˘æ
(b,
BIO_C_GET_SSL
,0,(*)(s¶p))

	)

451 
	#BIO_£t_s¶_mode
(
b
,
˛õ¡
Ë
	`BIO_˘æ
(b,
BIO_C_SSL_MODE
,˛õ¡,
NULL
)

	)

452 
	#BIO_£t_s¶_ª√gŸüã_byãs
(
b
,
num
) \

453 
	`BIO_˘æ
(
b
,
BIO_C_SET_SSL_RENEGOTIATE_BYTES
,
num
,
NULL
)

	)

454 
	#BIO_gë_num_ª√gŸüãs
(
b
) \

455 
	`BIO_˘æ
(
b
,
BIO_C_GET_SSL_NUM_RENEGOTIATES
,0,
NULL
)

	)

456 
	#BIO_£t_s¶_ª√gŸüã_timeout
(
b
,
£c⁄ds
) \

457 
	`BIO_˘æ
(
b
,
BIO_C_SET_SSL_RENEGOTIATE_TIMEOUT
,
£c⁄ds
,
NULL
)

	)

462 
	#BIO_gë_mem_d©a
(
b
,
µ
Ë
	`BIO_˘æ
(b,
BIO_CTRL_INFO
,0,(*)’p))

	)

463 
	#BIO_£t_mem_buf
(
b
,
bm
,
c
Ë
	`BIO_˘æ
(b,
BIO_C_SET_BUF_MEM
,c,(*)(bm))

	)

464 
	#BIO_gë_mem_±r
(
b
,
µ
Ë
	`BIO_˘æ
(b,
BIO_C_GET_BUF_MEM_PTR
,0, \

465 (*)(
µ
))

	)

466 
	#BIO_£t_mem_eof_ªtu∫
(
b
,
v
) \

467 
	`BIO_˘æ
(
b
,
BIO_C_SET_BUF_MEM_EOF_RETURN
,
v
,
NULL
)

	)

470 
	#BIO_gë_buf„r_num_löes
(
b
Ë
	`BIO_˘æ
(b,
BIO_C_GET_BUFF_NUM_LINES
,0,
NULL
)

	)

471 
	#BIO_£t_buf„r_size
(
b
,
size
Ë
	`BIO_˘æ
(b,
BIO_C_SET_BUFF_SIZE
,size,
NULL
)

	)

472 
	#BIO_£t_ªad_buf„r_size
(
b
,
size
Ë
	`BIO_öt_˘æ
(b,
BIO_C_SET_BUFF_SIZE
,size,0)

	)

473 
	#BIO_£t_wrôe_buf„r_size
(
b
,
size
Ë
	`BIO_öt_˘æ
(b,
BIO_C_SET_BUFF_SIZE
,size,1)

	)

474 
	#BIO_£t_buf„r_ªad_d©a
(
b
,
buf
,
num
Ë
	`BIO_˘æ
(b,
BIO_C_SET_BUFF_READ_DATA
,num,buf)

	)

477 
	#BIO_dup_°©e
(
b
,
ªt
Ë
	`BIO_˘æ
(b,
BIO_CTRL_DUP
,0,(*)‘ë))

	)

479 
	#BIO_ª£t
(
b
Ë()
	`BIO_˘æ
(b,
BIO_CTRL_RESET
,0,
NULL
)

	)

480 
	#BIO_eof
(
b
Ë()
	`BIO_˘æ
(b,
BIO_CTRL_EOF
,0,
NULL
)

	)

481 
	#BIO_£t_˛o£
(
b
,
c
Ë()
	`BIO_˘æ
(b,
BIO_CTRL_SET_CLOSE
,(c),
NULL
)

	)

482 
	#BIO_gë_˛o£
(
b
Ë()
	`BIO_˘æ
(b,
BIO_CTRL_GET_CLOSE
,0,
NULL
)

	)

483 
	#BIO_≥ndög
(
b
Ë()
	`BIO_˘æ
(b,
BIO_CTRL_PENDING
,0,
NULL
)

	)

484 
	#BIO_w≥ndög
(
b
Ë()
	`BIO_˘æ
(b,
BIO_CTRL_WPENDING
,0,
NULL
)

	)

486 
size_t
 
BIO_˘æ_≥ndög
(
BIO
 *
b
);

487 
size_t
 
BIO_˘æ_w≥ndög
(
BIO
 *
b
);

488 
	#BIO_Êush
(
b
Ë()
	`BIO_˘æ
(b,
BIO_CTRL_FLUSH
,0,
NULL
)

	)

489 
	#BIO_gë_öfo_ˇŒback
(
b
,
cbp
Ë()
	`BIO_˘æ
(b,
BIO_CTRL_GET_CALLBACK
,0, \

490 
cbp
)

	)

491 
	#BIO_£t_öfo_ˇŒback
(
b
,
cb
Ë()
	`BIO_ˇŒback_˘æ
(b,
BIO_CTRL_SET_CALLBACK
,cb)

	)

494 
	#BIO_buf„r_gë_num_löes
(
b
Ë
	`BIO_˘æ
(b,
BIO_CTRL_GET
,0,
NULL
)

	)

495 
	#BIO_buf„r_≥ek
(
b
,
s
,
l
Ë
	`BIO_˘æ
(b,
BIO_CTRL_PEEK
,÷),(s))

	)

498 
	#BIO_£t_wrôe_buf_size
(
b
,
size
Ë()
	`BIO_˘æ
(b,
BIO_C_SET_WRITE_BUF_SIZE
,size,
NULL
)

	)

499 
	#BIO_gë_wrôe_buf_size
(
b
,
size
Ë(
size_t
)
	`BIO_˘æ
(b,
BIO_C_GET_WRITE_BUF_SIZE
,size,
NULL
)

	)

500 
	#BIO_make_bio_∑ú
(
b1
,
b2
Ë()
	`BIO_˘æ
(b1,
BIO_C_MAKE_BIO_PAIR
,0,b2)

	)

501 
	#BIO_de°roy_bio_∑ú
(
b
Ë()
	`BIO_˘æ
(b,
BIO_C_DESTROY_BIO_PAIR
,0,
NULL
)

	)

502 
	#BIO_shutdown_wr
(
b
Ë()
	`BIO_˘æ
(b, 
BIO_C_SHUTDOWN_WR
, 0, 
NULL
)

	)

504 
	#BIO_gë_wrôe_gu¨™ãe
(
b
Ë()
	`BIO_˘æ
(b,
BIO_C_GET_WRITE_GUARANTEE
,0,
NULL
)

	)

505 
	#BIO_gë_ªad_ªque°
(
b
Ë()
	`BIO_˘æ
(b,
BIO_C_GET_READ_REQUEST
,0,
NULL
)

	)

506 
size_t
 
BIO_˘æ_gë_wrôe_gu¨™ãe
(
BIO
 *
b
);

507 
size_t
 
BIO_˘æ_gë_ªad_ªque°
(
BIO
 *
b
);

508 
BIO_˘æ_ª£t_ªad_ªque°
(
BIO
 *
b
);

511 
	#BIO_˘æ_dgøm_c⁄√˘
(
b
,
≥î
) \

512 ()
	`BIO_˘æ
(
b
,
BIO_CTRL_DGRAM_CONNECT
,0, (*)(
≥î
))

	)

513 
	#BIO_˘æ_£t_c⁄√˘ed
(
b
,
≥î
) \

514 ()
	`BIO_˘æ
(
b
, 
BIO_CTRL_DGRAM_SET_CONNECTED
, 0, (*)(
≥î
))

	)

515 
	#BIO_dgøm_ªcv_timedout
(
b
) \

516 ()
	`BIO_˘æ
(
b
, 
BIO_CTRL_DGRAM_GET_RECV_TIMER_EXP
, 0, 
NULL
)

	)

517 
	#BIO_dgøm_£nd_timedout
(
b
) \

518 ()
	`BIO_˘æ
(
b
, 
BIO_CTRL_DGRAM_GET_SEND_TIMER_EXP
, 0, 
NULL
)

	)

519 
	#BIO_dgøm_gë_≥î
(
b
,
≥î
) \

520 ()
	`BIO_˘æ
(
b
, 
BIO_CTRL_DGRAM_GET_PEER
, 0, (*)(
≥î
))

	)

521 
	#BIO_dgøm_£t_≥î
(
b
,
≥î
) \

522 ()
	`BIO_˘æ
(
b
, 
BIO_CTRL_DGRAM_SET_PEER
, 0, (*)(
≥î
))

	)

523 
	#BIO_dgøm_gë_mtu_ovîhód
(
b
) \

524 ()
	`BIO_˘æ
((
b
), 
BIO_CTRL_DGRAM_GET_MTU_OVERHEAD
, 0, 
NULL
)

	)

526 
	#BIO_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

527 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_BIO
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

528 
BIO_£t_ex_d©a
(
BIO
 *
bio
, 
idx
, *
d©a
);

529 *
BIO_gë_ex_d©a
(
BIO
 *
bio
, 
idx
);

530 
uöt64_t
 
BIO_numbî_ªad
(
BIO
 *
bio
);

531 
uöt64_t
 
BIO_numbî_wrôãn
(
BIO
 *
bio
);

534 
BIO_a¢1_£t_¥efix
(
BIO
 *
b
, 
a¢1_ps_func
 *
¥efix
,

535 
a¢1_ps_func
 *
¥efix_‰ì
);

536 
BIO_a¢1_gë_¥efix
(
BIO
 *
b
, 
a¢1_ps_func
 **
µªfix
,

537 
a¢1_ps_func
 **
µªfix_‰ì
);

538 
BIO_a¢1_£t_suffix
(
BIO
 *
b
, 
a¢1_ps_func
 *
suffix
,

539 
a¢1_ps_func
 *
suffix_‰ì
);

540 
BIO_a¢1_gë_suffix
(
BIO
 *
b
, 
a¢1_ps_func
 **
psuffix
,

541 
a¢1_ps_func
 **
psuffix_‰ì
);

543 c⁄° 
BIO_METHOD
 *
BIO_s_fûe
();

544 
BIO
 *
BIO_√w_fûe
(c⁄° *
fûíame
, c⁄° *
mode
);

545 #i‚de‡
OPENSSL_NO_STDIO


546 
BIO
 *
BIO_√w_Â
(
FILE
 *
°ªam
, 
˛o£_Êag
);

548 
BIO
 *
BIO_√w
(c⁄° 
BIO_METHOD
 *
ty≥
);

549 
BIO_‰ì
(
BIO
 *
a
);

550 
BIO_£t_d©a
(
BIO
 *
a
, *
±r
);

551 *
BIO_gë_d©a
(
BIO
 *
a
);

552 
BIO_£t_öô
(
BIO
 *
a
, 
öô
);

553 
BIO_gë_öô
(
BIO
 *
a
);

554 
BIO_£t_shutdown
(
BIO
 *
a
, 
shut
);

555 
BIO_gë_shutdown
(
BIO
 *
a
);

556 
BIO_v‰ì
(
BIO
 *
a
);

557 
BIO_up_ªf
(
BIO
 *
a
);

558 
BIO_ªad
(
BIO
 *
b
, *
d©a
, 
dÀn
);

559 
BIO_ªad_ex
(
BIO
 *
b
, *
d©a
, 
size_t
 
dÀn
, size_à*
ªadbyãs
);

560 
BIO_gës
(
BIO
 *
bp
, *
buf
, 
size
);

561 
BIO_wrôe
(
BIO
 *
b
, c⁄° *
d©a
, 
dÀn
);

562 
BIO_wrôe_ex
(
BIO
 *
b
, c⁄° *
d©a
, 
size_t
 
dÀn
, size_à*
wrôãn
);

563 
BIO_puts
(
BIO
 *
bp
, c⁄° *
buf
);

564 
BIO_ödít
(
BIO
 *
b
, 
ödít
, 
max
);

565 
BIO_˘æ
(
BIO
 *
bp
, 
cmd
, 
œrg
, *
∑rg
);

566 
BIO_ˇŒback_˘æ
(
BIO
 *
b
, 
cmd
, 
BIO_öfo_cb
 *
Â
);

567 *
BIO_±r_˘æ
(
BIO
 *
bp
, 
cmd
, 
œrg
);

568 
BIO_öt_˘æ
(
BIO
 *
bp
, 
cmd
, 
œrg
, 
ürg
);

569 
BIO
 *
BIO_push
(BIO *
b
, BIO *
≠≥nd
);

570 
BIO
 *
BIO_p›
(BIO *
b
);

571 
BIO_‰ì_Æl
(
BIO
 *
a
);

572 
BIO
 *
BIO_föd_ty≥
(BIO *
b
, 
bio_ty≥
);

573 
BIO
 *
BIO_√xt
(BIO *
b
);

574 
BIO_£t_√xt
(
BIO
 *
b
, BIO *
√xt
);

575 
BIO
 *
BIO_gë_ªåy_BIO
(BIO *
bio
, *
ªas⁄
);

576 
BIO_gë_ªåy_ªas⁄
(
BIO
 *
bio
);

577 
BIO_£t_ªåy_ªas⁄
(
BIO
 *
bio
, 
ªas⁄
);

578 
BIO
 *
BIO_dup_chaö
(BIO *
ö
);

580 
BIO_ƒód0
(
BIO
 *
bio
, **
buf
);

581 
BIO_ƒód
(
BIO
 *
bio
, **
buf
, 
num
);

582 
BIO_nwrôe0
(
BIO
 *
bio
, **
buf
);

583 
BIO_nwrôe
(
BIO
 *
bio
, **
buf
, 
num
);

585 
BIO_debug_ˇŒback
(
BIO
 *
bio
, 
cmd
, c⁄° *
¨gp
, 
¨gi
,

586 
¨gl
, 
ªt
);

588 c⁄° 
BIO_METHOD
 *
BIO_s_mem
();

589 c⁄° 
BIO_METHOD
 *
BIO_s_£cmem
();

590 
BIO
 *
BIO_√w_mem_buf
(c⁄° *
buf
, 
Àn
);

591 #i‚de‡
OPENSSL_NO_SOCK


592 c⁄° 
BIO_METHOD
 *
BIO_s_sockë
();

593 c⁄° 
BIO_METHOD
 *
BIO_s_c⁄√˘
();

594 c⁄° 
BIO_METHOD
 *
BIO_s_ac˚±
();

596 c⁄° 
BIO_METHOD
 *
BIO_s_fd
();

597 c⁄° 
BIO_METHOD
 *
BIO_s_log
();

598 c⁄° 
BIO_METHOD
 *
BIO_s_bio
();

599 c⁄° 
BIO_METHOD
 *
BIO_s_nuŒ
();

600 c⁄° 
BIO_METHOD
 *
BIO_f_nuŒ
();

601 c⁄° 
BIO_METHOD
 *
BIO_f_buf„r
();

602 c⁄° 
BIO_METHOD
 *
BIO_f_löebuf„r
();

603 c⁄° 
BIO_METHOD
 *
BIO_f_nbio_ã°
();

604 #i‚de‡
OPENSSL_NO_DGRAM


605 c⁄° 
BIO_METHOD
 *
BIO_s_d©agøm
();

606 
BIO_dgøm_n⁄_Áèl_îr‹
(
îr‹
);

607 
BIO
 *
BIO_√w_dgøm
(
fd
, 
˛o£_Êag
);

608 #i‚de‡
OPENSSL_NO_SCTP


609 c⁄° 
BIO_METHOD
 *
BIO_s_d©agøm_s˘p
();

610 
BIO
 *
BIO_√w_dgøm_s˘p
(
fd
, 
˛o£_Êag
);

611 
BIO_dgøm_is_s˘p
(
BIO
 *
bio
);

612 
BIO_dgøm_s˘p_nŸifiˇti⁄_cb
(
BIO
 *
b
,

613 (*
h™dÀ_nŸifiˇti⁄s
Ë(
BIO
 *
bio
,

614 *
c⁄ãxt
,

615 *
buf
),

616 *
c⁄ãxt
);

617 
BIO_dgøm_s˘p_waô_f‹_dry
(
BIO
 *
b
);

618 
BIO_dgøm_s˘p_msg_waôög
(
BIO
 *
b
);

622 #i‚de‡
OPENSSL_NO_SOCK


623 
BIO_sock_should_ªåy
(
i
);

624 
BIO_sock_n⁄_Áèl_îr‹
(
îr‹
);

627 
BIO_fd_should_ªåy
(
i
);

628 
BIO_fd_n⁄_Áèl_îr‹
(
îr‹
);

629 
BIO_dump_cb
((*
cb
Ë(c⁄° *
d©a
, 
size_t
 
Àn
, *
u
),

630 *
u
, c⁄° *
s
, 
Àn
);

631 
BIO_dump_ödít_cb
((*
cb
Ë(c⁄° *
d©a
, 
size_t
 
Àn
, *
u
),

632 *
u
, c⁄° *
s
, 
Àn
, 
ödít
);

633 
BIO_dump
(
BIO
 *
b
, c⁄° *
byãs
, 
Àn
);

634 
BIO_dump_ödít
(
BIO
 *
b
, c⁄° *
byãs
, 
Àn
, 
ödít
);

635 #i‚de‡
OPENSSL_NO_STDIO


636 
BIO_dump_Â
(
FILE
 *
Â
, c⁄° *
s
, 
Àn
);

637 
BIO_dump_ödít_Â
(
FILE
 *
Â
, c⁄° *
s
, 
Àn
, 
ödít
);

639 
BIO_hex_°rög
(
BIO
 *
out
, 
ödít
, 
width
, *
d©a
,

640 
d©Æí
);

642 #i‚de‡
OPENSSL_NO_SOCK


643 
BIO_ADDR
 *
BIO_ADDR_√w
();

644 
BIO_ADDR_øwmake
(
BIO_ADDR
 *
≠
, 
Ámûy
,

645 c⁄° *
whîe
, 
size_t
 
whîñí
, 
p‹t
);

646 
BIO_ADDR_‰ì
(
BIO_ADDR
 *);

647 
BIO_ADDR_˛ór
(
BIO_ADDR
 *
≠
);

648 
BIO_ADDR_Ámûy
(c⁄° 
BIO_ADDR
 *
≠
);

649 
BIO_ADDR_øwaddªss
(c⁄° 
BIO_ADDR
 *
≠
, *
p
, 
size_t
 *
l
);

650 
BIO_ADDR_øwp‹t
(c⁄° 
BIO_ADDR
 *
≠
);

651 *
BIO_ADDR_ho°«me_°rög
(c⁄° 
BIO_ADDR
 *
≠
, 
numîic
);

652 *
BIO_ADDR_£rvi˚_°rög
(c⁄° 
BIO_ADDR
 *
≠
, 
numîic
);

653 *
BIO_ADDR_∑th_°rög
(c⁄° 
BIO_ADDR
 *
≠
);

655 c⁄° 
BIO_ADDRINFO
 *
BIO_ADDRINFO_√xt
(c⁄° BIO_ADDRINFO *
bai
);

656 
BIO_ADDRINFO_Ámûy
(c⁄° 
BIO_ADDRINFO
 *
bai
);

657 
BIO_ADDRINFO_sockty≥
(c⁄° 
BIO_ADDRINFO
 *
bai
);

658 
BIO_ADDRINFO_¥Ÿocﬁ
(c⁄° 
BIO_ADDRINFO
 *
bai
);

659 c⁄° 
BIO_ADDR
 *
BIO_ADDRINFO_addªss
(c⁄° 
BIO_ADDRINFO
 *
bai
);

660 
BIO_ADDRINFO_‰ì
(
BIO_ADDRINFO
 *
bai
);

662 
	eBIO_ho°£rv_¥i‹ôõs
 {

663 
BIO_PARSE_PRIO_HOST
, 
BIO_PARSE_PRIO_SERV


665 
BIO_∑r£_ho°£rv
(c⁄° *
ho°£rv
, **
ho°
, **
£rvi˚
,

666 
BIO_ho°£rv_¥i‹ôõs
 
ho°£rv_¥io
);

667 
	eBIO_lookup_ty≥
 {

668 
BIO_LOOKUP_CLIENT
, 
BIO_LOOKUP_SERVER


670 
BIO_lookup
(c⁄° *
ho°
, c⁄° *
£rvi˚
,

671 
BIO_lookup_ty≥
 
lookup_ty≥
,

672 
Ámûy
, 
sockty≥
, 
BIO_ADDRINFO
 **
ªs
);

673 
BIO_lookup_ex
(c⁄° *
ho°
, c⁄° *
£rvi˚
,

674 
lookup_ty≥
, 
Ámûy
, 
sockty≥
, 
¥Ÿocﬁ
,

675 
BIO_ADDRINFO
 **
ªs
);

676 
BIO_sock_îr‹
(
sock
);

677 
BIO_sockë_io˘l
(
fd
, 
ty≥
, *
¨g
);

678 
BIO_sockë_nbio
(
fd
, 
mode
);

679 
BIO_sock_öô
();

680 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

681 
	#BIO_sock_˛ónup
(Ë0Ë

	)

683 
BIO_£t_t˝_ndñay
(
sock
, 
tu∫_⁄
);

685 
DEPRECATEDIN_1_1_0
(
ho°ít
 *
BIO_gëho°by«me
(c⁄° *
«me
))

686 
DEPRECATEDIN_1_1_0
(
BIO_gë_p‹t
(c⁄° *
°r
, *
p‹t_±r
))

687 
DEPRECATEDIN_1_1_0
(
BIO_gë_ho°_ù
(c⁄° *
°r
, *
ù
))

688 
DEPRECATEDIN_1_1_0
(
BIO_gë_ac˚±_sockë
(*
ho°_p‹t
, 
mode
))

689 
DEPRECATEDIN_1_1_0
(
BIO_ac˚±
(
sock
, **
ù_p‹t
))

691 
	uBIO_sock_öfo_u
 {

692 
BIO_ADDR
 *
addr
;

694 
	eBIO_sock_öfo_ty≥
 {

695 
BIO_SOCK_INFO_ADDRESS


697 
BIO_sock_öfo
(
sock
,

698 
BIO_sock_öfo_ty≥
 
ty≥
, 
BIO_sock_öfo_u
 *
öfo
);

700 
	#BIO_SOCK_REUSEADDR
 0x01

	)

701 
	#BIO_SOCK_V6_ONLY
 0x02

	)

702 
	#BIO_SOCK_KEEPALIVE
 0x04

	)

703 
	#BIO_SOCK_NONBLOCK
 0x08

	)

704 
	#BIO_SOCK_NODELAY
 0x10

	)

706 
BIO_sockë
(
domaö
, 
sockty≥
, 
¥Ÿocﬁ
, 
›ti⁄s
);

707 
BIO_c⁄√˘
(
sock
, c⁄° 
BIO_ADDR
 *
addr
, 
›ti⁄s
);

708 
BIO_böd
(
sock
, c⁄° 
BIO_ADDR
 *
addr
, 
›ti⁄s
);

709 
BIO_li°í
(
sock
, c⁄° 
BIO_ADDR
 *
addr
, 
›ti⁄s
);

710 
BIO_ac˚±_ex
(
ac˚±_sock
, 
BIO_ADDR
 *
addr
, 
›ti⁄s
);

711 
BIO_˛o£sockë
(
sock
);

713 
BIO
 *
BIO_√w_sockë
(
sock
, 
˛o£_Êag
);

714 
BIO
 *
BIO_√w_c⁄√˘
(c⁄° *
ho°_p‹t
);

715 
BIO
 *
BIO_√w_ac˚±
(c⁄° *
ho°_p‹t
);

718 
BIO
 *
BIO_√w_fd
(
fd
, 
˛o£_Êag
);

720 
BIO_√w_bio_∑ú
(
BIO
 **
bio1
, 
size_t
 
wrôebuf1
,

721 
BIO
 **
bio2
, 
size_t
 
wrôebuf2
);

728 
BIO_c›y_√xt_ªåy
(
BIO
 *
b
);

734 
	#os¶_bio__©å__
(
x
)

	)

735 #i‡
deföed
(
__GNUC__
Ë&& deföed(
__STDC_VERSION__
) \

736 && !
deföed
(
__APPLE__
)

741 #i‡
__STDC_VERSION__
 >= 199901L

742 #unde‡
os¶_bio__©å__


743 
	#os¶_bio__©å__
 
__©åibuã__


	)

744 #i‡
__GNUC__
*10 + 
__GNUC_MINOR__
 >= 44

745 
	#os¶_bio__¥ötf__
 
__gnu_¥ötf__


	)

747 
	#os¶_bio__¥ötf__
 
__¥ötf__


	)

751 
BIO_¥ötf
(
BIO
 *
bio
, c⁄° *
f‹m©
, ...)

752 
os¶_bio__©å__
((
__f‹m©__
(
os¶_bio__¥ötf__
, 2, 3)));

753 
BIO_v¥ötf
(
BIO
 *
bio
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

754 
os¶_bio__©å__
((
__f‹m©__
(
os¶_bio__¥ötf__
, 2, 0)));

755 
BIO_¢¥ötf
(*
buf
, 
size_t
 
n
, c⁄° *
f‹m©
, ...)

756 
os¶_bio__©å__
((
__f‹m©__
(
os¶_bio__¥ötf__
, 3, 4)));

757 
BIO_v¢¥ötf
(*
buf
, 
size_t
 
n
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

758 
os¶_bio__©å__
((
__f‹m©__
(
os¶_bio__¥ötf__
, 3, 0)));

759 #unde‡
os¶_bio__©å__


760 #unde‡
os¶_bio__¥ötf__


763 
BIO_METHOD
 *
BIO_mëh_√w
(
ty≥
, c⁄° *
«me
);

764 
BIO_mëh_‰ì
(
BIO_METHOD
 *
biom
);

765 (*
BIO_mëh_gë_wrôe
(c⁄° 
BIO_METHOD
 *
biom
)Ë(
BIO
 *, const *, );

766 (*
BIO_mëh_gë_wrôe_ex
(c⁄° 
BIO_METHOD
 *
biom
)Ë(
BIO
 *, c⁄° *, 
size_t
,

767 
size_t
 *);

768 
BIO_mëh_£t_wrôe
(
BIO_METHOD
 *
biom
,

769 (*
wrôe
Ë(
BIO
 *, const *, ));

770 
BIO_mëh_£t_wrôe_ex
(
BIO_METHOD
 *
biom
,

771 (*
bwrôe
Ë(
BIO
 *, c⁄° *, 
size_t
, size_t *));

772 (*
BIO_mëh_gë_ªad
(c⁄° 
BIO_METHOD
 *
biom
)Ë(
BIO
 *, *, );

773 (*
BIO_mëh_gë_ªad_ex
(c⁄° 
BIO_METHOD
 *
biom
)Ë(
BIO
 *, *, 
size_t
, size_t *);

774 
BIO_mëh_£t_ªad
(
BIO_METHOD
 *
biom
,

775 (*
ªad
Ë(
BIO
 *, *, ));

776 
BIO_mëh_£t_ªad_ex
(
BIO_METHOD
 *
biom
,

777 (*
bªad
Ë(
BIO
 *, *, 
size_t
, size_t *));

778 (*
BIO_mëh_gë_puts
(c⁄° 
BIO_METHOD
 *
biom
)Ë(
BIO
 *, const *);

779 
BIO_mëh_£t_puts
(
BIO_METHOD
 *
biom
,

780 (*
puts
Ë(
BIO
 *, const *));

781 (*
BIO_mëh_gë_gës
(c⁄° 
BIO_METHOD
 *
biom
)Ë(
BIO
 *, *, );

782 
BIO_mëh_£t_gës
(
BIO_METHOD
 *
biom
,

783 (*
gës
Ë(
BIO
 *, *, ));

784 (*
BIO_mëh_gë_˘æ
(c⁄° 
BIO_METHOD
 *
biom
)Ë(
BIO
 *, , , *);

785 
BIO_mëh_£t_˘æ
(
BIO_METHOD
 *
biom
,

786 (*
˘æ
Ë(
BIO
 *, , , *));

787 (*
BIO_mëh_gë_¸óã
(c⁄° 
BIO_METHOD
 *
bi⁄
)Ë(
BIO
 *);

788 
BIO_mëh_£t_¸óã
(
BIO_METHOD
 *
biom
, (*
¸óã
Ë(
BIO
 *));

789 (*
BIO_mëh_gë_de°roy
(c⁄° 
BIO_METHOD
 *
biom
)Ë(
BIO
 *);

790 
BIO_mëh_£t_de°roy
(
BIO_METHOD
 *
biom
, (*
de°roy
Ë(
BIO
 *));

791 (*
BIO_mëh_gë_ˇŒback_˘æ
(c⁄° 
BIO_METHOD
 *
biom
))

792 (
BIO
 *, , 
BIO_öfo_cb
 *);

793 
BIO_mëh_£t_ˇŒback_˘æ
(
BIO_METHOD
 *
biom
,

794 (*
ˇŒback_˘æ
Ë(
BIO
 *, ,

795 
BIO_öfo_cb
 *));

797 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/buffer.h

10 #i‚de‡
HEADER_BUFFER_H


11 
	#HEADER_BUFFER_H


	)

13 
	~<›ís¶/os¶_typ.h
>

14 #i‚de‡
HEADER_CRYPTO_H


15 
	~<›ís¶/¸y±o.h
>

17 
	~<›ís¶/buf„ªº.h
>

20 #ifde‡ 
__˝lu•lus


24 
	~<°ddef.h
>

25 
	~<sys/ty≥s.h
>

31 
	#BUF_°rdup
(
s
Ë
	`OPENSSL_°rdup
(s)

	)

32 
	#BUF_°∫dup
(
s
, 
size
Ë
	`OPENSSL_°∫dup
(s, size)

	)

33 
	#BUF_memdup
(
d©a
, 
size
Ë
	`OPENSSL_memdup
(d©a, size)

	)

34 
	#BUF_°æ˝y
(
d°
, 
§c
, 
size
Ë
	`OPENSSL_°æ˝y
(d°, src, size)

	)

35 
	#BUF_°æˇt
(
d°
, 
§c
, 
size
Ë
	`OPENSSL_°æˇt
(d°, src, size)

	)

36 
	#BUF_°∫Àn
(
°r
, 
maxÀn
Ë
	`OPENSSL_°∫Àn
(°r, maxÀn)

	)

38 
	sbuf_mem_°
 {

39 
size_t
 
Àngth
;

40 *
d©a
;

41 
size_t
 
max
;

42 
Êags
;

45 
	#BUF_MEM_FLAG_SECURE
 0x01

	)

47 
BUF_MEM
 *
BUF_MEM_√w
();

48 
BUF_MEM
 *
BUF_MEM_√w_ex
(
Êags
);

49 
BUF_MEM_‰ì
(
BUF_MEM
 *
a
);

50 
size_t
 
BUF_MEM_grow
(
BUF_MEM
 *
°r
, size_à
Àn
);

51 
size_t
 
BUF_MEM_grow_˛ón
(
BUF_MEM
 *
°r
, size_à
Àn
);

52 
BUF_ªvî£
(*
out
, c⁄° *
ö
, 
size_t
 
siz
);

55 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/comp.h

10 #i‚de‡
HEADER_COMP_H


11 
	#HEADER_COMP_H


	)

13 
	~<›ís¶/›ís¶c⁄f.h
>

15 #i‚de‡
OPENSSL_NO_COMP


16 
	~<›ís¶/¸y±o.h
>

17 
	~<›ís¶/com≥º.h
>

18 #ifde‡ 
__˝lu•lus


24 
COMP_CTX
 *
COMP_CTX_√w
(
COMP_METHOD
 *
mëh
);

25 c⁄° 
COMP_METHOD
 *
COMP_CTX_gë_mëhod
(c⁄° 
COMP_CTX
 *
˘x
);

26 
COMP_CTX_gë_ty≥
(c⁄° 
COMP_CTX
* 
comp
);

27 
COMP_gë_ty≥
(c⁄° 
COMP_METHOD
 *
mëh
);

28 c⁄° *
COMP_gë_«me
(c⁄° 
COMP_METHOD
 *
mëh
);

29 
COMP_CTX_‰ì
(
COMP_CTX
 *
˘x
);

31 
COMP_com¥ess_block
(
COMP_CTX
 *
˘x
, *
out
, 
ﬁí
,

32 *
ö
, 
ûí
);

33 
COMP_ex∑nd_block
(
COMP_CTX
 *
˘x
, *
out
, 
ﬁí
,

34 *
ö
, 
ûí
);

36 
COMP_METHOD
 *
COMP_zlib
();

38 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

39 
	#COMP_zlib_˛ónup
(Ë0Ë

	)

42 #ifde‡
HEADER_BIO_H


43 #ifde‡
ZLIB


44 c⁄° 
BIO_METHOD
 *
BIO_f_zlib
();

49 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/crypto.h

11 #i‚de‡
HEADER_CRYPTO_H


12 
	#HEADER_CRYPTO_H


	)

14 
	~<°dlib.h
>

15 
	~<time.h
>

17 
	~<›ís¶/e_os2.h
>

19 #i‚de‡
OPENSSL_NO_STDIO


20 
	~<°dio.h
>

23 
	~<›ís¶/ß„°ack.h
>

24 
	~<›ís¶/›ís¶v.h
>

25 
	~<›ís¶/os¶_typ.h
>

26 
	~<›ís¶/›ís¶c⁄f.h
>

27 
	~<›ís¶/¸y±€º.h
>

29 #ifde‡
CHARSET_EBCDIC


30 
	~<›ís¶/ebcdic.h
>

37 
	~<›ís¶/symhacks.h
>

39 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

40 
	~<›ís¶/›ís¶v.h
>

43 #ifde‡ 
__˝lu•lus


47 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

48 
	#SSLóy
 
O≥nSSL_vîsi⁄_num


	)

49 
	#SSLóy_vîsi⁄
 
O≥nSSL_vîsi⁄


	)

50 
	#SSLEAY_VERSION_NUMBER
 
OPENSSL_VERSION_NUMBER


	)

51 
	#SSLEAY_VERSION
 
OPENSSL_VERSION


	)

52 
	#SSLEAY_CFLAGS
 
OPENSSL_CFLAGS


	)

53 
	#SSLEAY_BUILT_ON
 
OPENSSL_BUILT_ON


	)

54 
	#SSLEAY_PLATFORM
 
OPENSSL_PLATFORM


	)

55 
	#SSLEAY_DIR
 
OPENSSL_DIR


	)

62 
dummy
;

63 } 
	tCRYPTO_dy∆ock
;

67 
	tCRYPTO_RWLOCK
;

69 
CRYPTO_RWLOCK
 *
CRYPTO_THREAD_lock_√w
();

70 
CRYPTO_THREAD_ªad_lock
(
CRYPTO_RWLOCK
 *
lock
);

71 
CRYPTO_THREAD_wrôe_lock
(
CRYPTO_RWLOCK
 *
lock
);

72 
CRYPTO_THREAD_u∆ock
(
CRYPTO_RWLOCK
 *
lock
);

73 
CRYPTO_THREAD_lock_‰ì
(
CRYPTO_RWLOCK
 *
lock
);

75 
CRYPTO_©omic_add
(*
vÆ
, 
amou¡
, *
ªt
, 
CRYPTO_RWLOCK
 *
lock
);

81 
	#CRYPTO_MEM_CHECK_OFF
 0x0

	)

82 
	#CRYPTO_MEM_CHECK_ON
 0x1

	)

83 
	#CRYPTO_MEM_CHECK_ENABLE
 0x2

	)

84 
	#CRYPTO_MEM_CHECK_DISABLE
 0x3

	)

86 
	s¸y±o_ex_d©a_°
 {

87 
STACK_OF
(Ë*
	gsk
;

89 
DEFINE_STACK_OF
()

94 
	#CRYPTO_EX_INDEX_SSL
 0

	)

95 
	#CRYPTO_EX_INDEX_SSL_CTX
 1

	)

96 
	#CRYPTO_EX_INDEX_SSL_SESSION
 2

	)

97 
	#CRYPTO_EX_INDEX_X509
 3

	)

98 
	#CRYPTO_EX_INDEX_X509_STORE
 4

	)

99 
	#CRYPTO_EX_INDEX_X509_STORE_CTX
 5

	)

100 
	#CRYPTO_EX_INDEX_DH
 6

	)

101 
	#CRYPTO_EX_INDEX_DSA
 7

	)

102 
	#CRYPTO_EX_INDEX_EC_KEY
 8

	)

103 
	#CRYPTO_EX_INDEX_RSA
 9

	)

104 
	#CRYPTO_EX_INDEX_ENGINE
 10

	)

105 
	#CRYPTO_EX_INDEX_UI
 11

	)

106 
	#CRYPTO_EX_INDEX_BIO
 12

	)

107 
	#CRYPTO_EX_INDEX_APP
 13

	)

108 
	#CRYPTO_EX_INDEX_UI_METHOD
 14

	)

109 
	#CRYPTO_EX_INDEX_DRBG
 15

	)

110 
	#CRYPTO_EX_INDEX__COUNT
 16

	)

113 
	#OPENSSL_mÆloc_öô
(Ë0Ë

	)

115 
CRYPTO_mem_˘æ
(
mode
);

117 
	#OPENSSL_mÆloc
(
num
) \

118 
	`CRYPTO_mÆloc
(
num
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

119 
	#OPENSSL_zÆloc
(
num
) \

120 
	`CRYPTO_zÆloc
(
num
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

121 
	#OPENSSL_ªÆloc
(
addr
, 
num
) \

122 
	`CRYPTO_ªÆloc
(
addr
, 
num
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

123 
	#OPENSSL_˛ór_ªÆloc
(
addr
, 
ﬁd_num
, 
num
) \

124 
	`CRYPTO_˛ór_ªÆloc
(
addr
, 
ﬁd_num
, 
num
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

125 
	#OPENSSL_˛ór_‰ì
(
addr
, 
num
) \

126 
	`CRYPTO_˛ór_‰ì
(
addr
, 
num
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

127 
	#OPENSSL_‰ì
(
addr
) \

128 
	`CRYPTO_‰ì
(
addr
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

129 
	#OPENSSL_memdup
(
°r
, 
s
) \

130 
	`CRYPTO_memdup
((
°r
), 
s
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

131 
	#OPENSSL_°rdup
(
°r
) \

132 
	`CRYPTO_°rdup
(
°r
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

133 
	#OPENSSL_°∫dup
(
°r
, 
n
) \

134 
	`CRYPTO_°∫dup
(
°r
, 
n
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

135 
	#OPENSSL_£cuª_mÆloc
(
num
) \

136 
	`CRYPTO_£cuª_mÆloc
(
num
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

137 
	#OPENSSL_£cuª_zÆloc
(
num
) \

138 
	`CRYPTO_£cuª_zÆloc
(
num
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

139 
	#OPENSSL_£cuª_‰ì
(
addr
) \

140 
	`CRYPTO_£cuª_‰ì
(
addr
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

141 
	#OPENSSL_£cuª_˛ór_‰ì
(
addr
, 
num
) \

142 
	`CRYPTO_£cuª_˛ór_‰ì
(
addr
, 
num
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

143 
	#OPENSSL_£cuª_a˘uÆ_size
(
±r
) \

144 
	`CRYPTO_£cuª_a˘uÆ_size
(
±r
)

	)

146 
size_t
 
OPENSSL_°æ˝y
(*
d°
, c⁄° *
§c
, size_à
siz
);

147 
size_t
 
OPENSSL_°æˇt
(*
d°
, c⁄° *
§c
, size_à
siz
);

148 
size_t
 
OPENSSL_°∫Àn
(c⁄° *
°r
, size_à
maxÀn
);

149 *
OPENSSL_buf2hex°r
(c⁄° *
buf„r
, 
Àn
);

150 *
OPENSSL_hex°r2buf
(c⁄° *
°r
, *
Àn
);

151 
OPENSSL_hexch¨2öt
(
c
);

153 
	#OPENSSL_MALLOC_MAX_NELEMS
(
ty≥
Ë(((1U<<(()*8-1))-1)/—y≥))

	)

155 
O≥nSSL_vîsi⁄_num
();

156 c⁄° *
O≥nSSL_vîsi⁄
(
ty≥
);

157 
	#OPENSSL_VERSION
 0

	)

158 
	#OPENSSL_CFLAGS
 1

	)

159 
	#OPENSSL_BUILT_ON
 2

	)

160 
	#OPENSSL_PLATFORM
 3

	)

161 
	#OPENSSL_DIR
 4

	)

162 
	#OPENSSL_ENGINES_DIR
 5

	)

164 
OPENSSL_is£tugid
();

166 
	tCRYPTO_EX_√w
 (*
	t∑ª¡
, *
	t±r
, 
	tCRYPTO_EX_DATA
 *
	tad
,

167 
	tidx
, 
	t¨gl
, *
	t¨gp
);

168 
	tCRYPTO_EX_‰ì
 (*
	t∑ª¡
, *
	t±r
, 
	tCRYPTO_EX_DATA
 *
	tad
,

169 
	tidx
, 
	t¨gl
, *
	t¨gp
);

170 
	tCRYPTO_EX_dup
 (
	tCRYPTO_EX_DATA
 *
	tto
, c⁄° CRYPTO_EX_DATA *
	t‰om
,

171 *
	t‰om_d
, 
	tidx
, 
	t¨gl
, *
	t¨gp
);

172 
__owur
 
CRYPTO_gë_ex_√w_ödex
(
˛ass_ödex
, 
¨gl
, *
¨gp
,

173 
CRYPTO_EX_√w
 *
√w_func
, 
CRYPTO_EX_dup
 *
dup_func
,

174 
CRYPTO_EX_‰ì
 *
‰ì_func
);

176 
CRYPTO_‰ì_ex_ödex
(
˛ass_ödex
, 
idx
);

182 
CRYPTO_√w_ex_d©a
(
˛ass_ödex
, *
obj
, 
CRYPTO_EX_DATA
 *
ad
);

183 
CRYPTO_dup_ex_d©a
(
˛ass_ödex
, 
CRYPTO_EX_DATA
 *
to
,

184 c⁄° 
CRYPTO_EX_DATA
 *
‰om
);

186 
CRYPTO_‰ì_ex_d©a
(
˛ass_ödex
, *
obj
, 
CRYPTO_EX_DATA
 *
ad
);

192 
CRYPTO_£t_ex_d©a
(
CRYPTO_EX_DATA
 *
ad
, 
idx
, *
vÆ
);

193 *
CRYPTO_gë_ex_d©a
(c⁄° 
CRYPTO_EX_DATA
 *
ad
, 
idx
);

195 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

200 
	#CRYPTO_˛ónup_Æl_ex_d©a
(Ë0Ë

	)

212 
	#CRYPTO_num_locks
(Ë(1)

	)

213 
	#CRYPTO_£t_lockög_ˇŒback
(
func
)

	)

214 
	#CRYPTO_gë_lockög_ˇŒback
(Ë(
NULL
)

	)

215 
	#CRYPTO_£t_add_lock_ˇŒback
(
func
)

	)

216 
	#CRYPTO_gë_add_lock_ˇŒback
(Ë(
NULL
)

	)

223 
	#CRYPTO_LOCK
 1

	)

224 
	#CRYPTO_UNLOCK
 2

	)

225 
	#CRYPTO_READ
 4

	)

226 
	#CRYPTO_WRITE
 8

	)

229 
	s¸y±o_thªadid_°
 {

230 
	gdummy
;

231 } 
	tCRYPTO_THREADID
;

233 
	#CRYPTO_THREADID_£t_numîic
(
id
, 
vÆ
)

	)

234 
	#CRYPTO_THREADID_£t_poöãr
(
id
, 
±r
)

	)

235 
	#CRYPTO_THREADID_£t_ˇŒback
(
thªadid_func
Ë(0)

	)

236 
	#CRYPTO_THREADID_gë_ˇŒback
(Ë(
NULL
)

	)

237 
	#CRYPTO_THREADID_cuºít
(
id
)

	)

238 
	#CRYPTO_THREADID_cmp
(
a
, 
b
Ë(-1)

	)

239 
	#CRYPTO_THREADID_˝y
(
de°
, 
§c
)

	)

240 
	#CRYPTO_THREADID_hash
(
id
Ë(0UL)

	)

242 #i‡
OPENSSL_API_COMPAT
 < 0x10000000L

243 
	#CRYPTO_£t_id_ˇŒback
(
func
)

	)

244 
	#CRYPTO_gë_id_ˇŒback
(Ë(
NULL
)

	)

245 
	#CRYPTO_thªad_id
(Ë(0UL)

	)

248 
	#CRYPTO_£t_dy∆ock_¸óã_ˇŒback
(
dyn_¸óã_fun˘i⁄
)

	)

249 
	#CRYPTO_£t_dy∆ock_lock_ˇŒback
(
dyn_lock_fun˘i⁄
)

	)

250 
	#CRYPTO_£t_dy∆ock_de°roy_ˇŒback
(
dyn_de°roy_fun˘i⁄
)

	)

251 
	#CRYPTO_gë_dy∆ock_¸óã_ˇŒback
(Ë(
NULL
)

	)

252 
	#CRYPTO_gë_dy∆ock_lock_ˇŒback
(Ë(
NULL
)

	)

253 
	#CRYPTO_gë_dy∆ock_de°roy_ˇŒback
(Ë(
NULL
)

	)

256 
CRYPTO_£t_mem_fun˘i⁄s
(

257 *(*
m
Ë(
size_t
, const *, ),

258 *(*
r
Ë(*, 
size_t
, const *, ),

259 (*
f
) (*, const *, ));

260 
CRYPTO_£t_mem_debug
(
Êag
);

261 
CRYPTO_gë_mem_fun˘i⁄s
(

262 *(**
m
Ë(
size_t
, const *, ),

263 *(**
r
Ë(*, 
size_t
, const *, ),

264 (**
f
) (*, const *, ));

266 *
CRYPTO_mÆloc
(
size_t
 
num
, c⁄° *
fûe
, 
löe
);

267 *
CRYPTO_zÆloc
(
size_t
 
num
, c⁄° *
fûe
, 
löe
);

268 *
CRYPTO_memdup
(c⁄° *
°r
, 
size_t
 
siz
, c⁄° *
fûe
, 
löe
);

269 *
CRYPTO_°rdup
(c⁄° *
°r
, c⁄° *
fûe
, 
löe
);

270 *
CRYPTO_°∫dup
(c⁄° *
°r
, 
size_t
 
s
, c⁄° *
fûe
, 
löe
);

271 
CRYPTO_‰ì
(*
±r
, c⁄° *
fûe
, 
löe
);

272 
CRYPTO_˛ór_‰ì
(*
±r
, 
size_t
 
num
, c⁄° *
fûe
, 
löe
);

273 *
CRYPTO_ªÆloc
(*
addr
, 
size_t
 
num
, c⁄° *
fûe
, 
löe
);

274 *
CRYPTO_˛ór_ªÆloc
(*
addr
, 
size_t
 
ﬁd_num
, size_à
num
,

275 c⁄° *
fûe
, 
löe
);

277 
CRYPTO_£cuª_mÆloc_öô
(
size_t
 
sz
, 
mösize
);

278 
CRYPTO_£cuª_mÆloc_d⁄e
();

279 *
CRYPTO_£cuª_mÆloc
(
size_t
 
num
, c⁄° *
fûe
, 
löe
);

280 *
CRYPTO_£cuª_zÆloc
(
size_t
 
num
, c⁄° *
fûe
, 
löe
);

281 
CRYPTO_£cuª_‰ì
(*
±r
, c⁄° *
fûe
, 
löe
);

282 
CRYPTO_£cuª_˛ór_‰ì
(*
±r
, 
size_t
 
num
,

283 c⁄° *
fûe
, 
löe
);

284 
CRYPTO_£cuª_Æloˇãd
(c⁄° *
±r
);

285 
CRYPTO_£cuª_mÆloc_öôülized
();

286 
size_t
 
CRYPTO_£cuª_a˘uÆ_size
(*
±r
);

287 
size_t
 
CRYPTO_£cuª_u£d
();

289 
OPENSSL_˛ón£
(*
±r
, 
size_t
 
Àn
);

291 #i‚de‡
OPENSSL_NO_CRYPTO_MDEBUG


292 
	#OPENSSL_mem_debug_push
(
öfo
) \

293 
	`CRYPTO_mem_debug_push
(
öfo
, 
OPENSSL_FILE
, 
OPENSSL_LINE
)

	)

294 
	#OPENSSL_mem_debug_p›
() \

295 
	`CRYPTO_mem_debug_p›
()

	)

296 
CRYPTO_mem_debug_push
(c⁄° *
öfo
, c⁄° *
fûe
, 
löe
);

297 
CRYPTO_mem_debug_p›
();

298 
CRYPTO_gë_Æloc_cou¡s
(*
mcou¡
, *
rcou¡
, *
fcou¡
);

306 
CRYPTO_mem_debug_mÆloc
(*
addr
, 
size_t
 
num
, 
Êag
,

307 c⁄° *
fûe
, 
löe
);

308 
CRYPTO_mem_debug_ªÆloc
(*
addr1
, *
addr2
, 
size_t
 
num
, 
Êag
,

309 c⁄° *
fûe
, 
löe
);

310 
CRYPTO_mem_debug_‰ì
(*
addr
, 
Êag
,

311 c⁄° *
fûe
, 
löe
);

313 
CRYPTO_mem_Àaks_cb
((*
cb
Ë(c⁄° *
°r
, 
size_t
 
Àn
, *
u
),

314 *
u
);

315 #i‚de‡
OPENSSL_NO_STDIO


316 
CRYPTO_mem_Àaks_Â
(
FILE
 *);

318 
CRYPTO_mem_Àaks
(
BIO
 *
bio
);

322 
os¶_n‹ëu∫
 
OPENSSL_dõ
(c⁄° *
as£πi⁄
, c⁄° *
fûe
, 
löe
);

323 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

324 
	#O≥nSSLDõ
(
f
,
l
,
a
Ë
	`OPENSSL_dõ
(◊),(f),÷))

	)

326 
	#OPENSSL_as£π
(
e
) \

327 ()((
e
Ë? 0 : (
	`OPENSSL_dõ
("as£πi⁄ faûed: " #e, 
OPENSSL_FILE
, 
OPENSSL_LINE
), 1))

	)

329 
OPENSSL_is£rvi˚
();

331 
FIPS_mode
();

332 
FIPS_mode_£t
(
r
);

334 
OPENSSL_öô
();

335 #ifde‡
OPENSSL_SYS_UNIX


336 
OPENSSL_f‹k_¥ï¨e
();

337 
OPENSSL_f‹k_∑ª¡
();

338 
OPENSSL_f‹k_chûd
();

341 
tm
 *
OPENSSL_gmtime
(c⁄° 
time_t
 *
timî
, tm *
ªsu…
);

342 
OPENSSL_gmtime_adj
(
tm
 *tm, 
off£t_day
, 
off£t_£c
);

343 
OPENSSL_gmtime_diff
(*
pday
, *
p£c
,

344 c⁄° 
tm
 *
‰om
, c⁄° tm *
to
);

353 
CRYPTO_memcmp
(c⁄° * 
ö_a
, c⁄° * 
ö_b
, 
size_t
 
Àn
);

356 
	#OPENSSL_INIT_NO_LOAD_CRYPTO_STRINGS
 0x00000001L

	)

357 
	#OPENSSL_INIT_LOAD_CRYPTO_STRINGS
 0x00000002L

	)

358 
	#OPENSSL_INIT_ADD_ALL_CIPHERS
 0x00000004L

	)

359 
	#OPENSSL_INIT_ADD_ALL_DIGESTS
 0x00000008L

	)

360 
	#OPENSSL_INIT_NO_ADD_ALL_CIPHERS
 0x00000010L

	)

361 
	#OPENSSL_INIT_NO_ADD_ALL_DIGESTS
 0x00000020L

	)

362 
	#OPENSSL_INIT_LOAD_CONFIG
 0x00000040L

	)

363 
	#OPENSSL_INIT_NO_LOAD_CONFIG
 0x00000080L

	)

364 
	#OPENSSL_INIT_ASYNC
 0x00000100L

	)

365 
	#OPENSSL_INIT_ENGINE_RDRAND
 0x00000200L

	)

366 
	#OPENSSL_INIT_ENGINE_DYNAMIC
 0x00000400L

	)

367 
	#OPENSSL_INIT_ENGINE_OPENSSL
 0x00000800L

	)

368 
	#OPENSSL_INIT_ENGINE_CRYPTODEV
 0x00001000L

	)

369 
	#OPENSSL_INIT_ENGINE_CAPI
 0x00002000L

	)

370 
	#OPENSSL_INIT_ENGINE_PADLOCK
 0x00004000L

	)

371 
	#OPENSSL_INIT_ENGINE_AFALG
 0x00008000L

	)

373 
	#OPENSSL_INIT_ATFORK
 0x00020000L

	)

375 
	#OPENSSL_INIT_NO_ATEXIT
 0x00080000L

	)

380 
	#OPENSSL_INIT_ENGINE_ALL_BUILTIN
 \

381 (
OPENSSL_INIT_ENGINE_RDRAND
 | 
OPENSSL_INIT_ENGINE_DYNAMIC
 \

382 | 
OPENSSL_INIT_ENGINE_CRYPTODEV
 | 
OPENSSL_INIT_ENGINE_CAPI
 | \

383 
OPENSSL_INIT_ENGINE_PADLOCK
)

	)

387 
OPENSSL_˛ónup
();

388 
OPENSSL_öô_¸y±o
(
uöt64_t
 
›ts
, c⁄° 
OPENSSL_INIT_SETTINGS
 *
£âögs
);

389 
OPENSSL_©exô
((*
h™dÀr
)());

390 
OPENSSL_thªad_°›
();

393 
OPENSSL_INIT_SETTINGS
 *
OPENSSL_INIT_√w
();

394 #i‚de‡
OPENSSL_NO_STDIO


395 
OPENSSL_INIT_£t_c⁄fig_fûíame
(
OPENSSL_INIT_SETTINGS
 *
£âögs
,

396 c⁄° *
c⁄fig_fûíame
);

397 
OPENSSL_INIT_£t_c⁄fig_fûe_Êags
(
OPENSSL_INIT_SETTINGS
 *
£âögs
,

398 
Êags
);

399 
OPENSSL_INIT_£t_c⁄fig_≠≤ame
(
OPENSSL_INIT_SETTINGS
 *
£âögs
,

400 c⁄° *
c⁄fig_≠≤ame
);

402 
OPENSSL_INIT_‰ì
(
OPENSSL_INIT_SETTINGS
 *
£âögs
);

404 #i‡
deföed
(
OPENSSL_THREADS
Ë&& !deföed(
CRYPTO_TDEBUG
)

405 #i‡
deföed
(
_WIN32
)

406 #i‡
deföed
(
BASETYPES
Ë|| deföed(
_WINDEF_H
)

408 
DWORD
 
	tCRYPTO_THREAD_LOCAL
;

409 
DWORD
 
	tCRYPTO_THREAD_ID
;

411 
LONG
 
	tCRYPTO_ONCE
;

412 
	#CRYPTO_ONCE_STATIC_INIT
 0

	)

415 
	~<±hªad.h
>

416 
±hªad_⁄˚_t
 
	tCRYPTO_ONCE
;

417 
±hªad_key_t
 
	tCRYPTO_THREAD_LOCAL
;

418 
±hªad_t
 
	tCRYPTO_THREAD_ID
;

420 
	#CRYPTO_ONCE_STATIC_INIT
 
PTHREAD_ONCE_INIT


	)

424 #i‡!
deföed
(
CRYPTO_ONCE_STATIC_INIT
)

425 
	tCRYPTO_ONCE
;

426 
	tCRYPTO_THREAD_LOCAL
;

427 
	tCRYPTO_THREAD_ID
;

428 
	#CRYPTO_ONCE_STATIC_INIT
 0

	)

431 
CRYPTO_THREAD_run_⁄˚
(
CRYPTO_ONCE
 *
⁄˚
, (*
öô
)());

433 
CRYPTO_THREAD_öô_loˇl
(
CRYPTO_THREAD_LOCAL
 *
key
, (*
˛ónup
)(*));

434 *
CRYPTO_THREAD_gë_loˇl
(
CRYPTO_THREAD_LOCAL
 *
key
);

435 
CRYPTO_THREAD_£t_loˇl
(
CRYPTO_THREAD_LOCAL
 *
key
, *
vÆ
);

436 
CRYPTO_THREAD_˛ónup_loˇl
(
CRYPTO_THREAD_LOCAL
 *
key
);

438 
CRYPTO_THREAD_ID
 
CRYPTO_THREAD_gë_cuºít_id
();

439 
CRYPTO_THREAD_com∑ª_id
(
CRYPTO_THREAD_ID
 
a
, CRYPTO_THREAD_ID 
b
);

442 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/ct.h

10 #i‚de‡
HEADER_CT_H


11 
	#HEADER_CT_H


	)

13 
	~<›ís¶/›ís¶c⁄f.h
>

15 #i‚de‡
OPENSSL_NO_CT


16 
	~<›ís¶/os¶_typ.h
>

17 
	~<›ís¶/ß„°ack.h
>

18 
	~<›ís¶/x509.h
>

19 
	~<›ís¶/˘îr.h
>

20 #ifde‡ 
__˝lu•lus


26 
	#SCT_MIN_RSA_BITS
 2048

	)

29 
	#CT_V1_HASHLEN
 
SHA256_DIGEST_LENGTH


	)

32 
CT_LOG_ENTRY_TYPE_NOT_SET
 = -1,

33 
CT_LOG_ENTRY_TYPE_X509
 = 0,

34 
CT_LOG_ENTRY_TYPE_PRECERT
 = 1

35 } 
	t˘_log_íåy_ty≥_t
;

38 
SCT_VERSION_NOT_SET
 = -1,

39 
SCT_VERSION_V1
 = 0

40 } 
	ts˘_vîsi⁄_t
;

43 
SCT_SOURCE_UNKNOWN
,

44 
SCT_SOURCE_TLS_EXTENSION
,

45 
SCT_SOURCE_X509V3_EXTENSION
,

46 
SCT_SOURCE_OCSP_STAPLED_RESPONSE


47 } 
	ts˘_sour˚_t
;

50 
SCT_VALIDATION_STATUS_NOT_SET
,

51 
SCT_VALIDATION_STATUS_UNKNOWN_LOG
,

52 
SCT_VALIDATION_STATUS_VALID
,

53 
SCT_VALIDATION_STATUS_INVALID
,

54 
SCT_VALIDATION_STATUS_UNVERIFIED
,

55 
SCT_VALIDATION_STATUS_UNKNOWN_VERSION


56 } 
	ts˘_vÆid©i⁄_°©us_t
;

58 
DEFINE_STACK_OF
(
SCT
)

59 
DEFINE_STACK_OF
(
CTLOG
)

70 
CT_POLICY_EVAL_CTX
 *
CT_POLICY_EVAL_CTX_√w
();

73 
CT_POLICY_EVAL_CTX_‰ì
(
CT_POLICY_EVAL_CTX
 *
˘x
);

76 
X509
* 
CT_POLICY_EVAL_CTX_gë0_˚π
(c⁄° 
CT_POLICY_EVAL_CTX
 *
˘x
);

83 
CT_POLICY_EVAL_CTX_£t1_˚π
(
CT_POLICY_EVAL_CTX
 *
˘x
, 
X509
 *
˚π
);

86 
X509
* 
CT_POLICY_EVAL_CTX_gë0_issuî
(c⁄° 
CT_POLICY_EVAL_CTX
 *
˘x
);

93 
CT_POLICY_EVAL_CTX_£t1_issuî
(
CT_POLICY_EVAL_CTX
 *
˘x
, 
X509
 *
issuî
);

96 c⁄° 
CTLOG_STORE
 *
CT_POLICY_EVAL_CTX_gë0_log_°‹e
(c⁄° 
CT_POLICY_EVAL_CTX
 *
˘x
);

99 
CT_POLICY_EVAL_CTX_£t_sh¨ed_CTLOG_STORE
(
CT_POLICY_EVAL_CTX
 *
˘x
,

100 
CTLOG_STORE
 *
log_°‹e
);

107 
uöt64_t
 
CT_POLICY_EVAL_CTX_gë_time
(c⁄° 
CT_POLICY_EVAL_CTX
 *
˘x
);

115 
CT_POLICY_EVAL_CTX_£t_time
(
CT_POLICY_EVAL_CTX
 *
˘x
, 
uöt64_t
 
time_ö_ms
);

125 
SCT
 *
SCT_√w
();

131 
SCT
 *
SCT_√w_‰om_ba£64
(
vîsi⁄
,

132 c⁄° *
logid_ba£64
,

133 
˘_log_íåy_ty≥_t
 
íåy_ty≥
,

134 
uöt64_t
 
time°amp
,

135 c⁄° *
exãnsi⁄s_ba£64
,

136 c⁄° *
sig«tuª_ba£64
);

141 
SCT_‰ì
(
SCT
 *
s˘
);

147 
SCT_LIST_‰ì
(
STACK_OF
(
SCT
Ë*
a
);

152 
s˘_vîsi⁄_t
 
SCT_gë_vîsi⁄
(c⁄° 
SCT
 *
s˘
);

158 
__owur
 
SCT_£t_vîsi⁄
(
SCT
 *
s˘
, 
s˘_vîsi⁄_t
 
vîsi⁄
);

163 
˘_log_íåy_ty≥_t
 
SCT_gë_log_íåy_ty≥
(c⁄° 
SCT
 *
s˘
);

169 
__owur
 
SCT_£t_log_íåy_ty≥
(
SCT
 *
s˘
, 
˘_log_íåy_ty≥_t
 
íåy_ty≥
);

176 
size_t
 
SCT_gë0_log_id
(c⁄° 
SCT
 *
s˘
, **
log_id
);

183 
__owur
 
SCT_£t0_log_id
(
SCT
 *
s˘
, *
log_id
, 
size_t
 
log_id_Àn
);

190 
__owur
 
SCT_£t1_log_id
(
SCT
 *
s˘
, c⁄° *
log_id
,

191 
size_t
 
log_id_Àn
);

196 
uöt64_t
 
SCT_gë_time°amp
(c⁄° 
SCT
 *
s˘
);

201 
SCT_£t_time°amp
(
SCT
 *
s˘
, 
uöt64_t
 
time°amp
);

208 
SCT_gë_sig«tuª_nid
(c⁄° 
SCT
 *
s˘
);

216 
__owur
 
SCT_£t_sig«tuª_nid
(
SCT
 *
s˘
, 
nid
);

223 
size_t
 
SCT_gë0_exãnsi⁄s
(c⁄° 
SCT
 *
s˘
, **
ext
);

229 
SCT_£t0_exãnsi⁄s
(
SCT
 *
s˘
, *
ext
, 
size_t
 
ext_Àn
);

236 
__owur
 
SCT_£t1_exãnsi⁄s
(
SCT
 *
s˘
, c⁄° *
ext
,

237 
size_t
 
ext_Àn
);

244 
size_t
 
SCT_gë0_sig«tuª
(c⁄° 
SCT
 *
s˘
, **
sig
);

250 
SCT_£t0_sig«tuª
(
SCT
 *
s˘
, *
sig
, 
size_t
 
sig_Àn
);

256 
__owur
 
SCT_£t1_sig«tuª
(
SCT
 *
s˘
, c⁄° *
sig
,

257 
size_t
 
sig_Àn
);

262 
s˘_sour˚_t
 
SCT_gë_sour˚
(c⁄° 
SCT
 *
s˘
);

268 
__owur
 
SCT_£t_sour˚
(
SCT
 *
s˘
, 
s˘_sour˚_t
 
sour˚
);

273 c⁄° *
SCT_vÆid©i⁄_°©us_°rög
(c⁄° 
SCT
 *
s˘
);

281 
SCT_¥öt
(c⁄° 
SCT
 *
s˘
, 
BIO
 *
out
, 
ödít
, c⁄° 
CTLOG_STORE
 *
logs
);

290 
SCT_LIST_¥öt
(c⁄° 
STACK_OF
(
SCT
Ë*
s˘_li°
, 
BIO
 *
out
, 
ödít
,

291 c⁄° *
£∑øt‹
, c⁄° 
CTLOG_STORE
 *
logs
);

297 
s˘_vÆid©i⁄_°©us_t
 
SCT_gë_vÆid©i⁄_°©us
(c⁄° 
SCT
 *
s˘
);

306 
__owur
 
SCT_vÆid©e
(
SCT
 *
s˘
, c⁄° 
CT_POLICY_EVAL_CTX
 *
˘x
);

315 
__owur
 
SCT_LIST_vÆid©e
(c⁄° 
STACK_OF
(
SCT
Ë*
s˘s
,

316 
CT_POLICY_EVAL_CTX
 *
˘x
);

335 
__owur
 
i2o_SCT_LIST
(c⁄° 
STACK_OF
(
SCT
Ë*
a
, **
µ
);

347 
STACK_OF
(
SCT
Ë*
o2i_SCT_LIST
(STACK_OF(SCTË**
a
, c⁄° **
µ
,

348 
size_t
 
Àn
);

362 
__owur
 
i2d_SCT_LIST
(c⁄° 
STACK_OF
(
SCT
Ë*
a
, **
µ
);

374 
STACK_OF
(
SCT
Ë*
d2i_SCT_LIST
(STACK_OF(SCTË**
a
, c⁄° **
µ
,

375 
Àn
);

386 
__owur
 
i2o_SCT
(c⁄° 
SCT
 *
s˘
, **
out
);

399 
SCT
 *
o2i_SCT
(SCT **
ps˘
, c⁄° **
ö
, 
size_t
 
Àn
);

411 
CTLOG
 *
CTLOG_√w
(
EVP_PKEY
 *
public_key
, c⁄° *
«me
);

419 
CTLOG_√w_‰om_ba£64
(
CTLOG
 ** 
˘_log
,

420 c⁄° *
pkey_ba£64
, c⁄° *
«me
);

425 
CTLOG_‰ì
(
CTLOG
 *
log
);

428 c⁄° *
CTLOG_gë0_«me
(c⁄° 
CTLOG
 *
log
);

430 
CTLOG_gë0_log_id
(c⁄° 
CTLOG
 *
log
, c⁄° 
uöt8_t
 **
log_id
,

431 
size_t
 *
log_id_Àn
);

433 
EVP_PKEY
 *
CTLOG_gë0_public_key
(c⁄° 
CTLOG
 *
log
);

443 
CTLOG_STORE
 *
CTLOG_STORE_√w
();

448 
CTLOG_STORE_‰ì
(
CTLOG_STORE
 *
°‹e
);

454 c⁄° 
CTLOG
 *
CTLOG_STORE_gë0_log_by_id
(c⁄° 
CTLOG_STORE
 *
°‹e
,

455 c⁄° 
uöt8_t
 *
log_id
,

456 
size_t
 
log_id_Àn
);

462 
__owur
 
CTLOG_STORE_lﬂd_fûe
(
CTLOG_STORE
 *
°‹e
, c⁄° *
fûe
);

470 
__owur
 
CTLOG_STORE_lﬂd_deÁu…_fûe
(
CTLOG_STORE
 *
°‹e
);

472 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/dtls1.h

10 #i‚de‡
HEADER_DTLS1_H


11 
	#HEADER_DTLS1_H


	)

13 #ifde‡ 
__˝lu•lus


17 
	#DTLS1_VERSION
 0xFEFF

	)

18 
	#DTLS1_2_VERSION
 0xFEFD

	)

19 
	#DTLS_MIN_VERSION
 
DTLS1_VERSION


	)

20 
	#DTLS_MAX_VERSION
 
DTLS1_2_VERSION


	)

21 
	#DTLS1_VERSION_MAJOR
 0xFE

	)

23 
	#DTLS1_BAD_VER
 0x0100

	)

26 
	#DTLS_ANY_VERSION
 0x1FFFF

	)

33 
	#DTLS1_COOKIE_LENGTH
 256

	)

35 
	#DTLS1_RT_HEADER_LENGTH
 13

	)

37 
	#DTLS1_HM_HEADER_LENGTH
 12

	)

39 
	#DTLS1_HM_BAD_FRAGMENT
 -2

	)

40 
	#DTLS1_HM_FRAGMENT_RETRY
 -3

	)

42 
	#DTLS1_CCS_HEADER_LENGTH
 1

	)

44 
	#DTLS1_AL_HEADER_LENGTH
 2

	)

47 
	#DTLS1_TMO_READ_COUNT
 2

	)

48 
	#DTLS1_TMO_WRITE_COUNT
 2

	)

50 
	#DTLS1_TMO_ALERT_COUNT
 12

	)

52 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/e_os2.h

10 #i‚de‡
HEADER_E_OS2_H


11 
	#HEADER_E_OS2_H


	)

13 
	~<›ís¶/›ís¶c⁄f.h
>

15 #ifde‡ 
__˝lu•lus


25 
	#OPENSSL_SYS_UNIX


	)

33 #i‡
deföed
(
OPENSSL_SYS_MSDOS
)

34 #unde‡
OPENSSL_SYS_UNIX


45 #i‡
deföed
(
OPENSSL_SYS_UEFI
)

46 #unde‡
OPENSSL_SYS_UNIX


47 #ñi‡
deföed
(
OPENSSL_SYS_UWIN
)

48 #unde‡
OPENSSL_SYS_UNIX


49 
	#OPENSSL_SYS_WIN32_UWIN


	)

51 #i‡
deföed
(
__CYGWIN__
Ë|| deföed(
OPENSSL_SYS_CYGWIN
)

52 
	#OPENSSL_SYS_WIN32_CYGWIN


	)

54 #i‡
deföed
(
_WIN32
Ë|| deföed(
OPENSSL_SYS_WIN32
)

55 #unde‡
OPENSSL_SYS_UNIX


56 #i‡!
deföed
(
OPENSSL_SYS_WIN32
)

57 
	#OPENSSL_SYS_WIN32


	)

60 #i‡
deföed
(
_WIN64
Ë|| deföed(
OPENSSL_SYS_WIN64
)

61 #unde‡
OPENSSL_SYS_UNIX


62 #i‡!
deföed
(
OPENSSL_SYS_WIN64
)

63 
	#OPENSSL_SYS_WIN64


	)

66 #i‡
deföed
(
OPENSSL_SYS_WINNT
)

67 #unde‡
OPENSSL_SYS_UNIX


69 #i‡
deföed
(
OPENSSL_SYS_WINCE
)

70 #unde‡
OPENSSL_SYS_UNIX


76 #i‡
deföed
(
OPENSSL_SYS_WIN32
Ë|| deföed(
OPENSSL_SYS_WIN64
Ë|| deföed(
OPENSSL_SYS_WINNT
Ë|| deföed(
OPENSSL_SYS_WINCE
)

77 #unde‡
OPENSSL_SYS_UNIX


78 
	#OPENSSL_SYS_WINDOWS


	)

79 #i‚de‡
OPENSSL_SYS_MSDOS


80 
	#OPENSSL_SYS_MSDOS


	)

89 #ifde‡
OPENSSL_SYS_WINDOWS


90 #i‚de‡
OPENSSL_OPT_WINDLL


91 #i‡
deföed
(
_WINDLL
)

93 
	#OPENSSL_OPT_WINDLL


	)

99 #i‡
deföed
(
__VMS
Ë|| deföed(
VMS
Ë|| deföed(
OPENSSL_SYS_VMS
)

100 #i‡!
deföed
(
OPENSSL_SYS_VMS
)

101 #unde‡
OPENSSL_SYS_UNIX


103 
	#OPENSSL_SYS_VMS


	)

104 #i‡
deföed
(
__DECC
)

105 
	#OPENSSL_SYS_VMS_DECC


	)

106 #ñi‡
deföed
(
__DECCXX
)

107 
	#OPENSSL_SYS_VMS_DECC


	)

108 
	#OPENSSL_SYS_VMS_DECCXX


	)

110 
	#OPENSSL_SYS_VMS_NODECC


	)

115 #ifde‡
OPENSSL_SYS_UNIX


116 #i‡
deföed
(
löux
Ë|| deföed(
__löux__
Ë&& !deföed(
OPENSSL_SYS_LINUX
)

117 
	#OPENSSL_SYS_LINUX


	)

119 #i‡
deföed
(
_AIX
Ë&& !deföed(
OPENSSL_SYS_AIX
)

120 
	#OPENSSL_SYS_AIX


	)

125 #i‡
deföed
(
__VOS__
Ë&& !deföed(
OPENSSL_SYS_VOS
)

126 
	#OPENSSL_SYS_VOS


	)

127 #ifde‡
__HPPA__


128 
	#OPENSSL_SYS_VOS_HPPA


	)

130 #ifde‡
__IA32__


131 
	#OPENSSL_SYS_VOS_IA32


	)

140 #ifde‡
OPENSSL_SYS_MSDOS


141 
	#OPENSSL_UNISTD_IO
 <
io
.
h
>

	)

142 
	#OPENSSL_DECLARE_EXIT
 
	`exô
();

	)

144 
	#OPENSSL_UNISTD_IO
 
OPENSSL_UNISTD


	)

145 
	#OPENSSL_DECLARE_EXIT


	)

167 #i‡
deföed
(
OPENSSL_SYS_WINDOWS
Ë&& deföed(
OPENSSL_OPT_WINDLL
)

168 
	#OPENSSL_EXPORT
 
	`__de˛•ec
(
dŒexp‹t
)

	)

169 
	#OPENSSL_EXTERN
 
	`__de˛•ec
(
dŒimp‹t
)

	)

171 
	#OPENSSL_EXPORT
 

	)

172 
	#OPENSSL_EXTERN
 

	)

186 #ifde‡
OPENSSL_EXPORT_VAR_AS_FUNCTION


187 
	#OPENSSL_IMPLEMENT_GLOBAL
(
ty≥
,
«me
,
vÆue
) \

188 
ty≥
 *
_shadow_
##
	`«me
() \

189 { 
ty≥
 
_hide_
##
«me
=
vÆue
;  &_hide_##«me; }

	)

190 
	#OPENSSL_DECLARE_GLOBAL
(
ty≥
,
«me
Ëty≥ *
_shadow_
##
	`«me
()

	)

191 
	#OPENSSL_GLOBAL_REF
(
«me
Ë(*(
_shadow_
##
	`«me
()))

	)

193 
	#OPENSSL_IMPLEMENT_GLOBAL
(
ty≥
,
«me
,
vÆue
Ëty≥ 
_shadow_
##«me=vÆue;

	)

194 
	#OPENSSL_DECLARE_GLOBAL
(
ty≥
,
«me
Ë
OPENSSL_EXPORT
Åy≥ 
_shadow_
##
	)
name

195 
	#OPENSSL_GLOBAL_REF
(
«me
Ë
_shadow_
##
	)
name

198 #ifde‡
_WIN32


199 #ifde‡
_WIN64


200 
	#os¶_ssize_t
 
__öt64


	)

201 
	#OSSL_SSIZE_MAX
 
_I64_MAX


	)

203 
	#os¶_ssize_t
 

	)

204 
	#OSSL_SSIZE_MAX
 
INT_MAX


	)

208 #i‡
deföed
(
OPENSSL_SYS_UEFI
Ë&& !deföed(
os¶_ssize_t
)

209 
	#os¶_ssize_t
 
INTN


	)

210 
	#OSSL_SSIZE_MAX
 
MAX_INTN


	)

213 #i‚de‡
os¶_ssize_t


214 
	#os¶_ssize_t
 
ssize_t


	)

215 #i‡
deföed
(
SSIZE_MAX
)

216 
	#OSSL_SSIZE_MAX
 
SSIZE_MAX


	)

217 #ñi‡
deföed
(
_POSIX_SSIZE_MAX
)

218 
	#OSSL_SSIZE_MAX
 
_POSIX_SSIZE_MAX


	)

220 
	#OSSL_SSIZE_MAX
 ((
ssize_t
)(
SIZE_MAX
>>1))

	)

224 #ifde‡
DEBUG_UNUSED


225 
	#__owur
 
	`__©åibuã__
((
__w¨n_unu£d_ªsu…__
))

	)

227 
	#__owur


	)

231 #i‡
deföed
(
OPENSSL_SYS_UEFI
)

232 
INT8
 
	töt8_t
;

233 
UINT8
 
	tuöt8_t
;

234 
INT16
 
	töt16_t
;

235 
UINT16
 
	tuöt16_t
;

236 
INT32
 
	töt32_t
;

237 
UINT32
 
	tuöt32_t
;

238 
INT64
 
	töt64_t
;

239 
UINT64
 
	tuöt64_t
;

240 #ñi‡(
deföed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L) || \

241 
deföed
(
__osf__
Ë|| deföed(
__sgi
Ë|| deföed(
__hpux
) || \

242 
deföed
(
OPENSSL_SYS_VMS
Ë|| deföed (
__O≥nBSD__
)

243 
	~<öây≥s.h
>

244 #ñi‡
deföed
(
_MSC_VER
) && _MSC_VER<=1500

249 sig√d 
	töt8_t
;

250 
	tuöt8_t
;

251 
	töt16_t
;

252 
	tuöt16_t
;

253 
	töt32_t
;

254 
	tuöt32_t
;

255 
__öt64
 
	töt64_t
;

256 
	t__öt64
 
	tuöt64_t
;

258 
	~<°döt.h
>

262 #i‡!
deföed
(
ölöe
Ë&& !deföed(
__˝lu•lus
)

263 #i‡
deföed
(
__STDC_VERSION__
) && __STDC_VERSION__>=199901L

265 
	#os¶_ölöe
 
ölöe


	)

266 #ñi‡
deföed
(
__GNUC__
) && __GNUC__>=2

267 
	#os¶_ölöe
 
__ölöe__


	)

268 #ñi‡
deföed
(
_MSC_VER
)

274 
	#os¶_ölöe
 
__ölöe


	)

276 
	#os¶_ölöe


	)

279 
	#os¶_ölöe
 
ölöe


	)

282 #i‡
deföed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 201112L

283 
	#os¶_n‹ëu∫
 
_N‹ëu∫


	)

284 #ñi‡
deföed
(
__GNUC__
) && __GNUC__ >= 2

285 
	#os¶_n‹ëu∫
 
	`__©åibuã__
((
n‹ëu∫
))

	)

287 
	#os¶_n‹ëu∫


	)

291 #i‡
deföed
(
__GNUC__
)

292 
	#os¶_unu£d
 
	`__©åibuã__
((
unu£d
))

	)

294 
	#os¶_unu£d


	)

297 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/hmac.h

10 #i‚de‡
HEADER_HMAC_H


11 
	#HEADER_HMAC_H


	)

13 
	~<›ís¶/›ís¶c⁄f.h
>

15 
	~<›ís¶/evp.h
>

17 #i‡
OPENSSL_API_COMPAT
 < 0x10200000L

18 
	#HMAC_MAX_MD_CBLOCK
 128

	)

21 #ifde‡ 
__˝lu•lus


25 
size_t
 
HMAC_size
(c⁄° 
HMAC_CTX
 *
e
);

26 
HMAC_CTX
 *
HMAC_CTX_√w
();

27 
HMAC_CTX_ª£t
(
HMAC_CTX
 *
˘x
);

28 
HMAC_CTX_‰ì
(
HMAC_CTX
 *
˘x
);

30 
DEPRECATEDIN_1_1_0
(
__owur
 
HMAC_Inô
(
HMAC_CTX
 *
˘x
, c⁄° *
key
, 
Àn
,

31 c⁄° 
EVP_MD
 *
md
))

33  
HMAC_Inô_ex
(
HMAC_CTX
 *
˘x
, c⁄° *
key
, 
Àn
,

34 c⁄° 
EVP_MD
 *
md
, 
ENGINE
 *
im∂
);

35  
HMAC_Upd©e
(
HMAC_CTX
 *
˘x
, c⁄° *
d©a
,

36 
size_t
 
Àn
);

37  
HMAC_FöÆ
(
HMAC_CTX
 *
˘x
, *
md
,

38 *
Àn
);

39 *
HMAC
(c⁄° 
EVP_MD
 *
evp_md
, c⁄° *
key
, 
key_Àn
,

40 c⁄° *
d
, 
size_t
 
n
, *
md
,

41 *
md_Àn
);

42 
__owur
 
HMAC_CTX_c›y
(
HMAC_CTX
 *
d˘x
, HMAC_CTX *
s˘x
);

44 
HMAC_CTX_£t_Êags
(
HMAC_CTX
 *
˘x
, 
Êags
);

45 c⁄° 
EVP_MD
 *
HMAC_CTX_gë_md
(c⁄° 
HMAC_CTX
 *
˘x
);

47 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/lhash.h

14 #i‚de‡
HEADER_LHASH_H


15 
	#HEADER_LHASH_H


	)

17 
	~<›ís¶/e_os2.h
>

18 
	~<›ís¶/bio.h
>

20 #ifde‡ 
__˝lu•lus


24 
lhash_node_°
 
	tOPENSSL_LH_NODE
;

25 (*
OPENSSL_LH_COMPFUNC
) (const *, const *);

26 (*
	tOPENSSL_LH_HASHFUNC
) (const *);

27 (*
OPENSSL_LH_DOALL_FUNC
) (*);

28 (*
OPENSSL_LH_DOALL_FUNCARG
) (*, *);

29 
lhash_°
 
	tOPENSSL_LHASH
;

41 
	#DECLARE_LHASH_HASH_FN
(
«me
, 
o_ty≥
) \

42 
«me
##
	`_LHASH_HASH
(c⁄° *);

	)

43 
	#IMPLEMENT_LHASH_HASH_FN
(
«me
, 
o_ty≥
) \

44 
«me
##
	`_LHASH_HASH
(c⁄° *
¨g
) { \

45 c⁄° 
o_ty≥
 *
a
 = 
¨g
; \

46  
«me
##
	`_hash
(
a
); }

	)

47 
	#LHASH_HASH_FN
(
«me
Ë«me##
_LHASH_HASH


	)

50 
	#DECLARE_LHASH_COMP_FN
(
«me
, 
o_ty≥
) \

51 
«me
##
	`_LHASH_COMP
(c⁄° *, c⁄° *);

	)

52 
	#IMPLEMENT_LHASH_COMP_FN
(
«me
, 
o_ty≥
) \

53 
«me
##
	`_LHASH_COMP
(c⁄° *
¨g1
, c⁄° *
¨g2
) { \

54 c⁄° 
o_ty≥
 *
a
 = 
¨g1
; \

55 c⁄° 
o_ty≥
 *
b
 = 
¨g2
; \

56  
«me
##
	`_cmp
(
a
,
b
); }

	)

57 
	#LHASH_COMP_FN
(
«me
Ë«me##
_LHASH_COMP


	)

60 
	#DECLARE_LHASH_DOALL_ARG_FN
(
«me
, 
o_ty≥
, 
a_ty≥
) \

61 
«me
##
	`_LHASH_DOALL_ARG
(*, *);

	)

62 
	#IMPLEMENT_LHASH_DOALL_ARG_FN
(
«me
, 
o_ty≥
, 
a_ty≥
) \

63 
«me
##
	`_LHASH_DOALL_ARG
(*
¨g1
, *
¨g2
) { \

64 
o_ty≥
 *
a
 = 
¨g1
; \

65 
a_ty≥
 *
b
 = 
¨g2
; \

66 
«me
##
	`_dﬂŒ_¨g
(
a
, 
b
); }

	)

67 
	#LHASH_DOALL_ARG_FN
(
«me
Ë«me##
_LHASH_DOALL_ARG


	)

70 
	#LH_LOAD_MULT
 256

	)

72 
OPENSSL_LH_îr‹
(
OPENSSL_LHASH
 *
lh
);

73 
OPENSSL_LHASH
 *
OPENSSL_LH_√w
(
OPENSSL_LH_HASHFUNC
 
h
, 
OPENSSL_LH_COMPFUNC
 
c
);

74 
OPENSSL_LH_‰ì
(
OPENSSL_LHASH
 *
lh
);

75 *
OPENSSL_LH_ö£π
(
OPENSSL_LHASH
 *
lh
, *
d©a
);

76 *
OPENSSL_LH_dñëe
(
OPENSSL_LHASH
 *
lh
, c⁄° *
d©a
);

77 *
OPENSSL_LH_ªåõve
(
OPENSSL_LHASH
 *
lh
, c⁄° *
d©a
);

78 
OPENSSL_LH_dﬂŒ
(
OPENSSL_LHASH
 *
lh
, 
OPENSSL_LH_DOALL_FUNC
 
func
);

79 
OPENSSL_LH_dﬂŒ_¨g
(
OPENSSL_LHASH
 *
lh
, 
OPENSSL_LH_DOALL_FUNCARG
 
func
, *
¨g
);

80 
OPENSSL_LH_°rhash
(c⁄° *
c
);

81 
OPENSSL_LH_num_ôems
(c⁄° 
OPENSSL_LHASH
 *
lh
);

82 
OPENSSL_LH_gë_down_lﬂd
(c⁄° 
OPENSSL_LHASH
 *
lh
);

83 
OPENSSL_LH_£t_down_lﬂd
(
OPENSSL_LHASH
 *
lh
, 
down_lﬂd
);

85 #i‚de‡
OPENSSL_NO_STDIO


86 
OPENSSL_LH_°©s
(c⁄° 
OPENSSL_LHASH
 *
lh
, 
FILE
 *
Â
);

87 
OPENSSL_LH_node_°©s
(c⁄° 
OPENSSL_LHASH
 *
lh
, 
FILE
 *
Â
);

88 
OPENSSL_LH_node_ußge_°©s
(c⁄° 
OPENSSL_LHASH
 *
lh
, 
FILE
 *
Â
);

90 
OPENSSL_LH_°©s_bio
(c⁄° 
OPENSSL_LHASH
 *
lh
, 
BIO
 *
out
);

91 
OPENSSL_LH_node_°©s_bio
(c⁄° 
OPENSSL_LHASH
 *
lh
, 
BIO
 *
out
);

92 
OPENSSL_LH_node_ußge_°©s_bio
(c⁄° 
OPENSSL_LHASH
 *
lh
, 
BIO
 *
out
);

94 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

95 
	#_LHASH
 
OPENSSL_LHASH


	)

96 
	#LHASH_NODE
 
OPENSSL_LH_NODE


	)

97 
	#lh_îr‹
 
OPENSSL_LH_îr‹


	)

98 
	#lh_√w
 
OPENSSL_LH_√w


	)

99 
	#lh_‰ì
 
OPENSSL_LH_‰ì


	)

100 
	#lh_ö£π
 
OPENSSL_LH_ö£π


	)

101 
	#lh_dñëe
 
OPENSSL_LH_dñëe


	)

102 
	#lh_ªåõve
 
OPENSSL_LH_ªåõve


	)

103 
	#lh_dﬂŒ
 
OPENSSL_LH_dﬂŒ


	)

104 
	#lh_dﬂŒ_¨g
 
OPENSSL_LH_dﬂŒ_¨g


	)

105 
	#lh_°rhash
 
OPENSSL_LH_°rhash


	)

106 
	#lh_num_ôems
 
OPENSSL_LH_num_ôems


	)

107 #i‚de‡
OPENSSL_NO_STDIO


108 
	#lh_°©s
 
OPENSSL_LH_°©s


	)

109 
	#lh_node_°©s
 
OPENSSL_LH_node_°©s


	)

110 
	#lh_node_ußge_°©s
 
OPENSSL_LH_node_ußge_°©s


	)

112 
	#lh_°©s_bio
 
OPENSSL_LH_°©s_bio


	)

113 
	#lh_node_°©s_bio
 
OPENSSL_LH_node_°©s_bio


	)

114 
	#lh_node_ußge_°©s_bio
 
OPENSSL_LH_node_ußge_°©s_bio


	)

119 
	#LHASH_OF
(
ty≥
Ë
lhash_°_
##
	)
type

121 
	#DEFINE_LHASH_OF
(
ty≥
) \

122 
	`LHASH_OF
(
ty≥
Ë{ 
lh_
##ty≥##
_dummy
 { * 
d1
; 
d2
; 
d3
; } 
dummy
; }; \

123 
os¶_ölöe
 
	`LHASH_OF
(
ty≥
) * \

124 
lh_
##
ty≥
##
	`_√w
((*
h‚
)(constÅype *), \

125 (*
c‚
)(c⁄° 
ty≥
 *, constÅype *)) \

127  (
	`LHASH_OF
(
ty≥
) *) \

128 
	`OPENSSL_LH_√w
((
OPENSSL_LH_HASHFUNC
)
h‚
, (
OPENSSL_LH_COMPFUNC
)
c‚
); \

130 
os¶_unu£d
 
os¶_ölöe
 
lh_
##
ty≥
##
	`_‰ì
(
	`LHASH_OF
—y≥Ë*
lh
) \

132 
	`OPENSSL_LH_‰ì
((
OPENSSL_LHASH
 *)
lh
); \

134 
os¶_unu£d
 
os¶_ölöe
 
ty≥
 *
lh_
##ty≥##
	`_ö£π
(
	`LHASH_OF
—y≥Ë*
lh
,Åy≥ *
d
) \

136  (
ty≥
 *)
	`OPENSSL_LH_ö£π
((
OPENSSL_LHASH
 *)
lh
, 
d
); \

138 
os¶_unu£d
 
os¶_ölöe
 
ty≥
 *
lh_
##ty≥##
	`_dñëe
(
	`LHASH_OF
—y≥Ë*
lh
, c⁄°Åy≥ *
d
) \

140  (
ty≥
 *)
	`OPENSSL_LH_dñëe
((
OPENSSL_LHASH
 *)
lh
, 
d
); \

142 
os¶_unu£d
 
os¶_ölöe
 
ty≥
 *
lh_
##ty≥##
	`_ªåõve
(
	`LHASH_OF
—y≥Ë*
lh
, c⁄°Åy≥ *
d
) \

144  (
ty≥
 *)
	`OPENSSL_LH_ªåõve
((
OPENSSL_LHASH
 *)
lh
, 
d
); \

146 
os¶_unu£d
 
os¶_ölöe
 
lh_
##
ty≥
##
	`_îr‹
(
	`LHASH_OF
—y≥Ë*
lh
) \

148  
	`OPENSSL_LH_îr‹
((
OPENSSL_LHASH
 *)
lh
); \

150 
os¶_unu£d
 
os¶_ölöe
 
lh_
##
ty≥
##
	`_num_ôems
(
	`LHASH_OF
—y≥Ë*
lh
) \

152  
	`OPENSSL_LH_num_ôems
((
OPENSSL_LHASH
 *)
lh
); \

154 
os¶_unu£d
 
os¶_ölöe
 
lh_
##
ty≥
##
	`_node_°©s_bio
(c⁄° 
	`LHASH_OF
—y≥Ë*
lh
, 
BIO
 *
out
) \

156 
	`OPENSSL_LH_node_°©s_bio
((c⁄° 
OPENSSL_LHASH
 *)
lh
, 
out
); \

158 
os¶_unu£d
 
os¶_ölöe
 
lh_
##
ty≥
##
	`_node_ußge_°©s_bio
(c⁄° 
	`LHASH_OF
—y≥Ë*
lh
, 
BIO
 *
out
) \

160 
	`OPENSSL_LH_node_ußge_°©s_bio
((c⁄° 
OPENSSL_LHASH
 *)
lh
, 
out
); \

162 
os¶_unu£d
 
os¶_ölöe
 
lh_
##
ty≥
##
	`_°©s_bio
(c⁄° 
	`LHASH_OF
—y≥Ë*
lh
, 
BIO
 *
out
) \

164 
	`OPENSSL_LH_°©s_bio
((c⁄° 
OPENSSL_LHASH
 *)
lh
, 
out
); \

166 
os¶_unu£d
 
os¶_ölöe
 
lh_
##
ty≥
##
	`_gë_down_lﬂd
(
	`LHASH_OF
—y≥Ë*
lh
) \

168  
	`OPENSSL_LH_gë_down_lﬂd
((
OPENSSL_LHASH
 *)
lh
); \

170 
os¶_unu£d
 
os¶_ölöe
 
lh_
##
ty≥
##
	`_£t_down_lﬂd
(
	`LHASH_OF
—y≥Ë*
lh
, 
dl
) \

172 
	`OPENSSL_LH_£t_down_lﬂd
((
OPENSSL_LHASH
 *)
lh
, 
dl
); \

174 
os¶_unu£d
 
os¶_ölöe
 
lh_
##
ty≥
##
	`_dﬂŒ
(
	`LHASH_OF
—y≥Ë*
lh
, \

175 (*
dﬂŒ
)(
ty≥
 *)) \

177 
	`OPENSSL_LH_dﬂŒ
((
OPENSSL_LHASH
 *)
lh
, (
OPENSSL_LH_DOALL_FUNC
)
dﬂŒ
); \

179 
	`LHASH_OF
(
ty≥
)

	)

181 
	#IMPLEMENT_LHASH_DOALL_ARG_CONST
(
ty≥
, 
¨gty≥
) \

182 
	`öt_im∂emít_lhash_dﬂŒ
(
ty≥
, 
¨gty≥
, c⁄°Åy≥)

	)

184 
	#IMPLEMENT_LHASH_DOALL_ARG
(
ty≥
, 
¨gty≥
) \

185 
	`öt_im∂emít_lhash_dﬂŒ
(
ty≥
, 
¨gty≥
,Åy≥)

	)

187 
	#öt_im∂emít_lhash_dﬂŒ
(
ty≥
, 
¨gty≥
, 
cb¨gty≥
) \

188 
os¶_unu£d
 
os¶_ölöe
 \

189 
lh_
##
ty≥
##
_dﬂŒ_
##
	`¨gty≥
(
	`LHASH_OF
—y≥Ë*
lh
, \

190 (*
‚
)(
cb¨gty≥
 *, 
¨gty≥
 *), \

191 
¨gty≥
 *
¨g
) \

193 
	`OPENSSL_LH_dﬂŒ_¨g
((
OPENSSL_LHASH
 *)
lh
, (
OPENSSL_LH_DOALL_FUNCARG
)
‚
, (*)
¨g
); \

195 
	`LHASH_OF
(
ty≥
)

	)

197 
DEFINE_LHASH_OF
(
OPENSSL_STRING
);

198 #ifde‡
_MSC_VER


203 #¥agm®
w¨nög
 (
push
)

204 #¥agm®
w¨nög
 (
dißbÀ
: 4090)

207 
DEFINE_LHASH_OF
(
OPENSSL_CSTRING
);

209 #ifde‡
_MSC_VER


210 #¥agm®
w¨nög
 (
p›
)

221 #ifde‡
__SUNPRO_C


222 #¥agm®
wók
 
OPENSSL_LH_√w


223 #¥agm®
wók
 
OPENSSL_LH_‰ì


224 #¥agm®
wók
 
OPENSSL_LH_ö£π


225 #¥agm®
wók
 
OPENSSL_LH_dñëe


226 #¥agm®
wók
 
OPENSSL_LH_ªåõve


227 #¥agm®
wók
 
OPENSSL_LH_îr‹


228 #¥agm®
wók
 
OPENSSL_LH_num_ôems


229 #¥agm®
wók
 
OPENSSL_LH_node_°©s_bio


230 #¥agm®
wók
 
OPENSSL_LH_node_ußge_°©s_bio


231 #¥agm®
wók
 
OPENSSL_LH_°©s_bio


232 #¥agm®
wók
 
OPENSSL_LH_gë_down_lﬂd


233 #¥agm®
wók
 
OPENSSL_LH_£t_down_lﬂd


234 #¥agm®
wók
 
OPENSSL_LH_dﬂŒ


235 #¥agm®
wók
 
OPENSSL_LH_dﬂŒ_¨g


238 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/ossl_typ.h

10 #i‚de‡
HEADER_OPENSSL_TYPES_H


11 
	#HEADER_OPENSSL_TYPES_H


	)

13 
	~<limôs.h
>

15 #ifde‡ 
__˝lu•lus


19 
	~<›ís¶/e_os2.h
>

21 #ifde‡
NO_ASN1_TYPEDEFS


22 
	#ASN1_INTEGER
 
ASN1_STRING


	)

23 
	#ASN1_ENUMERATED
 
ASN1_STRING


	)

24 
	#ASN1_BIT_STRING
 
ASN1_STRING


	)

25 
	#ASN1_OCTET_STRING
 
ASN1_STRING


	)

26 
	#ASN1_PRINTABLESTRING
 
ASN1_STRING


	)

27 
	#ASN1_T61STRING
 
ASN1_STRING


	)

28 
	#ASN1_IA5STRING
 
ASN1_STRING


	)

29 
	#ASN1_UTCTIME
 
ASN1_STRING


	)

30 
	#ASN1_GENERALIZEDTIME
 
ASN1_STRING


	)

31 
	#ASN1_TIME
 
ASN1_STRING


	)

32 
	#ASN1_GENERALSTRING
 
ASN1_STRING


	)

33 
	#ASN1_UNIVERSALSTRING
 
ASN1_STRING


	)

34 
	#ASN1_BMPSTRING
 
ASN1_STRING


	)

35 
	#ASN1_VISIBLESTRING
 
ASN1_STRING


	)

36 
	#ASN1_UTF8STRING
 
ASN1_STRING


	)

37 
	#ASN1_BOOLEAN
 

	)

38 
	#ASN1_NULL
 

	)

40 
a¢1_°rög_°
 
	tASN1_INTEGER
;

41 
a¢1_°rög_°
 
	tASN1_ENUMERATED
;

42 
a¢1_°rög_°
 
	tASN1_BIT_STRING
;

43 
a¢1_°rög_°
 
	tASN1_OCTET_STRING
;

44 
a¢1_°rög_°
 
	tASN1_PRINTABLESTRING
;

45 
a¢1_°rög_°
 
	tASN1_T61STRING
;

46 
a¢1_°rög_°
 
	tASN1_IA5STRING
;

47 
a¢1_°rög_°
 
	tASN1_GENERALSTRING
;

48 
a¢1_°rög_°
 
	tASN1_UNIVERSALSTRING
;

49 
a¢1_°rög_°
 
	tASN1_BMPSTRING
;

50 
a¢1_°rög_°
 
	tASN1_UTCTIME
;

51 
a¢1_°rög_°
 
	tASN1_TIME
;

52 
a¢1_°rög_°
 
	tASN1_GENERALIZEDTIME
;

53 
a¢1_°rög_°
 
	tASN1_VISIBLESTRING
;

54 
a¢1_°rög_°
 
	tASN1_UTF8STRING
;

55 
a¢1_°rög_°
 
	tASN1_STRING
;

56 
	tASN1_BOOLEAN
;

57 
	tASN1_NULL
;

60 
a¢1_obje˘_°
 
	tASN1_OBJECT
;

62 
ASN1_ITEM_°
 
	tASN1_ITEM
;

63 
a¢1_p˘x_°
 
	tASN1_PCTX
;

64 
a¢1_s˘x_°
 
	tASN1_SCTX
;

66 #ifde‡
_WIN32


67 #unde‡
X509_NAME


68 #unde‡
X509_EXTENSIONS


69 #unde‡
PKCS7_ISSUER_AND_SERIAL


70 #unde‡
PKCS7_SIGNER_INFO


71 #unde‡
OCSP_REQUEST


72 #unde‡
OCSP_RESPONSE


75 #ifde‡
BIGNUM


76 #unde‡
BIGNUM


78 
d™e_°
;

79 
bio_°
 
	tBIO
;

80 
bignum_°
 
	tBIGNUM
;

81 
bignum_˘x
 
	tBN_CTX
;

82 
bn_blödög_°
 
	tBN_BLINDING
;

83 
bn_m⁄t_˘x_°
 
	tBN_MONT_CTX
;

84 
bn_ª˝_˘x_°
 
	tBN_RECP_CTX
;

85 
bn_gícb_°
 
	tBN_GENCB
;

87 
buf_mem_°
 
	tBUF_MEM
;

89 
evp_cùhî_°
 
	tEVP_CIPHER
;

90 
evp_cùhî_˘x_°
 
	tEVP_CIPHER_CTX
;

91 
evp_md_°
 
	tEVP_MD
;

92 
evp_md_˘x_°
 
	tEVP_MD_CTX
;

93 
evp_pkey_°
 
	tEVP_PKEY
;

95 
evp_pkey_a¢1_mëhod_°
 
	tEVP_PKEY_ASN1_METHOD
;

97 
evp_pkey_mëhod_°
 
	tEVP_PKEY_METHOD
;

98 
evp_pkey_˘x_°
 
	tEVP_PKEY_CTX
;

100 
evp_Encode_Ctx_°
 
	tEVP_ENCODE_CTX
;

102 
hmac_˘x_°
 
	tHMAC_CTX
;

104 
dh_°
 
	tDH
;

105 
dh_mëhod
 
	tDH_METHOD
;

107 
dß_°
 
	tDSA
;

108 
dß_mëhod
 
	tDSA_METHOD
;

110 
rß_°
 
	tRSA
;

111 
rß_mëh_°
 
	tRSA_METHOD
;

113 
ec_key_°
 
	tEC_KEY
;

114 
ec_key_mëhod_°
 
	tEC_KEY_METHOD
;

116 
ønd_mëh_°
 
	tRAND_METHOD
;

117 
ønd_drbg_°
 
	tRAND_DRBG
;

119 
s¶_d™e_°
 
	tSSL_DANE
;

120 
x509_°
 
	tX509
;

121 
X509_Æg‹_°
 
	tX509_ALGOR
;

122 
X509_¸l_°
 
	tX509_CRL
;

123 
x509_¸l_mëhod_°
 
	tX509_CRL_METHOD
;

124 
x509_ªvoked_°
 
	tX509_REVOKED
;

125 
X509_«me_°
 
	tX509_NAME
;

126 
X509_pubkey_°
 
	tX509_PUBKEY
;

127 
x509_°‹e_°
 
	tX509_STORE
;

128 
x509_°‹e_˘x_°
 
	tX509_STORE_CTX
;

130 
x509_obje˘_°
 
	tX509_OBJECT
;

131 
x509_lookup_°
 
	tX509_LOOKUP
;

132 
x509_lookup_mëhod_°
 
	tX509_LOOKUP_METHOD
;

133 
X509_VERIFY_PARAM_°
 
	tX509_VERIFY_PARAM
;

135 
x509_sig_öfo_°
 
	tX509_SIG_INFO
;

137 
pkcs8_¥iv_key_öfo_°
 
	tPKCS8_PRIV_KEY_INFO
;

139 
v3_ext_˘x
 
	tX509V3_CTX
;

140 
c⁄f_°
 
	tCONF
;

141 
os¶_öô_£âögs_°
 
	tOPENSSL_INIT_SETTINGS
;

143 
ui_°
 
	tUI
;

144 
ui_mëhod_°
 
	tUI_METHOD
;

146 
ígöe_°
 
	tENGINE
;

147 
s¶_°
 
	tSSL
;

148 
s¶_˘x_°
 
	tSSL_CTX
;

150 
comp_˘x_°
 
	tCOMP_CTX
;

151 
comp_mëhod_°
 
	tCOMP_METHOD
;

153 
X509_POLICY_NODE_°
 
	tX509_POLICY_NODE
;

154 
X509_POLICY_LEVEL_°
 
	tX509_POLICY_LEVEL
;

155 
X509_POLICY_TREE_°
 
	tX509_POLICY_TREE
;

156 
X509_POLICY_CACHE_°
 
	tX509_POLICY_CACHE
;

158 
AUTHORITY_KEYID_°
 
	tAUTHORITY_KEYID
;

159 
DIST_POINT_°
 
	tDIST_POINT
;

160 
ISSUING_DIST_POINT_°
 
	tISSUING_DIST_POINT
;

161 
NAME_CONSTRAINTS_°
 
	tNAME_CONSTRAINTS
;

163 
¸y±o_ex_d©a_°
 
	tCRYPTO_EX_DATA
;

165 
oc•_ªq_˘x_°
 
	tOCSP_REQ_CTX
;

166 
oc•_ª•⁄£_°
 
	tOCSP_RESPONSE
;

167 
oc•_ª•⁄dî_id_°
 
	tOCSP_RESPID
;

169 
s˘_°
 
	tSCT
;

170 
s˘_˘x_°
 
	tSCT_CTX
;

171 
˘log_°
 
	tCTLOG
;

172 
˘log_°‹e_°
 
	tCTLOG_STORE
;

173 
˘_pﬁicy_evÆ_˘x_°
 
	tCT_POLICY_EVAL_CTX
;

175 
os¶_°‹e_öfo_°
 
	tOSSL_STORE_INFO
;

176 
os¶_°‹e_£¨ch_°
 
	tOSSL_STORE_SEARCH
;

178 #i‡
deföed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L && \

179 
deföed
(
INTMAX_MAX
Ë&& deföed(
UINTMAX_MAX
)

180 
ötmax_t
 
	tos¶_ötmax_t
;

181 
uötmax_t
 
	tos¶_uötmax_t
;

189 
	tos¶_ötmax_t
;

190 
	tos¶_uötmax_t
;

193 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/pem.h

10 #i‚de‡
HEADER_PEM_H


11 
	#HEADER_PEM_H


	)

13 
	~<›ís¶/e_os2.h
>

14 
	~<›ís¶/bio.h
>

15 
	~<›ís¶/ß„°ack.h
>

16 
	~<›ís¶/evp.h
>

17 
	~<›ís¶/x509.h
>

18 
	~<›ís¶/≥mîr.h
>

20 #ifde‡ 
__˝lu•lus


24 
	#PEM_BUFSIZE
 1024

	)

26 
	#PEM_STRING_X509_OLD
 "X509 CERTIFICATE"

	)

27 
	#PEM_STRING_X509
 "CERTIFICATE"

	)

28 
	#PEM_STRING_X509_TRUSTED
 "TRUSTED CERTIFICATE"

	)

29 
	#PEM_STRING_X509_REQ_OLD
 "NEW CERTIFICATE REQUEST"

	)

30 
	#PEM_STRING_X509_REQ
 "CERTIFICATE REQUEST"

	)

31 
	#PEM_STRING_X509_CRL
 "X509 CRL"

	)

32 
	#PEM_STRING_EVP_PKEY
 "ANY PRIVATE KEY"

	)

33 
	#PEM_STRING_PUBLIC
 "PUBLIC KEY"

	)

34 
	#PEM_STRING_RSA
 "RSA PRIVATE KEY"

	)

35 
	#PEM_STRING_RSA_PUBLIC
 "RSA PUBLIC KEY"

	)

36 
	#PEM_STRING_DSA
 "DSA PRIVATE KEY"

	)

37 
	#PEM_STRING_DSA_PUBLIC
 "DSA PUBLIC KEY"

	)

38 
	#PEM_STRING_PKCS7
 "PKCS7"

	)

39 
	#PEM_STRING_PKCS7_SIGNED
 "PKCS #7 SIGNED DATA"

	)

40 
	#PEM_STRING_PKCS8
 "ENCRYPTED PRIVATE KEY"

	)

41 
	#PEM_STRING_PKCS8INF
 "PRIVATE KEY"

	)

42 
	#PEM_STRING_DHPARAMS
 "DH PARAMETERS"

	)

43 
	#PEM_STRING_DHXPARAMS
 "X9.42 DH PARAMETERS"

	)

44 
	#PEM_STRING_SSL_SESSION
 "SSL SESSION PARAMETERS"

	)

45 
	#PEM_STRING_DSAPARAMS
 "DSA PARAMETERS"

	)

46 
	#PEM_STRING_ECDSA_PUBLIC
 "ECDSA PUBLIC KEY"

	)

47 
	#PEM_STRING_ECPARAMETERS
 "EC PARAMETERS"

	)

48 
	#PEM_STRING_ECPRIVATEKEY
 "EC PRIVATE KEY"

	)

49 
	#PEM_STRING_PARAMETERS
 "PARAMETERS"

	)

50 
	#PEM_STRING_CMS
 "CMS"

	)

52 
	#PEM_TYPE_ENCRYPTED
 10

	)

53 
	#PEM_TYPE_MIC_ONLY
 20

	)

54 
	#PEM_TYPE_MIC_CLEAR
 30

	)

55 
	#PEM_TYPE_CLEAR
 40

	)

63 #ifde‡
OPENSSL_NO_STDIO


65 
	#IMPLEMENT_PEM_ªad_Â
(
«me
, 
ty≥
, 
°r
, 
a¢1
Ë

	)

66 
	#IMPLEMENT_PEM_wrôe_Â
(
«me
, 
ty≥
, 
°r
, 
a¢1
Ë

	)

67 
	#IMPLEMENT_PEM_wrôe_Â_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
Ë

	)

68 
	#IMPLEMENT_PEM_wrôe_cb_Â
(
«me
, 
ty≥
, 
°r
, 
a¢1
Ë

	)

69 
	#IMPLEMENT_PEM_wrôe_cb_Â_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
Ë

	)

72 
	#IMPLEMENT_PEM_ªad_Â
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

73 
ty≥
 *
PEM_ªad_
##
	`«me
(
FILE
 *
Â
,Åy≥ **
x
, 
≥m_∑ssw‹d_cb
 *
cb
, *
u
)\

75  
	`PEM_ASN1_ªad
((
d2i_of_void
 *)
d2i_
##
a¢1
, 
°r
,
Â
,(**)
x
,
cb
,
u
); \

76 }

	)

78 
	#IMPLEMENT_PEM_wrôe_Â
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

79 
PEM_wrôe_
##
	`«me
(
FILE
 *
Â
, 
ty≥
 *
x
) \

81  
	`PEM_ASN1_wrôe
((
i2d_of_void
 *)
i2d_
##
a¢1
,
°r
,
Â
,
x
,
NULL
,NULL,0,NULL,NULL); \

82 }

	)

84 
	#IMPLEMENT_PEM_wrôe_Â_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

85 
PEM_wrôe_
##
	`«me
(
FILE
 *
Â
, c⁄° 
ty≥
 *
x
) \

87  
	`PEM_ASN1_wrôe
((
i2d_of_void
 *)
i2d_
##
a¢1
,
°r
,
Â
,(*)
x
,
NULL
,NULL,0,NULL,NULL); \

88 }

	)

90 
	#IMPLEMENT_PEM_wrôe_cb_Â
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

91 
PEM_wrôe_
##
	`«me
(
FILE
 *
Â
, 
ty≥
 *
x
, c⁄° 
EVP_CIPHER
 *
íc
, \

92 *
k°r
, 
kÀn
, 
≥m_∑ssw‹d_cb
 *
cb
, \

93 *
u
) \

95  
	`PEM_ASN1_wrôe
((
i2d_of_void
 *)
i2d_
##
a¢1
,
°r
,
Â
,
x
,
íc
,
k°r
,
kÀn
,
cb
,
u
); \

96 }

	)

98 
	#IMPLEMENT_PEM_wrôe_cb_Â_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

99 
PEM_wrôe_
##
	`«me
(
FILE
 *
Â
, 
ty≥
 *
x
, c⁄° 
EVP_CIPHER
 *
íc
, \

100 *
k°r
, 
kÀn
, 
≥m_∑ssw‹d_cb
 *
cb
, \

101 *
u
) \

103  
	`PEM_ASN1_wrôe
((
i2d_of_void
 *)
i2d_
##
a¢1
,
°r
,
Â
,
x
,
íc
,
k°r
,
kÀn
,
cb
,
u
); \

104 }

	)

108 
	#IMPLEMENT_PEM_ªad_bio
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

109 
ty≥
 *
PEM_ªad_bio_
##
	`«me
(
BIO
 *
bp
,Åy≥ **
x
, 
≥m_∑ssw‹d_cb
 *
cb
, *
u
)\

111  
	`PEM_ASN1_ªad_bio
((
d2i_of_void
 *)
d2i_
##
a¢1
, 
°r
,
bp
,(**)
x
,
cb
,
u
); \

112 }

	)

114 
	#IMPLEMENT_PEM_wrôe_bio
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

115 
PEM_wrôe_bio_
##
	`«me
(
BIO
 *
bp
, 
ty≥
 *
x
) \

117  
	`PEM_ASN1_wrôe_bio
((
i2d_of_void
 *)
i2d_
##
a¢1
,
°r
,
bp
,
x
,
NULL
,NULL,0,NULL,NULL); \

118 }

	)

120 
	#IMPLEMENT_PEM_wrôe_bio_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

121 
PEM_wrôe_bio_
##
	`«me
(
BIO
 *
bp
, c⁄° 
ty≥
 *
x
) \

123  
	`PEM_ASN1_wrôe_bio
((
i2d_of_void
 *)
i2d_
##
a¢1
,
°r
,
bp
,(*)
x
,
NULL
,NULL,0,NULL,NULL); \

124 }

	)

126 
	#IMPLEMENT_PEM_wrôe_cb_bio
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

127 
PEM_wrôe_bio_
##
	`«me
(
BIO
 *
bp
, 
ty≥
 *
x
, c⁄° 
EVP_CIPHER
 *
íc
, \

128 *
k°r
, 
kÀn
, 
≥m_∑ssw‹d_cb
 *
cb
, *
u
) \

130  
	`PEM_ASN1_wrôe_bio
((
i2d_of_void
 *)
i2d_
##
a¢1
,
°r
,
bp
,
x
,
íc
,
k°r
,
kÀn
,
cb
,
u
); \

131 }

	)

133 
	#IMPLEMENT_PEM_wrôe_cb_bio_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

134 
PEM_wrôe_bio_
##
	`«me
(
BIO
 *
bp
, 
ty≥
 *
x
, c⁄° 
EVP_CIPHER
 *
íc
, \

135 *
k°r
, 
kÀn
, 
≥m_∑ssw‹d_cb
 *
cb
, *
u
) \

137  
	`PEM_ASN1_wrôe_bio
((
i2d_of_void
 *)
i2d_
##
a¢1
,
°r
,
bp
,(*)
x
,
íc
,
k°r
,
kÀn
,
cb
,
u
); \

138 }

	)

140 
	#IMPLEMENT_PEM_wrôe
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

141 
	`IMPLEMENT_PEM_wrôe_bio
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

142 
	`IMPLEMENT_PEM_wrôe_Â
(
«me
, 
ty≥
, 
°r
, 
a¢1
)

	)

144 
	#IMPLEMENT_PEM_wrôe_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

145 
	`IMPLEMENT_PEM_wrôe_bio_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

146 
	`IMPLEMENT_PEM_wrôe_Â_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
)

	)

148 
	#IMPLEMENT_PEM_wrôe_cb
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

149 
	`IMPLEMENT_PEM_wrôe_cb_bio
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

150 
	`IMPLEMENT_PEM_wrôe_cb_Â
(
«me
, 
ty≥
, 
°r
, 
a¢1
)

	)

152 
	#IMPLEMENT_PEM_wrôe_cb_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

153 
	`IMPLEMENT_PEM_wrôe_cb_bio_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

154 
	`IMPLEMENT_PEM_wrôe_cb_Â_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
)

	)

156 
	#IMPLEMENT_PEM_ªad
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

157 
	`IMPLEMENT_PEM_ªad_bio
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

158 
	`IMPLEMENT_PEM_ªad_Â
(
«me
, 
ty≥
, 
°r
, 
a¢1
)

	)

160 
	#IMPLEMENT_PEM_rw
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

161 
	`IMPLEMENT_PEM_ªad
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

162 
	`IMPLEMENT_PEM_wrôe
(
«me
, 
ty≥
, 
°r
, 
a¢1
)

	)

164 
	#IMPLEMENT_PEM_rw_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

165 
	`IMPLEMENT_PEM_ªad
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

166 
	`IMPLEMENT_PEM_wrôe_c⁄°
(
«me
, 
ty≥
, 
°r
, 
a¢1
)

	)

168 
	#IMPLEMENT_PEM_rw_cb
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

169 
	`IMPLEMENT_PEM_ªad
(
«me
, 
ty≥
, 
°r
, 
a¢1
) \

170 
	`IMPLEMENT_PEM_wrôe_cb
(
«me
, 
ty≥
, 
°r
, 
a¢1
)

	)

174 #i‡
deföed
(
OPENSSL_NO_STDIO
)

176 
	#DECLARE_PEM_ªad_Â
(
«me
, 
ty≥
Ë

	)

177 
	#DECLARE_PEM_wrôe_Â
(
«me
, 
ty≥
Ë

	)

178 
	#DECLARE_PEM_wrôe_Â_c⁄°
(
«me
, 
ty≥
Ë

	)

179 
	#DECLARE_PEM_wrôe_cb_Â
(
«me
, 
ty≥
Ë

	)

182 
	#DECLARE_PEM_ªad_Â
(
«me
, 
ty≥
) \

183 
ty≥
 *
PEM_ªad_
##
	`«me
(
FILE
 *
Â
,Åy≥ **
x
, 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

	)

185 
	#DECLARE_PEM_wrôe_Â
(
«me
, 
ty≥
) \

186 
PEM_wrôe_
##
	`«me
(
FILE
 *
Â
, 
ty≥
 *
x
);

	)

188 
	#DECLARE_PEM_wrôe_Â_c⁄°
(
«me
, 
ty≥
) \

189 
PEM_wrôe_
##
	`«me
(
FILE
 *
Â
, c⁄° 
ty≥
 *
x
);

	)

191 
	#DECLARE_PEM_wrôe_cb_Â
(
«me
, 
ty≥
) \

192 
PEM_wrôe_
##
	`«me
(
FILE
 *
Â
, 
ty≥
 *
x
, c⁄° 
EVP_CIPHER
 *
íc
, \

193 *
k°r
, 
kÀn
, 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

	)

197 
	#DECLARE_PEM_ªad_bio
(
«me
, 
ty≥
) \

198 
ty≥
 *
PEM_ªad_bio_
##
	`«me
(
BIO
 *
bp
,Åy≥ **
x
, 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

	)

200 
	#DECLARE_PEM_wrôe_bio
(
«me
, 
ty≥
) \

201 
PEM_wrôe_bio_
##
	`«me
(
BIO
 *
bp
, 
ty≥
 *
x
);

	)

203 
	#DECLARE_PEM_wrôe_bio_c⁄°
(
«me
, 
ty≥
) \

204 
PEM_wrôe_bio_
##
	`«me
(
BIO
 *
bp
, c⁄° 
ty≥
 *
x
);

	)

206 
	#DECLARE_PEM_wrôe_cb_bio
(
«me
, 
ty≥
) \

207 
PEM_wrôe_bio_
##
	`«me
(
BIO
 *
bp
, 
ty≥
 *
x
, c⁄° 
EVP_CIPHER
 *
íc
, \

208 *
k°r
, 
kÀn
, 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

	)

210 
	#DECLARE_PEM_wrôe
(
«me
, 
ty≥
) \

211 
	`DECLARE_PEM_wrôe_bio
(
«me
, 
ty≥
) \

212 
	`DECLARE_PEM_wrôe_Â
(
«me
, 
ty≥
)

	)

213 
	#DECLARE_PEM_wrôe_c⁄°
(
«me
, 
ty≥
) \

214 
	`DECLARE_PEM_wrôe_bio_c⁄°
(
«me
, 
ty≥
) \

215 
	`DECLARE_PEM_wrôe_Â_c⁄°
(
«me
, 
ty≥
)

	)

216 
	#DECLARE_PEM_wrôe_cb
(
«me
, 
ty≥
) \

217 
	`DECLARE_PEM_wrôe_cb_bio
(
«me
, 
ty≥
) \

218 
	`DECLARE_PEM_wrôe_cb_Â
(
«me
, 
ty≥
)

	)

219 
	#DECLARE_PEM_ªad
(
«me
, 
ty≥
) \

220 
	`DECLARE_PEM_ªad_bio
(
«me
, 
ty≥
) \

221 
	`DECLARE_PEM_ªad_Â
(
«me
, 
ty≥
)

	)

222 
	#DECLARE_PEM_rw
(
«me
, 
ty≥
) \

223 
	`DECLARE_PEM_ªad
(
«me
, 
ty≥
) \

224 
	`DECLARE_PEM_wrôe
(
«me
, 
ty≥
)

	)

225 
	#DECLARE_PEM_rw_c⁄°
(
«me
, 
ty≥
) \

226 
	`DECLARE_PEM_ªad
(
«me
, 
ty≥
) \

227 
	`DECLARE_PEM_wrôe_c⁄°
(
«me
, 
ty≥
)

	)

228 
	#DECLARE_PEM_rw_cb
(
«me
, 
ty≥
) \

229 
	`DECLARE_PEM_ªad
(
«me
, 
ty≥
) \

230 
	`DECLARE_PEM_wrôe_cb
(
«me
, 
ty≥
)

	)

231 
	t≥m_∑ssw‹d_cb
 (*
	tbuf
, 
	tsize
, 
	trwÊag
, *
	tu£rd©a
);

233 
PEM_gë_EVP_CIPHER_INFO
(*
hódî
, 
EVP_CIPHER_INFO
 *
cùhî
);

234 
PEM_do_hódî
(
EVP_CIPHER_INFO
 *
cùhî
, *
d©a
, *
Àn
,

235 
≥m_∑ssw‹d_cb
 *
ˇŒback
, *
u
);

237 
PEM_ªad_bio
(
BIO
 *
bp
, **
«me
, **
hódî
,

238 **
d©a
, *
Àn
);

239 
	#PEM_FLAG_SECURE
 0x1

	)

240 
	#PEM_FLAG_EAY_COMPATIBLE
 0x2

	)

241 
	#PEM_FLAG_ONLY_B64
 0x4

	)

242 
PEM_ªad_bio_ex
(
BIO
 *
bp
, **
«me
, **
hódî
,

243 **
d©a
, *
Àn
, 
Êags
);

244 
PEM_byãs_ªad_bio_£cmem
(**
pd©a
, *
∂í
, **
≤m
,

245 c⁄° *
«me
, 
BIO
 *
bp
, 
≥m_∑ssw‹d_cb
 *
cb
,

246 *
u
);

247 
PEM_wrôe_bio
(
BIO
 *
bp
, c⁄° *
«me
, c⁄° *
hdr
,

248 c⁄° *
d©a
, 
Àn
);

249 
PEM_byãs_ªad_bio
(**
pd©a
, *
∂í
, **
≤m
,

250 c⁄° *
«me
, 
BIO
 *
bp
, 
≥m_∑ssw‹d_cb
 *
cb
,

251 *
u
);

252 *
PEM_ASN1_ªad_bio
(
d2i_of_void
 *
d2i
, c⁄° *
«me
, 
BIO
 *
bp
, **
x
,

253 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

254 
PEM_ASN1_wrôe_bio
(
i2d_of_void
 *
i2d
, c⁄° *
«me
, 
BIO
 *
bp
, *
x
,

255 c⁄° 
EVP_CIPHER
 *
íc
, *
k°r
, 
kÀn
,

256 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

258 
STACK_OF
(
X509_INFO
Ë*
PEM_X509_INFO_ªad_bio
(
BIO
 *
bp
, STACK_OF(X509_INFOË*
sk
,

259 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

260 
PEM_X509_INFO_wrôe_bio
(
BIO
 *
bp
, 
X509_INFO
 *
xi
, 
EVP_CIPHER
 *
íc
,

261 *
k°r
, 
kÀn
,

262 
≥m_∑ssw‹d_cb
 *
cd
, *
u
);

264 #i‚de‡
OPENSSL_NO_STDIO


265 
PEM_ªad
(
FILE
 *
Â
, **
«me
, **
hódî
,

266 **
d©a
, *
Àn
);

267 
PEM_wrôe
(
FILE
 *
Â
, c⁄° *
«me
, c⁄° *
hdr
,

268 c⁄° *
d©a
, 
Àn
);

269 *
PEM_ASN1_ªad
(
d2i_of_void
 *
d2i
, c⁄° *
«me
, 
FILE
 *
Â
, **
x
,

270 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

271 
PEM_ASN1_wrôe
(
i2d_of_void
 *
i2d
, c⁄° *
«me
, 
FILE
 *
Â
,

272 *
x
, c⁄° 
EVP_CIPHER
 *
íc
, *
k°r
,

273 
kÀn
, 
≥m_∑ssw‹d_cb
 *
ˇŒback
, *
u
);

274 
STACK_OF
(
X509_INFO
Ë*
PEM_X509_INFO_ªad
(
FILE
 *
Â
, STACK_OF(X509_INFOË*
sk
,

275 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

278 
PEM_SignInô
(
EVP_MD_CTX
 *
˘x
, 
EVP_MD
 *
ty≥
);

279 
PEM_SignUpd©e
(
EVP_MD_CTX
 *
˘x
, *
d
, 
˙t
);

280 
PEM_SignFöÆ
(
EVP_MD_CTX
 *
˘x
, *
sigªt
,

281 *
sigÀn
, 
EVP_PKEY
 *
pkey
);

284 
PEM_def_ˇŒback
(*
buf
, 
num
, 
rwÊag
, *
u£rd©a
);

285 
PEM_¥oc_ty≥
(*
buf
, 
ty≥
);

286 
PEM_dek_öfo
(*
buf
, c⁄° *
ty≥
, 
Àn
, *
°r
);

288 
	~<›ís¶/symhacks.h
>

290 
DECLARE_PEM_rw
(
X509
, X509)

291 
DECLARE_PEM_rw
(
X509_AUX
, 
X509
)

292 
DECLARE_PEM_rw
(
X509_REQ
, X509_REQ)

293 
DECLARE_PEM_wrôe
(
X509_REQ_NEW
, 
X509_REQ
)

294 
DECLARE_PEM_rw
(
X509_CRL
, X509_CRL)

295 
DECLARE_PEM_rw
(
PKCS7
, PKCS7)

296 
DECLARE_PEM_rw
(
NETSCAPE_CERT_SEQUENCE
, NETSCAPE_CERT_SEQUENCE)

297 
DECLARE_PEM_rw
(
PKCS8
, 
X509_SIG
)

298 
DECLARE_PEM_rw
(
PKCS8_PRIV_KEY_INFO
, PKCS8_PRIV_KEY_INFO)

299 #i‚de‡
OPENSSL_NO_RSA


300 
DECLARE_PEM_rw_cb
(
RSAPriv©eKey
, 
RSA
)

301 
DECLARE_PEM_rw_c⁄°
(
RSAPublicKey
, 
RSA
)

302 
DECLARE_PEM_rw
(
RSA_PUBKEY
, 
RSA
)

304 #i‚de‡
OPENSSL_NO_DSA


305 
DECLARE_PEM_rw_cb
(
DSAPriv©eKey
, 
DSA
)

306 
DECLARE_PEM_rw
(
DSA_PUBKEY
, 
DSA
)

307 
DECLARE_PEM_rw_c⁄°
(
DSA∑øms
, 
DSA
)

309 #i‚de‡
OPENSSL_NO_EC


310 
DECLARE_PEM_rw_c⁄°
(
ECPKP¨amëîs
, 
EC_GROUP
)

311 
DECLARE_PEM_rw_cb
(
ECPriv©eKey
, 
EC_KEY
)

312 
DECLARE_PEM_rw
(
EC_PUBKEY
, 
EC_KEY
)

314 #i‚de‡
OPENSSL_NO_DH


315 
DECLARE_PEM_rw_c⁄°
(
DH∑øms
, 
DH
)

316 
DECLARE_PEM_wrôe_c⁄°
(
DHx∑øms
, 
DH
)

318 
DECLARE_PEM_rw_cb
(
Priv©eKey
, 
EVP_PKEY
)

319 
DECLARE_PEM_rw
(
PUBKEY
, 
EVP_PKEY
)

321 
PEM_wrôe_bio_Priv©eKey_åadôi⁄Æ
(
BIO
 *
bp
, 
EVP_PKEY
 *
x
,

322 c⁄° 
EVP_CIPHER
 *
íc
,

323 *
k°r
, 
kÀn
,

324 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

326 
PEM_wrôe_bio_PKCS8Priv©eKey_nid
(
BIO
 *
bp
, 
EVP_PKEY
 *
x
, 
nid
,

327 *
k°r
, 
kÀn
,

328 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

329 
PEM_wrôe_bio_PKCS8Priv©eKey
(
BIO
 *, 
EVP_PKEY
 *, c⁄° 
EVP_CIPHER
 *,

330 *, , 
≥m_∑ssw‹d_cb
 *, *);

331 
i2d_PKCS8Priv©eKey_bio
(
BIO
 *
bp
, 
EVP_PKEY
 *
x
, c⁄° 
EVP_CIPHER
 *
íc
,

332 *
k°r
, 
kÀn
,

333 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

334 
i2d_PKCS8Priv©eKey_nid_bio
(
BIO
 *
bp
, 
EVP_PKEY
 *
x
, 
nid
,

335 *
k°r
, 
kÀn
,

336 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

337 
EVP_PKEY
 *
d2i_PKCS8Priv©eKey_bio
(
BIO
 *
bp
, EVP_PKEY **
x
, 
≥m_∑ssw‹d_cb
 *
cb
,

338 *
u
);

340 #i‚de‡
OPENSSL_NO_STDIO


341 
i2d_PKCS8Priv©eKey_Â
(
FILE
 *
Â
, 
EVP_PKEY
 *
x
, c⁄° 
EVP_CIPHER
 *
íc
,

342 *
k°r
, 
kÀn
,

343 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

344 
i2d_PKCS8Priv©eKey_nid_Â
(
FILE
 *
Â
, 
EVP_PKEY
 *
x
, 
nid
,

345 *
k°r
, 
kÀn
,

346 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

347 
PEM_wrôe_PKCS8Priv©eKey_nid
(
FILE
 *
Â
, 
EVP_PKEY
 *
x
, 
nid
,

348 *
k°r
, 
kÀn
,

349 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

351 
EVP_PKEY
 *
d2i_PKCS8Priv©eKey_Â
(
FILE
 *
Â
, EVP_PKEY **
x
, 
≥m_∑ssw‹d_cb
 *
cb
,

352 *
u
);

354 
PEM_wrôe_PKCS8Priv©eKey
(
FILE
 *
Â
, 
EVP_PKEY
 *
x
, c⁄° 
EVP_CIPHER
 *
íc
,

355 *
k°r
, 
kÀn
, 
≥m_∑ssw‹d_cb
 *
cd
,

356 *
u
);

358 
EVP_PKEY
 *
PEM_ªad_bio_P¨amëîs
(
BIO
 *
bp
, EVP_PKEY **
x
);

359 
PEM_wrôe_bio_P¨amëîs
(
BIO
 *
bp
, 
EVP_PKEY
 *
x
);

361 #i‚de‡
OPENSSL_NO_DSA


362 
EVP_PKEY
 *
b2i_Priv©eKey
(c⁄° **
ö
, 
Àngth
);

363 
EVP_PKEY
 *
b2i_PublicKey
(c⁄° **
ö
, 
Àngth
);

364 
EVP_PKEY
 *
b2i_Priv©eKey_bio
(
BIO
 *
ö
);

365 
EVP_PKEY
 *
b2i_PublicKey_bio
(
BIO
 *
ö
);

366 
i2b_Priv©eKey_bio
(
BIO
 *
out
, 
EVP_PKEY
 *
pk
);

367 
i2b_PublicKey_bio
(
BIO
 *
out
, 
EVP_PKEY
 *
pk
);

368 #i‚de‡
OPENSSL_NO_RC4


369 
EVP_PKEY
 *
b2i_PVK_bio
(
BIO
 *
ö
, 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

370 
i2b_PVK_bio
(
BIO
 *
out
, 
EVP_PKEY
 *
pk
, 
í˛evñ
,

371 
≥m_∑ssw‹d_cb
 *
cb
, *
u
);

375 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/randerr.h

11 #i‚de‡
HEADER_RANDERR_H


12 
	#HEADER_RANDERR_H


	)

14 
	~<›ís¶/symhacks.h
>

16 #ifde‡ 
__˝lu•lus


19 
ERR_lﬂd_RAND_°rögs
();

24 
	#RAND_F_DRBG_BYTES
 101

	)

25 
	#RAND_F_DRBG_GET_ENTROPY
 105

	)

26 
	#RAND_F_DRBG_SETUP
 117

	)

27 
	#RAND_F_GET_ENTROPY
 106

	)

28 
	#RAND_F_RAND_BYTES
 100

	)

29 
	#RAND_F_RAND_DRBG_ENABLE_LOCKING
 119

	)

30 
	#RAND_F_RAND_DRBG_GENERATE
 107

	)

31 
	#RAND_F_RAND_DRBG_GET_ENTROPY
 120

	)

32 
	#RAND_F_RAND_DRBG_GET_NONCE
 123

	)

33 
	#RAND_F_RAND_DRBG_INSTANTIATE
 108

	)

34 
	#RAND_F_RAND_DRBG_NEW
 109

	)

35 
	#RAND_F_RAND_DRBG_RESEED
 110

	)

36 
	#RAND_F_RAND_DRBG_RESTART
 102

	)

37 
	#RAND_F_RAND_DRBG_SET
 104

	)

38 
	#RAND_F_RAND_DRBG_SET_DEFAULTS
 121

	)

39 
	#RAND_F_RAND_DRBG_UNINSTANTIATE
 118

	)

40 
	#RAND_F_RAND_LOAD_FILE
 111

	)

41 
	#RAND_F_RAND_POOL_ACQUIRE_ENTROPY
 122

	)

42 
	#RAND_F_RAND_POOL_ADD
 103

	)

43 
	#RAND_F_RAND_POOL_ADD_BEGIN
 113

	)

44 
	#RAND_F_RAND_POOL_ADD_END
 114

	)

45 
	#RAND_F_RAND_POOL_ATTACH
 124

	)

46 
	#RAND_F_RAND_POOL_BYTES_NEEDED
 115

	)

47 
	#RAND_F_RAND_POOL_GROW
 125

	)

48 
	#RAND_F_RAND_POOL_NEW
 116

	)

49 
	#RAND_F_RAND_WRITE_FILE
 112

	)

54 
	#RAND_R_ADDITIONAL_INPUT_TOO_LONG
 102

	)

55 
	#RAND_R_ALREADY_INSTANTIATED
 103

	)

56 
	#RAND_R_ARGUMENT_OUT_OF_RANGE
 105

	)

57 
	#RAND_R_CANNOT_OPEN_FILE
 121

	)

58 
	#RAND_R_DRBG_ALREADY_INITIALIZED
 129

	)

59 
	#RAND_R_DRBG_NOT_INITIALISED
 104

	)

60 
	#RAND_R_ENTROPY_INPUT_TOO_LONG
 106

	)

61 
	#RAND_R_ENTROPY_OUT_OF_RANGE
 124

	)

62 
	#RAND_R_ERROR_ENTROPY_POOL_WAS_IGNORED
 127

	)

63 
	#RAND_R_ERROR_INITIALISING_DRBG
 107

	)

64 
	#RAND_R_ERROR_INSTANTIATING_DRBG
 108

	)

65 
	#RAND_R_ERROR_RETRIEVING_ADDITIONAL_INPUT
 109

	)

66 
	#RAND_R_ERROR_RETRIEVING_ENTROPY
 110

	)

67 
	#RAND_R_ERROR_RETRIEVING_NONCE
 111

	)

68 
	#RAND_R_FAILED_TO_CREATE_LOCK
 126

	)

69 
	#RAND_R_FUNC_NOT_IMPLEMENTED
 101

	)

70 
	#RAND_R_FWRITE_ERROR
 123

	)

71 
	#RAND_R_GENERATE_ERROR
 112

	)

72 
	#RAND_R_INTERNAL_ERROR
 113

	)

73 
	#RAND_R_IN_ERROR_STATE
 114

	)

74 
	#RAND_R_NOT_A_REGULAR_FILE
 122

	)

75 
	#RAND_R_NOT_INSTANTIATED
 115

	)

76 
	#RAND_R_NO_DRBG_IMPLEMENTATION_SELECTED
 128

	)

77 
	#RAND_R_PARENT_LOCKING_NOT_ENABLED
 130

	)

78 
	#RAND_R_PARENT_STRENGTH_TOO_WEAK
 131

	)

79 
	#RAND_R_PERSONALISATION_STRING_TOO_LONG
 116

	)

80 
	#RAND_R_PREDICTION_RESISTANCE_NOT_SUPPORTED
 133

	)

81 
	#RAND_R_PRNG_NOT_SEEDED
 100

	)

82 
	#RAND_R_RANDOM_POOL_OVERFLOW
 125

	)

83 
	#RAND_R_RANDOM_POOL_UNDERFLOW
 134

	)

84 
	#RAND_R_REQUEST_TOO_LARGE_FOR_DRBG
 117

	)

85 
	#RAND_R_RESEED_ERROR
 118

	)

86 
	#RAND_R_SELFTEST_FAILURE
 119

	)

87 
	#RAND_R_TOO_LITTLE_NONCE_REQUESTED
 135

	)

88 
	#RAND_R_TOO_MUCH_NONCE_REQUESTED
 136

	)

89 
	#RAND_R_UNSUPPORTED_DRBG_FLAGS
 132

	)

90 
	#RAND_R_UNSUPPORTED_DRBG_TYPE
 120

	)

	@/usr/include/openssl/safestack.h

10 #i‚de‡
HEADER_SAFESTACK_H


11 
	#HEADER_SAFESTACK_H


	)

13 
	~<›ís¶/°ack.h
>

14 
	~<›ís¶/e_os2.h
>

16 #ifde‡
__˝lu•lus


20 
	#STACK_OF
(
ty≥
Ë
°ack_°_
##
	)
type

22 
	#SKM_DEFINE_STACK_OF
(
t1
, 
t2
, 
t3
) \

23 
	`STACK_OF
(
t1
); \

24 (*
	tsk_
##
	tt1
##
	t_compfunc
)(c⁄° 
	tt3
 * c⁄° *
	ta
, c⁄°Å3 *c⁄° *
	tb
); \

25 (*
	tsk_
##
	tt1
##
	t_‰ìfunc
)(
	tt3
 *
	ta
); \

26 
t3
 * (*
	tsk_
##
	tt1
##
	t_c›yfunc
)(c⁄° 
	tt3
 *
	ta
); \

27 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_num
(c⁄° 
	`STACK_OF
—1Ë*
sk
) \

29  
	`OPENSSL_sk_num
((c⁄° 
OPENSSL_STACK
 *)
sk
); \

31 
os¶_unu£d
 
os¶_ölöe
 
t2
 *
sk_
##
t1
##
	`_vÆue
(c⁄° 
	`STACK_OF
—1Ë*
sk
, 
idx
) \

33  (
t2
 *)
	`OPENSSL_sk_vÆue
((c⁄° 
OPENSSL_STACK
 *)
sk
, 
idx
); \

35 
os¶_unu£d
 
os¶_ölöe
 
	`STACK_OF
(
t1
Ë*
sk_
##t1##
	`_√w
(sk_##t1##
_compfunc
 
com∑ª
) \

37  (
	`STACK_OF
(
t1
Ë*)
	`OPENSSL_sk_√w
((
OPENSSL_sk_compfunc
)
com∑ª
); \

39 
os¶_unu£d
 
os¶_ölöe
 
	`STACK_OF
(
t1
Ë*
sk_
##t1##
	`_√w_nuŒ
() \

41  (
	`STACK_OF
(
t1
Ë*)
	`OPENSSL_sk_√w_nuŒ
(); \

43 
os¶_unu£d
 
os¶_ölöe
 
	`STACK_OF
(
t1
Ë*
sk_
##t1##
	`_√w_ª£rve
(sk_##t1##
_compfunc
 
com∑ª
, 
n
) \

45  (
	`STACK_OF
(
t1
Ë*)
	`OPENSSL_sk_√w_ª£rve
((
OPENSSL_sk_compfunc
)
com∑ª
, 
n
); \

47 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_ª£rve
(
	`STACK_OF
—1Ë*
sk
, 
n
) \

49  
	`OPENSSL_sk_ª£rve
((
OPENSSL_STACK
 *)
sk
, 
n
); \

51 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_‰ì
(
	`STACK_OF
—1Ë*
sk
) \

53 
	`OPENSSL_sk_‰ì
((
OPENSSL_STACK
 *)
sk
); \

55 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_zîo
(
	`STACK_OF
—1Ë*
sk
) \

57 
	`OPENSSL_sk_zîo
((
OPENSSL_STACK
 *)
sk
); \

59 
os¶_unu£d
 
os¶_ölöe
 
t2
 *
sk_
##
t1
##
	`_dñëe
(
	`STACK_OF
—1Ë*
sk
, 
i
) \

61  (
t2
 *)
	`OPENSSL_sk_dñëe
((
OPENSSL_STACK
 *)
sk
, 
i
); \

63 
os¶_unu£d
 
os¶_ölöe
 
t2
 *
sk_
##
t1
##
	`_dñëe_±r
(
	`STACK_OF
—1Ë*
sk
,Å2 *
±r
) \

65  (
t2
 *)
	`OPENSSL_sk_dñëe_±r
((
OPENSSL_STACK
 *)
sk
, \

66 (c⁄° *)
±r
); \

68 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_push
(
	`STACK_OF
—1Ë*
sk
, 
t2
 *
±r
) \

70  
	`OPENSSL_sk_push
((
OPENSSL_STACK
 *)
sk
, (c⁄° *)
±r
); \

72 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_unshi·
(
	`STACK_OF
—1Ë*
sk
, 
t2
 *
±r
) \

74  
	`OPENSSL_sk_unshi·
((
OPENSSL_STACK
 *)
sk
, (c⁄° *)
±r
); \

76 
os¶_unu£d
 
os¶_ölöe
 
t2
 *
sk_
##
t1
##
	`_p›
(
	`STACK_OF
—1Ë*
sk
) \

78  (
t2
 *)
	`OPENSSL_sk_p›
((
OPENSSL_STACK
 *)
sk
); \

80 
os¶_unu£d
 
os¶_ölöe
 
t2
 *
sk_
##
t1
##
	`_shi·
(
	`STACK_OF
—1Ë*
sk
) \

82  (
t2
 *)
	`OPENSSL_sk_shi·
((
OPENSSL_STACK
 *)
sk
); \

84 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_p›_‰ì
(
	`STACK_OF
—1Ë*
sk
, sk_##t1##
_‰ìfunc
 
‰ìfunc
) \

86 
	`OPENSSL_sk_p›_‰ì
((
OPENSSL_STACK
 *)
sk
, (
OPENSSL_sk_‰ìfunc
)
‰ìfunc
); \

88 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_ö£π
(
	`STACK_OF
—1Ë*
sk
, 
t2
 *
±r
, 
idx
) \

90  
	`OPENSSL_sk_ö£π
((
OPENSSL_STACK
 *)
sk
, (c⁄° *)
±r
, 
idx
); \

92 
os¶_unu£d
 
os¶_ölöe
 
t2
 *
sk_
##
t1
##
	`_£t
(
	`STACK_OF
—1Ë*
sk
, 
idx
,Å2 *
±r
) \

94  (
t2
 *)
	`OPENSSL_sk_£t
((
OPENSSL_STACK
 *)
sk
, 
idx
, (c⁄° *)
±r
); \

96 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_föd
(
	`STACK_OF
—1Ë*
sk
, 
t2
 *
±r
) \

98  
	`OPENSSL_sk_föd
((
OPENSSL_STACK
 *)
sk
, (c⁄° *)
±r
); \

100 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_föd_ex
(
	`STACK_OF
—1Ë*
sk
, 
t2
 *
±r
) \

102  
	`OPENSSL_sk_föd_ex
((
OPENSSL_STACK
 *)
sk
, (c⁄° *)
±r
); \

104 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_s‹t
(
	`STACK_OF
—1Ë*
sk
) \

106 
	`OPENSSL_sk_s‹t
((
OPENSSL_STACK
 *)
sk
); \

108 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
	`_is_s‹ãd
(c⁄° 
	`STACK_OF
—1Ë*
sk
) \

110  
	`OPENSSL_sk_is_s‹ãd
((c⁄° 
OPENSSL_STACK
 *)
sk
); \

112 
os¶_unu£d
 
os¶_ölöe
 
	`STACK_OF
(
t1
Ë* 
sk_
##t1##
	`_dup
(c⁄° STACK_OF—1Ë*
sk
) \

114  (
	`STACK_OF
(
t1
Ë*)
	`OPENSSL_sk_dup
((c⁄° 
OPENSSL_STACK
 *)
sk
); \

116 
os¶_unu£d
 
os¶_ölöe
 
	`STACK_OF
(
t1
Ë*
sk_
##t1##
	`_dìp_c›y
(c⁄° STACK_OF—1Ë*
sk
, \

117 
sk_
##
t1
##
_c›yfunc
 
c›yfunc
, \

118 
sk_
##
t1
##
_‰ìfunc
 
‰ìfunc
) \

120  (
	`STACK_OF
(
t1
Ë*)
	`OPENSSL_sk_dìp_c›y
((c⁄° 
OPENSSL_STACK
 *)
sk
, \

121 (
OPENSSL_sk_c›yfunc
)
c›yfunc
, \

122 (
OPENSSL_sk_‰ìfunc
)
‰ìfunc
); \

124 
os¶_unu£d
 
os¶_ölöe
 
sk_
##
t1
##
_compfunc
 sk_##t1##
	`_£t_cmp_func
(
	`STACK_OF
—1Ë*
sk
, sk_##t1##_compfun¯
com∑ª
) \

126  (
sk_
##
t1
##
_compfunc
)
	`OPENSSL_sk_£t_cmp_func
((
OPENSSL_STACK
 *)
sk
, (
OPENSSL_sk_compfunc
)
com∑ª
); \

127 }

	)

129 
	#DEFINE_SPECIAL_STACK_OF
(
t1
, 
t2
Ë
	`SKM_DEFINE_STACK_OF
—1,Å2,Å2)

	)

130 
	#DEFINE_STACK_OF
(
t
Ë
	`SKM_DEFINE_STACK_OF
—,Å,Å)

	)

131 
	#DEFINE_SPECIAL_STACK_OF_CONST
(
t1
, 
t2
) \

132 
	`SKM_DEFINE_STACK_OF
(
t1
, c⁄° 
t2
,Å2)

	)

133 
	#DEFINE_STACK_OF_CONST
(
t
Ë
	`SKM_DEFINE_STACK_OF
—, c⁄°Å,Å)

	)

149 *
	tOPENSSL_STRING
;

150 c⁄° *
	tOPENSSL_CSTRING
;

159 
DEFINE_SPECIAL_STACK_OF
(
OPENSSL_STRING
, )

160 
DEFINE_SPECIAL_STACK_OF_CONST
(
OPENSSL_CSTRING
, )

166 *
	tOPENSSL_BLOCK
;

167 
DEFINE_SPECIAL_STACK_OF
(
OPENSSL_BLOCK
, )

177 #ifde‡
__SUNPRO_C


178 #¥agm®
wók
 
OPENSSL_sk_num


179 #¥agm®
wók
 
OPENSSL_sk_vÆue


180 #¥agm®
wók
 
OPENSSL_sk_√w


181 #¥agm®
wók
 
OPENSSL_sk_√w_nuŒ


182 #¥agm®
wók
 
OPENSSL_sk_√w_ª£rve


183 #¥agm®
wók
 
OPENSSL_sk_ª£rve


184 #¥agm®
wók
 
OPENSSL_sk_‰ì


185 #¥agm®
wók
 
OPENSSL_sk_zîo


186 #¥agm®
wók
 
OPENSSL_sk_dñëe


187 #¥agm®
wók
 
OPENSSL_sk_dñëe_±r


188 #¥agm®
wók
 
OPENSSL_sk_push


189 #¥agm®
wók
 
OPENSSL_sk_unshi·


190 #¥agm®
wók
 
OPENSSL_sk_p›


191 #¥agm®
wók
 
OPENSSL_sk_shi·


192 #¥agm®
wók
 
OPENSSL_sk_p›_‰ì


193 #¥agm®
wók
 
OPENSSL_sk_ö£π


194 #¥agm®
wók
 
OPENSSL_sk_£t


195 #¥agm®
wók
 
OPENSSL_sk_föd


196 #¥agm®
wók
 
OPENSSL_sk_föd_ex


197 #¥agm®
wók
 
OPENSSL_sk_s‹t


198 #¥agm®
wók
 
OPENSSL_sk_is_s‹ãd


199 #¥agm®
wók
 
OPENSSL_sk_dup


200 #¥agm®
wók
 
OPENSSL_sk_dìp_c›y


201 #¥agm®
wók
 
OPENSSL_sk_£t_cmp_func


204 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/srtp.h

16 #i‚de‡
HEADER_D1_SRTP_H


17 
	#HEADER_D1_SRTP_H


	)

19 
	~<›ís¶/s¶.h
>

21 #ifde‡ 
__˝lu•lus


25 
	#SRTP_AES128_CM_SHA1_80
 0x0001

	)

26 
	#SRTP_AES128_CM_SHA1_32
 0x0002

	)

27 
	#SRTP_AES128_F8_SHA1_80
 0x0003

	)

28 
	#SRTP_AES128_F8_SHA1_32
 0x0004

	)

29 
	#SRTP_NULL_SHA1_80
 0x0005

	)

30 
	#SRTP_NULL_SHA1_32
 0x0006

	)

33 
	#SRTP_AEAD_AES_128_GCM
 0x0007

	)

34 
	#SRTP_AEAD_AES_256_GCM
 0x0008

	)

36 #i‚de‡
OPENSSL_NO_SRTP


38 
__owur
 
SSL_CTX_£t_é£xt_u£_§ç
(
SSL_CTX
 *
˘x
, c⁄° *
¥ofûes
);

39 
__owur
 
SSL_£t_é£xt_u£_§ç
(
SSL
 *
s¶
, c⁄° *
¥ofûes
);

41 
__owur
 
STACK_OF
(
SRTP_PROTECTION_PROFILE
Ë*
SSL_gë_§ç_¥ofûes
(
SSL
 *
s¶
);

42 
__owur
 
SRTP_PROTECTION_PROFILE
 *
SSL_gë_£À˘ed_§ç_¥ofûe
(
SSL
 *
s
);

46 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/ssl2.h

10 #i‚de‡
HEADER_SSL2_H


11 
	#HEADER_SSL2_H


	)

13 #ifde‡ 
__˝lu•lus


17 
	#SSL2_VERSION
 0x0002

	)

19 
	#SSL2_MT_CLIENT_HELLO
 1

	)

21 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/ssl3.h

11 #i‚de‡
HEADER_SSL3_H


12 
	#HEADER_SSL3_H


	)

14 
	~<›ís¶/comp.h
>

15 
	~<›ís¶/buf„r.h
>

16 
	~<›ís¶/evp.h
>

17 
	~<›ís¶/s¶.h
>

19 #ifde‡ 
__˝lu•lus


27 
	#SSL3_CK_SCSV
 0x030000FF

	)

33 
	#SSL3_CK_FALLBACK_SCSV
 0x03005600

	)

35 
	#SSL3_CK_RSA_NULL_MD5
 0x03000001

	)

36 
	#SSL3_CK_RSA_NULL_SHA
 0x03000002

	)

37 
	#SSL3_CK_RSA_RC4_40_MD5
 0x03000003

	)

38 
	#SSL3_CK_RSA_RC4_128_MD5
 0x03000004

	)

39 
	#SSL3_CK_RSA_RC4_128_SHA
 0x03000005

	)

40 
	#SSL3_CK_RSA_RC2_40_MD5
 0x03000006

	)

41 
	#SSL3_CK_RSA_IDEA_128_SHA
 0x03000007

	)

42 
	#SSL3_CK_RSA_DES_40_CBC_SHA
 0x03000008

	)

43 
	#SSL3_CK_RSA_DES_64_CBC_SHA
 0x03000009

	)

44 
	#SSL3_CK_RSA_DES_192_CBC3_SHA
 0x0300000A

	)

46 
	#SSL3_CK_DH_DSS_DES_40_CBC_SHA
 0x0300000B

	)

47 
	#SSL3_CK_DH_DSS_DES_64_CBC_SHA
 0x0300000C

	)

48 
	#SSL3_CK_DH_DSS_DES_192_CBC3_SHA
 0x0300000D

	)

49 
	#SSL3_CK_DH_RSA_DES_40_CBC_SHA
 0x0300000E

	)

50 
	#SSL3_CK_DH_RSA_DES_64_CBC_SHA
 0x0300000F

	)

51 
	#SSL3_CK_DH_RSA_DES_192_CBC3_SHA
 0x03000010

	)

53 
	#SSL3_CK_DHE_DSS_DES_40_CBC_SHA
 0x03000011

	)

54 
	#SSL3_CK_EDH_DSS_DES_40_CBC_SHA
 
SSL3_CK_DHE_DSS_DES_40_CBC_SHA


	)

55 
	#SSL3_CK_DHE_DSS_DES_64_CBC_SHA
 0x03000012

	)

56 
	#SSL3_CK_EDH_DSS_DES_64_CBC_SHA
 
SSL3_CK_DHE_DSS_DES_64_CBC_SHA


	)

57 
	#SSL3_CK_DHE_DSS_DES_192_CBC3_SHA
 0x03000013

	)

58 
	#SSL3_CK_EDH_DSS_DES_192_CBC3_SHA
 
SSL3_CK_DHE_DSS_DES_192_CBC3_SHA


	)

59 
	#SSL3_CK_DHE_RSA_DES_40_CBC_SHA
 0x03000014

	)

60 
	#SSL3_CK_EDH_RSA_DES_40_CBC_SHA
 
SSL3_CK_DHE_RSA_DES_40_CBC_SHA


	)

61 
	#SSL3_CK_DHE_RSA_DES_64_CBC_SHA
 0x03000015

	)

62 
	#SSL3_CK_EDH_RSA_DES_64_CBC_SHA
 
SSL3_CK_DHE_RSA_DES_64_CBC_SHA


	)

63 
	#SSL3_CK_DHE_RSA_DES_192_CBC3_SHA
 0x03000016

	)

64 
	#SSL3_CK_EDH_RSA_DES_192_CBC3_SHA
 
SSL3_CK_DHE_RSA_DES_192_CBC3_SHA


	)

66 
	#SSL3_CK_ADH_RC4_40_MD5
 0x03000017

	)

67 
	#SSL3_CK_ADH_RC4_128_MD5
 0x03000018

	)

68 
	#SSL3_CK_ADH_DES_40_CBC_SHA
 0x03000019

	)

69 
	#SSL3_CK_ADH_DES_64_CBC_SHA
 0x0300001A

	)

70 
	#SSL3_CK_ADH_DES_192_CBC_SHA
 0x0300001B

	)

73 
	#SSL3_RFC_RSA_NULL_MD5
 "TLS_RSA_WITH_NULL_MD5"

	)

74 
	#SSL3_RFC_RSA_NULL_SHA
 "TLS_RSA_WITH_NULL_SHA"

	)

75 
	#SSL3_RFC_RSA_DES_192_CBC3_SHA
 "TLS_RSA_WITH_3DES_EDE_CBC_SHA"

	)

76 
	#SSL3_RFC_DHE_DSS_DES_192_CBC3_SHA
 "TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA"

	)

77 
	#SSL3_RFC_DHE_RSA_DES_192_CBC3_SHA
 "TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA"

	)

78 
	#SSL3_RFC_ADH_DES_192_CBC_SHA
 "TLS_DH_™⁄_WITH_3DES_EDE_CBC_SHA"

	)

79 
	#SSL3_RFC_RSA_IDEA_128_SHA
 "TLS_RSA_WITH_IDEA_CBC_SHA"

	)

80 
	#SSL3_RFC_RSA_RC4_128_MD5
 "TLS_RSA_WITH_RC4_128_MD5"

	)

81 
	#SSL3_RFC_RSA_RC4_128_SHA
 "TLS_RSA_WITH_RC4_128_SHA"

	)

82 
	#SSL3_RFC_ADH_RC4_128_MD5
 "TLS_DH_™⁄_WITH_RC4_128_MD5"

	)

84 
	#SSL3_TXT_RSA_NULL_MD5
 "NULL-MD5"

	)

85 
	#SSL3_TXT_RSA_NULL_SHA
 "NULL-SHA"

	)

86 
	#SSL3_TXT_RSA_RC4_40_MD5
 "EXP-RC4-MD5"

	)

87 
	#SSL3_TXT_RSA_RC4_128_MD5
 "RC4-MD5"

	)

88 
	#SSL3_TXT_RSA_RC4_128_SHA
 "RC4-SHA"

	)

89 
	#SSL3_TXT_RSA_RC2_40_MD5
 "EXP-RC2-CBC-MD5"

	)

90 
	#SSL3_TXT_RSA_IDEA_128_SHA
 "IDEA-CBC-SHA"

	)

91 
	#SSL3_TXT_RSA_DES_40_CBC_SHA
 "EXP-DES-CBC-SHA"

	)

92 
	#SSL3_TXT_RSA_DES_64_CBC_SHA
 "DES-CBC-SHA"

	)

93 
	#SSL3_TXT_RSA_DES_192_CBC3_SHA
 "DES-CBC3-SHA"

	)

95 
	#SSL3_TXT_DH_DSS_DES_40_CBC_SHA
 "EXP-DH-DSS-DES-CBC-SHA"

	)

96 
	#SSL3_TXT_DH_DSS_DES_64_CBC_SHA
 "DH-DSS-DES-CBC-SHA"

	)

97 
	#SSL3_TXT_DH_DSS_DES_192_CBC3_SHA
 "DH-DSS-DES-CBC3-SHA"

	)

98 
	#SSL3_TXT_DH_RSA_DES_40_CBC_SHA
 "EXP-DH-RSA-DES-CBC-SHA"

	)

99 
	#SSL3_TXT_DH_RSA_DES_64_CBC_SHA
 "DH-RSA-DES-CBC-SHA"

	)

100 
	#SSL3_TXT_DH_RSA_DES_192_CBC3_SHA
 "DH-RSA-DES-CBC3-SHA"

	)

102 
	#SSL3_TXT_DHE_DSS_DES_40_CBC_SHA
 "EXP-DHE-DSS-DES-CBC-SHA"

	)

103 
	#SSL3_TXT_DHE_DSS_DES_64_CBC_SHA
 "DHE-DSS-DES-CBC-SHA"

	)

104 
	#SSL3_TXT_DHE_DSS_DES_192_CBC3_SHA
 "DHE-DSS-DES-CBC3-SHA"

	)

105 
	#SSL3_TXT_DHE_RSA_DES_40_CBC_SHA
 "EXP-DHE-RSA-DES-CBC-SHA"

	)

106 
	#SSL3_TXT_DHE_RSA_DES_64_CBC_SHA
 "DHE-RSA-DES-CBC-SHA"

	)

107 
	#SSL3_TXT_DHE_RSA_DES_192_CBC3_SHA
 "DHE-RSA-DES-CBC3-SHA"

	)

114 
	#SSL3_TXT_EDH_DSS_DES_40_CBC_SHA
 "EXP-EDH-DSS-DES-CBC-SHA"

	)

115 
	#SSL3_TXT_EDH_DSS_DES_64_CBC_SHA
 "EDH-DSS-DES-CBC-SHA"

	)

116 
	#SSL3_TXT_EDH_DSS_DES_192_CBC3_SHA
 "EDH-DSS-DES-CBC3-SHA"

	)

117 
	#SSL3_TXT_EDH_RSA_DES_40_CBC_SHA
 "EXP-EDH-RSA-DES-CBC-SHA"

	)

118 
	#SSL3_TXT_EDH_RSA_DES_64_CBC_SHA
 "EDH-RSA-DES-CBC-SHA"

	)

119 
	#SSL3_TXT_EDH_RSA_DES_192_CBC3_SHA
 "EDH-RSA-DES-CBC3-SHA"

	)

121 
	#SSL3_TXT_ADH_RC4_40_MD5
 "EXP-ADH-RC4-MD5"

	)

122 
	#SSL3_TXT_ADH_RC4_128_MD5
 "ADH-RC4-MD5"

	)

123 
	#SSL3_TXT_ADH_DES_40_CBC_SHA
 "EXP-ADH-DES-CBC-SHA"

	)

124 
	#SSL3_TXT_ADH_DES_64_CBC_SHA
 "ADH-DES-CBC-SHA"

	)

125 
	#SSL3_TXT_ADH_DES_192_CBC_SHA
 "ADH-DES-CBC3-SHA"

	)

127 
	#SSL3_SSL_SESSION_ID_LENGTH
 32

	)

128 
	#SSL3_MAX_SSL_SESSION_ID_LENGTH
 32

	)

130 
	#SSL3_MASTER_SECRET_SIZE
 48

	)

131 
	#SSL3_RANDOM_SIZE
 32

	)

132 
	#SSL3_SESSION_ID_SIZE
 32

	)

133 
	#SSL3_RT_HEADER_LENGTH
 5

	)

135 
	#SSL3_HM_HEADER_LENGTH
 4

	)

137 #i‚de‡
SSL3_ALIGN_PAYLOAD


146 
	#SSL3_ALIGN_PAYLOAD
 8

	)

148 #i‡(
SSL3_ALIGN_PAYLOAD
&(SSL3_ALIGN_PAYLOAD-1))!=0

150 #unde‡
SSL3_ALIGN_PAYLOAD


160 
	#SSL3_RT_MAX_MD_SIZE
 64

	)

166 
	#SSL_RT_MAX_CIPHER_BLOCK_SIZE
 16

	)

168 
	#SSL3_RT_MAX_EXTRA
 (16384)

	)

171 
	#SSL3_RT_MAX_PLAIN_LENGTH
 16384

	)

173 
	#SSL3_RT_MAX_COMPRESSED_OVERHEAD
 1024

	)

180 
	#SSL3_RT_MAX_ENCRYPTED_OVERHEAD
 (256 + 
SSL3_RT_MAX_MD_SIZE
)

	)

181 
	#SSL3_RT_MAX_TLS13_ENCRYPTED_OVERHEAD
 256

	)

188 
	#SSL3_RT_SEND_MAX_ENCRYPTED_OVERHEAD
 \

189 (
SSL_RT_MAX_CIPHER_BLOCK_SIZE
 + 
SSL3_RT_MAX_MD_SIZE
)

	)

193 #ifde‡
OPENSSL_NO_COMP


194 
	#SSL3_RT_MAX_COMPRESSED_LENGTH
 
SSL3_RT_MAX_PLAIN_LENGTH


	)

196 
	#SSL3_RT_MAX_COMPRESSED_LENGTH
 \

197 (
SSL3_RT_MAX_PLAIN_LENGTH
+
SSL3_RT_MAX_COMPRESSED_OVERHEAD
)

	)

199 
	#SSL3_RT_MAX_ENCRYPTED_LENGTH
 \

200 (
SSL3_RT_MAX_ENCRYPTED_OVERHEAD
+
SSL3_RT_MAX_COMPRESSED_LENGTH
)

	)

201 
	#SSL3_RT_MAX_TLS13_ENCRYPTED_LENGTH
 \

202 (
SSL3_RT_MAX_PLAIN_LENGTH
 + 
SSL3_RT_MAX_TLS13_ENCRYPTED_OVERHEAD
)

	)

203 
	#SSL3_RT_MAX_PACKET_SIZE
 \

204 (
SSL3_RT_MAX_ENCRYPTED_LENGTH
+
SSL3_RT_HEADER_LENGTH
)

	)

206 
	#SSL3_MD_CLIENT_FINISHED_CONST
 "\x43\x4C\x4E\x54"

	)

207 
	#SSL3_MD_SERVER_FINISHED_CONST
 "\x53\x52\x56\x52"

	)

209 
	#SSL3_VERSION
 0x0300

	)

210 
	#SSL3_VERSION_MAJOR
 0x03

	)

211 
	#SSL3_VERSION_MINOR
 0x00

	)

213 
	#SSL3_RT_CHANGE_CIPHER_SPEC
 20

	)

214 
	#SSL3_RT_ALERT
 21

	)

215 
	#SSL3_RT_HANDSHAKE
 22

	)

216 
	#SSL3_RT_APPLICATION_DATA
 23

	)

217 
	#DTLS1_RT_HEARTBEAT
 24

	)

220 
	#TLS1_RT_CRYPTO
 0x1000

	)

221 
	#TLS1_RT_CRYPTO_PREMASTER
 (
TLS1_RT_CRYPTO
 | 0x1)

	)

222 
	#TLS1_RT_CRYPTO_CLIENT_RANDOM
 (
TLS1_RT_CRYPTO
 | 0x2)

	)

223 
	#TLS1_RT_CRYPTO_SERVER_RANDOM
 (
TLS1_RT_CRYPTO
 | 0x3)

	)

224 
	#TLS1_RT_CRYPTO_MASTER
 (
TLS1_RT_CRYPTO
 | 0x4)

	)

226 
	#TLS1_RT_CRYPTO_READ
 0x0000

	)

227 
	#TLS1_RT_CRYPTO_WRITE
 0x0100

	)

228 
	#TLS1_RT_CRYPTO_MAC
 (
TLS1_RT_CRYPTO
 | 0x5)

	)

229 
	#TLS1_RT_CRYPTO_KEY
 (
TLS1_RT_CRYPTO
 | 0x6)

	)

230 
	#TLS1_RT_CRYPTO_IV
 (
TLS1_RT_CRYPTO
 | 0x7)

	)

231 
	#TLS1_RT_CRYPTO_FIXED_IV
 (
TLS1_RT_CRYPTO
 | 0x8)

	)

234 
	#SSL3_RT_HEADER
 0x100

	)

235 
	#SSL3_RT_INNER_CONTENT_TYPE
 0x101

	)

237 
	#SSL3_AL_WARNING
 1

	)

238 
	#SSL3_AL_FATAL
 2

	)

240 
	#SSL3_AD_CLOSE_NOTIFY
 0

	)

241 
	#SSL3_AD_UNEXPECTED_MESSAGE
 10

	)

242 
	#SSL3_AD_BAD_RECORD_MAC
 20

	)

243 
	#SSL3_AD_DECOMPRESSION_FAILURE
 30

	)

244 
	#SSL3_AD_HANDSHAKE_FAILURE
 40

	)

245 
	#SSL3_AD_NO_CERTIFICATE
 41

	)

246 
	#SSL3_AD_BAD_CERTIFICATE
 42

	)

247 
	#SSL3_AD_UNSUPPORTED_CERTIFICATE
 43

	)

248 
	#SSL3_AD_CERTIFICATE_REVOKED
 44

	)

249 
	#SSL3_AD_CERTIFICATE_EXPIRED
 45

	)

250 
	#SSL3_AD_CERTIFICATE_UNKNOWN
 46

	)

251 
	#SSL3_AD_ILLEGAL_PARAMETER
 47

	)

253 
	#TLS1_HB_REQUEST
 1

	)

254 
	#TLS1_HB_RESPONSE
 2

	)

257 
	#SSL3_CT_RSA_SIGN
 1

	)

258 
	#SSL3_CT_DSS_SIGN
 2

	)

259 
	#SSL3_CT_RSA_FIXED_DH
 3

	)

260 
	#SSL3_CT_DSS_FIXED_DH
 4

	)

261 
	#SSL3_CT_RSA_EPHEMERAL_DH
 5

	)

262 
	#SSL3_CT_DSS_EPHEMERAL_DH
 6

	)

263 
	#SSL3_CT_FORTEZZA_DMS
 20

	)

268 
	#SSL3_CT_NUMBER
 10

	)

270 #i‡
deföed
(
TLS_CT_NUMBER
)

271 #i‡
TLS_CT_NUMBER
 !
SSL3_CT_NUMBER


277 
	#SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS
 0x0001

	)

280 
	#TLS1_FLAGS_TLS_PADDING_BUG
 0x0

	)

282 
	#TLS1_FLAGS_SKIP_CERT_VERIFY
 0x0010

	)

285 
	#TLS1_FLAGS_ENCRYPT_THEN_MAC_READ
 0x0100

	)

286 
	#TLS1_FLAGS_ENCRYPT_THEN_MAC
 
TLS1_FLAGS_ENCRYPT_THEN_MAC_READ


	)

289 
	#TLS1_FLAGS_RECEIVED_EXTMS
 0x0200

	)

291 
	#TLS1_FLAGS_ENCRYPT_THEN_MAC_WRITE
 0x0400

	)

293 
	#TLS1_FLAGS_STATELESS
 0x0800

	)

295 
	#SSL3_MT_HELLO_REQUEST
 0

	)

296 
	#SSL3_MT_CLIENT_HELLO
 1

	)

297 
	#SSL3_MT_SERVER_HELLO
 2

	)

298 
	#SSL3_MT_NEWSESSION_TICKET
 4

	)

299 
	#SSL3_MT_END_OF_EARLY_DATA
 5

	)

300 
	#SSL3_MT_ENCRYPTED_EXTENSIONS
 8

	)

301 
	#SSL3_MT_CERTIFICATE
 11

	)

302 
	#SSL3_MT_SERVER_KEY_EXCHANGE
 12

	)

303 
	#SSL3_MT_CERTIFICATE_REQUEST
 13

	)

304 
	#SSL3_MT_SERVER_DONE
 14

	)

305 
	#SSL3_MT_CERTIFICATE_VERIFY
 15

	)

306 
	#SSL3_MT_CLIENT_KEY_EXCHANGE
 16

	)

307 
	#SSL3_MT_FINISHED
 20

	)

308 
	#SSL3_MT_CERTIFICATE_URL
 21

	)

309 
	#SSL3_MT_CERTIFICATE_STATUS
 22

	)

310 
	#SSL3_MT_SUPPLEMENTAL_DATA
 23

	)

311 
	#SSL3_MT_KEY_UPDATE
 24

	)

312 #i‚de‡
OPENSSL_NO_NEXTPROTONEG


313 
	#SSL3_MT_NEXT_PROTO
 67

	)

315 
	#SSL3_MT_MESSAGE_HASH
 254

	)

316 
	#DTLS1_MT_HELLO_VERIFY_REQUEST
 3

	)

319 
	#SSL3_MT_CHANGE_CIPHER_SPEC
 0x0101

	)

321 
	#SSL3_MT_CCS
 1

	)

324 
	#SSL3_CC_READ
 0x001

	)

325 
	#SSL3_CC_WRITE
 0x002

	)

326 
	#SSL3_CC_CLIENT
 0x010

	)

327 
	#SSL3_CC_SERVER
 0x020

	)

328 
	#SSL3_CC_EARLY
 0x040

	)

329 
	#SSL3_CC_HANDSHAKE
 0x080

	)

330 
	#SSL3_CC_APPLICATION
 0x100

	)

331 
	#SSL3_CHANGE_CIPHER_CLIENT_WRITE
 (
SSL3_CC_CLIENT
|
SSL3_CC_WRITE
)

	)

332 
	#SSL3_CHANGE_CIPHER_SERVER_READ
 (
SSL3_CC_SERVER
|
SSL3_CC_READ
)

	)

333 
	#SSL3_CHANGE_CIPHER_CLIENT_READ
 (
SSL3_CC_CLIENT
|
SSL3_CC_READ
)

	)

334 
	#SSL3_CHANGE_CIPHER_SERVER_WRITE
 (
SSL3_CC_SERVER
|
SSL3_CC_WRITE
)

	)

336 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/sslerr.h

11 #i‚de‡
HEADER_SSLERR_H


12 
	#HEADER_SSLERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_SSL_°rögs
();

26 
	#SSL_F_ADD_CLIENT_KEY_SHARE_EXT
 438

	)

27 
	#SSL_F_ADD_KEY_SHARE
 512

	)

28 
	#SSL_F_BYTES_TO_CIPHER_LIST
 519

	)

29 
	#SSL_F_CHECK_SUITEB_CIPHER_LIST
 331

	)

30 
	#SSL_F_CIPHERSUITE_CB
 622

	)

31 
	#SSL_F_CONSTRUCT_CA_NAMES
 552

	)

32 
	#SSL_F_CONSTRUCT_KEY_EXCHANGE_TBS
 553

	)

33 
	#SSL_F_CONSTRUCT_STATEFUL_TICKET
 636

	)

34 
	#SSL_F_CONSTRUCT_STATELESS_TICKET
 637

	)

35 
	#SSL_F_CREATE_SYNTHETIC_MESSAGE_HASH
 539

	)

36 
	#SSL_F_CREATE_TICKET_PREQUEL
 638

	)

37 
	#SSL_F_CT_MOVE_SCTS
 345

	)

38 
	#SSL_F_CT_STRICT
 349

	)

39 
	#SSL_F_CUSTOM_EXT_ADD
 554

	)

40 
	#SSL_F_CUSTOM_EXT_PARSE
 555

	)

41 
	#SSL_F_D2I_SSL_SESSION
 103

	)

42 
	#SSL_F_DANE_CTX_ENABLE
 347

	)

43 
	#SSL_F_DANE_MTYPE_SET
 393

	)

44 
	#SSL_F_DANE_TLSA_ADD
 394

	)

45 
	#SSL_F_DERIVE_SECRET_KEY_AND_IV
 514

	)

46 
	#SSL_F_DO_DTLS1_WRITE
 245

	)

47 
	#SSL_F_DO_SSL3_WRITE
 104

	)

48 
	#SSL_F_DTLS1_BUFFER_RECORD
 247

	)

49 
	#SSL_F_DTLS1_CHECK_TIMEOUT_NUM
 318

	)

50 
	#SSL_F_DTLS1_HEARTBEAT
 305

	)

51 
	#SSL_F_DTLS1_HM_FRAGMENT_NEW
 623

	)

52 
	#SSL_F_DTLS1_PREPROCESS_FRAGMENT
 288

	)

53 
	#SSL_F_DTLS1_PROCESS_BUFFERED_RECORDS
 424

	)

54 
	#SSL_F_DTLS1_PROCESS_RECORD
 257

	)

55 
	#SSL_F_DTLS1_READ_BYTES
 258

	)

56 
	#SSL_F_DTLS1_READ_FAILED
 339

	)

57 
	#SSL_F_DTLS1_RETRANSMIT_MESSAGE
 390

	)

58 
	#SSL_F_DTLS1_WRITE_APP_DATA_BYTES
 268

	)

59 
	#SSL_F_DTLS1_WRITE_BYTES
 545

	)

60 
	#SSL_F_DTLSV1_LISTEN
 350

	)

61 
	#SSL_F_DTLS_CONSTRUCT_CHANGE_CIPHER_SPEC
 371

	)

62 
	#SSL_F_DTLS_CONSTRUCT_HELLO_VERIFY_REQUEST
 385

	)

63 
	#SSL_F_DTLS_GET_REASSEMBLED_MESSAGE
 370

	)

64 
	#SSL_F_DTLS_PROCESS_HELLO_VERIFY
 386

	)

65 
	#SSL_F_DTLS_RECORD_LAYER_NEW
 635

	)

66 
	#SSL_F_DTLS_WAIT_FOR_DRY
 592

	)

67 
	#SSL_F_EARLY_DATA_COUNT_OK
 532

	)

68 
	#SSL_F_FINAL_EARLY_DATA
 556

	)

69 
	#SSL_F_FINAL_EC_PT_FORMATS
 485

	)

70 
	#SSL_F_FINAL_EMS
 486

	)

71 
	#SSL_F_FINAL_KEY_SHARE
 503

	)

72 
	#SSL_F_FINAL_MAXFRAGMENTLEN
 557

	)

73 
	#SSL_F_FINAL_RENEGOTIATE
 483

	)

74 
	#SSL_F_FINAL_SERVER_NAME
 558

	)

75 
	#SSL_F_FINAL_SIG_ALGS
 497

	)

76 
	#SSL_F_GET_CERT_VERIFY_TBS_DATA
 588

	)

77 
	#SSL_F_NSS_KEYLOG_INT
 500

	)

78 
	#SSL_F_OPENSSL_INIT_SSL
 342

	)

79 
	#SSL_F_OSSL_STATEM_CLIENT13_READ_TRANSITION
 436

	)

80 
	#SSL_F_OSSL_STATEM_CLIENT13_WRITE_TRANSITION
 598

	)

81 
	#SSL_F_OSSL_STATEM_CLIENT_CONSTRUCT_MESSAGE
 430

	)

82 
	#SSL_F_OSSL_STATEM_CLIENT_POST_PROCESS_MESSAGE
 593

	)

83 
	#SSL_F_OSSL_STATEM_CLIENT_PROCESS_MESSAGE
 594

	)

84 
	#SSL_F_OSSL_STATEM_CLIENT_READ_TRANSITION
 417

	)

85 
	#SSL_F_OSSL_STATEM_CLIENT_WRITE_TRANSITION
 599

	)

86 
	#SSL_F_OSSL_STATEM_SERVER13_READ_TRANSITION
 437

	)

87 
	#SSL_F_OSSL_STATEM_SERVER13_WRITE_TRANSITION
 600

	)

88 
	#SSL_F_OSSL_STATEM_SERVER_CONSTRUCT_MESSAGE
 431

	)

89 
	#SSL_F_OSSL_STATEM_SERVER_POST_PROCESS_MESSAGE
 601

	)

90 
	#SSL_F_OSSL_STATEM_SERVER_POST_WORK
 602

	)

91 
	#SSL_F_OSSL_STATEM_SERVER_PROCESS_MESSAGE
 603

	)

92 
	#SSL_F_OSSL_STATEM_SERVER_READ_TRANSITION
 418

	)

93 
	#SSL_F_OSSL_STATEM_SERVER_WRITE_TRANSITION
 604

	)

94 
	#SSL_F_PARSE_CA_NAMES
 541

	)

95 
	#SSL_F_PITEM_NEW
 624

	)

96 
	#SSL_F_PQUEUE_NEW
 625

	)

97 
	#SSL_F_PROCESS_KEY_SHARE_EXT
 439

	)

98 
	#SSL_F_READ_STATE_MACHINE
 352

	)

99 
	#SSL_F_SET_CLIENT_CIPHERSUITE
 540

	)

100 
	#SSL_F_SRP_GENERATE_CLIENT_MASTER_SECRET
 595

	)

101 
	#SSL_F_SRP_GENERATE_SERVER_MASTER_SECRET
 589

	)

102 
	#SSL_F_SRP_VERIFY_SERVER_PARAM
 596

	)

103 
	#SSL_F_SSL3_CHANGE_CIPHER_STATE
 129

	)

104 
	#SSL_F_SSL3_CHECK_CERT_AND_ALGORITHM
 130

	)

105 
	#SSL_F_SSL3_CTRL
 213

	)

106 
	#SSL_F_SSL3_CTX_CTRL
 133

	)

107 
	#SSL_F_SSL3_DIGEST_CACHED_RECORDS
 293

	)

108 
	#SSL_F_SSL3_DO_CHANGE_CIPHER_SPEC
 292

	)

109 
	#SSL_F_SSL3_ENC
 608

	)

110 
	#SSL_F_SSL3_FINAL_FINISH_MAC
 285

	)

111 
	#SSL_F_SSL3_FINISH_MAC
 587

	)

112 
	#SSL_F_SSL3_GENERATE_KEY_BLOCK
 238

	)

113 
	#SSL_F_SSL3_GENERATE_MASTER_SECRET
 388

	)

114 
	#SSL_F_SSL3_GET_RECORD
 143

	)

115 
	#SSL_F_SSL3_INIT_FINISHED_MAC
 397

	)

116 
	#SSL_F_SSL3_OUTPUT_CERT_CHAIN
 147

	)

117 
	#SSL_F_SSL3_READ_BYTES
 148

	)

118 
	#SSL_F_SSL3_READ_N
 149

	)

119 
	#SSL_F_SSL3_SETUP_KEY_BLOCK
 157

	)

120 
	#SSL_F_SSL3_SETUP_READ_BUFFER
 156

	)

121 
	#SSL_F_SSL3_SETUP_WRITE_BUFFER
 291

	)

122 
	#SSL_F_SSL3_WRITE_BYTES
 158

	)

123 
	#SSL_F_SSL3_WRITE_PENDING
 159

	)

124 
	#SSL_F_SSL_ADD_CERT_CHAIN
 316

	)

125 
	#SSL_F_SSL_ADD_CERT_TO_BUF
 319

	)

126 
	#SSL_F_SSL_ADD_CERT_TO_WPACKET
 493

	)

127 
	#SSL_F_SSL_ADD_CLIENTHELLO_RENEGOTIATE_EXT
 298

	)

128 
	#SSL_F_SSL_ADD_CLIENTHELLO_TLSEXT
 277

	)

129 
	#SSL_F_SSL_ADD_CLIENTHELLO_USE_SRTP_EXT
 307

	)

130 
	#SSL_F_SSL_ADD_DIR_CERT_SUBJECTS_TO_STACK
 215

	)

131 
	#SSL_F_SSL_ADD_FILE_CERT_SUBJECTS_TO_STACK
 216

	)

132 
	#SSL_F_SSL_ADD_SERVERHELLO_RENEGOTIATE_EXT
 299

	)

133 
	#SSL_F_SSL_ADD_SERVERHELLO_TLSEXT
 278

	)

134 
	#SSL_F_SSL_ADD_SERVERHELLO_USE_SRTP_EXT
 308

	)

135 
	#SSL_F_SSL_BAD_METHOD
 160

	)

136 
	#SSL_F_SSL_BUILD_CERT_CHAIN
 332

	)

137 
	#SSL_F_SSL_BYTES_TO_CIPHER_LIST
 161

	)

138 
	#SSL_F_SSL_CACHE_CIPHERLIST
 520

	)

139 
	#SSL_F_SSL_CERT_ADD0_CHAIN_CERT
 346

	)

140 
	#SSL_F_SSL_CERT_DUP
 221

	)

141 
	#SSL_F_SSL_CERT_NEW
 162

	)

142 
	#SSL_F_SSL_CERT_SET0_CHAIN
 340

	)

143 
	#SSL_F_SSL_CHECK_PRIVATE_KEY
 163

	)

144 
	#SSL_F_SSL_CHECK_SERVERHELLO_TLSEXT
 280

	)

145 
	#SSL_F_SSL_CHECK_SRP_EXT_CLIENTHELLO
 606

	)

146 
	#SSL_F_SSL_CHECK_SRVR_ECC_CERT_AND_ALG
 279

	)

147 
	#SSL_F_SSL_CHOOSE_CLIENT_VERSION
 607

	)

148 
	#SSL_F_SSL_CIPHER_DESCRIPTION
 626

	)

149 
	#SSL_F_SSL_CIPHER_LIST_TO_BYTES
 425

	)

150 
	#SSL_F_SSL_CIPHER_PROCESS_RULESTR
 230

	)

151 
	#SSL_F_SSL_CIPHER_STRENGTH_SORT
 231

	)

152 
	#SSL_F_SSL_CLEAR
 164

	)

153 
	#SSL_F_SSL_CLIENT_HELLO_GET1_EXTENSIONS_PRESENT
 627

	)

154 
	#SSL_F_SSL_COMP_ADD_COMPRESSION_METHOD
 165

	)

155 
	#SSL_F_SSL_CONF_CMD
 334

	)

156 
	#SSL_F_SSL_CREATE_CIPHER_LIST
 166

	)

157 
	#SSL_F_SSL_CTRL
 232

	)

158 
	#SSL_F_SSL_CTX_CHECK_PRIVATE_KEY
 168

	)

159 
	#SSL_F_SSL_CTX_ENABLE_CT
 398

	)

160 
	#SSL_F_SSL_CTX_MAKE_PROFILES
 309

	)

161 
	#SSL_F_SSL_CTX_NEW
 169

	)

162 
	#SSL_F_SSL_CTX_SET_ALPN_PROTOS
 343

	)

163 
	#SSL_F_SSL_CTX_SET_CIPHER_LIST
 269

	)

164 
	#SSL_F_SSL_CTX_SET_CLIENT_CERT_ENGINE
 290

	)

165 
	#SSL_F_SSL_CTX_SET_CT_VALIDATION_CALLBACK
 396

	)

166 
	#SSL_F_SSL_CTX_SET_SESSION_ID_CONTEXT
 219

	)

167 
	#SSL_F_SSL_CTX_SET_SSL_VERSION
 170

	)

168 
	#SSL_F_SSL_CTX_SET_TLSEXT_MAX_FRAGMENT_LENGTH
 551

	)

169 
	#SSL_F_SSL_CTX_USE_CERTIFICATE
 171

	)

170 
	#SSL_F_SSL_CTX_USE_CERTIFICATE_ASN1
 172

	)

171 
	#SSL_F_SSL_CTX_USE_CERTIFICATE_FILE
 173

	)

172 
	#SSL_F_SSL_CTX_USE_PRIVATEKEY
 174

	)

173 
	#SSL_F_SSL_CTX_USE_PRIVATEKEY_ASN1
 175

	)

174 
	#SSL_F_SSL_CTX_USE_PRIVATEKEY_FILE
 176

	)

175 
	#SSL_F_SSL_CTX_USE_PSK_IDENTITY_HINT
 272

	)

176 
	#SSL_F_SSL_CTX_USE_RSAPRIVATEKEY
 177

	)

177 
	#SSL_F_SSL_CTX_USE_RSAPRIVATEKEY_ASN1
 178

	)

178 
	#SSL_F_SSL_CTX_USE_RSAPRIVATEKEY_FILE
 179

	)

179 
	#SSL_F_SSL_CTX_USE_SERVERINFO
 336

	)

180 
	#SSL_F_SSL_CTX_USE_SERVERINFO_EX
 543

	)

181 
	#SSL_F_SSL_CTX_USE_SERVERINFO_FILE
 337

	)

182 
	#SSL_F_SSL_DANE_DUP
 403

	)

183 
	#SSL_F_SSL_DANE_ENABLE
 395

	)

184 
	#SSL_F_SSL_DERIVE
 590

	)

185 
	#SSL_F_SSL_DO_CONFIG
 391

	)

186 
	#SSL_F_SSL_DO_HANDSHAKE
 180

	)

187 
	#SSL_F_SSL_DUP_CA_LIST
 408

	)

188 
	#SSL_F_SSL_ENABLE_CT
 402

	)

189 
	#SSL_F_SSL_GENERATE_PKEY_GROUP
 559

	)

190 
	#SSL_F_SSL_GENERATE_SESSION_ID
 547

	)

191 
	#SSL_F_SSL_GET_NEW_SESSION
 181

	)

192 
	#SSL_F_SSL_GET_PREV_SESSION
 217

	)

193 
	#SSL_F_SSL_GET_SERVER_CERT_INDEX
 322

	)

194 
	#SSL_F_SSL_GET_SIGN_PKEY
 183

	)

195 
	#SSL_F_SSL_HANDSHAKE_HASH
 560

	)

196 
	#SSL_F_SSL_INIT_WBIO_BUFFER
 184

	)

197 
	#SSL_F_SSL_KEY_UPDATE
 515

	)

198 
	#SSL_F_SSL_LOAD_CLIENT_CA_FILE
 185

	)

199 
	#SSL_F_SSL_LOG_MASTER_SECRET
 498

	)

200 
	#SSL_F_SSL_LOG_RSA_CLIENT_KEY_EXCHANGE
 499

	)

201 
	#SSL_F_SSL_MODULE_INIT
 392

	)

202 
	#SSL_F_SSL_NEW
 186

	)

203 
	#SSL_F_SSL_NEXT_PROTO_VALIDATE
 565

	)

204 
	#SSL_F_SSL_PARSE_CLIENTHELLO_RENEGOTIATE_EXT
 300

	)

205 
	#SSL_F_SSL_PARSE_CLIENTHELLO_TLSEXT
 302

	)

206 
	#SSL_F_SSL_PARSE_CLIENTHELLO_USE_SRTP_EXT
 310

	)

207 
	#SSL_F_SSL_PARSE_SERVERHELLO_RENEGOTIATE_EXT
 301

	)

208 
	#SSL_F_SSL_PARSE_SERVERHELLO_TLSEXT
 303

	)

209 
	#SSL_F_SSL_PARSE_SERVERHELLO_USE_SRTP_EXT
 311

	)

210 
	#SSL_F_SSL_PEEK
 270

	)

211 
	#SSL_F_SSL_PEEK_EX
 432

	)

212 
	#SSL_F_SSL_PEEK_INTERNAL
 522

	)

213 
	#SSL_F_SSL_READ
 223

	)

214 
	#SSL_F_SSL_READ_EARLY_DATA
 529

	)

215 
	#SSL_F_SSL_READ_EX
 434

	)

216 
	#SSL_F_SSL_READ_INTERNAL
 523

	)

217 
	#SSL_F_SSL_RENEGOTIATE
 516

	)

218 
	#SSL_F_SSL_RENEGOTIATE_ABBREVIATED
 546

	)

219 
	#SSL_F_SSL_SCAN_CLIENTHELLO_TLSEXT
 320

	)

220 
	#SSL_F_SSL_SCAN_SERVERHELLO_TLSEXT
 321

	)

221 
	#SSL_F_SSL_SESSION_DUP
 348

	)

222 
	#SSL_F_SSL_SESSION_NEW
 189

	)

223 
	#SSL_F_SSL_SESSION_PRINT_FP
 190

	)

224 
	#SSL_F_SSL_SESSION_SET1_ID
 423

	)

225 
	#SSL_F_SSL_SESSION_SET1_ID_CONTEXT
 312

	)

226 
	#SSL_F_SSL_SET_ALPN_PROTOS
 344

	)

227 
	#SSL_F_SSL_SET_CERT
 191

	)

228 
	#SSL_F_SSL_SET_CERT_AND_KEY
 621

	)

229 
	#SSL_F_SSL_SET_CIPHER_LIST
 271

	)

230 
	#SSL_F_SSL_SET_CT_VALIDATION_CALLBACK
 399

	)

231 
	#SSL_F_SSL_SET_FD
 192

	)

232 
	#SSL_F_SSL_SET_PKEY
 193

	)

233 
	#SSL_F_SSL_SET_RFD
 194

	)

234 
	#SSL_F_SSL_SET_SESSION
 195

	)

235 
	#SSL_F_SSL_SET_SESSION_ID_CONTEXT
 218

	)

236 
	#SSL_F_SSL_SET_SESSION_TICKET_EXT
 294

	)

237 
	#SSL_F_SSL_SET_TLSEXT_MAX_FRAGMENT_LENGTH
 550

	)

238 
	#SSL_F_SSL_SET_WFD
 196

	)

239 
	#SSL_F_SSL_SHUTDOWN
 224

	)

240 
	#SSL_F_SSL_SRP_CTX_INIT
 313

	)

241 
	#SSL_F_SSL_START_ASYNC_JOB
 389

	)

242 
	#SSL_F_SSL_UNDEFINED_FUNCTION
 197

	)

243 
	#SSL_F_SSL_UNDEFINED_VOID_FUNCTION
 244

	)

244 
	#SSL_F_SSL_USE_CERTIFICATE
 198

	)

245 
	#SSL_F_SSL_USE_CERTIFICATE_ASN1
 199

	)

246 
	#SSL_F_SSL_USE_CERTIFICATE_FILE
 200

	)

247 
	#SSL_F_SSL_USE_PRIVATEKEY
 201

	)

248 
	#SSL_F_SSL_USE_PRIVATEKEY_ASN1
 202

	)

249 
	#SSL_F_SSL_USE_PRIVATEKEY_FILE
 203

	)

250 
	#SSL_F_SSL_USE_PSK_IDENTITY_HINT
 273

	)

251 
	#SSL_F_SSL_USE_RSAPRIVATEKEY
 204

	)

252 
	#SSL_F_SSL_USE_RSAPRIVATEKEY_ASN1
 205

	)

253 
	#SSL_F_SSL_USE_RSAPRIVATEKEY_FILE
 206

	)

254 
	#SSL_F_SSL_VALIDATE_CT
 400

	)

255 
	#SSL_F_SSL_VERIFY_CERT_CHAIN
 207

	)

256 
	#SSL_F_SSL_VERIFY_CLIENT_POST_HANDSHAKE
 616

	)

257 
	#SSL_F_SSL_WRITE
 208

	)

258 
	#SSL_F_SSL_WRITE_EARLY_DATA
 526

	)

259 
	#SSL_F_SSL_WRITE_EARLY_FINISH
 527

	)

260 
	#SSL_F_SSL_WRITE_EX
 433

	)

261 
	#SSL_F_SSL_WRITE_INTERNAL
 524

	)

262 
	#SSL_F_STATE_MACHINE
 353

	)

263 
	#SSL_F_TLS12_CHECK_PEER_SIGALG
 333

	)

264 
	#SSL_F_TLS12_COPY_SIGALGS
 533

	)

265 
	#SSL_F_TLS13_CHANGE_CIPHER_STATE
 440

	)

266 
	#SSL_F_TLS13_ENC
 609

	)

267 
	#SSL_F_TLS13_FINAL_FINISH_MAC
 605

	)

268 
	#SSL_F_TLS13_GENERATE_SECRET
 591

	)

269 
	#SSL_F_TLS13_HKDF_EXPAND
 561

	)

270 
	#SSL_F_TLS13_RESTORE_HANDSHAKE_DIGEST_FOR_PHA
 617

	)

271 
	#SSL_F_TLS13_SAVE_HANDSHAKE_DIGEST_FOR_PHA
 618

	)

272 
	#SSL_F_TLS13_SETUP_KEY_BLOCK
 441

	)

273 
	#SSL_F_TLS1_CHANGE_CIPHER_STATE
 209

	)

274 
	#SSL_F_TLS1_CHECK_DUPLICATE_EXTENSIONS
 341

	)

275 
	#SSL_F_TLS1_ENC
 401

	)

276 
	#SSL_F_TLS1_EXPORT_KEYING_MATERIAL
 314

	)

277 
	#SSL_F_TLS1_GET_CURVELIST
 338

	)

278 
	#SSL_F_TLS1_PRF
 284

	)

279 
	#SSL_F_TLS1_SAVE_U16
 628

	)

280 
	#SSL_F_TLS1_SETUP_KEY_BLOCK
 211

	)

281 
	#SSL_F_TLS1_SET_GROUPS
 629

	)

282 
	#SSL_F_TLS1_SET_RAW_SIGALGS
 630

	)

283 
	#SSL_F_TLS1_SET_SERVER_SIGALGS
 335

	)

284 
	#SSL_F_TLS1_SET_SHARED_SIGALGS
 631

	)

285 
	#SSL_F_TLS1_SET_SIGALGS
 632

	)

286 
	#SSL_F_TLS_CHOOSE_SIGALG
 513

	)

287 
	#SSL_F_TLS_CLIENT_KEY_EXCHANGE_POST_WORK
 354

	)

288 
	#SSL_F_TLS_COLLECT_EXTENSIONS
 435

	)

289 
	#SSL_F_TLS_CONSTRUCT_CERTIFICATE_AUTHORITIES
 542

	)

290 
	#SSL_F_TLS_CONSTRUCT_CERTIFICATE_REQUEST
 372

	)

291 
	#SSL_F_TLS_CONSTRUCT_CERT_STATUS
 429

	)

292 
	#SSL_F_TLS_CONSTRUCT_CERT_STATUS_BODY
 494

	)

293 
	#SSL_F_TLS_CONSTRUCT_CERT_VERIFY
 496

	)

294 
	#SSL_F_TLS_CONSTRUCT_CHANGE_CIPHER_SPEC
 427

	)

295 
	#SSL_F_TLS_CONSTRUCT_CKE_DHE
 404

	)

296 
	#SSL_F_TLS_CONSTRUCT_CKE_ECDHE
 405

	)

297 
	#SSL_F_TLS_CONSTRUCT_CKE_GOST
 406

	)

298 
	#SSL_F_TLS_CONSTRUCT_CKE_PSK_PREAMBLE
 407

	)

299 
	#SSL_F_TLS_CONSTRUCT_CKE_RSA
 409

	)

300 
	#SSL_F_TLS_CONSTRUCT_CKE_SRP
 410

	)

301 
	#SSL_F_TLS_CONSTRUCT_CLIENT_CERTIFICATE
 484

	)

302 
	#SSL_F_TLS_CONSTRUCT_CLIENT_HELLO
 487

	)

303 
	#SSL_F_TLS_CONSTRUCT_CLIENT_KEY_EXCHANGE
 488

	)

304 
	#SSL_F_TLS_CONSTRUCT_CLIENT_VERIFY
 489

	)

305 
	#SSL_F_TLS_CONSTRUCT_CTOS_ALPN
 466

	)

306 
	#SSL_F_TLS_CONSTRUCT_CTOS_CERTIFICATE
 355

	)

307 
	#SSL_F_TLS_CONSTRUCT_CTOS_COOKIE
 535

	)

308 
	#SSL_F_TLS_CONSTRUCT_CTOS_EARLY_DATA
 530

	)

309 
	#SSL_F_TLS_CONSTRUCT_CTOS_EC_PT_FORMATS
 467

	)

310 
	#SSL_F_TLS_CONSTRUCT_CTOS_EMS
 468

	)

311 
	#SSL_F_TLS_CONSTRUCT_CTOS_ETM
 469

	)

312 
	#SSL_F_TLS_CONSTRUCT_CTOS_HELLO
 356

	)

313 
	#SSL_F_TLS_CONSTRUCT_CTOS_KEY_EXCHANGE
 357

	)

314 
	#SSL_F_TLS_CONSTRUCT_CTOS_KEY_SHARE
 470

	)

315 
	#SSL_F_TLS_CONSTRUCT_CTOS_MAXFRAGMENTLEN
 549

	)

316 
	#SSL_F_TLS_CONSTRUCT_CTOS_NPN
 471

	)

317 
	#SSL_F_TLS_CONSTRUCT_CTOS_PADDING
 472

	)

318 
	#SSL_F_TLS_CONSTRUCT_CTOS_POST_HANDSHAKE_AUTH
 619

	)

319 
	#SSL_F_TLS_CONSTRUCT_CTOS_PSK
 501

	)

320 
	#SSL_F_TLS_CONSTRUCT_CTOS_PSK_KEX_MODES
 509

	)

321 
	#SSL_F_TLS_CONSTRUCT_CTOS_RENEGOTIATE
 473

	)

322 
	#SSL_F_TLS_CONSTRUCT_CTOS_SCT
 474

	)

323 
	#SSL_F_TLS_CONSTRUCT_CTOS_SERVER_NAME
 475

	)

324 
	#SSL_F_TLS_CONSTRUCT_CTOS_SESSION_TICKET
 476

	)

325 
	#SSL_F_TLS_CONSTRUCT_CTOS_SIG_ALGS
 477

	)

326 
	#SSL_F_TLS_CONSTRUCT_CTOS_SRP
 478

	)

327 
	#SSL_F_TLS_CONSTRUCT_CTOS_STATUS_REQUEST
 479

	)

328 
	#SSL_F_TLS_CONSTRUCT_CTOS_SUPPORTED_GROUPS
 480

	)

329 
	#SSL_F_TLS_CONSTRUCT_CTOS_SUPPORTED_VERSIONS
 481

	)

330 
	#SSL_F_TLS_CONSTRUCT_CTOS_USE_SRTP
 482

	)

331 
	#SSL_F_TLS_CONSTRUCT_CTOS_VERIFY
 358

	)

332 
	#SSL_F_TLS_CONSTRUCT_ENCRYPTED_EXTENSIONS
 443

	)

333 
	#SSL_F_TLS_CONSTRUCT_END_OF_EARLY_DATA
 536

	)

334 
	#SSL_F_TLS_CONSTRUCT_EXTENSIONS
 447

	)

335 
	#SSL_F_TLS_CONSTRUCT_FINISHED
 359

	)

336 
	#SSL_F_TLS_CONSTRUCT_HELLO_REQUEST
 373

	)

337 
	#SSL_F_TLS_CONSTRUCT_HELLO_RETRY_REQUEST
 510

	)

338 
	#SSL_F_TLS_CONSTRUCT_KEY_UPDATE
 517

	)

339 
	#SSL_F_TLS_CONSTRUCT_NEW_SESSION_TICKET
 428

	)

340 
	#SSL_F_TLS_CONSTRUCT_NEXT_PROTO
 426

	)

341 
	#SSL_F_TLS_CONSTRUCT_SERVER_CERTIFICATE
 490

	)

342 
	#SSL_F_TLS_CONSTRUCT_SERVER_HELLO
 491

	)

343 
	#SSL_F_TLS_CONSTRUCT_SERVER_KEY_EXCHANGE
 492

	)

344 
	#SSL_F_TLS_CONSTRUCT_STOC_ALPN
 451

	)

345 
	#SSL_F_TLS_CONSTRUCT_STOC_CERTIFICATE
 374

	)

346 
	#SSL_F_TLS_CONSTRUCT_STOC_COOKIE
 613

	)

347 
	#SSL_F_TLS_CONSTRUCT_STOC_CRYPTOPRO_BUG
 452

	)

348 
	#SSL_F_TLS_CONSTRUCT_STOC_DONE
 375

	)

349 
	#SSL_F_TLS_CONSTRUCT_STOC_EARLY_DATA
 531

	)

350 
	#SSL_F_TLS_CONSTRUCT_STOC_EARLY_DATA_INFO
 525

	)

351 
	#SSL_F_TLS_CONSTRUCT_STOC_EC_PT_FORMATS
 453

	)

352 
	#SSL_F_TLS_CONSTRUCT_STOC_EMS
 454

	)

353 
	#SSL_F_TLS_CONSTRUCT_STOC_ETM
 455

	)

354 
	#SSL_F_TLS_CONSTRUCT_STOC_HELLO
 376

	)

355 
	#SSL_F_TLS_CONSTRUCT_STOC_KEY_EXCHANGE
 377

	)

356 
	#SSL_F_TLS_CONSTRUCT_STOC_KEY_SHARE
 456

	)

357 
	#SSL_F_TLS_CONSTRUCT_STOC_MAXFRAGMENTLEN
 548

	)

358 
	#SSL_F_TLS_CONSTRUCT_STOC_NEXT_PROTO_NEG
 457

	)

359 
	#SSL_F_TLS_CONSTRUCT_STOC_PSK
 504

	)

360 
	#SSL_F_TLS_CONSTRUCT_STOC_RENEGOTIATE
 458

	)

361 
	#SSL_F_TLS_CONSTRUCT_STOC_SERVER_NAME
 459

	)

362 
	#SSL_F_TLS_CONSTRUCT_STOC_SESSION_TICKET
 460

	)

363 
	#SSL_F_TLS_CONSTRUCT_STOC_STATUS_REQUEST
 461

	)

364 
	#SSL_F_TLS_CONSTRUCT_STOC_SUPPORTED_GROUPS
 544

	)

365 
	#SSL_F_TLS_CONSTRUCT_STOC_SUPPORTED_VERSIONS
 611

	)

366 
	#SSL_F_TLS_CONSTRUCT_STOC_USE_SRTP
 462

	)

367 
	#SSL_F_TLS_EARLY_POST_PROCESS_CLIENT_HELLO
 521

	)

368 
	#SSL_F_TLS_FINISH_HANDSHAKE
 597

	)

369 
	#SSL_F_TLS_GET_MESSAGE_BODY
 351

	)

370 
	#SSL_F_TLS_GET_MESSAGE_HEADER
 387

	)

371 
	#SSL_F_TLS_HANDLE_ALPN
 562

	)

372 
	#SSL_F_TLS_HANDLE_STATUS_REQUEST
 563

	)

373 
	#SSL_F_TLS_PARSE_CERTIFICATE_AUTHORITIES
 566

	)

374 
	#SSL_F_TLS_PARSE_CLIENTHELLO_TLSEXT
 449

	)

375 
	#SSL_F_TLS_PARSE_CTOS_ALPN
 567

	)

376 
	#SSL_F_TLS_PARSE_CTOS_COOKIE
 614

	)

377 
	#SSL_F_TLS_PARSE_CTOS_EARLY_DATA
 568

	)

378 
	#SSL_F_TLS_PARSE_CTOS_EC_PT_FORMATS
 569

	)

379 
	#SSL_F_TLS_PARSE_CTOS_EMS
 570

	)

380 
	#SSL_F_TLS_PARSE_CTOS_KEY_SHARE
 463

	)

381 
	#SSL_F_TLS_PARSE_CTOS_MAXFRAGMENTLEN
 571

	)

382 
	#SSL_F_TLS_PARSE_CTOS_POST_HANDSHAKE_AUTH
 620

	)

383 
	#SSL_F_TLS_PARSE_CTOS_PSK
 505

	)

384 
	#SSL_F_TLS_PARSE_CTOS_PSK_KEX_MODES
 572

	)

385 
	#SSL_F_TLS_PARSE_CTOS_RENEGOTIATE
 464

	)

386 
	#SSL_F_TLS_PARSE_CTOS_SERVER_NAME
 573

	)

387 
	#SSL_F_TLS_PARSE_CTOS_SESSION_TICKET
 574

	)

388 
	#SSL_F_TLS_PARSE_CTOS_SIG_ALGS
 575

	)

389 
	#SSL_F_TLS_PARSE_CTOS_SIG_ALGS_CERT
 615

	)

390 
	#SSL_F_TLS_PARSE_CTOS_SRP
 576

	)

391 
	#SSL_F_TLS_PARSE_CTOS_STATUS_REQUEST
 577

	)

392 
	#SSL_F_TLS_PARSE_CTOS_SUPPORTED_GROUPS
 578

	)

393 
	#SSL_F_TLS_PARSE_CTOS_USE_SRTP
 465

	)

394 
	#SSL_F_TLS_PARSE_STOC_ALPN
 579

	)

395 
	#SSL_F_TLS_PARSE_STOC_COOKIE
 534

	)

396 
	#SSL_F_TLS_PARSE_STOC_EARLY_DATA
 538

	)

397 
	#SSL_F_TLS_PARSE_STOC_EARLY_DATA_INFO
 528

	)

398 
	#SSL_F_TLS_PARSE_STOC_EC_PT_FORMATS
 580

	)

399 
	#SSL_F_TLS_PARSE_STOC_KEY_SHARE
 445

	)

400 
	#SSL_F_TLS_PARSE_STOC_MAXFRAGMENTLEN
 581

	)

401 
	#SSL_F_TLS_PARSE_STOC_NPN
 582

	)

402 
	#SSL_F_TLS_PARSE_STOC_PSK
 502

	)

403 
	#SSL_F_TLS_PARSE_STOC_RENEGOTIATE
 448

	)

404 
	#SSL_F_TLS_PARSE_STOC_SCT
 564

	)

405 
	#SSL_F_TLS_PARSE_STOC_SERVER_NAME
 583

	)

406 
	#SSL_F_TLS_PARSE_STOC_SESSION_TICKET
 584

	)

407 
	#SSL_F_TLS_PARSE_STOC_STATUS_REQUEST
 585

	)

408 
	#SSL_F_TLS_PARSE_STOC_SUPPORTED_VERSIONS
 612

	)

409 
	#SSL_F_TLS_PARSE_STOC_USE_SRTP
 446

	)

410 
	#SSL_F_TLS_POST_PROCESS_CLIENT_HELLO
 378

	)

411 
	#SSL_F_TLS_POST_PROCESS_CLIENT_KEY_EXCHANGE
 384

	)

412 
	#SSL_F_TLS_PREPARE_CLIENT_CERTIFICATE
 360

	)

413 
	#SSL_F_TLS_PROCESS_AS_HELLO_RETRY_REQUEST
 610

	)

414 
	#SSL_F_TLS_PROCESS_CERTIFICATE_REQUEST
 361

	)

415 
	#SSL_F_TLS_PROCESS_CERT_STATUS
 362

	)

416 
	#SSL_F_TLS_PROCESS_CERT_STATUS_BODY
 495

	)

417 
	#SSL_F_TLS_PROCESS_CERT_VERIFY
 379

	)

418 
	#SSL_F_TLS_PROCESS_CHANGE_CIPHER_SPEC
 363

	)

419 
	#SSL_F_TLS_PROCESS_CKE_DHE
 411

	)

420 
	#SSL_F_TLS_PROCESS_CKE_ECDHE
 412

	)

421 
	#SSL_F_TLS_PROCESS_CKE_GOST
 413

	)

422 
	#SSL_F_TLS_PROCESS_CKE_PSK_PREAMBLE
 414

	)

423 
	#SSL_F_TLS_PROCESS_CKE_RSA
 415

	)

424 
	#SSL_F_TLS_PROCESS_CKE_SRP
 416

	)

425 
	#SSL_F_TLS_PROCESS_CLIENT_CERTIFICATE
 380

	)

426 
	#SSL_F_TLS_PROCESS_CLIENT_HELLO
 381

	)

427 
	#SSL_F_TLS_PROCESS_CLIENT_KEY_EXCHANGE
 382

	)

428 
	#SSL_F_TLS_PROCESS_ENCRYPTED_EXTENSIONS
 444

	)

429 
	#SSL_F_TLS_PROCESS_END_OF_EARLY_DATA
 537

	)

430 
	#SSL_F_TLS_PROCESS_FINISHED
 364

	)

431 
	#SSL_F_TLS_PROCESS_HELLO_REQ
 507

	)

432 
	#SSL_F_TLS_PROCESS_HELLO_RETRY_REQUEST
 511

	)

433 
	#SSL_F_TLS_PROCESS_INITIAL_SERVER_FLIGHT
 442

	)

434 
	#SSL_F_TLS_PROCESS_KEY_EXCHANGE
 365

	)

435 
	#SSL_F_TLS_PROCESS_KEY_UPDATE
 518

	)

436 
	#SSL_F_TLS_PROCESS_NEW_SESSION_TICKET
 366

	)

437 
	#SSL_F_TLS_PROCESS_NEXT_PROTO
 383

	)

438 
	#SSL_F_TLS_PROCESS_SERVER_CERTIFICATE
 367

	)

439 
	#SSL_F_TLS_PROCESS_SERVER_DONE
 368

	)

440 
	#SSL_F_TLS_PROCESS_SERVER_HELLO
 369

	)

441 
	#SSL_F_TLS_PROCESS_SKE_DHE
 419

	)

442 
	#SSL_F_TLS_PROCESS_SKE_ECDHE
 420

	)

443 
	#SSL_F_TLS_PROCESS_SKE_PSK_PREAMBLE
 421

	)

444 
	#SSL_F_TLS_PROCESS_SKE_SRP
 422

	)

445 
	#SSL_F_TLS_PSK_DO_BINDER
 506

	)

446 
	#SSL_F_TLS_SCAN_CLIENTHELLO_TLSEXT
 450

	)

447 
	#SSL_F_TLS_SETUP_HANDSHAKE
 508

	)

448 
	#SSL_F_USE_CERTIFICATE_CHAIN_FILE
 220

	)

449 
	#SSL_F_WPACKET_INTERN_INIT_LEN
 633

	)

450 
	#SSL_F_WPACKET_START_SUB_PACKET_LEN__
 634

	)

451 
	#SSL_F_WRITE_STATE_MACHINE
 586

	)

456 
	#SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY
 291

	)

457 
	#SSL_R_APP_DATA_IN_HANDSHAKE
 100

	)

458 
	#SSL_R_ATTEMPT_TO_REUSE_SESSION_IN_DIFFERENT_CONTEXT
 272

	)

459 
	#SSL_R_AT_LEAST_TLS_1_0_NEEDED_IN_FIPS_MODE
 143

	)

460 
	#SSL_R_AT_LEAST_TLS_1_2_NEEDED_IN_SUITEB_MODE
 158

	)

461 
	#SSL_R_BAD_CHANGE_CIPHER_SPEC
 103

	)

462 
	#SSL_R_BAD_CIPHER
 186

	)

463 
	#SSL_R_BAD_DATA
 390

	)

464 
	#SSL_R_BAD_DATA_RETURNED_BY_CALLBACK
 106

	)

465 
	#SSL_R_BAD_DECOMPRESSION
 107

	)

466 
	#SSL_R_BAD_DH_VALUE
 102

	)

467 
	#SSL_R_BAD_DIGEST_LENGTH
 111

	)

468 
	#SSL_R_BAD_EARLY_DATA
 233

	)

469 
	#SSL_R_BAD_ECC_CERT
 304

	)

470 
	#SSL_R_BAD_ECPOINT
 306

	)

471 
	#SSL_R_BAD_EXTENSION
 110

	)

472 
	#SSL_R_BAD_HANDSHAKE_LENGTH
 332

	)

473 
	#SSL_R_BAD_HANDSHAKE_STATE
 236

	)

474 
	#SSL_R_BAD_HELLO_REQUEST
 105

	)

475 
	#SSL_R_BAD_HRR_VERSION
 263

	)

476 
	#SSL_R_BAD_KEY_SHARE
 108

	)

477 
	#SSL_R_BAD_KEY_UPDATE
 122

	)

478 
	#SSL_R_BAD_LEGACY_VERSION
 292

	)

479 
	#SSL_R_BAD_LENGTH
 271

	)

480 
	#SSL_R_BAD_PACKET
 240

	)

481 
	#SSL_R_BAD_PACKET_LENGTH
 115

	)

482 
	#SSL_R_BAD_PROTOCOL_VERSION_NUMBER
 116

	)

483 
	#SSL_R_BAD_PSK
 219

	)

484 
	#SSL_R_BAD_PSK_IDENTITY
 114

	)

485 
	#SSL_R_BAD_RECORD_TYPE
 443

	)

486 
	#SSL_R_BAD_RSA_ENCRYPT
 119

	)

487 
	#SSL_R_BAD_SIGNATURE
 123

	)

488 
	#SSL_R_BAD_SRP_A_LENGTH
 347

	)

489 
	#SSL_R_BAD_SRP_PARAMETERS
 371

	)

490 
	#SSL_R_BAD_SRTP_MKI_VALUE
 352

	)

491 
	#SSL_R_BAD_SRTP_PROTECTION_PROFILE_LIST
 353

	)

492 
	#SSL_R_BAD_SSL_FILETYPE
 124

	)

493 
	#SSL_R_BAD_VALUE
 384

	)

494 
	#SSL_R_BAD_WRITE_RETRY
 127

	)

495 
	#SSL_R_BINDER_DOES_NOT_VERIFY
 253

	)

496 
	#SSL_R_BIO_NOT_SET
 128

	)

497 
	#SSL_R_BLOCK_CIPHER_PAD_IS_WRONG
 129

	)

498 
	#SSL_R_BN_LIB
 130

	)

499 
	#SSL_R_CALLBACK_FAILED
 234

	)

500 
	#SSL_R_CANNOT_CHANGE_CIPHER
 109

	)

501 
	#SSL_R_CA_DN_LENGTH_MISMATCH
 131

	)

502 
	#SSL_R_CA_KEY_TOO_SMALL
 397

	)

503 
	#SSL_R_CA_MD_TOO_WEAK
 398

	)

504 
	#SSL_R_CCS_RECEIVED_EARLY
 133

	)

505 
	#SSL_R_CERTIFICATE_VERIFY_FAILED
 134

	)

506 
	#SSL_R_CERT_CB_ERROR
 377

	)

507 
	#SSL_R_CERT_LENGTH_MISMATCH
 135

	)

508 
	#SSL_R_CIPHERSUITE_DIGEST_HAS_CHANGED
 218

	)

509 
	#SSL_R_CIPHER_CODE_WRONG_LENGTH
 137

	)

510 
	#SSL_R_CIPHER_OR_HASH_UNAVAILABLE
 138

	)

511 
	#SSL_R_CLIENTHELLO_TLSEXT
 226

	)

512 
	#SSL_R_COMPRESSED_LENGTH_TOO_LONG
 140

	)

513 
	#SSL_R_COMPRESSION_DISABLED
 343

	)

514 
	#SSL_R_COMPRESSION_FAILURE
 141

	)

515 
	#SSL_R_COMPRESSION_ID_NOT_WITHIN_PRIVATE_RANGE
 307

	)

516 
	#SSL_R_COMPRESSION_LIBRARY_ERROR
 142

	)

517 
	#SSL_R_CONNECTION_TYPE_NOT_SET
 144

	)

518 
	#SSL_R_CONTEXT_NOT_DANE_ENABLED
 167

	)

519 
	#SSL_R_COOKIE_GEN_CALLBACK_FAILURE
 400

	)

520 
	#SSL_R_COOKIE_MISMATCH
 308

	)

521 
	#SSL_R_CUSTOM_EXT_HANDLER_ALREADY_INSTALLED
 206

	)

522 
	#SSL_R_DANE_ALREADY_ENABLED
 172

	)

523 
	#SSL_R_DANE_CANNOT_OVERRIDE_MTYPE_FULL
 173

	)

524 
	#SSL_R_DANE_NOT_ENABLED
 175

	)

525 
	#SSL_R_DANE_TLSA_BAD_CERTIFICATE
 180

	)

526 
	#SSL_R_DANE_TLSA_BAD_CERTIFICATE_USAGE
 184

	)

527 
	#SSL_R_DANE_TLSA_BAD_DATA_LENGTH
 189

	)

528 
	#SSL_R_DANE_TLSA_BAD_DIGEST_LENGTH
 192

	)

529 
	#SSL_R_DANE_TLSA_BAD_MATCHING_TYPE
 200

	)

530 
	#SSL_R_DANE_TLSA_BAD_PUBLIC_KEY
 201

	)

531 
	#SSL_R_DANE_TLSA_BAD_SELECTOR
 202

	)

532 
	#SSL_R_DANE_TLSA_NULL_DATA
 203

	)

533 
	#SSL_R_DATA_BETWEEN_CCS_AND_FINISHED
 145

	)

534 
	#SSL_R_DATA_LENGTH_TOO_LONG
 146

	)

535 
	#SSL_R_DECRYPTION_FAILED
 147

	)

536 
	#SSL_R_DECRYPTION_FAILED_OR_BAD_RECORD_MAC
 281

	)

537 
	#SSL_R_DH_KEY_TOO_SMALL
 394

	)

538 
	#SSL_R_DH_PUBLIC_VALUE_LENGTH_IS_WRONG
 148

	)

539 
	#SSL_R_DIGEST_CHECK_FAILED
 149

	)

540 
	#SSL_R_DTLS_MESSAGE_TOO_BIG
 334

	)

541 
	#SSL_R_DUPLICATE_COMPRESSION_ID
 309

	)

542 
	#SSL_R_ECC_CERT_NOT_FOR_SIGNING
 318

	)

543 
	#SSL_R_ECDH_REQUIRED_FOR_SUITEB_MODE
 374

	)

544 
	#SSL_R_EE_KEY_TOO_SMALL
 399

	)

545 
	#SSL_R_EMPTY_SRTP_PROTECTION_PROFILE_LIST
 354

	)

546 
	#SSL_R_ENCRYPTED_LENGTH_TOO_LONG
 150

	)

547 
	#SSL_R_ERROR_IN_RECEIVED_CIPHER_LIST
 151

	)

548 
	#SSL_R_ERROR_SETTING_TLSA_BASE_DOMAIN
 204

	)

549 
	#SSL_R_EXCEEDS_MAX_FRAGMENT_SIZE
 194

	)

550 
	#SSL_R_EXCESSIVE_MESSAGE_SIZE
 152

	)

551 
	#SSL_R_EXTENSION_NOT_RECEIVED
 279

	)

552 
	#SSL_R_EXTRA_DATA_IN_MESSAGE
 153

	)

553 
	#SSL_R_EXT_LENGTH_MISMATCH
 163

	)

554 
	#SSL_R_FAILED_TO_INIT_ASYNC
 405

	)

555 
	#SSL_R_FRAGMENTED_CLIENT_HELLO
 401

	)

556 
	#SSL_R_GOT_A_FIN_BEFORE_A_CCS
 154

	)

557 
	#SSL_R_HTTPS_PROXY_REQUEST
 155

	)

558 
	#SSL_R_HTTP_REQUEST
 156

	)

559 
	#SSL_R_ILLEGAL_POINT_COMPRESSION
 162

	)

560 
	#SSL_R_ILLEGAL_SUITEB_DIGEST
 380

	)

561 
	#SSL_R_INAPPROPRIATE_FALLBACK
 373

	)

562 
	#SSL_R_INCONSISTENT_COMPRESSION
 340

	)

563 
	#SSL_R_INCONSISTENT_EARLY_DATA_ALPN
 222

	)

564 
	#SSL_R_INCONSISTENT_EARLY_DATA_SNI
 231

	)

565 
	#SSL_R_INCONSISTENT_EXTMS
 104

	)

566 
	#SSL_R_INSUFFICIENT_SECURITY
 241

	)

567 
	#SSL_R_INVALID_ALERT
 205

	)

568 
	#SSL_R_INVALID_CCS_MESSAGE
 260

	)

569 
	#SSL_R_INVALID_CERTIFICATE_OR_ALG
 238

	)

570 
	#SSL_R_INVALID_COMMAND
 280

	)

571 
	#SSL_R_INVALID_COMPRESSION_ALGORITHM
 341

	)

572 
	#SSL_R_INVALID_CONFIG
 283

	)

573 
	#SSL_R_INVALID_CONFIGURATION_NAME
 113

	)

574 
	#SSL_R_INVALID_CONTEXT
 282

	)

575 
	#SSL_R_INVALID_CT_VALIDATION_TYPE
 212

	)

576 
	#SSL_R_INVALID_KEY_UPDATE_TYPE
 120

	)

577 
	#SSL_R_INVALID_MAX_EARLY_DATA
 174

	)

578 
	#SSL_R_INVALID_NULL_CMD_NAME
 385

	)

579 
	#SSL_R_INVALID_SEQUENCE_NUMBER
 402

	)

580 
	#SSL_R_INVALID_SERVERINFO_DATA
 388

	)

581 
	#SSL_R_INVALID_SESSION_ID
 999

	)

582 
	#SSL_R_INVALID_SRP_USERNAME
 357

	)

583 
	#SSL_R_INVALID_STATUS_RESPONSE
 328

	)

584 
	#SSL_R_INVALID_TICKET_KEYS_LENGTH
 325

	)

585 
	#SSL_R_LENGTH_MISMATCH
 159

	)

586 
	#SSL_R_LENGTH_TOO_LONG
 404

	)

587 
	#SSL_R_LENGTH_TOO_SHORT
 160

	)

588 
	#SSL_R_LIBRARY_BUG
 274

	)

589 
	#SSL_R_LIBRARY_HAS_NO_CIPHERS
 161

	)

590 
	#SSL_R_MISSING_DSA_SIGNING_CERT
 165

	)

591 
	#SSL_R_MISSING_ECDSA_SIGNING_CERT
 381

	)

592 
	#SSL_R_MISSING_FATAL
 256

	)

593 
	#SSL_R_MISSING_PARAMETERS
 290

	)

594 
	#SSL_R_MISSING_RSA_CERTIFICATE
 168

	)

595 
	#SSL_R_MISSING_RSA_ENCRYPTING_CERT
 169

	)

596 
	#SSL_R_MISSING_RSA_SIGNING_CERT
 170

	)

597 
	#SSL_R_MISSING_SIGALGS_EXTENSION
 112

	)

598 
	#SSL_R_MISSING_SIGNING_CERT
 221

	)

599 
	#SSL_R_MISSING_SRP_PARAM
 358

	)

600 
	#SSL_R_MISSING_SUPPORTED_GROUPS_EXTENSION
 209

	)

601 
	#SSL_R_MISSING_TMP_DH_KEY
 171

	)

602 
	#SSL_R_MISSING_TMP_ECDH_KEY
 311

	)

603 
	#SSL_R_MIXED_HANDSHAKE_AND_NON_HANDSHAKE_DATA
 293

	)

604 
	#SSL_R_NOT_ON_RECORD_BOUNDARY
 182

	)

605 
	#SSL_R_NOT_REPLACING_CERTIFICATE
 289

	)

606 
	#SSL_R_NOT_SERVER
 284

	)

607 
	#SSL_R_NO_APPLICATION_PROTOCOL
 235

	)

608 
	#SSL_R_NO_CERTIFICATES_RETURNED
 176

	)

609 
	#SSL_R_NO_CERTIFICATE_ASSIGNED
 177

	)

610 
	#SSL_R_NO_CERTIFICATE_SET
 179

	)

611 
	#SSL_R_NO_CHANGE_FOLLOWING_HRR
 214

	)

612 
	#SSL_R_NO_CIPHERS_AVAILABLE
 181

	)

613 
	#SSL_R_NO_CIPHERS_SPECIFIED
 183

	)

614 
	#SSL_R_NO_CIPHER_MATCH
 185

	)

615 
	#SSL_R_NO_CLIENT_CERT_METHOD
 331

	)

616 
	#SSL_R_NO_COMPRESSION_SPECIFIED
 187

	)

617 
	#SSL_R_NO_COOKIE_CALLBACK_SET
 287

	)

618 
	#SSL_R_NO_GOST_CERTIFICATE_SENT_BY_PEER
 330

	)

619 
	#SSL_R_NO_METHOD_SPECIFIED
 188

	)

620 
	#SSL_R_NO_PEM_EXTENSIONS
 389

	)

621 
	#SSL_R_NO_PRIVATE_KEY_ASSIGNED
 190

	)

622 
	#SSL_R_NO_PROTOCOLS_AVAILABLE
 191

	)

623 
	#SSL_R_NO_RENEGOTIATION
 339

	)

624 
	#SSL_R_NO_REQUIRED_DIGEST
 324

	)

625 
	#SSL_R_NO_SHARED_CIPHER
 193

	)

626 
	#SSL_R_NO_SHARED_GROUPS
 410

	)

627 
	#SSL_R_NO_SHARED_SIGNATURE_ALGORITHMS
 376

	)

628 
	#SSL_R_NO_SRTP_PROFILES
 359

	)

629 
	#SSL_R_NO_SUITABLE_KEY_SHARE
 101

	)

630 
	#SSL_R_NO_SUITABLE_SIGNATURE_ALGORITHM
 118

	)

631 
	#SSL_R_NO_VALID_SCTS
 216

	)

632 
	#SSL_R_NO_VERIFY_COOKIE_CALLBACK
 403

	)

633 
	#SSL_R_NULL_SSL_CTX
 195

	)

634 
	#SSL_R_NULL_SSL_METHOD_PASSED
 196

	)

635 
	#SSL_R_OLD_SESSION_CIPHER_NOT_RETURNED
 197

	)

636 
	#SSL_R_OLD_SESSION_COMPRESSION_ALGORITHM_NOT_RETURNED
 344

	)

637 
	#SSL_R_OVERFLOW_ERROR
 237

	)

638 
	#SSL_R_PACKET_LENGTH_TOO_LONG
 198

	)

639 
	#SSL_R_PARSE_TLSEXT
 227

	)

640 
	#SSL_R_PATH_TOO_LONG
 270

	)

641 
	#SSL_R_PEER_DID_NOT_RETURN_A_CERTIFICATE
 199

	)

642 
	#SSL_R_PEM_NAME_BAD_PREFIX
 391

	)

643 
	#SSL_R_PEM_NAME_TOO_SHORT
 392

	)

644 
	#SSL_R_PIPELINE_FAILURE
 406

	)

645 
	#SSL_R_POST_HANDSHAKE_AUTH_ENCODING_ERR
 278

	)

646 
	#SSL_R_PRIVATE_KEY_MISMATCH
 288

	)

647 
	#SSL_R_PROTOCOL_IS_SHUTDOWN
 207

	)

648 
	#SSL_R_PSK_IDENTITY_NOT_FOUND
 223

	)

649 
	#SSL_R_PSK_NO_CLIENT_CB
 224

	)

650 
	#SSL_R_PSK_NO_SERVER_CB
 225

	)

651 
	#SSL_R_READ_BIO_NOT_SET
 211

	)

652 
	#SSL_R_READ_TIMEOUT_EXPIRED
 312

	)

653 
	#SSL_R_RECORD_LENGTH_MISMATCH
 213

	)

654 
	#SSL_R_RECORD_TOO_SMALL
 298

	)

655 
	#SSL_R_RENEGOTIATE_EXT_TOO_LONG
 335

	)

656 
	#SSL_R_RENEGOTIATION_ENCODING_ERR
 336

	)

657 
	#SSL_R_RENEGOTIATION_MISMATCH
 337

	)

658 
	#SSL_R_REQUEST_PENDING
 285

	)

659 
	#SSL_R_REQUEST_SENT
 286

	)

660 
	#SSL_R_REQUIRED_CIPHER_MISSING
 215

	)

661 
	#SSL_R_REQUIRED_COMPRESSION_ALGORITHM_MISSING
 342

	)

662 
	#SSL_R_SCSV_RECEIVED_WHEN_RENEGOTIATING
 345

	)

663 
	#SSL_R_SCT_VERIFICATION_FAILED
 208

	)

664 
	#SSL_R_SERVERHELLO_TLSEXT
 275

	)

665 
	#SSL_R_SESSION_ID_CONTEXT_UNINITIALIZED
 277

	)

666 
	#SSL_R_SHUTDOWN_WHILE_IN_INIT
 407

	)

667 
	#SSL_R_SIGNATURE_ALGORITHMS_ERROR
 360

	)

668 
	#SSL_R_SIGNATURE_FOR_NON_SIGNING_CERTIFICATE
 220

	)

669 
	#SSL_R_SRP_A_CALC
 361

	)

670 
	#SSL_R_SRTP_COULD_NOT_ALLOCATE_PROFILES
 362

	)

671 
	#SSL_R_SRTP_PROTECTION_PROFILE_LIST_TOO_LONG
 363

	)

672 
	#SSL_R_SRTP_UNKNOWN_PROTECTION_PROFILE
 364

	)

673 
	#SSL_R_SSL3_EXT_INVALID_MAX_FRAGMENT_LENGTH
 232

	)

674 
	#SSL_R_SSL3_EXT_INVALID_SERVERNAME
 319

	)

675 
	#SSL_R_SSL3_EXT_INVALID_SERVERNAME_TYPE
 320

	)

676 
	#SSL_R_SSL3_SESSION_ID_TOO_LONG
 300

	)

677 
	#SSL_R_SSLV3_ALERT_BAD_CERTIFICATE
 1042

	)

678 
	#SSL_R_SSLV3_ALERT_BAD_RECORD_MAC
 1020

	)

679 
	#SSL_R_SSLV3_ALERT_CERTIFICATE_EXPIRED
 1045

	)

680 
	#SSL_R_SSLV3_ALERT_CERTIFICATE_REVOKED
 1044

	)

681 
	#SSL_R_SSLV3_ALERT_CERTIFICATE_UNKNOWN
 1046

	)

682 
	#SSL_R_SSLV3_ALERT_DECOMPRESSION_FAILURE
 1030

	)

683 
	#SSL_R_SSLV3_ALERT_HANDSHAKE_FAILURE
 1040

	)

684 
	#SSL_R_SSLV3_ALERT_ILLEGAL_PARAMETER
 1047

	)

685 
	#SSL_R_SSLV3_ALERT_NO_CERTIFICATE
 1041

	)

686 
	#SSL_R_SSLV3_ALERT_UNEXPECTED_MESSAGE
 1010

	)

687 
	#SSL_R_SSLV3_ALERT_UNSUPPORTED_CERTIFICATE
 1043

	)

688 
	#SSL_R_SSL_COMMAND_SECTION_EMPTY
 117

	)

689 
	#SSL_R_SSL_COMMAND_SECTION_NOT_FOUND
 125

	)

690 
	#SSL_R_SSL_CTX_HAS_NO_DEFAULT_SSL_VERSION
 228

	)

691 
	#SSL_R_SSL_HANDSHAKE_FAILURE
 229

	)

692 
	#SSL_R_SSL_LIBRARY_HAS_NO_CIPHERS
 230

	)

693 
	#SSL_R_SSL_NEGATIVE_LENGTH
 372

	)

694 
	#SSL_R_SSL_SECTION_EMPTY
 126

	)

695 
	#SSL_R_SSL_SECTION_NOT_FOUND
 136

	)

696 
	#SSL_R_SSL_SESSION_ID_CALLBACK_FAILED
 301

	)

697 
	#SSL_R_SSL_SESSION_ID_CONFLICT
 302

	)

698 
	#SSL_R_SSL_SESSION_ID_CONTEXT_TOO_LONG
 273

	)

699 
	#SSL_R_SSL_SESSION_ID_HAS_BAD_LENGTH
 303

	)

700 
	#SSL_R_SSL_SESSION_ID_TOO_LONG
 408

	)

701 
	#SSL_R_SSL_SESSION_VERSION_MISMATCH
 210

	)

702 
	#SSL_R_STILL_IN_INIT
 121

	)

703 
	#SSL_R_TLSV13_ALERT_CERTIFICATE_REQUIRED
 1116

	)

704 
	#SSL_R_TLSV13_ALERT_MISSING_EXTENSION
 1109

	)

705 
	#SSL_R_TLSV1_ALERT_ACCESS_DENIED
 1049

	)

706 
	#SSL_R_TLSV1_ALERT_DECODE_ERROR
 1050

	)

707 
	#SSL_R_TLSV1_ALERT_DECRYPTION_FAILED
 1021

	)

708 
	#SSL_R_TLSV1_ALERT_DECRYPT_ERROR
 1051

	)

709 
	#SSL_R_TLSV1_ALERT_EXPORT_RESTRICTION
 1060

	)

710 
	#SSL_R_TLSV1_ALERT_INAPPROPRIATE_FALLBACK
 1086

	)

711 
	#SSL_R_TLSV1_ALERT_INSUFFICIENT_SECURITY
 1071

	)

712 
	#SSL_R_TLSV1_ALERT_INTERNAL_ERROR
 1080

	)

713 
	#SSL_R_TLSV1_ALERT_NO_RENEGOTIATION
 1100

	)

714 
	#SSL_R_TLSV1_ALERT_PROTOCOL_VERSION
 1070

	)

715 
	#SSL_R_TLSV1_ALERT_RECORD_OVERFLOW
 1022

	)

716 
	#SSL_R_TLSV1_ALERT_UNKNOWN_CA
 1048

	)

717 
	#SSL_R_TLSV1_ALERT_USER_CANCELLED
 1090

	)

718 
	#SSL_R_TLSV1_BAD_CERTIFICATE_HASH_VALUE
 1114

	)

719 
	#SSL_R_TLSV1_BAD_CERTIFICATE_STATUS_RESPONSE
 1113

	)

720 
	#SSL_R_TLSV1_CERTIFICATE_UNOBTAINABLE
 1111

	)

721 
	#SSL_R_TLSV1_UNRECOGNIZED_NAME
 1112

	)

722 
	#SSL_R_TLSV1_UNSUPPORTED_EXTENSION
 1110

	)

723 
	#SSL_R_TLS_HEARTBEAT_PEER_DOESNT_ACCEPT
 365

	)

724 
	#SSL_R_TLS_HEARTBEAT_PENDING
 366

	)

725 
	#SSL_R_TLS_ILLEGAL_EXPORTER_LABEL
 367

	)

726 
	#SSL_R_TLS_INVALID_ECPOINTFORMAT_LIST
 157

	)

727 
	#SSL_R_TOO_MANY_KEY_UPDATES
 132

	)

728 
	#SSL_R_TOO_MANY_WARN_ALERTS
 409

	)

729 
	#SSL_R_TOO_MUCH_EARLY_DATA
 164

	)

730 
	#SSL_R_UNABLE_TO_FIND_ECDH_PARAMETERS
 314

	)

731 
	#SSL_R_UNABLE_TO_FIND_PUBLIC_KEY_PARAMETERS
 239

	)

732 
	#SSL_R_UNABLE_TO_LOAD_SSL3_MD5_ROUTINES
 242

	)

733 
	#SSL_R_UNABLE_TO_LOAD_SSL3_SHA1_ROUTINES
 243

	)

734 
	#SSL_R_UNEXPECTED_CCS_MESSAGE
 262

	)

735 
	#SSL_R_UNEXPECTED_END_OF_EARLY_DATA
 178

	)

736 
	#SSL_R_UNEXPECTED_MESSAGE
 244

	)

737 
	#SSL_R_UNEXPECTED_RECORD
 245

	)

738 
	#SSL_R_UNINITIALIZED
 276

	)

739 
	#SSL_R_UNKNOWN_ALERT_TYPE
 246

	)

740 
	#SSL_R_UNKNOWN_CERTIFICATE_TYPE
 247

	)

741 
	#SSL_R_UNKNOWN_CIPHER_RETURNED
 248

	)

742 
	#SSL_R_UNKNOWN_CIPHER_TYPE
 249

	)

743 
	#SSL_R_UNKNOWN_CMD_NAME
 386

	)

744 
	#SSL_R_UNKNOWN_COMMAND
 139

	)

745 
	#SSL_R_UNKNOWN_DIGEST
 368

	)

746 
	#SSL_R_UNKNOWN_KEY_EXCHANGE_TYPE
 250

	)

747 
	#SSL_R_UNKNOWN_PKEY_TYPE
 251

	)

748 
	#SSL_R_UNKNOWN_PROTOCOL
 252

	)

749 
	#SSL_R_UNKNOWN_SSL_VERSION
 254

	)

750 
	#SSL_R_UNKNOWN_STATE
 255

	)

751 
	#SSL_R_UNSAFE_LEGACY_RENEGOTIATION_DISABLED
 338

	)

752 
	#SSL_R_UNSOLICITED_EXTENSION
 217

	)

753 
	#SSL_R_UNSUPPORTED_COMPRESSION_ALGORITHM
 257

	)

754 
	#SSL_R_UNSUPPORTED_ELLIPTIC_CURVE
 315

	)

755 
	#SSL_R_UNSUPPORTED_PROTOCOL
 258

	)

756 
	#SSL_R_UNSUPPORTED_SSL_VERSION
 259

	)

757 
	#SSL_R_UNSUPPORTED_STATUS_TYPE
 329

	)

758 
	#SSL_R_USE_SRTP_NOT_NEGOTIATED
 369

	)

759 
	#SSL_R_VERSION_TOO_HIGH
 166

	)

760 
	#SSL_R_VERSION_TOO_LOW
 396

	)

761 
	#SSL_R_WRONG_CERTIFICATE_TYPE
 383

	)

762 
	#SSL_R_WRONG_CIPHER_RETURNED
 261

	)

763 
	#SSL_R_WRONG_CURVE
 378

	)

764 
	#SSL_R_WRONG_SIGNATURE_LENGTH
 264

	)

765 
	#SSL_R_WRONG_SIGNATURE_SIZE
 265

	)

766 
	#SSL_R_WRONG_SIGNATURE_TYPE
 370

	)

767 
	#SSL_R_WRONG_SSL_VERSION
 266

	)

768 
	#SSL_R_WRONG_VERSION_NUMBER
 267

	)

769 
	#SSL_R_X509_LIB
 268

	)

770 
	#SSL_R_X509_VERIFICATION_SETUP_PROBLEMS
 269

	)

	@/usr/include/openssl/symhacks.h

10 #i‚de‡
HEADER_SYMHACKS_H


11 
	#HEADER_SYMHACKS_H


	)

13 
	~<›ís¶/e_os2.h
>

16 #i‡
deföed
(
OPENSSL_SYS_VMS
)

17 #unde‡
ERR_lﬂd_CRYPTO_°rögs


18 
	#ERR_lﬂd_CRYPTO_°rögs
 
ERR_lﬂd_CRYPTOlib_°rögs


	)

19 #unde‡
OCSP_¸lID_√w


20 
	#OCSP_¸lID_√w
 
OCSP_¸lID2_√w


	)

22 #unde‡
d2i_ECPARAMETERS


23 
	#d2i_ECPARAMETERS
 
d2i_UC_ECPARAMETERS


	)

24 #unde‡
i2d_ECPARAMETERS


25 
	#i2d_ECPARAMETERS
 
i2d_UC_ECPARAMETERS


	)

26 #unde‡
d2i_ECPKPARAMETERS


27 
	#d2i_ECPKPARAMETERS
 
d2i_UC_ECPKPARAMETERS


	)

28 #unde‡
i2d_ECPKPARAMETERS


29 
	#i2d_ECPKPARAMETERS
 
i2d_UC_ECPKPARAMETERS


	)

32 #unde‡
cms_D©a_¸óã


33 
	#cms_D©a_¸óã
 
¥iv_cms_D©a_¸óã


	)

	@/usr/include/openssl/tls1.h

12 #i‚de‡
HEADER_TLS1_H


13 
	#HEADER_TLS1_H


	)

15 
	~<›ís¶/buf„r.h
>

16 
	~<›ís¶/x509.h
>

18 #ifde‡ 
__˝lu•lus


23 #i‚de‡
OPENSSL_TLS_SECURITY_LEVEL


24 
	#OPENSSL_TLS_SECURITY_LEVEL
 1

	)

27 
	#TLS1_VERSION
 0x0301

	)

28 
	#TLS1_1_VERSION
 0x0302

	)

29 
	#TLS1_2_VERSION
 0x0303

	)

30 
	#TLS1_3_VERSION
 0x0304

	)

31 
	#TLS_MAX_VERSION
 
TLS1_3_VERSION


	)

34 
	#TLS_ANY_VERSION
 0x10000

	)

36 
	#TLS1_VERSION_MAJOR
 0x03

	)

37 
	#TLS1_VERSION_MINOR
 0x01

	)

39 
	#TLS1_1_VERSION_MAJOR
 0x03

	)

40 
	#TLS1_1_VERSION_MINOR
 0x02

	)

42 
	#TLS1_2_VERSION_MAJOR
 0x03

	)

43 
	#TLS1_2_VERSION_MINOR
 0x03

	)

45 
	#TLS1_gë_vîsi⁄
(
s
) \

46 ((
	`SSL_vîsi⁄
(
s
Ë>> 8Ë=
TLS1_VERSION_MAJOR
 ? SSL_vîsi⁄(sË: 0)

	)

48 
	#TLS1_gë_˛õ¡_vîsi⁄
(
s
) \

49 ((
	`SSL_˛õ¡_vîsi⁄
(
s
Ë>> 8Ë=
TLS1_VERSION_MAJOR
 ? SSL_˛õ¡_vîsi⁄(sË: 0)

	)

51 
	#TLS1_AD_DECRYPTION_FAILED
 21

	)

52 
	#TLS1_AD_RECORD_OVERFLOW
 22

	)

53 
	#TLS1_AD_UNKNOWN_CA
 48

	)

54 
	#TLS1_AD_ACCESS_DENIED
 49

	)

55 
	#TLS1_AD_DECODE_ERROR
 50

	)

56 
	#TLS1_AD_DECRYPT_ERROR
 51

	)

57 
	#TLS1_AD_EXPORT_RESTRICTION
 60

	)

58 
	#TLS1_AD_PROTOCOL_VERSION
 70

	)

59 
	#TLS1_AD_INSUFFICIENT_SECURITY
 71

	)

60 
	#TLS1_AD_INTERNAL_ERROR
 80

	)

61 
	#TLS1_AD_INAPPROPRIATE_FALLBACK
 86

	)

62 
	#TLS1_AD_USER_CANCELLED
 90

	)

63 
	#TLS1_AD_NO_RENEGOTIATION
 100

	)

65 
	#TLS13_AD_MISSING_EXTENSION
 109

	)

66 
	#TLS13_AD_CERTIFICATE_REQUIRED
 116

	)

68 
	#TLS1_AD_UNSUPPORTED_EXTENSION
 110

	)

69 
	#TLS1_AD_CERTIFICATE_UNOBTAINABLE
 111

	)

70 
	#TLS1_AD_UNRECOGNIZED_NAME
 112

	)

71 
	#TLS1_AD_BAD_CERTIFICATE_STATUS_RESPONSE
 113

	)

72 
	#TLS1_AD_BAD_CERTIFICATE_HASH_VALUE
 114

	)

73 
	#TLS1_AD_UNKNOWN_PSK_IDENTITY
 115

	)

74 
	#TLS1_AD_NO_APPLICATION_PROTOCOL
 120

	)

77 
	#TLSEXT_TYPE_£rvî_«me
 0

	)

78 
	#TLSEXT_TYPE_max_‰agmít_Àngth
 1

	)

79 
	#TLSEXT_TYPE_˛õ¡_˚πifiˇã_uæ
 2

	)

80 
	#TLSEXT_TYPE_åu°ed_ˇ_keys
 3

	)

81 
	#TLSEXT_TYPE_åunˇãd_hmac
 4

	)

82 
	#TLSEXT_TYPE_°©us_ªque°
 5

	)

84 
	#TLSEXT_TYPE_u£r_m≠pög
 6

	)

86 
	#TLSEXT_TYPE_˛õ¡_authz
 7

	)

87 
	#TLSEXT_TYPE_£rvî_authz
 8

	)

89 
	#TLSEXT_TYPE_˚π_ty≥
 9

	)

96 
	#TLSEXT_TYPE_suµ‹ãd_groups
 10

	)

97 
	#TLSEXT_TYPE_ñlùtic_curves
 
TLSEXT_TYPE_suµ‹ãd_groups


	)

98 
	#TLSEXT_TYPE_ec_poöt_f‹m©s
 11

	)

102 
	#TLSEXT_TYPE_§p
 12

	)

105 
	#TLSEXT_TYPE_sig«tuª_Æg‹ôhms
 13

	)

108 
	#TLSEXT_TYPE_u£_§ç
 14

	)

111 
	#TLSEXT_TYPE_hóπbót
 15

	)

114 
	#TLSEXT_TYPE_≠∂iˇti⁄_œyî_¥Ÿocﬁ_√gŸüti⁄
 16

	)

120 
	#TLSEXT_TYPE_sig√d_˚πifiˇã_time°amp
 18

	)

126 
	#TLSEXT_TYPE_∑ddög
 21

	)

129 
	#TLSEXT_TYPE_í¸y±_thí_mac
 22

	)

132 
	#TLSEXT_TYPE_exãnded_ma°î_£¸ë
 23

	)

135 
	#TLSEXT_TYPE_£ssi⁄_tickë
 35

	)

138 
	#TLSEXT_TYPE_psk
 41

	)

139 
	#TLSEXT_TYPE_óæy_d©a
 42

	)

140 
	#TLSEXT_TYPE_suµ‹ãd_vîsi⁄s
 43

	)

141 
	#TLSEXT_TYPE_cookõ
 44

	)

142 
	#TLSEXT_TYPE_psk_kex_modes
 45

	)

143 
	#TLSEXT_TYPE_˚πifiˇã_auth‹ôõs
 47

	)

144 
	#TLSEXT_TYPE_po°_h™dshake_auth
 49

	)

145 
	#TLSEXT_TYPE_sig«tuª_Æg‹ôhms_˚π
 50

	)

146 
	#TLSEXT_TYPE_key_sh¨e
 51

	)

149 
	#TLSEXT_TYPE_ª√gŸüã
 0xff01

	)

151 #i‚de‡
OPENSSL_NO_NEXTPROTONEG


153 
	#TLSEXT_TYPE_√xt_¥Ÿo_√g
 13172

	)

157 
	#TLSEXT_NAMETYPE_ho°_«me
 0

	)

159 
	#TLSEXT_STATUSTYPE_oc•
 1

	)

162 
	#TLSEXT_ECPOINTFORMAT_fú°
 0

	)

163 
	#TLSEXT_ECPOINTFORMAT_uncom¥es£d
 0

	)

164 
	#TLSEXT_ECPOINTFORMAT_™siX962_com¥es£d_¥ime
 1

	)

165 
	#TLSEXT_ECPOINTFORMAT_™siX962_com¥es£d_ch¨2
 2

	)

166 
	#TLSEXT_ECPOINTFORMAT_œ°
 2

	)

169 
	#TLSEXT_sig«tuª_™⁄ymous
 0

	)

170 
	#TLSEXT_sig«tuª_rß
 1

	)

171 
	#TLSEXT_sig«tuª_dß
 2

	)

172 
	#TLSEXT_sig«tuª_ecdß
 3

	)

173 
	#TLSEXT_sig«tuª_go°r34102001
 237

	)

174 
	#TLSEXT_sig«tuª_go°r34102012_256
 238

	)

175 
	#TLSEXT_sig«tuª_go°r34102012_512
 239

	)

178 
	#TLSEXT_sig«tuª_num
 7

	)

180 
	#TLSEXT_hash_n⁄e
 0

	)

181 
	#TLSEXT_hash_md5
 1

	)

182 
	#TLSEXT_hash_sha1
 2

	)

183 
	#TLSEXT_hash_sha224
 3

	)

184 
	#TLSEXT_hash_sha256
 4

	)

185 
	#TLSEXT_hash_sha384
 5

	)

186 
	#TLSEXT_hash_sha512
 6

	)

187 
	#TLSEXT_hash_go°r3411
 237

	)

188 
	#TLSEXT_hash_go°r34112012_256
 238

	)

189 
	#TLSEXT_hash_go°r34112012_512
 239

	)

193 
	#TLSEXT_hash_num
 10

	)

196 
	#TLSEXT_nid_unknown
 0x1000000

	)

200 
	#TLSEXT_curve_P_256
 23

	)

201 
	#TLSEXT_curve_P_384
 24

	)

204 
	#TLSEXT_max_‰agmít_Àngth_DISABLED
 0

	)

206 
	#TLSEXT_max_‰agmít_Àngth_512
 1

	)

207 
	#TLSEXT_max_‰agmít_Àngth_1024
 2

	)

208 
	#TLSEXT_max_‰agmít_Àngth_2048
 3

	)

209 
	#TLSEXT_max_‰agmít_Àngth_4096
 4

	)

211 
SSL_CTX_£t_é£xt_max_‰agmít_Àngth
(
SSL_CTX
 *
˘x
, 
uöt8_t
 
mode
);

212 
SSL_£t_é£xt_max_‰agmít_Àngth
(
SSL
 *
s¶
, 
uöt8_t
 
mode
);

214 
	#TLSEXT_MAXLEN_ho°_«me
 255

	)

216 
__owur
 c⁄° *
SSL_gë_£rvî«me
(c⁄° 
SSL
 *
s
, c⁄° 
ty≥
);

217 
__owur
 
SSL_gë_£rvî«me_ty≥
(c⁄° 
SSL
 *
s
);

225 
__owur
 
SSL_exp‹t_keyög_m©îül
(
SSL
 *
s
, *
out
, 
size_t
 
ﬁí
,

226 c⁄° *
œbñ
, 
size_t
 
Œí
,

227 c⁄° *
c⁄ãxt
,

228 
size_t
 
c⁄ãxéí
, 
u£_c⁄ãxt
);

237 
__owur
 
SSL_exp‹t_keyög_m©îül_óæy
(
SSL
 *
s
, *
out
,

238 
size_t
 
ﬁí
, c⁄° *
œbñ
,

239 
size_t
 
Œí
,

240 c⁄° *
c⁄ãxt
,

241 
size_t
 
c⁄ãxéí
);

243 
SSL_gë_≥î_sig«tuª_ty≥_nid
(c⁄° 
SSL
 *
s
, *
≤id
);

244 
SSL_gë_sig«tuª_ty≥_nid
(c⁄° 
SSL
 *
s
, *
≤id
);

246 
SSL_gë_sigÆgs
(
SSL
 *
s
, 
idx
,

247 *
psign
, *
phash
, *
psig«ndhash
,

248 *
rsig
, *
rhash
);

250 
SSL_gë_sh¨ed_sigÆgs
(
SSL
 *
s
, 
idx
,

251 *
psign
, *
phash
, *
psig«ndhash
,

252 *
rsig
, *
rhash
);

254 
__owur
 
SSL_check_chaö
(
SSL
 *
s
, 
X509
 *
x
, 
EVP_PKEY
 *
pk
, 
STACK_OF
(X509Ë*
chaö
);

256 
	#SSL_£t_é£xt_ho°_«me
(
s
,
«me
) \

257 
	`SSL_˘æ
(
s
,
SSL_CTRL_SET_TLSEXT_HOSTNAME
,
TLSEXT_NAMETYPE_ho°_«me
,\

258 (*)
«me
)

	)

260 
	#SSL_£t_é£xt_debug_ˇŒback
(
s¶
, 
cb
) \

261 
	`SSL_ˇŒback_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_DEBUG_CB
,\

262 ((*)())
cb
)

	)

264 
	#SSL_£t_é£xt_debug_¨g
(
s¶
, 
¨g
) \

265 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_DEBUG_ARG
,0,
¨g
)

	)

267 
	#SSL_gë_é£xt_°©us_ty≥
(
s¶
) \

268 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_GET_TLSEXT_STATUS_REQ_TYPE
,0,
NULL
)

	)

270 
	#SSL_£t_é£xt_°©us_ty≥
(
s¶
, 
ty≥
) \

271 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_STATUS_REQ_TYPE
,
ty≥
,
NULL
)

	)

273 
	#SSL_gë_é£xt_°©us_exts
(
s¶
, 
¨g
) \

274 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_GET_TLSEXT_STATUS_REQ_EXTS
,0,
¨g
)

	)

276 
	#SSL_£t_é£xt_°©us_exts
(
s¶
, 
¨g
) \

277 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_STATUS_REQ_EXTS
,0,
¨g
)

	)

279 
	#SSL_gë_é£xt_°©us_ids
(
s¶
, 
¨g
) \

280 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_GET_TLSEXT_STATUS_REQ_IDS
,0,
¨g
)

	)

282 
	#SSL_£t_é£xt_°©us_ids
(
s¶
, 
¨g
) \

283 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_STATUS_REQ_IDS
,0,
¨g
)

	)

285 
	#SSL_gë_é£xt_°©us_oc•_ª•
(
s¶
, 
¨g
) \

286 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_GET_TLSEXT_STATUS_REQ_OCSP_RESP
,0,
¨g
)

	)

288 
	#SSL_£t_é£xt_°©us_oc•_ª•
(
s¶
, 
¨g
, 
¨gÀn
) \

289 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_STATUS_REQ_OCSP_RESP
,
¨gÀn
,
¨g
)

	)

291 
	#SSL_CTX_£t_é£xt_£rvî«me_ˇŒback
(
˘x
, 
cb
) \

292 
	`SSL_CTX_ˇŒback_˘æ
(
˘x
,
SSL_CTRL_SET_TLSEXT_SERVERNAME_CB
,\

293 ((*)())
cb
)

	)

295 
	#SSL_TLSEXT_ERR_OK
 0

	)

296 
	#SSL_TLSEXT_ERR_ALERT_WARNING
 1

	)

297 
	#SSL_TLSEXT_ERR_ALERT_FATAL
 2

	)

298 
	#SSL_TLSEXT_ERR_NOACK
 3

	)

300 
	#SSL_CTX_£t_é£xt_£rvî«me_¨g
(
˘x
, 
¨g
) \

301 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_TLSEXT_SERVERNAME_ARG
,0,
¨g
)

	)

303 
	#SSL_CTX_gë_é£xt_tickë_keys
(
˘x
, 
keys
, 
keyÀn
) \

304 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_GET_TLSEXT_TICKET_KEYS
,
keyÀn
,
keys
)

	)

305 
	#SSL_CTX_£t_é£xt_tickë_keys
(
˘x
, 
keys
, 
keyÀn
) \

306 
	`SSL_CTX_˘æ
(
˘x
,
SSL_CTRL_SET_TLSEXT_TICKET_KEYS
,
keyÀn
,
keys
)

	)

308 
	#SSL_CTX_gë_é£xt_°©us_cb
(
s¶
, 
cb
) \

309 
	`SSL_CTX_˘æ
(
s¶
,
SSL_CTRL_GET_TLSEXT_STATUS_REQ_CB
,0,(*)
cb
)

	)

310 
	#SSL_CTX_£t_é£xt_°©us_cb
(
s¶
, 
cb
) \

311 
	`SSL_CTX_ˇŒback_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_STATUS_REQ_CB
,\

312 ((*)())
cb
)

	)

314 
	#SSL_CTX_gë_é£xt_°©us_¨g
(
s¶
, 
¨g
) \

315 
	`SSL_CTX_˘æ
(
s¶
,
SSL_CTRL_GET_TLSEXT_STATUS_REQ_CB_ARG
,0,
¨g
)

	)

316 
	#SSL_CTX_£t_é£xt_°©us_¨g
(
s¶
, 
¨g
) \

317 
	`SSL_CTX_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_STATUS_REQ_CB_ARG
,0,
¨g
)

	)

319 
	#SSL_CTX_£t_é£xt_°©us_ty≥
(
s¶
, 
ty≥
) \

320 
	`SSL_CTX_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_STATUS_REQ_TYPE
,
ty≥
,
NULL
)

	)

322 
	#SSL_CTX_gë_é£xt_°©us_ty≥
(
s¶
) \

323 
	`SSL_CTX_˘æ
(
s¶
,
SSL_CTRL_GET_TLSEXT_STATUS_REQ_TYPE
,0,
NULL
)

	)

325 
	#SSL_CTX_£t_é£xt_tickë_key_cb
(
s¶
, 
cb
) \

326 
	`SSL_CTX_ˇŒback_˘æ
(
s¶
,
SSL_CTRL_SET_TLSEXT_TICKET_KEY_CB
,\

327 ((*)())
cb
)

	)

329 #i‚de‡
OPENSSL_NO_HEARTBEATS


330 
	#SSL_DTLSEXT_HB_ENABLED
 0x01

	)

331 
	#SSL_DTLSEXT_HB_DONT_SEND_REQUESTS
 0x02

	)

332 
	#SSL_DTLSEXT_HB_DONT_RECV_REQUESTS
 0x04

	)

333 
	#SSL_gë_dé£xt_hóπbót_≥ndög
(
s¶
) \

334 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_GET_DTLS_EXT_HEARTBEAT_PENDING
,0,
NULL
)

	)

335 
	#SSL_£t_dé£xt_hóπbót_no_ªque°s
(
s¶
, 
¨g
) \

336 
	`SSL_˘æ
(
s¶
,
SSL_CTRL_SET_DTLS_EXT_HEARTBEAT_NO_REQUESTS
,
¨g
,
NULL
)

	)

338 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

339 
	#SSL_CTRL_TLS_EXT_SEND_HEARTBEAT
 \

340 
SSL_CTRL_DTLS_EXT_SEND_HEARTBEAT


	)

341 
	#SSL_CTRL_GET_TLS_EXT_HEARTBEAT_PENDING
 \

342 
SSL_CTRL_GET_DTLS_EXT_HEARTBEAT_PENDING


	)

343 
	#SSL_CTRL_SET_TLS_EXT_HEARTBEAT_NO_REQUESTS
 \

344 
SSL_CTRL_SET_DTLS_EXT_HEARTBEAT_NO_REQUESTS


	)

345 
	#SSL_TLSEXT_HB_ENABLED
 \

346 
SSL_DTLSEXT_HB_ENABLED


	)

347 
	#SSL_TLSEXT_HB_DONT_SEND_REQUESTS
 \

348 
SSL_DTLSEXT_HB_DONT_SEND_REQUESTS


	)

349 
	#SSL_TLSEXT_HB_DONT_RECV_REQUESTS
 \

350 
SSL_DTLSEXT_HB_DONT_RECV_REQUESTS


	)

351 
	#SSL_gë_é£xt_hóπbót_≥ndög
(
s¶
) \

352 
	`SSL_gë_dé£xt_hóπbót_≥ndög
(
s¶
)

	)

353 
	#SSL_£t_é£xt_hóπbót_no_ªque°s
(
s¶
, 
¨g
) \

354 
	`SSL_£t_dé£xt_hóπbót_no_ªque°s
(
s¶
,
¨g
)

	)

359 
	#TLS1_CK_PSK_WITH_RC4_128_SHA
 0x0300008A

	)

360 
	#TLS1_CK_PSK_WITH_3DES_EDE_CBC_SHA
 0x0300008B

	)

361 
	#TLS1_CK_PSK_WITH_AES_128_CBC_SHA
 0x0300008C

	)

362 
	#TLS1_CK_PSK_WITH_AES_256_CBC_SHA
 0x0300008D

	)

363 
	#TLS1_CK_DHE_PSK_WITH_RC4_128_SHA
 0x0300008E

	)

364 
	#TLS1_CK_DHE_PSK_WITH_3DES_EDE_CBC_SHA
 0x0300008F

	)

365 
	#TLS1_CK_DHE_PSK_WITH_AES_128_CBC_SHA
 0x03000090

	)

366 
	#TLS1_CK_DHE_PSK_WITH_AES_256_CBC_SHA
 0x03000091

	)

367 
	#TLS1_CK_RSA_PSK_WITH_RC4_128_SHA
 0x03000092

	)

368 
	#TLS1_CK_RSA_PSK_WITH_3DES_EDE_CBC_SHA
 0x03000093

	)

369 
	#TLS1_CK_RSA_PSK_WITH_AES_128_CBC_SHA
 0x03000094

	)

370 
	#TLS1_CK_RSA_PSK_WITH_AES_256_CBC_SHA
 0x03000095

	)

373 
	#TLS1_CK_PSK_WITH_AES_128_GCM_SHA256
 0x030000A8

	)

374 
	#TLS1_CK_PSK_WITH_AES_256_GCM_SHA384
 0x030000A9

	)

375 
	#TLS1_CK_DHE_PSK_WITH_AES_128_GCM_SHA256
 0x030000AA

	)

376 
	#TLS1_CK_DHE_PSK_WITH_AES_256_GCM_SHA384
 0x030000AB

	)

377 
	#TLS1_CK_RSA_PSK_WITH_AES_128_GCM_SHA256
 0x030000AC

	)

378 
	#TLS1_CK_RSA_PSK_WITH_AES_256_GCM_SHA384
 0x030000AD

	)

379 
	#TLS1_CK_PSK_WITH_AES_128_CBC_SHA256
 0x030000AE

	)

380 
	#TLS1_CK_PSK_WITH_AES_256_CBC_SHA384
 0x030000AF

	)

381 
	#TLS1_CK_PSK_WITH_NULL_SHA256
 0x030000B0

	)

382 
	#TLS1_CK_PSK_WITH_NULL_SHA384
 0x030000B1

	)

383 
	#TLS1_CK_DHE_PSK_WITH_AES_128_CBC_SHA256
 0x030000B2

	)

384 
	#TLS1_CK_DHE_PSK_WITH_AES_256_CBC_SHA384
 0x030000B3

	)

385 
	#TLS1_CK_DHE_PSK_WITH_NULL_SHA256
 0x030000B4

	)

386 
	#TLS1_CK_DHE_PSK_WITH_NULL_SHA384
 0x030000B5

	)

387 
	#TLS1_CK_RSA_PSK_WITH_AES_128_CBC_SHA256
 0x030000B6

	)

388 
	#TLS1_CK_RSA_PSK_WITH_AES_256_CBC_SHA384
 0x030000B7

	)

389 
	#TLS1_CK_RSA_PSK_WITH_NULL_SHA256
 0x030000B8

	)

390 
	#TLS1_CK_RSA_PSK_WITH_NULL_SHA384
 0x030000B9

	)

393 
	#TLS1_CK_PSK_WITH_NULL_SHA
 0x0300002C

	)

394 
	#TLS1_CK_DHE_PSK_WITH_NULL_SHA
 0x0300002D

	)

395 
	#TLS1_CK_RSA_PSK_WITH_NULL_SHA
 0x0300002E

	)

398 
	#TLS1_CK_RSA_WITH_AES_128_SHA
 0x0300002F

	)

399 
	#TLS1_CK_DH_DSS_WITH_AES_128_SHA
 0x03000030

	)

400 
	#TLS1_CK_DH_RSA_WITH_AES_128_SHA
 0x03000031

	)

401 
	#TLS1_CK_DHE_DSS_WITH_AES_128_SHA
 0x03000032

	)

402 
	#TLS1_CK_DHE_RSA_WITH_AES_128_SHA
 0x03000033

	)

403 
	#TLS1_CK_ADH_WITH_AES_128_SHA
 0x03000034

	)

404 
	#TLS1_CK_RSA_WITH_AES_256_SHA
 0x03000035

	)

405 
	#TLS1_CK_DH_DSS_WITH_AES_256_SHA
 0x03000036

	)

406 
	#TLS1_CK_DH_RSA_WITH_AES_256_SHA
 0x03000037

	)

407 
	#TLS1_CK_DHE_DSS_WITH_AES_256_SHA
 0x03000038

	)

408 
	#TLS1_CK_DHE_RSA_WITH_AES_256_SHA
 0x03000039

	)

409 
	#TLS1_CK_ADH_WITH_AES_256_SHA
 0x0300003A

	)

412 
	#TLS1_CK_RSA_WITH_NULL_SHA256
 0x0300003B

	)

413 
	#TLS1_CK_RSA_WITH_AES_128_SHA256
 0x0300003C

	)

414 
	#TLS1_CK_RSA_WITH_AES_256_SHA256
 0x0300003D

	)

415 
	#TLS1_CK_DH_DSS_WITH_AES_128_SHA256
 0x0300003E

	)

416 
	#TLS1_CK_DH_RSA_WITH_AES_128_SHA256
 0x0300003F

	)

417 
	#TLS1_CK_DHE_DSS_WITH_AES_128_SHA256
 0x03000040

	)

420 
	#TLS1_CK_RSA_WITH_CAMELLIA_128_CBC_SHA
 0x03000041

	)

421 
	#TLS1_CK_DH_DSS_WITH_CAMELLIA_128_CBC_SHA
 0x03000042

	)

422 
	#TLS1_CK_DH_RSA_WITH_CAMELLIA_128_CBC_SHA
 0x03000043

	)

423 
	#TLS1_CK_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA
 0x03000044

	)

424 
	#TLS1_CK_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA
 0x03000045

	)

425 
	#TLS1_CK_ADH_WITH_CAMELLIA_128_CBC_SHA
 0x03000046

	)

428 
	#TLS1_CK_DHE_RSA_WITH_AES_128_SHA256
 0x03000067

	)

429 
	#TLS1_CK_DH_DSS_WITH_AES_256_SHA256
 0x03000068

	)

430 
	#TLS1_CK_DH_RSA_WITH_AES_256_SHA256
 0x03000069

	)

431 
	#TLS1_CK_DHE_DSS_WITH_AES_256_SHA256
 0x0300006A

	)

432 
	#TLS1_CK_DHE_RSA_WITH_AES_256_SHA256
 0x0300006B

	)

433 
	#TLS1_CK_ADH_WITH_AES_128_SHA256
 0x0300006C

	)

434 
	#TLS1_CK_ADH_WITH_AES_256_SHA256
 0x0300006D

	)

437 
	#TLS1_CK_RSA_WITH_CAMELLIA_256_CBC_SHA
 0x03000084

	)

438 
	#TLS1_CK_DH_DSS_WITH_CAMELLIA_256_CBC_SHA
 0x03000085

	)

439 
	#TLS1_CK_DH_RSA_WITH_CAMELLIA_256_CBC_SHA
 0x03000086

	)

440 
	#TLS1_CK_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA
 0x03000087

	)

441 
	#TLS1_CK_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA
 0x03000088

	)

442 
	#TLS1_CK_ADH_WITH_CAMELLIA_256_CBC_SHA
 0x03000089

	)

445 
	#TLS1_CK_RSA_WITH_SEED_SHA
 0x03000096

	)

446 
	#TLS1_CK_DH_DSS_WITH_SEED_SHA
 0x03000097

	)

447 
	#TLS1_CK_DH_RSA_WITH_SEED_SHA
 0x03000098

	)

448 
	#TLS1_CK_DHE_DSS_WITH_SEED_SHA
 0x03000099

	)

449 
	#TLS1_CK_DHE_RSA_WITH_SEED_SHA
 0x0300009A

	)

450 
	#TLS1_CK_ADH_WITH_SEED_SHA
 0x0300009B

	)

453 
	#TLS1_CK_RSA_WITH_AES_128_GCM_SHA256
 0x0300009C

	)

454 
	#TLS1_CK_RSA_WITH_AES_256_GCM_SHA384
 0x0300009D

	)

455 
	#TLS1_CK_DHE_RSA_WITH_AES_128_GCM_SHA256
 0x0300009E

	)

456 
	#TLS1_CK_DHE_RSA_WITH_AES_256_GCM_SHA384
 0x0300009F

	)

457 
	#TLS1_CK_DH_RSA_WITH_AES_128_GCM_SHA256
 0x030000A0

	)

458 
	#TLS1_CK_DH_RSA_WITH_AES_256_GCM_SHA384
 0x030000A1

	)

459 
	#TLS1_CK_DHE_DSS_WITH_AES_128_GCM_SHA256
 0x030000A2

	)

460 
	#TLS1_CK_DHE_DSS_WITH_AES_256_GCM_SHA384
 0x030000A3

	)

461 
	#TLS1_CK_DH_DSS_WITH_AES_128_GCM_SHA256
 0x030000A4

	)

462 
	#TLS1_CK_DH_DSS_WITH_AES_256_GCM_SHA384
 0x030000A5

	)

463 
	#TLS1_CK_ADH_WITH_AES_128_GCM_SHA256
 0x030000A6

	)

464 
	#TLS1_CK_ADH_WITH_AES_256_GCM_SHA384
 0x030000A7

	)

467 
	#TLS1_CK_RSA_WITH_AES_128_CCM
 0x0300C09C

	)

468 
	#TLS1_CK_RSA_WITH_AES_256_CCM
 0x0300C09D

	)

469 
	#TLS1_CK_DHE_RSA_WITH_AES_128_CCM
 0x0300C09E

	)

470 
	#TLS1_CK_DHE_RSA_WITH_AES_256_CCM
 0x0300C09F

	)

471 
	#TLS1_CK_RSA_WITH_AES_128_CCM_8
 0x0300C0A0

	)

472 
	#TLS1_CK_RSA_WITH_AES_256_CCM_8
 0x0300C0A1

	)

473 
	#TLS1_CK_DHE_RSA_WITH_AES_128_CCM_8
 0x0300C0A2

	)

474 
	#TLS1_CK_DHE_RSA_WITH_AES_256_CCM_8
 0x0300C0A3

	)

475 
	#TLS1_CK_PSK_WITH_AES_128_CCM
 0x0300C0A4

	)

476 
	#TLS1_CK_PSK_WITH_AES_256_CCM
 0x0300C0A5

	)

477 
	#TLS1_CK_DHE_PSK_WITH_AES_128_CCM
 0x0300C0A6

	)

478 
	#TLS1_CK_DHE_PSK_WITH_AES_256_CCM
 0x0300C0A7

	)

479 
	#TLS1_CK_PSK_WITH_AES_128_CCM_8
 0x0300C0A8

	)

480 
	#TLS1_CK_PSK_WITH_AES_256_CCM_8
 0x0300C0A9

	)

481 
	#TLS1_CK_DHE_PSK_WITH_AES_128_CCM_8
 0x0300C0AA

	)

482 
	#TLS1_CK_DHE_PSK_WITH_AES_256_CCM_8
 0x0300C0AB

	)

485 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_128_CCM
 0x0300C0AC

	)

486 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_256_CCM
 0x0300C0AD

	)

487 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_128_CCM_8
 0x0300C0AE

	)

488 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_256_CCM_8
 0x0300C0AF

	)

491 
	#TLS1_CK_RSA_WITH_CAMELLIA_128_CBC_SHA256
 0x030000BA

	)

492 
	#TLS1_CK_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256
 0x030000BB

	)

493 
	#TLS1_CK_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256
 0x030000BC

	)

494 
	#TLS1_CK_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256
 0x030000BD

	)

495 
	#TLS1_CK_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256
 0x030000BE

	)

496 
	#TLS1_CK_ADH_WITH_CAMELLIA_128_CBC_SHA256
 0x030000BF

	)

498 
	#TLS1_CK_RSA_WITH_CAMELLIA_256_CBC_SHA256
 0x030000C0

	)

499 
	#TLS1_CK_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256
 0x030000C1

	)

500 
	#TLS1_CK_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256
 0x030000C2

	)

501 
	#TLS1_CK_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256
 0x030000C3

	)

502 
	#TLS1_CK_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256
 0x030000C4

	)

503 
	#TLS1_CK_ADH_WITH_CAMELLIA_256_CBC_SHA256
 0x030000C5

	)

506 
	#TLS1_CK_ECDH_ECDSA_WITH_NULL_SHA
 0x0300C001

	)

507 
	#TLS1_CK_ECDH_ECDSA_WITH_RC4_128_SHA
 0x0300C002

	)

508 
	#TLS1_CK_ECDH_ECDSA_WITH_DES_192_CBC3_SHA
 0x0300C003

	)

509 
	#TLS1_CK_ECDH_ECDSA_WITH_AES_128_CBC_SHA
 0x0300C004

	)

510 
	#TLS1_CK_ECDH_ECDSA_WITH_AES_256_CBC_SHA
 0x0300C005

	)

512 
	#TLS1_CK_ECDHE_ECDSA_WITH_NULL_SHA
 0x0300C006

	)

513 
	#TLS1_CK_ECDHE_ECDSA_WITH_RC4_128_SHA
 0x0300C007

	)

514 
	#TLS1_CK_ECDHE_ECDSA_WITH_DES_192_CBC3_SHA
 0x0300C008

	)

515 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_128_CBC_SHA
 0x0300C009

	)

516 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_256_CBC_SHA
 0x0300C00A

	)

518 
	#TLS1_CK_ECDH_RSA_WITH_NULL_SHA
 0x0300C00B

	)

519 
	#TLS1_CK_ECDH_RSA_WITH_RC4_128_SHA
 0x0300C00C

	)

520 
	#TLS1_CK_ECDH_RSA_WITH_DES_192_CBC3_SHA
 0x0300C00D

	)

521 
	#TLS1_CK_ECDH_RSA_WITH_AES_128_CBC_SHA
 0x0300C00E

	)

522 
	#TLS1_CK_ECDH_RSA_WITH_AES_256_CBC_SHA
 0x0300C00F

	)

524 
	#TLS1_CK_ECDHE_RSA_WITH_NULL_SHA
 0x0300C010

	)

525 
	#TLS1_CK_ECDHE_RSA_WITH_RC4_128_SHA
 0x0300C011

	)

526 
	#TLS1_CK_ECDHE_RSA_WITH_DES_192_CBC3_SHA
 0x0300C012

	)

527 
	#TLS1_CK_ECDHE_RSA_WITH_AES_128_CBC_SHA
 0x0300C013

	)

528 
	#TLS1_CK_ECDHE_RSA_WITH_AES_256_CBC_SHA
 0x0300C014

	)

530 
	#TLS1_CK_ECDH_™⁄_WITH_NULL_SHA
 0x0300C015

	)

531 
	#TLS1_CK_ECDH_™⁄_WITH_RC4_128_SHA
 0x0300C016

	)

532 
	#TLS1_CK_ECDH_™⁄_WITH_DES_192_CBC3_SHA
 0x0300C017

	)

533 
	#TLS1_CK_ECDH_™⁄_WITH_AES_128_CBC_SHA
 0x0300C018

	)

534 
	#TLS1_CK_ECDH_™⁄_WITH_AES_256_CBC_SHA
 0x0300C019

	)

537 
	#TLS1_CK_SRP_SHA_WITH_3DES_EDE_CBC_SHA
 0x0300C01A

	)

538 
	#TLS1_CK_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA
 0x0300C01B

	)

539 
	#TLS1_CK_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA
 0x0300C01C

	)

540 
	#TLS1_CK_SRP_SHA_WITH_AES_128_CBC_SHA
 0x0300C01D

	)

541 
	#TLS1_CK_SRP_SHA_RSA_WITH_AES_128_CBC_SHA
 0x0300C01E

	)

542 
	#TLS1_CK_SRP_SHA_DSS_WITH_AES_128_CBC_SHA
 0x0300C01F

	)

543 
	#TLS1_CK_SRP_SHA_WITH_AES_256_CBC_SHA
 0x0300C020

	)

544 
	#TLS1_CK_SRP_SHA_RSA_WITH_AES_256_CBC_SHA
 0x0300C021

	)

545 
	#TLS1_CK_SRP_SHA_DSS_WITH_AES_256_CBC_SHA
 0x0300C022

	)

548 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_128_SHA256
 0x0300C023

	)

549 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_256_SHA384
 0x0300C024

	)

550 
	#TLS1_CK_ECDH_ECDSA_WITH_AES_128_SHA256
 0x0300C025

	)

551 
	#TLS1_CK_ECDH_ECDSA_WITH_AES_256_SHA384
 0x0300C026

	)

552 
	#TLS1_CK_ECDHE_RSA_WITH_AES_128_SHA256
 0x0300C027

	)

553 
	#TLS1_CK_ECDHE_RSA_WITH_AES_256_SHA384
 0x0300C028

	)

554 
	#TLS1_CK_ECDH_RSA_WITH_AES_128_SHA256
 0x0300C029

	)

555 
	#TLS1_CK_ECDH_RSA_WITH_AES_256_SHA384
 0x0300C02A

	)

558 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
 0x0300C02B

	)

559 
	#TLS1_CK_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
 0x0300C02C

	)

560 
	#TLS1_CK_ECDH_ECDSA_WITH_AES_128_GCM_SHA256
 0x0300C02D

	)

561 
	#TLS1_CK_ECDH_ECDSA_WITH_AES_256_GCM_SHA384
 0x0300C02E

	)

562 
	#TLS1_CK_ECDHE_RSA_WITH_AES_128_GCM_SHA256
 0x0300C02F

	)

563 
	#TLS1_CK_ECDHE_RSA_WITH_AES_256_GCM_SHA384
 0x0300C030

	)

564 
	#TLS1_CK_ECDH_RSA_WITH_AES_128_GCM_SHA256
 0x0300C031

	)

565 
	#TLS1_CK_ECDH_RSA_WITH_AES_256_GCM_SHA384
 0x0300C032

	)

568 
	#TLS1_CK_ECDHE_PSK_WITH_RC4_128_SHA
 0x0300C033

	)

569 
	#TLS1_CK_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA
 0x0300C034

	)

570 
	#TLS1_CK_ECDHE_PSK_WITH_AES_128_CBC_SHA
 0x0300C035

	)

571 
	#TLS1_CK_ECDHE_PSK_WITH_AES_256_CBC_SHA
 0x0300C036

	)

573 
	#TLS1_CK_ECDHE_PSK_WITH_AES_128_CBC_SHA256
 0x0300C037

	)

574 
	#TLS1_CK_ECDHE_PSK_WITH_AES_256_CBC_SHA384
 0x0300C038

	)

577 
	#TLS1_CK_ECDHE_PSK_WITH_NULL_SHA
 0x0300C039

	)

578 
	#TLS1_CK_ECDHE_PSK_WITH_NULL_SHA256
 0x0300C03A

	)

579 
	#TLS1_CK_ECDHE_PSK_WITH_NULL_SHA384
 0x0300C03B

	)

582 
	#TLS1_CK_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256
 0x0300C072

	)

583 
	#TLS1_CK_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384
 0x0300C073

	)

584 
	#TLS1_CK_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256
 0x0300C074

	)

585 
	#TLS1_CK_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384
 0x0300C075

	)

586 
	#TLS1_CK_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256
 0x0300C076

	)

587 
	#TLS1_CK_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384
 0x0300C077

	)

588 
	#TLS1_CK_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256
 0x0300C078

	)

589 
	#TLS1_CK_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384
 0x0300C079

	)

591 
	#TLS1_CK_PSK_WITH_CAMELLIA_128_CBC_SHA256
 0x0300C094

	)

592 
	#TLS1_CK_PSK_WITH_CAMELLIA_256_CBC_SHA384
 0x0300C095

	)

593 
	#TLS1_CK_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256
 0x0300C096

	)

594 
	#TLS1_CK_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384
 0x0300C097

	)

595 
	#TLS1_CK_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256
 0x0300C098

	)

596 
	#TLS1_CK_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384
 0x0300C099

	)

597 
	#TLS1_CK_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256
 0x0300C09A

	)

598 
	#TLS1_CK_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384
 0x0300C09B

	)

601 
	#TLS1_CK_ECDHE_RSA_WITH_CHACHA20_POLY1305
 0x0300CCA8

	)

602 
	#TLS1_CK_ECDHE_ECDSA_WITH_CHACHA20_POLY1305
 0x0300CCA9

	)

603 
	#TLS1_CK_DHE_RSA_WITH_CHACHA20_POLY1305
 0x0300CCAA

	)

604 
	#TLS1_CK_PSK_WITH_CHACHA20_POLY1305
 0x0300CCAB

	)

605 
	#TLS1_CK_ECDHE_PSK_WITH_CHACHA20_POLY1305
 0x0300CCAC

	)

606 
	#TLS1_CK_DHE_PSK_WITH_CHACHA20_POLY1305
 0x0300CCAD

	)

607 
	#TLS1_CK_RSA_PSK_WITH_CHACHA20_POLY1305
 0x0300CCAE

	)

610 
	#TLS1_3_CK_AES_128_GCM_SHA256
 0x03001301

	)

611 
	#TLS1_3_CK_AES_256_GCM_SHA384
 0x03001302

	)

612 
	#TLS1_3_CK_CHACHA20_POLY1305_SHA256
 0x03001303

	)

613 
	#TLS1_3_CK_AES_128_CCM_SHA256
 0x03001304

	)

614 
	#TLS1_3_CK_AES_128_CCM_8_SHA256
 0x03001305

	)

617 
	#TLS1_CK_RSA_WITH_ARIA_128_GCM_SHA256
 0x0300C050

	)

618 
	#TLS1_CK_RSA_WITH_ARIA_256_GCM_SHA384
 0x0300C051

	)

619 
	#TLS1_CK_DHE_RSA_WITH_ARIA_128_GCM_SHA256
 0x0300C052

	)

620 
	#TLS1_CK_DHE_RSA_WITH_ARIA_256_GCM_SHA384
 0x0300C053

	)

621 
	#TLS1_CK_DH_RSA_WITH_ARIA_128_GCM_SHA256
 0x0300C054

	)

622 
	#TLS1_CK_DH_RSA_WITH_ARIA_256_GCM_SHA384
 0x0300C055

	)

623 
	#TLS1_CK_DHE_DSS_WITH_ARIA_128_GCM_SHA256
 0x0300C056

	)

624 
	#TLS1_CK_DHE_DSS_WITH_ARIA_256_GCM_SHA384
 0x0300C057

	)

625 
	#TLS1_CK_DH_DSS_WITH_ARIA_128_GCM_SHA256
 0x0300C058

	)

626 
	#TLS1_CK_DH_DSS_WITH_ARIA_256_GCM_SHA384
 0x0300C059

	)

627 
	#TLS1_CK_DH_™⁄_WITH_ARIA_128_GCM_SHA256
 0x0300C05A

	)

628 
	#TLS1_CK_DH_™⁄_WITH_ARIA_256_GCM_SHA384
 0x0300C05B

	)

629 
	#TLS1_CK_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256
 0x0300C05C

	)

630 
	#TLS1_CK_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384
 0x0300C05D

	)

631 
	#TLS1_CK_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256
 0x0300C05E

	)

632 
	#TLS1_CK_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384
 0x0300C05F

	)

633 
	#TLS1_CK_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256
 0x0300C060

	)

634 
	#TLS1_CK_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384
 0x0300C061

	)

635 
	#TLS1_CK_ECDH_RSA_WITH_ARIA_128_GCM_SHA256
 0x0300C062

	)

636 
	#TLS1_CK_ECDH_RSA_WITH_ARIA_256_GCM_SHA384
 0x0300C063

	)

637 
	#TLS1_CK_PSK_WITH_ARIA_128_GCM_SHA256
 0x0300C06A

	)

638 
	#TLS1_CK_PSK_WITH_ARIA_256_GCM_SHA384
 0x0300C06B

	)

639 
	#TLS1_CK_DHE_PSK_WITH_ARIA_128_GCM_SHA256
 0x0300C06C

	)

640 
	#TLS1_CK_DHE_PSK_WITH_ARIA_256_GCM_SHA384
 0x0300C06D

	)

641 
	#TLS1_CK_RSA_PSK_WITH_ARIA_128_GCM_SHA256
 0x0300C06E

	)

642 
	#TLS1_CK_RSA_PSK_WITH_ARIA_256_GCM_SHA384
 0x0300C06F

	)

645 
	#TLS1_RFC_RSA_WITH_AES_128_SHA
 "TLS_RSA_WITH_AES_128_CBC_SHA"

	)

646 
	#TLS1_RFC_DHE_DSS_WITH_AES_128_SHA
 "TLS_DHE_DSS_WITH_AES_128_CBC_SHA"

	)

647 
	#TLS1_RFC_DHE_RSA_WITH_AES_128_SHA
 "TLS_DHE_RSA_WITH_AES_128_CBC_SHA"

	)

648 
	#TLS1_RFC_ADH_WITH_AES_128_SHA
 "TLS_DH_™⁄_WITH_AES_128_CBC_SHA"

	)

649 
	#TLS1_RFC_RSA_WITH_AES_256_SHA
 "TLS_RSA_WITH_AES_256_CBC_SHA"

	)

650 
	#TLS1_RFC_DHE_DSS_WITH_AES_256_SHA
 "TLS_DHE_DSS_WITH_AES_256_CBC_SHA"

	)

651 
	#TLS1_RFC_DHE_RSA_WITH_AES_256_SHA
 "TLS_DHE_RSA_WITH_AES_256_CBC_SHA"

	)

652 
	#TLS1_RFC_ADH_WITH_AES_256_SHA
 "TLS_DH_™⁄_WITH_AES_256_CBC_SHA"

	)

653 
	#TLS1_RFC_RSA_WITH_NULL_SHA256
 "TLS_RSA_WITH_NULL_SHA256"

	)

654 
	#TLS1_RFC_RSA_WITH_AES_128_SHA256
 "TLS_RSA_WITH_AES_128_CBC_SHA256"

	)

655 
	#TLS1_RFC_RSA_WITH_AES_256_SHA256
 "TLS_RSA_WITH_AES_256_CBC_SHA256"

	)

656 
	#TLS1_RFC_DHE_DSS_WITH_AES_128_SHA256
 "TLS_DHE_DSS_WITH_AES_128_CBC_SHA256"

	)

657 
	#TLS1_RFC_DHE_RSA_WITH_AES_128_SHA256
 "TLS_DHE_RSA_WITH_AES_128_CBC_SHA256"

	)

658 
	#TLS1_RFC_DHE_DSS_WITH_AES_256_SHA256
 "TLS_DHE_DSS_WITH_AES_256_CBC_SHA256"

	)

659 
	#TLS1_RFC_DHE_RSA_WITH_AES_256_SHA256
 "TLS_DHE_RSA_WITH_AES_256_CBC_SHA256"

	)

660 
	#TLS1_RFC_ADH_WITH_AES_128_SHA256
 "TLS_DH_™⁄_WITH_AES_128_CBC_SHA256"

	)

661 
	#TLS1_RFC_ADH_WITH_AES_256_SHA256
 "TLS_DH_™⁄_WITH_AES_256_CBC_SHA256"

	)

662 
	#TLS1_RFC_RSA_WITH_AES_128_GCM_SHA256
 "TLS_RSA_WITH_AES_128_GCM_SHA256"

	)

663 
	#TLS1_RFC_RSA_WITH_AES_256_GCM_SHA384
 "TLS_RSA_WITH_AES_256_GCM_SHA384"

	)

664 
	#TLS1_RFC_DHE_RSA_WITH_AES_128_GCM_SHA256
 "TLS_DHE_RSA_WITH_AES_128_GCM_SHA256"

	)

665 
	#TLS1_RFC_DHE_RSA_WITH_AES_256_GCM_SHA384
 "TLS_DHE_RSA_WITH_AES_256_GCM_SHA384"

	)

666 
	#TLS1_RFC_DHE_DSS_WITH_AES_128_GCM_SHA256
 "TLS_DHE_DSS_WITH_AES_128_GCM_SHA256"

	)

667 
	#TLS1_RFC_DHE_DSS_WITH_AES_256_GCM_SHA384
 "TLS_DHE_DSS_WITH_AES_256_GCM_SHA384"

	)

668 
	#TLS1_RFC_ADH_WITH_AES_128_GCM_SHA256
 "TLS_DH_™⁄_WITH_AES_128_GCM_SHA256"

	)

669 
	#TLS1_RFC_ADH_WITH_AES_256_GCM_SHA384
 "TLS_DH_™⁄_WITH_AES_256_GCM_SHA384"

	)

670 
	#TLS1_RFC_RSA_WITH_AES_128_CCM
 "TLS_RSA_WITH_AES_128_CCM"

	)

671 
	#TLS1_RFC_RSA_WITH_AES_256_CCM
 "TLS_RSA_WITH_AES_256_CCM"

	)

672 
	#TLS1_RFC_DHE_RSA_WITH_AES_128_CCM
 "TLS_DHE_RSA_WITH_AES_128_CCM"

	)

673 
	#TLS1_RFC_DHE_RSA_WITH_AES_256_CCM
 "TLS_DHE_RSA_WITH_AES_256_CCM"

	)

674 
	#TLS1_RFC_RSA_WITH_AES_128_CCM_8
 "TLS_RSA_WITH_AES_128_CCM_8"

	)

675 
	#TLS1_RFC_RSA_WITH_AES_256_CCM_8
 "TLS_RSA_WITH_AES_256_CCM_8"

	)

676 
	#TLS1_RFC_DHE_RSA_WITH_AES_128_CCM_8
 "TLS_DHE_RSA_WITH_AES_128_CCM_8"

	)

677 
	#TLS1_RFC_DHE_RSA_WITH_AES_256_CCM_8
 "TLS_DHE_RSA_WITH_AES_256_CCM_8"

	)

678 
	#TLS1_RFC_PSK_WITH_AES_128_CCM
 "TLS_PSK_WITH_AES_128_CCM"

	)

679 
	#TLS1_RFC_PSK_WITH_AES_256_CCM
 "TLS_PSK_WITH_AES_256_CCM"

	)

680 
	#TLS1_RFC_DHE_PSK_WITH_AES_128_CCM
 "TLS_DHE_PSK_WITH_AES_128_CCM"

	)

681 
	#TLS1_RFC_DHE_PSK_WITH_AES_256_CCM
 "TLS_DHE_PSK_WITH_AES_256_CCM"

	)

682 
	#TLS1_RFC_PSK_WITH_AES_128_CCM_8
 "TLS_PSK_WITH_AES_128_CCM_8"

	)

683 
	#TLS1_RFC_PSK_WITH_AES_256_CCM_8
 "TLS_PSK_WITH_AES_256_CCM_8"

	)

684 
	#TLS1_RFC_DHE_PSK_WITH_AES_128_CCM_8
 "TLS_PSK_DHE_WITH_AES_128_CCM_8"

	)

685 
	#TLS1_RFC_DHE_PSK_WITH_AES_256_CCM_8
 "TLS_PSK_DHE_WITH_AES_256_CCM_8"

	)

686 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_128_CCM
 "TLS_ECDHE_ECDSA_WITH_AES_128_CCM"

	)

687 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_256_CCM
 "TLS_ECDHE_ECDSA_WITH_AES_256_CCM"

	)

688 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_128_CCM_8
 "TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8"

	)

689 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_256_CCM_8
 "TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8"

	)

690 
	#TLS1_3_RFC_AES_128_GCM_SHA256
 "TLS_AES_128_GCM_SHA256"

	)

691 
	#TLS1_3_RFC_AES_256_GCM_SHA384
 "TLS_AES_256_GCM_SHA384"

	)

692 
	#TLS1_3_RFC_CHACHA20_POLY1305_SHA256
 "TLS_CHACHA20_POLY1305_SHA256"

	)

693 
	#TLS1_3_RFC_AES_128_CCM_SHA256
 "TLS_AES_128_CCM_SHA256"

	)

694 
	#TLS1_3_RFC_AES_128_CCM_8_SHA256
 "TLS_AES_128_CCM_8_SHA256"

	)

695 
	#TLS1_RFC_ECDHE_ECDSA_WITH_NULL_SHA
 "TLS_ECDHE_ECDSA_WITH_NULL_SHA"

	)

696 
	#TLS1_RFC_ECDHE_ECDSA_WITH_DES_192_CBC3_SHA
 "TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA"

	)

697 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_128_CBC_SHA
 "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA"

	)

698 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_256_CBC_SHA
 "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA"

	)

699 
	#TLS1_RFC_ECDHE_RSA_WITH_NULL_SHA
 "TLS_ECDHE_RSA_WITH_NULL_SHA"

	)

700 
	#TLS1_RFC_ECDHE_RSA_WITH_DES_192_CBC3_SHA
 "TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA"

	)

701 
	#TLS1_RFC_ECDHE_RSA_WITH_AES_128_CBC_SHA
 "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA"

	)

702 
	#TLS1_RFC_ECDHE_RSA_WITH_AES_256_CBC_SHA
 "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA"

	)

703 
	#TLS1_RFC_ECDH_™⁄_WITH_NULL_SHA
 "TLS_ECDH_™⁄_WITH_NULL_SHA"

	)

704 
	#TLS1_RFC_ECDH_™⁄_WITH_DES_192_CBC3_SHA
 "TLS_ECDH_™⁄_WITH_3DES_EDE_CBC_SHA"

	)

705 
	#TLS1_RFC_ECDH_™⁄_WITH_AES_128_CBC_SHA
 "TLS_ECDH_™⁄_WITH_AES_128_CBC_SHA"

	)

706 
	#TLS1_RFC_ECDH_™⁄_WITH_AES_256_CBC_SHA
 "TLS_ECDH_™⁄_WITH_AES_256_CBC_SHA"

	)

707 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_128_SHA256
 "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256"

	)

708 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_256_SHA384
 "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384"

	)

709 
	#TLS1_RFC_ECDHE_RSA_WITH_AES_128_SHA256
 "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256"

	)

710 
	#TLS1_RFC_ECDHE_RSA_WITH_AES_256_SHA384
 "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384"

	)

711 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
 "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256"

	)

712 
	#TLS1_RFC_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
 "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384"

	)

713 
	#TLS1_RFC_ECDHE_RSA_WITH_AES_128_GCM_SHA256
 "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"

	)

714 
	#TLS1_RFC_ECDHE_RSA_WITH_AES_256_GCM_SHA384
 "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"

	)

715 
	#TLS1_RFC_PSK_WITH_NULL_SHA
 "TLS_PSK_WITH_NULL_SHA"

	)

716 
	#TLS1_RFC_DHE_PSK_WITH_NULL_SHA
 "TLS_DHE_PSK_WITH_NULL_SHA"

	)

717 
	#TLS1_RFC_RSA_PSK_WITH_NULL_SHA
 "TLS_RSA_PSK_WITH_NULL_SHA"

	)

718 
	#TLS1_RFC_PSK_WITH_3DES_EDE_CBC_SHA
 "TLS_PSK_WITH_3DES_EDE_CBC_SHA"

	)

719 
	#TLS1_RFC_PSK_WITH_AES_128_CBC_SHA
 "TLS_PSK_WITH_AES_128_CBC_SHA"

	)

720 
	#TLS1_RFC_PSK_WITH_AES_256_CBC_SHA
 "TLS_PSK_WITH_AES_256_CBC_SHA"

	)

721 
	#TLS1_RFC_DHE_PSK_WITH_3DES_EDE_CBC_SHA
 "TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA"

	)

722 
	#TLS1_RFC_DHE_PSK_WITH_AES_128_CBC_SHA
 "TLS_DHE_PSK_WITH_AES_128_CBC_SHA"

	)

723 
	#TLS1_RFC_DHE_PSK_WITH_AES_256_CBC_SHA
 "TLS_DHE_PSK_WITH_AES_256_CBC_SHA"

	)

724 
	#TLS1_RFC_RSA_PSK_WITH_3DES_EDE_CBC_SHA
 "TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA"

	)

725 
	#TLS1_RFC_RSA_PSK_WITH_AES_128_CBC_SHA
 "TLS_RSA_PSK_WITH_AES_128_CBC_SHA"

	)

726 
	#TLS1_RFC_RSA_PSK_WITH_AES_256_CBC_SHA
 "TLS_RSA_PSK_WITH_AES_256_CBC_SHA"

	)

727 
	#TLS1_RFC_PSK_WITH_AES_128_GCM_SHA256
 "TLS_PSK_WITH_AES_128_GCM_SHA256"

	)

728 
	#TLS1_RFC_PSK_WITH_AES_256_GCM_SHA384
 "TLS_PSK_WITH_AES_256_GCM_SHA384"

	)

729 
	#TLS1_RFC_DHE_PSK_WITH_AES_128_GCM_SHA256
 "TLS_DHE_PSK_WITH_AES_128_GCM_SHA256"

	)

730 
	#TLS1_RFC_DHE_PSK_WITH_AES_256_GCM_SHA384
 "TLS_DHE_PSK_WITH_AES_256_GCM_SHA384"

	)

731 
	#TLS1_RFC_RSA_PSK_WITH_AES_128_GCM_SHA256
 "TLS_RSA_PSK_WITH_AES_128_GCM_SHA256"

	)

732 
	#TLS1_RFC_RSA_PSK_WITH_AES_256_GCM_SHA384
 "TLS_RSA_PSK_WITH_AES_256_GCM_SHA384"

	)

733 
	#TLS1_RFC_PSK_WITH_AES_128_CBC_SHA256
 "TLS_PSK_WITH_AES_128_CBC_SHA256"

	)

734 
	#TLS1_RFC_PSK_WITH_AES_256_CBC_SHA384
 "TLS_PSK_WITH_AES_256_CBC_SHA384"

	)

735 
	#TLS1_RFC_PSK_WITH_NULL_SHA256
 "TLS_PSK_WITH_NULL_SHA256"

	)

736 
	#TLS1_RFC_PSK_WITH_NULL_SHA384
 "TLS_PSK_WITH_NULL_SHA384"

	)

737 
	#TLS1_RFC_DHE_PSK_WITH_AES_128_CBC_SHA256
 "TLS_DHE_PSK_WITH_AES_128_CBC_SHA256"

	)

738 
	#TLS1_RFC_DHE_PSK_WITH_AES_256_CBC_SHA384
 "TLS_DHE_PSK_WITH_AES_256_CBC_SHA384"

	)

739 
	#TLS1_RFC_DHE_PSK_WITH_NULL_SHA256
 "TLS_DHE_PSK_WITH_NULL_SHA256"

	)

740 
	#TLS1_RFC_DHE_PSK_WITH_NULL_SHA384
 "TLS_DHE_PSK_WITH_NULL_SHA384"

	)

741 
	#TLS1_RFC_RSA_PSK_WITH_AES_128_CBC_SHA256
 "TLS_RSA_PSK_WITH_AES_128_CBC_SHA256"

	)

742 
	#TLS1_RFC_RSA_PSK_WITH_AES_256_CBC_SHA384
 "TLS_RSA_PSK_WITH_AES_256_CBC_SHA384"

	)

743 
	#TLS1_RFC_RSA_PSK_WITH_NULL_SHA256
 "TLS_RSA_PSK_WITH_NULL_SHA256"

	)

744 
	#TLS1_RFC_RSA_PSK_WITH_NULL_SHA384
 "TLS_RSA_PSK_WITH_NULL_SHA384"

	)

745 
	#TLS1_RFC_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA
 "TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA"

	)

746 
	#TLS1_RFC_ECDHE_PSK_WITH_AES_128_CBC_SHA
 "TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA"

	)

747 
	#TLS1_RFC_ECDHE_PSK_WITH_AES_256_CBC_SHA
 "TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA"

	)

748 
	#TLS1_RFC_ECDHE_PSK_WITH_AES_128_CBC_SHA256
 "TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256"

	)

749 
	#TLS1_RFC_ECDHE_PSK_WITH_AES_256_CBC_SHA384
 "TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384"

	)

750 
	#TLS1_RFC_ECDHE_PSK_WITH_NULL_SHA
 "TLS_ECDHE_PSK_WITH_NULL_SHA"

	)

751 
	#TLS1_RFC_ECDHE_PSK_WITH_NULL_SHA256
 "TLS_ECDHE_PSK_WITH_NULL_SHA256"

	)

752 
	#TLS1_RFC_ECDHE_PSK_WITH_NULL_SHA384
 "TLS_ECDHE_PSK_WITH_NULL_SHA384"

	)

753 
	#TLS1_RFC_SRP_SHA_WITH_3DES_EDE_CBC_SHA
 "TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA"

	)

754 
	#TLS1_RFC_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA
 "TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA"

	)

755 
	#TLS1_RFC_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA
 "TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA"

	)

756 
	#TLS1_RFC_SRP_SHA_WITH_AES_128_CBC_SHA
 "TLS_SRP_SHA_WITH_AES_128_CBC_SHA"

	)

757 
	#TLS1_RFC_SRP_SHA_RSA_WITH_AES_128_CBC_SHA
 "TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA"

	)

758 
	#TLS1_RFC_SRP_SHA_DSS_WITH_AES_128_CBC_SHA
 "TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA"

	)

759 
	#TLS1_RFC_SRP_SHA_WITH_AES_256_CBC_SHA
 "TLS_SRP_SHA_WITH_AES_256_CBC_SHA"

	)

760 
	#TLS1_RFC_SRP_SHA_RSA_WITH_AES_256_CBC_SHA
 "TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA"

	)

761 
	#TLS1_RFC_SRP_SHA_DSS_WITH_AES_256_CBC_SHA
 "TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA"

	)

762 
	#TLS1_RFC_DHE_RSA_WITH_CHACHA20_POLY1305
 "TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256"

	)

763 
	#TLS1_RFC_ECDHE_RSA_WITH_CHACHA20_POLY1305
 "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"

	)

764 
	#TLS1_RFC_ECDHE_ECDSA_WITH_CHACHA20_POLY1305
 "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256"

	)

765 
	#TLS1_RFC_PSK_WITH_CHACHA20_POLY1305
 "TLS_PSK_WITH_CHACHA20_POLY1305_SHA256"

	)

766 
	#TLS1_RFC_ECDHE_PSK_WITH_CHACHA20_POLY1305
 "TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256"

	)

767 
	#TLS1_RFC_DHE_PSK_WITH_CHACHA20_POLY1305
 "TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256"

	)

768 
	#TLS1_RFC_RSA_PSK_WITH_CHACHA20_POLY1305
 "TLS_RSA_PSK_WITH_CHACHA20_POLY1305_SHA256"

	)

769 
	#TLS1_RFC_RSA_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256"

	)

770 
	#TLS1_RFC_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256"

	)

771 
	#TLS1_RFC_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256"

	)

772 
	#TLS1_RFC_ADH_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_DH_™⁄_WITH_CAMELLIA_128_CBC_SHA256"

	)

773 
	#TLS1_RFC_RSA_WITH_CAMELLIA_256_CBC_SHA256
 "TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256"

	)

774 
	#TLS1_RFC_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256
 "TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256"

	)

775 
	#TLS1_RFC_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256
 "TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256"

	)

776 
	#TLS1_RFC_ADH_WITH_CAMELLIA_256_CBC_SHA256
 "TLS_DH_™⁄_WITH_CAMELLIA_256_CBC_SHA256"

	)

777 
	#TLS1_RFC_RSA_WITH_CAMELLIA_256_CBC_SHA
 "TLS_RSA_WITH_CAMELLIA_256_CBC_SHA"

	)

778 
	#TLS1_RFC_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA
 "TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA"

	)

779 
	#TLS1_RFC_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA
 "TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA"

	)

780 
	#TLS1_RFC_ADH_WITH_CAMELLIA_256_CBC_SHA
 "TLS_DH_™⁄_WITH_CAMELLIA_256_CBC_SHA"

	)

781 
	#TLS1_RFC_RSA_WITH_CAMELLIA_128_CBC_SHA
 "TLS_RSA_WITH_CAMELLIA_128_CBC_SHA"

	)

782 
	#TLS1_RFC_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA
 "TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA"

	)

783 
	#TLS1_RFC_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA
 "TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA"

	)

784 
	#TLS1_RFC_ADH_WITH_CAMELLIA_128_CBC_SHA
 "TLS_DH_™⁄_WITH_CAMELLIA_128_CBC_SHA"

	)

785 
	#TLS1_RFC_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256"

	)

786 
	#TLS1_RFC_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384
 "TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384"

	)

787 
	#TLS1_RFC_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256"

	)

788 
	#TLS1_RFC_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384
 "TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384"

	)

789 
	#TLS1_RFC_PSK_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256"

	)

790 
	#TLS1_RFC_PSK_WITH_CAMELLIA_256_CBC_SHA384
 "TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384"

	)

791 
	#TLS1_RFC_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256"

	)

792 
	#TLS1_RFC_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384
 "TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384"

	)

793 
	#TLS1_RFC_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256"

	)

794 
	#TLS1_RFC_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384
 "TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384"

	)

795 
	#TLS1_RFC_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256
 "TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256"

	)

796 
	#TLS1_RFC_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384
 "TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384"

	)

797 
	#TLS1_RFC_RSA_WITH_SEED_SHA
 "TLS_RSA_WITH_SEED_CBC_SHA"

	)

798 
	#TLS1_RFC_DHE_DSS_WITH_SEED_SHA
 "TLS_DHE_DSS_WITH_SEED_CBC_SHA"

	)

799 
	#TLS1_RFC_DHE_RSA_WITH_SEED_SHA
 "TLS_DHE_RSA_WITH_SEED_CBC_SHA"

	)

800 
	#TLS1_RFC_ADH_WITH_SEED_SHA
 "TLS_DH_™⁄_WITH_SEED_CBC_SHA"

	)

801 
	#TLS1_RFC_ECDHE_PSK_WITH_RC4_128_SHA
 "TLS_ECDHE_PSK_WITH_RC4_128_SHA"

	)

802 
	#TLS1_RFC_ECDH_™⁄_WITH_RC4_128_SHA
 "TLS_ECDH_™⁄_WITH_RC4_128_SHA"

	)

803 
	#TLS1_RFC_ECDHE_ECDSA_WITH_RC4_128_SHA
 "TLS_ECDHE_ECDSA_WITH_RC4_128_SHA"

	)

804 
	#TLS1_RFC_ECDHE_RSA_WITH_RC4_128_SHA
 "TLS_ECDHE_RSA_WITH_RC4_128_SHA"

	)

805 
	#TLS1_RFC_PSK_WITH_RC4_128_SHA
 "TLS_PSK_WITH_RC4_128_SHA"

	)

806 
	#TLS1_RFC_RSA_PSK_WITH_RC4_128_SHA
 "TLS_RSA_PSK_WITH_RC4_128_SHA"

	)

807 
	#TLS1_RFC_DHE_PSK_WITH_RC4_128_SHA
 "TLS_DHE_PSK_WITH_RC4_128_SHA"

	)

808 
	#TLS1_RFC_RSA_WITH_ARIA_128_GCM_SHA256
 "TLS_RSA_WITH_ARIA_128_GCM_SHA256"

	)

809 
	#TLS1_RFC_RSA_WITH_ARIA_256_GCM_SHA384
 "TLS_RSA_WITH_ARIA_256_GCM_SHA384"

	)

810 
	#TLS1_RFC_DHE_RSA_WITH_ARIA_128_GCM_SHA256
 "TLS_DHE_RSA_WITH_ARIA_128_GCM_SHA256"

	)

811 
	#TLS1_RFC_DHE_RSA_WITH_ARIA_256_GCM_SHA384
 "TLS_DHE_RSA_WITH_ARIA_256_GCM_SHA384"

	)

812 
	#TLS1_RFC_DH_RSA_WITH_ARIA_128_GCM_SHA256
 "TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256"

	)

813 
	#TLS1_RFC_DH_RSA_WITH_ARIA_256_GCM_SHA384
 "TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384"

	)

814 
	#TLS1_RFC_DHE_DSS_WITH_ARIA_128_GCM_SHA256
 "TLS_DHE_DSS_WITH_ARIA_128_GCM_SHA256"

	)

815 
	#TLS1_RFC_DHE_DSS_WITH_ARIA_256_GCM_SHA384
 "TLS_DHE_DSS_WITH_ARIA_256_GCM_SHA384"

	)

816 
	#TLS1_RFC_DH_DSS_WITH_ARIA_128_GCM_SHA256
 "TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256"

	)

817 
	#TLS1_RFC_DH_DSS_WITH_ARIA_256_GCM_SHA384
 "TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384"

	)

818 
	#TLS1_RFC_DH_™⁄_WITH_ARIA_128_GCM_SHA256
 "TLS_DH_™⁄_WITH_ARIA_128_GCM_SHA256"

	)

819 
	#TLS1_RFC_DH_™⁄_WITH_ARIA_256_GCM_SHA384
 "TLS_DH_™⁄_WITH_ARIA_256_GCM_SHA384"

	)

820 
	#TLS1_RFC_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256
 "TLS_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256"

	)

821 
	#TLS1_RFC_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384
 "TLS_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384"

	)

822 
	#TLS1_RFC_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256
 "TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256"

	)

823 
	#TLS1_RFC_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384
 "TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384"

	)

824 
	#TLS1_RFC_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256
 "TLS_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256"

	)

825 
	#TLS1_RFC_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384
 "TLS_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384"

	)

826 
	#TLS1_RFC_ECDH_RSA_WITH_ARIA_128_GCM_SHA256
 "TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256"

	)

827 
	#TLS1_RFC_ECDH_RSA_WITH_ARIA_256_GCM_SHA384
 "TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384"

	)

828 
	#TLS1_RFC_PSK_WITH_ARIA_128_GCM_SHA256
 "TLS_PSK_WITH_ARIA_128_GCM_SHA256"

	)

829 
	#TLS1_RFC_PSK_WITH_ARIA_256_GCM_SHA384
 "TLS_PSK_WITH_ARIA_256_GCM_SHA384"

	)

830 
	#TLS1_RFC_DHE_PSK_WITH_ARIA_128_GCM_SHA256
 "TLS_DHE_PSK_WITH_ARIA_128_GCM_SHA256"

	)

831 
	#TLS1_RFC_DHE_PSK_WITH_ARIA_256_GCM_SHA384
 "TLS_DHE_PSK_WITH_ARIA_256_GCM_SHA384"

	)

832 
	#TLS1_RFC_RSA_PSK_WITH_ARIA_128_GCM_SHA256
 "TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256"

	)

833 
	#TLS1_RFC_RSA_PSK_WITH_ARIA_256_GCM_SHA384
 "TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384"

	)

842 
	#TLS1_TXT_DHE_DSS_WITH_RC4_128_SHA
 "DHE-DSS-RC4-SHA"

	)

844 
	#TLS1_TXT_PSK_WITH_NULL_SHA
 "PSK-NULL-SHA"

	)

845 
	#TLS1_TXT_DHE_PSK_WITH_NULL_SHA
 "DHE-PSK-NULL-SHA"

	)

846 
	#TLS1_TXT_RSA_PSK_WITH_NULL_SHA
 "RSA-PSK-NULL-SHA"

	)

849 
	#TLS1_TXT_RSA_WITH_AES_128_SHA
 "AES128-SHA"

	)

850 
	#TLS1_TXT_DH_DSS_WITH_AES_128_SHA
 "DH-DSS-AES128-SHA"

	)

851 
	#TLS1_TXT_DH_RSA_WITH_AES_128_SHA
 "DH-RSA-AES128-SHA"

	)

852 
	#TLS1_TXT_DHE_DSS_WITH_AES_128_SHA
 "DHE-DSS-AES128-SHA"

	)

853 
	#TLS1_TXT_DHE_RSA_WITH_AES_128_SHA
 "DHE-RSA-AES128-SHA"

	)

854 
	#TLS1_TXT_ADH_WITH_AES_128_SHA
 "ADH-AES128-SHA"

	)

856 
	#TLS1_TXT_RSA_WITH_AES_256_SHA
 "AES256-SHA"

	)

857 
	#TLS1_TXT_DH_DSS_WITH_AES_256_SHA
 "DH-DSS-AES256-SHA"

	)

858 
	#TLS1_TXT_DH_RSA_WITH_AES_256_SHA
 "DH-RSA-AES256-SHA"

	)

859 
	#TLS1_TXT_DHE_DSS_WITH_AES_256_SHA
 "DHE-DSS-AES256-SHA"

	)

860 
	#TLS1_TXT_DHE_RSA_WITH_AES_256_SHA
 "DHE-RSA-AES256-SHA"

	)

861 
	#TLS1_TXT_ADH_WITH_AES_256_SHA
 "ADH-AES256-SHA"

	)

864 
	#TLS1_TXT_ECDH_ECDSA_WITH_NULL_SHA
 "ECDH-ECDSA-NULL-SHA"

	)

865 
	#TLS1_TXT_ECDH_ECDSA_WITH_RC4_128_SHA
 "ECDH-ECDSA-RC4-SHA"

	)

866 
	#TLS1_TXT_ECDH_ECDSA_WITH_DES_192_CBC3_SHA
 "ECDH-ECDSA-DES-CBC3-SHA"

	)

867 
	#TLS1_TXT_ECDH_ECDSA_WITH_AES_128_CBC_SHA
 "ECDH-ECDSA-AES128-SHA"

	)

868 
	#TLS1_TXT_ECDH_ECDSA_WITH_AES_256_CBC_SHA
 "ECDH-ECDSA-AES256-SHA"

	)

870 
	#TLS1_TXT_ECDHE_ECDSA_WITH_NULL_SHA
 "ECDHE-ECDSA-NULL-SHA"

	)

871 
	#TLS1_TXT_ECDHE_ECDSA_WITH_RC4_128_SHA
 "ECDHE-ECDSA-RC4-SHA"

	)

872 
	#TLS1_TXT_ECDHE_ECDSA_WITH_DES_192_CBC3_SHA
 "ECDHE-ECDSA-DES-CBC3-SHA"

	)

873 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_128_CBC_SHA
 "ECDHE-ECDSA-AES128-SHA"

	)

874 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_256_CBC_SHA
 "ECDHE-ECDSA-AES256-SHA"

	)

876 
	#TLS1_TXT_ECDH_RSA_WITH_NULL_SHA
 "ECDH-RSA-NULL-SHA"

	)

877 
	#TLS1_TXT_ECDH_RSA_WITH_RC4_128_SHA
 "ECDH-RSA-RC4-SHA"

	)

878 
	#TLS1_TXT_ECDH_RSA_WITH_DES_192_CBC3_SHA
 "ECDH-RSA-DES-CBC3-SHA"

	)

879 
	#TLS1_TXT_ECDH_RSA_WITH_AES_128_CBC_SHA
 "ECDH-RSA-AES128-SHA"

	)

880 
	#TLS1_TXT_ECDH_RSA_WITH_AES_256_CBC_SHA
 "ECDH-RSA-AES256-SHA"

	)

882 
	#TLS1_TXT_ECDHE_RSA_WITH_NULL_SHA
 "ECDHE-RSA-NULL-SHA"

	)

883 
	#TLS1_TXT_ECDHE_RSA_WITH_RC4_128_SHA
 "ECDHE-RSA-RC4-SHA"

	)

884 
	#TLS1_TXT_ECDHE_RSA_WITH_DES_192_CBC3_SHA
 "ECDHE-RSA-DES-CBC3-SHA"

	)

885 
	#TLS1_TXT_ECDHE_RSA_WITH_AES_128_CBC_SHA
 "ECDHE-RSA-AES128-SHA"

	)

886 
	#TLS1_TXT_ECDHE_RSA_WITH_AES_256_CBC_SHA
 "ECDHE-RSA-AES256-SHA"

	)

888 
	#TLS1_TXT_ECDH_™⁄_WITH_NULL_SHA
 "AECDH-NULL-SHA"

	)

889 
	#TLS1_TXT_ECDH_™⁄_WITH_RC4_128_SHA
 "AECDH-RC4-SHA"

	)

890 
	#TLS1_TXT_ECDH_™⁄_WITH_DES_192_CBC3_SHA
 "AECDH-DES-CBC3-SHA"

	)

891 
	#TLS1_TXT_ECDH_™⁄_WITH_AES_128_CBC_SHA
 "AECDH-AES128-SHA"

	)

892 
	#TLS1_TXT_ECDH_™⁄_WITH_AES_256_CBC_SHA
 "AECDH-AES256-SHA"

	)

895 
	#TLS1_TXT_PSK_WITH_RC4_128_SHA
 "PSK-RC4-SHA"

	)

896 
	#TLS1_TXT_PSK_WITH_3DES_EDE_CBC_SHA
 "PSK-3DES-EDE-CBC-SHA"

	)

897 
	#TLS1_TXT_PSK_WITH_AES_128_CBC_SHA
 "PSK-AES128-CBC-SHA"

	)

898 
	#TLS1_TXT_PSK_WITH_AES_256_CBC_SHA
 "PSK-AES256-CBC-SHA"

	)

900 
	#TLS1_TXT_DHE_PSK_WITH_RC4_128_SHA
 "DHE-PSK-RC4-SHA"

	)

901 
	#TLS1_TXT_DHE_PSK_WITH_3DES_EDE_CBC_SHA
 "DHE-PSK-3DES-EDE-CBC-SHA"

	)

902 
	#TLS1_TXT_DHE_PSK_WITH_AES_128_CBC_SHA
 "DHE-PSK-AES128-CBC-SHA"

	)

903 
	#TLS1_TXT_DHE_PSK_WITH_AES_256_CBC_SHA
 "DHE-PSK-AES256-CBC-SHA"

	)

904 
	#TLS1_TXT_RSA_PSK_WITH_RC4_128_SHA
 "RSA-PSK-RC4-SHA"

	)

905 
	#TLS1_TXT_RSA_PSK_WITH_3DES_EDE_CBC_SHA
 "RSA-PSK-3DES-EDE-CBC-SHA"

	)

906 
	#TLS1_TXT_RSA_PSK_WITH_AES_128_CBC_SHA
 "RSA-PSK-AES128-CBC-SHA"

	)

907 
	#TLS1_TXT_RSA_PSK_WITH_AES_256_CBC_SHA
 "RSA-PSK-AES256-CBC-SHA"

	)

910 
	#TLS1_TXT_PSK_WITH_AES_128_GCM_SHA256
 "PSK-AES128-GCM-SHA256"

	)

911 
	#TLS1_TXT_PSK_WITH_AES_256_GCM_SHA384
 "PSK-AES256-GCM-SHA384"

	)

912 
	#TLS1_TXT_DHE_PSK_WITH_AES_128_GCM_SHA256
 "DHE-PSK-AES128-GCM-SHA256"

	)

913 
	#TLS1_TXT_DHE_PSK_WITH_AES_256_GCM_SHA384
 "DHE-PSK-AES256-GCM-SHA384"

	)

914 
	#TLS1_TXT_RSA_PSK_WITH_AES_128_GCM_SHA256
 "RSA-PSK-AES128-GCM-SHA256"

	)

915 
	#TLS1_TXT_RSA_PSK_WITH_AES_256_GCM_SHA384
 "RSA-PSK-AES256-GCM-SHA384"

	)

917 
	#TLS1_TXT_PSK_WITH_AES_128_CBC_SHA256
 "PSK-AES128-CBC-SHA256"

	)

918 
	#TLS1_TXT_PSK_WITH_AES_256_CBC_SHA384
 "PSK-AES256-CBC-SHA384"

	)

919 
	#TLS1_TXT_PSK_WITH_NULL_SHA256
 "PSK-NULL-SHA256"

	)

920 
	#TLS1_TXT_PSK_WITH_NULL_SHA384
 "PSK-NULL-SHA384"

	)

922 
	#TLS1_TXT_DHE_PSK_WITH_AES_128_CBC_SHA256
 "DHE-PSK-AES128-CBC-SHA256"

	)

923 
	#TLS1_TXT_DHE_PSK_WITH_AES_256_CBC_SHA384
 "DHE-PSK-AES256-CBC-SHA384"

	)

924 
	#TLS1_TXT_DHE_PSK_WITH_NULL_SHA256
 "DHE-PSK-NULL-SHA256"

	)

925 
	#TLS1_TXT_DHE_PSK_WITH_NULL_SHA384
 "DHE-PSK-NULL-SHA384"

	)

927 
	#TLS1_TXT_RSA_PSK_WITH_AES_128_CBC_SHA256
 "RSA-PSK-AES128-CBC-SHA256"

	)

928 
	#TLS1_TXT_RSA_PSK_WITH_AES_256_CBC_SHA384
 "RSA-PSK-AES256-CBC-SHA384"

	)

929 
	#TLS1_TXT_RSA_PSK_WITH_NULL_SHA256
 "RSA-PSK-NULL-SHA256"

	)

930 
	#TLS1_TXT_RSA_PSK_WITH_NULL_SHA384
 "RSA-PSK-NULL-SHA384"

	)

933 
	#TLS1_TXT_SRP_SHA_WITH_3DES_EDE_CBC_SHA
 "SRP-3DES-EDE-CBC-SHA"

	)

934 
	#TLS1_TXT_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA
 "SRP-RSA-3DES-EDE-CBC-SHA"

	)

935 
	#TLS1_TXT_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA
 "SRP-DSS-3DES-EDE-CBC-SHA"

	)

936 
	#TLS1_TXT_SRP_SHA_WITH_AES_128_CBC_SHA
 "SRP-AES-128-CBC-SHA"

	)

937 
	#TLS1_TXT_SRP_SHA_RSA_WITH_AES_128_CBC_SHA
 "SRP-RSA-AES-128-CBC-SHA"

	)

938 
	#TLS1_TXT_SRP_SHA_DSS_WITH_AES_128_CBC_SHA
 "SRP-DSS-AES-128-CBC-SHA"

	)

939 
	#TLS1_TXT_SRP_SHA_WITH_AES_256_CBC_SHA
 "SRP-AES-256-CBC-SHA"

	)

940 
	#TLS1_TXT_SRP_SHA_RSA_WITH_AES_256_CBC_SHA
 "SRP-RSA-AES-256-CBC-SHA"

	)

941 
	#TLS1_TXT_SRP_SHA_DSS_WITH_AES_256_CBC_SHA
 "SRP-DSS-AES-256-CBC-SHA"

	)

944 
	#TLS1_TXT_RSA_WITH_CAMELLIA_128_CBC_SHA
 "CAMELLIA128-SHA"

	)

945 
	#TLS1_TXT_DH_DSS_WITH_CAMELLIA_128_CBC_SHA
 "DH-DSS-CAMELLIA128-SHA"

	)

946 
	#TLS1_TXT_DH_RSA_WITH_CAMELLIA_128_CBC_SHA
 "DH-RSA-CAMELLIA128-SHA"

	)

947 
	#TLS1_TXT_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA
 "DHE-DSS-CAMELLIA128-SHA"

	)

948 
	#TLS1_TXT_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA
 "DHE-RSA-CAMELLIA128-SHA"

	)

949 
	#TLS1_TXT_ADH_WITH_CAMELLIA_128_CBC_SHA
 "ADH-CAMELLIA128-SHA"

	)

951 
	#TLS1_TXT_RSA_WITH_CAMELLIA_256_CBC_SHA
 "CAMELLIA256-SHA"

	)

952 
	#TLS1_TXT_DH_DSS_WITH_CAMELLIA_256_CBC_SHA
 "DH-DSS-CAMELLIA256-SHA"

	)

953 
	#TLS1_TXT_DH_RSA_WITH_CAMELLIA_256_CBC_SHA
 "DH-RSA-CAMELLIA256-SHA"

	)

954 
	#TLS1_TXT_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA
 "DHE-DSS-CAMELLIA256-SHA"

	)

955 
	#TLS1_TXT_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA
 "DHE-RSA-CAMELLIA256-SHA"

	)

956 
	#TLS1_TXT_ADH_WITH_CAMELLIA_256_CBC_SHA
 "ADH-CAMELLIA256-SHA"

	)

959 
	#TLS1_TXT_RSA_WITH_CAMELLIA_128_CBC_SHA256
 "CAMELLIA128-SHA256"

	)

960 
	#TLS1_TXT_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256
 "DH-DSS-CAMELLIA128-SHA256"

	)

961 
	#TLS1_TXT_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256
 "DH-RSA-CAMELLIA128-SHA256"

	)

962 
	#TLS1_TXT_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256
 "DHE-DSS-CAMELLIA128-SHA256"

	)

963 
	#TLS1_TXT_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256
 "DHE-RSA-CAMELLIA128-SHA256"

	)

964 
	#TLS1_TXT_ADH_WITH_CAMELLIA_128_CBC_SHA256
 "ADH-CAMELLIA128-SHA256"

	)

966 
	#TLS1_TXT_RSA_WITH_CAMELLIA_256_CBC_SHA256
 "CAMELLIA256-SHA256"

	)

967 
	#TLS1_TXT_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256
 "DH-DSS-CAMELLIA256-SHA256"

	)

968 
	#TLS1_TXT_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256
 "DH-RSA-CAMELLIA256-SHA256"

	)

969 
	#TLS1_TXT_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256
 "DHE-DSS-CAMELLIA256-SHA256"

	)

970 
	#TLS1_TXT_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256
 "DHE-RSA-CAMELLIA256-SHA256"

	)

971 
	#TLS1_TXT_ADH_WITH_CAMELLIA_256_CBC_SHA256
 "ADH-CAMELLIA256-SHA256"

	)

973 
	#TLS1_TXT_PSK_WITH_CAMELLIA_128_CBC_SHA256
 "PSK-CAMELLIA128-SHA256"

	)

974 
	#TLS1_TXT_PSK_WITH_CAMELLIA_256_CBC_SHA384
 "PSK-CAMELLIA256-SHA384"

	)

975 
	#TLS1_TXT_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256
 "DHE-PSK-CAMELLIA128-SHA256"

	)

976 
	#TLS1_TXT_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384
 "DHE-PSK-CAMELLIA256-SHA384"

	)

977 
	#TLS1_TXT_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256
 "RSA-PSK-CAMELLIA128-SHA256"

	)

978 
	#TLS1_TXT_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384
 "RSA-PSK-CAMELLIA256-SHA384"

	)

979 
	#TLS1_TXT_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256
 "ECDHE-PSK-CAMELLIA128-SHA256"

	)

980 
	#TLS1_TXT_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384
 "ECDHE-PSK-CAMELLIA256-SHA384"

	)

983 
	#TLS1_TXT_RSA_WITH_SEED_SHA
 "SEED-SHA"

	)

984 
	#TLS1_TXT_DH_DSS_WITH_SEED_SHA
 "DH-DSS-SEED-SHA"

	)

985 
	#TLS1_TXT_DH_RSA_WITH_SEED_SHA
 "DH-RSA-SEED-SHA"

	)

986 
	#TLS1_TXT_DHE_DSS_WITH_SEED_SHA
 "DHE-DSS-SEED-SHA"

	)

987 
	#TLS1_TXT_DHE_RSA_WITH_SEED_SHA
 "DHE-RSA-SEED-SHA"

	)

988 
	#TLS1_TXT_ADH_WITH_SEED_SHA
 "ADH-SEED-SHA"

	)

991 
	#TLS1_TXT_RSA_WITH_NULL_SHA256
 "NULL-SHA256"

	)

992 
	#TLS1_TXT_RSA_WITH_AES_128_SHA256
 "AES128-SHA256"

	)

993 
	#TLS1_TXT_RSA_WITH_AES_256_SHA256
 "AES256-SHA256"

	)

994 
	#TLS1_TXT_DH_DSS_WITH_AES_128_SHA256
 "DH-DSS-AES128-SHA256"

	)

995 
	#TLS1_TXT_DH_RSA_WITH_AES_128_SHA256
 "DH-RSA-AES128-SHA256"

	)

996 
	#TLS1_TXT_DHE_DSS_WITH_AES_128_SHA256
 "DHE-DSS-AES128-SHA256"

	)

997 
	#TLS1_TXT_DHE_RSA_WITH_AES_128_SHA256
 "DHE-RSA-AES128-SHA256"

	)

998 
	#TLS1_TXT_DH_DSS_WITH_AES_256_SHA256
 "DH-DSS-AES256-SHA256"

	)

999 
	#TLS1_TXT_DH_RSA_WITH_AES_256_SHA256
 "DH-RSA-AES256-SHA256"

	)

1000 
	#TLS1_TXT_DHE_DSS_WITH_AES_256_SHA256
 "DHE-DSS-AES256-SHA256"

	)

1001 
	#TLS1_TXT_DHE_RSA_WITH_AES_256_SHA256
 "DHE-RSA-AES256-SHA256"

	)

1002 
	#TLS1_TXT_ADH_WITH_AES_128_SHA256
 "ADH-AES128-SHA256"

	)

1003 
	#TLS1_TXT_ADH_WITH_AES_256_SHA256
 "ADH-AES256-SHA256"

	)

1006 
	#TLS1_TXT_RSA_WITH_AES_128_GCM_SHA256
 "AES128-GCM-SHA256"

	)

1007 
	#TLS1_TXT_RSA_WITH_AES_256_GCM_SHA384
 "AES256-GCM-SHA384"

	)

1008 
	#TLS1_TXT_DHE_RSA_WITH_AES_128_GCM_SHA256
 "DHE-RSA-AES128-GCM-SHA256"

	)

1009 
	#TLS1_TXT_DHE_RSA_WITH_AES_256_GCM_SHA384
 "DHE-RSA-AES256-GCM-SHA384"

	)

1010 
	#TLS1_TXT_DH_RSA_WITH_AES_128_GCM_SHA256
 "DH-RSA-AES128-GCM-SHA256"

	)

1011 
	#TLS1_TXT_DH_RSA_WITH_AES_256_GCM_SHA384
 "DH-RSA-AES256-GCM-SHA384"

	)

1012 
	#TLS1_TXT_DHE_DSS_WITH_AES_128_GCM_SHA256
 "DHE-DSS-AES128-GCM-SHA256"

	)

1013 
	#TLS1_TXT_DHE_DSS_WITH_AES_256_GCM_SHA384
 "DHE-DSS-AES256-GCM-SHA384"

	)

1014 
	#TLS1_TXT_DH_DSS_WITH_AES_128_GCM_SHA256
 "DH-DSS-AES128-GCM-SHA256"

	)

1015 
	#TLS1_TXT_DH_DSS_WITH_AES_256_GCM_SHA384
 "DH-DSS-AES256-GCM-SHA384"

	)

1016 
	#TLS1_TXT_ADH_WITH_AES_128_GCM_SHA256
 "ADH-AES128-GCM-SHA256"

	)

1017 
	#TLS1_TXT_ADH_WITH_AES_256_GCM_SHA384
 "ADH-AES256-GCM-SHA384"

	)

1020 
	#TLS1_TXT_RSA_WITH_AES_128_CCM
 "AES128-CCM"

	)

1021 
	#TLS1_TXT_RSA_WITH_AES_256_CCM
 "AES256-CCM"

	)

1022 
	#TLS1_TXT_DHE_RSA_WITH_AES_128_CCM
 "DHE-RSA-AES128-CCM"

	)

1023 
	#TLS1_TXT_DHE_RSA_WITH_AES_256_CCM
 "DHE-RSA-AES256-CCM"

	)

1025 
	#TLS1_TXT_RSA_WITH_AES_128_CCM_8
 "AES128-CCM8"

	)

1026 
	#TLS1_TXT_RSA_WITH_AES_256_CCM_8
 "AES256-CCM8"

	)

1027 
	#TLS1_TXT_DHE_RSA_WITH_AES_128_CCM_8
 "DHE-RSA-AES128-CCM8"

	)

1028 
	#TLS1_TXT_DHE_RSA_WITH_AES_256_CCM_8
 "DHE-RSA-AES256-CCM8"

	)

1030 
	#TLS1_TXT_PSK_WITH_AES_128_CCM
 "PSK-AES128-CCM"

	)

1031 
	#TLS1_TXT_PSK_WITH_AES_256_CCM
 "PSK-AES256-CCM"

	)

1032 
	#TLS1_TXT_DHE_PSK_WITH_AES_128_CCM
 "DHE-PSK-AES128-CCM"

	)

1033 
	#TLS1_TXT_DHE_PSK_WITH_AES_256_CCM
 "DHE-PSK-AES256-CCM"

	)

1035 
	#TLS1_TXT_PSK_WITH_AES_128_CCM_8
 "PSK-AES128-CCM8"

	)

1036 
	#TLS1_TXT_PSK_WITH_AES_256_CCM_8
 "PSK-AES256-CCM8"

	)

1037 
	#TLS1_TXT_DHE_PSK_WITH_AES_128_CCM_8
 "DHE-PSK-AES128-CCM8"

	)

1038 
	#TLS1_TXT_DHE_PSK_WITH_AES_256_CCM_8
 "DHE-PSK-AES256-CCM8"

	)

1041 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_128_CCM
 "ECDHE-ECDSA-AES128-CCM"

	)

1042 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_256_CCM
 "ECDHE-ECDSA-AES256-CCM"

	)

1043 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_128_CCM_8
 "ECDHE-ECDSA-AES128-CCM8"

	)

1044 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_256_CCM_8
 "ECDHE-ECDSA-AES256-CCM8"

	)

1047 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_128_SHA256
 "ECDHE-ECDSA-AES128-SHA256"

	)

1048 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_256_SHA384
 "ECDHE-ECDSA-AES256-SHA384"

	)

1049 
	#TLS1_TXT_ECDH_ECDSA_WITH_AES_128_SHA256
 "ECDH-ECDSA-AES128-SHA256"

	)

1050 
	#TLS1_TXT_ECDH_ECDSA_WITH_AES_256_SHA384
 "ECDH-ECDSA-AES256-SHA384"

	)

1051 
	#TLS1_TXT_ECDHE_RSA_WITH_AES_128_SHA256
 "ECDHE-RSA-AES128-SHA256"

	)

1052 
	#TLS1_TXT_ECDHE_RSA_WITH_AES_256_SHA384
 "ECDHE-RSA-AES256-SHA384"

	)

1053 
	#TLS1_TXT_ECDH_RSA_WITH_AES_128_SHA256
 "ECDH-RSA-AES128-SHA256"

	)

1054 
	#TLS1_TXT_ECDH_RSA_WITH_AES_256_SHA384
 "ECDH-RSA-AES256-SHA384"

	)

1057 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
 "ECDHE-ECDSA-AES128-GCM-SHA256"

	)

1058 
	#TLS1_TXT_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
 "ECDHE-ECDSA-AES256-GCM-SHA384"

	)

1059 
	#TLS1_TXT_ECDH_ECDSA_WITH_AES_128_GCM_SHA256
 "ECDH-ECDSA-AES128-GCM-SHA256"

	)

1060 
	#TLS1_TXT_ECDH_ECDSA_WITH_AES_256_GCM_SHA384
 "ECDH-ECDSA-AES256-GCM-SHA384"

	)

1061 
	#TLS1_TXT_ECDHE_RSA_WITH_AES_128_GCM_SHA256
 "ECDHE-RSA-AES128-GCM-SHA256"

	)

1062 
	#TLS1_TXT_ECDHE_RSA_WITH_AES_256_GCM_SHA384
 "ECDHE-RSA-AES256-GCM-SHA384"

	)

1063 
	#TLS1_TXT_ECDH_RSA_WITH_AES_128_GCM_SHA256
 "ECDH-RSA-AES128-GCM-SHA256"

	)

1064 
	#TLS1_TXT_ECDH_RSA_WITH_AES_256_GCM_SHA384
 "ECDH-RSA-AES256-GCM-SHA384"

	)

1067 
	#TLS1_TXT_PSK_WITH_AES_128_GCM_SHA256
 "PSK-AES128-GCM-SHA256"

	)

1068 
	#TLS1_TXT_PSK_WITH_AES_256_GCM_SHA384
 "PSK-AES256-GCM-SHA384"

	)

1071 
	#TLS1_TXT_ECDHE_PSK_WITH_RC4_128_SHA
 "ECDHE-PSK-RC4-SHA"

	)

1072 
	#TLS1_TXT_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA
 "ECDHE-PSK-3DES-EDE-CBC-SHA"

	)

1073 
	#TLS1_TXT_ECDHE_PSK_WITH_AES_128_CBC_SHA
 "ECDHE-PSK-AES128-CBC-SHA"

	)

1074 
	#TLS1_TXT_ECDHE_PSK_WITH_AES_256_CBC_SHA
 "ECDHE-PSK-AES256-CBC-SHA"

	)

1076 
	#TLS1_TXT_ECDHE_PSK_WITH_AES_128_CBC_SHA256
 "ECDHE-PSK-AES128-CBC-SHA256"

	)

1077 
	#TLS1_TXT_ECDHE_PSK_WITH_AES_256_CBC_SHA384
 "ECDHE-PSK-AES256-CBC-SHA384"

	)

1079 
	#TLS1_TXT_ECDHE_PSK_WITH_NULL_SHA
 "ECDHE-PSK-NULL-SHA"

	)

1080 
	#TLS1_TXT_ECDHE_PSK_WITH_NULL_SHA256
 "ECDHE-PSK-NULL-SHA256"

	)

1081 
	#TLS1_TXT_ECDHE_PSK_WITH_NULL_SHA384
 "ECDHE-PSK-NULL-SHA384"

	)

1084 
	#TLS1_TXT_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256
 "ECDHE-ECDSA-CAMELLIA128-SHA256"

	)

1085 
	#TLS1_TXT_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384
 "ECDHE-ECDSA-CAMELLIA256-SHA384"

	)

1086 
	#TLS1_TXT_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256
 "ECDH-ECDSA-CAMELLIA128-SHA256"

	)

1087 
	#TLS1_TXT_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384
 "ECDH-ECDSA-CAMELLIA256-SHA384"

	)

1088 
	#TLS1_TXT_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256
 "ECDHE-RSA-CAMELLIA128-SHA256"

	)

1089 
	#TLS1_TXT_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384
 "ECDHE-RSA-CAMELLIA256-SHA384"

	)

1090 
	#TLS1_TXT_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256
 "ECDH-RSA-CAMELLIA128-SHA256"

	)

1091 
	#TLS1_TXT_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384
 "ECDH-RSA-CAMELLIA256-SHA384"

	)

1094 
	#TLS1_TXT_ECDHE_RSA_WITH_CHACHA20_POLY1305
 "ECDHE-RSA-CHACHA20-POLY1305"

	)

1095 
	#TLS1_TXT_ECDHE_ECDSA_WITH_CHACHA20_POLY1305
 "ECDHE-ECDSA-CHACHA20-POLY1305"

	)

1096 
	#TLS1_TXT_DHE_RSA_WITH_CHACHA20_POLY1305
 "DHE-RSA-CHACHA20-POLY1305"

	)

1097 
	#TLS1_TXT_PSK_WITH_CHACHA20_POLY1305
 "PSK-CHACHA20-POLY1305"

	)

1098 
	#TLS1_TXT_ECDHE_PSK_WITH_CHACHA20_POLY1305
 "ECDHE-PSK-CHACHA20-POLY1305"

	)

1099 
	#TLS1_TXT_DHE_PSK_WITH_CHACHA20_POLY1305
 "DHE-PSK-CHACHA20-POLY1305"

	)

1100 
	#TLS1_TXT_RSA_PSK_WITH_CHACHA20_POLY1305
 "RSA-PSK-CHACHA20-POLY1305"

	)

1103 
	#TLS1_TXT_RSA_WITH_ARIA_128_GCM_SHA256
 "ARIA128-GCM-SHA256"

	)

1104 
	#TLS1_TXT_RSA_WITH_ARIA_256_GCM_SHA384
 "ARIA256-GCM-SHA384"

	)

1105 
	#TLS1_TXT_DHE_RSA_WITH_ARIA_128_GCM_SHA256
 "DHE-RSA-ARIA128-GCM-SHA256"

	)

1106 
	#TLS1_TXT_DHE_RSA_WITH_ARIA_256_GCM_SHA384
 "DHE-RSA-ARIA256-GCM-SHA384"

	)

1107 
	#TLS1_TXT_DH_RSA_WITH_ARIA_128_GCM_SHA256
 "DH-RSA-ARIA128-GCM-SHA256"

	)

1108 
	#TLS1_TXT_DH_RSA_WITH_ARIA_256_GCM_SHA384
 "DH-RSA-ARIA256-GCM-SHA384"

	)

1109 
	#TLS1_TXT_DHE_DSS_WITH_ARIA_128_GCM_SHA256
 "DHE-DSS-ARIA128-GCM-SHA256"

	)

1110 
	#TLS1_TXT_DHE_DSS_WITH_ARIA_256_GCM_SHA384
 "DHE-DSS-ARIA256-GCM-SHA384"

	)

1111 
	#TLS1_TXT_DH_DSS_WITH_ARIA_128_GCM_SHA256
 "DH-DSS-ARIA128-GCM-SHA256"

	)

1112 
	#TLS1_TXT_DH_DSS_WITH_ARIA_256_GCM_SHA384
 "DH-DSS-ARIA256-GCM-SHA384"

	)

1113 
	#TLS1_TXT_DH_™⁄_WITH_ARIA_128_GCM_SHA256
 "ADH-ARIA128-GCM-SHA256"

	)

1114 
	#TLS1_TXT_DH_™⁄_WITH_ARIA_256_GCM_SHA384
 "ADH-ARIA256-GCM-SHA384"

	)

1115 
	#TLS1_TXT_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256
 "ECDHE-ECDSA-ARIA128-GCM-SHA256"

	)

1116 
	#TLS1_TXT_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384
 "ECDHE-ECDSA-ARIA256-GCM-SHA384"

	)

1117 
	#TLS1_TXT_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256
 "ECDH-ECDSA-ARIA128-GCM-SHA256"

	)

1118 
	#TLS1_TXT_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384
 "ECDH-ECDSA-ARIA256-GCM-SHA384"

	)

1119 
	#TLS1_TXT_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256
 "ECDHE-ARIA128-GCM-SHA256"

	)

1120 
	#TLS1_TXT_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384
 "ECDHE-ARIA256-GCM-SHA384"

	)

1121 
	#TLS1_TXT_ECDH_RSA_WITH_ARIA_128_GCM_SHA256
 "ECDH-ARIA128-GCM-SHA256"

	)

1122 
	#TLS1_TXT_ECDH_RSA_WITH_ARIA_256_GCM_SHA384
 "ECDH-ARIA256-GCM-SHA384"

	)

1123 
	#TLS1_TXT_PSK_WITH_ARIA_128_GCM_SHA256
 "PSK-ARIA128-GCM-SHA256"

	)

1124 
	#TLS1_TXT_PSK_WITH_ARIA_256_GCM_SHA384
 "PSK-ARIA256-GCM-SHA384"

	)

1125 
	#TLS1_TXT_DHE_PSK_WITH_ARIA_128_GCM_SHA256
 "DHE-PSK-ARIA128-GCM-SHA256"

	)

1126 
	#TLS1_TXT_DHE_PSK_WITH_ARIA_256_GCM_SHA384
 "DHE-PSK-ARIA256-GCM-SHA384"

	)

1127 
	#TLS1_TXT_RSA_PSK_WITH_ARIA_128_GCM_SHA256
 "RSA-PSK-ARIA128-GCM-SHA256"

	)

1128 
	#TLS1_TXT_RSA_PSK_WITH_ARIA_256_GCM_SHA384
 "RSA-PSK-ARIA256-GCM-SHA384"

	)

1130 
	#TLS_CT_RSA_SIGN
 1

	)

1131 
	#TLS_CT_DSS_SIGN
 2

	)

1132 
	#TLS_CT_RSA_FIXED_DH
 3

	)

1133 
	#TLS_CT_DSS_FIXED_DH
 4

	)

1134 
	#TLS_CT_ECDSA_SIGN
 64

	)

1135 
	#TLS_CT_RSA_FIXED_ECDH
 65

	)

1136 
	#TLS_CT_ECDSA_FIXED_ECDH
 66

	)

1137 
	#TLS_CT_GOST01_SIGN
 22

	)

1138 
	#TLS_CT_GOST12_SIGN
 238

	)

1139 
	#TLS_CT_GOST12_512_SIGN
 239

	)

1145 
	#TLS_CT_NUMBER
 10

	)

1147 #i‡
deföed
(
SSL3_CT_NUMBER
)

1148 #i‡
TLS_CT_NUMBER
 !
SSL3_CT_NUMBER


1153 
	#TLS1_FINISH_MAC_LENGTH
 12

	)

1155 
	#TLS_MD_MAX_CONST_SIZE
 22

	)

1156 
	#TLS_MD_CLIENT_FINISH_CONST
 "˛õ¡ föished"

	)

1157 
	#TLS_MD_CLIENT_FINISH_CONST_SIZE
 15

	)

1158 
	#TLS_MD_SERVER_FINISH_CONST
 "£rvî föished"

	)

1159 
	#TLS_MD_SERVER_FINISH_CONST_SIZE
 15

	)

1160 
	#TLS_MD_KEY_EXPANSION_CONST
 "keyÉx∑nsi⁄"

	)

1161 
	#TLS_MD_KEY_EXPANSION_CONST_SIZE
 13

	)

1162 
	#TLS_MD_CLIENT_WRITE_KEY_CONST
 "˛õ¡ wrôêkey"

	)

1163 
	#TLS_MD_CLIENT_WRITE_KEY_CONST_SIZE
 16

	)

1164 
	#TLS_MD_SERVER_WRITE_KEY_CONST
 "£rvî wrôêkey"

	)

1165 
	#TLS_MD_SERVER_WRITE_KEY_CONST_SIZE
 16

	)

1166 
	#TLS_MD_IV_BLOCK_CONST
 "IV block"

	)

1167 
	#TLS_MD_IV_BLOCK_CONST_SIZE
 8

	)

1168 
	#TLS_MD_MASTER_SECRET_CONST
 "ma°î se¸ë"

	)

1169 
	#TLS_MD_MASTER_SECRET_CONST_SIZE
 13

	)

1170 
	#TLS_MD_EXTENDED_MASTER_SECRET_CONST
 "exãnded ma°î se¸ë"

	)

1171 
	#TLS_MD_EXTENDED_MASTER_SECRET_CONST_SIZE
 22

	)

1173 #ifde‡
CHARSET_EBCDIC


1174 #unde‡
TLS_MD_CLIENT_FINISH_CONST


1178 
	#TLS_MD_CLIENT_FINISH_CONST
 "\x63\x6c\x69\x65\x6e\x74\x20\x66\x69\x6e\x69\x73\x68\x65\x64"

	)

1180 #unde‡
TLS_MD_SERVER_FINISH_CONST


1184 
	#TLS_MD_SERVER_FINISH_CONST
 "\x73\x65\x72\x76\x65\x72\x20\x66\x69\x6e\x69\x73\x68\x65\x64"

	)

1186 #unde‡
TLS_MD_SERVER_WRITE_KEY_CONST


1190 
	#TLS_MD_SERVER_WRITE_KEY_CONST
 "\x73\x65\x72\x76\x65\x72\x20\x77\x72\x69\x74\x65\x20\x6b\x65\x79"

	)

1192 #unde‡
TLS_MD_KEY_EXPANSION_CONST


1196 
	#TLS_MD_KEY_EXPANSION_CONST
 "\x6b\x65\x79\x20\x65\x78\x70\x61\x6e\x73\x69\x6f\x6e"

	)

1198 #unde‡
TLS_MD_CLIENT_WRITE_KEY_CONST


1202 
	#TLS_MD_CLIENT_WRITE_KEY_CONST
 "\x63\x6c\x69\x65\x6e\x74\x20\x77\x72\x69\x74\x65\x20\x6b\x65\x79"

	)

1204 #unde‡
TLS_MD_SERVER_WRITE_KEY_CONST


1208 
	#TLS_MD_SERVER_WRITE_KEY_CONST
 "\x73\x65\x72\x76\x65\x72\x20\x77\x72\x69\x74\x65\x20\x6b\x65\x79"

	)

1210 #unde‡
TLS_MD_IV_BLOCK_CONST


1214 
	#TLS_MD_IV_BLOCK_CONST
 "\x49\x56\x20\x62\x6c\x6f\x63\x6b"

	)

1216 #unde‡
TLS_MD_MASTER_SECRET_CONST


1220 
	#TLS_MD_MASTER_SECRET_CONST
 "\x6d\x61\x73\x74\x65\x72\x20\x73\x65\x63\x72\x65\x74"

	)

1221 #unde‡
TLS_MD_EXTENDED_MASTER_SECRET_CONST


1225 
	#TLS_MD_EXTENDED_MASTER_SECRET_CONST
 "\x65\x78\x74\x65\x6e\x64\x65\x64\x20\x6d\x61\x73\x74\x65\x72\x20\x73\x65\x63\x72\x65\x74"

	)

1229 
	sés_£ssi⁄_tickë_ext_°
 {

1230 
Àngth
;

1231 *
d©a
;

1234 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/x509.h

11 #i‚de‡
HEADER_X509_H


12 
	#HEADER_X509_H


	)

14 
	~<›ís¶/e_os2.h
>

15 
	~<›ís¶/os¶_typ.h
>

16 
	~<›ís¶/symhacks.h
>

17 
	~<›ís¶/buf„r.h
>

18 
	~<›ís¶/evp.h
>

19 
	~<›ís¶/bio.h
>

20 
	~<›ís¶/a¢1.h
>

21 
	~<›ís¶/ß„°ack.h
>

22 
	~<›ís¶/ec.h
>

24 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

25 
	~<›ís¶/rß.h
>

26 
	~<›ís¶/dß.h
>

27 
	~<›ís¶/dh.h
>

30 
	~<›ís¶/sha.h
>

31 
	~<›ís¶/x509îr.h
>

33 #ifde‡ 
__˝lu•lus


40 
	#X509_SIG_INFO_VALID
 0x1

	)

42 
	#X509_SIG_INFO_TLS
 0x2

	)

44 
	#X509_FILETYPE_PEM
 1

	)

45 
	#X509_FILETYPE_ASN1
 2

	)

46 
	#X509_FILETYPE_DEFAULT
 3

	)

48 
	#X509v3_KU_DIGITAL_SIGNATURE
 0x0080

	)

49 
	#X509v3_KU_NON_REPUDIATION
 0x0040

	)

50 
	#X509v3_KU_KEY_ENCIPHERMENT
 0x0020

	)

51 
	#X509v3_KU_DATA_ENCIPHERMENT
 0x0010

	)

52 
	#X509v3_KU_KEY_AGREEMENT
 0x0008

	)

53 
	#X509v3_KU_KEY_CERT_SIGN
 0x0004

	)

54 
	#X509v3_KU_CRL_SIGN
 0x0002

	)

55 
	#X509v3_KU_ENCIPHER_ONLY
 0x0001

	)

56 
	#X509v3_KU_DECIPHER_ONLY
 0x8000

	)

57 
	#X509v3_KU_UNDEF
 0xffff

	)

59 
	sX509_Æg‹_°
 {

60 
ASN1_OBJECT
 *
Æg‹ôhm
;

61 
ASN1_TYPE
 *
∑ømëî
;

64 
STACK_OF
(
	tX509_ALGOR
Ë
	tX509_ALGORS
;

66 
	sX509_vÆ_°
 {

67 
ASN1_TIME
 *
nŸBef‹e
;

68 
ASN1_TIME
 *
nŸA·î
;

69 } 
	tX509_VAL
;

71 
X509_sig_°
 
	tX509_SIG
;

73 
X509_«me_íåy_°
 
	tX509_NAME_ENTRY
;

75 
DEFINE_STACK_OF
(
X509_NAME_ENTRY
)

77 
DEFINE_STACK_OF
(
X509_NAME
)

79 
	#X509_EX_V_NETSCAPE_HACK
 0x8000

	)

80 
	#X509_EX_V_INIT
 0x0001

	)

81 
X509_exãnsi⁄_°
 
	tX509_EXTENSION
;

83 
STACK_OF
(
	tX509_EXTENSION
Ë
	tX509_EXTENSIONS
;

85 
DEFINE_STACK_OF
(
X509_EXTENSION
)

87 
x509_©åibuãs_°
 
	tX509_ATTRIBUTE
;

89 
DEFINE_STACK_OF
(
X509_ATTRIBUTE
)

91 
X509_ªq_öfo_°
 
	tX509_REQ_INFO
;

93 
X509_ªq_°
 
	tX509_REQ
;

95 
x509_˚π_aux_°
 
	tX509_CERT_AUX
;

97 
x509_cöf_°
 
	tX509_CINF
;

99 
DEFINE_STACK_OF
(
X509
)

103 
	sx509_åu°_°
 {

104 
åu°
;

105 
Êags
;

106 (*
check_åu°
Ë(
x509_åu°_°
 *, 
X509
 *, );

107 *
«me
;

108 
¨g1
;

109 *
¨g2
;

110 } 
	tX509_TRUST
;

112 
DEFINE_STACK_OF
(
X509_TRUST
)

116 
	#X509_TRUST_DEFAULT
 0

	)

118 
	#X509_TRUST_COMPAT
 1

	)

119 
	#X509_TRUST_SSL_CLIENT
 2

	)

120 
	#X509_TRUST_SSL_SERVER
 3

	)

121 
	#X509_TRUST_EMAIL
 4

	)

122 
	#X509_TRUST_OBJECT_SIGN
 5

	)

123 
	#X509_TRUST_OCSP_SIGN
 6

	)

124 
	#X509_TRUST_OCSP_REQUEST
 7

	)

125 
	#X509_TRUST_TSA
 8

	)

128 
	#X509_TRUST_MIN
 1

	)

129 
	#X509_TRUST_MAX
 8

	)

132 
	#X509_TRUST_DYNAMIC
 (1U << 0)

	)

133 
	#X509_TRUST_DYNAMIC_NAME
 (1U << 1)

	)

135 
	#X509_TRUST_NO_SS_COMPAT
 (1U << 2)

	)

137 
	#X509_TRUST_DO_SS_COMPAT
 (1U << 3)

	)

139 
	#X509_TRUST_OK_ANY_EKU
 (1U << 4)

	)

143 
	#X509_TRUST_TRUSTED
 1

	)

144 
	#X509_TRUST_REJECTED
 2

	)

145 
	#X509_TRUST_UNTRUSTED
 3

	)

149 
	#X509_FLAG_COMPAT
 0

	)

150 
	#X509_FLAG_NO_HEADER
 1L

	)

151 
	#X509_FLAG_NO_VERSION
 (1L << 1)

	)

152 
	#X509_FLAG_NO_SERIAL
 (1L << 2)

	)

153 
	#X509_FLAG_NO_SIGNAME
 (1L << 3)

	)

154 
	#X509_FLAG_NO_ISSUER
 (1L << 4)

	)

155 
	#X509_FLAG_NO_VALIDITY
 (1L << 5)

	)

156 
	#X509_FLAG_NO_SUBJECT
 (1L << 6)

	)

157 
	#X509_FLAG_NO_PUBKEY
 (1L << 7)

	)

158 
	#X509_FLAG_NO_EXTENSIONS
 (1L << 8)

	)

159 
	#X509_FLAG_NO_SIGDUMP
 (1L << 9)

	)

160 
	#X509_FLAG_NO_AUX
 (1L << 10)

	)

161 
	#X509_FLAG_NO_ATTRIBUTES
 (1L << 11)

	)

162 
	#X509_FLAG_NO_IDS
 (1L << 12)

	)

168 
	#XN_FLAG_SEP_MASK
 (0x‡<< 16)

	)

170 
	#XN_FLAG_COMPAT
 0

	)

171 
	#XN_FLAG_SEP_COMMA_PLUS
 (1 << 16)

	)

172 
	#XN_FLAG_SEP_CPLUS_SPC
 (2 << 16)

	)

173 
	#XN_FLAG_SEP_SPLUS_SPC
 (3 << 16)

	)

174 
	#XN_FLAG_SEP_MULTILINE
 (4 << 16)

	)

176 
	#XN_FLAG_DN_REV
 (1 << 20)

	)

180 
	#XN_FLAG_FN_MASK
 (0x3 << 21)

	)

182 
	#XN_FLAG_FN_SN
 0

	)

183 
	#XN_FLAG_FN_LN
 (1 << 21)

	)

184 
	#XN_FLAG_FN_OID
 (2 << 21)

	)

185 
	#XN_FLAG_FN_NONE
 (3 << 21)

	)

187 
	#XN_FLAG_SPC_EQ
 (1 << 23)

	)

194 
	#XN_FLAG_DUMP_UNKNOWN_FIELDS
 (1 << 24)

	)

196 
	#XN_FLAG_FN_ALIGN
 (1 << 25)

	)

201 
	#XN_FLAG_RFC2253
 (
ASN1_STRFLGS_RFC2253
 | \

202 
XN_FLAG_SEP_COMMA_PLUS
 | \

203 
XN_FLAG_DN_REV
 | \

204 
XN_FLAG_FN_SN
 | \

205 
XN_FLAG_DUMP_UNKNOWN_FIELDS
)

	)

209 
	#XN_FLAG_ONELINE
 (
ASN1_STRFLGS_RFC2253
 | \

210 
ASN1_STRFLGS_ESC_QUOTE
 | \

211 
XN_FLAG_SEP_CPLUS_SPC
 | \

212 
XN_FLAG_SPC_EQ
 | \

213 
XN_FLAG_FN_SN
)

	)

217 
	#XN_FLAG_MULTILINE
 (
ASN1_STRFLGS_ESC_CTRL
 | \

218 
ASN1_STRFLGS_ESC_MSB
 | \

219 
XN_FLAG_SEP_MULTILINE
 | \

220 
XN_FLAG_SPC_EQ
 | \

221 
XN_FLAG_FN_LN
 | \

222 
XN_FLAG_FN_ALIGN
)

	)

224 
DEFINE_STACK_OF
(
X509_REVOKED
)

226 
X509_¸l_öfo_°
 
	tX509_CRL_INFO
;

228 
DEFINE_STACK_OF
(
X509_CRL
)

230 
	s¥iv©e_key_°
 {

231 
vîsi⁄
;

233 
X509_ALGOR
 *
íc_Æg‹
;

234 
ASN1_OCTET_STRING
 *
íc_pkey
;

236 
EVP_PKEY
 *
dec_pkey
;

238 
key_Àngth
;

239 *
key_d©a
;

240 
key_‰ì
;

242 
EVP_CIPHER_INFO
 
cùhî
;

243 } 
	tX509_PKEY
;

245 
	sX509_öfo_°
 {

246 
X509
 *
x509
;

247 
X509_CRL
 *
¸l
;

248 
X509_PKEY
 *
x_pkey
;

249 
EVP_CIPHER_INFO
 
íc_cùhî
;

250 
íc_Àn
;

251 *
íc_d©a
;

252 } 
	tX509_INFO
;

254 
DEFINE_STACK_OF
(
X509_INFO
)

260 
	sNësˇ≥_•kac_°
 {

261 
X509_PUBKEY
 *
pubkey
;

262 
ASN1_IA5STRING
 *
chÆÀnge
;

263 } 
	tNETSCAPE_SPKAC
;

265 
	sNësˇ≥_•ki_°
 {

266 
NETSCAPE_SPKAC
 *
•kac
;

267 
X509_ALGOR
 
sig_Æg‹
;

268 
ASN1_BIT_STRING
 *
sig«tuª
;

269 } 
	tNETSCAPE_SPKI
;

272 
	sNësˇ≥_˚πifiˇã_£quí˚
 {

273 
ASN1_OBJECT
 *
ty≥
;

274 
STACK_OF
(
X509
Ë*
˚πs
;

275 } 
	tNETSCAPE_CERT_SEQUENCE
;

286 
	sPBEPARAM_°
 {

287 
ASN1_OCTET_STRING
 *
ß…
;

288 
ASN1_INTEGER
 *
ôî
;

289 } 
	tPBEPARAM
;

293 
	sPBE2PARAM_°
 {

294 
X509_ALGOR
 *
keyfunc
;

295 
X509_ALGOR
 *
í¸y±i⁄
;

296 } 
	tPBE2PARAM
;

298 
	sPBKDF2PARAM_°
 {

300 
ASN1_TYPE
 *
ß…
;

301 
ASN1_INTEGER
 *
ôî
;

302 
ASN1_INTEGER
 *
keyÀngth
;

303 
X509_ALGOR
 *
¥f
;

304 } 
	tPBKDF2PARAM
;

306 #i‚de‡
OPENSSL_NO_SCRYPT


307 
	sSCRYPT_PARAMS_°
 {

308 
ASN1_OCTET_STRING
 *
ß…
;

309 
ASN1_INTEGER
 *
co°P¨amëî
;

310 
ASN1_INTEGER
 *
blockSize
;

311 
ASN1_INTEGER
 *
∑øŒñiz©i⁄P¨amëî
;

312 
ASN1_INTEGER
 *
keyLígth
;

313 } 
	tSCRYPT_PARAMS
;

316 #ifde‡ 
__˝lu•lus


320 
	~<›ís¶/x509_vfy.h
>

321 
	~<›ís¶/pkcs7.h
>

323 #ifde‡ 
__˝lu•lus


327 
	#X509_EXT_PACK_UNKNOWN
 1

	)

328 
	#X509_EXT_PACK_STRING
 2

	)

330 
	#X509_exåa˘_key
(
x
Ë
	`X509_gë_pubkey
(x)

	)

331 
	#X509_REQ_exåa˘_key
(
a
Ë
	`X509_REQ_gë_pubkey
◊)

	)

332 
	#X509_«me_cmp
(
a
,
b
Ë
	`X509_NAME_cmp
(◊),(b))

	)

334 
X509_CRL_£t_deÁu…_mëhod
(c⁄° 
X509_CRL_METHOD
 *
mëh
);

335 
X509_CRL_METHOD
 *
X509_CRL_METHOD_√w
((*
¸l_öô
Ë(
X509_CRL
 *
¸l
),

336 (*
¸l_‰ì
Ë(
X509_CRL
 *
¸l
),

337 (*
¸l_lookup
Ë(
X509_CRL
 *
¸l
,

338 
X509_REVOKED
 **
ªt
,

339 
ASN1_INTEGER
 *
£r
,

340 
X509_NAME
 *
issuî
),

341 (*
¸l_vîify
Ë(
X509_CRL
 *
¸l
,

342 
EVP_PKEY
 *
pk
));

343 
X509_CRL_METHOD_‰ì
(
X509_CRL_METHOD
 *
m
);

345 
X509_CRL_£t_mëh_d©a
(
X509_CRL
 *
¸l
, *
d©
);

346 *
X509_CRL_gë_mëh_d©a
(
X509_CRL
 *
¸l
);

348 c⁄° *
X509_vîify_˚π_îr‹_°rög
(
n
);

350 
X509_vîify
(
X509
 *
a
, 
EVP_PKEY
 *
r
);

352 
X509_REQ_vîify
(
X509_REQ
 *
a
, 
EVP_PKEY
 *
r
);

353 
X509_CRL_vîify
(
X509_CRL
 *
a
, 
EVP_PKEY
 *
r
);

354 
NETSCAPE_SPKI_vîify
(
NETSCAPE_SPKI
 *
a
, 
EVP_PKEY
 *
r
);

356 
NETSCAPE_SPKI
 *
NETSCAPE_SPKI_b64_decode
(c⁄° *
°r
, 
Àn
);

357 *
NETSCAPE_SPKI_b64_ícode
(
NETSCAPE_SPKI
 *
x
);

358 
EVP_PKEY
 *
NETSCAPE_SPKI_gë_pubkey
(
NETSCAPE_SPKI
 *
x
);

359 
NETSCAPE_SPKI_£t_pubkey
(
NETSCAPE_SPKI
 *
x
, 
EVP_PKEY
 *
pkey
);

361 
NETSCAPE_SPKI_¥öt
(
BIO
 *
out
, 
NETSCAPE_SPKI
 *
•ki
);

363 
X509_sig«tuª_dump
(
BIO
 *
bp
, c⁄° 
ASN1_STRING
 *
sig
, 
ödít
);

364 
X509_sig«tuª_¥öt
(
BIO
 *
bp
, c⁄° 
X509_ALGOR
 *
Æg
,

365 c⁄° 
ASN1_STRING
 *
sig
);

367 
X509_sign
(
X509
 *
x
, 
EVP_PKEY
 *
pkey
, c⁄° 
EVP_MD
 *
md
);

368 
X509_sign_˘x
(
X509
 *
x
, 
EVP_MD_CTX
 *
˘x
);

369 #i‚de‡
OPENSSL_NO_OCSP


370 
X509_hâp_nbio
(
OCSP_REQ_CTX
 *
r˘x
, 
X509
 **
p˚π
);

372 
X509_REQ_sign
(
X509_REQ
 *
x
, 
EVP_PKEY
 *
pkey
, c⁄° 
EVP_MD
 *
md
);

373 
X509_REQ_sign_˘x
(
X509_REQ
 *
x
, 
EVP_MD_CTX
 *
˘x
);

374 
X509_CRL_sign
(
X509_CRL
 *
x
, 
EVP_PKEY
 *
pkey
, c⁄° 
EVP_MD
 *
md
);

375 
X509_CRL_sign_˘x
(
X509_CRL
 *
x
, 
EVP_MD_CTX
 *
˘x
);

376 #i‚de‡
OPENSSL_NO_OCSP


377 
X509_CRL_hâp_nbio
(
OCSP_REQ_CTX
 *
r˘x
, 
X509_CRL
 **
p¸l
);

379 
NETSCAPE_SPKI_sign
(
NETSCAPE_SPKI
 *
x
, 
EVP_PKEY
 *
pkey
, c⁄° 
EVP_MD
 *
md
);

381 
X509_pubkey_dige°
(c⁄° 
X509
 *
d©a
, c⁄° 
EVP_MD
 *
ty≥
,

382 *
md
, *
Àn
);

383 
X509_dige°
(c⁄° 
X509
 *
d©a
, c⁄° 
EVP_MD
 *
ty≥
,

384 *
md
, *
Àn
);

385 
X509_CRL_dige°
(c⁄° 
X509_CRL
 *
d©a
, c⁄° 
EVP_MD
 *
ty≥
,

386 *
md
, *
Àn
);

387 
X509_REQ_dige°
(c⁄° 
X509_REQ
 *
d©a
, c⁄° 
EVP_MD
 *
ty≥
,

388 *
md
, *
Àn
);

389 
X509_NAME_dige°
(c⁄° 
X509_NAME
 *
d©a
, c⁄° 
EVP_MD
 *
ty≥
,

390 *
md
, *
Àn
);

392 #i‚de‡
OPENSSL_NO_STDIO


393 
X509
 *
d2i_X509_Â
(
FILE
 *
Â
, X509 **
x509
);

394 
i2d_X509_Â
(
FILE
 *
Â
, 
X509
 *
x509
);

395 
X509_CRL
 *
d2i_X509_CRL_Â
(
FILE
 *
Â
, X509_CRL **
¸l
);

396 
i2d_X509_CRL_Â
(
FILE
 *
Â
, 
X509_CRL
 *
¸l
);

397 
X509_REQ
 *
d2i_X509_REQ_Â
(
FILE
 *
Â
, X509_REQ **
ªq
);

398 
i2d_X509_REQ_Â
(
FILE
 *
Â
, 
X509_REQ
 *
ªq
);

399 #i‚de‡
OPENSSL_NO_RSA


400 
RSA
 *
d2i_RSAPriv©eKey_Â
(
FILE
 *
Â
, RSA **
rß
);

401 
i2d_RSAPriv©eKey_Â
(
FILE
 *
Â
, 
RSA
 *
rß
);

402 
RSA
 *
d2i_RSAPublicKey_Â
(
FILE
 *
Â
, RSA **
rß
);

403 
i2d_RSAPublicKey_Â
(
FILE
 *
Â
, 
RSA
 *
rß
);

404 
RSA
 *
d2i_RSA_PUBKEY_Â
(
FILE
 *
Â
, RSA **
rß
);

405 
i2d_RSA_PUBKEY_Â
(
FILE
 *
Â
, 
RSA
 *
rß
);

407 #i‚de‡
OPENSSL_NO_DSA


408 
DSA
 *
d2i_DSA_PUBKEY_Â
(
FILE
 *
Â
, DSA **
dß
);

409 
i2d_DSA_PUBKEY_Â
(
FILE
 *
Â
, 
DSA
 *
dß
);

410 
DSA
 *
d2i_DSAPriv©eKey_Â
(
FILE
 *
Â
, DSA **
dß
);

411 
i2d_DSAPriv©eKey_Â
(
FILE
 *
Â
, 
DSA
 *
dß
);

413 #i‚de‡
OPENSSL_NO_EC


414 
EC_KEY
 *
d2i_EC_PUBKEY_Â
(
FILE
 *
Â
, EC_KEY **
eckey
);

415 
i2d_EC_PUBKEY_Â
(
FILE
 *
Â
, 
EC_KEY
 *
eckey
);

416 
EC_KEY
 *
d2i_ECPriv©eKey_Â
(
FILE
 *
Â
, EC_KEY **
eckey
);

417 
i2d_ECPriv©eKey_Â
(
FILE
 *
Â
, 
EC_KEY
 *
eckey
);

419 
X509_SIG
 *
d2i_PKCS8_Â
(
FILE
 *
Â
, X509_SIG **
p8
);

420 
i2d_PKCS8_Â
(
FILE
 *
Â
, 
X509_SIG
 *
p8
);

421 
PKCS8_PRIV_KEY_INFO
 *
d2i_PKCS8_PRIV_KEY_INFO_Â
(
FILE
 *
Â
,

422 
PKCS8_PRIV_KEY_INFO
 **
p8öf
);

423 
i2d_PKCS8_PRIV_KEY_INFO_Â
(
FILE
 *
Â
, 
PKCS8_PRIV_KEY_INFO
 *
p8öf
);

424 
i2d_PKCS8Priv©eKeyInfo_Â
(
FILE
 *
Â
, 
EVP_PKEY
 *
key
);

425 
i2d_Priv©eKey_Â
(
FILE
 *
Â
, 
EVP_PKEY
 *
pkey
);

426 
EVP_PKEY
 *
d2i_Priv©eKey_Â
(
FILE
 *
Â
, EVP_PKEY **
a
);

427 
i2d_PUBKEY_Â
(
FILE
 *
Â
, 
EVP_PKEY
 *
pkey
);

428 
EVP_PKEY
 *
d2i_PUBKEY_Â
(
FILE
 *
Â
, EVP_PKEY **
a
);

431 
X509
 *
d2i_X509_bio
(
BIO
 *
bp
, X509 **
x509
);

432 
i2d_X509_bio
(
BIO
 *
bp
, 
X509
 *
x509
);

433 
X509_CRL
 *
d2i_X509_CRL_bio
(
BIO
 *
bp
, X509_CRL **
¸l
);

434 
i2d_X509_CRL_bio
(
BIO
 *
bp
, 
X509_CRL
 *
¸l
);

435 
X509_REQ
 *
d2i_X509_REQ_bio
(
BIO
 *
bp
, X509_REQ **
ªq
);

436 
i2d_X509_REQ_bio
(
BIO
 *
bp
, 
X509_REQ
 *
ªq
);

437 #i‚de‡
OPENSSL_NO_RSA


438 
RSA
 *
d2i_RSAPriv©eKey_bio
(
BIO
 *
bp
, RSA **
rß
);

439 
i2d_RSAPriv©eKey_bio
(
BIO
 *
bp
, 
RSA
 *
rß
);

440 
RSA
 *
d2i_RSAPublicKey_bio
(
BIO
 *
bp
, RSA **
rß
);

441 
i2d_RSAPublicKey_bio
(
BIO
 *
bp
, 
RSA
 *
rß
);

442 
RSA
 *
d2i_RSA_PUBKEY_bio
(
BIO
 *
bp
, RSA **
rß
);

443 
i2d_RSA_PUBKEY_bio
(
BIO
 *
bp
, 
RSA
 *
rß
);

445 #i‚de‡
OPENSSL_NO_DSA


446 
DSA
 *
d2i_DSA_PUBKEY_bio
(
BIO
 *
bp
, DSA **
dß
);

447 
i2d_DSA_PUBKEY_bio
(
BIO
 *
bp
, 
DSA
 *
dß
);

448 
DSA
 *
d2i_DSAPriv©eKey_bio
(
BIO
 *
bp
, DSA **
dß
);

449 
i2d_DSAPriv©eKey_bio
(
BIO
 *
bp
, 
DSA
 *
dß
);

451 #i‚de‡
OPENSSL_NO_EC


452 
EC_KEY
 *
d2i_EC_PUBKEY_bio
(
BIO
 *
bp
, EC_KEY **
eckey
);

453 
i2d_EC_PUBKEY_bio
(
BIO
 *
bp
, 
EC_KEY
 *
eckey
);

454 
EC_KEY
 *
d2i_ECPriv©eKey_bio
(
BIO
 *
bp
, EC_KEY **
eckey
);

455 
i2d_ECPriv©eKey_bio
(
BIO
 *
bp
, 
EC_KEY
 *
eckey
);

457 
X509_SIG
 *
d2i_PKCS8_bio
(
BIO
 *
bp
, X509_SIG **
p8
);

458 
i2d_PKCS8_bio
(
BIO
 *
bp
, 
X509_SIG
 *
p8
);

459 
PKCS8_PRIV_KEY_INFO
 *
d2i_PKCS8_PRIV_KEY_INFO_bio
(
BIO
 *
bp
,

460 
PKCS8_PRIV_KEY_INFO
 **
p8öf
);

461 
i2d_PKCS8_PRIV_KEY_INFO_bio
(
BIO
 *
bp
, 
PKCS8_PRIV_KEY_INFO
 *
p8öf
);

462 
i2d_PKCS8Priv©eKeyInfo_bio
(
BIO
 *
bp
, 
EVP_PKEY
 *
key
);

463 
i2d_Priv©eKey_bio
(
BIO
 *
bp
, 
EVP_PKEY
 *
pkey
);

464 
EVP_PKEY
 *
d2i_Priv©eKey_bio
(
BIO
 *
bp
, EVP_PKEY **
a
);

465 
i2d_PUBKEY_bio
(
BIO
 *
bp
, 
EVP_PKEY
 *
pkey
);

466 
EVP_PKEY
 *
d2i_PUBKEY_bio
(
BIO
 *
bp
, EVP_PKEY **
a
);

468 
X509
 *
X509_dup
(X509 *
x509
);

469 
X509_ATTRIBUTE
 *
X509_ATTRIBUTE_dup
(X509_ATTRIBUTE *
xa
);

470 
X509_EXTENSION
 *
X509_EXTENSION_dup
(X509_EXTENSION *
ex
);

471 
X509_CRL
 *
X509_CRL_dup
(X509_CRL *
¸l
);

472 
X509_REVOKED
 *
X509_REVOKED_dup
(X509_REVOKED *
ªv
);

473 
X509_REQ
 *
X509_REQ_dup
(X509_REQ *
ªq
);

474 
X509_ALGOR
 *
X509_ALGOR_dup
(X509_ALGOR *
xn
);

475 
X509_ALGOR_£t0
(
X509_ALGOR
 *
Æg
, 
ASN1_OBJECT
 *
aobj
, 
±y≥
,

476 *
pvÆ
);

477 
X509_ALGOR_gë0
(c⁄° 
ASN1_OBJECT
 **
∑obj
, *
µty≥
,

478 c⁄° **
µvÆ
, c⁄° 
X509_ALGOR
 *
Æg‹
);

479 
X509_ALGOR_£t_md
(
X509_ALGOR
 *
Æg
, c⁄° 
EVP_MD
 *
md
);

480 
X509_ALGOR_cmp
(c⁄° 
X509_ALGOR
 *
a
, c⁄° X509_ALGOR *
b
);

482 
X509_NAME
 *
X509_NAME_dup
(X509_NAME *
xn
);

483 
X509_NAME_ENTRY
 *
X509_NAME_ENTRY_dup
(X509_NAME_ENTRY *
√
);

485 
X509_cmp_time
(c⁄° 
ASN1_TIME
 *
s
, 
time_t
 *
t
);

486 
X509_cmp_cuºít_time
(c⁄° 
ASN1_TIME
 *
s
);

487 
ASN1_TIME
 *
X509_time_adj
(ASN1_TIME *
s
, 
adj
, 
time_t
 *
t
);

488 
ASN1_TIME
 *
X509_time_adj_ex
(ASN1_TIME *
s
,

489 
off£t_day
, 
off£t_£c
, 
time_t
 *
t
);

490 
ASN1_TIME
 *
X509_gmtime_adj
(ASN1_TIME *
s
, 
adj
);

492 c⁄° *
X509_gë_deÁu…_˚π_¨ó
();

493 c⁄° *
X509_gë_deÁu…_˚π_dú
();

494 c⁄° *
X509_gë_deÁu…_˚π_fûe
();

495 c⁄° *
X509_gë_deÁu…_˚π_dú_ív
();

496 c⁄° *
X509_gë_deÁu…_˚π_fûe_ív
();

497 c⁄° *
X509_gë_deÁu…_¥iv©e_dú
();

499 
X509_REQ
 *
X509_to_X509_REQ
(
X509
 *
x
, 
EVP_PKEY
 *
pkey
, c⁄° 
EVP_MD
 *
md
);

500 
X509
 *
X509_REQ_to_X509
(
X509_REQ
 *
r
, 
days
, 
EVP_PKEY
 *
pkey
);

502 
DECLARE_ASN1_FUNCTIONS
(
X509_ALGOR
)

503 
DECLARE_ASN1_ENCODE_FUNCTIONS
(
X509_ALGORS
, X509_ALGORS, X509_ALGORS)

504 
DECLARE_ASN1_FUNCTIONS
(
X509_VAL
)

506 
DECLARE_ASN1_FUNCTIONS
(
X509_PUBKEY
)

508 
X509_PUBKEY_£t
(
X509_PUBKEY
 **
x
, 
EVP_PKEY
 *
pkey
);

509 
EVP_PKEY
 *
X509_PUBKEY_gë0
(
X509_PUBKEY
 *
key
);

510 
EVP_PKEY
 *
X509_PUBKEY_gë
(
X509_PUBKEY
 *
key
);

511 
X509_gë_pubkey_∑ømëîs
(
EVP_PKEY
 *
pkey
, 
STACK_OF
(
X509
Ë*
chaö
);

512 
X509_gë_∑thÀn
(
X509
 *
x
);

513 
i2d_PUBKEY
(
EVP_PKEY
 *
a
, **
µ
);

514 
EVP_PKEY
 *
d2i_PUBKEY
(EVP_PKEY **
a
, c⁄° **
µ
, 
Àngth
);

515 #i‚de‡
OPENSSL_NO_RSA


516 
i2d_RSA_PUBKEY
(
RSA
 *
a
, **
µ
);

517 
RSA
 *
d2i_RSA_PUBKEY
(RSA **
a
, c⁄° **
µ
, 
Àngth
);

519 #i‚de‡
OPENSSL_NO_DSA


520 
i2d_DSA_PUBKEY
(
DSA
 *
a
, **
µ
);

521 
DSA
 *
d2i_DSA_PUBKEY
(DSA **
a
, c⁄° **
µ
, 
Àngth
);

523 #i‚de‡
OPENSSL_NO_EC


524 
i2d_EC_PUBKEY
(
EC_KEY
 *
a
, **
µ
);

525 
EC_KEY
 *
d2i_EC_PUBKEY
(EC_KEY **
a
, c⁄° **
µ
, 
Àngth
);

528 
DECLARE_ASN1_FUNCTIONS
(
X509_SIG
)

529 
X509_SIG_gë0
(c⁄° 
X509_SIG
 *
sig
, c⁄° 
X509_ALGOR
 **
∑lg
,

530 c⁄° 
ASN1_OCTET_STRING
 **
pdige°
);

531 
X509_SIG_gëm
(
X509_SIG
 *
sig
, 
X509_ALGOR
 **
∑lg
,

532 
ASN1_OCTET_STRING
 **
pdige°
);

534 
DECLARE_ASN1_FUNCTIONS
(
X509_REQ_INFO
)

535 
DECLARE_ASN1_FUNCTIONS
(
X509_REQ
)

537 
DECLARE_ASN1_FUNCTIONS
(
X509_ATTRIBUTE
)

538 
X509_ATTRIBUTE
 *
X509_ATTRIBUTE_¸óã
(
nid
, 
©πy≥
, *
vÆue
);

540 
DECLARE_ASN1_FUNCTIONS
(
X509_EXTENSION
)

541 
DECLARE_ASN1_ENCODE_FUNCTIONS
(
X509_EXTENSIONS
, X509_EXTENSIONS, X509_EXTENSIONS)

543 
DECLARE_ASN1_FUNCTIONS
(
X509_NAME_ENTRY
)

545 
DECLARE_ASN1_FUNCTIONS
(
X509_NAME
)

547 
X509_NAME_£t
(
X509_NAME
 **
xn
, X509_NAME *
«me
);

549 
DECLARE_ASN1_FUNCTIONS
(
X509_CINF
)

551 
DECLARE_ASN1_FUNCTIONS
(
X509
)

552 
DECLARE_ASN1_FUNCTIONS
(
X509_CERT_AUX
)

554 
	#X509_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

555 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_X509
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

556 
X509_£t_ex_d©a
(
X509
 *
r
, 
idx
, *
¨g
);

557 *
X509_gë_ex_d©a
(
X509
 *
r
, 
idx
);

558 
i2d_X509_AUX
(
X509
 *
a
, **
µ
);

559 
X509
 *
d2i_X509_AUX
(X509 **
a
, c⁄° **
µ
, 
Àngth
);

561 
i2d_ª_X509_tbs
(
X509
 *
x
, **
µ
);

563 
X509_SIG_INFO_gë
(c⁄° 
X509_SIG_INFO
 *
sigöf
, *
mdnid
, *
pknid
,

564 *
£cbôs
, 
uöt32_t
 *
Êags
);

565 
X509_SIG_INFO_£t
(
X509_SIG_INFO
 *
sigöf
, 
mdnid
, 
pknid
,

566 
£cbôs
, 
uöt32_t
 
Êags
);

568 
X509_gë_sig«tuª_öfo
(
X509
 *
x
, *
mdnid
, *
pknid
, *
£cbôs
,

569 
uöt32_t
 *
Êags
);

571 
X509_gë0_sig«tuª
(c⁄° 
ASN1_BIT_STRING
 **
psig
,

572 c⁄° 
X509_ALGOR
 **
∑lg
, c⁄° 
X509
 *
x
);

573 
X509_gë_sig«tuª_nid
(c⁄° 
X509
 *
x
);

575 
X509_åu°ed
(c⁄° 
X509
 *
x
);

576 
X509_Æüs_£t1
(
X509
 *
x
, c⁄° *
«me
, 
Àn
);

577 
X509_keyid_£t1
(
X509
 *
x
, c⁄° *
id
, 
Àn
);

578 *
X509_Æüs_gë0
(
X509
 *
x
, *
Àn
);

579 *
X509_keyid_gë0
(
X509
 *
x
, *
Àn
);

580 (*
X509_TRUST_£t_deÁu…
((*
åu°
Ë(, 
X509
 *, ))) (, X509 *,

582 
X509_TRUST_£t
(*
t
, 
åu°
);

583 
X509_add1_åu°_obje˘
(
X509
 *
x
, c⁄° 
ASN1_OBJECT
 *
obj
);

584 
X509_add1_ªje˘_obje˘
(
X509
 *
x
, c⁄° 
ASN1_OBJECT
 *
obj
);

585 
X509_åu°_˛ór
(
X509
 *
x
);

586 
X509_ªje˘_˛ór
(
X509
 *
x
);

588 
STACK_OF
(
ASN1_OBJECT
Ë*
X509_gë0_åu°_obje˘s
(
X509
 *
x
);

589 
STACK_OF
(
ASN1_OBJECT
Ë*
X509_gë0_ªje˘_obje˘s
(
X509
 *
x
);

591 
DECLARE_ASN1_FUNCTIONS
(
X509_REVOKED
)

592 
DECLARE_ASN1_FUNCTIONS
(
X509_CRL_INFO
)

593 
DECLARE_ASN1_FUNCTIONS
(
X509_CRL
)

595 
X509_CRL_add0_ªvoked
(
X509_CRL
 *
¸l
, 
X509_REVOKED
 *
ªv
);

596 
X509_CRL_gë0_by_£rül
(
X509_CRL
 *
¸l
,

597 
X509_REVOKED
 **
ªt
, 
ASN1_INTEGER
 *
£rül
);

598 
X509_CRL_gë0_by_˚π
(
X509_CRL
 *
¸l
, 
X509_REVOKED
 **
ªt
, 
X509
 *
x
);

600 
X509_PKEY
 *
X509_PKEY_√w
();

601 
X509_PKEY_‰ì
(
X509_PKEY
 *
a
);

603 
DECLARE_ASN1_FUNCTIONS
(
NETSCAPE_SPKI
)

604 
DECLARE_ASN1_FUNCTIONS
(
NETSCAPE_SPKAC
)

605 
DECLARE_ASN1_FUNCTIONS
(
NETSCAPE_CERT_SEQUENCE
)

607 
X509_INFO
 *
X509_INFO_√w
();

608 
X509_INFO_‰ì
(
X509_INFO
 *
a
);

609 *
X509_NAME_⁄ñöe
(c⁄° 
X509_NAME
 *
a
, *
buf
, 
size
);

611 
ASN1_vîify
(
i2d_of_void
 *
i2d
, 
X509_ALGOR
 *
Æg‹1
,

612 
ASN1_BIT_STRING
 *
sig«tuª
, *
d©a
, 
EVP_PKEY
 *
pkey
);

614 
ASN1_dige°
(
i2d_of_void
 *
i2d
, c⁄° 
EVP_MD
 *
ty≥
, *
d©a
,

615 *
md
, *
Àn
);

617 
ASN1_sign
(
i2d_of_void
 *
i2d
, 
X509_ALGOR
 *
Æg‹1
,

618 
X509_ALGOR
 *
Æg‹2
, 
ASN1_BIT_STRING
 *
sig«tuª
,

619 *
d©a
, 
EVP_PKEY
 *
pkey
, c⁄° 
EVP_MD
 *
ty≥
);

621 
ASN1_ôem_dige°
(c⁄° 
ASN1_ITEM
 *
ô
, c⁄° 
EVP_MD
 *
ty≥
, *
d©a
,

622 *
md
, *
Àn
);

624 
ASN1_ôem_vîify
(c⁄° 
ASN1_ITEM
 *
ô
, 
X509_ALGOR
 *
Æg‹1
,

625 
ASN1_BIT_STRING
 *
sig«tuª
, *
d©a
, 
EVP_PKEY
 *
pkey
);

627 
ASN1_ôem_sign
(c⁄° 
ASN1_ITEM
 *
ô
, 
X509_ALGOR
 *
Æg‹1
,

628 
X509_ALGOR
 *
Æg‹2
, 
ASN1_BIT_STRING
 *
sig«tuª
, *
d©a
,

629 
EVP_PKEY
 *
pkey
, c⁄° 
EVP_MD
 *
ty≥
);

630 
ASN1_ôem_sign_˘x
(c⁄° 
ASN1_ITEM
 *
ô
, 
X509_ALGOR
 *
Æg‹1
,

631 
X509_ALGOR
 *
Æg‹2
, 
ASN1_BIT_STRING
 *
sig«tuª
,

632 *
a¢
, 
EVP_MD_CTX
 *
˘x
);

634 
X509_gë_vîsi⁄
(c⁄° 
X509
 *
x
);

635 
X509_£t_vîsi⁄
(
X509
 *
x
, 
vîsi⁄
);

636 
X509_£t_£rülNumbî
(
X509
 *
x
, 
ASN1_INTEGER
 *
£rül
);

637 
ASN1_INTEGER
 *
X509_gë_£rülNumbî
(
X509
 *
x
);

638 c⁄° 
ASN1_INTEGER
 *
X509_gë0_£rülNumbî
(c⁄° 
X509
 *
x
);

639 
X509_£t_issuî_«me
(
X509
 *
x
, 
X509_NAME
 *
«me
);

640 
X509_NAME
 *
X509_gë_issuî_«me
(c⁄° 
X509
 *
a
);

641 
X509_£t_subje˘_«me
(
X509
 *
x
, 
X509_NAME
 *
«me
);

642 
X509_NAME
 *
X509_gë_subje˘_«me
(c⁄° 
X509
 *
a
);

643 c⁄° 
ASN1_TIME
 * 
X509_gë0_nŸBef‹e
(c⁄° 
X509
 *
x
);

644 
ASN1_TIME
 *
X509_gëm_nŸBef‹e
(c⁄° 
X509
 *
x
);

645 
X509_£t1_nŸBef‹e
(
X509
 *
x
, c⁄° 
ASN1_TIME
 *
tm
);

646 c⁄° 
ASN1_TIME
 *
X509_gë0_nŸA·î
(c⁄° 
X509
 *
x
);

647 
ASN1_TIME
 *
X509_gëm_nŸA·î
(c⁄° 
X509
 *
x
);

648 
X509_£t1_nŸA·î
(
X509
 *
x
, c⁄° 
ASN1_TIME
 *
tm
);

649 
X509_£t_pubkey
(
X509
 *
x
, 
EVP_PKEY
 *
pkey
);

650 
X509_up_ªf
(
X509
 *
x
);

651 
X509_gë_sig«tuª_ty≥
(c⁄° 
X509
 *
x
);

653 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

654 
	#X509_gë_nŸBef‹e
 
X509_gëm_nŸBef‹e


	)

655 
	#X509_gë_nŸA·î
 
X509_gëm_nŸA·î


	)

656 
	#X509_£t_nŸBef‹e
 
X509_£t1_nŸBef‹e


	)

657 
	#X509_£t_nŸA·î
 
X509_£t1_nŸA·î


	)

665 
X509_PUBKEY
 *
X509_gë_X509_PUBKEY
(c⁄° 
X509
 *
x
);

666 c⁄° 
STACK_OF
(
X509_EXTENSION
Ë*
X509_gë0_exãnsi⁄s
(c⁄° 
X509
 *
x
);

667 
X509_gë0_uids
(c⁄° 
X509
 *
x
, c⁄° 
ASN1_BIT_STRING
 **
piuid
,

668 c⁄° 
ASN1_BIT_STRING
 **
psuid
);

669 c⁄° 
X509_ALGOR
 *
X509_gë0_tbs_sigÆg
(c⁄° 
X509
 *
x
);

671 
EVP_PKEY
 *
X509_gë0_pubkey
(c⁄° 
X509
 *
x
);

672 
EVP_PKEY
 *
X509_gë_pubkey
(
X509
 *
x
);

673 
ASN1_BIT_STRING
 *
X509_gë0_pubkey_bô°r
(c⁄° 
X509
 *
x
);

674 
X509_˚πifiˇã_ty≥
(c⁄° 
X509
 *
x
, c⁄° 
EVP_PKEY
 *
pubkey
);

676 
X509_REQ_gë_vîsi⁄
(c⁄° 
X509_REQ
 *
ªq
);

677 
X509_REQ_£t_vîsi⁄
(
X509_REQ
 *
x
, 
vîsi⁄
);

678 
X509_NAME
 *
X509_REQ_gë_subje˘_«me
(c⁄° 
X509_REQ
 *
ªq
);

679 
X509_REQ_£t_subje˘_«me
(
X509_REQ
 *
ªq
, 
X509_NAME
 *
«me
);

680 
X509_REQ_gë0_sig«tuª
(c⁄° 
X509_REQ
 *
ªq
, c⁄° 
ASN1_BIT_STRING
 **
psig
,

681 c⁄° 
X509_ALGOR
 **
∑lg
);

682 
X509_REQ_gë_sig«tuª_nid
(c⁄° 
X509_REQ
 *
ªq
);

683 
i2d_ª_X509_REQ_tbs
(
X509_REQ
 *
ªq
, **
µ
);

684 
X509_REQ_£t_pubkey
(
X509_REQ
 *
x
, 
EVP_PKEY
 *
pkey
);

685 
EVP_PKEY
 *
X509_REQ_gë_pubkey
(
X509_REQ
 *
ªq
);

686 
EVP_PKEY
 *
X509_REQ_gë0_pubkey
(
X509_REQ
 *
ªq
);

687 
X509_PUBKEY
 *
X509_REQ_gë_X509_PUBKEY
(
X509_REQ
 *
ªq
);

688 
X509_REQ_exãnsi⁄_nid
(
nid
);

689 *
X509_REQ_gë_exãnsi⁄_nids
();

690 
X509_REQ_£t_exãnsi⁄_nids
(*
nids
);

691 
STACK_OF
(
X509_EXTENSION
Ë*
X509_REQ_gë_exãnsi⁄s
(
X509_REQ
 *
ªq
);

692 
X509_REQ_add_exãnsi⁄s_nid
(
X509_REQ
 *
ªq
, 
STACK_OF
(
X509_EXTENSION
Ë*
exts
,

693 
nid
);

694 
X509_REQ_add_exãnsi⁄s
(
X509_REQ
 *
ªq
, 
STACK_OF
(
X509_EXTENSION
Ë*
exts
);

695 
X509_REQ_gë_©å_cou¡
(c⁄° 
X509_REQ
 *
ªq
);

696 
X509_REQ_gë_©å_by_NID
(c⁄° 
X509_REQ
 *
ªq
, 
nid
, 
œ°pos
);

697 
X509_REQ_gë_©å_by_OBJ
(c⁄° 
X509_REQ
 *
ªq
, c⁄° 
ASN1_OBJECT
 *
obj
,

698 
œ°pos
);

699 
X509_ATTRIBUTE
 *
X509_REQ_gë_©å
(c⁄° 
X509_REQ
 *
ªq
, 
loc
);

700 
X509_ATTRIBUTE
 *
X509_REQ_dñëe_©å
(
X509_REQ
 *
ªq
, 
loc
);

701 
X509_REQ_add1_©å
(
X509_REQ
 *
ªq
, 
X509_ATTRIBUTE
 *
©å
);

702 
X509_REQ_add1_©å_by_OBJ
(
X509_REQ
 *
ªq
,

703 c⁄° 
ASN1_OBJECT
 *
obj
, 
ty≥
,

704 c⁄° *
byãs
, 
Àn
);

705 
X509_REQ_add1_©å_by_NID
(
X509_REQ
 *
ªq
,

706 
nid
, 
ty≥
,

707 c⁄° *
byãs
, 
Àn
);

708 
X509_REQ_add1_©å_by_txt
(
X509_REQ
 *
ªq
,

709 c⁄° *
©å«me
, 
ty≥
,

710 c⁄° *
byãs
, 
Àn
);

712 
X509_CRL_£t_vîsi⁄
(
X509_CRL
 *
x
, 
vîsi⁄
);

713 
X509_CRL_£t_issuî_«me
(
X509_CRL
 *
x
, 
X509_NAME
 *
«me
);

714 
X509_CRL_£t1_œ°Upd©e
(
X509_CRL
 *
x
, c⁄° 
ASN1_TIME
 *
tm
);

715 
X509_CRL_£t1_√xtUpd©e
(
X509_CRL
 *
x
, c⁄° 
ASN1_TIME
 *
tm
);

716 
X509_CRL_s‹t
(
X509_CRL
 *
¸l
);

717 
X509_CRL_up_ªf
(
X509_CRL
 *
¸l
);

719 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

720 
	#X509_CRL_£t_œ°Upd©e
 
X509_CRL_£t1_œ°Upd©e


	)

721 
	#X509_CRL_£t_√xtUpd©e
 
X509_CRL_£t1_√xtUpd©e


	)

724 
X509_CRL_gë_vîsi⁄
(c⁄° 
X509_CRL
 *
¸l
);

725 c⁄° 
ASN1_TIME
 *
X509_CRL_gë0_œ°Upd©e
(c⁄° 
X509_CRL
 *
¸l
);

726 c⁄° 
ASN1_TIME
 *
X509_CRL_gë0_√xtUpd©e
(c⁄° 
X509_CRL
 *
¸l
);

727 
DEPRECATEDIN_1_1_0
(
ASN1_TIME
 *
X509_CRL_gë_œ°Upd©e
(
X509_CRL
 *
¸l
))

728 
DEPRECATEDIN_1_1_0
(
ASN1_TIME
 *
X509_CRL_gë_√xtUpd©e
(
X509_CRL
 *
¸l
))

729 
X509_NAME
 *
X509_CRL_gë_issuî
(c⁄° 
X509_CRL
 *
¸l
);

730 c⁄° 
STACK_OF
(
X509_EXTENSION
Ë*
X509_CRL_gë0_exãnsi⁄s
(c⁄° 
X509_CRL
 *
¸l
);

731 
STACK_OF
(
X509_REVOKED
Ë*
X509_CRL_gë_REVOKED
(
X509_CRL
 *
¸l
);

732 
X509_CRL_gë0_sig«tuª
(c⁄° 
X509_CRL
 *
¸l
, c⁄° 
ASN1_BIT_STRING
 **
psig
,

733 c⁄° 
X509_ALGOR
 **
∑lg
);

734 
X509_CRL_gë_sig«tuª_nid
(c⁄° 
X509_CRL
 *
¸l
);

735 
i2d_ª_X509_CRL_tbs
(
X509_CRL
 *
ªq
, **
µ
);

737 c⁄° 
ASN1_INTEGER
 *
X509_REVOKED_gë0_£rülNumbî
(c⁄° 
X509_REVOKED
 *
x
);

738 
X509_REVOKED_£t_£rülNumbî
(
X509_REVOKED
 *
x
, 
ASN1_INTEGER
 *
£rül
);

739 c⁄° 
ASN1_TIME
 *
X509_REVOKED_gë0_ªvoˇti⁄D©e
(c⁄° 
X509_REVOKED
 *
x
);

740 
X509_REVOKED_£t_ªvoˇti⁄D©e
(
X509_REVOKED
 *
r
, 
ASN1_TIME
 *
tm
);

741 c⁄° 
STACK_OF
(
X509_EXTENSION
) *

742 
X509_REVOKED_gë0_exãnsi⁄s
(c⁄° 
X509_REVOKED
 *
r
);

744 
X509_CRL
 *
X509_CRL_diff
(X509_CRL *
ba£
, X509_CRL *
√wî
,

745 
EVP_PKEY
 *
skey
, c⁄° 
EVP_MD
 *
md
, 
Êags
);

747 
X509_REQ_check_¥iv©e_key
(
X509_REQ
 *
x509
, 
EVP_PKEY
 *
pkey
);

749 
X509_check_¥iv©e_key
(c⁄° 
X509
 *
x509
, c⁄° 
EVP_PKEY
 *
pkey
);

750 
X509_chaö_check_suôeb
(*
≥º‹_dïth
,

751 
X509
 *
x
, 
STACK_OF
(X509Ë*
chaö
,

752 
Êags
);

753 
X509_CRL_check_suôeb
(
X509_CRL
 *
¸l
, 
EVP_PKEY
 *
pk
, 
Êags
);

754 
STACK_OF
(
X509
Ë*
X509_chaö_up_ªf
(STACK_OF(X509Ë*
chaö
);

756 
X509_issuî_™d_£rül_cmp
(c⁄° 
X509
 *
a
, c⁄° X509 *
b
);

757 
X509_issuî_™d_£rül_hash
(
X509
 *
a
);

759 
X509_issuî_«me_cmp
(c⁄° 
X509
 *
a
, c⁄° X509 *
b
);

760 
X509_issuî_«me_hash
(
X509
 *
a
);

762 
X509_subje˘_«me_cmp
(c⁄° 
X509
 *
a
, c⁄° X509 *
b
);

763 
X509_subje˘_«me_hash
(
X509
 *
x
);

765 #i‚de‡
OPENSSL_NO_MD5


766 
X509_issuî_«me_hash_ﬁd
(
X509
 *
a
);

767 
X509_subje˘_«me_hash_ﬁd
(
X509
 *
x
);

770 
X509_cmp
(c⁄° 
X509
 *
a
, c⁄° X509 *
b
);

771 
X509_NAME_cmp
(c⁄° 
X509_NAME
 *
a
, c⁄° X509_NAME *
b
);

772 
X509_NAME_hash
(
X509_NAME
 *
x
);

773 
X509_NAME_hash_ﬁd
(
X509_NAME
 *
x
);

775 
X509_CRL_cmp
(c⁄° 
X509_CRL
 *
a
, c⁄° X509_CRL *
b
);

776 
X509_CRL_m©ch
(c⁄° 
X509_CRL
 *
a
, c⁄° X509_CRL *
b
);

777 
X509_aux_¥öt
(
BIO
 *
out
, 
X509
 *
x
, 
ödít
);

778 #i‚de‡
OPENSSL_NO_STDIO


779 
X509_¥öt_ex_Â
(
FILE
 *
bp
, 
X509
 *
x
, 
nmÊag
,

780 
cÊag
);

781 
X509_¥öt_Â
(
FILE
 *
bp
, 
X509
 *
x
);

782 
X509_CRL_¥öt_Â
(
FILE
 *
bp
, 
X509_CRL
 *
x
);

783 
X509_REQ_¥öt_Â
(
FILE
 *
bp
, 
X509_REQ
 *
ªq
);

784 
X509_NAME_¥öt_ex_Â
(
FILE
 *
Â
, c⁄° 
X509_NAME
 *
nm
, 
ödít
,

785 
Êags
);

788 
X509_NAME_¥öt
(
BIO
 *
bp
, c⁄° 
X509_NAME
 *
«me
, 
oba£
);

789 
X509_NAME_¥öt_ex
(
BIO
 *
out
, c⁄° 
X509_NAME
 *
nm
, 
ödít
,

790 
Êags
);

791 
X509_¥öt_ex
(
BIO
 *
bp
, 
X509
 *
x
, 
nmÊag
,

792 
cÊag
);

793 
X509_¥öt
(
BIO
 *
bp
, 
X509
 *
x
);

794 
X509_oc•id_¥öt
(
BIO
 *
bp
, 
X509
 *
x
);

795 
X509_CRL_¥öt_ex
(
BIO
 *
out
, 
X509_CRL
 *
x
, 
nmÊag
);

796 
X509_CRL_¥öt
(
BIO
 *
bp
, 
X509_CRL
 *
x
);

797 
X509_REQ_¥öt_ex
(
BIO
 *
bp
, 
X509_REQ
 *
x
, 
nmÊag
,

798 
cÊag
);

799 
X509_REQ_¥öt
(
BIO
 *
bp
, 
X509_REQ
 *
ªq
);

801 
X509_NAME_íåy_cou¡
(c⁄° 
X509_NAME
 *
«me
);

802 
X509_NAME_gë_ãxt_by_NID
(
X509_NAME
 *
«me
, 
nid
, *
buf
, 
Àn
);

803 
X509_NAME_gë_ãxt_by_OBJ
(
X509_NAME
 *
«me
, c⁄° 
ASN1_OBJECT
 *
obj
,

804 *
buf
, 
Àn
);

810 
X509_NAME_gë_ödex_by_NID
(
X509_NAME
 *
«me
, 
nid
, 
œ°pos
);

811 
X509_NAME_gë_ödex_by_OBJ
(
X509_NAME
 *
«me
, c⁄° 
ASN1_OBJECT
 *
obj
,

812 
œ°pos
);

813 
X509_NAME_ENTRY
 *
X509_NAME_gë_íåy
(c⁄° 
X509_NAME
 *
«me
, 
loc
);

814 
X509_NAME_ENTRY
 *
X509_NAME_dñëe_íåy
(
X509_NAME
 *
«me
, 
loc
);

815 
X509_NAME_add_íåy
(
X509_NAME
 *
«me
, c⁄° 
X509_NAME_ENTRY
 *
√
,

816 
loc
, 
£t
);

817 
X509_NAME_add_íåy_by_OBJ
(
X509_NAME
 *
«me
, c⁄° 
ASN1_OBJECT
 *
obj
, 
ty≥
,

818 c⁄° *
byãs
, 
Àn
, 
loc
,

819 
£t
);

820 
X509_NAME_add_íåy_by_NID
(
X509_NAME
 *
«me
, 
nid
, 
ty≥
,

821 c⁄° *
byãs
, 
Àn
, 
loc
,

822 
£t
);

823 
X509_NAME_ENTRY
 *
X509_NAME_ENTRY_¸óã_by_txt
(X509_NAME_ENTRY **
√
,

824 c⁄° *
fõld
, 
ty≥
,

825 c⁄° *
byãs
,

826 
Àn
);

827 
X509_NAME_ENTRY
 *
X509_NAME_ENTRY_¸óã_by_NID
(X509_NAME_ENTRY **
√
, 
nid
,

828 
ty≥
,

829 c⁄° *
byãs
,

830 
Àn
);

831 
X509_NAME_add_íåy_by_txt
(
X509_NAME
 *
«me
, c⁄° *
fõld
, 
ty≥
,

832 c⁄° *
byãs
, 
Àn
, 
loc
,

833 
£t
);

834 
X509_NAME_ENTRY
 *
X509_NAME_ENTRY_¸óã_by_OBJ
(X509_NAME_ENTRY **
√
,

835 c⁄° 
ASN1_OBJECT
 *
obj
, 
ty≥
,

836 c⁄° *
byãs
,

837 
Àn
);

838 
X509_NAME_ENTRY_£t_obje˘
(
X509_NAME_ENTRY
 *
√
, c⁄° 
ASN1_OBJECT
 *
obj
);

839 
X509_NAME_ENTRY_£t_d©a
(
X509_NAME_ENTRY
 *
√
, 
ty≥
,

840 c⁄° *
byãs
, 
Àn
);

841 
ASN1_OBJECT
 *
X509_NAME_ENTRY_gë_obje˘
(c⁄° 
X509_NAME_ENTRY
 *
√
);

842 
ASN1_STRING
 * 
X509_NAME_ENTRY_gë_d©a
(c⁄° 
X509_NAME_ENTRY
 *
√
);

843 
X509_NAME_ENTRY_£t
(c⁄° 
X509_NAME_ENTRY
 *
√
);

845 
X509_NAME_gë0_dî
(
X509_NAME
 *
nm
, c⁄° **
pdî
,

846 
size_t
 *
pdîÀn
);

848 
X509v3_gë_ext_cou¡
(c⁄° 
STACK_OF
(
X509_EXTENSION
Ë*
x
);

849 
X509v3_gë_ext_by_NID
(c⁄° 
STACK_OF
(
X509_EXTENSION
Ë*
x
,

850 
nid
, 
œ°pos
);

851 
X509v3_gë_ext_by_OBJ
(c⁄° 
STACK_OF
(
X509_EXTENSION
Ë*
x
,

852 c⁄° 
ASN1_OBJECT
 *
obj
, 
œ°pos
);

853 
X509v3_gë_ext_by_¸ôiˇl
(c⁄° 
STACK_OF
(
X509_EXTENSION
Ë*
x
,

854 
¸ô
, 
œ°pos
);

855 
X509_EXTENSION
 *
X509v3_gë_ext
(c⁄° 
STACK_OF
(X509_EXTENSIONË*
x
, 
loc
);

856 
X509_EXTENSION
 *
X509v3_dñëe_ext
(
STACK_OF
(X509_EXTENSIONË*
x
, 
loc
);

857 
STACK_OF
(
X509_EXTENSION
Ë*
X509v3_add_ext
(STACK_OF(X509_EXTENSIONË**
x
,

858 
X509_EXTENSION
 *
ex
, 
loc
);

860 
X509_gë_ext_cou¡
(c⁄° 
X509
 *
x
);

861 
X509_gë_ext_by_NID
(c⁄° 
X509
 *
x
, 
nid
, 
œ°pos
);

862 
X509_gë_ext_by_OBJ
(c⁄° 
X509
 *
x
, c⁄° 
ASN1_OBJECT
 *
obj
, 
œ°pos
);

863 
X509_gë_ext_by_¸ôiˇl
(c⁄° 
X509
 *
x
, 
¸ô
, 
œ°pos
);

864 
X509_EXTENSION
 *
X509_gë_ext
(c⁄° 
X509
 *
x
, 
loc
);

865 
X509_EXTENSION
 *
X509_dñëe_ext
(
X509
 *
x
, 
loc
);

866 
X509_add_ext
(
X509
 *
x
, 
X509_EXTENSION
 *
ex
, 
loc
);

867 *
X509_gë_ext_d2i
(c⁄° 
X509
 *
x
, 
nid
, *
¸ô
, *
idx
);

868 
X509_add1_ext_i2d
(
X509
 *
x
, 
nid
, *
vÆue
, 
¸ô
,

869 
Êags
);

871 
X509_CRL_gë_ext_cou¡
(c⁄° 
X509_CRL
 *
x
);

872 
X509_CRL_gë_ext_by_NID
(c⁄° 
X509_CRL
 *
x
, 
nid
, 
œ°pos
);

873 
X509_CRL_gë_ext_by_OBJ
(c⁄° 
X509_CRL
 *
x
, c⁄° 
ASN1_OBJECT
 *
obj
,

874 
œ°pos
);

875 
X509_CRL_gë_ext_by_¸ôiˇl
(c⁄° 
X509_CRL
 *
x
, 
¸ô
, 
œ°pos
);

876 
X509_EXTENSION
 *
X509_CRL_gë_ext
(c⁄° 
X509_CRL
 *
x
, 
loc
);

877 
X509_EXTENSION
 *
X509_CRL_dñëe_ext
(
X509_CRL
 *
x
, 
loc
);

878 
X509_CRL_add_ext
(
X509_CRL
 *
x
, 
X509_EXTENSION
 *
ex
, 
loc
);

879 *
X509_CRL_gë_ext_d2i
(c⁄° 
X509_CRL
 *
x
, 
nid
, *
¸ô
, *
idx
);

880 
X509_CRL_add1_ext_i2d
(
X509_CRL
 *
x
, 
nid
, *
vÆue
, 
¸ô
,

881 
Êags
);

883 
X509_REVOKED_gë_ext_cou¡
(c⁄° 
X509_REVOKED
 *
x
);

884 
X509_REVOKED_gë_ext_by_NID
(c⁄° 
X509_REVOKED
 *
x
, 
nid
, 
œ°pos
);

885 
X509_REVOKED_gë_ext_by_OBJ
(c⁄° 
X509_REVOKED
 *
x
, c⁄° 
ASN1_OBJECT
 *
obj
,

886 
œ°pos
);

887 
X509_REVOKED_gë_ext_by_¸ôiˇl
(c⁄° 
X509_REVOKED
 *
x
, 
¸ô
,

888 
œ°pos
);

889 
X509_EXTENSION
 *
X509_REVOKED_gë_ext
(c⁄° 
X509_REVOKED
 *
x
, 
loc
);

890 
X509_EXTENSION
 *
X509_REVOKED_dñëe_ext
(
X509_REVOKED
 *
x
, 
loc
);

891 
X509_REVOKED_add_ext
(
X509_REVOKED
 *
x
, 
X509_EXTENSION
 *
ex
, 
loc
);

892 *
X509_REVOKED_gë_ext_d2i
(c⁄° 
X509_REVOKED
 *
x
, 
nid
, *
¸ô
,

893 *
idx
);

894 
X509_REVOKED_add1_ext_i2d
(
X509_REVOKED
 *
x
, 
nid
, *
vÆue
, 
¸ô
,

895 
Êags
);

897 
X509_EXTENSION
 *
X509_EXTENSION_¸óã_by_NID
(X509_EXTENSION **
ex
,

898 
nid
, 
¸ô
,

899 
ASN1_OCTET_STRING
 *
d©a
);

900 
X509_EXTENSION
 *
X509_EXTENSION_¸óã_by_OBJ
(X509_EXTENSION **
ex
,

901 c⁄° 
ASN1_OBJECT
 *
obj
, 
¸ô
,

902 
ASN1_OCTET_STRING
 *
d©a
);

903 
X509_EXTENSION_£t_obje˘
(
X509_EXTENSION
 *
ex
, c⁄° 
ASN1_OBJECT
 *
obj
);

904 
X509_EXTENSION_£t_¸ôiˇl
(
X509_EXTENSION
 *
ex
, 
¸ô
);

905 
X509_EXTENSION_£t_d©a
(
X509_EXTENSION
 *
ex
, 
ASN1_OCTET_STRING
 *
d©a
);

906 
ASN1_OBJECT
 *
X509_EXTENSION_gë_obje˘
(
X509_EXTENSION
 *
ex
);

907 
ASN1_OCTET_STRING
 *
X509_EXTENSION_gë_d©a
(
X509_EXTENSION
 *
√
);

908 
X509_EXTENSION_gë_¸ôiˇl
(c⁄° 
X509_EXTENSION
 *
ex
);

910 
X509©_gë_©å_cou¡
(c⁄° 
STACK_OF
(
X509_ATTRIBUTE
Ë*
x
);

911 
X509©_gë_©å_by_NID
(c⁄° 
STACK_OF
(
X509_ATTRIBUTE
Ë*
x
, 
nid
,

912 
œ°pos
);

913 
X509©_gë_©å_by_OBJ
(c⁄° 
STACK_OF
(
X509_ATTRIBUTE
Ë*
sk
,

914 c⁄° 
ASN1_OBJECT
 *
obj
, 
œ°pos
);

915 
X509_ATTRIBUTE
 *
X509©_gë_©å
(c⁄° 
STACK_OF
(X509_ATTRIBUTEË*
x
, 
loc
);

916 
X509_ATTRIBUTE
 *
X509©_dñëe_©å
(
STACK_OF
(X509_ATTRIBUTEË*
x
, 
loc
);

917 
STACK_OF
(
X509_ATTRIBUTE
Ë*
X509©_add1_©å
(STACK_OF(X509_ATTRIBUTEË**
x
,

918 
X509_ATTRIBUTE
 *
©å
);

919 
STACK_OF
(
X509_ATTRIBUTE
Ë*
X509©_add1_©å_by_OBJ
(STACK_OF(X509_ATTRIBUTE)

920 **
x
, c⁄° 
ASN1_OBJECT
 *
obj
,

921 
ty≥
,

922 c⁄° *
byãs
,

923 
Àn
);

924 
STACK_OF
(
X509_ATTRIBUTE
Ë*
X509©_add1_©å_by_NID
(STACK_OF(X509_ATTRIBUTE)

925 **
x
, 
nid
, 
ty≥
,

926 c⁄° *
byãs
,

927 
Àn
);

928 
STACK_OF
(
X509_ATTRIBUTE
Ë*
X509©_add1_©å_by_txt
(STACK_OF(X509_ATTRIBUTE)

929 **
x
, c⁄° *
©å«me
,

930 
ty≥
,

931 c⁄° *
byãs
,

932 
Àn
);

933 *
X509©_gë0_d©a_by_OBJ
(
STACK_OF
(
X509_ATTRIBUTE
Ë*
x
,

934 c⁄° 
ASN1_OBJECT
 *
obj
, 
œ°pos
, 
ty≥
);

935 
X509_ATTRIBUTE
 *
X509_ATTRIBUTE_¸óã_by_NID
(X509_ATTRIBUTE **
©å
, 
nid
,

936 
©πy≥
, c⁄° *
d©a
,

937 
Àn
);

938 
X509_ATTRIBUTE
 *
X509_ATTRIBUTE_¸óã_by_OBJ
(X509_ATTRIBUTE **
©å
,

939 c⁄° 
ASN1_OBJECT
 *
obj
,

940 
©πy≥
, c⁄° *
d©a
,

941 
Àn
);

942 
X509_ATTRIBUTE
 *
X509_ATTRIBUTE_¸óã_by_txt
(X509_ATTRIBUTE **
©å
,

943 c⁄° *
©∫ame
, 
ty≥
,

944 c⁄° *
byãs
,

945 
Àn
);

946 
X509_ATTRIBUTE_£t1_obje˘
(
X509_ATTRIBUTE
 *
©å
, c⁄° 
ASN1_OBJECT
 *
obj
);

947 
X509_ATTRIBUTE_£t1_d©a
(
X509_ATTRIBUTE
 *
©å
, 
©åty≥
,

948 c⁄° *
d©a
, 
Àn
);

949 *
X509_ATTRIBUTE_gë0_d©a
(
X509_ATTRIBUTE
 *
©å
, 
idx
, 
©πy≥
,

950 *
d©a
);

951 
X509_ATTRIBUTE_cou¡
(c⁄° 
X509_ATTRIBUTE
 *
©å
);

952 
ASN1_OBJECT
 *
X509_ATTRIBUTE_gë0_obje˘
(
X509_ATTRIBUTE
 *
©å
);

953 
ASN1_TYPE
 *
X509_ATTRIBUTE_gë0_ty≥
(
X509_ATTRIBUTE
 *
©å
, 
idx
);

955 
EVP_PKEY_gë_©å_cou¡
(c⁄° 
EVP_PKEY
 *
key
);

956 
EVP_PKEY_gë_©å_by_NID
(c⁄° 
EVP_PKEY
 *
key
, 
nid
, 
œ°pos
);

957 
EVP_PKEY_gë_©å_by_OBJ
(c⁄° 
EVP_PKEY
 *
key
, c⁄° 
ASN1_OBJECT
 *
obj
,

958 
œ°pos
);

959 
X509_ATTRIBUTE
 *
EVP_PKEY_gë_©å
(c⁄° 
EVP_PKEY
 *
key
, 
loc
);

960 
X509_ATTRIBUTE
 *
EVP_PKEY_dñëe_©å
(
EVP_PKEY
 *
key
, 
loc
);

961 
EVP_PKEY_add1_©å
(
EVP_PKEY
 *
key
, 
X509_ATTRIBUTE
 *
©å
);

962 
EVP_PKEY_add1_©å_by_OBJ
(
EVP_PKEY
 *
key
,

963 c⁄° 
ASN1_OBJECT
 *
obj
, 
ty≥
,

964 c⁄° *
byãs
, 
Àn
);

965 
EVP_PKEY_add1_©å_by_NID
(
EVP_PKEY
 *
key
,

966 
nid
, 
ty≥
,

967 c⁄° *
byãs
, 
Àn
);

968 
EVP_PKEY_add1_©å_by_txt
(
EVP_PKEY
 *
key
,

969 c⁄° *
©å«me
, 
ty≥
,

970 c⁄° *
byãs
, 
Àn
);

972 
X509_vîify_˚π
(
X509_STORE_CTX
 *
˘x
);

975 
X509
 *
X509_föd_by_issuî_™d_£rül
(
STACK_OF
(X509Ë*
sk
, 
X509_NAME
 *
«me
,

976 
ASN1_INTEGER
 *
£rül
);

977 
X509
 *
X509_föd_by_subje˘
(
STACK_OF
(X509Ë*
sk
, 
X509_NAME
 *
«me
);

979 
DECLARE_ASN1_FUNCTIONS
(
PBEPARAM
)

980 
DECLARE_ASN1_FUNCTIONS
(
PBE2PARAM
)

981 
DECLARE_ASN1_FUNCTIONS
(
PBKDF2PARAM
)

982 #i‚de‡
OPENSSL_NO_SCRYPT


983 
DECLARE_ASN1_FUNCTIONS
(
SCRYPT_PARAMS
)

986 
PKCS5_pbe_£t0_Æg‹
(
X509_ALGOR
 *
Æg‹
, 
Æg
, 
ôî
,

987 c⁄° *
ß…
, 
ß…Àn
);

989 
X509_ALGOR
 *
PKCS5_pbe_£t
(
Æg
, 
ôî
,

990 c⁄° *
ß…
, 
ß…Àn
);

991 
X509_ALGOR
 *
PKCS5_pbe2_£t
(c⁄° 
EVP_CIPHER
 *
cùhî
, 
ôî
,

992 *
ß…
, 
ß…Àn
);

993 
X509_ALGOR
 *
PKCS5_pbe2_£t_iv
(c⁄° 
EVP_CIPHER
 *
cùhî
, 
ôî
,

994 *
ß…
, 
ß…Àn
,

995 *
aiv
, 
¥f_nid
);

997 #i‚de‡
OPENSSL_NO_SCRYPT


998 
X509_ALGOR
 *
PKCS5_pbe2_£t_s¸y±
(c⁄° 
EVP_CIPHER
 *
cùhî
,

999 c⁄° *
ß…
, 
ß…Àn
,

1000 *
aiv
, 
uöt64_t
 
N
, uöt64_à
r
,

1001 
uöt64_t
 
p
);

1004 
X509_ALGOR
 *
PKCS5_pbkdf2_£t
(
ôî
, *
ß…
, 
ß…Àn
,

1005 
¥f_nid
, 
keyÀn
);

1009 
DECLARE_ASN1_FUNCTIONS
(
PKCS8_PRIV_KEY_INFO
)

1011 
EVP_PKEY
 *
EVP_PKCS82PKEY
(c⁄° 
PKCS8_PRIV_KEY_INFO
 *
p8
);

1012 
PKCS8_PRIV_KEY_INFO
 *
EVP_PKEY2PKCS8
(
EVP_PKEY
 *
pkey
);

1014 
PKCS8_pkey_£t0
(
PKCS8_PRIV_KEY_INFO
 *
¥iv
, 
ASN1_OBJECT
 *
aobj
,

1015 
vîsi⁄
, 
±y≥
, *
pvÆ
,

1016 *
≥nc
, 
≥n˛í
);

1017 
PKCS8_pkey_gë0
(c⁄° 
ASN1_OBJECT
 **
µkÆg
,

1018 c⁄° **
pk
, *
µkÀn
,

1019 c⁄° 
X509_ALGOR
 **
∑
, c⁄° 
PKCS8_PRIV_KEY_INFO
 *
p8
);

1021 c⁄° 
STACK_OF
(
X509_ATTRIBUTE
) *

1022 
PKCS8_pkey_gë0_©ås
(c⁄° 
PKCS8_PRIV_KEY_INFO
 *
p8
);

1023 
PKCS8_pkey_add1_©å_by_NID
(
PKCS8_PRIV_KEY_INFO
 *
p8
, 
nid
, 
ty≥
,

1024 c⁄° *
byãs
, 
Àn
);

1026 
X509_PUBKEY_£t0_∑øm
(
X509_PUBKEY
 *
pub
, 
ASN1_OBJECT
 *
aobj
,

1027 
±y≥
, *
pvÆ
,

1028 *
≥nc
, 
≥n˛í
);

1029 
X509_PUBKEY_gë0_∑øm
(
ASN1_OBJECT
 **
µkÆg
,

1030 c⁄° **
pk
, *
µkÀn
,

1031 
X509_ALGOR
 **
∑
, 
X509_PUBKEY
 *
pub
);

1033 
X509_check_åu°
(
X509
 *
x
, 
id
, 
Êags
);

1034 
X509_TRUST_gë_cou¡
();

1035 
X509_TRUST
 *
X509_TRUST_gë0
(
idx
);

1036 
X509_TRUST_gë_by_id
(
id
);

1037 
X509_TRUST_add
(
id
, 
Êags
, (*
ck
Ë(
X509_TRUST
 *, 
X509
 *, ),

1038 c⁄° *
«me
, 
¨g1
, *
¨g2
);

1039 
X509_TRUST_˛ónup
();

1040 
X509_TRUST_gë_Êags
(c⁄° 
X509_TRUST
 *
xp
);

1041 *
X509_TRUST_gë0_«me
(c⁄° 
X509_TRUST
 *
xp
);

1042 
X509_TRUST_gë_åu°
(c⁄° 
X509_TRUST
 *
xp
);

1044 #ifde‡ 
__˝lu•lus


	@/usr/include/rpc/netdb.h

36 #i‚de‡
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<„©uªs.h
>

41 
	#__√ed_size_t


	)

42 
	~<°ddef.h
>

44 
__BEGIN_DECLS


46 
	sΩ˚¡


48 *
	mr_«me
;

49 **
	mr_Æü£s
;

50 
	mr_numbî
;

53 
	$£åp˚¡
 (
__°ay›í
Ë
__THROW
;

54 
	$ídΩ˚¡
 (Ë
__THROW
;

55 
Ω˚¡
 *
	$gëΩcby«me
 (c⁄° *
__«me
Ë
__THROW
;

56 
Ω˚¡
 *
	$gëΩcbynumbî
 (
__numbî
Ë
__THROW
;

57 
Ω˚¡
 *
	$gëΩ˚¡
 (Ë
__THROW
;

59 #ifde‡
__USE_MISC


60 
	$gëΩcby«me_r
 (c⁄° *
__«me
, 
Ω˚¡
 *
__ªsu…_buf
,

61 *
__buf„r
, 
size_t
 
__buÊí
,

62 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

64 
	$gëΩcbynumbî_r
 (
__numbî
, 
Ω˚¡
 *
__ªsu…_buf
,

65 *
__buf„r
, 
size_t
 
__buÊí
,

66 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

68 
	$gëΩ˚¡_r
 (
Ω˚¡
 *
__ªsu…_buf
, *
__buf„r
,

69 
size_t
 
__buÊí
, 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

72 
__END_DECLS


	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

	@/usr/include/strings.h

18 #i‚def 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

21 
	~<„©uªs.h
>

22 
	#__√ed_size_t


	)

23 
	~<°ddef.h
>

26 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

27 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

30 
	g__BEGIN_DECLS


32 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


34 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

38 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

39 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

42 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

45 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


48 *
	`ödex
 (*
__s
, 
__c
)

49 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

50 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

51 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

53 #i‡
deföed
 
__OPTIMIZE__


54 
__exã∫_Æways_ölöe
 *

55 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


57  
	`__buûtö_ödex
 (
__s
, 
__c
);

60 
__exã∫_Æways_ölöe
 const *

61 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


63  
	`__buûtö_ödex
 (
__s
, 
__c
);

66 
	}
}

68 *
	$ödex
 (c⁄° *
__s
, 
__c
)

69 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

73 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


76 *
	`rödex
 (*
__s
, 
__c
)

77 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

78 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

79 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

81 #i‡
deföed
 
__OPTIMIZE__


82 
__exã∫_Æways_ölöe
 *

83 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


85  
	`__buûtö_rödex
 (
__s
, 
__c
);

88 
__exã∫_Æways_ölöe
 const *

89 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


91  
	`__buûtö_rödex
 (
__s
, 
__c
);

94 
	}
}

96 *
	$rödex
 (c⁄° *
__s
, 
__c
)

97 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

101 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8
 || deföed 
__USE_XOPEN2K8XSI


104 
	$ffs
 (
__i
Ë
__THROW
 
__©åibuã_c⁄°__
;

109 #ifdef 
__USE_MISC


110 
	$ff¶
 (
__l
Ë
__THROW
 
__©åibuã_c⁄°__
;

111 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

112 
__THROW
 
__©åibuã_c⁄°__
;

116 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

117 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

120 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

123 #ifdef 
__USE_XOPEN2K8


125 
	~<bôs/ty≥s/loˇÀ_t.h
>

128 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
loˇÀ_t
 
__loc
)

129 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

133 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

134 
size_t
 
__n
, 
loˇÀ_t
 
__loc
)

135 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

138 
__END_DECLS


140 #i‡
	`__GNUC_PREREQ
 (3,4Ë&& 
__USE_FORTIFY_LEVEL
 > 0 \

141 && 
deföed
 
__f‹tify_fun˘i⁄


143 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


144 
	~<bôs/°rögs_f‹tifõd.h
>

	@/usr/include/openssl/asn1.h

10 #i‚de‡
HEADER_ASN1_H


11 
	#HEADER_ASN1_H


	)

13 
	~<time.h
>

14 
	~<›ís¶/e_os2.h
>

15 
	~<›ís¶/›ís¶c⁄f.h
>

16 
	~<›ís¶/bio.h
>

17 
	~<›ís¶/ß„°ack.h
>

18 
	~<›ís¶/a¢1îr.h
>

19 
	~<›ís¶/symhacks.h
>

21 
	~<›ís¶/os¶_typ.h
>

22 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

23 
	~<›ís¶/bn.h
>

26 #ifde‡
OPENSSL_BUILD_SHLIBCRYPTO


27 #unde‡
OPENSSL_EXTERN


28 
	#OPENSSL_EXTERN
 
OPENSSL_EXPORT


	)

31 #ifde‡ 
__˝lu•lus


35 
	#V_ASN1_UNIVERSAL
 0x00

	)

36 
	#V_ASN1_APPLICATION
 0x40

	)

37 
	#V_ASN1_CONTEXT_SPECIFIC
 0x80

	)

38 
	#V_ASN1_PRIVATE
 0xc0

	)

40 
	#V_ASN1_CONSTRUCTED
 0x20

	)

41 
	#V_ASN1_PRIMITIVE_TAG
 0x1f

	)

42 
	#V_ASN1_PRIMATIVE_TAG
 
V_ASN1_PRIMITIVE_TAG


	)

44 
	#V_ASN1_APP_CHOOSE
 -2

	)

45 
	#V_ASN1_OTHER
 -3

	)

46 
	#V_ASN1_ANY
 -4

	)

48 
	#V_ASN1_UNDEF
 -1

	)

50 
	#V_ASN1_EOC
 0

	)

51 
	#V_ASN1_BOOLEAN
 1

	)

52 
	#V_ASN1_INTEGER
 2

	)

53 
	#V_ASN1_BIT_STRING
 3

	)

54 
	#V_ASN1_OCTET_STRING
 4

	)

55 
	#V_ASN1_NULL
 5

	)

56 
	#V_ASN1_OBJECT
 6

	)

57 
	#V_ASN1_OBJECT_DESCRIPTOR
 7

	)

58 
	#V_ASN1_EXTERNAL
 8

	)

59 
	#V_ASN1_REAL
 9

	)

60 
	#V_ASN1_ENUMERATED
 10

	)

61 
	#V_ASN1_UTF8STRING
 12

	)

62 
	#V_ASN1_SEQUENCE
 16

	)

63 
	#V_ASN1_SET
 17

	)

64 
	#V_ASN1_NUMERICSTRING
 18

	)

65 
	#V_ASN1_PRINTABLESTRING
 19

	)

66 
	#V_ASN1_T61STRING
 20

	)

67 
	#V_ASN1_TELETEXSTRING
 20

	)

68 
	#V_ASN1_VIDEOTEXSTRING
 21

	)

69 
	#V_ASN1_IA5STRING
 22

	)

70 
	#V_ASN1_UTCTIME
 23

	)

71 
	#V_ASN1_GENERALIZEDTIME
 24

	)

72 
	#V_ASN1_GRAPHICSTRING
 25

	)

73 
	#V_ASN1_ISO64STRING
 26

	)

74 
	#V_ASN1_VISIBLESTRING
 26

	)

75 
	#V_ASN1_GENERALSTRING
 27

	)

76 
	#V_ASN1_UNIVERSALSTRING
 28

	)

77 
	#V_ASN1_BMPSTRING
 30

	)

85 
	#V_ASN1_NEG
 0x100

	)

86 
	#V_ASN1_NEG_INTEGER
 (2 | 
V_ASN1_NEG
)

	)

87 
	#V_ASN1_NEG_ENUMERATED
 (10 | 
V_ASN1_NEG
)

	)

90 
	#B_ASN1_NUMERICSTRING
 0x0001

	)

91 
	#B_ASN1_PRINTABLESTRING
 0x0002

	)

92 
	#B_ASN1_T61STRING
 0x0004

	)

93 
	#B_ASN1_TELETEXSTRING
 0x0004

	)

94 
	#B_ASN1_VIDEOTEXSTRING
 0x0008

	)

95 
	#B_ASN1_IA5STRING
 0x0010

	)

96 
	#B_ASN1_GRAPHICSTRING
 0x0020

	)

97 
	#B_ASN1_ISO64STRING
 0x0040

	)

98 
	#B_ASN1_VISIBLESTRING
 0x0040

	)

99 
	#B_ASN1_GENERALSTRING
 0x0080

	)

100 
	#B_ASN1_UNIVERSALSTRING
 0x0100

	)

101 
	#B_ASN1_OCTET_STRING
 0x0200

	)

102 
	#B_ASN1_BIT_STRING
 0x0400

	)

103 
	#B_ASN1_BMPSTRING
 0x0800

	)

104 
	#B_ASN1_UNKNOWN
 0x1000

	)

105 
	#B_ASN1_UTF8STRING
 0x2000

	)

106 
	#B_ASN1_UTCTIME
 0x4000

	)

107 
	#B_ASN1_GENERALIZEDTIME
 0x8000

	)

108 
	#B_ASN1_SEQUENCE
 0x10000

	)

110 
	#MBSTRING_FLAG
 0x1000

	)

111 
	#MBSTRING_UTF8
 (
MBSTRING_FLAG
)

	)

112 
	#MBSTRING_ASC
 (
MBSTRING_FLAG
|1)

	)

113 
	#MBSTRING_BMP
 (
MBSTRING_FLAG
|2)

	)

114 
	#MBSTRING_UNIV
 (
MBSTRING_FLAG
|4)

	)

115 
	#SMIME_OLDMIME
 0x400

	)

116 
	#SMIME_CRLFEOL
 0x800

	)

117 
	#SMIME_STREAM
 0x1000

	)

118 
X509_Æg‹_°
;

119 
DEFINE_STACK_OF
(
X509_ALGOR
)

121 
	#ASN1_STRING_FLAG_BITS_LEFT
 0x08

	)

127 
	#ASN1_STRING_FLAG_NDEF
 0x010

	)

135 
	#ASN1_STRING_FLAG_CONT
 0x020

	)

140 
	#ASN1_STRING_FLAG_MSTRING
 0x040

	)

142 
	#ASN1_STRING_FLAG_EMBED
 0x080

	)

144 
	#ASN1_STRING_FLAG_X509_TIME
 0x100

	)

146 
	sa¢1_°rög_°
 {

147 
Àngth
;

148 
ty≥
;

149 *
d©a
;

155 
Êags
;

164 
	sASN1_ENCODING_°
 {

165 *
íc
;

166 
Àn
;

167 
modifõd
;

168 } 
	tASN1_ENCODING
;

171 
	#ASN1_LONG_UNDEF
 0x7fffffffL

	)

173 
	#STABLE_FLAGS_MALLOC
 0x01

	)

180 
	#STABLE_FLAGS_CLEAR
 
STABLE_FLAGS_MALLOC


	)

181 
	#STABLE_NO_MASK
 0x02

	)

182 
	#DIRSTRING_TYPE
 \

183 (
B_ASN1_PRINTABLESTRING
|
B_ASN1_T61STRING
|
B_ASN1_BMPSTRING
|
B_ASN1_UTF8STRING
)

	)

184 
	#PKCS9STRING_TYPE
 (
DIRSTRING_TYPE
|
B_ASN1_IA5STRING
)

	)

186 
	sa¢1_°rög_èbÀ_°
 {

187 
nid
;

188 
mösize
;

189 
maxsize
;

190 
mask
;

191 
Êags
;

192 } 
	tASN1_STRING_TABLE
;

194 
DEFINE_STACK_OF
(
ASN1_STRING_TABLE
)

198 
	#ub_«me
 32768

	)

199 
	#ub_comm⁄_«me
 64

	)

200 
	#ub_loˇlôy_«me
 128

	)

201 
	#ub_°©e_«me
 128

	)

202 
	#ub_‹g™iz©i⁄_«me
 64

	)

203 
	#ub_‹g™iz©i⁄_unô_«me
 64

	)

204 
	#ub_tôÀ
 64

	)

205 
	#ub_emaû_addªss
 128

	)

210 
ASN1_TEMPLATE_°
 
	tASN1_TEMPLATE
;

211 
ASN1_TLC_°
 
	tASN1_TLC
;

213 
ASN1_VALUE_°
 
	tASN1_VALUE
;

217 
	#DECLARE_ASN1_FUNCTIONS
(
ty≥
Ë
	`DECLARE_ASN1_FUNCTIONS_«me
—y≥,Åy≥)

	)

219 
	#DECLARE_ASN1_ALLOC_FUNCTIONS
(
ty≥
) \

220 
	`DECLARE_ASN1_ALLOC_FUNCTIONS_«me
(
ty≥
,Åy≥)

	)

222 
	#DECLARE_ASN1_FUNCTIONS_«me
(
ty≥
, 
«me
) \

223 
	`DECLARE_ASN1_ALLOC_FUNCTIONS_«me
(
ty≥
, 
«me
) \

224 
	`DECLARE_ASN1_ENCODE_FUNCTIONS
(
ty≥
, 
«me
,Çame)

	)

226 
	#DECLARE_ASN1_FUNCTIONS_‚ame
(
ty≥
, 
ô«me
, 
«me
) \

227 
	`DECLARE_ASN1_ALLOC_FUNCTIONS_«me
(
ty≥
, 
«me
) \

228 
	`DECLARE_ASN1_ENCODE_FUNCTIONS
(
ty≥
, 
ô«me
, 
«me
)

	)

230 
	#DECLARE_ASN1_ENCODE_FUNCTIONS
(
ty≥
, 
ô«me
, 
«me
) \

231 
ty≥
 *
d2i_
##
	`«me
—y≥ **
a
, c⁄° **
ö
, 
Àn
); \

232 
i2d_
##
	`«me
(
ty≥
 *
a
, **
out
); \

233 
	`DECLARE_ASN1_ITEM
(
ô«me
)

	)

235 
	#DECLARE_ASN1_ENCODE_FUNCTIONS_c⁄°
(
ty≥
, 
«me
) \

236 
ty≥
 *
d2i_
##
	`«me
—y≥ **
a
, c⁄° **
ö
, 
Àn
); \

237 
i2d_
##
	`«me
(c⁄° 
ty≥
 *
a
, **
out
); \

238 
	`DECLARE_ASN1_ITEM
(
«me
)

	)

240 
	#DECLARE_ASN1_NDEF_FUNCTION
(
«me
) \

241 
i2d_
##
«me
##
	`_NDEF
“amê*
a
, **
out
);

	)

243 
	#DECLARE_ASN1_FUNCTIONS_c⁄°
(
«me
) \

244 
	`DECLARE_ASN1_ALLOC_FUNCTIONS
(
«me
) \

245 
	`DECLARE_ASN1_ENCODE_FUNCTIONS_c⁄°
(
«me
,Çame)

	)

247 
	#DECLARE_ASN1_ALLOC_FUNCTIONS_«me
(
ty≥
, 
«me
) \

248 
ty≥
 *
«me
##
	`_√w
(); \

249 
«me
##
	`_‰ì
(
ty≥
 *
a
);

	)

251 
	#DECLARE_ASN1_PRINT_FUNCTION
(
°«me
) \

252 
	`DECLARE_ASN1_PRINT_FUNCTION_‚ame
(
°«me
, säame)

	)

254 
	#DECLARE_ASN1_PRINT_FUNCTION_‚ame
(
°«me
, 
‚ame
) \

255 
‚ame
##
	`_¥öt_˘x
(
BIO
 *
out
, 
°«me
 *
x
, 
ödít
, \

256 c⁄° 
ASN1_PCTX
 *
p˘x
);

	)

258 
	#D2I_OF
(
ty≥
Ëty≥ *(*)—y≥ **,c⁄° **,)

	)

259 
	#I2D_OF
(
ty≥
Ë(*)—y≥ *,**)

	)

260 
	#I2D_OF_c⁄°
(
ty≥
Ë(*)(c⁄°Åy≥ *,**)

	)

262 
	#CHECKED_D2I_OF
(
ty≥
, 
d2i
) \

263 ((
d2i_of_void
*Ë(1 ? 
d2i
 : ((
	`D2I_OF
(
ty≥
))0)))

	)

264 
	#CHECKED_I2D_OF
(
ty≥
, 
i2d
) \

265 ((
i2d_of_void
*Ë(1 ? 
i2d
 : ((
	`I2D_OF
(
ty≥
))0)))

	)

266 
	#CHECKED_NEW_OF
(
ty≥
, 
x√w
) \

267 ((*(*)()Ë(1 ? 
x√w
 : ((
ty≥
 *(*)())0)))

	)

268 
	#CHECKED_PTR_OF
(
ty≥
, 
p
) \

269 ((*Ë(1 ? 
p
 : (
ty≥
*)0))

	)

270 
	#CHECKED_PPTR_OF
(
ty≥
, 
p
) \

271 ((**Ë(1 ? 
p
 : (
ty≥
**)0))

	)

273 
	#TYPEDEF_D2I_OF
(
ty≥
Ëty≥ *
	td2i_of_
##
	tty≥
—y≥ **,c⁄° **,)

	)

274 
	tTYPEDEF_I2D_OF
(
	tty≥
Ë
	ti2d_of_
##ty≥—y≥ *,**)

	)

275 
	tTYPEDEF_D2I2D_OF
(
	tty≥
Ë
	tTYPEDEF_D2I_OF
—y≥); 
	`TYPEDEF_I2D_OF
(
ty≥
)

	)

277 
TYPEDEF_D2I2D_OF
();

315 #i‚de‡
OPENSSL_EXPORT_VAR_AS_FUNCTION


318 c⁄° 
	tASN1_ITEM
 
	tASN1_ITEM_EXP
;

321 
	#ASN1_ITEM_±r
(
ùå
Ë(ùå)

	)

324 
	#ASN1_ITEM_ªf
(
ùå
Ë(&(ùå##
_ô
))

	)

326 
	#ASN1_ITEM_Ωå
(
ªf
Ë(&‘ef##
_ô
))

	)

328 
	#DECLARE_ASN1_ITEM
(
«me
) \

329 
OPENSSL_EXTERN
 c⁄° 
ASN1_ITEM
 
«me
##
_ô
;

	)

339 c⁄° 
	tASN1_ITEM
 *
	tASN1_ITEM_EXP
 ();

342 
	#ASN1_ITEM_±r
(
ùå
Ë(
	`ùå
())

	)

345 
	#ASN1_ITEM_ªf
(
ùå
Ë(ùå##
_ô
)

	)

347 
	#ASN1_ITEM_Ωå
(
ªf
Ë‘ef##
	`_ô
())

	)

349 
	#DECLARE_ASN1_ITEM
(
«me
) \

350 c⁄° 
ASN1_ITEM
 * 
«me
##
	`_ô
();

	)

361 
	#ASN1_STRFLGS_ESC_2253
 1

	)

362 
	#ASN1_STRFLGS_ESC_CTRL
 2

	)

363 
	#ASN1_STRFLGS_ESC_MSB
 4

	)

370 
	#ASN1_STRFLGS_ESC_QUOTE
 8

	)

375 
	#CHARTYPE_PRINTABLESTRING
 0x10

	)

377 
	#CHARTYPE_FIRST_ESC_2253
 0x20

	)

379 
	#CHARTYPE_LAST_ESC_2253
 0x40

	)

390 
	#ASN1_STRFLGS_UTF8_CONVERT
 0x10

	)

398 
	#ASN1_STRFLGS_IGNORE_TYPE
 0x20

	)

401 
	#ASN1_STRFLGS_SHOW_TYPE
 0x40

	)

411 
	#ASN1_STRFLGS_DUMP_ALL
 0x80

	)

412 
	#ASN1_STRFLGS_DUMP_UNKNOWN
 0x100

	)

419 
	#ASN1_STRFLGS_DUMP_DER
 0x200

	)

424 
	#ASN1_STRFLGS_ESC_2254
 0x400

	)

431 
	#ASN1_STRFLGS_RFC2253
 (
ASN1_STRFLGS_ESC_2253
 | \

432 
ASN1_STRFLGS_ESC_CTRL
 | \

433 
ASN1_STRFLGS_ESC_MSB
 | \

434 
ASN1_STRFLGS_UTF8_CONVERT
 | \

435 
ASN1_STRFLGS_DUMP_UNKNOWN
 | \

436 
ASN1_STRFLGS_DUMP_DER
)

	)

438 
DEFINE_STACK_OF
(
ASN1_INTEGER
)

440 
DEFINE_STACK_OF
(
ASN1_GENERALSTRING
)

442 
DEFINE_STACK_OF
(
ASN1_UTF8STRING
)

444 
	sa¢1_ty≥_°
 {

445 
ty≥
;

447 *
±r
;

448 
ASN1_BOOLEAN
 
boﬁón
;

449 
ASN1_STRING
 *
a¢1_°rög
;

450 
ASN1_OBJECT
 *
obje˘
;

451 
ASN1_INTEGER
 *
öãgî
;

452 
ASN1_ENUMERATED
 *
íumî©ed
;

453 
ASN1_BIT_STRING
 *
bô_°rög
;

454 
ASN1_OCTET_STRING
 *
o˘ë_°rög
;

455 
ASN1_PRINTABLESTRING
 *
¥öèbÀ°rög
;

456 
ASN1_T61STRING
 *
t61°rög
;

457 
ASN1_IA5STRING
 *
ü5°rög
;

458 
ASN1_GENERALSTRING
 *
gíîÆ°rög
;

459 
ASN1_BMPSTRING
 *
bmp°rög
;

460 
ASN1_UNIVERSALSTRING
 *
univîßl°rög
;

461 
ASN1_UTCTIME
 *
ut˘ime
;

462 
ASN1_GENERALIZEDTIME
 *
gíîÆizedtime
;

463 
ASN1_VISIBLESTRING
 *
visibÀ°rög
;

464 
ASN1_UTF8STRING
 *
utf8°rög
;

469 
ASN1_STRING
 *
£t
;

470 
ASN1_STRING
 *
£quí˚
;

471 
ASN1_VALUE
 *
a¢1_vÆue
;

472 } 
vÆue
;

473 } 
	tASN1_TYPE
;

475 
DEFINE_STACK_OF
(
ASN1_TYPE
)

477 
STACK_OF
(
	tASN1_TYPE
Ë
	tASN1_SEQUENCE_ANY
;

479 
DECLARE_ASN1_ENCODE_FUNCTIONS_c⁄°
(
ASN1_SEQUENCE_ANY
, ASN1_SEQUENCE_ANY)

480 
DECLARE_ASN1_ENCODE_FUNCTIONS_c⁄°
(
ASN1_SEQUENCE_ANY
, 
ASN1_SET_ANY
)

483 
	sBIT_STRING_BITNAME_°
 {

484 
bônum
;

485 c⁄° *
 ame
;

486 c⁄° *
¢ame
;

487 } 
	tBIT_STRING_BITNAME
;

489 
	#B_ASN1_TIME
 \

490 
B_ASN1_UTCTIME
 | \

491 
B_ASN1_GENERALIZEDTIME


	)

493 
	#B_ASN1_PRINTABLE
 \

494 
B_ASN1_NUMERICSTRING
| \

495 
B_ASN1_PRINTABLESTRING
| \

496 
B_ASN1_T61STRING
| \

497 
B_ASN1_IA5STRING
| \

498 
B_ASN1_BIT_STRING
| \

499 
B_ASN1_UNIVERSALSTRING
|\

500 
B_ASN1_BMPSTRING
|\

501 
B_ASN1_UTF8STRING
|\

502 
B_ASN1_SEQUENCE
|\

503 
B_ASN1_UNKNOWN


	)

505 
	#B_ASN1_DIRECTORYSTRING
 \

506 
B_ASN1_PRINTABLESTRING
| \

507 
B_ASN1_TELETEXSTRING
|\

508 
B_ASN1_BMPSTRING
|\

509 
B_ASN1_UNIVERSALSTRING
|\

510 
B_ASN1_UTF8STRING


	)

512 
	#B_ASN1_DISPLAYTEXT
 \

513 
B_ASN1_IA5STRING
| \

514 
B_ASN1_VISIBLESTRING
| \

515 
B_ASN1_BMPSTRING
|\

516 
B_ASN1_UTF8STRING


	)

518 
DECLARE_ASN1_FUNCTIONS_‚ame
(
ASN1_TYPE
, 
ASN1_ANY
, ASN1_TYPE)

520 
ASN1_TYPE_gë
(c⁄° 
ASN1_TYPE
 *
a
);

521 
ASN1_TYPE_£t
(
ASN1_TYPE
 *
a
, 
ty≥
, *
vÆue
);

522 
ASN1_TYPE_£t1
(
ASN1_TYPE
 *
a
, 
ty≥
, c⁄° *
vÆue
);

523 
ASN1_TYPE_cmp
(c⁄° 
ASN1_TYPE
 *
a
, c⁄° ASN1_TYPE *
b
);

525 
ASN1_TYPE
 *
ASN1_TYPE_∑ck_£quí˚
(c⁄° 
ASN1_ITEM
 *
ô
, *
s
, ASN1_TYPE **
t
);

526 *
ASN1_TYPE_u≈ack_£quí˚
(c⁄° 
ASN1_ITEM
 *
ô
, c⁄° 
ASN1_TYPE
 *
t
);

528 
ASN1_OBJECT
 *
ASN1_OBJECT_√w
();

529 
ASN1_OBJECT_‰ì
(
ASN1_OBJECT
 *
a
);

530 
i2d_ASN1_OBJECT
(c⁄° 
ASN1_OBJECT
 *
a
, **
µ
);

531 
ASN1_OBJECT
 *
d2i_ASN1_OBJECT
(ASN1_OBJECT **
a
, c⁄° **
µ
,

532 
Àngth
);

534 
DECLARE_ASN1_ITEM
(
ASN1_OBJECT
)

536 
DEFINE_STACK_OF
(
ASN1_OBJECT
)

538 
ASN1_STRING
 *
ASN1_STRING_√w
();

539 
ASN1_STRING_‰ì
(
ASN1_STRING
 *
a
);

540 
ASN1_STRING_˛ór_‰ì
(
ASN1_STRING
 *
a
);

541 
ASN1_STRING_c›y
(
ASN1_STRING
 *
d°
, c⁄° ASN1_STRING *
°r
);

542 
ASN1_STRING
 *
ASN1_STRING_dup
(c⁄° ASN1_STRING *
a
);

543 
ASN1_STRING
 *
ASN1_STRING_ty≥_√w
(
ty≥
);

544 
ASN1_STRING_cmp
(c⁄° 
ASN1_STRING
 *
a
, c⁄° ASN1_STRING *
b
);

549 
ASN1_STRING_£t
(
ASN1_STRING
 *
°r
, c⁄° *
d©a
, 
Àn
);

550 
ASN1_STRING_£t0
(
ASN1_STRING
 *
°r
, *
d©a
, 
Àn
);

551 
ASN1_STRING_Àngth
(c⁄° 
ASN1_STRING
 *
x
);

552 
ASN1_STRING_Àngth_£t
(
ASN1_STRING
 *
x
, 
n
);

553 
ASN1_STRING_ty≥
(c⁄° 
ASN1_STRING
 *
x
);

554 
DEPRECATEDIN_1_1_0
(*
ASN1_STRING_d©a
(
ASN1_STRING
 *
x
))

555 c⁄° *
ASN1_STRING_gë0_d©a
(c⁄° 
ASN1_STRING
 *
x
);

557 
DECLARE_ASN1_FUNCTIONS
(
ASN1_BIT_STRING
)

558 
ASN1_BIT_STRING_£t
(
ASN1_BIT_STRING
 *
a
, *
d
, 
Àngth
);

559 
ASN1_BIT_STRING_£t_bô
(
ASN1_BIT_STRING
 *
a
, 
n
, 
vÆue
);

560 
ASN1_BIT_STRING_gë_bô
(c⁄° 
ASN1_BIT_STRING
 *
a
, 
n
);

561 
ASN1_BIT_STRING_check
(c⁄° 
ASN1_BIT_STRING
 *
a
,

562 c⁄° *
Êags
, 
Êags_Àn
);

564 
ASN1_BIT_STRING_«me_¥öt
(
BIO
 *
out
, 
ASN1_BIT_STRING
 *
bs
,

565 
BIT_STRING_BITNAME
 *
tbl
, 
ödít
);

566 
ASN1_BIT_STRING_num_asc
(c⁄° *
«me
, 
BIT_STRING_BITNAME
 *
tbl
);

567 
ASN1_BIT_STRING_£t_asc
(
ASN1_BIT_STRING
 *
bs
, c⁄° *
«me
, 
vÆue
,

568 
BIT_STRING_BITNAME
 *
tbl
);

570 
DECLARE_ASN1_FUNCTIONS
(
ASN1_INTEGER
)

571 
ASN1_INTEGER
 *
d2i_ASN1_UINTEGER
(ASN1_INTEGER **
a
, c⁄° **
µ
,

572 
Àngth
);

573 
ASN1_INTEGER
 *
ASN1_INTEGER_dup
(c⁄° ASN1_INTEGER *
x
);

574 
ASN1_INTEGER_cmp
(c⁄° 
ASN1_INTEGER
 *
x
, c⁄° ASN1_INTEGER *
y
);

576 
DECLARE_ASN1_FUNCTIONS
(
ASN1_ENUMERATED
)

578 
ASN1_UTCTIME_check
(c⁄° 
ASN1_UTCTIME
 *
a
);

579 
ASN1_UTCTIME
 *
ASN1_UTCTIME_£t
(ASN1_UTCTIME *
s
, 
time_t
 
t
);

580 
ASN1_UTCTIME
 *
ASN1_UTCTIME_adj
(ASN1_UTCTIME *
s
, 
time_t
 
t
,

581 
off£t_day
, 
off£t_£c
);

582 
ASN1_UTCTIME_£t_°rög
(
ASN1_UTCTIME
 *
s
, c⁄° *
°r
);

583 
ASN1_UTCTIME_cmp_time_t
(c⁄° 
ASN1_UTCTIME
 *
s
, 
time_t
 
t
);

585 
ASN1_GENERALIZEDTIME_check
(c⁄° 
ASN1_GENERALIZEDTIME
 *
a
);

586 
ASN1_GENERALIZEDTIME
 *
ASN1_GENERALIZEDTIME_£t
(ASN1_GENERALIZEDTIME *
s
,

587 
time_t
 
t
);

588 
ASN1_GENERALIZEDTIME
 *
ASN1_GENERALIZEDTIME_adj
(ASN1_GENERALIZEDTIME *
s
,

589 
time_t
 
t
, 
off£t_day
,

590 
off£t_£c
);

591 
ASN1_GENERALIZEDTIME_£t_°rög
(
ASN1_GENERALIZEDTIME
 *
s
, c⁄° *
°r
);

593 
ASN1_TIME_diff
(*
pday
, *
p£c
,

594 c⁄° 
ASN1_TIME
 *
‰om
, c⁄° ASN1_TIME *
to
);

596 
DECLARE_ASN1_FUNCTIONS
(
ASN1_OCTET_STRING
)

597 
ASN1_OCTET_STRING
 *
ASN1_OCTET_STRING_dup
(c⁄° ASN1_OCTET_STRING *
a
);

598 
ASN1_OCTET_STRING_cmp
(c⁄° 
ASN1_OCTET_STRING
 *
a
,

599 c⁄° 
ASN1_OCTET_STRING
 *
b
);

600 
ASN1_OCTET_STRING_£t
(
ASN1_OCTET_STRING
 *
°r
, c⁄° *
d©a
,

601 
Àn
);

603 
DECLARE_ASN1_FUNCTIONS
(
ASN1_VISIBLESTRING
)

604 
DECLARE_ASN1_FUNCTIONS
(
ASN1_UNIVERSALSTRING
)

605 
DECLARE_ASN1_FUNCTIONS
(
ASN1_UTF8STRING
)

606 
DECLARE_ASN1_FUNCTIONS
(
ASN1_NULL
)

607 
DECLARE_ASN1_FUNCTIONS
(
ASN1_BMPSTRING
)

609 
UTF8_gëc
(c⁄° *
°r
, 
Àn
, *
vÆ
);

610 
UTF8_putc
(*
°r
, 
Àn
, 
vÆue
);

612 
DECLARE_ASN1_FUNCTIONS_«me
(
ASN1_STRING
, 
ASN1_PRINTABLE
)

614 
DECLARE_ASN1_FUNCTIONS_«me
(
ASN1_STRING
, 
DIRECTORYSTRING
)

615 
DECLARE_ASN1_FUNCTIONS_«me
(
ASN1_STRING
, 
DISPLAYTEXT
)

616 
DECLARE_ASN1_FUNCTIONS
(
ASN1_PRINTABLESTRING
)

617 
DECLARE_ASN1_FUNCTIONS
(
ASN1_T61STRING
)

618 
DECLARE_ASN1_FUNCTIONS
(
ASN1_IA5STRING
)

619 
DECLARE_ASN1_FUNCTIONS
(
ASN1_GENERALSTRING
)

620 
DECLARE_ASN1_FUNCTIONS
(
ASN1_UTCTIME
)

621 
DECLARE_ASN1_FUNCTIONS
(
ASN1_GENERALIZEDTIME
)

622 
DECLARE_ASN1_FUNCTIONS
(
ASN1_TIME
)

624 
DECLARE_ASN1_ITEM
(
ASN1_OCTET_STRING_NDEF
)

626 
ASN1_TIME
 *
ASN1_TIME_£t
(ASN1_TIME *
s
, 
time_t
 
t
);

627 
ASN1_TIME
 *
ASN1_TIME_adj
(ASN1_TIME *
s
, 
time_t
 
t
,

628 
off£t_day
, 
off£t_£c
);

629 
ASN1_TIME_check
(c⁄° 
ASN1_TIME
 *
t
);

630 
ASN1_GENERALIZEDTIME
 *
ASN1_TIME_to_gíîÆizedtime
(c⁄° 
ASN1_TIME
 *
t
,

631 
ASN1_GENERALIZEDTIME
 **
out
);

632 
ASN1_TIME_£t_°rög
(
ASN1_TIME
 *
s
, c⁄° *
°r
);

633 
ASN1_TIME_£t_°rög_X509
(
ASN1_TIME
 *
s
, c⁄° *
°r
);

634 
ASN1_TIME_to_tm
(c⁄° 
ASN1_TIME
 *
s
, 
tm
 *tm);

635 
ASN1_TIME_n‹mÆize
(
ASN1_TIME
 *
s
);

636 
ASN1_TIME_cmp_time_t
(c⁄° 
ASN1_TIME
 *
s
, 
time_t
 
t
);

637 
ASN1_TIME_com∑ª
(c⁄° 
ASN1_TIME
 *
a
, c⁄° ASN1_TIME *
b
);

639 
i2a_ASN1_INTEGER
(
BIO
 *
bp
, c⁄° 
ASN1_INTEGER
 *
a
);

640 
a2i_ASN1_INTEGER
(
BIO
 *
bp
, 
ASN1_INTEGER
 *
bs
, *
buf
, 
size
);

641 
i2a_ASN1_ENUMERATED
(
BIO
 *
bp
, c⁄° 
ASN1_ENUMERATED
 *
a
);

642 
a2i_ASN1_ENUMERATED
(
BIO
 *
bp
, 
ASN1_ENUMERATED
 *
bs
, *
buf
, 
size
);

643 
i2a_ASN1_OBJECT
(
BIO
 *
bp
, c⁄° 
ASN1_OBJECT
 *
a
);

644 
a2i_ASN1_STRING
(
BIO
 *
bp
, 
ASN1_STRING
 *
bs
, *
buf
, 
size
);

645 
i2a_ASN1_STRING
(
BIO
 *
bp
, c⁄° 
ASN1_STRING
 *
a
, 
ty≥
);

646 
i2t_ASN1_OBJECT
(*
buf
, 
buf_Àn
, c⁄° 
ASN1_OBJECT
 *
a
);

648 
a2d_ASN1_OBJECT
(*
out
, 
ﬁí
, c⁄° *
buf
, 
num
);

649 
ASN1_OBJECT
 *
ASN1_OBJECT_¸óã
(
nid
, *
d©a
, 
Àn
,

650 c⁄° *
¢
, c⁄° *
 
);

652 
ASN1_INTEGER_gë_öt64
(
öt64_t
 *
¥
, c⁄° 
ASN1_INTEGER
 *
a
);

653 
ASN1_INTEGER_£t_öt64
(
ASN1_INTEGER
 *
a
, 
öt64_t
 
r
);

654 
ASN1_INTEGER_gë_uöt64
(
uöt64_t
 *
¥
, c⁄° 
ASN1_INTEGER
 *
a
);

655 
ASN1_INTEGER_£t_uöt64
(
ASN1_INTEGER
 *
a
, 
uöt64_t
 
r
);

657 
ASN1_INTEGER_£t
(
ASN1_INTEGER
 *
a
, 
v
);

658 
ASN1_INTEGER_gë
(c⁄° 
ASN1_INTEGER
 *
a
);

659 
ASN1_INTEGER
 *
BN_to_ASN1_INTEGER
(c⁄° 
BIGNUM
 *
bn
, ASN1_INTEGER *
ai
);

660 
BIGNUM
 *
ASN1_INTEGER_to_BN
(c⁄° 
ASN1_INTEGER
 *
ai
, BIGNUM *
bn
);

662 
ASN1_ENUMERATED_gë_öt64
(
öt64_t
 *
¥
, c⁄° 
ASN1_ENUMERATED
 *
a
);

663 
ASN1_ENUMERATED_£t_öt64
(
ASN1_ENUMERATED
 *
a
, 
öt64_t
 
r
);

666 
ASN1_ENUMERATED_£t
(
ASN1_ENUMERATED
 *
a
, 
v
);

667 
ASN1_ENUMERATED_gë
(c⁄° 
ASN1_ENUMERATED
 *
a
);

668 
ASN1_ENUMERATED
 *
BN_to_ASN1_ENUMERATED
(c⁄° 
BIGNUM
 *
bn
, ASN1_ENUMERATED *
ai
);

669 
BIGNUM
 *
ASN1_ENUMERATED_to_BN
(c⁄° 
ASN1_ENUMERATED
 *
ai
, BIGNUM *
bn
);

673 
ASN1_PRINTABLE_ty≥
(c⁄° *
s
, 
max
);

675 
ASN1_èg2bô
(
èg
);

678 
ASN1_gë_obje˘
(c⁄° **
µ
, *
∂ígth
, *
±ag
,

679 *
p˛ass
, 
omax
);

680 
ASN1_check_öföôe_íd
(**
p
, 
Àn
);

681 
ASN1_c⁄°_check_öföôe_íd
(c⁄° **
p
, 
Àn
);

682 
ASN1_put_obje˘
(**
µ
, 
c⁄°ru˘ed
, 
Àngth
,

683 
èg
, 
x˛ass
);

684 
ASN1_put_eoc
(**
µ
);

685 
ASN1_obje˘_size
(
c⁄°ru˘ed
, 
Àngth
, 
èg
);

688 *
ASN1_dup
(
i2d_of_void
 *
i2d
, 
d2i_of_void
 *
d2i
, *
x
);

690 
	#ASN1_dup_of
(
ty≥
,
i2d
,
d2i
,
x
) \

691 ((
ty≥
*)
	`ASN1_dup
(
	`CHECKED_I2D_OF
—y≥, 
i2d
), \

692 
	`CHECKED_D2I_OF
(
ty≥
, 
d2i
), \

693 
	`CHECKED_PTR_OF
(
ty≥
, 
x
)))

	)

695 
	#ASN1_dup_of_c⁄°
(
ty≥
,
i2d
,
d2i
,
x
) \

696 ((
ty≥
*)
	`ASN1_dup
(
	`CHECKED_I2D_OF
(c⁄°Åy≥, 
i2d
), \

697 
	`CHECKED_D2I_OF
(
ty≥
, 
d2i
), \

698 
	`CHECKED_PTR_OF
(c⁄° 
ty≥
, 
x
)))

	)

700 *
ASN1_ôem_dup
(c⁄° 
ASN1_ITEM
 *
ô
, *
x
);

704 
	#M_ASN1_√w_of
(
ty≥
Ë—y≥ *)
	`ASN1_ôem_√w
(
	`ASN1_ITEM_Ωå
—y≥))

	)

705 
	#M_ASN1_‰ì_of
(
x
, 
ty≥
) \

706 
	`ASN1_ôem_‰ì
(
	`CHECKED_PTR_OF
(
ty≥
, 
x
), 
	`ASN1_ITEM_Ωå
—y≥))

	)

708 #i‚de‡
OPENSSL_NO_STDIO


709 *
ASN1_d2i_Â
(*(*
x√w
Ë(), 
d2i_of_void
 *
d2i
, 
FILE
 *
ö
, **
x
);

711 
	#ASN1_d2i_Â_of
(
ty≥
,
x√w
,
d2i
,
ö
,
x
) \

712 ((
ty≥
*)
	`ASN1_d2i_Â
(
	`CHECKED_NEW_OF
—y≥, 
x√w
), \

713 
	`CHECKED_D2I_OF
(
ty≥
, 
d2i
), \

714 
ö
, \

715 
	`CHECKED_PPTR_OF
(
ty≥
, 
x
)))

	)

717 *
ASN1_ôem_d2i_Â
(c⁄° 
ASN1_ITEM
 *
ô
, 
FILE
 *
ö
, *
x
);

718 
ASN1_i2d_Â
(
i2d_of_void
 *
i2d
, 
FILE
 *
out
, *
x
);

720 
	#ASN1_i2d_Â_of
(
ty≥
,
i2d
,
out
,
x
) \

721 (
	`ASN1_i2d_Â
(
	`CHECKED_I2D_OF
(
ty≥
, 
i2d
), \

722 
out
, \

723 
	`CHECKED_PTR_OF
(
ty≥
, 
x
)))

	)

725 
	#ASN1_i2d_Â_of_c⁄°
(
ty≥
,
i2d
,
out
,
x
) \

726 (
	`ASN1_i2d_Â
(
	`CHECKED_I2D_OF
(c⁄° 
ty≥
, 
i2d
), \

727 
out
, \

728 
	`CHECKED_PTR_OF
(c⁄° 
ty≥
, 
x
)))

	)

730 
ASN1_ôem_i2d_Â
(c⁄° 
ASN1_ITEM
 *
ô
, 
FILE
 *
out
, *
x
);

731 
ASN1_STRING_¥öt_ex_Â
(
FILE
 *
Â
, c⁄° 
ASN1_STRING
 *
°r
, 
Êags
);

734 
ASN1_STRING_to_UTF8
(**
out
, c⁄° 
ASN1_STRING
 *
ö
);

736 *
ASN1_d2i_bio
(*(*
x√w
Ë(), 
d2i_of_void
 *
d2i
, 
BIO
 *
ö
, **
x
);

738 
	#ASN1_d2i_bio_of
(
ty≥
,
x√w
,
d2i
,
ö
,
x
) \

739 ((
ty≥
*)
	`ASN1_d2i_bio
–
	`CHECKED_NEW_OF
—y≥, 
x√w
), \

740 
	`CHECKED_D2I_OF
(
ty≥
, 
d2i
), \

741 
ö
, \

742 
	`CHECKED_PPTR_OF
(
ty≥
, 
x
)))

	)

744 *
ASN1_ôem_d2i_bio
(c⁄° 
ASN1_ITEM
 *
ô
, 
BIO
 *
ö
, *
x
);

745 
ASN1_i2d_bio
(
i2d_of_void
 *
i2d
, 
BIO
 *
out
, *
x
);

747 
	#ASN1_i2d_bio_of
(
ty≥
,
i2d
,
out
,
x
) \

748 (
	`ASN1_i2d_bio
(
	`CHECKED_I2D_OF
(
ty≥
, 
i2d
), \

749 
out
, \

750 
	`CHECKED_PTR_OF
(
ty≥
, 
x
)))

	)

752 
	#ASN1_i2d_bio_of_c⁄°
(
ty≥
,
i2d
,
out
,
x
) \

753 (
	`ASN1_i2d_bio
(
	`CHECKED_I2D_OF
(c⁄° 
ty≥
, 
i2d
), \

754 
out
, \

755 
	`CHECKED_PTR_OF
(c⁄° 
ty≥
, 
x
)))

	)

757 
ASN1_ôem_i2d_bio
(c⁄° 
ASN1_ITEM
 *
ô
, 
BIO
 *
out
, *
x
);

758 
ASN1_UTCTIME_¥öt
(
BIO
 *
Â
, c⁄° 
ASN1_UTCTIME
 *
a
);

759 
ASN1_GENERALIZEDTIME_¥öt
(
BIO
 *
Â
, c⁄° 
ASN1_GENERALIZEDTIME
 *
a
);

760 
ASN1_TIME_¥öt
(
BIO
 *
Â
, c⁄° 
ASN1_TIME
 *
a
);

761 
ASN1_STRING_¥öt
(
BIO
 *
bp
, c⁄° 
ASN1_STRING
 *
v
);

762 
ASN1_STRING_¥öt_ex
(
BIO
 *
out
, c⁄° 
ASN1_STRING
 *
°r
, 
Êags
);

763 
ASN1_buf_¥öt
(
BIO
 *
bp
, c⁄° *
buf
, 
size_t
 
buÊí
, 
off
);

764 
ASN1_bn_¥öt
(
BIO
 *
bp
, c⁄° *
numbî
, c⁄° 
BIGNUM
 *
num
,

765 *
buf
, 
off
);

766 
ASN1_∑r£
(
BIO
 *
bp
, c⁄° *
µ
, 
Àn
, 
ödít
);

767 
ASN1_∑r£_dump
(
BIO
 *
bp
, c⁄° *
µ
, 
Àn
, 
ödít
,

768 
dump
);

769 c⁄° *
ASN1_èg2°r
(
èg
);

773 
ASN1_UNIVERSALSTRING_to_°rög
(
ASN1_UNIVERSALSTRING
 *
s
);

775 
ASN1_TYPE_£t_o˘ë°rög
(
ASN1_TYPE
 *
a
, *
d©a
, 
Àn
);

776 
ASN1_TYPE_gë_o˘ë°rög
(c⁄° 
ASN1_TYPE
 *
a
, *
d©a
, 
max_Àn
);

777 
ASN1_TYPE_£t_öt_o˘ë°rög
(
ASN1_TYPE
 *
a
, 
num
,

778 *
d©a
, 
Àn
);

779 
ASN1_TYPE_gë_öt_o˘ë°rög
(c⁄° 
ASN1_TYPE
 *
a
, *
num
,

780 *
d©a
, 
max_Àn
);

782 *
ASN1_ôem_u≈ack
(c⁄° 
ASN1_STRING
 *
o˘
, c⁄° 
ASN1_ITEM
 *
ô
);

784 
ASN1_STRING
 *
ASN1_ôem_∑ck
(*
obj
, c⁄° 
ASN1_ITEM
 *
ô
,

785 
ASN1_OCTET_STRING
 **
o˘
);

787 
ASN1_STRING_£t_deÁu…_mask
(
mask
);

788 
ASN1_STRING_£t_deÁu…_mask_asc
(c⁄° *
p
);

789 
ASN1_STRING_gë_deÁu…_mask
();

790 
ASN1_mb°rög_c›y
(
ASN1_STRING
 **
out
, c⁄° *
ö
, 
Àn
,

791 
öf‹m
, 
mask
);

792 
ASN1_mb°rög_nc›y
(
ASN1_STRING
 **
out
, c⁄° *
ö
, 
Àn
,

793 
öf‹m
, 
mask
,

794 
mösize
, 
maxsize
);

796 
ASN1_STRING
 *
ASN1_STRING_£t_by_NID
(ASN1_STRING **
out
,

797 c⁄° *
ö
, 
öÀn
,

798 
öf‹m
, 
nid
);

799 
ASN1_STRING_TABLE
 *
ASN1_STRING_TABLE_gë
(
nid
);

800 
ASN1_STRING_TABLE_add
(, , , , );

801 
ASN1_STRING_TABLE_˛ónup
();

806 
ASN1_VALUE
 *
ASN1_ôem_√w
(c⁄° 
ASN1_ITEM
 *
ô
);

807 
ASN1_ôem_‰ì
(
ASN1_VALUE
 *
vÆ
, c⁄° 
ASN1_ITEM
 *
ô
);

808 
ASN1_VALUE
 *
ASN1_ôem_d2i
(ASN1_VALUE **
vÆ
, c⁄° **
ö
,

809 
Àn
, c⁄° 
ASN1_ITEM
 *
ô
);

810 
ASN1_ôem_i2d
(
ASN1_VALUE
 *
vÆ
, **
out
, c⁄° 
ASN1_ITEM
 *
ô
);

811 
ASN1_ôem_ndef_i2d
(
ASN1_VALUE
 *
vÆ
, **
out
,

812 c⁄° 
ASN1_ITEM
 *
ô
);

814 
ASN1_add_oid_moduÀ
();

815 
ASN1_add_°abÀ_moduÀ
();

817 
ASN1_TYPE
 *
ASN1_gíî©e_nc⁄f
(c⁄° *
°r
, 
CONF
 *
nc⁄f
);

818 
ASN1_TYPE
 *
ASN1_gíî©e_v3
(c⁄° *
°r
, 
X509V3_CTX
 *
˙f
);

819 
ASN1_°r2mask
(c⁄° *
°r
, *
pmask
);

824 
	#ASN1_PCTX_FLAGS_SHOW_ABSENT
 0x001

	)

826 
	#ASN1_PCTX_FLAGS_SHOW_SEQUENCE
 0x002

	)

828 
	#ASN1_PCTX_FLAGS_SHOW_SSOF
 0x004

	)

830 
	#ASN1_PCTX_FLAGS_SHOW_TYPE
 0x008

	)

832 
	#ASN1_PCTX_FLAGS_NO_ANY_TYPE
 0x010

	)

834 
	#ASN1_PCTX_FLAGS_NO_MSTRING_TYPE
 0x020

	)

836 
	#ASN1_PCTX_FLAGS_NO_FIELD_NAME
 0x040

	)

838 
	#ASN1_PCTX_FLAGS_SHOW_FIELD_STRUCT_NAME
 0x080

	)

840 
	#ASN1_PCTX_FLAGS_NO_STRUCT_NAME
 0x100

	)

842 
ASN1_ôem_¥öt
(
BIO
 *
out
, 
ASN1_VALUE
 *
iÊd
, 
ödít
,

843 c⁄° 
ASN1_ITEM
 *
ô
, c⁄° 
ASN1_PCTX
 *
p˘x
);

844 
ASN1_PCTX
 *
ASN1_PCTX_√w
();

845 
ASN1_PCTX_‰ì
(
ASN1_PCTX
 *
p
);

846 
ASN1_PCTX_gë_Êags
(c⁄° 
ASN1_PCTX
 *
p
);

847 
ASN1_PCTX_£t_Êags
(
ASN1_PCTX
 *
p
, 
Êags
);

848 
ASN1_PCTX_gë_nm_Êags
(c⁄° 
ASN1_PCTX
 *
p
);

849 
ASN1_PCTX_£t_nm_Êags
(
ASN1_PCTX
 *
p
, 
Êags
);

850 
ASN1_PCTX_gë_˚π_Êags
(c⁄° 
ASN1_PCTX
 *
p
);

851 
ASN1_PCTX_£t_˚π_Êags
(
ASN1_PCTX
 *
p
, 
Êags
);

852 
ASN1_PCTX_gë_oid_Êags
(c⁄° 
ASN1_PCTX
 *
p
);

853 
ASN1_PCTX_£t_oid_Êags
(
ASN1_PCTX
 *
p
, 
Êags
);

854 
ASN1_PCTX_gë_°r_Êags
(c⁄° 
ASN1_PCTX
 *
p
);

855 
ASN1_PCTX_£t_°r_Êags
(
ASN1_PCTX
 *
p
, 
Êags
);

857 
ASN1_SCTX
 *
ASN1_SCTX_√w
((*
sˇn_cb
Ë(ASN1_SCTX *
˘x
));

858 
ASN1_SCTX_‰ì
(
ASN1_SCTX
 *
p
);

859 c⁄° 
ASN1_ITEM
 *
ASN1_SCTX_gë_ôem
(
ASN1_SCTX
 *
p
);

860 c⁄° 
ASN1_TEMPLATE
 *
ASN1_SCTX_gë_ãm∂©e
(
ASN1_SCTX
 *
p
);

861 
ASN1_SCTX_gë_Êags
(
ASN1_SCTX
 *
p
);

862 
ASN1_SCTX_£t_≠p_d©a
(
ASN1_SCTX
 *
p
, *
d©a
);

863 *
ASN1_SCTX_gë_≠p_d©a
(
ASN1_SCTX
 *
p
);

865 c⁄° 
BIO_METHOD
 *
BIO_f_a¢1
();

867 
BIO
 *
BIO_√w_NDEF
(BIO *
out
, 
ASN1_VALUE
 *
vÆ
, c⁄° 
ASN1_ITEM
 *
ô
);

869 
i2d_ASN1_bio_°ªam
(
BIO
 *
out
, 
ASN1_VALUE
 *
vÆ
, BIO *
ö
, 
Êags
,

870 c⁄° 
ASN1_ITEM
 *
ô
);

871 
PEM_wrôe_bio_ASN1_°ªam
(
BIO
 *
out
, 
ASN1_VALUE
 *
vÆ
, BIO *
ö
, 
Êags
,

872 c⁄° *
hdr
, c⁄° 
ASN1_ITEM
 *
ô
);

873 
SMIME_wrôe_ASN1
(
BIO
 *
bio
, 
ASN1_VALUE
 *
vÆ
, BIO *
d©a
, 
Êags
,

874 
˘y≥_nid
, 
ec⁄t_nid
,

875 
STACK_OF
(
X509_ALGOR
Ë*
mdÆgs
, c⁄° 
ASN1_ITEM
 *
ô
);

876 
ASN1_VALUE
 *
SMIME_ªad_ASN1
(
BIO
 *
bio
, BIO **
bc⁄t
, c⁄° 
ASN1_ITEM
 *
ô
);

877 
SMIME_¸lf_c›y
(
BIO
 *
ö
, BIO *
out
, 
Êags
);

878 
SMIME_ãxt
(
BIO
 *
ö
, BIO *
out
);

880 c⁄° 
ASN1_ITEM
 *
ASN1_ITEM_lookup
(c⁄° *
«me
);

881 c⁄° 
ASN1_ITEM
 *
ASN1_ITEM_gë
(
size_t
 
i
);

883 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/asyncerr.h

11 #i‚de‡
HEADER_ASYNCERR_H


12 
	#HEADER_ASYNCERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_ASYNC_°rögs
();

26 
	#ASYNC_F_ASYNC_CTX_NEW
 100

	)

27 
	#ASYNC_F_ASYNC_INIT_THREAD
 101

	)

28 
	#ASYNC_F_ASYNC_JOB_NEW
 102

	)

29 
	#ASYNC_F_ASYNC_PAUSE_JOB
 103

	)

30 
	#ASYNC_F_ASYNC_START_FUNC
 104

	)

31 
	#ASYNC_F_ASYNC_START_JOB
 105

	)

32 
	#ASYNC_F_ASYNC_WAIT_CTX_SET_WAIT_FD
 106

	)

37 
	#ASYNC_R_FAILED_TO_SET_POOL
 101

	)

38 
	#ASYNC_R_FAILED_TO_SWAP_CONTEXT
 102

	)

39 
	#ASYNC_R_INIT_FAILED
 105

	)

40 
	#ASYNC_R_INVALID_POOL_SIZE
 103

	)

	@/usr/include/openssl/bioerr.h

11 #i‚de‡
HEADER_BIOERR_H


12 
	#HEADER_BIOERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_BIO_°rögs
();

26 
	#BIO_F_ACPT_STATE
 100

	)

27 
	#BIO_F_ADDRINFO_WRAP
 148

	)

28 
	#BIO_F_ADDR_STRINGS
 134

	)

29 
	#BIO_F_BIO_ACCEPT
 101

	)

30 
	#BIO_F_BIO_ACCEPT_EX
 137

	)

31 
	#BIO_F_BIO_ACCEPT_NEW
 152

	)

32 
	#BIO_F_BIO_ADDR_NEW
 144

	)

33 
	#BIO_F_BIO_BIND
 147

	)

34 
	#BIO_F_BIO_CALLBACK_CTRL
 131

	)

35 
	#BIO_F_BIO_CONNECT
 138

	)

36 
	#BIO_F_BIO_CONNECT_NEW
 153

	)

37 
	#BIO_F_BIO_CTRL
 103

	)

38 
	#BIO_F_BIO_GETS
 104

	)

39 
	#BIO_F_BIO_GET_HOST_IP
 106

	)

40 
	#BIO_F_BIO_GET_NEW_INDEX
 102

	)

41 
	#BIO_F_BIO_GET_PORT
 107

	)

42 
	#BIO_F_BIO_LISTEN
 139

	)

43 
	#BIO_F_BIO_LOOKUP
 135

	)

44 
	#BIO_F_BIO_LOOKUP_EX
 143

	)

45 
	#BIO_F_BIO_MAKE_PAIR
 121

	)

46 
	#BIO_F_BIO_METH_NEW
 146

	)

47 
	#BIO_F_BIO_NEW
 108

	)

48 
	#BIO_F_BIO_NEW_DGRAM_SCTP
 145

	)

49 
	#BIO_F_BIO_NEW_FILE
 109

	)

50 
	#BIO_F_BIO_NEW_MEM_BUF
 126

	)

51 
	#BIO_F_BIO_NREAD
 123

	)

52 
	#BIO_F_BIO_NREAD0
 124

	)

53 
	#BIO_F_BIO_NWRITE
 125

	)

54 
	#BIO_F_BIO_NWRITE0
 122

	)

55 
	#BIO_F_BIO_PARSE_HOSTSERV
 136

	)

56 
	#BIO_F_BIO_PUTS
 110

	)

57 
	#BIO_F_BIO_READ
 111

	)

58 
	#BIO_F_BIO_READ_EX
 105

	)

59 
	#BIO_F_BIO_READ_INTERN
 120

	)

60 
	#BIO_F_BIO_SOCKET
 140

	)

61 
	#BIO_F_BIO_SOCKET_NBIO
 142

	)

62 
	#BIO_F_BIO_SOCK_INFO
 141

	)

63 
	#BIO_F_BIO_SOCK_INIT
 112

	)

64 
	#BIO_F_BIO_WRITE
 113

	)

65 
	#BIO_F_BIO_WRITE_EX
 119

	)

66 
	#BIO_F_BIO_WRITE_INTERN
 128

	)

67 
	#BIO_F_BUFFER_CTRL
 114

	)

68 
	#BIO_F_CONN_CTRL
 127

	)

69 
	#BIO_F_CONN_STATE
 115

	)

70 
	#BIO_F_DGRAM_SCTP_NEW
 149

	)

71 
	#BIO_F_DGRAM_SCTP_READ
 132

	)

72 
	#BIO_F_DGRAM_SCTP_WRITE
 133

	)

73 
	#BIO_F_DOAPR_OUTCH
 150

	)

74 
	#BIO_F_FILE_CTRL
 116

	)

75 
	#BIO_F_FILE_READ
 130

	)

76 
	#BIO_F_LINEBUFFER_CTRL
 129

	)

77 
	#BIO_F_LINEBUFFER_NEW
 151

	)

78 
	#BIO_F_MEM_WRITE
 117

	)

79 
	#BIO_F_NBIOF_NEW
 154

	)

80 
	#BIO_F_SLG_WRITE
 155

	)

81 
	#BIO_F_SSL_NEW
 118

	)

86 
	#BIO_R_ACCEPT_ERROR
 100

	)

87 
	#BIO_R_ADDRINFO_ADDR_IS_NOT_AF_INET
 141

	)

88 
	#BIO_R_AMBIGUOUS_HOST_OR_SERVICE
 129

	)

89 
	#BIO_R_BAD_FOPEN_MODE
 101

	)

90 
	#BIO_R_BROKEN_PIPE
 124

	)

91 
	#BIO_R_CONNECT_ERROR
 103

	)

92 
	#BIO_R_GETHOSTBYNAME_ADDR_IS_NOT_AF_INET
 107

	)

93 
	#BIO_R_GETSOCKNAME_ERROR
 132

	)

94 
	#BIO_R_GETSOCKNAME_TRUNCATED_ADDRESS
 133

	)

95 
	#BIO_R_GETTING_SOCKTYPE
 134

	)

96 
	#BIO_R_INVALID_ARGUMENT
 125

	)

97 
	#BIO_R_INVALID_SOCKET
 135

	)

98 
	#BIO_R_IN_USE
 123

	)

99 
	#BIO_R_LENGTH_TOO_LONG
 102

	)

100 
	#BIO_R_LISTEN_V6_ONLY
 136

	)

101 
	#BIO_R_LOOKUP_RETURNED_NOTHING
 142

	)

102 
	#BIO_R_MALFORMED_HOST_OR_SERVICE
 130

	)

103 
	#BIO_R_NBIO_CONNECT_ERROR
 110

	)

104 
	#BIO_R_NO_ACCEPT_ADDR_OR_SERVICE_SPECIFIED
 143

	)

105 
	#BIO_R_NO_HOSTNAME_OR_SERVICE_SPECIFIED
 144

	)

106 
	#BIO_R_NO_PORT_DEFINED
 113

	)

107 
	#BIO_R_NO_SUCH_FILE
 128

	)

108 
	#BIO_R_NULL_PARAMETER
 115

	)

109 
	#BIO_R_UNABLE_TO_BIND_SOCKET
 117

	)

110 
	#BIO_R_UNABLE_TO_CREATE_SOCKET
 118

	)

111 
	#BIO_R_UNABLE_TO_KEEPALIVE
 137

	)

112 
	#BIO_R_UNABLE_TO_LISTEN_SOCKET
 119

	)

113 
	#BIO_R_UNABLE_TO_NODELAY
 138

	)

114 
	#BIO_R_UNABLE_TO_REUSEADDR
 139

	)

115 
	#BIO_R_UNAVAILABLE_IP_FAMILY
 145

	)

116 
	#BIO_R_UNINITIALIZED
 120

	)

117 
	#BIO_R_UNKNOWN_INFO_TYPE
 140

	)

118 
	#BIO_R_UNSUPPORTED_IP_FAMILY
 146

	)

119 
	#BIO_R_UNSUPPORTED_METHOD
 121

	)

120 
	#BIO_R_UNSUPPORTED_PROTOCOL_FAMILY
 131

	)

121 
	#BIO_R_WRITE_TO_READ_ONLY_BIO
 126

	)

122 
	#BIO_R_WSASTARTUP
 122

	)

	@/usr/include/openssl/buffererr.h

11 #i‚de‡
HEADER_BUFERR_H


12 
	#HEADER_BUFERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_BUF_°rögs
();

26 
	#BUF_F_BUF_MEM_GROW
 100

	)

27 
	#BUF_F_BUF_MEM_GROW_CLEAN
 105

	)

28 
	#BUF_F_BUF_MEM_NEW
 101

	)

	@/usr/include/openssl/comperr.h

11 #i‚de‡
HEADER_COMPERR_H


12 
	#HEADER_COMPERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 
	~<›ís¶/›ís¶c⁄f.h
>

20 #i‚de‡
OPENSSL_NO_COMP


22 #ifde‡ 
__˝lu•lus


25 
ERR_lﬂd_COMP_°rögs
();

30 
	#COMP_F_BIO_ZLIB_FLUSH
 99

	)

31 
	#COMP_F_BIO_ZLIB_NEW
 100

	)

32 
	#COMP_F_BIO_ZLIB_READ
 101

	)

33 
	#COMP_F_BIO_ZLIB_WRITE
 102

	)

34 
	#COMP_F_COMP_CTX_NEW
 103

	)

39 
	#COMP_R_ZLIB_DEFLATE_ERROR
 99

	)

40 
	#COMP_R_ZLIB_INFLATE_ERROR
 100

	)

41 
	#COMP_R_ZLIB_NOT_SUPPORTED
 101

	)

	@/usr/include/openssl/cryptoerr.h

11 #i‚de‡
HEADER_CRYPTOERR_H


12 
	#HEADER_CRYPTOERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_CRYPTO_°rögs
();

26 
	#CRYPTO_F_CMAC_CTX_NEW
 120

	)

27 
	#CRYPTO_F_CRYPTO_DUP_EX_DATA
 110

	)

28 
	#CRYPTO_F_CRYPTO_FREE_EX_DATA
 111

	)

29 
	#CRYPTO_F_CRYPTO_GET_EX_NEW_INDEX
 100

	)

30 
	#CRYPTO_F_CRYPTO_MEMDUP
 115

	)

31 
	#CRYPTO_F_CRYPTO_NEW_EX_DATA
 112

	)

32 
	#CRYPTO_F_CRYPTO_OCB128_COPY_CTX
 121

	)

33 
	#CRYPTO_F_CRYPTO_OCB128_INIT
 122

	)

34 
	#CRYPTO_F_CRYPTO_SET_EX_DATA
 102

	)

35 
	#CRYPTO_F_FIPS_MODE_SET
 109

	)

36 
	#CRYPTO_F_GET_AND_LOCK
 113

	)

37 
	#CRYPTO_F_OPENSSL_ATEXIT
 114

	)

38 
	#CRYPTO_F_OPENSSL_BUF2HEXSTR
 117

	)

39 
	#CRYPTO_F_OPENSSL_FOPEN
 119

	)

40 
	#CRYPTO_F_OPENSSL_HEXSTR2BUF
 118

	)

41 
	#CRYPTO_F_OPENSSL_INIT_CRYPTO
 116

	)

42 
	#CRYPTO_F_OPENSSL_LH_NEW
 126

	)

43 
	#CRYPTO_F_OPENSSL_SK_DEEP_COPY
 127

	)

44 
	#CRYPTO_F_OPENSSL_SK_DUP
 128

	)

45 
	#CRYPTO_F_PKEY_HMAC_INIT
 123

	)

46 
	#CRYPTO_F_PKEY_POLY1305_INIT
 124

	)

47 
	#CRYPTO_F_PKEY_SIPHASH_INIT
 125

	)

48 
	#CRYPTO_F_SK_RESERVE
 129

	)

53 
	#CRYPTO_R_FIPS_MODE_NOT_SUPPORTED
 101

	)

54 
	#CRYPTO_R_ILLEGAL_HEX_DIGIT
 102

	)

55 
	#CRYPTO_R_ODD_NUMBER_OF_DIGITS
 103

	)

	@/usr/include/openssl/cterr.h

11 #i‚de‡
HEADER_CTERR_H


12 
	#HEADER_CTERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 
	~<›ís¶/›ís¶c⁄f.h
>

20 #i‚de‡
OPENSSL_NO_CT


22 #ifde‡ 
__˝lu•lus


25 
ERR_lﬂd_CT_°rögs
();

30 
	#CT_F_CTLOG_NEW
 117

	)

31 
	#CT_F_CTLOG_NEW_FROM_BASE64
 118

	)

32 
	#CT_F_CTLOG_NEW_FROM_CONF
 119

	)

33 
	#CT_F_CTLOG_STORE_LOAD_CTX_NEW
 122

	)

34 
	#CT_F_CTLOG_STORE_LOAD_FILE
 123

	)

35 
	#CT_F_CTLOG_STORE_LOAD_LOG
 130

	)

36 
	#CT_F_CTLOG_STORE_NEW
 131

	)

37 
	#CT_F_CT_BASE64_DECODE
 124

	)

38 
	#CT_F_CT_POLICY_EVAL_CTX_NEW
 133

	)

39 
	#CT_F_CT_V1_LOG_ID_FROM_PKEY
 125

	)

40 
	#CT_F_I2O_SCT
 107

	)

41 
	#CT_F_I2O_SCT_LIST
 108

	)

42 
	#CT_F_I2O_SCT_SIGNATURE
 109

	)

43 
	#CT_F_O2I_SCT
 110

	)

44 
	#CT_F_O2I_SCT_LIST
 111

	)

45 
	#CT_F_O2I_SCT_SIGNATURE
 112

	)

46 
	#CT_F_SCT_CTX_NEW
 126

	)

47 
	#CT_F_SCT_CTX_VERIFY
 128

	)

48 
	#CT_F_SCT_NEW
 100

	)

49 
	#CT_F_SCT_NEW_FROM_BASE64
 127

	)

50 
	#CT_F_SCT_SET0_LOG_ID
 101

	)

51 
	#CT_F_SCT_SET1_EXTENSIONS
 114

	)

52 
	#CT_F_SCT_SET1_LOG_ID
 115

	)

53 
	#CT_F_SCT_SET1_SIGNATURE
 116

	)

54 
	#CT_F_SCT_SET_LOG_ENTRY_TYPE
 102

	)

55 
	#CT_F_SCT_SET_SIGNATURE_NID
 103

	)

56 
	#CT_F_SCT_SET_VERSION
 104

	)

61 
	#CT_R_BASE64_DECODE_ERROR
 108

	)

62 
	#CT_R_INVALID_LOG_ID_LENGTH
 100

	)

63 
	#CT_R_LOG_CONF_INVALID
 109

	)

64 
	#CT_R_LOG_CONF_INVALID_KEY
 110

	)

65 
	#CT_R_LOG_CONF_MISSING_DESCRIPTION
 111

	)

66 
	#CT_R_LOG_CONF_MISSING_KEY
 112

	)

67 
	#CT_R_LOG_KEY_INVALID
 113

	)

68 
	#CT_R_SCT_FUTURE_TIMESTAMP
 116

	)

69 
	#CT_R_SCT_INVALID
 104

	)

70 
	#CT_R_SCT_INVALID_SIGNATURE
 107

	)

71 
	#CT_R_SCT_LIST_INVALID
 105

	)

72 
	#CT_R_SCT_LOG_ID_MISMATCH
 114

	)

73 
	#CT_R_SCT_NOT_SET
 106

	)

74 
	#CT_R_SCT_UNSUPPORTED_VERSION
 115

	)

75 
	#CT_R_UNRECOGNIZED_SIGNATURE_NID
 101

	)

76 
	#CT_R_UNSUPPORTED_ENTRY_TYPE
 102

	)

77 
	#CT_R_UNSUPPORTED_VERSION
 103

	)

	@/usr/include/openssl/dh.h

10 #i‚de‡
HEADER_DH_H


11 
	#HEADER_DH_H


	)

13 
	~<›ís¶/›ís¶c⁄f.h
>

15 #i‚de‡
OPENSSL_NO_DH


16 
	~<›ís¶/e_os2.h
>

17 
	~<›ís¶/bio.h
>

18 
	~<›ís¶/a¢1.h
>

19 
	~<›ís¶/os¶_typ.h
>

20 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

21 
	~<›ís¶/bn.h
>

23 
	~<›ís¶/dhîr.h
>

25 #ifde‡ 
__˝lu•lus


29 #i‚de‡
OPENSSL_DH_MAX_MODULUS_BITS


30 
	#OPENSSL_DH_MAX_MODULUS_BITS
 10000

	)

33 
	#OPENSSL_DH_FIPS_MIN_MODULUS_BITS
 1024

	)

35 
	#DH_FLAG_CACHE_MONT_P
 0x01

	)

37 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

41 
	#DH_FLAG_NO_EXP_CONSTTIME
 0x00

	)

51 
	#DH_FLAG_FIPS_METHOD
 0x0400

	)

59 
	#DH_FLAG_NON_FIPS_ALLOW
 0x0400

	)

65 
DECLARE_ASN1_ITEM
(
DH∑øms
)

67 
	#DH_GENERATOR_2
 2

	)

69 
	#DH_GENERATOR_5
 5

	)

72 
	#DH_CHECK_P_NOT_PRIME
 0x01

	)

73 
	#DH_CHECK_P_NOT_SAFE_PRIME
 0x02

	)

74 
	#DH_UNABLE_TO_CHECK_GENERATOR
 0x04

	)

75 
	#DH_NOT_SUITABLE_GENERATOR
 0x08

	)

76 
	#DH_CHECK_Q_NOT_PRIME
 0x10

	)

77 
	#DH_CHECK_INVALID_Q_VALUE
 0x20

	)

78 
	#DH_CHECK_INVALID_J_VALUE
 0x40

	)

81 
	#DH_CHECK_PUBKEY_TOO_SMALL
 0x01

	)

82 
	#DH_CHECK_PUBKEY_TOO_LARGE
 0x02

	)

83 
	#DH_CHECK_PUBKEY_INVALID
 0x04

	)

89 
	#DH_CHECK_P_NOT_STRONG_PRIME
 
DH_CHECK_P_NOT_SAFE_PRIME


	)

91 
	#d2i_DH∑øms_Â
(
Â
,
x
) \

92 (
DH
 *)
	`ASN1_d2i_Â
((*(*)())
DH_√w
, \

93 (*(*)())
d2i_DH∑øms
, \

94 (
Â
), \

95 (**)(
x
))

	)

96 
	#i2d_DH∑øms_Â
(
Â
,
x
) \

97 
	`ASN1_i2d_Â
(
i2d_DH∑øms
,(
Â
), (*)(
x
))

	)

98 
	#d2i_DH∑øms_bio
(
bp
,
x
) \

99 
	`ASN1_d2i_bio_of
(
DH
, 
DH_√w
, 
d2i_DH∑øms
, 
bp
, 
x
)

	)

100 
	#i2d_DH∑øms_bio
(
bp
,
x
) \

101 
	`ASN1_i2d_bio_of_c⁄°
(
DH
,
i2d_DH∑øms
,
bp
,
x
)

	)

103 
	#d2i_DHx∑øms_Â
(
Â
,
x
) \

104 (
DH
 *)
	`ASN1_d2i_Â
((*(*)())
DH_√w
, \

105 (*(*)())
d2i_DHx∑øms
, \

106 (
Â
), \

107 (**)(
x
))

	)

108 
	#i2d_DHx∑øms_Â
(
Â
,
x
) \

109 
	`ASN1_i2d_Â
(
i2d_DHx∑øms
,(
Â
), (*)(
x
))

	)

110 
	#d2i_DHx∑øms_bio
(
bp
,
x
) \

111 
	`ASN1_d2i_bio_of
(
DH
, 
DH_√w
, 
d2i_DHx∑øms
, 
bp
, 
x
)

	)

112 
	#i2d_DHx∑øms_bio
(
bp
,
x
) \

113 
	`ASN1_i2d_bio_of_c⁄°
(
DH
, 
i2d_DHx∑øms
, 
bp
, 
x
)

	)

115 
DH
 *
DH∑øms_dup
(DH *);

117 c⁄° 
DH_METHOD
 *
DH_O≥nSSL
();

119 
DH_£t_deÁu…_mëhod
(c⁄° 
DH_METHOD
 *
mëh
);

120 c⁄° 
DH_METHOD
 *
DH_gë_deÁu…_mëhod
();

121 
DH_£t_mëhod
(
DH
 *
dh
, c⁄° 
DH_METHOD
 *
mëh
);

122 
DH
 *
DH_√w_mëhod
(
ENGINE
 *
ígöe
);

124 
DH
 *
DH_√w
();

125 
DH_‰ì
(
DH
 *
dh
);

126 
DH_up_ªf
(
DH
 *
dh
);

127 
DH_bôs
(c⁄° 
DH
 *
dh
);

128 
DH_size
(c⁄° 
DH
 *
dh
);

129 
DH_£curôy_bôs
(c⁄° 
DH
 *
dh
);

130 
	#DH_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

131 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_DH
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

132 
DH_£t_ex_d©a
(
DH
 *
d
, 
idx
, *
¨g
);

133 *
DH_gë_ex_d©a
(
DH
 *
d
, 
idx
);

136 
DEPRECATEDIN_0_9_8
(
DH
 *
DH_gíî©e_∑ømëîs
(
¥ime_Àn
, 
gíî©‹
,

137 (*
ˇŒback
) (, ,

139 *
cb_¨g
))

142 
DH_gíî©e_∑ømëîs_ex
(
DH
 *
dh
, 
¥ime_Àn
, 
gíî©‹
,

143 
BN_GENCB
 *
cb
);

145 
DH_check_∑øms_ex
(c⁄° 
DH
 *
dh
);

146 
DH_check_ex
(c⁄° 
DH
 *
dh
);

147 
DH_check_pub_key_ex
(c⁄° 
DH
 *
dh
, c⁄° 
BIGNUM
 *
pub_key
);

148 
DH_check_∑øms
(c⁄° 
DH
 *
dh
, *
ªt
);

149 
DH_check
(c⁄° 
DH
 *
dh
, *
codes
);

150 
DH_check_pub_key
(c⁄° 
DH
 *
dh
, c⁄° 
BIGNUM
 *
pub_key
, *
codes
);

151 
DH_gíî©e_key
(
DH
 *
dh
);

152 
DH_compuã_key
(*
key
, c⁄° 
BIGNUM
 *
pub_key
, 
DH
 *
dh
);

153 
DH_compuã_key_∑dded
(*
key
, c⁄° 
BIGNUM
 *
pub_key
, 
DH
 *
dh
);

154 
DH
 *
d2i_DH∑øms
(DH **
a
, c⁄° **
µ
, 
Àngth
);

155 
i2d_DH∑øms
(c⁄° 
DH
 *
a
, **
µ
);

156 
DH
 *
d2i_DHx∑øms
(DH **
a
, c⁄° **
µ
, 
Àngth
);

157 
i2d_DHx∑øms
(c⁄° 
DH
 *
a
, **
µ
);

158 #i‚de‡
OPENSSL_NO_STDIO


159 
DH∑øms_¥öt_Â
(
FILE
 *
Â
, c⁄° 
DH
 *
x
);

161 
DH∑øms_¥öt
(
BIO
 *
bp
, c⁄° 
DH
 *
x
);

164 
DH
 *
DH_gë_1024_160
();

165 
DH
 *
DH_gë_2048_224
();

166 
DH
 *
DH_gë_2048_256
();

169 
DH
 *
DH_√w_by_nid
(
nid
);

170 
DH_gë_nid
(c⁄° 
DH
 *
dh
);

172 #i‚de‡
OPENSSL_NO_CMS


174 
DH_KDF_X9_42
(*
out
, 
size_t
 
ouéí
,

175 c⁄° *
Z
, 
size_t
 
ZÀn
,

176 
ASN1_OBJECT
 *
key_oid
,

177 c⁄° *
ukm
, 
size_t
 
ukmÀn
, c⁄° 
EVP_MD
 *
md
);

180 
DH_gë0_pqg
(c⁄° 
DH
 *
dh
,

181 c⁄° 
BIGNUM
 **
p
, c⁄° BIGNUM **
q
, c⁄° BIGNUM **
g
);

182 
DH_£t0_pqg
(
DH
 *
dh
, 
BIGNUM
 *
p
, BIGNUM *
q
, BIGNUM *
g
);

183 
DH_gë0_key
(c⁄° 
DH
 *
dh
,

184 c⁄° 
BIGNUM
 **
pub_key
, c⁄° BIGNUM **
¥iv_key
);

185 
DH_£t0_key
(
DH
 *
dh
, 
BIGNUM
 *
pub_key
, BIGNUM *
¥iv_key
);

186 c⁄° 
BIGNUM
 *
DH_gë0_p
(c⁄° 
DH
 *
dh
);

187 c⁄° 
BIGNUM
 *
DH_gë0_q
(c⁄° 
DH
 *
dh
);

188 c⁄° 
BIGNUM
 *
DH_gë0_g
(c⁄° 
DH
 *
dh
);

189 c⁄° 
BIGNUM
 *
DH_gë0_¥iv_key
(c⁄° 
DH
 *
dh
);

190 c⁄° 
BIGNUM
 *
DH_gë0_pub_key
(c⁄° 
DH
 *
dh
);

191 
DH_˛ór_Êags
(
DH
 *
dh
, 
Êags
);

192 
DH_ã°_Êags
(c⁄° 
DH
 *
dh
, 
Êags
);

193 
DH_£t_Êags
(
DH
 *
dh
, 
Êags
);

194 
ENGINE
 *
DH_gë0_ígöe
(
DH
 *
d
);

195 
DH_gë_Àngth
(c⁄° 
DH
 *
dh
);

196 
DH_£t_Àngth
(
DH
 *
dh
, 
Àngth
);

198 
DH_METHOD
 *
DH_mëh_√w
(c⁄° *
«me
, 
Êags
);

199 
DH_mëh_‰ì
(
DH_METHOD
 *
dhm
);

200 
DH_METHOD
 *
DH_mëh_dup
(c⁄° DH_METHOD *
dhm
);

201 c⁄° *
DH_mëh_gë0_«me
(c⁄° 
DH_METHOD
 *
dhm
);

202 
DH_mëh_£t1_«me
(
DH_METHOD
 *
dhm
, c⁄° *
«me
);

203 
DH_mëh_gë_Êags
(c⁄° 
DH_METHOD
 *
dhm
);

204 
DH_mëh_£t_Êags
(
DH_METHOD
 *
dhm
, 
Êags
);

205 *
DH_mëh_gë0_≠p_d©a
(c⁄° 
DH_METHOD
 *
dhm
);

206 
DH_mëh_£t0_≠p_d©a
(
DH_METHOD
 *
dhm
, *
≠p_d©a
);

207 (*
DH_mëh_gë_gíî©e_key
(c⁄° 
DH_METHOD
 *
dhm
)Ë(
DH
 *);

208 
DH_mëh_£t_gíî©e_key
(
DH_METHOD
 *
dhm
, (*
gíî©e_key
Ë(
DH
 *));

209 (*
DH_mëh_gë_compuã_key
(c⁄° 
DH_METHOD
 *
dhm
))

210 (*
key
, c⁄° 
BIGNUM
 *
pub_key
, 
DH
 *
dh
);

211 
DH_mëh_£t_compuã_key
(
DH_METHOD
 *
dhm
,

212 (*
compuã_key
Ë(*
key
, c⁄° 
BIGNUM
 *
pub_key
, 
DH
 *
dh
));

213 (*
DH_mëh_gë_bn_mod_exp
(c⁄° 
DH_METHOD
 *
dhm
))

214 (c⁄° 
DH
 *, 
BIGNUM
 *, const BIGNUM *, const BIGNUM *, const BIGNUM *,

215 
BN_CTX
 *, 
BN_MONT_CTX
 *);

216 
DH_mëh_£t_bn_mod_exp
(
DH_METHOD
 *
dhm
,

217 (*
bn_mod_exp
Ë(c⁄° 
DH
 *, 
BIGNUM
 *, const BIGNUM *, const BIGNUM *,

218 c⁄° 
BIGNUM
 *, 
BN_CTX
 *, 
BN_MONT_CTX
 *));

219 (*
DH_mëh_gë_öô
(c⁄° 
DH_METHOD
 *
dhm
))(
DH
 *);

220 
DH_mëh_£t_öô
(
DH_METHOD
 *
dhm
, (*
öô
)(
DH
 *));

221 (*
DH_mëh_gë_föish
(c⁄° 
DH_METHOD
 *
dhm
)Ë(
DH
 *);

222 
DH_mëh_£t_föish
(
DH_METHOD
 *
dhm
, (*
föish
Ë(
DH
 *));

223 (*
DH_mëh_gë_gíî©e_∑øms
(c⁄° 
DH_METHOD
 *
dhm
))

224 (
DH
 *, , , 
BN_GENCB
 *);

225 
DH_mëh_£t_gíî©e_∑øms
(
DH_METHOD
 *
dhm
,

226 (*
gíî©e_∑øms
Ë(
DH
 *, , , 
BN_GENCB
 *));

229 
	#EVP_PKEY_CTX_£t_dh_∑ømgí_¥ime_Àn
(
˘x
, 
Àn
) \

230 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DH
, 
EVP_PKEY_OP_PARAMGEN
, \

231 
EVP_PKEY_CTRL_DH_PARAMGEN_PRIME_LEN
, 
Àn
, 
NULL
)

	)

233 
	#EVP_PKEY_CTX_£t_dh_∑ømgí_sub¥ime_Àn
(
˘x
, 
Àn
) \

234 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DH
, 
EVP_PKEY_OP_PARAMGEN
, \

235 
EVP_PKEY_CTRL_DH_PARAMGEN_SUBPRIME_LEN
, 
Àn
, 
NULL
)

	)

237 
	#EVP_PKEY_CTX_£t_dh_∑ømgí_ty≥
(
˘x
, 
typ
) \

238 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DH
, 
EVP_PKEY_OP_PARAMGEN
, \

239 
EVP_PKEY_CTRL_DH_PARAMGEN_TYPE
, 
typ
, 
NULL
)

	)

241 
	#EVP_PKEY_CTX_£t_dh_∑ømgí_gíî©‹
(
˘x
, 
gí
) \

242 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DH
, 
EVP_PKEY_OP_PARAMGEN
, \

243 
EVP_PKEY_CTRL_DH_PARAMGEN_GENERATOR
, 
gí
, 
NULL
)

	)

245 
	#EVP_PKEY_CTX_£t_dh_rfc5114
(
˘x
, 
gí
) \

246 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, 
EVP_PKEY_OP_PARAMGEN
, \

247 
EVP_PKEY_CTRL_DH_RFC5114
, 
gí
, 
NULL
)

	)

249 
	#EVP_PKEY_CTX_£t_dhx_rfc5114
(
˘x
, 
gí
) \

250 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, 
EVP_PKEY_OP_PARAMGEN
, \

251 
EVP_PKEY_CTRL_DH_RFC5114
, 
gí
, 
NULL
)

	)

253 
	#EVP_PKEY_CTX_£t_dh_nid
(
˘x
, 
nid
) \

254 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DH
, \

255 
EVP_PKEY_OP_PARAMGEN
 | 
EVP_PKEY_OP_KEYGEN
, \

256 
EVP_PKEY_CTRL_DH_NID
, 
nid
, 
NULL
)

	)

258 
	#EVP_PKEY_CTX_£t_dh_∑d
(
˘x
, 
∑d
) \

259 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DH
, 
EVP_PKEY_OP_DERIVE
, \

260 
EVP_PKEY_CTRL_DH_PAD
, 
∑d
, 
NULL
)

	)

262 
	#EVP_PKEY_CTX_£t_dh_kdf_ty≥
(
˘x
, 
kdf
) \

263 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

264 
EVP_PKEY_OP_DERIVE
, \

265 
EVP_PKEY_CTRL_DH_KDF_TYPE
, 
kdf
, 
NULL
)

	)

267 
	#EVP_PKEY_CTX_gë_dh_kdf_ty≥
(
˘x
) \

268 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

269 
EVP_PKEY_OP_DERIVE
, \

270 
EVP_PKEY_CTRL_DH_KDF_TYPE
, -2, 
NULL
)

	)

272 
	#EVP_PKEY_CTX_£t0_dh_kdf_oid
(
˘x
, 
oid
) \

273 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

274 
EVP_PKEY_OP_DERIVE
, \

275 
EVP_PKEY_CTRL_DH_KDF_OID
, 0, (*)(
oid
))

	)

277 
	#EVP_PKEY_CTX_gë0_dh_kdf_oid
(
˘x
, 
poid
) \

278 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

279 
EVP_PKEY_OP_DERIVE
, \

280 
EVP_PKEY_CTRL_GET_DH_KDF_OID
, 0, (*)(
poid
))

	)

282 
	#EVP_PKEY_CTX_£t_dh_kdf_md
(
˘x
, 
md
) \

283 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

284 
EVP_PKEY_OP_DERIVE
, \

285 
EVP_PKEY_CTRL_DH_KDF_MD
, 0, (*)(
md
))

	)

287 
	#EVP_PKEY_CTX_gë_dh_kdf_md
(
˘x
, 
pmd
) \

288 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

289 
EVP_PKEY_OP_DERIVE
, \

290 
EVP_PKEY_CTRL_GET_DH_KDF_MD
, 0, (*)(
pmd
))

	)

292 
	#EVP_PKEY_CTX_£t_dh_kdf_ouéí
(
˘x
, 
Àn
) \

293 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

294 
EVP_PKEY_OP_DERIVE
, \

295 
EVP_PKEY_CTRL_DH_KDF_OUTLEN
, 
Àn
, 
NULL
)

	)

297 
	#EVP_PKEY_CTX_gë_dh_kdf_ouéí
(
˘x
, 
∂í
) \

298 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

299 
EVP_PKEY_OP_DERIVE
, \

300 
EVP_PKEY_CTRL_GET_DH_KDF_OUTLEN
, 0, (*)(
∂í
))

	)

302 
	#EVP_PKEY_CTX_£t0_dh_kdf_ukm
(
˘x
, 
p
, 
∂í
) \

303 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

304 
EVP_PKEY_OP_DERIVE
, \

305 
EVP_PKEY_CTRL_DH_KDF_UKM
, 
∂í
, (*)(
p
))

	)

307 
	#EVP_PKEY_CTX_gë0_dh_kdf_ukm
(
˘x
, 
p
) \

308 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DHX
, \

309 
EVP_PKEY_OP_DERIVE
, \

310 
EVP_PKEY_CTRL_GET_DH_KDF_UKM
, 0, (*)(
p
))

	)

312 
	#EVP_PKEY_CTRL_DH_PARAMGEN_PRIME_LEN
 (
EVP_PKEY_ALG_CTRL
 + 1)

	)

313 
	#EVP_PKEY_CTRL_DH_PARAMGEN_GENERATOR
 (
EVP_PKEY_ALG_CTRL
 + 2)

	)

314 
	#EVP_PKEY_CTRL_DH_RFC5114
 (
EVP_PKEY_ALG_CTRL
 + 3)

	)

315 
	#EVP_PKEY_CTRL_DH_PARAMGEN_SUBPRIME_LEN
 (
EVP_PKEY_ALG_CTRL
 + 4)

	)

316 
	#EVP_PKEY_CTRL_DH_PARAMGEN_TYPE
 (
EVP_PKEY_ALG_CTRL
 + 5)

	)

317 
	#EVP_PKEY_CTRL_DH_KDF_TYPE
 (
EVP_PKEY_ALG_CTRL
 + 6)

	)

318 
	#EVP_PKEY_CTRL_DH_KDF_MD
 (
EVP_PKEY_ALG_CTRL
 + 7)

	)

319 
	#EVP_PKEY_CTRL_GET_DH_KDF_MD
 (
EVP_PKEY_ALG_CTRL
 + 8)

	)

320 
	#EVP_PKEY_CTRL_DH_KDF_OUTLEN
 (
EVP_PKEY_ALG_CTRL
 + 9)

	)

321 
	#EVP_PKEY_CTRL_GET_DH_KDF_OUTLEN
 (
EVP_PKEY_ALG_CTRL
 + 10)

	)

322 
	#EVP_PKEY_CTRL_DH_KDF_UKM
 (
EVP_PKEY_ALG_CTRL
 + 11)

	)

323 
	#EVP_PKEY_CTRL_GET_DH_KDF_UKM
 (
EVP_PKEY_ALG_CTRL
 + 12)

	)

324 
	#EVP_PKEY_CTRL_DH_KDF_OID
 (
EVP_PKEY_ALG_CTRL
 + 13)

	)

325 
	#EVP_PKEY_CTRL_GET_DH_KDF_OID
 (
EVP_PKEY_ALG_CTRL
 + 14)

	)

326 
	#EVP_PKEY_CTRL_DH_NID
 (
EVP_PKEY_ALG_CTRL
 + 15)

	)

327 
	#EVP_PKEY_CTRL_DH_PAD
 (
EVP_PKEY_ALG_CTRL
 + 16)

	)

330 
	#EVP_PKEY_DH_KDF_NONE
 1

	)

331 #i‚de‡
OPENSSL_NO_CMS


332 
	#EVP_PKEY_DH_KDF_X9_42
 2

	)

336 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/dsa.h

10 #i‚de‡
HEADER_DSA_H


11 
	#HEADER_DSA_H


	)

13 
	~<›ís¶/›ís¶c⁄f.h
>

15 #i‚de‡
OPENSSL_NO_DSA


16 #ifde‡ 
__˝lu•lus


19 
	~<›ís¶/e_os2.h
>

20 
	~<›ís¶/bio.h
>

21 
	~<›ís¶/¸y±o.h
>

22 
	~<›ís¶/os¶_typ.h
>

23 
	~<›ís¶/bn.h
>

24 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

25 
	~<›ís¶/dh.h
>

27 
	~<›ís¶/dßîr.h
>

29 #i‚de‡
OPENSSL_DSA_MAX_MODULUS_BITS


30 
	#OPENSSL_DSA_MAX_MODULUS_BITS
 10000

	)

33 
	#OPENSSL_DSA_FIPS_MIN_MODULUS_BITS
 1024

	)

35 
	#DSA_FLAG_CACHE_MONT_P
 0x01

	)

36 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

40 
	#DSA_FLAG_NO_EXP_CONSTTIME
 0x00

	)

50 
	#DSA_FLAG_FIPS_METHOD
 0x0400

	)

58 
	#DSA_FLAG_NON_FIPS_ALLOW
 0x0400

	)

59 
	#DSA_FLAG_FIPS_CHECKED
 0x0800

	)

65 
DSA_SIG_°
 
	tDSA_SIG
;

67 
	#d2i_DSA∑øms_Â
(
Â
,
x
Ë(
DSA
 *)
	`ASN1_d2i_Â
((*(*)())
DSA_√w
, \

68 (*(*)())
d2i_DSA∑øms
,(
Â
),(**)(
x
))

	)

69 
	#i2d_DSA∑øms_Â
(
Â
,
x
Ë
	`ASN1_i2d_Â
(
i2d_DSA∑øms
,(fp), \

70 (*)(
x
))

	)

71 
	#d2i_DSA∑øms_bio
(
bp
,
x
Ë
	`ASN1_d2i_bio_of
(
DSA
,
DSA_√w
,
d2i_DSA∑øms
,bp,x)

	)

72 
	#i2d_DSA∑øms_bio
(
bp
,
x
Ë
	`ASN1_i2d_bio_of_c⁄°
(
DSA
,
i2d_DSA∑øms
,bp,x)

	)

74 
DSA
 *
DSA∑øms_dup
(DSA *
x
);

75 
DSA_SIG
 *
DSA_SIG_√w
();

76 
DSA_SIG_‰ì
(
DSA_SIG
 *
a
);

77 
i2d_DSA_SIG
(c⁄° 
DSA_SIG
 *
a
, **
µ
);

78 
DSA_SIG
 *
d2i_DSA_SIG
(DSA_SIG **
v
, c⁄° **
µ
, 
Àngth
);

79 
DSA_SIG_gë0
(c⁄° 
DSA_SIG
 *
sig
, c⁄° 
BIGNUM
 **
¥
, c⁄° BIGNUM **
ps
);

80 
DSA_SIG_£t0
(
DSA_SIG
 *
sig
, 
BIGNUM
 *
r
, BIGNUM *
s
);

82 
DSA_SIG
 *
DSA_do_sign
(c⁄° *
dg°
, 
dÀn
, 
DSA
 *
dß
);

83 
DSA_do_vîify
(c⁄° *
dg°
, 
dg°_Àn
,

84 
DSA_SIG
 *
sig
, 
DSA
 *
dß
);

86 c⁄° 
DSA_METHOD
 *
DSA_O≥nSSL
();

88 
DSA_£t_deÁu…_mëhod
(c⁄° 
DSA_METHOD
 *);

89 c⁄° 
DSA_METHOD
 *
DSA_gë_deÁu…_mëhod
();

90 
DSA_£t_mëhod
(
DSA
 *
dß
, c⁄° 
DSA_METHOD
 *);

91 c⁄° 
DSA_METHOD
 *
DSA_gë_mëhod
(
DSA
 *
d
);

93 
DSA
 *
DSA_√w
();

94 
DSA
 *
DSA_√w_mëhod
(
ENGINE
 *
ígöe
);

95 
DSA_‰ì
(
DSA
 *
r
);

97 
DSA_up_ªf
(
DSA
 *
r
);

98 
DSA_size
(c⁄° 
DSA
 *);

99 
DSA_bôs
(c⁄° 
DSA
 *
d
);

100 
DSA_£curôy_bôs
(c⁄° 
DSA
 *
d
);

102 
DEPRECATEDIN_1_2_0
(
DSA_sign_£tup
(
DSA
 *
dß
, 
BN_CTX
 *
˘x_ö
, 
BIGNUM
 **
kövp
, BIGNUM **
Ω
))

103 
DSA_sign
(
ty≥
, c⁄° *
dg°
, 
dÀn
,

104 *
sig
, *
sigÀn
, 
DSA
 *
dß
);

105 
DSA_vîify
(
ty≥
, c⁄° *
dg°
, 
dg°_Àn
,

106 c⁄° *
sigbuf
, 
sigÀn
, 
DSA
 *
dß
);

107 
	#DSA_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

108 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_DSA
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

109 
DSA_£t_ex_d©a
(
DSA
 *
d
, 
idx
, *
¨g
);

110 *
DSA_gë_ex_d©a
(
DSA
 *
d
, 
idx
);

112 
DSA
 *
d2i_DSAPublicKey
(DSA **
a
, c⁄° **
µ
, 
Àngth
);

113 
DSA
 *
d2i_DSAPriv©eKey
(DSA **
a
, c⁄° **
µ
, 
Àngth
);

114 
DSA
 *
d2i_DSA∑øms
(DSA **
a
, c⁄° **
µ
, 
Àngth
);

117 
DEPRECATEDIN_0_9_8
(
DSA
 *
DSA_gíî©e_∑ømëîs
(
bôs
,

118 *
£ed
,

119 
£ed_Àn
,

120 *
cou¡î_ªt
,

121 *
h_ªt
, 

122 (*
ˇŒback
) (, ,

124 *
cb_¨g
))

127 
DSA_gíî©e_∑ømëîs_ex
(
DSA
 *
dß
, 
bôs
,

128 c⁄° *
£ed
, 
£ed_Àn
,

129 *
cou¡î_ªt
, *
h_ªt
,

130 
BN_GENCB
 *
cb
);

132 
DSA_gíî©e_key
(
DSA
 *
a
);

133 
i2d_DSAPublicKey
(c⁄° 
DSA
 *
a
, **
µ
);

134 
i2d_DSAPriv©eKey
(c⁄° 
DSA
 *
a
, **
µ
);

135 
i2d_DSA∑øms
(c⁄° 
DSA
 *
a
, **
µ
);

137 
DSA∑øms_¥öt
(
BIO
 *
bp
, c⁄° 
DSA
 *
x
);

138 
DSA_¥öt
(
BIO
 *
bp
, c⁄° 
DSA
 *
x
, 
off
);

139 #i‚de‡
OPENSSL_NO_STDIO


140 
DSA∑øms_¥öt_Â
(
FILE
 *
Â
, c⁄° 
DSA
 *
x
);

141 
DSA_¥öt_Â
(
FILE
 *
bp
, c⁄° 
DSA
 *
x
, 
off
);

144 
	#DSS_¥ime_checks
 64

	)

151 
	#DSA_is_¥ime
(
n
, 
ˇŒback
, 
cb_¨g
) \

152 
	`BN_is_¥ime
(
n
, 
DSS_¥ime_checks
, 
ˇŒback
, 
NULL
, 
cb_¨g
)

	)

154 #i‚de‡
OPENSSL_NO_DH


159 
DH
 *
DSA_dup_DH
(c⁄° 
DSA
 *
r
);

162 
	#EVP_PKEY_CTX_£t_dß_∑ømgí_bôs
(
˘x
, 
nbôs
) \

163 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_DSA
, 
EVP_PKEY_OP_PARAMGEN
, \

164 
EVP_PKEY_CTRL_DSA_PARAMGEN_BITS
, 
nbôs
, 
NULL
)

	)

166 
	#EVP_PKEY_CTRL_DSA_PARAMGEN_BITS
 (
EVP_PKEY_ALG_CTRL
 + 1)

	)

167 
	#EVP_PKEY_CTRL_DSA_PARAMGEN_Q_BITS
 (
EVP_PKEY_ALG_CTRL
 + 2)

	)

168 
	#EVP_PKEY_CTRL_DSA_PARAMGEN_MD
 (
EVP_PKEY_ALG_CTRL
 + 3)

	)

170 
DSA_gë0_pqg
(c⁄° 
DSA
 *
d
,

171 c⁄° 
BIGNUM
 **
p
, c⁄° BIGNUM **
q
, c⁄° BIGNUM **
g
);

172 
DSA_£t0_pqg
(
DSA
 *
d
, 
BIGNUM
 *
p
, BIGNUM *
q
, BIGNUM *
g
);

173 
DSA_gë0_key
(c⁄° 
DSA
 *
d
,

174 c⁄° 
BIGNUM
 **
pub_key
, c⁄° BIGNUM **
¥iv_key
);

175 
DSA_£t0_key
(
DSA
 *
d
, 
BIGNUM
 *
pub_key
, BIGNUM *
¥iv_key
);

176 c⁄° 
BIGNUM
 *
DSA_gë0_p
(c⁄° 
DSA
 *
d
);

177 c⁄° 
BIGNUM
 *
DSA_gë0_q
(c⁄° 
DSA
 *
d
);

178 c⁄° 
BIGNUM
 *
DSA_gë0_g
(c⁄° 
DSA
 *
d
);

179 c⁄° 
BIGNUM
 *
DSA_gë0_pub_key
(c⁄° 
DSA
 *
d
);

180 c⁄° 
BIGNUM
 *
DSA_gë0_¥iv_key
(c⁄° 
DSA
 *
d
);

181 
DSA_˛ór_Êags
(
DSA
 *
d
, 
Êags
);

182 
DSA_ã°_Êags
(c⁄° 
DSA
 *
d
, 
Êags
);

183 
DSA_£t_Êags
(
DSA
 *
d
, 
Êags
);

184 
ENGINE
 *
DSA_gë0_ígöe
(
DSA
 *
d
);

186 
DSA_METHOD
 *
DSA_mëh_√w
(c⁄° *
«me
, 
Êags
);

187 
DSA_mëh_‰ì
(
DSA_METHOD
 *
dßm
);

188 
DSA_METHOD
 *
DSA_mëh_dup
(c⁄° DSA_METHOD *
dßm
);

189 c⁄° *
DSA_mëh_gë0_«me
(c⁄° 
DSA_METHOD
 *
dßm
);

190 
DSA_mëh_£t1_«me
(
DSA_METHOD
 *
dßm
, c⁄° *
«me
);

191 
DSA_mëh_gë_Êags
(c⁄° 
DSA_METHOD
 *
dßm
);

192 
DSA_mëh_£t_Êags
(
DSA_METHOD
 *
dßm
, 
Êags
);

193 *
DSA_mëh_gë0_≠p_d©a
(c⁄° 
DSA_METHOD
 *
dßm
);

194 
DSA_mëh_£t0_≠p_d©a
(
DSA_METHOD
 *
dßm
, *
≠p_d©a
);

195 
DSA_SIG
 *(*
DSA_mëh_gë_sign
(c⁄° 
DSA_METHOD
 *
dßm
))

196 (c⁄° *, , 
DSA
 *);

197 
DSA_mëh_£t_sign
(
DSA_METHOD
 *
dßm
,

198 
DSA_SIG
 *(*
sign
Ë(c⁄° *, , 
DSA
 *));

199 (*
DSA_mëh_gë_sign_£tup
(c⁄° 
DSA_METHOD
 *
dßm
))

200 (
DSA
 *, 
BN_CTX
 *, 
BIGNUM
 **, BIGNUM **);

201 
DSA_mëh_£t_sign_£tup
(
DSA_METHOD
 *
dßm
,

202 (*
sign_£tup
Ë(
DSA
 *, 
BN_CTX
 *, 
BIGNUM
 **, BIGNUM **));

203 (*
DSA_mëh_gë_vîify
(c⁄° 
DSA_METHOD
 *
dßm
))

204 (c⁄° *, , 
DSA_SIG
 *, 
DSA
 *);

205 
DSA_mëh_£t_vîify
(
DSA_METHOD
 *
dßm
,

206 (*
vîify
Ë(c⁄° *, , 
DSA_SIG
 *, 
DSA
 *));

207 (*
DSA_mëh_gë_mod_exp
(c⁄° 
DSA_METHOD
 *
dßm
))

208 (
DSA
 *, 
BIGNUM
 *, const BIGNUM *, const BIGNUM *, const BIGNUM *,

209 c⁄° 
BIGNUM
 *, c⁄° BIGNUM *, 
BN_CTX
 *, 
BN_MONT_CTX
 *);

210 
DSA_mëh_£t_mod_exp
(
DSA_METHOD
 *
dßm
,

211 (*
mod_exp
Ë(
DSA
 *, 
BIGNUM
 *, const BIGNUM *, const BIGNUM *,

212 c⁄° 
BIGNUM
 *, c⁄° BIGNUM *, c⁄° BIGNUM *, 
BN_CTX
 *,

213 
BN_MONT_CTX
 *));

214 (*
DSA_mëh_gë_bn_mod_exp
(c⁄° 
DSA_METHOD
 *
dßm
))

215 (
DSA
 *, 
BIGNUM
 *, const BIGNUM *, const BIGNUM *, const BIGNUM *,

216 
BN_CTX
 *, 
BN_MONT_CTX
 *);

217 
DSA_mëh_£t_bn_mod_exp
(
DSA_METHOD
 *
dßm
,

218 (*
bn_mod_exp
Ë(
DSA
 *, 
BIGNUM
 *, const BIGNUM *, const BIGNUM *,

219 c⁄° 
BIGNUM
 *, 
BN_CTX
 *, 
BN_MONT_CTX
 *));

220 (*
DSA_mëh_gë_öô
(c⁄° 
DSA_METHOD
 *
dßm
))(
DSA
 *);

221 
DSA_mëh_£t_öô
(
DSA_METHOD
 *
dßm
, (*
öô
)(
DSA
 *));

222 (*
DSA_mëh_gë_föish
(c⁄° 
DSA_METHOD
 *
dßm
)Ë(
DSA
 *);

223 
DSA_mëh_£t_föish
(
DSA_METHOD
 *
dßm
, (*
föish
Ë(
DSA
 *));

224 (*
DSA_mëh_gë_∑ømgí
(c⁄° 
DSA_METHOD
 *
dßm
))

225 (
DSA
 *, , const *, , *, *,

226 
BN_GENCB
 *);

227 
DSA_mëh_£t_∑ømgí
(
DSA_METHOD
 *
dßm
,

228 (*
∑ømgí
Ë(
DSA
 *, , const *, , *,

229 *, 
BN_GENCB
 *));

230 (*
DSA_mëh_gë_keygí
(c⁄° 
DSA_METHOD
 *
dßm
)Ë(
DSA
 *);

231 
DSA_mëh_£t_keygí
(
DSA_METHOD
 *
dßm
, (*
keygí
Ë(
DSA
 *));

234 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/ebcdic.h

10 #i‚de‡
HEADER_EBCDIC_H


11 
	#HEADER_EBCDIC_H


	)

13 
	~<°dlib.h
>

15 #ifde‡ 
__˝lu•lus


20 
	#os_tﬂscii
 
_›ís¶_os_tﬂscii


	)

21 
	#os_t€bcdic
 
_›ís¶_os_t€bcdic


	)

22 
	#ebcdic2ascii
 
_›ís¶_ebcdic2ascii


	)

23 
	#ascii2ebcdic
 
_›ís¶_ascii2ebcdic


	)

25 c⁄° 
os_tﬂscii
[256];

26 c⁄° 
os_t€bcdic
[256];

27 *
ebcdic2ascii
(*
de°
, c⁄° *
§˚
, 
size_t
 
cou¡
);

28 *
ascii2ebcdic
(*
de°
, c⁄° *
§˚
, 
size_t
 
cou¡
);

30 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/ec.h

11 #i‚de‡
HEADER_EC_H


12 
	#HEADER_EC_H


	)

14 
	~<›ís¶/›ís¶c⁄f.h
>

16 #i‚de‡
OPENSSL_NO_EC


17 
	~<›ís¶/a¢1.h
>

18 
	~<›ís¶/symhacks.h
>

19 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

20 
	~<›ís¶/bn.h
>

22 
	~<›ís¶/e˚º.h
>

23 #ifde‡ 
__˝lu•lus


27 #i‚de‡
OPENSSL_ECC_MAX_FIELD_BITS


28 
	#OPENSSL_ECC_MAX_FIELD_BITS
 661

	)

36 
POINT_CONVERSION_COMPRESSED
 = 2,

38 
POINT_CONVERSION_UNCOMPRESSED
 = 4,

41 
POINT_CONVERSION_HYBRID
 = 6

42 } 
	tpoöt_c⁄vîsi⁄_f‹m_t
;

44 
ec_mëhod_°
 
	tEC_METHOD
;

45 
ec_group_°
 
	tEC_GROUP
;

46 
ec_poöt_°
 
	tEC_POINT
;

47 
e˝k_∑ømëîs_°
 
	tECPKPARAMETERS
;

48 
ec_∑ømëîs_°
 
	tECPARAMETERS
;

58 c⁄° 
EC_METHOD
 *
EC_GFp_sim∂e_mëhod
();

63 c⁄° 
EC_METHOD
 *
EC_GFp_m⁄t_mëhod
();

68 c⁄° 
EC_METHOD
 *
EC_GFp_ni°_mëhod
();

70 #i‚de‡
OPENSSL_NO_EC_NISTP_64_GCC_128


74 c⁄° 
EC_METHOD
 *
EC_GFp_ni°p224_mëhod
();

79 c⁄° 
EC_METHOD
 *
EC_GFp_ni°p256_mëhod
();

84 c⁄° 
EC_METHOD
 *
EC_GFp_ni°p521_mëhod
();

87 #i‚de‡
OPENSSL_NO_EC2M


95 c⁄° 
EC_METHOD
 *
EC_GF2m_sim∂e_mëhod
();

107 
EC_GROUP
 *
EC_GROUP_√w
(c⁄° 
EC_METHOD
 *
mëh
);

112 
EC_GROUP_‰ì
(
EC_GROUP
 *
group
);

117 
EC_GROUP_˛ór_‰ì
(
EC_GROUP
 *
group
);

124 
EC_GROUP_c›y
(
EC_GROUP
 *
d°
, c⁄° EC_GROUP *
§c
);

131 
EC_GROUP
 *
EC_GROUP_dup
(c⁄° EC_GROUP *
§c
);

137 c⁄° 
EC_METHOD
 *
EC_GROUP_mëhod_of
(c⁄° 
EC_GROUP
 *
group
);

143 
EC_METHOD_gë_fõld_ty≥
(c⁄° 
EC_METHOD
 *
mëh
);

153 
EC_GROUP_£t_gíî©‹
(
EC_GROUP
 *
group
, c⁄° 
EC_POINT
 *
gíî©‹
,

154 c⁄° 
BIGNUM
 *
‹dî
, c⁄° BIGNUM *
coÁ˘‹
);

160 c⁄° 
EC_POINT
 *
EC_GROUP_gë0_gíî©‹
(c⁄° 
EC_GROUP
 *
group
);

166 
BN_MONT_CTX
 *
EC_GROUP_gë_m⁄t_d©a
(c⁄° 
EC_GROUP
 *
group
);

174 
EC_GROUP_gë_‹dî
(c⁄° 
EC_GROUP
 *
group
, 
BIGNUM
 *
‹dî
, 
BN_CTX
 *
˘x
);

180 c⁄° 
BIGNUM
 *
EC_GROUP_gë0_‹dî
(c⁄° 
EC_GROUP
 *
group
);

186 
EC_GROUP_‹dî_bôs
(c⁄° 
EC_GROUP
 *
group
);

194 
EC_GROUP_gë_coÁ˘‹
(c⁄° 
EC_GROUP
 *
group
, 
BIGNUM
 *
coÁ˘‹
,

195 
BN_CTX
 *
˘x
);

201 c⁄° 
BIGNUM
 *
EC_GROUP_gë0_coÁ˘‹
(c⁄° 
EC_GROUP
 *
group
);

207 
EC_GROUP_£t_curve_«me
(
EC_GROUP
 *
group
, 
nid
);

213 
EC_GROUP_gë_curve_«me
(c⁄° 
EC_GROUP
 *
group
);

215 
EC_GROUP_£t_a¢1_Êag
(
EC_GROUP
 *
group
, 
Êag
);

216 
EC_GROUP_gë_a¢1_Êag
(c⁄° 
EC_GROUP
 *
group
);

218 
EC_GROUP_£t_poöt_c⁄vîsi⁄_f‹m
(
EC_GROUP
 *
group
,

219 
poöt_c⁄vîsi⁄_f‹m_t
 
f‹m
);

220 
poöt_c⁄vîsi⁄_f‹m_t
 
EC_GROUP_gë_poöt_c⁄vîsi⁄_f‹m
(c⁄° 
EC_GROUP
 *);

222 *
EC_GROUP_gë0_£ed
(c⁄° 
EC_GROUP
 *
x
);

223 
size_t
 
EC_GROUP_gë_£ed_Àn
(c⁄° 
EC_GROUP
 *);

224 
size_t
 
EC_GROUP_£t_£ed
(
EC_GROUP
 *, c⁄° *, size_à
Àn
);

236 
EC_GROUP_£t_curve
(
EC_GROUP
 *
group
, c⁄° 
BIGNUM
 *
p
, c⁄° BIGNUM *
a
,

237 c⁄° 
BIGNUM
 *
b
, 
BN_CTX
 *
˘x
);

249 
EC_GROUP_gë_curve
(c⁄° 
EC_GROUP
 *
group
, 
BIGNUM
 *
p
, BIGNUM *
a
, BIGNUM *
b
,

250 
BN_CTX
 *
˘x
);

261 
DEPRECATEDIN_1_2_0
(
EC_GROUP_£t_curve_GFp
(
EC_GROUP
 *
group
, c⁄° 
BIGNUM
 *
p
,

262 c⁄° 
BIGNUM
 *
a
, c⁄° BIGNUM *
b
,

263 
BN_CTX
 *
˘x
))

274 
DEPRECATEDIN_1_2_0
(
EC_GROUP_gë_curve_GFp
(c⁄° 
EC_GROUP
 *
group
, 
BIGNUM
 *
p
,

275 
BIGNUM
 *
a
, BIGNUM *
b
,

276 
BN_CTX
 *
˘x
))

278 #i‚de‡
OPENSSL_NO_EC2M


288 
DEPRECATEDIN_1_2_0
(
EC_GROUP_£t_curve_GF2m
(
EC_GROUP
 *
group
, c⁄° 
BIGNUM
 *
p
,

289 c⁄° 
BIGNUM
 *
a
, c⁄° BIGNUM *
b
,

290 
BN_CTX
 *
˘x
))

301 
DEPRECATEDIN_1_2_0
(
EC_GROUP_gë_curve_GF2m
(c⁄° 
EC_GROUP
 *
group
, 
BIGNUM
 *
p
,

302 
BIGNUM
 *
a
, BIGNUM *
b
,

303 
BN_CTX
 *
˘x
))

309 
EC_GROUP_gë_degªe
(c⁄° 
EC_GROUP
 *
group
);

316 
EC_GROUP_check
(c⁄° 
EC_GROUP
 *
group
, 
BN_CTX
 *
˘x
);

323 
EC_GROUP_check_dis¸imö™t
(c⁄° 
EC_GROUP
 *
group
, 
BN_CTX
 *
˘x
);

331 
EC_GROUP_cmp
(c⁄° 
EC_GROUP
 *
a
, c⁄° EC_GROUP *
b
, 
BN_CTX
 *
˘x
);

346 
EC_GROUP
 *
EC_GROUP_√w_curve_GFp
(c⁄° 
BIGNUM
 *
p
, c⁄° BIGNUM *
a
,

347 c⁄° 
BIGNUM
 *
b
, 
BN_CTX
 *
˘x
);

348 #i‚de‡
OPENSSL_NO_EC2M


357 
EC_GROUP
 *
EC_GROUP_√w_curve_GF2m
(c⁄° 
BIGNUM
 *
p
, c⁄° BIGNUM *
a
,

358 c⁄° 
BIGNUM
 *
b
, 
BN_CTX
 *
˘x
);

366 
EC_GROUP
 *
EC_GROUP_√w_by_curve_«me
(
nid
);

373 
EC_GROUP
 *
EC_GROUP_√w_‰om_e˝¨amëîs
(c⁄° 
ECPARAMETERS
 *
∑øms
);

381 
ECPARAMETERS
 *
EC_GROUP_gë_e˝¨amëîs
(c⁄° 
EC_GROUP
 *
group
,

382 
ECPARAMETERS
 *
∑øms
);

389 
EC_GROUP
 *
EC_GROUP_√w_‰om_e˝k∑ømëîs
(c⁄° 
ECPKPARAMETERS
 *
∑øms
);

397 
ECPKPARAMETERS
 *
EC_GROUP_gë_e˝k∑ømëîs
(c⁄° 
EC_GROUP
 *
group
,

398 
ECPKPARAMETERS
 *
∑øms
);

405 
nid
;

406 c⁄° *
commít
;

407 } 
	tEC_buûtö_curve
;

415 
size_t
 
EC_gë_buûtö_curves
(
EC_buûtö_curve
 *
r
, size_à
nôems
);

417 c⁄° *
EC_curve_nid2ni°
(
nid
);

418 
EC_curve_ni°2nid
(c⁄° *
«me
);

428 
EC_POINT
 *
EC_POINT_√w
(c⁄° 
EC_GROUP
 *
group
);

433 
EC_POINT_‰ì
(
EC_POINT
 *
poöt
);

438 
EC_POINT_˛ór_‰ì
(
EC_POINT
 *
poöt
);

445 
EC_POINT_c›y
(
EC_POINT
 *
d°
, c⁄° EC_POINT *
§c
);

453 
EC_POINT
 *
EC_POINT_dup
(c⁄° EC_POINT *
§c
, c⁄° 
EC_GROUP
 *
group
);

459 c⁄° 
EC_METHOD
 *
EC_POINT_mëhod_of
(c⁄° 
EC_POINT
 *
poöt
);

466 
EC_POINT_£t_to_öföôy
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
poöt
);

477 
EC_POINT_£t_J¥oje˘ive_co‹dö©es_GFp
(c⁄° 
EC_GROUP
 *
group
,

478 
EC_POINT
 *
p
, c⁄° 
BIGNUM
 *
x
,

479 c⁄° 
BIGNUM
 *
y
, c⁄° BIGNUM *
z
,

480 
BN_CTX
 *
˘x
);

491 
EC_POINT_gë_J¥oje˘ive_co‹dö©es_GFp
(c⁄° 
EC_GROUP
 *
group
,

492 c⁄° 
EC_POINT
 *
p
, 
BIGNUM
 *
x
,

493 
BIGNUM
 *
y
, BIGNUM *
z
,

494 
BN_CTX
 *
˘x
);

504 
EC_POINT_£t_afföe_co‹dö©es
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
p
,

505 c⁄° 
BIGNUM
 *
x
, c⁄° BIGNUM *
y
,

506 
BN_CTX
 *
˘x
);

516 
EC_POINT_gë_afföe_co‹dö©es
(c⁄° 
EC_GROUP
 *
group
, c⁄° 
EC_POINT
 *
p
,

517 
BIGNUM
 *
x
, BIGNUM *
y
, 
BN_CTX
 *
˘x
);

528 
DEPRECATEDIN_1_2_0
(
EC_POINT_£t_afföe_co‹dö©es_GFp
(c⁄° 
EC_GROUP
 *
group
,

529 
EC_POINT
 *
p
,

530 c⁄° 
BIGNUM
 *
x
,

531 c⁄° 
BIGNUM
 *
y
,

532 
BN_CTX
 *
˘x
))

543 
DEPRECATEDIN_1_2_0
(
EC_POINT_gë_afföe_co‹dö©es_GFp
(c⁄° 
EC_GROUP
 *
group
,

544 c⁄° 
EC_POINT
 *
p
,

545 
BIGNUM
 *
x
,

546 
BIGNUM
 *
y
,

547 
BN_CTX
 *
˘x
))

557 
EC_POINT_£t_com¥es£d_co‹dö©es
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
p
,

558 c⁄° 
BIGNUM
 *
x
, 
y_bô
,

559 
BN_CTX
 *
˘x
);

570 
DEPRECATEDIN_1_2_0
(
EC_POINT_£t_com¥es£d_co‹dö©es_GFp
(c⁄° 
EC_GROUP
 *
group
,

571 
EC_POINT
 *
p
,

572 c⁄° 
BIGNUM
 *
x
,

573 
y_bô
,

574 
BN_CTX
 *
˘x
))

575 #i‚de‡
OPENSSL_NO_EC2M


585 
DEPRECATEDIN_1_2_0
(
EC_POINT_£t_afföe_co‹dö©es_GF2m
(c⁄° 
EC_GROUP
 *
group
,

586 
EC_POINT
 *
p
,

587 c⁄° 
BIGNUM
 *
x
,

588 c⁄° 
BIGNUM
 *
y
,

589 
BN_CTX
 *
˘x
))

600 
DEPRECATEDIN_1_2_0
(
EC_POINT_gë_afföe_co‹dö©es_GF2m
(c⁄° 
EC_GROUP
 *
group
,

601 c⁄° 
EC_POINT
 *
p
,

602 
BIGNUM
 *
x
,

603 
BIGNUM
 *
y
,

604 
BN_CTX
 *
˘x
))

615 
DEPRECATEDIN_1_2_0
(
EC_POINT_£t_com¥es£d_co‹dö©es_GF2m
(c⁄° 
EC_GROUP
 *
group
,

616 
EC_POINT
 *
p
,

617 c⁄° 
BIGNUM
 *
x
,

618 
y_bô
,

619 
BN_CTX
 *
˘x
))

631 
size_t
 
EC_POINT_poöt2o˘
(c⁄° 
EC_GROUP
 *
group
, c⁄° 
EC_POINT
 *
p
,

632 
poöt_c⁄vîsi⁄_f‹m_t
 
f‹m
,

633 *
buf
, 
size_t
 
Àn
, 
BN_CTX
 *
˘x
);

643 
EC_POINT_o˘2poöt
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
p
,

644 c⁄° *
buf
, 
size_t
 
Àn
, 
BN_CTX
 *
˘x
);

654 
size_t
 
EC_POINT_poöt2buf
(c⁄° 
EC_GROUP
 *
group
, c⁄° 
EC_POINT
 *
poöt
,

655 
poöt_c⁄vîsi⁄_f‹m_t
 
f‹m
,

656 **
pbuf
, 
BN_CTX
 *
˘x
);

659 
BIGNUM
 *
EC_POINT_poöt2bn
(c⁄° 
EC_GROUP
 *, c⁄° 
EC_POINT
 *,

660 
poöt_c⁄vîsi⁄_f‹m_t
 
f‹m
, 
BIGNUM
 *, 
BN_CTX
 *);

661 
EC_POINT
 *
EC_POINT_bn2poöt
(c⁄° 
EC_GROUP
 *, c⁄° 
BIGNUM
 *,

662 
EC_POINT
 *, 
BN_CTX
 *);

663 *
EC_POINT_poöt2hex
(c⁄° 
EC_GROUP
 *, c⁄° 
EC_POINT
 *,

664 
poöt_c⁄vîsi⁄_f‹m_t
 
f‹m
, 
BN_CTX
 *);

665 
EC_POINT
 *
EC_POINT_hex2poöt
(c⁄° 
EC_GROUP
 *, const *,

666 
EC_POINT
 *, 
BN_CTX
 *);

680 
EC_POINT_add
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
r
, c⁄° EC_POINT *
a
,

681 c⁄° 
EC_POINT
 *
b
, 
BN_CTX
 *
˘x
);

690 
EC_POINT_dbl
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
r
, c⁄° EC_POINT *
a
,

691 
BN_CTX
 *
˘x
);

699 
EC_POINT_övît
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
a
, 
BN_CTX
 *
˘x
);

706 
EC_POINT_is_©_öföôy
(c⁄° 
EC_GROUP
 *
group
, c⁄° 
EC_POINT
 *
p
);

714 
EC_POINT_is_⁄_curve
(c⁄° 
EC_GROUP
 *
group
, c⁄° 
EC_POINT
 *
poöt
,

715 
BN_CTX
 *
˘x
);

724 
EC_POINT_cmp
(c⁄° 
EC_GROUP
 *
group
, c⁄° 
EC_POINT
 *
a
, c⁄° EC_POINT *
b
,

725 
BN_CTX
 *
˘x
);

727 
EC_POINT_make_afföe
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
poöt
, 
BN_CTX
 *
˘x
);

728 
EC_POINTs_make_afföe
(c⁄° 
EC_GROUP
 *
group
, 
size_t
 
num
,

729 
EC_POINT
 *
poöts
[], 
BN_CTX
 *
˘x
);

741 
EC_POINTs_mul
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
r
, c⁄° 
BIGNUM
 *
n
,

742 
size_t
 
num
, c⁄° 
EC_POINT
 *
p
[], c⁄° 
BIGNUM
 *
m
[],

743 
BN_CTX
 *
˘x
);

754 
EC_POINT_mul
(c⁄° 
EC_GROUP
 *
group
, 
EC_POINT
 *
r
, c⁄° 
BIGNUM
 *
n
,

755 c⁄° 
EC_POINT
 *
q
, c⁄° 
BIGNUM
 *
m
, 
BN_CTX
 *
˘x
);

762 
EC_GROUP_¥ecompuã_mu…
(
EC_GROUP
 *
group
, 
BN_CTX
 *
˘x
);

768 
EC_GROUP_have_¥ecompuã_mu…
(c⁄° 
EC_GROUP
 *
group
);

774 
DECLARE_ASN1_ITEM
(
ECPKPARAMETERS
)

775 
DECLARE_ASN1_ALLOC_FUNCTIONS
(
ECPKPARAMETERS
)

776 
DECLARE_ASN1_ITEM
(
ECPARAMETERS
)

777 
DECLARE_ASN1_ALLOC_FUNCTIONS
(
ECPARAMETERS
)

783 
EC_GROUP_gë_basis_ty≥
(c⁄° 
EC_GROUP
 *);

784 #i‚de‡
OPENSSL_NO_EC2M


785 
EC_GROUP_gë_åöomül_basis
(c⁄° 
EC_GROUP
 *, *
k
);

786 
EC_GROUP_gë_≥¡™omül_basis
(c⁄° 
EC_GROUP
 *, *
k1
,

787 *
k2
, *
k3
);

790 
	#OPENSSL_EC_EXPLICIT_CURVE
 0x000

	)

791 
	#OPENSSL_EC_NAMED_CURVE
 0x001

	)

793 
EC_GROUP
 *
d2i_ECPKP¨amëîs
(EC_GROUP **, c⁄° **
ö
, 
Àn
);

794 
i2d_ECPKP¨amëîs
(c⁄° 
EC_GROUP
 *, **
out
);

796 
	#d2i_ECPKP¨amëîs_bio
(
bp
,
x
Ë
	`ASN1_d2i_bio_of
(
EC_GROUP
,
NULL
,
d2i_ECPKP¨amëîs
,bp,x)

	)

797 
	#i2d_ECPKP¨amëîs_bio
(
bp
,
x
Ë
	`ASN1_i2d_bio_of_c⁄°
(
EC_GROUP
,
i2d_ECPKP¨amëîs
,bp,x)

	)

798 
	#d2i_ECPKP¨amëîs_Â
(
Â
,
x
Ë(
EC_GROUP
 *)
	`ASN1_d2i_Â
(
NULL
, \

799 (*(*)())
d2i_ECPKP¨amëîs
,(
Â
),(**)(
x
))

	)

800 
	#i2d_ECPKP¨amëîs_Â
(
Â
,
x
Ë
	`ASN1_i2d_Â
(
i2d_ECPKP¨amëîs
,(fp), \

801 (*)(
x
))

	)

803 
ECPKP¨amëîs_¥öt
(
BIO
 *
bp
, c⁄° 
EC_GROUP
 *
x
, 
off
);

804 #i‚de‡
OPENSSL_NO_STDIO


805 
ECPKP¨amëîs_¥öt_Â
(
FILE
 *
Â
, c⁄° 
EC_GROUP
 *
x
, 
off
);

813 
	#EC_PKEY_NO_PARAMETERS
 0x001

	)

814 
	#EC_PKEY_NO_PUBKEY
 0x002

	)

817 
	#EC_FLAG_NON_FIPS_ALLOW
 0x1

	)

818 
	#EC_FLAG_FIPS_CHECKED
 0x2

	)

819 
	#EC_FLAG_COFACTOR_ECDH
 0x1000

	)

824 
EC_KEY
 *
EC_KEY_√w
();

826 
EC_KEY_gë_Êags
(c⁄° 
EC_KEY
 *
key
);

828 
EC_KEY_£t_Êags
(
EC_KEY
 *
key
, 
Êags
);

830 
EC_KEY_˛ór_Êags
(
EC_KEY
 *
key
, 
Êags
);

837 
EC_KEY
 *
EC_KEY_√w_by_curve_«me
(
nid
);

842 
EC_KEY_‰ì
(
EC_KEY
 *
key
);

849 
EC_KEY
 *
EC_KEY_c›y
(EC_KEY *
d°
, c⁄° EC_KEY *
§c
);

855 
EC_KEY
 *
EC_KEY_dup
(c⁄° EC_KEY *
§c
);

861 
EC_KEY_up_ªf
(
EC_KEY
 *
key
);

867 
ENGINE
 *
EC_KEY_gë0_ígöe
(c⁄° 
EC_KEY
 *
eckey
);

873 c⁄° 
EC_GROUP
 *
EC_KEY_gë0_group
(c⁄° 
EC_KEY
 *
key
);

881 
EC_KEY_£t_group
(
EC_KEY
 *
key
, c⁄° 
EC_GROUP
 *
group
);

887 c⁄° 
BIGNUM
 *
EC_KEY_gë0_¥iv©e_key
(c⁄° 
EC_KEY
 *
key
);

895 
EC_KEY_£t_¥iv©e_key
(
EC_KEY
 *
key
, c⁄° 
BIGNUM
 *
¥v
);

901 c⁄° 
EC_POINT
 *
EC_KEY_gë0_public_key
(c⁄° 
EC_KEY
 *
key
);

909 
EC_KEY_£t_public_key
(
EC_KEY
 *
key
, c⁄° 
EC_POINT
 *
pub
);

911 
EC_KEY_gë_íc_Êags
(c⁄° 
EC_KEY
 *
key
);

912 
EC_KEY_£t_íc_Êags
(
EC_KEY
 *
eckey
, 
Êags
);

913 
poöt_c⁄vîsi⁄_f‹m_t
 
EC_KEY_gë_c⁄v_f‹m
(c⁄° 
EC_KEY
 *
key
);

914 
EC_KEY_£t_c⁄v_f‹m
(
EC_KEY
 *
eckey
, 
poöt_c⁄vîsi⁄_f‹m_t
 
cf‹m
);

916 
	#EC_KEY_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

917 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_EC_KEY
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

918 
EC_KEY_£t_ex_d©a
(
EC_KEY
 *
key
, 
idx
, *
¨g
);

919 *
EC_KEY_gë_ex_d©a
(c⁄° 
EC_KEY
 *
key
, 
idx
);

922 
EC_KEY_£t_a¢1_Êag
(
EC_KEY
 *
eckey
, 
a¢1_Êag
);

930 
EC_KEY_¥ecompuã_mu…
(
EC_KEY
 *
key
, 
BN_CTX
 *
˘x
);

936 
EC_KEY_gíî©e_key
(
EC_KEY
 *
key
);

942 
EC_KEY_check_key
(c⁄° 
EC_KEY
 *
key
);

948 
EC_KEY_ˇn_sign
(c⁄° 
EC_KEY
 *
eckey
);

957 
EC_KEY_£t_public_key_afföe_co‹dö©es
(
EC_KEY
 *
key
, 
BIGNUM
 *
x
,

958 
BIGNUM
 *
y
);

967 
size_t
 
EC_KEY_key2buf
(c⁄° 
EC_KEY
 *
key
, 
poöt_c⁄vîsi⁄_f‹m_t
 
f‹m
,

968 **
pbuf
, 
BN_CTX
 *
˘x
);

978 
EC_KEY_o˘2key
(
EC_KEY
 *
key
, c⁄° *
buf
, 
size_t
 
Àn
,

979 
BN_CTX
 *
˘x
);

988 
EC_KEY_o˘2¥iv
(
EC_KEY
 *
key
, c⁄° *
buf
, 
size_t
 
Àn
);

998 
size_t
 
EC_KEY_¥iv2o˘
(c⁄° 
EC_KEY
 *
key
, *
buf
, size_à
Àn
);

1005 
size_t
 
EC_KEY_¥iv2buf
(c⁄° 
EC_KEY
 *
eckey
, **
pbuf
);

1017 
EC_KEY
 *
d2i_ECPriv©eKey
(EC_KEY **
key
, c⁄° **
ö
, 
Àn
);

1025 
i2d_ECPriv©eKey
(
EC_KEY
 *
key
, **
out
);

1038 
EC_KEY
 *
d2i_ECP¨amëîs
(EC_KEY **
key
, c⁄° **
ö
, 
Àn
);

1046 
i2d_ECP¨amëîs
(
EC_KEY
 *
key
, **
out
);

1060 
EC_KEY
 *
o2i_ECPublicKey
(EC_KEY **
key
, c⁄° **
ö
, 
Àn
);

1068 
i2o_ECPublicKey
(c⁄° 
EC_KEY
 *
key
, **
out
);

1075 
ECP¨amëîs_¥öt
(
BIO
 *
bp
, c⁄° 
EC_KEY
 *
key
);

1083 
EC_KEY_¥öt
(
BIO
 *
bp
, c⁄° 
EC_KEY
 *
key
, 
off
);

1085 #i‚de‡
OPENSSL_NO_STDIO


1091 
ECP¨amëîs_¥öt_Â
(
FILE
 *
Â
, c⁄° 
EC_KEY
 *
key
);

1099 
EC_KEY_¥öt_Â
(
FILE
 *
Â
, c⁄° 
EC_KEY
 *
key
, 
off
);

1103 c⁄° 
EC_KEY_METHOD
 *
EC_KEY_O≥nSSL
();

1104 c⁄° 
EC_KEY_METHOD
 *
EC_KEY_gë_deÁu…_mëhod
();

1105 
EC_KEY_£t_deÁu…_mëhod
(c⁄° 
EC_KEY_METHOD
 *
mëh
);

1106 c⁄° 
EC_KEY_METHOD
 *
EC_KEY_gë_mëhod
(c⁄° 
EC_KEY
 *
key
);

1107 
EC_KEY_£t_mëhod
(
EC_KEY
 *
key
, c⁄° 
EC_KEY_METHOD
 *
mëh
);

1108 
EC_KEY
 *
EC_KEY_√w_mëhod
(
ENGINE
 *
ígöe
);

1115 
ECDH_KDF_X9_62
(*
out
, 
size_t
 
ouéí
,

1116 c⁄° *
Z
, 
size_t
 
ZÀn
,

1117 c⁄° *
söfo
, 
size_t
 
söfﬁí
,

1118 c⁄° 
EVP_MD
 *
md
);

1120 
ECDH_compuã_key
(*
out
, 
size_t
 
ouéí
, c⁄° 
EC_POINT
 *
pub_key
,

1121 c⁄° 
EC_KEY
 *
ecdh
,

1122 *(*
KDF
Ë(c⁄° *
ö
, 
size_t
 
öÀn
,

1123 *
out
, 
size_t
 *
ouéí
));

1125 
ECDSA_SIG_°
 
	tECDSA_SIG
;

1130 
ECDSA_SIG
 *
ECDSA_SIG_√w
();

1135 
ECDSA_SIG_‰ì
(
ECDSA_SIG
 *
sig
);

1144 
i2d_ECDSA_SIG
(c⁄° 
ECDSA_SIG
 *
sig
, **
µ
);

1153 
ECDSA_SIG
 *
d2i_ECDSA_SIG
(ECDSA_SIG **
sig
, c⁄° **
µ
, 
Àn
);

1160 
ECDSA_SIG_gë0
(c⁄° 
ECDSA_SIG
 *
sig
, c⁄° 
BIGNUM
 **
¥
, c⁄° BIGNUM **
ps
);

1165 c⁄° 
BIGNUM
 *
ECDSA_SIG_gë0_r
(c⁄° 
ECDSA_SIG
 *
sig
);

1170 c⁄° 
BIGNUM
 *
ECDSA_SIG_gë0_s
(c⁄° 
ECDSA_SIG
 *
sig
);

1177 
ECDSA_SIG_£t0
(
ECDSA_SIG
 *
sig
, 
BIGNUM
 *
r
, BIGNUM *
s
);

1186 
ECDSA_SIG
 *
ECDSA_do_sign
(c⁄° *
dg°
, 
dg°_Àn
,

1187 
EC_KEY
 *
eckey
);

1199 
ECDSA_SIG
 *
ECDSA_do_sign_ex
(c⁄° *
dg°
, 
dg°Àn
,

1200 c⁄° 
BIGNUM
 *
köv
, c⁄° BIGNUM *
Ω
,

1201 
EC_KEY
 *
eckey
);

1212 
ECDSA_do_vîify
(c⁄° *
dg°
, 
dg°_Àn
,

1213 c⁄° 
ECDSA_SIG
 *
sig
, 
EC_KEY
 *
eckey
);

1222 
ECDSA_sign_£tup
(
EC_KEY
 *
eckey
, 
BN_CTX
 *
˘x
, 
BIGNUM
 **
köv
, BIGNUM **
Ω
);

1234 
ECDSA_sign
(
ty≥
, c⁄° *
dg°
, 
dg°Àn
,

1235 *
sig
, *
sigÀn
, 
EC_KEY
 *
eckey
);

1250 
ECDSA_sign_ex
(
ty≥
, c⁄° *
dg°
, 
dg°Àn
,

1251 *
sig
, *
sigÀn
,

1252 c⁄° 
BIGNUM
 *
köv
, c⁄° BIGNUM *
Ω
, 
EC_KEY
 *
eckey
);

1265 
ECDSA_vîify
(
ty≥
, c⁄° *
dg°
, 
dg°Àn
,

1266 c⁄° *
sig
, 
sigÀn
, 
EC_KEY
 *
eckey
);

1272 
ECDSA_size
(c⁄° 
EC_KEY
 *
eckey
);

1278 
EC_KEY_METHOD
 *
EC_KEY_METHOD_√w
(c⁄° EC_KEY_METHOD *
mëh
);

1279 
EC_KEY_METHOD_‰ì
(
EC_KEY_METHOD
 *
mëh
);

1280 
EC_KEY_METHOD_£t_öô
(
EC_KEY_METHOD
 *
mëh
,

1281 (*
öô
)(
EC_KEY
 *
key
),

1282 (*
föish
)(
EC_KEY
 *
key
),

1283 (*
c›y
)(
EC_KEY
 *
de°
, c⁄° EC_KEY *
§c
),

1284 (*
£t_group
)(
EC_KEY
 *
key
, c⁄° 
EC_GROUP
 *
gΩ
),

1285 (*
£t_¥iv©e
)(
EC_KEY
 *
key
,

1286 c⁄° 
BIGNUM
 *
¥iv_key
),

1287 (*
£t_public
)(
EC_KEY
 *
key
,

1288 c⁄° 
EC_POINT
 *
pub_key
));

1290 
EC_KEY_METHOD_£t_keygí
(
EC_KEY_METHOD
 *
mëh
,

1291 (*
keygí
)(
EC_KEY
 *
key
));

1293 
EC_KEY_METHOD_£t_compuã_key
(
EC_KEY_METHOD
 *
mëh
,

1294 (*
ckey
)(**
p£c
,

1295 
size_t
 *
p£˛í
,

1296 c⁄° 
EC_POINT
 *
pub_key
,

1297 c⁄° 
EC_KEY
 *
ecdh
));

1299 
EC_KEY_METHOD_£t_sign
(
EC_KEY_METHOD
 *
mëh
,

1300 (*
sign
)(
ty≥
, c⁄° *
dg°
,

1301 
dÀn
, *
sig
,

1302 *
sigÀn
,

1303 c⁄° 
BIGNUM
 *
köv
, c⁄° BIGNUM *
r
,

1304 
EC_KEY
 *
eckey
),

1305 (*
sign_£tup
)(
EC_KEY
 *
eckey
, 
BN_CTX
 *
˘x_ö
,

1306 
BIGNUM
 **
kövp
, BIGNUM **
Ω
),

1307 
ECDSA_SIG
 *(*
sign_sig
)(c⁄° *
dg°
,

1308 
dg°_Àn
,

1309 c⁄° 
BIGNUM
 *
ö_köv
,

1310 c⁄° 
BIGNUM
 *
ö_r
,

1311 
EC_KEY
 *
eckey
));

1313 
EC_KEY_METHOD_£t_vîify
(
EC_KEY_METHOD
 *
mëh
,

1314 (*
vîify
)(
ty≥
, const 

1315 *
dg°
, 
dg°_Àn
,

1316 c⁄° *
sigbuf
,

1317 
sig_Àn
, 
EC_KEY
 *
eckey
),

1318 (*
vîify_sig
)(c⁄° *
dg°
,

1319 
dg°_Àn
,

1320 c⁄° 
ECDSA_SIG
 *
sig
,

1321 
EC_KEY
 *
eckey
));

1323 
EC_KEY_METHOD_gë_öô
(c⁄° 
EC_KEY_METHOD
 *
mëh
,

1324 (**
pöô
)(
EC_KEY
 *
key
),

1325 (**
pföish
)(
EC_KEY
 *
key
),

1326 (**
pc›y
)(
EC_KEY
 *
de°
, c⁄° EC_KEY *
§c
),

1327 (**
p£t_group
)(
EC_KEY
 *
key
,

1328 c⁄° 
EC_GROUP
 *
gΩ
),

1329 (**
p£t_¥iv©e
)(
EC_KEY
 *
key
,

1330 c⁄° 
BIGNUM
 *
¥iv_key
),

1331 (**
p£t_public
)(
EC_KEY
 *
key
,

1332 c⁄° 
EC_POINT
 *
pub_key
));

1334 
EC_KEY_METHOD_gë_keygí
(c⁄° 
EC_KEY_METHOD
 *
mëh
,

1335 (**
pkeygí
)(
EC_KEY
 *
key
));

1337 
EC_KEY_METHOD_gë_compuã_key
(c⁄° 
EC_KEY_METHOD
 *
mëh
,

1338 (**
pck
)(**
p£c
,

1339 
size_t
 *
p£˛í
,

1340 c⁄° 
EC_POINT
 *
pub_key
,

1341 c⁄° 
EC_KEY
 *
ecdh
));

1343 
EC_KEY_METHOD_gë_sign
(c⁄° 
EC_KEY_METHOD
 *
mëh
,

1344 (**
psign
)(
ty≥
, c⁄° *
dg°
,

1345 
dÀn
, *
sig
,

1346 *
sigÀn
,

1347 c⁄° 
BIGNUM
 *
köv
, c⁄° BIGNUM *
r
,

1348 
EC_KEY
 *
eckey
),

1349 (**
psign_£tup
)(
EC_KEY
 *
eckey
, 
BN_CTX
 *
˘x_ö
,

1350 
BIGNUM
 **
kövp
, BIGNUM **
Ω
),

1351 
ECDSA_SIG
 *(**
psign_sig
)(c⁄° *
dg°
,

1352 
dg°_Àn
,

1353 c⁄° 
BIGNUM
 *
ö_köv
,

1354 c⁄° 
BIGNUM
 *
ö_r
,

1355 
EC_KEY
 *
eckey
));

1357 
EC_KEY_METHOD_gë_vîify
(c⁄° 
EC_KEY_METHOD
 *
mëh
,

1358 (**
pvîify
)(
ty≥
, const 

1359 *
dg°
, 
dg°_Àn
,

1360 c⁄° *
sigbuf
,

1361 
sig_Àn
, 
EC_KEY
 *
eckey
),

1362 (**
pvîify_sig
)(c⁄° *
dg°
,

1363 
dg°_Àn
,

1364 c⁄° 
ECDSA_SIG
 *
sig
,

1365 
EC_KEY
 *
eckey
));

1367 
	#ECP¨amëîs_dup
(
x
Ë
	`ASN1_dup_of
(
EC_KEY
,
i2d_ECP¨amëîs
,
d2i_ECP¨amëîs
,x)

	)

1369 #i‚de‡
__˝lu•lus


1370 #i‡
deföed
(
__SUNPRO_C
)

1371 #i‡
__SUNPRO_C
 >= 0x520

1372 #¥agm®
îr‹_mesßges
 (,
E_ARRAY_OF_INCOMPLETE_NONAME
,
E_ARRAY_OF_INCOMPLETE
)

1377 
	#EVP_PKEY_CTX_£t_ec_∑ømgí_curve_nid
(
˘x
, 
nid
) \

1378 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1379 
EVP_PKEY_OP_PARAMGEN
|
EVP_PKEY_OP_KEYGEN
, \

1380 
EVP_PKEY_CTRL_EC_PARAMGEN_CURVE_NID
, 
nid
, 
NULL
)

	)

1382 
	#EVP_PKEY_CTX_£t_ec_∑øm_íc
(
˘x
, 
Êag
) \

1383 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1384 
EVP_PKEY_OP_PARAMGEN
|
EVP_PKEY_OP_KEYGEN
, \

1385 
EVP_PKEY_CTRL_EC_PARAM_ENC
, 
Êag
, 
NULL
)

	)

1387 
	#EVP_PKEY_CTX_£t_ecdh_coÁ˘‹_mode
(
˘x
, 
Êag
) \

1388 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1389 
EVP_PKEY_OP_DERIVE
, \

1390 
EVP_PKEY_CTRL_EC_ECDH_COFACTOR
, 
Êag
, 
NULL
)

	)

1392 
	#EVP_PKEY_CTX_gë_ecdh_coÁ˘‹_mode
(
˘x
) \

1393 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1394 
EVP_PKEY_OP_DERIVE
, \

1395 
EVP_PKEY_CTRL_EC_ECDH_COFACTOR
, -2, 
NULL
)

	)

1397 
	#EVP_PKEY_CTX_£t_ecdh_kdf_ty≥
(
˘x
, 
kdf
) \

1398 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1399 
EVP_PKEY_OP_DERIVE
, \

1400 
EVP_PKEY_CTRL_EC_KDF_TYPE
, 
kdf
, 
NULL
)

	)

1402 
	#EVP_PKEY_CTX_gë_ecdh_kdf_ty≥
(
˘x
) \

1403 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1404 
EVP_PKEY_OP_DERIVE
, \

1405 
EVP_PKEY_CTRL_EC_KDF_TYPE
, -2, 
NULL
)

	)

1407 
	#EVP_PKEY_CTX_£t_ecdh_kdf_md
(
˘x
, 
md
) \

1408 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1409 
EVP_PKEY_OP_DERIVE
, \

1410 
EVP_PKEY_CTRL_EC_KDF_MD
, 0, (*)(
md
))

	)

1412 
	#EVP_PKEY_CTX_gë_ecdh_kdf_md
(
˘x
, 
pmd
) \

1413 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1414 
EVP_PKEY_OP_DERIVE
, \

1415 
EVP_PKEY_CTRL_GET_EC_KDF_MD
, 0, (*)(
pmd
))

	)

1417 
	#EVP_PKEY_CTX_£t_ecdh_kdf_ouéí
(
˘x
, 
Àn
) \

1418 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1419 
EVP_PKEY_OP_DERIVE
, \

1420 
EVP_PKEY_CTRL_EC_KDF_OUTLEN
, 
Àn
, 
NULL
)

	)

1422 
	#EVP_PKEY_CTX_gë_ecdh_kdf_ouéí
(
˘x
, 
∂í
) \

1423 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1424 
EVP_PKEY_OP_DERIVE
, \

1425 
EVP_PKEY_CTRL_GET_EC_KDF_OUTLEN
, 0, \

1426 (*)(
∂í
))

	)

1428 
	#EVP_PKEY_CTX_£t0_ecdh_kdf_ukm
(
˘x
, 
p
, 
∂í
) \

1429 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1430 
EVP_PKEY_OP_DERIVE
, \

1431 
EVP_PKEY_CTRL_EC_KDF_UKM
, 
∂í
, (*)(
p
))

	)

1433 
	#EVP_PKEY_CTX_gë0_ecdh_kdf_ukm
(
˘x
, 
p
) \

1434 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_EC
, \

1435 
EVP_PKEY_OP_DERIVE
, \

1436 
EVP_PKEY_CTRL_GET_EC_KDF_UKM
, 0, (*)(
p
))

	)

1439 
	#EVP_PKEY_CTX_£t1_id
(
˘x
, 
id
, 
id_Àn
) \

1440 
	`EVP_PKEY_CTX_˘æ
(
˘x
, -1, -1, \

1441 
EVP_PKEY_CTRL_SET1_ID
, ()
id_Àn
, (*)(
id
))

	)

1443 
	#EVP_PKEY_CTX_gë1_id
(
˘x
, 
id
) \

1444 
	`EVP_PKEY_CTX_˘æ
(
˘x
, -1, -1, \

1445 
EVP_PKEY_CTRL_GET1_ID
, 0, (*)(
id
))

	)

1447 
	#EVP_PKEY_CTX_gë1_id_Àn
(
˘x
, 
id_Àn
) \

1448 
	`EVP_PKEY_CTX_˘æ
(
˘x
, -1, -1, \

1449 
EVP_PKEY_CTRL_GET1_ID_LEN
, 0, (*)(
id_Àn
))

	)

1451 
	#EVP_PKEY_CTRL_EC_PARAMGEN_CURVE_NID
 (
EVP_PKEY_ALG_CTRL
 + 1)

	)

1452 
	#EVP_PKEY_CTRL_EC_PARAM_ENC
 (
EVP_PKEY_ALG_CTRL
 + 2)

	)

1453 
	#EVP_PKEY_CTRL_EC_ECDH_COFACTOR
 (
EVP_PKEY_ALG_CTRL
 + 3)

	)

1454 
	#EVP_PKEY_CTRL_EC_KDF_TYPE
 (
EVP_PKEY_ALG_CTRL
 + 4)

	)

1455 
	#EVP_PKEY_CTRL_EC_KDF_MD
 (
EVP_PKEY_ALG_CTRL
 + 5)

	)

1456 
	#EVP_PKEY_CTRL_GET_EC_KDF_MD
 (
EVP_PKEY_ALG_CTRL
 + 6)

	)

1457 
	#EVP_PKEY_CTRL_EC_KDF_OUTLEN
 (
EVP_PKEY_ALG_CTRL
 + 7)

	)

1458 
	#EVP_PKEY_CTRL_GET_EC_KDF_OUTLEN
 (
EVP_PKEY_ALG_CTRL
 + 8)

	)

1459 
	#EVP_PKEY_CTRL_EC_KDF_UKM
 (
EVP_PKEY_ALG_CTRL
 + 9)

	)

1460 
	#EVP_PKEY_CTRL_GET_EC_KDF_UKM
 (
EVP_PKEY_ALG_CTRL
 + 10)

	)

1461 
	#EVP_PKEY_CTRL_SET1_ID
 (
EVP_PKEY_ALG_CTRL
 + 11)

	)

1462 
	#EVP_PKEY_CTRL_GET1_ID
 (
EVP_PKEY_ALG_CTRL
 + 12)

	)

1463 
	#EVP_PKEY_CTRL_GET1_ID_LEN
 (
EVP_PKEY_ALG_CTRL
 + 13)

	)

1465 
	#EVP_PKEY_ECDH_KDF_NONE
 1

	)

1466 
	#EVP_PKEY_ECDH_KDF_X9_63
 2

	)

1472 
	#EVP_PKEY_ECDH_KDF_X9_62
 
EVP_PKEY_ECDH_KDF_X9_63


	)

1475 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/evp.h

10 #i‚de‡
HEADER_ENVELOPE_H


11 
	#HEADER_ENVELOPE_H


	)

13 
	~<›ís¶/›ís¶c⁄f.h
>

14 
	~<›ís¶/os¶_typ.h
>

15 
	~<›ís¶/symhacks.h
>

16 
	~<›ís¶/bio.h
>

17 
	~<›ís¶/ev≥º.h
>

19 
	#EVP_MAX_MD_SIZE
 64

	)

20 
	#EVP_MAX_KEY_LENGTH
 64

	)

21 
	#EVP_MAX_IV_LENGTH
 16

	)

22 
	#EVP_MAX_BLOCK_LENGTH
 32

	)

24 
	#PKCS5_SALT_LEN
 8

	)

26 
	#PKCS5_DEFAULT_ITER
 2048

	)

28 
	~<›ís¶/obje˘s.h
>

30 
	#EVP_PK_RSA
 0x0001

	)

31 
	#EVP_PK_DSA
 0x0002

	)

32 
	#EVP_PK_DH
 0x0004

	)

33 
	#EVP_PK_EC
 0x0008

	)

34 
	#EVP_PKT_SIGN
 0x0010

	)

35 
	#EVP_PKT_ENC
 0x0020

	)

36 
	#EVP_PKT_EXCH
 0x0040

	)

37 
	#EVP_PKS_RSA
 0x0100

	)

38 
	#EVP_PKS_DSA
 0x0200

	)

39 
	#EVP_PKS_EC
 0x0400

	)

41 
	#EVP_PKEY_NONE
 
NID_undef


	)

42 
	#EVP_PKEY_RSA
 
NID_rßEn¸y±i⁄


	)

43 
	#EVP_PKEY_RSA2
 
NID_rß


	)

44 
	#EVP_PKEY_RSA_PSS
 
NID_rßsßPss


	)

45 
	#EVP_PKEY_DSA
 
NID_dß


	)

46 
	#EVP_PKEY_DSA1
 
NID_dß_2


	)

47 
	#EVP_PKEY_DSA2
 
NID_dßWôhSHA


	)

48 
	#EVP_PKEY_DSA3
 
NID_dßWôhSHA1


	)

49 
	#EVP_PKEY_DSA4
 
NID_dßWôhSHA1_2


	)

50 
	#EVP_PKEY_DH
 
NID_dhKeyAgªemít


	)

51 
	#EVP_PKEY_DHX
 
NID_dhpubli˙umbî


	)

52 
	#EVP_PKEY_EC
 
NID_X9_62_id_ecPublicKey


	)

53 
	#EVP_PKEY_SM2
 
NID_sm2


	)

54 
	#EVP_PKEY_HMAC
 
NID_hmac


	)

55 
	#EVP_PKEY_CMAC
 
NID_cmac


	)

56 
	#EVP_PKEY_SCRYPT
 
NID_id_s¸y±


	)

57 
	#EVP_PKEY_TLS1_PRF
 
NID_és1_¥f


	)

58 
	#EVP_PKEY_HKDF
 
NID_hkdf


	)

59 
	#EVP_PKEY_POLY1305
 
NID_pﬁy1305


	)

60 
	#EVP_PKEY_SIPHASH
 
NID_sùhash


	)

61 
	#EVP_PKEY_X25519
 
NID_X25519


	)

62 
	#EVP_PKEY_ED25519
 
NID_ED25519


	)

63 
	#EVP_PKEY_X448
 
NID_X448


	)

64 
	#EVP_PKEY_ED448
 
NID_ED448


	)

66 #ifde‡ 
__˝lu•lus


70 
	#EVP_PKEY_MO_SIGN
 0x0001

	)

71 
	#EVP_PKEY_MO_VERIFY
 0x0002

	)

72 
	#EVP_PKEY_MO_ENCRYPT
 0x0004

	)

73 
	#EVP_PKEY_MO_DECRYPT
 0x0008

	)

75 #i‚de‡
EVP_MD


76 
EVP_MD
 *
EVP_MD_mëh_√w
(
md_ty≥
, 
pkey_ty≥
);

77 
EVP_MD
 *
EVP_MD_mëh_dup
(c⁄° EVP_MD *
md
);

78 
EVP_MD_mëh_‰ì
(
EVP_MD
 *
md
);

80 
EVP_MD_mëh_£t_öput_blocksize
(
EVP_MD
 *
md
, 
blocksize
);

81 
EVP_MD_mëh_£t_ªsu…_size
(
EVP_MD
 *
md
, 
ªsu…size
);

82 
EVP_MD_mëh_£t_≠p_d©asize
(
EVP_MD
 *
md
, 
d©asize
);

83 
EVP_MD_mëh_£t_Êags
(
EVP_MD
 *
md
, 
Êags
);

84 
EVP_MD_mëh_£t_öô
(
EVP_MD
 *
md
, (*
öô
)(
EVP_MD_CTX
 *
˘x
));

85 
EVP_MD_mëh_£t_upd©e
(
EVP_MD
 *
md
, (*
upd©e
)(
EVP_MD_CTX
 *
˘x
,

86 c⁄° *
d©a
,

87 
size_t
 
cou¡
));

88 
EVP_MD_mëh_£t_föÆ
(
EVP_MD
 *
md
, (*
föÆ
)(
EVP_MD_CTX
 *
˘x
,

89 *
md
));

90 
EVP_MD_mëh_£t_c›y
(
EVP_MD
 *
md
, (*
c›y
)(
EVP_MD_CTX
 *
to
,

91 c⁄° 
EVP_MD_CTX
 *
‰om
));

92 
EVP_MD_mëh_£t_˛ónup
(
EVP_MD
 *
md
, (*
˛ónup
)(
EVP_MD_CTX
 *
˘x
));

93 
EVP_MD_mëh_£t_˘æ
(
EVP_MD
 *
md
, (*
˘æ
)(
EVP_MD_CTX
 *
˘x
, 
cmd
,

94 
p1
, *
p2
));

96 
EVP_MD_mëh_gë_öput_blocksize
(c⁄° 
EVP_MD
 *
md
);

97 
EVP_MD_mëh_gë_ªsu…_size
(c⁄° 
EVP_MD
 *
md
);

98 
EVP_MD_mëh_gë_≠p_d©asize
(c⁄° 
EVP_MD
 *
md
);

99 
EVP_MD_mëh_gë_Êags
(c⁄° 
EVP_MD
 *
md
);

100 (*
EVP_MD_mëh_gë_öô
(c⁄° 
EVP_MD
 *
md
))(
EVP_MD_CTX
 *
˘x
);

101 (*
EVP_MD_mëh_gë_upd©e
(c⁄° 
EVP_MD
 *
md
))(
EVP_MD_CTX
 *
˘x
,

102 c⁄° *
d©a
,

103 
size_t
 
cou¡
);

104 (*
EVP_MD_mëh_gë_föÆ
(c⁄° 
EVP_MD
 *
md
))(
EVP_MD_CTX
 *
˘x
,

105 *
md
);

106 (*
EVP_MD_mëh_gë_c›y
(c⁄° 
EVP_MD
 *
md
))(
EVP_MD_CTX
 *
to
,

107 c⁄° 
EVP_MD_CTX
 *
‰om
);

108 (*
EVP_MD_mëh_gë_˛ónup
(c⁄° 
EVP_MD
 *
md
))(
EVP_MD_CTX
 *
˘x
);

109 (*
EVP_MD_mëh_gë_˘æ
(c⁄° 
EVP_MD
 *
md
))(
EVP_MD_CTX
 *
˘x
, 
cmd
,

110 
p1
, *
p2
);

113 
	#EVP_MD_FLAG_ONESHOT
 0x0001

	)

116 
	#EVP_MD_FLAG_XOF
 0x0002

	)

120 
	#EVP_MD_FLAG_DIGALGID_MASK
 0x0018

	)

124 
	#EVP_MD_FLAG_DIGALGID_NULL
 0x0000

	)

128 
	#EVP_MD_FLAG_DIGALGID_ABSENT
 0x0008

	)

132 
	#EVP_MD_FLAG_DIGALGID_CUSTOM
 0x0018

	)

135 
	#EVP_MD_FLAG_FIPS
 0x0400

	)

139 
	#EVP_MD_CTRL_DIGALGID
 0x1

	)

140 
	#EVP_MD_CTRL_MICALG
 0x2

	)

141 
	#EVP_MD_CTRL_XOF_LEN
 0x3

	)

145 
	#EVP_MD_CTRL_ALG_CTRL
 0x1000

	)

151 
	#EVP_MD_CTX_FLAG_ONESHOT
 0x0001

	)

153 
	#EVP_MD_CTX_FLAG_CLEANED
 0x0002

	)

155 
	#EVP_MD_CTX_FLAG_REUSE
 0x0004

	)

162 
	#EVP_MD_CTX_FLAG_NON_FIPS_ALLOW
 0x0008

	)

170 
	#EVP_MD_CTX_FLAG_PAD_MASK
 0xF0

	)

171 
	#EVP_MD_CTX_FLAG_PAD_PKCS1
 0x00

	)

172 
	#EVP_MD_CTX_FLAG_PAD_X931
 0x10

	)

173 
	#EVP_MD_CTX_FLAG_PAD_PSS
 0x20

	)

175 
	#EVP_MD_CTX_FLAG_NO_INIT
 0x0100

	)

182 
	#EVP_MD_CTX_FLAG_FINALISE
 0x0200

	)

185 
EVP_CIPHER
 *
EVP_CIPHER_mëh_√w
(
cùhî_ty≥
, 
block_size
, 
key_Àn
);

186 
EVP_CIPHER
 *
EVP_CIPHER_mëh_dup
(c⁄° EVP_CIPHER *
cùhî
);

187 
EVP_CIPHER_mëh_‰ì
(
EVP_CIPHER
 *
cùhî
);

189 
EVP_CIPHER_mëh_£t_iv_Àngth
(
EVP_CIPHER
 *
cùhî
, 
iv_Àn
);

190 
EVP_CIPHER_mëh_£t_Êags
(
EVP_CIPHER
 *
cùhî
, 
Êags
);

191 
EVP_CIPHER_mëh_£t_im∂_˘x_size
(
EVP_CIPHER
 *
cùhî
, 
˘x_size
);

192 
EVP_CIPHER_mëh_£t_öô
(
EVP_CIPHER
 *
cùhî
,

193 (*
öô
Ë(
EVP_CIPHER_CTX
 *
˘x
,

194 c⁄° *
key
,

195 c⁄° *
iv
,

196 
íc
));

197 
EVP_CIPHER_mëh_£t_do_cùhî
(
EVP_CIPHER
 *
cùhî
,

198 (*
do_cùhî
Ë(
EVP_CIPHER_CTX
 *
˘x
,

199 *
out
,

200 c⁄° *
ö
,

201 
size_t
 
öl
));

202 
EVP_CIPHER_mëh_£t_˛ónup
(
EVP_CIPHER
 *
cùhî
,

203 (*
˛ónup
Ë(
EVP_CIPHER_CTX
 *));

204 
EVP_CIPHER_mëh_£t_£t_a¢1_∑øms
(
EVP_CIPHER
 *
cùhî
,

205 (*
£t_a¢1_∑ømëîs
Ë(
EVP_CIPHER_CTX
 *,

206 
ASN1_TYPE
 *));

207 
EVP_CIPHER_mëh_£t_gë_a¢1_∑øms
(
EVP_CIPHER
 *
cùhî
,

208 (*
gë_a¢1_∑ømëîs
Ë(
EVP_CIPHER_CTX
 *,

209 
ASN1_TYPE
 *));

210 
EVP_CIPHER_mëh_£t_˘æ
(
EVP_CIPHER
 *
cùhî
,

211 (*
˘æ
Ë(
EVP_CIPHER_CTX
 *, 
ty≥
,

212 
¨g
, *
±r
));

214 (*
EVP_CIPHER_mëh_gë_öô
(c⁄° 
EVP_CIPHER
 *
cùhî
))(
EVP_CIPHER_CTX
 *
˘x
,

215 c⁄° *
key
,

216 c⁄° *
iv
,

217 
íc
);

218 (*
EVP_CIPHER_mëh_gë_do_cùhî
(c⁄° 
EVP_CIPHER
 *
cùhî
))(
EVP_CIPHER_CTX
 *
˘x
,

219 *
out
,

220 c⁄° *
ö
,

221 
size_t
 
öl
);

222 (*
EVP_CIPHER_mëh_gë_˛ónup
(c⁄° 
EVP_CIPHER
 *
cùhî
))(
EVP_CIPHER_CTX
 *);

223 (*
EVP_CIPHER_mëh_gë_£t_a¢1_∑øms
(c⁄° 
EVP_CIPHER
 *
cùhî
))(
EVP_CIPHER_CTX
 *,

224 
ASN1_TYPE
 *);

225 (*
EVP_CIPHER_mëh_gë_gë_a¢1_∑øms
(c⁄° 
EVP_CIPHER
 *
cùhî
))(
EVP_CIPHER_CTX
 *,

226 
ASN1_TYPE
 *);

227 (*
EVP_CIPHER_mëh_gë_˘æ
(c⁄° 
EVP_CIPHER
 *
cùhî
))(
EVP_CIPHER_CTX
 *,

228 
ty≥
, 
¨g
,

229 *
±r
);

235 
	#EVP_CIPH_STREAM_CIPHER
 0x0

	)

236 
	#EVP_CIPH_ECB_MODE
 0x1

	)

237 
	#EVP_CIPH_CBC_MODE
 0x2

	)

238 
	#EVP_CIPH_CFB_MODE
 0x3

	)

239 
	#EVP_CIPH_OFB_MODE
 0x4

	)

240 
	#EVP_CIPH_CTR_MODE
 0x5

	)

241 
	#EVP_CIPH_GCM_MODE
 0x6

	)

242 
	#EVP_CIPH_CCM_MODE
 0x7

	)

243 
	#EVP_CIPH_XTS_MODE
 0x10001

	)

244 
	#EVP_CIPH_WRAP_MODE
 0x10002

	)

245 
	#EVP_CIPH_OCB_MODE
 0x10003

	)

246 
	#EVP_CIPH_MODE
 0xF0007

	)

248 
	#EVP_CIPH_VARIABLE_LENGTH
 0x8

	)

250 
	#EVP_CIPH_CUSTOM_IV
 0x10

	)

252 
	#EVP_CIPH_ALWAYS_CALL_INIT
 0x20

	)

254 
	#EVP_CIPH_CTRL_INIT
 0x40

	)

256 
	#EVP_CIPH_CUSTOM_KEY_LENGTH
 0x80

	)

258 
	#EVP_CIPH_NO_PADDING
 0x100

	)

260 
	#EVP_CIPH_RAND_KEY
 0x200

	)

262 
	#EVP_CIPH_CUSTOM_COPY
 0x400

	)

264 
	#EVP_CIPH_CUSTOM_IV_LENGTH
 0x800

	)

266 
	#EVP_CIPH_FLAG_DEFAULT_ASN1
 0x1000

	)

268 
	#EVP_CIPH_FLAG_LENGTH_BITS
 0x2000

	)

270 
	#EVP_CIPH_FLAG_FIPS
 0x4000

	)

272 
	#EVP_CIPH_FLAG_NON_FIPS_ALLOW
 0x8000

	)

276 
	#EVP_CIPH_FLAG_CUSTOM_CIPHER
 0x100000

	)

277 
	#EVP_CIPH_FLAG_AEAD_CIPHER
 0x200000

	)

278 
	#EVP_CIPH_FLAG_TLS1_1_MULTIBLOCK
 0x400000

	)

280 
	#EVP_CIPH_FLAG_PIPELINE
 0X800000

	)

287 
	#EVP_CIPHER_CTX_FLAG_WRAP_ALLOW
 0x1

	)

291 
	#EVP_CTRL_INIT
 0x0

	)

292 
	#EVP_CTRL_SET_KEY_LENGTH
 0x1

	)

293 
	#EVP_CTRL_GET_RC2_KEY_BITS
 0x2

	)

294 
	#EVP_CTRL_SET_RC2_KEY_BITS
 0x3

	)

295 
	#EVP_CTRL_GET_RC5_ROUNDS
 0x4

	)

296 
	#EVP_CTRL_SET_RC5_ROUNDS
 0x5

	)

297 
	#EVP_CTRL_RAND_KEY
 0x6

	)

298 
	#EVP_CTRL_PBE_PRF_NID
 0x7

	)

299 
	#EVP_CTRL_COPY
 0x8

	)

300 
	#EVP_CTRL_AEAD_SET_IVLEN
 0x9

	)

301 
	#EVP_CTRL_AEAD_GET_TAG
 0x10

	)

302 
	#EVP_CTRL_AEAD_SET_TAG
 0x11

	)

303 
	#EVP_CTRL_AEAD_SET_IV_FIXED
 0x12

	)

304 
	#EVP_CTRL_GCM_SET_IVLEN
 
EVP_CTRL_AEAD_SET_IVLEN


	)

305 
	#EVP_CTRL_GCM_GET_TAG
 
EVP_CTRL_AEAD_GET_TAG


	)

306 
	#EVP_CTRL_GCM_SET_TAG
 
EVP_CTRL_AEAD_SET_TAG


	)

307 
	#EVP_CTRL_GCM_SET_IV_FIXED
 
EVP_CTRL_AEAD_SET_IV_FIXED


	)

308 
	#EVP_CTRL_GCM_IV_GEN
 0x13

	)

309 
	#EVP_CTRL_CCM_SET_IVLEN
 
EVP_CTRL_AEAD_SET_IVLEN


	)

310 
	#EVP_CTRL_CCM_GET_TAG
 
EVP_CTRL_AEAD_GET_TAG


	)

311 
	#EVP_CTRL_CCM_SET_TAG
 
EVP_CTRL_AEAD_SET_TAG


	)

312 
	#EVP_CTRL_CCM_SET_IV_FIXED
 
EVP_CTRL_AEAD_SET_IV_FIXED


	)

313 
	#EVP_CTRL_CCM_SET_L
 0x14

	)

314 
	#EVP_CTRL_CCM_SET_MSGLEN
 0x15

	)

320 
	#EVP_CTRL_AEAD_TLS1_AAD
 0x16

	)

322 
	#EVP_CTRL_AEAD_SET_MAC_KEY
 0x17

	)

324 
	#EVP_CTRL_GCM_SET_IV_INV
 0x18

	)

326 
	#EVP_CTRL_TLS1_1_MULTIBLOCK_AAD
 0x19

	)

327 
	#EVP_CTRL_TLS1_1_MULTIBLOCK_ENCRYPT
 0x1a

	)

328 
	#EVP_CTRL_TLS1_1_MULTIBLOCK_DECRYPT
 0x1b

	)

329 
	#EVP_CTRL_TLS1_1_MULTIBLOCK_MAX_BUFSIZE
 0x1c

	)

331 
	#EVP_CTRL_SSL3_MASTER_SECRET
 0x1d

	)

334 
	#EVP_CTRL_SET_SBOX
 0x1e

	)

339 
	#EVP_CTRL_SBOX_USED
 0x1f

	)

343 
	#EVP_CTRL_KEY_MESH
 0x20

	)

345 
	#EVP_CTRL_BLOCK_PADDING_MODE
 0x21

	)

348 
	#EVP_CTRL_SET_PIPELINE_OUTPUT_BUFS
 0x22

	)

350 
	#EVP_CTRL_SET_PIPELINE_INPUT_BUFS
 0x23

	)

352 
	#EVP_CTRL_SET_PIPELINE_INPUT_LENS
 0x24

	)

354 
	#EVP_CTRL_GET_IVLEN
 0x25

	)

357 
	#EVP_PADDING_PKCS7
 1

	)

358 
	#EVP_PADDING_ISO7816_4
 2

	)

359 
	#EVP_PADDING_ANSI923
 3

	)

360 
	#EVP_PADDING_ISO10126
 4

	)

361 
	#EVP_PADDING_ZERO
 5

	)

364 
	#EVP_AEAD_TLS1_AAD_LEN
 13

	)

367 *
out
;

368 c⁄° *
öp
;

369 
size_t
 
Àn
;

370 
öãæóve
;

371 } 
	tEVP_CTRL_TLS1_1_MULTIBLOCK_PARAM
;

375 
	#EVP_GCM_TLS_FIXED_IV_LEN
 4

	)

377 
	#EVP_GCM_TLS_EXPLICIT_IV_LEN
 8

	)

379 
	#EVP_GCM_TLS_TAG_LEN
 16

	)

383 
	#EVP_CCM_TLS_FIXED_IV_LEN
 4

	)

385 
	#EVP_CCM_TLS_EXPLICIT_IV_LEN
 8

	)

387 
	#EVP_CCM_TLS_IV_LEN
 12

	)

389 
	#EVP_CCM_TLS_TAG_LEN
 16

	)

391 
	#EVP_CCM8_TLS_TAG_LEN
 8

	)

394 
	#EVP_CHACHAPOLY_TLS_TAG_LEN
 16

	)

396 
	sevp_cùhî_öfo_°
 {

397 c⁄° 
EVP_CIPHER
 *
cùhî
;

398 
iv
[
EVP_MAX_IV_LENGTH
];

399 } 
	tEVP_CIPHER_INFO
;

403 (
EVP_PBE_KEYGEN
Ë(
	tEVP_CIPHER_CTX
 *
	t˘x
, c⁄° *
	t∑ss
,

404 
	t∑s¶í
, 
	tASN1_TYPE
 *
	t∑øm
,

405 c⁄° 
	tEVP_CIPHER
 *
	tcùhî
, c⁄° 
	tEVP_MD
 *
	tmd
,

406 
	tí_de
);

408 #i‚de‡
OPENSSL_NO_RSA


409 
	#EVP_PKEY_assign_RSA
(
pkey
,
rß
Ë
	`EVP_PKEY_assign
(’key),
EVP_PKEY_RSA
,\

410 (*)(
rß
))

	)

413 #i‚de‡
OPENSSL_NO_DSA


414 
	#EVP_PKEY_assign_DSA
(
pkey
,
dß
Ë
	`EVP_PKEY_assign
(’key),
EVP_PKEY_DSA
,\

415 (*)(
dß
))

	)

418 #i‚de‡
OPENSSL_NO_DH


419 
	#EVP_PKEY_assign_DH
(
pkey
,
dh
Ë
	`EVP_PKEY_assign
(’key),
EVP_PKEY_DH
,\

420 (*)(
dh
))

	)

423 #i‚de‡
OPENSSL_NO_EC


424 
	#EVP_PKEY_assign_EC_KEY
(
pkey
,
eckey
Ë
	`EVP_PKEY_assign
(’key),
EVP_PKEY_EC
,\

425 (*)(
eckey
))

	)

427 #i‚de‡
OPENSSL_NO_SIPHASH


428 
	#EVP_PKEY_assign_SIPHASH
(
pkey
,
shkey
Ë
	`EVP_PKEY_assign
(’key),
EVP_PKEY_SIPHASH
,\

429 (*)(
shkey
))

	)

432 #i‚de‡
OPENSSL_NO_POLY1305


433 
	#EVP_PKEY_assign_POLY1305
(
pkey
,
pﬁykey
Ë
	`EVP_PKEY_assign
(’key),
EVP_PKEY_POLY1305
,\

434 (*)(
pﬁykey
))

	)

438 
	#EVP_gë_dige°bynid
(
a
Ë
	`EVP_gë_dige°by«me
(
	`OBJ_nid2¢
◊))

	)

439 
	#EVP_gë_dige°byobj
(
a
Ë
	`EVP_gë_dige°bynid
(
	`OBJ_obj2nid
◊))

	)

440 
	#EVP_gë_cùhîbynid
(
a
Ë
	`EVP_gë_cùhîby«me
(
	`OBJ_nid2¢
◊))

	)

441 
	#EVP_gë_cùhîbyobj
(
a
Ë
	`EVP_gë_cùhîbynid
(
	`OBJ_obj2nid
◊))

	)

443 
EVP_MD_ty≥
(c⁄° 
EVP_MD
 *
md
);

444 
	#EVP_MD_nid
(
e
Ë
	`EVP_MD_ty≥
”)

	)

445 
	#EVP_MD_«me
(
e
Ë
	`OBJ_nid2¢
(
	`EVP_MD_nid
”))

	)

446 
EVP_MD_pkey_ty≥
(c⁄° 
EVP_MD
 *
md
);

447 
EVP_MD_size
(c⁄° 
EVP_MD
 *
md
);

448 
EVP_MD_block_size
(c⁄° 
EVP_MD
 *
md
);

449 
EVP_MD_Êags
(c⁄° 
EVP_MD
 *
md
);

451 c⁄° 
EVP_MD
 *
EVP_MD_CTX_md
(c⁄° 
EVP_MD_CTX
 *
˘x
);

452 (*
EVP_MD_CTX_upd©e_‚
(
EVP_MD_CTX
 *
˘x
))(EVP_MD_CTX *ctx,

453 c⁄° *
d©a
, 
size_t
 
cou¡
);

454 
EVP_MD_CTX_£t_upd©e_‚
(
EVP_MD_CTX
 *
˘x
,

455 (*
upd©e
Ë(
EVP_MD_CTX
 *
˘x
,

456 c⁄° *
d©a
, 
size_t
 
cou¡
));

457 
	#EVP_MD_CTX_size
(
e
Ë
	`EVP_MD_size
(
	`EVP_MD_CTX_md
”))

	)

458 
	#EVP_MD_CTX_block_size
(
e
Ë
	`EVP_MD_block_size
(
	`EVP_MD_CTX_md
”))

	)

459 
	#EVP_MD_CTX_ty≥
(
e
Ë
	`EVP_MD_ty≥
(
	`EVP_MD_CTX_md
”))

	)

460 
EVP_PKEY_CTX
 *
EVP_MD_CTX_pkey_˘x
(c⁄° 
EVP_MD_CTX
 *
˘x
);

461 
EVP_MD_CTX_£t_pkey_˘x
(
EVP_MD_CTX
 *
˘x
, 
EVP_PKEY_CTX
 *
p˘x
);

462 *
EVP_MD_CTX_md_d©a
(c⁄° 
EVP_MD_CTX
 *
˘x
);

464 
EVP_CIPHER_nid
(c⁄° 
EVP_CIPHER
 *
cùhî
);

465 
	#EVP_CIPHER_«me
(
e
Ë
	`OBJ_nid2¢
(
	`EVP_CIPHER_nid
”))

	)

466 
EVP_CIPHER_block_size
(c⁄° 
EVP_CIPHER
 *
cùhî
);

467 
EVP_CIPHER_im∂_˘x_size
(c⁄° 
EVP_CIPHER
 *
cùhî
);

468 
EVP_CIPHER_key_Àngth
(c⁄° 
EVP_CIPHER
 *
cùhî
);

469 
EVP_CIPHER_iv_Àngth
(c⁄° 
EVP_CIPHER
 *
cùhî
);

470 
EVP_CIPHER_Êags
(c⁄° 
EVP_CIPHER
 *
cùhî
);

471 
	#EVP_CIPHER_mode
(
e
Ë(
	`EVP_CIPHER_Êags
”Ë& 
EVP_CIPH_MODE
)

	)

473 c⁄° 
EVP_CIPHER
 *
EVP_CIPHER_CTX_cùhî
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

474 
EVP_CIPHER_CTX_í¸y±ög
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

475 
EVP_CIPHER_CTX_nid
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

476 
EVP_CIPHER_CTX_block_size
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

477 
EVP_CIPHER_CTX_key_Àngth
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

478 
EVP_CIPHER_CTX_iv_Àngth
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

479 c⁄° *
EVP_CIPHER_CTX_iv
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

480 c⁄° *
EVP_CIPHER_CTX_‹igöÆ_iv
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

481 *
EVP_CIPHER_CTX_iv_noc⁄°
(
EVP_CIPHER_CTX
 *
˘x
);

482 *
EVP_CIPHER_CTX_buf_noc⁄°
(
EVP_CIPHER_CTX
 *
˘x
);

483 
EVP_CIPHER_CTX_num
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

484 
EVP_CIPHER_CTX_£t_num
(
EVP_CIPHER_CTX
 *
˘x
, 
num
);

485 
EVP_CIPHER_CTX_c›y
(
EVP_CIPHER_CTX
 *
out
, c⁄° EVP_CIPHER_CTX *
ö
);

486 *
EVP_CIPHER_CTX_gë_≠p_d©a
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

487 
EVP_CIPHER_CTX_£t_≠p_d©a
(
EVP_CIPHER_CTX
 *
˘x
, *
d©a
);

488 *
EVP_CIPHER_CTX_gë_cùhî_d©a
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
);

489 *
EVP_CIPHER_CTX_£t_cùhî_d©a
(
EVP_CIPHER_CTX
 *
˘x
, *
cùhî_d©a
);

490 
	#EVP_CIPHER_CTX_ty≥
(
c
Ë
	`EVP_CIPHER_ty≥
(
	`EVP_CIPHER_CTX_cùhî
(c))

	)

491 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

492 
	#EVP_CIPHER_CTX_Êags
(
c
Ë
	`EVP_CIPHER_Êags
(
	`EVP_CIPHER_CTX_cùhî
(c))

	)

494 
	#EVP_CIPHER_CTX_mode
(
c
Ë
	`EVP_CIPHER_mode
(
	`EVP_CIPHER_CTX_cùhî
(c))

	)

496 
	#EVP_ENCODE_LENGTH
(
l
Ë(((÷)+2)/3*4)+(÷)/48+1)*2+80)

	)

497 
	#EVP_DECODE_LENGTH
(
l
Ë((÷)+3)/4*3+80)

	)

499 
	#EVP_SignInô_ex
(
a
,
b
,
c
Ë
	`EVP_Dige°Inô_ex
◊,b,c)

	)

500 
	#EVP_SignInô
(
a
,
b
Ë
	`EVP_Dige°Inô
◊,b)

	)

501 
	#EVP_SignUpd©e
(
a
,
b
,
c
Ë
	`EVP_Dige°Upd©e
◊,b,c)

	)

502 
	#EVP_VîifyInô_ex
(
a
,
b
,
c
Ë
	`EVP_Dige°Inô_ex
◊,b,c)

	)

503 
	#EVP_VîifyInô
(
a
,
b
Ë
	`EVP_Dige°Inô
◊,b)

	)

504 
	#EVP_VîifyUpd©e
(
a
,
b
,
c
Ë
	`EVP_Dige°Upd©e
◊,b,c)

	)

505 
	#EVP_O≥nUpd©e
(
a
,
b
,
c
,
d
,
e
Ë
	`EVP_De¸y±Upd©e
◊,b,c,d,e)

	)

506 
	#EVP_SólUpd©e
(
a
,
b
,
c
,
d
,
e
Ë
	`EVP_En¸y±Upd©e
◊,b,c,d,e)

	)

507 
	#EVP_Dige°SignUpd©e
(
a
,
b
,
c
Ë
	`EVP_Dige°Upd©e
◊,b,c)

	)

508 
	#EVP_Dige°VîifyUpd©e
(
a
,
b
,
c
Ë
	`EVP_Dige°Upd©e
◊,b,c)

	)

510 #ifde‡
CONST_STRICT


511 
BIO_£t_md
(
BIO
 *, c⁄° 
EVP_MD
 *
md
);

513 
	#BIO_£t_md
(
b
,
md
Ë
	`BIO_˘æ
(b,
BIO_C_SET_MD
,0,(*)(md))

	)

515 
	#BIO_gë_md
(
b
,
mdp
Ë
	`BIO_˘æ
(b,
BIO_C_GET_MD
,0,(*)(mdp))

	)

516 
	#BIO_gë_md_˘x
(
b
,
md˝
Ë
	`BIO_˘æ
(b,
BIO_C_GET_MD_CTX
,0, \

517 (*)(
md˝
))

	)

518 
	#BIO_£t_md_˘x
(
b
,
md˝
Ë
	`BIO_˘æ
(b,
BIO_C_SET_MD_CTX
,0, \

519 (*)(
md˝
))

	)

520 
	#BIO_gë_cùhî_°©us
(
b
Ë
	`BIO_˘æ
(b,
BIO_C_GET_CIPHER_STATUS
,0,
NULL
)

	)

521 
	#BIO_gë_cùhî_˘x
(
b
,
c_µ
Ë
	`BIO_˘æ
(b,
BIO_C_GET_CIPHER_CTX
,0, \

522 (*)(
c_µ
))

	)

524  
EVP_Cùhî
(
EVP_CIPHER_CTX
 *
c
,

525 *
out
,

526 c⁄° *
ö
, 
öl
);

528 
	#EVP_add_cùhî_Æüs
(
n
,
Æüs
) \

529 
	`OBJ_NAME_add
((
Æüs
),
OBJ_NAME_TYPE_CIPHER_METH
|
OBJ_NAME_ALIAS
,(
n
))

	)

530 
	#EVP_add_dige°_Æüs
(
n
,
Æüs
) \

531 
	`OBJ_NAME_add
((
Æüs
),
OBJ_NAME_TYPE_MD_METH
|
OBJ_NAME_ALIAS
,(
n
))

	)

532 
	#EVP_dñëe_cùhî_Æüs
(
Æüs
) \

533 
	`OBJ_NAME_ªmove
(
Æüs
,
OBJ_NAME_TYPE_CIPHER_METH
|
OBJ_NAME_ALIAS
);

	)

534 
	#EVP_dñëe_dige°_Æüs
(
Æüs
) \

535 
	`OBJ_NAME_ªmove
(
Æüs
,
OBJ_NAME_TYPE_MD_METH
|
OBJ_NAME_ALIAS
);

	)

537 
EVP_MD_CTX_˘æ
(
EVP_MD_CTX
 *
˘x
, 
cmd
, 
p1
, *
p2
);

538 
EVP_MD_CTX
 *
EVP_MD_CTX_√w
();

539 
EVP_MD_CTX_ª£t
(
EVP_MD_CTX
 *
˘x
);

540 
EVP_MD_CTX_‰ì
(
EVP_MD_CTX
 *
˘x
);

541 
	#EVP_MD_CTX_¸óã
(Ë
	`EVP_MD_CTX_√w
()

	)

542 
	#EVP_MD_CTX_öô
(
˘x
Ë
	`EVP_MD_CTX_ª£t
((˘x))

	)

543 
	#EVP_MD_CTX_de°roy
(
˘x
Ë
	`EVP_MD_CTX_‰ì
((˘x))

	)

544 
__owur
 
EVP_MD_CTX_c›y_ex
(
EVP_MD_CTX
 *
out
, c⁄° EVP_MD_CTX *
ö
);

545 
EVP_MD_CTX_£t_Êags
(
EVP_MD_CTX
 *
˘x
, 
Êags
);

546 
EVP_MD_CTX_˛ór_Êags
(
EVP_MD_CTX
 *
˘x
, 
Êags
);

547 
EVP_MD_CTX_ã°_Êags
(c⁄° 
EVP_MD_CTX
 *
˘x
, 
Êags
);

548 
__owur
 
EVP_Dige°Inô_ex
(
EVP_MD_CTX
 *
˘x
, c⁄° 
EVP_MD
 *
ty≥
,

549 
ENGINE
 *
im∂
);

550 
__owur
 
EVP_Dige°Upd©e
(
EVP_MD_CTX
 *
˘x
, c⁄° *
d
,

551 
size_t
 
˙t
);

552 
__owur
 
EVP_Dige°FöÆ_ex
(
EVP_MD_CTX
 *
˘x
, *
md
,

553 *
s
);

554 
__owur
 
EVP_Dige°
(c⁄° *
d©a
, 
size_t
 
cou¡
,

555 *
md
, *
size
,

556 c⁄° 
EVP_MD
 *
ty≥
, 
ENGINE
 *
im∂
);

558 
__owur
 
EVP_MD_CTX_c›y
(
EVP_MD_CTX
 *
out
, c⁄° EVP_MD_CTX *
ö
);

559 
__owur
 
EVP_Dige°Inô
(
EVP_MD_CTX
 *
˘x
, c⁄° 
EVP_MD
 *
ty≥
);

560 
__owur
 
EVP_Dige°FöÆ
(
EVP_MD_CTX
 *
˘x
, *
md
,

561 *
s
);

562 
__owur
 
EVP_Dige°FöÆXOF
(
EVP_MD_CTX
 *
˘x
, *
md
,

563 
size_t
 
Àn
);

565 
EVP_ªad_pw_°rög
(*
buf
, 
Àngth
, c⁄° *
¥om±
, 
vîify
);

566 
EVP_ªad_pw_°rög_mö
(*
buf
, 
möÀn
, 
maxÀn
,

567 c⁄° *
¥om±
, 
vîify
);

568 
EVP_£t_pw_¥om±
(c⁄° *
¥om±
);

569 *
EVP_gë_pw_¥om±
();

571 
__owur
 
EVP_ByãsToKey
(c⁄° 
EVP_CIPHER
 *
ty≥
, c⁄° 
EVP_MD
 *
md
,

572 c⁄° *
ß…
,

573 c⁄° *
d©a
, 
d©Æ
, 
cou¡
,

574 *
key
, *
iv
);

576 
EVP_CIPHER_CTX_£t_Êags
(
EVP_CIPHER_CTX
 *
˘x
, 
Êags
);

577 
EVP_CIPHER_CTX_˛ór_Êags
(
EVP_CIPHER_CTX
 *
˘x
, 
Êags
);

578 
EVP_CIPHER_CTX_ã°_Êags
(c⁄° 
EVP_CIPHER_CTX
 *
˘x
, 
Êags
);

580 
__owur
 
EVP_En¸y±Inô
(
EVP_CIPHER_CTX
 *
˘x
, c⁄° 
EVP_CIPHER
 *
cùhî
,

581 c⁄° *
key
, c⁄° *
iv
);

582  
EVP_En¸y±Inô_ex
(
EVP_CIPHER_CTX
 *
˘x
,

583 c⁄° 
EVP_CIPHER
 *
cùhî
, 
ENGINE
 *
im∂
,

584 c⁄° *
key
,

585 c⁄° *
iv
);

586  
EVP_En¸y±Upd©e
(
EVP_CIPHER_CTX
 *
˘x
, *
out
,

587 *
oué
, c⁄° *
ö
, 
öl
);

588  
EVP_En¸y±FöÆ_ex
(
EVP_CIPHER_CTX
 *
˘x
, *
out
,

589 *
oué
);

590  
EVP_En¸y±FöÆ
(
EVP_CIPHER_CTX
 *
˘x
, *
out
,

591 *
oué
);

593 
__owur
 
EVP_De¸y±Inô
(
EVP_CIPHER_CTX
 *
˘x
, c⁄° 
EVP_CIPHER
 *
cùhî
,

594 c⁄° *
key
, c⁄° *
iv
);

595  
EVP_De¸y±Inô_ex
(
EVP_CIPHER_CTX
 *
˘x
,

596 c⁄° 
EVP_CIPHER
 *
cùhî
, 
ENGINE
 *
im∂
,

597 c⁄° *
key
,

598 c⁄° *
iv
);

599  
EVP_De¸y±Upd©e
(
EVP_CIPHER_CTX
 *
˘x
, *
out
,

600 *
oué
, c⁄° *
ö
, 
öl
);

601 
__owur
 
EVP_De¸y±FöÆ
(
EVP_CIPHER_CTX
 *
˘x
, *
outm
,

602 *
oué
);

603  
EVP_De¸y±FöÆ_ex
(
EVP_CIPHER_CTX
 *
˘x
, *
outm
,

604 *
oué
);

606 
__owur
 
EVP_CùhîInô
(
EVP_CIPHER_CTX
 *
˘x
, c⁄° 
EVP_CIPHER
 *
cùhî
,

607 c⁄° *
key
, c⁄° *
iv
,

608 
íc
);

609  
EVP_CùhîInô_ex
(
EVP_CIPHER_CTX
 *
˘x
,

610 c⁄° 
EVP_CIPHER
 *
cùhî
, 
ENGINE
 *
im∂
,

611 c⁄° *
key
,

612 c⁄° *
iv
, 
íc
);

613 
__owur
 
EVP_CùhîUpd©e
(
EVP_CIPHER_CTX
 *
˘x
, *
out
,

614 *
oué
, c⁄° *
ö
, 
öl
);

615 
__owur
 
EVP_CùhîFöÆ
(
EVP_CIPHER_CTX
 *
˘x
, *
outm
,

616 *
oué
);

617 
__owur
 
EVP_CùhîFöÆ_ex
(
EVP_CIPHER_CTX
 *
˘x
, *
outm
,

618 *
oué
);

620 
__owur
 
EVP_SignFöÆ
(
EVP_MD_CTX
 *
˘x
, *
md
, *
s
,

621 
EVP_PKEY
 *
pkey
);

623 
__owur
 
EVP_Dige°Sign
(
EVP_MD_CTX
 *
˘x
, *
sigªt
,

624 
size_t
 *
sigÀn
, c⁄° *
tbs
,

625 
size_t
 
tb¶í
);

627 
__owur
 
EVP_VîifyFöÆ
(
EVP_MD_CTX
 *
˘x
, c⁄° *
sigbuf
,

628 
sigÀn
, 
EVP_PKEY
 *
pkey
);

630 
__owur
 
EVP_Dige°Vîify
(
EVP_MD_CTX
 *
˘x
, c⁄° *
sigªt
,

631 
size_t
 
sigÀn
, c⁄° *
tbs
,

632 
size_t
 
tb¶í
);

634  
EVP_Dige°SignInô
(
EVP_MD_CTX
 *
˘x
, 
EVP_PKEY_CTX
 **
p˘x
,

635 c⁄° 
EVP_MD
 *
ty≥
, 
ENGINE
 *
e
,

636 
EVP_PKEY
 *
pkey
);

637 
__owur
 
EVP_Dige°SignFöÆ
(
EVP_MD_CTX
 *
˘x
, *
sigªt
,

638 
size_t
 *
sigÀn
);

640 
__owur
 
EVP_Dige°VîifyInô
(
EVP_MD_CTX
 *
˘x
, 
EVP_PKEY_CTX
 **
p˘x
,

641 c⁄° 
EVP_MD
 *
ty≥
, 
ENGINE
 *
e
,

642 
EVP_PKEY
 *
pkey
);

643 
__owur
 
EVP_Dige°VîifyFöÆ
(
EVP_MD_CTX
 *
˘x
, c⁄° *
sig
,

644 
size_t
 
sigÀn
);

646 #i‚de‡
OPENSSL_NO_RSA


647 
__owur
 
EVP_O≥nInô
(
EVP_CIPHER_CTX
 *
˘x
, c⁄° 
EVP_CIPHER
 *
ty≥
,

648 c⁄° *
ek
, 
ekl
,

649 c⁄° *
iv
, 
EVP_PKEY
 *
¥iv
);

650 
__owur
 
EVP_O≥nFöÆ
(
EVP_CIPHER_CTX
 *
˘x
, *
out
, *
oué
);

652 
__owur
 
EVP_SólInô
(
EVP_CIPHER_CTX
 *
˘x
, c⁄° 
EVP_CIPHER
 *
ty≥
,

653 **
ek
, *
ekl
, *
iv
,

654 
EVP_PKEY
 **
pubk
, 
≈ubk
);

655 
__owur
 
EVP_SólFöÆ
(
EVP_CIPHER_CTX
 *
˘x
, *
out
, *
oué
);

658 
EVP_ENCODE_CTX
 *
EVP_ENCODE_CTX_√w
();

659 
EVP_ENCODE_CTX_‰ì
(
EVP_ENCODE_CTX
 *
˘x
);

660 
EVP_ENCODE_CTX_c›y
(
EVP_ENCODE_CTX
 *
d˘x
, EVP_ENCODE_CTX *
s˘x
);

661 
EVP_ENCODE_CTX_num
(
EVP_ENCODE_CTX
 *
˘x
);

662 
EVP_EncodeInô
(
EVP_ENCODE_CTX
 *
˘x
);

663 
EVP_EncodeUpd©e
(
EVP_ENCODE_CTX
 *
˘x
, *
out
, *
oué
,

664 c⁄° *
ö
, 
öl
);

665 
EVP_EncodeFöÆ
(
EVP_ENCODE_CTX
 *
˘x
, *
out
, *
oué
);

666 
EVP_EncodeBlock
(*
t
, c⁄° *
f
, 
n
);

668 
EVP_DecodeInô
(
EVP_ENCODE_CTX
 *
˘x
);

669 
EVP_DecodeUpd©e
(
EVP_ENCODE_CTX
 *
˘x
, *
out
, *
oué
,

670 c⁄° *
ö
, 
öl
);

671 
EVP_DecodeFöÆ
(
EVP_ENCODE_CTX
 *
˘x
, 

672 *
out
, *
oué
);

673 
EVP_DecodeBlock
(*
t
, c⁄° *
f
, 
n
);

675 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

676 
	#EVP_CIPHER_CTX_öô
(
c
Ë
	`EVP_CIPHER_CTX_ª£t
(c)

	)

677 
	#EVP_CIPHER_CTX_˛ónup
(
c
Ë
	`EVP_CIPHER_CTX_ª£t
(c)

	)

679 
EVP_CIPHER_CTX
 *
EVP_CIPHER_CTX_√w
();

680 
EVP_CIPHER_CTX_ª£t
(
EVP_CIPHER_CTX
 *
c
);

681 
EVP_CIPHER_CTX_‰ì
(
EVP_CIPHER_CTX
 *
c
);

682 
EVP_CIPHER_CTX_£t_key_Àngth
(
EVP_CIPHER_CTX
 *
x
, 
keyÀn
);

683 
EVP_CIPHER_CTX_£t_∑ddög
(
EVP_CIPHER_CTX
 *
c
, 
∑d
);

684 
EVP_CIPHER_CTX_˘æ
(
EVP_CIPHER_CTX
 *
˘x
, 
ty≥
, 
¨g
, *
±r
);

685 
EVP_CIPHER_CTX_ønd_key
(
EVP_CIPHER_CTX
 *
˘x
, *
key
);

687 c⁄° 
BIO_METHOD
 *
BIO_f_md
();

688 c⁄° 
BIO_METHOD
 *
BIO_f_ba£64
();

689 c⁄° 
BIO_METHOD
 *
BIO_f_cùhî
();

690 c⁄° 
BIO_METHOD
 *
BIO_f_ªlübÀ
();

691 
__owur
 
BIO_£t_cùhî
(
BIO
 *
b
, c⁄° 
EVP_CIPHER
 *
c
, c⁄° *
k
,

692 c⁄° *
i
, 
íc
);

694 c⁄° 
EVP_MD
 *
EVP_md_nuŒ
();

695 #i‚de‡
OPENSSL_NO_MD2


696 c⁄° 
EVP_MD
 *
EVP_md2
();

698 #i‚de‡
OPENSSL_NO_MD4


699 c⁄° 
EVP_MD
 *
EVP_md4
();

701 #i‚de‡
OPENSSL_NO_MD5


702 c⁄° 
EVP_MD
 *
EVP_md5
();

703 c⁄° 
EVP_MD
 *
EVP_md5_sha1
();

705 #i‚de‡
OPENSSL_NO_BLAKE2


706 c⁄° 
EVP_MD
 *
EVP_bœke2b512
();

707 c⁄° 
EVP_MD
 *
EVP_bœke2s256
();

709 c⁄° 
EVP_MD
 *
EVP_sha1
();

710 c⁄° 
EVP_MD
 *
EVP_sha224
();

711 c⁄° 
EVP_MD
 *
EVP_sha256
();

712 c⁄° 
EVP_MD
 *
EVP_sha384
();

713 c⁄° 
EVP_MD
 *
EVP_sha512
();

714 c⁄° 
EVP_MD
 *
EVP_sha512_224
();

715 c⁄° 
EVP_MD
 *
EVP_sha512_256
();

716 c⁄° 
EVP_MD
 *
EVP_sha3_224
();

717 c⁄° 
EVP_MD
 *
EVP_sha3_256
();

718 c⁄° 
EVP_MD
 *
EVP_sha3_384
();

719 c⁄° 
EVP_MD
 *
EVP_sha3_512
();

720 c⁄° 
EVP_MD
 *
EVP_shake128
();

721 c⁄° 
EVP_MD
 *
EVP_shake256
();

722 #i‚de‡
OPENSSL_NO_MDC2


723 c⁄° 
EVP_MD
 *
EVP_mdc2
();

725 #i‚de‡
OPENSSL_NO_RMD160


726 c⁄° 
EVP_MD
 *
EVP_rùemd160
();

728 #i‚de‡
OPENSSL_NO_WHIRLPOOL


729 c⁄° 
EVP_MD
 *
EVP_whúÕoﬁ
();

731 #i‚de‡
OPENSSL_NO_SM3


732 c⁄° 
EVP_MD
 *
EVP_sm3
();

734 c⁄° 
EVP_CIPHER
 *
EVP_íc_nuŒ
();

735 #i‚de‡
OPENSSL_NO_DES


736 c⁄° 
EVP_CIPHER
 *
EVP_des_ecb
();

737 c⁄° 
EVP_CIPHER
 *
EVP_des_ede
();

738 c⁄° 
EVP_CIPHER
 *
EVP_des_ede3
();

739 c⁄° 
EVP_CIPHER
 *
EVP_des_ede_ecb
();

740 c⁄° 
EVP_CIPHER
 *
EVP_des_ede3_ecb
();

741 c⁄° 
EVP_CIPHER
 *
EVP_des_cfb64
();

742 
	#EVP_des_cfb
 
EVP_des_cfb64


	)

743 c⁄° 
EVP_CIPHER
 *
EVP_des_cfb1
();

744 c⁄° 
EVP_CIPHER
 *
EVP_des_cfb8
();

745 c⁄° 
EVP_CIPHER
 *
EVP_des_ede_cfb64
();

746 
	#EVP_des_ede_cfb
 
EVP_des_ede_cfb64


	)

747 c⁄° 
EVP_CIPHER
 *
EVP_des_ede3_cfb64
();

748 
	#EVP_des_ede3_cfb
 
EVP_des_ede3_cfb64


	)

749 c⁄° 
EVP_CIPHER
 *
EVP_des_ede3_cfb1
();

750 c⁄° 
EVP_CIPHER
 *
EVP_des_ede3_cfb8
();

751 c⁄° 
EVP_CIPHER
 *
EVP_des_ofb
();

752 c⁄° 
EVP_CIPHER
 *
EVP_des_ede_ofb
();

753 c⁄° 
EVP_CIPHER
 *
EVP_des_ede3_ofb
();

754 c⁄° 
EVP_CIPHER
 *
EVP_des_cbc
();

755 c⁄° 
EVP_CIPHER
 *
EVP_des_ede_cbc
();

756 c⁄° 
EVP_CIPHER
 *
EVP_des_ede3_cbc
();

757 c⁄° 
EVP_CIPHER
 *
EVP_desx_cbc
();

758 c⁄° 
EVP_CIPHER
 *
EVP_des_ede3_wøp
();

765 #i‚de‡
OPENSSL_NO_RC4


766 c⁄° 
EVP_CIPHER
 *
EVP_rc4
();

767 c⁄° 
EVP_CIPHER
 *
EVP_rc4_40
();

768 #i‚de‡
OPENSSL_NO_MD5


769 c⁄° 
EVP_CIPHER
 *
EVP_rc4_hmac_md5
();

772 #i‚de‡
OPENSSL_NO_IDEA


773 c⁄° 
EVP_CIPHER
 *
EVP_idó_ecb
();

774 c⁄° 
EVP_CIPHER
 *
EVP_idó_cfb64
();

775 
	#EVP_idó_cfb
 
EVP_idó_cfb64


	)

776 c⁄° 
EVP_CIPHER
 *
EVP_idó_ofb
();

777 c⁄° 
EVP_CIPHER
 *
EVP_idó_cbc
();

779 #i‚de‡
OPENSSL_NO_RC2


780 c⁄° 
EVP_CIPHER
 *
EVP_rc2_ecb
();

781 c⁄° 
EVP_CIPHER
 *
EVP_rc2_cbc
();

782 c⁄° 
EVP_CIPHER
 *
EVP_rc2_40_cbc
();

783 c⁄° 
EVP_CIPHER
 *
EVP_rc2_64_cbc
();

784 c⁄° 
EVP_CIPHER
 *
EVP_rc2_cfb64
();

785 
	#EVP_rc2_cfb
 
EVP_rc2_cfb64


	)

786 c⁄° 
EVP_CIPHER
 *
EVP_rc2_ofb
();

788 #i‚de‡
OPENSSL_NO_BF


789 c⁄° 
EVP_CIPHER
 *
EVP_bf_ecb
();

790 c⁄° 
EVP_CIPHER
 *
EVP_bf_cbc
();

791 c⁄° 
EVP_CIPHER
 *
EVP_bf_cfb64
();

792 
	#EVP_bf_cfb
 
EVP_bf_cfb64


	)

793 c⁄° 
EVP_CIPHER
 *
EVP_bf_ofb
();

795 #i‚de‡
OPENSSL_NO_CAST


796 c⁄° 
EVP_CIPHER
 *
EVP_ˇ°5_ecb
();

797 c⁄° 
EVP_CIPHER
 *
EVP_ˇ°5_cbc
();

798 c⁄° 
EVP_CIPHER
 *
EVP_ˇ°5_cfb64
();

799 
	#EVP_ˇ°5_cfb
 
EVP_ˇ°5_cfb64


	)

800 c⁄° 
EVP_CIPHER
 *
EVP_ˇ°5_ofb
();

802 #i‚de‡
OPENSSL_NO_RC5


803 c⁄° 
EVP_CIPHER
 *
EVP_rc5_32_12_16_cbc
();

804 c⁄° 
EVP_CIPHER
 *
EVP_rc5_32_12_16_ecb
();

805 c⁄° 
EVP_CIPHER
 *
EVP_rc5_32_12_16_cfb64
();

806 
	#EVP_rc5_32_12_16_cfb
 
EVP_rc5_32_12_16_cfb64


	)

807 c⁄° 
EVP_CIPHER
 *
EVP_rc5_32_12_16_ofb
();

809 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_ecb
();

810 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_cbc
();

811 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_cfb1
();

812 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_cfb8
();

813 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_cfb128
();

814 
	#EVP_´s_128_cfb
 
EVP_´s_128_cfb128


	)

815 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_ofb
();

816 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_˘r
();

817 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_ccm
();

818 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_gcm
();

819 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_xts
();

820 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_wøp
();

821 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_wøp_∑d
();

822 #i‚de‡
OPENSSL_NO_OCB


823 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_ocb
();

825 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_ecb
();

826 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_cbc
();

827 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_cfb1
();

828 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_cfb8
();

829 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_cfb128
();

830 
	#EVP_´s_192_cfb
 
EVP_´s_192_cfb128


	)

831 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_ofb
();

832 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_˘r
();

833 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_ccm
();

834 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_gcm
();

835 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_wøp
();

836 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_wøp_∑d
();

837 #i‚de‡
OPENSSL_NO_OCB


838 c⁄° 
EVP_CIPHER
 *
EVP_´s_192_ocb
();

840 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_ecb
();

841 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_cbc
();

842 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_cfb1
();

843 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_cfb8
();

844 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_cfb128
();

845 
	#EVP_´s_256_cfb
 
EVP_´s_256_cfb128


	)

846 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_ofb
();

847 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_˘r
();

848 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_ccm
();

849 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_gcm
();

850 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_xts
();

851 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_wøp
();

852 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_wøp_∑d
();

853 #i‚de‡
OPENSSL_NO_OCB


854 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_ocb
();

856 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_cbc_hmac_sha1
();

857 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_cbc_hmac_sha1
();

858 c⁄° 
EVP_CIPHER
 *
EVP_´s_128_cbc_hmac_sha256
();

859 c⁄° 
EVP_CIPHER
 *
EVP_´s_256_cbc_hmac_sha256
();

860 #i‚de‡
OPENSSL_NO_ARIA


861 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_128_ecb
();

862 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_128_cbc
();

863 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_128_cfb1
();

864 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_128_cfb8
();

865 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_128_cfb128
();

866 
	#EVP_¨ü_128_cfb
 
EVP_¨ü_128_cfb128


	)

867 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_128_˘r
();

868 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_128_ofb
();

869 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_128_gcm
();

870 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_128_ccm
();

871 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_192_ecb
();

872 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_192_cbc
();

873 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_192_cfb1
();

874 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_192_cfb8
();

875 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_192_cfb128
();

876 
	#EVP_¨ü_192_cfb
 
EVP_¨ü_192_cfb128


	)

877 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_192_˘r
();

878 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_192_ofb
();

879 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_192_gcm
();

880 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_192_ccm
();

881 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_256_ecb
();

882 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_256_cbc
();

883 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_256_cfb1
();

884 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_256_cfb8
();

885 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_256_cfb128
();

886 
	#EVP_¨ü_256_cfb
 
EVP_¨ü_256_cfb128


	)

887 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_256_˘r
();

888 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_256_ofb
();

889 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_256_gcm
();

890 c⁄° 
EVP_CIPHER
 *
EVP_¨ü_256_ccm
();

892 #i‚de‡
OPENSSL_NO_CAMELLIA


893 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_128_ecb
();

894 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_128_cbc
();

895 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_128_cfb1
();

896 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_128_cfb8
();

897 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_128_cfb128
();

898 
	#EVP_ˇmñlü_128_cfb
 
EVP_ˇmñlü_128_cfb128


	)

899 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_128_ofb
();

900 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_128_˘r
();

901 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_192_ecb
();

902 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_192_cbc
();

903 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_192_cfb1
();

904 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_192_cfb8
();

905 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_192_cfb128
();

906 
	#EVP_ˇmñlü_192_cfb
 
EVP_ˇmñlü_192_cfb128


	)

907 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_192_ofb
();

908 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_192_˘r
();

909 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_256_ecb
();

910 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_256_cbc
();

911 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_256_cfb1
();

912 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_256_cfb8
();

913 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_256_cfb128
();

914 
	#EVP_ˇmñlü_256_cfb
 
EVP_ˇmñlü_256_cfb128


	)

915 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_256_ofb
();

916 c⁄° 
EVP_CIPHER
 *
EVP_ˇmñlü_256_˘r
();

918 #i‚de‡
OPENSSL_NO_CHACHA


919 c⁄° 
EVP_CIPHER
 *
EVP_chacha20
();

920 #i‚de‡
OPENSSL_NO_POLY1305


921 c⁄° 
EVP_CIPHER
 *
EVP_chacha20_pﬁy1305
();

925 #i‚de‡
OPENSSL_NO_SEED


926 c⁄° 
EVP_CIPHER
 *
EVP_£ed_ecb
();

927 c⁄° 
EVP_CIPHER
 *
EVP_£ed_cbc
();

928 c⁄° 
EVP_CIPHER
 *
EVP_£ed_cfb128
();

929 
	#EVP_£ed_cfb
 
EVP_£ed_cfb128


	)

930 c⁄° 
EVP_CIPHER
 *
EVP_£ed_ofb
();

933 #i‚de‡
OPENSSL_NO_SM4


934 c⁄° 
EVP_CIPHER
 *
EVP_sm4_ecb
();

935 c⁄° 
EVP_CIPHER
 *
EVP_sm4_cbc
();

936 c⁄° 
EVP_CIPHER
 *
EVP_sm4_cfb128
();

937 
	#EVP_sm4_cfb
 
EVP_sm4_cfb128


	)

938 c⁄° 
EVP_CIPHER
 *
EVP_sm4_ofb
();

939 c⁄° 
EVP_CIPHER
 *
EVP_sm4_˘r
();

942 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

943 
	#OPENSSL_add_Æl_Æg‹ôhms_c⁄f
() \

944 
	`OPENSSL_öô_¸y±o
(
OPENSSL_INIT_ADD_ALL_CIPHERS
 \

945 | 
OPENSSL_INIT_ADD_ALL_DIGESTS
 \

946 | 
OPENSSL_INIT_LOAD_CONFIG
, 
NULL
)

	)

947 
	#OPENSSL_add_Æl_Æg‹ôhms_noc⁄f
() \

948 
	`OPENSSL_öô_¸y±o
(
OPENSSL_INIT_ADD_ALL_CIPHERS
 \

949 | 
OPENSSL_INIT_ADD_ALL_DIGESTS
, 
NULL
)

	)

951 #ifde‡
OPENSSL_LOAD_CONF


952 
	#O≥nSSL_add_Æl_Æg‹ôhms
(Ë
	`OPENSSL_add_Æl_Æg‹ôhms_c⁄f
()

	)

954 
	#O≥nSSL_add_Æl_Æg‹ôhms
(Ë
	`OPENSSL_add_Æl_Æg‹ôhms_noc⁄f
()

	)

957 
	#O≥nSSL_add_Æl_cùhîs
() \

958 
	`OPENSSL_öô_¸y±o
(
OPENSSL_INIT_ADD_ALL_CIPHERS
, 
NULL
)

	)

959 
	#O≥nSSL_add_Æl_dige°s
() \

960 
	`OPENSSL_öô_¸y±o
(
OPENSSL_INIT_ADD_ALL_DIGESTS
, 
NULL
)

	)

962 
	#EVP_˛ónup
(Ë0Ë

	)

965 
EVP_add_cùhî
(c⁄° 
EVP_CIPHER
 *
cùhî
);

966 
EVP_add_dige°
(c⁄° 
EVP_MD
 *
dige°
);

968 c⁄° 
EVP_CIPHER
 *
EVP_gë_cùhîby«me
(c⁄° *
«me
);

969 c⁄° 
EVP_MD
 *
EVP_gë_dige°by«me
(c⁄° *
«me
);

971 
EVP_CIPHER_do_Æl
((*
‚
Ë(c⁄° 
EVP_CIPHER
 *
cùh
,

972 c⁄° *
‰om
, c⁄° *
to
, *
x
),

973 *
¨g
);

974 
EVP_CIPHER_do_Æl_s‹ãd
((*
‚
)

975 (c⁄° 
EVP_CIPHER
 *
cùh
, c⁄° *
‰om
,

976 c⁄° *
to
, *
x
), *
¨g
);

978 
EVP_MD_do_Æl
((*
‚
Ë(c⁄° 
EVP_MD
 *
cùh
,

979 c⁄° *
‰om
, c⁄° *
to
, *
x
),

980 *
¨g
);

981 
EVP_MD_do_Æl_s‹ãd
((*
‚
)

982 (c⁄° 
EVP_MD
 *
cùh
, c⁄° *
‰om
,

983 c⁄° *
to
, *
x
), *
¨g
);

985 
EVP_PKEY_de¸y±_ﬁd
(*
dec_key
,

986 c⁄° *
íc_key
, 
íc_key_Àn
,

987 
EVP_PKEY
 *
¥iv©e_key
);

988 
EVP_PKEY_í¸y±_ﬁd
(*
íc_key
,

989 c⁄° *
key
, 
key_Àn
,

990 
EVP_PKEY
 *
pub_key
);

991 
EVP_PKEY_ty≥
(
ty≥
);

992 
EVP_PKEY_id
(c⁄° 
EVP_PKEY
 *
pkey
);

993 
EVP_PKEY_ba£_id
(c⁄° 
EVP_PKEY
 *
pkey
);

994 
EVP_PKEY_bôs
(c⁄° 
EVP_PKEY
 *
pkey
);

995 
EVP_PKEY_£curôy_bôs
(c⁄° 
EVP_PKEY
 *
pkey
);

996 
EVP_PKEY_size
(c⁄° 
EVP_PKEY
 *
pkey
);

997 
EVP_PKEY_£t_ty≥
(
EVP_PKEY
 *
pkey
, 
ty≥
);

998 
EVP_PKEY_£t_ty≥_°r
(
EVP_PKEY
 *
pkey
, c⁄° *
°r
, 
Àn
);

999 
EVP_PKEY_£t_Æüs_ty≥
(
EVP_PKEY
 *
pkey
, 
ty≥
);

1000 #i‚de‡
OPENSSL_NO_ENGINE


1001 
EVP_PKEY_£t1_ígöe
(
EVP_PKEY
 *
pkey
, 
ENGINE
 *
e
);

1002 
ENGINE
 *
EVP_PKEY_gë0_ígöe
(c⁄° 
EVP_PKEY
 *
pkey
);

1004 
EVP_PKEY_assign
(
EVP_PKEY
 *
pkey
, 
ty≥
, *
key
);

1005 *
EVP_PKEY_gë0
(c⁄° 
EVP_PKEY
 *
pkey
);

1006 c⁄° *
EVP_PKEY_gë0_hmac
(c⁄° 
EVP_PKEY
 *
pkey
, 
size_t
 *
Àn
);

1007 #i‚de‡
OPENSSL_NO_POLY1305


1008 c⁄° *
EVP_PKEY_gë0_pﬁy1305
(c⁄° 
EVP_PKEY
 *
pkey
, 
size_t
 *
Àn
);

1010 #i‚de‡
OPENSSL_NO_SIPHASH


1011 c⁄° *
EVP_PKEY_gë0_sùhash
(c⁄° 
EVP_PKEY
 *
pkey
, 
size_t
 *
Àn
);

1014 #i‚de‡
OPENSSL_NO_RSA


1015 
rß_°
;

1016 
EVP_PKEY_£t1_RSA
(
EVP_PKEY
 *
pkey
, 
rß_°
 *
key
);

1017 
rß_°
 *
EVP_PKEY_gë0_RSA
(
EVP_PKEY
 *
pkey
);

1018 
rß_°
 *
EVP_PKEY_gë1_RSA
(
EVP_PKEY
 *
pkey
);

1020 #i‚de‡
OPENSSL_NO_DSA


1021 
dß_°
;

1022 
EVP_PKEY_£t1_DSA
(
EVP_PKEY
 *
pkey
, 
dß_°
 *
key
);

1023 
dß_°
 *
EVP_PKEY_gë0_DSA
(
EVP_PKEY
 *
pkey
);

1024 
dß_°
 *
EVP_PKEY_gë1_DSA
(
EVP_PKEY
 *
pkey
);

1026 #i‚de‡
OPENSSL_NO_DH


1027 
dh_°
;

1028 
EVP_PKEY_£t1_DH
(
EVP_PKEY
 *
pkey
, 
dh_°
 *
key
);

1029 
dh_°
 *
EVP_PKEY_gë0_DH
(
EVP_PKEY
 *
pkey
);

1030 
dh_°
 *
EVP_PKEY_gë1_DH
(
EVP_PKEY
 *
pkey
);

1032 #i‚de‡
OPENSSL_NO_EC


1033 
ec_key_°
;

1034 
EVP_PKEY_£t1_EC_KEY
(
EVP_PKEY
 *
pkey
, 
ec_key_°
 *
key
);

1035 
ec_key_°
 *
EVP_PKEY_gë0_EC_KEY
(
EVP_PKEY
 *
pkey
);

1036 
ec_key_°
 *
EVP_PKEY_gë1_EC_KEY
(
EVP_PKEY
 *
pkey
);

1039 
EVP_PKEY
 *
EVP_PKEY_√w
();

1040 
EVP_PKEY_up_ªf
(
EVP_PKEY
 *
pkey
);

1041 
EVP_PKEY_‰ì
(
EVP_PKEY
 *
pkey
);

1043 
EVP_PKEY
 *
d2i_PublicKey
(
ty≥
, EVP_PKEY **
a
, c⁄° **
µ
,

1044 
Àngth
);

1045 
i2d_PublicKey
(
EVP_PKEY
 *
a
, **
µ
);

1047 
EVP_PKEY
 *
d2i_Priv©eKey
(
ty≥
, EVP_PKEY **
a
, c⁄° **
µ
,

1048 
Àngth
);

1049 
EVP_PKEY
 *
d2i_AutoPriv©eKey
(EVP_PKEY **
a
, c⁄° **
µ
,

1050 
Àngth
);

1051 
i2d_Priv©eKey
(
EVP_PKEY
 *
a
, **
µ
);

1053 
EVP_PKEY_c›y_∑ømëîs
(
EVP_PKEY
 *
to
, c⁄° EVP_PKEY *
‰om
);

1054 
EVP_PKEY_missög_∑ømëîs
(c⁄° 
EVP_PKEY
 *
pkey
);

1055 
EVP_PKEY_ßve_∑ømëîs
(
EVP_PKEY
 *
pkey
, 
mode
);

1056 
EVP_PKEY_cmp_∑ømëîs
(c⁄° 
EVP_PKEY
 *
a
, c⁄° EVP_PKEY *
b
);

1058 
EVP_PKEY_cmp
(c⁄° 
EVP_PKEY
 *
a
, c⁄° EVP_PKEY *
b
);

1060 
EVP_PKEY_¥öt_public
(
BIO
 *
out
, c⁄° 
EVP_PKEY
 *
pkey
,

1061 
ödít
, 
ASN1_PCTX
 *
p˘x
);

1062 
EVP_PKEY_¥öt_¥iv©e
(
BIO
 *
out
, c⁄° 
EVP_PKEY
 *
pkey
,

1063 
ödít
, 
ASN1_PCTX
 *
p˘x
);

1064 
EVP_PKEY_¥öt_∑øms
(
BIO
 *
out
, c⁄° 
EVP_PKEY
 *
pkey
,

1065 
ödít
, 
ASN1_PCTX
 *
p˘x
);

1067 
EVP_PKEY_gë_deÁu…_dige°_nid
(
EVP_PKEY
 *
pkey
, *
≤id
);

1069 
EVP_PKEY_£t1_és_ícodedpoöt
(
EVP_PKEY
 *
pkey
,

1070 c⁄° *
±
, 
size_t
 
±Àn
);

1071 
size_t
 
EVP_PKEY_gë1_és_ícodedpoöt
(
EVP_PKEY
 *
pkey
, **
µt
);

1073 
EVP_CIPHER_ty≥
(c⁄° 
EVP_CIPHER
 *
˘x
);

1076 
EVP_CIPHER_∑øm_to_a¢1
(
EVP_CIPHER_CTX
 *
c
, 
ASN1_TYPE
 *
ty≥
);

1077 
EVP_CIPHER_a¢1_to_∑øm
(
EVP_CIPHER_CTX
 *
c
, 
ASN1_TYPE
 *
ty≥
);

1080 
EVP_CIPHER_£t_a¢1_iv
(
EVP_CIPHER_CTX
 *
c
, 
ASN1_TYPE
 *
ty≥
);

1081 
EVP_CIPHER_gë_a¢1_iv
(
EVP_CIPHER_CTX
 *
c
, 
ASN1_TYPE
 *
ty≥
);

1084 
PKCS5_PBE_keyivgí
(
EVP_CIPHER_CTX
 *
˘x
, c⁄° *
∑ss
, 
∑s¶í
,

1085 
ASN1_TYPE
 *
∑øm
, c⁄° 
EVP_CIPHER
 *
cùhî
,

1086 c⁄° 
EVP_MD
 *
md
, 
í_de
);

1087 
PKCS5_PBKDF2_HMAC_SHA1
(c⁄° *
∑ss
, 
∑s¶í
,

1088 c⁄° *
ß…
, 
ß…Àn
, 
ôî
,

1089 
keyÀn
, *
out
);

1090 
PKCS5_PBKDF2_HMAC
(c⁄° *
∑ss
, 
∑s¶í
,

1091 c⁄° *
ß…
, 
ß…Àn
, 
ôî
,

1092 c⁄° 
EVP_MD
 *
dige°
, 
keyÀn
, *
out
);

1093 
PKCS5_v2_PBE_keyivgí
(
EVP_CIPHER_CTX
 *
˘x
, c⁄° *
∑ss
, 
∑s¶í
,

1094 
ASN1_TYPE
 *
∑øm
, c⁄° 
EVP_CIPHER
 *
cùhî
,

1095 c⁄° 
EVP_MD
 *
md
, 
í_de
);

1097 #i‚de‡
OPENSSL_NO_SCRYPT


1098 
EVP_PBE_s¸y±
(c⁄° *
∑ss
, 
size_t
 
∑s¶í
,

1099 c⁄° *
ß…
, 
size_t
 
ß…Àn
,

1100 
uöt64_t
 
N
, uöt64_à
r
, uöt64_à
p
, uöt64_à
maxmem
,

1101 *
key
, 
size_t
 
keyÀn
);

1103 
PKCS5_v2_s¸y±_keyivgí
(
EVP_CIPHER_CTX
 *
˘x
, c⁄° *
∑ss
,

1104 
∑s¶í
, 
ASN1_TYPE
 *
∑øm
,

1105 c⁄° 
EVP_CIPHER
 *
c
, c⁄° 
EVP_MD
 *
md
, 
í_de
);

1108 
PKCS5_PBE_add
();

1110 
EVP_PBE_CùhîInô
(
ASN1_OBJECT
 *
pbe_obj
, c⁄° *
∑ss
, 
∑s¶í
,

1111 
ASN1_TYPE
 *
∑øm
, 
EVP_CIPHER_CTX
 *
˘x
, 
í_de
);

1116 
	#EVP_PBE_TYPE_OUTER
 0x0

	)

1118 
	#EVP_PBE_TYPE_PRF
 0x1

	)

1120 
	#EVP_PBE_TYPE_KDF
 0x2

	)

1122 
EVP_PBE_Æg_add_ty≥
(
pbe_ty≥
, 
pbe_nid
, 
cùhî_nid
,

1123 
md_nid
, 
EVP_PBE_KEYGEN
 *
keygí
);

1124 
EVP_PBE_Æg_add
(
nid
, c⁄° 
EVP_CIPHER
 *
cùhî
, c⁄° 
EVP_MD
 *
md
,

1125 
EVP_PBE_KEYGEN
 *
keygí
);

1126 
EVP_PBE_föd
(
ty≥
, 
pbe_nid
, *
p˙id
, *
pmnid
,

1127 
EVP_PBE_KEYGEN
 **
pkeygí
);

1128 
EVP_PBE_˛ónup
();

1129 
EVP_PBE_gë
(*
±y≥
, *
µbe_nid
, 
size_t
 
num
);

1131 
	#ASN1_PKEY_ALIAS
 0x1

	)

1132 
	#ASN1_PKEY_DYNAMIC
 0x2

	)

1133 
	#ASN1_PKEY_SIGPARAM_NULL
 0x4

	)

1135 
	#ASN1_PKEY_CTRL_PKCS7_SIGN
 0x1

	)

1136 
	#ASN1_PKEY_CTRL_PKCS7_ENCRYPT
 0x2

	)

1137 
	#ASN1_PKEY_CTRL_DEFAULT_MD_NID
 0x3

	)

1138 
	#ASN1_PKEY_CTRL_CMS_SIGN
 0x5

	)

1139 
	#ASN1_PKEY_CTRL_CMS_ENVELOPE
 0x7

	)

1140 
	#ASN1_PKEY_CTRL_CMS_RI_TYPE
 0x8

	)

1142 
	#ASN1_PKEY_CTRL_SET1_TLS_ENCPT
 0x9

	)

1143 
	#ASN1_PKEY_CTRL_GET1_TLS_ENCPT
 0xa

	)

1145 
EVP_PKEY_a¢1_gë_cou¡
();

1146 c⁄° 
EVP_PKEY_ASN1_METHOD
 *
EVP_PKEY_a¢1_gë0
(
idx
);

1147 c⁄° 
EVP_PKEY_ASN1_METHOD
 *
EVP_PKEY_a¢1_föd
(
ENGINE
 **
≥
, 
ty≥
);

1148 c⁄° 
EVP_PKEY_ASN1_METHOD
 *
EVP_PKEY_a¢1_föd_°r
(
ENGINE
 **
≥
,

1149 c⁄° *
°r
, 
Àn
);

1150 
EVP_PKEY_a¢1_add0
(c⁄° 
EVP_PKEY_ASN1_METHOD
 *
amëh
);

1151 
EVP_PKEY_a¢1_add_Æüs
(
to
, 
‰om
);

1152 
EVP_PKEY_a¢1_gë0_öfo
(*
µkey_id
, *
pkey_ba£_id
,

1153 *
µkey_Êags
, c⁄° **
pöfo
,

1154 c⁄° **
µem_°r
,

1155 c⁄° 
EVP_PKEY_ASN1_METHOD
 *
amëh
);

1157 c⁄° 
EVP_PKEY_ASN1_METHOD
 *
EVP_PKEY_gë0_a¢1
(c⁄° 
EVP_PKEY
 *
pkey
);

1158 
EVP_PKEY_ASN1_METHOD
 *
EVP_PKEY_a¢1_√w
(
id
, 
Êags
,

1159 c⁄° *
≥m_°r
,

1160 c⁄° *
öfo
);

1161 
EVP_PKEY_a¢1_c›y
(
EVP_PKEY_ASN1_METHOD
 *
d°
,

1162 c⁄° 
EVP_PKEY_ASN1_METHOD
 *
§c
);

1163 
EVP_PKEY_a¢1_‰ì
(
EVP_PKEY_ASN1_METHOD
 *
amëh
);

1164 
EVP_PKEY_a¢1_£t_public
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1165 (*
pub_decode
Ë(
EVP_PKEY
 *
pk
,

1166 
X509_PUBKEY
 *
pub
),

1167 (*
pub_ícode
Ë(
X509_PUBKEY
 *
pub
,

1168 c⁄° 
EVP_PKEY
 *
pk
),

1169 (*
pub_cmp
Ë(c⁄° 
EVP_PKEY
 *
a
,

1170 c⁄° 
EVP_PKEY
 *
b
),

1171 (*
pub_¥öt
Ë(
BIO
 *
out
,

1172 c⁄° 
EVP_PKEY
 *
pkey
,

1173 
ödít
, 
ASN1_PCTX
 *
p˘x
),

1174 (*
pkey_size
Ë(c⁄° 
EVP_PKEY
 *
pk
),

1175 (*
pkey_bôs
Ë(c⁄° 
EVP_PKEY
 *
pk
));

1176 
EVP_PKEY_a¢1_£t_¥iv©e
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1177 (*
¥iv_decode
Ë(
EVP_PKEY
 *
pk
,

1178 c⁄° 
PKCS8_PRIV_KEY_INFO


1179 *
p8öf
),

1180 (*
¥iv_ícode
Ë(
PKCS8_PRIV_KEY_INFO
 *
p8
,

1181 c⁄° 
EVP_PKEY
 *
pk
),

1182 (*
¥iv_¥öt
Ë(
BIO
 *
out
,

1183 c⁄° 
EVP_PKEY
 *
pkey
,

1184 
ödít
,

1185 
ASN1_PCTX
 *
p˘x
));

1186 
EVP_PKEY_a¢1_£t_∑øm
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1187 (*
∑øm_decode
Ë(
EVP_PKEY
 *
pkey
,

1188 c⁄° **
pdî
,

1189 
dîÀn
),

1190 (*
∑øm_ícode
Ë(c⁄° 
EVP_PKEY
 *
pkey
,

1191 **
pdî
),

1192 (*
∑øm_missög
Ë(c⁄° 
EVP_PKEY
 *
pk
),

1193 (*
∑øm_c›y
Ë(
EVP_PKEY
 *
to
,

1194 c⁄° 
EVP_PKEY
 *
‰om
),

1195 (*
∑øm_cmp
Ë(c⁄° 
EVP_PKEY
 *
a
,

1196 c⁄° 
EVP_PKEY
 *
b
),

1197 (*
∑øm_¥öt
Ë(
BIO
 *
out
,

1198 c⁄° 
EVP_PKEY
 *
pkey
,

1199 
ödít
,

1200 
ASN1_PCTX
 *
p˘x
));

1202 
EVP_PKEY_a¢1_£t_‰ì
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1203 (*
pkey_‰ì
Ë(
EVP_PKEY
 *
pkey
));

1204 
EVP_PKEY_a¢1_£t_˘æ
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1205 (*
pkey_˘æ
Ë(
EVP_PKEY
 *
pkey
, 
›
,

1206 
¨g1
, *
¨g2
));

1207 
EVP_PKEY_a¢1_£t_ôem
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1208 (*
ôem_vîify
Ë(
EVP_MD_CTX
 *
˘x
,

1209 c⁄° 
ASN1_ITEM
 *
ô
,

1210 *
a¢
,

1211 
X509_ALGOR
 *
a
,

1212 
ASN1_BIT_STRING
 *
sig
,

1213 
EVP_PKEY
 *
pkey
),

1214 (*
ôem_sign
Ë(
EVP_MD_CTX
 *
˘x
,

1215 c⁄° 
ASN1_ITEM
 *
ô
,

1216 *
a¢
,

1217 
X509_ALGOR
 *
Æg1
,

1218 
X509_ALGOR
 *
Æg2
,

1219 
ASN1_BIT_STRING
 *
sig
));

1221 
EVP_PKEY_a¢1_£t_sigöf
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1222 (*
sigöf_£t
Ë(
X509_SIG_INFO
 *
sigöf
,

1223 c⁄° 
X509_ALGOR
 *
Æg
,

1224 c⁄° 
ASN1_STRING
 *
sig
));

1226 
EVP_PKEY_a¢1_£t_check
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1227 (*
pkey_check
Ë(c⁄° 
EVP_PKEY
 *
pk
));

1229 
EVP_PKEY_a¢1_£t_public_check
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1230 (*
pkey_pub_check
Ë(c⁄° 
EVP_PKEY
 *
pk
));

1232 
EVP_PKEY_a¢1_£t_∑øm_check
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1233 (*
pkey_∑øm_check
Ë(c⁄° 
EVP_PKEY
 *
pk
));

1235 
EVP_PKEY_a¢1_£t_£t_¥iv_key
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1236 (*
£t_¥iv_key
Ë(
EVP_PKEY
 *
pk
,

1238 *
¥iv
,

1239 
size_t
 
Àn
));

1240 
EVP_PKEY_a¢1_£t_£t_pub_key
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1241 (*
£t_pub_key
Ë(
EVP_PKEY
 *
pk
,

1242 c⁄° *
pub
,

1243 
size_t
 
Àn
));

1244 
EVP_PKEY_a¢1_£t_gë_¥iv_key
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1245 (*
gë_¥iv_key
Ë(c⁄° 
EVP_PKEY
 *
pk
,

1246 *
¥iv
,

1247 
size_t
 *
Àn
));

1248 
EVP_PKEY_a¢1_£t_gë_pub_key
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1249 (*
gë_pub_key
Ë(c⁄° 
EVP_PKEY
 *
pk
,

1250 *
pub
,

1251 
size_t
 *
Àn
));

1253 
EVP_PKEY_a¢1_£t_£curôy_bôs
(
EVP_PKEY_ASN1_METHOD
 *
amëh
,

1254 (*
pkey_£curôy_bôs
Ë(c⁄° 
EVP_PKEY


1255 *
pk
));

1257 
	#EVP_PKEY_OP_UNDEFINED
 0

	)

1258 
	#EVP_PKEY_OP_PARAMGEN
 (1<<1)

	)

1259 
	#EVP_PKEY_OP_KEYGEN
 (1<<2)

	)

1260 
	#EVP_PKEY_OP_SIGN
 (1<<3)

	)

1261 
	#EVP_PKEY_OP_VERIFY
 (1<<4)

	)

1262 
	#EVP_PKEY_OP_VERIFYRECOVER
 (1<<5)

	)

1263 
	#EVP_PKEY_OP_SIGNCTX
 (1<<6)

	)

1264 
	#EVP_PKEY_OP_VERIFYCTX
 (1<<7)

	)

1265 
	#EVP_PKEY_OP_ENCRYPT
 (1<<8)

	)

1266 
	#EVP_PKEY_OP_DECRYPT
 (1<<9)

	)

1267 
	#EVP_PKEY_OP_DERIVE
 (1<<10)

	)

1269 
	#EVP_PKEY_OP_TYPE_SIG
 \

1270 (
EVP_PKEY_OP_SIGN
 | 
EVP_PKEY_OP_VERIFY
 | 
EVP_PKEY_OP_VERIFYRECOVER
 \

1271 | 
EVP_PKEY_OP_SIGNCTX
 | 
EVP_PKEY_OP_VERIFYCTX
)

	)

1273 
	#EVP_PKEY_OP_TYPE_CRYPT
 \

1274 (
EVP_PKEY_OP_ENCRYPT
 | 
EVP_PKEY_OP_DECRYPT
)

	)

1276 
	#EVP_PKEY_OP_TYPE_NOGEN
 \

1277 (
EVP_PKEY_OP_TYPE_SIG
 | 
EVP_PKEY_OP_TYPE_CRYPT
 | 
EVP_PKEY_OP_DERIVE
)

	)

1279 
	#EVP_PKEY_OP_TYPE_GEN
 \

1280 (
EVP_PKEY_OP_PARAMGEN
 | 
EVP_PKEY_OP_KEYGEN
)

	)

1282 
	#EVP_PKEY_CTX_£t_sig«tuª_md
(
˘x
, 
md
) \

1283 
	`EVP_PKEY_CTX_˘æ
(
˘x
, -1, 
EVP_PKEY_OP_TYPE_SIG
, \

1284 
EVP_PKEY_CTRL_MD
, 0, (*)(
md
))

	)

1286 
	#EVP_PKEY_CTX_gë_sig«tuª_md
(
˘x
, 
pmd
) \

1287 
	`EVP_PKEY_CTX_˘æ
(
˘x
, -1, 
EVP_PKEY_OP_TYPE_SIG
, \

1288 
EVP_PKEY_CTRL_GET_MD
, 0, (*)(
pmd
))

	)

1290 
	#EVP_PKEY_CTX_£t_mac_key
(
˘x
, 
key
, 
Àn
) \

1291 
	`EVP_PKEY_CTX_˘æ
(
˘x
, -1, 
EVP_PKEY_OP_KEYGEN
, \

1292 
EVP_PKEY_CTRL_SET_MAC_KEY
, 
Àn
, (*)(
key
))

	)

1294 
	#EVP_PKEY_CTRL_MD
 1

	)

1295 
	#EVP_PKEY_CTRL_PEER_KEY
 2

	)

1297 
	#EVP_PKEY_CTRL_PKCS7_ENCRYPT
 3

	)

1298 
	#EVP_PKEY_CTRL_PKCS7_DECRYPT
 4

	)

1300 
	#EVP_PKEY_CTRL_PKCS7_SIGN
 5

	)

1302 
	#EVP_PKEY_CTRL_SET_MAC_KEY
 6

	)

1304 
	#EVP_PKEY_CTRL_DIGESTINIT
 7

	)

1307 
	#EVP_PKEY_CTRL_SET_IV
 8

	)

1309 
	#EVP_PKEY_CTRL_CMS_ENCRYPT
 9

	)

1310 
	#EVP_PKEY_CTRL_CMS_DECRYPT
 10

	)

1311 
	#EVP_PKEY_CTRL_CMS_SIGN
 11

	)

1313 
	#EVP_PKEY_CTRL_CIPHER
 12

	)

1315 
	#EVP_PKEY_CTRL_GET_MD
 13

	)

1317 
	#EVP_PKEY_CTRL_SET_DIGEST_SIZE
 14

	)

1319 
	#EVP_PKEY_ALG_CTRL
 0x1000

	)

1321 
	#EVP_PKEY_FLAG_AUTOARGLEN
 2

	)

1325 
	#EVP_PKEY_FLAG_SIGCTX_CUSTOM
 4

	)

1327 c⁄° 
EVP_PKEY_METHOD
 *
EVP_PKEY_mëh_föd
(
ty≥
);

1328 
EVP_PKEY_METHOD
 *
EVP_PKEY_mëh_√w
(
id
, 
Êags
);

1329 
EVP_PKEY_mëh_gë0_öfo
(*
µkey_id
, *
pÊags
,

1330 c⁄° 
EVP_PKEY_METHOD
 *
mëh
);

1331 
EVP_PKEY_mëh_c›y
(
EVP_PKEY_METHOD
 *
d°
, c⁄° EVP_PKEY_METHOD *
§c
);

1332 
EVP_PKEY_mëh_‰ì
(
EVP_PKEY_METHOD
 *
pmëh
);

1333 
EVP_PKEY_mëh_add0
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
);

1334 
EVP_PKEY_mëh_ªmove
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
);

1335 
size_t
 
EVP_PKEY_mëh_gë_cou¡
();

1336 c⁄° 
EVP_PKEY_METHOD
 *
EVP_PKEY_mëh_gë0
(
size_t
 
idx
);

1338 
EVP_PKEY_CTX
 *
EVP_PKEY_CTX_√w
(
EVP_PKEY
 *
pkey
, 
ENGINE
 *
e
);

1339 
EVP_PKEY_CTX
 *
EVP_PKEY_CTX_√w_id
(
id
, 
ENGINE
 *
e
);

1340 
EVP_PKEY_CTX
 *
EVP_PKEY_CTX_dup
(EVP_PKEY_CTX *
˘x
);

1341 
EVP_PKEY_CTX_‰ì
(
EVP_PKEY_CTX
 *
˘x
);

1343 
EVP_PKEY_CTX_˘æ
(
EVP_PKEY_CTX
 *
˘x
, 
keyty≥
, 
›ty≥
,

1344 
cmd
, 
p1
, *
p2
);

1345 
EVP_PKEY_CTX_˘æ_°r
(
EVP_PKEY_CTX
 *
˘x
, c⁄° *
ty≥
,

1346 c⁄° *
vÆue
);

1347 
EVP_PKEY_CTX_˘æ_uöt64
(
EVP_PKEY_CTX
 *
˘x
, 
keyty≥
, 
›ty≥
,

1348 
cmd
, 
uöt64_t
 
vÆue
);

1350 
EVP_PKEY_CTX_°r2˘æ
(
EVP_PKEY_CTX
 *
˘x
, 
cmd
, c⁄° *
°r
);

1351 
EVP_PKEY_CTX_hex2˘æ
(
EVP_PKEY_CTX
 *
˘x
, 
cmd
, c⁄° *
hex
);

1353 
EVP_PKEY_CTX_md
(
EVP_PKEY_CTX
 *
˘x
, 
›ty≥
, 
cmd
, c⁄° *
md
);

1355 
EVP_PKEY_CTX_gë_›î©i⁄
(
EVP_PKEY_CTX
 *
˘x
);

1356 
EVP_PKEY_CTX_£t0_keygí_öfo
(
EVP_PKEY_CTX
 *
˘x
, *
d©
, 
d©Àn
);

1358 
EVP_PKEY
 *
EVP_PKEY_√w_mac_key
(
ty≥
, 
ENGINE
 *
e
,

1359 c⁄° *
key
, 
keyÀn
);

1360 
EVP_PKEY
 *
EVP_PKEY_√w_øw_¥iv©e_key
(
ty≥
, 
ENGINE
 *
e
,

1361 c⁄° *
¥iv
,

1362 
size_t
 
Àn
);

1363 
EVP_PKEY
 *
EVP_PKEY_√w_øw_public_key
(
ty≥
, 
ENGINE
 *
e
,

1364 c⁄° *
pub
,

1365 
size_t
 
Àn
);

1366 
EVP_PKEY_gë_øw_¥iv©e_key
(c⁄° 
EVP_PKEY
 *
pkey
, *
¥iv
,

1367 
size_t
 *
Àn
);

1368 
EVP_PKEY_gë_øw_public_key
(c⁄° 
EVP_PKEY
 *
pkey
, *
pub
,

1369 
size_t
 *
Àn
);

1371 
EVP_PKEY
 *
EVP_PKEY_√w_CMAC_key
(
ENGINE
 *
e
, c⁄° *
¥iv
,

1372 
size_t
 
Àn
, c⁄° 
EVP_CIPHER
 *
cùhî
);

1374 
EVP_PKEY_CTX_£t_d©a
(
EVP_PKEY_CTX
 *
˘x
, *
d©a
);

1375 *
EVP_PKEY_CTX_gë_d©a
(
EVP_PKEY_CTX
 *
˘x
);

1376 
EVP_PKEY
 *
EVP_PKEY_CTX_gë0_pkey
(
EVP_PKEY_CTX
 *
˘x
);

1378 
EVP_PKEY
 *
EVP_PKEY_CTX_gë0_≥îkey
(
EVP_PKEY_CTX
 *
˘x
);

1380 
EVP_PKEY_CTX_£t_≠p_d©a
(
EVP_PKEY_CTX
 *
˘x
, *
d©a
);

1381 *
EVP_PKEY_CTX_gë_≠p_d©a
(
EVP_PKEY_CTX
 *
˘x
);

1383 
EVP_PKEY_sign_öô
(
EVP_PKEY_CTX
 *
˘x
);

1384 
EVP_PKEY_sign
(
EVP_PKEY_CTX
 *
˘x
,

1385 *
sig
, 
size_t
 *
sigÀn
,

1386 c⁄° *
tbs
, 
size_t
 
tb¶í
);

1387 
EVP_PKEY_vîify_öô
(
EVP_PKEY_CTX
 *
˘x
);

1388 
EVP_PKEY_vîify
(
EVP_PKEY_CTX
 *
˘x
,

1389 c⁄° *
sig
, 
size_t
 
sigÀn
,

1390 c⁄° *
tbs
, 
size_t
 
tb¶í
);

1391 
EVP_PKEY_vîify_ªcovî_öô
(
EVP_PKEY_CTX
 *
˘x
);

1392 
EVP_PKEY_vîify_ªcovî
(
EVP_PKEY_CTX
 *
˘x
,

1393 *
rout
, 
size_t
 *
rouéí
,

1394 c⁄° *
sig
, 
size_t
 
sigÀn
);

1395 
EVP_PKEY_í¸y±_öô
(
EVP_PKEY_CTX
 *
˘x
);

1396 
EVP_PKEY_í¸y±
(
EVP_PKEY_CTX
 *
˘x
,

1397 *
out
, 
size_t
 *
ouéí
,

1398 c⁄° *
ö
, 
size_t
 
öÀn
);

1399 
EVP_PKEY_de¸y±_öô
(
EVP_PKEY_CTX
 *
˘x
);

1400 
EVP_PKEY_de¸y±
(
EVP_PKEY_CTX
 *
˘x
,

1401 *
out
, 
size_t
 *
ouéí
,

1402 c⁄° *
ö
, 
size_t
 
öÀn
);

1404 
EVP_PKEY_dîive_öô
(
EVP_PKEY_CTX
 *
˘x
);

1405 
EVP_PKEY_dîive_£t_≥î
(
EVP_PKEY_CTX
 *
˘x
, 
EVP_PKEY
 *
≥î
);

1406 
EVP_PKEY_dîive
(
EVP_PKEY_CTX
 *
˘x
, *
key
, 
size_t
 *
keyÀn
);

1408 
	tEVP_PKEY_gí_cb
(
	tEVP_PKEY_CTX
 *
	t˘x
);

1410 
EVP_PKEY_∑ømgí_öô
(
EVP_PKEY_CTX
 *
˘x
);

1411 
EVP_PKEY_∑ømgí
(
EVP_PKEY_CTX
 *
˘x
, 
EVP_PKEY
 **
µkey
);

1412 
EVP_PKEY_keygí_öô
(
EVP_PKEY_CTX
 *
˘x
);

1413 
EVP_PKEY_keygí
(
EVP_PKEY_CTX
 *
˘x
, 
EVP_PKEY
 **
µkey
);

1414 
EVP_PKEY_check
(
EVP_PKEY_CTX
 *
˘x
);

1415 
EVP_PKEY_public_check
(
EVP_PKEY_CTX
 *
˘x
);

1416 
EVP_PKEY_∑øm_check
(
EVP_PKEY_CTX
 *
˘x
);

1418 
EVP_PKEY_CTX_£t_cb
(
EVP_PKEY_CTX
 *
˘x
, 
EVP_PKEY_gí_cb
 *
cb
);

1419 
EVP_PKEY_gí_cb
 *
EVP_PKEY_CTX_gë_cb
(
EVP_PKEY_CTX
 *
˘x
);

1421 
EVP_PKEY_CTX_gë_keygí_öfo
(
EVP_PKEY_CTX
 *
˘x
, 
idx
);

1423 
EVP_PKEY_mëh_£t_öô
(
EVP_PKEY_METHOD
 *
pmëh
,

1424 (*
öô
Ë(
EVP_PKEY_CTX
 *
˘x
));

1426 
EVP_PKEY_mëh_£t_c›y
(
EVP_PKEY_METHOD
 *
pmëh
,

1427 (*
c›y
Ë(
EVP_PKEY_CTX
 *
d°
,

1428 
EVP_PKEY_CTX
 *
§c
));

1430 
EVP_PKEY_mëh_£t_˛ónup
(
EVP_PKEY_METHOD
 *
pmëh
,

1431 (*
˛ónup
Ë(
EVP_PKEY_CTX
 *
˘x
));

1433 
EVP_PKEY_mëh_£t_∑ømgí
(
EVP_PKEY_METHOD
 *
pmëh
,

1434 (*
∑ømgí_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1435 (*
∑ømgí
Ë(
EVP_PKEY_CTX
 *
˘x
,

1436 
EVP_PKEY
 *
pkey
));

1438 
EVP_PKEY_mëh_£t_keygí
(
EVP_PKEY_METHOD
 *
pmëh
,

1439 (*
keygí_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1440 (*
keygí
Ë(
EVP_PKEY_CTX
 *
˘x
,

1441 
EVP_PKEY
 *
pkey
));

1443 
EVP_PKEY_mëh_£t_sign
(
EVP_PKEY_METHOD
 *
pmëh
,

1444 (*
sign_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1445 (*
sign
Ë(
EVP_PKEY_CTX
 *
˘x
,

1446 *
sig
, 
size_t
 *
sigÀn
,

1447 c⁄° *
tbs
,

1448 
size_t
 
tb¶í
));

1450 
EVP_PKEY_mëh_£t_vîify
(
EVP_PKEY_METHOD
 *
pmëh
,

1451 (*
vîify_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1452 (*
vîify
Ë(
EVP_PKEY_CTX
 *
˘x
,

1453 c⁄° *
sig
,

1454 
size_t
 
sigÀn
,

1455 c⁄° *
tbs
,

1456 
size_t
 
tb¶í
));

1458 
EVP_PKEY_mëh_£t_vîify_ªcovî
(
EVP_PKEY_METHOD
 *
pmëh
,

1459 (*
vîify_ªcovî_öô
Ë(
EVP_PKEY_CTX


1460 *
˘x
),

1461 (*
vîify_ªcovî
Ë(
EVP_PKEY_CTX


1462 *
˘x
,

1464 *
sig
,

1465 
size_t
 *
sigÀn
,

1467 *
tbs
,

1468 
size_t
 
tb¶í
));

1470 
EVP_PKEY_mëh_£t_sign˘x
(
EVP_PKEY_METHOD
 *
pmëh
,

1471 (*
sign˘x_öô
Ë(
EVP_PKEY_CTX
 *
˘x
,

1472 
EVP_MD_CTX
 *
m˘x
),

1473 (*
sign˘x
Ë(
EVP_PKEY_CTX
 *
˘x
,

1474 *
sig
,

1475 
size_t
 *
sigÀn
,

1476 
EVP_MD_CTX
 *
m˘x
));

1478 
EVP_PKEY_mëh_£t_vîify˘x
(
EVP_PKEY_METHOD
 *
pmëh
,

1479 (*
vîify˘x_öô
Ë(
EVP_PKEY_CTX
 *
˘x
,

1480 
EVP_MD_CTX
 *
m˘x
),

1481 (*
vîify˘x
Ë(
EVP_PKEY_CTX
 *
˘x
,

1482 c⁄° *
sig
,

1483 
sigÀn
,

1484 
EVP_MD_CTX
 *
m˘x
));

1486 
EVP_PKEY_mëh_£t_í¸y±
(
EVP_PKEY_METHOD
 *
pmëh
,

1487 (*
í¸y±_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1488 (*
í¸y±‚
Ë(
EVP_PKEY_CTX
 *
˘x
,

1489 *
out
,

1490 
size_t
 *
ouéí
,

1491 c⁄° *
ö
,

1492 
size_t
 
öÀn
));

1494 
EVP_PKEY_mëh_£t_de¸y±
(
EVP_PKEY_METHOD
 *
pmëh
,

1495 (*
de¸y±_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1496 (*
de¸y±
Ë(
EVP_PKEY_CTX
 *
˘x
,

1497 *
out
,

1498 
size_t
 *
ouéí
,

1499 c⁄° *
ö
,

1500 
size_t
 
öÀn
));

1502 
EVP_PKEY_mëh_£t_dîive
(
EVP_PKEY_METHOD
 *
pmëh
,

1503 (*
dîive_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1504 (*
dîive
Ë(
EVP_PKEY_CTX
 *
˘x
,

1505 *
key
,

1506 
size_t
 *
keyÀn
));

1508 
EVP_PKEY_mëh_£t_˘æ
(
EVP_PKEY_METHOD
 *
pmëh
,

1509 (*
˘æ
Ë(
EVP_PKEY_CTX
 *
˘x
, 
ty≥
, 
p1
,

1510 *
p2
),

1511 (*
˘æ_°r
Ë(
EVP_PKEY_CTX
 *
˘x
,

1512 c⁄° *
ty≥
,

1513 c⁄° *
vÆue
));

1515 
EVP_PKEY_mëh_£t_check
(
EVP_PKEY_METHOD
 *
pmëh
,

1516 (*
check
Ë(
EVP_PKEY
 *
pkey
));

1518 
EVP_PKEY_mëh_£t_public_check
(
EVP_PKEY_METHOD
 *
pmëh
,

1519 (*
check
Ë(
EVP_PKEY
 *
pkey
));

1521 
EVP_PKEY_mëh_£t_∑øm_check
(
EVP_PKEY_METHOD
 *
pmëh
,

1522 (*
check
Ë(
EVP_PKEY
 *
pkey
));

1524 
EVP_PKEY_mëh_£t_dige°_cu°om
(
EVP_PKEY_METHOD
 *
pmëh
,

1525 (*
dige°_cu°om
Ë(
EVP_PKEY_CTX
 *
˘x
,

1526 
EVP_MD_CTX
 *
m˘x
));

1528 
EVP_PKEY_mëh_gë_öô
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1529 (**
pöô
Ë(
EVP_PKEY_CTX
 *
˘x
));

1531 
EVP_PKEY_mëh_gë_c›y
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1532 (**
pc›y
Ë(
EVP_PKEY_CTX
 *
d°
,

1533 
EVP_PKEY_CTX
 *
§c
));

1535 
EVP_PKEY_mëh_gë_˛ónup
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1536 (**
p˛ónup
Ë(
EVP_PKEY_CTX
 *
˘x
));

1538 
EVP_PKEY_mëh_gë_∑ømgí
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1539 (**
µ¨amgí_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1540 (**
µ¨amgí
Ë(
EVP_PKEY_CTX
 *
˘x
,

1541 
EVP_PKEY
 *
pkey
));

1543 
EVP_PKEY_mëh_gë_keygí
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1544 (**
pkeygí_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1545 (**
pkeygí
Ë(
EVP_PKEY_CTX
 *
˘x
,

1546 
EVP_PKEY
 *
pkey
));

1548 
EVP_PKEY_mëh_gë_sign
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1549 (**
psign_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1550 (**
psign
Ë(
EVP_PKEY_CTX
 *
˘x
,

1551 *
sig
, 
size_t
 *
sigÀn
,

1552 c⁄° *
tbs
,

1553 
size_t
 
tb¶í
));

1555 
EVP_PKEY_mëh_gë_vîify
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1556 (**
pvîify_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1557 (**
pvîify
Ë(
EVP_PKEY_CTX
 *
˘x
,

1558 c⁄° *
sig
,

1559 
size_t
 
sigÀn
,

1560 c⁄° *
tbs
,

1561 
size_t
 
tb¶í
));

1563 
EVP_PKEY_mëh_gë_vîify_ªcovî
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1564 (**
pvîify_ªcovî_öô
Ë(
EVP_PKEY_CTX


1565 *
˘x
),

1566 (**
pvîify_ªcovî
Ë(
EVP_PKEY_CTX


1567 *
˘x
,

1569 *
sig
,

1570 
size_t
 *
sigÀn
,

1572 *
tbs
,

1573 
size_t
 
tb¶í
));

1575 
EVP_PKEY_mëh_gë_sign˘x
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1576 (**
psign˘x_öô
Ë(
EVP_PKEY_CTX
 *
˘x
,

1577 
EVP_MD_CTX
 *
m˘x
),

1578 (**
psign˘x
Ë(
EVP_PKEY_CTX
 *
˘x
,

1579 *
sig
,

1580 
size_t
 *
sigÀn
,

1581 
EVP_MD_CTX
 *
m˘x
));

1583 
EVP_PKEY_mëh_gë_vîify˘x
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1584 (**
pvîify˘x_öô
Ë(
EVP_PKEY_CTX
 *
˘x
,

1585 
EVP_MD_CTX
 *
m˘x
),

1586 (**
pvîify˘x
Ë(
EVP_PKEY_CTX
 *
˘x
,

1587 c⁄° *
sig
,

1588 
sigÀn
,

1589 
EVP_MD_CTX
 *
m˘x
));

1591 
EVP_PKEY_mëh_gë_í¸y±
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1592 (**
≥n¸y±_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1593 (**
≥n¸y±‚
Ë(
EVP_PKEY_CTX
 *
˘x
,

1594 *
out
,

1595 
size_t
 *
ouéí
,

1596 c⁄° *
ö
,

1597 
size_t
 
öÀn
));

1599 
EVP_PKEY_mëh_gë_de¸y±
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1600 (**
pde¸y±_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1601 (**
pde¸y±
Ë(
EVP_PKEY_CTX
 *
˘x
,

1602 *
out
,

1603 
size_t
 *
ouéí
,

1604 c⁄° *
ö
,

1605 
size_t
 
öÀn
));

1607 
EVP_PKEY_mëh_gë_dîive
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1608 (**
pdîive_öô
Ë(
EVP_PKEY_CTX
 *
˘x
),

1609 (**
pdîive
Ë(
EVP_PKEY_CTX
 *
˘x
,

1610 *
key
,

1611 
size_t
 *
keyÀn
));

1613 
EVP_PKEY_mëh_gë_˘æ
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1614 (**
p˘æ
Ë(
EVP_PKEY_CTX
 *
˘x
, 
ty≥
, 
p1
,

1615 *
p2
),

1616 (**
p˘æ_°r
Ë(
EVP_PKEY_CTX
 *
˘x
,

1617 c⁄° *
ty≥
,

1618 c⁄° *
vÆue
));

1620 
EVP_PKEY_mëh_gë_check
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1621 (**
pcheck
Ë(
EVP_PKEY
 *
pkey
));

1623 
EVP_PKEY_mëh_gë_public_check
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1624 (**
pcheck
Ë(
EVP_PKEY
 *
pkey
));

1626 
EVP_PKEY_mëh_gë_∑øm_check
(c⁄° 
EVP_PKEY_METHOD
 *
pmëh
,

1627 (**
pcheck
Ë(
EVP_PKEY
 *
pkey
));

1629 
EVP_PKEY_mëh_gë_dige°_cu°om
(
EVP_PKEY_METHOD
 *
pmëh
,

1630 (**
pdige°_cu°om
Ë(
EVP_PKEY_CTX
 *
˘x
,

1631 
EVP_MD_CTX
 *
m˘x
));

1632 
EVP_add_Æg_moduÀ
();

1635 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/opensslv.h

10 #i‚de‡
HEADER_OPENSSLV_H


11 
	#HEADER_OPENSSLV_H


	)

13 #ifde‡ 
__˝lu•lus


42 
	#OPENSSL_VERSION_NUMBER
 0x1010104fL

	)

43 
	#OPENSSL_VERSION_TEXT
 "O≥nSSL 1.1.1d 10 Sï 2019"

	)

94 
	#SHLIB_VERSION_HISTORY
 ""

	)

95 
	#SHLIB_VERSION_NUMBER
 "1.1"

	)

98 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/pemerr.h

11 #i‚de‡
HEADER_PEMERR_H


12 
	#HEADER_PEMERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_PEM_°rögs
();

26 
	#PEM_F_B2I_DSS
 127

	)

27 
	#PEM_F_B2I_PVK_BIO
 128

	)

28 
	#PEM_F_B2I_RSA
 129

	)

29 
	#PEM_F_CHECK_BITLEN_DSA
 130

	)

30 
	#PEM_F_CHECK_BITLEN_RSA
 131

	)

31 
	#PEM_F_D2I_PKCS8PRIVATEKEY_BIO
 120

	)

32 
	#PEM_F_D2I_PKCS8PRIVATEKEY_FP
 121

	)

33 
	#PEM_F_DO_B2I
 132

	)

34 
	#PEM_F_DO_B2I_BIO
 133

	)

35 
	#PEM_F_DO_BLOB_HEADER
 134

	)

36 
	#PEM_F_DO_I2B
 146

	)

37 
	#PEM_F_DO_PK8PKEY
 126

	)

38 
	#PEM_F_DO_PK8PKEY_FP
 125

	)

39 
	#PEM_F_DO_PVK_BODY
 135

	)

40 
	#PEM_F_DO_PVK_HEADER
 136

	)

41 
	#PEM_F_GET_HEADER_AND_DATA
 143

	)

42 
	#PEM_F_GET_NAME
 144

	)

43 
	#PEM_F_I2B_PVK
 137

	)

44 
	#PEM_F_I2B_PVK_BIO
 138

	)

45 
	#PEM_F_LOAD_IV
 101

	)

46 
	#PEM_F_PEM_ASN1_READ
 102

	)

47 
	#PEM_F_PEM_ASN1_READ_BIO
 103

	)

48 
	#PEM_F_PEM_ASN1_WRITE
 104

	)

49 
	#PEM_F_PEM_ASN1_WRITE_BIO
 105

	)

50 
	#PEM_F_PEM_DEF_CALLBACK
 100

	)

51 
	#PEM_F_PEM_DO_HEADER
 106

	)

52 
	#PEM_F_PEM_GET_EVP_CIPHER_INFO
 107

	)

53 
	#PEM_F_PEM_READ
 108

	)

54 
	#PEM_F_PEM_READ_BIO
 109

	)

55 
	#PEM_F_PEM_READ_BIO_DHPARAMS
 141

	)

56 
	#PEM_F_PEM_READ_BIO_EX
 145

	)

57 
	#PEM_F_PEM_READ_BIO_PARAMETERS
 140

	)

58 
	#PEM_F_PEM_READ_BIO_PRIVATEKEY
 123

	)

59 
	#PEM_F_PEM_READ_DHPARAMS
 142

	)

60 
	#PEM_F_PEM_READ_PRIVATEKEY
 124

	)

61 
	#PEM_F_PEM_SIGNFINAL
 112

	)

62 
	#PEM_F_PEM_WRITE
 113

	)

63 
	#PEM_F_PEM_WRITE_BIO
 114

	)

64 
	#PEM_F_PEM_WRITE_PRIVATEKEY
 139

	)

65 
	#PEM_F_PEM_X509_INFO_READ
 115

	)

66 
	#PEM_F_PEM_X509_INFO_READ_BIO
 116

	)

67 
	#PEM_F_PEM_X509_INFO_WRITE_BIO
 117

	)

72 
	#PEM_R_BAD_BASE64_DECODE
 100

	)

73 
	#PEM_R_BAD_DECRYPT
 101

	)

74 
	#PEM_R_BAD_END_LINE
 102

	)

75 
	#PEM_R_BAD_IV_CHARS
 103

	)

76 
	#PEM_R_BAD_MAGIC_NUMBER
 116

	)

77 
	#PEM_R_BAD_PASSWORD_READ
 104

	)

78 
	#PEM_R_BAD_VERSION_NUMBER
 117

	)

79 
	#PEM_R_BIO_WRITE_FAILURE
 118

	)

80 
	#PEM_R_CIPHER_IS_NULL
 127

	)

81 
	#PEM_R_ERROR_CONVERTING_PRIVATE_KEY
 115

	)

82 
	#PEM_R_EXPECTING_PRIVATE_KEY_BLOB
 119

	)

83 
	#PEM_R_EXPECTING_PUBLIC_KEY_BLOB
 120

	)

84 
	#PEM_R_HEADER_TOO_LONG
 128

	)

85 
	#PEM_R_INCONSISTENT_HEADER
 121

	)

86 
	#PEM_R_KEYBLOB_HEADER_PARSE_ERROR
 122

	)

87 
	#PEM_R_KEYBLOB_TOO_SHORT
 123

	)

88 
	#PEM_R_MISSING_DEK_IV
 129

	)

89 
	#PEM_R_NOT_DEK_INFO
 105

	)

90 
	#PEM_R_NOT_ENCRYPTED
 106

	)

91 
	#PEM_R_NOT_PROC_TYPE
 107

	)

92 
	#PEM_R_NO_START_LINE
 108

	)

93 
	#PEM_R_PROBLEMS_GETTING_PASSWORD
 109

	)

94 
	#PEM_R_PVK_DATA_TOO_SHORT
 124

	)

95 
	#PEM_R_PVK_TOO_SHORT
 125

	)

96 
	#PEM_R_READ_KEY
 111

	)

97 
	#PEM_R_SHORT_HEADER
 112

	)

98 
	#PEM_R_UNEXPECTED_DEK_IV
 130

	)

99 
	#PEM_R_UNSUPPORTED_CIPHER
 113

	)

100 
	#PEM_R_UNSUPPORTED_ENCRYPTION
 114

	)

101 
	#PEM_R_UNSUPPORTED_KEY_COMPONENTS
 126

	)

	@/usr/include/openssl/pkcs7.h

10 #i‚de‡
HEADER_PKCS7_H


11 
	#HEADER_PKCS7_H


	)

13 
	~<›ís¶/a¢1.h
>

14 
	~<›ís¶/bio.h
>

15 
	~<›ís¶/e_os2.h
>

17 
	~<›ís¶/symhacks.h
>

18 
	~<›ís¶/os¶_typ.h
>

19 
	~<›ís¶/pkcs7îr.h
>

21 #ifde‡ 
__˝lu•lus


32 
	spkcs7_issuî_™d_£rül_°
 {

33 
X509_NAME
 *
issuî
;

34 
ASN1_INTEGER
 *
£rül
;

35 } 
	tPKCS7_ISSUER_AND_SERIAL
;

37 
	spkcs7_sig√r_öfo_°
 {

38 
ASN1_INTEGER
 *
vîsi⁄
;

39 
PKCS7_ISSUER_AND_SERIAL
 *
issuî_™d_£rül
;

40 
X509_ALGOR
 *
dige°_Æg
;

41 
STACK_OF
(
X509_ATTRIBUTE
Ë*
auth_©å
;

42 
X509_ALGOR
 *
dige°_íc_Æg
;

43 
ASN1_OCTET_STRING
 *
íc_dige°
;

44 
STACK_OF
(
X509_ATTRIBUTE
Ë*
u«uth_©å
;

46 
EVP_PKEY
 *
pkey
;

47 } 
	tPKCS7_SIGNER_INFO
;

49 
DEFINE_STACK_OF
(
PKCS7_SIGNER_INFO
)

51 
	spkcs7_ªcù_öfo_°
 {

52 
ASN1_INTEGER
 *
vîsi⁄
;

53 
PKCS7_ISSUER_AND_SERIAL
 *
issuî_™d_£rül
;

54 
X509_ALGOR
 *
key_íc_Æg‹
;

55 
ASN1_OCTET_STRING
 *
íc_key
;

56 
X509
 *
˚π
;

57 } 
	tPKCS7_RECIP_INFO
;

59 
DEFINE_STACK_OF
(
PKCS7_RECIP_INFO
)

61 
	spkcs7_sig√d_°
 {

62 
ASN1_INTEGER
 *
vîsi⁄
;

63 
STACK_OF
(
X509_ALGOR
Ë*
md_Ægs
;

64 
STACK_OF
(
X509
Ë*
˚π
;

65 
STACK_OF
(
X509_CRL
Ë*
¸l
;

66 
STACK_OF
(
PKCS7_SIGNER_INFO
Ë*
sig√r_öfo
;

67 
pkcs7_°
 *
c⁄ã¡s
;

68 } 
	tPKCS7_SIGNED
;

74 
	spkcs7_íc_c⁄ã¡_°
 {

75 
ASN1_OBJECT
 *
c⁄ã¡_ty≥
;

76 
X509_ALGOR
 *
Æg‹ôhm
;

77 
ASN1_OCTET_STRING
 *
íc_d©a
;

78 c⁄° 
EVP_CIPHER
 *
cùhî
;

79 } 
	tPKCS7_ENC_CONTENT
;

81 
	spkcs7_ívñ›ed_°
 {

82 
ASN1_INTEGER
 *
vîsi⁄
;

83 
STACK_OF
(
PKCS7_RECIP_INFO
Ë*
ªcùõ¡öfo
;

84 
PKCS7_ENC_CONTENT
 *
íc_d©a
;

85 } 
	tPKCS7_ENVELOPE
;

87 
	spkcs7_sig√d™dívñ›ed_°
 {

88 
ASN1_INTEGER
 *
vîsi⁄
;

89 
STACK_OF
(
X509_ALGOR
Ë*
md_Ægs
;

90 
STACK_OF
(
X509
Ë*
˚π
;

91 
STACK_OF
(
X509_CRL
Ë*
¸l
;

92 
STACK_OF
(
PKCS7_SIGNER_INFO
Ë*
sig√r_öfo
;

93 
PKCS7_ENC_CONTENT
 *
íc_d©a
;

94 
STACK_OF
(
PKCS7_RECIP_INFO
Ë*
ªcùõ¡öfo
;

95 } 
	tPKCS7_SIGN_ENVELOPE
;

97 
	spkcs7_dige°_°
 {

98 
ASN1_INTEGER
 *
vîsi⁄
;

99 
X509_ALGOR
 *
md
;

100 
pkcs7_°
 *
c⁄ã¡s
;

101 
ASN1_OCTET_STRING
 *
dige°
;

102 } 
	tPKCS7_DIGEST
;

104 
	spkcs7_í¸y±ed_°
 {

105 
ASN1_INTEGER
 *
vîsi⁄
;

106 
PKCS7_ENC_CONTENT
 *
íc_d©a
;

107 } 
	tPKCS7_ENCRYPT
;

109 
	spkcs7_°
 {

114 *
a¢1
;

115 
Àngth
;

116 
	#PKCS7_S_HEADER
 0

	)

117 
	#PKCS7_S_BODY
 1

	)

118 
	#PKCS7_S_TAIL
 2

	)

119 
°©e
;

120 
dëached
;

121 
ASN1_OBJECT
 *
ty≥
;

128 *
±r
;

130 
ASN1_OCTET_STRING
 *
d©a
;

132 
PKCS7_SIGNED
 *
sign
;

134 
PKCS7_ENVELOPE
 *
ívñ›ed
;

136 
PKCS7_SIGN_ENVELOPE
 *
sig√d_™d_ívñ›ed
;

138 
PKCS7_DIGEST
 *
dige°
;

140 
PKCS7_ENCRYPT
 *
í¸y±ed
;

142 
ASN1_TYPE
 *
Ÿhî
;

143 } 
d
;

144 } 
	tPKCS7
;

146 
DEFINE_STACK_OF
(
PKCS7
)

148 
	#PKCS7_OP_SET_DETACHED_SIGNATURE
 1

	)

149 
	#PKCS7_OP_GET_DETACHED_SIGNATURE
 2

	)

151 
	#PKCS7_gë_sig√d_©åibuãs
(
si
Ë((si)->
auth_©å
)

	)

152 
	#PKCS7_gë_©åibuãs
(
si
Ë((si)->
u«uth_©å
)

	)

154 
	#PKCS7_ty≥_is_sig√d
(
a
Ë(
	`OBJ_obj2nid
(◊)->
ty≥
Ë=
NID_pkcs7_sig√d
)

	)

155 
	#PKCS7_ty≥_is_í¸y±ed
(
a
Ë(
	`OBJ_obj2nid
(◊)->
ty≥
Ë=
NID_pkcs7_í¸y±ed
)

	)

156 
	#PKCS7_ty≥_is_ívñ›ed
(
a
Ë(
	`OBJ_obj2nid
(◊)->
ty≥
Ë=
NID_pkcs7_ívñ›ed
)

	)

157 
	#PKCS7_ty≥_is_sig√dAndEnvñ›ed
(
a
) \

158 (
	`OBJ_obj2nid
((
a
)->
ty≥
Ë=
NID_pkcs7_sig√dAndEnvñ›ed
)

	)

159 
	#PKCS7_ty≥_is_d©a
(
a
Ë(
	`OBJ_obj2nid
(◊)->
ty≥
Ë=
NID_pkcs7_d©a
)

	)

160 
	#PKCS7_ty≥_is_dige°
(
a
Ë(
	`OBJ_obj2nid
(◊)->
ty≥
Ë=
NID_pkcs7_dige°
)

	)

162 
	#PKCS7_£t_dëached
(
p
,
v
) \

163 
	`PKCS7_˘æ
(
p
,
PKCS7_OP_SET_DETACHED_SIGNATURE
,
v
,
NULL
)

	)

164 
	#PKCS7_gë_dëached
(
p
) \

165 
	`PKCS7_˘æ
(
p
,
PKCS7_OP_GET_DETACHED_SIGNATURE
,0,
NULL
)

	)

167 
	#PKCS7_is_dëached
(
p7
Ë(
	`PKCS7_ty≥_is_sig√d
’7Ë&& 
	`PKCS7_gë_dëached
’7))

	)

171 
	#PKCS7_TEXT
 0x1

	)

172 
	#PKCS7_NOCERTS
 0x2

	)

173 
	#PKCS7_NOSIGS
 0x4

	)

174 
	#PKCS7_NOCHAIN
 0x8

	)

175 
	#PKCS7_NOINTERN
 0x10

	)

176 
	#PKCS7_NOVERIFY
 0x20

	)

177 
	#PKCS7_DETACHED
 0x40

	)

178 
	#PKCS7_BINARY
 0x80

	)

179 
	#PKCS7_NOATTR
 0x100

	)

180 
	#PKCS7_NOSMIMECAP
 0x200

	)

181 
	#PKCS7_NOOLDMIMETYPE
 0x400

	)

182 
	#PKCS7_CRLFEOL
 0x800

	)

183 
	#PKCS7_STREAM
 0x1000

	)

184 
	#PKCS7_NOCRL
 0x2000

	)

185 
	#PKCS7_PARTIAL
 0x4000

	)

186 
	#PKCS7_REUSE_DIGEST
 0x8000

	)

187 
	#PKCS7_NO_DUAL_CONTENT
 0x10000

	)

191 
	#SMIME_TEXT
 
PKCS7_TEXT


	)

192 
	#SMIME_NOCERTS
 
PKCS7_NOCERTS


	)

193 
	#SMIME_NOSIGS
 
PKCS7_NOSIGS


	)

194 
	#SMIME_NOCHAIN
 
PKCS7_NOCHAIN


	)

195 
	#SMIME_NOINTERN
 
PKCS7_NOINTERN


	)

196 
	#SMIME_NOVERIFY
 
PKCS7_NOVERIFY


	)

197 
	#SMIME_DETACHED
 
PKCS7_DETACHED


	)

198 
	#SMIME_BINARY
 
PKCS7_BINARY


	)

199 
	#SMIME_NOATTR
 
PKCS7_NOATTR


	)

202 
	#SMIME_ASCIICRLF
 0x80000

	)

204 
DECLARE_ASN1_FUNCTIONS
(
PKCS7_ISSUER_AND_SERIAL
)

206 
PKCS7_ISSUER_AND_SERIAL_dige°
(
PKCS7_ISSUER_AND_SERIAL
 *
d©a
,

207 c⁄° 
EVP_MD
 *
ty≥
, *
md
,

208 *
Àn
);

209 #i‚de‡
OPENSSL_NO_STDIO


210 
PKCS7
 *
d2i_PKCS7_Â
(
FILE
 *
Â
, PKCS7 **
p7
);

211 
i2d_PKCS7_Â
(
FILE
 *
Â
, 
PKCS7
 *
p7
);

213 
PKCS7
 *
PKCS7_dup
(PKCS7 *
p7
);

214 
PKCS7
 *
d2i_PKCS7_bio
(
BIO
 *
bp
, PKCS7 **
p7
);

215 
i2d_PKCS7_bio
(
BIO
 *
bp
, 
PKCS7
 *
p7
);

216 
i2d_PKCS7_bio_°ªam
(
BIO
 *
out
, 
PKCS7
 *
p7
, BIO *
ö
, 
Êags
);

217 
PEM_wrôe_bio_PKCS7_°ªam
(
BIO
 *
out
, 
PKCS7
 *
p7
, BIO *
ö
, 
Êags
);

219 
DECLARE_ASN1_FUNCTIONS
(
PKCS7_SIGNER_INFO
)

220 
DECLARE_ASN1_FUNCTIONS
(
PKCS7_RECIP_INFO
)

221 
DECLARE_ASN1_FUNCTIONS
(
PKCS7_SIGNED
)

222 
DECLARE_ASN1_FUNCTIONS
(
PKCS7_ENC_CONTENT
)

223 
DECLARE_ASN1_FUNCTIONS
(
PKCS7_ENVELOPE
)

224 
DECLARE_ASN1_FUNCTIONS
(
PKCS7_SIGN_ENVELOPE
)

225 
DECLARE_ASN1_FUNCTIONS
(
PKCS7_DIGEST
)

226 
DECLARE_ASN1_FUNCTIONS
(
PKCS7_ENCRYPT
)

227 
DECLARE_ASN1_FUNCTIONS
(
PKCS7
)

229 
DECLARE_ASN1_ITEM
(
PKCS7_ATTR_SIGN
)

230 
DECLARE_ASN1_ITEM
(
PKCS7_ATTR_VERIFY
)

232 
DECLARE_ASN1_NDEF_FUNCTION
(
PKCS7
)

233 
DECLARE_ASN1_PRINT_FUNCTION
(
PKCS7
)

235 
PKCS7_˘æ
(
PKCS7
 *
p7
, 
cmd
, 
œrg
, *
∑rg
);

237 
PKCS7_£t_ty≥
(
PKCS7
 *
p7
, 
ty≥
);

238 
PKCS7_£t0_ty≥_Ÿhî
(
PKCS7
 *
p7
, 
ty≥
, 
ASN1_TYPE
 *
Ÿhî
);

239 
PKCS7_£t_c⁄ã¡
(
PKCS7
 *
p7
, PKCS7 *
p7_d©a
);

240 
PKCS7_SIGNER_INFO_£t
(
PKCS7_SIGNER_INFO
 *
p7i
, 
X509
 *
x509
, 
EVP_PKEY
 *
pkey
,

241 c⁄° 
EVP_MD
 *
dg°
);

242 
PKCS7_SIGNER_INFO_sign
(
PKCS7_SIGNER_INFO
 *
si
);

243 
PKCS7_add_sig√r
(
PKCS7
 *
p7
, 
PKCS7_SIGNER_INFO
 *
p7i
);

244 
PKCS7_add_˚πifiˇã
(
PKCS7
 *
p7
, 
X509
 *
x509
);

245 
PKCS7_add_¸l
(
PKCS7
 *
p7
, 
X509_CRL
 *
x509
);

246 
PKCS7_c⁄ã¡_√w
(
PKCS7
 *
p7
, 
nid
);

247 
PKCS7_d©aVîify
(
X509_STORE
 *
˚π_°‹e
, 
X509_STORE_CTX
 *
˘x
,

248 
BIO
 *
bio
, 
PKCS7
 *
p7
, 
PKCS7_SIGNER_INFO
 *
si
);

249 
PKCS7_sig«tuªVîify
(
BIO
 *
bio
, 
PKCS7
 *
p7
, 
PKCS7_SIGNER_INFO
 *
si
,

250 
X509
 *
x509
);

252 
BIO
 *
PKCS7_d©aInô
(
PKCS7
 *
p7
, BIO *
bio
);

253 
PKCS7_d©aFöÆ
(
PKCS7
 *
p7
, 
BIO
 *
bio
);

254 
BIO
 *
PKCS7_d©aDecode
(
PKCS7
 *
p7
, 
EVP_PKEY
 *
pkey
, BIO *
ö_bio
, 
X509
 *
p˚π
);

256 
PKCS7_SIGNER_INFO
 *
PKCS7_add_sig«tuª
(
PKCS7
 *
p7
, 
X509
 *
x509
,

257 
EVP_PKEY
 *
pkey
, c⁄° 
EVP_MD
 *
dg°
);

258 
X509
 *
PKCS7_˚π_‰om_sig√r_öfo
(
PKCS7
 *
p7
, 
PKCS7_SIGNER_INFO
 *
si
);

259 
PKCS7_£t_dige°
(
PKCS7
 *
p7
, c⁄° 
EVP_MD
 *
md
);

260 
STACK_OF
(
PKCS7_SIGNER_INFO
Ë*
PKCS7_gë_sig√r_öfo
(
PKCS7
 *
p7
);

262 
PKCS7_RECIP_INFO
 *
PKCS7_add_ªcùõ¡
(
PKCS7
 *
p7
, 
X509
 *
x509
);

263 
PKCS7_SIGNER_INFO_gë0_Ægs
(
PKCS7_SIGNER_INFO
 *
si
, 
EVP_PKEY
 **
pk
,

264 
X509_ALGOR
 **
pdig
, X509_ALGOR **
psig
);

265 
PKCS7_RECIP_INFO_gë0_Æg
(
PKCS7_RECIP_INFO
 *
ri
, 
X509_ALGOR
 **
≥nc
);

266 
PKCS7_add_ªcùõ¡_öfo
(
PKCS7
 *
p7
, 
PKCS7_RECIP_INFO
 *
ri
);

267 
PKCS7_RECIP_INFO_£t
(
PKCS7_RECIP_INFO
 *
p7i
, 
X509
 *
x509
);

268 
PKCS7_£t_cùhî
(
PKCS7
 *
p7
, c⁄° 
EVP_CIPHER
 *
cùhî
);

269 
PKCS7_°ªam
(***
bound¨y
, 
PKCS7
 *
p7
);

271 
PKCS7_ISSUER_AND_SERIAL
 *
PKCS7_gë_issuî_™d_£rül
(
PKCS7
 *
p7
, 
idx
);

272 
ASN1_OCTET_STRING
 *
PKCS7_dige°_‰om_©åibuãs
(
STACK_OF
(
X509_ATTRIBUTE
Ë*
sk
);

273 
PKCS7_add_sig√d_©åibuã
(
PKCS7_SIGNER_INFO
 *
p7si
, 
nid
, 
ty≥
,

274 *
d©a
);

275 
PKCS7_add_©åibuã
(
PKCS7_SIGNER_INFO
 *
p7si
, 
nid
, 
©πy≥
,

276 *
vÆue
);

277 
ASN1_TYPE
 *
PKCS7_gë_©åibuã
(
PKCS7_SIGNER_INFO
 *
si
, 
nid
);

278 
ASN1_TYPE
 *
PKCS7_gë_sig√d_©åibuã
(
PKCS7_SIGNER_INFO
 *
si
, 
nid
);

279 
PKCS7_£t_sig√d_©åibuãs
(
PKCS7_SIGNER_INFO
 *
p7si
,

280 
STACK_OF
(
X509_ATTRIBUTE
Ë*
sk
);

281 
PKCS7_£t_©åibuãs
(
PKCS7_SIGNER_INFO
 *
p7si
,

282 
STACK_OF
(
X509_ATTRIBUTE
Ë*
sk
);

284 
PKCS7
 *
PKCS7_sign
(
X509
 *
sign˚π
, 
EVP_PKEY
 *
pkey
, 
STACK_OF
(X509Ë*
˚πs
,

285 
BIO
 *
d©a
, 
Êags
);

287 
PKCS7_SIGNER_INFO
 *
PKCS7_sign_add_sig√r
(
PKCS7
 *
p7
,

288 
X509
 *
sign˚π
, 
EVP_PKEY
 *
pkey
,

289 c⁄° 
EVP_MD
 *
md
, 
Êags
);

291 
PKCS7_föÆ
(
PKCS7
 *
p7
, 
BIO
 *
d©a
, 
Êags
);

292 
PKCS7_vîify
(
PKCS7
 *
p7
, 
STACK_OF
(
X509
Ë*
˚πs
, 
X509_STORE
 *
°‹e
,

293 
BIO
 *
öd©a
, BIO *
out
, 
Êags
);

294 
STACK_OF
(
X509
Ë*
PKCS7_gë0_sig√rs
(
PKCS7
 *
p7
, STACK_OF(X509Ë*
˚πs
,

295 
Êags
);

296 
PKCS7
 *
PKCS7_í¸y±
(
STACK_OF
(
X509
Ë*
˚πs
, 
BIO
 *
ö
, c⁄° 
EVP_CIPHER
 *
cùhî
,

297 
Êags
);

298 
PKCS7_de¸y±
(
PKCS7
 *
p7
, 
EVP_PKEY
 *
pkey
, 
X509
 *
˚π
, 
BIO
 *
d©a
,

299 
Êags
);

301 
PKCS7_add_©åib_smimeˇp
(
PKCS7_SIGNER_INFO
 *
si
,

302 
STACK_OF
(
X509_ALGOR
Ë*
ˇp
);

303 
STACK_OF
(
X509_ALGOR
Ë*
PKCS7_gë_smimeˇp
(
PKCS7_SIGNER_INFO
 *
si
);

304 
PKCS7_sim∂e_smimeˇp
(
STACK_OF
(
X509_ALGOR
Ë*
sk
, 
nid
, 
¨g
);

306 
PKCS7_add_©åib_c⁄ã¡_ty≥
(
PKCS7_SIGNER_INFO
 *
si
, 
ASN1_OBJECT
 *
coid
);

307 
PKCS7_add0_©åib_signög_time
(
PKCS7_SIGNER_INFO
 *
si
, 
ASN1_TIME
 *
t
);

308 
PKCS7_add1_©åib_dige°
(
PKCS7_SIGNER_INFO
 *
si
,

309 c⁄° *
md
, 
mdÀn
);

311 
SMIME_wrôe_PKCS7
(
BIO
 *
bio
, 
PKCS7
 *
p7
, BIO *
d©a
, 
Êags
);

312 
PKCS7
 *
SMIME_ªad_PKCS7
(
BIO
 *
bio
, BIO **
bc⁄t
);

314 
BIO
 *
BIO_√w_PKCS7
(BIO *
out
, 
PKCS7
 *
p7
);

316 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/rsa.h

10 #i‚de‡
HEADER_RSA_H


11 
	#HEADER_RSA_H


	)

13 
	~<›ís¶/›ís¶c⁄f.h
>

15 #i‚de‡
OPENSSL_NO_RSA


16 
	~<›ís¶/a¢1.h
>

17 
	~<›ís¶/bio.h
>

18 
	~<›ís¶/¸y±o.h
>

19 
	~<›ís¶/os¶_typ.h
>

20 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

21 
	~<›ís¶/bn.h
>

23 
	~<›ís¶/rßîr.h
>

24 #ifde‡ 
__˝lu•lus


30 #i‚de‡
OPENSSL_RSA_MAX_MODULUS_BITS


31 
	#OPENSSL_RSA_MAX_MODULUS_BITS
 16384

	)

34 
	#OPENSSL_RSA_FIPS_MIN_MODULUS_BITS
 1024

	)

36 #i‚de‡
OPENSSL_RSA_SMALL_MODULUS_BITS


37 
	#OPENSSL_RSA_SMALL_MODULUS_BITS
 3072

	)

39 #i‚de‡
OPENSSL_RSA_MAX_PUBEXP_BITS


42 
	#OPENSSL_RSA_MAX_PUBEXP_BITS
 64

	)

45 
	#RSA_3
 0x3L

	)

46 
	#RSA_F4
 0x10001L

	)

49 
	#RSA_ASN1_VERSION_DEFAULT
 0

	)

50 
	#RSA_ASN1_VERSION_MULTI
 1

	)

52 
	#RSA_DEFAULT_PRIME_NUM
 2

	)

54 
	#RSA_METHOD_FLAG_NO_CHECK
 0x0001

	)

57 
	#RSA_FLAG_CACHE_PUBLIC
 0x0002

	)

58 
	#RSA_FLAG_CACHE_PRIVATE
 0x0004

	)

59 
	#RSA_FLAG_BLINDING
 0x0008

	)

60 
	#RSA_FLAG_THREAD_SAFE
 0x0010

	)

67 
	#RSA_FLAG_EXT_PKEY
 0x0020

	)

75 
	#RSA_FLAG_NO_BLINDING
 0x0080

	)

76 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

80 
	#RSA_FLAG_NO_CONSTTIME
 0x0000

	)

82 #i‡
OPENSSL_API_COMPAT
 < 0x00908000L

92 
	#RSA_FLAG_NO_EXP_CONSTTIME
 
RSA_FLAG_NO_CONSTTIME


	)

95 
	#EVP_PKEY_CTX_£t_rß_∑ddög
(
˘x
, 
∑d
) \

96 
	`RSA_pkey_˘x_˘æ
(
˘x
, -1, 
EVP_PKEY_CTRL_RSA_PADDING
, 
∑d
, 
NULL
)

	)

98 
	#EVP_PKEY_CTX_gë_rß_∑ddög
(
˘x
, 
µad
) \

99 
	`RSA_pkey_˘x_˘æ
(
˘x
, -1, 
EVP_PKEY_CTRL_GET_RSA_PADDING
, 0, 
µad
)

	)

101 
	#EVP_PKEY_CTX_£t_rß_pss_ß…Àn
(
˘x
, 
Àn
) \

102 
	`RSA_pkey_˘x_˘æ
(
˘x
, (
EVP_PKEY_OP_SIGN
|
EVP_PKEY_OP_VERIFY
), \

103 
EVP_PKEY_CTRL_RSA_PSS_SALTLEN
, 
Àn
, 
NULL
)

	)

105 
	#RSA_PSS_SALTLEN_DIGEST
 -1

	)

107 
	#RSA_PSS_SALTLEN_AUTO
 -2

	)

109 
	#RSA_PSS_SALTLEN_MAX
 -3

	)

111 
	#RSA_PSS_SALTLEN_MAX_SIGN
 -2

	)

113 
	#EVP_PKEY_CTX_£t_rß_pss_keygí_ß…Àn
(
˘x
, 
Àn
) \

114 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_RSA_PSS
, 
EVP_PKEY_OP_KEYGEN
, \

115 
EVP_PKEY_CTRL_RSA_PSS_SALTLEN
, 
Àn
, 
NULL
)

	)

117 
	#EVP_PKEY_CTX_gë_rß_pss_ß…Àn
(
˘x
, 
∂í
) \

118 
	`RSA_pkey_˘x_˘æ
(
˘x
, (
EVP_PKEY_OP_SIGN
|
EVP_PKEY_OP_VERIFY
), \

119 
EVP_PKEY_CTRL_GET_RSA_PSS_SALTLEN
, 0, 
∂í
)

	)

121 
	#EVP_PKEY_CTX_£t_rß_keygí_bôs
(
˘x
, 
bôs
) \

122 
	`RSA_pkey_˘x_˘æ
(
˘x
, 
EVP_PKEY_OP_KEYGEN
, \

123 
EVP_PKEY_CTRL_RSA_KEYGEN_BITS
, 
bôs
, 
NULL
)

	)

125 
	#EVP_PKEY_CTX_£t_rß_keygí_pubexp
(
˘x
, 
pubexp
) \

126 
	`RSA_pkey_˘x_˘æ
(
˘x
, 
EVP_PKEY_OP_KEYGEN
, \

127 
EVP_PKEY_CTRL_RSA_KEYGEN_PUBEXP
, 0, 
pubexp
)

	)

129 
	#EVP_PKEY_CTX_£t_rß_keygí_¥imes
(
˘x
, 
¥imes
) \

130 
	`RSA_pkey_˘x_˘æ
(
˘x
, 
EVP_PKEY_OP_KEYGEN
, \

131 
EVP_PKEY_CTRL_RSA_KEYGEN_PRIMES
, 
¥imes
, 
NULL
)

	)

133 
	#EVP_PKEY_CTX_£t_rß_mgf1_md
(
˘x
, 
md
) \

134 
	`RSA_pkey_˘x_˘æ
(
˘x
, 
EVP_PKEY_OP_TYPE_SIG
 | 
EVP_PKEY_OP_TYPE_CRYPT
, \

135 
EVP_PKEY_CTRL_RSA_MGF1_MD
, 0, (*)(
md
))

	)

137 
	#EVP_PKEY_CTX_£t_rß_pss_keygí_mgf1_md
(
˘x
, 
md
) \

138 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_RSA_PSS
, 
EVP_PKEY_OP_KEYGEN
, \

139 
EVP_PKEY_CTRL_RSA_MGF1_MD
, 0, (*)(
md
))

	)

141 
	#EVP_PKEY_CTX_£t_rß_ﬂï_md
(
˘x
, 
md
) \

142 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_RSA
, 
EVP_PKEY_OP_TYPE_CRYPT
, \

143 
EVP_PKEY_CTRL_RSA_OAEP_MD
, 0, (*)(
md
))

	)

145 
	#EVP_PKEY_CTX_gë_rß_mgf1_md
(
˘x
, 
pmd
) \

146 
	`RSA_pkey_˘x_˘æ
(
˘x
, 
EVP_PKEY_OP_TYPE_SIG
 | 
EVP_PKEY_OP_TYPE_CRYPT
, \

147 
EVP_PKEY_CTRL_GET_RSA_MGF1_MD
, 0, (*)(
pmd
))

	)

149 
	#EVP_PKEY_CTX_gë_rß_ﬂï_md
(
˘x
, 
pmd
) \

150 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_RSA
, 
EVP_PKEY_OP_TYPE_CRYPT
, \

151 
EVP_PKEY_CTRL_GET_RSA_OAEP_MD
, 0, (*)(
pmd
))

	)

153 
	#EVP_PKEY_CTX_£t0_rß_ﬂï_œbñ
(
˘x
, 
l
, 
Œí
) \

154 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_RSA
, 
EVP_PKEY_OP_TYPE_CRYPT
, \

155 
EVP_PKEY_CTRL_RSA_OAEP_LABEL
, 
Œí
, (*)(
l
))

	)

157 
	#EVP_PKEY_CTX_gë0_rß_ﬂï_œbñ
(
˘x
, 
l
) \

158 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_RSA
, 
EVP_PKEY_OP_TYPE_CRYPT
, \

159 
EVP_PKEY_CTRL_GET_RSA_OAEP_LABEL
, 0, (*)(
l
))

	)

161 
	#EVP_PKEY_CTX_£t_rß_pss_keygí_md
(
˘x
, 
md
) \

162 
	`EVP_PKEY_CTX_˘æ
(
˘x
, 
EVP_PKEY_RSA_PSS
, \

163 
EVP_PKEY_OP_KEYGEN
, 
EVP_PKEY_CTRL_MD
, \

164 0, (*)(
md
))

	)

166 
	#EVP_PKEY_CTRL_RSA_PADDING
 (
EVP_PKEY_ALG_CTRL
 + 1)

	)

167 
	#EVP_PKEY_CTRL_RSA_PSS_SALTLEN
 (
EVP_PKEY_ALG_CTRL
 + 2)

	)

169 
	#EVP_PKEY_CTRL_RSA_KEYGEN_BITS
 (
EVP_PKEY_ALG_CTRL
 + 3)

	)

170 
	#EVP_PKEY_CTRL_RSA_KEYGEN_PUBEXP
 (
EVP_PKEY_ALG_CTRL
 + 4)

	)

171 
	#EVP_PKEY_CTRL_RSA_MGF1_MD
 (
EVP_PKEY_ALG_CTRL
 + 5)

	)

173 
	#EVP_PKEY_CTRL_GET_RSA_PADDING
 (
EVP_PKEY_ALG_CTRL
 + 6)

	)

174 
	#EVP_PKEY_CTRL_GET_RSA_PSS_SALTLEN
 (
EVP_PKEY_ALG_CTRL
 + 7)

	)

175 
	#EVP_PKEY_CTRL_GET_RSA_MGF1_MD
 (
EVP_PKEY_ALG_CTRL
 + 8)

	)

177 
	#EVP_PKEY_CTRL_RSA_OAEP_MD
 (
EVP_PKEY_ALG_CTRL
 + 9)

	)

178 
	#EVP_PKEY_CTRL_RSA_OAEP_LABEL
 (
EVP_PKEY_ALG_CTRL
 + 10)

	)

180 
	#EVP_PKEY_CTRL_GET_RSA_OAEP_MD
 (
EVP_PKEY_ALG_CTRL
 + 11)

	)

181 
	#EVP_PKEY_CTRL_GET_RSA_OAEP_LABEL
 (
EVP_PKEY_ALG_CTRL
 + 12)

	)

183 
	#EVP_PKEY_CTRL_RSA_KEYGEN_PRIMES
 (
EVP_PKEY_ALG_CTRL
 + 13)

	)

185 
	#RSA_PKCS1_PADDING
 1

	)

186 
	#RSA_SSLV23_PADDING
 2

	)

187 
	#RSA_NO_PADDING
 3

	)

188 
	#RSA_PKCS1_OAEP_PADDING
 4

	)

189 
	#RSA_X931_PADDING
 5

	)

191 
	#RSA_PKCS1_PSS_PADDING
 6

	)

193 
	#RSA_PKCS1_PADDING_SIZE
 11

	)

195 
	#RSA_£t_≠p_d©a
(
s
,
¨g
Ë
	`RSA_£t_ex_d©a
(s,0,¨g)

	)

196 
	#RSA_gë_≠p_d©a
(
s
Ë
	`RSA_gë_ex_d©a
(s,0)

	)

198 
RSA
 *
RSA_√w
();

199 
RSA
 *
RSA_√w_mëhod
(
ENGINE
 *
ígöe
);

200 
RSA_bôs
(c⁄° 
RSA
 *
rß
);

201 
RSA_size
(c⁄° 
RSA
 *
rß
);

202 
RSA_£curôy_bôs
(c⁄° 
RSA
 *
rß
);

204 
RSA_£t0_key
(
RSA
 *
r
, 
BIGNUM
 *
n
, BIGNUM *
e
, BIGNUM *
d
);

205 
RSA_£t0_Á˘‹s
(
RSA
 *
r
, 
BIGNUM
 *
p
, BIGNUM *
q
);

206 
RSA_£t0_¸t_∑øms
(
RSA
 *
r
,
BIGNUM
 *
dmp1
, BIGNUM *
dmq1
, BIGNUM *
iqmp
);

207 
RSA_£t0_mu…i_¥ime_∑øms
(
RSA
 *
r
, 
BIGNUM
 *
¥imes
[], BIGNUM *
exps
[],

208 
BIGNUM
 *
c€ffs
[], 
≤um
);

209 
RSA_gë0_key
(c⁄° 
RSA
 *
r
,

210 c⁄° 
BIGNUM
 **
n
, c⁄° BIGNUM **
e
, c⁄° BIGNUM **
d
);

211 
RSA_gë0_Á˘‹s
(c⁄° 
RSA
 *
r
, c⁄° 
BIGNUM
 **
p
, c⁄° BIGNUM **
q
);

212 
RSA_gë_mu…i_¥ime_exåa_cou¡
(c⁄° 
RSA
 *
r
);

213 
RSA_gë0_mu…i_¥ime_Á˘‹s
(c⁄° 
RSA
 *
r
, c⁄° 
BIGNUM
 *
¥imes
[]);

214 
RSA_gë0_¸t_∑øms
(c⁄° 
RSA
 *
r
,

215 c⁄° 
BIGNUM
 **
dmp1
, c⁄° BIGNUM **
dmq1
,

216 c⁄° 
BIGNUM
 **
iqmp
);

217 
RSA_gë0_mu…i_¥ime_¸t_∑øms
(c⁄° 
RSA
 *
r
, c⁄° 
BIGNUM
 *
exps
[],

218 c⁄° 
BIGNUM
 *
c€ffs
[]);

219 c⁄° 
BIGNUM
 *
RSA_gë0_n
(c⁄° 
RSA
 *
d
);

220 c⁄° 
BIGNUM
 *
RSA_gë0_e
(c⁄° 
RSA
 *
d
);

221 c⁄° 
BIGNUM
 *
RSA_gë0_d
(c⁄° 
RSA
 *
d
);

222 c⁄° 
BIGNUM
 *
RSA_gë0_p
(c⁄° 
RSA
 *
d
);

223 c⁄° 
BIGNUM
 *
RSA_gë0_q
(c⁄° 
RSA
 *
d
);

224 c⁄° 
BIGNUM
 *
RSA_gë0_dmp1
(c⁄° 
RSA
 *
r
);

225 c⁄° 
BIGNUM
 *
RSA_gë0_dmq1
(c⁄° 
RSA
 *
r
);

226 c⁄° 
BIGNUM
 *
RSA_gë0_iqmp
(c⁄° 
RSA
 *
r
);

227 
RSA_˛ór_Êags
(
RSA
 *
r
, 
Êags
);

228 
RSA_ã°_Êags
(c⁄° 
RSA
 *
r
, 
Êags
);

229 
RSA_£t_Êags
(
RSA
 *
r
, 
Êags
);

230 
RSA_gë_vîsi⁄
(
RSA
 *
r
);

231 
ENGINE
 *
RSA_gë0_ígöe
(c⁄° 
RSA
 *
r
);

234 
DEPRECATEDIN_0_9_8
(
RSA
 *
RSA_gíî©e_key
(
bôs
, 
e
, 

235 (*
ˇŒback
) (, , *),

236 *
cb_¨g
))

239 
RSA_gíî©e_key_ex
(
RSA
 *
rß
, 
bôs
, 
BIGNUM
 *
e
, 
BN_GENCB
 *
cb
);

241 
RSA_gíî©e_mu…i_¥ime_key
(
RSA
 *
rß
, 
bôs
, 
¥imes
,

242 
BIGNUM
 *
e
, 
BN_GENCB
 *
cb
);

244 
RSA_X931_dîive_ex
(
RSA
 *
rß
, 
BIGNUM
 *
p1
, BIGNUM *
p2
, BIGNUM *
q1
,

245 
BIGNUM
 *
q2
, c⁄° BIGNUM *
Xp1
, c⁄° BIGNUM *
Xp2
,

246 c⁄° 
BIGNUM
 *
Xp
, c⁄° BIGNUM *
Xq1
, c⁄° BIGNUM *
Xq2
,

247 c⁄° 
BIGNUM
 *
Xq
, c⁄° BIGNUM *
e
, 
BN_GENCB
 *
cb
);

248 
RSA_X931_gíî©e_key_ex
(
RSA
 *
rß
, 
bôs
, c⁄° 
BIGNUM
 *
e
,

249 
BN_GENCB
 *
cb
);

251 
RSA_check_key
(c⁄° 
RSA
 *);

252 
RSA_check_key_ex
(c⁄° 
RSA
 *, 
BN_GENCB
 *
cb
);

254 
RSA_public_í¸y±
(
Êí
, c⁄° *
‰om
,

255 *
to
, 
RSA
 *
rß
, 
∑ddög
);

256 
RSA_¥iv©e_í¸y±
(
Êí
, c⁄° *
‰om
,

257 *
to
, 
RSA
 *
rß
, 
∑ddög
);

258 
RSA_public_de¸y±
(
Êí
, c⁄° *
‰om
,

259 *
to
, 
RSA
 *
rß
, 
∑ddög
);

260 
RSA_¥iv©e_de¸y±
(
Êí
, c⁄° *
‰om
,

261 *
to
, 
RSA
 *
rß
, 
∑ddög
);

262 
RSA_‰ì
(
RSA
 *
r
);

264 
RSA_up_ªf
(
RSA
 *
r
);

266 
RSA_Êags
(c⁄° 
RSA
 *
r
);

268 
RSA_£t_deÁu…_mëhod
(c⁄° 
RSA_METHOD
 *
mëh
);

269 c⁄° 
RSA_METHOD
 *
RSA_gë_deÁu…_mëhod
();

270 c⁄° 
RSA_METHOD
 *
RSA_nuŒ_mëhod
();

271 c⁄° 
RSA_METHOD
 *
RSA_gë_mëhod
(c⁄° 
RSA
 *
rß
);

272 
RSA_£t_mëhod
(
RSA
 *
rß
, c⁄° 
RSA_METHOD
 *
mëh
);

275 c⁄° 
RSA_METHOD
 *
RSA_PKCS1_O≥nSSL
();

277 
RSA_pkey_˘x_˘æ
(
EVP_PKEY_CTX
 *
˘x
, 
›ty≥
, 
cmd
, 
p1
, *
p2
);

279 
DECLARE_ASN1_ENCODE_FUNCTIONS_c⁄°
(
RSA
, 
RSAPublicKey
)

280 
DECLARE_ASN1_ENCODE_FUNCTIONS_c⁄°
(
RSA
, 
RSAPriv©eKey
)

282 
	srß_pss_∑øms_°
 {

283 
X509_ALGOR
 *
hashAlg‹ôhm
;

284 
X509_ALGOR
 *
maskGíAlg‹ôhm
;

285 
ASN1_INTEGER
 *
ß…Lígth
;

286 
ASN1_INTEGER
 *
åaûîFõld
;

288 
X509_ALGOR
 *
maskHash
;

289 } 
	tRSA_PSS_PARAMS
;

291 
DECLARE_ASN1_FUNCTIONS
(
RSA_PSS_PARAMS
)

293 
	srß_ﬂï_∑øms_°
 {

294 
X509_ALGOR
 *
hashFunc
;

295 
X509_ALGOR
 *
maskGíFunc
;

296 
X509_ALGOR
 *
pSour˚Func
;

298 
X509_ALGOR
 *
maskHash
;

299 } 
	tRSA_OAEP_PARAMS
;

301 
DECLARE_ASN1_FUNCTIONS
(
RSA_OAEP_PARAMS
)

303 #i‚de‡
OPENSSL_NO_STDIO


304 
RSA_¥öt_Â
(
FILE
 *
Â
, c⁄° 
RSA
 *
r
, 
off£t
);

307 
RSA_¥öt
(
BIO
 *
bp
, c⁄° 
RSA
 *
r
, 
off£t
);

313 
RSA_sign
(
ty≥
, c⁄° *
m
, 
m_Àngth
,

314 *
sigªt
, *
sigÀn
, 
RSA
 *
rß
);

315 
RSA_vîify
(
ty≥
, c⁄° *
m
, 
m_Àngth
,

316 c⁄° *
sigbuf
, 
sigÀn
, 
RSA
 *
rß
);

322 
RSA_sign_ASN1_OCTET_STRING
(
ty≥
,

323 c⁄° *
m
, 
m_Àngth
,

324 *
sigªt
, *
sigÀn
,

325 
RSA
 *
rß
);

326 
RSA_vîify_ASN1_OCTET_STRING
(
ty≥
, c⁄° *
m
,

327 
m_Àngth
, *
sigbuf
,

328 
sigÀn
, 
RSA
 *
rß
);

330 
RSA_blödög_⁄
(
RSA
 *
rß
, 
BN_CTX
 *
˘x
);

331 
RSA_blödög_off
(
RSA
 *
rß
);

332 
BN_BLINDING
 *
RSA_£tup_blödög
(
RSA
 *
rß
, 
BN_CTX
 *
˘x
);

334 
RSA_∑ddög_add_PKCS1_ty≥_1
(*
to
, 
éí
,

335 c⁄° *
f
, 
Ê
);

336 
RSA_∑ddög_check_PKCS1_ty≥_1
(*
to
, 
éí
,

337 c⁄° *
f
, 
Ê
,

338 
rß_Àn
);

339 
RSA_∑ddög_add_PKCS1_ty≥_2
(*
to
, 
éí
,

340 c⁄° *
f
, 
Ê
);

341 
RSA_∑ddög_check_PKCS1_ty≥_2
(*
to
, 
éí
,

342 c⁄° *
f
, 
Ê
,

343 
rß_Àn
);

344 
PKCS1_MGF1
(*
mask
, 
Àn
, c⁄° *
£ed
,

345 
£edÀn
, c⁄° 
EVP_MD
 *
dg°
);

346 
RSA_∑ddög_add_PKCS1_OAEP
(*
to
, 
éí
,

347 c⁄° *
f
, 
Ê
,

348 c⁄° *
p
, 
∂
);

349 
RSA_∑ddög_check_PKCS1_OAEP
(*
to
, 
éí
,

350 c⁄° *
f
, 
Ê
, 
rß_Àn
,

351 c⁄° *
p
, 
∂
);

352 
RSA_∑ddög_add_PKCS1_OAEP_mgf1
(*
to
, 
éí
,

353 c⁄° *
‰om
, 
Êí
,

354 c⁄° *
∑øm
, 
∂í
,

355 c⁄° 
EVP_MD
 *
md
, c⁄° EVP_MD *
mgf1md
);

356 
RSA_∑ddög_check_PKCS1_OAEP_mgf1
(*
to
, 
éí
,

357 c⁄° *
‰om
, 
Êí
,

358 
num
, c⁄° *
∑øm
,

359 
∂í
, c⁄° 
EVP_MD
 *
md
,

360 c⁄° 
EVP_MD
 *
mgf1md
);

361 
RSA_∑ddög_add_SSLv23
(*
to
, 
éí
,

362 c⁄° *
f
, 
Ê
);

363 
RSA_∑ddög_check_SSLv23
(*
to
, 
éí
,

364 c⁄° *
f
, 
Ê
, 
rß_Àn
);

365 
RSA_∑ddög_add_n⁄e
(*
to
, 
éí
, c⁄° *
f
,

366 
Ê
);

367 
RSA_∑ddög_check_n⁄e
(*
to
, 
éí
,

368 c⁄° *
f
, 
Ê
, 
rß_Àn
);

369 
RSA_∑ddög_add_X931
(*
to
, 
éí
, c⁄° *
f
,

370 
Ê
);

371 
RSA_∑ddög_check_X931
(*
to
, 
éí
,

372 c⁄° *
f
, 
Ê
, 
rß_Àn
);

373 
RSA_X931_hash_id
(
nid
);

375 
RSA_vîify_PKCS1_PSS
(
RSA
 *
rß
, c⁄° *
mHash
,

376 c⁄° 
EVP_MD
 *
Hash
, c⁄° *
EM
,

377 
sLí
);

378 
RSA_∑ddög_add_PKCS1_PSS
(
RSA
 *
rß
, *
EM
,

379 c⁄° *
mHash
, c⁄° 
EVP_MD
 *
Hash
,

380 
sLí
);

382 
RSA_vîify_PKCS1_PSS_mgf1
(
RSA
 *
rß
, c⁄° *
mHash
,

383 c⁄° 
EVP_MD
 *
Hash
, c⁄° EVP_MD *
mgf1Hash
,

384 c⁄° *
EM
, 
sLí
);

386 
RSA_∑ddög_add_PKCS1_PSS_mgf1
(
RSA
 *
rß
, *
EM
,

387 c⁄° *
mHash
,

388 c⁄° 
EVP_MD
 *
Hash
, c⁄° EVP_MD *
mgf1Hash
,

389 
sLí
);

391 
	#RSA_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

392 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_RSA
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

393 
RSA_£t_ex_d©a
(
RSA
 *
r
, 
idx
, *
¨g
);

394 *
RSA_gë_ex_d©a
(c⁄° 
RSA
 *
r
, 
idx
);

396 
RSA
 *
RSAPublicKey_dup
(RSA *
rß
);

397 
RSA
 *
RSAPriv©eKey_dup
(RSA *
rß
);

406 
	#RSA_FLAG_FIPS_METHOD
 0x0400

	)

414 
	#RSA_FLAG_NON_FIPS_ALLOW
 0x0400

	)

419 
	#RSA_FLAG_CHECKED
 0x0800

	)

421 
RSA_METHOD
 *
RSA_mëh_√w
(c⁄° *
«me
, 
Êags
);

422 
RSA_mëh_‰ì
(
RSA_METHOD
 *
mëh
);

423 
RSA_METHOD
 *
RSA_mëh_dup
(c⁄° RSA_METHOD *
mëh
);

424 c⁄° *
RSA_mëh_gë0_«me
(c⁄° 
RSA_METHOD
 *
mëh
);

425 
RSA_mëh_£t1_«me
(
RSA_METHOD
 *
mëh
, c⁄° *
«me
);

426 
RSA_mëh_gë_Êags
(c⁄° 
RSA_METHOD
 *
mëh
);

427 
RSA_mëh_£t_Êags
(
RSA_METHOD
 *
mëh
, 
Êags
);

428 *
RSA_mëh_gë0_≠p_d©a
(c⁄° 
RSA_METHOD
 *
mëh
);

429 
RSA_mëh_£t0_≠p_d©a
(
RSA_METHOD
 *
mëh
, *
≠p_d©a
);

430 (*
RSA_mëh_gë_pub_íc
(c⁄° 
RSA_METHOD
 *
mëh
))

431 (
Êí
, c⁄° *
‰om
,

432 *
to
, 
RSA
 *
rß
, 
∑ddög
);

433 
RSA_mëh_£t_pub_íc
(
RSA_METHOD
 *
rß
,

434 (*
pub_íc
Ë(
Êí
, c⁄° *
‰om
,

435 *
to
, 
RSA
 *
rß
,

436 
∑ddög
));

437 (*
RSA_mëh_gë_pub_dec
(c⁄° 
RSA_METHOD
 *
mëh
))

438 (
Êí
, c⁄° *
‰om
,

439 *
to
, 
RSA
 *
rß
, 
∑ddög
);

440 
RSA_mëh_£t_pub_dec
(
RSA_METHOD
 *
rß
,

441 (*
pub_dec
Ë(
Êí
, c⁄° *
‰om
,

442 *
to
, 
RSA
 *
rß
,

443 
∑ddög
));

444 (*
RSA_mëh_gë_¥iv_íc
(c⁄° 
RSA_METHOD
 *
mëh
))

445 (
Êí
, c⁄° *
‰om
,

446 *
to
, 
RSA
 *
rß
, 
∑ddög
);

447 
RSA_mëh_£t_¥iv_íc
(
RSA_METHOD
 *
rß
,

448 (*
¥iv_íc
Ë(
Êí
, c⁄° *
‰om
,

449 *
to
, 
RSA
 *
rß
,

450 
∑ddög
));

451 (*
RSA_mëh_gë_¥iv_dec
(c⁄° 
RSA_METHOD
 *
mëh
))

452 (
Êí
, c⁄° *
‰om
,

453 *
to
, 
RSA
 *
rß
, 
∑ddög
);

454 
RSA_mëh_£t_¥iv_dec
(
RSA_METHOD
 *
rß
,

455 (*
¥iv_dec
Ë(
Êí
, c⁄° *
‰om
,

456 *
to
, 
RSA
 *
rß
,

457 
∑ddög
));

458 (*
RSA_mëh_gë_mod_exp
(c⁄° 
RSA_METHOD
 *
mëh
))

459 (
BIGNUM
 *
r0
, c⁄° BIGNUM *
i
, 
RSA
 *
rß
, 
BN_CTX
 *
˘x
);

460 
RSA_mëh_£t_mod_exp
(
RSA_METHOD
 *
rß
,

461 (*
mod_exp
Ë(
BIGNUM
 *
r0
, c⁄° BIGNUM *
i
, 
RSA
 *
rß
,

462 
BN_CTX
 *
˘x
));

463 (*
RSA_mëh_gë_bn_mod_exp
(c⁄° 
RSA_METHOD
 *
mëh
))

464 (
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
,

465 c⁄° 
BIGNUM
 *
m
, 
BN_CTX
 *
˘x
, 
BN_MONT_CTX
 *
m_˘x
);

466 
RSA_mëh_£t_bn_mod_exp
(
RSA_METHOD
 *
rß
,

467 (*
bn_mod_exp
Ë(
BIGNUM
 *
r
,

468 c⁄° 
BIGNUM
 *
a
,

469 c⁄° 
BIGNUM
 *
p
,

470 c⁄° 
BIGNUM
 *
m
,

471 
BN_CTX
 *
˘x
,

472 
BN_MONT_CTX
 *
m_˘x
));

473 (*
RSA_mëh_gë_öô
(c⁄° 
RSA_METHOD
 *
mëh
)Ë(
RSA
 *
rß
);

474 
RSA_mëh_£t_öô
(
RSA_METHOD
 *
rß
, (*
öô
Ë(
RSA
 *rsa));

475 (*
RSA_mëh_gë_föish
(c⁄° 
RSA_METHOD
 *
mëh
)Ë(
RSA
 *
rß
);

476 
RSA_mëh_£t_föish
(
RSA_METHOD
 *
rß
, (*
föish
Ë(
RSA
 *rsa));

477 (*
RSA_mëh_gë_sign
(c⁄° 
RSA_METHOD
 *
mëh
))

478 (
ty≥
,

479 c⁄° *
m
, 
m_Àngth
,

480 *
sigªt
, *
sigÀn
,

481 c⁄° 
RSA
 *
rß
);

482 
RSA_mëh_£t_sign
(
RSA_METHOD
 *
rß
,

483 (*
sign
Ë(
ty≥
, c⁄° *
m
,

484 
m_Àngth
,

485 *
sigªt
, *
sigÀn
,

486 c⁄° 
RSA
 *
rß
));

487 (*
RSA_mëh_gë_vîify
(c⁄° 
RSA_METHOD
 *
mëh
))

488 (
dty≥
, c⁄° *
m
,

489 
m_Àngth
, c⁄° *
sigbuf
,

490 
sigÀn
, c⁄° 
RSA
 *
rß
);

491 
RSA_mëh_£t_vîify
(
RSA_METHOD
 *
rß
,

492 (*
vîify
Ë(
dty≥
, c⁄° *
m
,

493 
m_Àngth
,

494 c⁄° *
sigbuf
,

495 
sigÀn
, c⁄° 
RSA
 *
rß
));

496 (*
RSA_mëh_gë_keygí
(c⁄° 
RSA_METHOD
 *
mëh
))

497 (
RSA
 *
rß
, 
bôs
, 
BIGNUM
 *
e
, 
BN_GENCB
 *
cb
);

498 
RSA_mëh_£t_keygí
(
RSA_METHOD
 *
rß
,

499 (*
keygí
Ë(
RSA
 *
rß
, 
bôs
, 
BIGNUM
 *
e
,

500 
BN_GENCB
 *
cb
));

501 (*
RSA_mëh_gë_mu…i_¥ime_keygí
(c⁄° 
RSA_METHOD
 *
mëh
))

502 (
RSA
 *
rß
, 
bôs
, 
¥imes
, 
BIGNUM
 *
e
, 
BN_GENCB
 *
cb
);

503 
RSA_mëh_£t_mu…i_¥ime_keygí
(
RSA_METHOD
 *
mëh
,

504 (*
keygí
Ë(
RSA
 *
rß
, 
bôs
,

505 
¥imes
, 
BIGNUM
 *
e
,

506 
BN_GENCB
 *
cb
));

508 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/sha.h

10 #i‚de‡
HEADER_SHA_H


11 
	#HEADER_SHA_H


	)

13 
	~<›ís¶/e_os2.h
>

14 
	~<°ddef.h
>

16 #ifde‡ 
__˝lu•lus


25 
	#SHA_LONG
 

	)

27 
	#SHA_LBLOCK
 16

	)

28 
	#SHA_CBLOCK
 (
SHA_LBLOCK
*4)

	)

31 
	#SHA_LAST_BLOCK
 (
SHA_CBLOCK
-8)

	)

32 
	#SHA_DIGEST_LENGTH
 20

	)

34 
	sSHA°©e_°
 {

35 
SHA_LONG
 
h0
, 
h1
, 
h2
, 
h3
, 
h4
;

36 
SHA_LONG
 
Nl
, 
Nh
;

37 
SHA_LONG
 
d©a
[
SHA_LBLOCK
];

38 
num
;

39 } 
	tSHA_CTX
;

41 
SHA1_Inô
(
SHA_CTX
 *
c
);

42 
SHA1_Upd©e
(
SHA_CTX
 *
c
, c⁄° *
d©a
, 
size_t
 
Àn
);

43 
SHA1_FöÆ
(*
md
, 
SHA_CTX
 *
c
);

44 *
SHA1
(c⁄° *
d
, 
size_t
 
n
, *
md
);

45 
SHA1_Tønsf‹m
(
SHA_CTX
 *
c
, c⁄° *
d©a
);

47 
	#SHA256_CBLOCK
 (
SHA_LBLOCK
*4)

	)

51 
	sSHA256°©e_°
 {

52 
SHA_LONG
 
h
[8];

53 
SHA_LONG
 
Nl
, 
Nh
;

54 
SHA_LONG
 
d©a
[
SHA_LBLOCK
];

55 
num
, 
md_Àn
;

56 } 
	tSHA256_CTX
;

58 
SHA224_Inô
(
SHA256_CTX
 *
c
);

59 
SHA224_Upd©e
(
SHA256_CTX
 *
c
, c⁄° *
d©a
, 
size_t
 
Àn
);

60 
SHA224_FöÆ
(*
md
, 
SHA256_CTX
 *
c
);

61 *
SHA224
(c⁄° *
d
, 
size_t
 
n
, *
md
);

62 
SHA256_Inô
(
SHA256_CTX
 *
c
);

63 
SHA256_Upd©e
(
SHA256_CTX
 *
c
, c⁄° *
d©a
, 
size_t
 
Àn
);

64 
SHA256_FöÆ
(*
md
, 
SHA256_CTX
 *
c
);

65 *
SHA256
(c⁄° *
d
, 
size_t
 
n
, *
md
);

66 
SHA256_Tønsf‹m
(
SHA256_CTX
 *
c
, c⁄° *
d©a
);

68 
	#SHA224_DIGEST_LENGTH
 28

	)

69 
	#SHA256_DIGEST_LENGTH
 32

	)

70 
	#SHA384_DIGEST_LENGTH
 48

	)

71 
	#SHA512_DIGEST_LENGTH
 64

	)

83 
	#SHA512_CBLOCK
 (
SHA_LBLOCK
*8)

	)

84 #i‡(
deföed
(
_WIN32
Ë|| deföed(
_WIN64
)Ë&& !deföed(
__MINGW32__
)

85 
	#SHA_LONG64
 
__öt64


	)

86 
	#U64
(
C
ËC##
UI64


	)

87 #ñi‡
deföed
(
__¨ch64__
)

88 
	#SHA_LONG64
 

	)

89 
	#U64
(
C
ËC##
UL


	)

91 
	#SHA_LONG64
 

	)

92 
	#U64
(
C
ËC##
ULL


	)

95 
	sSHA512°©e_°
 {

96 
SHA_LONG64
 
h
[8];

97 
SHA_LONG64
 
Nl
, 
Nh
;

99 
SHA_LONG64
 
d
[
SHA_LBLOCK
];

100 
p
[
SHA512_CBLOCK
];

101 } 
u
;

102 
num
, 
md_Àn
;

103 } 
	tSHA512_CTX
;

105 
SHA384_Inô
(
SHA512_CTX
 *
c
);

106 
SHA384_Upd©e
(
SHA512_CTX
 *
c
, c⁄° *
d©a
, 
size_t
 
Àn
);

107 
SHA384_FöÆ
(*
md
, 
SHA512_CTX
 *
c
);

108 *
SHA384
(c⁄° *
d
, 
size_t
 
n
, *
md
);

109 
SHA512_Inô
(
SHA512_CTX
 *
c
);

110 
SHA512_Upd©e
(
SHA512_CTX
 *
c
, c⁄° *
d©a
, 
size_t
 
Àn
);

111 
SHA512_FöÆ
(*
md
, 
SHA512_CTX
 *
c
);

112 *
SHA512
(c⁄° *
d
, 
size_t
 
n
, *
md
);

113 
SHA512_Tønsf‹m
(
SHA512_CTX
 *
c
, c⁄° *
d©a
);

115 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/stack.h

10 #i‚de‡
HEADER_STACK_H


11 
	#HEADER_STACK_H


	)

13 #ifde‡ 
__˝lu•lus


17 
°ack_°
 
	tOPENSSL_STACK
;

19 (*
OPENSSL_sk_compfunc
)(const *, const *);

20 (*
OPENSSL_sk_‰ìfunc
)(*);

21 *(*
	tOPENSSL_sk_c›yfunc
)(const *);

23 
OPENSSL_sk_num
(c⁄° 
OPENSSL_STACK
 *);

24 *
OPENSSL_sk_vÆue
(c⁄° 
OPENSSL_STACK
 *, );

26 *
OPENSSL_sk_£t
(
OPENSSL_STACK
 *
°
, 
i
, c⁄° *
d©a
);

28 
OPENSSL_STACK
 *
OPENSSL_sk_√w
(
OPENSSL_sk_compfunc
 
cmp
);

29 
OPENSSL_STACK
 *
OPENSSL_sk_√w_nuŒ
();

30 
OPENSSL_STACK
 *
OPENSSL_sk_√w_ª£rve
(
OPENSSL_sk_compfunc
 
c
, 
n
);

31 
OPENSSL_sk_ª£rve
(
OPENSSL_STACK
 *
°
, 
n
);

32 
OPENSSL_sk_‰ì
(
OPENSSL_STACK
 *);

33 
OPENSSL_sk_p›_‰ì
(
OPENSSL_STACK
 *
°
, (*
func
) (*));

34 
OPENSSL_STACK
 *
OPENSSL_sk_dìp_c›y
(const OPENSSL_STACK *,

35 
OPENSSL_sk_c›yfunc
 
c
,

36 
OPENSSL_sk_‰ìfunc
 
f
);

37 
OPENSSL_sk_ö£π
(
OPENSSL_STACK
 *
sk
, c⁄° *
d©a
, 
whîe
);

38 *
OPENSSL_sk_dñëe
(
OPENSSL_STACK
 *
°
, 
loc
);

39 *
OPENSSL_sk_dñëe_±r
(
OPENSSL_STACK
 *
°
, c⁄° *
p
);

40 
OPENSSL_sk_föd
(
OPENSSL_STACK
 *
°
, c⁄° *
d©a
);

41 
OPENSSL_sk_föd_ex
(
OPENSSL_STACK
 *
°
, c⁄° *
d©a
);

42 
OPENSSL_sk_push
(
OPENSSL_STACK
 *
°
, c⁄° *
d©a
);

43 
OPENSSL_sk_unshi·
(
OPENSSL_STACK
 *
°
, c⁄° *
d©a
);

44 *
OPENSSL_sk_shi·
(
OPENSSL_STACK
 *
°
);

45 *
OPENSSL_sk_p›
(
OPENSSL_STACK
 *
°
);

46 
OPENSSL_sk_zîo
(
OPENSSL_STACK
 *
°
);

47 
OPENSSL_sk_compfunc
 
OPENSSL_sk_£t_cmp_func
(
OPENSSL_STACK
 *
sk
,

48 
OPENSSL_sk_compfunc
 
cmp
);

49 
OPENSSL_STACK
 *
OPENSSL_sk_dup
(c⁄° OPENSSL_STACK *
°
);

50 
OPENSSL_sk_s‹t
(
OPENSSL_STACK
 *
°
);

51 
OPENSSL_sk_is_s‹ãd
(c⁄° 
OPENSSL_STACK
 *
°
);

53 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

54 
	#_STACK
 
OPENSSL_STACK


	)

55 
	#sk_num
 
OPENSSL_sk_num


	)

56 
	#sk_vÆue
 
OPENSSL_sk_vÆue


	)

57 
	#sk_£t
 
OPENSSL_sk_£t


	)

58 
	#sk_√w
 
OPENSSL_sk_√w


	)

59 
	#sk_√w_nuŒ
 
OPENSSL_sk_√w_nuŒ


	)

60 
	#sk_‰ì
 
OPENSSL_sk_‰ì


	)

61 
	#sk_p›_‰ì
 
OPENSSL_sk_p›_‰ì


	)

62 
	#sk_dìp_c›y
 
OPENSSL_sk_dìp_c›y


	)

63 
	#sk_ö£π
 
OPENSSL_sk_ö£π


	)

64 
	#sk_dñëe
 
OPENSSL_sk_dñëe


	)

65 
	#sk_dñëe_±r
 
OPENSSL_sk_dñëe_±r


	)

66 
	#sk_föd
 
OPENSSL_sk_föd


	)

67 
	#sk_föd_ex
 
OPENSSL_sk_föd_ex


	)

68 
	#sk_push
 
OPENSSL_sk_push


	)

69 
	#sk_unshi·
 
OPENSSL_sk_unshi·


	)

70 
	#sk_shi·
 
OPENSSL_sk_shi·


	)

71 
	#sk_p›
 
OPENSSL_sk_p›


	)

72 
	#sk_zîo
 
OPENSSL_sk_zîo


	)

73 
	#sk_£t_cmp_func
 
OPENSSL_sk_£t_cmp_func


	)

74 
	#sk_dup
 
OPENSSL_sk_dup


	)

75 
	#sk_s‹t
 
OPENSSL_sk_s‹t


	)

76 
	#sk_is_s‹ãd
 
OPENSSL_sk_is_s‹ãd


	)

79 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/x509_vfy.h

10 #i‚de‡
HEADER_X509_VFY_H


11 
	#HEADER_X509_VFY_H


	)

16 #i‚de‡
HEADER_X509_H


17 
	~<›ís¶/x509.h
>

20 
	~<›ís¶/›ís¶c⁄f.h
>

21 
	~<›ís¶/lhash.h
>

22 
	~<›ís¶/bio.h
>

23 
	~<›ís¶/¸y±o.h
>

24 
	~<›ís¶/symhacks.h
>

26 #ifde‡ 
__˝lu•lus


48 
X509_LU_NONE
 = 0,

49 
X509_LU_X509
, 
X509_LU_CRL


50 } 
	tX509_LOOKUP_TYPE
;

52 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

53 
	#X509_LU_RETRY
 -1

	)

54 
	#X509_LU_FAIL
 0

	)

57 
DEFINE_STACK_OF
(
X509_LOOKUP
)

58 
DEFINE_STACK_OF
(
X509_OBJECT
)

59 
DEFINE_STACK_OF
(
X509_VERIFY_PARAM
)

61 
X509_STORE_£t_dïth
(
X509_STORE
 *
°‹e
, 
dïth
);

63 (*
X509_STORE_CTX_vîify_cb
)(, 
	tX509_STORE_CTX
 *);

64 (*
X509_STORE_CTX_vîify_‚
)(
	tX509_STORE_CTX
 *);

65 (*
X509_STORE_CTX_gë_issuî_‚
)(
	tX509
 **
	tissuî
,

66 
	tX509_STORE_CTX
 *
	t˘x
, 
	tX509
 *
	tx
);

67 (*
X509_STORE_CTX_check_issued_‚
)(
	tX509_STORE_CTX
 *
	t˘x
,

68 
	tX509
 *
	tx
, X509 *
	tissuî
);

69 (*
X509_STORE_CTX_check_ªvoˇti⁄_‚
)(
	tX509_STORE_CTX
 *
	t˘x
);

70 (*
X509_STORE_CTX_gë_¸l_‚
)(
	tX509_STORE_CTX
 *
	t˘x
,

71 
	tX509_CRL
 **
	t¸l
, 
	tX509
 *
	tx
);

72 (*
X509_STORE_CTX_check_¸l_‚
)(
	tX509_STORE_CTX
 *
	t˘x
, 
	tX509_CRL
 *
	t¸l
);

73 (*
X509_STORE_CTX_˚π_¸l_‚
)(
	tX509_STORE_CTX
 *
	t˘x
,

74 
	tX509_CRL
 *
	t¸l
, 
	tX509
 *
	tx
);

75 (*
X509_STORE_CTX_check_pﬁicy_‚
)(
	tX509_STORE_CTX
 *
	t˘x
);

76 
STACK_OF
(
	tX509
Ë*(*
	tX509_STORE_CTX_lookup_˚πs_‚
)(
	tX509_STORE_CTX
 *
	t˘x
,

77 
	tX509_NAME
 *
	tnm
);

78 
STACK_OF
(
	tX509_CRL
Ë*(*
	tX509_STORE_CTX_lookup_¸ls_‚
)(
	tX509_STORE_CTX
 *
	t˘x
,

79 
	tX509_NAME
 *
	tnm
);

80 (*
X509_STORE_CTX_˛ónup_‚
)(
	tX509_STORE_CTX
 *
	t˘x
);

83 
X509_STORE_CTX_£t_dïth
(
X509_STORE_CTX
 *
˘x
, 
dïth
);

85 
	#X509_STORE_CTX_£t_≠p_d©a
(
˘x
,
d©a
) \

86 
	`X509_STORE_CTX_£t_ex_d©a
(
˘x
,0,
d©a
)

	)

87 
	#X509_STORE_CTX_gë_≠p_d©a
(
˘x
) \

88 
	`X509_STORE_CTX_gë_ex_d©a
(
˘x
,0)

	)

90 
	#X509_L_FILE_LOAD
 1

	)

91 
	#X509_L_ADD_DIR
 2

	)

93 
	#X509_LOOKUP_lﬂd_fûe
(
x
,
«me
,
ty≥
) \

94 
	`X509_LOOKUP_˘æ
((
x
),
X509_L_FILE_LOAD
,(
«me
),()(
ty≥
),
NULL
)

	)

96 
	#X509_LOOKUP_add_dú
(
x
,
«me
,
ty≥
) \

97 
	`X509_LOOKUP_˘æ
((
x
),
X509_L_ADD_DIR
,(
«me
),()(
ty≥
),
NULL
)

	)

99 
	#X509_V_OK
 0

	)

100 
	#X509_V_ERR_UNSPECIFIED
 1

	)

101 
	#X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT
 2

	)

102 
	#X509_V_ERR_UNABLE_TO_GET_CRL
 3

	)

103 
	#X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE
 4

	)

104 
	#X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE
 5

	)

105 
	#X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY
 6

	)

106 
	#X509_V_ERR_CERT_SIGNATURE_FAILURE
 7

	)

107 
	#X509_V_ERR_CRL_SIGNATURE_FAILURE
 8

	)

108 
	#X509_V_ERR_CERT_NOT_YET_VALID
 9

	)

109 
	#X509_V_ERR_CERT_HAS_EXPIRED
 10

	)

110 
	#X509_V_ERR_CRL_NOT_YET_VALID
 11

	)

111 
	#X509_V_ERR_CRL_HAS_EXPIRED
 12

	)

112 
	#X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD
 13

	)

113 
	#X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD
 14

	)

114 
	#X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD
 15

	)

115 
	#X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD
 16

	)

116 
	#X509_V_ERR_OUT_OF_MEM
 17

	)

117 
	#X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT
 18

	)

118 
	#X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN
 19

	)

119 
	#X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY
 20

	)

120 
	#X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE
 21

	)

121 
	#X509_V_ERR_CERT_CHAIN_TOO_LONG
 22

	)

122 
	#X509_V_ERR_CERT_REVOKED
 23

	)

123 
	#X509_V_ERR_INVALID_CA
 24

	)

124 
	#X509_V_ERR_PATH_LENGTH_EXCEEDED
 25

	)

125 
	#X509_V_ERR_INVALID_PURPOSE
 26

	)

126 
	#X509_V_ERR_CERT_UNTRUSTED
 27

	)

127 
	#X509_V_ERR_CERT_REJECTED
 28

	)

129 
	#X509_V_ERR_SUBJECT_ISSUER_MISMATCH
 29

	)

130 
	#X509_V_ERR_AKID_SKID_MISMATCH
 30

	)

131 
	#X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH
 31

	)

132 
	#X509_V_ERR_KEYUSAGE_NO_CERTSIGN
 32

	)

133 
	#X509_V_ERR_UNABLE_TO_GET_CRL_ISSUER
 33

	)

134 
	#X509_V_ERR_UNHANDLED_CRITICAL_EXTENSION
 34

	)

135 
	#X509_V_ERR_KEYUSAGE_NO_CRL_SIGN
 35

	)

136 
	#X509_V_ERR_UNHANDLED_CRITICAL_CRL_EXTENSION
 36

	)

137 
	#X509_V_ERR_INVALID_NON_CA
 37

	)

138 
	#X509_V_ERR_PROXY_PATH_LENGTH_EXCEEDED
 38

	)

139 
	#X509_V_ERR_KEYUSAGE_NO_DIGITAL_SIGNATURE
 39

	)

140 
	#X509_V_ERR_PROXY_CERTIFICATES_NOT_ALLOWED
 40

	)

141 
	#X509_V_ERR_INVALID_EXTENSION
 41

	)

142 
	#X509_V_ERR_INVALID_POLICY_EXTENSION
 42

	)

143 
	#X509_V_ERR_NO_EXPLICIT_POLICY
 43

	)

144 
	#X509_V_ERR_DIFFERENT_CRL_SCOPE
 44

	)

145 
	#X509_V_ERR_UNSUPPORTED_EXTENSION_FEATURE
 45

	)

146 
	#X509_V_ERR_UNNESTED_RESOURCE
 46

	)

147 
	#X509_V_ERR_PERMITTED_VIOLATION
 47

	)

148 
	#X509_V_ERR_EXCLUDED_VIOLATION
 48

	)

149 
	#X509_V_ERR_SUBTREE_MINMAX
 49

	)

151 
	#X509_V_ERR_APPLICATION_VERIFICATION
 50

	)

152 
	#X509_V_ERR_UNSUPPORTED_CONSTRAINT_TYPE
 51

	)

153 
	#X509_V_ERR_UNSUPPORTED_CONSTRAINT_SYNTAX
 52

	)

154 
	#X509_V_ERR_UNSUPPORTED_NAME_SYNTAX
 53

	)

155 
	#X509_V_ERR_CRL_PATH_VALIDATION_ERROR
 54

	)

157 
	#X509_V_ERR_PATH_LOOP
 55

	)

159 
	#X509_V_ERR_SUITE_B_INVALID_VERSION
 56

	)

160 
	#X509_V_ERR_SUITE_B_INVALID_ALGORITHM
 57

	)

161 
	#X509_V_ERR_SUITE_B_INVALID_CURVE
 58

	)

162 
	#X509_V_ERR_SUITE_B_INVALID_SIGNATURE_ALGORITHM
 59

	)

163 
	#X509_V_ERR_SUITE_B_LOS_NOT_ALLOWED
 60

	)

164 
	#X509_V_ERR_SUITE_B_CANNOT_SIGN_P_384_WITH_P_256
 61

	)

166 
	#X509_V_ERR_HOSTNAME_MISMATCH
 62

	)

167 
	#X509_V_ERR_EMAIL_MISMATCH
 63

	)

168 
	#X509_V_ERR_IP_ADDRESS_MISMATCH
 64

	)

170 
	#X509_V_ERR_DANE_NO_MATCH
 65

	)

172 
	#X509_V_ERR_EE_KEY_TOO_SMALL
 66

	)

173 
	#X509_V_ERR_CA_KEY_TOO_SMALL
 67

	)

174 
	#X509_V_ERR_CA_MD_TOO_WEAK
 68

	)

176 
	#X509_V_ERR_INVALID_CALL
 69

	)

178 
	#X509_V_ERR_STORE_LOOKUP
 70

	)

180 
	#X509_V_ERR_NO_VALID_SCTS
 71

	)

182 
	#X509_V_ERR_PROXY_SUBJECT_NAME_VIOLATION
 72

	)

184 
	#X509_V_ERR_OCSP_VERIFY_NEEDED
 73

	)

185 
	#X509_V_ERR_OCSP_VERIFY_FAILED
 74

	)

186 
	#X509_V_ERR_OCSP_CERT_UNKNOWN
 75

	)

190 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

191 
	#X509_V_FLAG_CB_ISSUER_CHECK
 0x0

	)

194 
	#X509_V_FLAG_USE_CHECK_TIME
 0x2

	)

196 
	#X509_V_FLAG_CRL_CHECK
 0x4

	)

198 
	#X509_V_FLAG_CRL_CHECK_ALL
 0x8

	)

200 
	#X509_V_FLAG_IGNORE_CRITICAL
 0x10

	)

202 
	#X509_V_FLAG_X509_STRICT
 0x20

	)

204 
	#X509_V_FLAG_ALLOW_PROXY_CERTS
 0x40

	)

206 
	#X509_V_FLAG_POLICY_CHECK
 0x80

	)

208 
	#X509_V_FLAG_EXPLICIT_POLICY
 0x100

	)

210 
	#X509_V_FLAG_INHIBIT_ANY
 0x200

	)

212 
	#X509_V_FLAG_INHIBIT_MAP
 0x400

	)

214 
	#X509_V_FLAG_NOTIFY_POLICY
 0x800

	)

216 
	#X509_V_FLAG_EXTENDED_CRL_SUPPORT
 0x1000

	)

218 
	#X509_V_FLAG_USE_DELTAS
 0x2000

	)

220 
	#X509_V_FLAG_CHECK_SS_SIGNATURE
 0x4000

	)

222 
	#X509_V_FLAG_TRUSTED_FIRST
 0x8000

	)

224 
	#X509_V_FLAG_SUITEB_128_LOS_ONLY
 0x10000

	)

226 
	#X509_V_FLAG_SUITEB_192_LOS
 0x20000

	)

228 
	#X509_V_FLAG_SUITEB_128_LOS
 0x30000

	)

230 
	#X509_V_FLAG_PARTIAL_CHAIN
 0x80000

	)

236 
	#X509_V_FLAG_NO_ALT_CHAINS
 0x100000

	)

238 
	#X509_V_FLAG_NO_CHECK_TIME
 0x200000

	)

240 
	#X509_VP_FLAG_DEFAULT
 0x1

	)

241 
	#X509_VP_FLAG_OVERWRITE
 0x2

	)

242 
	#X509_VP_FLAG_RESET_FLAGS
 0x4

	)

243 
	#X509_VP_FLAG_LOCKED
 0x8

	)

244 
	#X509_VP_FLAG_ONCE
 0x10

	)

247 
	#X509_V_FLAG_POLICY_MASK
 (
X509_V_FLAG_POLICY_CHECK
 \

248 | 
X509_V_FLAG_EXPLICIT_POLICY
 \

249 | 
X509_V_FLAG_INHIBIT_ANY
 \

250 | 
X509_V_FLAG_INHIBIT_MAP
)

	)

252 
X509_OBJECT_idx_by_subje˘
(
STACK_OF
(
X509_OBJECT
Ë*
h
, 
X509_LOOKUP_TYPE
 
ty≥
,

253 
X509_NAME
 *
«me
);

254 
X509_OBJECT
 *
X509_OBJECT_ªåõve_by_subje˘
(
STACK_OF
(X509_OBJECTË*
h
,

255 
X509_LOOKUP_TYPE
 
ty≥
,

256 
X509_NAME
 *
«me
);

257 
X509_OBJECT
 *
X509_OBJECT_ªåõve_m©ch
(
STACK_OF
(X509_OBJECTË*
h
,

258 
X509_OBJECT
 *
x
);

259 
X509_OBJECT_up_ªf_cou¡
(
X509_OBJECT
 *
a
);

260 
X509_OBJECT
 *
X509_OBJECT_√w
();

261 
X509_OBJECT_‰ì
(
X509_OBJECT
 *
a
);

262 
X509_LOOKUP_TYPE
 
X509_OBJECT_gë_ty≥
(c⁄° 
X509_OBJECT
 *
a
);

263 
X509
 *
X509_OBJECT_gë0_X509
(c⁄° 
X509_OBJECT
 *
a
);

264 
X509_OBJECT_£t1_X509
(
X509_OBJECT
 *
a
, 
X509
 *
obj
);

265 
X509_CRL
 *
X509_OBJECT_gë0_X509_CRL
(
X509_OBJECT
 *
a
);

266 
X509_OBJECT_£t1_X509_CRL
(
X509_OBJECT
 *
a
, 
X509_CRL
 *
obj
);

267 
X509_STORE
 *
X509_STORE_√w
();

268 
X509_STORE_‰ì
(
X509_STORE
 *
v
);

269 
X509_STORE_lock
(
X509_STORE
 *
˘x
);

270 
X509_STORE_u∆ock
(
X509_STORE
 *
˘x
);

271 
X509_STORE_up_ªf
(
X509_STORE
 *
v
);

272 
STACK_OF
(
X509_OBJECT
Ë*
X509_STORE_gë0_obje˘s
(
X509_STORE
 *
v
);

274 
STACK_OF
(
X509
Ë*
X509_STORE_CTX_gë1_˚πs
(
X509_STORE_CTX
 *
°
, 
X509_NAME
 *
nm
);

275 
STACK_OF
(
X509_CRL
Ë*
X509_STORE_CTX_gë1_¸ls
(
X509_STORE_CTX
 *
°
, 
X509_NAME
 *
nm
);

276 
X509_STORE_£t_Êags
(
X509_STORE
 *
˘x
, 
Êags
);

277 
X509_STORE_£t_puΩo£
(
X509_STORE
 *
˘x
, 
puΩo£
);

278 
X509_STORE_£t_åu°
(
X509_STORE
 *
˘x
, 
åu°
);

279 
X509_STORE_£t1_∑øm
(
X509_STORE
 *
˘x
, 
X509_VERIFY_PARAM
 *
pm
);

280 
X509_VERIFY_PARAM
 *
X509_STORE_gë0_∑øm
(
X509_STORE
 *
˘x
);

282 
X509_STORE_£t_vîify
(
X509_STORE
 *
˘x
, 
X509_STORE_CTX_vîify_‚
 
vîify
);

283 
	#X509_STORE_£t_vîify_func
(
˘x
, 
func
) \

284 
	`X509_STORE_£t_vîify
((
˘x
),(
func
))

	)

285 
X509_STORE_CTX_£t_vîify
(
X509_STORE_CTX
 *
˘x
,

286 
X509_STORE_CTX_vîify_‚
 
vîify
);

287 
X509_STORE_CTX_vîify_‚
 
X509_STORE_gë_vîify
(
X509_STORE
 *
˘x
);

288 
X509_STORE_£t_vîify_cb
(
X509_STORE
 *
˘x
,

289 
X509_STORE_CTX_vîify_cb
 
vîify_cb
);

290 
	#X509_STORE_£t_vîify_cb_func
(
˘x
,
func
) \

291 
	`X509_STORE_£t_vîify_cb
((
˘x
),(
func
))

	)

292 
X509_STORE_CTX_vîify_cb
 
X509_STORE_gë_vîify_cb
(
X509_STORE
 *
˘x
);

293 
X509_STORE_£t_gë_issuî
(
X509_STORE
 *
˘x
,

294 
X509_STORE_CTX_gë_issuî_‚
 
gë_issuî
);

295 
X509_STORE_CTX_gë_issuî_‚
 
X509_STORE_gë_gë_issuî
(
X509_STORE
 *
˘x
);

296 
X509_STORE_£t_check_issued
(
X509_STORE
 *
˘x
,

297 
X509_STORE_CTX_check_issued_‚
 
check_issued
);

298 
X509_STORE_CTX_check_issued_‚
 
X509_STORE_gë_check_issued
(
X509_STORE
 *
˘x
);

299 
X509_STORE_£t_check_ªvoˇti⁄
(
X509_STORE
 *
˘x
,

300 
X509_STORE_CTX_check_ªvoˇti⁄_‚
 
check_ªvoˇti⁄
);

301 
X509_STORE_CTX_check_ªvoˇti⁄_‚
 
X509_STORE_gë_check_ªvoˇti⁄
(
X509_STORE
 *
˘x
);

302 
X509_STORE_£t_gë_¸l
(
X509_STORE
 *
˘x
,

303 
X509_STORE_CTX_gë_¸l_‚
 
gë_¸l
);

304 
X509_STORE_CTX_gë_¸l_‚
 
X509_STORE_gë_gë_¸l
(
X509_STORE
 *
˘x
);

305 
X509_STORE_£t_check_¸l
(
X509_STORE
 *
˘x
,

306 
X509_STORE_CTX_check_¸l_‚
 
check_¸l
);

307 
X509_STORE_CTX_check_¸l_‚
 
X509_STORE_gë_check_¸l
(
X509_STORE
 *
˘x
);

308 
X509_STORE_£t_˚π_¸l
(
X509_STORE
 *
˘x
,

309 
X509_STORE_CTX_˚π_¸l_‚
 
˚π_¸l
);

310 
X509_STORE_CTX_˚π_¸l_‚
 
X509_STORE_gë_˚π_¸l
(
X509_STORE
 *
˘x
);

311 
X509_STORE_£t_check_pﬁicy
(
X509_STORE
 *
˘x
,

312 
X509_STORE_CTX_check_pﬁicy_‚
 
check_pﬁicy
);

313 
X509_STORE_CTX_check_pﬁicy_‚
 
X509_STORE_gë_check_pﬁicy
(
X509_STORE
 *
˘x
);

314 
X509_STORE_£t_lookup_˚πs
(
X509_STORE
 *
˘x
,

315 
X509_STORE_CTX_lookup_˚πs_‚
 
lookup_˚πs
);

316 
X509_STORE_CTX_lookup_˚πs_‚
 
X509_STORE_gë_lookup_˚πs
(
X509_STORE
 *
˘x
);

317 
X509_STORE_£t_lookup_¸ls
(
X509_STORE
 *
˘x
,

318 
X509_STORE_CTX_lookup_¸ls_‚
 
lookup_¸ls
);

319 
	#X509_STORE_£t_lookup_¸ls_cb
(
˘x
, 
func
) \

320 
	`X509_STORE_£t_lookup_¸ls
((
˘x
), (
func
))

	)

321 
X509_STORE_CTX_lookup_¸ls_‚
 
X509_STORE_gë_lookup_¸ls
(
X509_STORE
 *
˘x
);

322 
X509_STORE_£t_˛ónup
(
X509_STORE
 *
˘x
,

323 
X509_STORE_CTX_˛ónup_‚
 
˛ónup
);

324 
X509_STORE_CTX_˛ónup_‚
 
X509_STORE_gë_˛ónup
(
X509_STORE
 *
˘x
);

326 
	#X509_STORE_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

327 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_X509_STORE
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

328 
X509_STORE_£t_ex_d©a
(
X509_STORE
 *
˘x
, 
idx
, *
d©a
);

329 *
X509_STORE_gë_ex_d©a
(
X509_STORE
 *
˘x
, 
idx
);

331 
X509_STORE_CTX
 *
X509_STORE_CTX_√w
();

333 
X509_STORE_CTX_gë1_issuî
(
X509
 **
issuî
, 
X509_STORE_CTX
 *
˘x
, X509 *
x
);

335 
X509_STORE_CTX_‰ì
(
X509_STORE_CTX
 *
˘x
);

336 
X509_STORE_CTX_öô
(
X509_STORE_CTX
 *
˘x
, 
X509_STORE
 *
°‹e
,

337 
X509
 *
x509
, 
STACK_OF
(X509Ë*
chaö
);

338 
X509_STORE_CTX_£t0_åu°ed_°ack
(
X509_STORE_CTX
 *
˘x
, 
STACK_OF
(
X509
Ë*
sk
);

339 
X509_STORE_CTX_˛ónup
(
X509_STORE_CTX
 *
˘x
);

341 
X509_STORE
 *
X509_STORE_CTX_gë0_°‹e
(
X509_STORE_CTX
 *
˘x
);

342 
X509
 *
X509_STORE_CTX_gë0_˚π
(
X509_STORE_CTX
 *
˘x
);

343 
STACK_OF
(
X509
)* 
X509_STORE_CTX_gë0_u¡ru°ed
(
X509_STORE_CTX
 *
˘x
);

344 
X509_STORE_CTX_£t0_u¡ru°ed
(
X509_STORE_CTX
 *
˘x
, 
STACK_OF
(
X509
Ë*
sk
);

345 
X509_STORE_CTX_£t_vîify_cb
(
X509_STORE_CTX
 *
˘x
,

346 
X509_STORE_CTX_vîify_cb
 
vîify
);

347 
X509_STORE_CTX_vîify_cb
 
X509_STORE_CTX_gë_vîify_cb
(
X509_STORE_CTX
 *
˘x
);

348 
X509_STORE_CTX_vîify_‚
 
X509_STORE_CTX_gë_vîify
(
X509_STORE_CTX
 *
˘x
);

349 
X509_STORE_CTX_gë_issuî_‚
 
X509_STORE_CTX_gë_gë_issuî
(
X509_STORE_CTX
 *
˘x
);

350 
X509_STORE_CTX_check_issued_‚
 
X509_STORE_CTX_gë_check_issued
(
X509_STORE_CTX
 *
˘x
);

351 
X509_STORE_CTX_check_ªvoˇti⁄_‚
 
X509_STORE_CTX_gë_check_ªvoˇti⁄
(
X509_STORE_CTX
 *
˘x
);

352 
X509_STORE_CTX_gë_¸l_‚
 
X509_STORE_CTX_gë_gë_¸l
(
X509_STORE_CTX
 *
˘x
);

353 
X509_STORE_CTX_check_¸l_‚
 
X509_STORE_CTX_gë_check_¸l
(
X509_STORE_CTX
 *
˘x
);

354 
X509_STORE_CTX_˚π_¸l_‚
 
X509_STORE_CTX_gë_˚π_¸l
(
X509_STORE_CTX
 *
˘x
);

355 
X509_STORE_CTX_check_pﬁicy_‚
 
X509_STORE_CTX_gë_check_pﬁicy
(
X509_STORE_CTX
 *
˘x
);

356 
X509_STORE_CTX_lookup_˚πs_‚
 
X509_STORE_CTX_gë_lookup_˚πs
(
X509_STORE_CTX
 *
˘x
);

357 
X509_STORE_CTX_lookup_¸ls_‚
 
X509_STORE_CTX_gë_lookup_¸ls
(
X509_STORE_CTX
 *
˘x
);

358 
X509_STORE_CTX_˛ónup_‚
 
X509_STORE_CTX_gë_˛ónup
(
X509_STORE_CTX
 *
˘x
);

360 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

361 
	#X509_STORE_CTX_gë_chaö
 
X509_STORE_CTX_gë0_chaö


	)

362 
	#X509_STORE_CTX_£t_chaö
 
X509_STORE_CTX_£t0_u¡ru°ed


	)

363 
	#X509_STORE_CTX_åu°ed_°ack
 
X509_STORE_CTX_£t0_åu°ed_°ack


	)

364 
	#X509_STORE_gë_by_subje˘
 
X509_STORE_CTX_gë_by_subje˘


	)

365 
	#X509_STORE_gë1_˚πs
 
X509_STORE_CTX_gë1_˚πs


	)

366 
	#X509_STORE_gë1_¸ls
 
X509_STORE_CTX_gë1_¸ls


	)

368 
	#X509_STORE_gë1_˚π
 
X509_STORE_CTX_gë1_˚πs


	)

370 
	#X509_STORE_gë1_¸l
 
X509_STORE_CTX_gë1_¸ls


	)

373 
X509_LOOKUP
 *
X509_STORE_add_lookup
(
X509_STORE
 *
v
, 
X509_LOOKUP_METHOD
 *
m
);

374 
X509_LOOKUP_METHOD
 *
X509_LOOKUP_hash_dú
();

375 
X509_LOOKUP_METHOD
 *
X509_LOOKUP_fûe
();

377 (*
X509_LOOKUP_˘æ_‚
)(
	tX509_LOOKUP
 *
	t˘x
, 
	tcmd
, c⁄° *
	t¨gc
,

378 
	t¨gl
, **
	tªt
);

379 (*
X509_LOOKUP_gë_by_subje˘_‚
)(
	tX509_LOOKUP
 *
	t˘x
,

380 
	tX509_LOOKUP_TYPE
 
	tty≥
,

381 
	tX509_NAME
 *
	t«me
,

382 
	tX509_OBJECT
 *
	tªt
);

383 (*
X509_LOOKUP_gë_by_issuî_£rül_‚
)(
	tX509_LOOKUP
 *
	t˘x
,

384 
	tX509_LOOKUP_TYPE
 
	tty≥
,

385 
	tX509_NAME
 *
	t«me
,

386 
	tASN1_INTEGER
 *
	t£rül
,

387 
	tX509_OBJECT
 *
	tªt
);

388 (*
X509_LOOKUP_gë_by_fögî¥öt_‚
)(
	tX509_LOOKUP
 *
	t˘x
,

389 
	tX509_LOOKUP_TYPE
 
	tty≥
,

390 c⁄° * 
	tbyãs
,

391 
	tÀn
,

392 
	tX509_OBJECT
 *
	tªt
);

393 (*
X509_LOOKUP_gë_by_Æüs_‚
)(
	tX509_LOOKUP
 *
	t˘x
,

394 
	tX509_LOOKUP_TYPE
 
	tty≥
,

395 c⁄° *
	t°r
,

396 
	tÀn
,

397 
	tX509_OBJECT
 *
	tªt
);

399 
X509_LOOKUP_METHOD
 *
X509_LOOKUP_mëh_√w
(c⁄° *
«me
);

400 
X509_LOOKUP_mëh_‰ì
(
X509_LOOKUP_METHOD
 *
mëhod
);

402 
X509_LOOKUP_mëh_£t_√w_ôem
(
X509_LOOKUP_METHOD
 *
mëhod
,

403 (*
√w_ôem
Ë(
X509_LOOKUP
 *
˘x
));

404 (*
X509_LOOKUP_mëh_gë_√w_ôem
(c⁄° 
X509_LOOKUP_METHOD
* 
mëhod
))

405 (
X509_LOOKUP
 *
˘x
);

407 
X509_LOOKUP_mëh_£t_‰ì
(
X509_LOOKUP_METHOD
 *
mëhod
,

408 (*
‰ì_‚
Ë(
X509_LOOKUP
 *
˘x
));

409 (*
X509_LOOKUP_mëh_gë_‰ì
(c⁄° 
X509_LOOKUP_METHOD
* 
mëhod
))

410 (
X509_LOOKUP
 *
˘x
);

412 
X509_LOOKUP_mëh_£t_öô
(
X509_LOOKUP_METHOD
 *
mëhod
,

413 (*
öô
Ë(
X509_LOOKUP
 *
˘x
));

414 (*
X509_LOOKUP_mëh_gë_öô
(c⁄° 
X509_LOOKUP_METHOD
* 
mëhod
))

415 (
X509_LOOKUP
 *
˘x
);

417 
X509_LOOKUP_mëh_£t_shutdown
(
X509_LOOKUP_METHOD
 *
mëhod
,

418 (*
shutdown
Ë(
X509_LOOKUP
 *
˘x
));

419 (*
X509_LOOKUP_mëh_gë_shutdown
(c⁄° 
X509_LOOKUP_METHOD
* 
mëhod
))

420 (
X509_LOOKUP
 *
˘x
);

422 
X509_LOOKUP_mëh_£t_˘æ
(
X509_LOOKUP_METHOD
 *
mëhod
,

423 
X509_LOOKUP_˘æ_‚
 
˘æ_‚
);

424 
X509_LOOKUP_˘æ_‚
 
X509_LOOKUP_mëh_gë_˘æ
(c⁄° 
X509_LOOKUP_METHOD
 *
mëhod
);

426 
X509_LOOKUP_mëh_£t_gë_by_subje˘
(
X509_LOOKUP_METHOD
 *
mëhod
,

427 
X509_LOOKUP_gë_by_subje˘_‚
 
‚
);

428 
X509_LOOKUP_gë_by_subje˘_‚
 
X509_LOOKUP_mëh_gë_gë_by_subje˘
(

429 c⁄° 
X509_LOOKUP_METHOD
 *
mëhod
);

431 
X509_LOOKUP_mëh_£t_gë_by_issuî_£rül
(
X509_LOOKUP_METHOD
 *
mëhod
,

432 
X509_LOOKUP_gë_by_issuî_£rül_‚
 
‚
);

433 
X509_LOOKUP_gë_by_issuî_£rül_‚
 
X509_LOOKUP_mëh_gë_gë_by_issuî_£rül
(

434 c⁄° 
X509_LOOKUP_METHOD
 *
mëhod
);

436 
X509_LOOKUP_mëh_£t_gë_by_fögî¥öt
(
X509_LOOKUP_METHOD
 *
mëhod
,

437 
X509_LOOKUP_gë_by_fögî¥öt_‚
 
‚
);

438 
X509_LOOKUP_gë_by_fögî¥öt_‚
 
X509_LOOKUP_mëh_gë_gë_by_fögî¥öt
(

439 c⁄° 
X509_LOOKUP_METHOD
 *
mëhod
);

441 
X509_LOOKUP_mëh_£t_gë_by_Æüs
(
X509_LOOKUP_METHOD
 *
mëhod
,

442 
X509_LOOKUP_gë_by_Æüs_‚
 
‚
);

443 
X509_LOOKUP_gë_by_Æüs_‚
 
X509_LOOKUP_mëh_gë_gë_by_Æüs
(

444 c⁄° 
X509_LOOKUP_METHOD
 *
mëhod
);

447 
X509_STORE_add_˚π
(
X509_STORE
 *
˘x
, 
X509
 *
x
);

448 
X509_STORE_add_¸l
(
X509_STORE
 *
˘x
, 
X509_CRL
 *
x
);

450 
X509_STORE_CTX_gë_by_subje˘
(
X509_STORE_CTX
 *
vs
, 
X509_LOOKUP_TYPE
 
ty≥
,

451 
X509_NAME
 *
«me
, 
X509_OBJECT
 *
ªt
);

452 
X509_OBJECT
 *
X509_STORE_CTX_gë_obj_by_subje˘
(
X509_STORE_CTX
 *
vs
,

453 
X509_LOOKUP_TYPE
 
ty≥
,

454 
X509_NAME
 *
«me
);

456 
X509_LOOKUP_˘æ
(
X509_LOOKUP
 *
˘x
, 
cmd
, c⁄° *
¨gc
,

457 
¨gl
, **
ªt
);

459 
X509_lﬂd_˚π_fûe
(
X509_LOOKUP
 *
˘x
, c⁄° *
fûe
, 
ty≥
);

460 
X509_lﬂd_¸l_fûe
(
X509_LOOKUP
 *
˘x
, c⁄° *
fûe
, 
ty≥
);

461 
X509_lﬂd_˚π_¸l_fûe
(
X509_LOOKUP
 *
˘x
, c⁄° *
fûe
, 
ty≥
);

463 
X509_LOOKUP
 *
X509_LOOKUP_√w
(
X509_LOOKUP_METHOD
 *
mëhod
);

464 
X509_LOOKUP_‰ì
(
X509_LOOKUP
 *
˘x
);

465 
X509_LOOKUP_öô
(
X509_LOOKUP
 *
˘x
);

466 
X509_LOOKUP_by_subje˘
(
X509_LOOKUP
 *
˘x
, 
X509_LOOKUP_TYPE
 
ty≥
,

467 
X509_NAME
 *
«me
, 
X509_OBJECT
 *
ªt
);

468 
X509_LOOKUP_by_issuî_£rül
(
X509_LOOKUP
 *
˘x
, 
X509_LOOKUP_TYPE
 
ty≥
,

469 
X509_NAME
 *
«me
, 
ASN1_INTEGER
 *
£rül
,

470 
X509_OBJECT
 *
ªt
);

471 
X509_LOOKUP_by_fögî¥öt
(
X509_LOOKUP
 *
˘x
, 
X509_LOOKUP_TYPE
 
ty≥
,

472 c⁄° *
byãs
, 
Àn
,

473 
X509_OBJECT
 *
ªt
);

474 
X509_LOOKUP_by_Æüs
(
X509_LOOKUP
 *
˘x
, 
X509_LOOKUP_TYPE
 
ty≥
,

475 c⁄° *
°r
, 
Àn
, 
X509_OBJECT
 *
ªt
);

476 
X509_LOOKUP_£t_mëhod_d©a
(
X509_LOOKUP
 *
˘x
, *
d©a
);

477 *
X509_LOOKUP_gë_mëhod_d©a
(c⁄° 
X509_LOOKUP
 *
˘x
);

478 
X509_STORE
 *
X509_LOOKUP_gë_°‹e
(c⁄° 
X509_LOOKUP
 *
˘x
);

479 
X509_LOOKUP_shutdown
(
X509_LOOKUP
 *
˘x
);

481 
X509_STORE_lﬂd_loˇti⁄s
(
X509_STORE
 *
˘x
,

482 c⁄° *
fûe
, c⁄° *
dú
);

483 
X509_STORE_£t_deÁu…_∑ths
(
X509_STORE
 *
˘x
);

485 
	#X509_STORE_CTX_gë_ex_√w_ödex
(
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
) \

486 
	`CRYPTO_gë_ex_√w_ödex
(
CRYPTO_EX_INDEX_X509_STORE_CTX
, 
l
, 
p
, 
√wf
, 
dupf
, 
‰ìf
)

	)

487 
X509_STORE_CTX_£t_ex_d©a
(
X509_STORE_CTX
 *
˘x
, 
idx
, *
d©a
);

488 *
X509_STORE_CTX_gë_ex_d©a
(
X509_STORE_CTX
 *
˘x
, 
idx
);

489 
X509_STORE_CTX_gë_îr‹
(
X509_STORE_CTX
 *
˘x
);

490 
X509_STORE_CTX_£t_îr‹
(
X509_STORE_CTX
 *
˘x
, 
s
);

491 
X509_STORE_CTX_gë_îr‹_dïth
(
X509_STORE_CTX
 *
˘x
);

492 
X509_STORE_CTX_£t_îr‹_dïth
(
X509_STORE_CTX
 *
˘x
, 
dïth
);

493 
X509
 *
X509_STORE_CTX_gë_cuºít_˚π
(
X509_STORE_CTX
 *
˘x
);

494 
X509_STORE_CTX_£t_cuºít_˚π
(
X509_STORE_CTX
 *
˘x
, 
X509
 *
x
);

495 
X509
 *
X509_STORE_CTX_gë0_cuºít_issuî
(
X509_STORE_CTX
 *
˘x
);

496 
X509_CRL
 *
X509_STORE_CTX_gë0_cuºít_¸l
(
X509_STORE_CTX
 *
˘x
);

497 
X509_STORE_CTX
 *
X509_STORE_CTX_gë0_∑ª¡_˘x
(X509_STORE_CTX *
˘x
);

498 
STACK_OF
(
X509
Ë*
X509_STORE_CTX_gë0_chaö
(
X509_STORE_CTX
 *
˘x
);

499 
STACK_OF
(
X509
Ë*
X509_STORE_CTX_gë1_chaö
(
X509_STORE_CTX
 *
˘x
);

500 
X509_STORE_CTX_£t_˚π
(
X509_STORE_CTX
 *
c
, 
X509
 *
x
);

501 
X509_STORE_CTX_£t0_vîifõd_chaö
(
X509_STORE_CTX
 *
c
, 
STACK_OF
(
X509
Ë*
sk
);

502 
X509_STORE_CTX_£t0_¸ls
(
X509_STORE_CTX
 *
c
, 
STACK_OF
(
X509_CRL
Ë*
sk
);

503 
X509_STORE_CTX_£t_puΩo£
(
X509_STORE_CTX
 *
˘x
, 
puΩo£
);

504 
X509_STORE_CTX_£t_åu°
(
X509_STORE_CTX
 *
˘x
, 
åu°
);

505 
X509_STORE_CTX_puΩo£_öhîô
(
X509_STORE_CTX
 *
˘x
, 
def_puΩo£
,

506 
puΩo£
, 
åu°
);

507 
X509_STORE_CTX_£t_Êags
(
X509_STORE_CTX
 *
˘x
, 
Êags
);

508 
X509_STORE_CTX_£t_time
(
X509_STORE_CTX
 *
˘x
, 
Êags
,

509 
time_t
 
t
);

511 
X509_POLICY_TREE
 *
X509_STORE_CTX_gë0_pﬁicy_åì
(
X509_STORE_CTX
 *
˘x
);

512 
X509_STORE_CTX_gë_ex∂icô_pﬁicy
(
X509_STORE_CTX
 *
˘x
);

513 
X509_STORE_CTX_gë_num_u¡ru°ed
(
X509_STORE_CTX
 *
˘x
);

515 
X509_VERIFY_PARAM
 *
X509_STORE_CTX_gë0_∑øm
(
X509_STORE_CTX
 *
˘x
);

516 
X509_STORE_CTX_£t0_∑øm
(
X509_STORE_CTX
 *
˘x
, 
X509_VERIFY_PARAM
 *
∑øm
);

517 
X509_STORE_CTX_£t_deÁu…
(
X509_STORE_CTX
 *
˘x
, c⁄° *
«me
);

523 
X509_STORE_CTX_£t0_d™e
(
X509_STORE_CTX
 *
˘x
, 
SSL_DANE
 *
d™e
);

524 
	#DANE_FLAG_NO_DANE_EE_NAMECHECKS
 (1L << 0)

	)

528 
X509_VERIFY_PARAM
 *
X509_VERIFY_PARAM_√w
();

529 
X509_VERIFY_PARAM_‰ì
(
X509_VERIFY_PARAM
 *
∑øm
);

530 
X509_VERIFY_PARAM_öhîô
(
X509_VERIFY_PARAM
 *
to
,

531 c⁄° 
X509_VERIFY_PARAM
 *
‰om
);

532 
X509_VERIFY_PARAM_£t1
(
X509_VERIFY_PARAM
 *
to
,

533 c⁄° 
X509_VERIFY_PARAM
 *
‰om
);

534 
X509_VERIFY_PARAM_£t1_«me
(
X509_VERIFY_PARAM
 *
∑øm
, c⁄° *
«me
);

535 
X509_VERIFY_PARAM_£t_Êags
(
X509_VERIFY_PARAM
 *
∑øm
,

536 
Êags
);

537 
X509_VERIFY_PARAM_˛ór_Êags
(
X509_VERIFY_PARAM
 *
∑øm
,

538 
Êags
);

539 
X509_VERIFY_PARAM_gë_Êags
(
X509_VERIFY_PARAM
 *
∑øm
);

540 
X509_VERIFY_PARAM_£t_puΩo£
(
X509_VERIFY_PARAM
 *
∑øm
, 
puΩo£
);

541 
X509_VERIFY_PARAM_£t_åu°
(
X509_VERIFY_PARAM
 *
∑øm
, 
åu°
);

542 
X509_VERIFY_PARAM_£t_dïth
(
X509_VERIFY_PARAM
 *
∑øm
, 
dïth
);

543 
X509_VERIFY_PARAM_£t_auth_Àvñ
(
X509_VERIFY_PARAM
 *
∑øm
, 
auth_Àvñ
);

544 
time_t
 
X509_VERIFY_PARAM_gë_time
(c⁄° 
X509_VERIFY_PARAM
 *
∑øm
);

545 
X509_VERIFY_PARAM_£t_time
(
X509_VERIFY_PARAM
 *
∑øm
, 
time_t
 
t
);

546 
X509_VERIFY_PARAM_add0_pﬁicy
(
X509_VERIFY_PARAM
 *
∑øm
,

547 
ASN1_OBJECT
 *
pﬁicy
);

548 
X509_VERIFY_PARAM_£t1_pﬁicõs
(
X509_VERIFY_PARAM
 *
∑øm
,

549 
STACK_OF
(
ASN1_OBJECT
Ë*
pﬁicõs
);

551 
X509_VERIFY_PARAM_£t_öh_Êags
(
X509_VERIFY_PARAM
 *
∑øm
,

552 
uöt32_t
 
Êags
);

553 
uöt32_t
 
X509_VERIFY_PARAM_gë_öh_Êags
(c⁄° 
X509_VERIFY_PARAM
 *
∑øm
);

555 
X509_VERIFY_PARAM_£t1_ho°
(
X509_VERIFY_PARAM
 *
∑øm
,

556 c⁄° *
«me
, 
size_t
 
«mñí
);

557 
X509_VERIFY_PARAM_add1_ho°
(
X509_VERIFY_PARAM
 *
∑øm
,

558 c⁄° *
«me
, 
size_t
 
«mñí
);

559 
X509_VERIFY_PARAM_£t_ho°Êags
(
X509_VERIFY_PARAM
 *
∑øm
,

560 
Êags
);

561 
X509_VERIFY_PARAM_gë_ho°Êags
(c⁄° 
X509_VERIFY_PARAM
 *
∑øm
);

562 *
X509_VERIFY_PARAM_gë0_≥î«me
(
X509_VERIFY_PARAM
 *);

563 
X509_VERIFY_PARAM_move_≥î«me
(
X509_VERIFY_PARAM
 *, X509_VERIFY_PARAM *);

564 
X509_VERIFY_PARAM_£t1_emaû
(
X509_VERIFY_PARAM
 *
∑øm
,

565 c⁄° *
emaû
, 
size_t
 
emaûÀn
);

566 
X509_VERIFY_PARAM_£t1_ù
(
X509_VERIFY_PARAM
 *
∑øm
,

567 c⁄° *
ù
, 
size_t
 
ùÀn
);

568 
X509_VERIFY_PARAM_£t1_ù_asc
(
X509_VERIFY_PARAM
 *
∑øm
,

569 c⁄° *
ùasc
);

571 
X509_VERIFY_PARAM_gë_dïth
(c⁄° 
X509_VERIFY_PARAM
 *
∑øm
);

572 
X509_VERIFY_PARAM_gë_auth_Àvñ
(c⁄° 
X509_VERIFY_PARAM
 *
∑øm
);

573 c⁄° *
X509_VERIFY_PARAM_gë0_«me
(c⁄° 
X509_VERIFY_PARAM
 *
∑øm
);

575 
X509_VERIFY_PARAM_add0_èbÀ
(
X509_VERIFY_PARAM
 *
∑øm
);

576 
X509_VERIFY_PARAM_gë_cou¡
();

577 c⁄° 
X509_VERIFY_PARAM
 *
X509_VERIFY_PARAM_gë0
(
id
);

578 c⁄° 
X509_VERIFY_PARAM
 *
X509_VERIFY_PARAM_lookup
(c⁄° *
«me
);

579 
X509_VERIFY_PARAM_èbÀ_˛ónup
();

582 
	#X509_PCY_TREE_FAILURE
 -2

	)

583 
	#X509_PCY_TREE_INVALID
 -1

	)

584 
	#X509_PCY_TREE_INTERNAL
 0

	)

590 
	#X509_PCY_TREE_VALID
 1

	)

591 
	#X509_PCY_TREE_EMPTY
 2

	)

592 
	#X509_PCY_TREE_EXPLICIT
 4

	)

594 
X509_pﬁicy_check
(
X509_POLICY_TREE
 **
±ªe
, *
≥x∂icô_pﬁicy
,

595 
STACK_OF
(
X509
Ë*
˚πs
,

596 
STACK_OF
(
ASN1_OBJECT
Ë*
pﬁicy_oids
, 
Êags
);

598 
X509_pﬁicy_åì_‰ì
(
X509_POLICY_TREE
 *
åì
);

600 
X509_pﬁicy_åì_Àvñ_cou¡
(c⁄° 
X509_POLICY_TREE
 *
åì
);

601 
X509_POLICY_LEVEL
 *
X509_pﬁicy_åì_gë0_Àvñ
(c⁄° 
X509_POLICY_TREE
 *
åì
,

602 
i
);

604 
STACK_OF
(
X509_POLICY_NODE
Ë*
X509_pﬁicy_åì_gë0_pﬁicõs
(const

605 
X509_POLICY_TREE


606 *
åì
);

608 
STACK_OF
(
X509_POLICY_NODE
Ë*
X509_pﬁicy_åì_gë0_u£r_pﬁicõs
(const

609 
X509_POLICY_TREE


610 *
åì
);

612 
X509_pﬁicy_Àvñ_node_cou¡
(
X509_POLICY_LEVEL
 *
Àvñ
);

614 
X509_POLICY_NODE
 *
X509_pﬁicy_Àvñ_gë0_node
(
X509_POLICY_LEVEL
 *
Àvñ
,

615 
i
);

617 c⁄° 
ASN1_OBJECT
 *
X509_pﬁicy_node_gë0_pﬁicy
(c⁄° 
X509_POLICY_NODE
 *
node
);

619 
STACK_OF
(
POLICYQUALINFO
Ë*
X509_pﬁicy_node_gë0_quÆifõrs
(const

620 
X509_POLICY_NODE


621 *
node
);

622 c⁄° 
X509_POLICY_NODE
 *
X509_pﬁicy_node_gë0_∑ª¡
(const X509_POLICY_NODE

623 *
node
);

625 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/x509err.h

11 #i‚de‡
HEADER_X509ERR_H


12 
	#HEADER_X509ERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_X509_°rögs
();

26 
	#X509_F_ADD_CERT_DIR
 100

	)

27 
	#X509_F_BUILD_CHAIN
 106

	)

28 
	#X509_F_BY_FILE_CTRL
 101

	)

29 
	#X509_F_CHECK_NAME_CONSTRAINTS
 149

	)

30 
	#X509_F_CHECK_POLICY
 145

	)

31 
	#X509_F_DANE_I2D
 107

	)

32 
	#X509_F_DIR_CTRL
 102

	)

33 
	#X509_F_GET_CERT_BY_SUBJECT
 103

	)

34 
	#X509_F_I2D_X509_AUX
 151

	)

35 
	#X509_F_LOOKUP_CERTS_SK
 152

	)

36 
	#X509_F_NETSCAPE_SPKI_B64_DECODE
 129

	)

37 
	#X509_F_NETSCAPE_SPKI_B64_ENCODE
 130

	)

38 
	#X509_F_NEW_DIR
 153

	)

39 
	#X509_F_X509AT_ADD1_ATTR
 135

	)

40 
	#X509_F_X509V3_ADD_EXT
 104

	)

41 
	#X509_F_X509_ATTRIBUTE_CREATE_BY_NID
 136

	)

42 
	#X509_F_X509_ATTRIBUTE_CREATE_BY_OBJ
 137

	)

43 
	#X509_F_X509_ATTRIBUTE_CREATE_BY_TXT
 140

	)

44 
	#X509_F_X509_ATTRIBUTE_GET0_DATA
 139

	)

45 
	#X509_F_X509_ATTRIBUTE_SET1_DATA
 138

	)

46 
	#X509_F_X509_CHECK_PRIVATE_KEY
 128

	)

47 
	#X509_F_X509_CRL_DIFF
 105

	)

48 
	#X509_F_X509_CRL_METHOD_NEW
 154

	)

49 
	#X509_F_X509_CRL_PRINT_FP
 147

	)

50 
	#X509_F_X509_EXTENSION_CREATE_BY_NID
 108

	)

51 
	#X509_F_X509_EXTENSION_CREATE_BY_OBJ
 109

	)

52 
	#X509_F_X509_GET_PUBKEY_PARAMETERS
 110

	)

53 
	#X509_F_X509_LOAD_CERT_CRL_FILE
 132

	)

54 
	#X509_F_X509_LOAD_CERT_FILE
 111

	)

55 
	#X509_F_X509_LOAD_CRL_FILE
 112

	)

56 
	#X509_F_X509_LOOKUP_METH_NEW
 160

	)

57 
	#X509_F_X509_LOOKUP_NEW
 155

	)

58 
	#X509_F_X509_NAME_ADD_ENTRY
 113

	)

59 
	#X509_F_X509_NAME_CANON
 156

	)

60 
	#X509_F_X509_NAME_ENTRY_CREATE_BY_NID
 114

	)

61 
	#X509_F_X509_NAME_ENTRY_CREATE_BY_TXT
 131

	)

62 
	#X509_F_X509_NAME_ENTRY_SET_OBJECT
 115

	)

63 
	#X509_F_X509_NAME_ONELINE
 116

	)

64 
	#X509_F_X509_NAME_PRINT
 117

	)

65 
	#X509_F_X509_OBJECT_NEW
 150

	)

66 
	#X509_F_X509_PRINT_EX_FP
 118

	)

67 
	#X509_F_X509_PUBKEY_DECODE
 148

	)

68 
	#X509_F_X509_PUBKEY_GET0
 119

	)

69 
	#X509_F_X509_PUBKEY_SET
 120

	)

70 
	#X509_F_X509_REQ_CHECK_PRIVATE_KEY
 144

	)

71 
	#X509_F_X509_REQ_PRINT_EX
 121

	)

72 
	#X509_F_X509_REQ_PRINT_FP
 122

	)

73 
	#X509_F_X509_REQ_TO_X509
 123

	)

74 
	#X509_F_X509_STORE_ADD_CERT
 124

	)

75 
	#X509_F_X509_STORE_ADD_CRL
 125

	)

76 
	#X509_F_X509_STORE_ADD_LOOKUP
 157

	)

77 
	#X509_F_X509_STORE_CTX_GET1_ISSUER
 146

	)

78 
	#X509_F_X509_STORE_CTX_INIT
 143

	)

79 
	#X509_F_X509_STORE_CTX_NEW
 142

	)

80 
	#X509_F_X509_STORE_CTX_PURPOSE_INHERIT
 134

	)

81 
	#X509_F_X509_STORE_NEW
 158

	)

82 
	#X509_F_X509_TO_X509_REQ
 126

	)

83 
	#X509_F_X509_TRUST_ADD
 133

	)

84 
	#X509_F_X509_TRUST_SET
 141

	)

85 
	#X509_F_X509_VERIFY_CERT
 127

	)

86 
	#X509_F_X509_VERIFY_PARAM_NEW
 159

	)

91 
	#X509_R_AKID_MISMATCH
 110

	)

92 
	#X509_R_BAD_SELECTOR
 133

	)

93 
	#X509_R_BAD_X509_FILETYPE
 100

	)

94 
	#X509_R_BASE64_DECODE_ERROR
 118

	)

95 
	#X509_R_CANT_CHECK_DH_KEY
 114

	)

96 
	#X509_R_CERT_ALREADY_IN_HASH_TABLE
 101

	)

97 
	#X509_R_CRL_ALREADY_DELTA
 127

	)

98 
	#X509_R_CRL_VERIFY_FAILURE
 131

	)

99 
	#X509_R_IDP_MISMATCH
 128

	)

100 
	#X509_R_INVALID_ATTRIBUTES
 138

	)

101 
	#X509_R_INVALID_DIRECTORY
 113

	)

102 
	#X509_R_INVALID_FIELD_NAME
 119

	)

103 
	#X509_R_INVALID_TRUST
 123

	)

104 
	#X509_R_ISSUER_MISMATCH
 129

	)

105 
	#X509_R_KEY_TYPE_MISMATCH
 115

	)

106 
	#X509_R_KEY_VALUES_MISMATCH
 116

	)

107 
	#X509_R_LOADING_CERT_DIR
 103

	)

108 
	#X509_R_LOADING_DEFAULTS
 104

	)

109 
	#X509_R_METHOD_NOT_SUPPORTED
 124

	)

110 
	#X509_R_NAME_TOO_LONG
 134

	)

111 
	#X509_R_NEWER_CRL_NOT_NEWER
 132

	)

112 
	#X509_R_NO_CERTIFICATE_FOUND
 135

	)

113 
	#X509_R_NO_CERTIFICATE_OR_CRL_FOUND
 136

	)

114 
	#X509_R_NO_CERT_SET_FOR_US_TO_VERIFY
 105

	)

115 
	#X509_R_NO_CRL_FOUND
 137

	)

116 
	#X509_R_NO_CRL_NUMBER
 130

	)

117 
	#X509_R_PUBLIC_KEY_DECODE_ERROR
 125

	)

118 
	#X509_R_PUBLIC_KEY_ENCODE_ERROR
 126

	)

119 
	#X509_R_SHOULD_RETRY
 106

	)

120 
	#X509_R_UNABLE_TO_FIND_PARAMETERS_IN_CHAIN
 107

	)

121 
	#X509_R_UNABLE_TO_GET_CERTS_PUBLIC_KEY
 108

	)

122 
	#X509_R_UNKNOWN_KEY_TYPE
 117

	)

123 
	#X509_R_UNKNOWN_NID
 109

	)

124 
	#X509_R_UNKNOWN_PURPOSE_ID
 121

	)

125 
	#X509_R_UNKNOWN_TRUST_ID
 120

	)

126 
	#X509_R_UNSUPPORTED_ALGORITHM
 111

	)

127 
	#X509_R_WRONG_LOOKUP_TYPE
 112

	)

128 
	#X509_R_WRONG_TYPE
 122

	)

	@/usr/include/openssl/asn1err.h

11 #i‚de‡
HEADER_ASN1ERR_H


12 
	#HEADER_ASN1ERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_ASN1_°rögs
();

26 
	#ASN1_F_A2D_ASN1_OBJECT
 100

	)

27 
	#ASN1_F_A2I_ASN1_INTEGER
 102

	)

28 
	#ASN1_F_A2I_ASN1_STRING
 103

	)

29 
	#ASN1_F_APPEND_EXP
 176

	)

30 
	#ASN1_F_ASN1_BIO_INIT
 113

	)

31 
	#ASN1_F_ASN1_BIT_STRING_SET_BIT
 183

	)

32 
	#ASN1_F_ASN1_CB
 177

	)

33 
	#ASN1_F_ASN1_CHECK_TLEN
 104

	)

34 
	#ASN1_F_ASN1_COLLECT
 106

	)

35 
	#ASN1_F_ASN1_D2I_EX_PRIMITIVE
 108

	)

36 
	#ASN1_F_ASN1_D2I_FP
 109

	)

37 
	#ASN1_F_ASN1_D2I_READ_BIO
 107

	)

38 
	#ASN1_F_ASN1_DIGEST
 184

	)

39 
	#ASN1_F_ASN1_DO_ADB
 110

	)

40 
	#ASN1_F_ASN1_DO_LOCK
 233

	)

41 
	#ASN1_F_ASN1_DUP
 111

	)

42 
	#ASN1_F_ASN1_ENC_SAVE
 115

	)

43 
	#ASN1_F_ASN1_EX_C2I
 204

	)

44 
	#ASN1_F_ASN1_FIND_END
 190

	)

45 
	#ASN1_F_ASN1_GENERALIZEDTIME_ADJ
 216

	)

46 
	#ASN1_F_ASN1_GENERATE_V3
 178

	)

47 
	#ASN1_F_ASN1_GET_INT64
 224

	)

48 
	#ASN1_F_ASN1_GET_OBJECT
 114

	)

49 
	#ASN1_F_ASN1_GET_UINT64
 225

	)

50 
	#ASN1_F_ASN1_I2D_BIO
 116

	)

51 
	#ASN1_F_ASN1_I2D_FP
 117

	)

52 
	#ASN1_F_ASN1_ITEM_D2I_FP
 206

	)

53 
	#ASN1_F_ASN1_ITEM_DUP
 191

	)

54 
	#ASN1_F_ASN1_ITEM_EMBED_D2I
 120

	)

55 
	#ASN1_F_ASN1_ITEM_EMBED_NEW
 121

	)

56 
	#ASN1_F_ASN1_ITEM_FLAGS_I2D
 118

	)

57 
	#ASN1_F_ASN1_ITEM_I2D_BIO
 192

	)

58 
	#ASN1_F_ASN1_ITEM_I2D_FP
 193

	)

59 
	#ASN1_F_ASN1_ITEM_PACK
 198

	)

60 
	#ASN1_F_ASN1_ITEM_SIGN
 195

	)

61 
	#ASN1_F_ASN1_ITEM_SIGN_CTX
 220

	)

62 
	#ASN1_F_ASN1_ITEM_UNPACK
 199

	)

63 
	#ASN1_F_ASN1_ITEM_VERIFY
 197

	)

64 
	#ASN1_F_ASN1_MBSTRING_NCOPY
 122

	)

65 
	#ASN1_F_ASN1_OBJECT_NEW
 123

	)

66 
	#ASN1_F_ASN1_OUTPUT_DATA
 214

	)

67 
	#ASN1_F_ASN1_PCTX_NEW
 205

	)

68 
	#ASN1_F_ASN1_PRIMITIVE_NEW
 119

	)

69 
	#ASN1_F_ASN1_SCTX_NEW
 221

	)

70 
	#ASN1_F_ASN1_SIGN
 128

	)

71 
	#ASN1_F_ASN1_STR2TYPE
 179

	)

72 
	#ASN1_F_ASN1_STRING_GET_INT64
 227

	)

73 
	#ASN1_F_ASN1_STRING_GET_UINT64
 230

	)

74 
	#ASN1_F_ASN1_STRING_SET
 186

	)

75 
	#ASN1_F_ASN1_STRING_TABLE_ADD
 129

	)

76 
	#ASN1_F_ASN1_STRING_TO_BN
 228

	)

77 
	#ASN1_F_ASN1_STRING_TYPE_NEW
 130

	)

78 
	#ASN1_F_ASN1_TEMPLATE_EX_D2I
 132

	)

79 
	#ASN1_F_ASN1_TEMPLATE_NEW
 133

	)

80 
	#ASN1_F_ASN1_TEMPLATE_NOEXP_D2I
 131

	)

81 
	#ASN1_F_ASN1_TIME_ADJ
 217

	)

82 
	#ASN1_F_ASN1_TYPE_GET_INT_OCTETSTRING
 134

	)

83 
	#ASN1_F_ASN1_TYPE_GET_OCTETSTRING
 135

	)

84 
	#ASN1_F_ASN1_UTCTIME_ADJ
 218

	)

85 
	#ASN1_F_ASN1_VERIFY
 137

	)

86 
	#ASN1_F_B64_READ_ASN1
 209

	)

87 
	#ASN1_F_B64_WRITE_ASN1
 210

	)

88 
	#ASN1_F_BIO_NEW_NDEF
 208

	)

89 
	#ASN1_F_BITSTR_CB
 180

	)

90 
	#ASN1_F_BN_TO_ASN1_STRING
 229

	)

91 
	#ASN1_F_C2I_ASN1_BIT_STRING
 189

	)

92 
	#ASN1_F_C2I_ASN1_INTEGER
 194

	)

93 
	#ASN1_F_C2I_ASN1_OBJECT
 196

	)

94 
	#ASN1_F_C2I_IBUF
 226

	)

95 
	#ASN1_F_C2I_UINT64_INT
 101

	)

96 
	#ASN1_F_COLLECT_DATA
 140

	)

97 
	#ASN1_F_D2I_ASN1_OBJECT
 147

	)

98 
	#ASN1_F_D2I_ASN1_UINTEGER
 150

	)

99 
	#ASN1_F_D2I_AUTOPRIVATEKEY
 207

	)

100 
	#ASN1_F_D2I_PRIVATEKEY
 154

	)

101 
	#ASN1_F_D2I_PUBLICKEY
 155

	)

102 
	#ASN1_F_DO_BUF
 142

	)

103 
	#ASN1_F_DO_CREATE
 124

	)

104 
	#ASN1_F_DO_DUMP
 125

	)

105 
	#ASN1_F_DO_TCREATE
 222

	)

106 
	#ASN1_F_I2A_ASN1_OBJECT
 126

	)

107 
	#ASN1_F_I2D_ASN1_BIO_STREAM
 211

	)

108 
	#ASN1_F_I2D_ASN1_OBJECT
 143

	)

109 
	#ASN1_F_I2D_DSA_PUBKEY
 161

	)

110 
	#ASN1_F_I2D_EC_PUBKEY
 181

	)

111 
	#ASN1_F_I2D_PRIVATEKEY
 163

	)

112 
	#ASN1_F_I2D_PUBLICKEY
 164

	)

113 
	#ASN1_F_I2D_RSA_PUBKEY
 165

	)

114 
	#ASN1_F_LONG_C2I
 166

	)

115 
	#ASN1_F_NDEF_PREFIX
 127

	)

116 
	#ASN1_F_NDEF_SUFFIX
 136

	)

117 
	#ASN1_F_OID_MODULE_INIT
 174

	)

118 
	#ASN1_F_PARSE_TAGGING
 182

	)

119 
	#ASN1_F_PKCS5_PBE2_SET_IV
 167

	)

120 
	#ASN1_F_PKCS5_PBE2_SET_SCRYPT
 231

	)

121 
	#ASN1_F_PKCS5_PBE_SET
 202

	)

122 
	#ASN1_F_PKCS5_PBE_SET0_ALGOR
 215

	)

123 
	#ASN1_F_PKCS5_PBKDF2_SET
 219

	)

124 
	#ASN1_F_PKCS5_SCRYPT_SET
 232

	)

125 
	#ASN1_F_SMIME_READ_ASN1
 212

	)

126 
	#ASN1_F_SMIME_TEXT
 213

	)

127 
	#ASN1_F_STABLE_GET
 138

	)

128 
	#ASN1_F_STBL_MODULE_INIT
 223

	)

129 
	#ASN1_F_UINT32_C2I
 105

	)

130 
	#ASN1_F_UINT32_NEW
 139

	)

131 
	#ASN1_F_UINT64_C2I
 112

	)

132 
	#ASN1_F_UINT64_NEW
 141

	)

133 
	#ASN1_F_X509_CRL_ADD0_REVOKED
 169

	)

134 
	#ASN1_F_X509_INFO_NEW
 170

	)

135 
	#ASN1_F_X509_NAME_ENCODE
 203

	)

136 
	#ASN1_F_X509_NAME_EX_D2I
 158

	)

137 
	#ASN1_F_X509_NAME_EX_NEW
 171

	)

138 
	#ASN1_F_X509_PKEY_NEW
 173

	)

143 
	#ASN1_R_ADDING_OBJECT
 171

	)

144 
	#ASN1_R_ASN1_PARSE_ERROR
 203

	)

145 
	#ASN1_R_ASN1_SIG_PARSE_ERROR
 204

	)

146 
	#ASN1_R_AUX_ERROR
 100

	)

147 
	#ASN1_R_BAD_OBJECT_HEADER
 102

	)

148 
	#ASN1_R_BMPSTRING_IS_WRONG_LENGTH
 214

	)

149 
	#ASN1_R_BN_LIB
 105

	)

150 
	#ASN1_R_BOOLEAN_IS_WRONG_LENGTH
 106

	)

151 
	#ASN1_R_BUFFER_TOO_SMALL
 107

	)

152 
	#ASN1_R_CIPHER_HAS_NO_OBJECT_IDENTIFIER
 108

	)

153 
	#ASN1_R_CONTEXT_NOT_INITIALISED
 217

	)

154 
	#ASN1_R_DATA_IS_WRONG
 109

	)

155 
	#ASN1_R_DECODE_ERROR
 110

	)

156 
	#ASN1_R_DEPTH_EXCEEDED
 174

	)

157 
	#ASN1_R_DIGEST_AND_KEY_TYPE_NOT_SUPPORTED
 198

	)

158 
	#ASN1_R_ENCODE_ERROR
 112

	)

159 
	#ASN1_R_ERROR_GETTING_TIME
 173

	)

160 
	#ASN1_R_ERROR_LOADING_SECTION
 172

	)

161 
	#ASN1_R_ERROR_SETTING_CIPHER_PARAMS
 114

	)

162 
	#ASN1_R_EXPECTING_AN_INTEGER
 115

	)

163 
	#ASN1_R_EXPECTING_AN_OBJECT
 116

	)

164 
	#ASN1_R_EXPLICIT_LENGTH_MISMATCH
 119

	)

165 
	#ASN1_R_EXPLICIT_TAG_NOT_CONSTRUCTED
 120

	)

166 
	#ASN1_R_FIELD_MISSING
 121

	)

167 
	#ASN1_R_FIRST_NUM_TOO_LARGE
 122

	)

168 
	#ASN1_R_HEADER_TOO_LONG
 123

	)

169 
	#ASN1_R_ILLEGAL_BITSTRING_FORMAT
 175

	)

170 
	#ASN1_R_ILLEGAL_BOOLEAN
 176

	)

171 
	#ASN1_R_ILLEGAL_CHARACTERS
 124

	)

172 
	#ASN1_R_ILLEGAL_FORMAT
 177

	)

173 
	#ASN1_R_ILLEGAL_HEX
 178

	)

174 
	#ASN1_R_ILLEGAL_IMPLICIT_TAG
 179

	)

175 
	#ASN1_R_ILLEGAL_INTEGER
 180

	)

176 
	#ASN1_R_ILLEGAL_NEGATIVE_VALUE
 226

	)

177 
	#ASN1_R_ILLEGAL_NESTED_TAGGING
 181

	)

178 
	#ASN1_R_ILLEGAL_NULL
 125

	)

179 
	#ASN1_R_ILLEGAL_NULL_VALUE
 182

	)

180 
	#ASN1_R_ILLEGAL_OBJECT
 183

	)

181 
	#ASN1_R_ILLEGAL_OPTIONAL_ANY
 126

	)

182 
	#ASN1_R_ILLEGAL_OPTIONS_ON_ITEM_TEMPLATE
 170

	)

183 
	#ASN1_R_ILLEGAL_PADDING
 221

	)

184 
	#ASN1_R_ILLEGAL_TAGGED_ANY
 127

	)

185 
	#ASN1_R_ILLEGAL_TIME_VALUE
 184

	)

186 
	#ASN1_R_ILLEGAL_ZERO_CONTENT
 222

	)

187 
	#ASN1_R_INTEGER_NOT_ASCII_FORMAT
 185

	)

188 
	#ASN1_R_INTEGER_TOO_LARGE_FOR_LONG
 128

	)

189 
	#ASN1_R_INVALID_BIT_STRING_BITS_LEFT
 220

	)

190 
	#ASN1_R_INVALID_BMPSTRING_LENGTH
 129

	)

191 
	#ASN1_R_INVALID_DIGIT
 130

	)

192 
	#ASN1_R_INVALID_MIME_TYPE
 205

	)

193 
	#ASN1_R_INVALID_MODIFIER
 186

	)

194 
	#ASN1_R_INVALID_NUMBER
 187

	)

195 
	#ASN1_R_INVALID_OBJECT_ENCODING
 216

	)

196 
	#ASN1_R_INVALID_SCRYPT_PARAMETERS
 227

	)

197 
	#ASN1_R_INVALID_SEPARATOR
 131

	)

198 
	#ASN1_R_INVALID_STRING_TABLE_VALUE
 218

	)

199 
	#ASN1_R_INVALID_UNIVERSALSTRING_LENGTH
 133

	)

200 
	#ASN1_R_INVALID_UTF8STRING
 134

	)

201 
	#ASN1_R_INVALID_VALUE
 219

	)

202 
	#ASN1_R_LIST_ERROR
 188

	)

203 
	#ASN1_R_MIME_NO_CONTENT_TYPE
 206

	)

204 
	#ASN1_R_MIME_PARSE_ERROR
 207

	)

205 
	#ASN1_R_MIME_SIG_PARSE_ERROR
 208

	)

206 
	#ASN1_R_MISSING_EOC
 137

	)

207 
	#ASN1_R_MISSING_SECOND_NUMBER
 138

	)

208 
	#ASN1_R_MISSING_VALUE
 189

	)

209 
	#ASN1_R_MSTRING_NOT_UNIVERSAL
 139

	)

210 
	#ASN1_R_MSTRING_WRONG_TAG
 140

	)

211 
	#ASN1_R_NESTED_ASN1_STRING
 197

	)

212 
	#ASN1_R_NESTED_TOO_DEEP
 201

	)

213 
	#ASN1_R_NON_HEX_CHARACTERS
 141

	)

214 
	#ASN1_R_NOT_ASCII_FORMAT
 190

	)

215 
	#ASN1_R_NOT_ENOUGH_DATA
 142

	)

216 
	#ASN1_R_NO_CONTENT_TYPE
 209

	)

217 
	#ASN1_R_NO_MATCHING_CHOICE_TYPE
 143

	)

218 
	#ASN1_R_NO_MULTIPART_BODY_FAILURE
 210

	)

219 
	#ASN1_R_NO_MULTIPART_BOUNDARY
 211

	)

220 
	#ASN1_R_NO_SIG_CONTENT_TYPE
 212

	)

221 
	#ASN1_R_NULL_IS_WRONG_LENGTH
 144

	)

222 
	#ASN1_R_OBJECT_NOT_ASCII_FORMAT
 191

	)

223 
	#ASN1_R_ODD_NUMBER_OF_CHARS
 145

	)

224 
	#ASN1_R_SECOND_NUMBER_TOO_LARGE
 147

	)

225 
	#ASN1_R_SEQUENCE_LENGTH_MISMATCH
 148

	)

226 
	#ASN1_R_SEQUENCE_NOT_CONSTRUCTED
 149

	)

227 
	#ASN1_R_SEQUENCE_OR_SET_NEEDS_CONFIG
 192

	)

228 
	#ASN1_R_SHORT_LINE
 150

	)

229 
	#ASN1_R_SIG_INVALID_MIME_TYPE
 213

	)

230 
	#ASN1_R_STREAMING_NOT_SUPPORTED
 202

	)

231 
	#ASN1_R_STRING_TOO_LONG
 151

	)

232 
	#ASN1_R_STRING_TOO_SHORT
 152

	)

233 
	#ASN1_R_THE_ASN1_OBJECT_IDENTIFIER_IS_NOT_KNOWN_FOR_THIS_MD
 154

	)

234 
	#ASN1_R_TIME_NOT_ASCII_FORMAT
 193

	)

235 
	#ASN1_R_TOO_LARGE
 223

	)

236 
	#ASN1_R_TOO_LONG
 155

	)

237 
	#ASN1_R_TOO_SMALL
 224

	)

238 
	#ASN1_R_TYPE_NOT_CONSTRUCTED
 156

	)

239 
	#ASN1_R_TYPE_NOT_PRIMITIVE
 195

	)

240 
	#ASN1_R_UNEXPECTED_EOC
 159

	)

241 
	#ASN1_R_UNIVERSALSTRING_IS_WRONG_LENGTH
 215

	)

242 
	#ASN1_R_UNKNOWN_FORMAT
 160

	)

243 
	#ASN1_R_UNKNOWN_MESSAGE_DIGEST_ALGORITHM
 161

	)

244 
	#ASN1_R_UNKNOWN_OBJECT_TYPE
 162

	)

245 
	#ASN1_R_UNKNOWN_PUBLIC_KEY_TYPE
 163

	)

246 
	#ASN1_R_UNKNOWN_SIGNATURE_ALGORITHM
 199

	)

247 
	#ASN1_R_UNKNOWN_TAG
 194

	)

248 
	#ASN1_R_UNSUPPORTED_ANY_DEFINED_BY_TYPE
 164

	)

249 
	#ASN1_R_UNSUPPORTED_CIPHER
 228

	)

250 
	#ASN1_R_UNSUPPORTED_PUBLIC_KEY_TYPE
 167

	)

251 
	#ASN1_R_UNSUPPORTED_TYPE
 196

	)

252 
	#ASN1_R_WRONG_INTEGER_TYPE
 225

	)

253 
	#ASN1_R_WRONG_PUBLIC_KEY_TYPE
 200

	)

254 
	#ASN1_R_WRONG_TAG
 168

	)

	@/usr/include/openssl/bn.h

11 #i‚de‡
HEADER_BN_H


12 
	#HEADER_BN_H


	)

14 
	~<›ís¶/e_os2.h
>

15 #i‚de‡
OPENSSL_NO_STDIO


16 
	~<°dio.h
>

18 
	~<›ís¶/›ís¶c⁄f.h
>

19 
	~<›ís¶/os¶_typ.h
>

20 
	~<›ís¶/¸y±o.h
>

21 
	~<›ís¶/b√º.h
>

23 #ifde‡ 
__˝lu•lus


30 #ifde‡
SIXTY_FOUR_BIT_LONG


31 
	#BN_ULONG
 

	)

32 
	#BN_BYTES
 8

	)

38 #ifde‡
SIXTY_FOUR_BIT


39 
	#BN_ULONG
 

	)

40 
	#BN_BYTES
 8

	)

43 #ifde‡
THIRTY_TWO_BIT


44 
	#BN_ULONG
 

	)

45 
	#BN_BYTES
 4

	)

48 
	#BN_BITS2
 (
BN_BYTES
 * 8)

	)

49 
	#BN_BITS
 (
BN_BITS2
 * 2)

	)

50 
	#BN_TBIT
 ((
BN_ULONG
)1 << (
BN_BITS2
 - 1))

	)

52 
	#BN_FLG_MALLOCED
 0x01

	)

53 
	#BN_FLG_STATIC_DATA
 0x02

	)

61 
	#BN_FLG_CONSTTIME
 0x04

	)

62 
	#BN_FLG_SECURE
 0x08

	)

64 #i‡
OPENSSL_API_COMPAT
 < 0x00908000L

66 
	#BN_FLG_EXP_CONSTTIME
 
BN_FLG_CONSTTIME


	)

67 
	#BN_FLG_FREE
 0x8000

	)

70 
BN_£t_Êags
(
BIGNUM
 *
b
, 
n
);

71 
BN_gë_Êags
(c⁄° 
BIGNUM
 *
b
, 
n
);

74 
	#BN_RAND_TOP_ANY
 -1

	)

75 
	#BN_RAND_TOP_ONE
 0

	)

76 
	#BN_RAND_TOP_TWO
 1

	)

79 
	#BN_RAND_BOTTOM_ANY
 0

	)

80 
	#BN_RAND_BOTTOM_ODD
 1

	)

88 
BN_wôh_Êags
(
BIGNUM
 *
de°
, c⁄° BIGNUM *
b
, 
Êags
);

91 
BN_GENCB_ˇŒ
(
BN_GENCB
 *
cb
, 
a
, 
b
);

93 
BN_GENCB
 *
BN_GENCB_√w
();

94 
BN_GENCB_‰ì
(
BN_GENCB
 *
cb
);

97 
BN_GENCB_£t_ﬁd
(
BN_GENCB
 *
gícb
, (*
ˇŒback
) (, , *),

98 *
cb_¨g
);

101 
BN_GENCB_£t
(
BN_GENCB
 *
gícb
, (*
ˇŒback
) (, , BN_GENCB *),

102 *
cb_¨g
);

104 *
BN_GENCB_gë_¨g
(
BN_GENCB
 *
cb
);

106 
	#BN_¥ime_checks
 0

	)

172 
	#BN_¥ime_checks_f‹_size
(
b
) ((b) >= 3747 ? 3 : \

173 (
b
) >= 1345 ? 4 : \

174 (
b
) >= 476 ? 5 : \

175 (
b
) >= 400 ? 6 : \

176 (
b
) >= 347 ? 7 : \

177 (
b
) >= 308 ? 8 : \

178 (
b
) >= 55 ? 27 : \

179  34)

	)

181 
	#BN_num_byãs
(
a
Ë((
	`BN_num_bôs
◊)+7)/8)

	)

183 
BN_abs_is_w‹d
(c⁄° 
BIGNUM
 *
a
, c⁄° 
BN_ULONG
 
w
);

184 
BN_is_zîo
(c⁄° 
BIGNUM
 *
a
);

185 
BN_is_⁄e
(c⁄° 
BIGNUM
 *
a
);

186 
BN_is_w‹d
(c⁄° 
BIGNUM
 *
a
, c⁄° 
BN_ULONG
 
w
);

187 
BN_is_odd
(c⁄° 
BIGNUM
 *
a
);

189 
	#BN_⁄e
(
a
Ë(
	`BN_£t_w‹d
(◊),1))

	)

191 
BN_zîo_ex
(
BIGNUM
 *
a
);

193 #i‡
OPENSSL_API_COMPAT
 >= 0x00908000L

194 
	#BN_zîo
(
a
Ë
	`BN_zîo_ex
◊)

	)

196 
	#BN_zîo
(
a
Ë(
	`BN_£t_w‹d
(◊),0))

	)

199 c⁄° 
BIGNUM
 *
BN_vÆue_⁄e
();

200 *
BN_›ti⁄s
();

201 
BN_CTX
 *
BN_CTX_√w
();

202 
BN_CTX
 *
BN_CTX_£cuª_√w
();

203 
BN_CTX_‰ì
(
BN_CTX
 *
c
);

204 
BN_CTX_°¨t
(
BN_CTX
 *
˘x
);

205 
BIGNUM
 *
BN_CTX_gë
(
BN_CTX
 *
˘x
);

206 
BN_CTX_íd
(
BN_CTX
 *
˘x
);

207 
BN_ønd
(
BIGNUM
 *
∫d
, 
bôs
, 
t›
, 
bŸtom
);

208 
BN_¥iv_ønd
(
BIGNUM
 *
∫d
, 
bôs
, 
t›
, 
bŸtom
);

209 
BN_ønd_ønge
(
BIGNUM
 *
∫d
, c⁄° BIGNUM *
ønge
);

210 
BN_¥iv_ønd_ønge
(
BIGNUM
 *
∫d
, c⁄° BIGNUM *
ønge
);

211 
BN_p£udo_ønd
(
BIGNUM
 *
∫d
, 
bôs
, 
t›
, 
bŸtom
);

212 
BN_p£udo_ønd_ønge
(
BIGNUM
 *
∫d
, c⁄° BIGNUM *
ønge
);

213 
BN_num_bôs
(c⁄° 
BIGNUM
 *
a
);

214 
BN_num_bôs_w‹d
(
BN_ULONG
 
l
);

215 
BN_£curôy_bôs
(
L
, 
N
);

216 
BIGNUM
 *
BN_√w
();

217 
BIGNUM
 *
BN_£cuª_√w
();

218 
BN_˛ór_‰ì
(
BIGNUM
 *
a
);

219 
BIGNUM
 *
BN_c›y
(BIGNUM *
a
, c⁄° BIGNUM *
b
);

220 
BN_sw≠
(
BIGNUM
 *
a
, BIGNUM *
b
);

221 
BIGNUM
 *
BN_bö2bn
(c⁄° *
s
, 
Àn
, BIGNUM *
ªt
);

222 
BN_bn2bö
(c⁄° 
BIGNUM
 *
a
, *
to
);

223 
BN_bn2bö∑d
(c⁄° 
BIGNUM
 *
a
, *
to
, 
tﬁí
);

224 
BIGNUM
 *
BN_Àbö2bn
(c⁄° *
s
, 
Àn
, BIGNUM *
ªt
);

225 
BN_bn2Àbö∑d
(c⁄° 
BIGNUM
 *
a
, *
to
, 
tﬁí
);

226 
BIGNUM
 *
BN_mpi2bn
(c⁄° *
s
, 
Àn
, BIGNUM *
ªt
);

227 
BN_bn2mpi
(c⁄° 
BIGNUM
 *
a
, *
to
);

228 
BN_sub
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
);

229 
BN_usub
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
);

230 
BN_uadd
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
);

231 
BN_add
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
);

232 
BN_mul
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
, 
BN_CTX
 *
˘x
);

233 
BN_sqr
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, 
BN_CTX
 *
˘x
);

238 
BN_£t_√g©ive
(
BIGNUM
 *
b
, 
n
);

243 
BN_is_√g©ive
(c⁄° 
BIGNUM
 *
b
);

245 
BN_div
(
BIGNUM
 *
dv
, BIGNUM *
ªm
, c⁄° BIGNUM *
m
, c⁄° BIGNUM *
d
,

246 
BN_CTX
 *
˘x
);

247 
	#BN_mod
(
ªm
,
m
,
d
,
˘x
Ë
	`BN_div
(
NULL
,‘em),(m),(d),(˘x))

	)

248 
BN_¬mod
(
BIGNUM
 *
r
, c⁄° BIGNUM *
m
, c⁄° BIGNUM *
d
, 
BN_CTX
 *
˘x
);

249 
BN_mod_add
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
, c⁄° BIGNUM *
m
,

250 
BN_CTX
 *
˘x
);

251 
BN_mod_add_quick
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
,

252 c⁄° 
BIGNUM
 *
m
);

253 
BN_mod_sub
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
, c⁄° BIGNUM *
m
,

254 
BN_CTX
 *
˘x
);

255 
BN_mod_sub_quick
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
,

256 c⁄° 
BIGNUM
 *
m
);

257 
BN_mod_mul
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
, c⁄° BIGNUM *
m
,

258 
BN_CTX
 *
˘x
);

259 
BN_mod_sqr
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
m
, 
BN_CTX
 *
˘x
);

260 
BN_mod_lshi·1
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
m
, 
BN_CTX
 *
˘x
);

261 
BN_mod_lshi·1_quick
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
m
);

262 
BN_mod_lshi·
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, 
n
, c⁄° BIGNUM *
m
,

263 
BN_CTX
 *
˘x
);

264 
BN_mod_lshi·_quick
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, 
n
, c⁄° BIGNUM *
m
);

266 
BN_ULONG
 
BN_mod_w‹d
(c⁄° 
BIGNUM
 *
a
, BN_ULONG 
w
);

267 
BN_ULONG
 
BN_div_w‹d
(
BIGNUM
 *
a
, BN_ULONG 
w
);

268 
BN_mul_w‹d
(
BIGNUM
 *
a
, 
BN_ULONG
 
w
);

269 
BN_add_w‹d
(
BIGNUM
 *
a
, 
BN_ULONG
 
w
);

270 
BN_sub_w‹d
(
BIGNUM
 *
a
, 
BN_ULONG
 
w
);

271 
BN_£t_w‹d
(
BIGNUM
 *
a
, 
BN_ULONG
 
w
);

272 
BN_ULONG
 
BN_gë_w‹d
(c⁄° 
BIGNUM
 *
a
);

274 
BN_cmp
(c⁄° 
BIGNUM
 *
a
, c⁄° BIGNUM *
b
);

275 
BN_‰ì
(
BIGNUM
 *
a
);

276 
BN_is_bô_£t
(c⁄° 
BIGNUM
 *
a
, 
n
);

277 
BN_lshi·
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, 
n
);

278 
BN_lshi·1
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
);

279 
BN_exp
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
, 
BN_CTX
 *
˘x
);

281 
BN_mod_exp
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
,

282 c⁄° 
BIGNUM
 *
m
, 
BN_CTX
 *
˘x
);

283 
BN_mod_exp_m⁄t
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
,

284 c⁄° 
BIGNUM
 *
m
, 
BN_CTX
 *
˘x
, 
BN_MONT_CTX
 *
m_˘x
);

285 
BN_mod_exp_m⁄t_c⁄°time
(
BIGNUM
 *
º
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
,

286 c⁄° 
BIGNUM
 *
m
, 
BN_CTX
 *
˘x
,

287 
BN_MONT_CTX
 *
ö_m⁄t
);

288 
BN_mod_exp_m⁄t_w‹d
(
BIGNUM
 *
r
, 
BN_ULONG
 
a
, c⁄° BIGNUM *
p
,

289 c⁄° 
BIGNUM
 *
m
, 
BN_CTX
 *
˘x
, 
BN_MONT_CTX
 *
m_˘x
);

290 
BN_mod_exp2_m⁄t
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a1
, c⁄° BIGNUM *
p1
,

291 c⁄° 
BIGNUM
 *
a2
, c⁄° BIGNUM *
p2
, c⁄° BIGNUM *
m
,

292 
BN_CTX
 *
˘x
, 
BN_MONT_CTX
 *
m_˘x
);

293 
BN_mod_exp_sim∂e
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
,

294 c⁄° 
BIGNUM
 *
m
, 
BN_CTX
 *
˘x
);

296 
BN_mask_bôs
(
BIGNUM
 *
a
, 
n
);

297 #i‚de‡
OPENSSL_NO_STDIO


298 
BN_¥öt_Â
(
FILE
 *
Â
, c⁄° 
BIGNUM
 *
a
);

300 
BN_¥öt
(
BIO
 *
bio
, c⁄° 
BIGNUM
 *
a
);

301 
BN_ªcùroˇl
(
BIGNUM
 *
r
, c⁄° BIGNUM *
m
, 
Àn
, 
BN_CTX
 *
˘x
);

302 
BN_rshi·
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, 
n
);

303 
BN_rshi·1
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
);

304 
BN_˛ór
(
BIGNUM
 *
a
);

305 
BIGNUM
 *
BN_dup
(c⁄° BIGNUM *
a
);

306 
BN_ucmp
(c⁄° 
BIGNUM
 *
a
, c⁄° BIGNUM *
b
);

307 
BN_£t_bô
(
BIGNUM
 *
a
, 
n
);

308 
BN_˛ór_bô
(
BIGNUM
 *
a
, 
n
);

309 *
BN_bn2hex
(c⁄° 
BIGNUM
 *
a
);

310 *
BN_bn2dec
(c⁄° 
BIGNUM
 *
a
);

311 
BN_hex2bn
(
BIGNUM
 **
a
, c⁄° *
°r
);

312 
BN_dec2bn
(
BIGNUM
 **
a
, c⁄° *
°r
);

313 
BN_asc2bn
(
BIGNUM
 **
a
, c⁄° *
°r
);

314 
BN_gcd
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
, 
BN_CTX
 *
˘x
);

315 
BN_kr⁄eckî
(c⁄° 
BIGNUM
 *
a
, c⁄° BIGNUM *
b
, 
BN_CTX
 *
˘x
);

318 
BIGNUM
 *
BN_mod_övî£
(BIGNUM *
ªt
,

319 c⁄° 
BIGNUM
 *
a
, c⁄° BIGNUM *
n
, 
BN_CTX
 *
˘x
);

320 
BIGNUM
 *
BN_mod_sqπ
(BIGNUM *
ªt
,

321 c⁄° 
BIGNUM
 *
a
, c⁄° BIGNUM *
n
, 
BN_CTX
 *
˘x
);

323 
BN_c⁄°time_sw≠
(
BN_ULONG
 
sw≠
, 
BIGNUM
 *
a
, BIGNUM *
b
, 
nw‹ds
);

326 
DEPRECATEDIN_0_9_8
(
BIGNUM
 *
BN_gíî©e_¥ime
(BIGNUM *
ªt
, 
bôs
, 
ß„
,

327 c⁄° 
BIGNUM
 *
add
,

328 c⁄° 
BIGNUM
 *
ªm
,

329 (*
ˇŒback
) (, ,

331 *
cb_¨g
))

332 
DEPRECATEDIN_0_9_8
(

333 
BN_is_¥ime
(c⁄° 
BIGNUM
 *
p
, 
nchecks
,

334 (*
ˇŒback
) (, , *),

335 
BN_CTX
 *
˘x
, *
cb_¨g
))

336 
DEPRECATEDIN_0_9_8
(

337 
BN_is_¥ime_Á°ã°
(c⁄° 
BIGNUM
 *
p
, 
nchecks
,

338 (*
ˇŒback
) (, , *),

339 
BN_CTX
 *
˘x
, *
cb_¨g
,

340 
do_åül_divisi⁄
))

343 
BN_gíî©e_¥ime_ex
(
BIGNUM
 *
ªt
, 
bôs
, 
ß„
, c⁄° BIGNUM *
add
,

344 c⁄° 
BIGNUM
 *
ªm
, 
BN_GENCB
 *
cb
);

345 
BN_is_¥ime_ex
(c⁄° 
BIGNUM
 *
p
, 
nchecks
, 
BN_CTX
 *
˘x
, 
BN_GENCB
 *
cb
);

346 
BN_is_¥ime_Á°ã°_ex
(c⁄° 
BIGNUM
 *
p
, 
nchecks
, 
BN_CTX
 *
˘x
,

347 
do_åül_divisi⁄
, 
BN_GENCB
 *
cb
);

349 
BN_X931_gíî©e_Xpq
(
BIGNUM
 *
Xp
, BIGNUM *
Xq
, 
nbôs
, 
BN_CTX
 *
˘x
);

351 
BN_X931_dîive_¥ime_ex
(
BIGNUM
 *
p
, BIGNUM *
p1
, BIGNUM *
p2
,

352 c⁄° 
BIGNUM
 *
Xp
, c⁄° BIGNUM *
Xp1
,

353 c⁄° 
BIGNUM
 *
Xp2
, c⁄° BIGNUM *
e
, 
BN_CTX
 *
˘x
,

354 
BN_GENCB
 *
cb
);

355 
BN_X931_gíî©e_¥ime_ex
(
BIGNUM
 *
p
, BIGNUM *
p1
, BIGNUM *
p2
, BIGNUM *
Xp1
,

356 
BIGNUM
 *
Xp2
, c⁄° BIGNUM *
Xp
, c⁄° BIGNUM *
e
,

357 
BN_CTX
 *
˘x
, 
BN_GENCB
 *
cb
);

359 
BN_MONT_CTX
 *
BN_MONT_CTX_√w
();

360 
BN_mod_mul_m⁄tgomîy
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
,

361 
BN_MONT_CTX
 *
m⁄t
, 
BN_CTX
 *
˘x
);

362 
BN_to_m⁄tgomîy
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, 
BN_MONT_CTX
 *
m⁄t
,

363 
BN_CTX
 *
˘x
);

364 
BN_‰om_m⁄tgomîy
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, 
BN_MONT_CTX
 *
m⁄t
,

365 
BN_CTX
 *
˘x
);

366 
BN_MONT_CTX_‰ì
(
BN_MONT_CTX
 *
m⁄t
);

367 
BN_MONT_CTX_£t
(
BN_MONT_CTX
 *
m⁄t
, c⁄° 
BIGNUM
 *
mod
, 
BN_CTX
 *
˘x
);

368 
BN_MONT_CTX
 *
BN_MONT_CTX_c›y
(BN_MONT_CTX *
to
, BN_MONT_CTX *
‰om
);

369 
BN_MONT_CTX
 *
BN_MONT_CTX_£t_locked
(BN_MONT_CTX **
pm⁄t
, 
CRYPTO_RWLOCK
 *
lock
,

370 c⁄° 
BIGNUM
 *
mod
, 
BN_CTX
 *
˘x
);

373 
	#BN_BLINDING_NO_UPDATE
 0x00000001

	)

374 
	#BN_BLINDING_NO_RECREATE
 0x00000002

	)

376 
BN_BLINDING
 *
BN_BLINDING_√w
(c⁄° 
BIGNUM
 *
A
, c⁄° BIGNUM *
Ai
, BIGNUM *
mod
);

377 
BN_BLINDING_‰ì
(
BN_BLINDING
 *
b
);

378 
BN_BLINDING_upd©e
(
BN_BLINDING
 *
b
, 
BN_CTX
 *
˘x
);

379 
BN_BLINDING_c⁄vît
(
BIGNUM
 *
n
, 
BN_BLINDING
 *
b
, 
BN_CTX
 *
˘x
);

380 
BN_BLINDING_övît
(
BIGNUM
 *
n
, 
BN_BLINDING
 *
b
, 
BN_CTX
 *
˘x
);

381 
BN_BLINDING_c⁄vît_ex
(
BIGNUM
 *
n
, BIGNUM *
r
, 
BN_BLINDING
 *
b
, 
BN_CTX
 *);

382 
BN_BLINDING_övît_ex
(
BIGNUM
 *
n
, c⁄° BIGNUM *
r
, 
BN_BLINDING
 *
b
,

383 
BN_CTX
 *);

385 
BN_BLINDING_is_cuºít_thªad
(
BN_BLINDING
 *
b
);

386 
BN_BLINDING_£t_cuºít_thªad
(
BN_BLINDING
 *
b
);

387 
BN_BLINDING_lock
(
BN_BLINDING
 *
b
);

388 
BN_BLINDING_u∆ock
(
BN_BLINDING
 *
b
);

390 
BN_BLINDING_gë_Êags
(c⁄° 
BN_BLINDING
 *);

391 
BN_BLINDING_£t_Êags
(
BN_BLINDING
 *, );

392 
BN_BLINDING
 *
BN_BLINDING_¸óã_∑øm
(BN_BLINDING *
b
,

393 c⁄° 
BIGNUM
 *
e
, BIGNUM *
m
, 
BN_CTX
 *
˘x
,

394 (*
bn_mod_exp
Ë(
BIGNUM
 *
r
,

395 c⁄° 
BIGNUM
 *
a
,

396 c⁄° 
BIGNUM
 *
p
,

397 c⁄° 
BIGNUM
 *
m
,

398 
BN_CTX
 *
˘x
,

399 
BN_MONT_CTX
 *
m_˘x
),

400 
BN_MONT_CTX
 *
m_˘x
);

402 
DEPRECATEDIN_0_9_8
(
BN_£t_∑øms
(
mul
, 
high
, 
low
, 
m⁄t
))

403 
DEPRECATEDIN_0_9_8
(
BN_gë_∑øms
(
which
))

406 
BN_RECP_CTX
 *
BN_RECP_CTX_√w
();

407 
BN_RECP_CTX_‰ì
(
BN_RECP_CTX
 *
ª˝
);

408 
BN_RECP_CTX_£t
(
BN_RECP_CTX
 *
ª˝
, c⁄° 
BIGNUM
 *
rdiv
, 
BN_CTX
 *
˘x
);

409 
BN_mod_mul_ªcùroˇl
(
BIGNUM
 *
r
, c⁄° BIGNUM *
x
, c⁄° BIGNUM *
y
,

410 
BN_RECP_CTX
 *
ª˝
, 
BN_CTX
 *
˘x
);

411 
BN_mod_exp_ª˝
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
,

412 c⁄° 
BIGNUM
 *
m
, 
BN_CTX
 *
˘x
);

413 
BN_div_ª˝
(
BIGNUM
 *
dv
, BIGNUM *
ªm
, c⁄° BIGNUM *
m
,

414 
BN_RECP_CTX
 *
ª˝
, 
BN_CTX
 *
˘x
);

416 #i‚de‡
OPENSSL_NO_EC2M


428 
BN_GF2m_add
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
);

429 
	#BN_GF2m_sub
(
r
, 
a
, 
b
Ë
	`BN_GF2m_add
‘,á, b)

	)

433 
BN_GF2m_mod
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
);

435 
BN_GF2m_mod_mul
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
,

436 c⁄° 
BIGNUM
 *
p
, 
BN_CTX
 *
˘x
);

438 
BN_GF2m_mod_sqr
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
, 
BN_CTX
 *
˘x
);

440 
BN_GF2m_mod_öv
(
BIGNUM
 *
r
, c⁄° BIGNUM *
b
, c⁄° BIGNUM *
p
, 
BN_CTX
 *
˘x
);

442 
BN_GF2m_mod_div
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
,

443 c⁄° 
BIGNUM
 *
p
, 
BN_CTX
 *
˘x
);

445 
BN_GF2m_mod_exp
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
,

446 c⁄° 
BIGNUM
 *
p
, 
BN_CTX
 *
˘x
);

448 
BN_GF2m_mod_sqπ
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
,

449 
BN_CTX
 *
˘x
);

451 
BN_GF2m_mod_sﬁve_quad
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
,

452 
BN_CTX
 *
˘x
);

453 
	#BN_GF2m_cmp
(
a
, 
b
Ë
	`BN_ucmp
(◊), (b))

	)

461 
BN_GF2m_mod_¨r
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° 
p
[]);

463 
BN_GF2m_mod_mul_¨r
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
,

464 c⁄° 
p
[], 
BN_CTX
 *
˘x
);

466 
BN_GF2m_mod_sqr_¨r
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° 
p
[],

467 
BN_CTX
 *
˘x
);

469 
BN_GF2m_mod_öv_¨r
(
BIGNUM
 *
r
, c⁄° BIGNUM *
b
, c⁄° 
p
[],

470 
BN_CTX
 *
˘x
);

472 
BN_GF2m_mod_div_¨r
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
,

473 c⁄° 
p
[], 
BN_CTX
 *
˘x
);

475 
BN_GF2m_mod_exp_¨r
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
b
,

476 c⁄° 
p
[], 
BN_CTX
 *
˘x
);

478 
BN_GF2m_mod_sqπ_¨r
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
,

479 c⁄° 
p
[], 
BN_CTX
 *
˘x
);

481 
BN_GF2m_mod_sﬁve_quad_¨r
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
,

482 c⁄° 
p
[], 
BN_CTX
 *
˘x
);

483 
BN_GF2m_pﬁy2¨r
(c⁄° 
BIGNUM
 *
a
, 
p
[], 
max
);

484 
BN_GF2m_¨r2pﬁy
(c⁄° 
p
[], 
BIGNUM
 *
a
);

491 
BN_ni°_mod_192
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
, 
BN_CTX
 *
˘x
);

492 
BN_ni°_mod_224
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
, 
BN_CTX
 *
˘x
);

493 
BN_ni°_mod_256
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
, 
BN_CTX
 *
˘x
);

494 
BN_ni°_mod_384
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
, 
BN_CTX
 *
˘x
);

495 
BN_ni°_mod_521
(
BIGNUM
 *
r
, c⁄° BIGNUM *
a
, c⁄° BIGNUM *
p
, 
BN_CTX
 *
˘x
);

497 c⁄° 
BIGNUM
 *
BN_gë0_ni°_¥ime_192
();

498 c⁄° 
BIGNUM
 *
BN_gë0_ni°_¥ime_224
();

499 c⁄° 
BIGNUM
 *
BN_gë0_ni°_¥ime_256
();

500 c⁄° 
BIGNUM
 *
BN_gë0_ni°_¥ime_384
();

501 c⁄° 
BIGNUM
 *
BN_gë0_ni°_¥ime_521
();

503 (*
BN_ni°_mod_func
(c⁄° 
BIGNUM
 *
p
)Ë(BIGNUM *
r
, c⁄° BIGNUM *
a
,

504 c⁄° 
BIGNUM
 *
fõld
, 
BN_CTX
 *
˘x
);

506 
BN_gíî©e_dß_n⁄˚
(
BIGNUM
 *
out
, c⁄° BIGNUM *
ønge
,

507 c⁄° 
BIGNUM
 *
¥iv
, c⁄° *
mesßge
,

508 
size_t
 
mesßge_Àn
, 
BN_CTX
 *
˘x
);

511 
BIGNUM
 *
BN_gë_rfc2409_¥ime_768
(BIGNUM *
bn
);

512 
BIGNUM
 *
BN_gë_rfc2409_¥ime_1024
(BIGNUM *
bn
);

515 
BIGNUM
 *
BN_gë_rfc3526_¥ime_1536
(BIGNUM *
bn
);

516 
BIGNUM
 *
BN_gë_rfc3526_¥ime_2048
(BIGNUM *
bn
);

517 
BIGNUM
 *
BN_gë_rfc3526_¥ime_3072
(BIGNUM *
bn
);

518 
BIGNUM
 *
BN_gë_rfc3526_¥ime_4096
(BIGNUM *
bn
);

519 
BIGNUM
 *
BN_gë_rfc3526_¥ime_6144
(BIGNUM *
bn
);

520 
BIGNUM
 *
BN_gë_rfc3526_¥ime_8192
(BIGNUM *
bn
);

522 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

523 
	#gë_rfc2409_¥ime_768
 
BN_gë_rfc2409_¥ime_768


	)

524 
	#gë_rfc2409_¥ime_1024
 
BN_gë_rfc2409_¥ime_1024


	)

525 
	#gë_rfc3526_¥ime_1536
 
BN_gë_rfc3526_¥ime_1536


	)

526 
	#gë_rfc3526_¥ime_2048
 
BN_gë_rfc3526_¥ime_2048


	)

527 
	#gë_rfc3526_¥ime_3072
 
BN_gë_rfc3526_¥ime_3072


	)

528 
	#gë_rfc3526_¥ime_4096
 
BN_gë_rfc3526_¥ime_4096


	)

529 
	#gë_rfc3526_¥ime_6144
 
BN_gë_rfc3526_¥ime_6144


	)

530 
	#gë_rfc3526_¥ime_8192
 
BN_gë_rfc3526_¥ime_8192


	)

533 
BN_b¡e°_ønd
(
BIGNUM
 *
∫d
, 
bôs
, 
t›
, 
bŸtom
);

536 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/dherr.h

11 #i‚de‡
HEADER_DHERR_H


12 
	#HEADER_DHERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 
	~<›ís¶/›ís¶c⁄f.h
>

20 #i‚de‡
OPENSSL_NO_DH


22 #ifde‡ 
__˝lu•lus


25 
ERR_lﬂd_DH_°rögs
();

30 
	#DH_F_COMPUTE_KEY
 102

	)

31 
	#DH_F_DHPARAMS_PRINT_FP
 101

	)

32 
	#DH_F_DH_BUILTIN_GENPARAMS
 106

	)

33 
	#DH_F_DH_CHECK_EX
 121

	)

34 
	#DH_F_DH_CHECK_PARAMS_EX
 122

	)

35 
	#DH_F_DH_CHECK_PUB_KEY_EX
 123

	)

36 
	#DH_F_DH_CMS_DECRYPT
 114

	)

37 
	#DH_F_DH_CMS_SET_PEERKEY
 115

	)

38 
	#DH_F_DH_CMS_SET_SHARED_INFO
 116

	)

39 
	#DH_F_DH_METH_DUP
 117

	)

40 
	#DH_F_DH_METH_NEW
 118

	)

41 
	#DH_F_DH_METH_SET1_NAME
 119

	)

42 
	#DH_F_DH_NEW_BY_NID
 104

	)

43 
	#DH_F_DH_NEW_METHOD
 105

	)

44 
	#DH_F_DH_PARAM_DECODE
 107

	)

45 
	#DH_F_DH_PKEY_PUBLIC_CHECK
 124

	)

46 
	#DH_F_DH_PRIV_DECODE
 110

	)

47 
	#DH_F_DH_PRIV_ENCODE
 111

	)

48 
	#DH_F_DH_PUB_DECODE
 108

	)

49 
	#DH_F_DH_PUB_ENCODE
 109

	)

50 
	#DH_F_DO_DH_PRINT
 100

	)

51 
	#DH_F_GENERATE_KEY
 103

	)

52 
	#DH_F_PKEY_DH_CTRL_STR
 120

	)

53 
	#DH_F_PKEY_DH_DERIVE
 112

	)

54 
	#DH_F_PKEY_DH_INIT
 125

	)

55 
	#DH_F_PKEY_DH_KEYGEN
 113

	)

60 
	#DH_R_BAD_GENERATOR
 101

	)

61 
	#DH_R_BN_DECODE_ERROR
 109

	)

62 
	#DH_R_BN_ERROR
 106

	)

63 
	#DH_R_CHECK_INVALID_J_VALUE
 115

	)

64 
	#DH_R_CHECK_INVALID_Q_VALUE
 116

	)

65 
	#DH_R_CHECK_PUBKEY_INVALID
 122

	)

66 
	#DH_R_CHECK_PUBKEY_TOO_LARGE
 123

	)

67 
	#DH_R_CHECK_PUBKEY_TOO_SMALL
 124

	)

68 
	#DH_R_CHECK_P_NOT_PRIME
 117

	)

69 
	#DH_R_CHECK_P_NOT_SAFE_PRIME
 118

	)

70 
	#DH_R_CHECK_Q_NOT_PRIME
 119

	)

71 
	#DH_R_DECODE_ERROR
 104

	)

72 
	#DH_R_INVALID_PARAMETER_NAME
 110

	)

73 
	#DH_R_INVALID_PARAMETER_NID
 114

	)

74 
	#DH_R_INVALID_PUBKEY
 102

	)

75 
	#DH_R_KDF_PARAMETER_ERROR
 112

	)

76 
	#DH_R_KEYS_NOT_SET
 108

	)

77 
	#DH_R_MISSING_PUBKEY
 125

	)

78 
	#DH_R_MODULUS_TOO_LARGE
 103

	)

79 
	#DH_R_NOT_SUITABLE_GENERATOR
 120

	)

80 
	#DH_R_NO_PARAMETERS_SET
 107

	)

81 
	#DH_R_NO_PRIVATE_VALUE
 100

	)

82 
	#DH_R_PARAMETER_ENCODING_ERROR
 105

	)

83 
	#DH_R_PEER_KEY_ERROR
 111

	)

84 
	#DH_R_SHARED_INFO_ERROR
 113

	)

85 
	#DH_R_UNABLE_TO_CHECK_GENERATOR
 121

	)

	@/usr/include/openssl/dsaerr.h

11 #i‚de‡
HEADER_DSAERR_H


12 
	#HEADER_DSAERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 
	~<›ís¶/›ís¶c⁄f.h
>

20 #i‚de‡
OPENSSL_NO_DSA


22 #ifde‡ 
__˝lu•lus


25 
ERR_lﬂd_DSA_°rögs
();

30 
	#DSA_F_DSAPARAMS_PRINT
 100

	)

31 
	#DSA_F_DSAPARAMS_PRINT_FP
 101

	)

32 
	#DSA_F_DSA_BUILTIN_PARAMGEN
 125

	)

33 
	#DSA_F_DSA_BUILTIN_PARAMGEN2
 126

	)

34 
	#DSA_F_DSA_DO_SIGN
 112

	)

35 
	#DSA_F_DSA_DO_VERIFY
 113

	)

36 
	#DSA_F_DSA_METH_DUP
 127

	)

37 
	#DSA_F_DSA_METH_NEW
 128

	)

38 
	#DSA_F_DSA_METH_SET1_NAME
 129

	)

39 
	#DSA_F_DSA_NEW_METHOD
 103

	)

40 
	#DSA_F_DSA_PARAM_DECODE
 119

	)

41 
	#DSA_F_DSA_PRINT_FP
 105

	)

42 
	#DSA_F_DSA_PRIV_DECODE
 115

	)

43 
	#DSA_F_DSA_PRIV_ENCODE
 116

	)

44 
	#DSA_F_DSA_PUB_DECODE
 117

	)

45 
	#DSA_F_DSA_PUB_ENCODE
 118

	)

46 
	#DSA_F_DSA_SIGN
 106

	)

47 
	#DSA_F_DSA_SIGN_SETUP
 107

	)

48 
	#DSA_F_DSA_SIG_NEW
 102

	)

49 
	#DSA_F_OLD_DSA_PRIV_DECODE
 122

	)

50 
	#DSA_F_PKEY_DSA_CTRL
 120

	)

51 
	#DSA_F_PKEY_DSA_CTRL_STR
 104

	)

52 
	#DSA_F_PKEY_DSA_KEYGEN
 121

	)

57 
	#DSA_R_BAD_Q_VALUE
 102

	)

58 
	#DSA_R_BN_DECODE_ERROR
 108

	)

59 
	#DSA_R_BN_ERROR
 109

	)

60 
	#DSA_R_DECODE_ERROR
 104

	)

61 
	#DSA_R_INVALID_DIGEST_TYPE
 106

	)

62 
	#DSA_R_INVALID_PARAMETERS
 112

	)

63 
	#DSA_R_MISSING_PARAMETERS
 101

	)

64 
	#DSA_R_MISSING_PRIVATE_KEY
 111

	)

65 
	#DSA_R_MODULUS_TOO_LARGE
 103

	)

66 
	#DSA_R_NO_PARAMETERS_SET
 107

	)

67 
	#DSA_R_PARAMETER_ENCODING_ERROR
 105

	)

68 
	#DSA_R_Q_NOT_PRIME
 113

	)

69 
	#DSA_R_SEED_LEN_SMALL
 110

	)

	@/usr/include/openssl/ecerr.h

11 #i‚de‡
HEADER_ECERR_H


12 
	#HEADER_ECERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 
	~<›ís¶/›ís¶c⁄f.h
>

20 #i‚de‡
OPENSSL_NO_EC


22 #ifde‡ 
__˝lu•lus


25 
ERR_lﬂd_EC_°rögs
();

30 
	#EC_F_BN_TO_FELEM
 224

	)

31 
	#EC_F_D2I_ECPARAMETERS
 144

	)

32 
	#EC_F_D2I_ECPKPARAMETERS
 145

	)

33 
	#EC_F_D2I_ECPRIVATEKEY
 146

	)

34 
	#EC_F_DO_EC_KEY_PRINT
 221

	)

35 
	#EC_F_ECDH_CMS_DECRYPT
 238

	)

36 
	#EC_F_ECDH_CMS_SET_SHARED_INFO
 239

	)

37 
	#EC_F_ECDH_COMPUTE_KEY
 246

	)

38 
	#EC_F_ECDH_SIMPLE_COMPUTE_KEY
 257

	)

39 
	#EC_F_ECDSA_DO_SIGN_EX
 251

	)

40 
	#EC_F_ECDSA_DO_VERIFY
 252

	)

41 
	#EC_F_ECDSA_SIGN_EX
 254

	)

42 
	#EC_F_ECDSA_SIGN_SETUP
 248

	)

43 
	#EC_F_ECDSA_SIG_NEW
 265

	)

44 
	#EC_F_ECDSA_VERIFY
 253

	)

45 
	#EC_F_ECD_ITEM_VERIFY
 270

	)

46 
	#EC_F_ECKEY_PARAM2TYPE
 223

	)

47 
	#EC_F_ECKEY_PARAM_DECODE
 212

	)

48 
	#EC_F_ECKEY_PRIV_DECODE
 213

	)

49 
	#EC_F_ECKEY_PRIV_ENCODE
 214

	)

50 
	#EC_F_ECKEY_PUB_DECODE
 215

	)

51 
	#EC_F_ECKEY_PUB_ENCODE
 216

	)

52 
	#EC_F_ECKEY_TYPE2PARAM
 220

	)

53 
	#EC_F_ECPARAMETERS_PRINT
 147

	)

54 
	#EC_F_ECPARAMETERS_PRINT_FP
 148

	)

55 
	#EC_F_ECPKPARAMETERS_PRINT
 149

	)

56 
	#EC_F_ECPKPARAMETERS_PRINT_FP
 150

	)

57 
	#EC_F_ECP_NISTZ256_GET_AFFINE
 240

	)

58 
	#EC_F_ECP_NISTZ256_INV_MOD_ORD
 275

	)

59 
	#EC_F_ECP_NISTZ256_MULT_PRECOMPUTE
 243

	)

60 
	#EC_F_ECP_NISTZ256_POINTS_MUL
 241

	)

61 
	#EC_F_ECP_NISTZ256_PRE_COMP_NEW
 244

	)

62 
	#EC_F_ECP_NISTZ256_WINDOWED_MUL
 242

	)

63 
	#EC_F_ECX_KEY_OP
 266

	)

64 
	#EC_F_ECX_PRIV_ENCODE
 267

	)

65 
	#EC_F_ECX_PUB_ENCODE
 268

	)

66 
	#EC_F_EC_ASN1_GROUP2CURVE
 153

	)

67 
	#EC_F_EC_ASN1_GROUP2FIELDID
 154

	)

68 
	#EC_F_EC_GF2M_MONTGOMERY_POINT_MULTIPLY
 208

	)

69 
	#EC_F_EC_GF2M_SIMPLE_FIELD_INV
 296

	)

70 
	#EC_F_EC_GF2M_SIMPLE_GROUP_CHECK_DISCRIMINANT
 159

	)

71 
	#EC_F_EC_GF2M_SIMPLE_GROUP_SET_CURVE
 195

	)

72 
	#EC_F_EC_GF2M_SIMPLE_LADDER_POST
 285

	)

73 
	#EC_F_EC_GF2M_SIMPLE_LADDER_PRE
 288

	)

74 
	#EC_F_EC_GF2M_SIMPLE_OCT2POINT
 160

	)

75 
	#EC_F_EC_GF2M_SIMPLE_POINT2OCT
 161

	)

76 
	#EC_F_EC_GF2M_SIMPLE_POINTS_MUL
 289

	)

77 
	#EC_F_EC_GF2M_SIMPLE_POINT_GET_AFFINE_COORDINATES
 162

	)

78 
	#EC_F_EC_GF2M_SIMPLE_POINT_SET_AFFINE_COORDINATES
 163

	)

79 
	#EC_F_EC_GF2M_SIMPLE_SET_COMPRESSED_COORDINATES
 164

	)

80 
	#EC_F_EC_GFP_MONT_FIELD_DECODE
 133

	)

81 
	#EC_F_EC_GFP_MONT_FIELD_ENCODE
 134

	)

82 
	#EC_F_EC_GFP_MONT_FIELD_INV
 297

	)

83 
	#EC_F_EC_GFP_MONT_FIELD_MUL
 131

	)

84 
	#EC_F_EC_GFP_MONT_FIELD_SET_TO_ONE
 209

	)

85 
	#EC_F_EC_GFP_MONT_FIELD_SQR
 132

	)

86 
	#EC_F_EC_GFP_MONT_GROUP_SET_CURVE
 189

	)

87 
	#EC_F_EC_GFP_NISTP224_GROUP_SET_CURVE
 225

	)

88 
	#EC_F_EC_GFP_NISTP224_POINTS_MUL
 228

	)

89 
	#EC_F_EC_GFP_NISTP224_POINT_GET_AFFINE_COORDINATES
 226

	)

90 
	#EC_F_EC_GFP_NISTP256_GROUP_SET_CURVE
 230

	)

91 
	#EC_F_EC_GFP_NISTP256_POINTS_MUL
 231

	)

92 
	#EC_F_EC_GFP_NISTP256_POINT_GET_AFFINE_COORDINATES
 232

	)

93 
	#EC_F_EC_GFP_NISTP521_GROUP_SET_CURVE
 233

	)

94 
	#EC_F_EC_GFP_NISTP521_POINTS_MUL
 234

	)

95 
	#EC_F_EC_GFP_NISTP521_POINT_GET_AFFINE_COORDINATES
 235

	)

96 
	#EC_F_EC_GFP_NIST_FIELD_MUL
 200

	)

97 
	#EC_F_EC_GFP_NIST_FIELD_SQR
 201

	)

98 
	#EC_F_EC_GFP_NIST_GROUP_SET_CURVE
 202

	)

99 
	#EC_F_EC_GFP_SIMPLE_BLIND_COORDINATES
 287

	)

100 
	#EC_F_EC_GFP_SIMPLE_FIELD_INV
 298

	)

101 
	#EC_F_EC_GFP_SIMPLE_GROUP_CHECK_DISCRIMINANT
 165

	)

102 
	#EC_F_EC_GFP_SIMPLE_GROUP_SET_CURVE
 166

	)

103 
	#EC_F_EC_GFP_SIMPLE_MAKE_AFFINE
 102

	)

104 
	#EC_F_EC_GFP_SIMPLE_OCT2POINT
 103

	)

105 
	#EC_F_EC_GFP_SIMPLE_POINT2OCT
 104

	)

106 
	#EC_F_EC_GFP_SIMPLE_POINTS_MAKE_AFFINE
 137

	)

107 
	#EC_F_EC_GFP_SIMPLE_POINT_GET_AFFINE_COORDINATES
 167

	)

108 
	#EC_F_EC_GFP_SIMPLE_POINT_SET_AFFINE_COORDINATES
 168

	)

109 
	#EC_F_EC_GFP_SIMPLE_SET_COMPRESSED_COORDINATES
 169

	)

110 
	#EC_F_EC_GROUP_CHECK
 170

	)

111 
	#EC_F_EC_GROUP_CHECK_DISCRIMINANT
 171

	)

112 
	#EC_F_EC_GROUP_COPY
 106

	)

113 
	#EC_F_EC_GROUP_GET_CURVE
 291

	)

114 
	#EC_F_EC_GROUP_GET_CURVE_GF2M
 172

	)

115 
	#EC_F_EC_GROUP_GET_CURVE_GFP
 130

	)

116 
	#EC_F_EC_GROUP_GET_DEGREE
 173

	)

117 
	#EC_F_EC_GROUP_GET_ECPARAMETERS
 261

	)

118 
	#EC_F_EC_GROUP_GET_ECPKPARAMETERS
 262

	)

119 
	#EC_F_EC_GROUP_GET_PENTANOMIAL_BASIS
 193

	)

120 
	#EC_F_EC_GROUP_GET_TRINOMIAL_BASIS
 194

	)

121 
	#EC_F_EC_GROUP_NEW
 108

	)

122 
	#EC_F_EC_GROUP_NEW_BY_CURVE_NAME
 174

	)

123 
	#EC_F_EC_GROUP_NEW_FROM_DATA
 175

	)

124 
	#EC_F_EC_GROUP_NEW_FROM_ECPARAMETERS
 263

	)

125 
	#EC_F_EC_GROUP_NEW_FROM_ECPKPARAMETERS
 264

	)

126 
	#EC_F_EC_GROUP_SET_CURVE
 292

	)

127 
	#EC_F_EC_GROUP_SET_CURVE_GF2M
 176

	)

128 
	#EC_F_EC_GROUP_SET_CURVE_GFP
 109

	)

129 
	#EC_F_EC_GROUP_SET_GENERATOR
 111

	)

130 
	#EC_F_EC_GROUP_SET_SEED
 286

	)

131 
	#EC_F_EC_KEY_CHECK_KEY
 177

	)

132 
	#EC_F_EC_KEY_COPY
 178

	)

133 
	#EC_F_EC_KEY_GENERATE_KEY
 179

	)

134 
	#EC_F_EC_KEY_NEW
 182

	)

135 
	#EC_F_EC_KEY_NEW_METHOD
 245

	)

136 
	#EC_F_EC_KEY_OCT2PRIV
 255

	)

137 
	#EC_F_EC_KEY_PRINT
 180

	)

138 
	#EC_F_EC_KEY_PRINT_FP
 181

	)

139 
	#EC_F_EC_KEY_PRIV2BUF
 279

	)

140 
	#EC_F_EC_KEY_PRIV2OCT
 256

	)

141 
	#EC_F_EC_KEY_SET_PUBLIC_KEY_AFFINE_COORDINATES
 229

	)

142 
	#EC_F_EC_KEY_SIMPLE_CHECK_KEY
 258

	)

143 
	#EC_F_EC_KEY_SIMPLE_OCT2PRIV
 259

	)

144 
	#EC_F_EC_KEY_SIMPLE_PRIV2OCT
 260

	)

145 
	#EC_F_EC_PKEY_CHECK
 273

	)

146 
	#EC_F_EC_PKEY_PARAM_CHECK
 274

	)

147 
	#EC_F_EC_POINTS_MAKE_AFFINE
 136

	)

148 
	#EC_F_EC_POINTS_MUL
 290

	)

149 
	#EC_F_EC_POINT_ADD
 112

	)

150 
	#EC_F_EC_POINT_BN2POINT
 280

	)

151 
	#EC_F_EC_POINT_CMP
 113

	)

152 
	#EC_F_EC_POINT_COPY
 114

	)

153 
	#EC_F_EC_POINT_DBL
 115

	)

154 
	#EC_F_EC_POINT_GET_AFFINE_COORDINATES
 293

	)

155 
	#EC_F_EC_POINT_GET_AFFINE_COORDINATES_GF2M
 183

	)

156 
	#EC_F_EC_POINT_GET_AFFINE_COORDINATES_GFP
 116

	)

157 
	#EC_F_EC_POINT_GET_JPROJECTIVE_COORDINATES_GFP
 117

	)

158 
	#EC_F_EC_POINT_INVERT
 210

	)

159 
	#EC_F_EC_POINT_IS_AT_INFINITY
 118

	)

160 
	#EC_F_EC_POINT_IS_ON_CURVE
 119

	)

161 
	#EC_F_EC_POINT_MAKE_AFFINE
 120

	)

162 
	#EC_F_EC_POINT_NEW
 121

	)

163 
	#EC_F_EC_POINT_OCT2POINT
 122

	)

164 
	#EC_F_EC_POINT_POINT2BUF
 281

	)

165 
	#EC_F_EC_POINT_POINT2OCT
 123

	)

166 
	#EC_F_EC_POINT_SET_AFFINE_COORDINATES
 294

	)

167 
	#EC_F_EC_POINT_SET_AFFINE_COORDINATES_GF2M
 185

	)

168 
	#EC_F_EC_POINT_SET_AFFINE_COORDINATES_GFP
 124

	)

169 
	#EC_F_EC_POINT_SET_COMPRESSED_COORDINATES
 295

	)

170 
	#EC_F_EC_POINT_SET_COMPRESSED_COORDINATES_GF2M
 186

	)

171 
	#EC_F_EC_POINT_SET_COMPRESSED_COORDINATES_GFP
 125

	)

172 
	#EC_F_EC_POINT_SET_JPROJECTIVE_COORDINATES_GFP
 126

	)

173 
	#EC_F_EC_POINT_SET_TO_INFINITY
 127

	)

174 
	#EC_F_EC_PRE_COMP_NEW
 196

	)

175 
	#EC_F_EC_SCALAR_MUL_LADDER
 284

	)

176 
	#EC_F_EC_WNAF_MUL
 187

	)

177 
	#EC_F_EC_WNAF_PRECOMPUTE_MULT
 188

	)

178 
	#EC_F_I2D_ECPARAMETERS
 190

	)

179 
	#EC_F_I2D_ECPKPARAMETERS
 191

	)

180 
	#EC_F_I2D_ECPRIVATEKEY
 192

	)

181 
	#EC_F_I2O_ECPUBLICKEY
 151

	)

182 
	#EC_F_NISTP224_PRE_COMP_NEW
 227

	)

183 
	#EC_F_NISTP256_PRE_COMP_NEW
 236

	)

184 
	#EC_F_NISTP521_PRE_COMP_NEW
 237

	)

185 
	#EC_F_O2I_ECPUBLICKEY
 152

	)

186 
	#EC_F_OLD_EC_PRIV_DECODE
 222

	)

187 
	#EC_F_OSSL_ECDH_COMPUTE_KEY
 247

	)

188 
	#EC_F_OSSL_ECDSA_SIGN_SIG
 249

	)

189 
	#EC_F_OSSL_ECDSA_VERIFY_SIG
 250

	)

190 
	#EC_F_PKEY_ECD_CTRL
 271

	)

191 
	#EC_F_PKEY_ECD_DIGESTSIGN
 272

	)

192 
	#EC_F_PKEY_ECD_DIGESTSIGN25519
 276

	)

193 
	#EC_F_PKEY_ECD_DIGESTSIGN448
 277

	)

194 
	#EC_F_PKEY_ECX_DERIVE
 269

	)

195 
	#EC_F_PKEY_EC_CTRL
 197

	)

196 
	#EC_F_PKEY_EC_CTRL_STR
 198

	)

197 
	#EC_F_PKEY_EC_DERIVE
 217

	)

198 
	#EC_F_PKEY_EC_INIT
 282

	)

199 
	#EC_F_PKEY_EC_KDF_DERIVE
 283

	)

200 
	#EC_F_PKEY_EC_KEYGEN
 199

	)

201 
	#EC_F_PKEY_EC_PARAMGEN
 219

	)

202 
	#EC_F_PKEY_EC_SIGN
 218

	)

203 
	#EC_F_VALIDATE_ECX_DERIVE
 278

	)

208 
	#EC_R_ASN1_ERROR
 115

	)

209 
	#EC_R_BAD_SIGNATURE
 156

	)

210 
	#EC_R_BIGNUM_OUT_OF_RANGE
 144

	)

211 
	#EC_R_BUFFER_TOO_SMALL
 100

	)

212 
	#EC_R_CANNOT_INVERT
 165

	)

213 
	#EC_R_COORDINATES_OUT_OF_RANGE
 146

	)

214 
	#EC_R_CURVE_DOES_NOT_SUPPORT_ECDH
 160

	)

215 
	#EC_R_CURVE_DOES_NOT_SUPPORT_SIGNING
 159

	)

216 
	#EC_R_D2I_ECPKPARAMETERS_FAILURE
 117

	)

217 
	#EC_R_DECODE_ERROR
 142

	)

218 
	#EC_R_DISCRIMINANT_IS_ZERO
 118

	)

219 
	#EC_R_EC_GROUP_NEW_BY_NAME_FAILURE
 119

	)

220 
	#EC_R_FIELD_TOO_LARGE
 143

	)

221 
	#EC_R_GF2M_NOT_SUPPORTED
 147

	)

222 
	#EC_R_GROUP2PKPARAMETERS_FAILURE
 120

	)

223 
	#EC_R_I2D_ECPKPARAMETERS_FAILURE
 121

	)

224 
	#EC_R_INCOMPATIBLE_OBJECTS
 101

	)

225 
	#EC_R_INVALID_ARGUMENT
 112

	)

226 
	#EC_R_INVALID_COMPRESSED_POINT
 110

	)

227 
	#EC_R_INVALID_COMPRESSION_BIT
 109

	)

228 
	#EC_R_INVALID_CURVE
 141

	)

229 
	#EC_R_INVALID_DIGEST
 151

	)

230 
	#EC_R_INVALID_DIGEST_TYPE
 138

	)

231 
	#EC_R_INVALID_ENCODING
 102

	)

232 
	#EC_R_INVALID_FIELD
 103

	)

233 
	#EC_R_INVALID_FORM
 104

	)

234 
	#EC_R_INVALID_GROUP_ORDER
 122

	)

235 
	#EC_R_INVALID_KEY
 116

	)

236 
	#EC_R_INVALID_OUTPUT_LENGTH
 161

	)

237 
	#EC_R_INVALID_PEER_KEY
 133

	)

238 
	#EC_R_INVALID_PENTANOMIAL_BASIS
 132

	)

239 
	#EC_R_INVALID_PRIVATE_KEY
 123

	)

240 
	#EC_R_INVALID_TRINOMIAL_BASIS
 137

	)

241 
	#EC_R_KDF_PARAMETER_ERROR
 148

	)

242 
	#EC_R_KEYS_NOT_SET
 140

	)

243 
	#EC_R_LADDER_POST_FAILURE
 136

	)

244 
	#EC_R_LADDER_PRE_FAILURE
 153

	)

245 
	#EC_R_LADDER_STEP_FAILURE
 162

	)

246 
	#EC_R_MISSING_PARAMETERS
 124

	)

247 
	#EC_R_MISSING_PRIVATE_KEY
 125

	)

248 
	#EC_R_NEED_NEW_SETUP_VALUES
 157

	)

249 
	#EC_R_NOT_A_NIST_PRIME
 135

	)

250 
	#EC_R_NOT_IMPLEMENTED
 126

	)

251 
	#EC_R_NOT_INITIALIZED
 111

	)

252 
	#EC_R_NO_PARAMETERS_SET
 139

	)

253 
	#EC_R_NO_PRIVATE_VALUE
 154

	)

254 
	#EC_R_OPERATION_NOT_SUPPORTED
 152

	)

255 
	#EC_R_PASSED_NULL_PARAMETER
 134

	)

256 
	#EC_R_PEER_KEY_ERROR
 149

	)

257 
	#EC_R_PKPARAMETERS2GROUP_FAILURE
 127

	)

258 
	#EC_R_POINT_ARITHMETIC_FAILURE
 155

	)

259 
	#EC_R_POINT_AT_INFINITY
 106

	)

260 
	#EC_R_POINT_COORDINATES_BLIND_FAILURE
 163

	)

261 
	#EC_R_POINT_IS_NOT_ON_CURVE
 107

	)

262 
	#EC_R_RANDOM_NUMBER_GENERATION_FAILED
 158

	)

263 
	#EC_R_SHARED_INFO_ERROR
 150

	)

264 
	#EC_R_SLOT_FULL
 108

	)

265 
	#EC_R_UNDEFINED_GENERATOR
 113

	)

266 
	#EC_R_UNDEFINED_ORDER
 128

	)

267 
	#EC_R_UNKNOWN_COFACTOR
 164

	)

268 
	#EC_R_UNKNOWN_GROUP
 129

	)

269 
	#EC_R_UNKNOWN_ORDER
 114

	)

270 
	#EC_R_UNSUPPORTED_FIELD
 131

	)

271 
	#EC_R_WRONG_CURVE_PARAMETERS
 145

	)

272 
	#EC_R_WRONG_ORDER
 130

	)

	@/usr/include/openssl/evperr.h

11 #i‚de‡
HEADER_EVPERR_H


12 
	#HEADER_EVPERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_EVP_°rögs
();

26 
	#EVP_F_AESNI_INIT_KEY
 165

	)

27 
	#EVP_F_AESNI_XTS_INIT_KEY
 207

	)

28 
	#EVP_F_AES_GCM_CTRL
 196

	)

29 
	#EVP_F_AES_INIT_KEY
 133

	)

30 
	#EVP_F_AES_OCB_CIPHER
 169

	)

31 
	#EVP_F_AES_T4_INIT_KEY
 178

	)

32 
	#EVP_F_AES_T4_XTS_INIT_KEY
 208

	)

33 
	#EVP_F_AES_WRAP_CIPHER
 170

	)

34 
	#EVP_F_AES_XTS_INIT_KEY
 209

	)

35 
	#EVP_F_ALG_MODULE_INIT
 177

	)

36 
	#EVP_F_ARIA_CCM_INIT_KEY
 175

	)

37 
	#EVP_F_ARIA_GCM_CTRL
 197

	)

38 
	#EVP_F_ARIA_GCM_INIT_KEY
 176

	)

39 
	#EVP_F_ARIA_INIT_KEY
 185

	)

40 
	#EVP_F_B64_NEW
 198

	)

41 
	#EVP_F_CAMELLIA_INIT_KEY
 159

	)

42 
	#EVP_F_CHACHA20_POLY1305_CTRL
 182

	)

43 
	#EVP_F_CMLL_T4_INIT_KEY
 179

	)

44 
	#EVP_F_DES_EDE3_WRAP_CIPHER
 171

	)

45 
	#EVP_F_DO_SIGVER_INIT
 161

	)

46 
	#EVP_F_ENC_NEW
 199

	)

47 
	#EVP_F_EVP_CIPHERINIT_EX
 123

	)

48 
	#EVP_F_EVP_CIPHER_ASN1_TO_PARAM
 204

	)

49 
	#EVP_F_EVP_CIPHER_CTX_COPY
 163

	)

50 
	#EVP_F_EVP_CIPHER_CTX_CTRL
 124

	)

51 
	#EVP_F_EVP_CIPHER_CTX_SET_KEY_LENGTH
 122

	)

52 
	#EVP_F_EVP_CIPHER_PARAM_TO_ASN1
 205

	)

53 
	#EVP_F_EVP_DECRYPTFINAL_EX
 101

	)

54 
	#EVP_F_EVP_DECRYPTUPDATE
 166

	)

55 
	#EVP_F_EVP_DIGESTFINALXOF
 174

	)

56 
	#EVP_F_EVP_DIGESTINIT_EX
 128

	)

57 
	#EVP_F_EVP_ENCRYPTDECRYPTUPDATE
 219

	)

58 
	#EVP_F_EVP_ENCRYPTFINAL_EX
 127

	)

59 
	#EVP_F_EVP_ENCRYPTUPDATE
 167

	)

60 
	#EVP_F_EVP_MD_CTX_COPY_EX
 110

	)

61 
	#EVP_F_EVP_MD_SIZE
 162

	)

62 
	#EVP_F_EVP_OPENINIT
 102

	)

63 
	#EVP_F_EVP_PBE_ALG_ADD
 115

	)

64 
	#EVP_F_EVP_PBE_ALG_ADD_TYPE
 160

	)

65 
	#EVP_F_EVP_PBE_CIPHERINIT
 116

	)

66 
	#EVP_F_EVP_PBE_SCRYPT
 181

	)

67 
	#EVP_F_EVP_PKCS82PKEY
 111

	)

68 
	#EVP_F_EVP_PKEY2PKCS8
 113

	)

69 
	#EVP_F_EVP_PKEY_ASN1_ADD0
 188

	)

70 
	#EVP_F_EVP_PKEY_CHECK
 186

	)

71 
	#EVP_F_EVP_PKEY_COPY_PARAMETERS
 103

	)

72 
	#EVP_F_EVP_PKEY_CTX_CTRL
 137

	)

73 
	#EVP_F_EVP_PKEY_CTX_CTRL_STR
 150

	)

74 
	#EVP_F_EVP_PKEY_CTX_DUP
 156

	)

75 
	#EVP_F_EVP_PKEY_CTX_MD
 168

	)

76 
	#EVP_F_EVP_PKEY_DECRYPT
 104

	)

77 
	#EVP_F_EVP_PKEY_DECRYPT_INIT
 138

	)

78 
	#EVP_F_EVP_PKEY_DECRYPT_OLD
 151

	)

79 
	#EVP_F_EVP_PKEY_DERIVE
 153

	)

80 
	#EVP_F_EVP_PKEY_DERIVE_INIT
 154

	)

81 
	#EVP_F_EVP_PKEY_DERIVE_SET_PEER
 155

	)

82 
	#EVP_F_EVP_PKEY_ENCRYPT
 105

	)

83 
	#EVP_F_EVP_PKEY_ENCRYPT_INIT
 139

	)

84 
	#EVP_F_EVP_PKEY_ENCRYPT_OLD
 152

	)

85 
	#EVP_F_EVP_PKEY_GET0_DH
 119

	)

86 
	#EVP_F_EVP_PKEY_GET0_DSA
 120

	)

87 
	#EVP_F_EVP_PKEY_GET0_EC_KEY
 131

	)

88 
	#EVP_F_EVP_PKEY_GET0_HMAC
 183

	)

89 
	#EVP_F_EVP_PKEY_GET0_POLY1305
 184

	)

90 
	#EVP_F_EVP_PKEY_GET0_RSA
 121

	)

91 
	#EVP_F_EVP_PKEY_GET0_SIPHASH
 172

	)

92 
	#EVP_F_EVP_PKEY_GET_RAW_PRIVATE_KEY
 202

	)

93 
	#EVP_F_EVP_PKEY_GET_RAW_PUBLIC_KEY
 203

	)

94 
	#EVP_F_EVP_PKEY_KEYGEN
 146

	)

95 
	#EVP_F_EVP_PKEY_KEYGEN_INIT
 147

	)

96 
	#EVP_F_EVP_PKEY_METH_ADD0
 194

	)

97 
	#EVP_F_EVP_PKEY_METH_NEW
 195

	)

98 
	#EVP_F_EVP_PKEY_NEW
 106

	)

99 
	#EVP_F_EVP_PKEY_NEW_CMAC_KEY
 193

	)

100 
	#EVP_F_EVP_PKEY_NEW_RAW_PRIVATE_KEY
 191

	)

101 
	#EVP_F_EVP_PKEY_NEW_RAW_PUBLIC_KEY
 192

	)

102 
	#EVP_F_EVP_PKEY_PARAMGEN
 148

	)

103 
	#EVP_F_EVP_PKEY_PARAMGEN_INIT
 149

	)

104 
	#EVP_F_EVP_PKEY_PARAM_CHECK
 189

	)

105 
	#EVP_F_EVP_PKEY_PUBLIC_CHECK
 190

	)

106 
	#EVP_F_EVP_PKEY_SET1_ENGINE
 187

	)

107 
	#EVP_F_EVP_PKEY_SET_ALIAS_TYPE
 206

	)

108 
	#EVP_F_EVP_PKEY_SIGN
 140

	)

109 
	#EVP_F_EVP_PKEY_SIGN_INIT
 141

	)

110 
	#EVP_F_EVP_PKEY_VERIFY
 142

	)

111 
	#EVP_F_EVP_PKEY_VERIFY_INIT
 143

	)

112 
	#EVP_F_EVP_PKEY_VERIFY_RECOVER
 144

	)

113 
	#EVP_F_EVP_PKEY_VERIFY_RECOVER_INIT
 145

	)

114 
	#EVP_F_EVP_SIGNFINAL
 107

	)

115 
	#EVP_F_EVP_VERIFYFINAL
 108

	)

116 
	#EVP_F_INT_CTX_NEW
 157

	)

117 
	#EVP_F_OK_NEW
 200

	)

118 
	#EVP_F_PKCS5_PBE_KEYIVGEN
 117

	)

119 
	#EVP_F_PKCS5_V2_PBE_KEYIVGEN
 118

	)

120 
	#EVP_F_PKCS5_V2_PBKDF2_KEYIVGEN
 164

	)

121 
	#EVP_F_PKCS5_V2_SCRYPT_KEYIVGEN
 180

	)

122 
	#EVP_F_PKEY_SET_TYPE
 158

	)

123 
	#EVP_F_RC2_MAGIC_TO_METH
 109

	)

124 
	#EVP_F_RC5_CTRL
 125

	)

125 
	#EVP_F_R_32_12_16_INIT_KEY
 242

	)

126 
	#EVP_F_S390X_AES_GCM_CTRL
 201

	)

127 
	#EVP_F_UPDATE
 173

	)

132 
	#EVP_R_AES_KEY_SETUP_FAILED
 143

	)

133 
	#EVP_R_ARIA_KEY_SETUP_FAILED
 176

	)

134 
	#EVP_R_BAD_DECRYPT
 100

	)

135 
	#EVP_R_BAD_KEY_LENGTH
 195

	)

136 
	#EVP_R_BUFFER_TOO_SMALL
 155

	)

137 
	#EVP_R_CAMELLIA_KEY_SETUP_FAILED
 157

	)

138 
	#EVP_R_CIPHER_PARAMETER_ERROR
 122

	)

139 
	#EVP_R_COMMAND_NOT_SUPPORTED
 147

	)

140 
	#EVP_R_COPY_ERROR
 173

	)

141 
	#EVP_R_CTRL_NOT_IMPLEMENTED
 132

	)

142 
	#EVP_R_CTRL_OPERATION_NOT_IMPLEMENTED
 133

	)

143 
	#EVP_R_DATA_NOT_MULTIPLE_OF_BLOCK_LENGTH
 138

	)

144 
	#EVP_R_DECODE_ERROR
 114

	)

145 
	#EVP_R_DIFFERENT_KEY_TYPES
 101

	)

146 
	#EVP_R_DIFFERENT_PARAMETERS
 153

	)

147 
	#EVP_R_ERROR_LOADING_SECTION
 165

	)

148 
	#EVP_R_ERROR_SETTING_FIPS_MODE
 166

	)

149 
	#EVP_R_EXPECTING_AN_HMAC_KEY
 174

	)

150 
	#EVP_R_EXPECTING_AN_RSA_KEY
 127

	)

151 
	#EVP_R_EXPECTING_A_DH_KEY
 128

	)

152 
	#EVP_R_EXPECTING_A_DSA_KEY
 129

	)

153 
	#EVP_R_EXPECTING_A_EC_KEY
 142

	)

154 
	#EVP_R_EXPECTING_A_POLY1305_KEY
 164

	)

155 
	#EVP_R_EXPECTING_A_SIPHASH_KEY
 175

	)

156 
	#EVP_R_FIPS_MODE_NOT_SUPPORTED
 167

	)

157 
	#EVP_R_GET_RAW_KEY_FAILED
 182

	)

158 
	#EVP_R_ILLEGAL_SCRYPT_PARAMETERS
 171

	)

159 
	#EVP_R_INITIALIZATION_ERROR
 134

	)

160 
	#EVP_R_INPUT_NOT_INITIALIZED
 111

	)

161 
	#EVP_R_INVALID_DIGEST
 152

	)

162 
	#EVP_R_INVALID_FIPS_MODE
 168

	)

163 
	#EVP_R_INVALID_KEY
 163

	)

164 
	#EVP_R_INVALID_KEY_LENGTH
 130

	)

165 
	#EVP_R_INVALID_OPERATION
 148

	)

166 
	#EVP_R_KEYGEN_FAILURE
 120

	)

167 
	#EVP_R_KEY_SETUP_FAILED
 180

	)

168 
	#EVP_R_MEMORY_LIMIT_EXCEEDED
 172

	)

169 
	#EVP_R_MESSAGE_DIGEST_IS_NULL
 159

	)

170 
	#EVP_R_METHOD_NOT_SUPPORTED
 144

	)

171 
	#EVP_R_MISSING_PARAMETERS
 103

	)

172 
	#EVP_R_NOT_XOF_OR_INVALID_LENGTH
 178

	)

173 
	#EVP_R_NO_CIPHER_SET
 131

	)

174 
	#EVP_R_NO_DEFAULT_DIGEST
 158

	)

175 
	#EVP_R_NO_DIGEST_SET
 139

	)

176 
	#EVP_R_NO_KEY_SET
 154

	)

177 
	#EVP_R_NO_OPERATION_SET
 149

	)

178 
	#EVP_R_ONLY_ONESHOT_SUPPORTED
 177

	)

179 
	#EVP_R_OPERATION_NOT_SUPPORTED_FOR_THIS_KEYTYPE
 150

	)

180 
	#EVP_R_OPERATON_NOT_INITIALIZED
 151

	)

181 
	#EVP_R_PARTIALLY_OVERLAPPING
 162

	)

182 
	#EVP_R_PBKDF2_ERROR
 181

	)

183 
	#EVP_R_PKEY_APPLICATION_ASN1_METHOD_ALREADY_REGISTERED
 179

	)

184 
	#EVP_R_PRIVATE_KEY_DECODE_ERROR
 145

	)

185 
	#EVP_R_PRIVATE_KEY_ENCODE_ERROR
 146

	)

186 
	#EVP_R_PUBLIC_KEY_NOT_RSA
 106

	)

187 
	#EVP_R_UNKNOWN_CIPHER
 160

	)

188 
	#EVP_R_UNKNOWN_DIGEST
 161

	)

189 
	#EVP_R_UNKNOWN_OPTION
 169

	)

190 
	#EVP_R_UNKNOWN_PBE_ALGORITHM
 121

	)

191 
	#EVP_R_UNSUPPORTED_ALGORITHM
 156

	)

192 
	#EVP_R_UNSUPPORTED_CIPHER
 107

	)

193 
	#EVP_R_UNSUPPORTED_KEYLENGTH
 123

	)

194 
	#EVP_R_UNSUPPORTED_KEY_DERIVATION_FUNCTION
 124

	)

195 
	#EVP_R_UNSUPPORTED_KEY_SIZE
 108

	)

196 
	#EVP_R_UNSUPPORTED_NUMBER_OF_ROUNDS
 135

	)

197 
	#EVP_R_UNSUPPORTED_PRF
 125

	)

198 
	#EVP_R_UNSUPPORTED_PRIVATE_KEY_ALGORITHM
 118

	)

199 
	#EVP_R_UNSUPPORTED_SALT_TYPE
 126

	)

200 
	#EVP_R_WRAP_MODE_NOT_ALLOWED
 170

	)

201 
	#EVP_R_WRONG_FINAL_BLOCK_LENGTH
 109

	)

202 
	#EVP_R_XTS_DUPLICATED_KEYS
 183

	)

	@/usr/include/openssl/objects.h

10 #i‚de‡
HEADER_OBJECTS_H


11 
	#HEADER_OBJECTS_H


	)

13 
	~<›ís¶/obj_mac.h
>

14 
	~<›ís¶/bio.h
>

15 
	~<›ís¶/a¢1.h
>

16 
	~<›ís¶/obje˘£º.h
>

18 
	#OBJ_NAME_TYPE_UNDEF
 0x00

	)

19 
	#OBJ_NAME_TYPE_MD_METH
 0x01

	)

20 
	#OBJ_NAME_TYPE_CIPHER_METH
 0x02

	)

21 
	#OBJ_NAME_TYPE_PKEY_METH
 0x03

	)

22 
	#OBJ_NAME_TYPE_COMP_METH
 0x04

	)

23 
	#OBJ_NAME_TYPE_NUM
 0x05

	)

25 
	#OBJ_NAME_ALIAS
 0x8000

	)

27 
	#OBJ_BSEARCH_VALUE_ON_NOMATCH
 0x01

	)

28 
	#OBJ_BSEARCH_FIRST_VALUE_ON_MATCH
 0x02

	)

31 #ifde‡ 
__˝lu•lus


35 
	sobj_«me_°
 {

36 
ty≥
;

37 
Æüs
;

38 c⁄° *
«me
;

39 c⁄° *
d©a
;

40 } 
	tOBJ_NAME
;

42 
	#OBJ_¸óã_™d_add_obje˘
(
a
,
b
,
c
Ë
	`OBJ_¸óã
◊,b,c)

	)

44 
OBJ_NAME_öô
();

45 
OBJ_NAME_√w_ödex
((*
hash_func
) (const *),

46 (*
cmp_func
) (const *, const *),

47 (*
‰ì_func
) (const *, , const *));

48 c⁄° *
OBJ_NAME_gë
(c⁄° *
«me
, 
ty≥
);

49 
OBJ_NAME_add
(c⁄° *
«me
, 
ty≥
, c⁄° *
d©a
);

50 
OBJ_NAME_ªmove
(c⁄° *
«me
, 
ty≥
);

51 
OBJ_NAME_˛ónup
(
ty≥
);

52 
OBJ_NAME_do_Æl
(
ty≥
, (*
‚
Ë(c⁄° 
OBJ_NAME
 *, *
¨g
),

53 *
¨g
);

54 
OBJ_NAME_do_Æl_s‹ãd
(
ty≥
,

55 (*
‚
Ë(c⁄° 
OBJ_NAME
 *, *
¨g
),

56 *
¨g
);

58 
ASN1_OBJECT
 *
OBJ_dup
(c⁄° ASN1_OBJECT *
o
);

59 
ASN1_OBJECT
 *
OBJ_nid2obj
(
n
);

60 c⁄° *
OBJ_nid2 
(
n
);

61 c⁄° *
OBJ_nid2¢
(
n
);

62 
OBJ_obj2nid
(c⁄° 
ASN1_OBJECT
 *
o
);

63 
ASN1_OBJECT
 *
OBJ_txt2obj
(c⁄° *
s
, 
no_«me
);

64 
OBJ_obj2txt
(*
buf
, 
buf_Àn
, c⁄° 
ASN1_OBJECT
 *
a
, 
no_«me
);

65 
OBJ_txt2nid
(c⁄° *
s
);

66 
OBJ_ 2nid
(c⁄° *
s
);

67 
OBJ_¢2nid
(c⁄° *
s
);

68 
OBJ_cmp
(c⁄° 
ASN1_OBJECT
 *
a
, c⁄° ASN1_OBJECT *
b
);

69 c⁄° *
OBJ_b£¨ch_
(c⁄° *
key
, c⁄° *
ba£
, 
num
, 
size
,

70 (*
cmp
) (const *, const *));

71 c⁄° *
OBJ_b£¨ch_ex_
(c⁄° *
key
, c⁄° *
ba£
, 
num
,

72 
size
,

73 (*
cmp
) (const *, const *),

74 
Êags
);

76 
	#_DECLARE_OBJ_BSEARCH_CMP_FN
(
sc›e
, 
ty≥1
, 
ty≥2
, 
nm
) \

77 
nm
##
	`_cmp_BSEARCH_CMP_FN
(const *, const *); \

78 
nm
##
	`_cmp
(
ty≥1
 c⁄° *, 
ty≥2
 const *); \

79 
sc›e
 
ty≥2
 * 
OBJ_b£¨ch_
##
	`nm
(
ty≥1
 *
key
,Åy≥2 c⁄° *
ba£
, 
num
)

	)

81 
	#DECLARE_OBJ_BSEARCH_CMP_FN
(
ty≥1
, 
ty≥2
, 
cmp
) \

82 
	`_DECLARE_OBJ_BSEARCH_CMP_FN
(, 
ty≥1
, 
ty≥2
, 
cmp
)

	)

83 
	#DECLARE_OBJ_BSEARCH_GLOBAL_CMP_FN
(
ty≥1
, 
ty≥2
, 
nm
) \

84 
ty≥2
 * 
OBJ_b£¨ch_
##
	`nm
(
ty≥1
 *
key
,Åy≥2 c⁄° *
ba£
, 
num
)

	)

113 
	#IMPLEMENT_OBJ_BSEARCH_CMP_FN
(
ty≥1
, 
ty≥2
, 
nm
) \

114 
nm
##
	`_cmp_BSEARCH_CMP_FN
(c⁄° *
a_
, c⁄° *
b_
) \

116 
ty≥1
 c⁄° *
a
 = 
a_
; \

117 
ty≥2
 c⁄° *
b
 = 
b_
; \

118  
nm
##
	`_cmp
(
a
,
b
); \

120 
ty≥2
 *
OBJ_b£¨ch_
##
	`nm
(
ty≥1
 *
key
,Åy≥2 c⁄° *
ba£
, 
num
) \

122  (
ty≥2
 *)
	`OBJ_b£¨ch_
(
key
, 
ba£
, 
num
, (type2), \

123 
nm
##
_cmp_BSEARCH_CMP_FN
); \

125 
	`dummy_¥ŸŸy≥
()

	)

127 
	#IMPLEMENT_OBJ_BSEARCH_GLOBAL_CMP_FN
(
ty≥1
, 
ty≥2
, 
nm
) \

128 
nm
##
	`_cmp_BSEARCH_CMP_FN
(c⁄° *
a_
, c⁄° *
b_
) \

130 
ty≥1
 c⁄° *
a
 = 
a_
; \

131 
ty≥2
 c⁄° *
b
 = 
b_
; \

132  
nm
##
	`_cmp
(
a
,
b
); \

134 
ty≥2
 *
OBJ_b£¨ch_
##
	`nm
(
ty≥1
 *
key
,Åy≥2 c⁄° *
ba£
, 
num
) \

136  (
ty≥2
 *)
	`OBJ_b£¨ch_
(
key
, 
ba£
, 
num
, (type2), \

137 
nm
##
_cmp_BSEARCH_CMP_FN
); \

139 
	`dummy_¥ŸŸy≥
()

	)

141 
	#OBJ_b£¨ch
(
ty≥1
,
key
,
ty≥2
,
ba£
,
num
,
cmp
) \

142 ((
ty≥2
 *)
	`OBJ_b£¨ch_
(
	`CHECKED_PTR_OF
(
ty≥1
,
key
),CHECKED_PTR_OF—y≥2,
ba£
), \

143 
num
,(
ty≥2
), \

144 (()
	`CHECKED_PTR_OF
(
ty≥1
,
cmp
##
_ty≥_1
), \

145 ()
	`CHECKED_PTR_OF
(
ty≥2
,
cmp
##
_ty≥_2
), \

146 
cmp
##
_BSEARCH_CMP_FN
)))

	)

148 
	#OBJ_b£¨ch_ex
(
ty≥1
,
key
,
ty≥2
,
ba£
,
num
,
cmp
,
Êags
) \

149 ((
ty≥2
 *)
	`OBJ_b£¨ch_ex_
(
	`CHECKED_PTR_OF
(
ty≥1
,
key
),CHECKED_PTR_OF—y≥2,
ba£
), \

150 
num
,(
ty≥2
), \

151 (()
	`CHECKED_PTR_OF
(
ty≥1
,
cmp
##
_ty≥_1
), \

152 ()
ty≥_2
=
	`CHECKED_PTR_OF
(
ty≥2
,
cmp
##
_ty≥_2
), \

153 
cmp
##
_BSEARCH_CMP_FN
)),
Êags
)

	)

155 
OBJ_√w_nid
(
num
);

156 
OBJ_add_obje˘
(c⁄° 
ASN1_OBJECT
 *
obj
);

157 
OBJ_¸óã
(c⁄° *
oid
, c⁄° *
¢
, c⁄° *
 
);

158 #i‡
OPENSSL_API_COMPAT
 < 0x10100000L

159 
	#OBJ_˛ónup
(Ë0Ë

	)

161 
OBJ_¸óã_obje˘s
(
BIO
 *
ö
);

163 
size_t
 
OBJ_Àngth
(c⁄° 
ASN1_OBJECT
 *
obj
);

164 c⁄° *
OBJ_gë0_d©a
(c⁄° 
ASN1_OBJECT
 *
obj
);

166 
OBJ_föd_sigid_Ægs
(
signid
, *
pdig_nid
, *
µkey_nid
);

167 
OBJ_föd_sigid_by_Ægs
(*
psignid
, 
dig_nid
, 
pkey_nid
);

168 
OBJ_add_sigid
(
signid
, 
dig_id
, 
pkey_id
);

169 
OBJ_sigid_‰ì
();

172 #ifde‡ 
__˝lu•lus


	@/usr/include/openssl/pkcs7err.h

11 #i‚de‡
HEADER_PKCS7ERR_H


12 
	#HEADER_PKCS7ERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_PKCS7_°rögs
();

26 
	#PKCS7_F_DO_PKCS7_SIGNED_ATTRIB
 136

	)

27 
	#PKCS7_F_PKCS7_ADD0_ATTRIB_SIGNING_TIME
 135

	)

28 
	#PKCS7_F_PKCS7_ADD_ATTRIB_SMIMECAP
 118

	)

29 
	#PKCS7_F_PKCS7_ADD_CERTIFICATE
 100

	)

30 
	#PKCS7_F_PKCS7_ADD_CRL
 101

	)

31 
	#PKCS7_F_PKCS7_ADD_RECIPIENT_INFO
 102

	)

32 
	#PKCS7_F_PKCS7_ADD_SIGNATURE
 131

	)

33 
	#PKCS7_F_PKCS7_ADD_SIGNER
 103

	)

34 
	#PKCS7_F_PKCS7_BIO_ADD_DIGEST
 125

	)

35 
	#PKCS7_F_PKCS7_COPY_EXISTING_DIGEST
 138

	)

36 
	#PKCS7_F_PKCS7_CTRL
 104

	)

37 
	#PKCS7_F_PKCS7_DATADECODE
 112

	)

38 
	#PKCS7_F_PKCS7_DATAFINAL
 128

	)

39 
	#PKCS7_F_PKCS7_DATAINIT
 105

	)

40 
	#PKCS7_F_PKCS7_DATAVERIFY
 107

	)

41 
	#PKCS7_F_PKCS7_DECRYPT
 114

	)

42 
	#PKCS7_F_PKCS7_DECRYPT_RINFO
 133

	)

43 
	#PKCS7_F_PKCS7_ENCODE_RINFO
 132

	)

44 
	#PKCS7_F_PKCS7_ENCRYPT
 115

	)

45 
	#PKCS7_F_PKCS7_FINAL
 134

	)

46 
	#PKCS7_F_PKCS7_FIND_DIGEST
 127

	)

47 
	#PKCS7_F_PKCS7_GET0_SIGNERS
 124

	)

48 
	#PKCS7_F_PKCS7_RECIP_INFO_SET
 130

	)

49 
	#PKCS7_F_PKCS7_SET_CIPHER
 108

	)

50 
	#PKCS7_F_PKCS7_SET_CONTENT
 109

	)

51 
	#PKCS7_F_PKCS7_SET_DIGEST
 126

	)

52 
	#PKCS7_F_PKCS7_SET_TYPE
 110

	)

53 
	#PKCS7_F_PKCS7_SIGN
 116

	)

54 
	#PKCS7_F_PKCS7_SIGNATUREVERIFY
 113

	)

55 
	#PKCS7_F_PKCS7_SIGNER_INFO_SET
 129

	)

56 
	#PKCS7_F_PKCS7_SIGNER_INFO_SIGN
 139

	)

57 
	#PKCS7_F_PKCS7_SIGN_ADD_SIGNER
 137

	)

58 
	#PKCS7_F_PKCS7_SIMPLE_SMIMECAP
 119

	)

59 
	#PKCS7_F_PKCS7_VERIFY
 117

	)

64 
	#PKCS7_R_CERTIFICATE_VERIFY_ERROR
 117

	)

65 
	#PKCS7_R_CIPHER_HAS_NO_OBJECT_IDENTIFIER
 144

	)

66 
	#PKCS7_R_CIPHER_NOT_INITIALIZED
 116

	)

67 
	#PKCS7_R_CONTENT_AND_DATA_PRESENT
 118

	)

68 
	#PKCS7_R_CTRL_ERROR
 152

	)

69 
	#PKCS7_R_DECRYPT_ERROR
 119

	)

70 
	#PKCS7_R_DIGEST_FAILURE
 101

	)

71 
	#PKCS7_R_ENCRYPTION_CTRL_FAILURE
 149

	)

72 
	#PKCS7_R_ENCRYPTION_NOT_SUPPORTED_FOR_THIS_KEY_TYPE
 150

	)

73 
	#PKCS7_R_ERROR_ADDING_RECIPIENT
 120

	)

74 
	#PKCS7_R_ERROR_SETTING_CIPHER
 121

	)

75 
	#PKCS7_R_INVALID_NULL_POINTER
 143

	)

76 
	#PKCS7_R_INVALID_SIGNED_DATA_TYPE
 155

	)

77 
	#PKCS7_R_NO_CONTENT
 122

	)

78 
	#PKCS7_R_NO_DEFAULT_DIGEST
 151

	)

79 
	#PKCS7_R_NO_MATCHING_DIGEST_TYPE_FOUND
 154

	)

80 
	#PKCS7_R_NO_RECIPIENT_MATCHES_CERTIFICATE
 115

	)

81 
	#PKCS7_R_NO_SIGNATURES_ON_DATA
 123

	)

82 
	#PKCS7_R_NO_SIGNERS
 142

	)

83 
	#PKCS7_R_OPERATION_NOT_SUPPORTED_ON_THIS_TYPE
 104

	)

84 
	#PKCS7_R_PKCS7_ADD_SIGNATURE_ERROR
 124

	)

85 
	#PKCS7_R_PKCS7_ADD_SIGNER_ERROR
 153

	)

86 
	#PKCS7_R_PKCS7_DATASIGN
 145

	)

87 
	#PKCS7_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE
 127

	)

88 
	#PKCS7_R_SIGNATURE_FAILURE
 105

	)

89 
	#PKCS7_R_SIGNER_CERTIFICATE_NOT_FOUND
 128

	)

90 
	#PKCS7_R_SIGNING_CTRL_FAILURE
 147

	)

91 
	#PKCS7_R_SIGNING_NOT_SUPPORTED_FOR_THIS_KEY_TYPE
 148

	)

92 
	#PKCS7_R_SMIME_TEXT_ERROR
 129

	)

93 
	#PKCS7_R_UNABLE_TO_FIND_CERTIFICATE
 106

	)

94 
	#PKCS7_R_UNABLE_TO_FIND_MEM_BIO
 107

	)

95 
	#PKCS7_R_UNABLE_TO_FIND_MESSAGE_DIGEST
 108

	)

96 
	#PKCS7_R_UNKNOWN_DIGEST_TYPE
 109

	)

97 
	#PKCS7_R_UNKNOWN_OPERATION
 110

	)

98 
	#PKCS7_R_UNSUPPORTED_CIPHER_TYPE
 111

	)

99 
	#PKCS7_R_UNSUPPORTED_CONTENT_TYPE
 112

	)

100 
	#PKCS7_R_WRONG_CONTENT_TYPE
 113

	)

101 
	#PKCS7_R_WRONG_PKCS7_TYPE
 114

	)

	@/usr/include/openssl/rsaerr.h

11 #i‚de‡
HEADER_RSAERR_H


12 
	#HEADER_RSAERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_RSA_°rögs
();

26 
	#RSA_F_CHECK_PADDING_MD
 140

	)

27 
	#RSA_F_ENCODE_PKCS1
 146

	)

28 
	#RSA_F_INT_RSA_VERIFY
 145

	)

29 
	#RSA_F_OLD_RSA_PRIV_DECODE
 147

	)

30 
	#RSA_F_PKEY_PSS_INIT
 165

	)

31 
	#RSA_F_PKEY_RSA_CTRL
 143

	)

32 
	#RSA_F_PKEY_RSA_CTRL_STR
 144

	)

33 
	#RSA_F_PKEY_RSA_SIGN
 142

	)

34 
	#RSA_F_PKEY_RSA_VERIFY
 149

	)

35 
	#RSA_F_PKEY_RSA_VERIFYRECOVER
 141

	)

36 
	#RSA_F_RSA_ALGOR_TO_MD
 156

	)

37 
	#RSA_F_RSA_BUILTIN_KEYGEN
 129

	)

38 
	#RSA_F_RSA_CHECK_KEY
 123

	)

39 
	#RSA_F_RSA_CHECK_KEY_EX
 160

	)

40 
	#RSA_F_RSA_CMS_DECRYPT
 159

	)

41 
	#RSA_F_RSA_CMS_VERIFY
 158

	)

42 
	#RSA_F_RSA_ITEM_VERIFY
 148

	)

43 
	#RSA_F_RSA_METH_DUP
 161

	)

44 
	#RSA_F_RSA_METH_NEW
 162

	)

45 
	#RSA_F_RSA_METH_SET1_NAME
 163

	)

46 
	#RSA_F_RSA_MGF1_TO_MD
 157

	)

47 
	#RSA_F_RSA_MULTIP_INFO_NEW
 166

	)

48 
	#RSA_F_RSA_NEW_METHOD
 106

	)

49 
	#RSA_F_RSA_NULL
 124

	)

50 
	#RSA_F_RSA_NULL_PRIVATE_DECRYPT
 132

	)

51 
	#RSA_F_RSA_NULL_PRIVATE_ENCRYPT
 133

	)

52 
	#RSA_F_RSA_NULL_PUBLIC_DECRYPT
 134

	)

53 
	#RSA_F_RSA_NULL_PUBLIC_ENCRYPT
 135

	)

54 
	#RSA_F_RSA_OSSL_PRIVATE_DECRYPT
 101

	)

55 
	#RSA_F_RSA_OSSL_PRIVATE_ENCRYPT
 102

	)

56 
	#RSA_F_RSA_OSSL_PUBLIC_DECRYPT
 103

	)

57 
	#RSA_F_RSA_OSSL_PUBLIC_ENCRYPT
 104

	)

58 
	#RSA_F_RSA_PADDING_ADD_NONE
 107

	)

59 
	#RSA_F_RSA_PADDING_ADD_PKCS1_OAEP
 121

	)

60 
	#RSA_F_RSA_PADDING_ADD_PKCS1_OAEP_MGF1
 154

	)

61 
	#RSA_F_RSA_PADDING_ADD_PKCS1_PSS
 125

	)

62 
	#RSA_F_RSA_PADDING_ADD_PKCS1_PSS_MGF1
 152

	)

63 
	#RSA_F_RSA_PADDING_ADD_PKCS1_TYPE_1
 108

	)

64 
	#RSA_F_RSA_PADDING_ADD_PKCS1_TYPE_2
 109

	)

65 
	#RSA_F_RSA_PADDING_ADD_SSLV23
 110

	)

66 
	#RSA_F_RSA_PADDING_ADD_X931
 127

	)

67 
	#RSA_F_RSA_PADDING_CHECK_NONE
 111

	)

68 
	#RSA_F_RSA_PADDING_CHECK_PKCS1_OAEP
 122

	)

69 
	#RSA_F_RSA_PADDING_CHECK_PKCS1_OAEP_MGF1
 153

	)

70 
	#RSA_F_RSA_PADDING_CHECK_PKCS1_TYPE_1
 112

	)

71 
	#RSA_F_RSA_PADDING_CHECK_PKCS1_TYPE_2
 113

	)

72 
	#RSA_F_RSA_PADDING_CHECK_SSLV23
 114

	)

73 
	#RSA_F_RSA_PADDING_CHECK_X931
 128

	)

74 
	#RSA_F_RSA_PARAM_DECODE
 164

	)

75 
	#RSA_F_RSA_PRINT
 115

	)

76 
	#RSA_F_RSA_PRINT_FP
 116

	)

77 
	#RSA_F_RSA_PRIV_DECODE
 150

	)

78 
	#RSA_F_RSA_PRIV_ENCODE
 138

	)

79 
	#RSA_F_RSA_PSS_GET_PARAM
 151

	)

80 
	#RSA_F_RSA_PSS_TO_CTX
 155

	)

81 
	#RSA_F_RSA_PUB_DECODE
 139

	)

82 
	#RSA_F_RSA_SETUP_BLINDING
 136

	)

83 
	#RSA_F_RSA_SIGN
 117

	)

84 
	#RSA_F_RSA_SIGN_ASN1_OCTET_STRING
 118

	)

85 
	#RSA_F_RSA_VERIFY
 119

	)

86 
	#RSA_F_RSA_VERIFY_ASN1_OCTET_STRING
 120

	)

87 
	#RSA_F_RSA_VERIFY_PKCS1_PSS_MGF1
 126

	)

88 
	#RSA_F_SETUP_TBUF
 167

	)

93 
	#RSA_R_ALGORITHM_MISMATCH
 100

	)

94 
	#RSA_R_BAD_E_VALUE
 101

	)

95 
	#RSA_R_BAD_FIXED_HEADER_DECRYPT
 102

	)

96 
	#RSA_R_BAD_PAD_BYTE_COUNT
 103

	)

97 
	#RSA_R_BAD_SIGNATURE
 104

	)

98 
	#RSA_R_BLOCK_TYPE_IS_NOT_01
 106

	)

99 
	#RSA_R_BLOCK_TYPE_IS_NOT_02
 107

	)

100 
	#RSA_R_DATA_GREATER_THAN_MOD_LEN
 108

	)

101 
	#RSA_R_DATA_TOO_LARGE
 109

	)

102 
	#RSA_R_DATA_TOO_LARGE_FOR_KEY_SIZE
 110

	)

103 
	#RSA_R_DATA_TOO_LARGE_FOR_MODULUS
 132

	)

104 
	#RSA_R_DATA_TOO_SMALL
 111

	)

105 
	#RSA_R_DATA_TOO_SMALL_FOR_KEY_SIZE
 122

	)

106 
	#RSA_R_DIGEST_DOES_NOT_MATCH
 158

	)

107 
	#RSA_R_DIGEST_NOT_ALLOWED
 145

	)

108 
	#RSA_R_DIGEST_TOO_BIG_FOR_RSA_KEY
 112

	)

109 
	#RSA_R_DMP1_NOT_CONGRUENT_TO_D
 124

	)

110 
	#RSA_R_DMQ1_NOT_CONGRUENT_TO_D
 125

	)

111 
	#RSA_R_D_E_NOT_CONGRUENT_TO_1
 123

	)

112 
	#RSA_R_FIRST_OCTET_INVALID
 133

	)

113 
	#RSA_R_ILLEGAL_OR_UNSUPPORTED_PADDING_MODE
 144

	)

114 
	#RSA_R_INVALID_DIGEST
 157

	)

115 
	#RSA_R_INVALID_DIGEST_LENGTH
 143

	)

116 
	#RSA_R_INVALID_HEADER
 137

	)

117 
	#RSA_R_INVALID_LABEL
 160

	)

118 
	#RSA_R_INVALID_MESSAGE_LENGTH
 131

	)

119 
	#RSA_R_INVALID_MGF1_MD
 156

	)

120 
	#RSA_R_INVALID_MULTI_PRIME_KEY
 167

	)

121 
	#RSA_R_INVALID_OAEP_PARAMETERS
 161

	)

122 
	#RSA_R_INVALID_PADDING
 138

	)

123 
	#RSA_R_INVALID_PADDING_MODE
 141

	)

124 
	#RSA_R_INVALID_PSS_PARAMETERS
 149

	)

125 
	#RSA_R_INVALID_PSS_SALTLEN
 146

	)

126 
	#RSA_R_INVALID_SALT_LENGTH
 150

	)

127 
	#RSA_R_INVALID_TRAILER
 139

	)

128 
	#RSA_R_INVALID_X931_DIGEST
 142

	)

129 
	#RSA_R_IQMP_NOT_INVERSE_OF_Q
 126

	)

130 
	#RSA_R_KEY_PRIME_NUM_INVALID
 165

	)

131 
	#RSA_R_KEY_SIZE_TOO_SMALL
 120

	)

132 
	#RSA_R_LAST_OCTET_INVALID
 134

	)

133 
	#RSA_R_MISSING_PRIVATE_KEY
 179

	)

134 
	#RSA_R_MGF1_DIGEST_NOT_ALLOWED
 152

	)

135 
	#RSA_R_MODULUS_TOO_LARGE
 105

	)

136 
	#RSA_R_MP_COEFFICIENT_NOT_INVERSE_OF_R
 168

	)

137 
	#RSA_R_MP_EXPONENT_NOT_CONGRUENT_TO_D
 169

	)

138 
	#RSA_R_MP_R_NOT_PRIME
 170

	)

139 
	#RSA_R_NO_PUBLIC_EXPONENT
 140

	)

140 
	#RSA_R_NULL_BEFORE_BLOCK_MISSING
 113

	)

141 
	#RSA_R_N_DOES_NOT_EQUAL_PRODUCT_OF_PRIMES
 172

	)

142 
	#RSA_R_N_DOES_NOT_EQUAL_P_Q
 127

	)

143 
	#RSA_R_OAEP_DECODING_ERROR
 121

	)

144 
	#RSA_R_OPERATION_NOT_SUPPORTED_FOR_THIS_KEYTYPE
 148

	)

145 
	#RSA_R_PADDING_CHECK_FAILED
 114

	)

146 
	#RSA_R_PKCS_DECODING_ERROR
 159

	)

147 
	#RSA_R_PSS_SALTLEN_TOO_SMALL
 164

	)

148 
	#RSA_R_P_NOT_PRIME
 128

	)

149 
	#RSA_R_Q_NOT_PRIME
 129

	)

150 
	#RSA_R_RSA_OPERATIONS_NOT_SUPPORTED
 130

	)

151 
	#RSA_R_SLEN_CHECK_FAILED
 136

	)

152 
	#RSA_R_SLEN_RECOVERY_FAILED
 135

	)

153 
	#RSA_R_SSLV3_ROLLBACK_ATTACK
 115

	)

154 
	#RSA_R_THE_ASN1_OBJECT_IDENTIFIER_IS_NOT_KNOWN_FOR_THIS_MD
 116

	)

155 
	#RSA_R_UNKNOWN_ALGORITHM_TYPE
 117

	)

156 
	#RSA_R_UNKNOWN_DIGEST
 166

	)

157 
	#RSA_R_UNKNOWN_MASK_DIGEST
 151

	)

158 
	#RSA_R_UNKNOWN_PADDING_TYPE
 118

	)

159 
	#RSA_R_UNSUPPORTED_ENCRYPTION_TYPE
 162

	)

160 
	#RSA_R_UNSUPPORTED_LABEL_SOURCE
 163

	)

161 
	#RSA_R_UNSUPPORTED_MASK_ALGORITHM
 153

	)

162 
	#RSA_R_UNSUPPORTED_MASK_PARAMETER
 154

	)

163 
	#RSA_R_UNSUPPORTED_SIGNATURE_TYPE
 155

	)

164 
	#RSA_R_VALUE_MISSING
 147

	)

165 
	#RSA_R_WRONG_SIGNATURE_LENGTH
 119

	)

	@/usr/include/openssl/bnerr.h

11 #i‚de‡
HEADER_BNERR_H


12 
	#HEADER_BNERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_BN_°rögs
();

26 
	#BN_F_BNRAND
 127

	)

27 
	#BN_F_BNRAND_RANGE
 138

	)

28 
	#BN_F_BN_BLINDING_CONVERT_EX
 100

	)

29 
	#BN_F_BN_BLINDING_CREATE_PARAM
 128

	)

30 
	#BN_F_BN_BLINDING_INVERT_EX
 101

	)

31 
	#BN_F_BN_BLINDING_NEW
 102

	)

32 
	#BN_F_BN_BLINDING_UPDATE
 103

	)

33 
	#BN_F_BN_BN2DEC
 104

	)

34 
	#BN_F_BN_BN2HEX
 105

	)

35 
	#BN_F_BN_COMPUTE_WNAF
 142

	)

36 
	#BN_F_BN_CTX_GET
 116

	)

37 
	#BN_F_BN_CTX_NEW
 106

	)

38 
	#BN_F_BN_CTX_START
 129

	)

39 
	#BN_F_BN_DIV
 107

	)

40 
	#BN_F_BN_DIV_RECP
 130

	)

41 
	#BN_F_BN_EXP
 123

	)

42 
	#BN_F_BN_EXPAND_INTERNAL
 120

	)

43 
	#BN_F_BN_GENCB_NEW
 143

	)

44 
	#BN_F_BN_GENERATE_DSA_NONCE
 140

	)

45 
	#BN_F_BN_GENERATE_PRIME_EX
 141

	)

46 
	#BN_F_BN_GF2M_MOD
 131

	)

47 
	#BN_F_BN_GF2M_MOD_EXP
 132

	)

48 
	#BN_F_BN_GF2M_MOD_MUL
 133

	)

49 
	#BN_F_BN_GF2M_MOD_SOLVE_QUAD
 134

	)

50 
	#BN_F_BN_GF2M_MOD_SOLVE_QUAD_ARR
 135

	)

51 
	#BN_F_BN_GF2M_MOD_SQR
 136

	)

52 
	#BN_F_BN_GF2M_MOD_SQRT
 137

	)

53 
	#BN_F_BN_LSHIFT
 145

	)

54 
	#BN_F_BN_MOD_EXP2_MONT
 118

	)

55 
	#BN_F_BN_MOD_EXP_MONT
 109

	)

56 
	#BN_F_BN_MOD_EXP_MONT_CONSTTIME
 124

	)

57 
	#BN_F_BN_MOD_EXP_MONT_WORD
 117

	)

58 
	#BN_F_BN_MOD_EXP_RECP
 125

	)

59 
	#BN_F_BN_MOD_EXP_SIMPLE
 126

	)

60 
	#BN_F_BN_MOD_INVERSE
 110

	)

61 
	#BN_F_BN_MOD_INVERSE_NO_BRANCH
 139

	)

62 
	#BN_F_BN_MOD_LSHIFT_QUICK
 119

	)

63 
	#BN_F_BN_MOD_SQRT
 121

	)

64 
	#BN_F_BN_MONT_CTX_NEW
 149

	)

65 
	#BN_F_BN_MPI2BN
 112

	)

66 
	#BN_F_BN_NEW
 113

	)

67 
	#BN_F_BN_POOL_GET
 147

	)

68 
	#BN_F_BN_RAND
 114

	)

69 
	#BN_F_BN_RAND_RANGE
 122

	)

70 
	#BN_F_BN_RECP_CTX_NEW
 150

	)

71 
	#BN_F_BN_RSHIFT
 146

	)

72 
	#BN_F_BN_SET_WORDS
 144

	)

73 
	#BN_F_BN_STACK_PUSH
 148

	)

74 
	#BN_F_BN_USUB
 115

	)

79 
	#BN_R_ARG2_LT_ARG3
 100

	)

80 
	#BN_R_BAD_RECIPROCAL
 101

	)

81 
	#BN_R_BIGNUM_TOO_LONG
 114

	)

82 
	#BN_R_BITS_TOO_SMALL
 118

	)

83 
	#BN_R_CALLED_WITH_EVEN_MODULUS
 102

	)

84 
	#BN_R_DIV_BY_ZERO
 103

	)

85 
	#BN_R_ENCODING_ERROR
 104

	)

86 
	#BN_R_EXPAND_ON_STATIC_BIGNUM_DATA
 105

	)

87 
	#BN_R_INPUT_NOT_REDUCED
 110

	)

88 
	#BN_R_INVALID_LENGTH
 106

	)

89 
	#BN_R_INVALID_RANGE
 115

	)

90 
	#BN_R_INVALID_SHIFT
 119

	)

91 
	#BN_R_NOT_A_SQUARE
 111

	)

92 
	#BN_R_NOT_INITIALIZED
 107

	)

93 
	#BN_R_NO_INVERSE
 108

	)

94 
	#BN_R_NO_SOLUTION
 116

	)

95 
	#BN_R_PRIVATE_KEY_TOO_LARGE
 117

	)

96 
	#BN_R_P_IS_NOT_PRIME
 112

	)

97 
	#BN_R_TOO_MANY_ITERATIONS
 113

	)

98 
	#BN_R_TOO_MANY_TEMPORARY_VARIABLES
 109

	)

	@/usr/include/openssl/obj_mac.h

12 
	#SN_undef
 "UNDEF"

	)

13 
	#LN_undef
 "undeföed"

	)

14 
	#NID_undef
 0

	)

15 
	#OBJ_undef
 0L

	)

17 
	#SN_ôu_t
 "ITU-T"

	)

18 
	#LN_ôu_t
 "ôu-t"

	)

19 
	#NID_ôu_t
 645

	)

20 
	#OBJ_ôu_t
 0L

	)

22 
	#NID_ccôt
 404

	)

23 
	#OBJ_ccôt
 
OBJ_ôu_t


	)

25 
	#SN_iso
 "ISO"

	)

26 
	#LN_iso
 "iso"

	)

27 
	#NID_iso
 181

	)

28 
	#OBJ_iso
 1L

	)

30 
	#SN_joöt_iso_ôu_t
 "JOINT-ISO-ITU-T"

	)

31 
	#LN_joöt_iso_ôu_t
 "joöt-iso-ôu-t"

	)

32 
	#NID_joöt_iso_ôu_t
 646

	)

33 
	#OBJ_joöt_iso_ôu_t
 2L

	)

35 
	#NID_joöt_iso_ccôt
 393

	)

36 
	#OBJ_joöt_iso_ccôt
 
OBJ_joöt_iso_ôu_t


	)

38 
	#SN_membî_body
 "membî-body"

	)

39 
	#LN_membî_body
 "ISO Membî Body"

	)

40 
	#NID_membî_body
 182

	)

41 
	#OBJ_membî_body
 
OBJ_iso
,2L

	)

43 
	#SN_idítifõd_‹g™iz©i⁄
 "idítifõd-‹g™iz©i⁄"

	)

44 
	#NID_idítifõd_‹g™iz©i⁄
 676

	)

45 
	#OBJ_idítifõd_‹g™iz©i⁄
 
OBJ_iso
,3L

	)

47 
	#SN_hmac_md5
 "HMAC-MD5"

	)

48 
	#LN_hmac_md5
 "hmac-md5"

	)

49 
	#NID_hmac_md5
 780

	)

50 
	#OBJ_hmac_md5
 
OBJ_idítifõd_‹g™iz©i⁄
,6L,1L,5L,5L,8L,1L,1L

	)

52 
	#SN_hmac_sha1
 "HMAC-SHA1"

	)

53 
	#LN_hmac_sha1
 "hmac-sha1"

	)

54 
	#NID_hmac_sha1
 781

	)

55 
	#OBJ_hmac_sha1
 
OBJ_idítifõd_‹g™iz©i⁄
,6L,1L,5L,5L,8L,1L,2L

	)

57 
	#SN_x509ExtAdmissi⁄
 "x509ExtAdmissi⁄"

	)

58 
	#LN_x509ExtAdmissi⁄
 "Pro„ssi⁄Æ Inf‹m©i⁄ o∏basi†f‹ Admissi⁄"

	)

59 
	#NID_x509ExtAdmissi⁄
 1093

	)

60 
	#OBJ_x509ExtAdmissi⁄
 
OBJ_idítifõd_‹g™iz©i⁄
,36L,8L,3L,3L

	)

62 
	#SN_˚πicom_¨c
 "˚πicom-¨c"

	)

63 
	#NID_˚πicom_¨c
 677

	)

64 
	#OBJ_˚πicom_¨c
 
OBJ_idítifõd_‹g™iz©i⁄
,132L

	)

66 
	#SN_õì
 "õì"

	)

67 
	#NID_õì
 1170

	)

68 
	#OBJ_õì
 
OBJ_idítifõd_‹g™iz©i⁄
,111L

	)

70 
	#SN_õì_siswg
 "õì-siswg"

	)

71 
	#LN_õì_siswg
 "IEEE Securôy i¿St‹agêW‹kög Group"

	)

72 
	#NID_õì_siswg
 1171

	)

73 
	#OBJ_õì_siswg
 
OBJ_õì
,2L,1619L

	)

75 
	#SN_öã∫©i⁄Æ_‹g™iz©i⁄s
 "öã∫©i⁄Æ-‹g™iz©i⁄s"

	)

76 
	#LN_öã∫©i⁄Æ_‹g™iz©i⁄s
 "I¡î«ti⁄Æ Org™iz©i⁄s"

	)

77 
	#NID_öã∫©i⁄Æ_‹g™iz©i⁄s
 647

	)

78 
	#OBJ_öã∫©i⁄Æ_‹g™iz©i⁄s
 
OBJ_joöt_iso_ôu_t
,23L

	)

80 
	#SN_w≠
 "w≠"

	)

81 
	#NID_w≠
 678

	)

82 
	#OBJ_w≠
 
OBJ_öã∫©i⁄Æ_‹g™iz©i⁄s
,43L

	)

84 
	#SN_w≠_wsg
 "w≠-wsg"

	)

85 
	#NID_w≠_wsg
 679

	)

86 
	#OBJ_w≠_wsg
 
OBJ_w≠
,1L

	)

88 
	#SN_£À˘ed_©åibuã_ty≥s
 "£À˘ed-©åibuã-ty≥s"

	)

89 
	#LN_£À˘ed_©åibuã_ty≥s
 "Sñe˘ed Aâribuã Ty≥s"

	)

90 
	#NID_£À˘ed_©åibuã_ty≥s
 394

	)

91 
	#OBJ_£À˘ed_©åibuã_ty≥s
 
OBJ_joöt_iso_ôu_t
,5L,1L,5L

	)

93 
	#SN_˛óøn˚
 "˛óøn˚"

	)

94 
	#NID_˛óøn˚
 395

	)

95 
	#OBJ_˛óøn˚
 
OBJ_£À˘ed_©åibuã_ty≥s
,55L

	)

97 
	#SN_ISO_US
 "ISO-US"

	)

98 
	#LN_ISO_US
 "ISO US Membî Body"

	)

99 
	#NID_ISO_US
 183

	)

100 
	#OBJ_ISO_US
 
OBJ_membî_body
,840L

	)

102 
	#SN_X9_57
 "X9-57"

	)

103 
	#LN_X9_57
 "X9.57"

	)

104 
	#NID_X9_57
 184

	)

105 
	#OBJ_X9_57
 
OBJ_ISO_US
,10040L

	)

107 
	#SN_X9cm
 "X9cm"

	)

108 
	#LN_X9cm
 "X9.57 CM ?"

	)

109 
	#NID_X9cm
 185

	)

110 
	#OBJ_X9cm
 
OBJ_X9_57
,4L

	)

112 
	#SN_ISO_CN
 "ISO-CN"

	)

113 
	#LN_ISO_CN
 "ISO CN Membî Body"

	)

114 
	#NID_ISO_CN
 1140

	)

115 
	#OBJ_ISO_CN
 
OBJ_membî_body
,156L

	)

117 
	#SN_oscˇ
 "oscˇ"

	)

118 
	#NID_oscˇ
 1141

	)

119 
	#OBJ_oscˇ
 
OBJ_ISO_CN
,10197L

	)

121 
	#SN_sm_scheme
 "sm-scheme"

	)

122 
	#NID_sm_scheme
 1142

	)

123 
	#OBJ_sm_scheme
 
OBJ_oscˇ
,1L

	)

125 
	#SN_dß
 "DSA"

	)

126 
	#LN_dß
 "dßEn¸y±i⁄"

	)

127 
	#NID_dß
 116

	)

128 
	#OBJ_dß
 
OBJ_X9cm
,1L

	)

130 
	#SN_dßWôhSHA1
 "DSA-SHA1"

	)

131 
	#LN_dßWôhSHA1
 "dßWôhSHA1"

	)

132 
	#NID_dßWôhSHA1
 113

	)

133 
	#OBJ_dßWôhSHA1
 
OBJ_X9cm
,3L

	)

135 
	#SN_™si_X9_62
 "™si-X9-62"

	)

136 
	#LN_™si_X9_62
 "ANSI X9.62"

	)

137 
	#NID_™si_X9_62
 405

	)

138 
	#OBJ_™si_X9_62
 
OBJ_ISO_US
,10045L

	)

140 
	#OBJ_X9_62_id_fõldTy≥
 
OBJ_™si_X9_62
,1L

	)

142 
	#SN_X9_62_¥ime_fõld
 "¥ime-fõld"

	)

143 
	#NID_X9_62_¥ime_fõld
 406

	)

144 
	#OBJ_X9_62_¥ime_fõld
 
OBJ_X9_62_id_fõldTy≥
,1L

	)

146 
	#SN_X9_62_ch¨a˘îi°ic_two_fõld
 "ch¨a˘îi°ic-two-fõld"

	)

147 
	#NID_X9_62_ch¨a˘îi°ic_two_fõld
 407

	)

148 
	#OBJ_X9_62_ch¨a˘îi°ic_two_fõld
 
OBJ_X9_62_id_fõldTy≥
,2L

	)

150 
	#SN_X9_62_id_ch¨a˘îi°ic_two_basis
 "id-ch¨a˘îi°ic-two-basis"

	)

151 
	#NID_X9_62_id_ch¨a˘îi°ic_two_basis
 680

	)

152 
	#OBJ_X9_62_id_ch¨a˘îi°ic_two_basis
 
OBJ_X9_62_ch¨a˘îi°ic_two_fõld
,3L

	)

154 
	#SN_X9_62_⁄Basis
 "⁄Basis"

	)

155 
	#NID_X9_62_⁄Basis
 681

	)

156 
	#OBJ_X9_62_⁄Basis
 
OBJ_X9_62_id_ch¨a˘îi°ic_two_basis
,1L

	)

158 
	#SN_X9_62_çBasis
 "çBasis"

	)

159 
	#NID_X9_62_çBasis
 682

	)

160 
	#OBJ_X9_62_çBasis
 
OBJ_X9_62_id_ch¨a˘îi°ic_two_basis
,2L

	)

162 
	#SN_X9_62_µBasis
 "µBasis"

	)

163 
	#NID_X9_62_µBasis
 683

	)

164 
	#OBJ_X9_62_µBasis
 
OBJ_X9_62_id_ch¨a˘îi°ic_two_basis
,3L

	)

166 
	#OBJ_X9_62_id_publicKeyTy≥
 
OBJ_™si_X9_62
,2L

	)

168 
	#SN_X9_62_id_ecPublicKey
 "id-ecPublicKey"

	)

169 
	#NID_X9_62_id_ecPublicKey
 408

	)

170 
	#OBJ_X9_62_id_ecPublicKey
 
OBJ_X9_62_id_publicKeyTy≥
,1L

	)

172 
	#OBJ_X9_62_ñlùticCurve
 
OBJ_™si_X9_62
,3L

	)

174 
	#OBJ_X9_62_c_TwoCurve
 
OBJ_X9_62_ñlùticCurve
,0L

	)

176 
	#SN_X9_62_c2≤b163v1
 "c2≤b163v1"

	)

177 
	#NID_X9_62_c2≤b163v1
 684

	)

178 
	#OBJ_X9_62_c2≤b163v1
 
OBJ_X9_62_c_TwoCurve
,1L

	)

180 
	#SN_X9_62_c2≤b163v2
 "c2≤b163v2"

	)

181 
	#NID_X9_62_c2≤b163v2
 685

	)

182 
	#OBJ_X9_62_c2≤b163v2
 
OBJ_X9_62_c_TwoCurve
,2L

	)

184 
	#SN_X9_62_c2≤b163v3
 "c2≤b163v3"

	)

185 
	#NID_X9_62_c2≤b163v3
 686

	)

186 
	#OBJ_X9_62_c2≤b163v3
 
OBJ_X9_62_c_TwoCurve
,3L

	)

188 
	#SN_X9_62_c2≤b176v1
 "c2≤b176v1"

	)

189 
	#NID_X9_62_c2≤b176v1
 687

	)

190 
	#OBJ_X9_62_c2≤b176v1
 
OBJ_X9_62_c_TwoCurve
,4L

	)

192 
	#SN_X9_62_c2äb191v1
 "c2äb191v1"

	)

193 
	#NID_X9_62_c2äb191v1
 688

	)

194 
	#OBJ_X9_62_c2äb191v1
 
OBJ_X9_62_c_TwoCurve
,5L

	)

196 
	#SN_X9_62_c2äb191v2
 "c2äb191v2"

	)

197 
	#NID_X9_62_c2äb191v2
 689

	)

198 
	#OBJ_X9_62_c2äb191v2
 
OBJ_X9_62_c_TwoCurve
,6L

	)

200 
	#SN_X9_62_c2äb191v3
 "c2äb191v3"

	)

201 
	#NID_X9_62_c2äb191v3
 690

	)

202 
	#OBJ_X9_62_c2äb191v3
 
OBJ_X9_62_c_TwoCurve
,7L

	)

204 
	#SN_X9_62_c2⁄b191v4
 "c2⁄b191v4"

	)

205 
	#NID_X9_62_c2⁄b191v4
 691

	)

206 
	#OBJ_X9_62_c2⁄b191v4
 
OBJ_X9_62_c_TwoCurve
,8L

	)

208 
	#SN_X9_62_c2⁄b191v5
 "c2⁄b191v5"

	)

209 
	#NID_X9_62_c2⁄b191v5
 692

	)

210 
	#OBJ_X9_62_c2⁄b191v5
 
OBJ_X9_62_c_TwoCurve
,9L

	)

212 
	#SN_X9_62_c2≤b208w1
 "c2≤b208w1"

	)

213 
	#NID_X9_62_c2≤b208w1
 693

	)

214 
	#OBJ_X9_62_c2≤b208w1
 
OBJ_X9_62_c_TwoCurve
,10L

	)

216 
	#SN_X9_62_c2äb239v1
 "c2äb239v1"

	)

217 
	#NID_X9_62_c2äb239v1
 694

	)

218 
	#OBJ_X9_62_c2äb239v1
 
OBJ_X9_62_c_TwoCurve
,11L

	)

220 
	#SN_X9_62_c2äb239v2
 "c2äb239v2"

	)

221 
	#NID_X9_62_c2äb239v2
 695

	)

222 
	#OBJ_X9_62_c2äb239v2
 
OBJ_X9_62_c_TwoCurve
,12L

	)

224 
	#SN_X9_62_c2äb239v3
 "c2äb239v3"

	)

225 
	#NID_X9_62_c2äb239v3
 696

	)

226 
	#OBJ_X9_62_c2äb239v3
 
OBJ_X9_62_c_TwoCurve
,13L

	)

228 
	#SN_X9_62_c2⁄b239v4
 "c2⁄b239v4"

	)

229 
	#NID_X9_62_c2⁄b239v4
 697

	)

230 
	#OBJ_X9_62_c2⁄b239v4
 
OBJ_X9_62_c_TwoCurve
,14L

	)

232 
	#SN_X9_62_c2⁄b239v5
 "c2⁄b239v5"

	)

233 
	#NID_X9_62_c2⁄b239v5
 698

	)

234 
	#OBJ_X9_62_c2⁄b239v5
 
OBJ_X9_62_c_TwoCurve
,15L

	)

236 
	#SN_X9_62_c2≤b272w1
 "c2≤b272w1"

	)

237 
	#NID_X9_62_c2≤b272w1
 699

	)

238 
	#OBJ_X9_62_c2≤b272w1
 
OBJ_X9_62_c_TwoCurve
,16L

	)

240 
	#SN_X9_62_c2≤b304w1
 "c2≤b304w1"

	)

241 
	#NID_X9_62_c2≤b304w1
 700

	)

242 
	#OBJ_X9_62_c2≤b304w1
 
OBJ_X9_62_c_TwoCurve
,17L

	)

244 
	#SN_X9_62_c2äb359v1
 "c2äb359v1"

	)

245 
	#NID_X9_62_c2äb359v1
 701

	)

246 
	#OBJ_X9_62_c2äb359v1
 
OBJ_X9_62_c_TwoCurve
,18L

	)

248 
	#SN_X9_62_c2≤b368w1
 "c2≤b368w1"

	)

249 
	#NID_X9_62_c2≤b368w1
 702

	)

250 
	#OBJ_X9_62_c2≤b368w1
 
OBJ_X9_62_c_TwoCurve
,19L

	)

252 
	#SN_X9_62_c2äb431r1
 "c2äb431r1"

	)

253 
	#NID_X9_62_c2äb431r1
 703

	)

254 
	#OBJ_X9_62_c2äb431r1
 
OBJ_X9_62_c_TwoCurve
,20L

	)

256 
	#OBJ_X9_62_¥imeCurve
 
OBJ_X9_62_ñlùticCurve
,1L

	)

258 
	#SN_X9_62_¥ime192v1
 "¥ime192v1"

	)

259 
	#NID_X9_62_¥ime192v1
 409

	)

260 
	#OBJ_X9_62_¥ime192v1
 
OBJ_X9_62_¥imeCurve
,1L

	)

262 
	#SN_X9_62_¥ime192v2
 "¥ime192v2"

	)

263 
	#NID_X9_62_¥ime192v2
 410

	)

264 
	#OBJ_X9_62_¥ime192v2
 
OBJ_X9_62_¥imeCurve
,2L

	)

266 
	#SN_X9_62_¥ime192v3
 "¥ime192v3"

	)

267 
	#NID_X9_62_¥ime192v3
 411

	)

268 
	#OBJ_X9_62_¥ime192v3
 
OBJ_X9_62_¥imeCurve
,3L

	)

270 
	#SN_X9_62_¥ime239v1
 "¥ime239v1"

	)

271 
	#NID_X9_62_¥ime239v1
 412

	)

272 
	#OBJ_X9_62_¥ime239v1
 
OBJ_X9_62_¥imeCurve
,4L

	)

274 
	#SN_X9_62_¥ime239v2
 "¥ime239v2"

	)

275 
	#NID_X9_62_¥ime239v2
 413

	)

276 
	#OBJ_X9_62_¥ime239v2
 
OBJ_X9_62_¥imeCurve
,5L

	)

278 
	#SN_X9_62_¥ime239v3
 "¥ime239v3"

	)

279 
	#NID_X9_62_¥ime239v3
 414

	)

280 
	#OBJ_X9_62_¥ime239v3
 
OBJ_X9_62_¥imeCurve
,6L

	)

282 
	#SN_X9_62_¥ime256v1
 "¥ime256v1"

	)

283 
	#NID_X9_62_¥ime256v1
 415

	)

284 
	#OBJ_X9_62_¥ime256v1
 
OBJ_X9_62_¥imeCurve
,7L

	)

286 
	#OBJ_X9_62_id_ecSigTy≥
 
OBJ_™si_X9_62
,4L

	)

288 
	#SN_ecdß_wôh_SHA1
 "ecdß-wôh-SHA1"

	)

289 
	#NID_ecdß_wôh_SHA1
 416

	)

290 
	#OBJ_ecdß_wôh_SHA1
 
OBJ_X9_62_id_ecSigTy≥
,1L

	)

292 
	#SN_ecdß_wôh_Recommíded
 "ecdß-wôh-Recommíded"

	)

293 
	#NID_ecdß_wôh_Recommíded
 791

	)

294 
	#OBJ_ecdß_wôh_Recommíded
 
OBJ_X9_62_id_ecSigTy≥
,2L

	)

296 
	#SN_ecdß_wôh_S≥cifõd
 "ecdß-wôh-S≥cifõd"

	)

297 
	#NID_ecdß_wôh_S≥cifõd
 792

	)

298 
	#OBJ_ecdß_wôh_S≥cifõd
 
OBJ_X9_62_id_ecSigTy≥
,3L

	)

300 
	#SN_ecdß_wôh_SHA224
 "ecdß-wôh-SHA224"

	)

301 
	#NID_ecdß_wôh_SHA224
 793

	)

302 
	#OBJ_ecdß_wôh_SHA224
 
OBJ_ecdß_wôh_S≥cifõd
,1L

	)

304 
	#SN_ecdß_wôh_SHA256
 "ecdß-wôh-SHA256"

	)

305 
	#NID_ecdß_wôh_SHA256
 794

	)

306 
	#OBJ_ecdß_wôh_SHA256
 
OBJ_ecdß_wôh_S≥cifõd
,2L

	)

308 
	#SN_ecdß_wôh_SHA384
 "ecdß-wôh-SHA384"

	)

309 
	#NID_ecdß_wôh_SHA384
 795

	)

310 
	#OBJ_ecdß_wôh_SHA384
 
OBJ_ecdß_wôh_S≥cifõd
,3L

	)

312 
	#SN_ecdß_wôh_SHA512
 "ecdß-wôh-SHA512"

	)

313 
	#NID_ecdß_wôh_SHA512
 796

	)

314 
	#OBJ_ecdß_wôh_SHA512
 
OBJ_ecdß_wôh_S≥cifõd
,4L

	)

316 
	#OBJ_£cg_ñlùticCurve
 
OBJ_˚πicom_¨c
,0L

	)

318 
	#SN_£˝112r1
 "£˝112r1"

	)

319 
	#NID_£˝112r1
 704

	)

320 
	#OBJ_£˝112r1
 
OBJ_£cg_ñlùticCurve
,6L

	)

322 
	#SN_£˝112r2
 "£˝112r2"

	)

323 
	#NID_£˝112r2
 705

	)

324 
	#OBJ_£˝112r2
 
OBJ_£cg_ñlùticCurve
,7L

	)

326 
	#SN_£˝128r1
 "£˝128r1"

	)

327 
	#NID_£˝128r1
 706

	)

328 
	#OBJ_£˝128r1
 
OBJ_£cg_ñlùticCurve
,28L

	)

330 
	#SN_£˝128r2
 "£˝128r2"

	)

331 
	#NID_£˝128r2
 707

	)

332 
	#OBJ_£˝128r2
 
OBJ_£cg_ñlùticCurve
,29L

	)

334 
	#SN_£˝160k1
 "£˝160k1"

	)

335 
	#NID_£˝160k1
 708

	)

336 
	#OBJ_£˝160k1
 
OBJ_£cg_ñlùticCurve
,9L

	)

338 
	#SN_£˝160r1
 "£˝160r1"

	)

339 
	#NID_£˝160r1
 709

	)

340 
	#OBJ_£˝160r1
 
OBJ_£cg_ñlùticCurve
,8L

	)

342 
	#SN_£˝160r2
 "£˝160r2"

	)

343 
	#NID_£˝160r2
 710

	)

344 
	#OBJ_£˝160r2
 
OBJ_£cg_ñlùticCurve
,30L

	)

346 
	#SN_£˝192k1
 "£˝192k1"

	)

347 
	#NID_£˝192k1
 711

	)

348 
	#OBJ_£˝192k1
 
OBJ_£cg_ñlùticCurve
,31L

	)

350 
	#SN_£˝224k1
 "£˝224k1"

	)

351 
	#NID_£˝224k1
 712

	)

352 
	#OBJ_£˝224k1
 
OBJ_£cg_ñlùticCurve
,32L

	)

354 
	#SN_£˝224r1
 "£˝224r1"

	)

355 
	#NID_£˝224r1
 713

	)

356 
	#OBJ_£˝224r1
 
OBJ_£cg_ñlùticCurve
,33L

	)

358 
	#SN_£˝256k1
 "£˝256k1"

	)

359 
	#NID_£˝256k1
 714

	)

360 
	#OBJ_£˝256k1
 
OBJ_£cg_ñlùticCurve
,10L

	)

362 
	#SN_£˝384r1
 "£˝384r1"

	)

363 
	#NID_£˝384r1
 715

	)

364 
	#OBJ_£˝384r1
 
OBJ_£cg_ñlùticCurve
,34L

	)

366 
	#SN_£˝521r1
 "£˝521r1"

	)

367 
	#NID_£˝521r1
 716

	)

368 
	#OBJ_£˝521r1
 
OBJ_£cg_ñlùticCurve
,35L

	)

370 
	#SN_£˘113r1
 "£˘113r1"

	)

371 
	#NID_£˘113r1
 717

	)

372 
	#OBJ_£˘113r1
 
OBJ_£cg_ñlùticCurve
,4L

	)

374 
	#SN_£˘113r2
 "£˘113r2"

	)

375 
	#NID_£˘113r2
 718

	)

376 
	#OBJ_£˘113r2
 
OBJ_£cg_ñlùticCurve
,5L

	)

378 
	#SN_£˘131r1
 "£˘131r1"

	)

379 
	#NID_£˘131r1
 719

	)

380 
	#OBJ_£˘131r1
 
OBJ_£cg_ñlùticCurve
,22L

	)

382 
	#SN_£˘131r2
 "£˘131r2"

	)

383 
	#NID_£˘131r2
 720

	)

384 
	#OBJ_£˘131r2
 
OBJ_£cg_ñlùticCurve
,23L

	)

386 
	#SN_£˘163k1
 "£˘163k1"

	)

387 
	#NID_£˘163k1
 721

	)

388 
	#OBJ_£˘163k1
 
OBJ_£cg_ñlùticCurve
,1L

	)

390 
	#SN_£˘163r1
 "£˘163r1"

	)

391 
	#NID_£˘163r1
 722

	)

392 
	#OBJ_£˘163r1
 
OBJ_£cg_ñlùticCurve
,2L

	)

394 
	#SN_£˘163r2
 "£˘163r2"

	)

395 
	#NID_£˘163r2
 723

	)

396 
	#OBJ_£˘163r2
 
OBJ_£cg_ñlùticCurve
,15L

	)

398 
	#SN_£˘193r1
 "£˘193r1"

	)

399 
	#NID_£˘193r1
 724

	)

400 
	#OBJ_£˘193r1
 
OBJ_£cg_ñlùticCurve
,24L

	)

402 
	#SN_£˘193r2
 "£˘193r2"

	)

403 
	#NID_£˘193r2
 725

	)

404 
	#OBJ_£˘193r2
 
OBJ_£cg_ñlùticCurve
,25L

	)

406 
	#SN_£˘233k1
 "£˘233k1"

	)

407 
	#NID_£˘233k1
 726

	)

408 
	#OBJ_£˘233k1
 
OBJ_£cg_ñlùticCurve
,26L

	)

410 
	#SN_£˘233r1
 "£˘233r1"

	)

411 
	#NID_£˘233r1
 727

	)

412 
	#OBJ_£˘233r1
 
OBJ_£cg_ñlùticCurve
,27L

	)

414 
	#SN_£˘239k1
 "£˘239k1"

	)

415 
	#NID_£˘239k1
 728

	)

416 
	#OBJ_£˘239k1
 
OBJ_£cg_ñlùticCurve
,3L

	)

418 
	#SN_£˘283k1
 "£˘283k1"

	)

419 
	#NID_£˘283k1
 729

	)

420 
	#OBJ_£˘283k1
 
OBJ_£cg_ñlùticCurve
,16L

	)

422 
	#SN_£˘283r1
 "£˘283r1"

	)

423 
	#NID_£˘283r1
 730

	)

424 
	#OBJ_£˘283r1
 
OBJ_£cg_ñlùticCurve
,17L

	)

426 
	#SN_£˘409k1
 "£˘409k1"

	)

427 
	#NID_£˘409k1
 731

	)

428 
	#OBJ_£˘409k1
 
OBJ_£cg_ñlùticCurve
,36L

	)

430 
	#SN_£˘409r1
 "£˘409r1"

	)

431 
	#NID_£˘409r1
 732

	)

432 
	#OBJ_£˘409r1
 
OBJ_£cg_ñlùticCurve
,37L

	)

434 
	#SN_£˘571k1
 "£˘571k1"

	)

435 
	#NID_£˘571k1
 733

	)

436 
	#OBJ_£˘571k1
 
OBJ_£cg_ñlùticCurve
,38L

	)

438 
	#SN_£˘571r1
 "£˘571r1"

	)

439 
	#NID_£˘571r1
 734

	)

440 
	#OBJ_£˘571r1
 
OBJ_£cg_ñlùticCurve
,39L

	)

442 
	#OBJ_w≠_wsg_idm_ecid
 
OBJ_w≠_wsg
,4L

	)

444 
	#SN_w≠_wsg_idm_ecid_wés1
 "w≠-wsg-idm-ecid-wés1"

	)

445 
	#NID_w≠_wsg_idm_ecid_wés1
 735

	)

446 
	#OBJ_w≠_wsg_idm_ecid_wés1
 
OBJ_w≠_wsg_idm_ecid
,1L

	)

448 
	#SN_w≠_wsg_idm_ecid_wés3
 "w≠-wsg-idm-ecid-wés3"

	)

449 
	#NID_w≠_wsg_idm_ecid_wés3
 736

	)

450 
	#OBJ_w≠_wsg_idm_ecid_wés3
 
OBJ_w≠_wsg_idm_ecid
,3L

	)

452 
	#SN_w≠_wsg_idm_ecid_wés4
 "w≠-wsg-idm-ecid-wés4"

	)

453 
	#NID_w≠_wsg_idm_ecid_wés4
 737

	)

454 
	#OBJ_w≠_wsg_idm_ecid_wés4
 
OBJ_w≠_wsg_idm_ecid
,4L

	)

456 
	#SN_w≠_wsg_idm_ecid_wés5
 "w≠-wsg-idm-ecid-wés5"

	)

457 
	#NID_w≠_wsg_idm_ecid_wés5
 738

	)

458 
	#OBJ_w≠_wsg_idm_ecid_wés5
 
OBJ_w≠_wsg_idm_ecid
,5L

	)

460 
	#SN_w≠_wsg_idm_ecid_wés6
 "w≠-wsg-idm-ecid-wés6"

	)

461 
	#NID_w≠_wsg_idm_ecid_wés6
 739

	)

462 
	#OBJ_w≠_wsg_idm_ecid_wés6
 
OBJ_w≠_wsg_idm_ecid
,6L

	)

464 
	#SN_w≠_wsg_idm_ecid_wés7
 "w≠-wsg-idm-ecid-wés7"

	)

465 
	#NID_w≠_wsg_idm_ecid_wés7
 740

	)

466 
	#OBJ_w≠_wsg_idm_ecid_wés7
 
OBJ_w≠_wsg_idm_ecid
,7L

	)

468 
	#SN_w≠_wsg_idm_ecid_wés8
 "w≠-wsg-idm-ecid-wés8"

	)

469 
	#NID_w≠_wsg_idm_ecid_wés8
 741

	)

470 
	#OBJ_w≠_wsg_idm_ecid_wés8
 
OBJ_w≠_wsg_idm_ecid
,8L

	)

472 
	#SN_w≠_wsg_idm_ecid_wés9
 "w≠-wsg-idm-ecid-wés9"

	)

473 
	#NID_w≠_wsg_idm_ecid_wés9
 742

	)

474 
	#OBJ_w≠_wsg_idm_ecid_wés9
 
OBJ_w≠_wsg_idm_ecid
,9L

	)

476 
	#SN_w≠_wsg_idm_ecid_wés10
 "w≠-wsg-idm-ecid-wés10"

	)

477 
	#NID_w≠_wsg_idm_ecid_wés10
 743

	)

478 
	#OBJ_w≠_wsg_idm_ecid_wés10
 
OBJ_w≠_wsg_idm_ecid
,10L

	)

480 
	#SN_w≠_wsg_idm_ecid_wés11
 "w≠-wsg-idm-ecid-wés11"

	)

481 
	#NID_w≠_wsg_idm_ecid_wés11
 744

	)

482 
	#OBJ_w≠_wsg_idm_ecid_wés11
 
OBJ_w≠_wsg_idm_ecid
,11L

	)

484 
	#SN_w≠_wsg_idm_ecid_wés12
 "w≠-wsg-idm-ecid-wés12"

	)

485 
	#NID_w≠_wsg_idm_ecid_wés12
 745

	)

486 
	#OBJ_w≠_wsg_idm_ecid_wés12
 
OBJ_w≠_wsg_idm_ecid
,12L

	)

488 
	#SN_ˇ°5_cbc
 "CAST5-CBC"

	)

489 
	#LN_ˇ°5_cbc
 "ˇ°5-cbc"

	)

490 
	#NID_ˇ°5_cbc
 108

	)

491 
	#OBJ_ˇ°5_cbc
 
OBJ_ISO_US
,113533L,7L,66L,10L

	)

493 
	#SN_ˇ°5_ecb
 "CAST5-ECB"

	)

494 
	#LN_ˇ°5_ecb
 "ˇ°5-ecb"

	)

495 
	#NID_ˇ°5_ecb
 109

	)

497 
	#SN_ˇ°5_cfb64
 "CAST5-CFB"

	)

498 
	#LN_ˇ°5_cfb64
 "ˇ°5-cfb"

	)

499 
	#NID_ˇ°5_cfb64
 110

	)

501 
	#SN_ˇ°5_ofb64
 "CAST5-OFB"

	)

502 
	#LN_ˇ°5_ofb64
 "ˇ°5-ofb"

	)

503 
	#NID_ˇ°5_ofb64
 111

	)

505 
	#LN_pbeWôhMD5AndCa°5_CBC
 "pbeWôhMD5AndCa°5CBC"

	)

506 
	#NID_pbeWôhMD5AndCa°5_CBC
 112

	)

507 
	#OBJ_pbeWôhMD5AndCa°5_CBC
 
OBJ_ISO_US
,113533L,7L,66L,12L

	)

509 
	#SN_id_Passw‹dBa£dMAC
 "id-Passw‹dBa£dMAC"

	)

510 
	#LN_id_Passw‹dBa£dMAC
 "∑ssw‹d ba£d MAC"

	)

511 
	#NID_id_Passw‹dBa£dMAC
 782

	)

512 
	#OBJ_id_Passw‹dBa£dMAC
 
OBJ_ISO_US
,113533L,7L,66L,13L

	)

514 
	#SN_id_DHBa£dMac
 "id-DHBa£dMac"

	)

515 
	#LN_id_DHBa£dMac
 "Diffõ-Hñlm™ ba£d MAC"

	)

516 
	#NID_id_DHBa£dMac
 783

	)

517 
	#OBJ_id_DHBa£dMac
 
OBJ_ISO_US
,113533L,7L,66L,30L

	)

519 
	#SN_rßdsi
 "rßdsi"

	)

520 
	#LN_rßdsi
 "RSA D©®Securôy, Inc."

	)

521 
	#NID_rßdsi
 1

	)

522 
	#OBJ_rßdsi
 
OBJ_ISO_US
,113549L

	)

524 
	#SN_pkcs
 "pkcs"

	)

525 
	#LN_pkcs
 "RSA D©®Securôy, Inc. PKCS"

	)

526 
	#NID_pkcs
 2

	)

527 
	#OBJ_pkcs
 
OBJ_rßdsi
,1L

	)

529 
	#SN_pkcs1
 "pkcs1"

	)

530 
	#NID_pkcs1
 186

	)

531 
	#OBJ_pkcs1
 
OBJ_pkcs
,1L

	)

533 
	#LN_rßEn¸y±i⁄
 "rßEn¸y±i⁄"

	)

534 
	#NID_rßEn¸y±i⁄
 6

	)

535 
	#OBJ_rßEn¸y±i⁄
 
OBJ_pkcs1
,1L

	)

537 
	#SN_md2WôhRSAEn¸y±i⁄
 "RSA-MD2"

	)

538 
	#LN_md2WôhRSAEn¸y±i⁄
 "md2WôhRSAEn¸y±i⁄"

	)

539 
	#NID_md2WôhRSAEn¸y±i⁄
 7

	)

540 
	#OBJ_md2WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,2L

	)

542 
	#SN_md4WôhRSAEn¸y±i⁄
 "RSA-MD4"

	)

543 
	#LN_md4WôhRSAEn¸y±i⁄
 "md4WôhRSAEn¸y±i⁄"

	)

544 
	#NID_md4WôhRSAEn¸y±i⁄
 396

	)

545 
	#OBJ_md4WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,3L

	)

547 
	#SN_md5WôhRSAEn¸y±i⁄
 "RSA-MD5"

	)

548 
	#LN_md5WôhRSAEn¸y±i⁄
 "md5WôhRSAEn¸y±i⁄"

	)

549 
	#NID_md5WôhRSAEn¸y±i⁄
 8

	)

550 
	#OBJ_md5WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,4L

	)

552 
	#SN_sha1WôhRSAEn¸y±i⁄
 "RSA-SHA1"

	)

553 
	#LN_sha1WôhRSAEn¸y±i⁄
 "sha1WôhRSAEn¸y±i⁄"

	)

554 
	#NID_sha1WôhRSAEn¸y±i⁄
 65

	)

555 
	#OBJ_sha1WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,5L

	)

557 
	#SN_rßesO´p
 "RSAES-OAEP"

	)

558 
	#LN_rßesO´p
 "rßesO´p"

	)

559 
	#NID_rßesO´p
 919

	)

560 
	#OBJ_rßesO´p
 
OBJ_pkcs1
,7L

	)

562 
	#SN_mgf1
 "MGF1"

	)

563 
	#LN_mgf1
 "mgf1"

	)

564 
	#NID_mgf1
 911

	)

565 
	#OBJ_mgf1
 
OBJ_pkcs1
,8L

	)

567 
	#SN_pS≥cifõd
 "PSPECIFIED"

	)

568 
	#LN_pS≥cifõd
 "pS≥cifõd"

	)

569 
	#NID_pS≥cifõd
 935

	)

570 
	#OBJ_pS≥cifõd
 
OBJ_pkcs1
,9L

	)

572 
	#SN_rßsßPss
 "RSASSA-PSS"

	)

573 
	#LN_rßsßPss
 "rßsßPss"

	)

574 
	#NID_rßsßPss
 912

	)

575 
	#OBJ_rßsßPss
 
OBJ_pkcs1
,10L

	)

577 
	#SN_sha256WôhRSAEn¸y±i⁄
 "RSA-SHA256"

	)

578 
	#LN_sha256WôhRSAEn¸y±i⁄
 "sha256WôhRSAEn¸y±i⁄"

	)

579 
	#NID_sha256WôhRSAEn¸y±i⁄
 668

	)

580 
	#OBJ_sha256WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,11L

	)

582 
	#SN_sha384WôhRSAEn¸y±i⁄
 "RSA-SHA384"

	)

583 
	#LN_sha384WôhRSAEn¸y±i⁄
 "sha384WôhRSAEn¸y±i⁄"

	)

584 
	#NID_sha384WôhRSAEn¸y±i⁄
 669

	)

585 
	#OBJ_sha384WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,12L

	)

587 
	#SN_sha512WôhRSAEn¸y±i⁄
 "RSA-SHA512"

	)

588 
	#LN_sha512WôhRSAEn¸y±i⁄
 "sha512WôhRSAEn¸y±i⁄"

	)

589 
	#NID_sha512WôhRSAEn¸y±i⁄
 670

	)

590 
	#OBJ_sha512WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,13L

	)

592 
	#SN_sha224WôhRSAEn¸y±i⁄
 "RSA-SHA224"

	)

593 
	#LN_sha224WôhRSAEn¸y±i⁄
 "sha224WôhRSAEn¸y±i⁄"

	)

594 
	#NID_sha224WôhRSAEn¸y±i⁄
 671

	)

595 
	#OBJ_sha224WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,14L

	)

597 
	#SN_sha512_224WôhRSAEn¸y±i⁄
 "RSA-SHA512/224"

	)

598 
	#LN_sha512_224WôhRSAEn¸y±i⁄
 "sha512-224WôhRSAEn¸y±i⁄"

	)

599 
	#NID_sha512_224WôhRSAEn¸y±i⁄
 1145

	)

600 
	#OBJ_sha512_224WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,15L

	)

602 
	#SN_sha512_256WôhRSAEn¸y±i⁄
 "RSA-SHA512/256"

	)

603 
	#LN_sha512_256WôhRSAEn¸y±i⁄
 "sha512-256WôhRSAEn¸y±i⁄"

	)

604 
	#NID_sha512_256WôhRSAEn¸y±i⁄
 1146

	)

605 
	#OBJ_sha512_256WôhRSAEn¸y±i⁄
 
OBJ_pkcs1
,16L

	)

607 
	#SN_pkcs3
 "pkcs3"

	)

608 
	#NID_pkcs3
 27

	)

609 
	#OBJ_pkcs3
 
OBJ_pkcs
,3L

	)

611 
	#LN_dhKeyAgªemít
 "dhKeyAgªemít"

	)

612 
	#NID_dhKeyAgªemít
 28

	)

613 
	#OBJ_dhKeyAgªemít
 
OBJ_pkcs3
,1L

	)

615 
	#SN_pkcs5
 "pkcs5"

	)

616 
	#NID_pkcs5
 187

	)

617 
	#OBJ_pkcs5
 
OBJ_pkcs
,5L

	)

619 
	#SN_pbeWôhMD2AndDES_CBC
 "PBE-MD2-DES"

	)

620 
	#LN_pbeWôhMD2AndDES_CBC
 "pbeWôhMD2AndDES-CBC"

	)

621 
	#NID_pbeWôhMD2AndDES_CBC
 9

	)

622 
	#OBJ_pbeWôhMD2AndDES_CBC
 
OBJ_pkcs5
,1L

	)

624 
	#SN_pbeWôhMD5AndDES_CBC
 "PBE-MD5-DES"

	)

625 
	#LN_pbeWôhMD5AndDES_CBC
 "pbeWôhMD5AndDES-CBC"

	)

626 
	#NID_pbeWôhMD5AndDES_CBC
 10

	)

627 
	#OBJ_pbeWôhMD5AndDES_CBC
 
OBJ_pkcs5
,3L

	)

629 
	#SN_pbeWôhMD2AndRC2_CBC
 "PBE-MD2-RC2-64"

	)

630 
	#LN_pbeWôhMD2AndRC2_CBC
 "pbeWôhMD2AndRC2-CBC"

	)

631 
	#NID_pbeWôhMD2AndRC2_CBC
 168

	)

632 
	#OBJ_pbeWôhMD2AndRC2_CBC
 
OBJ_pkcs5
,4L

	)

634 
	#SN_pbeWôhMD5AndRC2_CBC
 "PBE-MD5-RC2-64"

	)

635 
	#LN_pbeWôhMD5AndRC2_CBC
 "pbeWôhMD5AndRC2-CBC"

	)

636 
	#NID_pbeWôhMD5AndRC2_CBC
 169

	)

637 
	#OBJ_pbeWôhMD5AndRC2_CBC
 
OBJ_pkcs5
,6L

	)

639 
	#SN_pbeWôhSHA1AndDES_CBC
 "PBE-SHA1-DES"

	)

640 
	#LN_pbeWôhSHA1AndDES_CBC
 "pbeWôhSHA1AndDES-CBC"

	)

641 
	#NID_pbeWôhSHA1AndDES_CBC
 170

	)

642 
	#OBJ_pbeWôhSHA1AndDES_CBC
 
OBJ_pkcs5
,10L

	)

644 
	#SN_pbeWôhSHA1AndRC2_CBC
 "PBE-SHA1-RC2-64"

	)

645 
	#LN_pbeWôhSHA1AndRC2_CBC
 "pbeWôhSHA1AndRC2-CBC"

	)

646 
	#NID_pbeWôhSHA1AndRC2_CBC
 68

	)

647 
	#OBJ_pbeWôhSHA1AndRC2_CBC
 
OBJ_pkcs5
,11L

	)

649 
	#LN_id_pbkdf2
 "PBKDF2"

	)

650 
	#NID_id_pbkdf2
 69

	)

651 
	#OBJ_id_pbkdf2
 
OBJ_pkcs5
,12L

	)

653 
	#LN_pbes2
 "PBES2"

	)

654 
	#NID_pbes2
 161

	)

655 
	#OBJ_pbes2
 
OBJ_pkcs5
,13L

	)

657 
	#LN_pbmac1
 "PBMAC1"

	)

658 
	#NID_pbmac1
 162

	)

659 
	#OBJ_pbmac1
 
OBJ_pkcs5
,14L

	)

661 
	#SN_pkcs7
 "pkcs7"

	)

662 
	#NID_pkcs7
 20

	)

663 
	#OBJ_pkcs7
 
OBJ_pkcs
,7L

	)

665 
	#LN_pkcs7_d©a
 "pkcs7-d©a"

	)

666 
	#NID_pkcs7_d©a
 21

	)

667 
	#OBJ_pkcs7_d©a
 
OBJ_pkcs7
,1L

	)

669 
	#LN_pkcs7_sig√d
 "pkcs7-sig√dD©a"

	)

670 
	#NID_pkcs7_sig√d
 22

	)

671 
	#OBJ_pkcs7_sig√d
 
OBJ_pkcs7
,2L

	)

673 
	#LN_pkcs7_ívñ›ed
 "pkcs7-ívñ›edD©a"

	)

674 
	#NID_pkcs7_ívñ›ed
 23

	)

675 
	#OBJ_pkcs7_ívñ›ed
 
OBJ_pkcs7
,3L

	)

677 
	#LN_pkcs7_sig√dAndEnvñ›ed
 "pkcs7-sig√dAndEnvñ›edD©a"

	)

678 
	#NID_pkcs7_sig√dAndEnvñ›ed
 24

	)

679 
	#OBJ_pkcs7_sig√dAndEnvñ›ed
 
OBJ_pkcs7
,4L

	)

681 
	#LN_pkcs7_dige°
 "pkcs7-dige°D©a"

	)

682 
	#NID_pkcs7_dige°
 25

	)

683 
	#OBJ_pkcs7_dige°
 
OBJ_pkcs7
,5L

	)

685 
	#LN_pkcs7_í¸y±ed
 "pkcs7-í¸y±edD©a"

	)

686 
	#NID_pkcs7_í¸y±ed
 26

	)

687 
	#OBJ_pkcs7_í¸y±ed
 
OBJ_pkcs7
,6L

	)

689 
	#SN_pkcs9
 "pkcs9"

	)

690 
	#NID_pkcs9
 47

	)

691 
	#OBJ_pkcs9
 
OBJ_pkcs
,9L

	)

693 
	#LN_pkcs9_emaûAddªss
 "emaûAddªss"

	)

694 
	#NID_pkcs9_emaûAddªss
 48

	)

695 
	#OBJ_pkcs9_emaûAddªss
 
OBJ_pkcs9
,1L

	)

697 
	#LN_pkcs9_un°ru˘uªdName
 "un°ru˘uªdName"

	)

698 
	#NID_pkcs9_un°ru˘uªdName
 49

	)

699 
	#OBJ_pkcs9_un°ru˘uªdName
 
OBJ_pkcs9
,2L

	)

701 
	#LN_pkcs9_c⁄ã¡Ty≥
 "c⁄ã¡Ty≥"

	)

702 
	#NID_pkcs9_c⁄ã¡Ty≥
 50

	)

703 
	#OBJ_pkcs9_c⁄ã¡Ty≥
 
OBJ_pkcs9
,3L

	)

705 
	#LN_pkcs9_mesßgeDige°
 "mesßgeDige°"

	)

706 
	#NID_pkcs9_mesßgeDige°
 51

	)

707 
	#OBJ_pkcs9_mesßgeDige°
 
OBJ_pkcs9
,4L

	)

709 
	#LN_pkcs9_signögTime
 "signögTime"

	)

710 
	#NID_pkcs9_signögTime
 52

	)

711 
	#OBJ_pkcs9_signögTime
 
OBJ_pkcs9
,5L

	)

713 
	#LN_pkcs9_cou¡îsig«tuª
 "cou¡îsig«tuª"

	)

714 
	#NID_pkcs9_cou¡îsig«tuª
 53

	)

715 
	#OBJ_pkcs9_cou¡îsig«tuª
 
OBJ_pkcs9
,6L

	)

717 
	#LN_pkcs9_chÆÀngePassw‹d
 "chÆÀngePassw‹d"

	)

718 
	#NID_pkcs9_chÆÀngePassw‹d
 54

	)

719 
	#OBJ_pkcs9_chÆÀngePassw‹d
 
OBJ_pkcs9
,7L

	)

721 
	#LN_pkcs9_un°ru˘uªdAddªss
 "un°ru˘uªdAddªss"

	)

722 
	#NID_pkcs9_un°ru˘uªdAddªss
 55

	)

723 
	#OBJ_pkcs9_un°ru˘uªdAddªss
 
OBJ_pkcs9
,8L

	)

725 
	#LN_pkcs9_extCîtAâribuãs
 "exãndedCîtifiˇãAâribuãs"

	)

726 
	#NID_pkcs9_extCîtAâribuãs
 56

	)

727 
	#OBJ_pkcs9_extCîtAâribuãs
 
OBJ_pkcs9
,9L

	)

729 
	#SN_ext_ªq
 "extReq"

	)

730 
	#LN_ext_ªq
 "Exãnsi⁄ Reque°"

	)

731 
	#NID_ext_ªq
 172

	)

732 
	#OBJ_ext_ªq
 
OBJ_pkcs9
,14L

	)

734 
	#SN_SMIMEC≠abûôõs
 "SMIME-CAPS"

	)

735 
	#LN_SMIMEC≠abûôõs
 "S/MIME C≠abûôõs"

	)

736 
	#NID_SMIMEC≠abûôõs
 167

	)

737 
	#OBJ_SMIMEC≠abûôõs
 
OBJ_pkcs9
,15L

	)

739 
	#SN_SMIME
 "SMIME"

	)

740 
	#LN_SMIME
 "S/MIME"

	)

741 
	#NID_SMIME
 188

	)

742 
	#OBJ_SMIME
 
OBJ_pkcs9
,16L

	)

744 
	#SN_id_smime_mod
 "id-smime-mod"

	)

745 
	#NID_id_smime_mod
 189

	)

746 
	#OBJ_id_smime_mod
 
OBJ_SMIME
,0L

	)

748 
	#SN_id_smime_˘
 "id-smime-˘"

	)

749 
	#NID_id_smime_˘
 190

	)

750 
	#OBJ_id_smime_˘
 
OBJ_SMIME
,1L

	)

752 
	#SN_id_smime_Ø
 "id-smime-Ø"

	)

753 
	#NID_id_smime_Ø
 191

	)

754 
	#OBJ_id_smime_Ø
 
OBJ_SMIME
,2L

	)

756 
	#SN_id_smime_Æg
 "id-smime-Æg"

	)

757 
	#NID_id_smime_Æg
 192

	)

758 
	#OBJ_id_smime_Æg
 
OBJ_SMIME
,3L

	)

760 
	#SN_id_smime_cd
 "id-smime-cd"

	)

761 
	#NID_id_smime_cd
 193

	)

762 
	#OBJ_id_smime_cd
 
OBJ_SMIME
,4L

	)

764 
	#SN_id_smime_•q
 "id-smime-•q"

	)

765 
	#NID_id_smime_•q
 194

	)

766 
	#OBJ_id_smime_•q
 
OBJ_SMIME
,5L

	)

768 
	#SN_id_smime_˘i
 "id-smime-˘i"

	)

769 
	#NID_id_smime_˘i
 195

	)

770 
	#OBJ_id_smime_˘i
 
OBJ_SMIME
,6L

	)

772 
	#SN_id_smime_mod_cms
 "id-smime-mod-cms"

	)

773 
	#NID_id_smime_mod_cms
 196

	)

774 
	#OBJ_id_smime_mod_cms
 
OBJ_id_smime_mod
,1L

	)

776 
	#SN_id_smime_mod_ess
 "id-smime-mod-ess"

	)

777 
	#NID_id_smime_mod_ess
 197

	)

778 
	#OBJ_id_smime_mod_ess
 
OBJ_id_smime_mod
,2L

	)

780 
	#SN_id_smime_mod_oid
 "id-smime-mod-oid"

	)

781 
	#NID_id_smime_mod_oid
 198

	)

782 
	#OBJ_id_smime_mod_oid
 
OBJ_id_smime_mod
,3L

	)

784 
	#SN_id_smime_mod_msg_v3
 "id-smime-mod-msg-v3"

	)

785 
	#NID_id_smime_mod_msg_v3
 199

	)

786 
	#OBJ_id_smime_mod_msg_v3
 
OBJ_id_smime_mod
,4L

	)

788 
	#SN_id_smime_mod_ës_eSig«tuª_88
 "id-smime-mod-ës-eSig«tuª-88"

	)

789 
	#NID_id_smime_mod_ës_eSig«tuª_88
 200

	)

790 
	#OBJ_id_smime_mod_ës_eSig«tuª_88
 
OBJ_id_smime_mod
,5L

	)

792 
	#SN_id_smime_mod_ës_eSig«tuª_97
 "id-smime-mod-ës-eSig«tuª-97"

	)

793 
	#NID_id_smime_mod_ës_eSig«tuª_97
 201

	)

794 
	#OBJ_id_smime_mod_ës_eSig«tuª_97
 
OBJ_id_smime_mod
,6L

	)

796 
	#SN_id_smime_mod_ës_eSigPﬁicy_88
 "id-smime-mod-ës-eSigPﬁicy-88"

	)

797 
	#NID_id_smime_mod_ës_eSigPﬁicy_88
 202

	)

798 
	#OBJ_id_smime_mod_ës_eSigPﬁicy_88
 
OBJ_id_smime_mod
,7L

	)

800 
	#SN_id_smime_mod_ës_eSigPﬁicy_97
 "id-smime-mod-ës-eSigPﬁicy-97"

	)

801 
	#NID_id_smime_mod_ës_eSigPﬁicy_97
 203

	)

802 
	#OBJ_id_smime_mod_ës_eSigPﬁicy_97
 
OBJ_id_smime_mod
,8L

	)

804 
	#SN_id_smime_˘_ª˚ùt
 "id-smime-˘-ª˚ùt"

	)

805 
	#NID_id_smime_˘_ª˚ùt
 204

	)

806 
	#OBJ_id_smime_˘_ª˚ùt
 
OBJ_id_smime_˘
,1L

	)

808 
	#SN_id_smime_˘_authD©a
 "id-smime-˘-authD©a"

	)

809 
	#NID_id_smime_˘_authD©a
 205

	)

810 
	#OBJ_id_smime_˘_authD©a
 
OBJ_id_smime_˘
,2L

	)

812 
	#SN_id_smime_˘_publishCît
 "id-smime-˘-publishCît"

	)

813 
	#NID_id_smime_˘_publishCît
 206

	)

814 
	#OBJ_id_smime_˘_publishCît
 
OBJ_id_smime_˘
,3L

	)

816 
	#SN_id_smime_˘_TSTInfo
 "id-smime-˘-TSTInfo"

	)

817 
	#NID_id_smime_˘_TSTInfo
 207

	)

818 
	#OBJ_id_smime_˘_TSTInfo
 
OBJ_id_smime_˘
,4L

	)

820 
	#SN_id_smime_˘_TDTInfo
 "id-smime-˘-TDTInfo"

	)

821 
	#NID_id_smime_˘_TDTInfo
 208

	)

822 
	#OBJ_id_smime_˘_TDTInfo
 
OBJ_id_smime_˘
,5L

	)

824 
	#SN_id_smime_˘_c⁄ã¡Info
 "id-smime-˘-c⁄ã¡Info"

	)

825 
	#NID_id_smime_˘_c⁄ã¡Info
 209

	)

826 
	#OBJ_id_smime_˘_c⁄ã¡Info
 
OBJ_id_smime_˘
,6L

	)

828 
	#SN_id_smime_˘_DVCSReque°D©a
 "id-smime-˘-DVCSReque°D©a"

	)

829 
	#NID_id_smime_˘_DVCSReque°D©a
 210

	)

830 
	#OBJ_id_smime_˘_DVCSReque°D©a
 
OBJ_id_smime_˘
,7L

	)

832 
	#SN_id_smime_˘_DVCSRe•⁄£D©a
 "id-smime-˘-DVCSRe•⁄£D©a"

	)

833 
	#NID_id_smime_˘_DVCSRe•⁄£D©a
 211

	)

834 
	#OBJ_id_smime_˘_DVCSRe•⁄£D©a
 
OBJ_id_smime_˘
,8L

	)

836 
	#SN_id_smime_˘_com¥es£dD©a
 "id-smime-˘-com¥es£dD©a"

	)

837 
	#NID_id_smime_˘_com¥es£dD©a
 786

	)

838 
	#OBJ_id_smime_˘_com¥es£dD©a
 
OBJ_id_smime_˘
,9L

	)

840 
	#SN_id_smime_˘_c⁄ã¡CﬁÀ˘i⁄
 "id-smime-˘-c⁄ã¡CﬁÀ˘i⁄"

	)

841 
	#NID_id_smime_˘_c⁄ã¡CﬁÀ˘i⁄
 1058

	)

842 
	#OBJ_id_smime_˘_c⁄ã¡CﬁÀ˘i⁄
 
OBJ_id_smime_˘
,19L

	)

844 
	#SN_id_smime_˘_authEnvñ›edD©a
 "id-smime-˘-authEnvñ›edD©a"

	)

845 
	#NID_id_smime_˘_authEnvñ›edD©a
 1059

	)

846 
	#OBJ_id_smime_˘_authEnvñ›edD©a
 
OBJ_id_smime_˘
,23L

	)

848 
	#SN_id_˘_asciiTextWôhCRLF
 "id-˘-asciiTextWôhCRLF"

	)

849 
	#NID_id_˘_asciiTextWôhCRLF
 787

	)

850 
	#OBJ_id_˘_asciiTextWôhCRLF
 
OBJ_id_smime_˘
,27L

	)

852 
	#SN_id_˘_xml
 "id-˘-xml"

	)

853 
	#NID_id_˘_xml
 1060

	)

854 
	#OBJ_id_˘_xml
 
OBJ_id_smime_˘
,28L

	)

856 
	#SN_id_smime_Ø_ª˚ùtReque°
 "id-smime-Ø-ª˚ùtReque°"

	)

857 
	#NID_id_smime_Ø_ª˚ùtReque°
 212

	)

858 
	#OBJ_id_smime_Ø_ª˚ùtReque°
 
OBJ_id_smime_Ø
,1L

	)

860 
	#SN_id_smime_Ø_£curôyLabñ
 "id-smime-Ø-£curôyLabñ"

	)

861 
	#NID_id_smime_Ø_£curôyLabñ
 213

	)

862 
	#OBJ_id_smime_Ø_£curôyLabñ
 
OBJ_id_smime_Ø
,2L

	)

864 
	#SN_id_smime_Ø_mlEx∑ndHi°‹y
 "id-smime-Ø-mlEx∑ndHi°‹y"

	)

865 
	#NID_id_smime_Ø_mlEx∑ndHi°‹y
 214

	)

866 
	#OBJ_id_smime_Ø_mlEx∑ndHi°‹y
 
OBJ_id_smime_Ø
,3L

	)

868 
	#SN_id_smime_Ø_c⁄ã¡Höt
 "id-smime-Ø-c⁄ã¡Höt"

	)

869 
	#NID_id_smime_Ø_c⁄ã¡Höt
 215

	)

870 
	#OBJ_id_smime_Ø_c⁄ã¡Höt
 
OBJ_id_smime_Ø
,4L

	)

872 
	#SN_id_smime_Ø_msgSigDige°
 "id-smime-Ø-msgSigDige°"

	)

873 
	#NID_id_smime_Ø_msgSigDige°
 216

	)

874 
	#OBJ_id_smime_Ø_msgSigDige°
 
OBJ_id_smime_Ø
,5L

	)

876 
	#SN_id_smime_Ø_íˇpC⁄ã¡Ty≥
 "id-smime-Ø-íˇpC⁄ã¡Ty≥"

	)

877 
	#NID_id_smime_Ø_íˇpC⁄ã¡Ty≥
 217

	)

878 
	#OBJ_id_smime_Ø_íˇpC⁄ã¡Ty≥
 
OBJ_id_smime_Ø
,6L

	)

880 
	#SN_id_smime_Ø_c⁄ã¡Idítifõr
 "id-smime-Ø-c⁄ã¡Idítifõr"

	)

881 
	#NID_id_smime_Ø_c⁄ã¡Idítifõr
 218

	)

882 
	#OBJ_id_smime_Ø_c⁄ã¡Idítifõr
 
OBJ_id_smime_Ø
,7L

	)

884 
	#SN_id_smime_Ø_macVÆue
 "id-smime-Ø-macVÆue"

	)

885 
	#NID_id_smime_Ø_macVÆue
 219

	)

886 
	#OBJ_id_smime_Ø_macVÆue
 
OBJ_id_smime_Ø
,8L

	)

888 
	#SN_id_smime_Ø_equivÆítLabñs
 "id-smime-Ø-equivÆítLabñs"

	)

889 
	#NID_id_smime_Ø_equivÆítLabñs
 220

	)

890 
	#OBJ_id_smime_Ø_equivÆítLabñs
 
OBJ_id_smime_Ø
,9L

	)

892 
	#SN_id_smime_Ø_c⁄ã¡Re„ªn˚
 "id-smime-Ø-c⁄ã¡Re„ªn˚"

	)

893 
	#NID_id_smime_Ø_c⁄ã¡Re„ªn˚
 221

	)

894 
	#OBJ_id_smime_Ø_c⁄ã¡Re„ªn˚
 
OBJ_id_smime_Ø
,10L

	)

896 
	#SN_id_smime_Ø_í¸ypKeyPªf
 "id-smime-Ø-í¸ypKeyPªf"

	)

897 
	#NID_id_smime_Ø_í¸ypKeyPªf
 222

	)

898 
	#OBJ_id_smime_Ø_í¸ypKeyPªf
 
OBJ_id_smime_Ø
,11L

	)

900 
	#SN_id_smime_Ø_signögCîtifiˇã
 "id-smime-Ø-signögCîtifiˇã"

	)

901 
	#NID_id_smime_Ø_signögCîtifiˇã
 223

	)

902 
	#OBJ_id_smime_Ø_signögCîtifiˇã
 
OBJ_id_smime_Ø
,12L

	)

904 
	#SN_id_smime_Ø_smimeEn¸y±Cîts
 "id-smime-Ø-smimeEn¸y±Cîts"

	)

905 
	#NID_id_smime_Ø_smimeEn¸y±Cîts
 224

	)

906 
	#OBJ_id_smime_Ø_smimeEn¸y±Cîts
 
OBJ_id_smime_Ø
,13L

	)

908 
	#SN_id_smime_Ø_timeSèmpTokí
 "id-smime-Ø-timeSèmpTokí"

	)

909 
	#NID_id_smime_Ø_timeSèmpTokí
 225

	)

910 
	#OBJ_id_smime_Ø_timeSèmpTokí
 
OBJ_id_smime_Ø
,14L

	)

912 
	#SN_id_smime_Ø_ës_sigPﬁicyId
 "id-smime-Ø-ës-sigPﬁicyId"

	)

913 
	#NID_id_smime_Ø_ës_sigPﬁicyId
 226

	)

914 
	#OBJ_id_smime_Ø_ës_sigPﬁicyId
 
OBJ_id_smime_Ø
,15L

	)

916 
	#SN_id_smime_Ø_ës_commômítTy≥
 "id-smime-Ø-ës-commômítTy≥"

	)

917 
	#NID_id_smime_Ø_ës_commômítTy≥
 227

	)

918 
	#OBJ_id_smime_Ø_ës_commômítTy≥
 
OBJ_id_smime_Ø
,16L

	)

920 
	#SN_id_smime_Ø_ës_sig√rLoˇti⁄
 "id-smime-Ø-ës-sig√rLoˇti⁄"

	)

921 
	#NID_id_smime_Ø_ës_sig√rLoˇti⁄
 228

	)

922 
	#OBJ_id_smime_Ø_ës_sig√rLoˇti⁄
 
OBJ_id_smime_Ø
,17L

	)

924 
	#SN_id_smime_Ø_ës_sig√rAâr
 "id-smime-Ø-ës-sig√rAâr"

	)

925 
	#NID_id_smime_Ø_ës_sig√rAâr
 229

	)

926 
	#OBJ_id_smime_Ø_ës_sig√rAâr
 
OBJ_id_smime_Ø
,18L

	)

928 
	#SN_id_smime_Ø_ës_ŸhîSigCît
 "id-smime-Ø-ës-ŸhîSigCît"

	)

929 
	#NID_id_smime_Ø_ës_ŸhîSigCît
 230

	)

930 
	#OBJ_id_smime_Ø_ës_ŸhîSigCît
 
OBJ_id_smime_Ø
,19L

	)

932 
	#SN_id_smime_Ø_ës_c⁄ã¡Time°amp
 "id-smime-Ø-ës-c⁄ã¡Time°amp"

	)

933 
	#NID_id_smime_Ø_ës_c⁄ã¡Time°amp
 231

	)

934 
	#OBJ_id_smime_Ø_ës_c⁄ã¡Time°amp
 
OBJ_id_smime_Ø
,20L

	)

936 
	#SN_id_smime_Ø_ës_CîtifiˇãRefs
 "id-smime-Ø-ës-CîtifiˇãRefs"

	)

937 
	#NID_id_smime_Ø_ës_CîtifiˇãRefs
 232

	)

938 
	#OBJ_id_smime_Ø_ës_CîtifiˇãRefs
 
OBJ_id_smime_Ø
,21L

	)

940 
	#SN_id_smime_Ø_ës_Revoˇti⁄Refs
 "id-smime-Ø-ës-Revoˇti⁄Refs"

	)

941 
	#NID_id_smime_Ø_ës_Revoˇti⁄Refs
 233

	)

942 
	#OBJ_id_smime_Ø_ës_Revoˇti⁄Refs
 
OBJ_id_smime_Ø
,22L

	)

944 
	#SN_id_smime_Ø_ës_˚πVÆues
 "id-smime-Ø-ës-˚πVÆues"

	)

945 
	#NID_id_smime_Ø_ës_˚πVÆues
 234

	)

946 
	#OBJ_id_smime_Ø_ës_˚πVÆues
 
OBJ_id_smime_Ø
,23L

	)

948 
	#SN_id_smime_Ø_ës_ªvoˇti⁄VÆues
 "id-smime-Ø-ës-ªvoˇti⁄VÆues"

	)

949 
	#NID_id_smime_Ø_ës_ªvoˇti⁄VÆues
 235

	)

950 
	#OBJ_id_smime_Ø_ës_ªvoˇti⁄VÆues
 
OBJ_id_smime_Ø
,24L

	)

952 
	#SN_id_smime_Ø_ës_escTimeSèmp
 "id-smime-Ø-ës-escTimeSèmp"

	)

953 
	#NID_id_smime_Ø_ës_escTimeSèmp
 236

	)

954 
	#OBJ_id_smime_Ø_ës_escTimeSèmp
 
OBJ_id_smime_Ø
,25L

	)

956 
	#SN_id_smime_Ø_ës_˚πCRLTime°amp
 "id-smime-Ø-ës-˚πCRLTime°amp"

	)

957 
	#NID_id_smime_Ø_ës_˚πCRLTime°amp
 237

	)

958 
	#OBJ_id_smime_Ø_ës_˚πCRLTime°amp
 
OBJ_id_smime_Ø
,26L

	)

960 
	#SN_id_smime_Ø_ës_¨chiveTimeSèmp
 "id-smime-Ø-ës-¨chiveTimeSèmp"

	)

961 
	#NID_id_smime_Ø_ës_¨chiveTimeSèmp
 238

	)

962 
	#OBJ_id_smime_Ø_ës_¨chiveTimeSèmp
 
OBJ_id_smime_Ø
,27L

	)

964 
	#SN_id_smime_Ø_sig«tuªTy≥
 "id-smime-Ø-sig«tuªTy≥"

	)

965 
	#NID_id_smime_Ø_sig«tuªTy≥
 239

	)

966 
	#OBJ_id_smime_Ø_sig«tuªTy≥
 
OBJ_id_smime_Ø
,28L

	)

968 
	#SN_id_smime_Ø_dvcs_dvc
 "id-smime-Ø-dvcs-dvc"

	)

969 
	#NID_id_smime_Ø_dvcs_dvc
 240

	)

970 
	#OBJ_id_smime_Ø_dvcs_dvc
 
OBJ_id_smime_Ø
,29L

	)

972 
	#SN_id_smime_Ø_signögCîtifiˇãV2
 "id-smime-Ø-signögCîtifiˇãV2"

	)

973 
	#NID_id_smime_Ø_signögCîtifiˇãV2
 1086

	)

974 
	#OBJ_id_smime_Ø_signögCîtifiˇãV2
 
OBJ_id_smime_Ø
,47L

	)

976 
	#SN_id_smime_Æg_ESDHwôh3DES
 "id-smime-Æg-ESDHwôh3DES"

	)

977 
	#NID_id_smime_Æg_ESDHwôh3DES
 241

	)

978 
	#OBJ_id_smime_Æg_ESDHwôh3DES
 
OBJ_id_smime_Æg
,1L

	)

980 
	#SN_id_smime_Æg_ESDHwôhRC2
 "id-smime-Æg-ESDHwôhRC2"

	)

981 
	#NID_id_smime_Æg_ESDHwôhRC2
 242

	)

982 
	#OBJ_id_smime_Æg_ESDHwôhRC2
 
OBJ_id_smime_Æg
,2L

	)

984 
	#SN_id_smime_Æg_3DESwøp
 "id-smime-Æg-3DESwøp"

	)

985 
	#NID_id_smime_Æg_3DESwøp
 243

	)

986 
	#OBJ_id_smime_Æg_3DESwøp
 
OBJ_id_smime_Æg
,3L

	)

988 
	#SN_id_smime_Æg_RC2wøp
 "id-smime-Æg-RC2wøp"

	)

989 
	#NID_id_smime_Æg_RC2wøp
 244

	)

990 
	#OBJ_id_smime_Æg_RC2wøp
 
OBJ_id_smime_Æg
,4L

	)

992 
	#SN_id_smime_Æg_ESDH
 "id-smime-Æg-ESDH"

	)

993 
	#NID_id_smime_Æg_ESDH
 245

	)

994 
	#OBJ_id_smime_Æg_ESDH
 
OBJ_id_smime_Æg
,5L

	)

996 
	#SN_id_smime_Æg_CMS3DESwøp
 "id-smime-Æg-CMS3DESwøp"

	)

997 
	#NID_id_smime_Æg_CMS3DESwøp
 246

	)

998 
	#OBJ_id_smime_Æg_CMS3DESwøp
 
OBJ_id_smime_Æg
,6L

	)

1000 
	#SN_id_smime_Æg_CMSRC2wøp
 "id-smime-Æg-CMSRC2wøp"

	)

1001 
	#NID_id_smime_Æg_CMSRC2wøp
 247

	)

1002 
	#OBJ_id_smime_Æg_CMSRC2wøp
 
OBJ_id_smime_Æg
,7L

	)

1004 
	#SN_id_Æg_PWRI_KEK
 "id-Æg-PWRI-KEK"

	)

1005 
	#NID_id_Æg_PWRI_KEK
 893

	)

1006 
	#OBJ_id_Æg_PWRI_KEK
 
OBJ_id_smime_Æg
,9L

	)

1008 
	#SN_id_smime_cd_ld≠
 "id-smime-cd-ld≠"

	)

1009 
	#NID_id_smime_cd_ld≠
 248

	)

1010 
	#OBJ_id_smime_cd_ld≠
 
OBJ_id_smime_cd
,1L

	)

1012 
	#SN_id_smime_•q_ës_sqt_uri
 "id-smime-•q-ës-sqt-uri"

	)

1013 
	#NID_id_smime_•q_ës_sqt_uri
 249

	)

1014 
	#OBJ_id_smime_•q_ës_sqt_uri
 
OBJ_id_smime_•q
,1L

	)

1016 
	#SN_id_smime_•q_ës_sqt_unŸi˚
 "id-smime-•q-ës-sqt-unŸi˚"

	)

1017 
	#NID_id_smime_•q_ës_sqt_unŸi˚
 250

	)

1018 
	#OBJ_id_smime_•q_ës_sqt_unŸi˚
 
OBJ_id_smime_•q
,2L

	)

1020 
	#SN_id_smime_˘i_ës_¥oofOfOrigö
 "id-smime-˘i-ës-¥oofOfOrigö"

	)

1021 
	#NID_id_smime_˘i_ës_¥oofOfOrigö
 251

	)

1022 
	#OBJ_id_smime_˘i_ës_¥oofOfOrigö
 
OBJ_id_smime_˘i
,1L

	)

1024 
	#SN_id_smime_˘i_ës_¥oofOfRe˚ùt
 "id-smime-˘i-ës-¥oofOfRe˚ùt"

	)

1025 
	#NID_id_smime_˘i_ës_¥oofOfRe˚ùt
 252

	)

1026 
	#OBJ_id_smime_˘i_ës_¥oofOfRe˚ùt
 
OBJ_id_smime_˘i
,2L

	)

1028 
	#SN_id_smime_˘i_ës_¥oofOfDñivîy
 "id-smime-˘i-ës-¥oofOfDñivîy"

	)

1029 
	#NID_id_smime_˘i_ës_¥oofOfDñivîy
 253

	)

1030 
	#OBJ_id_smime_˘i_ës_¥oofOfDñivîy
 
OBJ_id_smime_˘i
,3L

	)

1032 
	#SN_id_smime_˘i_ës_¥oofOfSídî
 "id-smime-˘i-ës-¥oofOfSídî"

	)

1033 
	#NID_id_smime_˘i_ës_¥oofOfSídî
 254

	)

1034 
	#OBJ_id_smime_˘i_ës_¥oofOfSídî
 
OBJ_id_smime_˘i
,4L

	)

1036 
	#SN_id_smime_˘i_ës_¥oofOfAµrovÆ
 "id-smime-˘i-ës-¥oofOfAµrovÆ"

	)

1037 
	#NID_id_smime_˘i_ës_¥oofOfAµrovÆ
 255

	)

1038 
	#OBJ_id_smime_˘i_ës_¥oofOfAµrovÆ
 
OBJ_id_smime_˘i
,5L

	)

1040 
	#SN_id_smime_˘i_ës_¥oofOfCª©i⁄
 "id-smime-˘i-ës-¥oofOfCª©i⁄"

	)

1041 
	#NID_id_smime_˘i_ës_¥oofOfCª©i⁄
 256

	)

1042 
	#OBJ_id_smime_˘i_ës_¥oofOfCª©i⁄
 
OBJ_id_smime_˘i
,6L

	)

1044 
	#LN_‰õndlyName
 "‰õndlyName"

	)

1045 
	#NID_‰õndlyName
 156

	)

1046 
	#OBJ_‰õndlyName
 
OBJ_pkcs9
,20L

	)

1048 
	#LN_loˇlKeyID
 "loˇlKeyID"

	)

1049 
	#NID_loˇlKeyID
 157

	)

1050 
	#OBJ_loˇlKeyID
 
OBJ_pkcs9
,21L

	)

1052 
	#SN_ms_c•_«me
 "CSPName"

	)

1053 
	#LN_ms_c•_«me
 "Mi¸oso· CSP Name"

	)

1054 
	#NID_ms_c•_«me
 417

	)

1055 
	#OBJ_ms_c•_«me
 1L,3L,6L,1L,4L,1L,311L,17L,1L

	)

1057 
	#SN_LoˇlKeySë
 "LoˇlKeySë"

	)

1058 
	#LN_LoˇlKeySë
 "Mi¸oso· Loˇ»Key së"

	)

1059 
	#NID_LoˇlKeySë
 856

	)

1060 
	#OBJ_LoˇlKeySë
 1L,3L,6L,1L,4L,1L,311L,17L,2L

	)

1062 
	#OBJ_˚πTy≥s
 
OBJ_pkcs9
,22L

	)

1064 
	#LN_x509Cîtifiˇã
 "x509Cîtifiˇã"

	)

1065 
	#NID_x509Cîtifiˇã
 158

	)

1066 
	#OBJ_x509Cîtifiˇã
 
OBJ_˚πTy≥s
,1L

	)

1068 
	#LN_sdsiCîtifiˇã
 "sdsiCîtifiˇã"

	)

1069 
	#NID_sdsiCîtifiˇã
 159

	)

1070 
	#OBJ_sdsiCîtifiˇã
 
OBJ_˚πTy≥s
,2L

	)

1072 
	#OBJ_¸lTy≥s
 
OBJ_pkcs9
,23L

	)

1074 
	#LN_x509Cæ
 "x509Cæ"

	)

1075 
	#NID_x509Cæ
 160

	)

1076 
	#OBJ_x509Cæ
 
OBJ_¸lTy≥s
,1L

	)

1078 
	#OBJ_pkcs12
 
OBJ_pkcs
,12L

	)

1080 
	#OBJ_pkcs12_pbeids
 
OBJ_pkcs12
,1L

	)

1082 
	#SN_pbe_WôhSHA1And128BôRC4
 "PBE-SHA1-RC4-128"

	)

1083 
	#LN_pbe_WôhSHA1And128BôRC4
 "pbeWôhSHA1And128BôRC4"

	)

1084 
	#NID_pbe_WôhSHA1And128BôRC4
 144

	)

1085 
	#OBJ_pbe_WôhSHA1And128BôRC4
 
OBJ_pkcs12_pbeids
,1L

	)

1087 
	#SN_pbe_WôhSHA1And40BôRC4
 "PBE-SHA1-RC4-40"

	)

1088 
	#LN_pbe_WôhSHA1And40BôRC4
 "pbeWôhSHA1And40BôRC4"

	)

1089 
	#NID_pbe_WôhSHA1And40BôRC4
 145

	)

1090 
	#OBJ_pbe_WôhSHA1And40BôRC4
 
OBJ_pkcs12_pbeids
,2L

	)

1092 
	#SN_pbe_WôhSHA1And3_Key_TrùÀDES_CBC
 "PBE-SHA1-3DES"

	)

1093 
	#LN_pbe_WôhSHA1And3_Key_TrùÀDES_CBC
 "pbeWôhSHA1And3-KeyTrùÀDES-CBC"

	)

1094 
	#NID_pbe_WôhSHA1And3_Key_TrùÀDES_CBC
 146

	)

1095 
	#OBJ_pbe_WôhSHA1And3_Key_TrùÀDES_CBC
 
OBJ_pkcs12_pbeids
,3L

	)

1097 
	#SN_pbe_WôhSHA1And2_Key_TrùÀDES_CBC
 "PBE-SHA1-2DES"

	)

1098 
	#LN_pbe_WôhSHA1And2_Key_TrùÀDES_CBC
 "pbeWôhSHA1And2-KeyTrùÀDES-CBC"

	)

1099 
	#NID_pbe_WôhSHA1And2_Key_TrùÀDES_CBC
 147

	)

1100 
	#OBJ_pbe_WôhSHA1And2_Key_TrùÀDES_CBC
 
OBJ_pkcs12_pbeids
,4L

	)

1102 
	#SN_pbe_WôhSHA1And128BôRC2_CBC
 "PBE-SHA1-RC2-128"

	)

1103 
	#LN_pbe_WôhSHA1And128BôRC2_CBC
 "pbeWôhSHA1And128BôRC2-CBC"

	)

1104 
	#NID_pbe_WôhSHA1And128BôRC2_CBC
 148

	)

1105 
	#OBJ_pbe_WôhSHA1And128BôRC2_CBC
 
OBJ_pkcs12_pbeids
,5L

	)

1107 
	#SN_pbe_WôhSHA1And40BôRC2_CBC
 "PBE-SHA1-RC2-40"

	)

1108 
	#LN_pbe_WôhSHA1And40BôRC2_CBC
 "pbeWôhSHA1And40BôRC2-CBC"

	)

1109 
	#NID_pbe_WôhSHA1And40BôRC2_CBC
 149

	)

1110 
	#OBJ_pbe_WôhSHA1And40BôRC2_CBC
 
OBJ_pkcs12_pbeids
,6L

	)

1112 
	#OBJ_pkcs12_Vîsi⁄1
 
OBJ_pkcs12
,10L

	)

1114 
	#OBJ_pkcs12_BagIds
 
OBJ_pkcs12_Vîsi⁄1
,1L

	)

1116 
	#LN_keyBag
 "keyBag"

	)

1117 
	#NID_keyBag
 150

	)

1118 
	#OBJ_keyBag
 
OBJ_pkcs12_BagIds
,1L

	)

1120 
	#LN_pkcs8ShroudedKeyBag
 "pkcs8ShroudedKeyBag"

	)

1121 
	#NID_pkcs8ShroudedKeyBag
 151

	)

1122 
	#OBJ_pkcs8ShroudedKeyBag
 
OBJ_pkcs12_BagIds
,2L

	)

1124 
	#LN_˚πBag
 "˚πBag"

	)

1125 
	#NID_˚πBag
 152

	)

1126 
	#OBJ_˚πBag
 
OBJ_pkcs12_BagIds
,3L

	)

1128 
	#LN_¸lBag
 "¸lBag"

	)

1129 
	#NID_¸lBag
 153

	)

1130 
	#OBJ_¸lBag
 
OBJ_pkcs12_BagIds
,4L

	)

1132 
	#LN_£¸ëBag
 "£¸ëBag"

	)

1133 
	#NID_£¸ëBag
 154

	)

1134 
	#OBJ_£¸ëBag
 
OBJ_pkcs12_BagIds
,5L

	)

1136 
	#LN_ß„C⁄ã¡sBag
 "ß„C⁄ã¡sBag"

	)

1137 
	#NID_ß„C⁄ã¡sBag
 155

	)

1138 
	#OBJ_ß„C⁄ã¡sBag
 
OBJ_pkcs12_BagIds
,6L

	)

1140 
	#SN_md2
 "MD2"

	)

1141 
	#LN_md2
 "md2"

	)

1142 
	#NID_md2
 3

	)

1143 
	#OBJ_md2
 
OBJ_rßdsi
,2L,2L

	)

1145 
	#SN_md4
 "MD4"

	)

1146 
	#LN_md4
 "md4"

	)

1147 
	#NID_md4
 257

	)

1148 
	#OBJ_md4
 
OBJ_rßdsi
,2L,4L

	)

1150 
	#SN_md5
 "MD5"

	)

1151 
	#LN_md5
 "md5"

	)

1152 
	#NID_md5
 4

	)

1153 
	#OBJ_md5
 
OBJ_rßdsi
,2L,5L

	)

1155 
	#SN_md5_sha1
 "MD5-SHA1"

	)

1156 
	#LN_md5_sha1
 "md5-sha1"

	)

1157 
	#NID_md5_sha1
 114

	)

1159 
	#LN_hmacWôhMD5
 "hmacWôhMD5"

	)

1160 
	#NID_hmacWôhMD5
 797

	)

1161 
	#OBJ_hmacWôhMD5
 
OBJ_rßdsi
,2L,6L

	)

1163 
	#LN_hmacWôhSHA1
 "hmacWôhSHA1"

	)

1164 
	#NID_hmacWôhSHA1
 163

	)

1165 
	#OBJ_hmacWôhSHA1
 
OBJ_rßdsi
,2L,7L

	)

1167 
	#SN_sm2
 "SM2"

	)

1168 
	#LN_sm2
 "sm2"

	)

1169 
	#NID_sm2
 1172

	)

1170 
	#OBJ_sm2
 
OBJ_sm_scheme
,301L

	)

1172 
	#SN_sm3
 "SM3"

	)

1173 
	#LN_sm3
 "sm3"

	)

1174 
	#NID_sm3
 1143

	)

1175 
	#OBJ_sm3
 
OBJ_sm_scheme
,401L

	)

1177 
	#SN_sm3WôhRSAEn¸y±i⁄
 "RSA-SM3"

	)

1178 
	#LN_sm3WôhRSAEn¸y±i⁄
 "sm3WôhRSAEn¸y±i⁄"

	)

1179 
	#NID_sm3WôhRSAEn¸y±i⁄
 1144

	)

1180 
	#OBJ_sm3WôhRSAEn¸y±i⁄
 
OBJ_sm_scheme
,504L

	)

1182 
	#LN_hmacWôhSHA224
 "hmacWôhSHA224"

	)

1183 
	#NID_hmacWôhSHA224
 798

	)

1184 
	#OBJ_hmacWôhSHA224
 
OBJ_rßdsi
,2L,8L

	)

1186 
	#LN_hmacWôhSHA256
 "hmacWôhSHA256"

	)

1187 
	#NID_hmacWôhSHA256
 799

	)

1188 
	#OBJ_hmacWôhSHA256
 
OBJ_rßdsi
,2L,9L

	)

1190 
	#LN_hmacWôhSHA384
 "hmacWôhSHA384"

	)

1191 
	#NID_hmacWôhSHA384
 800

	)

1192 
	#OBJ_hmacWôhSHA384
 
OBJ_rßdsi
,2L,10L

	)

1194 
	#LN_hmacWôhSHA512
 "hmacWôhSHA512"

	)

1195 
	#NID_hmacWôhSHA512
 801

	)

1196 
	#OBJ_hmacWôhSHA512
 
OBJ_rßdsi
,2L,11L

	)

1198 
	#LN_hmacWôhSHA512_224
 "hmacWôhSHA512-224"

	)

1199 
	#NID_hmacWôhSHA512_224
 1193

	)

1200 
	#OBJ_hmacWôhSHA512_224
 
OBJ_rßdsi
,2L,12L

	)

1202 
	#LN_hmacWôhSHA512_256
 "hmacWôhSHA512-256"

	)

1203 
	#NID_hmacWôhSHA512_256
 1194

	)

1204 
	#OBJ_hmacWôhSHA512_256
 
OBJ_rßdsi
,2L,13L

	)

1206 
	#SN_rc2_cbc
 "RC2-CBC"

	)

1207 
	#LN_rc2_cbc
 "rc2-cbc"

	)

1208 
	#NID_rc2_cbc
 37

	)

1209 
	#OBJ_rc2_cbc
 
OBJ_rßdsi
,3L,2L

	)

1211 
	#SN_rc2_ecb
 "RC2-ECB"

	)

1212 
	#LN_rc2_ecb
 "rc2-ecb"

	)

1213 
	#NID_rc2_ecb
 38

	)

1215 
	#SN_rc2_cfb64
 "RC2-CFB"

	)

1216 
	#LN_rc2_cfb64
 "rc2-cfb"

	)

1217 
	#NID_rc2_cfb64
 39

	)

1219 
	#SN_rc2_ofb64
 "RC2-OFB"

	)

1220 
	#LN_rc2_ofb64
 "rc2-ofb"

	)

1221 
	#NID_rc2_ofb64
 40

	)

1223 
	#SN_rc2_40_cbc
 "RC2-40-CBC"

	)

1224 
	#LN_rc2_40_cbc
 "rc2-40-cbc"

	)

1225 
	#NID_rc2_40_cbc
 98

	)

1227 
	#SN_rc2_64_cbc
 "RC2-64-CBC"

	)

1228 
	#LN_rc2_64_cbc
 "rc2-64-cbc"

	)

1229 
	#NID_rc2_64_cbc
 166

	)

1231 
	#SN_rc4
 "RC4"

	)

1232 
	#LN_rc4
 "rc4"

	)

1233 
	#NID_rc4
 5

	)

1234 
	#OBJ_rc4
 
OBJ_rßdsi
,3L,4L

	)

1236 
	#SN_rc4_40
 "RC4-40"

	)

1237 
	#LN_rc4_40
 "rc4-40"

	)

1238 
	#NID_rc4_40
 97

	)

1240 
	#SN_des_ede3_cbc
 "DES-EDE3-CBC"

	)

1241 
	#LN_des_ede3_cbc
 "des-ede3-cbc"

	)

1242 
	#NID_des_ede3_cbc
 44

	)

1243 
	#OBJ_des_ede3_cbc
 
OBJ_rßdsi
,3L,7L

	)

1245 
	#SN_rc5_cbc
 "RC5-CBC"

	)

1246 
	#LN_rc5_cbc
 "rc5-cbc"

	)

1247 
	#NID_rc5_cbc
 120

	)

1248 
	#OBJ_rc5_cbc
 
OBJ_rßdsi
,3L,8L

	)

1250 
	#SN_rc5_ecb
 "RC5-ECB"

	)

1251 
	#LN_rc5_ecb
 "rc5-ecb"

	)

1252 
	#NID_rc5_ecb
 121

	)

1254 
	#SN_rc5_cfb64
 "RC5-CFB"

	)

1255 
	#LN_rc5_cfb64
 "rc5-cfb"

	)

1256 
	#NID_rc5_cfb64
 122

	)

1258 
	#SN_rc5_ofb64
 "RC5-OFB"

	)

1259 
	#LN_rc5_ofb64
 "rc5-ofb"

	)

1260 
	#NID_rc5_ofb64
 123

	)

1262 
	#SN_ms_ext_ªq
 "msExtReq"

	)

1263 
	#LN_ms_ext_ªq
 "Mi¸oso· Exãnsi⁄ Reque°"

	)

1264 
	#NID_ms_ext_ªq
 171

	)

1265 
	#OBJ_ms_ext_ªq
 1L,3L,6L,1L,4L,1L,311L,2L,1L,14L

	)

1267 
	#SN_ms_code_öd
 "msCodeInd"

	)

1268 
	#LN_ms_code_öd
 "Mi¸oso· IndividuÆ CodêSignög"

	)

1269 
	#NID_ms_code_öd
 134

	)

1270 
	#OBJ_ms_code_öd
 1L,3L,6L,1L,4L,1L,311L,2L,1L,21L

	)

1272 
	#SN_ms_code_com
 "msCodeCom"

	)

1273 
	#LN_ms_code_com
 "Mi¸oso· Commîcü»CodêSignög"

	)

1274 
	#NID_ms_code_com
 135

	)

1275 
	#OBJ_ms_code_com
 1L,3L,6L,1L,4L,1L,311L,2L,1L,22L

	)

1277 
	#SN_ms_˘l_sign
 "msCTLSign"

	)

1278 
	#LN_ms_˘l_sign
 "Mi¸oso· Tru° Li° Signög"

	)

1279 
	#NID_ms_˘l_sign
 136

	)

1280 
	#OBJ_ms_˘l_sign
 1L,3L,6L,1L,4L,1L,311L,10L,3L,1L

	)

1282 
	#SN_ms_sgc
 "msSGC"

	)

1283 
	#LN_ms_sgc
 "Mi¸oso· Sîvî G©ed Cry±o"

	)

1284 
	#NID_ms_sgc
 137

	)

1285 
	#OBJ_ms_sgc
 1L,3L,6L,1L,4L,1L,311L,10L,3L,3L

	)

1287 
	#SN_ms_efs
 "msEFS"

	)

1288 
	#LN_ms_efs
 "Mi¸oso· En¸y±ed FûêSy°em"

	)

1289 
	#NID_ms_efs
 138

	)

1290 
	#OBJ_ms_efs
 1L,3L,6L,1L,4L,1L,311L,10L,3L,4L

	)

1292 
	#SN_ms_sm¨tˇrd_logö
 "msSm¨tˇrdLogö"

	)

1293 
	#LN_ms_sm¨tˇrd_logö
 "Mi¸oso· Sm¨tˇrdlogö"

	)

1294 
	#NID_ms_sm¨tˇrd_logö
 648

	)

1295 
	#OBJ_ms_sm¨tˇrd_logö
 1L,3L,6L,1L,4L,1L,311L,20L,2L,2L

	)

1297 
	#SN_ms_u≤
 "msUPN"

	)

1298 
	#LN_ms_u≤
 "Mi¸oso· Univîß»PröcùÆ Name"

	)

1299 
	#NID_ms_u≤
 649

	)

1300 
	#OBJ_ms_u≤
 1L,3L,6L,1L,4L,1L,311L,20L,2L,3L

	)

1302 
	#SN_idó_cbc
 "IDEA-CBC"

	)

1303 
	#LN_idó_cbc
 "idó-cbc"

	)

1304 
	#NID_idó_cbc
 34

	)

1305 
	#OBJ_idó_cbc
 1L,3L,6L,1L,4L,1L,188L,7L,1L,1L,2L

	)

1307 
	#SN_idó_ecb
 "IDEA-ECB"

	)

1308 
	#LN_idó_ecb
 "idó-ecb"

	)

1309 
	#NID_idó_ecb
 36

	)

1311 
	#SN_idó_cfb64
 "IDEA-CFB"

	)

1312 
	#LN_idó_cfb64
 "idó-cfb"

	)

1313 
	#NID_idó_cfb64
 35

	)

1315 
	#SN_idó_ofb64
 "IDEA-OFB"

	)

1316 
	#LN_idó_ofb64
 "idó-ofb"

	)

1317 
	#NID_idó_ofb64
 46

	)

1319 
	#SN_bf_cbc
 "BF-CBC"

	)

1320 
	#LN_bf_cbc
 "bf-cbc"

	)

1321 
	#NID_bf_cbc
 91

	)

1322 
	#OBJ_bf_cbc
 1L,3L,6L,1L,4L,1L,3029L,1L,2L

	)

1324 
	#SN_bf_ecb
 "BF-ECB"

	)

1325 
	#LN_bf_ecb
 "bf-ecb"

	)

1326 
	#NID_bf_ecb
 92

	)

1328 
	#SN_bf_cfb64
 "BF-CFB"

	)

1329 
	#LN_bf_cfb64
 "bf-cfb"

	)

1330 
	#NID_bf_cfb64
 93

	)

1332 
	#SN_bf_ofb64
 "BF-OFB"

	)

1333 
	#LN_bf_ofb64
 "bf-ofb"

	)

1334 
	#NID_bf_ofb64
 94

	)

1336 
	#SN_id_pkix
 "PKIX"

	)

1337 
	#NID_id_pkix
 127

	)

1338 
	#OBJ_id_pkix
 1L,3L,6L,1L,5L,5L,7L

	)

1340 
	#SN_id_pkix_mod
 "id-pkix-mod"

	)

1341 
	#NID_id_pkix_mod
 258

	)

1342 
	#OBJ_id_pkix_mod
 
OBJ_id_pkix
,0L

	)

1344 
	#SN_id_≥
 "id-≥"

	)

1345 
	#NID_id_≥
 175

	)

1346 
	#OBJ_id_≥
 
OBJ_id_pkix
,1L

	)

1348 
	#SN_id_qt
 "id-qt"

	)

1349 
	#NID_id_qt
 259

	)

1350 
	#OBJ_id_qt
 
OBJ_id_pkix
,2L

	)

1352 
	#SN_id_kp
 "id-kp"

	)

1353 
	#NID_id_kp
 128

	)

1354 
	#OBJ_id_kp
 
OBJ_id_pkix
,3L

	)

1356 
	#SN_id_ô
 "id-ô"

	)

1357 
	#NID_id_ô
 260

	)

1358 
	#OBJ_id_ô
 
OBJ_id_pkix
,4L

	)

1360 
	#SN_id_pkù
 "id-pkù"

	)

1361 
	#NID_id_pkù
 261

	)

1362 
	#OBJ_id_pkù
 
OBJ_id_pkix
,5L

	)

1364 
	#SN_id_Æg
 "id-Æg"

	)

1365 
	#NID_id_Æg
 262

	)

1366 
	#OBJ_id_Æg
 
OBJ_id_pkix
,6L

	)

1368 
	#SN_id_cmc
 "id-cmc"

	)

1369 
	#NID_id_cmc
 263

	)

1370 
	#OBJ_id_cmc
 
OBJ_id_pkix
,7L

	)

1372 
	#SN_id_⁄
 "id-⁄"

	)

1373 
	#NID_id_⁄
 264

	)

1374 
	#OBJ_id_⁄
 
OBJ_id_pkix
,8L

	)

1376 
	#SN_id_pda
 "id-pda"

	)

1377 
	#NID_id_pda
 265

	)

1378 
	#OBJ_id_pda
 
OBJ_id_pkix
,9L

	)

1380 
	#SN_id_aˇ
 "id-aˇ"

	)

1381 
	#NID_id_aˇ
 266

	)

1382 
	#OBJ_id_aˇ
 
OBJ_id_pkix
,10L

	)

1384 
	#SN_id_qcs
 "id-qcs"

	)

1385 
	#NID_id_qcs
 267

	)

1386 
	#OBJ_id_qcs
 
OBJ_id_pkix
,11L

	)

1388 
	#SN_id_c˘
 "id-c˘"

	)

1389 
	#NID_id_c˘
 268

	)

1390 
	#OBJ_id_c˘
 
OBJ_id_pkix
,12L

	)

1392 
	#SN_id_µl
 "id-µl"

	)

1393 
	#NID_id_µl
 662

	)

1394 
	#OBJ_id_µl
 
OBJ_id_pkix
,21L

	)

1396 
	#SN_id_ad
 "id-ad"

	)

1397 
	#NID_id_ad
 176

	)

1398 
	#OBJ_id_ad
 
OBJ_id_pkix
,48L

	)

1400 
	#SN_id_pkix1_ex∂icô_88
 "id-pkix1-ex∂icô-88"

	)

1401 
	#NID_id_pkix1_ex∂icô_88
 269

	)

1402 
	#OBJ_id_pkix1_ex∂icô_88
 
OBJ_id_pkix_mod
,1L

	)

1404 
	#SN_id_pkix1_im∂icô_88
 "id-pkix1-im∂icô-88"

	)

1405 
	#NID_id_pkix1_im∂icô_88
 270

	)

1406 
	#OBJ_id_pkix1_im∂icô_88
 
OBJ_id_pkix_mod
,2L

	)

1408 
	#SN_id_pkix1_ex∂icô_93
 "id-pkix1-ex∂icô-93"

	)

1409 
	#NID_id_pkix1_ex∂icô_93
 271

	)

1410 
	#OBJ_id_pkix1_ex∂icô_93
 
OBJ_id_pkix_mod
,3L

	)

1412 
	#SN_id_pkix1_im∂icô_93
 "id-pkix1-im∂icô-93"

	)

1413 
	#NID_id_pkix1_im∂icô_93
 272

	)

1414 
	#OBJ_id_pkix1_im∂icô_93
 
OBJ_id_pkix_mod
,4L

	)

1416 
	#SN_id_mod_¸mf
 "id-mod-¸mf"

	)

1417 
	#NID_id_mod_¸mf
 273

	)

1418 
	#OBJ_id_mod_¸mf
 
OBJ_id_pkix_mod
,5L

	)

1420 
	#SN_id_mod_cmc
 "id-mod-cmc"

	)

1421 
	#NID_id_mod_cmc
 274

	)

1422 
	#OBJ_id_mod_cmc
 
OBJ_id_pkix_mod
,6L

	)

1424 
	#SN_id_mod_kó_¥ofûe_88
 "id-mod-kó-¥ofûe-88"

	)

1425 
	#NID_id_mod_kó_¥ofûe_88
 275

	)

1426 
	#OBJ_id_mod_kó_¥ofûe_88
 
OBJ_id_pkix_mod
,7L

	)

1428 
	#SN_id_mod_kó_¥ofûe_93
 "id-mod-kó-¥ofûe-93"

	)

1429 
	#NID_id_mod_kó_¥ofûe_93
 276

	)

1430 
	#OBJ_id_mod_kó_¥ofûe_93
 
OBJ_id_pkix_mod
,8L

	)

1432 
	#SN_id_mod_cmp
 "id-mod-cmp"

	)

1433 
	#NID_id_mod_cmp
 277

	)

1434 
	#OBJ_id_mod_cmp
 
OBJ_id_pkix_mod
,9L

	)

1436 
	#SN_id_mod_quÆifõd_˚π_88
 "id-mod-quÆifõd-˚π-88"

	)

1437 
	#NID_id_mod_quÆifõd_˚π_88
 278

	)

1438 
	#OBJ_id_mod_quÆifõd_˚π_88
 
OBJ_id_pkix_mod
,10L

	)

1440 
	#SN_id_mod_quÆifõd_˚π_93
 "id-mod-quÆifõd-˚π-93"

	)

1441 
	#NID_id_mod_quÆifõd_˚π_93
 279

	)

1442 
	#OBJ_id_mod_quÆifõd_˚π_93
 
OBJ_id_pkix_mod
,11L

	)

1444 
	#SN_id_mod_©åibuã_˚π
 "id-mod-©åibuã-˚π"

	)

1445 
	#NID_id_mod_©åibuã_˚π
 280

	)

1446 
	#OBJ_id_mod_©åibuã_˚π
 
OBJ_id_pkix_mod
,12L

	)

1448 
	#SN_id_mod_time°amp_¥Ÿocﬁ
 "id-mod-time°amp-¥Ÿocﬁ"

	)

1449 
	#NID_id_mod_time°amp_¥Ÿocﬁ
 281

	)

1450 
	#OBJ_id_mod_time°amp_¥Ÿocﬁ
 
OBJ_id_pkix_mod
,13L

	)

1452 
	#SN_id_mod_oc•
 "id-mod-oc•"

	)

1453 
	#NID_id_mod_oc•
 282

	)

1454 
	#OBJ_id_mod_oc•
 
OBJ_id_pkix_mod
,14L

	)

1456 
	#SN_id_mod_dvcs
 "id-mod-dvcs"

	)

1457 
	#NID_id_mod_dvcs
 283

	)

1458 
	#OBJ_id_mod_dvcs
 
OBJ_id_pkix_mod
,15L

	)

1460 
	#SN_id_mod_cmp2000
 "id-mod-cmp2000"

	)

1461 
	#NID_id_mod_cmp2000
 284

	)

1462 
	#OBJ_id_mod_cmp2000
 
OBJ_id_pkix_mod
,16L

	)

1464 
	#SN_öfo_ac˚ss
 "auth‹ôyInfoAc˚ss"

	)

1465 
	#LN_öfo_ac˚ss
 "Auth‹ôy Inf‹m©i⁄ Ac˚ss"

	)

1466 
	#NID_öfo_ac˚ss
 177

	)

1467 
	#OBJ_öfo_ac˚ss
 
OBJ_id_≥
,1L

	)

1469 
	#SN_biomëricInfo
 "biomëricInfo"

	)

1470 
	#LN_biomëricInfo
 "Biomëri¯Info"

	)

1471 
	#NID_biomëricInfo
 285

	)

1472 
	#OBJ_biomëricInfo
 
OBJ_id_≥
,2L

	)

1474 
	#SN_qcSèãmíts
 "qcSèãmíts"

	)

1475 
	#NID_qcSèãmíts
 286

	)

1476 
	#OBJ_qcSèãmíts
 
OBJ_id_≥
,3L

	)

1478 
	#SN_ac_audôE¡ôy
 "ac-audôE¡ôy"

	)

1479 
	#NID_ac_audôE¡ôy
 287

	)

1480 
	#OBJ_ac_audôE¡ôy
 
OBJ_id_≥
,4L

	)

1482 
	#SN_ac_èrgëög
 "ac-èrgëög"

	)

1483 
	#NID_ac_èrgëög
 288

	)

1484 
	#OBJ_ac_èrgëög
 
OBJ_id_≥
,5L

	)

1486 
	#SN_ØC⁄åﬁs
 "ØC⁄åﬁs"

	)

1487 
	#NID_ØC⁄åﬁs
 289

	)

1488 
	#OBJ_ØC⁄åﬁs
 
OBJ_id_≥
,6L

	)

1490 
	#SN_sbgp_ùAddrBlock
 "sbgp-ùAddrBlock"

	)

1491 
	#NID_sbgp_ùAddrBlock
 290

	)

1492 
	#OBJ_sbgp_ùAddrBlock
 
OBJ_id_≥
,7L

	)

1494 
	#SN_sbgp_aut⁄omousSysNum
 "sbgp-aut⁄omousSysNum"

	)

1495 
	#NID_sbgp_aut⁄omousSysNum
 291

	)

1496 
	#OBJ_sbgp_aut⁄omousSysNum
 
OBJ_id_≥
,8L

	)

1498 
	#SN_sbgp_rouãrIdítifõr
 "sbgp-rouãrIdítifõr"

	)

1499 
	#NID_sbgp_rouãrIdítifõr
 292

	)

1500 
	#OBJ_sbgp_rouãrIdítifõr
 
OBJ_id_≥
,9L

	)

1502 
	#SN_ac_¥oxyög
 "ac-¥oxyög"

	)

1503 
	#NID_ac_¥oxyög
 397

	)

1504 
	#OBJ_ac_¥oxyög
 
OBJ_id_≥
,10L

	)

1506 
	#SN_söfo_ac˚ss
 "subje˘InfoAc˚ss"

	)

1507 
	#LN_söfo_ac˚ss
 "Subje˘ Inf‹m©i⁄ Ac˚ss"

	)

1508 
	#NID_söfo_ac˚ss
 398

	)

1509 
	#OBJ_söfo_ac˚ss
 
OBJ_id_≥
,11L

	)

1511 
	#SN_¥oxyCîtInfo
 "¥oxyCîtInfo"

	)

1512 
	#LN_¥oxyCîtInfo
 "Proxy Cîtifiˇã Inf‹m©i⁄"

	)

1513 
	#NID_¥oxyCîtInfo
 663

	)

1514 
	#OBJ_¥oxyCîtInfo
 
OBJ_id_≥
,14L

	)

1516 
	#SN_és„©uª
 "és„©uª"

	)

1517 
	#LN_és„©uª
 "TLS Fótuª"

	)

1518 
	#NID_és„©uª
 1020

	)

1519 
	#OBJ_és„©uª
 
OBJ_id_≥
,24L

	)

1521 
	#SN_id_qt_˝s
 "id-qt-˝s"

	)

1522 
	#LN_id_qt_˝s
 "Pﬁicy QuÆifõ∏CPS"

	)

1523 
	#NID_id_qt_˝s
 164

	)

1524 
	#OBJ_id_qt_˝s
 
OBJ_id_qt
,1L

	)

1526 
	#SN_id_qt_unŸi˚
 "id-qt-unŸi˚"

	)

1527 
	#LN_id_qt_unŸi˚
 "Pﬁicy QuÆifõ∏U£∏NŸi˚"

	)

1528 
	#NID_id_qt_unŸi˚
 165

	)

1529 
	#OBJ_id_qt_unŸi˚
 
OBJ_id_qt
,2L

	)

1531 
	#SN_ãxtNŸi˚
 "ãxtNŸi˚"

	)

1532 
	#NID_ãxtNŸi˚
 293

	)

1533 
	#OBJ_ãxtNŸi˚
 
OBJ_id_qt
,3L

	)

1535 
	#SN_£rvî_auth
 "£rvîAuth"

	)

1536 
	#LN_£rvî_auth
 "TLS Web Sîvî Authítiˇti⁄"

	)

1537 
	#NID_£rvî_auth
 129

	)

1538 
	#OBJ_£rvî_auth
 
OBJ_id_kp
,1L

	)

1540 
	#SN_˛õ¡_auth
 "˛õ¡Auth"

	)

1541 
	#LN_˛õ¡_auth
 "TLS Web Clõ¡ Authítiˇti⁄"

	)

1542 
	#NID_˛õ¡_auth
 130

	)

1543 
	#OBJ_˛õ¡_auth
 
OBJ_id_kp
,2L

	)

1545 
	#SN_code_sign
 "codeSignög"

	)

1546 
	#LN_code_sign
 "CodêSignög"

	)

1547 
	#NID_code_sign
 131

	)

1548 
	#OBJ_code_sign
 
OBJ_id_kp
,3L

	)

1550 
	#SN_emaû_¥Ÿe˘
 "emaûPrŸe˘i⁄"

	)

1551 
	#LN_emaû_¥Ÿe˘
 "E-maû PrŸe˘i⁄"

	)

1552 
	#NID_emaû_¥Ÿe˘
 132

	)

1553 
	#OBJ_emaû_¥Ÿe˘
 
OBJ_id_kp
,4L

	)

1555 
	#SN_ù£cEndSy°em
 "ù£cEndSy°em"

	)

1556 
	#LN_ù£cEndSy°em
 "IPSe¯End Sy°em"

	)

1557 
	#NID_ù£cEndSy°em
 294

	)

1558 
	#OBJ_ù£cEndSy°em
 
OBJ_id_kp
,5L

	)

1560 
	#SN_ù£cTu¬ñ
 "ù£cTu¬ñ"

	)

1561 
	#LN_ù£cTu¬ñ
 "IPSe¯Tu¬ñ"

	)

1562 
	#NID_ù£cTu¬ñ
 295

	)

1563 
	#OBJ_ù£cTu¬ñ
 
OBJ_id_kp
,6L

	)

1565 
	#SN_ù£cU£r
 "ù£cU£r"

	)

1566 
	#LN_ù£cU£r
 "IPSe¯U£r"

	)

1567 
	#NID_ù£cU£r
 296

	)

1568 
	#OBJ_ù£cU£r
 
OBJ_id_kp
,7L

	)

1570 
	#SN_time_°amp
 "timeSèmpög"

	)

1571 
	#LN_time_°amp
 "TimêSèmpög"

	)

1572 
	#NID_time_°amp
 133

	)

1573 
	#OBJ_time_°amp
 
OBJ_id_kp
,8L

	)

1575 
	#SN_OCSP_sign
 "OCSPSignög"

	)

1576 
	#LN_OCSP_sign
 "OCSP Signög"

	)

1577 
	#NID_OCSP_sign
 180

	)

1578 
	#OBJ_OCSP_sign
 
OBJ_id_kp
,9L

	)

1580 
	#SN_dvcs
 "DVCS"

	)

1581 
	#LN_dvcs
 "dvcs"

	)

1582 
	#NID_dvcs
 297

	)

1583 
	#OBJ_dvcs
 
OBJ_id_kp
,10L

	)

1585 
	#SN_ù£c_IKE
 "ù£cIKE"

	)

1586 
	#LN_ù£c_IKE
 "ù£¯I¡î√àKey Exch™ge"

	)

1587 
	#NID_ù£c_IKE
 1022

	)

1588 
	#OBJ_ù£c_IKE
 
OBJ_id_kp
,17L

	)

1590 
	#SN_ˇpw≠AC
 "ˇpw≠AC"

	)

1591 
	#LN_ˇpw≠AC
 "Cål/¥ovisi⁄ WAP Ac˚ss"

	)

1592 
	#NID_ˇpw≠AC
 1023

	)

1593 
	#OBJ_ˇpw≠AC
 
OBJ_id_kp
,18L

	)

1595 
	#SN_ˇpw≠WTP
 "ˇpw≠WTP"

	)

1596 
	#LN_ˇpw≠WTP
 "Cål/Provisi⁄ WAP Tîmö©i⁄"

	)

1597 
	#NID_ˇpw≠WTP
 1024

	)

1598 
	#OBJ_ˇpw≠WTP
 
OBJ_id_kp
,19L

	)

1600 
	#SN_sshClõ¡
 "£cuªShñlClõ¡"

	)

1601 
	#LN_sshClõ¡
 "SSH Clõ¡"

	)

1602 
	#NID_sshClõ¡
 1025

	)

1603 
	#OBJ_sshClõ¡
 
OBJ_id_kp
,21L

	)

1605 
	#SN_sshSîvî
 "£cuªShñlSîvî"

	)

1606 
	#LN_sshSîvî
 "SSH Sîvî"

	)

1607 
	#NID_sshSîvî
 1026

	)

1608 
	#OBJ_sshSîvî
 
OBJ_id_kp
,22L

	)

1610 
	#SN_£ndRouãr
 "£ndRouãr"

	)

1611 
	#LN_£ndRouãr
 "Síd Rouãr"

	)

1612 
	#NID_£ndRouãr
 1027

	)

1613 
	#OBJ_£ndRouãr
 
OBJ_id_kp
,23L

	)

1615 
	#SN_£ndProxõdRouãr
 "£ndProxõdRouãr"

	)

1616 
	#LN_£ndProxõdRouãr
 "Síd Proxõd Rouãr"

	)

1617 
	#NID_£ndProxõdRouãr
 1028

	)

1618 
	#OBJ_£ndProxõdRouãr
 
OBJ_id_kp
,24L

	)

1620 
	#SN_£ndOw√r
 "£ndOw√r"

	)

1621 
	#LN_£ndOw√r
 "Síd Ow√r"

	)

1622 
	#NID_£ndOw√r
 1029

	)

1623 
	#OBJ_£ndOw√r
 
OBJ_id_kp
,25L

	)

1625 
	#SN_£ndProxõdOw√r
 "£ndProxõdOw√r"

	)

1626 
	#LN_£ndProxõdOw√r
 "Síd Proxõd Ow√r"

	)

1627 
	#NID_£ndProxõdOw√r
 1030

	)

1628 
	#OBJ_£ndProxõdOw√r
 
OBJ_id_kp
,26L

	)

1630 
	#SN_cmcCA
 "cmcCA"

	)

1631 
	#LN_cmcCA
 "CMC Cîtifiˇã Auth‹ôy"

	)

1632 
	#NID_cmcCA
 1131

	)

1633 
	#OBJ_cmcCA
 
OBJ_id_kp
,27L

	)

1635 
	#SN_cmcRA
 "cmcRA"

	)

1636 
	#LN_cmcRA
 "CMC Regi°øti⁄ Auth‹ôy"

	)

1637 
	#NID_cmcRA
 1132

	)

1638 
	#OBJ_cmcRA
 
OBJ_id_kp
,28L

	)

1640 
	#SN_id_ô_ˇPrŸEncCît
 "id-ô-ˇPrŸEncCît"

	)

1641 
	#NID_id_ô_ˇPrŸEncCît
 298

	)

1642 
	#OBJ_id_ô_ˇPrŸEncCît
 
OBJ_id_ô
,1L

	)

1644 
	#SN_id_ô_signKeyPaúTy≥s
 "id-ô-signKeyPaúTy≥s"

	)

1645 
	#NID_id_ô_signKeyPaúTy≥s
 299

	)

1646 
	#OBJ_id_ô_signKeyPaúTy≥s
 
OBJ_id_ô
,2L

	)

1648 
	#SN_id_ô_ícKeyPaúTy≥s
 "id-ô-ícKeyPaúTy≥s"

	)

1649 
	#NID_id_ô_ícKeyPaúTy≥s
 300

	)

1650 
	#OBJ_id_ô_ícKeyPaúTy≥s
 
OBJ_id_ô
,3L

	)

1652 
	#SN_id_ô_¥e„ºedSymmAlg
 "id-ô-¥e„ºedSymmAlg"

	)

1653 
	#NID_id_ô_¥e„ºedSymmAlg
 301

	)

1654 
	#OBJ_id_ô_¥e„ºedSymmAlg
 
OBJ_id_ô
,4L

	)

1656 
	#SN_id_ô_ˇKeyUpd©eInfo
 "id-ô-ˇKeyUpd©eInfo"

	)

1657 
	#NID_id_ô_ˇKeyUpd©eInfo
 302

	)

1658 
	#OBJ_id_ô_ˇKeyUpd©eInfo
 
OBJ_id_ô
,5L

	)

1660 
	#SN_id_ô_cuºítCRL
 "id-ô-cuºítCRL"

	)

1661 
	#NID_id_ô_cuºítCRL
 303

	)

1662 
	#OBJ_id_ô_cuºítCRL
 
OBJ_id_ô
,6L

	)

1664 
	#SN_id_ô_unsuµ‹ãdOIDs
 "id-ô-unsuµ‹ãdOIDs"

	)

1665 
	#NID_id_ô_unsuµ‹ãdOIDs
 304

	)

1666 
	#OBJ_id_ô_unsuµ‹ãdOIDs
 
OBJ_id_ô
,7L

	)

1668 
	#SN_id_ô_subs¸ùti⁄Reque°
 "id-ô-subs¸ùti⁄Reque°"

	)

1669 
	#NID_id_ô_subs¸ùti⁄Reque°
 305

	)

1670 
	#OBJ_id_ô_subs¸ùti⁄Reque°
 
OBJ_id_ô
,8L

	)

1672 
	#SN_id_ô_subs¸ùti⁄Re•⁄£
 "id-ô-subs¸ùti⁄Re•⁄£"

	)

1673 
	#NID_id_ô_subs¸ùti⁄Re•⁄£
 306

	)

1674 
	#OBJ_id_ô_subs¸ùti⁄Re•⁄£
 
OBJ_id_ô
,9L

	)

1676 
	#SN_id_ô_keyPaúP¨amReq
 "id-ô-keyPaúP¨amReq"

	)

1677 
	#NID_id_ô_keyPaúP¨amReq
 307

	)

1678 
	#OBJ_id_ô_keyPaúP¨amReq
 
OBJ_id_ô
,10L

	)

1680 
	#SN_id_ô_keyPaúP¨amRï
 "id-ô-keyPaúP¨amRï"

	)

1681 
	#NID_id_ô_keyPaúP¨amRï
 308

	)

1682 
	#OBJ_id_ô_keyPaúP¨amRï
 
OBJ_id_ô
,11L

	)

1684 
	#SN_id_ô_ªvPas•hø£
 "id-ô-ªvPas•hø£"

	)

1685 
	#NID_id_ô_ªvPas•hø£
 309

	)

1686 
	#OBJ_id_ô_ªvPas•hø£
 
OBJ_id_ô
,12L

	)

1688 
	#SN_id_ô_im∂icôC⁄fúm
 "id-ô-im∂icôC⁄fúm"

	)

1689 
	#NID_id_ô_im∂icôC⁄fúm
 310

	)

1690 
	#OBJ_id_ô_im∂icôC⁄fúm
 
OBJ_id_ô
,13L

	)

1692 
	#SN_id_ô_c⁄fúmWaôTime
 "id-ô-c⁄fúmWaôTime"

	)

1693 
	#NID_id_ô_c⁄fúmWaôTime
 311

	)

1694 
	#OBJ_id_ô_c⁄fúmWaôTime
 
OBJ_id_ô
,14L

	)

1696 
	#SN_id_ô_‹igPKIMesßge
 "id-ô-‹igPKIMesßge"

	)

1697 
	#NID_id_ô_‹igPKIMesßge
 312

	)

1698 
	#OBJ_id_ô_‹igPKIMesßge
 
OBJ_id_ô
,15L

	)

1700 
	#SN_id_ô_suµL™gTags
 "id-ô-suµL™gTags"

	)

1701 
	#NID_id_ô_suµL™gTags
 784

	)

1702 
	#OBJ_id_ô_suµL™gTags
 
OBJ_id_ô
,16L

	)

1704 
	#SN_id_ªgCål
 "id-ªgCål"

	)

1705 
	#NID_id_ªgCål
 313

	)

1706 
	#OBJ_id_ªgCål
 
OBJ_id_pkù
,1L

	)

1708 
	#SN_id_ªgInfo
 "id-ªgInfo"

	)

1709 
	#NID_id_ªgInfo
 314

	)

1710 
	#OBJ_id_ªgInfo
 
OBJ_id_pkù
,2L

	)

1712 
	#SN_id_ªgCål_ªgTokí
 "id-ªgCål-ªgTokí"

	)

1713 
	#NID_id_ªgCål_ªgTokí
 315

	)

1714 
	#OBJ_id_ªgCål_ªgTokí
 
OBJ_id_ªgCål
,1L

	)

1716 
	#SN_id_ªgCål_authítiˇt‹
 "id-ªgCål-authítiˇt‹"

	)

1717 
	#NID_id_ªgCål_authítiˇt‹
 316

	)

1718 
	#OBJ_id_ªgCål_authítiˇt‹
 
OBJ_id_ªgCål
,2L

	)

1720 
	#SN_id_ªgCål_pkiPubliˇti⁄Info
 "id-ªgCål-pkiPubliˇti⁄Info"

	)

1721 
	#NID_id_ªgCål_pkiPubliˇti⁄Info
 317

	)

1722 
	#OBJ_id_ªgCål_pkiPubliˇti⁄Info
 
OBJ_id_ªgCål
,3L

	)

1724 
	#SN_id_ªgCål_pkiArchiveO±i⁄s
 "id-ªgCål-pkiArchiveO±i⁄s"

	)

1725 
	#NID_id_ªgCål_pkiArchiveO±i⁄s
 318

	)

1726 
	#OBJ_id_ªgCål_pkiArchiveO±i⁄s
 
OBJ_id_ªgCål
,4L

	)

1728 
	#SN_id_ªgCål_ﬁdCîtID
 "id-ªgCål-ﬁdCîtID"

	)

1729 
	#NID_id_ªgCål_ﬁdCîtID
 319

	)

1730 
	#OBJ_id_ªgCål_ﬁdCîtID
 
OBJ_id_ªgCål
,5L

	)

1732 
	#SN_id_ªgCål_¥ŸocﬁEn¸Key
 "id-ªgCål-¥ŸocﬁEn¸Key"

	)

1733 
	#NID_id_ªgCål_¥ŸocﬁEn¸Key
 320

	)

1734 
	#OBJ_id_ªgCål_¥ŸocﬁEn¸Key
 
OBJ_id_ªgCål
,6L

	)

1736 
	#SN_id_ªgInfo_utf8Paús
 "id-ªgInfo-utf8Paús"

	)

1737 
	#NID_id_ªgInfo_utf8Paús
 321

	)

1738 
	#OBJ_id_ªgInfo_utf8Paús
 
OBJ_id_ªgInfo
,1L

	)

1740 
	#SN_id_ªgInfo_˚πReq
 "id-ªgInfo-˚πReq"

	)

1741 
	#NID_id_ªgInfo_˚πReq
 322

	)

1742 
	#OBJ_id_ªgInfo_˚πReq
 
OBJ_id_ªgInfo
,2L

	)

1744 
	#SN_id_Æg_des40
 "id-Æg-des40"

	)

1745 
	#NID_id_Æg_des40
 323

	)

1746 
	#OBJ_id_Æg_des40
 
OBJ_id_Æg
,1L

	)

1748 
	#SN_id_Æg_noSig«tuª
 "id-Æg-noSig«tuª"

	)

1749 
	#NID_id_Æg_noSig«tuª
 324

	)

1750 
	#OBJ_id_Æg_noSig«tuª
 
OBJ_id_Æg
,2L

	)

1752 
	#SN_id_Æg_dh_sig_hmac_sha1
 "id-Æg-dh-sig-hmac-sha1"

	)

1753 
	#NID_id_Æg_dh_sig_hmac_sha1
 325

	)

1754 
	#OBJ_id_Æg_dh_sig_hmac_sha1
 
OBJ_id_Æg
,3L

	)

1756 
	#SN_id_Æg_dh_p›
 "id-Æg-dh-p›"

	)

1757 
	#NID_id_Æg_dh_p›
 326

	)

1758 
	#OBJ_id_Æg_dh_p›
 
OBJ_id_Æg
,4L

	)

1760 
	#SN_id_cmc_°©usInfo
 "id-cmc-°©usInfo"

	)

1761 
	#NID_id_cmc_°©usInfo
 327

	)

1762 
	#OBJ_id_cmc_°©usInfo
 
OBJ_id_cmc
,1L

	)

1764 
	#SN_id_cmc_idítifiˇti⁄
 "id-cmc-idítifiˇti⁄"

	)

1765 
	#NID_id_cmc_idítifiˇti⁄
 328

	)

1766 
	#OBJ_id_cmc_idítifiˇti⁄
 
OBJ_id_cmc
,2L

	)

1768 
	#SN_id_cmc_idítôyProof
 "id-cmc-idítôyProof"

	)

1769 
	#NID_id_cmc_idítôyProof
 329

	)

1770 
	#OBJ_id_cmc_idítôyProof
 
OBJ_id_cmc
,3L

	)

1772 
	#SN_id_cmc_d©aRëu∫
 "id-cmc-d©aRëu∫"

	)

1773 
	#NID_id_cmc_d©aRëu∫
 330

	)

1774 
	#OBJ_id_cmc_d©aRëu∫
 
OBJ_id_cmc
,4L

	)

1776 
	#SN_id_cmc_å™ß˘i⁄Id
 "id-cmc-å™ß˘i⁄Id"

	)

1777 
	#NID_id_cmc_å™ß˘i⁄Id
 331

	)

1778 
	#OBJ_id_cmc_å™ß˘i⁄Id
 
OBJ_id_cmc
,5L

	)

1780 
	#SN_id_cmc_£ndîN⁄˚
 "id-cmc-£ndîN⁄˚"

	)

1781 
	#NID_id_cmc_£ndîN⁄˚
 332

	)

1782 
	#OBJ_id_cmc_£ndîN⁄˚
 
OBJ_id_cmc
,6L

	)

1784 
	#SN_id_cmc_ªcùõ¡N⁄˚
 "id-cmc-ªcùõ¡N⁄˚"

	)

1785 
	#NID_id_cmc_ªcùõ¡N⁄˚
 333

	)

1786 
	#OBJ_id_cmc_ªcùõ¡N⁄˚
 
OBJ_id_cmc
,7L

	)

1788 
	#SN_id_cmc_addExãnsi⁄s
 "id-cmc-addExãnsi⁄s"

	)

1789 
	#NID_id_cmc_addExãnsi⁄s
 334

	)

1790 
	#OBJ_id_cmc_addExãnsi⁄s
 
OBJ_id_cmc
,8L

	)

1792 
	#SN_id_cmc_í¸y±edPOP
 "id-cmc-í¸y±edPOP"

	)

1793 
	#NID_id_cmc_í¸y±edPOP
 335

	)

1794 
	#OBJ_id_cmc_í¸y±edPOP
 
OBJ_id_cmc
,9L

	)

1796 
	#SN_id_cmc_de¸y±edPOP
 "id-cmc-de¸y±edPOP"

	)

1797 
	#NID_id_cmc_de¸y±edPOP
 336

	)

1798 
	#OBJ_id_cmc_de¸y±edPOP
 
OBJ_id_cmc
,10L

	)

1800 
	#SN_id_cmc_ÃaPOPWô√ss
 "id-cmc-ÃaPOPWô√ss"

	)

1801 
	#NID_id_cmc_ÃaPOPWô√ss
 337

	)

1802 
	#OBJ_id_cmc_ÃaPOPWô√ss
 
OBJ_id_cmc
,11L

	)

1804 
	#SN_id_cmc_gëCît
 "id-cmc-gëCît"

	)

1805 
	#NID_id_cmc_gëCît
 338

	)

1806 
	#OBJ_id_cmc_gëCît
 
OBJ_id_cmc
,15L

	)

1808 
	#SN_id_cmc_gëCRL
 "id-cmc-gëCRL"

	)

1809 
	#NID_id_cmc_gëCRL
 339

	)

1810 
	#OBJ_id_cmc_gëCRL
 
OBJ_id_cmc
,16L

	)

1812 
	#SN_id_cmc_ªvokeReque°
 "id-cmc-ªvokeReque°"

	)

1813 
	#NID_id_cmc_ªvokeReque°
 340

	)

1814 
	#OBJ_id_cmc_ªvokeReque°
 
OBJ_id_cmc
,17L

	)

1816 
	#SN_id_cmc_ªgInfo
 "id-cmc-ªgInfo"

	)

1817 
	#NID_id_cmc_ªgInfo
 341

	)

1818 
	#OBJ_id_cmc_ªgInfo
 
OBJ_id_cmc
,18L

	)

1820 
	#SN_id_cmc_ª•⁄£Info
 "id-cmc-ª•⁄£Info"

	)

1821 
	#NID_id_cmc_ª•⁄£Info
 342

	)

1822 
	#OBJ_id_cmc_ª•⁄£Info
 
OBJ_id_cmc
,19L

	)

1824 
	#SN_id_cmc_quîyPídög
 "id-cmc-quîyPídög"

	)

1825 
	#NID_id_cmc_quîyPídög
 343

	)

1826 
	#OBJ_id_cmc_quîyPídög
 
OBJ_id_cmc
,21L

	)

1828 
	#SN_id_cmc_p›LökR™dom
 "id-cmc-p›LökR™dom"

	)

1829 
	#NID_id_cmc_p›LökR™dom
 344

	)

1830 
	#OBJ_id_cmc_p›LökR™dom
 
OBJ_id_cmc
,22L

	)

1832 
	#SN_id_cmc_p›LökWô√ss
 "id-cmc-p›LökWô√ss"

	)

1833 
	#NID_id_cmc_p›LökWô√ss
 345

	)

1834 
	#OBJ_id_cmc_p›LökWô√ss
 
OBJ_id_cmc
,23L

	)

1836 
	#SN_id_cmc_c⁄fúmCîtAc˚±™˚
 "id-cmc-c⁄fúmCîtAc˚±™˚"

	)

1837 
	#NID_id_cmc_c⁄fúmCîtAc˚±™˚
 346

	)

1838 
	#OBJ_id_cmc_c⁄fúmCîtAc˚±™˚
 
OBJ_id_cmc
,24L

	)

1840 
	#SN_id_⁄_≥rs⁄ÆD©a
 "id-⁄-≥rs⁄ÆD©a"

	)

1841 
	#NID_id_⁄_≥rs⁄ÆD©a
 347

	)

1842 
	#OBJ_id_⁄_≥rs⁄ÆD©a
 
OBJ_id_⁄
,1L

	)

1844 
	#SN_id_⁄_≥rm™ítIdítifõr
 "id-⁄-≥rm™ítIdítifõr"

	)

1845 
	#LN_id_⁄_≥rm™ítIdítifõr
 "Pîm™íàIdítifõr"

	)

1846 
	#NID_id_⁄_≥rm™ítIdítifõr
 858

	)

1847 
	#OBJ_id_⁄_≥rm™ítIdítifõr
 
OBJ_id_⁄
,3L

	)

1849 
	#SN_id_pda_d©eOfBúth
 "id-pda-d©eOfBúth"

	)

1850 
	#NID_id_pda_d©eOfBúth
 348

	)

1851 
	#OBJ_id_pda_d©eOfBúth
 
OBJ_id_pda
,1L

	)

1853 
	#SN_id_pda_∂a˚OfBúth
 "id-pda-∂a˚OfBúth"

	)

1854 
	#NID_id_pda_∂a˚OfBúth
 349

	)

1855 
	#OBJ_id_pda_∂a˚OfBúth
 
OBJ_id_pda
,2L

	)

1857 
	#SN_id_pda_gídî
 "id-pda-gídî"

	)

1858 
	#NID_id_pda_gídî
 351

	)

1859 
	#OBJ_id_pda_gídî
 
OBJ_id_pda
,3L

	)

1861 
	#SN_id_pda_cou¡ryOfCôizíshù
 "id-pda-cou¡ryOfCôizíshù"

	)

1862 
	#NID_id_pda_cou¡ryOfCôizíshù
 352

	)

1863 
	#OBJ_id_pda_cou¡ryOfCôizíshù
 
OBJ_id_pda
,4L

	)

1865 
	#SN_id_pda_cou¡ryOfResidí˚
 "id-pda-cou¡ryOfResidí˚"

	)

1866 
	#NID_id_pda_cou¡ryOfResidí˚
 353

	)

1867 
	#OBJ_id_pda_cou¡ryOfResidí˚
 
OBJ_id_pda
,5L

	)

1869 
	#SN_id_aˇ_authítiˇti⁄Info
 "id-aˇ-authítiˇti⁄Info"

	)

1870 
	#NID_id_aˇ_authítiˇti⁄Info
 354

	)

1871 
	#OBJ_id_aˇ_authítiˇti⁄Info
 
OBJ_id_aˇ
,1L

	)

1873 
	#SN_id_aˇ_ac˚ssIdítôy
 "id-aˇ-ac˚ssIdítôy"

	)

1874 
	#NID_id_aˇ_ac˚ssIdítôy
 355

	)

1875 
	#OBJ_id_aˇ_ac˚ssIdítôy
 
OBJ_id_aˇ
,2L

	)

1877 
	#SN_id_aˇ_ch¨gögIdítôy
 "id-aˇ-ch¨gögIdítôy"

	)

1878 
	#NID_id_aˇ_ch¨gögIdítôy
 356

	)

1879 
	#OBJ_id_aˇ_ch¨gögIdítôy
 
OBJ_id_aˇ
,3L

	)

1881 
	#SN_id_aˇ_group
 "id-aˇ-group"

	)

1882 
	#NID_id_aˇ_group
 357

	)

1883 
	#OBJ_id_aˇ_group
 
OBJ_id_aˇ
,4L

	)

1885 
	#SN_id_aˇ_rﬁe
 "id-aˇ-rﬁe"

	)

1886 
	#NID_id_aˇ_rﬁe
 358

	)

1887 
	#OBJ_id_aˇ_rﬁe
 
OBJ_id_aˇ
,5L

	)

1889 
	#SN_id_aˇ_ícAârs
 "id-aˇ-ícAârs"

	)

1890 
	#NID_id_aˇ_ícAârs
 399

	)

1891 
	#OBJ_id_aˇ_ícAârs
 
OBJ_id_aˇ
,6L

	)

1893 
	#SN_id_qcs_pkixQCSy¡ax_v1
 "id-qcs-pkixQCSy¡ax-v1"

	)

1894 
	#NID_id_qcs_pkixQCSy¡ax_v1
 359

	)

1895 
	#OBJ_id_qcs_pkixQCSy¡ax_v1
 
OBJ_id_qcs
,1L

	)

1897 
	#SN_id_c˘_¸s
 "id-c˘-¸s"

	)

1898 
	#NID_id_c˘_¸s
 360

	)

1899 
	#OBJ_id_c˘_¸s
 
OBJ_id_c˘
,1L

	)

1901 
	#SN_id_c˘_PKID©a
 "id-c˘-PKID©a"

	)

1902 
	#NID_id_c˘_PKID©a
 361

	)

1903 
	#OBJ_id_c˘_PKID©a
 
OBJ_id_c˘
,2L

	)

1905 
	#SN_id_c˘_PKIRe•⁄£
 "id-c˘-PKIRe•⁄£"

	)

1906 
	#NID_id_c˘_PKIRe•⁄£
 362

	)

1907 
	#OBJ_id_c˘_PKIRe•⁄£
 
OBJ_id_c˘
,3L

	)

1909 
	#SN_id_µl_™yL™guage
 "id-µl-™yL™guage"

	)

1910 
	#LN_id_µl_™yL™guage
 "AnyÜ™guage"

	)

1911 
	#NID_id_µl_™yL™guage
 664

	)

1912 
	#OBJ_id_µl_™yL™guage
 
OBJ_id_µl
,0L

	)

1914 
	#SN_id_µl_öhîôAŒ
 "id-µl-öhîôAŒ"

	)

1915 
	#LN_id_µl_öhîôAŒ
 "InhîôáŒ"

	)

1916 
	#NID_id_µl_öhîôAŒ
 665

	)

1917 
	#OBJ_id_µl_öhîôAŒ
 
OBJ_id_µl
,1L

	)

1919 
	#SN_Indïídít
 "id-µl-ödïídít"

	)

1920 
	#LN_Indïídít
 "Indïídít"

	)

1921 
	#NID_Indïídít
 667

	)

1922 
	#OBJ_Indïídít
 
OBJ_id_µl
,2L

	)

1924 
	#SN_ad_OCSP
 "OCSP"

	)

1925 
	#LN_ad_OCSP
 "OCSP"

	)

1926 
	#NID_ad_OCSP
 178

	)

1927 
	#OBJ_ad_OCSP
 
OBJ_id_ad
,1L

	)

1929 
	#SN_ad_ˇ_issuîs
 "ˇIssuîs"

	)

1930 
	#LN_ad_ˇ_issuîs
 "CA Issuîs"

	)

1931 
	#NID_ad_ˇ_issuîs
 179

	)

1932 
	#OBJ_ad_ˇ_issuîs
 
OBJ_id_ad
,2L

	)

1934 
	#SN_ad_timeSèmpög
 "ad_time°ampög"

	)

1935 
	#LN_ad_timeSèmpög
 "AD TimêSèmpög"

	)

1936 
	#NID_ad_timeSèmpög
 363

	)

1937 
	#OBJ_ad_timeSèmpög
 
OBJ_id_ad
,3L

	)

1939 
	#SN_ad_dvcs
 "AD_DVCS"

	)

1940 
	#LN_ad_dvcs
 "ad dvcs"

	)

1941 
	#NID_ad_dvcs
 364

	)

1942 
	#OBJ_ad_dvcs
 
OBJ_id_ad
,4L

	)

1944 
	#SN_ˇRïosô‹y
 "ˇRïosô‹y"

	)

1945 
	#LN_ˇRïosô‹y
 "CA Rïosô‹y"

	)

1946 
	#NID_ˇRïosô‹y
 785

	)

1947 
	#OBJ_ˇRïosô‹y
 
OBJ_id_ad
,5L

	)

1949 
	#OBJ_id_pkix_OCSP
 
OBJ_ad_OCSP


	)

1951 
	#SN_id_pkix_OCSP_basic
 "basicOCSPRe•⁄£"

	)

1952 
	#LN_id_pkix_OCSP_basic
 "Basi¯OCSP Re•⁄£"

	)

1953 
	#NID_id_pkix_OCSP_basic
 365

	)

1954 
	#OBJ_id_pkix_OCSP_basic
 
OBJ_id_pkix_OCSP
,1L

	)

1956 
	#SN_id_pkix_OCSP_N⁄˚
 "N⁄˚"

	)

1957 
	#LN_id_pkix_OCSP_N⁄˚
 "OCSP N⁄˚"

	)

1958 
	#NID_id_pkix_OCSP_N⁄˚
 366

	)

1959 
	#OBJ_id_pkix_OCSP_N⁄˚
 
OBJ_id_pkix_OCSP
,2L

	)

1961 
	#SN_id_pkix_OCSP_CæID
 "CæID"

	)

1962 
	#LN_id_pkix_OCSP_CæID
 "OCSP CRL ID"

	)

1963 
	#NID_id_pkix_OCSP_CæID
 367

	)

1964 
	#OBJ_id_pkix_OCSP_CæID
 
OBJ_id_pkix_OCSP
,3L

	)

1966 
	#SN_id_pkix_OCSP_ac˚±abÀRe•⁄£s
 "ac˚±abÀRe•⁄£s"

	)

1967 
	#LN_id_pkix_OCSP_ac˚±abÀRe•⁄£s
 "Ac˚±abÀ OCSP Re•⁄£s"

	)

1968 
	#NID_id_pkix_OCSP_ac˚±abÀRe•⁄£s
 368

	)

1969 
	#OBJ_id_pkix_OCSP_ac˚±abÀRe•⁄£s
 
OBJ_id_pkix_OCSP
,4L

	)

1971 
	#SN_id_pkix_OCSP_noCheck
 "noCheck"

	)

1972 
	#LN_id_pkix_OCSP_noCheck
 "OCSP NÿCheck"

	)

1973 
	#NID_id_pkix_OCSP_noCheck
 369

	)

1974 
	#OBJ_id_pkix_OCSP_noCheck
 
OBJ_id_pkix_OCSP
,5L

	)

1976 
	#SN_id_pkix_OCSP_¨chiveCutoff
 "¨chiveCutoff"

	)

1977 
	#LN_id_pkix_OCSP_¨chiveCutoff
 "OCSP ArchivêCutoff"

	)

1978 
	#NID_id_pkix_OCSP_¨chiveCutoff
 370

	)

1979 
	#OBJ_id_pkix_OCSP_¨chiveCutoff
 
OBJ_id_pkix_OCSP
,6L

	)

1981 
	#SN_id_pkix_OCSP_£rvi˚Loˇt‹
 "£rvi˚Loˇt‹"

	)

1982 
	#LN_id_pkix_OCSP_£rvi˚Loˇt‹
 "OCSP Sîvi˚ Loˇt‹"

	)

1983 
	#NID_id_pkix_OCSP_£rvi˚Loˇt‹
 371

	)

1984 
	#OBJ_id_pkix_OCSP_£rvi˚Loˇt‹
 
OBJ_id_pkix_OCSP
,7L

	)

1986 
	#SN_id_pkix_OCSP_exãndedSètus
 "exãndedSètus"

	)

1987 
	#LN_id_pkix_OCSP_exãndedSètus
 "Exãnded OCSP Sètus"

	)

1988 
	#NID_id_pkix_OCSP_exãndedSètus
 372

	)

1989 
	#OBJ_id_pkix_OCSP_exãndedSètus
 
OBJ_id_pkix_OCSP
,8L

	)

1991 
	#SN_id_pkix_OCSP_vÆid
 "vÆid"

	)

1992 
	#NID_id_pkix_OCSP_vÆid
 373

	)

1993 
	#OBJ_id_pkix_OCSP_vÆid
 
OBJ_id_pkix_OCSP
,9L

	)

1995 
	#SN_id_pkix_OCSP_∑th
 "∑th"

	)

1996 
	#NID_id_pkix_OCSP_∑th
 374

	)

1997 
	#OBJ_id_pkix_OCSP_∑th
 
OBJ_id_pkix_OCSP
,10L

	)

1999 
	#SN_id_pkix_OCSP_åu°RoŸ
 "åu°RoŸ"

	)

2000 
	#LN_id_pkix_OCSP_åu°RoŸ
 "Tru° RoŸ"

	)

2001 
	#NID_id_pkix_OCSP_åu°RoŸ
 375

	)

2002 
	#OBJ_id_pkix_OCSP_åu°RoŸ
 
OBJ_id_pkix_OCSP
,11L

	)

2004 
	#SN_Æg‹ôhm
 "Æg‹ôhm"

	)

2005 
	#LN_Æg‹ôhm
 "Æg‹ôhm"

	)

2006 
	#NID_Æg‹ôhm
 376

	)

2007 
	#OBJ_Æg‹ôhm
 1L,3L,14L,3L,2L

	)

2009 
	#SN_md5WôhRSA
 "RSA-NP-MD5"

	)

2010 
	#LN_md5WôhRSA
 "md5WôhRSA"

	)

2011 
	#NID_md5WôhRSA
 104

	)

2012 
	#OBJ_md5WôhRSA
 
OBJ_Æg‹ôhm
,3L

	)

2014 
	#SN_des_ecb
 "DES-ECB"

	)

2015 
	#LN_des_ecb
 "des-ecb"

	)

2016 
	#NID_des_ecb
 29

	)

2017 
	#OBJ_des_ecb
 
OBJ_Æg‹ôhm
,6L

	)

2019 
	#SN_des_cbc
 "DES-CBC"

	)

2020 
	#LN_des_cbc
 "des-cbc"

	)

2021 
	#NID_des_cbc
 31

	)

2022 
	#OBJ_des_cbc
 
OBJ_Æg‹ôhm
,7L

	)

2024 
	#SN_des_ofb64
 "DES-OFB"

	)

2025 
	#LN_des_ofb64
 "des-ofb"

	)

2026 
	#NID_des_ofb64
 45

	)

2027 
	#OBJ_des_ofb64
 
OBJ_Æg‹ôhm
,8L

	)

2029 
	#SN_des_cfb64
 "DES-CFB"

	)

2030 
	#LN_des_cfb64
 "des-cfb"

	)

2031 
	#NID_des_cfb64
 30

	)

2032 
	#OBJ_des_cfb64
 
OBJ_Æg‹ôhm
,9L

	)

2034 
	#SN_rßSig«tuª
 "rßSig«tuª"

	)

2035 
	#NID_rßSig«tuª
 377

	)

2036 
	#OBJ_rßSig«tuª
 
OBJ_Æg‹ôhm
,11L

	)

2038 
	#SN_dß_2
 "DSA-ﬁd"

	)

2039 
	#LN_dß_2
 "dßEn¸y±i⁄-ﬁd"

	)

2040 
	#NID_dß_2
 67

	)

2041 
	#OBJ_dß_2
 
OBJ_Æg‹ôhm
,12L

	)

2043 
	#SN_dßWôhSHA
 "DSA-SHA"

	)

2044 
	#LN_dßWôhSHA
 "dßWôhSHA"

	)

2045 
	#NID_dßWôhSHA
 66

	)

2046 
	#OBJ_dßWôhSHA
 
OBJ_Æg‹ôhm
,13L

	)

2048 
	#SN_shaWôhRSAEn¸y±i⁄
 "RSA-SHA"

	)

2049 
	#LN_shaWôhRSAEn¸y±i⁄
 "shaWôhRSAEn¸y±i⁄"

	)

2050 
	#NID_shaWôhRSAEn¸y±i⁄
 42

	)

2051 
	#OBJ_shaWôhRSAEn¸y±i⁄
 
OBJ_Æg‹ôhm
,15L

	)

2053 
	#SN_des_ede_ecb
 "DES-EDE"

	)

2054 
	#LN_des_ede_ecb
 "des-ede"

	)

2055 
	#NID_des_ede_ecb
 32

	)

2056 
	#OBJ_des_ede_ecb
 
OBJ_Æg‹ôhm
,17L

	)

2058 
	#SN_des_ede3_ecb
 "DES-EDE3"

	)

2059 
	#LN_des_ede3_ecb
 "des-ede3"

	)

2060 
	#NID_des_ede3_ecb
 33

	)

2062 
	#SN_des_ede_cbc
 "DES-EDE-CBC"

	)

2063 
	#LN_des_ede_cbc
 "des-ede-cbc"

	)

2064 
	#NID_des_ede_cbc
 43

	)

2066 
	#SN_des_ede_cfb64
 "DES-EDE-CFB"

	)

2067 
	#LN_des_ede_cfb64
 "des-ede-cfb"

	)

2068 
	#NID_des_ede_cfb64
 60

	)

2070 
	#SN_des_ede3_cfb64
 "DES-EDE3-CFB"

	)

2071 
	#LN_des_ede3_cfb64
 "des-ede3-cfb"

	)

2072 
	#NID_des_ede3_cfb64
 61

	)

2074 
	#SN_des_ede_ofb64
 "DES-EDE-OFB"

	)

2075 
	#LN_des_ede_ofb64
 "des-ede-ofb"

	)

2076 
	#NID_des_ede_ofb64
 62

	)

2078 
	#SN_des_ede3_ofb64
 "DES-EDE3-OFB"

	)

2079 
	#LN_des_ede3_ofb64
 "des-ede3-ofb"

	)

2080 
	#NID_des_ede3_ofb64
 63

	)

2082 
	#SN_desx_cbc
 "DESX-CBC"

	)

2083 
	#LN_desx_cbc
 "desx-cbc"

	)

2084 
	#NID_desx_cbc
 80

	)

2086 
	#SN_sha
 "SHA"

	)

2087 
	#LN_sha
 "sha"

	)

2088 
	#NID_sha
 41

	)

2089 
	#OBJ_sha
 
OBJ_Æg‹ôhm
,18L

	)

2091 
	#SN_sha1
 "SHA1"

	)

2092 
	#LN_sha1
 "sha1"

	)

2093 
	#NID_sha1
 64

	)

2094 
	#OBJ_sha1
 
OBJ_Æg‹ôhm
,26L

	)

2096 
	#SN_dßWôhSHA1_2
 "DSA-SHA1-ﬁd"

	)

2097 
	#LN_dßWôhSHA1_2
 "dßWôhSHA1-ﬁd"

	)

2098 
	#NID_dßWôhSHA1_2
 70

	)

2099 
	#OBJ_dßWôhSHA1_2
 
OBJ_Æg‹ôhm
,27L

	)

2101 
	#SN_sha1WôhRSA
 "RSA-SHA1-2"

	)

2102 
	#LN_sha1WôhRSA
 "sha1WôhRSA"

	)

2103 
	#NID_sha1WôhRSA
 115

	)

2104 
	#OBJ_sha1WôhRSA
 
OBJ_Æg‹ôhm
,29L

	)

2106 
	#SN_rùemd160
 "RIPEMD160"

	)

2107 
	#LN_rùemd160
 "rùemd160"

	)

2108 
	#NID_rùemd160
 117

	)

2109 
	#OBJ_rùemd160
 1L,3L,36L,3L,2L,1L

	)

2111 
	#SN_rùemd160WôhRSA
 "RSA-RIPEMD160"

	)

2112 
	#LN_rùemd160WôhRSA
 "rùemd160WôhRSA"

	)

2113 
	#NID_rùemd160WôhRSA
 119

	)

2114 
	#OBJ_rùemd160WôhRSA
 1L,3L,36L,3L,3L,1L,2L

	)

2116 
	#SN_bœke2b512
 "BLAKE2b512"

	)

2117 
	#LN_bœke2b512
 "bœke2b512"

	)

2118 
	#NID_bœke2b512
 1056

	)

2119 
	#OBJ_bœke2b512
 1L,3L,6L,1L,4L,1L,1722L,12L,2L,1L,16L

	)

2121 
	#SN_bœke2s256
 "BLAKE2s256"

	)

2122 
	#LN_bœke2s256
 "bœke2s256"

	)

2123 
	#NID_bœke2s256
 1057

	)

2124 
	#OBJ_bœke2s256
 1L,3L,6L,1L,4L,1L,1722L,12L,2L,2L,8L

	)

2126 
	#SN_sx√t
 "SXNëID"

	)

2127 
	#LN_sx√t
 "Så⁄g Exå™ë ID"

	)

2128 
	#NID_sx√t
 143

	)

2129 
	#OBJ_sx√t
 1L,3L,101L,1L,4L,1L

	)

2131 
	#SN_X500
 "X500"

	)

2132 
	#LN_X500
 "dúe˘‹y sîvi˚†(X.500)"

	)

2133 
	#NID_X500
 11

	)

2134 
	#OBJ_X500
 2L,5L

	)

2136 
	#SN_X509
 "X509"

	)

2137 
	#NID_X509
 12

	)

2138 
	#OBJ_X509
 
OBJ_X500
,4L

	)

2140 
	#SN_comm⁄Name
 "CN"

	)

2141 
	#LN_comm⁄Name
 "comm⁄Name"

	)

2142 
	#NID_comm⁄Name
 13

	)

2143 
	#OBJ_comm⁄Name
 
OBJ_X509
,3L

	)

2145 
	#SN_su∫ame
 "SN"

	)

2146 
	#LN_su∫ame
 "su∫ame"

	)

2147 
	#NID_su∫ame
 100

	)

2148 
	#OBJ_su∫ame
 
OBJ_X509
,4L

	)

2150 
	#LN_£rülNumbî
 "£rülNumbî"

	)

2151 
	#NID_£rülNumbî
 105

	)

2152 
	#OBJ_£rülNumbî
 
OBJ_X509
,5L

	)

2154 
	#SN_cou¡ryName
 "C"

	)

2155 
	#LN_cou¡ryName
 "cou¡ryName"

	)

2156 
	#NID_cou¡ryName
 14

	)

2157 
	#OBJ_cou¡ryName
 
OBJ_X509
,6L

	)

2159 
	#SN_loˇlôyName
 "L"

	)

2160 
	#LN_loˇlôyName
 "loˇlôyName"

	)

2161 
	#NID_loˇlôyName
 15

	)

2162 
	#OBJ_loˇlôyName
 
OBJ_X509
,7L

	)

2164 
	#SN_°©eOrProvö˚Name
 "ST"

	)

2165 
	#LN_°©eOrProvö˚Name
 "°©eOrProvö˚Name"

	)

2166 
	#NID_°©eOrProvö˚Name
 16

	)

2167 
	#OBJ_°©eOrProvö˚Name
 
OBJ_X509
,8L

	)

2169 
	#SN_°ªëAddªss
 "°ªë"

	)

2170 
	#LN_°ªëAddªss
 "°ªëAddªss"

	)

2171 
	#NID_°ªëAddªss
 660

	)

2172 
	#OBJ_°ªëAddªss
 
OBJ_X509
,9L

	)

2174 
	#SN_‹g™iz©i⁄Name
 "O"

	)

2175 
	#LN_‹g™iz©i⁄Name
 "‹g™iz©i⁄Name"

	)

2176 
	#NID_‹g™iz©i⁄Name
 17

	)

2177 
	#OBJ_‹g™iz©i⁄Name
 
OBJ_X509
,10L

	)

2179 
	#SN_‹g™iz©i⁄ÆUnôName
 "OU"

	)

2180 
	#LN_‹g™iz©i⁄ÆUnôName
 "‹g™iz©i⁄ÆUnôName"

	)

2181 
	#NID_‹g™iz©i⁄ÆUnôName
 18

	)

2182 
	#OBJ_‹g™iz©i⁄ÆUnôName
 
OBJ_X509
,11L

	)

2184 
	#SN_tôÀ
 "tôÀ"

	)

2185 
	#LN_tôÀ
 "tôÀ"

	)

2186 
	#NID_tôÀ
 106

	)

2187 
	#OBJ_tôÀ
 
OBJ_X509
,12L

	)

2189 
	#LN_des¸ùti⁄
 "des¸ùti⁄"

	)

2190 
	#NID_des¸ùti⁄
 107

	)

2191 
	#OBJ_des¸ùti⁄
 
OBJ_X509
,13L

	)

2193 
	#LN_£¨chGuide
 "£¨chGuide"

	)

2194 
	#NID_£¨chGuide
 859

	)

2195 
	#OBJ_£¨chGuide
 
OBJ_X509
,14L

	)

2197 
	#LN_busöessC©eg‹y
 "busöessC©eg‹y"

	)

2198 
	#NID_busöessC©eg‹y
 860

	)

2199 
	#OBJ_busöessC©eg‹y
 
OBJ_X509
,15L

	)

2201 
	#LN_po°ÆAddªss
 "po°ÆAddªss"

	)

2202 
	#NID_po°ÆAddªss
 861

	)

2203 
	#OBJ_po°ÆAddªss
 
OBJ_X509
,16L

	)

2205 
	#LN_po°ÆCode
 "po°ÆCode"

	)

2206 
	#NID_po°ÆCode
 661

	)

2207 
	#OBJ_po°ÆCode
 
OBJ_X509
,17L

	)

2209 
	#LN_po°Offi˚Box
 "po°Offi˚Box"

	)

2210 
	#NID_po°Offi˚Box
 862

	)

2211 
	#OBJ_po°Offi˚Box
 
OBJ_X509
,18L

	)

2213 
	#LN_physiˇlDñivîyOffi˚Name
 "physiˇlDñivîyOffi˚Name"

	)

2214 
	#NID_physiˇlDñivîyOffi˚Name
 863

	)

2215 
	#OBJ_physiˇlDñivîyOffi˚Name
 
OBJ_X509
,19L

	)

2217 
	#LN_ãÀph⁄eNumbî
 "ãÀph⁄eNumbî"

	)

2218 
	#NID_ãÀph⁄eNumbî
 864

	)

2219 
	#OBJ_ãÀph⁄eNumbî
 
OBJ_X509
,20L

	)

2221 
	#LN_ãÀxNumbî
 "ãÀxNumbî"

	)

2222 
	#NID_ãÀxNumbî
 865

	)

2223 
	#OBJ_ãÀxNumbî
 
OBJ_X509
,21L

	)

2225 
	#LN_ãÀãxTîmöÆIdítifõr
 "ãÀãxTîmöÆIdítifõr"

	)

2226 
	#NID_ãÀãxTîmöÆIdítifõr
 866

	)

2227 
	#OBJ_ãÀãxTîmöÆIdítifõr
 
OBJ_X509
,22L

	)

2229 
	#LN_ÁcsimûeTñïh⁄eNumbî
 "ÁcsimûeTñïh⁄eNumbî"

	)

2230 
	#NID_ÁcsimûeTñïh⁄eNumbî
 867

	)

2231 
	#OBJ_ÁcsimûeTñïh⁄eNumbî
 
OBJ_X509
,23L

	)

2233 
	#LN_x121Addªss
 "x121Addªss"

	)

2234 
	#NID_x121Addªss
 868

	)

2235 
	#OBJ_x121Addªss
 
OBJ_X509
,24L

	)

2237 
	#LN_öã∫©i⁄ÆiSDNNumbî
 "öã∫©i⁄ÆiSDNNumbî"

	)

2238 
	#NID_öã∫©i⁄ÆiSDNNumbî
 869

	)

2239 
	#OBJ_öã∫©i⁄ÆiSDNNumbî
 
OBJ_X509
,25L

	)

2241 
	#LN_ªgi°îedAddªss
 "ªgi°îedAddªss"

	)

2242 
	#NID_ªgi°îedAddªss
 870

	)

2243 
	#OBJ_ªgi°îedAddªss
 
OBJ_X509
,26L

	)

2245 
	#LN_de°ö©i⁄Indiˇt‹
 "de°ö©i⁄Indiˇt‹"

	)

2246 
	#NID_de°ö©i⁄Indiˇt‹
 871

	)

2247 
	#OBJ_de°ö©i⁄Indiˇt‹
 
OBJ_X509
,27L

	)

2249 
	#LN_¥e„ºedDñivîyMëhod
 "¥e„ºedDñivîyMëhod"

	)

2250 
	#NID_¥e„ºedDñivîyMëhod
 872

	)

2251 
	#OBJ_¥e„ºedDñivîyMëhod
 
OBJ_X509
,28L

	)

2253 
	#LN_¥e£¡©i⁄Addªss
 "¥e£¡©i⁄Addªss"

	)

2254 
	#NID_¥e£¡©i⁄Addªss
 873

	)

2255 
	#OBJ_¥e£¡©i⁄Addªss
 
OBJ_X509
,29L

	)

2257 
	#LN_suµ‹ãdAµliˇti⁄C⁄ãxt
 "suµ‹ãdAµliˇti⁄C⁄ãxt"

	)

2258 
	#NID_suµ‹ãdAµliˇti⁄C⁄ãxt
 874

	)

2259 
	#OBJ_suµ‹ãdAµliˇti⁄C⁄ãxt
 
OBJ_X509
,30L

	)

2261 
	#SN_membî
 "membî"

	)

2262 
	#NID_membî
 875

	)

2263 
	#OBJ_membî
 
OBJ_X509
,31L

	)

2265 
	#SN_ow√r
 "ow√r"

	)

2266 
	#NID_ow√r
 876

	)

2267 
	#OBJ_ow√r
 
OBJ_X509
,32L

	)

2269 
	#LN_rﬁeOccu∑¡
 "rﬁeOccu∑¡"

	)

2270 
	#NID_rﬁeOccu∑¡
 877

	)

2271 
	#OBJ_rﬁeOccu∑¡
 
OBJ_X509
,33L

	)

2273 
	#SN_£eAlso
 "£eAlso"

	)

2274 
	#NID_£eAlso
 878

	)

2275 
	#OBJ_£eAlso
 
OBJ_X509
,34L

	)

2277 
	#LN_u£rPassw‹d
 "u£rPassw‹d"

	)

2278 
	#NID_u£rPassw‹d
 879

	)

2279 
	#OBJ_u£rPassw‹d
 
OBJ_X509
,35L

	)

2281 
	#LN_u£rCîtifiˇã
 "u£rCîtifiˇã"

	)

2282 
	#NID_u£rCîtifiˇã
 880

	)

2283 
	#OBJ_u£rCîtifiˇã
 
OBJ_X509
,36L

	)

2285 
	#LN_cACîtifiˇã
 "cACîtifiˇã"

	)

2286 
	#NID_cACîtifiˇã
 881

	)

2287 
	#OBJ_cACîtifiˇã
 
OBJ_X509
,37L

	)

2289 
	#LN_auth‹ôyRevoˇti⁄Li°
 "auth‹ôyRevoˇti⁄Li°"

	)

2290 
	#NID_auth‹ôyRevoˇti⁄Li°
 882

	)

2291 
	#OBJ_auth‹ôyRevoˇti⁄Li°
 
OBJ_X509
,38L

	)

2293 
	#LN_˚πifiˇãRevoˇti⁄Li°
 "˚πifiˇãRevoˇti⁄Li°"

	)

2294 
	#NID_˚πifiˇãRevoˇti⁄Li°
 883

	)

2295 
	#OBJ_˚πifiˇãRevoˇti⁄Li°
 
OBJ_X509
,39L

	)

2297 
	#LN_¸ossCîtifiˇãPaú
 "¸ossCîtifiˇãPaú"

	)

2298 
	#NID_¸ossCîtifiˇãPaú
 884

	)

2299 
	#OBJ_¸ossCîtifiˇãPaú
 
OBJ_X509
,40L

	)

2301 
	#SN_«me
 "«me"

	)

2302 
	#LN_«me
 "«me"

	)

2303 
	#NID_«me
 173

	)

2304 
	#OBJ_«me
 
OBJ_X509
,41L

	)

2306 
	#SN_givíName
 "GN"

	)

2307 
	#LN_givíName
 "givíName"

	)

2308 
	#NID_givíName
 99

	)

2309 
	#OBJ_givíName
 
OBJ_X509
,42L

	)

2311 
	#SN_öôüls
 "öôüls"

	)

2312 
	#LN_öôüls
 "öôüls"

	)

2313 
	#NID_öôüls
 101

	)

2314 
	#OBJ_öôüls
 
OBJ_X509
,43L

	)

2316 
	#LN_gíî©i⁄QuÆifõr
 "gíî©i⁄QuÆifõr"

	)

2317 
	#NID_gíî©i⁄QuÆifõr
 509

	)

2318 
	#OBJ_gíî©i⁄QuÆifõr
 
OBJ_X509
,44L

	)

2320 
	#LN_x500UniqueIdítifõr
 "x500UniqueIdítifõr"

	)

2321 
	#NID_x500UniqueIdítifõr
 503

	)

2322 
	#OBJ_x500UniqueIdítifõr
 
OBJ_X509
,45L

	)

2324 
	#SN_dnQuÆifõr
 "dnQuÆifõr"

	)

2325 
	#LN_dnQuÆifõr
 "dnQuÆifõr"

	)

2326 
	#NID_dnQuÆifõr
 174

	)

2327 
	#OBJ_dnQuÆifõr
 
OBJ_X509
,46L

	)

2329 
	#LN_íh™˚dSórchGuide
 "íh™˚dSórchGuide"

	)

2330 
	#NID_íh™˚dSórchGuide
 885

	)

2331 
	#OBJ_íh™˚dSórchGuide
 
OBJ_X509
,47L

	)

2333 
	#LN_¥ŸocﬁInf‹m©i⁄
 "¥ŸocﬁInf‹m©i⁄"

	)

2334 
	#NID_¥ŸocﬁInf‹m©i⁄
 886

	)

2335 
	#OBJ_¥ŸocﬁInf‹m©i⁄
 
OBJ_X509
,48L

	)

2337 
	#LN_di°öguishedName
 "di°öguishedName"

	)

2338 
	#NID_di°öguishedName
 887

	)

2339 
	#OBJ_di°öguishedName
 
OBJ_X509
,49L

	)

2341 
	#LN_uniqueMembî
 "uniqueMembî"

	)

2342 
	#NID_uniqueMembî
 888

	)

2343 
	#OBJ_uniqueMembî
 
OBJ_X509
,50L

	)

2345 
	#LN_hou£Idítifõr
 "hou£Idítifõr"

	)

2346 
	#NID_hou£Idítifõr
 889

	)

2347 
	#OBJ_hou£Idítifõr
 
OBJ_X509
,51L

	)

2349 
	#LN_suµ‹ãdAlg‹ôhms
 "suµ‹ãdAlg‹ôhms"

	)

2350 
	#NID_suµ‹ãdAlg‹ôhms
 890

	)

2351 
	#OBJ_suµ‹ãdAlg‹ôhms
 
OBJ_X509
,52L

	)

2353 
	#LN_dñèRevoˇti⁄Li°
 "dñèRevoˇti⁄Li°"

	)

2354 
	#NID_dñèRevoˇti⁄Li°
 891

	)

2355 
	#OBJ_dñèRevoˇti⁄Li°
 
OBJ_X509
,53L

	)

2357 
	#SN_dmdName
 "dmdName"

	)

2358 
	#NID_dmdName
 892

	)

2359 
	#OBJ_dmdName
 
OBJ_X509
,54L

	)

2361 
	#LN_p£ud⁄ym
 "p£ud⁄ym"

	)

2362 
	#NID_p£ud⁄ym
 510

	)

2363 
	#OBJ_p£ud⁄ym
 
OBJ_X509
,65L

	)

2365 
	#SN_rﬁe
 "rﬁe"

	)

2366 
	#LN_rﬁe
 "rﬁe"

	)

2367 
	#NID_rﬁe
 400

	)

2368 
	#OBJ_rﬁe
 
OBJ_X509
,72L

	)

2370 
	#LN_‹g™iz©i⁄Idítifõr
 "‹g™iz©i⁄Idítifõr"

	)

2371 
	#NID_‹g™iz©i⁄Idítifõr
 1089

	)

2372 
	#OBJ_‹g™iz©i⁄Idítifõr
 
OBJ_X509
,97L

	)

2374 
	#SN_cou¡ryCode3c
 "c3"

	)

2375 
	#LN_cou¡ryCode3c
 "cou¡ryCode3c"

	)

2376 
	#NID_cou¡ryCode3c
 1090

	)

2377 
	#OBJ_cou¡ryCode3c
 
OBJ_X509
,98L

	)

2379 
	#SN_cou¡ryCode3n
 "n3"

	)

2380 
	#LN_cou¡ryCode3n
 "cou¡ryCode3n"

	)

2381 
	#NID_cou¡ryCode3n
 1091

	)

2382 
	#OBJ_cou¡ryCode3n
 
OBJ_X509
,99L

	)

2384 
	#LN_dnsName
 "dnsName"

	)

2385 
	#NID_dnsName
 1092

	)

2386 
	#OBJ_dnsName
 
OBJ_X509
,100L

	)

2388 
	#SN_X500Æg‹ôhms
 "X500Æg‹ôhms"

	)

2389 
	#LN_X500Æg‹ôhms
 "dúe˘‹y sîvi˚†-álg‹ôhms"

	)

2390 
	#NID_X500Æg‹ôhms
 378

	)

2391 
	#OBJ_X500Æg‹ôhms
 
OBJ_X500
,8L

	)

2393 
	#SN_rß
 "RSA"

	)

2394 
	#LN_rß
 "rß"

	)

2395 
	#NID_rß
 19

	)

2396 
	#OBJ_rß
 
OBJ_X500Æg‹ôhms
,1L,1L

	)

2398 
	#SN_mdc2WôhRSA
 "RSA-MDC2"

	)

2399 
	#LN_mdc2WôhRSA
 "mdc2WôhRSA"

	)

2400 
	#NID_mdc2WôhRSA
 96

	)

2401 
	#OBJ_mdc2WôhRSA
 
OBJ_X500Æg‹ôhms
,3L,100L

	)

2403 
	#SN_mdc2
 "MDC2"

	)

2404 
	#LN_mdc2
 "mdc2"

	)

2405 
	#NID_mdc2
 95

	)

2406 
	#OBJ_mdc2
 
OBJ_X500Æg‹ôhms
,3L,101L

	)

2408 
	#SN_id_˚
 "id-˚"

	)

2409 
	#NID_id_˚
 81

	)

2410 
	#OBJ_id_˚
 
OBJ_X500
,29L

	)

2412 
	#SN_subje˘_dúe˘‹y_©åibuãs
 "subje˘Dúe˘‹yAâribuãs"

	)

2413 
	#LN_subje˘_dúe˘‹y_©åibuãs
 "X509v3 Subje˘ Dúe˘‹y Aâribuãs"

	)

2414 
	#NID_subje˘_dúe˘‹y_©åibuãs
 769

	)

2415 
	#OBJ_subje˘_dúe˘‹y_©åibuãs
 
OBJ_id_˚
,9L

	)

2417 
	#SN_subje˘_key_idítifõr
 "subje˘KeyIdítifõr"

	)

2418 
	#LN_subje˘_key_idítifõr
 "X509v3 Subje˘ Key Idítifõr"

	)

2419 
	#NID_subje˘_key_idítifõr
 82

	)

2420 
	#OBJ_subje˘_key_idítifõr
 
OBJ_id_˚
,14L

	)

2422 
	#SN_key_ußge
 "keyUßge"

	)

2423 
	#LN_key_ußge
 "X509v3 Key Ußge"

	)

2424 
	#NID_key_ußge
 83

	)

2425 
	#OBJ_key_ußge
 
OBJ_id_˚
,15L

	)

2427 
	#SN_¥iv©e_key_ußge_≥riod
 "¥iv©eKeyUßgePîiod"

	)

2428 
	#LN_¥iv©e_key_ußge_≥riod
 "X509v3 Priv©êKey UßgêPîiod"

	)

2429 
	#NID_¥iv©e_key_ußge_≥riod
 84

	)

2430 
	#OBJ_¥iv©e_key_ußge_≥riod
 
OBJ_id_˚
,16L

	)

2432 
	#SN_subje˘_Æt_«me
 "subje˘A…Name"

	)

2433 
	#LN_subje˘_Æt_«me
 "X509v3 Subje˘ A…î«tivêName"

	)

2434 
	#NID_subje˘_Æt_«me
 85

	)

2435 
	#OBJ_subje˘_Æt_«me
 
OBJ_id_˚
,17L

	)

2437 
	#SN_issuî_Æt_«me
 "issuîA…Name"

	)

2438 
	#LN_issuî_Æt_«me
 "X509v3 Issuî A…î«tivêName"

	)

2439 
	#NID_issuî_Æt_«me
 86

	)

2440 
	#OBJ_issuî_Æt_«me
 
OBJ_id_˚
,18L

	)

2442 
	#SN_basic_c⁄°øöts
 "basicC⁄°øöts"

	)

2443 
	#LN_basic_c⁄°øöts
 "X509v3 Basi¯C⁄°øöts"

	)

2444 
	#NID_basic_c⁄°øöts
 87

	)

2445 
	#OBJ_basic_c⁄°øöts
 
OBJ_id_˚
,19L

	)

2447 
	#SN_¸l_numbî
 "¸lNumbî"

	)

2448 
	#LN_¸l_numbî
 "X509v3 CRL Numbî"

	)

2449 
	#NID_¸l_numbî
 88

	)

2450 
	#OBJ_¸l_numbî
 
OBJ_id_˚
,20L

	)

2452 
	#SN_¸l_ªas⁄
 "CRLRós⁄"

	)

2453 
	#LN_¸l_ªas⁄
 "X509v3 CRL Rós⁄ Code"

	)

2454 
	#NID_¸l_ªas⁄
 141

	)

2455 
	#OBJ_¸l_ªas⁄
 
OBJ_id_˚
,21L

	)

2457 
	#SN_övÆidôy_d©e
 "övÆidôyD©e"

	)

2458 
	#LN_övÆidôy_d©e
 "InvÆidôy D©e"

	)

2459 
	#NID_övÆidôy_d©e
 142

	)

2460 
	#OBJ_övÆidôy_d©e
 
OBJ_id_˚
,24L

	)

2462 
	#SN_dñè_¸l
 "dñèCRL"

	)

2463 
	#LN_dñè_¸l
 "X509v3 Dñè CRL Indiˇt‹"

	)

2464 
	#NID_dñè_¸l
 140

	)

2465 
	#OBJ_dñè_¸l
 
OBJ_id_˚
,27L

	)

2467 
	#SN_issuög_di°ributi⁄_poöt
 "issuögDi°ributi⁄Poöt"

	)

2468 
	#LN_issuög_di°ributi⁄_poöt
 "X509v3 Issuög Di°ributi⁄ Poöt"

	)

2469 
	#NID_issuög_di°ributi⁄_poöt
 770

	)

2470 
	#OBJ_issuög_di°ributi⁄_poöt
 
OBJ_id_˚
,28L

	)

2472 
	#SN_˚πifiˇã_issuî
 "˚πifiˇãIssuî"

	)

2473 
	#LN_˚πifiˇã_issuî
 "X509v3 Cîtifiˇã Issuî"

	)

2474 
	#NID_˚πifiˇã_issuî
 771

	)

2475 
	#OBJ_˚πifiˇã_issuî
 
OBJ_id_˚
,29L

	)

2477 
	#SN_«me_c⁄°øöts
 "«meC⁄°øöts"

	)

2478 
	#LN_«me_c⁄°øöts
 "X509v3 NamêC⁄°øöts"

	)

2479 
	#NID_«me_c⁄°øöts
 666

	)

2480 
	#OBJ_«me_c⁄°øöts
 
OBJ_id_˚
,30L

	)

2482 
	#SN_¸l_di°ributi⁄_poöts
 "¸lDi°ributi⁄Poöts"

	)

2483 
	#LN_¸l_di°ributi⁄_poöts
 "X509v3 CRL Di°ributi⁄ Poöts"

	)

2484 
	#NID_¸l_di°ributi⁄_poöts
 103

	)

2485 
	#OBJ_¸l_di°ributi⁄_poöts
 
OBJ_id_˚
,31L

	)

2487 
	#SN_˚πifiˇã_pﬁicõs
 "˚πifiˇãPﬁicõs"

	)

2488 
	#LN_˚πifiˇã_pﬁicõs
 "X509v3 Cîtifiˇã Pﬁicõs"

	)

2489 
	#NID_˚πifiˇã_pﬁicõs
 89

	)

2490 
	#OBJ_˚πifiˇã_pﬁicõs
 
OBJ_id_˚
,32L

	)

2492 
	#SN_™y_pﬁicy
 "™yPﬁicy"

	)

2493 
	#LN_™y_pﬁicy
 "X509v3 Any Pﬁicy"

	)

2494 
	#NID_™y_pﬁicy
 746

	)

2495 
	#OBJ_™y_pﬁicy
 
OBJ_˚πifiˇã_pﬁicõs
,0L

	)

2497 
	#SN_pﬁicy_m≠pögs
 "pﬁicyM≠pögs"

	)

2498 
	#LN_pﬁicy_m≠pögs
 "X509v3 Pﬁicy M≠pögs"

	)

2499 
	#NID_pﬁicy_m≠pögs
 747

	)

2500 
	#OBJ_pﬁicy_m≠pögs
 
OBJ_id_˚
,33L

	)

2502 
	#SN_auth‹ôy_key_idítifõr
 "auth‹ôyKeyIdítifõr"

	)

2503 
	#LN_auth‹ôy_key_idítifõr
 "X509v3 Auth‹ôy Key Idítifõr"

	)

2504 
	#NID_auth‹ôy_key_idítifõr
 90

	)

2505 
	#OBJ_auth‹ôy_key_idítifõr
 
OBJ_id_˚
,35L

	)

2507 
	#SN_pﬁicy_c⁄°øöts
 "pﬁicyC⁄°øöts"

	)

2508 
	#LN_pﬁicy_c⁄°øöts
 "X509v3 Pﬁicy C⁄°øöts"

	)

2509 
	#NID_pﬁicy_c⁄°øöts
 401

	)

2510 
	#OBJ_pﬁicy_c⁄°øöts
 
OBJ_id_˚
,36L

	)

2512 
	#SN_ext_key_ußge
 "exãndedKeyUßge"

	)

2513 
	#LN_ext_key_ußge
 "X509v3 Exãnded Key Ußge"

	)

2514 
	#NID_ext_key_ußge
 126

	)

2515 
	#OBJ_ext_key_ußge
 
OBJ_id_˚
,37L

	)

2517 
	#SN_‰eshe°_¸l
 "‰eshe°CRL"

	)

2518 
	#LN_‰eshe°_¸l
 "X509v3 Fªshe° CRL"

	)

2519 
	#NID_‰eshe°_¸l
 857

	)

2520 
	#OBJ_‰eshe°_¸l
 
OBJ_id_˚
,46L

	)

2522 
	#SN_öhibô_™y_pﬁicy
 "öhibôAnyPﬁicy"

	)

2523 
	#LN_öhibô_™y_pﬁicy
 "X509v3 Inhibô Any Pﬁicy"

	)

2524 
	#NID_öhibô_™y_pﬁicy
 748

	)

2525 
	#OBJ_öhibô_™y_pﬁicy
 
OBJ_id_˚
,54L

	)

2527 
	#SN_èrgë_öf‹m©i⁄
 "èrgëInf‹m©i⁄"

	)

2528 
	#LN_èrgë_öf‹m©i⁄
 "X509v3 AC T¨gëög"

	)

2529 
	#NID_èrgë_öf‹m©i⁄
 402

	)

2530 
	#OBJ_èrgë_öf‹m©i⁄
 
OBJ_id_˚
,55L

	)

2532 
	#SN_no_ªv_avaû
 "noRevAvaû"

	)

2533 
	#LN_no_ªv_avaû
 "X509v3 NÿRevoˇti⁄ AvaûabÀ"

	)

2534 
	#NID_no_ªv_avaû
 403

	)

2535 
	#OBJ_no_ªv_avaû
 
OBJ_id_˚
,56L

	)

2537 
	#SN_™yExãndedKeyUßge
 "™yExãndedKeyUßge"

	)

2538 
	#LN_™yExãndedKeyUßge
 "Any Exãnded Key Ußge"

	)

2539 
	#NID_™yExãndedKeyUßge
 910

	)

2540 
	#OBJ_™yExãndedKeyUßge
 
OBJ_ext_key_ußge
,0L

	)

2542 
	#SN_√tsˇ≥
 "Nësˇ≥"

	)

2543 
	#LN_√tsˇ≥
 "Nësˇ≥ Communiˇti⁄†C‹p."

	)

2544 
	#NID_√tsˇ≥
 57

	)

2545 
	#OBJ_√tsˇ≥
 2L,16L,840L,1L,113730L

	)

2547 
	#SN_√tsˇ≥_˚π_exãnsi⁄
 "nsCîtExt"

	)

2548 
	#LN_√tsˇ≥_˚π_exãnsi⁄
 "Nësˇ≥ Cîtifiˇã Exãnsi⁄"

	)

2549 
	#NID_√tsˇ≥_˚π_exãnsi⁄
 58

	)

2550 
	#OBJ_√tsˇ≥_˚π_exãnsi⁄
 
OBJ_√tsˇ≥
,1L

	)

2552 
	#SN_√tsˇ≥_d©a_ty≥
 "nsD©aTy≥"

	)

2553 
	#LN_√tsˇ≥_d©a_ty≥
 "Nësˇ≥ D©®Ty≥"

	)

2554 
	#NID_√tsˇ≥_d©a_ty≥
 59

	)

2555 
	#OBJ_√tsˇ≥_d©a_ty≥
 
OBJ_√tsˇ≥
,2L

	)

2557 
	#SN_√tsˇ≥_˚π_ty≥
 "nsCîtTy≥"

	)

2558 
	#LN_√tsˇ≥_˚π_ty≥
 "Nësˇ≥ CîàTy≥"

	)

2559 
	#NID_√tsˇ≥_˚π_ty≥
 71

	)

2560 
	#OBJ_√tsˇ≥_˚π_ty≥
 
OBJ_√tsˇ≥_˚π_exãnsi⁄
,1L

	)

2562 
	#SN_√tsˇ≥_ba£_uæ
 "nsBa£Uæ"

	)

2563 
	#LN_√tsˇ≥_ba£_uæ
 "Nësˇ≥ Ba£ Uæ"

	)

2564 
	#NID_√tsˇ≥_ba£_uæ
 72

	)

2565 
	#OBJ_√tsˇ≥_ba£_uæ
 
OBJ_√tsˇ≥_˚π_exãnsi⁄
,2L

	)

2567 
	#SN_√tsˇ≥_ªvoˇti⁄_uæ
 "nsRevoˇti⁄Uæ"

	)

2568 
	#LN_√tsˇ≥_ªvoˇti⁄_uæ
 "Nësˇ≥ Revoˇti⁄ Uæ"

	)

2569 
	#NID_√tsˇ≥_ªvoˇti⁄_uæ
 73

	)

2570 
	#OBJ_√tsˇ≥_ªvoˇti⁄_uæ
 
OBJ_√tsˇ≥_˚π_exãnsi⁄
,3L

	)

2572 
	#SN_√tsˇ≥_ˇ_ªvoˇti⁄_uæ
 "nsCaRevoˇti⁄Uæ"

	)

2573 
	#LN_√tsˇ≥_ˇ_ªvoˇti⁄_uæ
 "Nësˇ≥ CA Revoˇti⁄ Uæ"

	)

2574 
	#NID_√tsˇ≥_ˇ_ªvoˇti⁄_uæ
 74

	)

2575 
	#OBJ_√tsˇ≥_ˇ_ªvoˇti⁄_uæ
 
OBJ_√tsˇ≥_˚π_exãnsi⁄
,4L

	)

2577 
	#SN_√tsˇ≥_ª√wÆ_uæ
 "nsRíewÆUæ"

	)

2578 
	#LN_√tsˇ≥_ª√wÆ_uæ
 "Nësˇ≥ RíewÆ Uæ"

	)

2579 
	#NID_√tsˇ≥_ª√wÆ_uæ
 75

	)

2580 
	#OBJ_√tsˇ≥_ª√wÆ_uæ
 
OBJ_√tsˇ≥_˚π_exãnsi⁄
,7L

	)

2582 
	#SN_√tsˇ≥_ˇ_pﬁicy_uæ
 "nsCaPﬁicyUæ"

	)

2583 
	#LN_√tsˇ≥_ˇ_pﬁicy_uæ
 "Nësˇ≥ CA Pﬁicy Uæ"

	)

2584 
	#NID_√tsˇ≥_ˇ_pﬁicy_uæ
 76

	)

2585 
	#OBJ_√tsˇ≥_ˇ_pﬁicy_uæ
 
OBJ_√tsˇ≥_˚π_exãnsi⁄
,8L

	)

2587 
	#SN_√tsˇ≥_s¶_£rvî_«me
 "nsS¶SîvîName"

	)

2588 
	#LN_√tsˇ≥_s¶_£rvî_«me
 "Nësˇ≥ SSL Sîvî Name"

	)

2589 
	#NID_√tsˇ≥_s¶_£rvî_«me
 77

	)

2590 
	#OBJ_√tsˇ≥_s¶_£rvî_«me
 
OBJ_√tsˇ≥_˚π_exãnsi⁄
,12L

	)

2592 
	#SN_√tsˇ≥_commít
 "nsCommít"

	)

2593 
	#LN_√tsˇ≥_commít
 "Nësˇ≥ Commít"

	)

2594 
	#NID_√tsˇ≥_commít
 78

	)

2595 
	#OBJ_√tsˇ≥_commít
 
OBJ_√tsˇ≥_˚π_exãnsi⁄
,13L

	)

2597 
	#SN_√tsˇ≥_˚π_£quí˚
 "nsCîtSequí˚"

	)

2598 
	#LN_√tsˇ≥_˚π_£quí˚
 "Nësˇ≥ Cîtifiˇã Sequí˚"

	)

2599 
	#NID_√tsˇ≥_˚π_£quí˚
 79

	)

2600 
	#OBJ_√tsˇ≥_˚π_£quí˚
 
OBJ_√tsˇ≥_d©a_ty≥
,5L

	)

2602 
	#SN_ns_sgc
 "nsSGC"

	)

2603 
	#LN_ns_sgc
 "Nësˇ≥ Sîvî G©ed Cry±o"

	)

2604 
	#NID_ns_sgc
 139

	)

2605 
	#OBJ_ns_sgc
 
OBJ_√tsˇ≥
,4L,1L

	)

2607 
	#SN_‹g
 "ORG"

	)

2608 
	#LN_‹g
 "‹g"

	)

2609 
	#NID_‹g
 379

	)

2610 
	#OBJ_‹g
 
OBJ_iso
,3L

	)

2612 
	#SN_dod
 "DOD"

	)

2613 
	#LN_dod
 "dod"

	)

2614 
	#NID_dod
 380

	)

2615 
	#OBJ_dod
 
OBJ_‹g
,6L

	)

2617 
	#SN_ü«
 "IANA"

	)

2618 
	#LN_ü«
 "ü«"

	)

2619 
	#NID_ü«
 381

	)

2620 
	#OBJ_ü«
 
OBJ_dod
,1L

	)

2622 
	#OBJ_öã∫ë
 
OBJ_ü«


	)

2624 
	#SN_Dúe˘‹y
 "dúe˘‹y"

	)

2625 
	#LN_Dúe˘‹y
 "Dúe˘‹y"

	)

2626 
	#NID_Dúe˘‹y
 382

	)

2627 
	#OBJ_Dúe˘‹y
 
OBJ_öã∫ë
,1L

	)

2629 
	#SN_M™agemít
 "mgmt"

	)

2630 
	#LN_M™agemít
 "M™agemít"

	)

2631 
	#NID_M™agemít
 383

	)

2632 
	#OBJ_M™agemít
 
OBJ_öã∫ë
,2L

	)

2634 
	#SN_Ex≥rimíèl
 "ex≥rimíèl"

	)

2635 
	#LN_Ex≥rimíèl
 "Ex≥rimíèl"

	)

2636 
	#NID_Ex≥rimíèl
 384

	)

2637 
	#OBJ_Ex≥rimíèl
 
OBJ_öã∫ë
,3L

	)

2639 
	#SN_Priv©e
 "¥iv©e"

	)

2640 
	#LN_Priv©e
 "Priv©e"

	)

2641 
	#NID_Priv©e
 385

	)

2642 
	#OBJ_Priv©e
 
OBJ_öã∫ë
,4L

	)

2644 
	#SN_Securôy
 "£curôy"

	)

2645 
	#LN_Securôy
 "Securôy"

	)

2646 
	#NID_Securôy
 386

	)

2647 
	#OBJ_Securôy
 
OBJ_öã∫ë
,5L

	)

2649 
	#SN_SNMPv2
 "¢mpv2"

	)

2650 
	#LN_SNMPv2
 "SNMPv2"

	)

2651 
	#NID_SNMPv2
 387

	)

2652 
	#OBJ_SNMPv2
 
OBJ_öã∫ë
,6L

	)

2654 
	#LN_Maû
 "Maû"

	)

2655 
	#NID_Maû
 388

	)

2656 
	#OBJ_Maû
 
OBJ_öã∫ë
,7L

	)

2658 
	#SN_E¡î¥i£s
 "íãΩri£s"

	)

2659 
	#LN_E¡î¥i£s
 "E¡î¥i£s"

	)

2660 
	#NID_E¡î¥i£s
 389

	)

2661 
	#OBJ_E¡î¥i£s
 
OBJ_Priv©e
,1L

	)

2663 
	#SN_dcObje˘
 "dcobje˘"

	)

2664 
	#LN_dcObje˘
 "dcObje˘"

	)

2665 
	#NID_dcObje˘
 390

	)

2666 
	#OBJ_dcObje˘
 
OBJ_E¡î¥i£s
,1466L,344L

	)

2668 
	#SN_mime_mhs
 "mime-mhs"

	)

2669 
	#LN_mime_mhs
 "MIME MHS"

	)

2670 
	#NID_mime_mhs
 504

	)

2671 
	#OBJ_mime_mhs
 
OBJ_Maû
,1L

	)

2673 
	#SN_mime_mhs_hódögs
 "mime-mhs-hódögs"

	)

2674 
	#LN_mime_mhs_hódögs
 "mime-mhs-hódögs"

	)

2675 
	#NID_mime_mhs_hódögs
 505

	)

2676 
	#OBJ_mime_mhs_hódögs
 
OBJ_mime_mhs
,1L

	)

2678 
	#SN_mime_mhs_bodõs
 "mime-mhs-bodõs"

	)

2679 
	#LN_mime_mhs_bodõs
 "mime-mhs-bodõs"

	)

2680 
	#NID_mime_mhs_bodõs
 506

	)

2681 
	#OBJ_mime_mhs_bodõs
 
OBJ_mime_mhs
,2L

	)

2683 
	#SN_id_hex_∑πül_mesßge
 "id-hex-∑πül-mesßge"

	)

2684 
	#LN_id_hex_∑πül_mesßge
 "id-hex-∑πül-mesßge"

	)

2685 
	#NID_id_hex_∑πül_mesßge
 507

	)

2686 
	#OBJ_id_hex_∑πül_mesßge
 
OBJ_mime_mhs_hódögs
,1L

	)

2688 
	#SN_id_hex_mu…ù¨t_mesßge
 "id-hex-mu…ù¨t-mesßge"

	)

2689 
	#LN_id_hex_mu…ù¨t_mesßge
 "id-hex-mu…ù¨t-mesßge"

	)

2690 
	#NID_id_hex_mu…ù¨t_mesßge
 508

	)

2691 
	#OBJ_id_hex_mu…ù¨t_mesßge
 
OBJ_mime_mhs_hódögs
,2L

	)

2693 
	#SN_zlib_com¥essi⁄
 "ZLIB"

	)

2694 
	#LN_zlib_com¥essi⁄
 "zlib com¥essi⁄"

	)

2695 
	#NID_zlib_com¥essi⁄
 125

	)

2696 
	#OBJ_zlib_com¥essi⁄
 
OBJ_id_smime_Æg
,8L

	)

2698 
	#OBJ_cs‹
 2L,16L,840L,1L,101L,3L

	)

2700 
	#OBJ_ni°Alg‹ôhms
 
OBJ_cs‹
,4L

	)

2702 
	#OBJ_´s
 
OBJ_ni°Alg‹ôhms
,1L

	)

2704 
	#SN_´s_128_ecb
 "AES-128-ECB"

	)

2705 
	#LN_´s_128_ecb
 "´s-128-ecb"

	)

2706 
	#NID_´s_128_ecb
 418

	)

2707 
	#OBJ_´s_128_ecb
 
OBJ_´s
,1L

	)

2709 
	#SN_´s_128_cbc
 "AES-128-CBC"

	)

2710 
	#LN_´s_128_cbc
 "´s-128-cbc"

	)

2711 
	#NID_´s_128_cbc
 419

	)

2712 
	#OBJ_´s_128_cbc
 
OBJ_´s
,2L

	)

2714 
	#SN_´s_128_ofb128
 "AES-128-OFB"

	)

2715 
	#LN_´s_128_ofb128
 "´s-128-ofb"

	)

2716 
	#NID_´s_128_ofb128
 420

	)

2717 
	#OBJ_´s_128_ofb128
 
OBJ_´s
,3L

	)

2719 
	#SN_´s_128_cfb128
 "AES-128-CFB"

	)

2720 
	#LN_´s_128_cfb128
 "´s-128-cfb"

	)

2721 
	#NID_´s_128_cfb128
 421

	)

2722 
	#OBJ_´s_128_cfb128
 
OBJ_´s
,4L

	)

2724 
	#SN_id_´s128_wøp
 "id-´s128-wøp"

	)

2725 
	#NID_id_´s128_wøp
 788

	)

2726 
	#OBJ_id_´s128_wøp
 
OBJ_´s
,5L

	)

2728 
	#SN_´s_128_gcm
 "id-´s128-GCM"

	)

2729 
	#LN_´s_128_gcm
 "´s-128-gcm"

	)

2730 
	#NID_´s_128_gcm
 895

	)

2731 
	#OBJ_´s_128_gcm
 
OBJ_´s
,6L

	)

2733 
	#SN_´s_128_ccm
 "id-´s128-CCM"

	)

2734 
	#LN_´s_128_ccm
 "´s-128-ccm"

	)

2735 
	#NID_´s_128_ccm
 896

	)

2736 
	#OBJ_´s_128_ccm
 
OBJ_´s
,7L

	)

2738 
	#SN_id_´s128_wøp_∑d
 "id-´s128-wøp-∑d"

	)

2739 
	#NID_id_´s128_wøp_∑d
 897

	)

2740 
	#OBJ_id_´s128_wøp_∑d
 
OBJ_´s
,8L

	)

2742 
	#SN_´s_192_ecb
 "AES-192-ECB"

	)

2743 
	#LN_´s_192_ecb
 "´s-192-ecb"

	)

2744 
	#NID_´s_192_ecb
 422

	)

2745 
	#OBJ_´s_192_ecb
 
OBJ_´s
,21L

	)

2747 
	#SN_´s_192_cbc
 "AES-192-CBC"

	)

2748 
	#LN_´s_192_cbc
 "´s-192-cbc"

	)

2749 
	#NID_´s_192_cbc
 423

	)

2750 
	#OBJ_´s_192_cbc
 
OBJ_´s
,22L

	)

2752 
	#SN_´s_192_ofb128
 "AES-192-OFB"

	)

2753 
	#LN_´s_192_ofb128
 "´s-192-ofb"

	)

2754 
	#NID_´s_192_ofb128
 424

	)

2755 
	#OBJ_´s_192_ofb128
 
OBJ_´s
,23L

	)

2757 
	#SN_´s_192_cfb128
 "AES-192-CFB"

	)

2758 
	#LN_´s_192_cfb128
 "´s-192-cfb"

	)

2759 
	#NID_´s_192_cfb128
 425

	)

2760 
	#OBJ_´s_192_cfb128
 
OBJ_´s
,24L

	)

2762 
	#SN_id_´s192_wøp
 "id-´s192-wøp"

	)

2763 
	#NID_id_´s192_wøp
 789

	)

2764 
	#OBJ_id_´s192_wøp
 
OBJ_´s
,25L

	)

2766 
	#SN_´s_192_gcm
 "id-´s192-GCM"

	)

2767 
	#LN_´s_192_gcm
 "´s-192-gcm"

	)

2768 
	#NID_´s_192_gcm
 898

	)

2769 
	#OBJ_´s_192_gcm
 
OBJ_´s
,26L

	)

2771 
	#SN_´s_192_ccm
 "id-´s192-CCM"

	)

2772 
	#LN_´s_192_ccm
 "´s-192-ccm"

	)

2773 
	#NID_´s_192_ccm
 899

	)

2774 
	#OBJ_´s_192_ccm
 
OBJ_´s
,27L

	)

2776 
	#SN_id_´s192_wøp_∑d
 "id-´s192-wøp-∑d"

	)

2777 
	#NID_id_´s192_wøp_∑d
 900

	)

2778 
	#OBJ_id_´s192_wøp_∑d
 
OBJ_´s
,28L

	)

2780 
	#SN_´s_256_ecb
 "AES-256-ECB"

	)

2781 
	#LN_´s_256_ecb
 "´s-256-ecb"

	)

2782 
	#NID_´s_256_ecb
 426

	)

2783 
	#OBJ_´s_256_ecb
 
OBJ_´s
,41L

	)

2785 
	#SN_´s_256_cbc
 "AES-256-CBC"

	)

2786 
	#LN_´s_256_cbc
 "´s-256-cbc"

	)

2787 
	#NID_´s_256_cbc
 427

	)

2788 
	#OBJ_´s_256_cbc
 
OBJ_´s
,42L

	)

2790 
	#SN_´s_256_ofb128
 "AES-256-OFB"

	)

2791 
	#LN_´s_256_ofb128
 "´s-256-ofb"

	)

2792 
	#NID_´s_256_ofb128
 428

	)

2793 
	#OBJ_´s_256_ofb128
 
OBJ_´s
,43L

	)

2795 
	#SN_´s_256_cfb128
 "AES-256-CFB"

	)

2796 
	#LN_´s_256_cfb128
 "´s-256-cfb"

	)

2797 
	#NID_´s_256_cfb128
 429

	)

2798 
	#OBJ_´s_256_cfb128
 
OBJ_´s
,44L

	)

2800 
	#SN_id_´s256_wøp
 "id-´s256-wøp"

	)

2801 
	#NID_id_´s256_wøp
 790

	)

2802 
	#OBJ_id_´s256_wøp
 
OBJ_´s
,45L

	)

2804 
	#SN_´s_256_gcm
 "id-´s256-GCM"

	)

2805 
	#LN_´s_256_gcm
 "´s-256-gcm"

	)

2806 
	#NID_´s_256_gcm
 901

	)

2807 
	#OBJ_´s_256_gcm
 
OBJ_´s
,46L

	)

2809 
	#SN_´s_256_ccm
 "id-´s256-CCM"

	)

2810 
	#LN_´s_256_ccm
 "´s-256-ccm"

	)

2811 
	#NID_´s_256_ccm
 902

	)

2812 
	#OBJ_´s_256_ccm
 
OBJ_´s
,47L

	)

2814 
	#SN_id_´s256_wøp_∑d
 "id-´s256-wøp-∑d"

	)

2815 
	#NID_id_´s256_wøp_∑d
 903

	)

2816 
	#OBJ_id_´s256_wøp_∑d
 
OBJ_´s
,48L

	)

2818 
	#SN_´s_128_xts
 "AES-128-XTS"

	)

2819 
	#LN_´s_128_xts
 "´s-128-xts"

	)

2820 
	#NID_´s_128_xts
 913

	)

2821 
	#OBJ_´s_128_xts
 
OBJ_õì_siswg
,0L,1L,1L

	)

2823 
	#SN_´s_256_xts
 "AES-256-XTS"

	)

2824 
	#LN_´s_256_xts
 "´s-256-xts"

	)

2825 
	#NID_´s_256_xts
 914

	)

2826 
	#OBJ_´s_256_xts
 
OBJ_õì_siswg
,0L,1L,2L

	)

2828 
	#SN_´s_128_cfb1
 "AES-128-CFB1"

	)

2829 
	#LN_´s_128_cfb1
 "´s-128-cfb1"

	)

2830 
	#NID_´s_128_cfb1
 650

	)

2832 
	#SN_´s_192_cfb1
 "AES-192-CFB1"

	)

2833 
	#LN_´s_192_cfb1
 "´s-192-cfb1"

	)

2834 
	#NID_´s_192_cfb1
 651

	)

2836 
	#SN_´s_256_cfb1
 "AES-256-CFB1"

	)

2837 
	#LN_´s_256_cfb1
 "´s-256-cfb1"

	)

2838 
	#NID_´s_256_cfb1
 652

	)

2840 
	#SN_´s_128_cfb8
 "AES-128-CFB8"

	)

2841 
	#LN_´s_128_cfb8
 "´s-128-cfb8"

	)

2842 
	#NID_´s_128_cfb8
 653

	)

2844 
	#SN_´s_192_cfb8
 "AES-192-CFB8"

	)

2845 
	#LN_´s_192_cfb8
 "´s-192-cfb8"

	)

2846 
	#NID_´s_192_cfb8
 654

	)

2848 
	#SN_´s_256_cfb8
 "AES-256-CFB8"

	)

2849 
	#LN_´s_256_cfb8
 "´s-256-cfb8"

	)

2850 
	#NID_´s_256_cfb8
 655

	)

2852 
	#SN_´s_128_˘r
 "AES-128-CTR"

	)

2853 
	#LN_´s_128_˘r
 "´s-128-˘r"

	)

2854 
	#NID_´s_128_˘r
 904

	)

2856 
	#SN_´s_192_˘r
 "AES-192-CTR"

	)

2857 
	#LN_´s_192_˘r
 "´s-192-˘r"

	)

2858 
	#NID_´s_192_˘r
 905

	)

2860 
	#SN_´s_256_˘r
 "AES-256-CTR"

	)

2861 
	#LN_´s_256_˘r
 "´s-256-˘r"

	)

2862 
	#NID_´s_256_˘r
 906

	)

2864 
	#SN_´s_128_ocb
 "AES-128-OCB"

	)

2865 
	#LN_´s_128_ocb
 "´s-128-ocb"

	)

2866 
	#NID_´s_128_ocb
 958

	)

2868 
	#SN_´s_192_ocb
 "AES-192-OCB"

	)

2869 
	#LN_´s_192_ocb
 "´s-192-ocb"

	)

2870 
	#NID_´s_192_ocb
 959

	)

2872 
	#SN_´s_256_ocb
 "AES-256-OCB"

	)

2873 
	#LN_´s_256_ocb
 "´s-256-ocb"

	)

2874 
	#NID_´s_256_ocb
 960

	)

2876 
	#SN_des_cfb1
 "DES-CFB1"

	)

2877 
	#LN_des_cfb1
 "des-cfb1"

	)

2878 
	#NID_des_cfb1
 656

	)

2880 
	#SN_des_cfb8
 "DES-CFB8"

	)

2881 
	#LN_des_cfb8
 "des-cfb8"

	)

2882 
	#NID_des_cfb8
 657

	)

2884 
	#SN_des_ede3_cfb1
 "DES-EDE3-CFB1"

	)

2885 
	#LN_des_ede3_cfb1
 "des-ede3-cfb1"

	)

2886 
	#NID_des_ede3_cfb1
 658

	)

2888 
	#SN_des_ede3_cfb8
 "DES-EDE3-CFB8"

	)

2889 
	#LN_des_ede3_cfb8
 "des-ede3-cfb8"

	)

2890 
	#NID_des_ede3_cfb8
 659

	)

2892 
	#OBJ_ni°_hashÆgs
 
OBJ_ni°Alg‹ôhms
,2L

	)

2894 
	#SN_sha256
 "SHA256"

	)

2895 
	#LN_sha256
 "sha256"

	)

2896 
	#NID_sha256
 672

	)

2897 
	#OBJ_sha256
 
OBJ_ni°_hashÆgs
,1L

	)

2899 
	#SN_sha384
 "SHA384"

	)

2900 
	#LN_sha384
 "sha384"

	)

2901 
	#NID_sha384
 673

	)

2902 
	#OBJ_sha384
 
OBJ_ni°_hashÆgs
,2L

	)

2904 
	#SN_sha512
 "SHA512"

	)

2905 
	#LN_sha512
 "sha512"

	)

2906 
	#NID_sha512
 674

	)

2907 
	#OBJ_sha512
 
OBJ_ni°_hashÆgs
,3L

	)

2909 
	#SN_sha224
 "SHA224"

	)

2910 
	#LN_sha224
 "sha224"

	)

2911 
	#NID_sha224
 675

	)

2912 
	#OBJ_sha224
 
OBJ_ni°_hashÆgs
,4L

	)

2914 
	#SN_sha512_224
 "SHA512-224"

	)

2915 
	#LN_sha512_224
 "sha512-224"

	)

2916 
	#NID_sha512_224
 1094

	)

2917 
	#OBJ_sha512_224
 
OBJ_ni°_hashÆgs
,5L

	)

2919 
	#SN_sha512_256
 "SHA512-256"

	)

2920 
	#LN_sha512_256
 "sha512-256"

	)

2921 
	#NID_sha512_256
 1095

	)

2922 
	#OBJ_sha512_256
 
OBJ_ni°_hashÆgs
,6L

	)

2924 
	#SN_sha3_224
 "SHA3-224"

	)

2925 
	#LN_sha3_224
 "sha3-224"

	)

2926 
	#NID_sha3_224
 1096

	)

2927 
	#OBJ_sha3_224
 
OBJ_ni°_hashÆgs
,7L

	)

2929 
	#SN_sha3_256
 "SHA3-256"

	)

2930 
	#LN_sha3_256
 "sha3-256"

	)

2931 
	#NID_sha3_256
 1097

	)

2932 
	#OBJ_sha3_256
 
OBJ_ni°_hashÆgs
,8L

	)

2934 
	#SN_sha3_384
 "SHA3-384"

	)

2935 
	#LN_sha3_384
 "sha3-384"

	)

2936 
	#NID_sha3_384
 1098

	)

2937 
	#OBJ_sha3_384
 
OBJ_ni°_hashÆgs
,9L

	)

2939 
	#SN_sha3_512
 "SHA3-512"

	)

2940 
	#LN_sha3_512
 "sha3-512"

	)

2941 
	#NID_sha3_512
 1099

	)

2942 
	#OBJ_sha3_512
 
OBJ_ni°_hashÆgs
,10L

	)

2944 
	#SN_shake128
 "SHAKE128"

	)

2945 
	#LN_shake128
 "shake128"

	)

2946 
	#NID_shake128
 1100

	)

2947 
	#OBJ_shake128
 
OBJ_ni°_hashÆgs
,11L

	)

2949 
	#SN_shake256
 "SHAKE256"

	)

2950 
	#LN_shake256
 "shake256"

	)

2951 
	#NID_shake256
 1101

	)

2952 
	#OBJ_shake256
 
OBJ_ni°_hashÆgs
,12L

	)

2954 
	#SN_hmac_sha3_224
 "id-hmacWôhSHA3-224"

	)

2955 
	#LN_hmac_sha3_224
 "hmac-sha3-224"

	)

2956 
	#NID_hmac_sha3_224
 1102

	)

2957 
	#OBJ_hmac_sha3_224
 
OBJ_ni°_hashÆgs
,13L

	)

2959 
	#SN_hmac_sha3_256
 "id-hmacWôhSHA3-256"

	)

2960 
	#LN_hmac_sha3_256
 "hmac-sha3-256"

	)

2961 
	#NID_hmac_sha3_256
 1103

	)

2962 
	#OBJ_hmac_sha3_256
 
OBJ_ni°_hashÆgs
,14L

	)

2964 
	#SN_hmac_sha3_384
 "id-hmacWôhSHA3-384"

	)

2965 
	#LN_hmac_sha3_384
 "hmac-sha3-384"

	)

2966 
	#NID_hmac_sha3_384
 1104

	)

2967 
	#OBJ_hmac_sha3_384
 
OBJ_ni°_hashÆgs
,15L

	)

2969 
	#SN_hmac_sha3_512
 "id-hmacWôhSHA3-512"

	)

2970 
	#LN_hmac_sha3_512
 "hmac-sha3-512"

	)

2971 
	#NID_hmac_sha3_512
 1105

	)

2972 
	#OBJ_hmac_sha3_512
 
OBJ_ni°_hashÆgs
,16L

	)

2974 
	#OBJ_dß_wôh_sha2
 
OBJ_ni°Alg‹ôhms
,3L

	)

2976 
	#SN_dß_wôh_SHA224
 "dß_wôh_SHA224"

	)

2977 
	#NID_dß_wôh_SHA224
 802

	)

2978 
	#OBJ_dß_wôh_SHA224
 
OBJ_dß_wôh_sha2
,1L

	)

2980 
	#SN_dß_wôh_SHA256
 "dß_wôh_SHA256"

	)

2981 
	#NID_dß_wôh_SHA256
 803

	)

2982 
	#OBJ_dß_wôh_SHA256
 
OBJ_dß_wôh_sha2
,2L

	)

2984 
	#OBJ_sigAlgs
 
OBJ_ni°Alg‹ôhms
,3L

	)

2986 
	#SN_dß_wôh_SHA384
 "id-dß-wôh-sha384"

	)

2987 
	#LN_dß_wôh_SHA384
 "dß_wôh_SHA384"

	)

2988 
	#NID_dß_wôh_SHA384
 1106

	)

2989 
	#OBJ_dß_wôh_SHA384
 
OBJ_sigAlgs
,3L

	)

2991 
	#SN_dß_wôh_SHA512
 "id-dß-wôh-sha512"

	)

2992 
	#LN_dß_wôh_SHA512
 "dß_wôh_SHA512"

	)

2993 
	#NID_dß_wôh_SHA512
 1107

	)

2994 
	#OBJ_dß_wôh_SHA512
 
OBJ_sigAlgs
,4L

	)

2996 
	#SN_dß_wôh_SHA3_224
 "id-dß-wôh-sha3-224"

	)

2997 
	#LN_dß_wôh_SHA3_224
 "dß_wôh_SHA3-224"

	)

2998 
	#NID_dß_wôh_SHA3_224
 1108

	)

2999 
	#OBJ_dß_wôh_SHA3_224
 
OBJ_sigAlgs
,5L

	)

3001 
	#SN_dß_wôh_SHA3_256
 "id-dß-wôh-sha3-256"

	)

3002 
	#LN_dß_wôh_SHA3_256
 "dß_wôh_SHA3-256"

	)

3003 
	#NID_dß_wôh_SHA3_256
 1109

	)

3004 
	#OBJ_dß_wôh_SHA3_256
 
OBJ_sigAlgs
,6L

	)

3006 
	#SN_dß_wôh_SHA3_384
 "id-dß-wôh-sha3-384"

	)

3007 
	#LN_dß_wôh_SHA3_384
 "dß_wôh_SHA3-384"

	)

3008 
	#NID_dß_wôh_SHA3_384
 1110

	)

3009 
	#OBJ_dß_wôh_SHA3_384
 
OBJ_sigAlgs
,7L

	)

3011 
	#SN_dß_wôh_SHA3_512
 "id-dß-wôh-sha3-512"

	)

3012 
	#LN_dß_wôh_SHA3_512
 "dß_wôh_SHA3-512"

	)

3013 
	#NID_dß_wôh_SHA3_512
 1111

	)

3014 
	#OBJ_dß_wôh_SHA3_512
 
OBJ_sigAlgs
,8L

	)

3016 
	#SN_ecdß_wôh_SHA3_224
 "id-ecdß-wôh-sha3-224"

	)

3017 
	#LN_ecdß_wôh_SHA3_224
 "ecdß_wôh_SHA3-224"

	)

3018 
	#NID_ecdß_wôh_SHA3_224
 1112

	)

3019 
	#OBJ_ecdß_wôh_SHA3_224
 
OBJ_sigAlgs
,9L

	)

3021 
	#SN_ecdß_wôh_SHA3_256
 "id-ecdß-wôh-sha3-256"

	)

3022 
	#LN_ecdß_wôh_SHA3_256
 "ecdß_wôh_SHA3-256"

	)

3023 
	#NID_ecdß_wôh_SHA3_256
 1113

	)

3024 
	#OBJ_ecdß_wôh_SHA3_256
 
OBJ_sigAlgs
,10L

	)

3026 
	#SN_ecdß_wôh_SHA3_384
 "id-ecdß-wôh-sha3-384"

	)

3027 
	#LN_ecdß_wôh_SHA3_384
 "ecdß_wôh_SHA3-384"

	)

3028 
	#NID_ecdß_wôh_SHA3_384
 1114

	)

3029 
	#OBJ_ecdß_wôh_SHA3_384
 
OBJ_sigAlgs
,11L

	)

3031 
	#SN_ecdß_wôh_SHA3_512
 "id-ecdß-wôh-sha3-512"

	)

3032 
	#LN_ecdß_wôh_SHA3_512
 "ecdß_wôh_SHA3-512"

	)

3033 
	#NID_ecdß_wôh_SHA3_512
 1115

	)

3034 
	#OBJ_ecdß_wôh_SHA3_512
 
OBJ_sigAlgs
,12L

	)

3036 
	#SN_RSA_SHA3_224
 "id-rßsß-pkcs1-v1_5-wôh-sha3-224"

	)

3037 
	#LN_RSA_SHA3_224
 "RSA-SHA3-224"

	)

3038 
	#NID_RSA_SHA3_224
 1116

	)

3039 
	#OBJ_RSA_SHA3_224
 
OBJ_sigAlgs
,13L

	)

3041 
	#SN_RSA_SHA3_256
 "id-rßsß-pkcs1-v1_5-wôh-sha3-256"

	)

3042 
	#LN_RSA_SHA3_256
 "RSA-SHA3-256"

	)

3043 
	#NID_RSA_SHA3_256
 1117

	)

3044 
	#OBJ_RSA_SHA3_256
 
OBJ_sigAlgs
,14L

	)

3046 
	#SN_RSA_SHA3_384
 "id-rßsß-pkcs1-v1_5-wôh-sha3-384"

	)

3047 
	#LN_RSA_SHA3_384
 "RSA-SHA3-384"

	)

3048 
	#NID_RSA_SHA3_384
 1118

	)

3049 
	#OBJ_RSA_SHA3_384
 
OBJ_sigAlgs
,15L

	)

3051 
	#SN_RSA_SHA3_512
 "id-rßsß-pkcs1-v1_5-wôh-sha3-512"

	)

3052 
	#LN_RSA_SHA3_512
 "RSA-SHA3-512"

	)

3053 
	#NID_RSA_SHA3_512
 1119

	)

3054 
	#OBJ_RSA_SHA3_512
 
OBJ_sigAlgs
,16L

	)

3056 
	#SN_hﬁd_ö°ru˘i⁄_code
 "hﬁdIn°ru˘i⁄Code"

	)

3057 
	#LN_hﬁd_ö°ru˘i⁄_code
 "Hﬁd In°ru˘i⁄ Code"

	)

3058 
	#NID_hﬁd_ö°ru˘i⁄_code
 430

	)

3059 
	#OBJ_hﬁd_ö°ru˘i⁄_code
 
OBJ_id_˚
,23L

	)

3061 
	#OBJ_hﬁdIn°ru˘i⁄
 
OBJ_X9_57
,2L

	)

3063 
	#SN_hﬁd_ö°ru˘i⁄_n⁄e
 "hﬁdIn°ru˘i⁄N⁄e"

	)

3064 
	#LN_hﬁd_ö°ru˘i⁄_n⁄e
 "Hﬁd In°ru˘i⁄ N⁄e"

	)

3065 
	#NID_hﬁd_ö°ru˘i⁄_n⁄e
 431

	)

3066 
	#OBJ_hﬁd_ö°ru˘i⁄_n⁄e
 
OBJ_hﬁdIn°ru˘i⁄
,1L

	)

3068 
	#SN_hﬁd_ö°ru˘i⁄_ˇŒ_issuî
 "hﬁdIn°ru˘i⁄CÆlIssuî"

	)

3069 
	#LN_hﬁd_ö°ru˘i⁄_ˇŒ_issuî
 "Hﬁd In°ru˘i⁄ CÆ»Issuî"

	)

3070 
	#NID_hﬁd_ö°ru˘i⁄_ˇŒ_issuî
 432

	)

3071 
	#OBJ_hﬁd_ö°ru˘i⁄_ˇŒ_issuî
 
OBJ_hﬁdIn°ru˘i⁄
,2L

	)

3073 
	#SN_hﬁd_ö°ru˘i⁄_ªje˘
 "hﬁdIn°ru˘i⁄Reje˘"

	)

3074 
	#LN_hﬁd_ö°ru˘i⁄_ªje˘
 "Hﬁd In°ru˘i⁄ Reje˘"

	)

3075 
	#NID_hﬁd_ö°ru˘i⁄_ªje˘
 433

	)

3076 
	#OBJ_hﬁd_ö°ru˘i⁄_ªje˘
 
OBJ_hﬁdIn°ru˘i⁄
,3L

	)

3078 
	#SN_d©a
 "d©a"

	)

3079 
	#NID_d©a
 434

	)

3080 
	#OBJ_d©a
 
OBJ_ôu_t
,9L

	)

3082 
	#SN_pss
 "pss"

	)

3083 
	#NID_pss
 435

	)

3084 
	#OBJ_pss
 
OBJ_d©a
,2342L

	)

3086 
	#SN_u˛
 "u˛"

	)

3087 
	#NID_u˛
 436

	)

3088 
	#OBJ_u˛
 
OBJ_pss
,19200300L

	)

3090 
	#SN_pûŸ
 "pûŸ"

	)

3091 
	#NID_pûŸ
 437

	)

3092 
	#OBJ_pûŸ
 
OBJ_u˛
,100L

	)

3094 
	#LN_pûŸAâribuãTy≥
 "pûŸAâribuãTy≥"

	)

3095 
	#NID_pûŸAâribuãTy≥
 438

	)

3096 
	#OBJ_pûŸAâribuãTy≥
 
OBJ_pûŸ
,1L

	)

3098 
	#LN_pûŸAâribuãSy¡ax
 "pûŸAâribuãSy¡ax"

	)

3099 
	#NID_pûŸAâribuãSy¡ax
 439

	)

3100 
	#OBJ_pûŸAâribuãSy¡ax
 
OBJ_pûŸ
,3L

	)

3102 
	#LN_pûŸObje˘Cœss
 "pûŸObje˘Cœss"

	)

3103 
	#NID_pûŸObje˘Cœss
 440

	)

3104 
	#OBJ_pûŸObje˘Cœss
 
OBJ_pûŸ
,4L

	)

3106 
	#LN_pûŸGroups
 "pûŸGroups"

	)

3107 
	#NID_pûŸGroups
 441

	)

3108 
	#OBJ_pûŸGroups
 
OBJ_pûŸ
,10L

	)

3110 
	#LN_iA5SåögSy¡ax
 "iA5SåögSy¡ax"

	)

3111 
	#NID_iA5SåögSy¡ax
 442

	)

3112 
	#OBJ_iA5SåögSy¡ax
 
OBJ_pûŸAâribuãSy¡ax
,4L

	)

3114 
	#LN_ˇ£Ign‹eIA5SåögSy¡ax
 "ˇ£Ign‹eIA5SåögSy¡ax"

	)

3115 
	#NID_ˇ£Ign‹eIA5SåögSy¡ax
 443

	)

3116 
	#OBJ_ˇ£Ign‹eIA5SåögSy¡ax
 
OBJ_pûŸAâribuãSy¡ax
,5L

	)

3118 
	#LN_pûŸObje˘
 "pûŸObje˘"

	)

3119 
	#NID_pûŸObje˘
 444

	)

3120 
	#OBJ_pûŸObje˘
 
OBJ_pûŸObje˘Cœss
,3L

	)

3122 
	#LN_pûŸPîs⁄
 "pûŸPîs⁄"

	)

3123 
	#NID_pûŸPîs⁄
 445

	)

3124 
	#OBJ_pûŸPîs⁄
 
OBJ_pûŸObje˘Cœss
,4L

	)

3126 
	#SN_accou¡
 "accou¡"

	)

3127 
	#NID_accou¡
 446

	)

3128 
	#OBJ_accou¡
 
OBJ_pûŸObje˘Cœss
,5L

	)

3130 
	#SN_documít
 "documít"

	)

3131 
	#NID_documít
 447

	)

3132 
	#OBJ_documít
 
OBJ_pûŸObje˘Cœss
,6L

	)

3134 
	#SN_room
 "room"

	)

3135 
	#NID_room
 448

	)

3136 
	#OBJ_room
 
OBJ_pûŸObje˘Cœss
,7L

	)

3138 
	#LN_documítSîõs
 "documítSîõs"

	)

3139 
	#NID_documítSîõs
 449

	)

3140 
	#OBJ_documítSîõs
 
OBJ_pûŸObje˘Cœss
,9L

	)

3142 
	#SN_Domaö
 "domaö"

	)

3143 
	#LN_Domaö
 "Domaö"

	)

3144 
	#NID_Domaö
 392

	)

3145 
	#OBJ_Domaö
 
OBJ_pûŸObje˘Cœss
,13L

	)

3147 
	#LN_rFC822loˇlP¨t
 "rFC822loˇlP¨t"

	)

3148 
	#NID_rFC822loˇlP¨t
 450

	)

3149 
	#OBJ_rFC822loˇlP¨t
 
OBJ_pûŸObje˘Cœss
,14L

	)

3151 
	#LN_dNSDomaö
 "dNSDomaö"

	)

3152 
	#NID_dNSDomaö
 451

	)

3153 
	#OBJ_dNSDomaö
 
OBJ_pûŸObje˘Cœss
,15L

	)

3155 
	#LN_domaöRñ©edObje˘
 "domaöRñ©edObje˘"

	)

3156 
	#NID_domaöRñ©edObje˘
 452

	)

3157 
	#OBJ_domaöRñ©edObje˘
 
OBJ_pûŸObje˘Cœss
,17L

	)

3159 
	#LN_‰õndlyCou¡ry
 "‰õndlyCou¡ry"

	)

3160 
	#NID_‰õndlyCou¡ry
 453

	)

3161 
	#OBJ_‰õndlyCou¡ry
 
OBJ_pûŸObje˘Cœss
,18L

	)

3163 
	#LN_sim∂eSecurôyObje˘
 "sim∂eSecurôyObje˘"

	)

3164 
	#NID_sim∂eSecurôyObje˘
 454

	)

3165 
	#OBJ_sim∂eSecurôyObje˘
 
OBJ_pûŸObje˘Cœss
,19L

	)

3167 
	#LN_pûŸOrg™iz©i⁄
 "pûŸOrg™iz©i⁄"

	)

3168 
	#NID_pûŸOrg™iz©i⁄
 455

	)

3169 
	#OBJ_pûŸOrg™iz©i⁄
 
OBJ_pûŸObje˘Cœss
,20L

	)

3171 
	#LN_pûŸDSA
 "pûŸDSA"

	)

3172 
	#NID_pûŸDSA
 456

	)

3173 
	#OBJ_pûŸDSA
 
OBJ_pûŸObje˘Cœss
,21L

	)

3175 
	#LN_quÆôyLabñÀdD©a
 "quÆôyLabñÀdD©a"

	)

3176 
	#NID_quÆôyLabñÀdD©a
 457

	)

3177 
	#OBJ_quÆôyLabñÀdD©a
 
OBJ_pûŸObje˘Cœss
,22L

	)

3179 
	#SN_u£rId
 "UID"

	)

3180 
	#LN_u£rId
 "u£rId"

	)

3181 
	#NID_u£rId
 458

	)

3182 
	#OBJ_u£rId
 
OBJ_pûŸAâribuãTy≥
,1L

	)

3184 
	#LN_ãxtEncodedORAddªss
 "ãxtEncodedORAddªss"

	)

3185 
	#NID_ãxtEncodedORAddªss
 459

	)

3186 
	#OBJ_ãxtEncodedORAddªss
 
OBJ_pûŸAâribuãTy≥
,2L

	)

3188 
	#SN_rfc822Maûbox
 "maû"

	)

3189 
	#LN_rfc822Maûbox
 "rfc822Maûbox"

	)

3190 
	#NID_rfc822Maûbox
 460

	)

3191 
	#OBJ_rfc822Maûbox
 
OBJ_pûŸAâribuãTy≥
,3L

	)

3193 
	#SN_öfo
 "öfo"

	)

3194 
	#NID_öfo
 461

	)

3195 
	#OBJ_öfo
 
OBJ_pûŸAâribuãTy≥
,4L

	)

3197 
	#LN_ÁvourôeDrök
 "ÁvourôeDrök"

	)

3198 
	#NID_ÁvourôeDrök
 462

	)

3199 
	#OBJ_ÁvourôeDrök
 
OBJ_pûŸAâribuãTy≥
,5L

	)

3201 
	#LN_roomNumbî
 "roomNumbî"

	)

3202 
	#NID_roomNumbî
 463

	)

3203 
	#OBJ_roomNumbî
 
OBJ_pûŸAâribuãTy≥
,6L

	)

3205 
	#SN_phŸo
 "phŸo"

	)

3206 
	#NID_phŸo
 464

	)

3207 
	#OBJ_phŸo
 
OBJ_pûŸAâribuãTy≥
,7L

	)

3209 
	#LN_u£rCœss
 "u£rCœss"

	)

3210 
	#NID_u£rCœss
 465

	)

3211 
	#OBJ_u£rCœss
 
OBJ_pûŸAâribuãTy≥
,8L

	)

3213 
	#SN_ho°
 "ho°"

	)

3214 
	#NID_ho°
 466

	)

3215 
	#OBJ_ho°
 
OBJ_pûŸAâribuãTy≥
,9L

	)

3217 
	#SN_m™agî
 "m™agî"

	)

3218 
	#NID_m™agî
 467

	)

3219 
	#OBJ_m™agî
 
OBJ_pûŸAâribuãTy≥
,10L

	)

3221 
	#LN_documítIdítifõr
 "documítIdítifõr"

	)

3222 
	#NID_documítIdítifõr
 468

	)

3223 
	#OBJ_documítIdítifõr
 
OBJ_pûŸAâribuãTy≥
,11L

	)

3225 
	#LN_documítTôÀ
 "documítTôÀ"

	)

3226 
	#NID_documítTôÀ
 469

	)

3227 
	#OBJ_documítTôÀ
 
OBJ_pûŸAâribuãTy≥
,12L

	)

3229 
	#LN_documítVîsi⁄
 "documítVîsi⁄"

	)

3230 
	#NID_documítVîsi⁄
 470

	)

3231 
	#OBJ_documítVîsi⁄
 
OBJ_pûŸAâribuãTy≥
,13L

	)

3233 
	#LN_documítAuth‹
 "documítAuth‹"

	)

3234 
	#NID_documítAuth‹
 471

	)

3235 
	#OBJ_documítAuth‹
 
OBJ_pûŸAâribuãTy≥
,14L

	)

3237 
	#LN_documítLoˇti⁄
 "documítLoˇti⁄"

	)

3238 
	#NID_documítLoˇti⁄
 472

	)

3239 
	#OBJ_documítLoˇti⁄
 
OBJ_pûŸAâribuãTy≥
,15L

	)

3241 
	#LN_homeTñïh⁄eNumbî
 "homeTñïh⁄eNumbî"

	)

3242 
	#NID_homeTñïh⁄eNumbî
 473

	)

3243 
	#OBJ_homeTñïh⁄eNumbî
 
OBJ_pûŸAâribuãTy≥
,20L

	)

3245 
	#SN_£¸ë¨y
 "£¸ë¨y"

	)

3246 
	#NID_£¸ë¨y
 474

	)

3247 
	#OBJ_£¸ë¨y
 
OBJ_pûŸAâribuãTy≥
,21L

	)

3249 
	#LN_ŸhîMaûbox
 "ŸhîMaûbox"

	)

3250 
	#NID_ŸhîMaûbox
 475

	)

3251 
	#OBJ_ŸhîMaûbox
 
OBJ_pûŸAâribuãTy≥
,22L

	)

3253 
	#LN_œ°ModifõdTime
 "œ°ModifõdTime"

	)

3254 
	#NID_œ°ModifõdTime
 476

	)

3255 
	#OBJ_œ°ModifõdTime
 
OBJ_pûŸAâribuãTy≥
,23L

	)

3257 
	#LN_œ°ModifõdBy
 "œ°ModifõdBy"

	)

3258 
	#NID_œ°ModifõdBy
 477

	)

3259 
	#OBJ_œ°ModifõdBy
 
OBJ_pûŸAâribuãTy≥
,24L

	)

3261 
	#SN_domaöComp⁄ít
 "DC"

	)

3262 
	#LN_domaöComp⁄ít
 "domaöComp⁄ít"

	)

3263 
	#NID_domaöComp⁄ít
 391

	)

3264 
	#OBJ_domaöComp⁄ít
 
OBJ_pûŸAâribuãTy≥
,25L

	)

3266 
	#LN_aRec‹d
 "aRec‹d"

	)

3267 
	#NID_aRec‹d
 478

	)

3268 
	#OBJ_aRec‹d
 
OBJ_pûŸAâribuãTy≥
,26L

	)

3270 
	#LN_pûŸAâribuãTy≥27
 "pûŸAâribuãTy≥27"

	)

3271 
	#NID_pûŸAâribuãTy≥27
 479

	)

3272 
	#OBJ_pûŸAâribuãTy≥27
 
OBJ_pûŸAâribuãTy≥
,27L

	)

3274 
	#LN_mXRec‹d
 "mXRec‹d"

	)

3275 
	#NID_mXRec‹d
 480

	)

3276 
	#OBJ_mXRec‹d
 
OBJ_pûŸAâribuãTy≥
,28L

	)

3278 
	#LN_nSRec‹d
 "nSRec‹d"

	)

3279 
	#NID_nSRec‹d
 481

	)

3280 
	#OBJ_nSRec‹d
 
OBJ_pûŸAâribuãTy≥
,29L

	)

3282 
	#LN_sOARec‹d
 "sOARec‹d"

	)

3283 
	#NID_sOARec‹d
 482

	)

3284 
	#OBJ_sOARec‹d
 
OBJ_pûŸAâribuãTy≥
,30L

	)

3286 
	#LN_cNAMERec‹d
 "cNAMERec‹d"

	)

3287 
	#NID_cNAMERec‹d
 483

	)

3288 
	#OBJ_cNAMERec‹d
 
OBJ_pûŸAâribuãTy≥
,31L

	)

3290 
	#LN_assocüãdDomaö
 "assocüãdDomaö"

	)

3291 
	#NID_assocüãdDomaö
 484

	)

3292 
	#OBJ_assocüãdDomaö
 
OBJ_pûŸAâribuãTy≥
,37L

	)

3294 
	#LN_assocüãdName
 "assocüãdName"

	)

3295 
	#NID_assocüãdName
 485

	)

3296 
	#OBJ_assocüãdName
 
OBJ_pûŸAâribuãTy≥
,38L

	)

3298 
	#LN_homePo°ÆAddªss
 "homePo°ÆAddªss"

	)

3299 
	#NID_homePo°ÆAddªss
 486

	)

3300 
	#OBJ_homePo°ÆAddªss
 
OBJ_pûŸAâribuãTy≥
,39L

	)

3302 
	#LN_≥rs⁄ÆTôÀ
 "≥rs⁄ÆTôÀ"

	)

3303 
	#NID_≥rs⁄ÆTôÀ
 487

	)

3304 
	#OBJ_≥rs⁄ÆTôÀ
 
OBJ_pûŸAâribuãTy≥
,40L

	)

3306 
	#LN_mobûeTñïh⁄eNumbî
 "mobûeTñïh⁄eNumbî"

	)

3307 
	#NID_mobûeTñïh⁄eNumbî
 488

	)

3308 
	#OBJ_mobûeTñïh⁄eNumbî
 
OBJ_pûŸAâribuãTy≥
,41L

	)

3310 
	#LN_∑gîTñïh⁄eNumbî
 "∑gîTñïh⁄eNumbî"

	)

3311 
	#NID_∑gîTñïh⁄eNumbî
 489

	)

3312 
	#OBJ_∑gîTñïh⁄eNumbî
 
OBJ_pûŸAâribuãTy≥
,42L

	)

3314 
	#LN_‰õndlyCou¡ryName
 "‰õndlyCou¡ryName"

	)

3315 
	#NID_‰õndlyCou¡ryName
 490

	)

3316 
	#OBJ_‰õndlyCou¡ryName
 
OBJ_pûŸAâribuãTy≥
,43L

	)

3318 
	#SN_uniqueIdítifõr
 "uid"

	)

3319 
	#LN_uniqueIdítifõr
 "uniqueIdítifõr"

	)

3320 
	#NID_uniqueIdítifõr
 102

	)

3321 
	#OBJ_uniqueIdítifõr
 
OBJ_pûŸAâribuãTy≥
,44L

	)

3323 
	#LN_‹g™iz©i⁄ÆSètus
 "‹g™iz©i⁄ÆSètus"

	)

3324 
	#NID_‹g™iz©i⁄ÆSètus
 491

	)

3325 
	#OBJ_‹g™iz©i⁄ÆSètus
 
OBJ_pûŸAâribuãTy≥
,45L

	)

3327 
	#LN_j™ëMaûbox
 "j™ëMaûbox"

	)

3328 
	#NID_j™ëMaûbox
 492

	)

3329 
	#OBJ_j™ëMaûbox
 
OBJ_pûŸAâribuãTy≥
,46L

	)

3331 
	#LN_maûPª„ªn˚O±i⁄
 "maûPª„ªn˚O±i⁄"

	)

3332 
	#NID_maûPª„ªn˚O±i⁄
 493

	)

3333 
	#OBJ_maûPª„ªn˚O±i⁄
 
OBJ_pûŸAâribuãTy≥
,47L

	)

3335 
	#LN_buûdögName
 "buûdögName"

	)

3336 
	#NID_buûdögName
 494

	)

3337 
	#OBJ_buûdögName
 
OBJ_pûŸAâribuãTy≥
,48L

	)

3339 
	#LN_dSAQuÆôy
 "dSAQuÆôy"

	)

3340 
	#NID_dSAQuÆôy
 495

	)

3341 
	#OBJ_dSAQuÆôy
 
OBJ_pûŸAâribuãTy≥
,49L

	)

3343 
	#LN_sögÀLevñQuÆôy
 "sögÀLevñQuÆôy"

	)

3344 
	#NID_sögÀLevñQuÆôy
 496

	)

3345 
	#OBJ_sögÀLevñQuÆôy
 
OBJ_pûŸAâribuãTy≥
,50L

	)

3347 
	#LN_subåìMöimumQuÆôy
 "subåìMöimumQuÆôy"

	)

3348 
	#NID_subåìMöimumQuÆôy
 497

	)

3349 
	#OBJ_subåìMöimumQuÆôy
 
OBJ_pûŸAâribuãTy≥
,51L

	)

3351 
	#LN_subåìMaximumQuÆôy
 "subåìMaximumQuÆôy"

	)

3352 
	#NID_subåìMaximumQuÆôy
 498

	)

3353 
	#OBJ_subåìMaximumQuÆôy
 
OBJ_pûŸAâribuãTy≥
,52L

	)

3355 
	#LN_≥rs⁄ÆSig«tuª
 "≥rs⁄ÆSig«tuª"

	)

3356 
	#NID_≥rs⁄ÆSig«tuª
 499

	)

3357 
	#OBJ_≥rs⁄ÆSig«tuª
 
OBJ_pûŸAâribuãTy≥
,53L

	)

3359 
	#LN_dITRedúe˘
 "dITRedúe˘"

	)

3360 
	#NID_dITRedúe˘
 500

	)

3361 
	#OBJ_dITRedúe˘
 
OBJ_pûŸAâribuãTy≥
,54L

	)

3363 
	#SN_audio
 "audio"

	)

3364 
	#NID_audio
 501

	)

3365 
	#OBJ_audio
 
OBJ_pûŸAâribuãTy≥
,55L

	)

3367 
	#LN_documítPublishî
 "documítPublishî"

	)

3368 
	#NID_documítPublishî
 502

	)

3369 
	#OBJ_documítPublishî
 
OBJ_pûŸAâribuãTy≥
,56L

	)

3371 
	#SN_id_£t
 "id-£t"

	)

3372 
	#LN_id_£t
 "Secuª EÀ˘r⁄i¯Tønß˘i⁄s"

	)

3373 
	#NID_id_£t
 512

	)

3374 
	#OBJ_id_£t
 
OBJ_öã∫©i⁄Æ_‹g™iz©i⁄s
,42L

	)

3376 
	#SN_£t_˘y≥
 "£t-˘y≥"

	)

3377 
	#LN_£t_˘y≥
 "c⁄ã¡Åy≥s"

	)

3378 
	#NID_£t_˘y≥
 513

	)

3379 
	#OBJ_£t_˘y≥
 
OBJ_id_£t
,0L

	)

3381 
	#SN_£t_msgExt
 "£t-msgExt"

	)

3382 
	#LN_£t_msgExt
 "mesßgêexãnsi⁄s"

	)

3383 
	#NID_£t_msgExt
 514

	)

3384 
	#OBJ_£t_msgExt
 
OBJ_id_£t
,1L

	)

3386 
	#SN_£t_©å
 "£t-©å"

	)

3387 
	#NID_£t_©å
 515

	)

3388 
	#OBJ_£t_©å
 
OBJ_id_£t
,3L

	)

3390 
	#SN_£t_pﬁicy
 "£t-pﬁicy"

	)

3391 
	#NID_£t_pﬁicy
 516

	)

3392 
	#OBJ_£t_pﬁicy
 
OBJ_id_£t
,5L

	)

3394 
	#SN_£t_˚πExt
 "£t-˚πExt"

	)

3395 
	#LN_£t_˚πExt
 "˚πifiˇãÉxãnsi⁄s"

	)

3396 
	#NID_£t_˚πExt
 517

	)

3397 
	#OBJ_£t_˚πExt
 
OBJ_id_£t
,7L

	)

3399 
	#SN_£t_bønd
 "£t-bønd"

	)

3400 
	#NID_£t_bønd
 518

	)

3401 
	#OBJ_£t_bønd
 
OBJ_id_£t
,8L

	)

3403 
	#SN_£t˘_PAND©a
 "£t˘-PAND©a"

	)

3404 
	#NID_£t˘_PAND©a
 519

	)

3405 
	#OBJ_£t˘_PAND©a
 
OBJ_£t_˘y≥
,0L

	)

3407 
	#SN_£t˘_PANTokí
 "£t˘-PANTokí"

	)

3408 
	#NID_£t˘_PANTokí
 520

	)

3409 
	#OBJ_£t˘_PANTokí
 
OBJ_£t_˘y≥
,1L

	)

3411 
	#SN_£t˘_PANO∆y
 "£t˘-PANO∆y"

	)

3412 
	#NID_£t˘_PANO∆y
 521

	)

3413 
	#OBJ_£t˘_PANO∆y
 
OBJ_£t_˘y≥
,2L

	)

3415 
	#SN_£t˘_OID©a
 "£t˘-OID©a"

	)

3416 
	#NID_£t˘_OID©a
 522

	)

3417 
	#OBJ_£t˘_OID©a
 
OBJ_£t_˘y≥
,3L

	)

3419 
	#SN_£t˘_PI
 "£t˘-PI"

	)

3420 
	#NID_£t˘_PI
 523

	)

3421 
	#OBJ_£t˘_PI
 
OBJ_£t_˘y≥
,4L

	)

3423 
	#SN_£t˘_PID©a
 "£t˘-PID©a"

	)

3424 
	#NID_£t˘_PID©a
 524

	)

3425 
	#OBJ_£t˘_PID©a
 
OBJ_£t_˘y≥
,5L

	)

3427 
	#SN_£t˘_PID©aUnsig√d
 "£t˘-PID©aUnsig√d"

	)

3428 
	#NID_£t˘_PID©aUnsig√d
 525

	)

3429 
	#OBJ_£t˘_PID©aUnsig√d
 
OBJ_£t_˘y≥
,6L

	)

3431 
	#SN_£t˘_HODI≈ut
 "£t˘-HODI≈ut"

	)

3432 
	#NID_£t˘_HODI≈ut
 526

	)

3433 
	#OBJ_£t˘_HODI≈ut
 
OBJ_£t_˘y≥
,7L

	)

3435 
	#SN_£t˘_AuthResBaggage
 "£t˘-AuthResBaggage"

	)

3436 
	#NID_£t˘_AuthResBaggage
 527

	)

3437 
	#OBJ_£t˘_AuthResBaggage
 
OBJ_£t_˘y≥
,8L

	)

3439 
	#SN_£t˘_AuthRevReqBaggage
 "£t˘-AuthRevReqBaggage"

	)

3440 
	#NID_£t˘_AuthRevReqBaggage
 528

	)

3441 
	#OBJ_£t˘_AuthRevReqBaggage
 
OBJ_£t_˘y≥
,9L

	)

3443 
	#SN_£t˘_AuthRevResBaggage
 "£t˘-AuthRevResBaggage"

	)

3444 
	#NID_£t˘_AuthRevResBaggage
 529

	)

3445 
	#OBJ_£t˘_AuthRevResBaggage
 
OBJ_£t_˘y≥
,10L

	)

3447 
	#SN_£t˘_C≠TokíSeq
 "£t˘-C≠TokíSeq"

	)

3448 
	#NID_£t˘_C≠TokíSeq
 530

	)

3449 
	#OBJ_£t˘_C≠TokíSeq
 
OBJ_£t_˘y≥
,11L

	)

3451 
	#SN_£t˘_PInôResD©a
 "£t˘-PInôResD©a"

	)

3452 
	#NID_£t˘_PInôResD©a
 531

	)

3453 
	#OBJ_£t˘_PInôResD©a
 
OBJ_£t_˘y≥
,12L

	)

3455 
	#SN_£t˘_PI_TBS
 "£t˘-PI-TBS"

	)

3456 
	#NID_£t˘_PI_TBS
 532

	)

3457 
	#OBJ_£t˘_PI_TBS
 
OBJ_£t_˘y≥
,13L

	)

3459 
	#SN_£t˘_PResD©a
 "£t˘-PResD©a"

	)

3460 
	#NID_£t˘_PResD©a
 533

	)

3461 
	#OBJ_£t˘_PResD©a
 
OBJ_£t_˘y≥
,14L

	)

3463 
	#SN_£t˘_AuthReqTBS
 "£t˘-AuthReqTBS"

	)

3464 
	#NID_£t˘_AuthReqTBS
 534

	)

3465 
	#OBJ_£t˘_AuthReqTBS
 
OBJ_£t_˘y≥
,16L

	)

3467 
	#SN_£t˘_AuthResTBS
 "£t˘-AuthResTBS"

	)

3468 
	#NID_£t˘_AuthResTBS
 535

	)

3469 
	#OBJ_£t˘_AuthResTBS
 
OBJ_£t_˘y≥
,17L

	)

3471 
	#SN_£t˘_AuthResTBSX
 "£t˘-AuthResTBSX"

	)

3472 
	#NID_£t˘_AuthResTBSX
 536

	)

3473 
	#OBJ_£t˘_AuthResTBSX
 
OBJ_£t_˘y≥
,18L

	)

3475 
	#SN_£t˘_AuthTokíTBS
 "£t˘-AuthTokíTBS"

	)

3476 
	#NID_£t˘_AuthTokíTBS
 537

	)

3477 
	#OBJ_£t˘_AuthTokíTBS
 
OBJ_£t_˘y≥
,19L

	)

3479 
	#SN_£t˘_C≠TokíD©a
 "£t˘-C≠TokíD©a"

	)

3480 
	#NID_£t˘_C≠TokíD©a
 538

	)

3481 
	#OBJ_£t˘_C≠TokíD©a
 
OBJ_£t_˘y≥
,20L

	)

3483 
	#SN_£t˘_C≠TokíTBS
 "£t˘-C≠TokíTBS"

	)

3484 
	#NID_£t˘_C≠TokíTBS
 539

	)

3485 
	#OBJ_£t˘_C≠TokíTBS
 
OBJ_£t_˘y≥
,21L

	)

3487 
	#SN_£t˘_AcqC¨dCodeMsg
 "£t˘-AcqC¨dCodeMsg"

	)

3488 
	#NID_£t˘_AcqC¨dCodeMsg
 540

	)

3489 
	#OBJ_£t˘_AcqC¨dCodeMsg
 
OBJ_£t_˘y≥
,22L

	)

3491 
	#SN_£t˘_AuthRevReqTBS
 "£t˘-AuthRevReqTBS"

	)

3492 
	#NID_£t˘_AuthRevReqTBS
 541

	)

3493 
	#OBJ_£t˘_AuthRevReqTBS
 
OBJ_£t_˘y≥
,23L

	)

3495 
	#SN_£t˘_AuthRevResD©a
 "£t˘-AuthRevResD©a"

	)

3496 
	#NID_£t˘_AuthRevResD©a
 542

	)

3497 
	#OBJ_£t˘_AuthRevResD©a
 
OBJ_£t_˘y≥
,24L

	)

3499 
	#SN_£t˘_AuthRevResTBS
 "£t˘-AuthRevResTBS"

	)

3500 
	#NID_£t˘_AuthRevResTBS
 543

	)

3501 
	#OBJ_£t˘_AuthRevResTBS
 
OBJ_£t_˘y≥
,25L

	)

3503 
	#SN_£t˘_C≠ReqTBS
 "£t˘-C≠ReqTBS"

	)

3504 
	#NID_£t˘_C≠ReqTBS
 544

	)

3505 
	#OBJ_£t˘_C≠ReqTBS
 
OBJ_£t_˘y≥
,26L

	)

3507 
	#SN_£t˘_C≠ReqTBSX
 "£t˘-C≠ReqTBSX"

	)

3508 
	#NID_£t˘_C≠ReqTBSX
 545

	)

3509 
	#OBJ_£t˘_C≠ReqTBSX
 
OBJ_£t_˘y≥
,27L

	)

3511 
	#SN_£t˘_C≠ResD©a
 "£t˘-C≠ResD©a"

	)

3512 
	#NID_£t˘_C≠ResD©a
 546

	)

3513 
	#OBJ_£t˘_C≠ResD©a
 
OBJ_£t_˘y≥
,28L

	)

3515 
	#SN_£t˘_C≠RevReqTBS
 "£t˘-C≠RevReqTBS"

	)

3516 
	#NID_£t˘_C≠RevReqTBS
 547

	)

3517 
	#OBJ_£t˘_C≠RevReqTBS
 
OBJ_£t_˘y≥
,29L

	)

3519 
	#SN_£t˘_C≠RevReqTBSX
 "£t˘-C≠RevReqTBSX"

	)

3520 
	#NID_£t˘_C≠RevReqTBSX
 548

	)

3521 
	#OBJ_£t˘_C≠RevReqTBSX
 
OBJ_£t_˘y≥
,30L

	)

3523 
	#SN_£t˘_C≠RevResD©a
 "£t˘-C≠RevResD©a"

	)

3524 
	#NID_£t˘_C≠RevResD©a
 549

	)

3525 
	#OBJ_£t˘_C≠RevResD©a
 
OBJ_£t_˘y≥
,31L

	)

3527 
	#SN_£t˘_CªdReqTBS
 "£t˘-CªdReqTBS"

	)

3528 
	#NID_£t˘_CªdReqTBS
 550

	)

3529 
	#OBJ_£t˘_CªdReqTBS
 
OBJ_£t_˘y≥
,32L

	)

3531 
	#SN_£t˘_CªdReqTBSX
 "£t˘-CªdReqTBSX"

	)

3532 
	#NID_£t˘_CªdReqTBSX
 551

	)

3533 
	#OBJ_£t˘_CªdReqTBSX
 
OBJ_£t_˘y≥
,33L

	)

3535 
	#SN_£t˘_CªdResD©a
 "£t˘-CªdResD©a"

	)

3536 
	#NID_£t˘_CªdResD©a
 552

	)

3537 
	#OBJ_£t˘_CªdResD©a
 
OBJ_£t_˘y≥
,34L

	)

3539 
	#SN_£t˘_CªdRevReqTBS
 "£t˘-CªdRevReqTBS"

	)

3540 
	#NID_£t˘_CªdRevReqTBS
 553

	)

3541 
	#OBJ_£t˘_CªdRevReqTBS
 
OBJ_£t_˘y≥
,35L

	)

3543 
	#SN_£t˘_CªdRevReqTBSX
 "£t˘-CªdRevReqTBSX"

	)

3544 
	#NID_£t˘_CªdRevReqTBSX
 554

	)

3545 
	#OBJ_£t˘_CªdRevReqTBSX
 
OBJ_£t_˘y≥
,36L

	)

3547 
	#SN_£t˘_CªdRevResD©a
 "£t˘-CªdRevResD©a"

	)

3548 
	#NID_£t˘_CªdRevResD©a
 555

	)

3549 
	#OBJ_£t˘_CªdRevResD©a
 
OBJ_£t_˘y≥
,37L

	)

3551 
	#SN_£t˘_PCîtReqD©a
 "£t˘-PCîtReqD©a"

	)

3552 
	#NID_£t˘_PCîtReqD©a
 556

	)

3553 
	#OBJ_£t˘_PCîtReqD©a
 
OBJ_£t_˘y≥
,38L

	)

3555 
	#SN_£t˘_PCîtResTBS
 "£t˘-PCîtResTBS"

	)

3556 
	#NID_£t˘_PCîtResTBS
 557

	)

3557 
	#OBJ_£t˘_PCîtResTBS
 
OBJ_£t_˘y≥
,39L

	)

3559 
	#SN_£t˘_B©chAdmöReqD©a
 "£t˘-B©chAdmöReqD©a"

	)

3560 
	#NID_£t˘_B©chAdmöReqD©a
 558

	)

3561 
	#OBJ_£t˘_B©chAdmöReqD©a
 
OBJ_£t_˘y≥
,40L

	)

3563 
	#SN_£t˘_B©chAdmöResD©a
 "£t˘-B©chAdmöResD©a"

	)

3564 
	#NID_£t˘_B©chAdmöResD©a
 559

	)

3565 
	#OBJ_£t˘_B©chAdmöResD©a
 
OBJ_£t_˘y≥
,41L

	)

3567 
	#SN_£t˘_C¨dCInôResTBS
 "£t˘-C¨dCInôResTBS"

	)

3568 
	#NID_£t˘_C¨dCInôResTBS
 560

	)

3569 
	#OBJ_£t˘_C¨dCInôResTBS
 
OBJ_£t_˘y≥
,42L

	)

3571 
	#SN_£t˘_MeAqCInôResTBS
 "£t˘-MeAqCInôResTBS"

	)

3572 
	#NID_£t˘_MeAqCInôResTBS
 561

	)

3573 
	#OBJ_£t˘_MeAqCInôResTBS
 
OBJ_£t_˘y≥
,43L

	)

3575 
	#SN_£t˘_RegF‹mResTBS
 "£t˘-RegF‹mResTBS"

	)

3576 
	#NID_£t˘_RegF‹mResTBS
 562

	)

3577 
	#OBJ_£t˘_RegF‹mResTBS
 
OBJ_£t_˘y≥
,44L

	)

3579 
	#SN_£t˘_CîtReqD©a
 "£t˘-CîtReqD©a"

	)

3580 
	#NID_£t˘_CîtReqD©a
 563

	)

3581 
	#OBJ_£t˘_CîtReqD©a
 
OBJ_£t_˘y≥
,45L

	)

3583 
	#SN_£t˘_CîtReqTBS
 "£t˘-CîtReqTBS"

	)

3584 
	#NID_£t˘_CîtReqTBS
 564

	)

3585 
	#OBJ_£t˘_CîtReqTBS
 
OBJ_£t_˘y≥
,46L

	)

3587 
	#SN_£t˘_CîtResD©a
 "£t˘-CîtResD©a"

	)

3588 
	#NID_£t˘_CîtResD©a
 565

	)

3589 
	#OBJ_£t˘_CîtResD©a
 
OBJ_£t_˘y≥
,47L

	)

3591 
	#SN_£t˘_CîtInqReqTBS
 "£t˘-CîtInqReqTBS"

	)

3592 
	#NID_£t˘_CîtInqReqTBS
 566

	)

3593 
	#OBJ_£t˘_CîtInqReqTBS
 
OBJ_£t_˘y≥
,48L

	)

3595 
	#SN_£t˘_Eº‹TBS
 "£t˘-Eº‹TBS"

	)

3596 
	#NID_£t˘_Eº‹TBS
 567

	)

3597 
	#OBJ_£t˘_Eº‹TBS
 
OBJ_£t_˘y≥
,49L

	)

3599 
	#SN_£t˘_PIDuÆSig√dTBE
 "£t˘-PIDuÆSig√dTBE"

	)

3600 
	#NID_£t˘_PIDuÆSig√dTBE
 568

	)

3601 
	#OBJ_£t˘_PIDuÆSig√dTBE
 
OBJ_£t_˘y≥
,50L

	)

3603 
	#SN_£t˘_PIUnsig√dTBE
 "£t˘-PIUnsig√dTBE"

	)

3604 
	#NID_£t˘_PIUnsig√dTBE
 569

	)

3605 
	#OBJ_£t˘_PIUnsig√dTBE
 
OBJ_£t_˘y≥
,51L

	)

3607 
	#SN_£t˘_AuthReqTBE
 "£t˘-AuthReqTBE"

	)

3608 
	#NID_£t˘_AuthReqTBE
 570

	)

3609 
	#OBJ_£t˘_AuthReqTBE
 
OBJ_£t_˘y≥
,52L

	)

3611 
	#SN_£t˘_AuthResTBE
 "£t˘-AuthResTBE"

	)

3612 
	#NID_£t˘_AuthResTBE
 571

	)

3613 
	#OBJ_£t˘_AuthResTBE
 
OBJ_£t_˘y≥
,53L

	)

3615 
	#SN_£t˘_AuthResTBEX
 "£t˘-AuthResTBEX"

	)

3616 
	#NID_£t˘_AuthResTBEX
 572

	)

3617 
	#OBJ_£t˘_AuthResTBEX
 
OBJ_£t_˘y≥
,54L

	)

3619 
	#SN_£t˘_AuthTokíTBE
 "£t˘-AuthTokíTBE"

	)

3620 
	#NID_£t˘_AuthTokíTBE
 573

	)

3621 
	#OBJ_£t˘_AuthTokíTBE
 
OBJ_£t_˘y≥
,55L

	)

3623 
	#SN_£t˘_C≠TokíTBE
 "£t˘-C≠TokíTBE"

	)

3624 
	#NID_£t˘_C≠TokíTBE
 574

	)

3625 
	#OBJ_£t˘_C≠TokíTBE
 
OBJ_£t_˘y≥
,56L

	)

3627 
	#SN_£t˘_C≠TokíTBEX
 "£t˘-C≠TokíTBEX"

	)

3628 
	#NID_£t˘_C≠TokíTBEX
 575

	)

3629 
	#OBJ_£t˘_C≠TokíTBEX
 
OBJ_£t_˘y≥
,57L

	)

3631 
	#SN_£t˘_AcqC¨dCodeMsgTBE
 "£t˘-AcqC¨dCodeMsgTBE"

	)

3632 
	#NID_£t˘_AcqC¨dCodeMsgTBE
 576

	)

3633 
	#OBJ_£t˘_AcqC¨dCodeMsgTBE
 
OBJ_£t_˘y≥
,58L

	)

3635 
	#SN_£t˘_AuthRevReqTBE
 "£t˘-AuthRevReqTBE"

	)

3636 
	#NID_£t˘_AuthRevReqTBE
 577

	)

3637 
	#OBJ_£t˘_AuthRevReqTBE
 
OBJ_£t_˘y≥
,59L

	)

3639 
	#SN_£t˘_AuthRevResTBE
 "£t˘-AuthRevResTBE"

	)

3640 
	#NID_£t˘_AuthRevResTBE
 578

	)

3641 
	#OBJ_£t˘_AuthRevResTBE
 
OBJ_£t_˘y≥
,60L

	)

3643 
	#SN_£t˘_AuthRevResTBEB
 "£t˘-AuthRevResTBEB"

	)

3644 
	#NID_£t˘_AuthRevResTBEB
 579

	)

3645 
	#OBJ_£t˘_AuthRevResTBEB
 
OBJ_£t_˘y≥
,61L

	)

3647 
	#SN_£t˘_C≠ReqTBE
 "£t˘-C≠ReqTBE"

	)

3648 
	#NID_£t˘_C≠ReqTBE
 580

	)

3649 
	#OBJ_£t˘_C≠ReqTBE
 
OBJ_£t_˘y≥
,62L

	)

3651 
	#SN_£t˘_C≠ReqTBEX
 "£t˘-C≠ReqTBEX"

	)

3652 
	#NID_£t˘_C≠ReqTBEX
 581

	)

3653 
	#OBJ_£t˘_C≠ReqTBEX
 
OBJ_£t_˘y≥
,63L

	)

3655 
	#SN_£t˘_C≠ResTBE
 "£t˘-C≠ResTBE"

	)

3656 
	#NID_£t˘_C≠ResTBE
 582

	)

3657 
	#OBJ_£t˘_C≠ResTBE
 
OBJ_£t_˘y≥
,64L

	)

3659 
	#SN_£t˘_C≠RevReqTBE
 "£t˘-C≠RevReqTBE"

	)

3660 
	#NID_£t˘_C≠RevReqTBE
 583

	)

3661 
	#OBJ_£t˘_C≠RevReqTBE
 
OBJ_£t_˘y≥
,65L

	)

3663 
	#SN_£t˘_C≠RevReqTBEX
 "£t˘-C≠RevReqTBEX"

	)

3664 
	#NID_£t˘_C≠RevReqTBEX
 584

	)

3665 
	#OBJ_£t˘_C≠RevReqTBEX
 
OBJ_£t_˘y≥
,66L

	)

3667 
	#SN_£t˘_C≠RevResTBE
 "£t˘-C≠RevResTBE"

	)

3668 
	#NID_£t˘_C≠RevResTBE
 585

	)

3669 
	#OBJ_£t˘_C≠RevResTBE
 
OBJ_£t_˘y≥
,67L

	)

3671 
	#SN_£t˘_CªdReqTBE
 "£t˘-CªdReqTBE"

	)

3672 
	#NID_£t˘_CªdReqTBE
 586

	)

3673 
	#OBJ_£t˘_CªdReqTBE
 
OBJ_£t_˘y≥
,68L

	)

3675 
	#SN_£t˘_CªdReqTBEX
 "£t˘-CªdReqTBEX"

	)

3676 
	#NID_£t˘_CªdReqTBEX
 587

	)

3677 
	#OBJ_£t˘_CªdReqTBEX
 
OBJ_£t_˘y≥
,69L

	)

3679 
	#SN_£t˘_CªdResTBE
 "£t˘-CªdResTBE"

	)

3680 
	#NID_£t˘_CªdResTBE
 588

	)

3681 
	#OBJ_£t˘_CªdResTBE
 
OBJ_£t_˘y≥
,70L

	)

3683 
	#SN_£t˘_CªdRevReqTBE
 "£t˘-CªdRevReqTBE"

	)

3684 
	#NID_£t˘_CªdRevReqTBE
 589

	)

3685 
	#OBJ_£t˘_CªdRevReqTBE
 
OBJ_£t_˘y≥
,71L

	)

3687 
	#SN_£t˘_CªdRevReqTBEX
 "£t˘-CªdRevReqTBEX"

	)

3688 
	#NID_£t˘_CªdRevReqTBEX
 590

	)

3689 
	#OBJ_£t˘_CªdRevReqTBEX
 
OBJ_£t_˘y≥
,72L

	)

3691 
	#SN_£t˘_CªdRevResTBE
 "£t˘-CªdRevResTBE"

	)

3692 
	#NID_£t˘_CªdRevResTBE
 591

	)

3693 
	#OBJ_£t˘_CªdRevResTBE
 
OBJ_£t_˘y≥
,73L

	)

3695 
	#SN_£t˘_B©chAdmöReqTBE
 "£t˘-B©chAdmöReqTBE"

	)

3696 
	#NID_£t˘_B©chAdmöReqTBE
 592

	)

3697 
	#OBJ_£t˘_B©chAdmöReqTBE
 
OBJ_£t_˘y≥
,74L

	)

3699 
	#SN_£t˘_B©chAdmöResTBE
 "£t˘-B©chAdmöResTBE"

	)

3700 
	#NID_£t˘_B©chAdmöResTBE
 593

	)

3701 
	#OBJ_£t˘_B©chAdmöResTBE
 
OBJ_£t_˘y≥
,75L

	)

3703 
	#SN_£t˘_RegF‹mReqTBE
 "£t˘-RegF‹mReqTBE"

	)

3704 
	#NID_£t˘_RegF‹mReqTBE
 594

	)

3705 
	#OBJ_£t˘_RegF‹mReqTBE
 
OBJ_£t_˘y≥
,76L

	)

3707 
	#SN_£t˘_CîtReqTBE
 "£t˘-CîtReqTBE"

	)

3708 
	#NID_£t˘_CîtReqTBE
 595

	)

3709 
	#OBJ_£t˘_CîtReqTBE
 
OBJ_£t_˘y≥
,77L

	)

3711 
	#SN_£t˘_CîtReqTBEX
 "£t˘-CîtReqTBEX"

	)

3712 
	#NID_£t˘_CîtReqTBEX
 596

	)

3713 
	#OBJ_£t˘_CîtReqTBEX
 
OBJ_£t_˘y≥
,78L

	)

3715 
	#SN_£t˘_CîtResTBE
 "£t˘-CîtResTBE"

	)

3716 
	#NID_£t˘_CîtResTBE
 597

	)

3717 
	#OBJ_£t˘_CîtResTBE
 
OBJ_£t_˘y≥
,79L

	)

3719 
	#SN_£t˘_CRLNŸifiˇti⁄TBS
 "£t˘-CRLNŸifiˇti⁄TBS"

	)

3720 
	#NID_£t˘_CRLNŸifiˇti⁄TBS
 598

	)

3721 
	#OBJ_£t˘_CRLNŸifiˇti⁄TBS
 
OBJ_£t_˘y≥
,80L

	)

3723 
	#SN_£t˘_CRLNŸifiˇti⁄ResTBS
 "£t˘-CRLNŸifiˇti⁄ResTBS"

	)

3724 
	#NID_£t˘_CRLNŸifiˇti⁄ResTBS
 599

	)

3725 
	#OBJ_£t˘_CRLNŸifiˇti⁄ResTBS
 
OBJ_£t_˘y≥
,81L

	)

3727 
	#SN_£t˘_BCIDi°ributi⁄TBS
 "£t˘-BCIDi°ributi⁄TBS"

	)

3728 
	#NID_£t˘_BCIDi°ributi⁄TBS
 600

	)

3729 
	#OBJ_£t˘_BCIDi°ributi⁄TBS
 
OBJ_£t_˘y≥
,82L

	)

3731 
	#SN_£ãxt_gíCry±
 "£ãxt-gíCry±"

	)

3732 
	#LN_£ãxt_gíCry±
 "gíîi¯¸y±ogøm"

	)

3733 
	#NID_£ãxt_gíCry±
 601

	)

3734 
	#OBJ_£ãxt_gíCry±
 
OBJ_£t_msgExt
,1L

	)

3736 
	#SN_£ãxt_miAuth
 "£ãxt-miAuth"

	)

3737 
	#LN_£ãxt_miAuth
 "mîch™àöôüãdáuth"

	)

3738 
	#NID_£ãxt_miAuth
 602

	)

3739 
	#OBJ_£ãxt_miAuth
 
OBJ_£t_msgExt
,3L

	)

3741 
	#SN_£ãxt_pöSecuª
 "£ãxt-pöSecuª"

	)

3742 
	#NID_£ãxt_pöSecuª
 603

	)

3743 
	#OBJ_£ãxt_pöSecuª
 
OBJ_£t_msgExt
,4L

	)

3745 
	#SN_£ãxt_pöAny
 "£ãxt-pöAny"

	)

3746 
	#NID_£ãxt_pöAny
 604

	)

3747 
	#OBJ_£ãxt_pöAny
 
OBJ_£t_msgExt
,5L

	)

3749 
	#SN_£ãxt_åack2
 "£ãxt-åack2"

	)

3750 
	#NID_£ãxt_åack2
 605

	)

3751 
	#OBJ_£ãxt_åack2
 
OBJ_£t_msgExt
,7L

	)

3753 
	#SN_£ãxt_cv
 "£ãxt-cv"

	)

3754 
	#LN_£ãxt_cv
 "addôi⁄Æ vîifiˇti⁄"

	)

3755 
	#NID_£ãxt_cv
 606

	)

3756 
	#OBJ_£ãxt_cv
 
OBJ_£t_msgExt
,8L

	)

3758 
	#SN_£t_pﬁicy_roŸ
 "£t-pﬁicy-roŸ"

	)

3759 
	#NID_£t_pﬁicy_roŸ
 607

	)

3760 
	#OBJ_£t_pﬁicy_roŸ
 
OBJ_£t_pﬁicy
,0L

	)

3762 
	#SN_£tCext_hashedRoŸ
 "£tCext-hashedRoŸ"

	)

3763 
	#NID_£tCext_hashedRoŸ
 608

	)

3764 
	#OBJ_£tCext_hashedRoŸ
 
OBJ_£t_˚πExt
,0L

	)

3766 
	#SN_£tCext_˚πTy≥
 "£tCext-˚πTy≥"

	)

3767 
	#NID_£tCext_˚πTy≥
 609

	)

3768 
	#OBJ_£tCext_˚πTy≥
 
OBJ_£t_˚πExt
,1L

	)

3770 
	#SN_£tCext_mîchD©a
 "£tCext-mîchD©a"

	)

3771 
	#NID_£tCext_mîchD©a
 610

	)

3772 
	#OBJ_£tCext_mîchD©a
 
OBJ_£t_˚πExt
,2L

	)

3774 
	#SN_£tCext_cCîtRequúed
 "£tCext-cCîtRequúed"

	)

3775 
	#NID_£tCext_cCîtRequúed
 611

	)

3776 
	#OBJ_£tCext_cCîtRequúed
 
OBJ_£t_˚πExt
,3L

	)

3778 
	#SN_£tCext_tu¬ñög
 "£tCext-tu¬ñög"

	)

3779 
	#NID_£tCext_tu¬ñög
 612

	)

3780 
	#OBJ_£tCext_tu¬ñög
 
OBJ_£t_˚πExt
,4L

	)

3782 
	#SN_£tCext_£tExt
 "£tCext-£tExt"

	)

3783 
	#NID_£tCext_£tExt
 613

	)

3784 
	#OBJ_£tCext_£tExt
 
OBJ_£t_˚πExt
,5L

	)

3786 
	#SN_£tCext_£tQuÆf
 "£tCext-£tQuÆf"

	)

3787 
	#NID_£tCext_£tQuÆf
 614

	)

3788 
	#OBJ_£tCext_£tQuÆf
 
OBJ_£t_˚πExt
,6L

	)

3790 
	#SN_£tCext_PGWYˇ∑bûôõs
 "£tCext-PGWYˇ∑bûôõs"

	)

3791 
	#NID_£tCext_PGWYˇ∑bûôõs
 615

	)

3792 
	#OBJ_£tCext_PGWYˇ∑bûôõs
 
OBJ_£t_˚πExt
,7L

	)

3794 
	#SN_£tCext_TokíIdítifõr
 "£tCext-TokíIdítifõr"

	)

3795 
	#NID_£tCext_TokíIdítifõr
 616

	)

3796 
	#OBJ_£tCext_TokíIdítifõr
 
OBJ_£t_˚πExt
,8L

	)

3798 
	#SN_£tCext_Tøck2D©a
 "£tCext-Tøck2D©a"

	)

3799 
	#NID_£tCext_Tøck2D©a
 617

	)

3800 
	#OBJ_£tCext_Tøck2D©a
 
OBJ_£t_˚πExt
,9L

	)

3802 
	#SN_£tCext_TokíTy≥
 "£tCext-TokíTy≥"

	)

3803 
	#NID_£tCext_TokíTy≥
 618

	)

3804 
	#OBJ_£tCext_TokíTy≥
 
OBJ_£t_˚πExt
,10L

	)

3806 
	#SN_£tCext_IssuîC≠abûôõs
 "£tCext-IssuîC≠abûôõs"

	)

3807 
	#NID_£tCext_IssuîC≠abûôõs
 619

	)

3808 
	#OBJ_£tCext_IssuîC≠abûôõs
 
OBJ_£t_˚πExt
,11L

	)

3810 
	#SN_£tAâr_Cît
 "£tAâr-Cît"

	)

3811 
	#NID_£tAâr_Cît
 620

	)

3812 
	#OBJ_£tAâr_Cît
 
OBJ_£t_©å
,0L

	)

3814 
	#SN_£tAâr_PGWYˇp
 "£tAâr-PGWYˇp"

	)

3815 
	#LN_£tAâr_PGWYˇp
 "∑ymíàg©eway c≠abûôõs"

	)

3816 
	#NID_£tAâr_PGWYˇp
 621

	)

3817 
	#OBJ_£tAâr_PGWYˇp
 
OBJ_£t_©å
,1L

	)

3819 
	#SN_£tAâr_TokíTy≥
 "£tAâr-TokíTy≥"

	)

3820 
	#NID_£tAâr_TokíTy≥
 622

	)

3821 
	#OBJ_£tAâr_TokíTy≥
 
OBJ_£t_©å
,2L

	)

3823 
	#SN_£tAâr_IssC≠
 "£tAâr-IssC≠"

	)

3824 
	#LN_£tAâr_IssC≠
 "issuî c≠abûôõs"

	)

3825 
	#NID_£tAâr_IssC≠
 623

	)

3826 
	#OBJ_£tAâr_IssC≠
 
OBJ_£t_©å
,3L

	)

3828 
	#SN_£t_roŸKeyThumb
 "£t-roŸKeyThumb"

	)

3829 
	#NID_£t_roŸKeyThumb
 624

	)

3830 
	#OBJ_£t_roŸKeyThumb
 
OBJ_£tAâr_Cît
,0L

	)

3832 
	#SN_£t_addPﬁicy
 "£t-addPﬁicy"

	)

3833 
	#NID_£t_addPﬁicy
 625

	)

3834 
	#OBJ_£t_addPﬁicy
 
OBJ_£tAâr_Cît
,1L

	)

3836 
	#SN_£tAâr_Tokí_EMV
 "£tAâr-Tokí-EMV"

	)

3837 
	#NID_£tAâr_Tokí_EMV
 626

	)

3838 
	#OBJ_£tAâr_Tokí_EMV
 
OBJ_£tAâr_TokíTy≥
,1L

	)

3840 
	#SN_£tAâr_Tokí_B0Prime
 "£tAâr-Tokí-B0Prime"

	)

3841 
	#NID_£tAâr_Tokí_B0Prime
 627

	)

3842 
	#OBJ_£tAâr_Tokí_B0Prime
 
OBJ_£tAâr_TokíTy≥
,2L

	)

3844 
	#SN_£tAâr_IssC≠_CVM
 "£tAâr-IssC≠-CVM"

	)

3845 
	#NID_£tAâr_IssC≠_CVM
 628

	)

3846 
	#OBJ_£tAâr_IssC≠_CVM
 
OBJ_£tAâr_IssC≠
,3L

	)

3848 
	#SN_£tAâr_IssC≠_T2
 "£tAâr-IssC≠-T2"

	)

3849 
	#NID_£tAâr_IssC≠_T2
 629

	)

3850 
	#OBJ_£tAâr_IssC≠_T2
 
OBJ_£tAâr_IssC≠
,4L

	)

3852 
	#SN_£tAâr_IssC≠_Sig
 "£tAâr-IssC≠-Sig"

	)

3853 
	#NID_£tAâr_IssC≠_Sig
 630

	)

3854 
	#OBJ_£tAâr_IssC≠_Sig
 
OBJ_£tAâr_IssC≠
,5L

	)

3856 
	#SN_£tAâr_GíCry±grm
 "£tAâr-GíCry±grm"

	)

3857 
	#LN_£tAâr_GíCry±grm
 "gíî©ê¸y±ogøm"

	)

3858 
	#NID_£tAâr_GíCry±grm
 631

	)

3859 
	#OBJ_£tAâr_GíCry±grm
 
OBJ_£tAâr_IssC≠_CVM
,1L

	)

3861 
	#SN_£tAâr_T2Enc
 "£tAâr-T2Enc"

	)

3862 
	#LN_£tAâr_T2Enc
 "í¸y±edÅøck 2"

	)

3863 
	#NID_£tAâr_T2Enc
 632

	)

3864 
	#OBJ_£tAâr_T2Enc
 
OBJ_£tAâr_IssC≠_T2
,1L

	)

3866 
	#SN_£tAâr_T2˛óπxt
 "£tAâr-T2˛óπxt"

	)

3867 
	#LN_£tAâr_T2˛óπxt
 "˛óπexàåack 2"

	)

3868 
	#NID_£tAâr_T2˛óπxt
 633

	)

3869 
	#OBJ_£tAâr_T2˛óπxt
 
OBJ_£tAâr_IssC≠_T2
,2L

	)

3871 
	#SN_£tAâr_TokICCsig
 "£tAâr-TokICCsig"

	)

3872 
	#LN_£tAâr_TokICCsig
 "ICC o∏tokí sig«tuª"

	)

3873 
	#NID_£tAâr_TokICCsig
 634

	)

3874 
	#OBJ_£tAâr_TokICCsig
 
OBJ_£tAâr_IssC≠_Sig
,1L

	)

3876 
	#SN_£tAâr_SecDevSig
 "£tAâr-SecDevSig"

	)

3877 
	#LN_£tAâr_SecDevSig
 "£cuª devi˚ sig«tuª"

	)

3878 
	#NID_£tAâr_SecDevSig
 635

	)

3879 
	#OBJ_£tAâr_SecDevSig
 
OBJ_£tAâr_IssC≠_Sig
,2L

	)

3881 
	#SN_£t_bønd_IATA_ATA
 "£t-bønd-IATA-ATA"

	)

3882 
	#NID_£t_bønd_IATA_ATA
 636

	)

3883 
	#OBJ_£t_bønd_IATA_ATA
 
OBJ_£t_bønd
,1L

	)

3885 
	#SN_£t_bønd_Döîs
 "£t-bønd-Döîs"

	)

3886 
	#NID_£t_bønd_Döîs
 637

	)

3887 
	#OBJ_£t_bønd_Döîs
 
OBJ_£t_bønd
,30L

	)

3889 
	#SN_£t_bønd_AmîiˇnEx¥ess
 "£t-bønd-AmîiˇnEx¥ess"

	)

3890 
	#NID_£t_bønd_AmîiˇnEx¥ess
 638

	)

3891 
	#OBJ_£t_bønd_AmîiˇnEx¥ess
 
OBJ_£t_bønd
,34L

	)

3893 
	#SN_£t_bønd_JCB
 "£t-bønd-JCB"

	)

3894 
	#NID_£t_bønd_JCB
 639

	)

3895 
	#OBJ_£t_bønd_JCB
 
OBJ_£t_bønd
,35L

	)

3897 
	#SN_£t_bønd_Viß
 "£t-bønd-Viß"

	)

3898 
	#NID_£t_bønd_Viß
 640

	)

3899 
	#OBJ_£t_bønd_Viß
 
OBJ_£t_bønd
,4L

	)

3901 
	#SN_£t_bønd_Ma°îC¨d
 "£t-bønd-Ma°îC¨d"

	)

3902 
	#NID_£t_bønd_Ma°îC¨d
 641

	)

3903 
	#OBJ_£t_bønd_Ma°îC¨d
 
OBJ_£t_bønd
,5L

	)

3905 
	#SN_£t_bønd_Novus
 "£t-bønd-Novus"

	)

3906 
	#NID_£t_bønd_Novus
 642

	)

3907 
	#OBJ_£t_bønd_Novus
 
OBJ_£t_bønd
,6011L

	)

3909 
	#SN_des_cdmf
 "DES-CDMF"

	)

3910 
	#LN_des_cdmf
 "des-cdmf"

	)

3911 
	#NID_des_cdmf
 643

	)

3912 
	#OBJ_des_cdmf
 
OBJ_rßdsi
,3L,10L

	)

3914 
	#SN_rßOAEPEn¸y±i⁄SET
 "rßOAEPEn¸y±i⁄SET"

	)

3915 
	#NID_rßOAEPEn¸y±i⁄SET
 644

	)

3916 
	#OBJ_rßOAEPEn¸y±i⁄SET
 
OBJ_rßdsi
,1L,1L,6L

	)

3918 
	#SN_ù£c3
 "OakÀy-EC2N-3"

	)

3919 
	#LN_ù£c3
 "ù£c3"

	)

3920 
	#NID_ù£c3
 749

	)

3922 
	#SN_ù£c4
 "OakÀy-EC2N-4"

	)

3923 
	#LN_ù£c4
 "ù£c4"

	)

3924 
	#NID_ù£c4
 750

	)

3926 
	#SN_whúÕoﬁ
 "whúÕoﬁ"

	)

3927 
	#NID_whúÕoﬁ
 804

	)

3928 
	#OBJ_whúÕoﬁ
 
OBJ_iso
,0L,10118L,3L,0L,55L

	)

3930 
	#SN_¸y±›ro
 "¸y±›ro"

	)

3931 
	#NID_¸y±›ro
 805

	)

3932 
	#OBJ_¸y±›ro
 
OBJ_membî_body
,643L,2L,2L

	)

3934 
	#SN_¸y±ocom
 "¸y±ocom"

	)

3935 
	#NID_¸y±ocom
 806

	)

3936 
	#OBJ_¸y±ocom
 
OBJ_membî_body
,643L,2L,9L

	)

3938 
	#SN_id_tc26
 "id-tc26"

	)

3939 
	#NID_id_tc26
 974

	)

3940 
	#OBJ_id_tc26
 
OBJ_membî_body
,643L,7L,1L

	)

3942 
	#SN_id_Go°R3411_94_wôh_Go°R3410_2001
 "id-Go°R3411-94-wôh-Go°R3410-2001"

	)

3943 
	#LN_id_Go°R3411_94_wôh_Go°R3410_2001
 "GOST R 34.11-94 wôh GOST R 34.10-2001"

	)

3944 
	#NID_id_Go°R3411_94_wôh_Go°R3410_2001
 807

	)

3945 
	#OBJ_id_Go°R3411_94_wôh_Go°R3410_2001
 
OBJ_¸y±›ro
,3L

	)

3947 
	#SN_id_Go°R3411_94_wôh_Go°R3410_94
 "id-Go°R3411-94-wôh-Go°R3410-94"

	)

3948 
	#LN_id_Go°R3411_94_wôh_Go°R3410_94
 "GOST R 34.11-94 wôh GOST R 34.10-94"

	)

3949 
	#NID_id_Go°R3411_94_wôh_Go°R3410_94
 808

	)

3950 
	#OBJ_id_Go°R3411_94_wôh_Go°R3410_94
 
OBJ_¸y±›ro
,4L

	)

3952 
	#SN_id_Go°R3411_94
 "md_go°94"

	)

3953 
	#LN_id_Go°R3411_94
 "GOST R 34.11-94"

	)

3954 
	#NID_id_Go°R3411_94
 809

	)

3955 
	#OBJ_id_Go°R3411_94
 
OBJ_¸y±›ro
,9L

	)

3957 
	#SN_id_HMACGo°R3411_94
 "id-HMACGo°R3411-94"

	)

3958 
	#LN_id_HMACGo°R3411_94
 "HMAC GOST 34.11-94"

	)

3959 
	#NID_id_HMACGo°R3411_94
 810

	)

3960 
	#OBJ_id_HMACGo°R3411_94
 
OBJ_¸y±›ro
,10L

	)

3962 
	#SN_id_Go°R3410_2001
 "go°2001"

	)

3963 
	#LN_id_Go°R3410_2001
 "GOST R 34.10-2001"

	)

3964 
	#NID_id_Go°R3410_2001
 811

	)

3965 
	#OBJ_id_Go°R3410_2001
 
OBJ_¸y±›ro
,19L

	)

3967 
	#SN_id_Go°R3410_94
 "go°94"

	)

3968 
	#LN_id_Go°R3410_94
 "GOST R 34.10-94"

	)

3969 
	#NID_id_Go°R3410_94
 812

	)

3970 
	#OBJ_id_Go°R3410_94
 
OBJ_¸y±›ro
,20L

	)

3972 
	#SN_id_Go°28147_89
 "go°89"

	)

3973 
	#LN_id_Go°28147_89
 "GOST 28147-89"

	)

3974 
	#NID_id_Go°28147_89
 813

	)

3975 
	#OBJ_id_Go°28147_89
 
OBJ_¸y±›ro
,21L

	)

3977 
	#SN_go°89_˙t
 "go°89-˙t"

	)

3978 
	#NID_go°89_˙t
 814

	)

3980 
	#SN_go°89_˙t_12
 "go°89-˙t-12"

	)

3981 
	#NID_go°89_˙t_12
 975

	)

3983 
	#SN_go°89_cbc
 "go°89-cbc"

	)

3984 
	#NID_go°89_cbc
 1009

	)

3986 
	#SN_go°89_ecb
 "go°89-ecb"

	)

3987 
	#NID_go°89_ecb
 1010

	)

3989 
	#SN_go°89_˘r
 "go°89-˘r"

	)

3990 
	#NID_go°89_˘r
 1011

	)

3992 
	#SN_id_Go°28147_89_MAC
 "go°-mac"

	)

3993 
	#LN_id_Go°28147_89_MAC
 "GOST 28147-89 MAC"

	)

3994 
	#NID_id_Go°28147_89_MAC
 815

	)

3995 
	#OBJ_id_Go°28147_89_MAC
 
OBJ_¸y±›ro
,22L

	)

3997 
	#SN_go°_mac_12
 "go°-mac-12"

	)

3998 
	#NID_go°_mac_12
 976

	)

4000 
	#SN_id_Go°R3411_94_¥f
 "¥f-go°r3411-94"

	)

4001 
	#LN_id_Go°R3411_94_¥f
 "GOST R 34.11-94 PRF"

	)

4002 
	#NID_id_Go°R3411_94_¥f
 816

	)

4003 
	#OBJ_id_Go°R3411_94_¥f
 
OBJ_¸y±›ro
,23L

	)

4005 
	#SN_id_Go°R3410_2001DH
 "id-Go°R3410-2001DH"

	)

4006 
	#LN_id_Go°R3410_2001DH
 "GOST R 34.10-2001 DH"

	)

4007 
	#NID_id_Go°R3410_2001DH
 817

	)

4008 
	#OBJ_id_Go°R3410_2001DH
 
OBJ_¸y±›ro
,98L

	)

4010 
	#SN_id_Go°R3410_94DH
 "id-Go°R3410-94DH"

	)

4011 
	#LN_id_Go°R3410_94DH
 "GOST R 34.10-94 DH"

	)

4012 
	#NID_id_Go°R3410_94DH
 818

	)

4013 
	#OBJ_id_Go°R3410_94DH
 
OBJ_¸y±›ro
,99L

	)

4015 
	#SN_id_Go°28147_89_Cry±oPro_KeyMeshög
 "id-Go°28147-89-Cry±oPro-KeyMeshög"

	)

4016 
	#NID_id_Go°28147_89_Cry±oPro_KeyMeshög
 819

	)

4017 
	#OBJ_id_Go°28147_89_Cry±oPro_KeyMeshög
 
OBJ_¸y±›ro
,14L,1L

	)

4019 
	#SN_id_Go°28147_89_N⁄e_KeyMeshög
 "id-Go°28147-89-N⁄e-KeyMeshög"

	)

4020 
	#NID_id_Go°28147_89_N⁄e_KeyMeshög
 820

	)

4021 
	#OBJ_id_Go°28147_89_N⁄e_KeyMeshög
 
OBJ_¸y±›ro
,14L,0L

	)

4023 
	#SN_id_Go°R3411_94_Te°P¨amSë
 "id-Go°R3411-94-Te°P¨amSë"

	)

4024 
	#NID_id_Go°R3411_94_Te°P¨amSë
 821

	)

4025 
	#OBJ_id_Go°R3411_94_Te°P¨amSë
 
OBJ_¸y±›ro
,30L,0L

	)

4027 
	#SN_id_Go°R3411_94_Cry±oProP¨amSë
 "id-Go°R3411-94-Cry±oProP¨amSë"

	)

4028 
	#NID_id_Go°R3411_94_Cry±oProP¨amSë
 822

	)

4029 
	#OBJ_id_Go°R3411_94_Cry±oProP¨amSë
 
OBJ_¸y±›ro
,30L,1L

	)

4031 
	#SN_id_Go°28147_89_Te°P¨amSë
 "id-Go°28147-89-Te°P¨amSë"

	)

4032 
	#NID_id_Go°28147_89_Te°P¨amSë
 823

	)

4033 
	#OBJ_id_Go°28147_89_Te°P¨amSë
 
OBJ_¸y±›ro
,31L,0L

	)

4035 
	#SN_id_Go°28147_89_Cry±oPro_A_P¨amSë
 "id-Go°28147-89-Cry±oPro-A-P¨amSë"

	)

4036 
	#NID_id_Go°28147_89_Cry±oPro_A_P¨amSë
 824

	)

4037 
	#OBJ_id_Go°28147_89_Cry±oPro_A_P¨amSë
 
OBJ_¸y±›ro
,31L,1L

	)

4039 
	#SN_id_Go°28147_89_Cry±oPro_B_P¨amSë
 "id-Go°28147-89-Cry±oPro-B-P¨amSë"

	)

4040 
	#NID_id_Go°28147_89_Cry±oPro_B_P¨amSë
 825

	)

4041 
	#OBJ_id_Go°28147_89_Cry±oPro_B_P¨amSë
 
OBJ_¸y±›ro
,31L,2L

	)

4043 
	#SN_id_Go°28147_89_Cry±oPro_C_P¨amSë
 "id-Go°28147-89-Cry±oPro-C-P¨amSë"

	)

4044 
	#NID_id_Go°28147_89_Cry±oPro_C_P¨amSë
 826

	)

4045 
	#OBJ_id_Go°28147_89_Cry±oPro_C_P¨amSë
 
OBJ_¸y±›ro
,31L,3L

	)

4047 
	#SN_id_Go°28147_89_Cry±oPro_D_P¨amSë
 "id-Go°28147-89-Cry±oPro-D-P¨amSë"

	)

4048 
	#NID_id_Go°28147_89_Cry±oPro_D_P¨amSë
 827

	)

4049 
	#OBJ_id_Go°28147_89_Cry±oPro_D_P¨amSë
 
OBJ_¸y±›ro
,31L,4L

	)

4051 
	#SN_id_Go°28147_89_Cry±oPro_Osˇr_1_1_P¨amSë
 "id-Go°28147-89-Cry±oPro-Osˇr-1-1-P¨amSë"

	)

4052 
	#NID_id_Go°28147_89_Cry±oPro_Osˇr_1_1_P¨amSë
 828

	)

4053 
	#OBJ_id_Go°28147_89_Cry±oPro_Osˇr_1_1_P¨amSë
 
OBJ_¸y±›ro
,31L,5L

	)

4055 
	#SN_id_Go°28147_89_Cry±oPro_Osˇr_1_0_P¨amSë
 "id-Go°28147-89-Cry±oPro-Osˇr-1-0-P¨amSë"

	)

4056 
	#NID_id_Go°28147_89_Cry±oPro_Osˇr_1_0_P¨amSë
 829

	)

4057 
	#OBJ_id_Go°28147_89_Cry±oPro_Osˇr_1_0_P¨amSë
 
OBJ_¸y±›ro
,31L,6L

	)

4059 
	#SN_id_Go°28147_89_Cry±oPro_RIC_1_P¨amSë
 "id-Go°28147-89-Cry±oPro-RIC-1-P¨amSë"

	)

4060 
	#NID_id_Go°28147_89_Cry±oPro_RIC_1_P¨amSë
 830

	)

4061 
	#OBJ_id_Go°28147_89_Cry±oPro_RIC_1_P¨amSë
 
OBJ_¸y±›ro
,31L,7L

	)

4063 
	#SN_id_Go°R3410_94_Te°P¨amSë
 "id-Go°R3410-94-Te°P¨amSë"

	)

4064 
	#NID_id_Go°R3410_94_Te°P¨amSë
 831

	)

4065 
	#OBJ_id_Go°R3410_94_Te°P¨amSë
 
OBJ_¸y±›ro
,32L,0L

	)

4067 
	#SN_id_Go°R3410_94_Cry±oPro_A_P¨amSë
 "id-Go°R3410-94-Cry±oPro-A-P¨amSë"

	)

4068 
	#NID_id_Go°R3410_94_Cry±oPro_A_P¨amSë
 832

	)

4069 
	#OBJ_id_Go°R3410_94_Cry±oPro_A_P¨amSë
 
OBJ_¸y±›ro
,32L,2L

	)

4071 
	#SN_id_Go°R3410_94_Cry±oPro_B_P¨amSë
 "id-Go°R3410-94-Cry±oPro-B-P¨amSë"

	)

4072 
	#NID_id_Go°R3410_94_Cry±oPro_B_P¨amSë
 833

	)

4073 
	#OBJ_id_Go°R3410_94_Cry±oPro_B_P¨amSë
 
OBJ_¸y±›ro
,32L,3L

	)

4075 
	#SN_id_Go°R3410_94_Cry±oPro_C_P¨amSë
 "id-Go°R3410-94-Cry±oPro-C-P¨amSë"

	)

4076 
	#NID_id_Go°R3410_94_Cry±oPro_C_P¨amSë
 834

	)

4077 
	#OBJ_id_Go°R3410_94_Cry±oPro_C_P¨amSë
 
OBJ_¸y±›ro
,32L,4L

	)

4079 
	#SN_id_Go°R3410_94_Cry±oPro_D_P¨amSë
 "id-Go°R3410-94-Cry±oPro-D-P¨amSë"

	)

4080 
	#NID_id_Go°R3410_94_Cry±oPro_D_P¨amSë
 835

	)

4081 
	#OBJ_id_Go°R3410_94_Cry±oPro_D_P¨amSë
 
OBJ_¸y±›ro
,32L,5L

	)

4083 
	#SN_id_Go°R3410_94_Cry±oPro_XchA_P¨amSë
 "id-Go°R3410-94-Cry±oPro-XchA-P¨amSë"

	)

4084 
	#NID_id_Go°R3410_94_Cry±oPro_XchA_P¨amSë
 836

	)

4085 
	#OBJ_id_Go°R3410_94_Cry±oPro_XchA_P¨amSë
 
OBJ_¸y±›ro
,33L,1L

	)

4087 
	#SN_id_Go°R3410_94_Cry±oPro_XchB_P¨amSë
 "id-Go°R3410-94-Cry±oPro-XchB-P¨amSë"

	)

4088 
	#NID_id_Go°R3410_94_Cry±oPro_XchB_P¨amSë
 837

	)

4089 
	#OBJ_id_Go°R3410_94_Cry±oPro_XchB_P¨amSë
 
OBJ_¸y±›ro
,33L,2L

	)

4091 
	#SN_id_Go°R3410_94_Cry±oPro_XchC_P¨amSë
 "id-Go°R3410-94-Cry±oPro-XchC-P¨amSë"

	)

4092 
	#NID_id_Go°R3410_94_Cry±oPro_XchC_P¨amSë
 838

	)

4093 
	#OBJ_id_Go°R3410_94_Cry±oPro_XchC_P¨amSë
 
OBJ_¸y±›ro
,33L,3L

	)

4095 
	#SN_id_Go°R3410_2001_Te°P¨amSë
 "id-Go°R3410-2001-Te°P¨amSë"

	)

4096 
	#NID_id_Go°R3410_2001_Te°P¨amSë
 839

	)

4097 
	#OBJ_id_Go°R3410_2001_Te°P¨amSë
 
OBJ_¸y±›ro
,35L,0L

	)

4099 
	#SN_id_Go°R3410_2001_Cry±oPro_A_P¨amSë
 "id-Go°R3410-2001-Cry±oPro-A-P¨amSë"

	)

4100 
	#NID_id_Go°R3410_2001_Cry±oPro_A_P¨amSë
 840

	)

4101 
	#OBJ_id_Go°R3410_2001_Cry±oPro_A_P¨amSë
 
OBJ_¸y±›ro
,35L,1L

	)

4103 
	#SN_id_Go°R3410_2001_Cry±oPro_B_P¨amSë
 "id-Go°R3410-2001-Cry±oPro-B-P¨amSë"

	)

4104 
	#NID_id_Go°R3410_2001_Cry±oPro_B_P¨amSë
 841

	)

4105 
	#OBJ_id_Go°R3410_2001_Cry±oPro_B_P¨amSë
 
OBJ_¸y±›ro
,35L,2L

	)

4107 
	#SN_id_Go°R3410_2001_Cry±oPro_C_P¨amSë
 "id-Go°R3410-2001-Cry±oPro-C-P¨amSë"

	)

4108 
	#NID_id_Go°R3410_2001_Cry±oPro_C_P¨amSë
 842

	)

4109 
	#OBJ_id_Go°R3410_2001_Cry±oPro_C_P¨amSë
 
OBJ_¸y±›ro
,35L,3L

	)

4111 
	#SN_id_Go°R3410_2001_Cry±oPro_XchA_P¨amSë
 "id-Go°R3410-2001-Cry±oPro-XchA-P¨amSë"

	)

4112 
	#NID_id_Go°R3410_2001_Cry±oPro_XchA_P¨amSë
 843

	)

4113 
	#OBJ_id_Go°R3410_2001_Cry±oPro_XchA_P¨amSë
 
OBJ_¸y±›ro
,36L,0L

	)

4115 
	#SN_id_Go°R3410_2001_Cry±oPro_XchB_P¨amSë
 "id-Go°R3410-2001-Cry±oPro-XchB-P¨amSë"

	)

4116 
	#NID_id_Go°R3410_2001_Cry±oPro_XchB_P¨amSë
 844

	)

4117 
	#OBJ_id_Go°R3410_2001_Cry±oPro_XchB_P¨amSë
 
OBJ_¸y±›ro
,36L,1L

	)

4119 
	#SN_id_Go°R3410_94_a
 "id-Go°R3410-94-a"

	)

4120 
	#NID_id_Go°R3410_94_a
 845

	)

4121 
	#OBJ_id_Go°R3410_94_a
 
OBJ_id_Go°R3410_94
,1L

	)

4123 
	#SN_id_Go°R3410_94_aBis
 "id-Go°R3410-94-aBis"

	)

4124 
	#NID_id_Go°R3410_94_aBis
 846

	)

4125 
	#OBJ_id_Go°R3410_94_aBis
 
OBJ_id_Go°R3410_94
,2L

	)

4127 
	#SN_id_Go°R3410_94_b
 "id-Go°R3410-94-b"

	)

4128 
	#NID_id_Go°R3410_94_b
 847

	)

4129 
	#OBJ_id_Go°R3410_94_b
 
OBJ_id_Go°R3410_94
,3L

	)

4131 
	#SN_id_Go°R3410_94_bBis
 "id-Go°R3410-94-bBis"

	)

4132 
	#NID_id_Go°R3410_94_bBis
 848

	)

4133 
	#OBJ_id_Go°R3410_94_bBis
 
OBJ_id_Go°R3410_94
,4L

	)

4135 
	#SN_id_Go°28147_89_cc
 "id-Go°28147-89-cc"

	)

4136 
	#LN_id_Go°28147_89_cc
 "GOST 28147-89 Cry±ocom P¨amSë"

	)

4137 
	#NID_id_Go°28147_89_cc
 849

	)

4138 
	#OBJ_id_Go°28147_89_cc
 
OBJ_¸y±ocom
,1L,6L,1L

	)

4140 
	#SN_id_Go°R3410_94_cc
 "go°94cc"

	)

4141 
	#LN_id_Go°R3410_94_cc
 "GOST 34.10-94 Cry±ocom"

	)

4142 
	#NID_id_Go°R3410_94_cc
 850

	)

4143 
	#OBJ_id_Go°R3410_94_cc
 
OBJ_¸y±ocom
,1L,5L,3L

	)

4145 
	#SN_id_Go°R3410_2001_cc
 "go°2001cc"

	)

4146 
	#LN_id_Go°R3410_2001_cc
 "GOST 34.10-2001 Cry±ocom"

	)

4147 
	#NID_id_Go°R3410_2001_cc
 851

	)

4148 
	#OBJ_id_Go°R3410_2001_cc
 
OBJ_¸y±ocom
,1L,5L,4L

	)

4150 
	#SN_id_Go°R3411_94_wôh_Go°R3410_94_cc
 "id-Go°R3411-94-wôh-Go°R3410-94-cc"

	)

4151 
	#LN_id_Go°R3411_94_wôh_Go°R3410_94_cc
 "GOST R 34.11-94 wôh GOST R 34.10-94 Cry±ocom"

	)

4152 
	#NID_id_Go°R3411_94_wôh_Go°R3410_94_cc
 852

	)

4153 
	#OBJ_id_Go°R3411_94_wôh_Go°R3410_94_cc
 
OBJ_¸y±ocom
,1L,3L,3L

	)

4155 
	#SN_id_Go°R3411_94_wôh_Go°R3410_2001_cc
 "id-Go°R3411-94-wôh-Go°R3410-2001-cc"

	)

4156 
	#LN_id_Go°R3411_94_wôh_Go°R3410_2001_cc
 "GOST R 34.11-94 wôh GOST R 34.10-2001 Cry±ocom"

	)

4157 
	#NID_id_Go°R3411_94_wôh_Go°R3410_2001_cc
 853

	)

4158 
	#OBJ_id_Go°R3411_94_wôh_Go°R3410_2001_cc
 
OBJ_¸y±ocom
,1L,3L,4L

	)

4160 
	#SN_id_Go°R3410_2001_P¨amSë_cc
 "id-Go°R3410-2001-P¨amSë-cc"

	)

4161 
	#LN_id_Go°R3410_2001_P¨amSë_cc
 "GOST R 3410-2001 P¨amëî Së Cry±ocom"

	)

4162 
	#NID_id_Go°R3410_2001_P¨amSë_cc
 854

	)

4163 
	#OBJ_id_Go°R3410_2001_P¨amSë_cc
 
OBJ_¸y±ocom
,1L,8L,1L

	)

4165 
	#SN_id_tc26_Æg‹ôhms
 "id-tc26-Æg‹ôhms"

	)

4166 
	#NID_id_tc26_Æg‹ôhms
 977

	)

4167 
	#OBJ_id_tc26_Æg‹ôhms
 
OBJ_id_tc26
,1L

	)

4169 
	#SN_id_tc26_sign
 "id-tc26-sign"

	)

4170 
	#NID_id_tc26_sign
 978

	)

4171 
	#OBJ_id_tc26_sign
 
OBJ_id_tc26_Æg‹ôhms
,1L

	)

4173 
	#SN_id_Go°R3410_2012_256
 "go°2012_256"

	)

4174 
	#LN_id_Go°R3410_2012_256
 "GOST R 34.10-2012 wôh 256 bô modulus"

	)

4175 
	#NID_id_Go°R3410_2012_256
 979

	)

4176 
	#OBJ_id_Go°R3410_2012_256
 
OBJ_id_tc26_sign
,1L

	)

4178 
	#SN_id_Go°R3410_2012_512
 "go°2012_512"

	)

4179 
	#LN_id_Go°R3410_2012_512
 "GOST R 34.10-2012 wôh 512 bô modulus"

	)

4180 
	#NID_id_Go°R3410_2012_512
 980

	)

4181 
	#OBJ_id_Go°R3410_2012_512
 
OBJ_id_tc26_sign
,2L

	)

4183 
	#SN_id_tc26_dige°
 "id-tc26-dige°"

	)

4184 
	#NID_id_tc26_dige°
 981

	)

4185 
	#OBJ_id_tc26_dige°
 
OBJ_id_tc26_Æg‹ôhms
,2L

	)

4187 
	#SN_id_Go°R3411_2012_256
 "md_go°12_256"

	)

4188 
	#LN_id_Go°R3411_2012_256
 "GOST R 34.11-2012 wôh 256 bô hash"

	)

4189 
	#NID_id_Go°R3411_2012_256
 982

	)

4190 
	#OBJ_id_Go°R3411_2012_256
 
OBJ_id_tc26_dige°
,2L

	)

4192 
	#SN_id_Go°R3411_2012_512
 "md_go°12_512"

	)

4193 
	#LN_id_Go°R3411_2012_512
 "GOST R 34.11-2012 wôh 512 bô hash"

	)

4194 
	#NID_id_Go°R3411_2012_512
 983

	)

4195 
	#OBJ_id_Go°R3411_2012_512
 
OBJ_id_tc26_dige°
,3L

	)

4197 
	#SN_id_tc26_signwôhdige°
 "id-tc26-signwôhdige°"

	)

4198 
	#NID_id_tc26_signwôhdige°
 984

	)

4199 
	#OBJ_id_tc26_signwôhdige°
 
OBJ_id_tc26_Æg‹ôhms
,3L

	)

4201 
	#SN_id_tc26_signwôhdige°_go°3410_2012_256
 "id-tc26-signwôhdige°-go°3410-2012-256"

	)

4202 
	#LN_id_tc26_signwôhdige°_go°3410_2012_256
 "GOST R 34.10-2012 wôh GOST R 34.11-2012 (256 bô)"

	)

4203 
	#NID_id_tc26_signwôhdige°_go°3410_2012_256
 985

	)

4204 
	#OBJ_id_tc26_signwôhdige°_go°3410_2012_256
 
OBJ_id_tc26_signwôhdige°
,2L

	)

4206 
	#SN_id_tc26_signwôhdige°_go°3410_2012_512
 "id-tc26-signwôhdige°-go°3410-2012-512"

	)

4207 
	#LN_id_tc26_signwôhdige°_go°3410_2012_512
 "GOST R 34.10-2012 wôh GOST R 34.11-2012 (512 bô)"

	)

4208 
	#NID_id_tc26_signwôhdige°_go°3410_2012_512
 986

	)

4209 
	#OBJ_id_tc26_signwôhdige°_go°3410_2012_512
 
OBJ_id_tc26_signwôhdige°
,3L

	)

4211 
	#SN_id_tc26_mac
 "id-tc26-mac"

	)

4212 
	#NID_id_tc26_mac
 987

	)

4213 
	#OBJ_id_tc26_mac
 
OBJ_id_tc26_Æg‹ôhms
,4L

	)

4215 
	#SN_id_tc26_hmac_go°_3411_2012_256
 "id-tc26-hmac-go°-3411-2012-256"

	)

4216 
	#LN_id_tc26_hmac_go°_3411_2012_256
 "HMAC GOST 34.11-2012 256 bô"

	)

4217 
	#NID_id_tc26_hmac_go°_3411_2012_256
 988

	)

4218 
	#OBJ_id_tc26_hmac_go°_3411_2012_256
 
OBJ_id_tc26_mac
,1L

	)

4220 
	#SN_id_tc26_hmac_go°_3411_2012_512
 "id-tc26-hmac-go°-3411-2012-512"

	)

4221 
	#LN_id_tc26_hmac_go°_3411_2012_512
 "HMAC GOST 34.11-2012 512 bô"

	)

4222 
	#NID_id_tc26_hmac_go°_3411_2012_512
 989

	)

4223 
	#OBJ_id_tc26_hmac_go°_3411_2012_512
 
OBJ_id_tc26_mac
,2L

	)

4225 
	#SN_id_tc26_cùhî
 "id-tc26-cùhî"

	)

4226 
	#NID_id_tc26_cùhî
 990

	)

4227 
	#OBJ_id_tc26_cùhî
 
OBJ_id_tc26_Æg‹ôhms
,5L

	)

4229 
	#SN_id_tc26_cùhî_go°r3412_2015_magma
 "id-tc26-cùhî-go°r3412-2015-magma"

	)

4230 
	#NID_id_tc26_cùhî_go°r3412_2015_magma
 1173

	)

4231 
	#OBJ_id_tc26_cùhî_go°r3412_2015_magma
 
OBJ_id_tc26_cùhî
,1L

	)

4233 
	#SN_id_tc26_cùhî_go°r3412_2015_magma_˘ø˝km
 "id-tc26-cùhî-go°r3412-2015-magma-˘ø˝km"

	)

4234 
	#NID_id_tc26_cùhî_go°r3412_2015_magma_˘ø˝km
 1174

	)

4235 
	#OBJ_id_tc26_cùhî_go°r3412_2015_magma_˘ø˝km
 
OBJ_id_tc26_cùhî_go°r3412_2015_magma
,1L

	)

4237 
	#SN_id_tc26_cùhî_go°r3412_2015_magma_˘ø˝km_omac
 "id-tc26-cùhî-go°r3412-2015-magma-˘ø˝km-omac"

	)

4238 
	#NID_id_tc26_cùhî_go°r3412_2015_magma_˘ø˝km_omac
 1175

	)

4239 
	#OBJ_id_tc26_cùhî_go°r3412_2015_magma_˘ø˝km_omac
 
OBJ_id_tc26_cùhî_go°r3412_2015_magma
,2L

	)

4241 
	#SN_id_tc26_cùhî_go°r3412_2015_kuznyechik
 "id-tc26-cùhî-go°r3412-2015-kuznyechik"

	)

4242 
	#NID_id_tc26_cùhî_go°r3412_2015_kuznyechik
 1176

	)

4243 
	#OBJ_id_tc26_cùhî_go°r3412_2015_kuznyechik
 
OBJ_id_tc26_cùhî
,2L

	)

4245 
	#SN_id_tc26_cùhî_go°r3412_2015_kuznyechik_˘ø˝km
 "id-tc26-cùhî-go°r3412-2015-kuznyechik-˘ø˝km"

	)

4246 
	#NID_id_tc26_cùhî_go°r3412_2015_kuznyechik_˘ø˝km
 1177

	)

4247 
	#OBJ_id_tc26_cùhî_go°r3412_2015_kuznyechik_˘ø˝km
 
OBJ_id_tc26_cùhî_go°r3412_2015_kuznyechik
,1L

	)

4249 
	#SN_id_tc26_cùhî_go°r3412_2015_kuznyechik_˘ø˝km_omac
 "id-tc26-cùhî-go°r3412-2015-kuznyechik-˘ø˝km-omac"

	)

4250 
	#NID_id_tc26_cùhî_go°r3412_2015_kuznyechik_˘ø˝km_omac
 1178

	)

4251 
	#OBJ_id_tc26_cùhî_go°r3412_2015_kuznyechik_˘ø˝km_omac
 
OBJ_id_tc26_cùhî_go°r3412_2015_kuznyechik
,2L

	)

4253 
	#SN_id_tc26_agªemít
 "id-tc26-agªemít"

	)

4254 
	#NID_id_tc26_agªemít
 991

	)

4255 
	#OBJ_id_tc26_agªemít
 
OBJ_id_tc26_Æg‹ôhms
,6L

	)

4257 
	#SN_id_tc26_agªemít_go°_3410_2012_256
 "id-tc26-agªemít-go°-3410-2012-256"

	)

4258 
	#NID_id_tc26_agªemít_go°_3410_2012_256
 992

	)

4259 
	#OBJ_id_tc26_agªemít_go°_3410_2012_256
 
OBJ_id_tc26_agªemít
,1L

	)

4261 
	#SN_id_tc26_agªemít_go°_3410_2012_512
 "id-tc26-agªemít-go°-3410-2012-512"

	)

4262 
	#NID_id_tc26_agªemít_go°_3410_2012_512
 993

	)

4263 
	#OBJ_id_tc26_agªemít_go°_3410_2012_512
 
OBJ_id_tc26_agªemít
,2L

	)

4265 
	#SN_id_tc26_wøp
 "id-tc26-wøp"

	)

4266 
	#NID_id_tc26_wøp
 1179

	)

4267 
	#OBJ_id_tc26_wøp
 
OBJ_id_tc26_Æg‹ôhms
,7L

	)

4269 
	#SN_id_tc26_wøp_go°r3412_2015_magma
 "id-tc26-wøp-go°r3412-2015-magma"

	)

4270 
	#NID_id_tc26_wøp_go°r3412_2015_magma
 1180

	)

4271 
	#OBJ_id_tc26_wøp_go°r3412_2015_magma
 
OBJ_id_tc26_wøp
,1L

	)

4273 
	#SN_id_tc26_wøp_go°r3412_2015_magma_kexp15
 "id-tc26-wøp-go°r3412-2015-magma-kexp15"

	)

4274 
	#NID_id_tc26_wøp_go°r3412_2015_magma_kexp15
 1181

	)

4275 
	#OBJ_id_tc26_wøp_go°r3412_2015_magma_kexp15
 
OBJ_id_tc26_wøp_go°r3412_2015_magma
,1L

	)

4277 
	#SN_id_tc26_wøp_go°r3412_2015_kuznyechik
 "id-tc26-wøp-go°r3412-2015-kuznyechik"

	)

4278 
	#NID_id_tc26_wøp_go°r3412_2015_kuznyechik
 1182

	)

4279 
	#OBJ_id_tc26_wøp_go°r3412_2015_kuznyechik
 
OBJ_id_tc26_wøp
,2L

	)

4281 
	#SN_id_tc26_wøp_go°r3412_2015_kuznyechik_kexp15
 "id-tc26-wøp-go°r3412-2015-kuznyechik-kexp15"

	)

4282 
	#NID_id_tc26_wøp_go°r3412_2015_kuznyechik_kexp15
 1183

	)

4283 
	#OBJ_id_tc26_wøp_go°r3412_2015_kuznyechik_kexp15
 
OBJ_id_tc26_wøp_go°r3412_2015_kuznyechik
,1L

	)

4285 
	#SN_id_tc26_c⁄°™ts
 "id-tc26-c⁄°™ts"

	)

4286 
	#NID_id_tc26_c⁄°™ts
 994

	)

4287 
	#OBJ_id_tc26_c⁄°™ts
 
OBJ_id_tc26
,2L

	)

4289 
	#SN_id_tc26_sign_c⁄°™ts
 "id-tc26-sign-c⁄°™ts"

	)

4290 
	#NID_id_tc26_sign_c⁄°™ts
 995

	)

4291 
	#OBJ_id_tc26_sign_c⁄°™ts
 
OBJ_id_tc26_c⁄°™ts
,1L

	)

4293 
	#SN_id_tc26_go°_3410_2012_256_c⁄°™ts
 "id-tc26-go°-3410-2012-256-c⁄°™ts"

	)

4294 
	#NID_id_tc26_go°_3410_2012_256_c⁄°™ts
 1147

	)

4295 
	#OBJ_id_tc26_go°_3410_2012_256_c⁄°™ts
 
OBJ_id_tc26_sign_c⁄°™ts
,1L

	)

4297 
	#SN_id_tc26_go°_3410_2012_256_∑ømSëA
 "id-tc26-go°-3410-2012-256-∑ømSëA"

	)

4298 
	#LN_id_tc26_go°_3410_2012_256_∑ømSëA
 "GOST R 34.10-2012 (256 bôËP¨amSë A"

	)

4299 
	#NID_id_tc26_go°_3410_2012_256_∑ømSëA
 1148

	)

4300 
	#OBJ_id_tc26_go°_3410_2012_256_∑ømSëA
 
OBJ_id_tc26_go°_3410_2012_256_c⁄°™ts
,1L

	)

4302 
	#SN_id_tc26_go°_3410_2012_256_∑ømSëB
 "id-tc26-go°-3410-2012-256-∑ømSëB"

	)

4303 
	#LN_id_tc26_go°_3410_2012_256_∑ømSëB
 "GOST R 34.10-2012 (256 bôËP¨amSë B"

	)

4304 
	#NID_id_tc26_go°_3410_2012_256_∑ømSëB
 1184

	)

4305 
	#OBJ_id_tc26_go°_3410_2012_256_∑ømSëB
 
OBJ_id_tc26_go°_3410_2012_256_c⁄°™ts
,2L

	)

4307 
	#SN_id_tc26_go°_3410_2012_256_∑ømSëC
 "id-tc26-go°-3410-2012-256-∑ømSëC"

	)

4308 
	#LN_id_tc26_go°_3410_2012_256_∑ømSëC
 "GOST R 34.10-2012 (256 bôËP¨amSë C"

	)

4309 
	#NID_id_tc26_go°_3410_2012_256_∑ømSëC
 1185

	)

4310 
	#OBJ_id_tc26_go°_3410_2012_256_∑ømSëC
 
OBJ_id_tc26_go°_3410_2012_256_c⁄°™ts
,3L

	)

4312 
	#SN_id_tc26_go°_3410_2012_256_∑ømSëD
 "id-tc26-go°-3410-2012-256-∑ømSëD"

	)

4313 
	#LN_id_tc26_go°_3410_2012_256_∑ømSëD
 "GOST R 34.10-2012 (256 bôËP¨amSë D"

	)

4314 
	#NID_id_tc26_go°_3410_2012_256_∑ømSëD
 1186

	)

4315 
	#OBJ_id_tc26_go°_3410_2012_256_∑ømSëD
 
OBJ_id_tc26_go°_3410_2012_256_c⁄°™ts
,4L

	)

4317 
	#SN_id_tc26_go°_3410_2012_512_c⁄°™ts
 "id-tc26-go°-3410-2012-512-c⁄°™ts"

	)

4318 
	#NID_id_tc26_go°_3410_2012_512_c⁄°™ts
 996

	)

4319 
	#OBJ_id_tc26_go°_3410_2012_512_c⁄°™ts
 
OBJ_id_tc26_sign_c⁄°™ts
,2L

	)

4321 
	#SN_id_tc26_go°_3410_2012_512_∑ømSëTe°
 "id-tc26-go°-3410-2012-512-∑ømSëTe°"

	)

4322 
	#LN_id_tc26_go°_3410_2012_512_∑ømSëTe°
 "GOST R 34.10-2012 (512 bôËã°ögÖ¨amëî së"

	)

4323 
	#NID_id_tc26_go°_3410_2012_512_∑ømSëTe°
 997

	)

4324 
	#OBJ_id_tc26_go°_3410_2012_512_∑ømSëTe°
 
OBJ_id_tc26_go°_3410_2012_512_c⁄°™ts
,0L

	)

4326 
	#SN_id_tc26_go°_3410_2012_512_∑ømSëA
 "id-tc26-go°-3410-2012-512-∑ømSëA"

	)

4327 
	#LN_id_tc26_go°_3410_2012_512_∑ømSëA
 "GOST R 34.10-2012 (512 bôËP¨amSë A"

	)

4328 
	#NID_id_tc26_go°_3410_2012_512_∑ømSëA
 998

	)

4329 
	#OBJ_id_tc26_go°_3410_2012_512_∑ømSëA
 
OBJ_id_tc26_go°_3410_2012_512_c⁄°™ts
,1L

	)

4331 
	#SN_id_tc26_go°_3410_2012_512_∑ømSëB
 "id-tc26-go°-3410-2012-512-∑ømSëB"

	)

4332 
	#LN_id_tc26_go°_3410_2012_512_∑ømSëB
 "GOST R 34.10-2012 (512 bôËP¨amSë B"

	)

4333 
	#NID_id_tc26_go°_3410_2012_512_∑ømSëB
 999

	)

4334 
	#OBJ_id_tc26_go°_3410_2012_512_∑ømSëB
 
OBJ_id_tc26_go°_3410_2012_512_c⁄°™ts
,2L

	)

4336 
	#SN_id_tc26_go°_3410_2012_512_∑ømSëC
 "id-tc26-go°-3410-2012-512-∑ømSëC"

	)

4337 
	#LN_id_tc26_go°_3410_2012_512_∑ømSëC
 "GOST R 34.10-2012 (512 bôËP¨amSë C"

	)

4338 
	#NID_id_tc26_go°_3410_2012_512_∑ømSëC
 1149

	)

4339 
	#OBJ_id_tc26_go°_3410_2012_512_∑ømSëC
 
OBJ_id_tc26_go°_3410_2012_512_c⁄°™ts
,3L

	)

4341 
	#SN_id_tc26_dige°_c⁄°™ts
 "id-tc26-dige°-c⁄°™ts"

	)

4342 
	#NID_id_tc26_dige°_c⁄°™ts
 1000

	)

4343 
	#OBJ_id_tc26_dige°_c⁄°™ts
 
OBJ_id_tc26_c⁄°™ts
,2L

	)

4345 
	#SN_id_tc26_cùhî_c⁄°™ts
 "id-tc26-cùhî-c⁄°™ts"

	)

4346 
	#NID_id_tc26_cùhî_c⁄°™ts
 1001

	)

4347 
	#OBJ_id_tc26_cùhî_c⁄°™ts
 
OBJ_id_tc26_c⁄°™ts
,5L

	)

4349 
	#SN_id_tc26_go°_28147_c⁄°™ts
 "id-tc26-go°-28147-c⁄°™ts"

	)

4350 
	#NID_id_tc26_go°_28147_c⁄°™ts
 1002

	)

4351 
	#OBJ_id_tc26_go°_28147_c⁄°™ts
 
OBJ_id_tc26_cùhî_c⁄°™ts
,1L

	)

4353 
	#SN_id_tc26_go°_28147_∑øm_Z
 "id-tc26-go°-28147-∑øm-Z"

	)

4354 
	#LN_id_tc26_go°_28147_∑øm_Z
 "GOST 28147-89 TC26Ö¨amëî së"

	)

4355 
	#NID_id_tc26_go°_28147_∑øm_Z
 1003

	)

4356 
	#OBJ_id_tc26_go°_28147_∑øm_Z
 
OBJ_id_tc26_go°_28147_c⁄°™ts
,1L

	)

4358 
	#SN_INN
 "INN"

	)

4359 
	#LN_INN
 "INN"

	)

4360 
	#NID_INN
 1004

	)

4361 
	#OBJ_INN
 
OBJ_membî_body
,643L,3L,131L,1L,1L

	)

4363 
	#SN_OGRN
 "OGRN"

	)

4364 
	#LN_OGRN
 "OGRN"

	)

4365 
	#NID_OGRN
 1005

	)

4366 
	#OBJ_OGRN
 
OBJ_membî_body
,643L,100L,1L

	)

4368 
	#SN_SNILS
 "SNILS"

	)

4369 
	#LN_SNILS
 "SNILS"

	)

4370 
	#NID_SNILS
 1006

	)

4371 
	#OBJ_SNILS
 
OBJ_membî_body
,643L,100L,3L

	)

4373 
	#SN_subje˘SignToﬁ
 "subje˘SignToﬁ"

	)

4374 
	#LN_subje˘SignToﬁ
 "Signög Toﬁ o‡Subje˘"

	)

4375 
	#NID_subje˘SignToﬁ
 1007

	)

4376 
	#OBJ_subje˘SignToﬁ
 
OBJ_membî_body
,643L,100L,111L

	)

4378 
	#SN_issuîSignToﬁ
 "issuîSignToﬁ"

	)

4379 
	#LN_issuîSignToﬁ
 "Signög Toﬁ o‡Issuî"

	)

4380 
	#NID_issuîSignToﬁ
 1008

	)

4381 
	#OBJ_issuîSignToﬁ
 
OBJ_membî_body
,643L,100L,112L

	)

4383 
	#SN_gøssh›≥r_ecb
 "gøssh›≥r-ecb"

	)

4384 
	#NID_gøssh›≥r_ecb
 1012

	)

4386 
	#SN_gøssh›≥r_˘r
 "gøssh›≥r-˘r"

	)

4387 
	#NID_gøssh›≥r_˘r
 1013

	)

4389 
	#SN_gøssh›≥r_ofb
 "gøssh›≥r-ofb"

	)

4390 
	#NID_gøssh›≥r_ofb
 1014

	)

4392 
	#SN_gøssh›≥r_cbc
 "gøssh›≥r-cbc"

	)

4393 
	#NID_gøssh›≥r_cbc
 1015

	)

4395 
	#SN_gøssh›≥r_cfb
 "gøssh›≥r-cfb"

	)

4396 
	#NID_gøssh›≥r_cfb
 1016

	)

4398 
	#SN_gøssh›≥r_mac
 "gøssh›≥r-mac"

	)

4399 
	#NID_gøssh›≥r_mac
 1017

	)

4401 
	#SN_magma_ecb
 "magma-ecb"

	)

4402 
	#NID_magma_ecb
 1187

	)

4404 
	#SN_magma_˘r
 "magma-˘r"

	)

4405 
	#NID_magma_˘r
 1188

	)

4407 
	#SN_magma_ofb
 "magma-ofb"

	)

4408 
	#NID_magma_ofb
 1189

	)

4410 
	#SN_magma_cbc
 "magma-cbc"

	)

4411 
	#NID_magma_cbc
 1190

	)

4413 
	#SN_magma_cfb
 "magma-cfb"

	)

4414 
	#NID_magma_cfb
 1191

	)

4416 
	#SN_magma_mac
 "magma-mac"

	)

4417 
	#NID_magma_mac
 1192

	)

4419 
	#SN_ˇmñlü_128_cbc
 "CAMELLIA-128-CBC"

	)

4420 
	#LN_ˇmñlü_128_cbc
 "ˇmñlü-128-cbc"

	)

4421 
	#NID_ˇmñlü_128_cbc
 751

	)

4422 
	#OBJ_ˇmñlü_128_cbc
 1L,2L,392L,200011L,61L,1L,1L,1L,2L

	)

4424 
	#SN_ˇmñlü_192_cbc
 "CAMELLIA-192-CBC"

	)

4425 
	#LN_ˇmñlü_192_cbc
 "ˇmñlü-192-cbc"

	)

4426 
	#NID_ˇmñlü_192_cbc
 752

	)

4427 
	#OBJ_ˇmñlü_192_cbc
 1L,2L,392L,200011L,61L,1L,1L,1L,3L

	)

4429 
	#SN_ˇmñlü_256_cbc
 "CAMELLIA-256-CBC"

	)

4430 
	#LN_ˇmñlü_256_cbc
 "ˇmñlü-256-cbc"

	)

4431 
	#NID_ˇmñlü_256_cbc
 753

	)

4432 
	#OBJ_ˇmñlü_256_cbc
 1L,2L,392L,200011L,61L,1L,1L,1L,4L

	)

4434 
	#SN_id_ˇmñlü128_wøp
 "id-ˇmñlü128-wøp"

	)

4435 
	#NID_id_ˇmñlü128_wøp
 907

	)

4436 
	#OBJ_id_ˇmñlü128_wøp
 1L,2L,392L,200011L,61L,1L,1L,3L,2L

	)

4438 
	#SN_id_ˇmñlü192_wøp
 "id-ˇmñlü192-wøp"

	)

4439 
	#NID_id_ˇmñlü192_wøp
 908

	)

4440 
	#OBJ_id_ˇmñlü192_wøp
 1L,2L,392L,200011L,61L,1L,1L,3L,3L

	)

4442 
	#SN_id_ˇmñlü256_wøp
 "id-ˇmñlü256-wøp"

	)

4443 
	#NID_id_ˇmñlü256_wøp
 909

	)

4444 
	#OBJ_id_ˇmñlü256_wøp
 1L,2L,392L,200011L,61L,1L,1L,3L,4L

	)

4446 
	#OBJ_¡t_ds
 0L,3L,4401L,5L

	)

4448 
	#OBJ_ˇmñlü
 
OBJ_¡t_ds
,3L,1L,9L

	)

4450 
	#SN_ˇmñlü_128_ecb
 "CAMELLIA-128-ECB"

	)

4451 
	#LN_ˇmñlü_128_ecb
 "ˇmñlü-128-ecb"

	)

4452 
	#NID_ˇmñlü_128_ecb
 754

	)

4453 
	#OBJ_ˇmñlü_128_ecb
 
OBJ_ˇmñlü
,1L

	)

4455 
	#SN_ˇmñlü_128_ofb128
 "CAMELLIA-128-OFB"

	)

4456 
	#LN_ˇmñlü_128_ofb128
 "ˇmñlü-128-ofb"

	)

4457 
	#NID_ˇmñlü_128_ofb128
 766

	)

4458 
	#OBJ_ˇmñlü_128_ofb128
 
OBJ_ˇmñlü
,3L

	)

4460 
	#SN_ˇmñlü_128_cfb128
 "CAMELLIA-128-CFB"

	)

4461 
	#LN_ˇmñlü_128_cfb128
 "ˇmñlü-128-cfb"

	)

4462 
	#NID_ˇmñlü_128_cfb128
 757

	)

4463 
	#OBJ_ˇmñlü_128_cfb128
 
OBJ_ˇmñlü
,4L

	)

4465 
	#SN_ˇmñlü_128_gcm
 "CAMELLIA-128-GCM"

	)

4466 
	#LN_ˇmñlü_128_gcm
 "ˇmñlü-128-gcm"

	)

4467 
	#NID_ˇmñlü_128_gcm
 961

	)

4468 
	#OBJ_ˇmñlü_128_gcm
 
OBJ_ˇmñlü
,6L

	)

4470 
	#SN_ˇmñlü_128_ccm
 "CAMELLIA-128-CCM"

	)

4471 
	#LN_ˇmñlü_128_ccm
 "ˇmñlü-128-ccm"

	)

4472 
	#NID_ˇmñlü_128_ccm
 962

	)

4473 
	#OBJ_ˇmñlü_128_ccm
 
OBJ_ˇmñlü
,7L

	)

4475 
	#SN_ˇmñlü_128_˘r
 "CAMELLIA-128-CTR"

	)

4476 
	#LN_ˇmñlü_128_˘r
 "ˇmñlü-128-˘r"

	)

4477 
	#NID_ˇmñlü_128_˘r
 963

	)

4478 
	#OBJ_ˇmñlü_128_˘r
 
OBJ_ˇmñlü
,9L

	)

4480 
	#SN_ˇmñlü_128_cmac
 "CAMELLIA-128-CMAC"

	)

4481 
	#LN_ˇmñlü_128_cmac
 "ˇmñlü-128-cmac"

	)

4482 
	#NID_ˇmñlü_128_cmac
 964

	)

4483 
	#OBJ_ˇmñlü_128_cmac
 
OBJ_ˇmñlü
,10L

	)

4485 
	#SN_ˇmñlü_192_ecb
 "CAMELLIA-192-ECB"

	)

4486 
	#LN_ˇmñlü_192_ecb
 "ˇmñlü-192-ecb"

	)

4487 
	#NID_ˇmñlü_192_ecb
 755

	)

4488 
	#OBJ_ˇmñlü_192_ecb
 
OBJ_ˇmñlü
,21L

	)

4490 
	#SN_ˇmñlü_192_ofb128
 "CAMELLIA-192-OFB"

	)

4491 
	#LN_ˇmñlü_192_ofb128
 "ˇmñlü-192-ofb"

	)

4492 
	#NID_ˇmñlü_192_ofb128
 767

	)

4493 
	#OBJ_ˇmñlü_192_ofb128
 
OBJ_ˇmñlü
,23L

	)

4495 
	#SN_ˇmñlü_192_cfb128
 "CAMELLIA-192-CFB"

	)

4496 
	#LN_ˇmñlü_192_cfb128
 "ˇmñlü-192-cfb"

	)

4497 
	#NID_ˇmñlü_192_cfb128
 758

	)

4498 
	#OBJ_ˇmñlü_192_cfb128
 
OBJ_ˇmñlü
,24L

	)

4500 
	#SN_ˇmñlü_192_gcm
 "CAMELLIA-192-GCM"

	)

4501 
	#LN_ˇmñlü_192_gcm
 "ˇmñlü-192-gcm"

	)

4502 
	#NID_ˇmñlü_192_gcm
 965

	)

4503 
	#OBJ_ˇmñlü_192_gcm
 
OBJ_ˇmñlü
,26L

	)

4505 
	#SN_ˇmñlü_192_ccm
 "CAMELLIA-192-CCM"

	)

4506 
	#LN_ˇmñlü_192_ccm
 "ˇmñlü-192-ccm"

	)

4507 
	#NID_ˇmñlü_192_ccm
 966

	)

4508 
	#OBJ_ˇmñlü_192_ccm
 
OBJ_ˇmñlü
,27L

	)

4510 
	#SN_ˇmñlü_192_˘r
 "CAMELLIA-192-CTR"

	)

4511 
	#LN_ˇmñlü_192_˘r
 "ˇmñlü-192-˘r"

	)

4512 
	#NID_ˇmñlü_192_˘r
 967

	)

4513 
	#OBJ_ˇmñlü_192_˘r
 
OBJ_ˇmñlü
,29L

	)

4515 
	#SN_ˇmñlü_192_cmac
 "CAMELLIA-192-CMAC"

	)

4516 
	#LN_ˇmñlü_192_cmac
 "ˇmñlü-192-cmac"

	)

4517 
	#NID_ˇmñlü_192_cmac
 968

	)

4518 
	#OBJ_ˇmñlü_192_cmac
 
OBJ_ˇmñlü
,30L

	)

4520 
	#SN_ˇmñlü_256_ecb
 "CAMELLIA-256-ECB"

	)

4521 
	#LN_ˇmñlü_256_ecb
 "ˇmñlü-256-ecb"

	)

4522 
	#NID_ˇmñlü_256_ecb
 756

	)

4523 
	#OBJ_ˇmñlü_256_ecb
 
OBJ_ˇmñlü
,41L

	)

4525 
	#SN_ˇmñlü_256_ofb128
 "CAMELLIA-256-OFB"

	)

4526 
	#LN_ˇmñlü_256_ofb128
 "ˇmñlü-256-ofb"

	)

4527 
	#NID_ˇmñlü_256_ofb128
 768

	)

4528 
	#OBJ_ˇmñlü_256_ofb128
 
OBJ_ˇmñlü
,43L

	)

4530 
	#SN_ˇmñlü_256_cfb128
 "CAMELLIA-256-CFB"

	)

4531 
	#LN_ˇmñlü_256_cfb128
 "ˇmñlü-256-cfb"

	)

4532 
	#NID_ˇmñlü_256_cfb128
 759

	)

4533 
	#OBJ_ˇmñlü_256_cfb128
 
OBJ_ˇmñlü
,44L

	)

4535 
	#SN_ˇmñlü_256_gcm
 "CAMELLIA-256-GCM"

	)

4536 
	#LN_ˇmñlü_256_gcm
 "ˇmñlü-256-gcm"

	)

4537 
	#NID_ˇmñlü_256_gcm
 969

	)

4538 
	#OBJ_ˇmñlü_256_gcm
 
OBJ_ˇmñlü
,46L

	)

4540 
	#SN_ˇmñlü_256_ccm
 "CAMELLIA-256-CCM"

	)

4541 
	#LN_ˇmñlü_256_ccm
 "ˇmñlü-256-ccm"

	)

4542 
	#NID_ˇmñlü_256_ccm
 970

	)

4543 
	#OBJ_ˇmñlü_256_ccm
 
OBJ_ˇmñlü
,47L

	)

4545 
	#SN_ˇmñlü_256_˘r
 "CAMELLIA-256-CTR"

	)

4546 
	#LN_ˇmñlü_256_˘r
 "ˇmñlü-256-˘r"

	)

4547 
	#NID_ˇmñlü_256_˘r
 971

	)

4548 
	#OBJ_ˇmñlü_256_˘r
 
OBJ_ˇmñlü
,49L

	)

4550 
	#SN_ˇmñlü_256_cmac
 "CAMELLIA-256-CMAC"

	)

4551 
	#LN_ˇmñlü_256_cmac
 "ˇmñlü-256-cmac"

	)

4552 
	#NID_ˇmñlü_256_cmac
 972

	)

4553 
	#OBJ_ˇmñlü_256_cmac
 
OBJ_ˇmñlü
,50L

	)

4555 
	#SN_ˇmñlü_128_cfb1
 "CAMELLIA-128-CFB1"

	)

4556 
	#LN_ˇmñlü_128_cfb1
 "ˇmñlü-128-cfb1"

	)

4557 
	#NID_ˇmñlü_128_cfb1
 760

	)

4559 
	#SN_ˇmñlü_192_cfb1
 "CAMELLIA-192-CFB1"

	)

4560 
	#LN_ˇmñlü_192_cfb1
 "ˇmñlü-192-cfb1"

	)

4561 
	#NID_ˇmñlü_192_cfb1
 761

	)

4563 
	#SN_ˇmñlü_256_cfb1
 "CAMELLIA-256-CFB1"

	)

4564 
	#LN_ˇmñlü_256_cfb1
 "ˇmñlü-256-cfb1"

	)

4565 
	#NID_ˇmñlü_256_cfb1
 762

	)

4567 
	#SN_ˇmñlü_128_cfb8
 "CAMELLIA-128-CFB8"

	)

4568 
	#LN_ˇmñlü_128_cfb8
 "ˇmñlü-128-cfb8"

	)

4569 
	#NID_ˇmñlü_128_cfb8
 763

	)

4571 
	#SN_ˇmñlü_192_cfb8
 "CAMELLIA-192-CFB8"

	)

4572 
	#LN_ˇmñlü_192_cfb8
 "ˇmñlü-192-cfb8"

	)

4573 
	#NID_ˇmñlü_192_cfb8
 764

	)

4575 
	#SN_ˇmñlü_256_cfb8
 "CAMELLIA-256-CFB8"

	)

4576 
	#LN_ˇmñlü_256_cfb8
 "ˇmñlü-256-cfb8"

	)

4577 
	#NID_ˇmñlü_256_cfb8
 765

	)

4579 
	#OBJ_¨ü
 1L,2L,410L,200046L,1L,1L

	)

4581 
	#SN_¨ü_128_ecb
 "ARIA-128-ECB"

	)

4582 
	#LN_¨ü_128_ecb
 "¨ü-128-ecb"

	)

4583 
	#NID_¨ü_128_ecb
 1065

	)

4584 
	#OBJ_¨ü_128_ecb
 
OBJ_¨ü
,1L

	)

4586 
	#SN_¨ü_128_cbc
 "ARIA-128-CBC"

	)

4587 
	#LN_¨ü_128_cbc
 "¨ü-128-cbc"

	)

4588 
	#NID_¨ü_128_cbc
 1066

	)

4589 
	#OBJ_¨ü_128_cbc
 
OBJ_¨ü
,2L

	)

4591 
	#SN_¨ü_128_cfb128
 "ARIA-128-CFB"

	)

4592 
	#LN_¨ü_128_cfb128
 "¨ü-128-cfb"

	)

4593 
	#NID_¨ü_128_cfb128
 1067

	)

4594 
	#OBJ_¨ü_128_cfb128
 
OBJ_¨ü
,3L

	)

4596 
	#SN_¨ü_128_ofb128
 "ARIA-128-OFB"

	)

4597 
	#LN_¨ü_128_ofb128
 "¨ü-128-ofb"

	)

4598 
	#NID_¨ü_128_ofb128
 1068

	)

4599 
	#OBJ_¨ü_128_ofb128
 
OBJ_¨ü
,4L

	)

4601 
	#SN_¨ü_128_˘r
 "ARIA-128-CTR"

	)

4602 
	#LN_¨ü_128_˘r
 "¨ü-128-˘r"

	)

4603 
	#NID_¨ü_128_˘r
 1069

	)

4604 
	#OBJ_¨ü_128_˘r
 
OBJ_¨ü
,5L

	)

4606 
	#SN_¨ü_192_ecb
 "ARIA-192-ECB"

	)

4607 
	#LN_¨ü_192_ecb
 "¨ü-192-ecb"

	)

4608 
	#NID_¨ü_192_ecb
 1070

	)

4609 
	#OBJ_¨ü_192_ecb
 
OBJ_¨ü
,6L

	)

4611 
	#SN_¨ü_192_cbc
 "ARIA-192-CBC"

	)

4612 
	#LN_¨ü_192_cbc
 "¨ü-192-cbc"

	)

4613 
	#NID_¨ü_192_cbc
 1071

	)

4614 
	#OBJ_¨ü_192_cbc
 
OBJ_¨ü
,7L

	)

4616 
	#SN_¨ü_192_cfb128
 "ARIA-192-CFB"

	)

4617 
	#LN_¨ü_192_cfb128
 "¨ü-192-cfb"

	)

4618 
	#NID_¨ü_192_cfb128
 1072

	)

4619 
	#OBJ_¨ü_192_cfb128
 
OBJ_¨ü
,8L

	)

4621 
	#SN_¨ü_192_ofb128
 "ARIA-192-OFB"

	)

4622 
	#LN_¨ü_192_ofb128
 "¨ü-192-ofb"

	)

4623 
	#NID_¨ü_192_ofb128
 1073

	)

4624 
	#OBJ_¨ü_192_ofb128
 
OBJ_¨ü
,9L

	)

4626 
	#SN_¨ü_192_˘r
 "ARIA-192-CTR"

	)

4627 
	#LN_¨ü_192_˘r
 "¨ü-192-˘r"

	)

4628 
	#NID_¨ü_192_˘r
 1074

	)

4629 
	#OBJ_¨ü_192_˘r
 
OBJ_¨ü
,10L

	)

4631 
	#SN_¨ü_256_ecb
 "ARIA-256-ECB"

	)

4632 
	#LN_¨ü_256_ecb
 "¨ü-256-ecb"

	)

4633 
	#NID_¨ü_256_ecb
 1075

	)

4634 
	#OBJ_¨ü_256_ecb
 
OBJ_¨ü
,11L

	)

4636 
	#SN_¨ü_256_cbc
 "ARIA-256-CBC"

	)

4637 
	#LN_¨ü_256_cbc
 "¨ü-256-cbc"

	)

4638 
	#NID_¨ü_256_cbc
 1076

	)

4639 
	#OBJ_¨ü_256_cbc
 
OBJ_¨ü
,12L

	)

4641 
	#SN_¨ü_256_cfb128
 "ARIA-256-CFB"

	)

4642 
	#LN_¨ü_256_cfb128
 "¨ü-256-cfb"

	)

4643 
	#NID_¨ü_256_cfb128
 1077

	)

4644 
	#OBJ_¨ü_256_cfb128
 
OBJ_¨ü
,13L

	)

4646 
	#SN_¨ü_256_ofb128
 "ARIA-256-OFB"

	)

4647 
	#LN_¨ü_256_ofb128
 "¨ü-256-ofb"

	)

4648 
	#NID_¨ü_256_ofb128
 1078

	)

4649 
	#OBJ_¨ü_256_ofb128
 
OBJ_¨ü
,14L

	)

4651 
	#SN_¨ü_256_˘r
 "ARIA-256-CTR"

	)

4652 
	#LN_¨ü_256_˘r
 "¨ü-256-˘r"

	)

4653 
	#NID_¨ü_256_˘r
 1079

	)

4654 
	#OBJ_¨ü_256_˘r
 
OBJ_¨ü
,15L

	)

4656 
	#SN_¨ü_128_cfb1
 "ARIA-128-CFB1"

	)

4657 
	#LN_¨ü_128_cfb1
 "¨ü-128-cfb1"

	)

4658 
	#NID_¨ü_128_cfb1
 1080

	)

4660 
	#SN_¨ü_192_cfb1
 "ARIA-192-CFB1"

	)

4661 
	#LN_¨ü_192_cfb1
 "¨ü-192-cfb1"

	)

4662 
	#NID_¨ü_192_cfb1
 1081

	)

4664 
	#SN_¨ü_256_cfb1
 "ARIA-256-CFB1"

	)

4665 
	#LN_¨ü_256_cfb1
 "¨ü-256-cfb1"

	)

4666 
	#NID_¨ü_256_cfb1
 1082

	)

4668 
	#SN_¨ü_128_cfb8
 "ARIA-128-CFB8"

	)

4669 
	#LN_¨ü_128_cfb8
 "¨ü-128-cfb8"

	)

4670 
	#NID_¨ü_128_cfb8
 1083

	)

4672 
	#SN_¨ü_192_cfb8
 "ARIA-192-CFB8"

	)

4673 
	#LN_¨ü_192_cfb8
 "¨ü-192-cfb8"

	)

4674 
	#NID_¨ü_192_cfb8
 1084

	)

4676 
	#SN_¨ü_256_cfb8
 "ARIA-256-CFB8"

	)

4677 
	#LN_¨ü_256_cfb8
 "¨ü-256-cfb8"

	)

4678 
	#NID_¨ü_256_cfb8
 1085

	)

4680 
	#SN_¨ü_128_ccm
 "ARIA-128-CCM"

	)

4681 
	#LN_¨ü_128_ccm
 "¨ü-128-ccm"

	)

4682 
	#NID_¨ü_128_ccm
 1120

	)

4683 
	#OBJ_¨ü_128_ccm
 
OBJ_¨ü
,37L

	)

4685 
	#SN_¨ü_192_ccm
 "ARIA-192-CCM"

	)

4686 
	#LN_¨ü_192_ccm
 "¨ü-192-ccm"

	)

4687 
	#NID_¨ü_192_ccm
 1121

	)

4688 
	#OBJ_¨ü_192_ccm
 
OBJ_¨ü
,38L

	)

4690 
	#SN_¨ü_256_ccm
 "ARIA-256-CCM"

	)

4691 
	#LN_¨ü_256_ccm
 "¨ü-256-ccm"

	)

4692 
	#NID_¨ü_256_ccm
 1122

	)

4693 
	#OBJ_¨ü_256_ccm
 
OBJ_¨ü
,39L

	)

4695 
	#SN_¨ü_128_gcm
 "ARIA-128-GCM"

	)

4696 
	#LN_¨ü_128_gcm
 "¨ü-128-gcm"

	)

4697 
	#NID_¨ü_128_gcm
 1123

	)

4698 
	#OBJ_¨ü_128_gcm
 
OBJ_¨ü
,34L

	)

4700 
	#SN_¨ü_192_gcm
 "ARIA-192-GCM"

	)

4701 
	#LN_¨ü_192_gcm
 "¨ü-192-gcm"

	)

4702 
	#NID_¨ü_192_gcm
 1124

	)

4703 
	#OBJ_¨ü_192_gcm
 
OBJ_¨ü
,35L

	)

4705 
	#SN_¨ü_256_gcm
 "ARIA-256-GCM"

	)

4706 
	#LN_¨ü_256_gcm
 "¨ü-256-gcm"

	)

4707 
	#NID_¨ü_256_gcm
 1125

	)

4708 
	#OBJ_¨ü_256_gcm
 
OBJ_¨ü
,36L

	)

4710 
	#SN_kiß
 "KISA"

	)

4711 
	#LN_kiß
 "kiß"

	)

4712 
	#NID_kiß
 773

	)

4713 
	#OBJ_kiß
 
OBJ_membî_body
,410L,200004L

	)

4715 
	#SN_£ed_ecb
 "SEED-ECB"

	)

4716 
	#LN_£ed_ecb
 "£ed-ecb"

	)

4717 
	#NID_£ed_ecb
 776

	)

4718 
	#OBJ_£ed_ecb
 
OBJ_kiß
,1L,3L

	)

4720 
	#SN_£ed_cbc
 "SEED-CBC"

	)

4721 
	#LN_£ed_cbc
 "£ed-cbc"

	)

4722 
	#NID_£ed_cbc
 777

	)

4723 
	#OBJ_£ed_cbc
 
OBJ_kiß
,1L,4L

	)

4725 
	#SN_£ed_cfb128
 "SEED-CFB"

	)

4726 
	#LN_£ed_cfb128
 "£ed-cfb"

	)

4727 
	#NID_£ed_cfb128
 779

	)

4728 
	#OBJ_£ed_cfb128
 
OBJ_kiß
,1L,5L

	)

4730 
	#SN_£ed_ofb128
 "SEED-OFB"

	)

4731 
	#LN_£ed_ofb128
 "£ed-ofb"

	)

4732 
	#NID_£ed_ofb128
 778

	)

4733 
	#OBJ_£ed_ofb128
 
OBJ_kiß
,1L,6L

	)

4735 
	#SN_sm4_ecb
 "SM4-ECB"

	)

4736 
	#LN_sm4_ecb
 "sm4-ecb"

	)

4737 
	#NID_sm4_ecb
 1133

	)

4738 
	#OBJ_sm4_ecb
 
OBJ_sm_scheme
,104L,1L

	)

4740 
	#SN_sm4_cbc
 "SM4-CBC"

	)

4741 
	#LN_sm4_cbc
 "sm4-cbc"

	)

4742 
	#NID_sm4_cbc
 1134

	)

4743 
	#OBJ_sm4_cbc
 
OBJ_sm_scheme
,104L,2L

	)

4745 
	#SN_sm4_ofb128
 "SM4-OFB"

	)

4746 
	#LN_sm4_ofb128
 "sm4-ofb"

	)

4747 
	#NID_sm4_ofb128
 1135

	)

4748 
	#OBJ_sm4_ofb128
 
OBJ_sm_scheme
,104L,3L

	)

4750 
	#SN_sm4_cfb128
 "SM4-CFB"

	)

4751 
	#LN_sm4_cfb128
 "sm4-cfb"

	)

4752 
	#NID_sm4_cfb128
 1137

	)

4753 
	#OBJ_sm4_cfb128
 
OBJ_sm_scheme
,104L,4L

	)

4755 
	#SN_sm4_cfb1
 "SM4-CFB1"

	)

4756 
	#LN_sm4_cfb1
 "sm4-cfb1"

	)

4757 
	#NID_sm4_cfb1
 1136

	)

4758 
	#OBJ_sm4_cfb1
 
OBJ_sm_scheme
,104L,5L

	)

4760 
	#SN_sm4_cfb8
 "SM4-CFB8"

	)

4761 
	#LN_sm4_cfb8
 "sm4-cfb8"

	)

4762 
	#NID_sm4_cfb8
 1138

	)

4763 
	#OBJ_sm4_cfb8
 
OBJ_sm_scheme
,104L,6L

	)

4765 
	#SN_sm4_˘r
 "SM4-CTR"

	)

4766 
	#LN_sm4_˘r
 "sm4-˘r"

	)

4767 
	#NID_sm4_˘r
 1139

	)

4768 
	#OBJ_sm4_˘r
 
OBJ_sm_scheme
,104L,7L

	)

4770 
	#SN_hmac
 "HMAC"

	)

4771 
	#LN_hmac
 "hmac"

	)

4772 
	#NID_hmac
 855

	)

4774 
	#SN_cmac
 "CMAC"

	)

4775 
	#LN_cmac
 "cmac"

	)

4776 
	#NID_cmac
 894

	)

4778 
	#SN_rc4_hmac_md5
 "RC4-HMAC-MD5"

	)

4779 
	#LN_rc4_hmac_md5
 "rc4-hmac-md5"

	)

4780 
	#NID_rc4_hmac_md5
 915

	)

4782 
	#SN_´s_128_cbc_hmac_sha1
 "AES-128-CBC-HMAC-SHA1"

	)

4783 
	#LN_´s_128_cbc_hmac_sha1
 "´s-128-cbc-hmac-sha1"

	)

4784 
	#NID_´s_128_cbc_hmac_sha1
 916

	)

4786 
	#SN_´s_192_cbc_hmac_sha1
 "AES-192-CBC-HMAC-SHA1"

	)

4787 
	#LN_´s_192_cbc_hmac_sha1
 "´s-192-cbc-hmac-sha1"

	)

4788 
	#NID_´s_192_cbc_hmac_sha1
 917

	)

4790 
	#SN_´s_256_cbc_hmac_sha1
 "AES-256-CBC-HMAC-SHA1"

	)

4791 
	#LN_´s_256_cbc_hmac_sha1
 "´s-256-cbc-hmac-sha1"

	)

4792 
	#NID_´s_256_cbc_hmac_sha1
 918

	)

4794 
	#SN_´s_128_cbc_hmac_sha256
 "AES-128-CBC-HMAC-SHA256"

	)

4795 
	#LN_´s_128_cbc_hmac_sha256
 "´s-128-cbc-hmac-sha256"

	)

4796 
	#NID_´s_128_cbc_hmac_sha256
 948

	)

4798 
	#SN_´s_192_cbc_hmac_sha256
 "AES-192-CBC-HMAC-SHA256"

	)

4799 
	#LN_´s_192_cbc_hmac_sha256
 "´s-192-cbc-hmac-sha256"

	)

4800 
	#NID_´s_192_cbc_hmac_sha256
 949

	)

4802 
	#SN_´s_256_cbc_hmac_sha256
 "AES-256-CBC-HMAC-SHA256"

	)

4803 
	#LN_´s_256_cbc_hmac_sha256
 "´s-256-cbc-hmac-sha256"

	)

4804 
	#NID_´s_256_cbc_hmac_sha256
 950

	)

4806 
	#SN_chacha20_pﬁy1305
 "ChaCha20-Pﬁy1305"

	)

4807 
	#LN_chacha20_pﬁy1305
 "chacha20-pﬁy1305"

	)

4808 
	#NID_chacha20_pﬁy1305
 1018

	)

4810 
	#SN_chacha20
 "ChaCha20"

	)

4811 
	#LN_chacha20
 "chacha20"

	)

4812 
	#NID_chacha20
 1019

	)

4814 
	#SN_dhpubli˙umbî
 "dhpubli˙umbî"

	)

4815 
	#LN_dhpubli˙umbî
 "X9.42 DH"

	)

4816 
	#NID_dhpubli˙umbî
 920

	)

4817 
	#OBJ_dhpubli˙umbî
 
OBJ_ISO_US
,10046L,2L,1L

	)

4819 
	#SN_bøöpoﬁP160r1
 "bøöpoﬁP160r1"

	)

4820 
	#NID_bøöpoﬁP160r1
 921

	)

4821 
	#OBJ_bøöpoﬁP160r1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,1L

	)

4823 
	#SN_bøöpoﬁP160t1
 "bøöpoﬁP160t1"

	)

4824 
	#NID_bøöpoﬁP160t1
 922

	)

4825 
	#OBJ_bøöpoﬁP160t1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,2L

	)

4827 
	#SN_bøöpoﬁP192r1
 "bøöpoﬁP192r1"

	)

4828 
	#NID_bøöpoﬁP192r1
 923

	)

4829 
	#OBJ_bøöpoﬁP192r1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,3L

	)

4831 
	#SN_bøöpoﬁP192t1
 "bøöpoﬁP192t1"

	)

4832 
	#NID_bøöpoﬁP192t1
 924

	)

4833 
	#OBJ_bøöpoﬁP192t1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,4L

	)

4835 
	#SN_bøöpoﬁP224r1
 "bøöpoﬁP224r1"

	)

4836 
	#NID_bøöpoﬁP224r1
 925

	)

4837 
	#OBJ_bøöpoﬁP224r1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,5L

	)

4839 
	#SN_bøöpoﬁP224t1
 "bøöpoﬁP224t1"

	)

4840 
	#NID_bøöpoﬁP224t1
 926

	)

4841 
	#OBJ_bøöpoﬁP224t1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,6L

	)

4843 
	#SN_bøöpoﬁP256r1
 "bøöpoﬁP256r1"

	)

4844 
	#NID_bøöpoﬁP256r1
 927

	)

4845 
	#OBJ_bøöpoﬁP256r1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,7L

	)

4847 
	#SN_bøöpoﬁP256t1
 "bøöpoﬁP256t1"

	)

4848 
	#NID_bøöpoﬁP256t1
 928

	)

4849 
	#OBJ_bøöpoﬁP256t1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,8L

	)

4851 
	#SN_bøöpoﬁP320r1
 "bøöpoﬁP320r1"

	)

4852 
	#NID_bøöpoﬁP320r1
 929

	)

4853 
	#OBJ_bøöpoﬁP320r1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,9L

	)

4855 
	#SN_bøöpoﬁP320t1
 "bøöpoﬁP320t1"

	)

4856 
	#NID_bøöpoﬁP320t1
 930

	)

4857 
	#OBJ_bøöpoﬁP320t1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,10L

	)

4859 
	#SN_bøöpoﬁP384r1
 "bøöpoﬁP384r1"

	)

4860 
	#NID_bøöpoﬁP384r1
 931

	)

4861 
	#OBJ_bøöpoﬁP384r1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,11L

	)

4863 
	#SN_bøöpoﬁP384t1
 "bøöpoﬁP384t1"

	)

4864 
	#NID_bøöpoﬁP384t1
 932

	)

4865 
	#OBJ_bøöpoﬁP384t1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,12L

	)

4867 
	#SN_bøöpoﬁP512r1
 "bøöpoﬁP512r1"

	)

4868 
	#NID_bøöpoﬁP512r1
 933

	)

4869 
	#OBJ_bøöpoﬁP512r1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,13L

	)

4871 
	#SN_bøöpoﬁP512t1
 "bøöpoﬁP512t1"

	)

4872 
	#NID_bøöpoﬁP512t1
 934

	)

4873 
	#OBJ_bøöpoﬁP512t1
 1L,3L,36L,3L,3L,2L,8L,1L,1L,14L

	)

4875 
	#OBJ_x9_63_scheme
 1L,3L,133L,16L,840L,63L,0L

	)

4877 
	#OBJ_£cg_scheme
 
OBJ_˚πicom_¨c
,1L

	)

4879 
	#SN_dhSögÀPass_°dDH_sha1kdf_scheme
 "dhSögÀPass-°dDH-sha1kdf-scheme"

	)

4880 
	#NID_dhSögÀPass_°dDH_sha1kdf_scheme
 936

	)

4881 
	#OBJ_dhSögÀPass_°dDH_sha1kdf_scheme
 
OBJ_x9_63_scheme
,2L

	)

4883 
	#SN_dhSögÀPass_°dDH_sha224kdf_scheme
 "dhSögÀPass-°dDH-sha224kdf-scheme"

	)

4884 
	#NID_dhSögÀPass_°dDH_sha224kdf_scheme
 937

	)

4885 
	#OBJ_dhSögÀPass_°dDH_sha224kdf_scheme
 
OBJ_£cg_scheme
,11L,0L

	)

4887 
	#SN_dhSögÀPass_°dDH_sha256kdf_scheme
 "dhSögÀPass-°dDH-sha256kdf-scheme"

	)

4888 
	#NID_dhSögÀPass_°dDH_sha256kdf_scheme
 938

	)

4889 
	#OBJ_dhSögÀPass_°dDH_sha256kdf_scheme
 
OBJ_£cg_scheme
,11L,1L

	)

4891 
	#SN_dhSögÀPass_°dDH_sha384kdf_scheme
 "dhSögÀPass-°dDH-sha384kdf-scheme"

	)

4892 
	#NID_dhSögÀPass_°dDH_sha384kdf_scheme
 939

	)

4893 
	#OBJ_dhSögÀPass_°dDH_sha384kdf_scheme
 
OBJ_£cg_scheme
,11L,2L

	)

4895 
	#SN_dhSögÀPass_°dDH_sha512kdf_scheme
 "dhSögÀPass-°dDH-sha512kdf-scheme"

	)

4896 
	#NID_dhSögÀPass_°dDH_sha512kdf_scheme
 940

	)

4897 
	#OBJ_dhSögÀPass_°dDH_sha512kdf_scheme
 
OBJ_£cg_scheme
,11L,3L

	)

4899 
	#SN_dhSögÀPass_coÁ˘‹DH_sha1kdf_scheme
 "dhSögÀPass-coÁ˘‹DH-sha1kdf-scheme"

	)

4900 
	#NID_dhSögÀPass_coÁ˘‹DH_sha1kdf_scheme
 941

	)

4901 
	#OBJ_dhSögÀPass_coÁ˘‹DH_sha1kdf_scheme
 
OBJ_x9_63_scheme
,3L

	)

4903 
	#SN_dhSögÀPass_coÁ˘‹DH_sha224kdf_scheme
 "dhSögÀPass-coÁ˘‹DH-sha224kdf-scheme"

	)

4904 
	#NID_dhSögÀPass_coÁ˘‹DH_sha224kdf_scheme
 942

	)

4905 
	#OBJ_dhSögÀPass_coÁ˘‹DH_sha224kdf_scheme
 
OBJ_£cg_scheme
,14L,0L

	)

4907 
	#SN_dhSögÀPass_coÁ˘‹DH_sha256kdf_scheme
 "dhSögÀPass-coÁ˘‹DH-sha256kdf-scheme"

	)

4908 
	#NID_dhSögÀPass_coÁ˘‹DH_sha256kdf_scheme
 943

	)

4909 
	#OBJ_dhSögÀPass_coÁ˘‹DH_sha256kdf_scheme
 
OBJ_£cg_scheme
,14L,1L

	)

4911 
	#SN_dhSögÀPass_coÁ˘‹DH_sha384kdf_scheme
 "dhSögÀPass-coÁ˘‹DH-sha384kdf-scheme"

	)

4912 
	#NID_dhSögÀPass_coÁ˘‹DH_sha384kdf_scheme
 944

	)

4913 
	#OBJ_dhSögÀPass_coÁ˘‹DH_sha384kdf_scheme
 
OBJ_£cg_scheme
,14L,2L

	)

4915 
	#SN_dhSögÀPass_coÁ˘‹DH_sha512kdf_scheme
 "dhSögÀPass-coÁ˘‹DH-sha512kdf-scheme"

	)

4916 
	#NID_dhSögÀPass_coÁ˘‹DH_sha512kdf_scheme
 945

	)

4917 
	#OBJ_dhSögÀPass_coÁ˘‹DH_sha512kdf_scheme
 
OBJ_£cg_scheme
,14L,3L

	)

4919 
	#SN_dh_°d_kdf
 "dh-°d-kdf"

	)

4920 
	#NID_dh_°d_kdf
 946

	)

4922 
	#SN_dh_coÁ˘‹_kdf
 "dh-coÁ˘‹-kdf"

	)

4923 
	#NID_dh_coÁ˘‹_kdf
 947

	)

4925 
	#SN_˘_¥e˚π_s˘s
 "˘_¥e˚π_s˘s"

	)

4926 
	#LN_˘_¥e˚π_s˘s
 "CT Pª˚πifiˇã SCTs"

	)

4927 
	#NID_˘_¥e˚π_s˘s
 951

	)

4928 
	#OBJ_˘_¥e˚π_s˘s
 1L,3L,6L,1L,4L,1L,11129L,2L,4L,2L

	)

4930 
	#SN_˘_¥e˚π_pois⁄
 "˘_¥e˚π_pois⁄"

	)

4931 
	#LN_˘_¥e˚π_pois⁄
 "CT Pª˚πifiˇã Pois⁄"

	)

4932 
	#NID_˘_¥e˚π_pois⁄
 952

	)

4933 
	#OBJ_˘_¥e˚π_pois⁄
 1L,3L,6L,1L,4L,1L,11129L,2L,4L,3L

	)

4935 
	#SN_˘_¥e˚π_sig√r
 "˘_¥e˚π_sig√r"

	)

4936 
	#LN_˘_¥e˚π_sig√r
 "CT Pª˚πifiˇã Sig√r"

	)

4937 
	#NID_˘_¥e˚π_sig√r
 953

	)

4938 
	#OBJ_˘_¥e˚π_sig√r
 1L,3L,6L,1L,4L,1L,11129L,2L,4L,4L

	)

4940 
	#SN_˘_˚π_s˘s
 "˘_˚π_s˘s"

	)

4941 
	#LN_˘_˚π_s˘s
 "CT Cîtifiˇã SCTs"

	)

4942 
	#NID_˘_˚π_s˘s
 954

	)

4943 
	#OBJ_˘_˚π_s˘s
 1L,3L,6L,1L,4L,1L,11129L,2L,4L,5L

	)

4945 
	#SN_jurisdi˘i⁄LoˇlôyName
 "jurisdi˘i⁄L"

	)

4946 
	#LN_jurisdi˘i⁄LoˇlôyName
 "jurisdi˘i⁄LoˇlôyName"

	)

4947 
	#NID_jurisdi˘i⁄LoˇlôyName
 955

	)

4948 
	#OBJ_jurisdi˘i⁄LoˇlôyName
 1L,3L,6L,1L,4L,1L,311L,60L,2L,1L,1L

	)

4950 
	#SN_jurisdi˘i⁄SèãOrProvö˚Name
 "jurisdi˘i⁄ST"

	)

4951 
	#LN_jurisdi˘i⁄SèãOrProvö˚Name
 "jurisdi˘i⁄SèãOrProvö˚Name"

	)

4952 
	#NID_jurisdi˘i⁄SèãOrProvö˚Name
 956

	)

4953 
	#OBJ_jurisdi˘i⁄SèãOrProvö˚Name
 1L,3L,6L,1L,4L,1L,311L,60L,2L,1L,2L

	)

4955 
	#SN_jurisdi˘i⁄Cou¡ryName
 "jurisdi˘i⁄C"

	)

4956 
	#LN_jurisdi˘i⁄Cou¡ryName
 "jurisdi˘i⁄Cou¡ryName"

	)

4957 
	#NID_jurisdi˘i⁄Cou¡ryName
 957

	)

4958 
	#OBJ_jurisdi˘i⁄Cou¡ryName
 1L,3L,6L,1L,4L,1L,311L,60L,2L,1L,3L

	)

4960 
	#SN_id_s¸y±
 "id-s¸y±"

	)

4961 
	#LN_id_s¸y±
 "s¸y±"

	)

4962 
	#NID_id_s¸y±
 973

	)

4963 
	#OBJ_id_s¸y±
 1L,3L,6L,1L,4L,1L,11591L,4L,11L

	)

4965 
	#SN_és1_¥f
 "TLS1-PRF"

	)

4966 
	#LN_és1_¥f
 "és1-¥f"

	)

4967 
	#NID_és1_¥f
 1021

	)

4969 
	#SN_hkdf
 "HKDF"

	)

4970 
	#LN_hkdf
 "hkdf"

	)

4971 
	#NID_hkdf
 1036

	)

4973 
	#SN_id_pköô
 "id-pköô"

	)

4974 
	#NID_id_pköô
 1031

	)

4975 
	#OBJ_id_pköô
 1L,3L,6L,1L,5L,2L,3L

	)

4977 
	#SN_pkInôClõ¡Auth
 "pkInôClõ¡Auth"

	)

4978 
	#LN_pkInôClõ¡Auth
 "PKINIT Clõ¡ Auth"

	)

4979 
	#NID_pkInôClõ¡Auth
 1032

	)

4980 
	#OBJ_pkInôClõ¡Auth
 
OBJ_id_pköô
,4L

	)

4982 
	#SN_pkInôKDC
 "pkInôKDC"

	)

4983 
	#LN_pkInôKDC
 "Signög KDC Re•⁄£"

	)

4984 
	#NID_pkInôKDC
 1033

	)

4985 
	#OBJ_pkInôKDC
 
OBJ_id_pköô
,5L

	)

4987 
	#SN_X25519
 "X25519"

	)

4988 
	#NID_X25519
 1034

	)

4989 
	#OBJ_X25519
 1L,3L,101L,110L

	)

4991 
	#SN_X448
 "X448"

	)

4992 
	#NID_X448
 1035

	)

4993 
	#OBJ_X448
 1L,3L,101L,111L

	)

4995 
	#SN_ED25519
 "ED25519"

	)

4996 
	#NID_ED25519
 1087

	)

4997 
	#OBJ_ED25519
 1L,3L,101L,112L

	)

4999 
	#SN_ED448
 "ED448"

	)

5000 
	#NID_ED448
 1088

	)

5001 
	#OBJ_ED448
 1L,3L,101L,113L

	)

5003 
	#SN_kx_rß
 "KxRSA"

	)

5004 
	#LN_kx_rß
 "kx-rß"

	)

5005 
	#NID_kx_rß
 1037

	)

5007 
	#SN_kx_ecdhe
 "KxECDHE"

	)

5008 
	#LN_kx_ecdhe
 "kx-ecdhe"

	)

5009 
	#NID_kx_ecdhe
 1038

	)

5011 
	#SN_kx_dhe
 "KxDHE"

	)

5012 
	#LN_kx_dhe
 "kx-dhe"

	)

5013 
	#NID_kx_dhe
 1039

	)

5015 
	#SN_kx_ecdhe_psk
 "KxECDHE-PSK"

	)

5016 
	#LN_kx_ecdhe_psk
 "kx-ecdhe-psk"

	)

5017 
	#NID_kx_ecdhe_psk
 1040

	)

5019 
	#SN_kx_dhe_psk
 "KxDHE-PSK"

	)

5020 
	#LN_kx_dhe_psk
 "kx-dhe-psk"

	)

5021 
	#NID_kx_dhe_psk
 1041

	)

5023 
	#SN_kx_rß_psk
 "KxRSA_PSK"

	)

5024 
	#LN_kx_rß_psk
 "kx-rß-psk"

	)

5025 
	#NID_kx_rß_psk
 1042

	)

5027 
	#SN_kx_psk
 "KxPSK"

	)

5028 
	#LN_kx_psk
 "kx-psk"

	)

5029 
	#NID_kx_psk
 1043

	)

5031 
	#SN_kx_§p
 "KxSRP"

	)

5032 
	#LN_kx_§p
 "kx-§p"

	)

5033 
	#NID_kx_§p
 1044

	)

5035 
	#SN_kx_go°
 "KxGOST"

	)

5036 
	#LN_kx_go°
 "kx-go°"

	)

5037 
	#NID_kx_go°
 1045

	)

5039 
	#SN_kx_™y
 "KxANY"

	)

5040 
	#LN_kx_™y
 "kx-™y"

	)

5041 
	#NID_kx_™y
 1063

	)

5043 
	#SN_auth_rß
 "AuthRSA"

	)

5044 
	#LN_auth_rß
 "auth-rß"

	)

5045 
	#NID_auth_rß
 1046

	)

5047 
	#SN_auth_ecdß
 "AuthECDSA"

	)

5048 
	#LN_auth_ecdß
 "auth-ecdß"

	)

5049 
	#NID_auth_ecdß
 1047

	)

5051 
	#SN_auth_psk
 "AuthPSK"

	)

5052 
	#LN_auth_psk
 "auth-psk"

	)

5053 
	#NID_auth_psk
 1048

	)

5055 
	#SN_auth_dss
 "AuthDSS"

	)

5056 
	#LN_auth_dss
 "auth-dss"

	)

5057 
	#NID_auth_dss
 1049

	)

5059 
	#SN_auth_go°01
 "AuthGOST01"

	)

5060 
	#LN_auth_go°01
 "auth-go°01"

	)

5061 
	#NID_auth_go°01
 1050

	)

5063 
	#SN_auth_go°12
 "AuthGOST12"

	)

5064 
	#LN_auth_go°12
 "auth-go°12"

	)

5065 
	#NID_auth_go°12
 1051

	)

5067 
	#SN_auth_§p
 "AuthSRP"

	)

5068 
	#LN_auth_§p
 "auth-§p"

	)

5069 
	#NID_auth_§p
 1052

	)

5071 
	#SN_auth_nuŒ
 "AuthNULL"

	)

5072 
	#LN_auth_nuŒ
 "auth-nuŒ"

	)

5073 
	#NID_auth_nuŒ
 1053

	)

5075 
	#SN_auth_™y
 "AuthANY"

	)

5076 
	#LN_auth_™y
 "auth-™y"

	)

5077 
	#NID_auth_™y
 1064

	)

5079 
	#SN_pﬁy1305
 "Pﬁy1305"

	)

5080 
	#LN_pﬁy1305
 "pﬁy1305"

	)

5081 
	#NID_pﬁy1305
 1061

	)

5083 
	#SN_sùhash
 "SùHash"

	)

5084 
	#LN_sùhash
 "sùhash"

	)

5085 
	#NID_sùhash
 1062

	)

5087 
	#SN_ffdhe2048
 "ffdhe2048"

	)

5088 
	#NID_ffdhe2048
 1126

	)

5090 
	#SN_ffdhe3072
 "ffdhe3072"

	)

5091 
	#NID_ffdhe3072
 1127

	)

5093 
	#SN_ffdhe4096
 "ffdhe4096"

	)

5094 
	#NID_ffdhe4096
 1128

	)

5096 
	#SN_ffdhe6144
 "ffdhe6144"

	)

5097 
	#NID_ffdhe6144
 1129

	)

5099 
	#SN_ffdhe8192
 "ffdhe8192"

	)

5100 
	#NID_ffdhe8192
 1130

	)

5102 
	#SN_ISO_UA
 "ISO-UA"

	)

5103 
	#NID_ISO_UA
 1150

	)

5104 
	#OBJ_ISO_UA
 
OBJ_membî_body
,804L

	)

5106 
	#SN_ua_pki
 "ua-pki"

	)

5107 
	#NID_ua_pki
 1151

	)

5108 
	#OBJ_ua_pki
 
OBJ_ISO_UA
,2L,1L,1L,1L

	)

5110 
	#SN_d°u28147
 "d°u28147"

	)

5111 
	#LN_d°u28147
 "DSTU Go° 28147-2009"

	)

5112 
	#NID_d°u28147
 1152

	)

5113 
	#OBJ_d°u28147
 
OBJ_ua_pki
,1L,1L,1L

	)

5115 
	#SN_d°u28147_ofb
 "d°u28147-ofb"

	)

5116 
	#LN_d°u28147_ofb
 "DSTU Go° 28147-2009 OFB mode"

	)

5117 
	#NID_d°u28147_ofb
 1153

	)

5118 
	#OBJ_d°u28147_ofb
 
OBJ_d°u28147
,2L

	)

5120 
	#SN_d°u28147_cfb
 "d°u28147-cfb"

	)

5121 
	#LN_d°u28147_cfb
 "DSTU Go° 28147-2009 CFB mode"

	)

5122 
	#NID_d°u28147_cfb
 1154

	)

5123 
	#OBJ_d°u28147_cfb
 
OBJ_d°u28147
,3L

	)

5125 
	#SN_d°u28147_wøp
 "d°u28147-wøp"

	)

5126 
	#LN_d°u28147_wøp
 "DSTU Go° 28147-2009 key wøp"

	)

5127 
	#NID_d°u28147_wøp
 1155

	)

5128 
	#OBJ_d°u28147_wøp
 
OBJ_d°u28147
,5L

	)

5130 
	#SN_hmacWôhD°u34311
 "hmacWôhD°u34311"

	)

5131 
	#LN_hmacWôhD°u34311
 "HMAC DSTU Go° 34311-95"

	)

5132 
	#NID_hmacWôhD°u34311
 1156

	)

5133 
	#OBJ_hmacWôhD°u34311
 
OBJ_ua_pki
,1L,1L,2L

	)

5135 
	#SN_d°u34311
 "d°u34311"

	)

5136 
	#LN_d°u34311
 "DSTU Go° 34311-95"

	)

5137 
	#NID_d°u34311
 1157

	)

5138 
	#OBJ_d°u34311
 
OBJ_ua_pki
,1L,2L,1L

	)

5140 
	#SN_d°u4145À
 "d°u4145À"

	)

5141 
	#LN_d°u4145À
 "DSTU 4145-2002Üôéêídün"

	)

5142 
	#NID_d°u4145À
 1158

	)

5143 
	#OBJ_d°u4145À
 
OBJ_ua_pki
,1L,3L,1L,1L

	)

5145 
	#SN_d°u4145be
 "d°u4145be"

	)

5146 
	#LN_d°u4145be
 "DSTU 4145-2002 bigÉndün"

	)

5147 
	#NID_d°u4145be
 1159

	)

5148 
	#OBJ_d°u4145be
 
OBJ_d°u4145À
,1L,1L

	)

5150 
	#SN_uacurve0
 "uacurve0"

	)

5151 
	#LN_uacurve0
 "DSTU curvê0"

	)

5152 
	#NID_uacurve0
 1160

	)

5153 
	#OBJ_uacurve0
 
OBJ_d°u4145À
,2L,0L

	)

5155 
	#SN_uacurve1
 "uacurve1"

	)

5156 
	#LN_uacurve1
 "DSTU curvê1"

	)

5157 
	#NID_uacurve1
 1161

	)

5158 
	#OBJ_uacurve1
 
OBJ_d°u4145À
,2L,1L

	)

5160 
	#SN_uacurve2
 "uacurve2"

	)

5161 
	#LN_uacurve2
 "DSTU curvê2"

	)

5162 
	#NID_uacurve2
 1162

	)

5163 
	#OBJ_uacurve2
 
OBJ_d°u4145À
,2L,2L

	)

5165 
	#SN_uacurve3
 "uacurve3"

	)

5166 
	#LN_uacurve3
 "DSTU curvê3"

	)

5167 
	#NID_uacurve3
 1163

	)

5168 
	#OBJ_uacurve3
 
OBJ_d°u4145À
,2L,3L

	)

5170 
	#SN_uacurve4
 "uacurve4"

	)

5171 
	#LN_uacurve4
 "DSTU curvê4"

	)

5172 
	#NID_uacurve4
 1164

	)

5173 
	#OBJ_uacurve4
 
OBJ_d°u4145À
,2L,4L

	)

5175 
	#SN_uacurve5
 "uacurve5"

	)

5176 
	#LN_uacurve5
 "DSTU curvê5"

	)

5177 
	#NID_uacurve5
 1165

	)

5178 
	#OBJ_uacurve5
 
OBJ_d°u4145À
,2L,5L

	)

5180 
	#SN_uacurve6
 "uacurve6"

	)

5181 
	#LN_uacurve6
 "DSTU curvê6"

	)

5182 
	#NID_uacurve6
 1166

	)

5183 
	#OBJ_uacurve6
 
OBJ_d°u4145À
,2L,6L

	)

5185 
	#SN_uacurve7
 "uacurve7"

	)

5186 
	#LN_uacurve7
 "DSTU curvê7"

	)

5187 
	#NID_uacurve7
 1167

	)

5188 
	#OBJ_uacurve7
 
OBJ_d°u4145À
,2L,7L

	)

5190 
	#SN_uacurve8
 "uacurve8"

	)

5191 
	#LN_uacurve8
 "DSTU curvê8"

	)

5192 
	#NID_uacurve8
 1168

	)

5193 
	#OBJ_uacurve8
 
OBJ_d°u4145À
,2L,8L

	)

5195 
	#SN_uacurve9
 "uacurve9"

	)

5196 
	#LN_uacurve9
 "DSTU curvê9"

	)

5197 
	#NID_uacurve9
 1169

	)

5198 
	#OBJ_uacurve9
 
OBJ_d°u4145À
,2L,9L

	)

	@/usr/include/openssl/objectserr.h

11 #i‚de‡
HEADER_OBJERR_H


12 
	#HEADER_OBJERR_H


	)

14 #i‚de‡
HEADER_SYMHACKS_H


15 
	~<›ís¶/symhacks.h
>

18 #ifde‡ 
__˝lu•lus


21 
ERR_lﬂd_OBJ_°rögs
();

26 
	#OBJ_F_OBJ_ADD_OBJECT
 105

	)

27 
	#OBJ_F_OBJ_ADD_SIGID
 107

	)

28 
	#OBJ_F_OBJ_CREATE
 100

	)

29 
	#OBJ_F_OBJ_DUP
 101

	)

30 
	#OBJ_F_OBJ_NAME_NEW_INDEX
 106

	)

31 
	#OBJ_F_OBJ_NID2LN
 102

	)

32 
	#OBJ_F_OBJ_NID2OBJ
 103

	)

33 
	#OBJ_F_OBJ_NID2SN
 104

	)

34 
	#OBJ_F_OBJ_TXT2OBJ
 108

	)

39 
	#OBJ_R_OID_EXISTS
 102

	)

40 
	#OBJ_R_UNKNOWN_NID
 101

	)

	@
1
.
1
/usr/include
240
4022
acl.c
adlist.c
adlist.h
ae.c
ae.h
ae_epoll.c
ae_evport.c
ae_kqueue.c
ae_select.c
anet.c
anet.h
aof.c
asciilogo.h
atomicvar.h
bio.c
bio.h
bitops.c
blocked.c
childinfo.c
cluster.c
cluster.h
config.c
config.h
connection.c
connection.h
connhelpers.h
crc16.c
crc16_slottable.h
crc64.c
crc64.h
crcspeed.c
crcspeed.h
db.c
debug.c
debugmacro.h
defrag.c
dict.c
dict.h
endianconv.c
endianconv.h
evict.c
expire.c
fmacros.h
geo.c
geo.h
geohash.c
geohash.h
geohash_helper.c
geohash_helper.h
gopher.c
help.h
hyperloglog.c
intset.c
intset.h
latency.c
latency.h
lazyfree.c
listpack.c
listpack.h
listpack_malloc.h
localtime.c
lolwut.c
lolwut.h
lolwut5.c
lolwut6.c
lzf.h
lzfP.h
lzf_c.c
lzf_d.c
memtest.c
module.c
modules/helloacl.c
modules/helloblock.c
modules/hellocluster.c
modules/hellodict.c
modules/hellohook.c
modules/hellotimer.c
modules/hellotype.c
modules/helloworld.c
modules/testmodule.c
multi.c
networking.c
notify.c
object.c
pqsort.c
pqsort.h
pubsub.c
quicklist.c
quicklist.h
rand.c
rand.h
rax.c
rax.h
rax_malloc.h
rdb.c
rdb.h
redis-benchmark.c
redis-check-aof.c
redis-check-rdb.c
redis-cli.c
redisassert.h
redismodule.h
release.c
release.h
replication.c
rio.c
rio.h
scripting.c
sds.c
sds.h
sdsalloc.h
sentinel.c
server.c
server.h
setcpuaffinity.c
setproctitle.c
sha1.c
sha1.h
sha256.c
sha256.h
siphash.c
slowlog.c
slowlog.h
solarisfixes.h
sort.c
sparkline.c
sparkline.h
stream.h
syncio.c
t_hash.c
t_list.c
t_set.c
t_stream.c
t_string.c
t_zset.c
testhelp.h
timeout.c
tls.c
tracking.c
util.c
util.h
version.h
ziplist.c
ziplist.h
zipmap.c
zipmap.h
zmalloc.c
zmalloc.h
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/dlfcn.h
/usr/include/endian.h
/usr/include/errno.h
/usr/include/execinfo.h
/usr/include/fcntl.h
/usr/include/features.h
/usr/include/inttypes.h
/usr/include/limits.h
/usr/include/linux/version.h
/usr/include/locale.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/netinet/tcp.h
/usr/include/openssl/err.h
/usr/include/openssl/rand.h
/usr/include/openssl/ssl.h
/usr/include/poll.h
/usr/include/pthread.h
/usr/include/sched.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/stropts.h
/usr/include/syslog.h
/usr/include/termios.h
/usr/include/time.h
/usr/include/ucontext.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/openssl/async.h
/usr/include/openssl/bio.h
/usr/include/openssl/buffer.h
/usr/include/openssl/comp.h
/usr/include/openssl/crypto.h
/usr/include/openssl/ct.h
/usr/include/openssl/dtls1.h
/usr/include/openssl/e_os2.h
/usr/include/openssl/hmac.h
/usr/include/openssl/lhash.h
/usr/include/openssl/ossl_typ.h
/usr/include/openssl/pem.h
/usr/include/openssl/randerr.h
/usr/include/openssl/safestack.h
/usr/include/openssl/srtp.h
/usr/include/openssl/ssl2.h
/usr/include/openssl/ssl3.h
/usr/include/openssl/sslerr.h
/usr/include/openssl/symhacks.h
/usr/include/openssl/tls1.h
/usr/include/openssl/x509.h
/usr/include/rpc/netdb.h
/usr/include/stdc-predef.h
/usr/include/strings.h
/usr/include/openssl/asn1.h
/usr/include/openssl/asyncerr.h
/usr/include/openssl/bioerr.h
/usr/include/openssl/buffererr.h
/usr/include/openssl/comperr.h
/usr/include/openssl/cryptoerr.h
/usr/include/openssl/cterr.h
/usr/include/openssl/dh.h
/usr/include/openssl/dsa.h
/usr/include/openssl/ebcdic.h
/usr/include/openssl/ec.h
/usr/include/openssl/evp.h
/usr/include/openssl/opensslv.h
/usr/include/openssl/pemerr.h
/usr/include/openssl/pkcs7.h
/usr/include/openssl/rsa.h
/usr/include/openssl/sha.h
/usr/include/openssl/stack.h
/usr/include/openssl/x509_vfy.h
/usr/include/openssl/x509err.h
/usr/include/openssl/asn1err.h
/usr/include/openssl/bn.h
/usr/include/openssl/dherr.h
/usr/include/openssl/dsaerr.h
/usr/include/openssl/ecerr.h
/usr/include/openssl/evperr.h
/usr/include/openssl/objects.h
/usr/include/openssl/pkcs7err.h
/usr/include/openssl/rsaerr.h
/usr/include/openssl/bnerr.h
/usr/include/openssl/obj_mac.h
/usr/include/openssl/objectserr.h
